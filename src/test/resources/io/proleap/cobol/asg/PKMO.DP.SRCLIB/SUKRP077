000010***************************************************************** 00001001
000020 IDENTIFICATION DIVISION.                                         00002001
000030 PROGRAM-ID.             SUKRP077.                                00003001
000040 AUTHOR.                 DENISE HAHN.                             00004001
000050 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00005001
000060 DATE-WRITTEN.           AUGUST, 2017.                            00006001
000070 DATE-COMPILED.                                                   00007001
000080***************************************************************** 00008001
000090*                                                               * 00009001
000091*  CARTON DIVERT COUNTS BY DOOR                                 * 00009101
000092*                                                               * 00009201
000095***************************************************************** 00009501
000096 ENVIRONMENT DIVISION.                                            00009601
000097 CONFIGURATION SECTION.                                           00009701
000098                                                                  00009801
000099 SOURCE-COMPUTER.        IBM-3090.                                00009901
000100 OBJECT-COMPUTER.        IBM-3090.                                00010001
000110                                                                  00011001
000120***************************************************************** 00012001
000130 INPUT-OUTPUT SECTION.                                            00013001
000140                                                                  00014001
000150 FILE-CONTROL.                                                    00015001
000160                                                                  00016001
000191     SELECT CONTROL-FILE                                          00019101
000192         ASSIGN TO INP01.                                         00019201
000193                                                                  00019301
000194     SELECT REPORT-FILE                                           00019401
000195         ASSIGN TO RPT01.                                         00019501
000196***************************************************************** 00019601
000197 DATA DIVISION.                                                   00019701
000198***************************************************************** 00019801
000199 FILE SECTION.                                                    00019901
000200                                                                  00020001
000270 FD  CONTROL-FILE                                                 00027001
000280     RECORDING MODE IS F                                          00028001
000290     LABEL RECORDS ARE STANDARD                                   00029001
000291     BLOCK CONTAINS 0 RECORDS.                                    00029101
000292 01  CONTROL-RECORD                  PIC  X(80).                  00029201
000293                                                                  00029301
000294 FD  REPORT-FILE                                                  00029401
000295     RECORDING MODE IS F                                          00029501
000296     BLOCK CONTAINS 0  RECORDS.                                   00029601
000297 01  REPORT-RECORD                   PIC X(150).                  00029701
000298                                                                  00029801
000299***************************************************************** 00029901
000300 WORKING-STORAGE SECTION.                                         00030001
000310                                                                  00031001
000320 01  PROGRAM-SWITCHES.                                            00032001
000330     05  PS-END-OF-CURSOR-SW         PIC X(01) VALUE 'N'.         00033005
000340         88  PS-END-OF-CURSOR                  VALUE 'Y'.         00034005
000350         88  PS-NOT-END-OF-CURSOR              VALUE 'N'.         00035005
000360     05  PS-SUMMARY-TABLE-SW         PIC X(01) VALUE 'N'.         00036011
000370         88  SUMMARY-TABLE-EOF                 VALUE 'Y'.         00037011
000380                                                                  00038001
000390 01  PC-PROGRAM-CONSTANTS.                                        00039001
000401     05  PC-ACTUAL-TABLE-ENTRIES     PIC S9(05) VALUE ZEROES.     00040111
000402     05  PC-SUKRP077                 PIC X(08)  VALUE             00040211
000403                                               'SUKRP077'.        00040301
000404     05  PC-REPORT-NBR               PIC X(02)  VALUE '-1'.       00040411
000405     05  PC-MAX-LINE-COUNT           PIC S9(3)  VALUE +60         00040511
000406                                                COMP-3.           00040611
000407     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             00040701
000408                                    '9999-09-09-09.09.09.999999'. 00040801
000409     05  PC-SLASH                    PIC X(01)  VALUE '/'.        00040911
000410     05  PC-DASH                     PIC X(01)  VALUE '-'.        00041011
000411     05  PC-DEFAULT-BEGIN            PIC X(16)  VALUE             00041106
000412                                    '-00.00.00.000000'.           00041206
000413     05  PC-DEFAULT-END              PIC X(16)  VALUE             00041306
000414                                    '-23.59.59.999999'.           00041406
000415     05  PC-TABLE-MAX                PIC S9(05) VALUE +300.       00041511
000420                                                                  00042001
000430 01  SD-DATE-TIME.                                                00043001
000440     05  SD-SYSTEM-DATE.                                          00044001
000450         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00045001
000460         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00046001
000470         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00047001
000480     05  SD-SYSTEM-TIME.                                          00048001
000490         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00049001
000491         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00049101
000492         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00049201
000493         10  FILLER                  PIC 9(02) VALUE ZERO.        00049301
000494                                                                  00049401
000495 01  PV-PROGRAM-VARIABLES.                                        00049501
000496     05  PV-READ-COUNT                PIC S9(7) COMP-3            00049601
000497                                                VALUE ZERO.       00049701
000498     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00049801
000499                                                VALUE ZERO.       00049901
000500     05  PV-NULL-IND                 PIC S9(04) VALUE +0          00050001
000510                                               COMP SYNC.         00051001
000520     05  PV-FORMAT-DATE.                                          00052001
000530         10 PV-FORMAT-DATE-MM         PIC  9(02).                 00053001
000540         10 FILLER                    PIC  X(01) VALUE '/'.       00054001
000550         10 PV-FORMAT-DATE-DD         PIC  9(02).                 00055001
000560         10 FILLER                    PIC  X(01) VALUE '/'.       00056001
000570         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 00057001
000580                                                                  00058001
000590     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00059001
000591     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00059101
000592                                               COMP-3.            00059201
000593     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00059301
000594                                               COMP-3.            00059401
000597     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          00059701
000598     05  PV-TRIPS-ON-PAGE            PIC  9(3) VALUE 6.           00059801
000630                                                                  00063001
000640     05  PV-TODAYS-DATE.                                          00064001
000650         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        00065001
000660         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        00066001
000670         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        00067001
000680     05  PV-TODAYS-DATE-YYYY.                                     00068001
000690         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          00069001
000691         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        00069101
000692                                                                  00069201
000693     05  PV-TODAYS-TIME.                                          00069301
000694         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        00069401
000695         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        00069501
000696         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        00069601
000697         10  FILLER                  PIC 9(02) VALUE ZERO.        00069701
000698                                                                  00069801
000699     05  PV-PREV-OPER                PIC   9(04).                 00069905
000700     05  PV-STORE-NAME               PIC   X(40).                 00070005
000701     05  PV-DC-NAME                  PIC   X(40).                 00070124
000702                                                                  00070224
000703     05  PV-DOOR-DIVERT-COUNT        PIC S9(09)  COMP.            00070324
000720     05  PV-DC-DIVERT-COUNT          PIC  9(11).                  00072010
000752     05  PV-CORP-DIVERT-COUNT        PIC  9(13).                  00075210
000755                                                                  00075501
000756  01  SPT-SUMMARY-PAGE-TABLE.                                     00075601
000757      05  FILLER  OCCURS 150 TIMES                                00075701
000758                  INDEXED BY SPT-INDEX.                           00075801
000759          10  SPT-DC-NBR             PIC 9(04)      VALUE ZEROES. 00075901
000760          10  SPT-DC-NAME            PIC X(20)      VALUE SPACES. 00076001
000780          10  SPT-DIVERT-COUNT       PIC 9(11)      VALUE ZEROES. 00078001
000800                                                                  00080001
000900                                                                  00090001
001000                                                                  00100001
001100 01  PV-ABEND-FIELDS.                                             00110001
001200     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           00120001
001300                                               COMP SYNC.         00130001
001400     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP077'.  00140001
001410     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      00141001
001420     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      00142001
001430     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      00143001
001440     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      00144001
001450     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      00145001
001460     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      00146001
001470     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      00147001
001480     05  PV-DB2-TABLE-NAME-1         PIC X(08) VALUE SPACES.      00148001
001490     05  PV-DB2-TABLE-NAME-2         PIC X(08) VALUE SPACES.      00149001
001500     05  PV-ERROR-MESSAGE-1          PIC X(50) VALUE SPACES.      00150001
001510     05  PV-ERROR-MESSAGE-2          PIC X(50) VALUE SPACES.      00151001
001520                                                                  00152001
001530     05  PV-DISPLAY-OPER             PIC  9(04) VALUE ZEROES.     00153001
001540     05  PV-DISPLAY-SQLCODE          PIC  9(03)- VALUE ZEROES.    00154001
001550     05  PV-DB2-TABLE-NAME1          PIC  X(15) VALUE SPACES.     00155001
001560                                                                  00156001
001570     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             00157001
001580     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             00158001
001590     05  PV-DISPLAY-PERCENT1         PIC ZZZ.99.                  00159001
001591     05  PV-DISPLAY-PERCENT2         PIC ZZZ.                     00159101
001592                                                                  00159201
001593 01  PV-SAVE-FIELDS.                                              00159301
001594     05  PV-SAVE-OPER-UNT-ID          PIC S9(04) COMP             00159401
001595                                                 VALUE +0.        00159501
001596 01  DK-DB-KEYS.                                                  00159601
001597     05  DK-OPER-UNT-ID              PIC S9(4) COMP.              00159701
001598     05  DK-BEGIN-TMST               PIC  X(26).                  00159807
001599     05  DK-BEGIN-TMST-R REDEFINES DK-BEGIN-TMST.                 00159903
001600         10  DK-BEGIN-DATE           PIC  X(10).                  00160001
001605         10  DK-BEGIN-TIME           PIC  X(16).                  00160507
001613     05  DK-END-TMST                 PIC  X(26).                  00161307
001614     05  DK-END-TMST-R REDEFINES DK-END-TMST.                     00161403
001615         10  DK-END-DATE             PIC  9(10).                  00161505
001619         10  DK-END-TIME             PIC  X(16).                  00161906
001628                                                                  00162801
001629 01  REPORT-DATES.                                                00162901
001630     05  REPORT-FROM-DATE            PIC X(10).                   00163001
001631     05  REPORT-TO-DATE              PIC X(10).                   00163101
001632******************************************************************00163201
001633*    DATE CONTROL CARD                                            00163301
001640******************************************************************00164001
001650     COPY SURD032.                                                00165001
001660                                                                  00166001
001692                                                                  00169201
001693******************************************************************00169301
001694*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               00169401
001695******************************************************************00169501
001696     COPY DPWS132O.                                               00169601
001697                                                                  00169701
001698 01  WS-BATCH-PROC-DATE.                                          00169801
001699     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      00169901
001700     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      00170001
001710     05  FILLER                      PIC X(01) VALUE SPACES.      00171001
001720     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      00172001
001730     05  FILLER                      PIC X(01) VALUE SPACES.      00173001
001740     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      00174001
001750*                                                                 00175001
001760 01  HEADING-LINES.                                               00176001
001770     05  HEADING-LINE1.                                           00177001
001780         10  FILLER                  PIC X(51) VALUE SPACES.      00178001
001790         10  FILLER                  PIC X(34) VALUE              00179001
001791         'DIVERTED CARTONS COUNT BY DC/DOOR'.                     00179101
001793         10  FILLER                  PIC X(53) VALUE SPACES.      00179301
001794                                                                  00179401
001795     05  HEADING-LINE1A.                                          00179501
001796         10  FILLER                  PIC X(46) VALUE SPACES.      00179601
001797         10  FILLER                  PIC X(13) VALUE              00179701
001798         'FISCAL MONTH '.                                         00179801
001799         10  HD1A-FROM-DATE          PIC X(10) VALUE SPACES.      00179901
001800         10  FILLER                  PIC X(03) VALUE ' - '.       00180001
001801         10  HD1A-TO-DATE            PIC X(10) VALUE SPACES.      00180101
001810         10  FILLER                  PIC X(50) VALUE SPACES.      00181001
001820                                                                  00182001
001830     05  HEADING-LINE2.                                           00183001
001840         10  HD2-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      00184001
001850         10  FILLER                  PIC X(01) VALUE SPACES.      00185001
001860         10  HD2-DC-NAME             PIC X(40) VALUE SPACES.      00186001
001870         10  FILLER                  PIC X(87) VALUE SPACES.      00187001
001880         10  FILLER                  PIC X(18) VALUE SPACES.      00188001
001890                                                                  00189001
001900     05  HEADING-LINE3.                                           00190001
002000         10  FILLER            PIC X(02) VALUE SPACES.            00200001
002100         10  FILLER            PIC X(02) VALUE 'DC'.              00210001
002200         10  FILLER            PIC X(04) VALUE SPACES.            00220001
002300         10  FILLER            PIC X(04) VALUE 'DOOR'.            00230001
002400         10  FILLER            PIC X(03) VALUE SPACES.            00240018
002401         10  FILLER            PIC X(05) VALUE 'STORE'.           00240101
002402         10  FILLER            PIC X(28) VALUE SPACES.            00240201
002410         10  FILLER            PIC X(03) VALUE 'LOC'.             00241001
002420         10  FILLER            PIC X(32) VALUE SPACES.            00242001
002430         10  FILLER            PIC X(06) VALUE 'DIVERT'.          00243001
002460         10  FILLER            PIC X(50) VALUE SPACES.            00246001
002470                                                                  00247001
002480     05  HEADING-LINE4.                                           00248001
002490         10  FILLER            PIC X(02) VALUE SPACES.            00249001
002491         10  FILLER            PIC X(03) VALUE 'NBR'.             00249101
002492         10  FILLER            PIC X(04) VALUE SPACES.            00249201
002493         10  FILLER            PIC X(03) VALUE 'NBR'.             00249301
002494         10  FILLER            PIC X(04) VALUE SPACES.            00249401
002495         10  FILLER            PIC X(03) VALUE 'NBR'.             00249501
002496         10  FILLER            PIC X(29) VALUE SPACES.            00249601
002497         10  FILLER            PIC X(04) VALUE 'TYPE'.            00249701
002498         10  FILLER            PIC X(32) VALUE SPACES.            00249801
002499         10  FILLER            PIC X(05) VALUE 'COUNT'.           00249901
002500         10  FILLER            PIC X(50) VALUE SPACES.            00250001
002600                                                                  00260001
002700 01  DETAIL-LINE.                                                 00270001
002800     05  DETAIL-LINE1.                                            00280001
002810         10  FILLER               PIC  X(01) VALUE SPACES.        00281001
002820         10  DL1-DC-NBR           PIC  Z(04) VALUE ZEROES.        00282001
002830         10  FILLER               PIC  X(03) VALUE SPACES.        00283001
002840         10  DL1-DOOR             PIC  X(04) VALUE SPACES.        00284001
002850         10  FILLER               PIC  X(03) VALUE SPACES.        00285001
002851         10  DL1-STORE            PIC  Z(04) VALUE ZEROES.        00285101
002852         10  FILLER               PIC  X(02) VALUE SPACES.        00285201
002860         10  DL1-STORE-NAME       PIC  X(25) VALUE SPACES.        00286001
002870         10  FILLER               PIC  X(03) VALUE SPACES.        00287001
002880         10  DL1-LOC-TYPE-CDE     PIC  X(02) VALUE SPACES.        00288001
002890         10  FILLER               PIC  X(02) VALUE SPACES.        00289001
002900         10  DL1-LOC-TYPE-DESC    PIC  X(19) VALUE SPACES.        00290001
002901         10  FILLER               PIC  X(04)  VALUE SPACES.       00290101
002902         10  DL1-DIVERT-COUNT     PIC  Z,ZZZ,ZZZ,ZZZ VALUE ZERO.  00290201
002903         10  FILLER               PIC  X(49)  VALUE SPACES.       00290301
002904                                                                  00290401
002905 01  TOTAL-LINES.                                                 00290501
002906     05  TOTAL-LINE1.                                             00290601
002907         10  FILLER               PIC  X(01) VALUE SPACES.        00290701
002908         10  TL1-DC-NBR           PIC  Z(04) VALUE ZEROES.        00290801
002909         10  FILLER               PIC  X(16) VALUE SPACES.        00290901
002930         10  TL1-DC-NAME          PIC  X(20) VALUE SPACES.        00293001
002940         10  FILLER               PIC  X(12) VALUE SPACES.        00294026
002950         10  FILLER               PIC  X(05) VALUE 'TOTAL'.       00295001
002960         10  FILLER               PIC  X(14)  VALUE SPACES.       00296001
002970         10  TL1-DIVERT-COUNT     PIC  Z,ZZZ,ZZZ,ZZZ,ZZZ          00297001
002980                                             VALUE ZERO.          00298001
003000         10  FILLER               PIC  X(49)  VALUE SPACES.       00300001
003100                                                                  00310001
003200 01  MISCELLANEOUS-LINES.                                         00320001
003300     05  BLANK-LINE.                                              00330001
003400         10  FILLER                  PIC X(150) VALUE SPACES.     00340001
003500                                                                  00350001
003600     05  END-OF-REPORT-LINE.                                      00360001
003700         10  FILLER                  PIC X(44) VALUE SPACES.      00370001
003800         10  FILLER                  PIC X(45) VALUE              00380001
003900             '*******   E N D   O F   R E P O R T   *******'.     00390001
004000         10  FILLER                  PIC X(43) VALUE SPACES.      00400001
004100         10  FILLER                  PIC X(18) VALUE SPACES.      00410001
004200                                                                  00420001
004300     05  NO-DATA-TO-REPORT-LINE.                                  00430001
004400         10  FILLER                  PIC X(40) VALUE SPACES.      00440001
004410         10  FILLER                  PIC  X(52)    VALUE          00441001
004420         '*******  N O   D A T A   T O   R E P O R T   *******'.  00442001
004430         10  FILLER                  PIC  X(40)    VALUE SPACES.  00443001
004440         10  FILLER                  PIC X(18) VALUE SPACES.      00444001
004450                                                                  00445001
004460                                                                  00446001
004470******************************************************************00447001
004480*  USED FOR DB2 ERROR MESSAGE BUILDING                            00448001
004490******************************************************************00449001
004491     COPY DPWS004.                                                00449101
004492                                                                  00449201
004493******************************************************************00449301
004494*   DB2 SQL COMMUNICATION AREA                                    00449401
004495******************************************************************00449501
004496     EXEC SQL                                                     00449601
004497          INCLUDE SQLCA                                           00449701
004498     END-EXEC.                                                    00449801
004499                                                                  00449901
004500*---------------------------------------------------------------* 00450001
004510*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        00451001
004520*  XLT_LOC                                                        00452001
004530*---------------------------------------------------------------* 00453001
004540     EXEC SQL                                                     00454001
004550          INCLUDE XLT00010                                        00455001
004560     END-EXEC.                                                    00456001
004561                                                                  00456101
004562*---------------------------------------------------------------* 00456201
004564*  TSUCRDV - DIVERT                                               00456401
004565*---------------------------------------------------------------* 00456501
004566     EXEC SQL                                                     00456601
004567          INCLUDE TSUCRDV                                         00456701
004568     END-EXEC.                                                    00456801
004569                                                                  00456901
004570*---------------------------------------------------------------* 00457001
004572*  TCNDCDR  DC DOOR DEFINITION                                    00457201
004573*---------------------------------------------------------------* 00457301
004574     EXEC SQL                                                     00457401
004575          INCLUDE TCNDCDR                                         00457501
004576     END-EXEC.                                                    00457601
004577                                                                  00457701
004578*---------------------------------------------------------------* 00457801
004580*  TCNDRST - DC DOOR TO STORE ASSOCIATION                         00458001
004581*---------------------------------------------------------------* 00458101
004582     EXEC SQL                                                     00458201
004583          INCLUDE TCNDRST                                         00458301
004584     END-EXEC.                                                    00458401
004585                                                                  00458501
004596*---------------------------------------------------------------* 00459601
004597*    DB2 AREA FOR COMMUNICATIONS AREA2                            00459701
004598*---------------------------------------------------------------* 00459801
004600     COPY SQLCA2.                                                 00460001
004601                                                                  00460101
004602*---------------------------------------------------------------* 00460201
004603*    DIVERT CURSOR                                                00460301
004604*---------------------------------------------------------------* 00460401
004605     EXEC SQL                                                     00460501
004606         DECLARE DIVERT_CSR CURSOR FOR                            00460601
004607             SELECT B.OPER_UNT_ID                                 00460701
004608                  , B.DOOR_ID                                     00460801
004609                  , B.DOOR_TYP_CDE                                00460901
004610                  , C.STR_NBR                                     00461001
004611                  , D.LOC_NM                                      00461101
004612                  , D.LOC_TYP_CDE                                 00461201
004613                  , COUNT(A.SHIPT_UNT_ID) AS DIVERT_COUNT         00461301
004614               FROM XLT_LOC X                                     00461417
004615                  , TSUCRDV A                                     00461517
004617                  , TCNDCDR B                                     00461701
004618                  , TCNDRST C                                     00461801
004619                  , XLT_LOC D                                     00461901
004622             WHERE  X.LOC_TYP_CDE  = 'DC'                         00462217
004623               AND X.OPN_DTE     <=  CURRENT DATE                 00462317
004624               AND X.CLO_DTE     >=  CURRENT DATE                 00462417
004625               AND X.LOC_NBR      =  A.OPER_UNT_ID                00462517
004628               AND A.DIVERT_TMST >= :DK-BEGIN-TMST                00462817
004629               AND A.DIVERT_TMST <= :DK-END-TMST                  00462917
004630               AND A.OPER_UNT_ID  =  B.OPER_UNT_ID                00463017
004631               AND A.DOOR_ID      =  B.DOOR_ID                    00463117
004632               AND B.DOOR_TYP_CDE IN ('SH','ST','SG','DS')        00463222
004634               AND B.OPER_UNT_ID  =  C.OPER_UNT_ID                00463422
004635               AND B.DOOR_ID      =  C.DOOR_ID                    00463522
004636               AND C.STRT_TMST   <=  A.DIVERT_TMST                00463622
004637               AND C.END_TMST    >=  A.DIVERT_TMST                00463722
004638               AND C.STR_NBR      =  D.LOC_NBR                    00463822
004639               AND A.DIVERT_TMST  IN                              00463922
004640                   (SELECT MAX(AA.DIVERT_TMST)                    00464022
004641                      FROM TSUCRDV AA                             00464122
004642                     WHERE A.SHIPT_UNT_ID  = AA.SHIPT_UNT_ID)     00464222
004643             GROUP BY B.OPER_UNT_ID                               00464301
004648                    , B.DOOR_ID                                   00464801
004649                    , B.DOOR_TYP_CDE                              00464901
004650                    , C.STR_NBR                                   00465001
004651                    , D.LOC_NM                                    00465101
004652                    , D.LOC_TYP_CDE                               00465201
004653             ORDER BY B.OPER_UNT_ID                               00465312
004654                    , B.DOOR_ID                                   00465401
004655                    , C.STR_NBR                                   00465501
004656                    , D.LOC_NM                                    00465601
004657                    , D.LOC_TYP_CDE                               00465701
004658                WITH UR                                           00465812
004670     END-EXEC.                                                    00467001
004671                                                                  00467101
004672******************************************************************00467201
004673 PROCEDURE DIVISION.                                              00467301
004674     DISPLAY '**** START OF SUKRP077 ****'.                       00467401
004675                                                                  00467501
004676*OPEN FILES.                                                      00467601
004677     OPEN INPUT  CONTROL-FILE                                     00467701
004678          OUTPUT REPORT-FILE.                                     00467801
004679                                                                  00467901
004680     PERFORM 1000-INITIALIZATION.                                 00468001
004681                                                                  00468101
004682     IF PS-END-OF-CURSOR                                          00468201
004690        ADD +1                  TO PV-PAGE-COUNT                  00469001
004691        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             00469101
004692        WRITE REPORT-RECORD                                       00469201
004693          FROM DP132O-STANDRD-HEADER-132-COLS                     00469301
004694            AFTER ADVANCING PAGE                                  00469401
004695        WRITE REPORT-RECORD                                       00469501
004696          FROM HEADING-LINE1                                      00469601
004697            AFTER ADVANCING 1 LINES                               00469701
004698        WRITE REPORT-RECORD                                       00469801
004699          FROM HEADING-LINE1A                                     00469901
004700            AFTER ADVANCING 1 LINES                               00470001
004710        WRITE REPORT-RECORD                                       00471001
004720          FROM HEADING-LINE2                                      00472001
004730            AFTER ADVANCING 1 LINE                                00473001
004740        WRITE REPORT-RECORD                                       00474001
004750          FROM NO-DATA-TO-REPORT-LINE                             00475001
004760            AFTER ADVANCING 2 LINES                               00476001
004770     ELSE                                                         00477001
004781         MOVE CNDCDR-OPER-UNT-ID TO  PV-PREV-OPER                 00478120
004790         PERFORM 8500-GET-LOCATION-NAME                           00479001
004791         PERFORM 1500-PRINT-HEADINGS                              00479101
004792         PERFORM 2000-PROCESS-INPUT                               00479201
004793           UNTIL PS-END-OF-CURSOR                                 00479301
004794         PERFORM 5020-PRINT-DC-TOTALS                             00479401
004795         PERFORM 4000-CREATE-TABLE-ENTRY                          00479501
004796         PERFORM 5030-PRINT-CORP-TOTALS                           00479601
004797     END-IF.                                                      00479701
004798                                                                  00479801
004799*FINISH REPORT.                                                   00479901
004800                                                                  00480001
004810     WRITE REPORT-RECORD                                          00481001
004820       FROM END-OF-REPORT-LINE                                    00482001
004830         AFTER ADVANCING 3 LINES.                                 00483001
004840                                                                  00484001
004841     PERFORM 8020-CLOSE-DIVERT-CSR.                               00484101
004842                                                                  00484201
004850*CLOSE FILES.                                                     00485001
004870     CLOSE CONTROL-FILE                                           00487001
004880           REPORT-FILE.                                           00488001
004890                                                                  00489001
004891     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 00489101
004892     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           00489201
004893                                                                  00489301
004894     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               00489401
004895     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        00489501
004896                                                                  00489601
004897     GOBACK.                                                      00489701
004898                                                                  00489801
004899******************************************************************00489901
004900*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *00490001
004910******************************************************************00491001
004920 1000-INITIALIZATION.                                             00492001
004930     ACCEPT SD-SYSTEM-DATE                                        00493001
004940       FROM DATE.                                                 00494001
004950                                                                  00495001
004960     ACCEPT SD-SYSTEM-TIME                                        00496001
004970       FROM TIME.                                                 00497001
004980                                                                  00498001
004990     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 00499001
004991     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   00499101
004992     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  00499201
004993     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  00499301
004994     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                00499401
004995                                                                  00499501
004996     MOVE PC-SUKRP077             TO DP132O-PROGRAM-NAME.         00499601
004997     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        00499701
004998     MOVE +0                      TO PV-PAGE-COUNT.               00499801
004999                                                                  00499901
005000     PERFORM 7010-READ-CONTROL-REC.                               00500001
005010     MOVE SU032-FROM-DATE    TO  REPORT-FROM-DATE                 00501001
005011                                 DK-BEGIN-DATE.                   00501101
005020     MOVE SU032-TO-DATE      TO  REPORT-TO-DATE                   00502001
005021                                 DK-END-DATE.                     00502101
005022     MOVE PC-DEFAULT-BEGIN   TO  DK-BEGIN-TIME.                   00502206
005024     MOVE PC-DEFAULT-END     TO  DK-END-TIME.                     00502406
005030                                                                  00503001
005040     SET SPT-INDEX TO 1.                                          00504001
005041                                                                  00504101
005042     SET  PS-NOT-END-OF-CURSOR  TO  TRUE.                         00504213
005043                                                                  00504316
005044     DISPLAY 'SUKRP077 - FROM:' DK-BEGIN-TMST                     00504416
005045     DISPLAY '           TO:  ' DK-END-TMST                       00504516
005046                                                                  00504616
005058     PERFORM 8000-OPEN-DIVERT-CSR.                                00505801
005059                                                                  00505901
005060     PERFORM 8010-FETCH-DIVERT-CSR.                               00506001
005061                                                                  00506101
005062******************************************************************00506201
005063**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  00506301
005070**  PAGES (AS NEEDED).                                            00507001
005080******************************************************************00508001
005090 1500-PRINT-HEADINGS.                                             00509001
005092     ADD +1                  TO PV-PAGE-COUNT.                    00509201
005093     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               00509301
005094                                                                  00509401
005095     MOVE REPORT-FROM-DATE   TO  HD1A-FROM-DATE.                  00509501
005096     MOVE REPORT-TO-DATE     TO  HD1A-TO-DATE.                    00509601
005097                                                                  00509701
005098     WRITE REPORT-RECORD                                          00509801
005099       FROM DP132O-STANDRD-HEADER-132-COLS                        00509901
005100         AFTER ADVANCING PAGE.                                    00510001
005101                                                                  00510101
005110     WRITE REPORT-RECORD                                          00511001
005120       FROM HEADING-LINE1                                         00512001
005130         AFTER ADVANCING 1 LINES.                                 00513001
005140                                                                  00514001
005150     WRITE REPORT-RECORD                                          00515001
005160       FROM HEADING-LINE1A                                        00516001
005170         AFTER ADVANCING 1 LINES.                                 00517001
005180                                                                  00518001
005190     WRITE REPORT-RECORD                                          00519001
005191       FROM HEADING-LINE2                                         00519101
005192         AFTER ADVANCING 1 LINE.                                  00519201
005193                                                                  00519301
005194     WRITE REPORT-RECORD                                          00519401
005195       FROM HEADING-LINE3                                         00519501
005196         AFTER ADVANCING 2 LINES.                                 00519601
005197                                                                  00519701
005198     WRITE REPORT-RECORD                                          00519801
005199       FROM HEADING-LINE4                                         00519901
005200         AFTER ADVANCING 1 LINES.                                 00520001
005300                                                                  00530001
005310     WRITE REPORT-RECORD                                          00531001
005320       FROM BLANK-LINE                                            00532001
005330         AFTER ADVANCING 1 LINE.                                  00533001
005340                                                                  00534001
005350     MOVE +05                TO PV-LINE-COUNT.                    00535001
005370                                                                  00537001
005380******************************************************************00538001
005390**  PROCESS CURSOR, WHEN DC CHANGES, DO A PAGE BREAK              00539005
005391******************************************************************00539101
005392 2000-PROCESS-INPUT.                                              00539201
005394     IF  CNDCDR-OPER-UNT-ID = PV-PREV-OPER                        00539401
005395         CONTINUE                                                 00539501
005396     ELSE                                                         00539601
005397         PERFORM 5020-PRINT-DC-TOTALS                             00539701
005398         PERFORM 4000-CREATE-TABLE-ENTRY                          00539801
005399         MOVE CNDCDR-OPER-UNT-ID TO  PV-PREV-OPER                 00539919
005410         PERFORM 8500-GET-LOCATION-NAME                           00541001
005500         PERFORM 1500-PRINT-HEADINGS                              00550001
005502     END-IF.                                                      00550201
005503                                                                  00550301
005504     ADD PV-DOOR-DIVERT-COUNT    TO  PV-DC-DIVERT-COUNT           00550409
005505                                     PV-CORP-DIVERT-COUNT.        00550509
005506                                                                  00550609
005509     PERFORM 5000-PRINT-DC-DOOR-TOTALS.                           00550901
005510                                                                  00551001
005511     PERFORM 8010-FETCH-DIVERT-CSR.                               00551109
005512                                                                  00551201
005520                                                                  00552001
007600****************************************************************  00760001
007700* CREATE INTERNAL TABLE WITH DC TOTALS                            00770001
007800****************************************************************  00780001
007900 4000-CREATE-TABLE-ENTRY.                                         00790001
008000                                                                  00800001
008100     IF  SPT-INDEX GREATER THAN PC-TABLE-MAX                      00810001
008200         MOVE '4000-CREATE-TABLE-ENTRY '  TO  PV-ABEND-PARAGRAPH  00820001
008300         SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX               00830001
008310         MOVE 'SUMMARY TABLE EXCEEDS MAXIMUM TABLE ENTRIES OF 150'00831001
008320                         TO PV-ERROR-MESSAGE-1                    00832001
008330         MOVE 'MAXIMUM TABLE SIZE NEEDS TO BE INCREASED'          00833001
008340                         TO PV-ERROR-MESSAGE-2                    00834001
008350         PERFORM 9998-ABEND                                       00835001
008351     END-IF.                                                      00835101
008352                                                                  00835201
008353     MOVE PV-PREV-OPER           TO  SPT-DC-NBR(SPT-INDEX).       00835301
008354     MOVE PV-DC-NAME             TO  SPT-DC-NAME(SPT-INDEX).      00835425
008356     MOVE PV-DC-DIVERT-COUNT     TO  SPT-DIVERT-COUNT(SPT-INDEX). 00835601
008358                                                                  00835801
008359     SET SPT-INDEX UP BY +1.                                      00835901
008360                                                                  00836001
008371     MOVE  ZEROES                TO  PV-DC-DIVERT-COUNT.          00837110
008373                                                                  00837301
008374                                                                  00837401
008375****************************************************************  00837501
008376* PRINT DC STORE TOTALS                                           00837601
008377****************************************************************  00837701
008378 5000-PRINT-DC-DOOR-TOTALS.                                       00837805
008400                                                                  00840001
008710     MOVE CNDCDR-OPER-UNT-ID    TO  DL1-DC-NBR                    00871005
008720     MOVE CNDCDR-DOOR-ID        TO  DL1-DOOR                      00872005
008721     MOVE CNDRST-STR-NBR        TO  DL1-STORE                     00872121
008722     MOVE XLT00010-LOC-NM       TO  DL1-STORE-NAME                00872221
008750     MOVE CNDCDR-DOOR-TYP-CDE   TO  DL1-LOC-TYPE-CDE              00875021
008751     EVALUATE TRUE                                                00875122
008752         WHEN CNDCDR-DOOR-TYP-CDE  =  'DS'                        00875222
008753              MOVE 'SHUTTLE DOOR '      TO  DL1-LOC-TYPE-DESC     00875322
008754         WHEN CNDCDR-DOOR-TYP-CDE  =  'ST'                        00875422
008755              MOVE 'STORAGE DOOR '      TO  DL1-LOC-TYPE-DESC     00875522
008756         WHEN CNDCDR-DOOR-TYP-CDE  =  'SH'                        00875622
008757              MOVE 'SHIPPING DOOR'      TO  DL1-LOC-TYPE-DESC     00875722
008758         WHEN CNDCDR-DOOR-TYP-CDE  =  'SG'                        00875822
008759              MOVE 'STRIPPING DOOR'     TO  DL1-LOC-TYPE-DESC     00875922
008760         WHEN OTHER                                               00876022
008761              MOVE CNDCDR-DOOR-TYP-CDE  TO  DL1-LOC-TYPE-DESC     00876122
008762     END-EVALUATE.                                                00876223
008763                                                                  00876323
008770     MOVE PV-DOOR-DIVERT-COUNT  TO  DL1-DIVERT-COUNT              00877005
008800                                                                  00880001
008900     WRITE REPORT-RECORD                                          00890001
009000       FROM DETAIL-LINE1                                          00900001
009100         AFTER ADVANCING 1 LINES.                                 00910001
009200                                                                  00920001
009300     ADD  1                  TO PV-LINE-COUNT.                    00930001
009400     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        00940001
009500         PERFORM 1500-PRINT-HEADINGS                              00950001
009600     END-IF.                                                      00960001
009700                                                                  00970001
009800****************************************************************  00980001
009900* PRINT DC TOTALS                                                 00990001
010000****************************************************************  01000001
010100 5020-PRINT-DC-TOTALS.                                            01010001
010200                                                                  01020001
010300     MOVE PV-PREV-OPER                 TO  TL1-DC-NBR.            01030001
010400     MOVE PV-DC-NAME                   TO  TL1-DC-NAME.           01040025
010600     MOVE PV-DC-DIVERT-COUNT           TO  TL1-DIVERT-COUNT.      01060001
010800                                                                  01080001
010900     WRITE REPORT-RECORD                                          01090001
011000       FROM TOTAL-LINE1                                           01100001
011100         AFTER ADVANCING 2 LINES.                                 01110001
011200                                                                  01120001
011300                                                                  01130001
011400****************************************************************  01140001
011500* PRINTS CORPORATE TOTAL                                       *  01150001
011600****************************************************************  01160001
011700 5030-PRINT-CORP-TOTALS.                                          01170001
011800                                                                  01180001
011900     MOVE 9999                  TO  HD2-OPER-UNT-ID.              01190001
012000     MOVE 'CORPORATE TOTALS'    TO  HD2-DC-NAME.                  01200001
012100                                                                  01210001
012200     PERFORM 1500-PRINT-HEADINGS.                                 01220001
012300                                                                  01230001
012400     SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX                   01240001
012500                                                                  01250001
012600*    THIS IS A WIDGET TO FIX THE INDEX SO THAT IT POINTS TO       01260001
012700*    THE LAST VALID LINE IN THE REPORT.                           01270001
012800     SUBTRACT 1 FROM PC-ACTUAL-TABLE-ENTRIES                      01280001
012900                                                                  01290001
012910     PERFORM 5200-SUMMARY-DETAIL                                  01291001
012920             VARYING SPT-INDEX FROM 1 BY 1                        01292001
012930             UNTIL SUMMARY-TABLE-EOF.                             01293001
012940                                                                  01294001
012941     MOVE ZEROES                       TO  TL1-DC-NBR.            01294101
012942     MOVE 'CORPORATE TOTAL'            TO  TL1-DC-NAME.           01294201
012944     MOVE PV-CORP-DIVERT-COUNT         TO  TL1-DIVERT-COUNT.      01294401
012946                                                                  01294601
012947     WRITE REPORT-RECORD                                          01294701
012948       FROM TOTAL-LINE1                                           01294801
012949         AFTER ADVANCING 2 LINES.                                 01294901
012950                                                                  01295001
012951                                                                  01295101
012952 5200-SUMMARY-DETAIL.                                             01295201
012954                                                                  01295401
012955     MOVE SPT-DC-NBR(SPT-INDEX)        TO  TL1-DC-NBR.            01295501
012956     MOVE SPT-DC-NAME(SPT-INDEX)       TO  TL1-DC-NAME.           01295601
012957     MOVE SPT-DIVERT-COUNT(SPT-INDEX)  TO  TL1-DIVERT-COUNT.      01295701
012959                                                                  01295901
012960     WRITE REPORT-RECORD                                          01296001
012970       FROM TOTAL-LINE1                                           01297001
012971         AFTER ADVANCING 2 LINES.                                 01297101
012972                                                                  01297201
012973                                                                  01297301
012974     IF SPT-INDEX  =  PC-ACTUAL-TABLE-ENTRIES                     01297401
012975        SET SUMMARY-TABLE-EOF TO TRUE.                            01297501
012976                                                                  01297601
012977                                                                  01297701
012978****************************************************************  01297801
012979* PRINTS A BLANK LINE                                          *  01297901
012980****************************************************************  01298001
012990 6000-PRINT-BLANK-LINE.                                           01299001
013000                                                                  01300001
013010        WRITE REPORT-RECORD                                       01301001
013011          FROM BLANK-LINE                                         01301101
013012            AFTER ADVANCING 1 LINE                                01301201
013013                                                                  01301301
013014     ADD +1 TO PV-LINE-COUNT.                                     01301401
013015                                                                  01301501
013028*-----------------------------------------------------------------01302801
013029*  READ DATE CONTROL RECORD                                       01302901
013030*-----------------------------------------------------------------01303001
013031 7010-READ-CONTROL-REC.                                           01303101
013033                                                                  01303301
013034     MOVE SPACES  TO  SU032-DATE-CONTROL-REC.                     01303401
013035                                                                  01303501
013036     READ CONTROL-FILE     INTO                                   01303601
013037           SU032-DATE-CONTROL-REC                                 01303701
013038     AT END                                                       01303801
013039         DISPLAY 'PROGRAM:  SUKRP077'                             01303901
013040         DISPLAY 'NO DATE CONTROL CARD'                           01304001
013041         DISPLAY SPACES                                           01304101
013050     NOT AT END                                                   01305001
013060         DISPLAY 'PROGRAM:  SUKRP077'                             01306001
013070         DISPLAY 'DATE CONTROL CARD:'                             01307001
013080                 SU032-DATE-CONTROL-REC                           01308001
013090         DISPLAY SPACES                                           01309001
013091     END-READ.                                                    01309101
013092                                                                  01309201
013093                                                                  01309301
013094*-----------------------------------------------------------------01309401
013095*  OPEN DIVERT CURSOR                                             01309501
013096*-----------------------------------------------------------------01309601
013097 8000-OPEN-DIVERT-CSR.                                            01309701
013099                                                                  01309901
013100     EXEC SQL                                                     01310001
013101         OPEN DIVERT_CSR                                          01310101
013102     END-EXEC.                                                    01310201
013103                                                                  01310301
013104     MOVE SQLCODE TO PV-SQLCODE                                   01310415
013106                                                                  01310615
013107     EVALUATE TRUE                                                01310701
013108         WHEN SQLCODE = ZERO                                      01310801
013109             CONTINUE                                             01310901
013110         WHEN OTHER                                               01311001
013111             MOVE SQLCODE TO PV-SQLCODE                           01311101
013112             MOVE '8000-OPEN-DIVERT-CSR' TO PV-ABEND-PARAGRAPH    01311205
013113             STRING 'SQL ERROR - '                                01311301
013114                     PV-SQLCODE ' - '                             01311401
013115                     DK-BEGIN-TMST                                01311501
013116                     DK-END-TMST                                  01311601
013117                          DELIMITED BY SIZE                       01311701
013118                     INTO PV-ABEND-OPERATION                      01311805
013119             PERFORM 9999-ABEND                                   01311905
013120     END-EVALUATE.                                                01312001
013121                                                                  01312101
013122                                                                  01312201
013123*-----------------------------------------------------------------01312301
013124*  FETCH DIVERT CURSOR                                            01312401
013125*-----------------------------------------------------------------01312501
013126 8010-FETCH-DIVERT-CSR.                                           01312601
013128                                                                  01312801
013129     EXEC SQL                                                     01312901
013130         FETCH  DIVERT_CSR                                        01313001
013131          INTO :CNDCDR-OPER-UNT-ID                                01313101
013132             , :CNDCDR-DOOR-ID                                    01313201
013133             , :CNDCDR-DOOR-TYP-CDE                               01313301
013134             , :CNDRST-STR-NBR                                    01313402
013135             , :XLT00010-LOC-NM                                   01313501
013136             , :XLT00010-LOC-TYP-CDE                              01313601
013137             , :PV-DOOR-DIVERT-COUNT                              01313701
013138     END-EXEC.                                                    01313801
013139                                                                  01313901
013140     EVALUATE TRUE                                                01314001
013141         WHEN SQLCODE = ZERO                                      01314101
013142             CONTINUE                                             01314201
013143         WHEN SQLCODE = +100                                      01314301
013144              SET  PS-END-OF-CURSOR  TO  TRUE                     01314401
013145         WHEN OTHER                                               01314501
013146             MOVE SQLCODE TO PV-SQLCODE                           01314601
013147             MOVE '8010-FETCH-DIVERT-CSR' TO PV-ABEND-PARAGRAPH   01314705
013148             STRING 'SQL ERROR - '                                01314801
013149                     PV-SQLCODE ' - '                             01314901
013150                     DK-BEGIN-TMST                                01315001
013151                     DK-END-TMST                                  01315101
013152                          DELIMITED BY SIZE                       01315201
013153                     INTO PV-ABEND-OPERATION                      01315305
013154             PERFORM 9999-ABEND                                   01315405
013155     END-EVALUATE.                                                01315501
013156                                                                  01315601
013157                                                                  01315701
013161*-----------------------------------------------------------------01316101
013162*  CLOSE DIVERT CURSOR                                            01316201
013163*-----------------------------------------------------------------01316301
013164 8020-CLOSE-DIVERT-CSR.                                           01316401
013166                                                                  01316601
013167     EXEC SQL                                                     01316701
013168         CLOSE DIVERT_CSR                                         01316801
013169     END-EXEC.                                                    01316901
013170                                                                  01317001
013171     EVALUATE TRUE                                                01317101
013172         WHEN SQLCODE = ZERO                                      01317201
013173             CONTINUE                                             01317301
013174         WHEN OTHER                                               01317401
013175             MOVE SQLCODE TO PV-SQLCODE                           01317501
013176             MOVE '8020-CLOSE-DIVERT-CSR' TO PV-ABEND-PARAGRAPH   01317605
013177             STRING 'SQL ERROR - '                                01317701
013178                     PV-SQLCODE ' - '                             01317801
013179                     DK-BEGIN-TMST                                01317901
013180                     DK-END-TMST                                  01318001
013181                          DELIMITED BY SIZE                       01318101
013182                     INTO PV-ABEND-OPERATION                      01318205
013183             PERFORM 9999-ABEND                                   01318305
013184     END-EVALUATE.                                                01318401
013185                                                                  01318501
013186                                                                  01318601
013187******************************************************************01318701
013188 8500-GET-LOCATION-NAME.                                          01318801
013189******************************************************************01318901
013191                                                                  01319101
013192     MOVE PV-PREV-OPER         TO  XLT00010-LOC-NBR               01319222
013193                                   PV-DISPLAY-OPER.               01319301
013194                                                                  01319401
013195     EXEC SQL                                                     01319501
013200         SELECT   LOC_NM                                          01320001
013300           INTO  :PV-DC-NAME                                      01330025
013400           FROM   XLT_LOC                                         01340001
013500          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   01350001
013600     END-EXEC.                                                    01360001
013700                                                                  01370001
013800     EVALUATE TRUE                                                01380001
013900         WHEN SQLCODE = +0                                        01390001
014000              MOVE PV-PREV-OPER        TO HD2-OPER-UNT-ID         01400022
014100              MOVE PV-DC-NAME          TO HD2-DC-NAME             01410025
014200         WHEN OTHER                                               01420001
014300              CONTINUE                                            01430001
014400     END-EVALUATE.                                                01440001
014500                                                                  01450001
014510                                                                  01451022
014600******************************************************************01460001
014700*  ABEND ROUTINE                                                 *01470001
014710******************************************************************01471001
014720 9900-DB2-ABEND.                                                  01472001
014730                                                                  01473001
014740     MOVE SQLCODE TO PV-SQLCODE.                                  01474001
014750     DISPLAY '*** DB2 ERROR '.                                    01475001
014760     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       01476001
014770     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 01477001
014780     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               01478001
014790     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               01479001
014800     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       01480001
014810     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       01481001
014820     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME-1.              01482001
014830     DISPLAY '*** TABLE 2   = ' PV-DB2-TABLE-NAME-2.              01483001
014840                                                                  01484001
014850     COPY DPPD004.                                                01485001
014860                                                                  01486001
014870     MOVE +4013 TO PV-ABEND-CODE.                                 01487001
014880     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         01488001
014890                                                                  01489001
014891 9998-ABEND.                                                      01489101
014893                                                                  01489301
014894     DISPLAY '***************'.                                   01489401
014895     DISPLAY '** ABEND     **'.                                   01489501
014896     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               01489601
014897     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             01489701
014898     DISPLAY '***************'.                                   01489801
014899                                                                  01489901
014900     MOVE +4008                  TO PV-ABEND-CODE.                01490001
014901     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         01490101
014910                                                                  01491001
014920 9999-ABEND.                                                      01492001
014930                                                                  01493001
014940     DISPLAY '***************'.                                   01494001
014950     DISPLAY '** ABEND     **'.                                   01495001
014960     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               01496001
014961     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             01496101
014962     DISPLAY '** MESSAGE 1 ** = ' PV-ERROR-MESSAGE-1.             01496201
014963     DISPLAY '** MESSAGE 2 ** = ' PV-ERROR-MESSAGE-2.             01496301
014964     DISPLAY '***************'.                                   01496401
014965                                                                  01496501
014966     MOVE +4008                  TO PV-ABEND-CODE.                01496601
014967     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         01496701
014968                                                                  01496801
014969******************************************************************01496901
014970*                 E N D   O F   P R O G R A M                    *01497001
014980******************************************************************01498001
014990***************************************************************** 01499001
