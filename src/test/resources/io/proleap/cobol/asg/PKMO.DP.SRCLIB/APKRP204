000100 IDENTIFICATION DIVISION.                                         00010014
000200 PROGRAM-ID.     APKRP204.                                        00020014
000300 AUTHOR.         M WILKINSON.                                     00030014
000400*DATE-WRITTEN.   MAY 20, 1994.                                    00040014
000500*DATE-COMPILED.                                                   00050014
000600****************************************************************  00060038
000700* COBOL 2                                                      *  00070038
000800*--------------------------------------------------------------*  00080038
000900* EDI REJECTION REPORT PROGRAM                                 *  00090038
001000*--------------------------------------------------------------*  00100038
001100* CHANGE LOG:                                                  *  00110038
001200*                                                              *  00120038
001300* 08/29/94    BY MARILYN WILKINSON                             *  00130038
001400*             CHANGED PROGRAM TO ACCOMODATE A PRE-PRODUCTION   *  00140038
001500*             VERSION                                          *  00150038
001600* 12/15/97    BY MIKE BESKE                      WR #: 5091    *  00160038
001700*             CHANGED '++INCLUDE' TO 'COPY' AS PART OF THE     *  00170038
001800*             Y2K SPECS.                                       *  00180038
001900*                                                              *  00190038
002000* 01/24/2000  BY JILL JUEL                   WR# 20675         *  00200038
002100*             CHANGED THE ERROR MESSAGES TO MAKE THEM MORE     *  00210038
002200*             USER FRIENDLY AND DISPLAY THE INVALID FIELD      *  00220038
002300*             WITH THE MESSAGE (ADDED ROUTINE Y100).           *  00230038
002400*                                                              *  00240038
002500* 02/01/2000  BY JILL JUEL                   WR# 20724         *  00250038
002600*             ADDED AP050-SAVE-INTERCHG-CNTL-NBR (ALSO         *  00260038
002700*             KNOWN AS THE ISA NUMBER) TO THE REPORT.          *  00270038
002800*                                                              *  00280038
002900* 02/02/2000 JILL JUEL                      WR#: 20626         *  00290038
003000*            - RECOMPILED PROGRAM. CHANGES WERE MADE TO        *  00300038
003100*              APRD050, APRD051, APRD052, AND APRD056 BY       *  00310038
003200*              THE EDI TEAM.                                   *  00320038
003300*                                                              *  00330038
003400* 08/08/2002 COLBY HANGER EXPENSE PROCESSING.  RECOMPILE FROM  *  00340038
003500*            PRODUCTION TO INCORPORATE COPYBOOK CHANGES.       *  00350038
003600*        BY: KEVIN CATLIN                   WR#: 23254         *  00360038
003700*                                                              *  00370038
003800*  DATE  05/08/2003                                            *  00380038
003900*      CHANGE MADE: CHANGE NEEDED FOR ARK PO NI-SKU.           *  00390038
004000*      REMOVED ALL REFERENCES FOR AP051-DEPT-NBR, AP051-CLASS, *  00400038
004100*      AP051-SKU-SEQ AND REPLACED WITH AP051-KOHLS-SKU.        *  00410038
004200*      MADE BY: ROLLIN KRING            WR/IR #: WR22557       *  00420038
004300*                                                              *  00430038
004400*  DATE  07/10/2003                                            *  00440038
004500*      CHANGE MADE: COMPOUND PREPACK EDI PROJECT               *  00450038
004600*      ADDED CODE TO HANDLE THE WARNING MESSAGES FROM THE      *  00460038
004700*      DETAIL RECORD 07 THAT HAS PACK HEADER DATA.             *  00470038
004800*      MADE BY: MIKE BESKE              WR/IR #: WR24658       *  00480038
004900*                                                              *  00490038
005000*  DATE  08/12/2003                                            *  00500038
005100*      CHANGE MADE: CORRECTED WHERE THE MOVE OF AP051-PK-      *  00510038
005200*      ITEM-SUMD-COST IS MOVED TO TYPE7-PK-ITEM-SUMD-COST      *  00520038
005300*      TO CORRECT SOC7 ABEND.                                  *  00530038
005400*      MADE BY: MIKE BESKE              WR/IR #: P000574638    *  00540038
005500*                                                              *  00550038
005600*  DATE  10/03/2003                                            *  00560038
005700*      CHANGE MADE: RECOMPILED TO PICK UP THE CHANGE TO THE    *  00570038
005800*      APWS050 COPYBOOK.                                       *  00580038
005900*      MADE BY: MIKE BESKE              WR/IR #: WR25850       *  00590038
006000*                                                              *  00600038
006100*  DATE  03/29/2004                                            *  00610038
006200*      CHANGE MADE: INCREASED THE SIZE FOR THE STORE NUMBERS   *  00620038
006300*      IN TYPE2-LINE2 FROM 3 TO 5.                             *  00630038
006400*      MADE BY: MIKE BESKE              WR/IR #: WR25805       *  00640038
006500*                                                              *  00650038
006600*  DATE  04/23/2007                                            *  00660041
006700*      CHANGE MADE: MODIFIED THE 'WHEN 18' OF THE EVALUATE     *  00670038
006800*      STATEMENT IN PARAGRAPH Y100-PROCESS-ERROR-MSG BY        *  00680038
006900*      REPLACING THE TYPE5-ALLW-CHRG-MTHD WITH HL2-PO-NBR.     *  00690038
007000*      MADE BY: KRYSTEN LEARY           WR/IR #: WR26018       *  00700038
007100*                                                              *  00710042
007200*  DATE  05/16/2007                                            *  00720042
007300*      CHANGE MADE: RECOMPILED TO PICK UP APWS050 MODIFICATION.*  00730042
007400*      MADE BY: MIKE BESKE              WR/IR #: P001021023    *  00740042
007500*                                                              *  00750045
007600*  DATE  12/19/2007                                            *  00760045
007700*      CHANGE MADE: EDI INVOICE LINE CONTROL                   *  00770045
007800*      ADDED CODE TO DISPLAY THE TOTAL INVOICE LINES COUNT     *  00780045
007900*      AS PART OF THE ERROR CODE 75 MESSAGE.  NEW PARA C650-   *  00790045
008000*      MOD PARA Y100-.  ALSO ADDED NUMEROUS MISSING END-IF STMT*  00800045
008100*      THROUGHOUT THE PROGRAM.                                 *  00810045
008200*      MADE BY: MIKE BESKE              WR/IR #: WR31187       *  00820045
008300*                                                              *  00821047
008400*  DATE  10/17/2014                                            *  00822047
008500*      CHANGE MADE: PO EXTENDED DIGIT CHANGES.                 *  00823047
008600*      EXTENDED PO# FROM 7 TO 9                                *  00824047
008700*      MADE BY: COGNIZANT               WR/IR #: CHG0094517    *  00825047
030001*                                                               * 00825151
029700*   DATE  03/16/2023                                            * 00825254
029800*   CHANGE MADE: RECOMPILE FOR UPDATED COPYBOOKS APWS050 AND    * 00825353
030000*                APRD051                                        * 00825453
030000*      MADE BY: JEAN KURK               WR/IR #: CHG0285404     * 00825554
030001*                                                               * 00825653
008702****************************************************************  00830038
008703                                                                  00840038
008704 ENVIRONMENT DIVISION.                                            00850014
008705 CONFIGURATION SECTION.                                           00860014
008706                                                                  00870014
008800 SOURCE-COMPUTER. IBM-3090.                                       00880014
008900 OBJECT-COMPUTER. IBM-3090.                                       00890014
009000                                                                  00900014
009100 INPUT-OUTPUT SECTION.                                            00910014
009200 FILE-CONTROL.                                                    00920014
009300                                                                  00930014
009400      SELECT EDI-REJ-FILE       ASSIGN TO INP01.                  00940014
009500                                                                  00950014
009600      SELECT EDI-REPORT         ASSIGN TO RPT01.                  00960038
009700                                                                  00970014
009800      SELECT EDI-SUMM-REPORT    ASSIGN TO RPT02.                  00980038
009900                                                                  00990014
010000 DATA DIVISION.                                                   01000014
010100 FILE SECTION.                                                    01010014
010200                                                                  01020014
010300 FD  EDI-REJ-FILE                                                 01030014
010400     RECORDING MODE IS F                                          01040014
010500     LABEL RECORDS ARE STANDARD                                   01050014
010600     BLOCK CONTAINS 0 RECORDS                                     01060014
010700     DATA RECORD IS EDI-RECORD.                                   01070014
010800 01  EDI-RECORD                  PIC X(500).                      01080014
010900                                                                  01090014
011000 FD  EDI-REPORT                                                   01100014
011100     RECORDING MODE IS F                                          01110014
011200     LABEL RECORDS ARE STANDARD                                   01120014
011300     RECORD CONTAINS 132 CHARACTERS                               01130014
011400     BLOCK CONTAINS 0 RECORDS                                     01140014
011500     DATA RECORD IS EDI-LINE.                                     01150014
011600 01  EDI-LINE                    PIC X(132).                      01160014
011700                                                                  01170014
011800 FD  EDI-SUMM-REPORT                                              01180014
011900     RECORDING MODE IS F                                          01190014
012000     LABEL RECORDS ARE STANDARD                                   01200014
012100     RECORD CONTAINS 132 CHARACTERS                               01210014
012200     BLOCK CONTAINS 0 RECORDS                                     01220014
012300     DATA RECORD IS EDI-SUMM-LINE.                                01230014
012400 01  EDI-SUMM-LINE               PIC X(132).                      01240014
012500                                                                  01250014
012600 WORKING-STORAGE SECTION.                                         01260014
012700*--------------------------------------------------------------*  01270038
012800* STANDARD HEADER 132 COLUMNS.  COPY DPWS132O                  *  01280038
012900*--------------------------------------------------------------*  01290038
013000     COPY DPWS132O.                                               01300014
013100                                                                  01310038
013200*--------------------------------------------------------------*  01320038
013300* ERROR MESSAGE CODES DESCRIPTIONS                             *  01330038
013400*--------------------------------------------------------------*  01340038
013500     COPY APWS050.                                                01350014
013600                                                                  01360038
013700*--------------------------------------------------------------*  01370038
013800* EDI REJECTION REPORT FILE LAYOUT                             *  01380038
013900*--------------------------------------------------------------*  01390038
014000 01  WS-EDI-REJECT-REC.                                           01400014
014100     COPY APRD051.                                                01410014
014200                                                                  01420038
014300 01  DIVIDE-LINE.                                                 01430014
014400     05  FILLER                  PIC X(25)    VALUE               01440014
014500         '-------------------------'.                             01450014
014600     05  FILLER                  PIC X(25)    VALUE               01460014
014700         '-------------------------'.                             01470014
014800     05  FILLER                  PIC X(25)    VALUE               01480014
014900         '-------------------------'.                             01490014
015000     05  FILLER                  PIC X(25)    VALUE               01500014
015100         '-------------------------'.                             01510014
015200     05  FILLER                  PIC X(25)    VALUE               01520014
015300         '-------------------------'.                             01530014
015400     05  FILLER                  PIC X(07)    VALUE               01540014
015500         '-      '.                                               01550014
015600                                                                  01560014
015700 01  END-OF-INVOICE-LINE.                                         01570014
015800     05  FILLER                  PIC X(07)     VALUE SPACES.      01580014
015900     05  FILLER                  PIC X(27)     VALUE              01590014
016000             'E N D   O F   I N V O I C E'.                       01600014
016100     05  FILLER                  PIC X(98)     VALUE SPACES.      01610014
016200                                                                  01620014
016300 01  EOR-END-OF-REPORT-LINE.                                      01630014
016400     05  FILLER                  PIC X(37)     VALUE SPACES.      01640014
016500     05  FILLER                  PIC X(25)     VALUE              01650014
016600             'E N D   O F   R E P O R T'.                         01660014
016700     05  FILLER                  PIC X(88)     VALUE SPACES.      01670014
016800                                                                  01680038
016900*--------------------------------------------------------------*  01690038
017000* REPORT ERROR LINES                                           *  01700038
017100*--------------------------------------------------------------*  01710038
017200 01  ERROR-DESC-LINE.                                             01720014
017300     05  FILLER                  PIC X(08)    VALUE               01730014
017400         'ERRORS: '.                                              01740014
017500     05  FILLER                  PIC X(119)   VALUE SPACES.       01750014
017600     05  FILLER                  PIC X(005)   VALUE '*****'.      01760014
017700                                                                  01770014
017800 01  ERROR-LINE.                                                  01780014
017900     05  ERROR-LINE-AREA.                                         01790014
018000         10  ERROR-LINE-TBL      OCCURS 2 TIMES                   01800014
018100                                 INDEXED BY ERRLN-INDX.           01810014
018200             15  ERR-ASTR-1      PIC X(01).                       01820014
018300             15  ERR-NMBR        PIC X(02).                       01830014
018400             15  ERR-ASTR-2      PIC X(01).                       01840014
018500             15  FILLER          PIC X(01).                       01850014
018600             15  ERR-DATA        PIC X(55).                       01860014
018700             15  FILLER          PIC X(03).                       01870014
018800         10  FILLER              PIC X(12)    VALUE SPACES.       01880014
018900                                                                  01890014
019000*--------------------------------------------------------------*  01900038
019100* REPORT DETAIL LINES                                          *  01910038
019200*--------------------------------------------------------------*  01920038
019300 01  TYPE1-LINE.                                                  01930014
019400     05  FILLER                  PIC X(32)    VALUE               01940014
019500         'TYPE: 01  INTERCHANGE DATA      '.                      01950014
019600     05  FILLER                  PIC X(100)   VALUE SPACES.       01960014
019700 01  TYPE1-LINE2.                                                 01970014
019800     05  FILLER                  PIC X(25)    VALUE               01980014
019900         'EDI SENDER ID QUALIFIER: '.                             01990014
020000     05  TYPE1-SEND-ID-QUAL      PIC X(02)    VALUE SPACES.       02000014
020100     05  FILLER                  PIC X(04)    VALUE SPACES.       02010014
020200     05  FILLER                  PIC X(15)    VALUE               02020014
020300         'EDI SENDER ID: '.                                       02030014
020400     05  TYPE1-SENDER-ID         PIC X(15)    VALUE SPACES.       02040014
020500     05  FILLER                  PIC X(04)    VALUE SPACES.       02050014
020600     05  FILLER                  PIC X(10)    VALUE               02060014
020700         'EDI TYPE: '.                                            02070014
020800     05  TYPE1-PROD-TEST         PIC X(01)    VALUE SPACES.       02080014
020900     05  FILLER                  PIC X(56)    VALUE SPACES.       02090014
021000 01  TYPE1-LINE3.                                                 02100014
021100     05  FILLER                  PIC X(15)    VALUE               02110014
021200         'INTERCHG DATE: '.                                       02120014
021300     05  TYPE1-INTERCHG-YY       PIC X(02)    VALUE SPACES.       02130014
021400     05  FILLER                  PIC X(01)    VALUE '/'.          02140014
021500     05  TYPE1-INTERCHG-MM       PIC X(02)    VALUE SPACES.       02150014
021600     05  FILLER                  PIC X(01)    VALUE '/'.          02160014
021700     05  TYPE1-INTERCHG-DD       PIC X(02)    VALUE SPACES.       02170014
021800     05  FILLER                  PIC X(04)    VALUE SPACES.       02180014
021900     05  FILLER                  PIC X(06)    VALUE 'TIME: '.     02190014
022000     05  FILLER                  PIC X(01)    VALUE SPACE.        02200014
022100     05  TYPE1-HH                PIC X(02)    VALUE SPACES.       02210014
022200     05  FILLER                  PIC X(01)    VALUE ':'.          02220014
022300     05  TYPE1-MM                PIC X(02)    VALUE SPACES.       02230014
022400     05  FILLER                  PIC X(04)    VALUE SPACES.       02240014
022500     05  FILLER                  PIC X(19)    VALUE               02250014
022600         'INTERCHG CNTL NBR: '.                                   02260014
022700     05  TYPE1-INTERCHG-CNTL     PIC X(09)    VALUE SPACES.       02270014
022800     05  FILLER                  PIC X(02)    VALUE SPACES.       02280014
022900     05  FILLER                  PIC X(13)    VALUE               02290014
023000         'GS CNTL NBR: '.                                         02300014
023100     05  TYPE1-GS-NBR            PIC X(09)    VALUE SPACES.       02310014
023200     05  FILLER                  PIC X(02)    VALUE SPACES.       02320014
023300     05  FILLER                  PIC X(13)    VALUE               02330014
023400         'TS CNTL NBR: '.                                         02340014
023500     05  TYPE1-TS-NBR            PIC X(09)    VALUE SPACES.       02350014
023600     05  FILLER                  PIC X(15)    VALUE SPACES.       02360014
023700                                                                  02370014
023800 01  TYPE2-LINE.                                                  02380014
023900     05  FILLER                  PIC X(32)    VALUE               02390014
024000         'TYPE: 02  INVOICE DATA          '.                      02400014
024100     05  FILLER                  PIC X(100)   VALUE SPACES.       02410014
024200 01  TYPE2-LINE2.                                                 02420014
024300     05  FILLER                  PIC X(11)    VALUE               02430014
024400         'STORE NO1: '.                                           02440014
024500     05  TYPE2-STORE-NBR1        PIC X(05)    VALUE SPACES.       02450034
024600     05  FILLER                  PIC X(04)    VALUE SPACES.       02460034
024700     05  FILLER                  PIC X(11)    VALUE               02470014
024800         'STORE NO2: '.                                           02480014
024900     05  TYPE2-STORE-NBR2        PIC X(05)    VALUE SPACES.       02490034
025000     05  FILLER                  PIC X(04)    VALUE SPACES.       02500034
025100     05  FILLER                  PIC X(19)    VALUE               02510014
025200         'LADING CARRIER ID: '.                                   02520014
025300     05  TYPE2-LAD-CARR          PIC X(16)    VALUE SPACES.       02530014
025400     05  FILLER                  PIC X(57)    VALUE SPACES.       02540014
025500                                                                  02550014
025600 01  TYPE2-LINE3.                                                 02560014
025700     05  FILLER                  PIC X(14)    VALUE               02570014
025800         'INVOICE DATE: '.                                        02580014
025900     05  TYPE2-INV-YY            PIC X(02)    VALUE SPACES.       02590014
026000     05  FILLER                  PIC X(01)    VALUE '/'.          02600014
026100     05  TYPE2-INV-MM            PIC X(02)    VALUE SPACES.       02610014
026200     05  FILLER                  PIC X(01)    VALUE '/'.          02620014
026300     05  TYPE2-INV-DD            PIC X(02)    VALUE SPACES.       02630014
026400     05  FILLER                  PIC X(06)    VALUE SPACES.       02640014
026500     05  FILLER                  PIC X(14)    VALUE               02650014
026600         'DATE SHIPPED: '.                                        02660014
026700     05  TYPE2-SHP-YY            PIC X(02)    VALUE SPACES.       02670014
026800     05  FILLER                  PIC X(01)    VALUE '/'.          02680014
026900     05  TYPE2-SHP-MM            PIC X(02)    VALUE SPACES.       02690014
027000     05  FILLER                  PIC X(01)    VALUE '/'.          02700014
027100     05  TYPE2-SHP-DD            PIC X(02)    VALUE SPACES.       02710014
027200     05  FILLER                  PIC X(06)    VALUE SPACES.       02720014
027300     05  FILLER                  PIC X(16)    VALUE               02730014
027400         'EFFECTIVE DATE: '.                                      02740014
027500     05  TYPE2-EFF-YY            PIC X(02)    VALUE SPACES.       02750014
027600     05  FILLER                  PIC X(01)    VALUE '/'.          02760014
027700     05  TYPE2-EFF-MM            PIC X(02)    VALUE SPACES.       02770014
027800     05  FILLER                  PIC X(01)    VALUE '/'.          02780014
027900     05  TYPE2-EFF-DD            PIC X(02)    VALUE SPACES.       02790014
028000     05  FILLER                  PIC X(52)    VALUE SPACES.       02800014
028100                                                                  02810014
028200 01  TYPE3-LINE.                                                  02820014
028300     05  FILLER                  PIC X(32)    VALUE               02830014
028400         'TYPE: 03  REMIT INSTRUCTIONS    '.                      02840014
028500     05  FILLER                  PIC X(100)   VALUE SPACES.       02850014
028600 01  TYPE3-LINE2.                                                 02860014
028700     05  FILLER                  PIC X(22)    VALUE               02870014
028800         'REMIT VENDOR DUNS NO: '.                                02880014
028900     05  TYPE3-DUNS-NBR          PIC X(09)    VALUE SPACES.       02890014
029000     05  FILLER                  PIC X(03)    VALUE SPACES.       02900014
029100     05  FILLER                  PIC X(15)    VALUE               02910014
029200         'REMIT TO NAME: '.                                       02920014
029300     05  TYPE3-NAME              PIC X(25)    VALUE SPACES.       02930014
029400     05  FILLER                  PIC X(58)    VALUE SPACES.       02940014
029500 01  TYPE3-LINE3.                                                 02950014
029600     05  FILLER                  PIC X(40)    VALUE SPACES.       02960014
029700     05  FILLER                  PIC X(09)    VALUE               02970014
029800         'ADDRESS: '.                                             02980014
029900     05  TYPE3-ADDR1             PIC X(25)    VALUE SPACES.       02990014
030000     05  FILLER                  PIC X(58)    VALUE SPACES.       03000014
030100 01  TYPE3-LINE4.                                                 03010014
030200     05  FILLER                  PIC X(40)    VALUE SPACES.       03020014
030300     05  FILLER                  PIC X(09)    VALUE               03030014
030400         '         '.                                             03040014
030500     05  TYPE3-ADDR2             PIC X(25)    VALUE SPACES.       03050014
030600     05  FILLER                  PIC X(58)    VALUE SPACES.       03060014
030700 01  TYPE3-LINE5.                                                 03070014
030800     05  FILLER                  PIC X(49)    VALUE SPACES.       03080014
030900     05  TYPE3-CITY              PIC X(19)    VALUE SPACES.       03090014
031000     05  FILLER                  PIC X(03)    VALUE SPACES.       03100014
031100     05  TYPE3-STATE             PIC X(02)    VALUE SPACES.       03110014
031200     05  FILLER                  PIC X(01)    VALUE SPACE.        03120014
031300     05  TYPE3-ZIP-5             PIC X(05)    VALUE SPACES.       03130014
031400     05  FILLER                  PIC X(01)    VALUE '-'.          03140014
031500     05  TYPE3-ZIP-4             PIC X(04)    VALUE SPACES.       03150014
031600     05  FILLER                  PIC X(58)    VALUE SPACES.       03160014
031700                                                                  03170014
031800 01  TYPE4-LINE.                                                  03180014
031900     05  FILLER                  PIC X(32)    VALUE               03190014
032000         'TYPE: 04  TERMS DATA            '.                      03200014
032100     05  FILLER                  PIC X(100)   VALUE SPACES.       03210014
032200 01  TYPE4-LINE2.                                                 03220014
032300     05  FILLER                  PIC X(16)    VALUE               03230014
032400         'TERMS TYPE CD:  '.                                      03240014
032500     05  TYPE4-TERMS-TYPE        PIC X(12)    VALUE SPACES.       03250014
032600     05  FILLER                  PIC X(12)    VALUE SPACES.       03260014
032700     05  FILLER                  PIC X(11)    VALUE               03270014
032800         'DISC PCT: '.                                            03280014
032900     05  FILLER                  PIC X(06)    VALUE SPACES.       03290014
033000     05  TYPE4-DISC-PCT          PIC ZZZ.99-.                     03300014
033100     05  FILLER                  PIC X(01)    VALUE '%'.          03310014
033200     05  FILLER                  PIC X(05)    VALUE SPACES.       03320014
033300     05  FILLER                  PIC X(22)    VALUE               03330014
033400         'DEFERRED PCT PAYABLE: '.                                03340014
033500     05  TYPE4-DEF-PCT-PAY       PIC ZZZ.99-.                     03350014
033600     05  FILLER                  PIC X(01)    VALUE '%'.          03360014
033700     05  FILLER                  PIC X(32)    VALUE SPACES.       03370014
033800 01  TYPE4-LINE3.                                                 03380014
033900     05  FILLER                  PIC X(22)    VALUE               03390014
034000         'TERMS BASIS DATE CD:  '.                                03400014
034100     05  TYPE4-BAS-DTE-CD        PIC X(12)    VALUE SPACES.       03410014
034200     05  FILLER                  PIC X(06)    VALUE SPACES.       03420014
034300     05  FILLER                  PIC X(15)    VALUE               03430014
034400         'DISC DUE DATE: '.                                       03440014
034500     05  TYPE4-DISC-DUE-YY       PIC X(02)    VALUE SPACES.       03450014
034600     05  FILLER                  PIC X(01)    VALUE '/'.          03460014
034700     05  TYPE4-DISC-DUE-MM       PIC X(02)    VALUE SPACES.       03470014
034800     05  FILLER                  PIC X(01)    VALUE '/'.          03480014
034900     05  TYPE4-DISC-DUE-DD       PIC X(02)    VALUE SPACES.       03490014
035000     05  FILLER                  PIC X(07)    VALUE SPACES.       03500014
035100     05  FILLER                  PIC X(20)    VALUE               03510014
035200         'DEFERRED DUE DATE:  '.                                  03520014
035300     05  TYPE4-DEF-DUE-YY        PIC X(02)    VALUE SPACES.       03530014
035400     05  FILLER                  PIC X(01)    VALUE '/'.          03540014
035500     05  TYPE4-DEF-DUE-MM        PIC X(02)    VALUE SPACES.       03550014
035600     05  FILLER                  PIC X(01)    VALUE '/'.          03560014
035700     05  TYPE4-DEF-DUE-DD        PIC X(02)    VALUE SPACES.       03570014
035800     05  FILLER                  PIC X(03)    VALUE SPACES.       03580014
035900     05  FILLER                  PIC X(32)    VALUE SPACES.       03590014
036000 01  TYPE4-LINE4.                                                 03600014
036100     05  FILLER                  PIC X(16)    VALUE               03610014
036200         'NET DUE DATE :  '.                                      03620014
036300     05  TYPE4-NET-DUE-YY        PIC X(02)    VALUE SPACES.       03630014
036400     05  FILLER                  PIC X(01)    VALUE '/'.          03640014
036500     05  TYPE4-NET-DUE-MM        PIC X(02)    VALUE SPACES.       03650014
036600     05  FILLER                  PIC X(01)    VALUE '/'.          03660014
036700     05  TYPE4-NET-DUE-DD        PIC X(02)    VALUE SPACES.       03670014
036800     05  FILLER                  PIC X(16)    VALUE SPACES.       03680014
036900     05  FILLER                  PIC X(15)    VALUE               03690014
037000         'DISC DAYS DUE: '.                                       03700014
037100     05  TYPE4-DISC-DAYS-DUE     PIC ZZ9      VALUE ZEROS.        03710014
037200     05  FILLER                  PIC X(12)    VALUE SPACES.       03720014
037300     05  FILLER                  PIC X(23)    VALUE               03730014
037400         'NET DEFERRED DAYS DUE: '.                               03740014
037500     05  FILLER                  PIC X(02)    VALUE SPACES.       03750014
037600     05  TYPE4-NET-DEF-DAYS      PIC ZZ9.                         03760014
037700     05  FILLER                  PIC X(06)    VALUE SPACES.       03770014
037800     05  FILLER                  PIC X(32)    VALUE SPACES.       03780014
037900 01  TYPE4-LINE5.                                                 03790014
038000     05  FILLER                  PIC X(40)    VALUE SPACES.       03800014
038100     05  FILLER                  PIC X(10)    VALUE               03810014
038200         'DISC AMT: '.                                            03820014
038300     05  TYPE4-DISC-AMT          PIC $$$$,$$$.99-.                03830014
038400     05  FILLER                  PIC X(08)    VALUE SPACES.       03840014
038500     05  FILLER                  PIC X(14)    VALUE               03850014
038600         'DEFERRED AMT: '.                                        03860014
038700     05  FILLER                  PIC X(03)    VALUE SPACES.       03870014
038800     05  TYPE4-DEF-AMT           PIC $$$$,$$$.99-.                03880014
038900     05  FILLER                  PIC X(01)    VALUE SPACES.       03890014
039000     05  FILLER                  PIC X(32)    VALUE SPACES.       03900014
039100                                                                  03910014
039200 01  TYPE5-LINE.                                                  03920014
039300     05  FILLER                  PIC X(32)    VALUE               03930014
039400         'TYPE: 05  ALLOWANCE/CHARGE DATA '.                      03940014
039500     05  FILLER                  PIC X(100)   VALUE SPACES.       03950014
039600 01  TYPE5-LINE2.                                                 03960014
039700     05  FILLER                  PIC X(16)    VALUE               03970014
039800         'ALLW/CHRG TYPE: '.                                      03980014
039900     05  TYPE5-ALLW-CHRG-TYPE    PIC X(11)   VALUE SPACE.         03990014
040000     05  FILLER                  PIC X(08)   VALUE SPACES.        04000014
040100     05  FILLER                  PIC X(16)   VALUE                04010014
040200         'ALLW/CHRG CODE: '.                                      04020014
040300     05  TYPE5-ALLW-CHRG-CD      PIC X(16)   VALUE SPACES.        04030014
040400     05  FILLER                  PIC X(02)   VALUE SPACES.        04040014
040500     05  FILLER                  PIC X(16)   VALUE                04050014
040600         'SPEC SRVC CODE: '.                                      04060014
040700     05  TYPE5-SPEC-SRVC-CD      PIC X(10)   VALUE SPACES.        04070014
040800     05  FILLER                  PIC X(02)   VALUE SPACES.        04080014
040900     05  FILLER                  PIC X(18)   VALUE                04090014
041000         'ALLW/CHRG METHOD: '.                                    04100014
041100     05  TYPE5-ALLW-CHRG-MTHD    PIC X(12)   VALUE SPACES.        04110014
041200     05  FILLER                  PIC X(19)   VALUE SPACES.        04120014
041300 01  TYPE5-LINE3.                                                 04130014
041400     05  FILLER                  PIC X(17)   VALUE                04140014
041500         'ALLW/CHRG TOTAL: '.                                     04150014
041600     05  TYPE5-ALLW-CHRG-TOTL    PIC $$$,$$$,$$$.99-.             04160014
041700     05  FILLER                  PIC X(03)   VALUE SPACES.        04170014
041800     05  FILLER                  PIC X(15)   VALUE                04180014
041900         'ALLW/CHRG PCT: '.                                       04190014
042000     05  TYPE5-ALLW-CHRG-PCT     PIC ZZZ.99-.                     04200014
042100     05  FILLER                  PIC X(01)   VALUE '%'.           04210014
042200     05  FILLER                  PIC X(11)   VALUE SPACES.        04220014
042300     05  FILLER                  PIC X(25)   VALUE                04230014
042400         'ALLW/CHRG PCT QUALIFIER: '.                             04240014
042500     05  TYPE5-ALLW-CHRG-QUAL    PIC X(10)   VALUE SPACE.         04250014
042600     05  FILLER                  PIC X(23)   VALUE SPACES.        04260014
042700                                                                  04270014
042800 01  TYPE6-LINE.                                                  04280014
042900     05  FILLER                  PIC X(32)    VALUE               04290014
043000         'TYPE: 06  SUMMARY DATA          '.                      04300014
043100     05  FILLER                  PIC X(100)   VALUE SPACES.       04310014
043200 01  TYPE6-LINE2.                                                 04320014
043300     05  FILLER                  PIC X(20)    VALUE               04330014
043400         'QUANTITY SHIPPED:   '.                                  04340014
043500     05  TYPE6-QTY-SHIP          PIC ZZ,ZZZ,ZZZ.99-.              04350014
043600     05  FILLER                  PIC X(02)    VALUE SPACES.       04360014
043700     05  FILLER                  PIC X(25)    VALUE               04370014
043800         'SHIPPED UNIT OF MEASURE: '.                             04380014
043900     05  TYPE6-SHIP-UOM          PIC X(09)    VALUE SPACES.       04390014
044000     05  FILLER                  PIC X(62)    VALUE SPACES.       04400014
044100 01  TYPE6-LINE3.                                                 04410014
044200     05  FILLER                  PIC X(19)    VALUE               04420014
044300         'GROSS INVOICE AMT: '.                                   04430014
044400     05  TYPE6-GROSS-INV-AMT     PIC $$$,$$$,$$$.99-.             04440014
044500     05  FILLER                  PIC X(02)    VALUE SPACES.       04450014
044600     05  FILLER                  PIC X(18)    VALUE               04460014
044700         'AMT SUBJ TO DISC: '.                                    04470014
044800     05  TYPE6-AMT-SUBJ-DISC     PIC $$$,$$$,$$$.99-.             04480014
044900     05  FILLER                  PIC X(02)    VALUE SPACES.       04490014
045000     05  FILLER                  PIC X(10)    VALUE               04500014
045100         'DISC AMT: '.                                            04510014
045200     05  TYPE6-DISC-AMT          PIC $$$,$$$,$$$.99-.             04520014
045300     05  FILLER                  PIC X(02)    VALUE SPACES.       04530014
045400     05  FILLER                  PIC X(14)    VALUE               04540014
045500         'DISC AMT DUE: '.                                        04550014
045600     05  TYPE6-DISC-AMT-DUE      PIC $$$,$$$,$$$.99-.             04560014
045700     05  FILLER                  PIC X(03)    VALUE SPACES.       04570014
045800                                                                  04580014
045900 01  TYPE7-LINE.                                                  04590014
046000     05  FILLER                  PIC X(32)    VALUE               04600014
046100         'TYPE: 07  DETAIL INVOICE DATA   '.                      04610014
046200     05  FILLER                  PIC X(100)   VALUE SPACES.       04620014
046300 01  TYPE7-LINE2.                                                 04630014
046400     05  FILLER                  PIC X(14)    VALUE               04640014
046500         'ID QUALIFIER: '.                                        04650014
046600     05  TYPE7-ID-QUAL           PIC X(02)    VALUE SPACES.       04660014
046700     05  FILLER                  PIC X(04)    VALUE SPACES.       04670014
046800     05  FILLER                  PIC X(04)    VALUE SPACES.       04680024
046900     05  TYPE7-UPC-TITLE         PIC X(10).                       04690024
047000     05  TYPE7-EAN-UPC           PIC X(16)    VALUE SPACES.       04700024
047100     05  FILLER                  PIC X(10)    VALUE               04710024
047200         '     SKU: '.                                            04720024
047300     05  TYPE7-SKU               PIC X(08)    VALUE SPACES.       04730024
047400     05  FILLER                  PIC X(92)    VALUE SPACES.       04740024
047500 01  TYPE7-LINE3.                                                 04750024
047600     05  FILLER                  PIC X(14)    VALUE               04760024
047700         'VENDOR STYLE: '.                                        04770024
047800     05  TYPE7-VNDR-STYLE        PIC X(20)    VALUE SPACES.       04780024
047900     05  FILLER                  PIC X(06)    VALUE SPACES.       04790024
048000     05  FILLER                  PIC X(17)    VALUE               04800024
048100         'NORMAL COLOR CD: '.                                     04810024
048200     05  TYPE7-NRML-CD           PIC X(03)    VALUE SPACES.       04820024
048300     05  FILLER                  PIC X(20)    VALUE SPACES.       04830024
048400     05  FILLER                  PIC X(11)    VALUE               04840024
048500         'SIZE CD:   '.                                           04850024
048600     05  TYPE7-SIZE-CD           PIC X(05)    VALUE SPACES.       04860024
048700     05  FILLER                  PIC X(36)    VALUE SPACES.       04870024
048800 01  TYPE7-LINE4.                                                 04880024
048900     05  FILLER                  PIC X(14)    VALUE               04890024
049000         'STYLE DESC:   '.                                        04900024
049100     05  TYPE7-VNDR-STYLE-DESC   PIC X(25)    VALUE SPACES.       04910024
049200     05  FILLER                  PIC X(01)    VALUE SPACES.       04920024
049300     05  FILLER                  PIC X(12)    VALUE               04930024
049400         'COLOR DESC: '.                                          04940024
049500     05  TYPE7-COLOR-DESC        PIC X(25)    VALUE SPACES.       04950024
049600     05  FILLER                  PIC X(03)    VALUE SPACES.       04960024
049700     05  FILLER                  PIC X(11)    VALUE               04970024
049800         'SIZE DESC: '.                                           04980024
049900     05  TYPE7-SIZE-DESC         PIC X(25)    VALUE SPACES.       04990024
050000     05  FILLER                  PIC X(56)    VALUE SPACES.       05000024
050100 01  TYPE7-LINE5.                                                 05010024
050200     05  FILLER                  PIC X(19)    VALUE               05020024
050300         'QUANTITY INVOICED: '.                                   05030024
050400     05  TYPE7-QTY-INVD          PIC ZZZ,ZZZ.99-.                 05040024
050500     05  FILLER                  PIC X(10)    VALUE SPACES.       05050024
050600     05  FILLER                  PIC X(17)    VALUE               05060024
050700         'UNIT OF MEASURE: '.                                     05070024
050800     05  TYPE7-UOM               PIC X(09)    VALUE SPACES.       05080024
050900     05  FILLER                  PIC X(04)    VALUE SPACES.       05090024
051000     05  FILLER                  PIC X(10)    VALUE SPACES.       05100024
051100     05  TYPE7-UNT-CST-TITLE     PIC X(11).                       05110027
051200     05  TYPE7-WHOL-COST         PIC $$,$$$,$$$.99-.              05120024
051300     05  FILLER                  PIC X(27)    VALUE SPACES.       05130024
051400                                                                  05140024
051500 01  TYPE7-LINE6.                                                 05150024
051600     05  FILLER                  PIC X(22)    VALUE               05160024
051700         'PACKITEM SUMMED COST: '.                                05170024
051800     05  TYPE7-PK-ITEM-SUMD-COST PIC $$,$$$,$$$.99-.              05180024
051900     05  FILLER                  PIC X(96)    VALUE SPACES.       05190024
052000                                                                  05200024
052100 01  TYPE-OTH-LINE.                                               05210024
052200     05  FILLER                  PIC X(06)    VALUE               05220024
052300         'TYPE: '.                                                05230024
052400     05  TYPE-OTH-REC-TYPE       PIC X(02)    VALUE SPACES.       05240024
052500     05  FILLER                  PIC X(02)    VALUE SPACES.       05250024
052600     05  FILLER                  PIC X(22)    VALUE SPACES.       05260024
052700     05  FILLER                  PIC X(100)   VALUE SPACES.       05270024
052800                                                                  05280024
052900 01  CALC-GROSS-LINE.                                             05290024
053000     05  FILLER                  PIC X(32)    VALUE               05300024
053100         'CALCULATED INVOICE EXTENSION =  '.                      05310024
053200     05  CALC-GROSS-EXTEN        PIC $$$$,$$$,$$$.99-.            05320024
053300     05  FILLER                  PIC X(19)    VALUE               05330024
053400         '  GROSS INVOICED = '.                                   05340024
053500     05  GROSS-INVOICED          PIC $$$$,$$$,$$$.99-.            05350024
053600     05  FILLER                  PIC X(084)   VALUE SPACES.       05360024
053700                                                                  05370038
053800*--------------------------------------------------------------*  05380038
053900* REPORT HEADING LINES                                         *  05390038
054000*--------------------------------------------------------------*  05400038
054100 01  HL-HEADING-LINE1.                                            05410024
054200     05  FILLER                  PIC X(50)     VALUE SPACES.      05420024
054300     05  FILLER                  PIC X(30)     VALUE              05430024
054400             ' EDI INVOICE REJECTION REPORT '.                    05440024
054500     05  FILLER                  PIC X(05)     VALUE SPACES.      05450024
054600     05  HEADER-TYPE             PIC X(25)     VALUE SPACES.      05460024
054700     05  FILLER                  PIC X(20)     VALUE SPACES.      05470024
054800                                                                  05480024
054900 01  HL-HEADING-LINE2.                                            05490024
055000     05  FILLER                  PIC X(15)     VALUE              05500024
055100         'VENDOR DUN NO: '.                                       05510024
055200     05  HL2-VENDOR-NBR          PIC ZZZZZZZZ9.                   05520024
055300     05  FILLER                  PIC X(02)     VALUE SPACES.      05530024
055400     05  HL2-ENT-ID-DESC         PIC X(25)     VALUE SPACES.      05540024
055500     05  FILLER                  PIC X(04)     VALUE SPACES.      05550024
055600     05  FILLER                  PIC X(11)     VALUE              05560024
055700         'INVOICE # '.                                            05570024
055800     05  HL2-INVOICE-NBR         PIC X(22)     VALUE SPACES.      05580024
055900     05  FILLER                  PIC X(07)     VALUE SPACES.      05590024
056000     05  FILLER                  PIC X(05)     VALUE 'PO # '.     05600024
056100     05  HL2-PO-NBR              PIC ZZZZZZZZ9.                   05610047
056200     05  FILLER                  PIC X(02)     VALUE SPACES.      05620049
056300     05  FILLER                  PIC X(06)     VALUE 'ISA # '.    05630024
056400     05  HL2-INTERCHG-CNTL-NBR   PIC ZZZZZZZZ9.                   05640024
056500                                                                  05650024
056600 01  HL-HEADING-LINE1-2.                                          05660024
056700     05  FILLER                  PIC X(46)     VALUE SPACES.      05670024
056800     05  FILLER                  PIC X(38)     VALUE              05680024
056900             ' SUMMARY EDI INVOICE REJECTION REPORT '.            05690024
057000     05  FILLER                  PIC X(05)     VALUE SPACES.      05700024
057100     05  HEADER-TYPE1-2          PIC X(25)     VALUE SPACES.      05710024
057200     05  FILLER                  PIC X(16)     VALUE SPACES.      05720024
057300                                                                  05730024
057400 01  NO-DATA-LINE.                                                05740024
057500     05  FILLER                  PIC X(44)     VALUE SPACES.      05750024
057600     05  FILLER                  PIC X(41)     VALUE              05760024
057700             ' NO REJECTION INVOICES FOR THIS RUN      '.         05770024
057800     05  FILLER                  PIC X(46)     VALUE SPACES.      05780024
057900                                                                  05790024
058000 01  PC-PROGRAM-CONSTANTS.                                        05800024
058100     05  PC-SLASH                PIC X(01)     VALUE '/'.         05810024
058200     05  PC-DASH                 PIC X(01)     VALUE '-'.         05820024
058300                                                                  05830038
058400 01  PV-PROGRAM-VARIABLES.                                        05840024
058500     05  PV-ABEND-CODE           PIC S9(04)    VALUE ZEROES       05850024
058600                                               COMP.              05860024
058700     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKRP204'.  05870024
058800     05  PV-LINE-COUNT           PIC S9(03)    VALUE ZEROES       05880024
058900                                               COMP-3.            05890024
059000     05  PV-LINE-COUNT-2         PIC S9(03)    VALUE ZEROES       05900024
059100                                               COMP-3.            05910024
059200     05  PV-LINE-LIMIT           PIC S9(03)    VALUE +60          05920024
059300                                               COMP-3.            05930024
059400     05  PV-PAGE-COUNT           PIC S9(06)    VALUE ZEROES       05940024
059500                                               COMP-3.            05950024
059600     05  PV-PAGE-COUNT-2         PIC S9(06)    VALUE ZEROES       05960024
059700                                               COMP-3.            05970024
059800     05  PV-ERROR-MSG            PIC X(65)     VALUE SPACES.      05980024
059900     05  PV-EDIT-CODE            PIC 9(02)     VALUE ZERO.        05990024
060000     05  PV-ERROR-CODE           PIC 9(02)     VALUE ZERO.        06000024
060100     05  PV-TOT-INVC-LINES       PIC ZZ,ZZZ,ZZ9.                  06010043
060200                                                                  06020038
060300 01  WS-PROGRAM-SWITCHES.                                         06030024
060400     05  WS-EDI-REJ-EOF-SW       PIC X(01)    VALUE 'N'.          06040024
060500         88  WS-EDI-REJ-EOF                   VALUE 'Y'.          06050038
060600     05  WS-EDI-EMPTY-FILE-SW    PIC X(01)    VALUE 'N'.          06060024
060700         88  WS-EDI-REJ-EMPTY-FILE            VALUE 'Y'.          06070038
060800     05  WS-ERR-DETAIL-GROSS-INV PIC X(01)    VALUE 'N'.          06080024
060900         88  ERR-DETAIL-GROSS-INVOICE         VALUE 'Y'.          06090024
061000         88  NO-ERR-DETAIL-GROSS-INVOICE      VALUE 'N'.          06100024
061100                                                                  06110038
061200 01  REPORT-TYPE-CONTROL         PIC X(01)     VALUE SPACE.       06120024
061300                                                                  06130024
061400 01  SD-SYSTEM-DATE.                                              06140024
061500     05  SD-SYSTEM-YEAR          PIC 9(02)     VALUE ZEROES.      06150024
061600     05  SD-SYSTEM-MONTH         PIC 9(02)     VALUE ZEROES.      06160024
061700     05  SD-SYSTEM-DAY           PIC 9(02)     VALUE ZEROES.      06170024
061800                                                                  06180024
061900 01  ST-SYSTEM-TIME.                                              06190024
062000     05  ST-SYSTEM-HOUR          PIC 9(02)     VALUE ZEROES.      06200024
062100     05  ST-SYSTEM-MINUTE        PIC 9(02)     VALUE ZEROES.      06210024
062200     05  FILLER                  PIC X(04)     VALUE SPACES.      06220024
062300                                                                  06230024
062400 01  SUMM-ERR-TABLE.                                              06240024
062500     05  SUMM-ERR-FLAG-AREA      OCCURS 99 TIMES                  06250024
062600                                 INDEXED BY FLG-INDX.             06260024
062700         10  SUMM-ERR-FLAG       PIC X(01).                       06270024
062800                                                                  06280038
062900*---------------------------*                                     06290038
063000 PROCEDURE DIVISION.                                              06300024
063100*---------------------------*                                     06310038
063200 A000-MAIN-DRIVER.                                                06320024
063300                                                                  06330038
063400     OPEN INPUT  EDI-REJ-FILE                                     06340024
063500          OUTPUT EDI-REPORT                                       06350024
063600                 EDI-SUMM-REPORT.                                 06360024
063700                                                                  06370024
063800     PERFORM H000-HOUSEKEEPING.                                   06380024
063900     IF NOT WS-EDI-REJ-EMPTY-FILE                                 06390024
064000        PERFORM B000-PROCESS                                      06400024
064100             UNTIL WS-EDI-REJ-EOF                                 06410045
064200     END-IF.                                                      06420045
064300     PERFORM Z900-END-OF-JOB.                                     06430024
064400     STOP RUN.                                                    06440024
064500                                                                  06450024
064600*--------------------------------------------------------------*  06460038
064700* PROCESS THE EDI TRANSMISSION REJECTED INVOICES               *  06470038
064800*--------------------------------------------------------------*  06480038
064900 B000-PROCESS.                                                    06490038
065000                                                                  06500038
065100     IF AP051-SORT-INVOICE-NBR NOT = HL2-INVOICE-NBR              06510024
065200        PERFORM W000-SUMMARY-LINES                                06520024
065300        PERFORM W700-END-OF-INVOICE-LINE                          06530024
065400        MOVE AP051-SORT-VENDOR-NBR        TO HL2-VENDOR-NBR       06540024
065500        MOVE AP051-SORT-INVOICE-NBR       TO HL2-INVOICE-NBR      06550024
065600        MOVE AP051-KOHLS-PO-NBR           TO HL2-PO-NBR           06560024
065700        SET NO-ERR-DETAIL-GROSS-INVOICE   TO TRUE                 06570024
065800        MOVE AP051-VENDOR-DESC            TO HL2-ENT-ID-DESC      06580024
065900        MOVE AP051-SAVE-INTERCHG-CNTL-NBR TO HL2-INTERCHG-CNTL-NBR06590024
066000        PERFORM W200-HEADING-ROUTINE                              06600045
066100     END-IF.                                                      06610045
066200                                                                  06620024
066300     EVALUATE AP051-RECORD-TYPE-IND                               06630024
066400        WHEN '01'                                                 06640024
066500             PERFORM C000-TYPE1                                   06650024
066600        WHEN '02'                                                 06660024
066700             PERFORM C100-TYPE2                                   06670024
066800        WHEN '03'                                                 06680024
066900             PERFORM C200-TYPE3                                   06690024
067000        WHEN '04'                                                 06700024
067100             PERFORM C300-TYPE4                                   06710024
067200        WHEN '05'                                                 06720024
067300             PERFORM C400-TYPE5                                   06730024
067400        WHEN '06'                                                 06740024
067500             PERFORM C500-TYPE6                                   06750024
067600        WHEN '07'                                                 06760024
067700             PERFORM C600-TYPE7                                   06770024
067800        WHEN HIGH-VALUES                                          06780024
067900             PERFORM C650-HIGH-VALUES                             06790043
068000        WHEN OTHER                                                06800024
068100             PERFORM C700-INVALID-TYPE                            06810024
068200     END-EVALUATE.                                                06820024
068300                                                                  06830024
068400** CHECK FOR ERRORS IN THE ERROR CODE AREA **                     06840038
068500     IF AP051-ERR-CD(1) = 0                                       06850024
068600        NEXT SENTENCE                                             06860024
068700     ELSE                                                         06870024
068800        PERFORM E100-ERROR-ROUTINE                                06880045
068900     END-IF.                                                      06890045
069000                                                                  06900024
069100     PERFORM W400-PRINT-DIVIDE-LINE.                              06910024
069200                                                                  06920024
069300     PERFORM R100-READ-EDI-REJECT.                                06930024
069400                                                                  06940024
069500*--------------------------------------------------------------*  06950038
069600* PROCESS THE INTERCHANGE RECORD                               *  06960038
069700*--------------------------------------------------------------*  06970038
069800 C000-TYPE1.                                                      06980038
069900                                                                  06990038
070000     MOVE AP051-EDI-SENDER-ID-QUAL   TO TYPE1-SEND-ID-QUAL.       07000024
070100     MOVE AP051-EDI-SENDER-ID        TO TYPE1-SENDER-ID.          07010024
070200     MOVE AP051-INTERCHG-DTE-YY      TO TYPE1-INTERCHG-YY.        07020024
070300     MOVE AP051-INTERCHG-DTE-MM      TO TYPE1-INTERCHG-MM.        07030024
070400     MOVE AP051-INTERCHG-DTE-DD      TO TYPE1-INTERCHG-DD.        07040024
070500     MOVE AP051-INTERCHG-TME-HH      TO TYPE1-HH.                 07050024
070600     MOVE AP051-INTERCHG-TME-MM      TO TYPE1-MM.                 07060024
070700     MOVE AP051-INTERCHG-CNTL-NBR    TO TYPE1-INTERCHG-CNTL.      07070024
070800     MOVE AP051-GS-CNTL-NBR          TO TYPE1-GS-NBR.             07080024
070900     MOVE AP051-TS-CNTL-NBR          TO TYPE1-TS-NBR.             07090024
071000     MOVE AP051-PROD-TEST-IND        TO TYPE1-PROD-TEST.          07100024
071100                                                                  07110024
071200     ADD 4 TO PV-LINE-COUNT.                                      07120024
071300     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            07130024
071400        PERFORM W200-HEADING-ROUTINE                              07140045
071500     END-IF.                                                      07150045
071600                                                                  07160024
071700     WRITE EDI-LINE FROM TYPE1-LINE                               07170024
071800         AFTER ADVANCING 2 LINE.                                  07180024
071900                                                                  07190024
072000     WRITE EDI-LINE FROM TYPE1-LINE2                              07200024
072100         AFTER ADVANCING 1 LINE.                                  07210024
072200                                                                  07220024
072300     WRITE EDI-LINE FROM TYPE1-LINE3                              07230024
072400         AFTER ADVANCING 1 LINE.                                  07240024
072500                                                                  07250024
072600*--------------------------------------------------------------*  07260038
072700* PROCESS THE INVOICE RECORD                                   *  07270038
072800*--------------------------------------------------------------*  07280038
072900 C100-TYPE2.                                                      07290038
073000                                                                  07300038
073100     MOVE AP051-KOHLS-STORE-NBR1    TO TYPE2-STORE-NBR1.          07310024
073200     MOVE AP051-KOHLS-STORE-NBR2    TO TYPE2-STORE-NBR2.          07320024
073300     MOVE AP051-LADING-CARRIER-NBR  TO TYPE2-LAD-CARR.            07330024
073400     MOVE AP051-INV-DTE-YY          TO TYPE2-INV-YY.              07340024
073500     MOVE AP051-INV-DTE-MM          TO TYPE2-INV-MM.              07350024
073600     MOVE AP051-INV-DTE-DD          TO TYPE2-INV-DD.              07360024
073700     MOVE AP051-SHPD-DTE-YY         TO TYPE2-SHP-YY.              07370024
073800     MOVE AP051-SHPD-DTE-MM         TO TYPE2-SHP-MM.              07380024
073900     MOVE AP051-SHPD-DTE-DD         TO TYPE2-SHP-DD.              07390024
074000     MOVE AP051-EFF-DTE-YY          TO TYPE2-EFF-YY.              07400024
074100     MOVE AP051-EFF-DTE-MM          TO TYPE2-EFF-MM.              07410024
074200     MOVE AP051-EFF-DTE-DD          TO TYPE2-EFF-DD.              07420024
074300                                                                  07430024
074400     ADD 4 TO PV-LINE-COUNT.                                      07440024
074500     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            07450024
074600        PERFORM W200-HEADING-ROUTINE                              07460045
074700     END-IF.                                                      07470045
074800                                                                  07480024
074900     WRITE EDI-LINE FROM TYPE2-LINE                               07490024
075000         AFTER ADVANCING 2 LINE.                                  07500024
075100                                                                  07510024
075200     WRITE EDI-LINE FROM TYPE2-LINE2                              07520024
075300         AFTER ADVANCING 1 LINE.                                  07530024
075400                                                                  07540024
075500     WRITE EDI-LINE FROM TYPE2-LINE3                              07550024
075600         AFTER ADVANCING 1 LINE.                                  07560024
075700                                                                  07570024
075800*--------------------------------------------------------------*  07580038
075900* PROCESS THE REMIT TO RECORD                                  *  07590038
076000*--------------------------------------------------------------*  07600038
076100 C200-TYPE3.                                                      07610038
076200                                                                  07620038
076300     MOVE AP051-REMIT-VNDR-DUNS-NBR TO TYPE3-DUNS-NBR.            07630024
076400     MOVE AP051-REMIT-TO-NAME       TO TYPE3-NAME.                07640024
076500     MOVE AP051-REMIT-TO-ADDR-1     TO TYPE3-ADDR1.               07650024
076600     MOVE AP051-REMIT-TO-ADDR-2     TO TYPE3-ADDR2.               07660024
076700     MOVE AP051-REMIT-TO-CITY       TO TYPE3-CITY.                07670024
076800     MOVE AP051-REMIT-TO-STATE      TO TYPE3-STATE.               07680024
076900     MOVE AP051-REMIT-TO-ZIP-5      TO TYPE3-ZIP-5.               07690024
077000     MOVE AP051-REMIT-TO-ZIP-4      TO TYPE3-ZIP-4.               07700024
077100                                                                  07710024
077200     ADD 6 TO PV-LINE-COUNT.                                      07720024
077300     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            07730024
077400        PERFORM W200-HEADING-ROUTINE                              07740045
077500     END-IF.                                                      07750045
077600                                                                  07760024
077700     WRITE EDI-LINE FROM TYPE3-LINE                               07770024
077800         AFTER ADVANCING 2 LINE.                                  07780024
077900                                                                  07790024
078000     WRITE EDI-LINE FROM TYPE3-LINE2                              07800024
078100         AFTER ADVANCING 1 LINE.                                  07810024
078200                                                                  07820024
078300     WRITE EDI-LINE FROM TYPE3-LINE3                              07830024
078400         AFTER ADVANCING 1 LINE.                                  07840024
078500                                                                  07850024
078600     WRITE EDI-LINE FROM TYPE3-LINE4                              07860024
078700         AFTER ADVANCING 1 LINE.                                  07870024
078800                                                                  07880024
078900     WRITE EDI-LINE FROM TYPE3-LINE5                              07890024
079000         AFTER ADVANCING 1 LINE.                                  07900024
079100                                                                  07910024
079200*--------------------------------------------------------------*  07920038
079300* PROCESS THE TERMS RECORD                                     *  07930038
079400*--------------------------------------------------------------*  07940038
079500 C300-TYPE4.                                                      07950038
079600                                                                  07960038
079700     EVALUATE AP051-TERMS-TYPE-CODE                               07970024
079800       WHEN '01'                                                  07980024
079900         MOVE 'BASIC       '        TO TYPE4-TERMS-TYPE           07990024
080000       WHEN '02'                                                  08000024
080100         MOVE 'END OF MONTH'        TO TYPE4-TERMS-TYPE           08010024
080200       WHEN '03'                                                  08020024
080300         MOVE 'FIXED DATE  '        TO TYPE4-TERMS-TYPE           08030024
080400       WHEN '04'                                                  08040024
080500         MOVE 'DEFR INSTALL'        TO TYPE4-TERMS-TYPE           08050024
080600       WHEN '05'                                                  08060024
080700         MOVE 'NO DISC     '        TO TYPE4-TERMS-TYPE           08070024
080800       WHEN '06'                                                  08080024
080900         MOVE 'MIXED       '        TO TYPE4-TERMS-TYPE           08090024
081000       WHEN '07'                                                  08100024
081100         MOVE 'EXTENDED    '        TO TYPE4-TERMS-TYPE           08110024
081200       WHEN '08'                                                  08120024
081300         MOVE 'BASIC DISC  '        TO TYPE4-TERMS-TYPE           08130024
081400       WHEN '09'                                                  08140024
081500         MOVE 'PROXIMO     '        TO TYPE4-TERMS-TYPE           08150024
081600       WHEN '10'                                                  08160024
081700         MOVE 'INSTANT     '        TO TYPE4-TERMS-TYPE           08170024
081800       WHEN '11'                                                  08180024
081900         MOVE 'ELECTIVE    '        TO TYPE4-TERMS-TYPE           08190024
082000       WHEN '12'                                                  08200024
082100         MOVE '10 DAYS EOM '        TO TYPE4-TERMS-TYPE           08210024
082200       WHEN '13'                                                  08220024
082300         MOVE 'PREV AGREED '        TO TYPE4-TERMS-TYPE           08230024
082400       WHEN '14'                                                  08240024
082500         MOVE 'MUTUAL DEFIN'        TO TYPE4-TERMS-TYPE           08250024
082600       WHEN OTHER                                                 08260024
082700         MOVE AP051-TERMS-TYPE-CODE TO TYPE4-TERMS-TYPE           08270024
082800     END-EVALUATE.                                                08280024
082900                                                                  08290024
083000     EVALUATE AP051-TRMS-BASIS-DTE-CODE                           08300024
083100       WHEN '01'                                                  08310024
083200         MOVE 'SHIP DATE   '        TO TYPE4-BAS-DTE-CD           08320024
083300       WHEN '02'                                                  08330024
083400         MOVE 'DELIV DATE  '        TO TYPE4-BAS-DTE-CD           08340024
083500       WHEN '03'                                                  08350024
083600         MOVE 'INVOICE DATE'        TO TYPE4-BAS-DTE-CD           08360024
083700       WHEN '04'                                                  08370024
083800         MOVE 'EFFECT DATE '        TO TYPE4-BAS-DTE-CD           08380024
083900       WHEN OTHER                                                 08390024
084000         MOVE AP051-TRMS-BASIS-DTE-CODE TO TYPE4-BAS-DTE-CD       08400024
084100     END-EVALUATE.                                                08410024
084200                                                                  08420024
084300     MOVE AP051-DISC-PCT            TO TYPE4-DISC-PCT.            08430024
084400     MOVE AP051-DISC-DUE-DTE-YY     TO TYPE4-DISC-DUE-YY.         08440024
084500     MOVE AP051-DISC-DUE-DTE-MM     TO TYPE4-DISC-DUE-MM.         08450024
084600     MOVE AP051-DISC-DUE-DTE-DD     TO TYPE4-DISC-DUE-DD.         08460024
084700     MOVE AP051-DISC-DAYS-DUE       TO TYPE4-DISC-DAYS-DUE.       08470024
084800     MOVE AP051-DISC-AMT            TO TYPE4-DISC-AMT.            08480024
084900     MOVE AP051-NET-DUE-DTE-YY      TO TYPE4-NET-DUE-YY.          08490024
085000     MOVE AP051-NET-DUE-DTE-MM      TO TYPE4-NET-DUE-MM.          08500024
085100     MOVE AP051-NET-DUE-DTE-DD      TO TYPE4-NET-DUE-DD.          08510024
085200     MOVE AP051-NET-DEFRD-DAYS-DUE  TO TYPE4-NET-DEF-DAYS.        08520024
085300     MOVE AP051-PCT-PAYABLE         TO TYPE4-DEF-PCT-PAY.         08530024
085400     MOVE AP051-DEF-DUE-DTE-YY      TO TYPE4-DEF-DUE-YY.          08540024
085500     MOVE AP051-DEF-DUE-DTE-MM      TO TYPE4-DEF-DUE-MM.          08550024
085600     MOVE AP051-DEF-DUE-DTE-DD      TO TYPE4-DEF-DUE-DD.          08560024
085700     MOVE AP051-DEFERRED-AMT        TO TYPE4-DEF-AMT.             08570024
085800                                                                  08580024
085900     ADD 6 TO PV-LINE-COUNT.                                      08590024
086000     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            08600024
086100        PERFORM W200-HEADING-ROUTINE                              08610045
086200     END-IF.                                                      08620045
086300                                                                  08630024
086400     WRITE EDI-LINE FROM TYPE4-LINE                               08640024
086500         AFTER ADVANCING 2 LINE.                                  08650024
086600                                                                  08660024
086700     WRITE EDI-LINE FROM TYPE4-LINE2                              08670024
086800         AFTER ADVANCING 1 LINE.                                  08680024
086900                                                                  08690024
087000     WRITE EDI-LINE FROM TYPE4-LINE3                              08700024
087100         AFTER ADVANCING 1 LINE.                                  08710024
087200                                                                  08720024
087300     WRITE EDI-LINE FROM TYPE4-LINE4                              08730024
087400         AFTER ADVANCING 1 LINE.                                  08740024
087500                                                                  08750024
087600     WRITE EDI-LINE FROM TYPE4-LINE5                              08760024
087700         AFTER ADVANCING 1 LINE.                                  08770024
087800                                                                  08780024
087900*--------------------------------------------------------------*  08790038
088000* PROCESS THE ALLW/CHRG RECORD                                 *  08800038
088100*--------------------------------------------------------------*  08810038
088200 C400-TYPE5.                                                      08820038
088300                                                                  08830038
088400     EVALUATE AP051-ALLW-CHG-TYPE                                 08840024
088500       WHEN 'C'                                                   08850024
088600         MOVE 'CHARGE     '         TO TYPE5-ALLW-CHRG-TYPE       08860024
088700       WHEN 'A'                                                   08870024
088800         MOVE 'ALLOWANCE  '         TO TYPE5-ALLW-CHRG-TYPE       08880024
088900       WHEN 'N'                                                   08890024
089000         MOVE 'NO ALLW CHG'         TO TYPE5-ALLW-CHRG-TYPE       08900024
089100       WHEN OTHER                                                 08910024
089200         MOVE AP051-ALLW-CHG-TYPE   TO TYPE5-ALLW-CHRG-TYPE       08920024
089300     END-EVALUATE.                                                08930024
089400                                                                  08940024
089500     EVALUATE AP051-ALLW-CHRG-CODE                                08950024
089600       WHEN '275'                                                 08960024
089700       WHEN 'DSC'                                                 08970024
089800         MOVE 'TERMS DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         08980024
089900       WHEN 'TTD'                                                 08990024
090000         MOVE 'TRADE DISCOUNT  '    TO TYPE5-ALLW-CHRG-CD         09000024
090100       WHEN 'CAC'                                                 09010024
090200         MOVE 'CASH DISCOUNT   '    TO TYPE5-ALLW-CHRG-CD         09020024
090300       WHEN 'NSD'                                                 09030024
090400       WHEN 'NSA'                                                 09040024
090500         MOVE 'NEW STORE/PROMO '    TO TYPE5-ALLW-CHRG-CD         09050024
090600       WHEN 'FFA'                                                 09060024
090700         MOVE 'FREIGHT ALLOW   '    TO TYPE5-ALLW-CHRG-CD         09070024
090800       WHEN 'TAL'                                                 09080024
090900         MOVE 'TRUCKLOAD DISC  '    TO TYPE5-ALLW-CHRG-CD         09090024
091000       WHEN 'VAB'                                                 09100024
091100         MOVE 'VOLUME DISCOUNT '    TO TYPE5-ALLW-CHRG-CD         09110024
091200       WHEN 'RCA'                                                 09120024
091300         MOVE 'NO RET CREDIT AL'    TO TYPE5-ALLW-CHRG-CD         09130024
091400       WHEN 'WSA'                                                 09140024
091500         MOVE 'WHAREHOUSE ALLW '    TO TYPE5-ALLW-CHRG-CD         09150024
091600       WHEN 'DDA'                                                 09160024
091700         MOVE 'DEFECTIVE ALLW  '    TO TYPE5-ALLW-CHRG-CD         09170024
091800       WHEN 'AAA'                                                 09180024
091900         MOVE 'ADVETISING ALLW '    TO TYPE5-ALLW-CHRG-CD         09190024
092000       WHEN 'EEA'                                                 09200024
092100         MOVE 'EARLY BUY ALLW  '    TO TYPE5-ALLW-CHRG-CD         09210024
092200       WHEN 'UUM'                                                 09220024
092300         MOVE 'UNSALEABLE MERCH'    TO TYPE5-ALLW-CHRG-CD         09230024
092400       WHEN '400'                                                 09240024
092500       WHEN 'FFC'                                                 09250024
092600       WHEN 'PAB'                                                 09260024
092700       WHEN 'SAB'                                                 09270024
092800       WHEN 'PST'                                                 09280024
092900       WHEN 'UUC'                                                 09290024
093000         MOVE 'FREIGHT CHARGE  '    TO TYPE5-ALLW-CHRG-CD         09300024
093100       WHEN 'MRK'                                                 09310024
093200         MOVE 'PRETICKETING    '    TO TYPE5-ALLW-CHRG-CD         09320024
093300       WHEN '445'                                                 09330024
093400       WHEN 'INS'                                                 09340024
093500         MOVE 'INSURANCE       '    TO TYPE5-ALLW-CHRG-CD         09350024
093600       WHEN 'MSG'                                                 09360024
093700         MOVE 'MISCELLANEOUS   '    TO TYPE5-ALLW-CHRG-CD         09370024
093800       WHEN 'SST'                                                 09380024
093900       WHEN 'TTL'                                                 09390024
094000       WHEN 'TTS'                                                 09400024
094100         MOVE 'TAX             '    TO TYPE5-ALLW-CHRG-CD         09410024
094200       WHEN 'SGG'                                                 09420024
094300         MOVE 'SMALL ORDER CHG '    TO TYPE5-ALLW-CHRG-CD         09430024
094400       WHEN 'HBG'                                                 09440024
094500       WHEN '690'                                                 09450024
094600         MOVE 'HANDLING        '    TO TYPE5-ALLW-CHRG-CD         09460024
094700       WHEN 'LAE'                                                 09470024
094800         MOVE 'LICENSE FEE     '    TO TYPE5-ALLW-CHRG-CD         09480024
094900       WHEN 'PPN'                                                 09490024
095000         MOVE 'PALLET CHARGE   '    TO TYPE5-ALLW-CHRG-CD         09500024
095100       WHEN OTHER                                                 09510024
095200         MOVE AP051-ALLW-CHRG-CODE  TO TYPE5-ALLW-CHRG-CD         09520024
095300     END-EVALUATE.                                                09530024
095400                                                                  09540024
095500     MOVE AP051-SPEC-SRVC-CODE      TO TYPE5-SPEC-SRVC-CD.        09550024
095600     EVALUATE AP051-SPEC-SRVC-CODE                                09560024
095700       WHEN 'FG        '                                          09570024
095800         MOVE 'FREE GOODS'          TO TYPE5-SPEC-SRVC-CD         09580024
095900       WHEN 'TC        '                                          09590024
096000         MOVE 'TICKETING '          TO TYPE5-SPEC-SRVC-CD         09600024
096100       WHEN OTHER                                                 09610024
096200         MOVE AP051-SPEC-SRVC-CODE  TO TYPE5-SPEC-SRVC-CD         09620024
096300     END-EVALUATE.                                                09630024
096400                                                                  09640024
096500     EVALUATE AP051-ALLW-CHRG-MTHD                                09650024
096600       WHEN '02'                                                  09660024
096700         MOVE 'OFF INVOICE '        TO TYPE5-ALLW-CHRG-MTHD       09670024
096800       WHEN OTHER                                                 09680024
096900         MOVE AP051-ALLW-CHRG-MTHD  TO TYPE5-ALLW-CHRG-MTHD       09690024
097000     END-EVALUATE.                                                09700024
097100                                                                  09710024
097200     MOVE AP051-ALLW-CHRG-TOTAL     TO TYPE5-ALLW-CHRG-TOTL.      09720024
097300     MOVE AP051-ALLW-CHRG-PCT       TO TYPE5-ALLW-CHRG-PCT.       09730024
097400     EVALUATE AP051-ALLW-CHRG-PCT-QUAL                            09740024
097500       WHEN '3'                                                   09750024
097600         MOVE 'DISC GROSS' TO TYPE5-ALLW-CHRG-QUAL                09760024
097700       WHEN OTHER                                                 09770024
097800         MOVE '          ' TO TYPE5-ALLW-CHRG-QUAL                09780024
097900     END-EVALUATE.                                                09790024
098000                                                                  09800024
098100     ADD 4 TO PV-LINE-COUNT.                                      09810024
098200     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            09820024
098300        PERFORM W200-HEADING-ROUTINE                              09830045
098400     END-IF.                                                      09840045
098500                                                                  09850024
098600     WRITE EDI-LINE FROM TYPE5-LINE                               09860024
098700         AFTER ADVANCING 2 LINE.                                  09870024
098800                                                                  09880024
098900     WRITE EDI-LINE FROM TYPE5-LINE2                              09890024
099000         AFTER ADVANCING 1 LINE.                                  09900024
099100                                                                  09910024
099200     WRITE EDI-LINE FROM TYPE5-LINE3                              09920024
099300         AFTER ADVANCING 1 LINE.                                  09930024
099400                                                                  09940024
099500*--------------------------------------------------------------*  09950038
099600* PROCESS THE SUMMARY RECORD                                   *  09960038
099700*--------------------------------------------------------------*  09970038
099800 C500-TYPE6.                                                      09980038
099900                                                                  09990038
100000     MOVE AP051-QUANTITY-SHIPPED    TO TYPE6-QTY-SHIP.            10000024
100100     EVALUATE AP051-SHIP-UNIT-MEASURE                             10010024
100200       WHEN 'CA'                                                  10020024
100300         MOVE 'CASE     ' TO TYPE6-SHIP-UOM                       10030024
100400       WHEN 'CH'                                                  10040024
100500         MOVE 'CONTAINER' TO TYPE6-SHIP-UOM                       10050024
100600       WHEN 'CT'                                                  10060024
100700         MOVE 'CARTON   ' TO TYPE6-SHIP-UOM                       10070024
100800       WHEN 'EA'                                                  10080024
100900         MOVE 'EACH     ' TO TYPE6-SHIP-UOM                       10090024
101000       WHEN OTHER                                                 10100024
101100         MOVE SPACES      TO TYPE6-SHIP-UOM                       10110024
101200     END-EVALUATE.                                                10120024
101300                                                                  10130024
101400     MOVE AP051-GROSS-INVOICE-AMT   TO TYPE6-GROSS-INV-AMT.       10140024
101500     MOVE AP051-GROSS-INVOICE-AMT   TO GROSS-INVOICED.            10150024
101600     MOVE AP051-AMT-SBJ-DISCOUNT    TO TYPE6-AMT-SUBJ-DISC.       10160024
101700     MOVE AP051-DISCOUNT-AMT        TO TYPE6-DISC-AMT.            10170024
101800     MOVE AP051-DISCOUNTED-AMT-DUE  TO TYPE6-DISC-AMT-DUE.        10180024
101900                                                                  10190024
102000     ADD 4 TO PV-LINE-COUNT.                                      10200024
102100     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            10210024
102200        PERFORM W200-HEADING-ROUTINE                              10220045
102300     END-IF.                                                      10230045
102400                                                                  10240024
102500     WRITE EDI-LINE FROM TYPE6-LINE                               10250024
102600         AFTER ADVANCING 2 LINE.                                  10260024
102700                                                                  10270024
102800     WRITE EDI-LINE FROM TYPE6-LINE2                              10280024
102900         AFTER ADVANCING 1 LINE.                                  10290024
103000                                                                  10300024
103100     WRITE EDI-LINE FROM TYPE6-LINE3                              10310024
103200         AFTER ADVANCING 1 LINE.                                  10320024
103300                                                                  10330024
103400*--------------------------------------------------------------*  10340038
103500* PROCESS THE ITEM DETAIL RECORD                               *  10350038
103600*--------------------------------------------------------------*  10360038
103700 C600-TYPE7.                                                      10370038
103800                                                                  10380038
103900     MOVE AP051-ID-QUALIFIER        TO TYPE7-ID-QUAL.             10390024
104000                                                                  10400024
104100     IF AP051-EAN-UPC(13:1) = SPACE                               10410024
104200        MOVE ' '                       TO TYPE7-EAN-UPC(1:1)      10420024
104300        MOVE AP051-EAN-UPC(1:1)        TO TYPE7-EAN-UPC(2:1)      10430024
104400        MOVE '-'                       TO TYPE7-EAN-UPC(3:1)      10440024
104500        MOVE AP051-EAN-UPC(2:5)        TO TYPE7-EAN-UPC(4:5)      10450024
104600        MOVE '-'                       TO TYPE7-EAN-UPC(9:1)      10460024
104700        MOVE AP051-EAN-UPC(7:5)        TO TYPE7-EAN-UPC(10:5)     10470024
104800        MOVE '-'                       TO TYPE7-EAN-UPC(15:1)     10480024
104900        MOVE AP051-EAN-UPC(12:1)       TO TYPE7-EAN-UPC(16:1)     10490024
105000     ELSE                                                         10500024
105100        MOVE AP051-EAN-UPC(1:2)        TO TYPE7-EAN-UPC(1:2)      10510024
105200        MOVE '-'                       TO TYPE7-EAN-UPC(3:1)      10520024
105300        MOVE AP051-EAN-UPC(3:5)        TO TYPE7-EAN-UPC(4:5)      10530024
105400        MOVE '-'                       TO TYPE7-EAN-UPC(9:1)      10540024
105500        MOVE AP051-EAN-UPC(8:5)        TO TYPE7-EAN-UPC(10:5)     10550024
105600        MOVE '-'                       TO TYPE7-EAN-UPC(15:1)     10560024
105700        MOVE AP051-EAN-UPC(13:1)       TO TYPE7-EAN-UPC(16:1)     10570026
105800     END-IF.                                                      10580026
105900                                                                  10590024
106000     MOVE AP051-KOHLS-SKU           TO TYPE7-SKU.                 10600024
106100     MOVE AP051-VENDOR-STYLE        TO TYPE7-VNDR-STYLE.          10610024
106200     MOVE AP051-VENDOR-STYLE-DSCRPT TO TYPE7-VNDR-STYLE-DESC.     10620024
106300     MOVE AP051-NRMA-COLOR-CODE     TO TYPE7-NRML-CD.             10630024
106400     MOVE AP051-VENDOR-COLOR-DSCRPT TO TYPE7-COLOR-DESC.          10640024
106500     MOVE AP051-NRMA-SIZE-CODE      TO TYPE7-SIZE-CD.             10650024
106600     MOVE AP051-VENDOR-SIZE-DSCRPT  TO TYPE7-SIZE-DESC.           10660024
106700     EVALUATE AP051-IT1-UNIT-MEASURE                              10670024
106800       WHEN 'EA'                                                  10680024
106900         MOVE 'EACH     ' TO TYPE7-UOM                            10690024
107000       WHEN 'PK'                                                  10700024
107100         MOVE 'PACK     ' TO TYPE7-UOM                            10710024
107200       WHEN 'PR'                                                  10720024
107300         MOVE 'PAIR     ' TO TYPE7-UOM                            10730024
107400       WHEN 'ST'                                                  10740024
107500         MOVE 'SET      ' TO TYPE7-UOM                            10750024
107600       WHEN 'AS'                                                  10760024
107700         MOVE 'PACK HDR ' TO TYPE7-UOM                            10770024
107800       WHEN 'PI'                                                  10780024
107900         MOVE 'PACKITEM ' TO TYPE7-UOM                            10790024
108000     END-EVALUATE.                                                10800024
108100                                                                  10810024
108200     MOVE AP051-QUANTITY-INVOICED   TO TYPE7-QTY-INVD.            10820024
108300     MOVE AP051-WHOLSALE-UNIT-COST  TO TYPE7-WHOL-COST.           10830024
108400                                                                  10840024
108500     IF AP051-IT1-MSR-PK-HDR                                      10850026
108600        MOVE 'PACK UPC: '              TO TYPE7-UPC-TITLE         10860026
108700        MOVE 'PACK COST: '             TO TYPE7-UNT-CST-TITLE     10870027
108800        MOVE AP051-PK-ITEM-SUMD-COST   TO TYPE7-PK-ITEM-SUMD-COST 10880028
108900        ADD 7 TO PV-LINE-COUNT                                    10890026
109000     ELSE                                                         10900026
109100        MOVE 'UPC CODE: '              TO TYPE7-UPC-TITLE         10910026
109200        MOVE 'UNIT COST: '             TO TYPE7-UNT-CST-TITLE     10920027
109300        ADD 6 TO PV-LINE-COUNT                                    10930026
109400     END-IF.                                                      10940026
109500                                                                  10950026
109600     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            10960024
109700        PERFORM W200-HEADING-ROUTINE                              10970045
109800     END-IF.                                                      10980045
109900                                                                  10990024
110000     WRITE EDI-LINE FROM TYPE7-LINE                               11000024
110100         AFTER ADVANCING 2 LINE.                                  11010024
110200                                                                  11020024
110300     WRITE EDI-LINE FROM TYPE7-LINE2                              11030024
110400         AFTER ADVANCING 1 LINE.                                  11040024
110500                                                                  11050024
110600     WRITE EDI-LINE FROM TYPE7-LINE3                              11060024
110700         AFTER ADVANCING 1 LINE.                                  11070024
110800                                                                  11080024
110900     WRITE EDI-LINE FROM TYPE7-LINE4                              11090024
111000         AFTER ADVANCING 1 LINE.                                  11100024
111100                                                                  11110024
111200     WRITE EDI-LINE FROM TYPE7-LINE5                              11120024
111300         AFTER ADVANCING 1 LINE.                                  11130024
111400                                                                  11140024
111500     IF AP051-IT1-MSR-PK-HDR                                      11150026
111600        WRITE EDI-LINE FROM TYPE7-LINE6                           11160026
111700            AFTER ADVANCING 1 LINE                                11170026
111800     END-IF.                                                      11180026
111900                                                                  11190024
112000*--------------------------------------------------------------*  11200043
112100* PROCESS THE HIGH-VALUES RECORD                               *  11210043
112200*--------------------------------------------------------------*  11220043
112300 C650-HIGH-VALUES.                                                11230043
112400                                                                  11240043
112500     IF AP051-ERR-TOO-MANY-LINES                                  11250043
112600        MOVE AP051-TOT-INVC-LINES TO PV-TOT-INVC-LINES            11260043
112700     END-IF.                                                      11270043
112800                                                                  11280043
112900*--------------------------------------------------------------*  11290038
113000* PROCESS AN INVALID RECORD TYPE                               *  11300038
113100*--------------------------------------------------------------*  11310038
113200 C700-INVALID-TYPE.                                               11320038
113300                                                                  11330038
113400     ADD 1 TO PV-LINE-COUNT.                                      11340024
113500     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            11350024
113600        PERFORM W200-HEADING-ROUTINE                              11360045
113700     END-IF.                                                      11370045
113800                                                                  11380024
113900     MOVE AP051-RECORD-TYPE-IND TO TYPE-OTH-REC-TYPE.             11390024
114000                                                                  11400024
114100     WRITE EDI-LINE FROM TYPE-OTH-LINE                            11410024
114200         AFTER ADVANCING 1 LINE.                                  11420024
114300                                                                  11430024
114400*--------------------------------------------------------------*  11440038
114500* CHECK FOR ERROR CODES AND PRINT 2 PER REPORT LINE            *  11450038
114600*--------------------------------------------------------------*  11460038
114700 E100-ERROR-ROUTINE.                                              11470038
114800                                                                  11480038
114900     ADD 1 TO PV-LINE-COUNT.                                      11490024
115000     IF PV-LINE-COUNT >= PV-LINE-LIMIT - 1                        11500024
115100        PERFORM W200-HEADING-ROUTINE                              11510045
115200     END-IF.                                                      11520045
115300                                                                  11530024
115400     WRITE EDI-LINE FROM ERROR-DESC-LINE                          11540024
115500         AFTER ADVANCING 1 LINE.                                  11550024
115600                                                                  11560024
115700     SET ERRLN-INDX TO 1.                                         11570024
115800     SET ERRLN-INDX DOWN BY 1.                                    11580024
115900     MOVE SPACES TO ERROR-LINE-AREA.                              11590024
116000                                                                  11600024
116100     PERFORM VARYING AP051-INDX FROM 1 BY 1                       11610024
116200        UNTIL AP051-INDX > 25                                     11620024
116300           OR AP051-ERR-CD(AP051-INDX) = ZEROS                    11630024
116400           SET ERR-INDX TO AP051-ERR-CD(AP051-INDX)               11640024
116500           SET FLG-INDX TO ERR-INDX                               11650024
116600           MOVE 'X' TO SUMM-ERR-FLAG(FLG-INDX)                    11660024
116700           SET ERRLN-INDX UP BY 1                                 11670024
116800           MOVE '*' TO ERR-ASTR-1(ERRLN-INDX)                     11680024
116900           MOVE '*' TO ERR-ASTR-2(ERRLN-INDX)                     11690024
117000           MOVE AP051-ERR-CD(AP051-INDX) TO PV-EDIT-CODE          11700024
117100                                            ERR-NMBR(ERRLN-INDX)  11710024
117200           PERFORM Y100-PROCESS-ERROR-MSG                         11720024
117300           MOVE PV-ERROR-MSG TO ERR-DATA(ERRLN-INDX)              11730024
117400                                                                  11740024
117500           IF ERRLN-INDX = 2                                      11750024
117600              PERFORM W600-WRITE-ERROR-LINE                       11760024
117700              SET ERRLN-INDX TO 1                                 11770024
117800              SET ERRLN-INDX DOWN BY 1                            11780024
117900              MOVE SPACES TO ERROR-LINE-AREA                      11790024
118000           END-IF                                                 11800024
118100     END-PERFORM.                                                 11810024
118200                                                                  11820024
118300     IF ERRLN-INDX > 0                                            11830024
118400        PERFORM W600-WRITE-ERROR-LINE                             11840045
118500     END-IF.                                                      11850045
118600                                                                  11860024
118700     IF AP051-ERR-DETL-GROSS-INV                                  11870024
118800        MOVE AP051-CALC-SUM-EXTEN   TO CALC-GROSS-EXTEN           11880024
118900        SET ERR-DETAIL-GROSS-INVOICE TO TRUE                      11890024
119000        WRITE EDI-LINE FROM CALC-GROSS-LINE                       11900024
119100            AFTER ADVANCING 1 LINE                                11910045
119200     END-IF.                                                      11920045
119300                                                                  11930024
119400*--------------------------------------------------------------*  11940038
119500* PERFORM ALL DATE ROUTINES, FILE OPENS, ETC                   *  11950038
119600*--------------------------------------------------------------*  11960038
119700 H000-HOUSEKEEPING.                                               11970038
119800                                                                  11980038
119900     ACCEPT SD-SYSTEM-DATE FROM DATE.                             11990024
120000     ACCEPT ST-SYSTEM-TIME FROM TIME.                             12000024
120100                                                                  12010024
120200     ACCEPT REPORT-TYPE-CONTROL.                                  12020024
120300     EVALUATE REPORT-TYPE-CONTROL                                 12030024
120400        WHEN 'T'                                                  12040024
120500          MOVE '     EDI TEST DATA       ' TO HEADER-TYPE         12050024
120600                                              HEADER-TYPE1-2      12060024
120700        WHEN 'P'                                                  12070024
120800          MOVE '  EDI PRODUCTION DATA    ' TO HEADER-TYPE         12080024
120900                                              HEADER-TYPE1-2      12090024
121000        WHEN 'A'                                                  12100024
121100          MOVE ' EDI PRE-PRODUCTION DATA ' TO HEADER-TYPE         12110024
121200                                              HEADER-TYPE1-2      12120024
121300        WHEN OTHER                                                12130024
121400          MOVE '   DATA TYPE UNKNOWN     ' TO HEADER-TYPE         12140024
121500                                              HEADER-TYPE1-2      12150024
121600     END-EVALUATE.                                                12160024
121700                                                                  12170024
121800     DISPLAY 'TYPE OF REPORT = ' REPORT-TYPE-CONTROL.             12180024
121900                                                                  12190024
122000     MOVE SD-SYSTEM-YEAR TO DP132O-RUN-YEAR.                      12200024
122100     MOVE SD-SYSTEM-MONTH TO DP132O-RUN-MONTH.                    12210024
122200     MOVE SD-SYSTEM-DAY TO DP132O-RUN-DAY.                        12220024
122300                                                                  12230024
122400     MOVE ST-SYSTEM-HOUR TO DP132O-RUN-HOUR.                      12240024
122500     MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE.                  12250024
122600                                                                  12260024
122700     MOVE PV-PROGRAM-NAME TO DP132O-PROGRAM-NAME.                 12270024
122800                                                                  12280024
122900     MOVE SPACES TO SUMM-ERR-TABLE.                               12290024
123000                                                                  12300024
123100     PERFORM R100-READ-EDI-REJECT.                                12310024
123200     IF WS-EDI-REJ-EOF                                            12320024
123300        DISPLAY '********************************* *'             12330024
123400        DISPLAY '*   EMPTY EDI REJECTION FILE      *'             12340024
123500        DISPLAY '*   PROGRAM ** = APKRP204         *'             12350024
123600        DISPLAY '*   PARAGRAPH  = H000-HOUSEKEEPING*'             12360024
123700        DISPLAY '***********************************'             12370024
123800        MOVE ZEROS                     TO HL2-VENDOR-NBR          12380024
123900                                          HL2-PO-NBR              12390024
124000                                          HL2-INTERCHG-CNTL-NBR   12400024
124100        MOVE SPACES                    TO HL2-INVOICE-NBR         12410024
124200                                          HL2-ENT-ID-DESC         12420024
124300        PERFORM W200-HEADING-ROUTINE                              12430024
124400        WRITE EDI-LINE FROM NO-DATA-LINE                          12440024
124500        PERFORM W500-SUMMARY-HEADING                              12450024
124600        WRITE EDI-SUMM-LINE FROM NO-DATA-LINE                     12460024
124700            AFTER ADVANCING 2 LINE                                12470024
124800        SET WS-EDI-REJ-EMPTY-FILE TO TRUE                         12480024
124900     ELSE                                                         12490024
125000        MOVE AP051-SORT-VENDOR-NBR        TO HL2-VENDOR-NBR       12500024
125100        MOVE AP051-SORT-INVOICE-NBR       TO HL2-INVOICE-NBR      12510024
125200        MOVE AP051-KOHLS-PO-NBR           TO HL2-PO-NBR           12520024
125300        MOVE AP051-VENDOR-DESC            TO HL2-ENT-ID-DESC      12530024
125400        MOVE AP051-SAVE-INTERCHG-CNTL-NBR TO HL2-INTERCHG-CNTL-NBR12540024
125500        PERFORM W200-HEADING-ROUTINE                              12550024
125600        PERFORM W500-SUMMARY-HEADING                              12560045
125700     END-IF.                                                      12570045
125800                                                                  12580024
125900*--------------------------------------------------------------*  12590038
126000* READ THE EDI TRANSMISSION REJECTION FILE                     *  12600038
126100*--------------------------------------------------------------*  12610038
126200 R100-READ-EDI-REJECT.                                            12620038
126300                                                                  12630038
126400     READ EDI-REJ-FILE          INTO WS-EDI-REJECT-REC            12640038
126500       AT END                                                     12650038
126600          SET WS-EDI-REJ-EOF    TO TRUE                           12660038
126700     END-READ.                                                    12670038
126800                                                                  12680024
126900*--------------------------------------------------------------*  12690038
127000* WRITE THE SUMMARY REPORT LINES                               *  12700038
127100*--------------------------------------------------------------*  12710038
127200 W000-SUMMARY-LINES.                                              12720038
127300                                                                  12730038
127400     ADD 3 TO PV-LINE-COUNT-2.                                    12740024
127500     IF PV-LINE-COUNT-2 >= PV-LINE-LIMIT - 1                      12750024
127600        PERFORM W500-SUMMARY-HEADING                              12760045
127700     END-IF.                                                      12770045
127800                                                                  12780024
127900     WRITE EDI-SUMM-LINE FROM HL-HEADING-LINE2                    12790024
128000         AFTER ADVANCING 2 LINE.                                  12800024
128100                                                                  12810024
128200     WRITE EDI-SUMM-LINE FROM ERROR-DESC-LINE                     12820024
128300         AFTER ADVANCING 1 LINE.                                  12830024
128400                                                                  12840024
128500     SET ERRLN-INDX TO 1.                                         12850024
128600     SET ERRLN-INDX DOWN BY 1.                                    12860024
128700     MOVE SPACES TO ERROR-LINE-AREA.                              12870024
128800                                                                  12880024
128900     MOVE ZERO TO PV-ERROR-CODE.                                  12890024
129000     PERFORM VARYING FLG-INDX   FROM 1 BY 1                       12900024
129100        UNTIL FLG-INDX   > 99                                     12910024
129200           ADD 1 TO PV-ERROR-CODE                                 12920024
129300           IF SUMM-ERR-FLAG(FLG-INDX) = 'X'                       12930024
129400              SET ERR-INDX TO FLG-INDX                            12940024
129500              SET ERRLN-INDX UP BY 1                              12950024
129600              MOVE '*' TO ERR-ASTR-1(ERRLN-INDX)                  12960024
129700              MOVE '*' TO ERR-ASTR-2(ERRLN-INDX)                  12970024
129800              MOVE PV-ERROR-CODE TO PV-EDIT-CODE                  12980024
129900                                    ERR-NMBR(ERRLN-INDX)          12990024
130000              PERFORM Y100-PROCESS-ERROR-MSG                      13000024
130100              MOVE PV-ERROR-MSG TO ERR-DATA(ERRLN-INDX)           13010024
130200                                                                  13020024
130300              IF ERRLN-INDX = 2                                   13030024
130400                 PERFORM W100-WRITE-SUMM-ERR-LINE                 13040024
130500                 SET ERRLN-INDX TO 1                              13050024
130600                 SET ERRLN-INDX DOWN BY 1                         13060024
130700                 MOVE SPACES TO ERROR-LINE-AREA                   13070024
130800              END-IF                                              13080024
130900           END-IF                                                 13090024
131000     END-PERFORM.                                                 13100024
131100                                                                  13110024
131200     IF ERRLN-INDX > 0                                            13120024
131300        PERFORM W100-WRITE-SUMM-ERR-LINE                          13130045
131400     END-IF.                                                      13140045
131500                                                                  13150024
131600     MOVE SPACES TO SUMM-ERR-TABLE.                               13160024
131700     IF ERR-DETAIL-GROSS-INVOICE                                  13170024
131800        WRITE EDI-SUMM-LINE FROM CALC-GROSS-LINE                  13180024
131900          AFTER ADVANCING 1 LINE                                  13190045
132000     END-IF.                                                      13200045
132100                                                                  13210024
132200     ADD 3 TO PV-LINE-COUNT-2.                                    13220024
132300     WRITE EDI-SUMM-LINE FROM DIVIDE-LINE                         13230024
132400         AFTER ADVANCING 2 LINE.                                  13240024
132500                                                                  13250024
132600*--------------------------------------------------------------*  13260038
132700* WRITE THE SUMMARY ERROR LINES                                *  13270038
132800*--------------------------------------------------------------*  13280038
132900 W100-WRITE-SUMM-ERR-LINE.                                        13290038
133000                                                                  13300038
133100     ADD 1 TO PV-LINE-COUNT-2.                                    13310024
133200     IF PV-LINE-COUNT-2 >= PV-LINE-LIMIT                          13320024
133300        PERFORM W500-SUMMARY-HEADING                              13330045
133400     END-IF.                                                      13340045
133500                                                                  13350024
133600     WRITE EDI-SUMM-LINE FROM ERROR-LINE                          13360024
133700         AFTER ADVANCING 1 LINE.                                  13370024
133800                                                                  13380024
133900*--------------------------------------------------------------*  13390038
134000* WRITE THE DETAIL LINE HEADING                                *  13400038
134100*--------------------------------------------------------------*  13410038
134200 W200-HEADING-ROUTINE.                                            13420038
134300                                                                  13430024
134400     ADD 1 TO PV-PAGE-COUNT.                                      13440024
134500     EVALUATE REPORT-TYPE-CONTROL                                 13450024
134600        WHEN 'T'                                                  13460024
134700           MOVE 1 TO DP132O-REPORT-NUMBER                         13470024
134800        WHEN 'A'                                                  13480024
134900           MOVE 3 TO DP132O-REPORT-NUMBER                         13490024
135000        WHEN 'P'                                                  13500024
135100           MOVE 5 TO DP132O-REPORT-NUMBER                         13510024
135200        WHEN OTHER                                                13520024
135300           MOVE 1 TO DP132O-REPORT-NUMBER                         13530024
135400     END-EVALUATE.                                                13540024
135500                                                                  13550024
135600     MOVE  9 TO PV-LINE-COUNT.                                    13560024
135700                                                                  13570024
135800     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    13580024
135900                                                                  13590024
136000     WRITE EDI-LINE FROM DP132O-STANDRD-HEADER-132-COLS           13600024
136100         AFTER ADVANCING PAGE.                                    13610024
136200                                                                  13620024
136300     WRITE EDI-LINE FROM HL-HEADING-LINE1                         13630024
136400         AFTER ADVANCING 2 LINE.                                  13640024
136500                                                                  13650024
136600     WRITE EDI-LINE FROM HL-HEADING-LINE2                         13660024
136700         AFTER ADVANCING 2 LINE.                                  13670024
136800                                                                  13680024
136900     WRITE EDI-LINE FROM DIVIDE-LINE                              13690024
137000         AFTER ADVANCING 2 LINE.                                  13700024
137100                                                                  13710024
137200*--------------------------------------------------------------*  13720038
137300* PRINT THE RECORD TYPE DIVIDING LINE                          *  13730038
137400*--------------------------------------------------------------*  13740038
137500 W400-PRINT-DIVIDE-LINE.                                          13750038
137600                                                                  13760038
137700     ADD 3 TO PV-LINE-COUNT.                                      13770024
137800     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            13780024
137900        PERFORM W200-HEADING-ROUTINE                              13790024
138000     ELSE                                                         13800024
138100        WRITE EDI-LINE FROM DIVIDE-LINE                           13810024
138200            AFTER ADVANCING 2 LINE                                13820045
138300     END-IF.                                                      13830045
138400                                                                  13840024
138500*--------------------------------------------------------------*  13850038
138600* SUMMARY REPORT HEADING ROUTINE                               *  13860038
138700*--------------------------------------------------------------*  13870038
138800 W500-SUMMARY-HEADING.                                            13880038
138900                                                                  13890038
139000     ADD 1 TO PV-PAGE-COUNT-2.                                    13900024
139100     EVALUATE REPORT-TYPE-CONTROL                                 13910024
139200        WHEN 'T'                                                  13920024
139300           MOVE 2 TO DP132O-REPORT-NUMBER                         13930024
139400        WHEN 'A'                                                  13940024
139500           MOVE 4 TO DP132O-REPORT-NUMBER                         13950024
139600        WHEN 'P'                                                  13960024
139700           MOVE 6 TO DP132O-REPORT-NUMBER                         13970024
139800        WHEN OTHER                                                13980024
139900           MOVE 2 TO DP132O-REPORT-NUMBER                         13990024
140000     END-EVALUATE.                                                14000024
140100                                                                  14010024
140200     MOVE  7 TO PV-LINE-COUNT-2.                                  14020024
140300                                                                  14030024
140400     MOVE PV-PAGE-COUNT-2 TO DP132O-PAGE-NUMBER.                  14040024
140500                                                                  14050024
140600     WRITE EDI-SUMM-LINE FROM DP132O-STANDRD-HEADER-132-COLS      14060024
140700         AFTER ADVANCING PAGE.                                    14070024
140800                                                                  14080024
140900     WRITE EDI-SUMM-LINE FROM HL-HEADING-LINE1-2                  14090024
141000         AFTER ADVANCING 2 LINE.                                  14100024
141100                                                                  14110024
141200     WRITE EDI-SUMM-LINE FROM DIVIDE-LINE                         14120024
141300         AFTER ADVANCING 2 LINE.                                  14130024
141400                                                                  14140024
141500*--------------------------------------------------------------*  14150038
141600* WRITE THE DETAIL REPORT ERROR LINE                           *  14160038
141700*--------------------------------------------------------------*  14170038
141800 W600-WRITE-ERROR-LINE.                                           14180038
141900                                                                  14190038
142000     ADD 1 TO PV-LINE-COUNT.                                      14200024
142100     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            14210024
142200        PERFORM W200-HEADING-ROUTINE                              14220045
142300     END-IF.                                                      14230045
142400                                                                  14240024
142500     WRITE EDI-LINE FROM ERROR-LINE                               14250024
142600         AFTER ADVANCING 1 LINE.                                  14260046
142700                                                                  14270046
142800                                                                  14280024
142900*--------------------------------------------------------------*  14290038
143000* WRITE THE DETAIL REPORT END OF INVOICE LINE                  *  14300038
143100*--------------------------------------------------------------*  14310038
143200 W700-END-OF-INVOICE-LINE.                                        14320038
143300                                                                  14330038
143400     ADD 1 TO PV-LINE-COUNT.                                      14340024
143500     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            14350024
143600        PERFORM W200-HEADING-ROUTINE                              14360045
143700     END-IF.                                                      14370045
143800                                                                  14380024
143900     WRITE EDI-LINE FROM END-OF-INVOICE-LINE                      14390024
144000         AFTER ADVANCING 1 LINE.                                  14400024
144100                                                                  14410024
144200*--------------------------------------------------------------*  14420038
144300* ADDS THE FIELD RELATING TO THE ERROR MESSAGE                 *  14430038
144400*--------------------------------------------------------------*  14440038
144500 Y100-PROCESS-ERROR-MSG.                                          14450024
144600                                                                  14460038
144700     MOVE SPACES TO PV-ERROR-MSG.                                 14470024
144800     EVALUATE PV-EDIT-CODE                                        14480024
144900         WHEN 11                                                  14490024
145000             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14500024
145100                    ', '                      DELIMITED BY SIZE   14510024
145200                    TYPE2-INV-YY              DELIMITED BY SIZE   14520024
145300                    '/'                       DELIMITED BY SIZE   14530024
145400                    TYPE2-INV-MM              DELIMITED BY SIZE   14540024
145500                    '/'                       DELIMITED BY SIZE   14550024
145600                    TYPE2-INV-DD              DELIMITED BY SIZE   14560024
145700               INTO PV-ERROR-MSG                                  14570024
145800             END-STRING                                           14580024
145900         WHEN 14                                                  14590024
146000             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14600024
146100                    ', '                      DELIMITED BY SIZE   14610024
146200                    TYPE5-ALLW-CHRG-CD        DELIMITED BY SIZE   14620024
146300                    '.'                       DELIMITED BY SIZE   14630024
146400               INTO PV-ERROR-MSG                                  14640024
146500             END-STRING                                           14650024
146600         WHEN 15                                                  14660024
146700             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14670024
146800                    ', '                      DELIMITED BY SIZE   14680024
146900                    TYPE5-ALLW-CHRG-CD        DELIMITED BY SIZE   14690024
147000                    '.'                       DELIMITED BY SIZE   14700024
147100               INTO PV-ERROR-MSG                                  14710024
147200             END-STRING                                           14720024
147300         WHEN 16                                                  14730024
147400             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14740024
147500                    ', '                      DELIMITED BY SIZE   14750024
147600                    TYPE5-ALLW-CHRG-TYPE      DELIMITED BY SIZE   14760024
147700                    '.'                       DELIMITED BY SIZE   14770024
147800               INTO PV-ERROR-MSG                                  14780024
147900             END-STRING                                           14790024
148000         WHEN 17                                                  14800024
148100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14810024
148200                    ', '                      DELIMITED BY SIZE   14820024
148300                    TYPE5-SPEC-SRVC-CD        DELIMITED BY SIZE   14830024
148400                    '.'                       DELIMITED BY SIZE   14840024
148500               INTO PV-ERROR-MSG                                  14850024
148600             END-STRING                                           14860024
148700         WHEN 18                                                  14870024
148800             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14880024
148900                    ', '                      DELIMITED BY SIZE   14890024
149000                    HL2-PO-NBR                DELIMITED BY SIZE   14900036
149100                    '.'                       DELIMITED BY SIZE   14910024
149200               INTO PV-ERROR-MSG                                  14920024
149300             END-STRING                                           14930024
149400         WHEN 19                                                  14940024
149500             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   14950024
149600                    ', '                      DELIMITED BY SIZE   14960024
149700                    TYPE5-ALLW-CHRG-QUAL      DELIMITED BY SIZE   14970024
149800                    '.'                       DELIMITED BY SIZE   14980024
149900               INTO PV-ERROR-MSG                                  14990024
150000             END-STRING                                           15000024
150100         WHEN 20                                                  15010024
150200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15020024
150300                    ', '                      DELIMITED BY SIZE   15030024
150400                    TYPE6-SHIP-UOM            DELIMITED BY SIZE   15040024
150500                    '.'                       DELIMITED BY SIZE   15050024
150600               INTO PV-ERROR-MSG                                  15060024
150700             END-STRING                                           15070024
150800         WHEN 21                                                  15080024
150900             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15090024
151000                    ', '                      DELIMITED BY SIZE   15100024
151100                    TYPE7-ID-QUAL             DELIMITED BY SIZE   15110024
151200                    '.'                       DELIMITED BY SIZE   15120024
151300               INTO PV-ERROR-MSG                                  15130024
151400             END-STRING                                           15140024
151500         WHEN 24                                                  15150024
151600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15160024
151700                    ', '                      DELIMITED BY SIZE   15170024
151800                    TYPE7-UOM                 DELIMITED BY SIZE   15180024
151900                    '.'                       DELIMITED BY SIZE   15190024
152000               INTO PV-ERROR-MSG                                  15200024
152100             END-STRING                                           15210024
152200         WHEN 26                                                  15220024
152300             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15230024
152400                    ', '                      DELIMITED BY SIZE   15240024
152500                    TYPE1-INTERCHG-YY         DELIMITED BY SIZE   15250024
152600                    '/'                       DELIMITED BY SIZE   15260024
152700                    TYPE1-INTERCHG-MM         DELIMITED BY SIZE   15270024
152800                    '/'                       DELIMITED BY SIZE   15280024
152900                    TYPE1-INTERCHG-DD         DELIMITED BY SIZE   15290024
153000               INTO PV-ERROR-MSG                                  15300024
153100             END-STRING                                           15310024
153200         WHEN 27                                                  15320024
153300             STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY '  '     15330024
153400                    ', STR #1 '             DELIMITED BY SIZE     15340035
153500                    TYPE2-STORE-NBR1        DELIMITED BY SIZE     15350024
153600                    ', STR #2 '             DELIMITED BY SIZE     15360035
153700                    TYPE2-STORE-NBR2        DELIMITED BY SIZE     15370024
153800               INTO PV-ERROR-MSG                                  15380024
153900             END-STRING                                           15390024
154000         WHEN 29                                                  15400024
154100             STRING EDI-ERROR-MSG(ERR-INDX) DELIMITED BY '  '     15410024
154200                    ', SKU: '               DELIMITED BY SIZE     15420024
154300                    TYPE7-SKU               DELIMITED BY SIZE     15430024
154400               INTO PV-ERROR-MSG                                  15440024
154500             END-STRING                                           15450024
154600         WHEN 40                                                  15460024
154700             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15470024
154800                    ', '                      DELIMITED BY SIZE   15480024
154900                    TYPE4-TERMS-TYPE          DELIMITED BY '  '   15490024
155000                    '.'                       DELIMITED BY SIZE   15500024
155100               INTO PV-ERROR-MSG                                  15510024
155200             END-STRING                                           15520024
155300         WHEN 41                                                  15530024
155400             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15540024
155500                    ', '                      DELIMITED BY SIZE   15550024
155600                    TYPE4-BAS-DTE-CD          DELIMITED BY '  '   15560024
155700                    '.'                       DELIMITED BY SIZE   15570024
155800               INTO PV-ERROR-MSG                                  15580024
155900             END-STRING                                           15590024
156000         WHEN 42                                                  15600024
156100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15610024
156200                    ', '                      DELIMITED BY SIZE   15620024
156300                    TYPE2-SHP-YY              DELIMITED BY SIZE   15630024
156400                    '/'                       DELIMITED BY SIZE   15640024
156500                    TYPE2-SHP-MM              DELIMITED BY SIZE   15650024
156600                    '/'                       DELIMITED BY SIZE   15660024
156700                    TYPE2-SHP-DD              DELIMITED BY SIZE   15670024
156800               INTO PV-ERROR-MSG                                  15680024
156900             END-STRING                                           15690024
157000         WHEN 43                                                  15700024
157100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15710024
157200                    ', '                      DELIMITED BY SIZE   15720024
157300                    TYPE2-EFF-YY              DELIMITED BY SIZE   15730024
157400                    '/'                       DELIMITED BY SIZE   15740024
157500                    TYPE2-EFF-MM              DELIMITED BY SIZE   15750024
157600                    '/'                       DELIMITED BY SIZE   15760024
157700                    TYPE2-EFF-DD              DELIMITED BY SIZE   15770024
157800               INTO PV-ERROR-MSG                                  15780024
157900             END-STRING                                           15790024
158000         WHEN 44                                                  15800024
158100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15810024
158200                    ', '                      DELIMITED BY SIZE   15820024
158300                    TYPE4-DISC-DUE-YY         DELIMITED BY SIZE   15830024
158400                    '/'                       DELIMITED BY SIZE   15840024
158500                    TYPE4-DISC-DUE-MM         DELIMITED BY SIZE   15850024
158600                    '/'                       DELIMITED BY SIZE   15860024
158700                    TYPE4-DISC-DUE-DD         DELIMITED BY SIZE   15870024
158800               INTO PV-ERROR-MSG                                  15880024
158900             END-STRING                                           15890024
159000         WHEN 45                                                  15900024
159100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   15910024
159200                    ', '                      DELIMITED BY SIZE   15920024
159300                    TYPE4-NET-DUE-YY          DELIMITED BY SIZE   15930024
159400                    '/'                       DELIMITED BY SIZE   15940024
159500                    TYPE4-NET-DUE-MM          DELIMITED BY SIZE   15950024
159600                    '/'                       DELIMITED BY SIZE   15960024
159700                    TYPE4-NET-DUE-DD          DELIMITED BY SIZE   15970024
159800               INTO PV-ERROR-MSG                                  15980024
159900             END-STRING                                           15990024
160000         WHEN 46                                                  16000024
160100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16010024
160200                    ', '                      DELIMITED BY SIZE   16020024
160300                    TYPE4-DEF-DUE-YY          DELIMITED BY SIZE   16030024
160400                    '/'                       DELIMITED BY SIZE   16040024
160500                    TYPE4-DEF-DUE-MM          DELIMITED BY SIZE   16050024
160600                    '/'                       DELIMITED BY SIZE   16060024
160700                    TYPE4-DEF-DUE-DD          DELIMITED BY SIZE   16070024
160800               INTO PV-ERROR-MSG                                  16080024
160900             END-STRING                                           16090024
161000         WHEN 51                                                  16100024
161100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16110024
161200                    TYPE6-DISC-AMT-DUE        DELIMITED BY SIZE   16120024
161300                    '>'                       DELIMITED BY SIZE   16130024
161400                    TYPE6-GROSS-INV-AMT       DELIMITED BY SIZE   16140024
161500               INTO PV-ERROR-MSG                                  16150024
161600             END-STRING                                           16160024
161700         WHEN 53                                                  16170024
161800             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16180024
161900                    ', '                      DELIMITED BY SIZE   16190024
162000                    TYPE4-DISC-PCT            DELIMITED BY SIZE   16200024
162100               INTO PV-ERROR-MSG                                  16210024
162200             END-STRING                                           16220024
162300         WHEN 54                                                  16230024
162400             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16240024
162500                    ', '                      DELIMITED BY SIZE   16250024
162600                    TYPE4-DISC-AMT            DELIMITED BY SIZE   16260024
162700                    '.'                       DELIMITED BY SIZE   16270024
162800               INTO PV-ERROR-MSG                                  16280024
162900             END-STRING                                           16290024
163000         WHEN 55                                                  16300024
163100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16310024
163200                    ', '                      DELIMITED BY SIZE   16320024
163300                    TYPE4-DEF-PCT-PAY         DELIMITED BY SIZE   16330024
163400                    '.'                       DELIMITED BY SIZE   16340024
163500               INTO PV-ERROR-MSG                                  16350024
163600             END-STRING                                           16360024
163700         WHEN 56                                                  16370024
163800             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16380024
163900                    ', '                      DELIMITED BY SIZE   16390024
164000                    TYPE4-DEF-AMT             DELIMITED BY SIZE   16400024
164100                    '.'                       DELIMITED BY SIZE   16410024
164200               INTO PV-ERROR-MSG                                  16420024
164300             END-STRING                                           16430024
164400         WHEN 57                                                  16440024
164500             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16450024
164600                    ', '                      DELIMITED BY SIZE   16460024
164700                    TYPE5-ALLW-CHRG-TOTL      DELIMITED BY SIZE   16470024
164800                    '.'                       DELIMITED BY SIZE   16480024
164900               INTO PV-ERROR-MSG                                  16490024
165000             END-STRING                                           16500024
165100         WHEN 58                                                  16510024
165200             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16520024
165300                    ', '                      DELIMITED BY SIZE   16530024
165400                    TYPE5-ALLW-CHRG-PCT       DELIMITED BY SIZE   16540024
165500                    '.'                       DELIMITED BY SIZE   16550024
165600               INTO PV-ERROR-MSG                                  16560024
165700             END-STRING                                           16570024
165800         WHEN 59                                                  16580024
165900             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16590024
166000                    ', '                      DELIMITED BY SIZE   16600024
166100                    TYPE6-GROSS-INV-AMT       DELIMITED BY SIZE   16610024
166200                    '.'                       DELIMITED BY SIZE   16620024
166300               INTO PV-ERROR-MSG                                  16630024
166400             END-STRING                                           16640024
166500         WHEN 60                                                  16650024
166600             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16660024
166700                    ', '                      DELIMITED BY SIZE   16670024
166800                    TYPE6-AMT-SUBJ-DISC       DELIMITED BY SIZE   16680024
166900                    '.'                       DELIMITED BY SIZE   16690024
167000               INTO PV-ERROR-MSG                                  16700024
167100             END-STRING                                           16710024
167200         WHEN 61                                                  16720024
167300             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16730024
167400                    ', '                      DELIMITED BY SIZE   16740024
167500                    TYPE6-DISC-AMT            DELIMITED BY SIZE   16750024
167600                    '.'                       DELIMITED BY SIZE   16760024
167700               INTO PV-ERROR-MSG                                  16770024
167800             END-STRING                                           16780024
167900         WHEN 62                                                  16790024
168000             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16800024
168100                    ', '                      DELIMITED BY SIZE   16810024
168200                    TYPE6-DISC-AMT-DUE        DELIMITED BY SIZE   16820024
168300                    '.'                       DELIMITED BY SIZE   16830024
168400               INTO PV-ERROR-MSG                                  16840024
168500             END-STRING                                           16850024
168600         WHEN 63                                                  16860024
168700             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16870024
168800                    ', '                      DELIMITED BY SIZE   16880024
168900                    TYPE7-QTY-INVD            DELIMITED BY SIZE   16890024
169000                    '.'                       DELIMITED BY SIZE   16900024
169100               INTO PV-ERROR-MSG                                  16910024
169200             END-STRING                                           16920024
169300         WHEN 64                                                  16930024
169400             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   16940024
169500                    ', '                      DELIMITED BY SIZE   16950024
169600                    TYPE7-WHOL-COST           DELIMITED BY SIZE   16960024
169700                    '.'                       DELIMITED BY SIZE   16970024
169800               INTO PV-ERROR-MSG                                  16980024
169900             END-STRING                                           16990024
170000         WHEN 70                                                  17000024
170100             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17010024
170200                    ', '                      DELIMITED BY SIZE   17020024
170300                    TYPE1-SENDER-ID           DELIMITED BY SIZE   17030024
170400                    '.'                       DELIMITED BY SIZE   17040024
170500               INTO PV-ERROR-MSG                                  17050024
170600             END-STRING                                           17060024
170700         WHEN 74                                                  17070024
170800             MOVE EDI-ERROR-MSG(80) TO PV-ERROR-MSG               17080024
170900         WHEN 75                                                  17090043
171000             STRING EDI-ERROR-MSG(ERR-INDX)   DELIMITED BY '  '   17100043
171100                    ' = '                     DELIMITED BY SIZE   17110043
171200                    PV-TOT-INVC-LINES         DELIMITED BY SIZE   17120043
171300                    '.'                       DELIMITED BY SIZE   17130043
171400               INTO PV-ERROR-MSG                                  17140044
171500             END-STRING                                           17150043
171600         WHEN OTHER                                               17160024
171700             MOVE EDI-ERROR-MSG(ERR-INDX) TO PV-ERROR-MSG         17170024
171800     END-EVALUATE.                                                17180024
171900                                                                  17190024
172000*--------------------------------------------------------------*  17200038
172100* END OF JOB ROUTINES, PRINT COUNTS, CLOSE FILES               *  17210038
172200*--------------------------------------------------------------*  17220038
172300 Z900-END-OF-JOB.                                                 17230038
172400                                                                  17240038
172500     ADD 1 TO PV-LINE-COUNT.                                      17250024
172600     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            17260024
172700        PERFORM W200-HEADING-ROUTINE                              17270045
172800     END-IF.                                                      17280045
172900                                                                  17290024
173000     IF NOT WS-EDI-REJ-EMPTY-FILE                                 17300024
173100        WRITE EDI-LINE FROM END-OF-INVOICE-LINE                   17310024
173200            AFTER ADVANCING 1 LINE                                17320045
173300     END-IF.                                                      17330045
173400                                                                  17340024
173500     ADD 2 TO PV-LINE-COUNT.                                      17350024
173600     IF PV-LINE-COUNT >= PV-LINE-LIMIT                            17360024
173700        PERFORM W200-HEADING-ROUTINE                              17370045
173800     END-IF.                                                      17380045
173900                                                                  17390024
174000     IF NOT WS-EDI-REJ-EMPTY-FILE                                 17400024
174100        WRITE EDI-LINE FROM EOR-END-OF-REPORT-LINE                17410024
174200            AFTER ADVANCING 2 LINE                                17420045
174300     END-IF.                                                      17430045
174400                                                                  17440024
174500     IF NOT WS-EDI-REJ-EMPTY-FILE                                 17450024
174600        PERFORM W000-SUMMARY-LINES                                17460045
174700     END-IF.                                                      17470045
174800                                                                  17480024
174900     CLOSE EDI-REJ-FILE                                           17490024
175000           EDI-REPORT                                             17500024
175100           EDI-SUMM-REPORT.                                       17510024
