000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    XLKUT067.                                         00020036
000300 AUTHOR.        THERESE RAMSEYER.                                 00030036
000400                                                                  00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  DECEMBER 2003.                                    00060036
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 CONFIGURATION SECTION.                                           00100000
001100 SOURCE-COMPUTER. IBM-3090.                                       00110000
001200 OBJECT-COMPUTER. IBM-3090.                                       00120000
001300                                                                  00130000
001400****************************************************************  00140000
001500* !!!!!!!!!!!!!     I M P O R T A N T   !!!!!!!!!!!!!!!!!!     *  00150081
001600* THIS MODULE CAN BE ACCESSED FROM BOTH BATCH AND CICS, SO     *  00160081
001700* IT MUST BE COMPILED FOR BOTH ENVIRONMENTS.                   *  00170081
001800****************************************************************  00180081
001900* THIS IS A MODULE THAT WILL BE USED TO ACCESS THE DOMAIN COPY *  00190036
002000* OF THE XLT_USR (KOHLS) -OR- DLT_TMP_EMP (TEMP) TABLES IN     *  00200082
002100* ORDER TO OBTAIN USER_ID GIVEN A NAME OR VICE VERSA.          *  00210082
002200****************************************************************  00220082
002300*                                                              *  00230081
002400* THE(USER ID) OR (FIRST & LAST NAME) ARE REQUIRED  TO         *  00240099
002500* DETERMINE THE ACCESS METHOD. THE REQUIRED VIEW SELECTION     *  00250081
002600* CAN BE EITHER KOHLS, TEMP OR BOTH.                           *  00260081
002700*                                                              *  00270000
002800* PARAGRAPHS: THE NAMING GOES BY THE ACCESS METHODS AND VIEW   *  00280094
002900*             SELECTION (EX 3000-KOHLS-USERID GETS THE KOHLS   *  00290082
003000*                        XLT_USR TABLE USING THE USR_ID AS KEY)*  00300082
003100*                                                              *  00310000
003200* WHEN A USER ID IS USED TO GET THE NAME, THE FOLLOWING WILL   *  00320082
003300* BE RETURNED: FIRST NAME           : JOHN                     *  00330082
003400*              MIDDLE INITIAL       : P                        *  00340082
003500*              LAST NAME            : SMITH                    *  00350082
003600*              XL067-COMBINED-NAME-1: SMITH, JOHN              *  00360082
003700*              XL067-COMBINED-NAME-2: JOHN SMITH               *  00370082
003800*              XL067-COMBINED-NAME-3: SMITH, JOHN, P           *  00380082
003900*              XL067-COMBINED-NAME-4: JOHN P SMITH             *  00390082
004000*              XL067-COMBINED-NAME-5: TK99999-SMITH, JOHN, P   *  00400082
004100*                                                              *  00410082
004200* THE DLT_TMP_EMP TABLE DOES NOT CONTAIN A FIELD FOR MIDDLE    *  00420082
004300* INITIAL.                                                     *  00430082
004400*                                                              *  00440082
004500* THE NAME FIELDS MAY ALSO CONTAIN THE TEXT "** UNKNOWN **" OR *  00450082
004600* "** MULTIPLES **" FOR THE RESPECTIVE SQLCODES +100 OR -811.  *  00460082
004700*                                                              *  00470082
004800* WHEN THE USER_ID IS REQUESTED, ALL OF THE NAME FORMATS       *  00480082
004900* WILL BE RETURNED AS WELL - PROVIDED THE USER_ID IS FOUND.    *  00490082
005000*                                                              *  00500082
005100* WHEN BOTH KOHLS AND TEMP IS SELECTED, THE PROCESSING WILL    *  00510082
005200* FIRST GO AFTER THE KOHLS TABLE, THEN THE TEMP.               *  00520082
005300*                                                              *  00530094
005400* -----------------------                                      *  00540097
005500*     NOTES FOR                                                *  00550097
005600* USING THIS SUB-ROUTINE:                                      *  00560097
005700* -----------------------                                      *  00570094
005800* 1) CHOOSE THE ACCESS METHOD - EITHER USER OR NAME            *  00580094
005900* 2) CHOSSE THE VIEW SELECTION - EITHER KOHLS, TEMP OR BOTH    *  00590094
006000* 3) LOAD YOUR KEYS - EITHER FIRST & LAST NAMES OR USERID      *  00600094
006100*                                                              *  00610094
006200* IF YOU USE NAME TO OBTAIN USERID, THE ROUTINE STILL RETURNS  *  00620094
006300* THE NAME IN ALL THE POSSIBLE FORMATS. SPACES FOR A FIRST     *  00630094
006400* NAME OR MIDDLE INITIAL FROM THE XLT_USR TABLE MEANS THAT     *  00640094
006500* IT WAS NULL. NO NULLS ARE ALLOWED ON THE DLT_TMP_EMP TABLE.  *  00650094
006600* A RETURN CODE OF '09' = XL067-KOHLS-FNME-OR-MI-NULL - THEN   *  00660097
006700* IT IS NECESSARY TO OBTAIN THE LAST NAME FROM THE OUTPUT:     *  00670097
006800* XL067-LAST-NAME.                                             *  00680097
006900****************************************************************  00690000
007000                                                                  00700000
007100 DATA DIVISION.                                                   00710000
007200 WORKING-STORAGE SECTION.                                         00720000
007300                                                                  00730000
007400 01  PROGRAM-VARIABLES.                                           00740050
007500     05  PV-PARA                  PIC X(05)  VALUE SPACES.        00750039
007600     05  PV-USER-ID               PIC X(08)  VALUE SPACES.        00760039
007700     05  PV-RETRY-COUNTER         PIC S9(04) VALUE +0 COMP.       00770039
007800                                                                  00780000
007900 01  PV-NULL-INDICATORS.                                          00790094
008000     05  PV-NULL-KOHLS-FN         PIC S9(04) VALUE +0 COMP.       00800094
008100     05  PV-NULL-KOHLS-MI         PIC S9(04) VALUE +0 COMP.       00810094
008200                                                                  00820094
008300 01  PS-SWITCHES.                                                 00830000
008400     05  PS-EDITS-COMPLETE-SW         PIC X(01)  VALUE 'N'.       00840036
008500         88  PS-EDITS-COMPLETE                   VALUE 'Y'.       00850036
008600         88  PS-EDITS-NOT-COMPLETE               VALUE 'N'.       00860036
008700     05  PS-MULTIPLES-SW              PIC X(01)  VALUE 'N'.       00870059
008800         88  PS-MULTIPLES                        VALUE 'Y'.       00880059
008900         88  PS-NO-MULTIPLES                     VALUE 'N'.       00890059
009000                                                                  00900000
009100 01  PC-CONSTANTS.                                                00910000
009200     05  PC-MAX-RETRIES           PIC S9(04) VALUE +3 COMP.       00920000
009300     05  PC-MOD-NM                PIC X(08)  VALUE 'XLKUT067'.    00930086
009400     05  PC-UNKNOWN               PIC X(13)  VALUE                00940086
009500                                   '** UNKNOWN **'.               00950039
009600     05  PC-MULTIPLES             PIC X(15)  VALUE                00960039
009700                                   '** MULTIPLES **'.             00970039
009800                                                                  00980000
009900****************************************************************  00990000
010000*  TABLE DECLARATIONS                                          *  01000036
010100****************************************************************  01010000
010200                                                                  01020000
010300*     XLT_USR                                                     01030036
010400     EXEC SQL                                                     01040000
010500         INCLUDE XLT00024                                         01050037
010600     END-EXEC.                                                    01060000
010700                                                                  01070036
010800*     DLT_TMP_EMP                                                 01080036
010900     EXEC SQL                                                     01090000
011000         INCLUDE DLT00002                                         01100036
011100     END-EXEC.                                                    01110000
011200                                                                  01120000
011300*     DB2 COMMUNICATIONS AREA                                     01130036
011400     EXEC SQL                                                     01140000
011500          INCLUDE SQLCA                                           01150000
011600     END-EXEC.                                                    01160000
011700                                                                  01170000
011800                                                                  01180000
011900 LINKAGE SECTION.                                                 01190000
012000     COPY XLWS067.                                                01200088
012100                                                                  01210000
012200                                                                  01220000
012300******************************************************************01230050
012400 PROCEDURE DIVISION USING XL067-USER-COMMAREA.                    01240036
012500******************************************************************01250050
012600 0000-MAINLINE.                                                   01260050
012700                                                                  01270050
012800     SET XL067-SUCCESSFUL  TO TRUE.                               01280043
012900     MOVE PC-MOD-NM        TO XL067-CALL-MOD-FAIL-NM.             01290086
013000                                                                  01300000
013100     MOVE SPACES TO XL067-OUTPUT-FIELDS.                          01310037
013200                                                                  01320000
013300     PERFORM 1000-EDIT.                                           01330039
013400                                                                  01340039
013500     IF PS-EDITS-COMPLETE                                         01350039
013600        EVALUATE TRUE                                             01360039
013700            WHEN XL067-SELECT-KOHLS-USER                          01370039
013800             AND XL067-BY-USER-ID                                 01380063
013900                 PERFORM 3000-KOHLS-USERID                        01390073
014000                                                                  01400039
014100            WHEN XL067-SELECT-KOHLS-USER                          01410039
014200             AND XL067-BY-NAME                                    01420063
014300                 PERFORM 2100-KOHLS-NAME                          01430059
014400                                                                  01440039
014500            WHEN XL067-SELECT-TEMP-USER                           01450039
014600             AND XL067-BY-USER-ID                                 01460063
014700                 PERFORM 4000-TEMP-USERID                         01470073
014800                                                                  01480039
014900            WHEN XL067-SELECT-TEMP-USER                           01490039
015000             AND XL067-BY-NAME                                    01500063
015100                 PERFORM 2300-TEMP-NAME                           01510059
015200                                                                  01520039
015300            WHEN XL067-SELECT-BOTH-USERS                          01530044
015400             AND XL067-BY-USER-ID                                 01540063
015500                 PERFORM 3000-KOHLS-USERID                        01550073
015600                 IF XL067-KOHLS-NOT-FOUND                         01560091
015700                    PERFORM 4000-TEMP-USERID                      01570073
015800                 END-IF                                           01580091
015900                                                                  01590039
016000            WHEN XL067-SELECT-BOTH-USERS                          01600044
016100             AND XL067-BY-NAME                                    01610063
016200                 PERFORM 2100-KOHLS-NAME                          01620066
016300                 IF XL067-KOHLS-NOT-FOUND                         01630091
016400                    PERFORM 2300-TEMP-NAME                        01640066
016500                 END-IF                                           01650092
016600                                                                  01660039
016700            WHEN OTHER                                            01670039
016800                 SET XL067-INVALID-ACCESS TO TRUE                 01680043
016900                                                                  01690039
017000        END-EVALUATE                                              01700039
017100     END-IF.                                                      01710039
017200                                                                  01720000
017300     GOBACK.                                                      01730000
017400                                                                  01740000
017500******************************************************************01750050
017600*  EDIT FOR REQUIRED FIELD(S)                                    *01760050
017700******************************************************************01770050
017800 1000-EDIT.                                                       01780043
017900                                                                  01790000
018000     SET PS-EDITS-COMPLETE    TO TRUE.                            01800039
018100                                                                  01810039
018200* CHECK FOR REQUIRED ACCESS METHOD                                01820039
018300     EVALUATE TRUE                                                01830000
018400         WHEN XL067-BY-USER-ID                                    01840039
018500           OR XL067-BY-NAME                                       01850039
018600              CONTINUE                                            01860039
018700         WHEN OTHER                                               01870039
018800              SET XL067-ACCESS-METHOD-MISSING                     01880039
018900                  PS-EDITS-NOT-COMPLETE         TO TRUE           01890086
019000     END-EVALUATE.                                                01900039
019100                                                                  01910039
019200* CHECK FOR REQUIRED VIEW SELECTION METHOD                        01920039
019300     EVALUATE TRUE                                                01930039
019400         WHEN XL067-SELECT-KOHLS-USER                             01940046
019500           OR XL067-SELECT-TEMP-USER                              01950046
019600           OR XL067-SELECT-BOTH-USERS                             01960046
019700              CONTINUE                                            01970039
019800         WHEN OTHER                                               01980039
019900              SET XL067-VIEW-SELECTION-MISSING                    01990039
020000                  PS-EDITS-NOT-COMPLETE         TO TRUE           02000039
020100     END-EVALUATE.                                                02010039
020200                                                                  02020039
020300* EDIT REQUIRED KEY FIELD(S)                                      02030039
020400     EVALUATE TRUE                                                02040039
020500         WHEN XL067-BY-USER-ID                                    02050039
020600              IF XL067-KEY-USER-ID = SPACE                        02060039
020700                 SET XL067-USER-ID-MISSING                        02070039
020800                     PS-EDITS-NOT-COMPLETE    TO TRUE             02080039
020900              END-IF                                              02090039
021000         WHEN XL067-BY-NAME                                       02100039
021100              IF XL067-KEY-FIRST-NAME = SPACE                     02110039
021200                 SET XL067-FIRST-NAME-MISSING                     02120039
021300                     PS-EDITS-NOT-COMPLETE    TO TRUE             02130039
021400              END-IF                                              02140039
021500              IF XL067-KEY-LAST-NAME = SPACE                      02150039
021600                 SET XL067-LAST-NAME-MISSING                      02160039
021700                     PS-EDITS-NOT-COMPLETE    TO TRUE             02170039
021800              END-IF                                              02180039
021900     END-EVALUATE.                                                02190000
022000                                                                  02200000
022100****************************************************************  02210059
022200*    ACCESS XLT_USR FOR USER_ID USING THE FULL NAME AS THE KEY *  02220059
022300*    ONCE THE USER_ID IS FOUND, EXEC SQL TO RETRIEVE ALL NAME  *  02230059
022400*    FORMATS TOO.                                              *  02240059
022500****************************************************************  02250059
022600 2100-KOHLS-NAME.                                                 02260059
022700                                                                  02270059
022800     SET PS-MULTIPLES  TO TRUE.                                   02280059
022900     PERFORM 2105-KOHLS-NAME.                                     02290059
023000     IF PS-NO-MULTIPLES                                           02300059
023100        PERFORM 3000-KOHLS-USERID                                 02310073
023200     END-IF.                                                      02320059
023300                                                                  02330059
023400****************************************************************  02340059
023500*    RETRIEVE THE USER_ID GIVEN FIRST AND LAST NAME            *  02350059
023600****************************************************************  02360059
023700 2105-KOHLS-NAME.                                                 02370059
023800                                                                  02380059
023900     MOVE '2105-'          TO PV-PARA.                            02390059
024000     SET XL067-SQL-ERROR   TO TRUE.                               02400059
024100                                                                  02410059
024200     PERFORM                                                      02420059
024300         WITH TEST AFTER                                          02430059
024400         VARYING PV-RETRY-COUNTER                                 02440059
024500         FROM 1 BY 1                                              02450059
024600         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  02460059
024700            OR SQLCODE = ZERO                                     02470059
024800            OR SQLCODE = +100                                     02480059
024900            OR SQLCODE = -811                                     02490073
025000                                                                  02500059
025100         EXEC SQL                                                 02510059
025200             SELECT  USR_ID                                       02520059
                          ,USR_RVKE_IND                                 02521099
025300              INTO  :XLT00024-USR-ID                              02530059
                         ,:XLT00024-USR-RVKE-IND                        02531099
025400              FROM   XLT_USR    USR                               02540083
025500             WHERE  USR.USR_LAST_NM = :XL067-KEY-LAST-NAME        02550060
025600               AND  USR.USR_FRST_NM = :XL067-KEY-FIRST-NAME       02560060
025700         END-EXEC                                                 02570059
025800                                                                  02580059
025900         MOVE SQLCA            TO XL067-SQLCA                     02590099
026000                                                                  02600099
026100         EVALUATE TRUE                                            02610059
026200             WHEN SQLCODE = ZERO                                  02620059
026300                  SET XL067-SUCCESSFUL                            02630059
026400                      PS-NO-MULTIPLES                             02640066
026500                      XL067-USER-IS-KOHLS    TO TRUE              02650066
026600                  MOVE XLT00024-USR-ID       TO XL067-USERID      02660059
026700                                                XL067-KEY-USER-ID 02670059
                        MOVE XLT00024-USR-RVKE-IND TO                   02671099
                                                 XL067-USER-REVOKED-IND 02672099
026800                                                                  02680059
026900             WHEN SQLCODE = -811                                  02690059
027000                  SET PS-MULTIPLES                                02700073
027100                      XL067-MULTIPLES-FOUND TO TRUE               02710073
027200                  MOVE PC-MULTIPLES TO XL067-LAST-NAME            02720059
027300                                       XL067-FIRST-NAME           02730059
027400                                       XL067-COMBINED-NAME-1      02740059
027500                                       XL067-COMBINED-NAME-2      02750059
027600                                       XL067-COMBINED-NAME-3      02760059
027700                                       XL067-COMBINED-NAME-4      02770059
027800                                       XL067-COMBINED-NAME-5      02780059
027900                                                                  02790059
028000             WHEN SQLCODE = -904                                  02800059
028100             WHEN SQLCODE = -911                                  02810059
028200             WHEN SQLCODE = -913                                  02820059
028300                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            02830059
028400                     SET XL067-SQL-ERROR   TO TRUE                02840059
028500                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR02850059
028600                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       02860077
028700                  END-IF                                          02870059
028800                                                                  02880059
028900             WHEN SQLCODE = +100                                  02890059
029000                  SET XL067-USER-NOT-FOUND                        02900072
029100                      XL067-KOHLS-NOT-FOUND                       02910072
029200                      XL067-SUCCESSFUL      TO TRUE               02920072
029300                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          02930077
029400                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    02940066
029500                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              02950066
029600                                     XL067-FIRST-NAME             02960066
029700                                     XL067-COMBINED-NAME-1        02970066
029800                                     XL067-COMBINED-NAME-2        02980066
029900                                     XL067-COMBINED-NAME-3        02990066
030000                                     XL067-COMBINED-NAME-4        03000066
030100                                     XL067-COMBINED-NAME-5        03010066
030200                                                                  03020059
030300             WHEN SQLWARN0 NOT = SPACES                           03030059
030400              AND SQLCODE NOT = ZERO                              03040081
030500                  MOVE +4                      TO PV-RETRY-COUNTER03050059
030600                  SET XL067-SQL-WARNING-ERROR  TO TRUE            03060059
030700                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR03070059
030800                                                                  03080059
030900         END-EVALUATE                                             03090059
031000     END-PERFORM.                                                 03100059
031100                                                                  03110059
031200****************************************************************  03120073
031300*    ACCESS DLT_TMP_EMP USING THE FIRST AND LAST NAME AS THE   *  03130073
031400*    KEY. ONCE THE USER_ID IS FOUND, EXEC THE SQL TO RETRIEVE  *  03140073
031500*    ALL OF THE NAME FORMATS TOO.                              *  03150073
031600****************************************************************  03160073
031700 2300-TEMP-NAME.                                                  03170073
031800                                                                  03180073
031900     SET PS-MULTIPLES  TO TRUE.                                   03190073
032000     PERFORM 2305-TEMP-NAME.                                      03200073
032100     IF PS-NO-MULTIPLES                                           03210073
032200        PERFORM 4000-TEMP-USERID                                  03220073
032300     END-IF.                                                      03230073
032400                                                                  03240073
032500****************************************************************  03250073
032600*    RETRIEVE THE USER_ID GIVEN FIRST AND LAST NAME            *  03260073
032700****************************************************************  03270073
032800 2305-TEMP-NAME.                                                  03280073
032900                                                                  03290073
033000     MOVE '2305-'          TO PV-PARA.                            03300073
033100     SET XL067-SQL-ERROR   TO TRUE.                               03310073
033200                                                                  03320073
033300     PERFORM                                                      03330073
033400         WITH TEST AFTER                                          03340073
033500         VARYING PV-RETRY-COUNTER                                 03350073
033600         FROM 1 BY 1                                              03360073
033700         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  03370073
033800            OR SQLCODE = ZERO                                     03380073
033900            OR SQLCODE = +100                                     03390073
034000            OR SQLCODE = -811                                     03400073
034100                                                                  03410073
034200         EXEC SQL                                                 03420073
034300             SELECT  TMP_USR_ID                                   03430073
034400              INTO  :DLT00002-TMP-USR-ID                          03440073
034500              FROM   DLT_TMP_EMP TMP                              03450083
034600             WHERE  TMP.LAST_NM = :XL067-KEY-LAST-NAME            03460073
034700               AND  TMP.FRST_NM = :XL067-KEY-FIRST-NAME           03470073
034800         END-EXEC                                                 03480073
034900                                                                  03490073
035000         MOVE SQLCA            TO XL067-SQLCA                     03500099
035100                                                                  03510099
035200         EVALUATE TRUE                                            03520073
035300             WHEN SQLCODE = ZERO                                  03530073
035400                  SET XL067-SUCCESSFUL                            03540073
035500                      PS-NO-MULTIPLES                             03550073
035600                      XL067-USER-IS-TEMP   TO TRUE                03560073
035700                  MOVE DLT00002-TMP-USR-ID TO XL067-USERID        03570073
035800                                              XL067-KEY-USER-ID   03580073
035900                                                                  03590073
036000             WHEN SQLCODE = -811                                  03600073
036100                  SET PS-MULTIPLES                                03610073
036200                      XL067-MULTIPLES-FOUND TO TRUE               03620073
036300                  MOVE PC-MULTIPLES TO XL067-LAST-NAME            03630073
036400                                       XL067-FIRST-NAME           03640073
036500                                       XL067-COMBINED-NAME-1      03650073
036600                                       XL067-COMBINED-NAME-2      03660073
036700                                       XL067-COMBINED-NAME-3      03670073
036800                                       XL067-COMBINED-NAME-4      03680073
036900                                       XL067-COMBINED-NAME-5      03690073
037000                                                                  03700073
037100             WHEN SQLCODE = -904                                  03710073
037200             WHEN SQLCODE = -911                                  03720073
037300             WHEN SQLCODE = -913                                  03730073
037400                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            03740073
037500                     SET XL067-SQL-ERROR   TO TRUE                03750073
037600                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR03760073
037700                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       03770077
037800                  END-IF                                          03780073
037900                                                                  03790073
038000             WHEN SQLCODE = +100                                  03800073
038100                  SET XL067-USER-NOT-FOUND                        03810073
038200                      XL067-KOHLS-NOT-FOUND                       03820077
038300                      XL067-SUCCESSFUL      TO TRUE               03830073
038400                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          03840077
038500                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    03850073
038600                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              03860073
038700                                     XL067-FIRST-NAME             03870073
038800                                     XL067-COMBINED-NAME-1        03880073
038900                                     XL067-COMBINED-NAME-2        03890073
039000                                     XL067-COMBINED-NAME-3        03900073
039100                                     XL067-COMBINED-NAME-4        03910073
039200                                     XL067-COMBINED-NAME-5        03920073
039300                                                                  03930073
039400             WHEN SQLWARN0 NOT = SPACES                           03940073
039500              AND SQLCODE NOT = ZERO                              03950081
039600                  MOVE +4                      TO PV-RETRY-COUNTER03960073
039700                  SET XL067-SQL-WARNING-ERROR  TO TRUE            03970073
039800                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR03980073
039900                                                                  03990073
040000         END-EVALUATE                                             04000073
040100     END-PERFORM.                                                 04010073
040200                                                                  04020073
040300****************************************************************  04030073
040400*    ACCESS XLT_USR FOR NAME USING THE USER_ID AS THE KEY      *  04040073
040500****************************************************************  04050073
040600 3000-KOHLS-USERID.                                               04060073
040700                                                                  04070073
040800     PERFORM 3010-KOHLS-USERID-2-FIELDS.                          04080073
040900     IF XL067-SUCCESSFUL                                          04090076
041000        PERFORM 3020-KOHLS-USERID-COMBO-1                         04100076
041100     END-IF.                                                      04110076
041200     IF XL067-SUCCESSFUL                                          04120076
041300        PERFORM 3030-KOHLS-USERID-COMBO-2                         04130076
041400     END-IF.                                                      04140076
041500     IF XL067-SUCCESSFUL                                          04150076
041600        PERFORM 3040-KOHLS-USERID-COMBO-3                         04160076
041700     END-IF.                                                      04170076
041800     IF XL067-SUCCESSFUL                                          04180076
041900        PERFORM 3050-KOHLS-USERID-COMBO-4                         04190076
042000     END-IF.                                                      04200076
042100*    DISPLAY 'RETURN CODE BEFORE COMBO 5: '                       04210085
042200*            XL067-RETURN-CODE.                                   04220085
042300     IF XL067-SUCCESSFUL                                          04230076
042400        PERFORM 3060-KOHLS-USERID-COMBO-5                         04240076
042500     END-IF.                                                      04250076
042600*    DISPLAY 'RETURN CODE AFTER COMBO 5: '                        04260085
042700*            XL067-RETURN-CODE.                                   04270085
042800                                                                  04280073
042900****************************************************************  04290073
043000*    RETRIEVE THE FIRST AND LAST NAME IN 2 SEPARATE FIELDS     *  04300073
043100****************************************************************  04310073
043200 3010-KOHLS-USERID-2-FIELDS.                                      04320073
043300                                                                  04330073
043400     MOVE '3010-'          TO PV-PARA.                            04340075
043500     SET XL067-SQL-ERROR   TO TRUE.                               04350073
043600     MOVE +0               TO PV-NULL-INDICATORS.                 04360094
043700                                                                  04370073
043800     PERFORM                                                      04380073
043900         WITH TEST AFTER                                          04390073
044000         VARYING PV-RETRY-COUNTER                                 04400073
044100         FROM 1 BY 1                                              04410073
044200         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  04420073
044300            OR SQLCODE = ZERO                                     04430073
044400            OR SQLCODE = +100                                     04440073
044500                                                                  04450073
044600         EXEC SQL                                                 04460073
044700             SELECT  USR_LAST_NM                                  04470073
044800                    ,USR_FRST_NM                                  04480073
044900                    ,USR_MID_INIT                                 04490073
                          ,USR_RVKE_IND                                 04491099
045000              INTO  :XLT00024-USR-LAST-NM                         04500073
045100                   ,:XLT00024-USR-FRST-NM:PV-NULL-KOHLS-FN        04510094
045200                   ,:XLT00024-USR-MID-INIT:PV-NULL-KOHLS-MI       04520094
                         ,:XLT00024-USR-RVKE-IND                        04521099
045300              FROM   XLT_USR    USR                               04530083
045400             WHERE  USR.USR_ID       = :XL067-KEY-USER-ID         04540073
045500         END-EXEC                                                 04550073
045600                                                                  04560078
045700         MOVE SQLCA            TO XL067-SQLCA                     04570099
045800                                                                  04580099
045900         EVALUATE TRUE                                            04590073
046000             WHEN SQLCODE = ZERO                                  04600073
046100                SET XL067-SUCCESSFUL                              04610073
046200                    XL067-USER-IS-KOHLS    TO TRUE                04620073
046300                MOVE XLT00024-USR-LAST-NM  TO XL067-LAST-NAME     04630073
                      MOVE XLT00024-USR-RVKE-IND TO                     04631099
                                                 XL067-USER-REVOKED-IND 04632099
046400                IF PV-NULL-KOHLS-FN = -1                          04640094
046500                   MOVE SPACE                 TO XL067-FIRST-NAME 04650094
046600                ELSE                                              04660094
046700                   MOVE XLT00024-USR-FRST-NM  TO XL067-FIRST-NAME 04670094
046800                END-IF                                            04680094
046900                IF PV-NULL-KOHLS-MI = -1                          04690094
047000                   MOVE SPACE TO XL067-MIDDLE-INITIAL             04700094
047100                ELSE                                              04710094
047200                   MOVE XLT00024-USR-MID-INIT TO                  04720094
047300                                           XL067-MIDDLE-INITIAL   04730094
047400                END-IF                                            04740094
047500                                                                  04750073
047600             WHEN SQLCODE = -904                                  04760073
047700             WHEN SQLCODE = -911                                  04770073
047800             WHEN SQLCODE = -913                                  04780073
047900                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            04790073
048000                     SET XL067-SQL-ERROR   TO TRUE                04800073
048100                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR04810073
048200                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       04820077
048300                     MOVE PC-MOD-NM  TO XL067-CALL-MOD-FAIL-NM    04830086
048400                  END-IF                                          04840073
048500                                                                  04850073
048600             WHEN SQLCODE = +100                                  04860073
048700                  SET XL067-USER-NOT-FOUND                        04870073
048800                      XL067-KOHLS-NOT-FOUND                       04880073
048900                      XL067-SUCCESSFUL      TO TRUE               04890073
049000                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          04900077
049100                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    04910073
049200                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              04920073
049300                                     XL067-FIRST-NAME             04930073
049400                                     XL067-COMBINED-NAME-1        04940073
049500                                     XL067-COMBINED-NAME-2        04950073
049600                                     XL067-COMBINED-NAME-3        04960073
049700                                     XL067-COMBINED-NAME-4        04970073
049800                                     XL067-COMBINED-NAME-5        04980073
049900                                                                  04990073
050000             WHEN SQLWARN0 NOT = SPACES                           05000073
050100              AND SQLCODE NOT = ZERO                              05010081
050200                  MOVE +4                      TO PV-RETRY-COUNTER05020073
050300                  SET XL067-SQL-WARNING-ERROR  TO TRUE            05030073
050400                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR05040073
050500                                                                  05050073
050600         END-EVALUATE                                             05060073
050700     END-PERFORM.                                                 05070073
050800                                                                  05080073
050900****************************************************************  05090073
051000*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 1 FIELD *  05100073
051100*    EX ( SMITH, JOHN)_                                        *  05110073
051200****************************************************************  05120073
051300 3020-KOHLS-USERID-COMBO-1.                                       05130073
051400                                                                  05140073
051500     MOVE '3020-'          TO PV-PARA.                            05150075
051600     SET XL067-SQL-ERROR   TO TRUE.                               05160073
051700                                                                  05170073
051800     PERFORM                                                      05180073
051900         WITH TEST AFTER                                          05190073
052000         VARYING PV-RETRY-COUNTER                                 05200073
052100         FROM 1 BY 1                                              05210073
052200         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  05220073
052300            OR SQLCODE = ZERO                                     05230073
052400            OR SQLCODE = +100                                     05240073
052500            OR SQLCODE = -305                                     05250096
052600                                                                  05260073
052700         EXEC SQL                                                 05270073
052800             SELECT STRIP(USR.USR_LAST_NM,T) CONCAT ', '          05280073
052900                    CONCAT STRIP(USR_FRST_NM,T)                   05290073
                        , USR_RVKE_IND                                  05291099
053000             INTO  :XL067-COMBINED-NAME-1                         05300096
                        ,:XL067-USER-REVOKED-IND                        05301099
053100             FROM   XLT_USR  USR                                  05310083
053200             WHERE  USR.USR_ID   = :XL067-KEY-USER-ID             05320073
053300         END-EXEC                                                 05330073
053400                                                                  05340073
053500         MOVE SQLCA            TO XL067-SQLCA                     05350099
053600                                                                  05360099
053700         EVALUATE TRUE                                            05370073
053800             WHEN SQLCODE = ZERO                                  05380073
053900                  SET XL067-SUCCESSFUL                            05390073
054000                      XL067-USER-IS-KOHLS    TO TRUE              05400073
054100                                                                  05410096
054200             WHEN SQLCODE = -305                                  05420096
054300                  SET XL067-KOHLS-FNME-OR-MI-NULL                 05430096
054400                      XL067-USER-IS-KOHLS    TO TRUE              05440096
054500                                                                  05450073
054600             WHEN SQLCODE = -904                                  05460073
054700             WHEN SQLCODE = -911                                  05470073
054800             WHEN SQLCODE = -913                                  05480073
054900                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            05490073
055000                     SET XL067-SQL-ERROR   TO TRUE                05500073
055100                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR05510073
055200                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       05520077
055300                  END-IF                                          05530073
055400                                                                  05540073
055500             WHEN SQLCODE = +100                                  05550073
055600                  SET XL067-USER-NOT-FOUND                        05560073
055700                      XL067-KOHLS-NOT-FOUND                       05570073
055800                      XL067-SUCCESSFUL      TO TRUE               05580073
055900                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          05590077
056000                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    05600073
056100                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              05610073
056200                                     XL067-FIRST-NAME             05620073
056300                                     XL067-COMBINED-NAME-1        05630073
056400                                     XL067-COMBINED-NAME-2        05640073
056500                                     XL067-COMBINED-NAME-3        05650073
056600                                     XL067-COMBINED-NAME-4        05660073
056700                                     XL067-COMBINED-NAME-5        05670073
056800                                                                  05680073
056900             WHEN SQLWARN0 NOT = SPACES                           05690073
057000              AND SQLCODE NOT = ZERO                              05700081
057100                  MOVE +4                      TO PV-RETRY-COUNTER05710073
057200                  SET XL067-SQL-WARNING-ERROR  TO TRUE            05720073
057300                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR05730073
057400         END-EVALUATE                                             05740073
057500     END-PERFORM.                                                 05750073
057600                                                                  05760073
057700****************************************************************  05770073
057800*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 2 FIELD *  05780073
057900*    EX ( JOHN SMITH)                                          *  05790073
058000****************************************************************  05800073
058100 3030-KOHLS-USERID-COMBO-2.                                       05810073
058200                                                                  05820073
058300     MOVE '3030-'          TO PV-PARA.                            05830075
058400     SET XL067-SQL-ERROR   TO TRUE.                               05840073
058500                                                                  05850073
058600     PERFORM                                                      05860073
058700         WITH TEST AFTER                                          05870073
058800         VARYING PV-RETRY-COUNTER                                 05880073
058900         FROM 1 BY 1                                              05890073
059000         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  05900073
059100            OR SQLCODE = ZERO                                     05910073
059200            OR SQLCODE = +100                                     05920073
059300            OR SQLCODE = -305                                     05930096
059400                                                                  05940073
059500         EXEC SQL                                                 05950073
059600             SELECT STRIP(USR_FRST_NM,T) CONCAT ' '               05960073
059700                    CONCAT STRIP(USR_LAST_NM,T)                   05970073
                        , USR_RVKE_IND                                  05971099
059800             INTO  :XL067-COMBINED-NAME-2                         05980073
                        ,:XL067-USER-REVOKED-IND                        05982099
059900             FROM   XLT_USR USR                                   05990083
060000             WHERE  USR.USR_ID = :XL067-KEY-USER-ID               06000073
060100         END-EXEC                                                 06010073
060200                                                                  06020073
060300         MOVE SQLCA            TO XL067-SQLCA                     06030099
060400                                                                  06040099
060500         EVALUATE TRUE                                            06050073
060600             WHEN SQLCODE = ZERO                                  06060073
060700                  SET XL067-SUCCESSFUL                            06070073
060800                      XL067-USER-IS-KOHLS    TO TRUE              06080073
060900                                                                  06090096
061000             WHEN SQLCODE = -305                                  06100096
061100                  SET XL067-KOHLS-FNME-OR-MI-NULL                 06110096
061200                      XL067-USER-IS-KOHLS    TO TRUE              06120096
061300                                                                  06130073
061400             WHEN SQLCODE = -904                                  06140073
061500             WHEN SQLCODE = -911                                  06150073
061600             WHEN SQLCODE = -913                                  06160073
061700                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            06170073
061800                     SET XL067-SQL-ERROR   TO TRUE                06180073
061900                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR06190073
062000                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       06200077
062100                  END-IF                                          06210073
062200                                                                  06220073
062300             WHEN SQLCODE = +100                                  06230073
062400                  SET XL067-USER-NOT-FOUND                        06240073
062500                      XL067-KOHLS-NOT-FOUND                       06250073
062600                      XL067-SUCCESSFUL      TO TRUE               06260073
062700                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          06270077
062800                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    06280073
062900                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              06290073
063000                                     XL067-FIRST-NAME             06300073
063100                                     XL067-COMBINED-NAME-1        06310073
063200                                     XL067-COMBINED-NAME-2        06320073
063300                                     XL067-COMBINED-NAME-3        06330073
063400                                     XL067-COMBINED-NAME-4        06340073
063500                                     XL067-COMBINED-NAME-5        06350073
063600                                                                  06360073
063700             WHEN SQLWARN0 NOT = SPACES                           06370073
063800              AND SQLCODE NOT = ZERO                              06380081
063900                  MOVE +4                      TO PV-RETRY-COUNTER06390073
064000                  SET XL067-SQL-WARNING-ERROR  TO TRUE            06400073
064100                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR06410073
064200                                                                  06420073
064300         END-EVALUATE                                             06430073
064400     END-PERFORM.                                                 06440073
064500                                                                  06450073
064600****************************************************************  06460073
064700*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 3 FIELD *  06470073
064800*    EX ( SMITH, JOHN P)                                       *  06480073
064900****************************************************************  06490073
065000 3040-KOHLS-USERID-COMBO-3.                                       06500073
065100                                                                  06510073
065200     MOVE '3040-'          TO PV-PARA.                            06520075
065300     SET XL067-SQL-ERROR   TO TRUE.                               06530073
065400                                                                  06540073
065500     PERFORM                                                      06550073
065600         WITH TEST AFTER                                          06560073
065700         VARYING PV-RETRY-COUNTER                                 06570073
065800         FROM 1 BY 1                                              06580073
065900         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  06590073
066000            OR SQLCODE = ZERO                                     06600073
066100            OR SQLCODE = +100                                     06610073
066200            OR SQLCODE = -305                                     06620096
066300                                                                  06630073
066400         EXEC SQL                                                 06640073
066500             SELECT STRIP(USR_LAST_NM,T) CONCAT ', '              06650073
066600                    CONCAT STRIP(USR_FRST_NM,T)                   06660073
                        , USR_RVKE_IND                                  06661099
066700             INTO  :XL067-COMBINED-NAME-3                         06670073
                        ,:XL067-USER-REVOKED-IND                        06672099
066800             FROM   XLT_USR  USR                                  06680083
066900             WHERE  USR.USR_MID_INIT  IS NULL                     06690098
067000                    AND USR.USR_ID    = :XL067-KEY-USER-ID        06700073
067100             UNION                                                06710073
067200             SELECT STRIP(USR.USR_LAST_NM,T) CONCAT ', '          06720073
067300                    CONCAT STRIP(USR.USR_FRST_NM,T) CONCAT ', '   06730073
067400                    CONCAT STRIP(USR.USR_MID_INIT,T)              06740073
                        , USR_RVKE_IND                                  06741099
067500             INTO  :XL067-COMBINED-NAME-3                         06750073
                        ,:XL067-USER-REVOKED-IND                        06750199
067600             FROM   XLT_USR  USR                                  06760083
067700             WHERE  USR.USR_MID_INIT IS NOT NULL                  06770098
067800                    AND USR.USR_ID    = :XL067-KEY-USER-ID        06780073
067900         END-EXEC                                                 06790073
068000                                                                  06800073
068100         MOVE SQLCA            TO XL067-SQLCA                     06810099
068200                                                                  06820099
068300         EVALUATE TRUE                                            06830073
068400             WHEN SQLCODE = ZERO                                  06840073
068500                  SET XL067-SUCCESSFUL                            06850073
068600                      XL067-USER-IS-KOHLS    TO TRUE              06860073
068700                                                                  06870073
068800             WHEN SQLCODE = -305                                  06880096
068900                  SET XL067-KOHLS-FNME-OR-MI-NULL                 06890096
069000                      XL067-USER-IS-KOHLS    TO TRUE              06900096
069100                                                                  06910096
069200             WHEN SQLCODE = -904                                  06920073
069300             WHEN SQLCODE = -911                                  06930073
069400             WHEN SQLCODE = -913                                  06940073
069500                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            06950073
069600                     SET XL067-SQL-ERROR   TO TRUE                06960073
069700                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR06970073
069800                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       06980077
069900                  END-IF                                          06990073
070000                                                                  07000073
070100             WHEN SQLCODE = +100                                  07010073
070200                  SET XL067-USER-NOT-FOUND                        07020073
070300                      XL067-KOHLS-NOT-FOUND                       07030073
070400                      XL067-SUCCESSFUL      TO TRUE               07040073
070500                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          07050077
070600                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    07060073
070700                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              07070073
070800                                     XL067-FIRST-NAME             07080073
070900                                     XL067-COMBINED-NAME-1        07090073
071000                                     XL067-COMBINED-NAME-2        07100073
071100                                     XL067-COMBINED-NAME-3        07110073
071200                                     XL067-COMBINED-NAME-4        07120073
071300                                     XL067-COMBINED-NAME-5        07130073
071400                                                                  07140073
071500             WHEN SQLWARN0 NOT = SPACES                           07150073
071600              AND SQLCODE NOT = ZERO                              07160081
071700                  MOVE +4                      TO PV-RETRY-COUNTER07170073
071800                  SET XL067-SQL-WARNING-ERROR  TO TRUE            07180073
071900                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR07190073
072000                                                                  07200073
072100         END-EVALUATE                                             07210073
072200     END-PERFORM.                                                 07220073
072300                                                                  07230073
072400****************************************************************  07240073
072500*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 4 FIELD *  07250073
072600*    EX ( JOHN P SMITH)                                        *  07260073
072700****************************************************************  07270073
072800 3050-KOHLS-USERID-COMBO-4.                                       07280073
072900                                                                  07290073
073000     MOVE '3050-'          TO PV-PARA.                            07300075
073100     SET XL067-SQL-ERROR   TO TRUE.                               07310073
073200                                                                  07320073
073300     PERFORM                                                      07330073
073400         WITH TEST AFTER                                          07340073
073500         VARYING PV-RETRY-COUNTER                                 07350073
073600         FROM 1 BY 1                                              07360073
073700         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  07370073
073800            OR SQLCODE = ZERO                                     07380073
073900            OR SQLCODE = +100                                     07390073
074000            OR SQLCODE = -305                                     07400096
074100                                                                  07410073
074200         EXEC SQL                                                 07420073
074300             SELECT STRIP(USR_FRST_NM,T)                          07430073
074400                    CONCAT ' ' CONCAT STRIP(USR_LAST_NM,T)        07440073
                        , USR_RVKE_IND                                  07441099
074500             INTO  :XL067-COMBINED-NAME-4                         07450073
                        ,:XL067-USER-REVOKED-IND                        07452099
074600             FROM   XLT_USR  USR                                  07460083
074700             WHERE  USR.USR_MID_INIT IS NULL                      07470098
074800               AND  USR.USR_ID    = :XL067-KEY-USER-ID            07480085
074900             UNION                                                07490073
075000             SELECT STRIP(USR_FRST_NM,T) CONCAT ' '               07500073
075100                    CONCAT STRIP(USR_MID_INIT,T)                  07510073
075200                    CONCAT ' ' CONCAT STRIP(USR_LAST_NM,T)        07520073
                        , USR_RVKE_IND                                  07521099
075300             INTO  :XL067-COMBINED-NAME-4                         07530073
                        ,:XL067-USER-REVOKED-IND                        07532099
075400             FROM   XLT_USR  USR                                  07540083
075500             WHERE  USR.USR_MID_INIT IS NOT NULL                  07550098
075600               AND  USR.USR_ID    = :XL067-KEY-USER-ID            07560085
075700         END-EXEC                                                 07570073
075800                                                                  07580073
075900         MOVE SQLCA            TO XL067-SQLCA                     07590099
076000                                                                  07600099
076100         EVALUATE TRUE                                            07610073
076200             WHEN SQLCODE = ZERO                                  07620073
076300                  SET XL067-SUCCESSFUL                            07630073
076400                      XL067-USER-IS-KOHLS    TO TRUE              07640073
076500                                                                  07650073
076600             WHEN SQLCODE = -305                                  07660096
076700                  SET XL067-KOHLS-FNME-OR-MI-NULL                 07670096
076800                      XL067-USER-IS-KOHLS    TO TRUE              07680096
076900                                                                  07690096
077000             WHEN SQLCODE = -904                                  07700073
077100             WHEN SQLCODE = -911                                  07710073
077200             WHEN SQLCODE = -913                                  07720073
077300                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            07730073
077400                     SET XL067-SQL-ERROR   TO TRUE                07740073
077500                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR07750073
077600                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       07760077
077700                  END-IF                                          07770073
077800                                                                  07780073
077900             WHEN SQLCODE = +100                                  07790073
078000                  SET XL067-USER-NOT-FOUND                        07800073
078100                      XL067-KOHLS-NOT-FOUND                       07810073
078200                      XL067-SUCCESSFUL      TO TRUE               07820073
078300                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          07830077
078400                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    07840073
078500                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              07850073
078600                                     XL067-FIRST-NAME             07860073
078700                                     XL067-COMBINED-NAME-1        07870073
078800                                     XL067-COMBINED-NAME-2        07880073
078900                                     XL067-COMBINED-NAME-3        07890073
079000                                     XL067-COMBINED-NAME-4        07900073
079100                                     XL067-COMBINED-NAME-5        07910073
079200                                                                  07920073
079300             WHEN SQLWARN0 NOT = SPACES                           07930073
079400              AND SQLCODE NOT = ZERO                              07940081
079500                  MOVE +4                      TO PV-RETRY-COUNTER07950073
079600                  SET XL067-SQL-WARNING-ERROR  TO TRUE            07960073
079700                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR07970073
079800                                                                  07980073
079900         END-EVALUATE                                             07990073
080000     END-PERFORM.                                                 08000073
080100                                                                  08010073
080200****************************************************************  08020073
080300*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 5 FIELD *  08030073
080400*    EX ( TK99999-SMITH, JOHN, P)                              *  08040073
080500****************************************************************  08050073
080600 3060-KOHLS-USERID-COMBO-5.                                       08060073
080700                                                                  08070073
080800     MOVE '3060-'          TO PV-PARA.                            08080075
080900     SET XL067-SQL-ERROR   TO TRUE.                               08090073
081000                                                                  08100073
081100     PERFORM                                                      08110073
081200         WITH TEST AFTER                                          08120073
081300         VARYING PV-RETRY-COUNTER                                 08130073
081400         FROM 1 BY 1                                              08140073
081500         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  08150073
081600            OR SQLCODE = ZERO                                     08160073
081700            OR SQLCODE = +100                                     08170073
081800            OR SQLCODE = -305                                     08180096
081900                                                                  08190073
082000         EXEC SQL                                                 08200073
082100              SELECT STRIP(USR_ID,T) CONCAT '-'                   08210073
082200                     CONCAT STRIP(USR_LAST_NM,T) CONCAT ', '      08220073
082300                     CONCAT STRIP(USR_FRST_NM,T)                  08230073
082400              INTO  :XL067-COMBINED-NAME-5                        08240073
                         ,:XL067-USER-REVOKED-IND                       08241099
082500              FROM   XLT_USR  USR                                 08250083
082600              WHERE  USR.USR_MID_INIT IS NULL                     08260098
082700              AND    USR.USR_ID    = :XL067-KEY-USER-ID           08270073
082800              UNION                                               08280073
082900              SELECT STRIP(USR_ID,T) CONCAT '-'                   08290073
083000                     CONCAT STRIP(USR_LAST_NM,T) CONCAT ', '      08300073
083100                     CONCAT STRIP(USR_FRST_NM,T) CONCAT ', '      08310073
083200                     CONCAT STRIP(USR_MID_INIT,T)                 08320073
083300              INTO  :XL067-COMBINED-NAME-5                        08330083
                         ,:XL067-USER-REVOKED-IND                       08331099
083400              FROM XLT_USR  USR                                   08340083
083500              WHERE USR.USR_MID_INIT IS NOT NULL                  08350098
083600              AND USR.USR_ID    = :XL067-KEY-USER-ID              08360073
083700         END-EXEC                                                 08370073
083800                                                                  08380073
083900         MOVE SQLCA            TO XL067-SQLCA                     08390099
084000                                                                  08400099
084100         EVALUATE TRUE                                            08410073
084200             WHEN SQLCODE = ZERO                                  08420073
084300                  SET XL067-SUCCESSFUL                            08430073
084400                      XL067-USER-IS-KOHLS    TO TRUE              08440073
084500                                                                  08450073
084600             WHEN SQLCODE = -305                                  08460096
084700                  SET XL067-KOHLS-FNME-OR-MI-NULL                 08470096
084800                      XL067-USER-IS-KOHLS    TO TRUE              08480096
084900                                                                  08490096
085000             WHEN SQLCODE = -904                                  08500073
085100             WHEN SQLCODE = -911                                  08510073
085200             WHEN SQLCODE = -913                                  08520073
085300                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            08530073
085400                     SET XL067-SQL-ERROR   TO TRUE                08540073
085500                     MOVE PV-PARA    TO XL067-KOHLS-CONTENTION-NBR08550073
085600                     MOVE SQLCODE    TO XL067-KOHLS-SQLCODE       08560077
085700                  END-IF                                          08570073
085800                                                                  08580073
085900             WHEN SQLCODE = +100                                  08590073
086000                  SET XL067-USER-NOT-FOUND                        08600073
086100                      XL067-KOHLS-NOT-FOUND                       08610073
086200                      XL067-SUCCESSFUL      TO TRUE               08620073
086300                  MOVE SQLCODE    TO XL067-KOHLS-SQLCODE          08630077
086400                  MOVE PV-PARA    TO XL067-KOHLS-NOT-FOUND-NBR    08640073
086500                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              08650073
086600                                     XL067-FIRST-NAME             08660073
086700                                     XL067-COMBINED-NAME-1        08670073
086800                                     XL067-COMBINED-NAME-2        08680073
086900                                     XL067-COMBINED-NAME-3        08690073
087000                                     XL067-COMBINED-NAME-4        08700073
087100                                     XL067-COMBINED-NAME-5        08710073
087200                                                                  08720073
087300             WHEN SQLWARN0 NOT = SPACES                           08730073
087400              AND SQLCODE NOT = ZERO                              08740081
087500                  MOVE +4                      TO PV-RETRY-COUNTER08750073
087600                  SET XL067-SQL-WARNING-ERROR  TO TRUE            08760073
087700                  MOVE PV-PARA            TO XL067-KOHLS-ERROR-NBR08770073
087800                                                                  08780073
087900         END-EVALUATE                                             08790073
088000     END-PERFORM.                                                 08800073
088100                                                                  08810073
088200****************************************************************  08820059
088300*    ACCESS DLT_TMP_EMP FOR NAME USING THE USER_ID AS THE KEY  *  08830059
088400*    COMBO NAMES (1&3)  AND (2&4) ARE THE SAME BECAUSE THERE   *  08840064
088500*    IS NOT A MIDDLE INITIAL FIELD ON DLT_TMP_EMP              *  08850064
088600****************************************************************  08860059
088700 4000-TEMP-USERID.                                                08870073
088800                                                                  08880053
088900     IF XL067-SUCCESSFUL                                          08890076
089000        PERFORM 4010-TEMP-USERID-2-FIELDS                         08900076
089100     END-IF.                                                      08910076
089200     IF XL067-SUCCESSFUL                                          08920076
089300        PERFORM 4020-TEMP-USERID-COMBO-1                          08930076
089400     END-IF.                                                      08940076
089500     IF XL067-SUCCESSFUL                                          08950076
089600        PERFORM 4030-TEMP-USERID-COMBO-2                          08960076
089700     END-IF.                                                      08970076
089800     IF XL067-SUCCESSFUL                                          08980076
089900        PERFORM 4060-TEMP-USERID-COMBO-5                          08990076
090000     END-IF.                                                      09000076
090100                                                                  09010053
090200****************************************************************  09020053
090300*    RETRIEVE THE FIRST AND LAST NAME IN 2 SEPARATE FIELDS     *  09030053
090400****************************************************************  09040053
090500 4010-TEMP-USERID-2-FIELDS.                                       09050073
090600                                                                  09060053
090700     MOVE '4010-'          TO PV-PARA.                            09070075
090800     SET XL067-SQL-ERROR   TO TRUE.                               09080053
090900                                                                  09090053
091000     PERFORM                                                      09100053
091100         WITH TEST AFTER                                          09110053
091200         VARYING PV-RETRY-COUNTER                                 09120053
091300         FROM 1 BY 1                                              09130053
091400         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  09140053
091500            OR SQLCODE = ZERO                                     09150053
091600            OR SQLCODE = +100                                     09160053
091700                                                                  09170053
091800         EXEC SQL                                                 09180053
091900             SELECT  LAST_NM                                      09190053
092000                    ,FRST_NM                                      09200064
092100              INTO  :DLT00002-LAST-NM                             09210053
092200                   ,:DLT00002-FRST-NM                             09220053
092300              FROM   DLT_TMP_EMP  TMP                             09230083
092400             WHERE  TMP.TMP_USR_ID   = :XL067-KEY-USER-ID         09240054
092500         END-EXEC                                                 09250053
092600                                                                  09260053
092700         MOVE SQLCA            TO XL067-SQLCA                     09270099
092800                                                                  09280099
092900         EVALUATE TRUE                                            09290053
093000             WHEN SQLCODE = ZERO                                  09300053
093100                  SET XL067-SUCCESSFUL                            09310066
093200                      XL067-USER-IS-TEMP     TO TRUE              09320066
093300                  MOVE DLT00002-LAST-NM      TO XL067-LAST-NAME   09330053
093400                  MOVE DLT00002-FRST-NM      TO XL067-FIRST-NAME  09340053
093500                                                                  09350053
093600             WHEN SQLCODE = -904                                  09360053
093700             WHEN SQLCODE = -911                                  09370053
093800             WHEN SQLCODE = -913                                  09380053
093900                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            09390053
094000                     SET XL067-SQL-ERROR   TO TRUE                09400053
094100                     MOVE PV-PARA    TO XL067-TEMP-CONTENTION-NBR 09410053
094200                     MOVE SQLCODE    TO XL067-TEMP-SQLCODE        09420077
094300                  END-IF                                          09430053
094400                                                                  09440053
094500             WHEN SQLCODE = +100                                  09450053
094600                  SET XL067-USER-NOT-FOUND                        09460071
094700                      XL067-TEMP-NOT-FOUND                        09470072
094800                      XL067-SUCCESSFUL      TO TRUE               09480072
094900                  MOVE SQLCODE    TO XL067-TEMP-SQLCODE           09490077
095000                  MOVE PV-PARA    TO XL067-TEMP-NOT-FOUND-NBR     09500066
095100                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              09510066
095200                                     XL067-FIRST-NAME             09520066
095300                                     XL067-COMBINED-NAME-1        09530066
095400                                     XL067-COMBINED-NAME-2        09540066
095500                                     XL067-COMBINED-NAME-3        09550066
095600                                     XL067-COMBINED-NAME-4        09560066
095700                                     XL067-COMBINED-NAME-5        09570066
095800                                                                  09580053
095900             WHEN SQLWARN0 NOT = SPACES                           09590053
096000              AND SQLCODE NOT = ZERO                              09600081
096100                  MOVE +4                      TO PV-RETRY-COUNTER09610053
096200                  SET XL067-SQL-WARNING-ERROR  TO TRUE            09620053
096300                  MOVE PV-PARA            TO XL067-TEMP-ERROR-NBR 09630053
096400                                                                  09640053
096500         END-EVALUATE                                             09650053
096600     END-PERFORM.                                                 09660053
096700                                                                  09670053
096800****************************************************************  09680053
096900*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 1 FIELD *  09690053
097000*    EX ( SMITH, JOHN)_                                        *  09700053
097100****************************************************************  09710053
097200 4020-TEMP-USERID-COMBO-1.                                        09720073
097300                                                                  09730053
097400     MOVE '4020-'          TO PV-PARA.                            09740075
097500     SET XL067-SQL-ERROR   TO TRUE.                               09750053
097600                                                                  09760053
097700     PERFORM                                                      09770053
097800         WITH TEST AFTER                                          09780053
097900         VARYING PV-RETRY-COUNTER                                 09790053
098000         FROM 1 BY 1                                              09800053
098100         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  09810053
098200            OR SQLCODE = ZERO                                     09820053
098300            OR SQLCODE = +100                                     09830053
098400                                                                  09840053
098500         EXEC SQL                                                 09850053
098600             SELECT STRIP(LAST_NM,T) CONCAT ', '                  09860054
098700                    CONCAT STRIP(FRST_NM,T)                       09870054
098800             INTO  :XL067-COMBINED-NAME-1                         09880053
098900             FROM   DLT_TMP_EMP   TMP                             09890083
099000             WHERE  TMP.TMP_USR_ID   = :XL067-KEY-USER-ID         09900054
099100         END-EXEC                                                 09910053
099200                                                                  09920053
099300         MOVE SQLCA            TO XL067-SQLCA                     09930099
099400                                                                  09940099
099500         EVALUATE TRUE                                            09950053
099600             WHEN SQLCODE = ZERO                                  09960053
099700               SET XL067-SUCCESSFUL                               09970066
099800                   XL067-USER-IS-TEMP     TO TRUE                 09980066
099900               MOVE XL067-COMBINED-NAME-1 TO XL067-COMBINED-NAME-309990064
100000                                                                  10000053
100100             WHEN SQLCODE = -904                                  10010053
100200             WHEN SQLCODE = -911                                  10020053
100300             WHEN SQLCODE = -913                                  10030053
100400                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            10040053
100500                     SET XL067-SQL-ERROR   TO TRUE                10050053
100600                     MOVE PV-PARA    TO XL067-TEMP-CONTENTION-NBR 10060053
100700                     MOVE SQLCODE    TO XL067-TEMP-SQLCODE        10070077
100800                  END-IF                                          10080053
100900                                                                  10090053
101000             WHEN SQLCODE = +100                                  10100053
101100                  SET XL067-USER-NOT-FOUND                        10110071
101200                      XL067-TEMP-NOT-FOUND                        10120072
101300                      XL067-SUCCESSFUL      TO TRUE               10130072
101400                  MOVE SQLCODE    TO XL067-TEMP-SQLCODE           10140077
101500                  MOVE PV-PARA    TO XL067-TEMP-NOT-FOUND-NBR     10150066
101600                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              10160066
101700                                     XL067-FIRST-NAME             10170066
101800                                     XL067-COMBINED-NAME-1        10180066
101900                                     XL067-COMBINED-NAME-2        10190066
102000                                     XL067-COMBINED-NAME-3        10200066
102100                                     XL067-COMBINED-NAME-4        10210066
102200                                     XL067-COMBINED-NAME-5        10220066
102300                                                                  10230053
102400             WHEN SQLWARN0 NOT = SPACES                           10240053
102500              AND SQLCODE NOT = ZERO                              10250081
102600                  MOVE +4                      TO PV-RETRY-COUNTER10260053
102700                  SET XL067-SQL-WARNING-ERROR  TO TRUE            10270053
102800                  MOVE PV-PARA            TO XL067-TEMP-ERROR-NBR 10280053
102900         END-EVALUATE                                             10290053
103000     END-PERFORM.                                                 10300053
103100                                                                  10310053
103200****************************************************************  10320053
103300*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 2 FIELD *  10330053
103400*    EX ( JOHN SMITH)                                          *  10340053
103500****************************************************************  10350053
103600 4030-TEMP-USERID-COMBO-2.                                        10360073
103700                                                                  10370053
103800     MOVE '4030-'          TO PV-PARA.                            10380075
103900     SET XL067-SQL-ERROR   TO TRUE.                               10390053
104000                                                                  10400053
104100     PERFORM                                                      10410053
104200         WITH TEST AFTER                                          10420053
104300         VARYING PV-RETRY-COUNTER                                 10430053
104400         FROM 1 BY 1                                              10440053
104500         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  10450053
104600            OR SQLCODE = ZERO                                     10460053
104700            OR SQLCODE = +100                                     10470053
104800                                                                  10480053
104900         EXEC SQL                                                 10490053
105000             SELECT STRIP(FRST_NM,T) CONCAT ' '                   10500054
105100                    CONCAT STRIP(LAST_NM,T)                       10510054
105200             INTO  :XL067-COMBINED-NAME-2                         10520053
105300             FROM   DLT_TMP_EMP  TMP                              10530083
105400             WHERE  TMP.TMP_USR_ID = :XL067-KEY-USER-ID           10540054
105500         END-EXEC                                                 10550053
105600                                                                  10560053
105700         MOVE SQLCA            TO XL067-SQLCA                     10570099
105800                                                                  10580099
105900         EVALUATE TRUE                                            10590053
106000             WHEN SQLCODE = ZERO                                  10600053
106100               SET XL067-SUCCESSFUL                               10610066
106200                   XL067-USER-IS-TEMP     TO TRUE                 10620066
106300               MOVE XL067-COMBINED-NAME-2 TO XL067-COMBINED-NAME-410630064
106400                                                                  10640053
106500             WHEN SQLCODE = -904                                  10650053
106600             WHEN SQLCODE = -911                                  10660053
106700             WHEN SQLCODE = -913                                  10670053
106800                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            10680053
106900                     SET XL067-SQL-ERROR   TO TRUE                10690053
107000                     MOVE PV-PARA    TO XL067-TEMP-CONTENTION-NBR 10700053
107100                     MOVE SQLCODE    TO XL067-TEMP-SQLCODE        10710077
107200                  END-IF                                          10720053
107300                                                                  10730053
107400             WHEN SQLCODE = +100                                  10740053
107500                  SET XL067-USER-NOT-FOUND                        10750071
107600                      XL067-TEMP-NOT-FOUND                        10760072
107700                      XL067-SUCCESSFUL      TO TRUE               10770072
107800                  MOVE SQLCODE    TO XL067-TEMP-SQLCODE           10780077
107900                  MOVE PV-PARA    TO XL067-TEMP-NOT-FOUND-NBR     10790066
108000                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              10800066
108100                                     XL067-FIRST-NAME             10810066
108200                                     XL067-COMBINED-NAME-1        10820066
108300                                     XL067-COMBINED-NAME-2        10830066
108400                                     XL067-COMBINED-NAME-3        10840066
108500                                     XL067-COMBINED-NAME-4        10850066
108600                                     XL067-COMBINED-NAME-5        10860066
108700                                                                  10870053
108800             WHEN SQLWARN0 NOT = SPACES                           10880053
108900              AND SQLCODE NOT = ZERO                              10890081
109000                  MOVE +4                      TO PV-RETRY-COUNTER10900053
109100                  SET XL067-SQL-WARNING-ERROR  TO TRUE            10910053
109200                  MOVE PV-PARA            TO XL067-TEMP-ERROR-NBR 10920053
109300                                                                  10930053
109400         END-EVALUATE                                             10940053
109500     END-PERFORM.                                                 10950053
109600                                                                  10960053
109700****************************************************************  10970053
109800*    RETRIEVE THE FIRST AND LAST NAME IN COMBINED NAME 5 FIELD *  10980053
109900*    EX ( TK99999-SMITH, JOHN)                                 *  10990054
110000****************************************************************  11000053
110100 4060-TEMP-USERID-COMBO-5.                                        11010073
110200                                                                  11020053
110300     MOVE '4060-'          TO PV-PARA.                            11030075
110400     SET XL067-SQL-ERROR   TO TRUE.                               11040053
110500                                                                  11050053
110600     PERFORM                                                      11060053
110700         WITH TEST AFTER                                          11070053
110800         VARYING PV-RETRY-COUNTER                                 11080053
110900         FROM 1 BY 1                                              11090053
111000         UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                  11100053
111100            OR SQLCODE = ZERO                                     11110053
111200            OR SQLCODE = +100                                     11120053
111300                                                                  11130053
111400         EXEC SQL                                                 11140053
111500              SELECT STRIP(TMP_USR_ID,T) CONCAT '-'               11150061
111600                     CONCAT STRIP(LAST_NM,T) CONCAT ', '          11160054
111700                     CONCAT STRIP(FRST_NM,T)                      11170054
111800              INTO  :XL067-COMBINED-NAME-5                        11180053
111900              FROM   DLT_TMP_EMP  TMP                             11190083
112000              WHERE  TMP.TMP_USR_ID = :XL067-KEY-USER-ID          11200054
112100         END-EXEC                                                 11210053
112200                                                                  11220053
112300         MOVE SQLCA            TO XL067-SQLCA                     11230099
112400                                                                  11240099
112500         EVALUATE TRUE                                            11250053
112600             WHEN SQLCODE = ZERO                                  11260053
112700                  SET XL067-SUCCESSFUL                            11270066
112800                      XL067-USER-IS-TEMP     TO TRUE              11280066
112900                                                                  11290053
113000             WHEN SQLCODE = -904                                  11300053
113100             WHEN SQLCODE = -911                                  11310053
113200             WHEN SQLCODE = -913                                  11320053
113300                  IF PV-RETRY-COUNTER > PC-MAX-RETRIES            11330053
113400                     SET XL067-SQL-ERROR   TO TRUE                11340053
113500                     MOVE PV-PARA    TO XL067-TEMP-CONTENTION-NBR 11350053
113600                     MOVE SQLCODE    TO XL067-TEMP-SQLCODE        11360077
113700                  END-IF                                          11370053
113800                                                                  11380053
113900             WHEN SQLCODE = +100                                  11390053
114000                  SET XL067-USER-NOT-FOUND                        11400071
114100                      XL067-TEMP-NOT-FOUND                        11410072
114200                      XL067-SUCCESSFUL      TO TRUE               11420072
114300                  MOVE SQLCODE    TO XL067-TEMP-SQLCODE           11430077
114400                  MOVE PV-PARA    TO XL067-TEMP-NOT-FOUND-NBR     11440066
114500                  MOVE PC-UNKNOWN TO XL067-LAST-NAME              11450066
114600                                     XL067-FIRST-NAME             11460066
114700                                     XL067-COMBINED-NAME-1        11470066
114800                                     XL067-COMBINED-NAME-2        11480066
114900                                     XL067-COMBINED-NAME-3        11490066
115000                                     XL067-COMBINED-NAME-4        11500066
115100                                     XL067-COMBINED-NAME-5        11510066
115200                                                                  11520053
115300             WHEN SQLWARN0 NOT = SPACES                           11530053
115400              AND SQLCODE NOT = ZERO                              11540081
115500                  MOVE +4                      TO PV-RETRY-COUNTER11550053
115600                  SET XL067-SQL-WARNING-ERROR  TO TRUE            11560053
115700                  MOVE PV-PARA            TO XL067-TEMP-ERROR-NBR 11570053
115800                                                                  11580053
115900         END-EVALUATE                                             11590053
116000     END-PERFORM.                                                 11600053
116100                                                                  11610053
116200******************************************************************11620053
116300**                       END SUB ROUTINE                        **11630073
116400******************************************************************11640053
