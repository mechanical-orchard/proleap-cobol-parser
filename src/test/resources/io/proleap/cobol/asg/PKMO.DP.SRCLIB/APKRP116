000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP116.                                        00020000
000300 AUTHOR.         M.WILKINSON.                                     00030000
000400 DATE-WRITTEN.   10/20/1995.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*************************************************************     00060000
000700*    COBOL 2                                                *     00070000
000800*                                                           *     00080000
000900*    UNJOURNALIZED RECEIPT AND NIR DETAIL REPORT            *     00090000
001000*                                                           *     00100000
001100*   PROGRAM OVERVIEW:                                       *     00110000
001200*                                                           *     00120000
001300*     THIS PROGRAM LISTS THE UNJOURNALIZED AND NON-         *     00130000
001400*     INVOICED RECEIPTS THAT ARE BETWEEN SUPPLIED DATES.    *     00140000
001500*                                                           *     00150000
001600*   INPUT:                                                  *     00160000
001700*                                                           *     00170000
001800*  1) VERIFIED-NINREC-FILE             (APRD102)            *     00180000
001900*  2) DATE-CONTROL-FILE               PV-DATE-AREA IN W/S   *     00190000
002000*  3) UNJOURNALIZED-FILE               (APRD042)            *     00200000
002100*                                                           *     00210000
002200*   OUTPUT:                                                 *     00220000
002300*                                                           *     00230000
002400*  1) RPT01-FILE                       (DPWS132O)           *     00240000
002500*                                                           *     00250000
002600*************************************************************     00260000
002700*   CHANGES:                                                *     00270000
002800*                                                           *     00280000
002900*   06/08/98  CHANGE MADE: Y2K. REMOVE 05 LEVEL PV-YYYYMMDD *     00290000
003000*             FIELD AND CORRESPONDING 10 LEVELS (PV-CENTURY,*     00300000
003100*             PV-YYMMDD, & PV-YYMMDD-9). THESE VARIABLES    *     00310000
003200*             ARE NOT USED IN PROGRAM.                      *     00320000
003300*             MADE BY: CAROLYN GIFFORD         WR/IR #:6041 *     00330000
003400*                                                           *     00340000
003500*   08/04/99  CHANGE MADE: Y2K. REPLACED THE INTRANEX       *     00350000
003600*             COPYBOOK WITH THE APRD042 COPYBOOK.           *     00360000
003700*             MADE BY: ROBIN BERNOSKI          WR/IR #:6041 *     00370000
003800*                                                           *     00380000
003900* 02/04/2003                                                *     00390000
004000*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00400000
004100*    RENAMED APKRP102 TO BE APKRP116. UPDATED THE PGM TITLE *     00410000
004200*    TO MATCH THE SPEC TITLE.                               *     00420000
004300*    UPDATED THE FILES IN THE PROG COMMENT BLOCK.           *     00430000
004400*    INCREASED THE PO PRINT FIELD TO Z(9) AND INCREASED THE *     00440000
004500*    OTHER W/S PO NBR FIELDS FROM 7 TO 9 BYTES.             *     00450000
004600* MADE BY:  MIKE BESKE                          WR#: 23500  *     00460000
004700*                                                           *     00470000
004800* 03/31/2004                                                *     00480000
004900*    CHANGE MADE: INCREASED VARIOUS W/S STORE VARIABLES FROM*     00490000
005000*    3 TO 4 CHARACTERS.  MODIFIED VARIOUS PARTS OF THE      *     00500000
005100*    PROCEDURE AREA TO REMOVE THE CUT DOWN OF THE APRD102   *     00510000
005200*    COPYBOOK STORE TO FIT THE OLD APRD042 STORE.  NOW IT   *     00520000
005300*    IS A STRAIGHT MOVE BECAUSE THE STORES ARE NOW 4 CHARS. *     00530000
005400* MADE BY:  MIKE BESKE                          WR#: 25805  *     00540000
004700*                                                           *     00541001
004800* 09/09/2021                                                *     00542001
004900*    CHANGE MADE: RECOMPILE FOR NEW VERSION OF APRD042      *     00543001
005400* MADE BY:  JEAN KURK                           CHG0260549  *     00548001
005500*************************************************************     00550000
005600/                                                                 00560000
005700 ENVIRONMENT DIVISION.                                            00570000
005800 CONFIGURATION SECTION.                                           00580000
005900 INPUT-OUTPUT SECTION.                                            00590000
006000 FILE-CONTROL.                                                    00600000
006100                                                                  00610000
006200     SELECT VERIFIED-NINREC-FILE ASSIGN TO UT-S-INP01.            00620000
006300     SELECT DATE-CONTROL-FILE    ASSIGN TO UT-S-INP02.            00630000
006400     SELECT UNJOURNALIZED-FILE   ASSIGN TO UT-S-INP03.            00640000
006500     SELECT RPT01-FILE           ASSIGN TO UT-S-RPT01.            00650000
006600                                                                  00660000
006700 DATA DIVISION.                                                   00670000
006800 FILE SECTION.                                                    00680000
006900 FD  VERIFIED-NINREC-FILE                                         00690000
007000     RECORDING MODE IS F                                          00700000
007100     LABEL RECORDS ARE STANDARD                                   00710000
007200     BLOCK CONTAINS 0 RECORDS                                     00720000
007300     DATA RECORD IS VERIFIED-NINREC-RECORD.                       00730000
007400 01  VERIFIED-NINREC-RECORD      PIC  X(200).                     00740000
007500                                                                  00750000
007600 FD  DATE-CONTROL-FILE                                            00760000
007700     RECORDING MODE IS F                                          00770000
007800     LABEL RECORDS ARE STANDARD                                   00780000
007900     BLOCK CONTAINS 0 RECORDS                                     00790000
008000     DATA RECORD IS DATE-CONTROL-RECORD.                          00800000
008100 01  DATE-CONTROL-RECORD         PIC  X(080).                     00810000
008200                                                                  00820000
008300 FD  UNJOURNALIZED-FILE                                           00830000
008400     RECORDING MODE IS F                                          00840000
008500     LABEL RECORDS ARE STANDARD                                   00850000
008600     BLOCK CONTAINS 0 RECORDS                                     00860000
008700     DATA RECORD IS UNJOURNALIZED-RECORD.                         00870000
008800 01  UNJOURNALIZED-RECORD        PIC  X(120).                     00880000
008900                                                                  00890000
009000 FD  RPT01-FILE                                                   00900000
009100     RECORDING MODE IS F                                          00910000
009200     LABEL RECORDS ARE STANDARD                                   00920000
009300     BLOCK CONTAINS 0 RECORDS                                     00930000
009400     DATA RECORD IS RPT01-RECORD.                                 00940000
009500 01  RPT01-RECORD                PIC  X(132).                     00950000
009600                                                                  00960000
009700 EJECT                                                            00970000
009800 WORKING-STORAGE SECTION.                                         00980000
009900                                                                  00990000
010000 01  PROGRAM-CONSTANTS.                                           01000000
010100     05  PC-MAX-LINES            PIC S9(05)   COMP-3  VALUE +60.  01010000
010200                                                                  01020000
010300 01  PV-DATE-AREA.                                                01030000
010400     05  PV-BEGIN-DATE           PIC X(10)   VALUE SPACES.        01040000
010500     05  FILLER                  PIC X(02)   VALUE SPACES.        01050000
010600     05  PV-ENDING-DATE          PIC X(10)   VALUE SPACES.        01060000
010700     05  FILLER                  PIC X(58)   VALUE SPACES.        01070000
010800                                                                  01080000
010900 01  PROGRAM-WORKAREA.                                            01090000
011000     05  FILLER                  PIC  X(30)           VALUE       01100000
011100         '** BEGINING OF APKRP116 W/S **'.                        01110000
011200                                                                  01120000
011300     05  PC-ONE                  PIC  9(01)    VALUE 1.           01130000
011400                                                                  01140000
011500     05  PV-CURRENT-PARAGRAPH    PIC  X(30)           VALUE SPACE.01150000
011600     05  PV-PROGRAM-NAME         PIC  X(08)           VALUE       01160000
011700         'APKRP116'.                                              01170000
011800     05  DB2-RETRY-MAX           PIC S9(04)    COMP   VALUE +3.   01180000
011900                                                                  01190000
012000*    05  INT-FULL-DATE.                                           01200000
012100*        10  INT-DATE            PIC X(08) VALUE SPACES.          01210000
012200*        10  INT-DATE-9   REDEFINES INT-DATE.                     01220000
012300*            15  INT-CC          PIC 9(02).                       01230000
012400*            15  INT-YY          PIC 9(02).                       01240000
012500*            15  INT-MM          PIC 9(02).                       01250000
012600*            15  INT-DD          PIC 9(02).                       01260000
012700                                                                  01270000
012800 01  KEY-AREA.                                                    01280000
012900     05  AP102-KEY.                                               01290000
013000         10  AP102-KEY-DEPT      PIC X(03) VALUE SPACES.          01300000
013100         10  AP102-KEY-PO-NBR    PIC X(09) VALUE SPACES.          01310000
013200         10  AP102-KEY-VEND-NBR  PIC X(09) VALUE SPACES.          01320000
013300         10  AP102-KEY-PO-LNE    PIC X(03) VALUE SPACES.          01330000
013400         10  AP102-KEY-STR-NBR   PIC X(04) VALUE SPACES.          01340000
013500     05  INT-KEY.                                                 01350000
013600         10  INT-KEY-DEPT        PIC X(03) VALUE SPACES.          01360000
013700         10  INT-KEY-PO-NBR      PIC X(09) VALUE SPACES.          01370000
013800         10  INT-KEY-VEND-NBR    PIC X(09) VALUE SPACES.          01380000
013900         10  INT-KEY-PO-LNE      PIC X(03) VALUE SPACES.          01390000
014000         10  INT-KEY-STR-NBR     PIC X(04) VALUE SPACES.          01400000
014100     05  HOLD-KEY.                                                01410000
014200         10  HOLD-KEY-DEPT       PIC X(03) VALUE SPACES.          01420000
014300         10  HOLD-KEY-DEPT-9     REDEFINES HOLD-KEY-DEPT          01430000
014400                                                     PIC 9(03).   01440000
014500         10  HOLD-KEY-PO-NBR     PIC X(09) VALUE SPACES.          01450000
014600         10  HOLD-KEY-PO-NBR-9   REDEFINES HOLD-KEY-PO-NBR        01460000
014700                                                     PIC 9(09).   01470000
014800         10  HOLD-KEY-VEND-NBR   PIC X(09) VALUE SPACES.          01480000
014900         10  HOLD-KEY-VEND-NBR-9 REDEFINES HOLD-KEY-VEND-NBR      01490000
015000                                                     PIC 9(09).   01500000
015100         10  HOLD-KEY-PO-LNE     PIC X(03) VALUE SPACES.          01510000
015200         10  HOLD-KEY-PO-LNE-9   REDEFINES HOLD-KEY-PO-LNE        01520000
015300                                                     PIC 9(03).   01530000
015400         10  HOLD-KEY-STR-NBR    PIC X(04) VALUE SPACES.          01540000
015500         10  HOLD-KEY-STR-NBR-9  REDEFINES HOLD-KEY-STR-NBR       01550000
015600                                                     PIC 9(04).   01560000
015700                                                                  01570000
015800 01  PRINT-FIELDS.                                                01580000
015900     05  PV-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01590000
016000     05  PV-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01600000
016100                                                                  01610000
016200 01  PROGRAM-SWITCHES-SUBS.                                       01620000
016300     05  PV-EOF-SW-AP102         PIC  X(01)           VALUE 'N'.  01630000
016400         88  EOF-AP102           VALUE 'Y'.                       01640000
016500     05  PV-EOF-SW-INT           PIC  X(01)           VALUE 'N'.  01650000
016600         88  EOF-INT             VALUE 'Y'.                       01660000
016700                                                                  01670000
016800     05  HOLD-VRFD-DTE.                                           01680000
016900         10  HOLD-YY             PIC X(04) VALUE SPACES.          01690000
017000         10  FILLER              PIC X(01) VALUE '-'.             01700000
017100         10  HOLD-MM             PIC X(02) VALUE SPACES.          01710000
017200         10  FILLER              PIC X(01) VALUE '-'.             01720000
017300         10  HOLD-DD             PIC X(02) VALUE SPACES.          01730000
017400                                                                  01740000
017500     05  INT-FULL-DATE.                                           01750000
017600         10  INT-MM              PIC X(02) VALUE SPACES.          01760000
017700         10  FILLER              PIC X(01) VALUE '-'.             01770000
017800         10  INT-DD              PIC X(02) VALUE SPACES.          01780000
017900         10  FILLER              PIC X(01) VALUE '-'.             01790000
018000         10  INT-YY              PIC X(04) VALUE SPACES.          01800000
018100                                                                  01810000
018200 01  PV-CURRENT-DATE.                                             01820000
018300     05  PV-CURRENT-YEAR         PIC  9(02)           VALUE 0.    01830000
018400     05  PV-CURRENT-MONTH        PIC  9(02)           VALUE 0.    01840000
018500     05  PV-CURRENT-DAY          PIC  9(02)           VALUE 0.    01850000
018600                                                                  01860000
018700 01  PV-CURRENT-JULIAN           PIC  9(05)           VALUE 0.    01870000
018800                                                                  01880000
018900 01  PV-CURRENT-TIME.                                             01890000
019000     05  PV-CURRENT-HOUR         PIC  9(02)           VALUE 0.    01900000
019100     05  PV-CURRENT-MINUTE       PIC  9(02)           VALUE 0.    01910000
019200     05  FILLER                  PIC  9(02)           VALUE 00.   01920000
019300                                                                  01930000
019400 EJECT                                                            01940000
019500*  INPUT RECORD AREA                                              01950000
019600                                                                  01960000
019700 01  AP102-RECORD.                                                01970000
019800     COPY APRD102.                                                01980000
019900                                                                  01990000
020000 EJECT                                                            02000000
020100*  INPUT RECORD AREA                                              02010000
020200                                                                  02020000
020300*01  AP042-EXTRACT-FILE.                                          02030000
020400     COPY APRD042.                                                02040000
020500                                                                  02050000
020600 EJECT                                                            02060000
020700*  PRINT AREA                                                     02070000
020800                                                                  02080000
020900     COPY DPWS132O.                                               02090000
021000                                                                  02100000
021100 01  HDR-LINE2.                                                   02110000
021200     05  FILLER                  PIC  X(40)   VALUE SPACES.       02120000
021300     05  HL2-TITLE               PIC  X(52)   VALUE               02130000
021400         'UNJOURNALIZED AND NON-INVOICED RECEIPT DETAIL REPORT'.  02140000
021500     05  FILLER                  PIC  X(40)   VALUE SPACES.       02150000
021600                                                                  02160000
021700 01  HDR-LINE2B.                                                  02170000
021800     05  FILLER                  PIC  X(49)   VALUE SPACES.       02180000
021900     05  FILLER                  PIC  X(07)   VALUE               02190000
022000         'DATES: '.                                               02200000
022100     05  HL2-BEGIN-DATE          PIC  X(10)   VALUE SPACES.       02210000
022200     05  FILLER                  PIC  X(06)   VALUE ' THRU '.     02220000
022300     05  HL2-END-DATE            PIC  X(10)   VALUE SPACES.       02230000
022400     05  FILLER                  PIC  X(50)   VALUE SPACES.       02240000
022500                                                                  02250000
022600 01  DETAIL-HEADER.                                               02260000
022700     05  FILLER               PIC X(3)    VALUE 'DPT'.            02270000
022800     05  FILLER               PIC X(2)    VALUE SPACES.           02280000
022900     05  FILLER               PIC X(11)   VALUE 'VENDOR NAME'.    02290000
023000     05  FILLER               PIC X(15)   VALUE SPACES.           02300000
023100     05  FILLER               PIC X(6)    VALUE 'PO NBR'.         02310000
023200     05  FILLER               PIC X(3)    VALUE SPACES.           02320000
023300     05  FILLER               PIC X(4)    VALUE 'LINE'.           02330000
023400     05  FILLER               PIC X(1)    VALUE SPACES.           02340000
023500     05  FILLER               PIC X(3)    VALUE 'CLS'.            02350000
023600     05  FILLER               PIC X(1)    VALUE SPACES.           02360000
023700     05  FILLER               PIC X(3)    VALUE 'STR'.            02370000
023800     05  FILLER               PIC X(2)    VALUE SPACES.           02380000
023900     05  FILLER               PIC X(7)    VALUE 'CREATED'.        02390000
024000     05  FILLER               PIC X(5)    VALUE SPACES.           02400000
024100     05  FILLER               PIC X(8)    VALUE 'VERIFIED'.       02410000
024200     05  FILLER               PIC X(8)    VALUE SPACES.           02420000
024300     05  FILLER               PIC X(9)    VALUE 'NR RETAIL'.      02430000
024400     05  FILLER               PIC X(8)    VALUE SPACES.           02440000
024500     05  FILLER               PIC X(7)    VALUE 'NR COST'.        02450000
024600     05  FILLER               PIC X(4)    VALUE SPACES.           02460000
024700     05  FILLER               PIC X(9)    VALUE 'RC RETAIL'.      02470000
024800     05  FILLER               PIC X(6)    VALUE SPACES.           02480000
024900     05  FILLER               PIC X(7)    VALUE 'RC COST'.        02490000
025000                                                                  02500000
025100 01  DETAIL-LINE.                                                 02510000
025200     05  DL-DEPT              PIC X(3).                           02520000
025300     05  FILLER               PIC X(2)    VALUE SPACES.           02530000
025400     05  DL-VENDOR-NAME       PIC X(23).                          02540000
025500     05  FILLER               PIC X(1)    VALUE SPACES.           02550000
025600     05  DL-PO-NBR            PIC Z(9)    VALUE ZERO.             02560000
025700     05  FILLER               PIC X(2)    VALUE SPACES.           02570000
025800     05  DL-PO-LINE-NBR       PIC X(3).                           02580000
025900     05  FILLER               PIC X(2)    VALUE SPACES.           02590000
026000     05  DL-CLASS             PIC X(2).                           02600000
026100     05  FILLER               PIC X(2)    VALUE SPACES.           02610000
026200     05  DL-STORE             PIC X(4).                           02620000
026300     05  FILLER               PIC X(1)    VALUE SPACES.           02630000
026400     05  DL-CREATE-DATE       PIC X(10).                          02640000
026500     05  FILLER               PIC X(2)    VALUE SPACES.           02650000
026600     05  DL-VERIFY-DATE       PIC X(10).                          02660000
026700     05  FILLER               PIC X(1)    VALUE SPACES.           02670000
026800     05  DL-NR-RETAIL         PIC ZZZ,ZZZ,ZZ9.99.                 02680000
026900     05  FILLER               PIC X(1)    VALUE SPACES.           02690000
027000     05  DL-NR-COST           PIC ZZZ,ZZZ,ZZZ.99.                 02700000
027100     05  FILLER               PIC X(1)    VALUE SPACES.           02710000
027200     05  DL-RC-RETAIL         PIC Z,ZZZ,ZZ9.99.                   02720000
027300     05  FILLER               PIC X(1)    VALUE SPACES.           02730000
027400     05  DL-RC-COST           PIC Z,ZZZ,ZZZ.99.                   02740000
027500                                                                  02750000
027600 01  EOR-END-OF-REPORT.                                           02760000
027700     05  FILLER                  PIC  X(52)  VALUE SPACES.        02770000
027800     05  FILLER                  PIC  X(26)  VALUE                02780000
027900         '*****  END OF REPORT *****'.                            02790000
028000     05  FILLER                  PIC  X(54)  VALUE SPACES.        02800000
028100                                                                  02810000
028200 EJECT                                                            02820000
028300 PROCEDURE DIVISION.                                              02830000
028400                                                                  02840000
028500***************************************************************** 02850000
028600*  MAIN PARAGRAPH                                                 02860000
028700***************************************************************** 02870000
028800 0000-MAIN.                                                       02880000
028900                                                                  02890000
029000     MOVE '0000-MAIN'            TO   PV-CURRENT-PARAGRAPH.       02900000
029100                                                                  02910000
029200     PERFORM 1000-BEGIN-PROGRAM.                                  02920000
029300     PERFORM 2000-PROCESS-DATA UNTIL EOF-AP102.                   02930000
029400     PERFORM 3000-FINISH-UNJ-FILE UNTIL EOF-INT.                  02940000
029500     PERFORM 4000-END-PROGRAM.                                    02950000
029600                                                                  02960000
029700     GOBACK.                                                      02970000
029800                                                                  02980000
029900 EJECT                                                            02990000
030000***************************************************************** 03000000
030100*  BEGIN PROGRAM STUFF                                            03010000
030200***************************************************************** 03020000
030300 1000-BEGIN-PROGRAM.                                              03030000
030400                                                                  03040000
030500     MOVE '1000-BEGIN-PROGRAM'   TO   PV-CURRENT-PARAGRAPH.       03050000
030600                                                                  03060000
030700     OPEN INPUT  VERIFIED-NINREC-FILE                             03070000
030800                 DATE-CONTROL-FILE                                03080000
030900                 UNJOURNALIZED-FILE                               03090000
031000          OUTPUT RPT01-FILE.                                      03100000
031100                                                                  03110000
031200     ACCEPT PV-CURRENT-JULIAN    FROM DAY.                        03120000
031300     READ DATE-CONTROL-FILE INTO PV-DATE-AREA.                    03130000
031400                                                                  03140000
031500     ACCEPT PV-CURRENT-DATE      FROM DATE.                       03150000
031600     MOVE PV-CURRENT-MONTH       TO   DP132O-RUN-MONTH.           03160000
031700     MOVE PV-CURRENT-DAY         TO   DP132O-RUN-DAY.             03170000
031800     MOVE PV-CURRENT-YEAR        TO   DP132O-RUN-YEAR.            03180000
031900                                                                  03190000
032000     ACCEPT PV-CURRENT-TIME      FROM TIME.                       03200000
032100     MOVE PV-CURRENT-HOUR        TO   DP132O-RUN-HOUR.            03210000
032200     MOVE PV-CURRENT-MINUTE      TO   DP132O-RUN-MINUTE.          03220000
032300                                                                  03230000
032400     MOVE PV-PROGRAM-NAME        TO   DP132O-PROGRAM-NAME.        03240000
032500     MOVE 1                      TO   DP132O-REPORT-NUMBER.       03250000
032600                                                                  03260000
032700     MOVE 99                     TO   PV-LINE-COUNT.              03270000
032800     MOVE PV-BEGIN-DATE          TO   HL2-BEGIN-DATE.             03280000
032900     MOVE PV-ENDING-DATE         TO   HL2-END-DATE.               03290000
033000                                                                  03300000
033100     MOVE SPACES                 TO   DETAIL-LINE.                03310000
033200                                                                  03320000
033300     PERFORM 7000-READ-VERIFIED-NINREC-FILE.                      03330000
033400     PERFORM 7100-READ-UNJOURNALIZED-FILE.                        03340000
033500                                                                  03350000
033600 EJECT                                                            03360000
033700***************************************************************** 03370000
033800*  MAIN PROGRAM LOOP.  IF KEYS FOR THE TWO RECORDS MATCH, MOVE    03380000
033900*  OUT ALL THE INFO.  IF NOT, MOVE OUT INFO FOR THE RECORD THAT   03390000
034000*  COMES FIRST SEQUENTIALLY.                                      03400000
034100***************************************************************** 03410000
034200 2000-PROCESS-DATA.                                               03420000
034300                                                                  03430000
034400     MOVE '2000-PROCESS-DATA'    TO   PV-CURRENT-PARAGRAPH.       03440000
034500                                                                  03450000
034600     IF AP102-KEY = INT-KEY                                       03460000
034700         PERFORM 8000-SETUP-AP102-PRINTLINE                       03470000
034800         PERFORM 8200-SETUP-LAST3-PRINTLINE                       03480000
034900         PERFORM 9000-WRITE-RECORD                                03490000
035000         PERFORM 7100-READ-UNJOURNALIZED-FILE                     03500000
035100         PERFORM UNTIL (AP102-KEY NOT = INT-KEY) OR EOF-INT       03510000
035200             PERFORM 8100-SETUP-INT-PRINTLINE                     03520000
035300             PERFORM 9000-WRITE-RECORD                            03530000
035400             PERFORM 7100-READ-UNJOURNALIZED-FILE                 03540000
035500         END-PERFORM                                              03550000
035600         PERFORM 7000-READ-VERIFIED-NINREC-FILE                   03560000
035700     ELSE                                                         03570000
035800         IF (AP102-KEY < INT-KEY) OR EOF-INT                      03580000
035900             PERFORM 8000-SETUP-AP102-PRINTLINE                   03590000
036000             PERFORM 9000-WRITE-RECORD                            03600000
036100             PERFORM 7000-READ-VERIFIED-NINREC-FILE               03610000
036200         ELSE                                                     03620000
036300             IF AP102-KEY > INT-KEY                               03630000
036400                 PERFORM 8100-SETUP-INT-PRINTLINE                 03640000
036500                 PERFORM 9000-WRITE-RECORD                        03650000
036600                 PERFORM 7100-READ-UNJOURNALIZED-FILE             03660000
036700             END-IF                                               03670000
036800         END-IF                                                   03680000
036900     END-IF.                                                      03690000
037000                                                                  03700000
037100 EJECT                                                            03710000
037200***************************************************************** 03720000
037300*  PRINT ANY RECORDS REMAINING IN THE UNJOURNALIZED FILE.         03730000
037400***************************************************************** 03740000
037500 3000-FINISH-UNJ-FILE.                                            03750000
037600                                                                  03760000
037700     MOVE '3000-FINISH-UNJ-FILE'   TO   PV-CURRENT-PARAGRAPH.     03770000
037800                                                                  03780000
037900     PERFORM 8100-SETUP-INT-PRINTLINE.                            03790000
038000     PERFORM 9000-WRITE-RECORD.                                   03800000
038100     PERFORM 7100-READ-UNJOURNALIZED-FILE.                        03810000
038200                                                                  03820000
038300 EJECT                                                            03830000
038400***************************************************************** 03840000
038500*  WRITE END OF REPORT AND CLOSE FILES.                           03850000
038600***************************************************************** 03860000
038700 4000-END-PROGRAM.                                                03870000
038800                                                                  03880000
038900     MOVE '4000-END-PROGRAM'     TO   PV-CURRENT-PARAGRAPH.       03890000
039000                                                                  03900000
039100     IF PV-LINE-COUNT > PC-MAX-LINES                              03910000
039200        PERFORM 9100-WRITE-HEADING.                               03920000
039300                                                                  03930000
039400     WRITE RPT01-RECORD FROM EOR-END-OF-REPORT                    03940000
039500           AFTER ADVANCING 2 LINES.                               03950000
039600                                                                  03960000
039700     CLOSE       VERIFIED-NINREC-FILE                             03970000
039800                 DATE-CONTROL-FILE                                03980000
039900                 UNJOURNALIZED-FILE                               03990000
040000                 RPT01-FILE.                                      04000000
040100 EJECT                                                            04010000
040200***************************************************************** 04020000
040300*  THIS ROUTINE READS THE REPORT FILE FROM APKUT102               04030000
040400***************************************************************** 04040000
040500 7000-READ-VERIFIED-NINREC-FILE.                                  04050000
040600                                                                  04060000
040700     MOVE '7000-READ-VERIFIED-NINREC-FILE'                        04070000
040800                                 TO   PV-CURRENT-PARAGRAPH.       04080000
040900                                                                  04090000
041000     READ VERIFIED-NINREC-FILE   INTO AP102-RECORD                04100000
041100         AT END                                                   04110000
041200             SET EOF-AP102 TO TRUE.                               04120000
041300                                                                  04130000
041400     MOVE AP102-DEPT-NBR        TO AP102-KEY-DEPT.                04140000
041500     MOVE AP102-PO-NBR          TO AP102-KEY-PO-NBR.              04150000
041600     MOVE AP102-DUN-NBR         TO AP102-KEY-VEND-NBR.            04160000
041700     MOVE AP102-PO-LNE-NBR(7:3) TO AP102-KEY-PO-LNE.              04170000
041800     MOVE AP102-STR-NBR         TO AP102-KEY-STR-NBR.             04180000
041900                                                                  04190000
042000 EJECT                                                            04200000
042100***************************************************************** 04210000
042200*  THIS ROUTINE READS THE WEEKLY UNJOURNALIZED EXTRACT FILE.      04220000
042300***************************************************************** 04230000
042400 7100-READ-UNJOURNALIZED-FILE.                                    04240000
042500                                                                  04250000
042600     MOVE '7100-READ-UNJOURNALIZED-FILE'                          04260000
042700                                 TO   PV-CURRENT-PARAGRAPH.       04270000
042800                                                                  04280000
042900     READ UNJOURNALIZED-FILE   INTO AP042-EXTRACT-FILE            04290000
043000         AT END                                                   04300000
043100             SET EOF-INT TO TRUE.                                 04310000
043200                                                                  04320000
043300     MOVE AP042-DEPT-NBR   TO INT-KEY-DEPT.                       04330000
043400     MOVE AP042-PO-NBR     TO INT-KEY-PO-NBR.                     04340000
043500     MOVE AP042-VND-NBR    TO INT-KEY-VEND-NBR.                   04350000
043600     MOVE AP042-PO-LNE-NBR TO INT-KEY-PO-LNE.                     04360000
043700     MOVE AP042-STR-NBR    TO INT-KEY-STR-NBR.                    04370000
043800                                                                  04380000
043900 EJECT                                                            04390000
044000***************************************************************** 04400000
044100*  THIS ROUTINE SETS UP THE AP102 PRINT LINE.                     04410000
044200***************************************************************** 04420000
044300 8000-SETUP-AP102-PRINTLINE.                                      04430000
044400                                                                  04440000
044500     MOVE '8000-SETUP-AP102-PRINTLINE'                            04450000
044600                                 TO   PV-CURRENT-PARAGRAPH.       04460000
044700                                                                  04470000
044800     IF (AP102-PO-NBR = HOLD-KEY-PO-NBR-9) AND                    04480000
044900        (AP102-DUN-NBR = HOLD-KEY-VEND-NBR) AND                   04490000
045000        (PV-LINE-COUNT <= PC-MAX-LINES)                           04500000
045100         IF (AP102-PO-LNE-NBR(7:3) = HOLD-KEY-PO-LNE-9) AND       04510000
045200            (AP102-STR-NBR      = HOLD-KEY-STR-NBR-9)             04520000
045300             CONTINUE                                             04530000
045400         ELSE                                                     04540000
045500             MOVE AP102-PO-LNE-NBR(7:3) TO DL-PO-LINE-NBR         04550000
045600                                           HOLD-KEY-PO-LNE        04560000
045700             MOVE AP102-CL-NBR(1:1)     TO DL-CLASS(1:1)          04570000
045800             MOVE '0'                   TO DL-CLASS(2:1)          04580000
045900             MOVE AP102-STR-NBR         TO DL-STORE               04590000
046000                                           HOLD-KEY-STR-NBR       04600000
046100         END-IF                                                   04610000
046200     ELSE                                                         04620000
046300         MOVE AP102-DEPT-NBR        TO DL-DEPT                    04630000
046400                                       HOLD-KEY-DEPT              04640000
046500         MOVE AP102-ENT-NAME-DESC   TO DL-VENDOR-NAME             04650000
046600         MOVE AP102-PO-NBR          TO DL-PO-NBR                  04660000
046700                                       HOLD-KEY-PO-NBR            04670000
046800         MOVE AP102-DUN-NBR         TO HOLD-KEY-VEND-NBR          04680000
046900         MOVE AP102-PO-LNE-NBR(7:3) TO DL-PO-LINE-NBR             04690000
047000                                       HOLD-KEY-PO-LNE            04700000
047100         MOVE AP102-CL-NBR(1:1)     TO DL-CLASS(1:1)              04710000
047200         MOVE '0'                   TO DL-CLASS(2:1)              04720000
047300         MOVE AP102-STR-NBR         TO DL-STORE                   04730000
047400                                       HOLD-KEY-STR-NBR           04740000
047500     END-IF.                                                      04750000
047600                                                                  04760000
047700     MOVE '  /  /    '            TO DL-CREATE-DATE.              04770000
047800     MOVE AP102-NINREC-REC-MM     TO DL-CREATE-DATE(1:2).         04780000
047900     MOVE AP102-NINREC-REC-DD     TO DL-CREATE-DATE(4:2).         04790000
048000     MOVE AP102-NINREC-REC-YYYY   TO DL-CREATE-DATE(7:4).         04800000
048100     MOVE AP102-NINREC-RTL-PR-AMT TO DL-NR-RETAIL.                04810000
048200     MOVE AP102-NINREC-COST-AMT   TO DL-NR-COST.                  04820000
048300                                                                  04830000
048400 EJECT                                                            04840000
048500***************************************************************** 04850000
048600*  THIS ROUTINE SETS UP THE UNJOURNALIZED EXTRACT PRINT LINE.     04860000
048700***************************************************************** 04870000
048800 8100-SETUP-INT-PRINTLINE.                                        04880000
048900                                                                  04890000
049000     MOVE '8100-SETUP-INT-PRINTLINE'                              04900000
049100                                 TO   PV-CURRENT-PARAGRAPH.       04910000
049200                                                                  04920000
049300     IF (AP042-PO-NBR = HOLD-KEY-PO-NBR-9) AND                    04930000
049400        (AP042-VND-NBR = HOLD-KEY-VEND-NBR-9) AND                 04940000
049500        (PV-LINE-COUNT <= PC-MAX-LINES)                           04950000
049600         IF (AP042-PO-LNE-NBR = HOLD-KEY-PO-LNE-9) AND            04960000
049700            (AP042-STR-NBR = HOLD-KEY-STR-NBR)                    04970000
049800             CONTINUE                                             04980000
049900         ELSE                                                     04990000
050000             MOVE AP042-PO-LNE-NBR  TO DL-PO-LINE-NBR             05000000
050100                                       HOLD-KEY-PO-LNE            05010000
050200             MOVE AP042-CL-NBR(1:2) TO DL-CLASS                   05020000
050300             MOVE AP042-STR-NBR     TO DL-STORE                   05030000
050400                                       HOLD-KEY-STR-NBR           05040000
050500         END-IF                                                   05050000
050600     ELSE                                                         05060000
050700         MOVE AP042-DEPT-NBR    TO DL-DEPT                        05070000
050800                                   HOLD-KEY-DEPT                  05080000
050900         MOVE AP042-ENT-NM-DESC TO DL-VENDOR-NAME                 05090000
051000         MOVE AP042-PO-NBR      TO DL-PO-NBR                      05100000
051100                                   HOLD-KEY-PO-NBR                05110000
051200         MOVE AP042-VND-NBR     TO HOLD-KEY-VEND-NBR              05120000
051300         MOVE AP042-PO-LNE-NBR  TO DL-PO-LINE-NBR                 05130000
051400                                   HOLD-KEY-PO-LNE                05140000
051500         MOVE AP042-CL-NBR(1:2) TO DL-CLASS                       05150000
051600         MOVE AP042-STR-NBR     TO DL-STORE                       05160000
051700                                   HOLD-KEY-STR-NBR               05170000
051800     END-IF.                                                      05180000
051900                                                                  05190000
052000     PERFORM 8200-SETUP-LAST3-PRINTLINE.                          05200000
052100                                                                  05210000
052200 EJECT                                                            05220000
052300***************************************************************** 05230000
052400*  THIS ROUTINE SETS UP ONLY THE 3 RECEIVER FIELDS FOR PRINTING.  05240000
052500***************************************************************** 05250000
052600 8200-SETUP-LAST3-PRINTLINE.                                      05260000
052700                                                                  05270000
052800     MOVE '8200-SETUP-LAST3-PRINTLINE'                            05280000
052900                                 TO   PV-CURRENT-PARAGRAPH.       05290000
053000                                                                  05300000
053100     MOVE AP042-VRFD-DTE TO HOLD-VRFD-DTE.                        05310000
053200     MOVE HOLD-YY        TO INT-YY.                               05320000
053300     MOVE HOLD-MM        TO INT-MM.                               05330000
053400     MOVE HOLD-DD        TO INT-DD.                               05340000
053500                                                                  05350000
053600     MOVE INT-FULL-DATE  TO DL-VERIFY-DATE.                       05360000
053700                                                                  05370000
053800     MOVE AP042-CALCD-VRFD-RTL-AMT   TO DL-RC-RETAIL.             05380000
053900     MOVE AP042-CALCD-VRFD-COST-AMT  TO DL-RC-COST.               05390000
054000                                                                  05400000
054100 EJECT                                                            05410000
054200***************************************************************** 05420000
054300*  PRINT RECORDS                                                  05430000
054400***************************************************************** 05440000
054500 9000-WRITE-RECORD.                                               05450000
054600                                                                  05460000
054700     MOVE '9000-WRITE-RECORD'    TO   PV-CURRENT-PARAGRAPH.       05470000
054800                                                                  05480000
054900     IF PV-LINE-COUNT > PC-MAX-LINES                              05490000
055000        PERFORM 9100-WRITE-HEADING.                               05500000
055100                                                                  05510000
055200     WRITE RPT01-RECORD FROM DETAIL-LINE                          05520000
055300        AFTER ADVANCING 1 LINES.                                  05530000
055400     ADD +1            TO PV-LINE-COUNT.                          05540000
055500     MOVE SPACES       TO DETAIL-LINE.                            05550000
055600                                                                  05560000
055700 EJECT                                                            05570000
055800***************************************************************** 05580000
055900*  REPORT AND COLUMN HEADINGS                                     05590000
056000***************************************************************** 05600000
056100 9100-WRITE-HEADING.                                              05610000
056200                                                                  05620000
056300     MOVE '9100-WRITE-HEADING'   TO   PV-CURRENT-PARAGRAPH.       05630000
056400                                                                  05640000
056500*  BUMP PAGE COUNT                                                05650000
056600     ADD 1                       TO   PV-PAGE-COUNT.              05660000
056700     MOVE PV-PAGE-COUNT          TO   DP132O-PAGE-NUMBER.         05670000
056800                                                                  05680000
056900*  CLEAR LINE COUNT                                               05690000
057000     MOVE 0                      TO   PV-LINE-COUNT.              05700000
057100                                                                  05710000
057200*  HEADING LINE 1 (STANDARD)                                      05720000
057300     WRITE RPT01-RECORD FROM DP132O-STANDRD-HEADER-132-COLS       05730000
057400           AFTER ADVANCING PAGE.                                  05740000
057500                                                                  05750000
057600*  HEADING LINE 2- APPL SPECIFIC                                  05760000
057700     WRITE RPT01-RECORD FROM HDR-LINE2                            05770000
057800           AFTER ADVANCING 1 LINES.                               05780000
057900     WRITE RPT01-RECORD FROM HDR-LINE2B                           05790000
058000           AFTER ADVANCING 1 LINES.                               05800000
058100     WRITE RPT01-RECORD FROM DETAIL-HEADER                        05810000
058200           AFTER ADVANCING 2 LINES.                               05820000
058300                                                                  05830000
058400     MOVE SPACES TO RPT01-RECORD.                                 05840000
058500     WRITE RPT01-RECORD AFTER ADVANCING 1 LINES.                  05850000
058600                                                                  05860000
058700     MOVE 7                      TO   PV-LINE-COUNT.              05870000
058800                                                                  05880000
