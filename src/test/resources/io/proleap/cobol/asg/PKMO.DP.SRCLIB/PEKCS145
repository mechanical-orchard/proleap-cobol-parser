000100 IDENTIFICATION DIVISION.                                         00010006
000200                                                                  00020006
000300 PROGRAM-ID.    PEKCS145.                                         00030006
000400 AUTHOR.        STU SMITH.                                        00040006
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050006
000600 DATE-WRITTEN.  09-12-91.                                         00060006
000700 DATE-COMPILED.                                                   00070006
000800                                                                  00080006
000900***************************************************************** 00090006
001000*    THIS PROGRAM DISPLAYS THE PERMANENT PRICE CHANGE             00100006
001100*    SYSTEM PARAMETERS. ALL PARAMETERS ARE DISPLAYED              00110006
001200*    BUT FISCAL DATE PARAMETERS CANNOT BE SELECTED                00120006
001300*    FOR TRANSFER TO PEKCS150 FOR UPDATE.                         00130006
001400*                                                                 00140006
001500*    TABLES READ ARE:-                                            00150006
001600*          TPPCCTL PERMANENT PRICE CHANGE CONTROL TABLE.          00160006
001700*                                                                 00170006
001800*    04/03/92 - A. REILAND  WR 1184                               00180006
001900*        ADDED COPYLIB PEWS048                                    00190006
002000******************************************************************00200006
002100* 07/01/92 - TCM -  WR NO. 2011                                  *00210006
002200*    MAKE CHANGES FOR NEW ARCHITECTURE                           *00220006
002300*    - CHANGE COPYBOOK FOR DPPD002 TO DPPD022                    *00230006
002400*    - CHANGE TEMPORARY STORAGE QUEUE NAME TO FOLLOW NEW NAMING  *00240006
002500*        STANDARD, INCLUDE SEQUENCE NUMBER IN QUEUE NAME,        *00250006
002600*        CHANGE LENGTH OF TASK NUMBER TO FIT SEQUENCE NUMBER IN  *00260006
002700*    - REMOVE COPYBOOK APPLICATION SPECIFIC AREA - PEWS021,      *00270006
002800*        HARD CODE IN APPLICATION SPECIFIC AREA, CHANGE THE      *00280006
002900*        PREFIX ON APPLICATION SPECIFIC FIELDS TO ASC-           *00290006
003000*    - REMOVE COPYBOOK MAP AREA - PEWS024, HARD CODE MAP         *00300006
003100*        REDEFINITION                                            *00310006
003200*    - REMOVE HARD CODED REFERENCE TO THE OPERATING COMPANY      *00320006
003300*    -   NOTE: PEKCS145/PEKCS150 STILL PROCESSES AS PEKCS365/    *00330006
003400*              PEKCS060 USED TO PROCESS.  BECAUSE OF THIS,       *00340006
003500*              COPYBOOK PEWS022 STILL USES THE                   *00350006
003600*              INTER-APPL-FORMAT-CODE AND THE                    *00360006
003700*              INTER-APPL-ACKNLG-CODE.                           *00370006
003800******************************************************************00380006
003900* 04/26/04 - TODD C. MICHALEK - WR 26966                         *00390006
004000*    ADDED COPYBOOK DPWS006 FOR CICS ARCHITECTURE                *00400006
004100******************************************************************00410006
004110*---------------------------------------------------------------* 00411007
004120* 09/14/2021 - GERMAN BANDA - CHG0261678                          00412010
004130* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00413008
004140*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00414008
004150*              MAKING THE CALL DYNAMIC VS STATIC                  00415008
004160*---------------------------------------------------------------* 00416008
004200*                                                                 00420006
004300*                                                                 00430006
004400*                                                                 00440006
004500 ENVIRONMENT DIVISION.                                            00450006
004600*                                                                 00460006
004700*                                                                 00470006
004800*                                                                 00480006
004900 DATA DIVISION.                                                   00490006
005000*                                                                 00500006
005100*                                                                 00510006
005200 WORKING-STORAGE SECTION.                                         00520006
005300                                                                  00530006
005400 01  PC-PROGRAM-CONSTANTS.                                        00540006
005500     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00550006
005600     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00560006
005700                                                     COMP SYNC.   00570006
005800     05  PC-SELECTED                    PIC X(01)    VALUE 'S'.   00580006
005900     05  PC-PEUPARM                     PIC X(08)                 00590006
006000                                        VALUE 'PEUPARM '.         00600006
006100     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00610006
006200     'PE145A  '.                                                  00620006
006300     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00630006
006400     'PEKM145 '.                                                  00640006
006500     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00650006
006600     'PEKCS145'.                                                  00660006
006700     05  PC-SEQ-1                       PIC 9        VALUE 1.     00670006
006800     05  PC-TSYMSG-00005                PIC 9(05)    VALUE 05.    00680006
006900     05  PC-TSYMSG-00008                PIC 9(05)    VALUE 08.    00690006
007000     05  PC-TSYMSG-00047                PIC 9(05)    VALUE 47.    00700006
007100     05  PC-TSYMSG-00050                PIC 9(05)    VALUE 50.    00710006
007200     05  PC-TSYMSG-00051                PIC 9(05)    VALUE 51.    00720006
007300     05  PC-TSYMSG-00052                PIC 9(05)    VALUE 52.    00730006
007400     05  PC-TSYMSG-00053                PIC 9(05)    VALUE 53.    00740006
007500     05  PC-TSYMSG-00054                PIC 9(05)    VALUE 54.    00750006
007600     05  PC-TSYMSG-00055                PIC 9(05)    VALUE 55.    00760006
007700     05  PC-TSYMSG-00057                PIC 9(05)    VALUE 57.    00770006
007800     05  PC-TSYMSG-00061                PIC 9(05)    VALUE 61.    00780006
007900     05  PC-TSYMSG-00062                PIC 9(05)    VALUE 62.    00790006
008000     05  PC-TSYMSG-00069                PIC 9(05)    VALUE 69.    00800006
008100     05  PC-TSYMSG-00070                PIC 9(05)    VALUE 70.    00810006
008200     05  PC-TSYMSG-99901                PIC 9(05)    VALUE 99901. 00820006
008300     05  PC-BEGINNING                   PIC X(01)    VALUE 'B'.   00830006
008400     05  PC-ENDING                      PIC X(01)    VALUE 'E'.   00840006
008500     05  PC-ITEMS-PER-PANEL             PIC S9(04)   VALUE +14    00850006
008600                                                     COMP SYNC.   00860006
008700     05  PC-ITEMS-PER-BLOCK             PIC S9(04)   VALUE +14    00870006
008800                                                     COMP SYNC.   00880006
008900     05  PC-MAX-ITEMS-TO-BE-READ        PIC S9(04)   VALUE +100   00890006
009000                                                     COMP SYNC.   00900006
009100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)   VALUE +2     00910006
009200                                                     COMP SYNC.   00920006
009300     05  PC-MAX-ITEMS                   PIC S9(09)   VALUE        00930006
009400                                                     +1000000     00940006
009500                                                     COMP-3.      00950006
009600     05  PC-BLOCK-LENGTH                PIC S9(04)   VALUE +967   00960006
009700                                                     COMP SYNC.   00970006
009800     05  PC-FIELD-LENGTH                PIC S9(04)   VALUE +7     00980006
009900                                                     COMP SYNC.   00990006
010000     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   01000006
010100                                                     COMP SYNC.   01010006
010200     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      01020006
010300         10  FILLER                     PIC X(01).                01030006
010400         10  PC-ERASE-EOF               PIC X(01).                01040006
010500                                                                  01050006
010600 01  PM-PROGRAM-MESSAGES.                                         01060006
010700     05  PM-PROGRAM-MESSAGE-1           PIC X(78)    VALUE        01070006
010800     'ERROR TRYING TO OPEN CURSOR FOR TPPCCTL TABLE - SQLCODE '.  01080006
010900     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-1.                   01090006
011000         10  FILLER                     PIC X(52).                01100006
011100         10  PM-SQLCODE-1               PIC Z(08)9-.              01110006
011200         10  FILLER                     PIC X(16).                01120006
011300     05  PM-PROGRAM-MESSAGE-2           PIC X(78)    VALUE        01130006
011400     'ERROR TRYING TO SELECT A ROW FROM TPPCCTL TABLE - SQLCODE '.01140006
011500     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-2.                   01150006
011600         10  FILLER                     PIC X(54).                01160006
011700         10  PM-SQLCODE-2               PIC Z(08)9-.              01170006
011800         10  FILLER                     PIC X(14).                01180006
011900     05  PM-PROGRAM-MESSAGE-3           PIC X(78)    VALUE        01190006
012000     'ERROR TRYING TO CLOSE CURSOR FOR TPPCCTL TABLE - SQLCODE '. 01200006
012100     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-3.                   01210006
012200         10  FILLER                     PIC X(53).                01220006
012300         10  PM-SQLCODE-3               PIC Z(08)9-.              01230006
012400         10  FILLER                     PIC X(15).                01240006
012500     05  PM-PROGRAM-MESSAGE-4           PIC X(78)    VALUE        01250006
012600     'ERROR TRYING TO REWRITE TO TEMP STORAGE QUEUE - RESP '.     01260006
012700     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-4.                   01270006
012800         10  FILLER                     PIC X(53).                01280006
012900         10  PM-RESP-4                  PIC Z(03)9-.              01290006
013000         10  FILLER                     PIC X(20).                01300006
013100     05  PM-PROGRAM-MESSAGE-5           PIC X(78)    VALUE        01310006
013200     'ERROR TRYING TO WRITE TO TEMP STORAGE QUEUE - RESP '.       01320006
013300     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-5.                   01330006
013400         10  FILLER                     PIC X(51).                01340006
013500         10  PM-RESP-5                  PIC Z(03)9-.              01350006
013600         10  FILLER                     PIC X(22).                01360006
013700     05  PM-PROGRAM-MESSAGE-6           PIC X(78)    VALUE        01370006
013800     'LOGIC ERROR IN TRYING TO WRITE TO TEMP STORAGE QUEUE - BLOCK01380006
013900-    '     '.                                                     01390006
014000     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-6.                   01400006
014100         10  FILLER                     PIC X(61).                01410006
014200         10  PM-BLOCK-NUMBER            PIC Z(03)9-.              01420006
014300         10  FILLER                     PIC X(12).                01430006
014400     05  PM-PROGRAM-MESSAGE-7           PIC X(78)    VALUE        01440006
014500     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                01450006
014600     05  PM-PROGRAM-MESSAGE-8           PIC X(78)    VALUE        01460006
014700     'ERROR TRYING TO DELETE TEMP STORAGE QUEUE - RESP '.         01470006
014800     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-8.                   01480006
014900         10  FILLER                     PIC X(49).                01490006
015000         10  PM-RESP-8                  PIC Z(03)9-.              01500006
015100         10  FILLER                     PIC X(24).                01510006
015200     05  PM-PROGRAM-MESSAGE-9           PIC X(78)    VALUE        01520006
015300     'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE - RESP '.      01530006
015400     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-9.                   01540006
015500         10  FILLER                     PIC X(52).                01550006
015600         10  PM-RESP-9                  PIC Z(03)9-.              01560006
015700         10  FILLER                     PIC X(21).                01570006
015800                                                                  01580006
015900 01  PS-PROGRAM-SUBSCRIPTS.                                       01590006
016000     05  PS-SUB                         PIC S9(04)   VALUE +0     01600006
016100                                                     COMP SYNC.   01610006
016200     05  PS-MAP-SUB                     PIC S9(04)   VALUE +0     01620006
016300                                                     COMP SYNC.   01630006
016400     05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0     01640006
016500                                                     COMP-3.      01650006
016600                                                                  01660006
016700 01  PS-PROGRAM-SWITCHES.                                         01670006
016800     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   01680006
016900         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   01690006
017000         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   01700006
017100         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   01710006
017200         88  PS-SEND-DATA-ONLY                       VALUE '4'.   01720006
017300         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   01730006
017400         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   01740006
017500     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   01750006
017600         88  PS-ERROR                                VALUE 'Y'.   01760006
017700         88  PS-NO-ERROR                             VALUE 'N'.   01770006
017800     05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.   01780006
017900         88  PS-INTER-APPL-VALID                     VALUE 'Y'.   01790006
018000         88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.   01800006
018100     05  PS-SAME-ITEMS-DISPLAYED-SW     PIC X(01)    VALUE 'N'.   01810006
018200         88  PS-SAME-ITEMS-DISPLAYED                 VALUE 'Y'.   01820006
018300         88  PS-DIFFERENT-ITEMS-DISPLAYED            VALUE 'N'.   01830006
018400     05  PS-CURSOR-POSITIONED-SW        PIC X(01)    VALUE 'N'.   01840006
018500         88  PS-CURSOR-POSITIONED                    VALUE 'Y'.   01850006
018600         88  PS-CURSOR-NOT-POSITIONED                VALUE 'N'.   01860006
018700     05  PS-VALID-BEG-ITEM-SW           PIC X(01)    VALUE 'N'.   01870006
018800         88  PS-VALID-BEG-ITEM                       VALUE 'Y'.   01880006
018900         88  PS-INVALID-BEG-ITEM                     VALUE 'N'.   01890006
019000     05  PS-TOP-ITEM-IN-ARRAY-SW        PIC X(01)    VALUE 'N'.   01900006
019100         88  PS-TOP-ITEM-IN-ARRAY                    VALUE 'Y'.   01910006
019200         88  PS-TOP-ITEM-NOT-IN-ARRAY                VALUE 'N'.   01920006
019300     05  PS-BOTTOM-ITEM-IN-ARRAY-SW     PIC X(01)    VALUE 'N'.   01930006
019400         88  PS-BOTTOM-ITEM-IN-ARRAY                 VALUE 'Y'.   01940006
019500         88  PS-BOTTOM-ITEM-NOT-IN-ARRAY             VALUE 'N'.   01950006
019600     05  PS-TOP-ITEM-IN-TEMP-SW         PIC X(01)    VALUE 'N'.   01960006
019700         88  PS-TOP-ITEM-IN-TEMP                     VALUE 'Y'.   01970006
019800         88  PS-TOP-ITEM-NOT-IN-TEMP                 VALUE 'N'.   01980006
019900     05  PS-BOTTOM-ITEM-IN-TEMP-SW      PIC X(01)    VALUE 'N'.   01990006
020000         88  PS-BOTTOM-ITEM-IN-TEMP                  VALUE 'Y'.   02000006
020100         88  PS-BOTTOM-ITEM-NOT-IN-TEMP              VALUE 'N'.   02010006
020200     05  PS-LAST-BLOCK-IN-ARRAY-SW      PIC X(01)    VALUE 'N'.   02020006
020300         88  PS-LAST-BLOCK-IN-ARRAY                  VALUE 'Y'.   02030006
020400         88  PS-LAST-BLOCK-NOT-IN-ARRAY              VALUE 'N'.   02040006
020500     05  PS-SELECTION-FOUND-SW          PIC X(01)    VALUE 'N'.   02050006
020600         88  PS-SELECTION-FOUND                      VALUE 'Y'.   02060006
020700         88  PS-NO-SELECTION-FOUND                   VALUE 'N'.   02070006
020800     05  PS-RETURN-FROM-Q150-SW         PIC X(01)    VALUE 'N'.   02080006
020900         88  PS-RETURN-FROM-Q150                     VALUE 'Y'.   02090006
021000         88  PS-NOT-RETURN-FROM-Q150                 VALUE 'N'.   02100006
021100     05  PS-VALID-FORMAT-CODE-SW        PIC X(01)    VALUE 'Y'.   02110006
021200         88  PS-VALID-FORMAT-CODE                    VALUE 'Y'.   02120006
021300         88  PS-INVALID-FORMAT-CODE                  VALUE 'N'.   02130006
021400     05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.   02140006
021500         88  PS-WARNING                              VALUE 'Y'.   02150006
021600         88  PS-NO-WARNING                           VALUE 'N'.   02160006
021700     05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.   02170006
021800         88  PS-INFORMATIONAL                        VALUE 'Y'.   02180006
021900         88  PS-NOT-INFORMATIONAL                    VALUE 'N'.   02190006
022000     05  PS-VALID-SELECTIONS-SW         PIC X(01)    VALUE 'N'.   02200006
022100         88  PS-VALID-SELECTIONS                     VALUE 'Y'.   02210006
022200         88  PS-INVALID-SELECTIONS                   VALUE 'N'.   02220006
022300     05  PS-CONTINUE-ON-SW              PIC X(01)    VALUE 'N'.   02230006
022400         88  PS-CONTINUE-ON                          VALUE 'Y'.   02240006
022500         88  PS-DO-NOT-CONTINUE-ON                   VALUE 'N'.   02250006
022600     05  PS-CURSOR-SET-SW               PIC X(01)    VALUE 'N'.   02260006
022700         88  PS-CURSOR-SET                           VALUE 'Y'.   02270006
022800         88  PS-CURSOR-NOT-SET                       VALUE 'N'.   02280006
022900                                                                  02290006
023000 01  PV-PROGRAM-VARIABLES.                                        02300006
023100     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     02310006
023200                                                     COMP SYNC.   02320006
023300     05  PV-HIGHEST-ITEM-TO-BE-READ     PIC S9(09)   VALUE +0     02330006
023400                                                     COMP-3.      02340006
023500     05  PV-ENDING-ITEM-ON-PANEL        PIC S9(09)   VALUE +0     02350006
023600                                                     COMP-3.      02360006
023700     05  PV-ITEM-IN-USE                 PIC S9(09)   VALUE +0     02370006
023800                                                     COMP-3.      02380006
023900     05  PV-START-ITEM-NUMBER           PIC S9(09)   VALUE +0     02390006
024000                                                     COMP-3.      02400006
024100     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     02410006
024200                                                     COMP-3.      02420006
024300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)   VALUE +0     02430006
024400                                                     COMP SYNC.   02440006
024500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)   VALUE +0     02450006
024600                                                     COMP SYNC.   02460006
024700     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     02470006
024800                                                     COMP-3.      02480006
024900     05  PV-SELECTED-PARM-NUMBER        PIC S9(09)   VALUE +0     02490006
025000                                                     COMP-3.      02500006
025100     05  PV-MAX-ITEMS-TO-BE-READ        PIC S9(09)   VALUE +0     02510006
025200                                                     COMP-3.      02520006
025300     05  PV-FIRST-ITEM-IN-ARRAY         PIC S9(09)   VALUE +0     02530006
025400                                                     COMP-3.      02540006
025500     05  PV-LAST-ITEM-IN-ARRAY          PIC S9(09)   VALUE +0     02550006
025600                                                     COMP-3.      02560006
025700     05  PV-LAST-ITEM-IN-TEMP           PIC S9(09)   VALUE +0     02570006
025800                                                     COMP-3.      02580006
025900     05  PV-BEGINNING-ITEM              PIC S9(09)   VALUE +0     02590006
026000                                                     COMP-3.      02600006
026100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)   VALUE +0     02610006
026200                                                     COMP-3.      02620006
026300     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     02630006
026400                                                     COMP SYNC.   02640006
026500     05  PV-RESP                        PIC S9(04)   VALUE +0     02650006
026600                                                     COMP SYNC.   02660006
026700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     02670006
026800                                                     COMP SYNC.   02680006
026900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     02690006
027000                                                     COMP SYNC.   02700006
027100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)   VALUE +0     02710006
027200                                                     COMP SYNC.   02720006
027300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0     02730006
027400                                                     COMP SYNC.   02740006
027500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0     02750006
027600                                                     COMP SYNC.   02760006
027700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)   VALUE +0     02770006
027800                                                     COMP SYNC.   02780006
027900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)   VALUE +0     02790006
028000                                                     COMP SYNC.   02800006
028100     05  PV-MSG-NUMBER                  PIC 9(05)    VALUE ZEROS. 02810006
028200     05  PV-DATE-MMDDYY-DISPLAY.                                  02820006
028300         10  PV-DATE-MMDDYY-MM-D        PIC X(2)     VALUE SPACES.02830006
028400         10  FILLER                     PIC X(1)     VALUE '/'.   02840006
028500         10  PV-DATE-MMDDYY-DD-D        PIC X(2)     VALUE SPACES.02850006
028600         10  FILLER                     PIC X(1)     VALUE '/'.   02860006
028700         10  PV-DATE-MMDDYY-YY-D        PIC X(2)     VALUE SPACES.02870006
028800     05  PV-DATE-MMDDYY-FORMAT.                                   02880006
028900         10  PV-DATE-MMDDYY-CC          PIC X(2)     VALUE SPACES.02890006
029000         10  PV-DATE-MMDDYY-YY          PIC X(2)     VALUE SPACES.02900006
029100         10  PV-DATE-MMDDYY-MM          PIC X(2)     VALUE SPACES.02910006
029200         10  PV-DATE-MMDDYY-DD          PIC X(2)     VALUE SPACES.02920006
029300     05  PV-DATE-MMYY-DISPLAY.                                    02930006
029400         10  FILLER                     PIC X(3)     VALUE SPACES.02940006
029500         10  PV-DATE-MMYY-MM-D          PIC X(2)     VALUE SPACES.02950006
029600         10  FILLER                     PIC X(1)     VALUE '/'.   02960006
029700         10  PV-DATE-MMYY-YY-D          PIC X(2)     VALUE SPACES.02970006
029800     05  PV-DATE-MMYY-FORMAT.                                     02980006
029900         10  FILLER                     PIC X(2)     VALUE SPACES.02990006
030000         10  PV-DATE-MMYY-CC            PIC X(2)     VALUE SPACES.03000006
030100         10  PV-DATE-MMYY-YY            PIC X(2)     VALUE SPACES.03010006
030200         10  PV-DATE-MMYY-MM            PIC X(2)     VALUE SPACES.03020006
030300     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.03030006
030400     05  PV-DISPLAY-NUMBER              PIC ZZZ,ZZZ  VALUE ZEROS. 03040006
030500     05  PV-DISPLAY-PARM-AMT           PIC  ZZZZZZZ9 VALUE ZEROS. 03050006
030600     05  PV-VALIDATE-NUMBER-X           PIC X(7)     VALUE SPACES.03060006
030700     05  FILLER REDEFINES PV-VALIDATE-NUMBER-X.                   03070006
030800         10 PV-VALIDATE-NUMBER          PIC 9(7).                 03080006
030900     05  PV-DISPLAY-NUMBER1             PIC ZZZ,ZZ9  VALUE ZEROS. 03090006
031000     05  PV-BLOCK                       PIC X(967)   VALUE SPACES.03100006
031100     05  FILLER REDEFINES PV-BLOCK.                               03110006
031200         10  FILLER                     PIC X(01).                03120006
031300         10  PV-BLOCK-ENTRIES OCCURS 14 TIMES.                    03130006
031400             15  PV-SELECTION-ENTRY     PIC X(01).                03140006
031500                 88  PV-SELECTION-MADE               VALUE 'S'.   03150006
031600             15  FILLER                 PIC X(1).                 03160006
031700             15  PV-SELECTED-PARM       PIC S9(3) COMP-3.         03170006
031800             15  FILLER                 PIC X(65).                03180006
031900 EJECT                                                            03190006
032000***************************************************************** 03200006
032100*    STANDARD COMMAREA.                                           03210006
032200***************************************************************** 03220006
032300                                                                  03230006
032400     COPY DPWS020.                                                03240006
032500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03250006
032600                                                                  03260006
032700***************************************************************** 03270006
032800*    INTER-APPLICATION COMMAREA.                                  03280006
032900***************************************************************** 03290006
033000                                                                  03300006
033100         10  INTER-APPL-COMM-AREA       PIC X(200).               03310006
033200     COPY PEWS022.                                                03320006
033300                                                                  03330006
033400***************************************************************** 03340006
033500*    SPECIFIC COMMMAREA FOR PEKCS145.                             03350006
033600***************************************************************** 03360006
033700         10  ASC-SPECIFIC-COMMAREA.                               03370006
033800             15  FILLER                               PIC X(02).  03380006
033900             15  ASC-BLOCK-ARRAY.                                 03390006
034000                 20  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.            03400006
034100                     30  ASC-BLOCK-MODIFIED-SW       PIC X(01).   03410006
034200                         88  ASC-BLOCK-MODIFIED                   03420006
034300                                                     VALUE 'Y'.   03430006
034400                         88  ASC-BLOCK-NOT-MODIFIED               03440006
034500                                                     VALUE 'N'.   03450006
034600                     30  ASC-BLOCK-ITEM-ENTIRS OCCURS 14 TIMES.   03460006
034700                         35  ASC-SELECTED-SW     PIC X(01).       03470006
034800                             88  ASC-NO-SELECT VALUE ' '.         03480006
034900                             88  ASC-SELECT      VALUE 'S'.       03490006
035000                             88  ASC-BEGIN       VALUE 'B'.       03500006
035100                             88  ASC-END         VALUE 'E'.       03510006
035200                         35  ASC-UPDATE-SW       PIC X(01).       03520006
035300                             88  ASC-CAN-UPDATE      VALUE 'Y'.   03530006
035400                             88  ASC-CANNOT-UPDATE VALUE 'N'.     03540006
035500                         35  ASC-LIST-ITEM-NUMBER     PIC S9(03)  03550006
035600                                                      COMP-3.     03560006
035700                         35  ASC-PARM-AMT             PIC S9(09)  03570006
035800                                                      COMP-3.     03580006
035900                         35  ASC-DESC                 PIC X(60).  03590006
036000             15  ASC-BLOCK-SUB                        PIC S9(04)  03600006
036100                                                      COMP.       03610006
036200             15  ASC-ITEM-SUB                         PIC S9(04)  03620006
036300                                                      COMP.       03630006
036400             15  ASC-NUMBER-OF-ITEMS-READ             PIC S9(09)  03640006
036500                                                      COMP-3.     03650006
036600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03660006
036700                                                         COMP-3.  03670006
036800             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03680006
036900                                                         COMP-3.  03690006
037000             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03700006
037100                                                         COMP-3.  03710006
037200             15  ASC-ITEM-AT-TOP-OF-PANEL             PIC S9(09)  03720006
037300                                                      COMP-3.     03730006
037400             15  ASC-HIGHEST-BLOCK-WRITTEN            PIC S9(04)  03740006
037500                                                      COMP.       03750006
037600             15  ASC-ITEMS-LEFT-ON-DB-SW              PIC X(1).   03760006
037700                 88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  03770006
037800                 88  ASC-NO-ITEMS-LEFT-ON-DB          VALUE 'N'.  03780006
037900             15  ASC-TEMP-QUEUE-NAME.                             03790006
038000                 20  ASC-TERM-ID                      PIC X(4).   03800006
038100                 20  ASC-TASK-NUMBER                  PIC S9(05)  03810006
038200                                                      COMP-3.     03820006
038300                 20  ASC-SEQ                          PIC 9.      03830006
038400             15  FILLER                               PIC X(889). 03840006
038500***************************************************************** 03850006
038600*    ABEND PROCESSING COPYBOOK.                                   03860006
038700***************************************************************** 03870006
038800                                                                  03880006
038900     COPY DPWS013.                                                03890006
039000                                                                  03900006
039100***************************************************************** 03910006
039200*    ATTRIBUTE SETTINGS COPYBOOK.                                 03920006
039300***************************************************************** 03930006
039400                                                                  03940006
039500     COPY DPWS015.                                                03950006
039600                                                                  03960006
039700***************************************************************** 03970006
039800*    CURRENT DATE AND TIME COPYBOOK.                              03980006
039900***************************************************************** 03990006
040000                                                                  04000006
040100     COPY DPWS017.                                                04010006
040200                                                                  04020006
040300***************************************************************** 04030006
040400*    CICS ARCHITECTURE VARIABLE LENGTH MESSAGE WORKING STORAGE    04040006
040500***************************************************************** 04050006
040600     COPY DPWS006.                                                04060006
040700***************************************************************** 04070006
040800*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          04080006
040900***************************************************************** 04090006
041000                                                                  04100006
041100     COPY DPWS009.                                                04110006
041200                                                                  04120006
041300***************************************************************** 04130006
041400*    FUNCTION KEYS COPYBOOK.                                      04140006
041500***************************************************************** 04150006
041600                                                                  04160006
041700     COPY DPWS016.                                                04170006
041800                                                                  04180006
041900***************************************************************** 04190006
042000*    DPKUT045 COPYBOOK.                                           04200006
042100***************************************************************** 04210006
042200                                                                  04220006
042300     COPY DPWS045.                                                04230006
042400                                                                  04240006
042500***************************************************************** 04250006
042600*    NUMERIC EDIT LAYOUT.                                         04260006
042700***************************************************************** 04270006
042800                                                                  04280006
042900     COPY DPWS010I.                                               04290006
043000                                                                  04300006
043100***************************************************************** 04310006
043200*    SYSTEM MESSAGES FILE COPY                                    04320006
043300***************************************************************** 04330006
043400                                                                  04340006
043500     COPY DPRD507I.                                               04350006
043600                                                                  04360006
043700***************************************************************** 04370006
043800*    STANDARD ATTENTION IDENTIFIER LIST                           04380006
043900***************************************************************** 04390006
044000                                                                  04400006
044100     COPY DFHAID.                                                 04410006
044200                                                                  04420006
044300***************************************************************** 04430006
044400*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        04440006
044500***************************************************************** 04450006
044600                                                                  04460006
044700     COPY DFHBMSCA.                                               04470006
044800                                                                  04480006
044900***************************************************************** 04490006
045000*    MAP LAYOUT                                                   04500006
045100***************************************************************** 04510006
045200                                                                  04520006
045300     COPY PEKM145.                                                04530006
045400                                                                  04540006
045500 01  MD-MAP-DATA-AREA REDEFINES PE145AI.                          04550006
045600     05  FILLER                 PIC X(1624).                      04560006
045700                                                                  04570006
045800 01  PEKM145I REDEFINES MD-MAP-DATA-AREA.                         04580006
045900     05  FILLER                 PIC X(12).                        04590006
046000     05  PEKM145I-ADATEL        PIC S9(04) COMP.                  04600006
046100     05  PEKM145I-ADATEA        PIC X(01).                        04610006
046200     05  FILLER                 PIC X(02).                        04620006
046300     05  PEKM145I-ADATEI        PIC X(10).                        04630006
046400     05  PEKM145I-ATIMEL        PIC S9(04) COMP.                  04640006
046500     05  PEKM145I-ATIMEA        PIC X(01).                        04650006
046600     05  FILLER                 PIC X(02).                        04660006
046700     05  PEKM145I-ATIMEI        PIC X(08).                        04670006
046800     05  PEKM145I-ATITLEL       PIC S9(04) COMP.                  04680006
046900     05  PEKM145I-ATITLEA       PIC X(01).                        04690006
047000     05  FILLER                 PIC X(02).                        04700006
047100     05  PEKM145I-ATITLEI       PIC X(30).                        04710006
047200     05  PEKM145I-ANETNAML      PIC S9(04) COMP.                  04720006
047300     05  PEKM145I-ANETNAMA      PIC X(01).                        04730006
047400     05  FILLER                 PIC X(02).                        04740006
047500     05  PEKM145I-ANETNAMI      PIC X(08).                        04750006
047600     05  PEKM145I-AMNEMICL      PIC S9(04) COMP.                  04760006
047700     05  PEKM145I-AMNEMICA      PIC X(01).                        04770006
047800     05  FILLER                 PIC X(02).                        04780006
047900     05  PEKM145I-AMENMICI      PIC X(08).                        04790006
048000     05  PEKM145I-ABEGITML      PIC S9(04) COMP.                  04800006
048100     05  PEKM145I-ABEGITMA      PIC X(01).                        04810006
048200     05  FILLER                 PIC X(02).                        04820006
048300     05  PEKM145I-ABEGITMI      PIC X(07).                        04830006
048400     05  PEKM145I-AENDITML      PIC S9(04) COMP.                  04840006
048500     05  PEKM145I-AENDITMA      PIC X(01).                        04850006
048600     05  FILLER                 PIC X(02).                        04860006
048700     05  PEKM145I-AENDITMI      PIC X(07).                        04870006
048800     05  PEKM145I-AOFL          PIC S9(04) COMP.                  04880006
048900     05  PEKM145I-AOFA          PIC X(01).                        04890006
049000     05  FILLER                 PIC X(02).                        04900006
049100     05  PEKM145I-AOFI          PIC X(02).                        04910006
049200     05  PEKM145I-ATOTITML      PIC S9(04) COMP.                  04920006
049300     05  PEKM145I-ATOTITMA      PIC X(01).                        04930006
049400     05  FILLER                 PIC X(02).                        04940006
049500     05  PEKM145I-ATOTITMI      PIC X(07).                        04950006
049600     05  PEKM145I-ASELCTI.                                        04960006
049700         10  PEKM145I-SELECTION-ENTRIES OCCURS 14 TIMES.          04970006
049800             15  PEKM145I-ASELL PIC S9(04) COMP.                  04980006
049900             15  PEKM145I-ASELA PIC X(01).                        04990006
050000             15  PEKM145I-ASELC PIC X(01).                        05000006
050100             15  PEKM145I-ASELH PIC X(01).                        05010006
050200             15  PEKM145I-ASELI PIC X(01).                        05020006
050300             15  PEKM145I-AVALL PIC S9(04) COMP.                  05030006
050400             15  PEKM145I-AVALA PIC X(01).                        05040006
050500             15  FILLER         PIC X(02).                        05050006
050600             15  PEKM145I-AVALI PIC X(08).                        05060006
050700             15  PEKM145I-ADESL PIC S9(04) COMP.                  05070006
050800             15  PEKM145I-ADESA PIC X(01).                        05080006
050900             15  FILLER         PIC X(02).                        05090006
051000             15  PEKM145I-ADESI PIC X(60).                        05100006
051100     05  PEKM145I-ATOTSELL      PIC S9(04) COMP.                  05110006
051200     05  PEKM145I-ATOTSELA      PIC X(01).                        05120006
051300     05  FILLER                 PIC X(02).                        05130006
051400     05  PEKM145I-ATOTSELI      PIC X(07).                        05140006
051500     05  PEKM145I-AMSGL         PIC S9(04) COMP.                  05150006
051600     05  PEKM145I-AMSGA         PIC X(01).                        05160006
051700     05  FILLER                 PIC X(02).                        05170006
051800     05  PEKM145I-AMSGI         PIC X(78).                        05180006
051900     05  PEKM145I-ANAVCMDL      PIC S9(04) COMP.                  05190006
052000     05  PEKM145I-ANAVCMDA      PIC X(01).                        05200006
052100     05  FILLER                 PIC X(02).                        05210006
052200     05  PEKM145I-ANAVCMDI      PIC X(08).                        05220006
052300     05  PEKM145I-ANAVKEYL      PIC S9(04) COMP.                  05230006
052400     05  PEKM145I-ANAVKEYA      PIC X(01).                        05240006
052500     05  FILLER                 PIC X(02).                        05250006
052600     05  PEKM145I-ANAVKEYI      PIC X(25).                        05260006
052700     05  PEKM145I-AFKLIN1L      PIC S9(04) COMP.                  05270006
052800     05  PEKM145I-AFKLIN1A      PIC X(01).                        05280006
052900     05  FILLER                 PIC X(02).                        05290006
053000     05  PEKM145I-AFKLIN1I      PIC X(78).                        05300006
053100     05  PEKM145I-AFKLIN2L      PIC S9(04) COMP.                  05310006
053200     05  PEKM145I-AFKLIN2A      PIC X(01).                        05320006
053300     05  FILLER                 PIC X(02).                        05330006
053400     05  PEKM145I-AFKLIN2I      PIC X(78).                        05340006
053500 01  PEKM145O REDEFINES MD-MAP-DATA-AREA.                         05350006
053600     05  FILLER                 PIC X(12).                        05360006
053700     05  FILLER                 PIC X(03).                        05370006
053800     05  PEKM145O-ADATEC        PIC X(01).                        05380006
053900     05  PEKM145O-ADATEH        PIC X(01).                        05390006
054000     05  PEKM145O-ADATEO        PIC X(10).                        05400006
054100     05  FILLER                 PIC X(03).                        05410006
054200     05  PEKM145O-ATIMEC        PIC X(01).                        05420006
054300     05  PEKM145O-ATIMEH        PIC X(01).                        05430006
054400     05  PEKM145O-ATIMEO        PIC X(08).                        05440006
054500     05  FILLER                 PIC X(03).                        05450006
054600     05  PEKM145O-ATITLEC       PIC X(01).                        05460006
054700     05  PEKM145O-ATITLEH       PIC X(01).                        05470006
054800     05  PEKM145O-ATITLEO       PIC X(30).                        05480006
054900     05  FILLER                 PIC X(03).                        05490006
055000     05  PEKM145O-ANETNAMC      PIC X(01).                        05500006
055100     05  PEKM145O-ANETNAMH      PIC X(01).                        05510006
055200     05  PEKM145O-ANETNAMO      PIC X(08).                        05520006
055300     05  FILLER                 PIC X(03).                        05530006
055400     05  PEKM145O-AMNEMICC      PIC X(01).                        05540006
055500     05  PEKM145O-AMNEMICH      PIC X(01).                        05550006
055600     05  PEKM145O-AMENMICO      PIC X(08).                        05560006
055700     05  FILLER                 PIC X(03).                        05570006
055800     05  PEKM145O-ABEGITMC      PIC X(01).                        05580006
055900     05  PEKM145O-ABEGITMH      PIC X(01).                        05590006
056000     05  PEKM145O-ABEGITMO      PIC ZZZ,ZZ9.                      05600006
056100     05  FILLER                 PIC X(03).                        05610006
056200     05  PEKM145O-AENDITMC      PIC X(01).                        05620006
056300     05  PEKM145O-AENDITMH      PIC X(01).                        05630006
056400     05  PEKM145O-AENDITMO      PIC ZZZ,ZZ9.                      05640006
056500     05  FILLER                 PIC X(03).                        05650006
056600     05  PEKM145O-AOFC          PIC X(01).                        05660006
056700     05  PEKM145O-AOFH          PIC X(01).                        05670006
056800     05  PEKM145O-AOFO          PIC X(02).                        05680006
056900     05  FILLER                 PIC X(03).                        05690006
057000     05  PEKM145O-ATOTITMC      PIC X(01).                        05700006
057100     05  PEKM145O-ATOTITMH      PIC X(01).                        05710006
057200     05  PEKM145O-ATOTITMO      PIC ZZZ,ZZZ.                      05720006
057300     05  PEKM145O-ASELCTO.                                        05730006
057400         10  PEKM145O-SELECTION-ENTRIES OCCURS 14 TIMES.          05740006
057500             15  FILLER         PIC X(03).                        05750006
057600             15  PEKM145O-ASELC PIC X(01).                        05760006
057700             15  PEKM145O-ASELH PIC X(01).                        05770006
057800             15  PEKM145O-ASELO PIC X(01).                        05780006
057900             15  FILLER         PIC X(03).                        05790006
058000             15  PEKM145O-AVALC PIC X(01).                        05800006
058100             15  PEKM145O-AVALH PIC X(01).                        05810006
058200             15  PEKM145O-AVALO PIC X(08).                        05820006
058300             15  FILLER         PIC X(03).                        05830006
058400             15  PEKM145O-ADESC PIC X(01).                        05840006
058500             15  PEKM145O-ADESH PIC X(01).                        05850006
058600             15  PEKM145O-ADESO PIC X(60).                        05860006
058700     05  FILLER                 PIC X(03).                        05870006
058800     05  PEKM145O-ATOTSELC      PIC X(01).                        05880006
058900     05  PEKM145O-ATOTSELH      PIC X(01).                        05890006
059000     05  PEKM145O-ATOTSELO      PIC ZZZ,ZZZ.                      05900006
059100     05  FILLER                 PIC X(03).                        05910006
059200     05  PEKM145O-AMSGC         PIC X(01).                        05920006
059300     05  PEKM145O-AMSGH         PIC X(01).                        05930006
059400     05  PEKM145O-AMSGO         PIC X(78).                        05940006
059500     05  FILLER                 PIC X(03).                        05950006
059600     05  PEKM145O-ANAVCMDC      PIC X(01).                        05960006
059700     05  PEKM145O-ANAVCMDH      PIC X(01).                        05970006
059800     05  PEKM145O-ANAVCMDO      PIC X(08).                        05980006
059900     05  FILLER                 PIC X(03).                        05990006
060000     05  PEKM145O-ANAVKEYC      PIC X(01).                        06000006
060100     05  PEKM145O-ANAVKEYH      PIC X(01).                        06010006
060200     05  PEKM145O-ANAVKEYO      PIC X(25).                        06020006
060300     05  FILLER                 PIC X(03).                        06030006
060400     05  PEKM145O-AFKLIN1C      PIC X(01).                        06040006
060500     05  PEKM145O-AFKLIN1H      PIC X(01).                        06050006
060600     05  PEKM145O-AFKLIN1O      PIC X(78).                        06060006
060700     05  FILLER                 PIC X(03).                        06070006
060800     05  PEKM145O-AFKLIN2C      PIC X(01).                        06080006
060900     05  PEKM145O-AFKLIN2H      PIC X(01).                        06090006
061000     05  PEKM145O-AFKLIN2O      PIC X(78).                        06100006
061100 EJECT                                                            06110006
061200***************************************************************** 06120006
061300*    PERM PRICE CHANGE CONTROL NUMBERS                            06130006
061400***************************************************************** 06140006
061500                                                                  06150006
061600     COPY PEWS048.                                                06160006
061700 EJECT                                                            06170006
061800***************************************************************** 06180006
061900*    DB2 COMMUNICATION AREA                                       06190006
062000***************************************************************** 06200006
062100                                                                  06210006
062200     EXEC SQL                                                     06220006
062300         INCLUDE SQLCA                                            06230006
062400     END-EXEC.                                                    06240006
062500                                                                  06250006
062600***************************************************************** 06260006
062700*    PERMANENT PRICE CHANGE VOLUME REPORT                         06270006
062800***************************************************************** 06280006
062900                                                                  06290006
063000     EXEC SQL                                                     06300006
063100         INCLUDE TPPCCTL                                          06310006
063200     END-EXEC.                                                    06320006
063300                                                                  06330006
063400     EXEC SQL                                                     06340006
063500         DECLARE CONTROL_TAB_CURSOR CURSOR FOR                    06350006
063600             SELECT PPCCTL_NBR,                                   06360006
063700                    PARM_AMT,                                     06370006
063800                    PPCCTL_DESC,                                  06380006
063900                    UPD_IND                                       06390006
064000             FROM TPPCCTL                                         06400006
064100         WHERE (OPERCO_NBR       =  :DP020-OPERATING-COMPANY) AND 06410006
064200               (PPCCTL_NBR       >  :PV-START-ITEM-NUMBER)        06420006
064300             ORDER BY PPCCTL_NBR                                  06430006
064400     END-EXEC.                                                    06440006
064500                                                                  06450006
064600 EJECT                                                            06460006
064700 LINKAGE SECTION.                                                 06470006
064800                                                                  06480006
064900 01  DFHCOMMAREA.                                                 06490006
065000     05  FILLER                         OCCURS  1 TO 4072 TIMES   06500006
065100                                        DEPENDING ON EIBCALEN.    06510006
065200         10  FILLER                     PIC X.                    06520006
065300                                                                  06530006
065400*                                                                 06540006
065500*                                                                 06550006
065600*                                                                 06560006
065700 PROCEDURE DIVISION.                                              06570006
065800                                                                  06580006
065900                                                                  06590006
066000 A100-MAIN-MODULE.                                                06600006
066100                                                                  06610006
066200******************************************************************06620006
066300*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           06630006
066400******************************************************************06640006
066500                                                                  06650006
066600     PERFORM DP015-0000-CHECK-COMMAREA.                           06660006
066700                                                                  06670006
066800     IF DP020-SRC-RETURN-W-TRAN-ID                                06680006
066900         PERFORM B100-CONTROL-PROCESSING                          06690006
067000     END-IF.                                                      06700006
067100                                                                  06710006
067200     PERFORM DP003-0000-RETURN-TO-CICS.                           06720006
067300 EJECT                                                            06730006
067400 B100-CONTROL-PROCESSING.                                         06740006
067500                                                                  06750006
067600******************************************************************06760006
067700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    06770006
067800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    06780006
067900*                                                                 06790006
068000*    PERFORMED BY A100-MAIN-MODULE.                               06800006
068100******************************************************************06810006
068200                                                                  06820006
068300     EVALUATE TRUE                                                06830006
068400                                                                  06840006
068500         WHEN DP020-NEXT-ACT-INITIAL                              06850006
068600             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 06860006
068700                                                                  06870006
068800             PERFORM C100-INITIALIZE-COMMAREA                     06880006
068900             PERFORM C200-SAVE-INITIAL-INTERAPPL                  06890006
069000             PERFORM D100-SETUP-INIT-PANEL                        06900006
069100                                                                  06910006
069200         WHEN DP020-NEXT-ACT-READ-MAP                             06920006
069300             MOVE -1         TO ANAVCMDL                          06930006
069400             PERFORM C300-PROCESS-PANEL                           06940006
069500                                                                  06950006
069600         WHEN DP020-NEXT-ACT-RETURN                               06960006
069700                                                                  06970006
069800             IF  PE022-INTER-APPL-FORMAT-CODE = 'Q150'            06980006
069900                 SET PS-RETURN-FROM-Q150 TO TRUE                  06990006
070000             END-IF                                               07000006
070100                                                                  07010006
070200             MOVE LOW-VALUES TO PE022-INTER-APPL-COMMAREA         07020006
070300                                                                  07030006
070400             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07040006
070500             MOVE -1         TO ANAVCMDL                          07050006
070600                                                                  07060006
070700             PERFORM C400-REFRESH-PANEL-FROM-TEMP                 07070006
070800                                                                  07080006
070900         WHEN DP020-NEXT-ACT-ERROR                                07090006
071000             MOVE DP020-MSG-NUMBER  TO PV-MSG-NUMBER              07100006
071100                                                                  07110006
071200             IF  DP020-NAV-MNEMONIC = SPACES                      07120006
071300                 MOVE SPACES          TO ANAVCMDO                 07130006
071400                 MOVE DP015-UNDERLINE TO ANAVCMDH                 07140006
071500                 MOVE DP015-GREEN     TO ANAVCMDC                 07150006
071600             ELSE                                                 07160006
071700                 MOVE -1         TO ANAVCMDL                      07170006
071800                 MOVE DP015-REVERSE   TO ANAVCMDH                 07180006
071900                 MOVE DP015-RED       TO ANAVCMDC                 07190006
072000             END-IF                                               07200006
072100                                                                  07210006
072200             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        07220006
072300                                                                  07230006
072400             PERFORM F100-EDIT-SELECTIONS                         07240006
072500                                                                  07250006
072600             MOVE PV-MSG-NUMBER TO DP020-MSG-NUMBER               07260006
072700                                                                  07270006
072800             SET DP020-MSG-FATAL         TO TRUE                  07280006
072900             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  07290006
073000             SET PS-SAME-ITEMS-DISPLAYED TO TRUE                  07300006
073100             SET PS-CURSOR-POSITIONED    TO TRUE                  07310006
073200                                                                  07320006
073300             PERFORM G100-DISPLAY-PANEL                           07330006
073400                                                                  07340006
073500         WHEN OTHER                                               07350006
073600             SET DP013-LOGIC-ABEND TO TRUE                        07360006
073700             SET DP013-NO-ROLLBACK TO TRUE                        07370006
073800                                                                  07380006
073900             MOVE 'B100-CONTROL-PROCESSING' TO                    07390006
074000                  DP013-PARAGRAPH                                 07400006
074100             MOVE PM-PROGRAM-MESSAGE-7      TO                    07410006
074200                  DP013-MESSAGE-TEXT(1)                           07420006
074300                                                                  07430006
074400             PERFORM DP013-0000-PROCESS-ABEND                     07440006
074500                                                                  07450006
074600     END-EVALUATE.                                                07460006
074700 EJECT                                                            07470006
074800 C100-INITIALIZE-COMMAREA.                                        07480006
074900                                                                  07490006
075000******************************************************************07500006
075100*    INITIALIZE SPECIFIC COMMAREA                                 07510006
075200*                                                                 07520006
075300*    PERFORMED BY B100-CONTROL-PROCESSING.                        07530006
075400******************************************************************07540006
075500     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07550006
075600                                                                  07560006
075700 EJECT                                                            07570006
075800 C200-SAVE-INITIAL-INTERAPPL.                                     07580006
075900                                                                  07590006
076000******************************************************************07600006
076100*    INITIALIZE THE INTER APPLICATION COMMAREA                    07610006
076200*                                                                 07620006
076300*    PERFORMED BY B100-CONTROL-PROCESSING.                        07630006
076400******************************************************************07640006
076500     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07650006
076600                                                                  07660006
076700 EJECT                                                            07670006
076800 C300-PROCESS-PANEL.                                              07680006
076900                                                                  07690006
077000******************************************************************07700006
077100*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED  07710006
077200*    ON WHAT FUNCTION KEY WAS SELECTED.                           07720006
077300*                                                                 07730006
077400*    PERFORMED BY B100-CONTROL-PROCESSING.                        07740006
077500******************************************************************07750006
077600                                                                  07760006
077700     PERFORM DP007-0000-GET-PANEL.                                07770006
077800                                                                  07780006
077900     SET PS-SEND-DATA-ONLY-FRSET TO TRUE                          07790006
078000                                                                  07800006
078100     EVALUATE TRUE                                                07810006
078200                                                                  07820006
078300         WHEN DP020-SRC-AID = DP016-CLEAR                         07830006
078400             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07840006
078500             SET PS-SAME-ITEMS-DISPLAYED  TO TRUE                 07850006
078600                                                                  07860006
078700             PERFORM F100-EDIT-SELECTIONS                         07870006
078800             PERFORM G100-DISPLAY-PANEL                           07880006
078900                                                                  07890006
079000         WHEN DP020-SRC-AID = DP016-PF5                           07900006
079100             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 07910006
079200             MOVE SPACES TO ANAVKEYI                              07920006
079300             PERFORM Z050-DELETE-TEMP-STORAGE                     07930006
079400             PERFORM D100-SETUP-INIT-PANEL                        07940006
079500                                                                  07950006
079600         WHEN DP020-SRC-AID = DP016-PA2                           07960006
079700             PERFORM DP009-0000-LOAD-FK-LINES                     07970006
079800             PERFORM DP017-0000-GET-CURR-DATE-TIME                07980006
079900                                                                  07990006
080000             SET PS-SEND-DATA-ONLY TO TRUE                        08000006
080100                                                                  08010006
080200             MOVE -1 TO ABEGITML                                  08020006
080300                                                                  08030006
080400             PERFORM DP008-0000-WRITE-PANEL                       08040006
080500                                                                  08050006
080600         WHEN OTHER                                               08060006
080700                                                                  08070006
080800             SET PS-INVALID-SELECTIONS TO TRUE                    08080006
080900                                                                  08090006
081000             PERFORM D200-RECORD-SELECTIONS                       08100006
081100                                                                  08110006
081200             IF PS-VALID-SELECTIONS                               08120006
081300                 PERFORM D300-CHECK-FUNCTION-KEY                  08130006
081400             ELSE                                                 08140006
081500                 SET PS-SAME-ITEMS-DISPLAYED TO TRUE              08150006
081600                                                                  08160006
081700                 PERFORM G100-DISPLAY-PANEL                       08170006
081800             END-IF                                               08180006
081900                                                                  08190006
082000     END-EVALUATE.                                                08200006
082100 EJECT                                                            08210006
082200 C350-RESET-ATTRIBUTES.                                           08220006
082300                                                                  08230006
082400******************************************************************08240006
082500*    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, 08250006
082600*    SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.       08260006
082700*    TO THE USER.                                                 08270006
082800*                                                                 08280006
082900*    PERFORMED BY C300-PROCESS-PANEL.                             08290006
083000******************************************************************08300006
083100                                                                  08310006
083200     MOVE +1                         TO PS-MAP-SUB.               08320006
083300                                                                  08330006
083400     PERFORM                                                      08340006
083500         UNTIL PS-MAP-SUB > 14                                    08350006
083600         MOVE DP015-GREEN     TO PEKM145O-ASELC(PS-MAP-SUB)       08360006
083700         MOVE DP015-UNDERLINE TO PEKM145O-ASELH(PS-MAP-SUB)       08370006
083800                                                                  08380006
083900         ADD 1 TO PS-MAP-SUB                                      08390006
084000                                                                  08400006
084100     END-PERFORM.                                                 08410006
084200 EJECT                                                            08420006
084300 C400-REFRESH-PANEL-FROM-TEMP.                                    08430006
084400                                                                  08440006
084500******************************************************************08450006
084600*    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, 08460006
084700*    SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.       08470006
084800*    TO THE USER.                                                 08480006
084900*                                                                 08490006
085000*    PERFORMED BY B100-CONTROL-PROCESSING.                        08500006
085100******************************************************************08510006
085200                                                                  08520006
085300     IF  PS-RETURN-FROM-Q150                                      08530006
085400         PERFORM D400-REFRESH-BLOCK-ARRAY                         08540006
085500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08550006
085600              TO PV-TOP-ITEM                                      08560006
085700         PERFORM Z050-DELETE-TEMP-STORAGE                         08570006
085800         PERFORM D100-SETUP-INIT-PANEL                            08580006
085900         PERFORM F500-BROWSE                                      08590006
086000     ELSE                                                         08600006
086100         PERFORM D400-REFRESH-BLOCK-ARRAY                         08610006
086200         PERFORM F100-EDIT-SELECTIONS                             08620006
086300         SET PS-DIFFERENT-ITEMS-DISPLAYED TO TRUE                 08630006
086400         PERFORM G100-DISPLAY-PANEL                               08640006
086500     END-IF.                                                      08650006
086600 EJECT                                                            08660006
086700 D100-SETUP-INIT-PANEL.                                           08670006
086800                                                                  08680006
086900******************************************************************08690006
087000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                         08700006
087100*    INITIALIZE PPCCTL_NBR COUNTERS AND FLAGS.                    08710006
087200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.   08720006
087300*    DISPLAY THE PANEL TO USER.                                   08730006
087400*                                                                 08740006
087500*    PERFORMED BY B100-CONTROL-PROCESSING.                        08750006
087600*    PERFORMED BY C300-PROCESS-PANEL.                             08760006
087700******************************************************************08770006
087800                                                                  08780006
087900     MOVE +1 TO ASC-BLOCK-SUB.                                    08790006
088000                                                                  08800006
088100     PERFORM I100-INITIALIZE-BLOCK.                               08810006
088200                                                                  08820006
088300     ADD +1 TO ASC-BLOCK-SUB.                                     08830006
088400                                                                  08840006
088500     PERFORM I100-INITIALIZE-BLOCK.                               08850006
088600                                                                  08860006
088700     MOVE +1                 TO ASC-BLOCK-SUB.                    08870006
088800     MOVE +0                 TO ASC-ITEM-SUB.                     08880006
088900     MOVE +0                 TO ASC-NUMBER-OF-ITEMS-READ.         08890006
089000     MOVE +0                 TO ASC-NUMBER-OF-SELECTED-ITEMS.     08900006
089100     MOVE SPACES             TO ASC-TEMP-QUEUE-NAME.              08910006
089200     MOVE +0                 TO ASC-HIGHEST-BLOCK-WRITTEN.        08920006
089300     MOVE +0                 TO ASC-START-OF-SELECTED-RANGE.      08930006
089400     MOVE +0                 TO ASC-END-OF-SELECTED-RANGE.        08940006
089500     MOVE PC-ITEMS-PER-PANEL TO PV-HIGHEST-ITEM-TO-BE-READ.       08950006
089600     MOVE -1                 TO ANAVCMDL.                         08960006
089700     MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-START-ITEM-NUMBER.       08970006
089800                                                                  08980006
089900     MOVE +1                         TO PS-MAP-SUB.               08990006
090000                                                                  09000006
090100     PERFORM                                                      09010006
090200         UNTIL PS-MAP-SUB > 14                                    09020006
090300         MOVE SPACES         TO PEKM145O-ASELO(PS-MAP-SUB)        09030006
090400                                                                  09040006
090500         ADD 1 TO PS-MAP-SUB                                      09050006
090600                                                                  09060006
090700     END-PERFORM.                                                 09070006
090800                                                                  09080006
090900     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            09090006
091000                                                                  09100006
091100     PERFORM H100-READ-ITEMS-FROM-DB.                             09110006
091200                                                                  09120006
091300     MOVE +1 TO ASC-ITEM-AT-TOP-OF-PANEL                          09130006
091400                                                                  09140006
091500     SET PS-DIFFERENT-ITEMS-DISPLAYED TO TRUE.                    09150006
091600                                                                  09160006
091700     IF  ASC-NUMBER-OF-ITEMS-READ = +0                            09170006
091800         MOVE ZERO TO PV-DISPLAY-NUMBER1                          09180006
091900         MOVE PV-DISPLAY-NUMBER1 TO ABEGITMI                      09190006
092000         MOVE PC-TSYMSG-00050        TO DP020-MSG-NUMBER          09200006
092100         SET DP020-MSG-INFORMATIONAL TO TRUE                      09210006
092200         SET PS-INFORMATIONAL        TO TRUE                      09220006
092300     END-IF.                                                      09230006
092400                                                                  09240006
092500     IF  PS-RETURN-FROM-Q150                                      09250006
092600         CONTINUE                                                 09260006
092700     ELSE                                                         09270006
092800         PERFORM G100-DISPLAY-PANEL                               09280006
092900     END-IF.                                                      09290006
093000 EJECT                                                            09300006
093100 D200-RECORD-SELECTIONS.                                          09310006
093200                                                                  09320006
093300******************************************************************09330006
093400*    IF THE USER HIT A KEY THAT DOES NOT REQUIRE US TO CHECK      09340006
093500*    WHAT WAS ENTERED ON THE SCREEN, SET A FLAG INDICATING THAT   09350006
093600*    ALL SELECTIONS ARE VALID.  IF ANY OTHER KEY IS HIT, MOVE THE 09360006
093700*    SELECTIONS MADE TO THE COMMAREA, AND EDIT THOSE SELECTIONS.  09370006
093800*                                                                 09380006
093900*    IF THE USER ENTERED SOMETHING IN THE COMMAND LINE OR HIT     09390006
094000*    AN INVALID FUNCTION KEY, DO NOT EDIT THE SELECTIONS.         09400006
094100*                                                                 09410006
094200*    PERFORMED BY C300-PROCESS-PANEL.                             09420006
094300******************************************************************09430006
094400                                                                  09440006
094500     IF (DP020-FK-DESELECT(DP020-SRC-AID))   OR                   09450006
094600        (DP020-FK-SELECT-ALL(DP020-SRC-AID)) OR                   09460006
094700        (DP020-FK-RETURN(DP020-SRC-AID))                          09470006
094800         SET PS-VALID-SELECTIONS TO TRUE                          09480006
094900     ELSE                                                         09490006
095000         PERFORM E200-MOVE-SELECTS-TO-COMMAREA                    09500006
095100                                                                  09510006
095200         IF (DP020-SRC-AID          = DP016-ENTER  AND            09520006
095300             DP020-NAV-MNEMONIC NOT = SPACES       AND            09530006
095400             DP020-NAV-MNEMONIC NOT = PC-PEUPARM   AND            09540006
095500             DP020-NAV-MNEMONIC NOT = LOW-VALUES)  OR             09550006
095600            (DP020-SRC-AID = DP016-PF1             OR             09560006
095700             DP020-SRC-AID = DP016-PF11            OR             09570006
095800             DP020-SRC-AID = DP016-PF12            OR             09580006
095900             DP020-SRC-AID = DP016-PF13            OR             09590006
096000             DP020-SRC-AID = DP016-PF14            OR             09600006
096100             DP020-SRC-AID = DP016-PF16            OR             09610006
096200             DP020-SRC-AID = DP016-PF17            OR             09620006
096300             DP020-SRC-AID = DP016-PF18            OR             09630006
096400             DP020-SRC-AID = DP016-PF19            OR             09640006
096500             DP020-SRC-AID = DP016-PF20            OR             09650006
096600             DP020-SRC-AID = DP016-PF21            OR             09660006
096700             DP020-SRC-AID = DP016-PF22            OR             09670006
096800             DP020-SRC-AID = DP016-PF23            OR             09680006
096900             DP020-SRC-AID = DP016-PF24)                          09690006
097000             SET PS-VALID-SELECTIONS TO TRUE                      09700006
097100         ELSE                                                     09710006
097200             PERFORM F100-EDIT-SELECTIONS                         09720006
097300         END-IF                                                   09730006
097400                                                                  09740006
097500     END-IF.                                                      09750006
097600                                                                  09760006
097700 EJECT                                                            09770006
097800 D300-CHECK-FUNCTION-KEY.                                         09780006
097900                                                                  09790006
098000******************************************************************09800006
098100*    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION    09810006
098200*    KEY HAD BEEN SELECTED BY THE USER.                           09820006
098300*                                                                 09830006
098400*    PERFORMED BY C300-PROCESS-PANEL.                             09840006
098500******************************************************************09850006
098600                                                                  09860006
098700     EVALUATE TRUE                                                09870006
098800                                                                  09880006
098900         WHEN (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)) OR             09890006
099000              (DP020-FK-RETURN(DP020-SRC-AID))                    09900006
099100                                                                  09910006
099200             SET PS-CONTINUE-ON TO TRUE                           09920006
099300             SET PS-NO-ERROR TO TRUE                              09930006
099400                                                                  09940006
099500             IF DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                09950006
099600                                                                  09960006
099700                 IF DP020-SRC-AID = DP016-PF15                    09970006
099800                                                                  09980006
099900                     IF ASC-NUMBER-OF-SELECTED-ITEMS = +0         09990006
100000                         MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER 10000006
100100                                                                  10010006
100200                         SET DP020-MSG-FATAL TO TRUE              10020006
100300                         SET PS-DO-NOT-CONTINUE-ON TO TRUE        10030006
100400                         SET PS-ERROR TO TRUE                     10040006
100500                     ELSE                                         10050006
100600                                                                  10060006
100700                         IF ASC-NUMBER-OF-SELECTED-ITEMS > +1     10070006
100800                             MOVE PC-TSYMSG-00047 TO              10080006
100900                                  DP020-MSG-NUMBER                10090006
101000                                                                  10100006
101100                             SET DP020-MSG-FATAL       TO TRUE    10110006
101200                             SET PS-DO-NOT-CONTINUE-ON TO TRUE    10120006
101300                         ELSE                                     10130006
101400                             PERFORM H400-WRITE-OUT-LAST-BLOCKS   10140006
101500                                                                  10150006
101600                             MOVE +1 TO PV-BLOCK-NUMBER           10160006
101700                             MOVE +1 TO PS-SUB                    10170006
101800                                                                  10180006
101900                             PERFORM Z175-READ-TEMP-STORAGE       10190006
102000                                                                  10200006
102100                             SET PS-NO-SELECTION-FOUND TO TRUE    10210006
102200                                                                  10220006
102300                             PERFORM E950-FIND-FIRST-SELECTED     10230006
102400                                UNTIL (PS-SELECTION-FOUND) OR     10240006
102500                                      (PV-CICS-RESPONSE =         10250006
102600                                       DFHRESP(ITEMERR))          10260006
102700                                                                  10270006
102800                                IF (PS-NO-SELECTION-FOUND)        10280006
102900                                                                  10290006
103000                                    SET PS-DO-NOT-CONTINUE-ON     10300006
103100                                                TO TRUE           10310006
103200                                END-IF                            10320006
103300                         END-IF                                   10330006
103400                                                                  10340006
103500                     END-IF                                       10350006
103600                                                                  10360006
103700                 END-IF                                           10370006
103800                                                                  10380006
103900             ELSE                                                 10390006
104000                 PERFORM Z050-DELETE-TEMP-STORAGE                 10400006
104100             END-IF                                               10410006
104200                                                                  10420006
104300             IF PS-CONTINUE-ON                                    10430006
104400                                                                  10440006
104500                 IF (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)) AND      10450006
104600                    (DP020-SRC-AID NOT = DP016-PF15)              10460006
104700                     PERFORM H400-WRITE-OUT-LAST-BLOCKS           10470006
104800                 END-IF                                           10480006
104900                                                                  10490006
105000                 PERFORM E300-NAVIGATE                            10500006
105100             ELSE                                                 10510006
105200                 PERFORM G100-DISPLAY-PANEL                       10520006
105300             END-IF                                               10530006
105400                                                                  10540006
105500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10550006
105600             PERFORM E400-DISPLAY-TOP-OF-LIST                     10560006
105700                                                                  10570006
105800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10580006
105900             PERFORM E500-BROWSE-BACKWARD                         10590006
106000                                                                  10600006
106100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10610006
106200             PERFORM E600-BROWSE-FORWARD                          10620006
106300                                                                  10630006
106400         WHEN (DP020-FK-DESELECT(DP020-SRC-AID)) OR               10640006
106500              (DP020-FK-SELECT-ALL(DP020-SRC-AID))                10650006
106600             PERFORM E700-SELECT-DESELECT-ALL                     10660006
106700                                                                  10670006
106800         WHEN DP020-SRC-AID = DP016-ENTER                         10680006
106900                                                                  10690006
107000             IF (DP020-NAV-MNEMONIC = LOW-VALUES) OR              10700006
107100                (DP020-NAV-MNEMONIC = SPACES)                     10710006
107200                 PERFORM E800-CHECK-FOR-JUMP-BROWSE               10720006
107300             ELSE                                                 10730006
107400                 IF (DP020-NAV-MNEMONIC = PC-PEUPARM)             10740006
107500                                                                  10750006
107600                     SET PS-CONTINUE-ON TO TRUE                   10760006
107700                     SET PS-NO-ERROR TO TRUE                      10770006
107800                                                                  10780006
107900                     IF ASC-NUMBER-OF-SELECTED-ITEMS = +0         10790006
108000                         MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER 10800006
108100                                                                  10810006
108200                         SET DP020-MSG-FATAL TO TRUE              10820006
108300                         SET PS-DO-NOT-CONTINUE-ON TO TRUE        10830006
108400                         SET PS-ERROR TO TRUE                     10840006
108500                     ELSE                                         10850006
108600                                                                  10860006
108700                         IF ASC-NUMBER-OF-SELECTED-ITEMS > +1     10870006
108800                             MOVE PC-TSYMSG-00047 TO              10880006
108900                                  DP020-MSG-NUMBER                10890006
109000                                                                  10900006
109100                             SET DP020-MSG-FATAL       TO TRUE    10910006
109200                             SET PS-DO-NOT-CONTINUE-ON TO TRUE    10920006
109300                         ELSE                                     10930006
109400                             PERFORM H400-WRITE-OUT-LAST-BLOCKS   10940006
109500                                                                  10950006
109600                             MOVE +1 TO PV-BLOCK-NUMBER           10960006
109700                             MOVE +1 TO PS-SUB                    10970006
109800                                                                  10980006
109900                             PERFORM Z175-READ-TEMP-STORAGE       10990006
110000                                                                  11000006
110100                             SET PS-NO-SELECTION-FOUND TO TRUE    11010006
110200                                                                  11020006
110300                             PERFORM E950-FIND-FIRST-SELECTED     11030006
110400                                UNTIL (PS-SELECTION-FOUND) OR     11040006
110500                                      (PV-CICS-RESPONSE =         11050006
110600                                       DFHRESP(ITEMERR))          11060006
110700                                                                  11070006
110800                                IF (PS-NO-SELECTION-FOUND)        11080006
110900                                                                  11090006
111000                                    SET PS-DO-NOT-CONTINUE-ON     11100006
111100                                                TO TRUE           11110006
111200                                END-IF                            11120006
111300                         END-IF                                   11130006
111400                                                                  11140006
111500                                                                  11150006
111600                     END-IF                                       11160006
111700                                                                  11170006
111800                     IF  PS-CONTINUE-ON                           11180006
111900                                                                  11190006
112000                         PERFORM H400-WRITE-OUT-LAST-BLOCKS       11200006
112100                         PERFORM E300-NAVIGATE                    11210006
112200                     ELSE                                         11220006
112300                         PERFORM G100-DISPLAY-PANEL               11230006
112400                     END-IF                                       11240006
112500                                                                  11250006
112600                 ELSE                                             11260006
112700                     PERFORM H400-WRITE-OUT-LAST-BLOCKS           11270006
112800                     MOVE LOW-VALUES TO INTER-APPL-COMM-AREA      11280006
112900                     PERFORM E300-NAVIGATE                        11290006
113000                 END-IF                                           11300006
113100             END-IF                                               11310006
113200                                                                  11320006
113300         WHEN OTHER                                               11330006
113400             PERFORM H400-WRITE-OUT-LAST-BLOCKS                   11340006
113500             PERFORM E300-NAVIGATE                                11350006
113600                                                                  11360006
113700     END-EVALUATE.                                                11370006
113800 EJECT                                                            11380006
113900 D400-REFRESH-BLOCK-ARRAY.                                        11390006
114000                                                                  11400006
114100******************************************************************11410006
114200*    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, 11420006
114300*    READ TEMPORARY STORAGE FILLING IN BOTH BLOCKS IN THE ARRAY   11430006
114400*    WITH THE ITEMS THAT WERE AT THE TOP OF THE LIST WHEN WE      11440006
114500*    HAD LEFT PREVIOUSLY.                                         11450006
114600*                                                                 11460006
114700*    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                   11470006
114800******************************************************************11480006
114900                                                                  11490006
115000     COMPUTE PV-TEMP-BLOCK-NUMBER =                               11500006
115100         1 + ((ASC-LIST-ITEM-NUMBER(1 1) - 1) /                   11510006
115200               PC-ITEMS-PER-BLOCK).                               11520006
115300                                                                  11530006
115400     MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                11540006
115500     MOVE +1                   TO ASC-BLOCK-SUB.                  11550006
115600                                                                  11560006
115700     PERFORM Z100-READ-TEMP-STORAGE.                              11570006
115800                                                                  11580006
115900     ADD +1 TO PV-BLOCK-NUMBER.                                   11590006
116000                                                                  11600006
116100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN) OR          11610006
116200        (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             11620006
116300         ADD +1 TO ASC-BLOCK-SUB                                  11630006
116400                                                                  11640006
116500         PERFORM Z100-READ-TEMP-STORAGE                           11650006
116600     END-IF.                                                      11660006
116700 EJECT                                                            11670006
116800 F100-EDIT-SELECTIONS.                                            11680006
116900                                                                  11690006
117000******************************************************************11700006
117100*    EDIT EACH SELECTION ENTRY.  IF EACH ENTRY IS CONSIDERED      11710006
117200*    VALID, CHECK IF A BEGINNING AND ENDING ENTRY WAS ENTERED,    11720006
117300*    AND CHECK THE FOLLOWING.                                     11730006
117400*                                                                 11740006
117500*    1) IF THERE IS A BEGINNING RANGE, THERE MUST BE AN ENDING.   11750006
117600*    2) IF THERE IS A ENDING RANGE, THERE MUST BE AN BEGINNING.   11760006
117700*    3) BEGINNING RANGE MUST PRECEDE ENDING RANGE.                11770006
117800*                                                                 11780006
117900*    IF A VALID BEGINNING AND ENDING RANGE HAVE BEEN SELECTED,    11790006
118000*    MARK ALL ITEMS IN THAT RANGE AS BEING SELECTED.              11800006
118100*                                                                 11810006
118200*    PERFORMED BY B100-CONTROL-PROCESSING.                        11820006
118300*    PERFORMED BY C300-PROCESS-PANEL.                             11830006
118400*    PERFORMED BY C500-REFRESH-PANEL-FROM-TEMP.                   11840006
118500*    PERFORMED BY D100-RECORD-SELECTIONS.                         11850006
118600******************************************************************11860006
118700                                                                  11870006
118800     SET PS-VALID-SELECTIONS TO TRUE.                             11880006
118900                                                                  11890006
119000     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            11900006
119100         (ASC-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.     11910006
119200                                                                  11920006
119300     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-ITEM-IN-USE.             11930006
119400     MOVE +1                         TO PS-SUB.                   11940006
119500                                                                  11950006
119600     PERFORM F100-EDIT                                            11960006
119700         UNTIL (PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL)    OR   11970006
119800               (PV-ITEM-IN-USE > ASC-NUMBER-OF-ITEMS-READ)        11980006
119900                                                                  11990006
120000     IF PS-VALID-SELECTIONS                                       12000006
120100                                                                  12010006
120200         IF ASC-START-OF-SELECTED-RANGE > +0                      12020006
120300                                                                  12030006
120400             IF ASC-END-OF-SELECTED-RANGE     >                   12040006
120500                ASC-START-OF-SELECTED-RANGE                       12050006
120600                 PERFORM F200-MARK-RANGE-AS-SELECTED              12060006
120700             ELSE                                                 12070006
120800                                                                  12080006
120900                 IF ASC-END-OF-SELECTED-RANGE = +0                12090006
121000                     MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER     12100006
121100                                                                  12110006
121200                     SET PS-CURSOR-POSITIONED TO TRUE             12120006
121300                     SET PS-WARNING           TO TRUE             12130006
121400                                                                  12140006
121500                     IF NOT DP020-NEXT-ACT-ERROR                  12150006
121600                         SET DP020-MSG-WARNING TO TRUE            12160006
121700                     END-IF                                       12170006
121800                                                                  12180006
121900                 ELSE                                             12190006
122000                     SET PS-INVALID-SELECTIONS TO TRUE            12200006
122100                     SET PS-CURSOR-POSITIONED  TO TRUE            12210006
122200                     SET DP020-MSG-FATAL       TO TRUE            12220006
122300                                                                  12230006
122400                     MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER     12240006
122500                                                                  12250006
122600                     IF NOT DP020-NEXT-ACT-ERROR                  12260006
122700                         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO         12270006
122800                              PV-ITEM-IN-USE                      12280006
122900                         MOVE +1                         TO       12290006
123000                              PS-SUB                              12300006
123100                                                                  12310006
123200                         PERFORM                                  12320006
123300                             UNTIL (PV-ITEM-IN-USE >              12330006
123400                                    PV-ENDING-ITEM-ON-PANEL)    OR12340006
123500                                   (PV-ITEM-IN-USE >              12350006
123600                                    ASC-NUMBER-OF-ITEMS-READ)     12360006
123700                                                                  12370006
123800                             PERFORM K100-SET-SUBSCRIPTS          12380006
123900                                                                  12390006
124000                             IF (ASC-BEGIN(ASC-BLOCK-SUB          12400006
124100                                             ASC-ITEM-SUB)) OR    12410006
124200                                (ASC-END(ASC-BLOCK-SUB            12420006
124300                                           ASC-ITEM-SUB))         12430006
124400                                 MOVE -1                      TO  12440006
124500                                      PEKM145I-ASELL(PS-SUB)      12450006
124600                                                                  12460006
124700                                 MOVE PV-ENDING-ITEM-ON-PANEL TO  12470006
124800                                      PV-ITEM-IN-USE              12480006
124900                             END-IF                               12490006
125000                                                                  12500006
125100                             ADD +1 TO PS-SUB                     12510006
125200                             ADD +1 TO PV-ITEM-IN-USE             12520006
125300                                                                  12530006
125400                         END-PERFORM                              12540006
125500                                                                  12550006
125600                     END-IF                                       12560006
125700                                                                  12570006
125800                 END-IF                                           12580006
125900                                                                  12590006
126000             END-IF                                               12600006
126100                                                                  12610006
126200         ELSE                                                     12620006
126300                                                                  12630006
126400             IF ASC-END-OF-SELECTED-RANGE > +0                    12640006
126500                 SET PS-CURSOR-POSITIONED TO TRUE                 12650006
126600                 SET PS-WARNING           TO TRUE                 12660006
126700                                                                  12670006
126800                 MOVE PC-TSYMSG-00053 TO DP020-MSG-NUMBER         12680006
126900                                                                  12690006
127000                 IF NOT DP020-NEXT-ACT-ERROR                      12700006
127100                     SET DP020-MSG-WARNING TO TRUE                12710006
127200                 END-IF                                           12720006
127300                                                                  12730006
127400             END-IF                                               12740006
127500                                                                  12750006
127600         END-IF                                                   12760006
127700                                                                  12770006
127800     END-IF.                                                      12780006
127900 EJECT                                                            12790006
128000 E200-MOVE-SELECTS-TO-COMMAREA.                                   12800006
128100                                                                  12810006
128200******************************************************************12820006
128300*    MOVE THE SELECTIONS MADE FROM THE CURRENT PAGE INTO          12830006
128400*    THE COMMAREA.                                                12840006
128500*                                                                 12850006
128600*    PERFORMED BY D100-RECORD-SELECTIONS.                         12860006
128700******************************************************************12870006
128800                                                                  12880006
128900     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            12890006
129000         (ASC-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.     12900006
129100                                                                  12910006
129200     MOVE +1                         TO PS-SUB.                   12920006
129300     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-ITEM-IN-USE.             12930006
129400                                                                  12940006
129500     PERFORM F300-CHECK-SELECTIONS                                12950006
129600         UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.          12960006
129700 EJECT                                                            12970006
129800 E300-NAVIGATE.                                                   12980006
129900                                                                  12990006
130000******************************************************************13000006
130100*    IF THE USER HITS A KEY THAT REQUIRES US TO GO TO ANOTHER     13010006
130200*    TRANSACTION,                                                 13020006
130300*    SET UP THE INTER APPLICATION COMMAREA,                       13030006
130400*    AND START THE NAVIGATOR.                                     13040006
130500*                                                                 13050006
130600*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        13060006
130700******************************************************************13070006
130800                                                                  13080006
130900     PERFORM F400-SETUP-INTER-APPL.                               13090006
131000     PERFORM DP015-1000-START-NAVIGATOR.                          13100006
131100 EJECT                                                            13110006
131200 E400-DISPLAY-TOP-OF-LIST.                                        13120006
131300                                                                  13130006
131400******************************************************************13140006
131500*    IF THE USER HITS THE 1ST PAGE KEY, COMPUTE THE TOP ITEM      13150006
131600*    NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM           13160006
131700*    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS  13170006
131800*    TO BE READ.                                                  13180006
131900*                                                                 13190006
132000*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        13200006
132100******************************************************************13210006
132200                                                                  13220006
132300     IF  ASC-NUMBER-OF-ITEMS-READ > +0                            13230006
132400         MOVE +1 TO PV-TOP-ITEM                                   13240006
132500                                                                  13250006
132600         PERFORM F500-BROWSE                                      13260006
132700     ELSE                                                         13270006
132800         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13280006
132900                                                                  13290006
133000         PERFORM G100-DISPLAY-PANEL                               13300006
133100     END-IF.                                                      13310006
133200 EJECT                                                            13320006
133300 E500-BROWSE-BACKWARD.                                            13330006
133400                                                                  13340006
133500******************************************************************13350006
133600*    IF THE USER HITS THE PAGE BACKARD KEY, COMPUTE THE TOP       13360006
133700*    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM      13370006
133800*    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS  13380006
133900*    TO BE READ.                                                  13390006
134000*                                                                 13400006
134100*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        13410006
134200******************************************************************13420006
134300                                                                  13430006
134400     IF  ASC-NUMBER-OF-ITEMS-READ > +0                            13440006
134500         COMPUTE PV-TOP-ITEM =                                    13450006
134600             ASC-ITEM-AT-TOP-OF-PANEL - PC-ITEMS-PER-PANEL        13460006
134700                                                                  13470006
134800         PERFORM F500-BROWSE                                      13480006
134900     ELSE                                                         13490006
135000         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13500006
135100                                                                  13510006
135200         PERFORM G100-DISPLAY-PANEL                               13520006
135300     END-IF.                                                      13530006
135400 EJECT                                                            13540006
135500 E600-BROWSE-FORWARD.                                             13550006
135600                                                                  13560006
135700******************************************************************13570006
135800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP       13580006
135900*    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM      13590006
136000*    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS  13600006
136100*    TO BE READ.                                                  13610006
136200*                                                                 13620006
136300*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        13630006
136400******************************************************************13640006
136500                                                                  13650006
136600     IF  ASC-NUMBER-OF-ITEMS-READ > +0                            13660006
136700         COMPUTE PV-TOP-ITEM =                                    13670006
136800             ASC-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL        13680006
136900                                                                  13690006
137000         PERFORM F500-BROWSE                                      13700006
137100     ELSE                                                         13710006
137200         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      13720006
137300                                                                  13730006
137400         PERFORM G100-DISPLAY-PANEL                               13740006
137500     END-IF.                                                      13750006
137600 EJECT                                                            13760006
137700 E700-SELECT-DESELECT-ALL.                                        13770006
137800                                                                  13780006
137900******************************************************************13790006
138000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION       13800006
138100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.          13810006
138200*    IF THE USER HITS THE SELECT ALL KEY, MARK THE SELECTION      13820006
138300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY NOT SELECTED.      13830006
138400*                                                                 13840006
138500*    PERFORMED BY D200-CHECK-FUNCTION-KEY.                        13850006
138600******************************************************************13860006
138700                                                                  13870006
138800     IF ASC-NUMBER-OF-ITEMS-READ > +0                             13880006
138900         MOVE +1 TO ASC-BLOCK-SUB                                 13890006
139000                                                                  13900006
139100         PERFORM F600-CLEAR-MARK-ALL-INDS                         13910006
139200             VARYING ASC-ITEM-SUB FROM 1 BY 1                     13920006
139300             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK              13930006
139400                                                                  13940006
139500         ADD +1 TO ASC-BLOCK-SUB                                  13950006
139600                                                                  13960006
139700         PERFORM F600-CLEAR-MARK-ALL-INDS                         13970006
139800             VARYING ASC-ITEM-SUB FROM 1 BY 1                     13980006
139900             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK              13990006
140000                                                                  14000006
140100         MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER    14010006
140200                                                                  14020006
140300******************************************************************14030006
140400*    CALCULATE THE BLOCK NUMBER OF THE FIRST BLOCK IN WORKING     14040006
140500*    STORAGE.  IF THIS BLOCK NUMBER IS NOT = 1, WE KNOW THAT      14050006
140600*    THERE ARE BLOCKS WITH SMALLER BLOCK NUMBERS SITTING OUT      14060006
140700*    IN TEMPORARY STORAGE THAT NEED TO BE RETRIEVED.              14070006
140800*                                                                 14080006
140900*    IF THE BLOCK NUMBER DOES = 1, BUT THE HIGHEST BLOCK NUMBER   14090006
141000*    WRITTEN TO TEMPORARY STORAGE IS GREATER THAN THE MAXIMUM     14100006
141100*    NUMBER OF BLOCKS IN WORKING STORAGE, WE KNOW THAT            14110006
141200*    THERE ARE BLOCKS WITH LARGER BLOCK NUMBERS SITTING OUT       14120006
141300*    IN TEMPORARY STORAGE THAT NEED TO BE RETRIEVED.              14130006
141400******************************************************************14140006
141500                                                                  14150006
141600         COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                        14160006
141700             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK) 14170006
141800                                                                  14180006
141900         IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                 14190006
142000            (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)  14200006
142100             MOVE +1 TO ASC-BLOCK-SUB                             14210006
142200                                                                  14220006
142300             PERFORM Z150-WRITE-TEMP-STORAGE                      14230006
142400                                                                  14240006
142500             MOVE +1 TO PV-BLOCK-NUMBER                           14250006
142600                                                                  14260006
142700             COMPUTE PV-PREV-BLOCK-IN-ARRAY =                     14270006
142800                 PV-FIRST-BLOCK-IN-ARRAY - 1                      14280006
142900                                                                  14290006
143000             PERFORM                                              14300006
143100                 UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY   14310006
143200                                                                  14320006
143300                 PERFORM Z100-READ-TEMP-STORAGE                   14330006
143400                                                                  14340006
143500                 PERFORM F600-CLEAR-MARK-ALL-INDS                 14350006
143600                     VARYING ASC-ITEM-SUB FROM 1 BY 1             14360006
143700                     UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK      14370006
143800                                                                  14380006
143900                 PERFORM Z150-WRITE-TEMP-STORAGE                  14390006
144000                                                                  14400006
144100                 ADD +1 TO PV-BLOCK-NUMBER                        14410006
144200                                                                  14420006
144300             END-PERFORM                                          14430006
144400                                                                  14440006
144500             COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                     14450006
144600                 PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY 14460006
144700                                                                  14470006
144800             PERFORM                                              14480006
144900                 UNTIL PV-NEXT-BLOCK-IN-ARRAY >                   14490006
145000                       ASC-HIGHEST-BLOCK-WRITTEN                  14500006
145100                                                                  14510006
145200                 MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER   14520006
145300                                                                  14530006
145400                 PERFORM Z100-READ-TEMP-STORAGE                   14540006
145500                                                                  14550006
145600                 PERFORM F600-CLEAR-MARK-ALL-INDS                 14560006
145700                     VARYING ASC-ITEM-SUB FROM 1 BY 1             14570006
145800                     UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK      14580006
145900                                                                  14590006
146000                 PERFORM Z150-WRITE-TEMP-STORAGE                  14600006
146100                                                                  14610006
146200                 ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                 14620006
146300                                                                  14630006
146400             END-PERFORM                                          14640006
146500                                                                  14650006
146600             MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      14660006
146700                                                                  14670006
146800             PERFORM Z100-READ-TEMP-STORAGE                       14680006
146900         END-IF                                                   14690006
147000                                                                  14700006
147100     END-IF.                                                      14710006
147200                                                                  14720006
147300     IF DP020-FK-DESELECT(DP020-SRC-AID)                          14730006
147400         MOVE +0 TO ASC-NUMBER-OF-SELECTED-ITEMS                  14740006
147500     END-IF.                                                      14750006
147600                                                                  14760006
147700     MOVE +0 TO ASC-START-OF-SELECTED-RANGE.                      14770006
147800     MOVE +0 TO ASC-END-OF-SELECTED-RANGE.                        14780006
147900                                                                  14790006
148000     SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                         14800006
148100                                                                  14810006
148200     PERFORM G100-DISPLAY-PANEL.                                  14820006
148300 EJECT                                                            14830006
148400 E800-CHECK-FOR-JUMP-BROWSE.                                      14840006
148500                                                                  14850006
148600******************************************************************14860006
148700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO     14870006
148800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.    14880006
148900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST   14890006
149000*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.       14900006
149100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT      14910006
149200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.           14920006
149300*                                                                 14930006
149400*    PERFORMED BY D300-CHECK-FUNCTION-KEY.                        14940006
149500******************************************************************14950006
149600                                                                  14960006
149700     SET PS-VALID-BEG-ITEM TO TRUE.                               14970006
149800                                                                  14980006
149900     IF (ABEGITMA                   = PC-ERASE-EOF) OR            14990006
150000        (ABEGITMI                   = SPACES      ) OR            15000006
150100        (ASC-NUMBER-OF-ITEMS-READ = +0)                           15010006
150200         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      15020006
150300         MOVE -1         TO ANAVCMDL                              15030006
150400                                                                  15040006
150500         IF  ASC-NUMBER-OF-ITEMS-READ = +0                        15050006
150600             MOVE ZERO TO PV-DISPLAY-NUMBER1                      15060006
150700             MOVE PV-DISPLAY-NUMBER1 TO ABEGITMI                  15070006
150800             MOVE PC-TSYMSG-00050        TO DP020-MSG-NUMBER      15080006
150900             SET DP020-MSG-INFORMATIONAL TO TRUE                  15090006
151000             SET PS-INFORMATIONAL        TO TRUE                  15100006
151100         END-IF                                                   15110006
151200                                                                  15120006
151300         PERFORM G100-DISPLAY-PANEL                               15130006
151400                                                                  15140006
151500     ELSE                                                         15150006
151600                                                                  15160006
151700         MOVE ABEGITMI TO DP010I-UNEDITED-FIELD                   15170006
151800         MOVE PC-FIELD-LENGTH TO DP010I-MAXIMUM-DIGITS            15180006
151900         MOVE +0              TO DP010I-MAXIMUM-DECIMALS          15190006
152000                                                                  15200006
152100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15210006
152200                                                                  15220006
152310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15231009
152320                         USING DP010I-NUMERIC-EDIT-AREA           15232009
152400                                                                  15240006
152500         IF NOT DP010I-ERROR-DETECTED                             15250006
152600             MOVE DP010I-NUMERIC-FIELD TO PV-DISPLAY-NUMBER       15260006
152700             MOVE PV-DISPLAY-NUMBER    TO ABEGITMO                15270006
152800             MOVE DP010I-NUMERIC-FIELD TO PV-BEGINNING-ITEM       15280006
152900                                                                  15290006
153000             IF (PV-BEGINNING-ITEM >  0)          AND             15300006
153100                (PV-BEGINNING-ITEM <  PC-MAX-ITEMS)               15310006
153200                 MOVE PV-BEGINNING-ITEM TO PV-TOP-ITEM            15320006
153300                                                                  15330006
153400                 COMPUTE PV-MAX-ITEMS-TO-BE-READ =                15340006
153500                     ((ASC-NUMBER-OF-ITEMS-READ +                 15350006
153600                       PC-MAX-ITEMS-TO-BE-READ)   -               15360006
153700                       PC-ITEMS-PER-PANEL)        + 1             15370006
153800                                                                  15380006
153900                 IF  PV-TOP-ITEM > PV-MAX-ITEMS-TO-BE-READ        15390006
154000                     MOVE PV-MAX-ITEMS-TO-BE-READ TO              15400006
154100                          PV-TOP-ITEM                             15410006
154200                     MOVE -1                      TO              15420006
154300                          ABEGITML                                15430006
154400                                                                  15440006
154500                     IF ASC-NO-ITEMS-LEFT-ON-DB                   15450006
154600                         MOVE PC-TSYMSG-00061      TO             15460006
154700                              DP020-MSG-NUMBER                    15470006
154800                     ELSE                                         15480006
154900                         MOVE PC-TSYMSG-00062      TO             15490006
155000                              DP020-MSG-NUMBER                    15500006
155100                     END-IF                                       15510006
155200                                                                  15520006
155300                     SET PS-CURSOR-POSITIONED    TO TRUE          15530006
155400                     SET DP020-MSG-INFORMATIONAL TO TRUE          15540006
155500                 END-IF                                           15550006
155600                                                                  15560006
155700                 PERFORM F500-BROWSE                              15570006
155800             ELSE                                                 15580006
155900                 MOVE PC-TSYMSG-00005       TO                    15590006
156000                      DP020-MSG-NUMBER                            15600006
156100                 MOVE -1                    TO                    15610006
156200                      ABEGITML                                    15620006
156300                 MOVE DP015-REVERSE         TO                    15630006
156400                      ABEGITMH                                    15640006
156500                 MOVE DP015-RED             TO                    15650006
156600                      ABEGITMC                                    15660006
156700                 MOVE DP015-UNP-ALP-BRT-MDT TO                    15670006
156800                      ABEGITMA                                    15680006
156900                                                                  15690006
157000                 SET PS-CURSOR-POSITIONED TO TRUE                 15700006
157100                 SET DP020-MSG-FATAL      TO TRUE                 15710006
157200                 SET PS-INVALID-BEG-ITEM  TO TRUE                 15720006
157300             END-IF                                               15730006
157400                                                                  15740006
157500         ELSE                                                     15750006
157600             MOVE PC-TSYMSG-00008       TO                        15760006
157700                  DP020-MSG-NUMBER                                15770006
157800             MOVE -1                    TO                        15780006
157900                  ABEGITML                                        15790006
158000             MOVE DP015-REVERSE         TO                        15800006
158100                  ABEGITMH                                        15810006
158200             MOVE DP015-RED             TO                        15820006
158300                  ABEGITMC                                        15830006
158400             MOVE DP015-UNP-ALP-BRT-MDT TO                        15840006
158500                  ABEGITMA                                        15850006
158600                                                                  15860006
158700             SET PS-CURSOR-POSITIONED TO TRUE                     15870006
158800             SET DP020-MSG-FATAL      TO TRUE                     15880006
158900             SET PS-INVALID-BEG-ITEM  TO TRUE                     15890006
159000         END-IF                                                   15900006
159100                                                                  15910006
159200     END-IF.                                                      15920006
159300                                                                  15930006
159400     IF PS-INVALID-BEG-ITEM                                       15940006
159500         SET PS-SAME-ITEMS-DISPLAYED TO TRUE                      15950006
159600                                                                  15960006
159700         PERFORM DP017-0000-GET-CURR-DATE-TIME                    15970006
159800         PERFORM I200-FORMAT-LIST-LINES                           15980006
159900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ATOTSELO            15990006
160000         PERFORM DP005-0000-FORMAT-MSG-LINES                      16000006
160100         PERFORM DP008-0000-WRITE-PANEL                           16010006
160200     END-IF.                                                      16020006
160300 EJECT                                                            16030006
160400 E950-FIND-FIRST-SELECTED.                                        16040006
160500                                                                  16050006
160600******************************************************************16060006
160700*    FIND THE FIRST DOCUMENT SELECTED ON THE LIST AND PASS THIS   16070006
160800*    DOCUMENT TO PEPHDR (APPROVAL HEADER).                        16080006
160900*                                                                 16090006
161000*    PERFORMED BY D200-CHECK-FUNCTION-KEY.                        16100006
161100******************************************************************16110006
161200                                                                  16120006
161300     IF PV-SELECTION-MADE(PS-SUB)                                 16130006
161400         SET PS-SELECTION-FOUND TO TRUE                           16140006
161500                                                                  16150006
161600         MOVE PV-SELECTED-PARM(PS-SUB) TO                         16160006
161700              PV-SELECTED-PARM-NUMBER                             16170006
161800     ELSE                                                         16180006
161900         ADD +1 TO PS-SUB                                         16190006
162000     END-IF.                                                      16200006
162100                                                                  16210006
162200     IF (PS-SUB > PC-ITEMS-PER-BLOCK) AND                         16220006
162300        (PS-NO-SELECTION-FOUND)                                   16230006
162400         MOVE +1 TO PS-SUB                                        16240006
162500                                                                  16250006
162600         ADD +1 TO PV-BLOCK-NUMBER                                16260006
162700                                                                  16270006
162800         PERFORM Z175-READ-TEMP-STORAGE                           16280006
162900     END-IF.                                                      16290006
163000 EJECT                                                            16300006
163100 F100-EDIT.                                                       16310006
163200                                                                  16320006
163300******************************************************************16330006
163400*    EDIT THE SELECTION ENTRIES.                                  16340006
163500*                                                                 16350006
163600*    1) VALID ENTRIES ARE 'S' 'B' OR 'E'.                         16360006
163700*    2) THERE CAN ONLY BE 1 BEGINNING AND 1 ENDING RANGE.         16370006
163800*                                                                 16380006
163900*    PERFORMED BY F100-EDIT-SELECTIONS.                           16390006
164000******************************************************************16400006
164100                                                                  16410006
164200     PERFORM K100-SET-SUBSCRIPTS.                                 16420006
164300                                                                  16430006
164400     IF NOT (ASC-NO-SELECT(ASC-BLOCK-SUB ASC-ITEM-SUB)) AND       16440006
164500        NOT (ASC-SELECT(ASC-BLOCK-SUB ASC-ITEM-SUB))              16450006
164600                                                                  16460006
164700******************************************************************16470006
164800*   IF THE CURRENT ENTRY IS A 'B', WE MUST MAKE SURE THAT THIS    16480006
164900*   IS THE ONLY 'B' ENTERED ON THE SCREEN.  TO VERIFY THIS, THE   16490006
165000*   CURRENT ITEM WE ARE POINTING TO SHOULD EQUAL THE START OF     16500006
165100*   SELECTED RANGE FIELD.  IF THEY ARE NOT EQUAL, AND THE START OF16510006
165200*   SELECTED RANGE FIELD DOES NOT EQUAL 0, WE KNOW THAT THIS FIELD16520006
165300*   CONTAINS THE LIST ITEM NUMBER THAT CURRENTLY CONTAINS A 'B'.  16530006
165400*   IF THE START OF SELECTED RANGE FIELD EQUALS 0, THAN THIS IS   16540006
165500*   THE FIRST 'B' ENTERED ON THE SCREEN, AND WE SET THIS FIELD    16550006
165600*   EQUAL TO THE CURRENT ITEM WE ARE POINTING TO.                 16560006
165700*                                                                 16570006
165800*   THE SAME TYPE OF LOGIC IS DONE FOR THE ENDING RANGE 'E'.      16580006
165900******************************************************************16590006
166000                                                                  16600006
166100         IF ASC-BEGIN(ASC-BLOCK-SUB ASC-ITEM-SUB)                 16610006
166200                                                                  16620006
166300             IF ASC-START-OF-SELECTED-RANGE NOT = PV-ITEM-IN-USE  16630006
166400                                                                  16640006
166500                 IF ASC-START-OF-SELECTED-RANGE = +0              16650006
166600                     MOVE PV-ITEM-IN-USE TO                       16660006
166700                          ASC-START-OF-SELECTED-RANGE             16670006
166800                 ELSE                                             16680006
166900                                                                  16690006
167000                     IF PS-VALID-SELECTIONS                       16700006
167100                         MOVE PC-TSYMSG-00054 TO DP020-MSG-NUMBER 16710006
167200                                                                  16720006
167300                         IF NOT DP020-NEXT-ACT-ERROR              16730006
167400                             MOVE -1 TO PEKM145I-ASELL(PS-SUB)    16740006
167500                         END-IF                                   16750006
167600                                                                  16760006
167700                     END-IF                                       16770006
167800                                                                  16780006
167900                     SET DP020-MSG-FATAL       TO TRUE            16790006
168000                     SET PS-INVALID-SELECTIONS TO TRUE            16800006
168100                     SET PS-CURSOR-POSITIONED  TO TRUE            16810006
168200                                                                  16820006
168300                 END-IF                                           16830006
168400                                                                  16840006
168500             END-IF                                               16850006
168600                                                                  16860006
168700         ELSE                                                     16870006
168800                                                                  16880006
168900             IF ASC-END(ASC-BLOCK-SUB ASC-ITEM-SUB)               16890006
169000                                                                  16900006
169100                 IF ASC-END-OF-SELECTED-RANGE NOT =               16910006
169200                    PV-ITEM-IN-USE                                16920006
169300                                                                  16930006
169400                     IF ASC-END-OF-SELECTED-RANGE = +0            16940006
169500                         MOVE PV-ITEM-IN-USE TO                   16950006
169600                              ASC-END-OF-SELECTED-RANGE           16960006
169700                     ELSE                                         16970006
169800                                                                  16980006
169900                         IF PS-VALID-SELECTIONS                   16990006
170000                             MOVE PC-TSYMSG-00055 TO              17000006
170100                                  DP020-MSG-NUMBER                17010006
170200                                                                  17020006
170300                             IF NOT DP020-NEXT-ACT-ERROR          17030006
170400                                 MOVE -1 TO PEKM145I-ASELL(PS-SUB)17040006
170500                             END-IF                               17050006
170600                                                                  17060006
170700                         END-IF                                   17070006
170800                                                                  17080006
170900                         SET PS-INVALID-SELECTIONS TO TRUE        17090006
171000                         SET PS-CURSOR-POSITIONED  TO TRUE        17100006
171100                         SET DP020-MSG-FATAL       TO TRUE        17110006
171200                                                                  17120006
171300                     END-IF                                       17130006
171400                                                                  17140006
171500                 END-IF                                           17150006
171600                                                                  17160006
171700             ELSE                                                 17170006
171800                                                                  17180006
171900                 IF PS-VALID-SELECTIONS                           17190006
172000                     MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER     17200006
172100                                                                  17210006
172200                     IF NOT DP020-NEXT-ACT-ERROR                  17220006
172300                         MOVE -1 TO PEKM145I-ASELL(PS-SUB)        17230006
172400                     END-IF                                       17240006
172500                                                                  17250006
172600                 END-IF                                           17260006
172700                                                                  17270006
172800                 SET PS-INVALID-SELECTIONS TO TRUE                17280006
172900                 SET PS-CURSOR-POSITIONED  TO TRUE                17290006
173000                 SET DP020-MSG-FATAL       TO TRUE                17300006
173100                                                                  17310006
173200                 MOVE DP015-RED     TO PEKM145O-ASELC(PS-SUB)     17320006
173300                 MOVE DP015-REVERSE TO PEKM145O-ASELH(PS-SUB)     17330006
173400             END-IF                                               17340006
173500                                                                  17350006
173600         END-IF                                                   17360006
173700                                                                  17370006
173800     END-IF.                                                      17380006
173900                                                                  17390006
174000     ADD +1 TO PV-ITEM-IN-USE.                                    17400006
174100     ADD +1 TO PS-SUB.                                            17410006
174200 EJECT                                                            17420006
174300 F200-MARK-RANGE-AS-SELECTED.                                     17430006
174400                                                                  17440006
174500******************************************************************17450006
174600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE     17460006
174700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS     17470006
174800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.              17480006
174900*                                                                 17490006
175000*    PERFORMED BY F100-EDIT-SELECTIONS.                           17500006
175100******************************************************************17510006
175200                                                                  17520006
175300     MOVE +1 TO ASC-BLOCK-SUB.                                    17530006
175400                                                                  17540006
175500     PERFORM G200-MARK-SELECTED-INDS                              17550006
175600         VARYING ASC-ITEM-SUB FROM 1 BY 1                         17560006
175700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK.                 17570006
175800                                                                  17580006
175900     ADD +1 TO ASC-BLOCK-SUB.                                     17590006
176000                                                                  17600006
176100     PERFORM G200-MARK-SELECTED-INDS                              17610006
176200         VARYING ASC-ITEM-SUB FROM 1 BY 1                         17620006
176300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK.                 17630006
176400                                                                  17640006
176500******************************************************************17650006
176600*    AFTER MARKING THE ENTRIES IN THE BLOCKS IN WORKING STORAGE,  17660006
176700*    WE MUST SEE IF ANY OF THE ENTRIES IN THE BLOCKS IN TEMPORARY 17670006
176800*    STORAGE SHOULD BE MARKED.  TO DETERMINE THIS, WE CALCULATE   17680006
176900*    THE BLOCK NUMBERS OF THE BLOCKS IN WORKING STORAGE AND THE   17690006
177000*    BLOCK NUMBERS OF THE BLOCKS IN TEMPORARY STORAGE THAT FALL   17700006
177100*    WITHIN THE STARTING AND ENDING RANGE SPECIFED BY THE USER.   17710006
177200*    IF THE BLOCK NUMBERS OF THE BLOCKS IN TEMPORARY STORAGE      17720006
177300*    ARE LESS THAN OR GREATER THAN THE BLOCK NUMBERS OF THE       17730006
177400*    BLOCKS IN WORKING STORAGE, WE MUST READ THOSE BLOCKS FROM    17740006
177500*    TEMPORARY STORAGE AND MARK THE APPROPRIATE ENTRIES AS BEING  17750006
177600*    SELECTED.                                                    17760006
177700******************************************************************17770006
177800                                                                  17780006
177900     MOVE ASC-LIST-ITEM-NUMBER(1 1)     TO                        17790006
178000          PV-LIST-ITEM-NUMBER.                                    17800006
178100                                                                  17810006
178200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17820006
178300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17830006
178400               PC-ITEMS-PER-BLOCK).                               17840006
178500                                                                  17850006
178600     MOVE ASC-START-OF-SELECTED-RANGE TO                          17860006
178700          PV-START-OF-SELECTED-RANGE.                             17870006
178800                                                                  17880006
178900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17890006
179000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17900006
179100               PC-ITEMS-PER-BLOCK).                               17910006
179200                                                                  17920006
179300     MOVE ASC-END-OF-SELECTED-RANGE     TO                        17930006
179400          PV-END-OF-SELECTED-RANGE.                               17940006
179500                                                                  17950006
179600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17960006
179700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17970006
179800               PC-ITEMS-PER-BLOCK).                               17980006
179900                                                                  17990006
180000     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             18000006
180100         PV-FIRST-BLOCK-IN-ARRAY + 1.                             18010006
180200                                                                  18020006
180300     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18030006
180400        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18040006
180500         MOVE +1 TO ASC-BLOCK-SUB                                 18050006
180600                                                                  18060006
180700         PERFORM Z150-WRITE-TEMP-STORAGE                          18070006
180800                                                                  18080006
180900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18090006
181000             PV-FIRST-BLOCK-IN-ARRAY - 1                          18100006
181100                                                                  18110006
181200         PERFORM                                                  18120006
181300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      18130006
181400                   PV-PREV-BLOCK-IN-ARRAY                         18140006
181500                                                                  18150006
181600             MOVE PV-FIRST-BLOCK-IN-RANGE TO PV-BLOCK-NUMBER      18160006
181700                                                                  18170006
181800             PERFORM Z100-READ-TEMP-STORAGE                       18180006
181900                                                                  18190006
182000             PERFORM G200-MARK-SELECTED-INDS                      18200006
182100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18210006
182200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK          18220006
182300                                                                  18230006
182400             PERFORM Z150-WRITE-TEMP-STORAGE                      18240006
182500                                                                  18250006
182600             ADD +1 TO PV-FIRST-BLOCK-IN-RANGE                    18260006
182700                                                                  18270006
182800         END-PERFORM                                              18280006
182900                                                                  18290006
183000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18300006
183100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18310006
183200                                                                  18320006
183300         PERFORM                                                  18330006
183400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18340006
183500                   PV-LAST-BLOCK-IN-RANGE                         18350006
183600                                                                  18360006
183700             MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER       18370006
183800                                                                  18380006
183900             PERFORM Z100-READ-TEMP-STORAGE                       18390006
184000                                                                  18400006
184100             PERFORM G200-MARK-SELECTED-INDS                      18410006
184200                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18420006
184300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK          18430006
184400                                                                  18440006
184500             PERFORM Z150-WRITE-TEMP-STORAGE                      18450006
184600                                                                  18460006
184700             ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                     18470006
184800                                                                  18480006
184900         END-PERFORM                                              18490006
185000                                                                  18500006
185100         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          18510006
185200                                                                  18520006
185300         PERFORM Z100-READ-TEMP-STORAGE                           18530006
185400     END-IF.                                                      18540006
185500                                                                  18550006
185600     MOVE +0 TO ASC-START-OF-SELECTED-RANGE.                      18560006
185700     MOVE +0 TO ASC-END-OF-SELECTED-RANGE.                        18570006
185800 EJECT                                                            18580006
185900 F300-CHECK-SELECTIONS.                                           18590006
186000                                                                  18600006
186100******************************************************************18610006
186200*    CHECK EACH ENTRY TO DETERMINE IF THE SELECTION CRITERIA IN   18620006
186300*    THE MAP DIFFERS FROM THAT IN THE ARRAY.  IF THEY DO DIFFER,  18630006
186400*    AND THE ARRAY ENTRY SHOWS THAT THE ITEM WAS PREVIOUSLY       18640006
186500*    SELECTED, SUBTRACT 1 FROM THE SELECTED COUNTER.  IF THEY DO  18650006
186600*    DIFFER, AND THE ARRAY ENTRY SHOWS THAT THIS ITEM WAS MARKED  18660006
186700*    AS EITHER THE BEGINNING OR ENDING SELECTION POINT, ZERO OUT  18670006
186800*    THE STARTING RANGE AND/OR ENDING RANGE.  IF THE ENTRY ON     18680006
186900*    THE MAP SHOWS THAT THIS ITEM WAS SELECTED, ADD 1 TO THE      18690006
187000*    SELECTED COUNTER.                                            18700006
187100*                                                                 18710006
187200*    PERFORMED BY E200-MOVE-SELECTS-TO-COMMAREA.                  18720006
187300******************************************************************18730006
187400                                                                  18740006
187500     IF (PV-ITEM-IN-USE < ASC-NUMBER-OF-ITEMS-READ) OR            18750006
187600        (PV-ITEM-IN-USE = ASC-NUMBER-OF-ITEMS-READ)               18760006
187700                                                                  18770006
187800         PERFORM K100-SET-SUBSCRIPTS                              18780006
187900                                                                  18790006
188000******************************************************************18800006
188100*    IF THE ENTRY IN THE BLOCK DOES NOT EQUAL THE ENTRY ON THE    18810006
188200*    MAP, SET THE SWITCH SAYING THAT THIS BLOCK HAS BEEN MODIFIED.18820006
188300*                                                                 18830006
188400*    IF THE ENTRY IN THE BLOCK EQUALS 'S', SUBTRACT 1 FROM THE    18840006
188500*    NUMBER OF SELECTED ITEMS.                                    18850006
188600*                                                                 18860006
188700*    IF THE ENTRY IN THE BLOCK EQUALS 'B' AND THIS ENTRY WAS EQUAL18870006
188800*    TO THE START OF SELECTED RANGE, MOVE 0 TO THE START OF       18880006
188900*    SELECTED RANGE.  IF THERE WAS MORE THAN ONE 'B' ON THE       18890006
189000*    SCREEN (ERROR), THE START OF SELECTED RANGE WILL THAN BE     18900006
189100*    RESET LATER TO POINT TO ONE OF THE OTHER 'B' ENTRIES.        18910006
189200*                                                                 18920006
189300*    THE SAME LOGIC APPLIES TO AN 'E' ENTRY.                      18930006
189400*                                                                 18940006
189500******************************************************************18950006
189600                                                                  18960006
189700         IF ASC-SELECTED-SW(ASC-BLOCK-SUB                         18970006
189800                              ASC-ITEM-SUB) NOT =                 18980006
189900            PEKM145I-ASELI(PS-SUB)                                18990006
190000             SET ASC-BLOCK-MODIFIED(ASC-BLOCK-SUB) TO TRUE        19000006
190100                                                                  19010006
190200             IF ASC-SELECT(ASC-BLOCK-SUB ASC-ITEM-SUB)            19020006
190300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19030006
190400             ELSE                                                 19040006
190500                                                                  19050006
190600                 IF ASC-BEGIN(ASC-BLOCK-SUB ASC-ITEM-SUB)         19060006
190700                                                                  19070006
190800                     IF ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB        19080006
190900                                               ASC-ITEM-SUB) =    19090006
191000                        ASC-START-OF-SELECTED-RANGE               19100006
191100                                                                  19110006
191200                         MOVE +0 TO ASC-START-OF-SELECTED-RANGE   19120006
191300                     END-IF                                       19130006
191400                                                                  19140006
191500                 ELSE                                             19150006
191600                                                                  19160006
191700                     IF ASC-END(ASC-BLOCK-SUB ASC-ITEM-SUB)       19170006
191800                                                                  19180006
191900                         IF ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB    19190006
192000                                                   ASC-ITEM-SUB)  19200006
192100                         =  ASC-END-OF-SELECTED-RANGE             19210006
192200                                                                  19220006
192300                             MOVE +0 TO                           19230006
192400                                  ASC-END-OF-SELECTED-RANGE       19240006
192500                         END-IF                                   19250006
192600                                                                  19260006
192700                     END-IF                                       19270006
192800                                                                  19280006
192900                 END-IF                                           19290006
193000                                                                  19300006
193100             END-IF                                               19310006
193200                                                                  19320006
193300******************************************************************19330006
193400*    IF THE ENTRY IN THE MAP EQUALS 'S', ADD 1 TO THE NUMBER OF   19340006
193500*    SELECTED ITEMS.                                              19350006
193600*                                                                 19360006
193700*    IF THE ENTRY IN THE MAP EQUALS SPACES OR ERASE EOF, MOVE     19370006
193800*    SPACES TO THE ENTRY IN THE BLOCK.                            19380006
193900*                                                                 19390006
194000*    IF THE ENTRY IN THE MAP DOES NOT EQUAL SPACES OR ERASE EOF,  19400006
194100*    MOVE WHATEVER WAS ENTERED ON THE MAP TO THE ENTRY IN THE     19410006
194200*    BLOCK.                                                       19420006
194300*                                                                 19430006
194400******************************************************************19440006
194500                                                                  19450006
194600             IF PEKM145I-ASELI(PS-SUB) = PC-SELECTED              19460006
194700                 ADD +1 TO ASC-NUMBER-OF-SELECTED-ITEMS           19470006
194800             END-IF                                               19480006
194900                                                                  19490006
195000             IF (PEKM145I-ASELA(PS-SUB) = PC-ERASE-EOF) OR        19500006
195100                (PEKM145I-ASELI(PS-SUB) = SPACES)                 19510006
195200                 MOVE SPACES               TO                     19520006
195300                      ASC-SELECTED-SW(ASC-BLOCK-SUB               19530006
195400                                        ASC-ITEM-SUB)             19540006
195500             ELSE                                                 19550006
195600                 MOVE PEKM145I-ASELI(PS-SUB) TO                   19560006
195700                      ASC-SELECTED-SW(ASC-BLOCK-SUB               19570006
195800                                        ASC-ITEM-SUB)             19580006
195900             END-IF                                               19590006
196000                                                                  19600006
196100         END-IF                                                   19610006
196200                                                                  19620006
196300     END-IF.                                                      19630006
196400                                                                  19640006
196500     ADD +1 TO PV-ITEM-IN-USE.                                    19650006
196600     ADD +1 TO PS-SUB.                                            19660006
196700 EJECT                                                            19670006
196800 F400-SETUP-INTER-APPL.                                           19680006
196900                                                                  19690006
197000******************************************************************19700006
197100*    SETUP THE INTERAPPL COMMAREA                                 19710006
197200******************************************************************19720006
197300                                                                  19730006
197400     MOVE LOW-VALUES TO INTER-APPL-COMM-AREA.                     19740006
197500     MOVE ASC-TEMP-QUEUE-NAME                                     19750006
197600          TO PE022-TEMP-QUEUE-NAME.                               19760006
197700     MOVE PV-SELECTED-PARM-NUMBER                                 19770006
197800          TO PE022-PARM-NBR.                                      19780006
197900     MOVE 'Q145' TO PE022-INTER-APPL-FORMAT-CODE.                 19790006
198000 EJECT                                                            19800006
198100 F500-BROWSE.                                                     19810006
198200                                                                  19820006
198300******************************************************************19830006
198400*    CALCULATE THE NEW TOP AND BOTTOM ITEM NUMBERS BASED ON WHERE 19840006
198500*    THE USER SPECIFIED TO GO ON THE LIST AND DETERMINE WHERE     19850006
198600*    THESE ITEMS CAN BE FOUND (I.E. ARRAY, TEMPORARY STORAGE).    19860006
198700*                                                                 19870006
198800*    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                       19880006
198900*    PERFORMED BY E500-BROWSE-BACKWARD.                           19890006
199000*    PERFORMED BY E600-BROWSE-FORWARD.                            19900006
199100*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     19910006
199200******************************************************************19920006
199300                                                                  19930006
199400     IF PV-TOP-ITEM < +1                                          19940006
199500         MOVE +1 TO PV-TOP-ITEM                                   19950006
199600                                                                  19960006
199700         IF  PS-CURSOR-NOT-POSITIONED                             19970006
199800             MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER             19980006
199900                                                                  19990006
200000             SET DP020-MSG-INFORMATIONAL TO TRUE                  20000006
200100             SET PS-INFORMATIONAL        TO TRUE                  20010006
200200             SET PS-CURSOR-POSITIONED    TO TRUE                  20020006
200300         END-IF                                                   20030006
200400                                                                  20040006
200500     END-IF.                                                      20050006
200600                                                                  20060006
200700     IF ASC-NO-ITEMS-LEFT-ON-DB                                   20070006
200800                                                                  20080006
200900         IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ               20090006
201000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         20100006
201100                                                                  20110006
201200             IF  PS-CURSOR-NOT-POSITIONED                         20120006
201300                 MOVE -1 TO ANAVCMDL                              20130006
201400                                                                  20140006
201500                 SET DP020-MSG-INFORMATIONAL TO TRUE              20150006
201600                 SET PS-CURSOR-POSITIONED    TO TRUE              20160006
201700                                                                  20170006
201800                 IF DP020-FK-NEXT-PAGE(DP020-SRC-AID)             20180006
201900                     MOVE PC-TSYMSG-00070 TO                      20190006
202000                          DP020-MSG-NUMBER                        20200006
202100                                                                  20210006
202200                     SET PS-INFORMATIONAL TO TRUE                 20220006
202300                 ELSE                                             20230006
202400                     MOVE PC-TSYMSG-00061 TO                      20240006
202500                          DP020-MSG-NUMBER                        20250006
202600                 END-IF                                           20260006
202700                                                                  20270006
202800             END-IF                                               20280006
202900                                                                  20290006
203000         END-IF                                                   20300006
203100                                                                  20310006
203200     END-IF.                                                      20320006
203300                                                                  20330006
203400     COMPUTE PV-BOTTOM-ITEM =                                     20340006
203500         (PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1.                  20350006
203600                                                                  20360006
203700     IF ASC-NO-ITEMS-LEFT-ON-DB                                   20370006
203800                                                                  20380006
203900         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             20390006
204000             MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-BOTTOM-ITEM      20400006
204100                                                                  20410006
204200             IF PS-CURSOR-NOT-POSITIONED                          20420006
204300                                                                  20430006
204400                 IF PV-TOP-ITEM NOT = +1                          20440006
204500                     MOVE PC-TSYMSG-00070       TO                20450006
204600                          DP020-MSG-NUMBER                        20460006
204700                                                                  20470006
204800                     SET PS-INFORMATIONAL       TO TRUE           20480006
204900                     SET DP020-MSG-INFORMATIONAL TO TRUE          20490006
205000                     SET PS-CURSOR-POSITIONED    TO TRUE          20500006
205100                 END-IF                                           20510006
205200                                                                  20520006
205300             END-IF                                               20530006
205400                                                                  20540006
205500         END-IF                                                   20550006
205600                                                                  20560006
205700     END-IF.                                                      20570006
205800                                                                  20580006
205900     PERFORM G300-DETERMINE-WHAT-IS-WHERE.                        20590006
206000                                                                  20600006
206100     IF  PS-TOP-ITEM-IN-ARRAY                                     20610006
206200                                                                  20620006
206300         IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                          20630006
206400                                                                  20640006
206500             IF  PS-BOTTOM-ITEM-IN-TEMP                           20650006
206600                 PERFORM G500-SCROLL-FORWARD                      20660006
206700             ELSE                                                 20670006
206800                                                                  20680006
206900                 IF  PS-LAST-BLOCK-NOT-IN-ARRAY                   20690006
207000                     PERFORM G500-SCROLL-FORWARD                  20700006
207100                 END-IF                                           20710006
207200                                                                  20720006
207300                 PERFORM G400-READ-ITEMS-INTO-ARRAY               20730006
207400                                                                  20740006
207500             END-IF                                               20750006
207600                                                                  20760006
207700         END-IF                                                   20770006
207800                                                                  20780006
207900     ELSE                                                         20790006
208000                                                                  20800006
208100         IF  PS-BOTTOM-ITEM-IN-ARRAY                              20810006
208200             PERFORM G600-SCROLL-BACKWARD                         20820006
208300         ELSE                                                     20830006
208400                                                                  20840006
208500             IF  PS-TOP-ITEM-IN-TEMP                              20850006
208600                 PERFORM G700-GET-TOP-ITEMS-BLOCK                 20860006
208700                 PERFORM G300-DETERMINE-WHAT-IS-WHERE             20870006
208800                                                                  20880006
208900                 IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                  20890006
209000                     PERFORM G400-READ-ITEMS-INTO-ARRAY           20900006
209100                 END-IF                                           20910006
209200                                                                  20920006
209300             ELSE                                                 20930006
209400                                                                  20940006
209500                 IF  PS-LAST-BLOCK-NOT-IN-ARRAY                   20950006
209600                     PERFORM G800-GET-LAST-BLOCK-IN-TEMP          20960006
209700                 END-IF                                           20970006
209800                                                                  20980006
209900                 PERFORM G400-READ-ITEMS-INTO-ARRAY               20990006
210000             END-IF                                               21000006
210100                                                                  21010006
210200         END-IF                                                   21020006
210300                                                                  21030006
210400     END-IF.                                                      21040006
210500                                                                  21050006
210600     IF  PV-TOP-ITEM = ASC-ITEM-AT-TOP-OF-PANEL                   21060006
210700         SET PS-SAME-ITEMS-DISPLAYED      TO TRUE                 21070006
210800     ELSE                                                         21080006
210900         SET PS-DIFFERENT-ITEMS-DISPLAYED TO TRUE                 21090006
211000                                                                  21100006
211100         MOVE PV-TOP-ITEM TO ASC-ITEM-AT-TOP-OF-PANEL             21110006
211200     END-IF.                                                      21120006
211300                                                                  21130006
211400     PERFORM G100-DISPLAY-PANEL.                                  21140006
211500 EJECT                                                            21150006
211600 F600-CLEAR-MARK-ALL-INDS.                                        21160006
211700                                                                  21170006
211800******************************************************************21180006
211900*    MARK EACH ITEM AS BEING NOT SELECTED OR SELECTED BASED ON    21190006
212000*    WHICH FUNCTION KEY THAT WAS HIT (DESELECT ALL OR SELECT ALL) 21200006
212100*                                                                 21210006
212200*    PERFORMED BY E700-SELECT-DESELECT-ALL.                       21220006
212300******************************************************************21230006
212400                                                                  21240006
212500     IF ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                        21250006
212600                               ASC-ITEM-SUB) NOT = +0             21260006
212700                                                                  21270006
212800         IF DP020-FK-DESELECT(DP020-SRC-AID)                      21280006
212900                                                                  21290006
213000             IF NOT ASC-NO-SELECT(ASC-BLOCK-SUB                   21300006
213100                                    ASC-ITEM-SUB)                 21310006
213200                                                                  21320006
213300                 SET ASC-NO-SELECT(ASC-BLOCK-SUB                  21330006
213400                                     ASC-ITEM-SUB) TO TRUE        21340006
213500                                                                  21350006
213600                 SET ASC-BLOCK-MODIFIED(ASC-BLOCK-SUB) TO TRUE    21360006
213700             END-IF                                               21370006
213800                                                                  21380006
213900         ELSE                                                     21390006
214000                                                                  21400006
214100             IF NOT ASC-SELECT(ASC-BLOCK-SUB                      21410006
214200                                 ASC-ITEM-SUB)                    21420006
214300                                                                  21430006
214400                 SET ASC-SELECT(ASC-BLOCK-SUB                     21440006
214500                                  ASC-ITEM-SUB) TO TRUE           21450006
214600                                                                  21460006
214700                 ADD +1 TO ASC-NUMBER-OF-SELECTED-ITEMS           21470006
214800                                                                  21480006
214900                 SET ASC-BLOCK-MODIFIED(ASC-BLOCK-SUB) TO TRUE    21490006
215000             END-IF                                               21500006
215100                                                                  21510006
215200         END-IF                                                   21520006
215300                                                                  21530006
215400     END-IF.                                                      21540006
215500 EJECT                                                            21550006
215600 G100-DISPLAY-PANEL.                                              21560006
215700                                                                  21570006
215800******************************************************************21580006
215900*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       21590006
216000*                                                                 21600006
216100*    PERFORMED BY B100-CONTROL-PROCESSING.                        21610006
216200*    PERFORMED BY C300-PROCESS-PANEL.                             21620006
216300*    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                   21630006
216400*    PERFORMED BY D100-SETUP-INIT-PANEL.                          21640006
216500*    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                       21650006
216600*    PERFORMED BY E500-BROWSE-BACKWARD.                           21660006
216700*    PERFORMED BY E600-BROWSE-FORWARD.                            21670006
216800*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     21680006
216900*    PERFORMED BY F500-BROWSE.                                    21690006
217000******************************************************************21700006
217100                                                                  21710006
217200     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       21720006
217300                                                                  21730006
217400     IF  PS-SEND-MAP-N-DATA-FRSET                                 21740006
217500         PERFORM DP002-0000-FORMAT-TITLE-LINES                    21750006
217600     END-IF.                                                      21760006
217700                                                                  21770006
217800     PERFORM H200-FORMAT-PANEL-BODY.                              21780006
217900                                                                  21790006
218000     PERFORM DP005-0000-FORMAT-MSG-LINES.                         21800006
218100                                                                  21810006
218200     IF  PS-SEND-MAP-N-DATA-FRSET                                 21820006
218300         PERFORM DP009-0000-LOAD-FK-LINES                         21830006
218400     END-IF.                                                      21840006
218500                                                                  21850006
218600     PERFORM DP008-0000-WRITE-PANEL.                              21860006
218700 EJECT                                                            21870006
218800 G200-MARK-SELECTED-INDS.                                         21880006
218900                                                                  21890006
219000******************************************************************21900006
219100*    MARK EACH ITEM THAT FALLS WITHIN THE BEGINNING AND ENDING    21910006
219200*    RANGE AS BEING SELECTED.                                     21920006
219300*                                                                 21930006
219400*    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                    21940006
219500******************************************************************21950006
219600                                                                  21960006
219700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                       21970006
219800                                ASC-ITEM-SUB) >                   21980006
219900         ASC-START-OF-SELECTED-RANGE) OR                          21990006
220000                                                                  22000006
220100        (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                       22010006
220200                                ASC-ITEM-SUB) =                   22020006
220300         ASC-START-OF-SELECTED-RANGE)                             22030006
220400                                                                  22040006
220500         IF (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                   22050006
220600                                    ASC-ITEM-SUB) <               22060006
220700             ASC-END-OF-SELECTED-RANGE) OR                        22070006
220800                                                                  22080006
220900            (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                   22090006
221000                                    ASC-ITEM-SUB) =               22100006
221100             ASC-END-OF-SELECTED-RANGE)                           22110006
221200                                                                  22120006
221300             IF NOT ASC-SELECT(ASC-BLOCK-SUB ASC-ITEM-SUB)        22130006
221400                                                                  22140006
221500                 SET ASC-SELECT(ASC-BLOCK-SUB                     22150006
221600                                  ASC-ITEM-SUB) TO TRUE           22160006
221700                                                                  22170006
221800                 SET ASC-BLOCK-MODIFIED(ASC-BLOCK-SUB) TO TRUE    22180006
221900                                                                  22190006
222000                 ADD +1 TO ASC-NUMBER-OF-SELECTED-ITEMS           22200006
222100             END-IF                                               22210006
222200                                                                  22220006
222300         END-IF                                                   22230006
222400                                                                  22240006
222500     END-IF.                                                      22250006
222600 EJECT                                                            22260006
222700 G300-DETERMINE-WHAT-IS-WHERE.                                    22270006
222800                                                                  22280006
222900******************************************************************22290006
223000*    DETERMINE WHETHER THE TOP ITEM AND BOTTOM ITEM CAN BE FOUND  22300006
223100*    IN THE ARRAY, IN TEMPORARY STORAGE, OR NEITHER.              22310006
223200*                                                                 22320006
223300*    PERFORMED BY F500-BROWSE.                                    22330006
223400******************************************************************22340006
223500                                                                  22350006
223600     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-FIRST-ITEM-IN-ARRAY.    22360006
223700                                                                  22370006
223800     COMPUTE PV-LAST-ITEM-IN-ARRAY =                              22380006
223900         (PV-FIRST-ITEM-IN-ARRAY +                                22390006
224000         (PC-MAX-BLOCKS-IN-ARRAY * PC-ITEMS-PER-BLOCK)) - 1.      22400006
224100                                                                  22410006
224200     IF  PV-LAST-ITEM-IN-ARRAY > ASC-NUMBER-OF-ITEMS-READ         22420006
224300         MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-LAST-ITEM-IN-ARRAY   22430006
224400     END-IF.                                                      22440006
224500                                                                  22450006
224600     COMPUTE PV-LAST-ITEM-IN-TEMP =                               22460006
224700         ASC-HIGHEST-BLOCK-WRITTEN * PC-ITEMS-PER-BLOCK.          22470006
224800                                                                  22480006
224900     IF  PV-LAST-ITEM-IN-TEMP > ASC-NUMBER-OF-ITEMS-READ          22490006
225000         MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-LAST-ITEM-IN-TEMP    22500006
225100     END-IF.                                                      22510006
225200                                                                  22520006
225300     IF (PV-TOP-ITEM > PV-FIRST-ITEM-IN-ARRAY) OR                 22530006
225400        (PV-TOP-ITEM = PV-FIRST-ITEM-IN-ARRAY)                    22540006
225500                                                                  22550006
225600         IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-ARRAY) OR              22560006
225700            (PV-TOP-ITEM = PV-LAST-ITEM-IN-ARRAY)                 22570006
225800             SET PS-TOP-ITEM-IN-ARRAY     TO TRUE                 22580006
225900         ELSE                                                     22590006
226000             SET PS-TOP-ITEM-NOT-IN-ARRAY TO TRUE                 22600006
226100         END-IF                                                   22610006
226200                                                                  22620006
226300     ELSE                                                         22630006
226400         SET PS-TOP-ITEM-NOT-IN-ARRAY TO TRUE                     22640006
226500     END-IF.                                                      22650006
226600                                                                  22660006
226700     IF (PV-BOTTOM-ITEM > PV-FIRST-ITEM-IN-ARRAY) OR              22670006
226800        (PV-BOTTOM-ITEM = PV-FIRST-ITEM-IN-ARRAY)                 22680006
226900                                                                  22690006
227000         IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-ARRAY) OR           22700006
227100            (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-ARRAY)              22710006
227200             SET PS-BOTTOM-ITEM-IN-ARRAY     TO TRUE              22720006
227300         ELSE                                                     22730006
227400             SET PS-BOTTOM-ITEM-NOT-IN-ARRAY TO TRUE              22740006
227500         END-IF                                                   22750006
227600                                                                  22760006
227700     ELSE                                                         22770006
227800         SET PS-BOTTOM-ITEM-NOT-IN-ARRAY TO TRUE                  22780006
227900     END-IF.                                                      22790006
228000                                                                  22800006
228100     IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-TEMP) OR                   22810006
228200        (PV-TOP-ITEM = PV-LAST-ITEM-IN-TEMP)                      22820006
228300         SET PS-TOP-ITEM-IN-TEMP     TO TRUE                      22830006
228400     ELSE                                                         22840006
228500         SET PS-TOP-ITEM-NOT-IN-TEMP TO TRUE                      22850006
228600     END-IF.                                                      22860006
228700                                                                  22870006
228800     IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-TEMP) OR                22880006
228900        (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-TEMP)                   22890006
229000         SET PS-BOTTOM-ITEM-IN-TEMP     TO TRUE                   22900006
229100     ELSE                                                         22910006
229200         SET PS-BOTTOM-ITEM-NOT-IN-TEMP TO TRUE                   22920006
229300     END-IF.                                                      22930006
229400                                                                  22940006
229500     IF  PV-LAST-ITEM-IN-TEMP > PV-LAST-ITEM-IN-ARRAY             22950006
229600         SET PS-LAST-BLOCK-NOT-IN-ARRAY TO TRUE                   22960006
229700     ELSE                                                         22970006
229800         SET PS-LAST-BLOCK-IN-ARRAY     TO TRUE                   22980006
229900     END-IF.                                                      22990006
230000 EJECT                                                            23000006
230100 G400-READ-ITEMS-INTO-ARRAY.                                      23010006
230200                                                                  23020006
230300******************************************************************23030006
230400*    DETERMINE THE SPOT IN THE ARRAY WHERE THE LAST ITEM FROM     23040006
230500*    THE DATA BASE WAS ADDED SO WE KNOW WHERE TO ADD THE NEW      23050006
230600*    ITEMS.                                                       23060006
230700*                                                                 23070006
230800*    PERFORMED BY F500-BROWSE.                                    23080006
230900******************************************************************23090006
231000                                                                  23100006
231100     COMPUTE PS-ITEM-SUB =                                        23110006
231200         (ASC-NUMBER-OF-ITEMS-READ -                              23120006
231300          ASC-LIST-ITEM-NUMBER(1 1)) + 1.                         23130006
231400                                                                  23140006
231500     MOVE PS-ITEM-SUB TO ASC-ITEM-SUB.                            23150006
231600                                                                  23160006
231700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK                        23170006
231800         SUBTRACT PC-ITEMS-PER-BLOCK FROM ASC-ITEM-SUB            23180006
231900                                                                  23190006
232000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLOCK-SUB             23200006
232100     ELSE                                                         23210006
232200         MOVE +1                     TO ASC-BLOCK-SUB             23220006
232300     END-IF.                                                      23230006
232400                                                                  23240006
232500     MOVE PV-BOTTOM-ITEM TO PV-HIGHEST-ITEM-TO-BE-READ.           23250006
232600     MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-START-ITEM-NUMBER.       23260006
232700                                                                  23270006
232800     PERFORM H100-READ-ITEMS-FROM-DB.                             23280006
232900                                                                  23290006
233000     IF  ASC-NO-ITEMS-LEFT-ON-DB                                  23300006
233100                                                                  23310006
233200         IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                23320006
233300             MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-TOP-ITEM         23330006
233400         END-IF                                                   23340006
233500                                                                  23350006
233600         MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER          23360006
233700         SET DP020-MSG-INFORMATIONAL TO TRUE                      23370006
233800         SET PS-INFORMATIONAL        TO TRUE                      23380006
233900                                                                  23390006
234000     END-IF.                                                      23400006
234100 EJECT                                                            23410006
234200 G500-SCROLL-FORWARD.                                             23420006
234300                                                                  23430006
234400******************************************************************23440006
234500*    IF THE TOP ITEM WE NEED IS IN THE ARRAY, BUT THE BOTTOM      23450006
234600*    ITEM WE NEED IS IN TEMPORARY STORAGE OR HAS NOT BEEN READ    23460006
234700*    YET, WRITE OUT THE 1ST BLOCK IN THE ARRAY TO TEMPORARY       23470006
234800*    STORAGE.  MOVE THE 2ND BLOCK IN THE ARRAY TO THE 1ST BLOCK   23480006
234900*    AND READ THE BLOCK NEEDED INTO THE 2ND BLOCK OF THE ARRAY.   23490006
235000*    THE TOP ITEM WILL BE LOCATED IN THE 1ST BLOCK, AND THE       23500006
235100*    BOTTOM ITEM WILL EITHER BE LOCATED IN THE 2ND BLOCK OR       23510006
235200*    WILL BE PLACED IN THE 2ND BLOCK.                             23520006
235300*                                                                 23530006
235400*    PERFORMED BY F500-BROWSE.                                    23540006
235500******************************************************************23550006
235600                                                                  23560006
235700     MOVE +1 TO ASC-BLOCK-SUB.                                    23570006
235800                                                                  23580006
235900     PERFORM Z150-WRITE-TEMP-STORAGE.                             23590006
236000                                                                  23600006
236100     MOVE ASC-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY) TO            23610006
236200          ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB).                       23620006
236300                                                                  23630006
236400     COMPUTE PV-TEMP-BLOCK-NUMBER =                               23640006
236500         1 + ((PV-BOTTOM-ITEM - 1) / PC-ITEMS-PER-BLOCK).         23650006
236600                                                                  23660006
236700     MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                23670006
236800                                                                  23680006
236900     ADD +1 TO ASC-BLOCK-SUB.                                     23690006
237000                                                                  23700006
237100     PERFORM Z100-READ-TEMP-STORAGE.                              23710006
237200 EJECT                                                            23720006
237300 G600-SCROLL-BACKWARD.                                            23730006
237400                                                                  23740006
237500******************************************************************23750006
237600*    IF TOP ITEM WE NEED IS NOT IN THE ARRAY, BUT THE BOTTOM      23760006
237700*    ITEM IS, WRITE BOTH BLOCKS TO TEMPORARY STORAGE.  MOVE       23770006
237800*    THE 1ST BLOCK IN THE ARRAY TO THE 2ND BLOCK OF THE ARRAY.    23780006
237900*    READ THE BLOCK THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK 23790006
238000*    OF THE ARRAY.                                                23800006
238100*                                                                 23810006
238200*    PERFORMED BY F500-BROWSE.                                    23820006
238300******************************************************************23830006
238400                                                                  23840006
238500     MOVE +1 TO ASC-BLOCK-SUB.                                    23850006
238600                                                                  23860006
238700     PERFORM Z150-WRITE-TEMP-STORAGE.                             23870006
238800                                                                  23880006
238900     ADD +1 TO ASC-BLOCK-SUB.                                     23890006
239000                                                                  23900006
239100     PERFORM Z150-WRITE-TEMP-STORAGE.                             23910006
239200                                                                  23920006
239300     MOVE +1                                   TO                 23930006
239400          ASC-BLOCK-SUB.                                          23940006
239500                                                                  23950006
239600     MOVE ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB) TO                     23960006
239700          ASC-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY).              23970006
239800                                                                  23980006
239900     COMPUTE PV-TEMP-BLOCK-NUMBER =                               23990006
240000         1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).            24000006
240100                                                                  24010006
240200     MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                24020006
240300                                                                  24030006
240400     PERFORM Z100-READ-TEMP-STORAGE.                              24040006
240500 EJECT                                                            24050006
240600 G700-GET-TOP-ITEMS-BLOCK.                                        24060006
240700                                                                  24070006
240800******************************************************************24080006
240900*    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE      24090006
241000*    ARRAY, BUT THE TOP ITEM IS IN TEMPORARY STORAGE, WRITE BOTH  24100006
241100*    BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ THE BLOCK    24110006
241200*    THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK OF THE ARRAY.  24120006
241300*    IF THERE IS ANOTHER BLOCK IN TEMPORARY STORAGE FOLLOWING     24130006
241400*    THE ONE JUST READ, READ THAT ONE INTO THE 2ND BLOCK OF THE   24140006
241500*    ARRAY, OTHERWISE INITIALIZE THE 2ND BLOCK OF THE ARRAY.      24150006
241600*                                                                 24160006
241700*    PERFORMED BY F500-BROWSE.                                    24170006
241800******************************************************************24180006
241900                                                                  24190006
242000     MOVE +1 TO ASC-BLOCK-SUB.                                    24200006
242100                                                                  24210006
242200     PERFORM Z150-WRITE-TEMP-STORAGE.                             24220006
242300                                                                  24230006
242400     ADD +1 TO ASC-BLOCK-SUB.                                     24240006
242500                                                                  24250006
242600     PERFORM Z150-WRITE-TEMP-STORAGE.                             24260006
242700                                                                  24270006
242800     COMPUTE PV-TEMP-BLOCK-NUMBER =                               24280006
242900         1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).            24290006
243000                                                                  24300006
243100     MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                24310006
243200     MOVE +1                   TO ASC-BLOCK-SUB.                  24320006
243300                                                                  24330006
243400     PERFORM Z100-READ-TEMP-STORAGE.                              24340006
243500                                                                  24350006
243600     ADD +1 TO PV-BLOCK-NUMBER.                                   24360006
243700     ADD +1 TO ASC-BLOCK-SUB.                                     24370006
243800                                                                  24380006
243900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN) OR          24390006
244000        (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             24400006
244100         PERFORM Z100-READ-TEMP-STORAGE                           24410006
244200     ELSE                                                         24420006
244300         PERFORM I100-INITIALIZE-BLOCK                            24430006
244400     END-IF.                                                      24440006
244500 EJECT                                                            24450006
244600 G800-GET-LAST-BLOCK-IN-TEMP.                                     24460006
244700                                                                  24470006
244800******************************************************************24480006
244900*    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE      24490006
245000*    ARRAY AND BOTH ITEMS ARE NOT IN TEMPORARY STORAGE (THE       24500006
245100*    ITEMS HAVE NOT BEEN READ FROM THE DATA BASE YET), AND THE    24510006
245200*    LAST ITEM READ FROM THE DATA BASE IS IN TEMPORARY STORAGE,   24520006
245300*    WRITE BOTH BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ   24530006
245400*    THE HIGHEST BLOCK IN TEMPORARY STORAGE INTO THE 1ST BLOCK    24540006
245500*    OF THE ARRAY, AND INITIALIZE THE 2ND BLOCK IN THE ARRAY.     24550006
245600*    THE 2ND BLOCK WILL BE USED FOR THE NEW ITEMS TO BE READ.     24560006
245700*    THE 1ST BLOCK WILL NOW CONTAIN THE ITEMS THAT WERE LAST      24570006
245800*    READ FROM THE DATA BASE.                                     24580006
245900*                                                                 24590006
246000*    PERFORMED BY F500-BROWSE.                                    24600006
246100******************************************************************24610006
246200                                                                  24620006
246300     MOVE +1 TO ASC-BLOCK-SUB.                                    24630006
246400                                                                  24640006
246500     PERFORM Z150-WRITE-TEMP-STORAGE.                             24650006
246600                                                                  24660006
246700     ADD +1 TO ASC-BLOCK-SUB.                                     24670006
246800                                                                  24680006
246900     PERFORM Z150-WRITE-TEMP-STORAGE.                             24690006
247000                                                                  24700006
247100     MOVE ASC-HIGHEST-BLOCK-WRITTEN TO PV-BLOCK-NUMBER.           24710006
247200     MOVE +1                          TO ASC-BLOCK-SUB.           24720006
247300                                                                  24730006
247400     PERFORM Z100-READ-TEMP-STORAGE.                              24740006
247500                                                                  24750006
247600     ADD +1 TO ASC-BLOCK-SUB.                                     24760006
247700                                                                  24770006
247800     PERFORM I100-INITIALIZE-BLOCK.                               24780006
247900 EJECT                                                            24790006
248000 H100-READ-ITEMS-FROM-DB.                                         24800006
248100                                                                  24810006
248200******************************************************************24820006
248300*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE     24830006
248400*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,      24840006
248500*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND   24850006
248600*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE      24860006
248700*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                    24870006
248800*                                                                 24880006
248900*    PERFORMED BY D100-SETUP-INIT-PANEL.                          24890006
249000*    PERFORMED BY G400-READ-ITEMS-INTO-ARRAY.                     24900006
249100******************************************************************24910006
249200                                                                  24920006
249300                                                                  24930006
249400     PERFORM Z200-OPEN-CONTROL-TAB-CURSOR.                        24940006
249500                                                                  24950006
249600     PERFORM                                                      24960006
249700         UNTIL (ASC-NO-ITEMS-LEFT-ON-DB) OR                       24970006
249800               (ASC-NUMBER-OF-ITEMS-READ =                        24980006
249900                PV-HIGHEST-ITEM-TO-BE-READ)                       24990006
250000                                                                  25000006
250100         IF  ASC-ITEM-SUB < PC-ITEMS-PER-BLOCK                    25010006
250200             ADD +1 TO ASC-ITEM-SUB                               25020006
250300         ELSE                                                     25030006
250400             ADD +1 TO ASC-BLOCK-SUB                              25040006
250500                                                                  25050006
250600             MOVE +1 TO ASC-ITEM-SUB                              25060006
250700                                                                  25070006
250800             IF  ASC-BLOCK-SUB > PC-MAX-BLOCKS-IN-ARRAY           25080006
250900                 MOVE +1 TO ASC-BLOCK-SUB                         25090006
251000                                                                  25100006
251100                 PERFORM Z150-WRITE-TEMP-STORAGE                  25110006
251200                                                                  25120006
251300                 MOVE ASC-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY)   25130006
251400                 TO   ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB)            25140006
251500                                                                  25150006
251600                 ADD +1 TO ASC-BLOCK-SUB                          25160006
251700                                                                  25170006
251800                 PERFORM I100-INITIALIZE-BLOCK                    25180006
251900             END-IF                                               25190006
252000                                                                  25200006
252100         END-IF                                                   25210006
252200                                                                  25220006
252300         PERFORM Z450-FETCH-CONTROL-TAB-CURSOR                    25230006
252400                                                                  25240006
252500         IF  ASC-ITEMS-LEFT-ON-DB                                 25250006
252600             ADD +1 TO ASC-NUMBER-OF-ITEMS-READ                   25260006
252700                                                                  25270006
252800             MOVE PPCCTL-UPD-IND TO                               25280006
252900                  ASC-UPDATE-SW(ASC-BLOCK-SUB                     25290006
253000                                  ASC-ITEM-SUB)                   25300006
253100                                                                  25310006
253200             MOVE PPCCTL-NBR TO                                   25320006
253300                  ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB              25330006
253400                                         ASC-ITEM-SUB)            25340006
253500                                                                  25350006
253600             MOVE PPCCTL-PARM-AMT TO                              25360006
253700                  ASC-PARM-AMT(ASC-BLOCK-SUB                      25370006
253800                                 ASC-ITEM-SUB)                    25380006
253900                                                                  25390006
254000             MOVE PPCCTL-DESC     TO                              25400006
254100                  ASC-DESC(ASC-BLOCK-SUB                          25410006
254200                             ASC-ITEM-SUB)                        25420006
254300                                                                  25430006
254400         END-IF                                                   25440006
254500                                                                  25450006
254600     END-PERFORM.                                                 25460006
254700                                                                  25470006
254800     IF  ASC-ITEMS-LEFT-ON-DB                                     25480006
254900                                                                  25490006
255000         PERFORM Z450-FETCH-CONTROL-TAB-CURSOR                    25500006
255100     END-IF.                                                      25510006
255200                                                                  25520006
255300     PERFORM Z900-CLOSE-CONTROL-TAB-CURSOR.                       25530006
255400 EJECT                                                            25540006
255500 H200-FORMAT-PANEL-BODY.                                          25550006
255600                                                                  25560006
255700******************************************************************25570006
255800*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.            25580006
255900*                                                                 25590006
256000*    PERFORMED BY G100-DISPLAY-PANEL.                             25600006
256100******************************************************************25610006
256200                                                                  25620006
256300     PERFORM I700-FORMAT-FROM-TO-LINE.                            25630006
256400     PERFORM I200-FORMAT-LIST-LINES.                              25640006
256500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ATOTSELO.               25650006
256600                                                                  25660006
256700     IF  NOT DP020-NEXT-ACT-ERROR                                 25670006
256800         PERFORM I800-SET-CURSOR-POSITION                         25680006
256900     END-IF.                                                      25690006
257000 EJECT                                                            25700006
257100 H400-WRITE-OUT-LAST-BLOCKS.                                      25710006
257200                                                                  25720006
257300******************************************************************25730006
257400*    WRITE OUT THE 2 BLOCKS CURRENTLY IN WORKING STORAGE TO       25740006
257500*    TEMPORARY STORAGE.                                           25750006
257600*                                                                 25760006
257700*    PERFORMED BY D200-CHECK-FUNCTION-KEY.                        25770006
257800*    PERFORMED BY E900-UPDATE-CANCEL-UNCANCEL.                    25780006
257900*    PERFORMED BY G600-SCROLL-BACKWARD.                           25790006
258000*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       25800006
258100*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    25810006
258200******************************************************************25820006
258300                                                                  25830006
258400     MOVE +1 TO ASC-BLOCK-SUB.                                    25840006
258500                                                                  25850006
258600     PERFORM Z150-WRITE-TEMP-STORAGE.                             25860006
258700                                                                  25870006
258800     ADD +1 TO ASC-BLOCK-SUB.                                     25880006
258900                                                                  25890006
259000     PERFORM Z150-WRITE-TEMP-STORAGE.                             25900006
259100 EJECT                                                            25910006
259200 I100-INITIALIZE-BLOCK.                                           25920006
259300                                                                  25930006
259400******************************************************************25940006
259500*    INITIALIZE A BLOCK IN THE ARRAY.                             25950006
259600*                                                                 25960006
259700*    PERFORMED BY D100-SETUP-INIT-PANEL.                          25970006
259800*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       25980006
259900*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    25990006
260000*    PERFORMED BY H100-READ-ITEMS-FROM-DB.                        26000006
260100******************************************************************26010006
260200                                                                  26020006
260300     PERFORM                                                      26030006
260400         VARYING PS-SUB FROM 1 BY 1                               26040006
260500         UNTIL PS-SUB > PC-ITEMS-PER-BLOCK                        26050006
260600                                                                  26060006
260700         MOVE SPACE  TO ASC-SELECTED-SW(ASC-BLOCK-SUB             26070006
260800                                             PS-SUB)              26080006
260900         MOVE +0     TO ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB        26090006
261000                                               PS-SUB)            26100006
261100                                                                  26110006
261200         MOVE +0     TO ASC-PARM-AMT(ASC-BLOCK-SUB                26120006
261300                                               PS-SUB)            26130006
261400                                                                  26140006
261500         MOVE SPACE  TO ASC-DESC(ASC-BLOCK-SUB                    26150006
261600                                            PS-SUB)               26160006
261700                                                                  26170006
261800     END-PERFORM.                                                 26180006
261900                                                                  26190006
262000 EJECT                                                            26200006
262100 I200-FORMAT-LIST-LINES.                                          26210006
262200                                                                  26220006
262300******************************************************************26230006
262400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.     26240006
262500*                                                                 26250006
262600*    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                     26260006
262700*    PERFORMED BY H200-FORMAT-PANEL-BODY.                         26270006
262800******************************************************************26280006
262900                                                                  26290006
263000     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            26300006
263100         (ASC-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.     26310006
263200                                                                  26320006
263300     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-ITEM-IN-USE.             26330006
263400     MOVE +1                         TO PS-SUB.                   26340006
263500     MOVE +1                         TO PS-MAP-SUB.               26350006
263600                                                                  26360006
263700     PERFORM                                                      26370006
263800         UNTIL PS-MAP-SUB > 14                                    26380006
263900         MOVE SPACES TO PEKM145O-ASELO(PS-MAP-SUB)                26390006
264000                        PEKM145O-AVALO(PS-MAP-SUB)                26400006
264100                        PEKM145O-ADESO(PS-MAP-SUB)                26410006
264200         ADD 1 TO PS-MAP-SUB                                      26420006
264300                                                                  26430006
264400     END-PERFORM.                                                 26440006
264500                                                                  26450006
264600     MOVE +1                         TO PS-MAP-SUB.               26460006
264700                                                                  26470006
264800     PERFORM J100-PROCESS-ITEMS                                   26480006
264900         UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.          26490006
265000                                                                  26500006
265100     MOVE +1                         TO PS-MAP-SUB.               26510006
265200     SET PS-CURSOR-NOT-SET TO TRUE.                               26520006
265300                                                                  26530006
265400     PERFORM                                                      26540006
265500         UNTIL PS-MAP-SUB > 14                                    26550006
265600                                                                  26560006
265700         IF  (PEKM145O-ASELO(PS-MAP-SUB)                          26570006
265800                      = SPACES)                                   26580006
265900         AND (PEKM145O-AVALO(PS-MAP-SUB)                          26590006
266000                      = SPACES)                                   26600006
266100         AND (PEKM145O-ADESO(PS-MAP-SUB)                          26610006
266200                      = SPACES)                                   26620006
266300              MOVE DP015-PRO-DRK-MDT                              26630006
266400                     TO PEKM145I-ASELA(PS-MAP-SUB)                26640006
266500         ELSE                                                     26650006
266600                                                                  26660006
266700            IF  (PS-CURSOR-NOT-SET)                               26670006
266800            AND (PEKM145I-ASELA(PS-MAP-SUB)                       26680006
266900                   NOT = DP015-PRO-DRK-MDT)                       26690006
267000                 IF (DP020-NAV-MNEMONIC = LOW-VALUES) OR          26700006
267100                    (DP020-NAV-MNEMONIC = SPACES)                 26710006
267200                     MOVE -1 TO PEKM145I-ASELL(PS-MAP-SUB)        26720006
267300                     SET PS-CURSOR-SET TO TRUE                    26730006
267400                 END-IF                                           26740006
267500            END-IF                                                26750006
267600         END-IF                                                   26760006
267700                                                                  26770006
267800         ADD 1 TO PS-MAP-SUB                                      26780006
267900                                                                  26790006
268000     END-PERFORM.                                                 26800006
268100                                                                  26810006
268200 EJECT                                                            26820006
268300 I700-FORMAT-FROM-TO-LINE.                                        26830006
268400                                                                  26840006
268500******************************************************************26850006
268600*    FORMAT THE LINE THAT WILL SHOW THE TOTAL NUMBER OF ITEMS WE  26860006
268700*    HAVE ON OUR LIST AND SHOW THE NUMBERS ASSOCIATED WITH THE    26870006
268800*    FIRST AND LAST ITEMS ON CURRENT PAGE.  THIS WILL HELP THE    26880006
268900*    USER DETERMINE HOW FAR THEY ARE INTO THE LIST.               26890006
269000*                                                                 26900006
269100*    PERFORMED BY H200-FORMAT-PANEL-BODY.                         26910006
269200******************************************************************26920006
269300                                                                  26930006
269400     IF  ASC-NUMBER-OF-ITEMS-READ > +0                            26940006
269500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            26950006
269600                                TO  PV-DISPLAY-NUMBER             26960006
269700         MOVE PV-DISPLAY-NUMBER TO ABEGITMO                       26970006
269800     ELSE                                                         26980006
269900         MOVE 0                  TO PV-DISPLAY-NUMBER1            26990006
270000         MOVE  PV-DISPLAY-NUMBER1 TO ABEGITMO                     27000006
270100     END-IF.                                                      27010006
270200                                                                  27020006
270300     MOVE DP015-GREEN           TO ABEGITMC.                      27030006
270400     MOVE DP015-UNDERLINE       TO ABEGITMH.                      27040006
270500     MOVE DP015-UNP-ALP-BRT-MDT TO ABEGITMA.                      27050006
270600                                                                  27060006
270700     COMPUTE PV-ENDING-ITEM-ON-PANEL =                            27070006
270800         (ASC-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.     27080006
270900                                                                  27090006
271000     IF  PV-ENDING-ITEM-ON-PANEL < ASC-NUMBER-OF-ITEMS-READ       27100006
271100         MOVE PV-ENDING-ITEM-ON-PANEL    TO AENDITMO              27110006
271200     ELSE                                                         27120006
271300         MOVE ASC-NUMBER-OF-ITEMS-READ TO AENDITMO                27130006
271400     END-IF.                                                      27140006
271500                                                                  27150006
271600     MOVE SPACES TO AOFO.                                         27160006
271700     MOVE ZEROES TO ATOTITMO.                                     27170006
271800                                                                  27180006
271900     IF (ASC-NUMBER-OF-ITEMS-READ > +0) AND                       27190006
272000        (ASC-NO-ITEMS-LEFT-ON-DB)                                 27200006
272100         MOVE 'OF'                       TO AOFO                  27210006
272200         MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITMO                27220006
272300     END-IF.                                                      27230006
272400 EJECT                                                            27240006
272500 I800-SET-CURSOR-POSITION.                                        27250006
272600                                                                  27260006
272700******************************************************************27270006
272800*    IF NO ITEMS WERE READ FROM THE DATA BASE, POINT THE CURSOR   27280006
272900*    TO THE COMMAND LINE, OTHERWISE POINT THE CURSOR TO ONE OF    27290006
273000*    THE SELECTION ENTRIES.                                       27300006
273100*                                                                 27310006
273200*    PERFORMED BY H200-FORMAT-PANEL-BODY.                         27320006
273300******************************************************************27330006
273400                                                                  27340006
273500     IF  ASC-NUMBER-OF-ITEMS-READ = +0                            27350006
273600         MOVE -1                   TO ANAVCMDL                    27360006
273700                                                                  27370006
273800         SET DP020-MSG-WARNING     TO TRUE                        27380006
273900                                                                  27390006
274000     ELSE                                                         27400006
274100         MOVE -1                   TO ANAVCMDL                    27410006
274200                                                                  27420006
274300     END-IF.                                                      27430006
274400 EJECT                                                            27440006
274500 J100-PROCESS-ITEMS.                                              27450006
274600                                                                  27460006
274700******************************************************************27470006
274800*    PROCESS EACH ITEM IN THE ARRAY AND MOVE IT TO THE MAP.       27480006
274900*    FILL THE MAP UNTIL WE HAVE REACHED THE MAXIMUM NUMBER OF     27490006
275000*    MAP ENTRIES.                                                 27500006
275100*                                                                 27510006
275200*    PERFORMED BY I200-FORMAT-LIST-LINES.                         27520006
275300******************************************************************27530006
275400                                                                  27540006
275500     IF (PV-ITEM-IN-USE < ASC-NUMBER-OF-ITEMS-READ) OR            27550006
275600        (PV-ITEM-IN-USE = ASC-NUMBER-OF-ITEMS-READ)               27560006
275700                                                                  27570006
275800         PERFORM K100-SET-SUBSCRIPTS                              27580006
275900                                                                  27590006
276000         MOVE DP015-UNP-ALP-BRT-MDT TO PEKM145I-ASELA(PS-MAP-SUB) 27600006
276100                                                                  27610006
276200         IF (ASC-SELECT(ASC-BLOCK-SUB ASC-ITEM-SUB))          OR  27620006
276300            (ASC-NO-SELECT(ASC-BLOCK-SUB ASC-ITEM-SUB))           27630006
276400             MOVE DP015-UNDERLINE TO PEKM145O-ASELH(PS-MAP-SUB)   27640006
276500             MOVE DP015-GREEN     TO PEKM145O-ASELC(PS-MAP-SUB)   27650006
276600         ELSE                                                     27660006
276700                                                                  27670006
276800             IF (ASC-BEGIN(ASC-BLOCK-SUB ASC-ITEM-SUB)) OR        27680006
276900                (ASC-END(ASC-BLOCK-SUB ASC-ITEM-SUB))             27690006
277000                                                                  27700006
277100                 IF (DP020-MSG-NUMBER = PC-TSYMSG-00053) OR       27710006
277200                    (DP020-MSG-NUMBER = PC-TSYMSG-00051)          27720006
277300                     MOVE DP015-REVERSE                           27730006
277400                                    TO PEKM145O-ASELH(PS-MAP-SUB) 27740006
277500                     MOVE DP015-YELLOW                            27750006
277600                                    TO PEKM145O-ASELC(PS-MAP-SUB) 27760006
277700                 END-IF                                           27770006
277800                                                                  27780006
277900                 IF (DP020-MSG-NUMBER = PC-TSYMSG-00054)          27790006
278000                AND (ASC-BEGIN(ASC-BLOCK-SUB ASC-ITEM-SUB))       27800006
278100                     MOVE DP015-REVERSE                           27810006
278200                                    TO PEKM145O-ASELH(PS-MAP-SUB) 27820006
278300                     MOVE DP015-RED TO PEKM145O-ASELC(PS-MAP-SUB) 27830006
278400                 END-IF                                           27840006
278500                                                                  27850006
278600                 IF (DP020-MSG-NUMBER = PC-TSYMSG-00055)          27860006
278700                AND (ASC-END(ASC-BLOCK-SUB ASC-ITEM-SUB))         27870006
278800                     MOVE DP015-REVERSE                           27880006
278900                                    TO PEKM145O-ASELH(PS-MAP-SUB) 27890006
279000                     MOVE DP015-RED TO PEKM145O-ASELC(PS-MAP-SUB) 27900006
279100                 END-IF                                           27910006
279200                                                                  27920006
279300                 IF DP020-MSG-NUMBER = PC-TSYMSG-00052            27930006
279400                     MOVE DP015-REVERSE                           27940006
279500                                     TO PEKM145O-ASELH(PS-MAP-SUB)27950006
279600                     MOVE DP015-RED  TO PEKM145O-ASELC(PS-MAP-SUB)27960006
279700                 END-IF                                           27970006
279800                                                                  27980006
279900             END-IF                                               27990006
280000                                                                  28000006
280100         END-IF                                                   28010006
280200                                                                  28020006
280300         MOVE ASC-SELECTED-SW(ASC-BLOCK-SUB ASC-ITEM-SUB) TO      28030006
280400              PEKM145O-ASELO(PS-SUB)                              28040006
280500                                                                  28050006
280600         MOVE ASC-PARM-AMT(ASC-BLOCK-SUB                          28060006
280700                          ASC-ITEM-SUB)                           28070006
280800               TO PV-DISPLAY-PARM-AMT                             28080006
280900         MOVE PV-DISPLAY-PARM-AMT                                 28090006
281000               TO PEKM145O-AVALO(PS-MAP-SUB)                      28100006
281100                                                                  28110006
281200         PERFORM J200-CHECK-PARM-AMT-FOR-DATE                     28120006
281300                                                                  28130006
281400         MOVE ASC-DESC(ASC-BLOCK-SUB                              28140006
281500                          ASC-ITEM-SUB)                           28150006
281600               TO PEKM145O-ADESO(PS-MAP-SUB)                      28160006
281700     ELSE                                                         28170006
281800         MOVE SPACES TO                                           28180006
281900                        PEKM145O-AVALO(PS-MAP-SUB)                28190006
282000                        PEKM145O-ADESO(PS-MAP-SUB)                28200006
282100                                                                  28210006
282200     END-IF.                                                      28220006
282300                                                                  28230006
282400     ADD +1 TO PV-ITEM-IN-USE.                                    28240006
282500     ADD +1 TO PS-SUB.                                            28250006
282600     ADD +1 TO PS-MAP-SUB.                                        28260006
282700 EJECT                                                            28270006
282800 J200-CHECK-PARM-AMT-FOR-DATE.                                    28280006
282900                                                                  28290006
283000******************************************************************28300006
283100*    PROCESS EACH ITEM IN THE ARRAY CHECK TO SEE IF IT IS         28310006
283200*    A DATE AND DISPLAY IT IN THE PREFERRED FORMAT.               28320006
283300*                                                                 28330006
283400*    PERFORMED BY J100-PROCESS-ITEMS.                             28340006
283500******************************************************************28350006
283600                                                                  28360006
283700                                                                  28370006
283800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                   28380006
283900                          ASC-ITEM-SUB)                           28390006
284000             = PE048-CURR-FISCAL-ME-DATE-NBR)                     28400006
284100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                   28410006
284200                          ASC-ITEM-SUB)                           28420006
284300             = PE048-NEXT-FISCAL-ME-DATE-NBR)                     28430006
284400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB                   28440006
284500                          ASC-ITEM-SUB)                           28450006
284600             = PE048-PHY-INV-DATE-NBR)                            28460006
284700               MOVE PV-DISPLAY-PARM-AMT                           28470006
284800                    TO  PV-DATE-MMDDYY-FORMAT                     28480006
284900               MOVE  PV-DATE-MMDDYY-MM TO PV-DATE-MMDDYY-MM-D     28490006
285000               MOVE  PV-DATE-MMDDYY-DD TO PV-DATE-MMDDYY-DD-D     28500006
285100               MOVE  PV-DATE-MMDDYY-YY TO PV-DATE-MMDDYY-YY-D     28510006
285200               MOVE  PV-DATE-MMDDYY-DISPLAY                       28520006
285300                     TO PEKM145O-AVALO(PS-MAP-SUB)                28530006
285400                                                                  28540006
285500         ELSE                                                     28550006
285600             IF (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB               28560006
285700                                        ASC-ITEM-SUB)             28570006
285800                    =  PE048-CURR-FISCAL-YM-DATE-NBR)             28580006
285900             OR (ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB               28590006
286000                                        ASC-ITEM-SUB)             28600006
286100                    =  PE048-NEXT-FISCAL-YM-DATE-NBR)             28610006
286200                 MOVE PV-DISPLAY-PARM-AMT                         28620006
286300                          TO PV-DATE-MMYY-FORMAT                  28630006
286400                 MOVE  PV-DATE-MMYY-MM TO PV-DATE-MMYY-MM-D       28640006
286500                 MOVE  PV-DATE-MMYY-YY TO PV-DATE-MMYY-YY-D       28650006
286600                 MOVE  PV-DATE-MMYY-DISPLAY                       28660006
286700                     TO PEKM145O-AVALO(PS-MAP-SUB)                28670006
286800             END-IF                                               28680006
286900         END-IF.                                                  28690006
287000                                                                  28700006
287100                                                                  28710006
287200         PERFORM J300-SET-NON-UPDATE-ATTRS.                       28720006
287300                                                                  28730006
287400 EJECT                                                            28740006
287500 J300-SET-NON-UPDATE-ATTRS.                                       28750006
287600                                                                  28760006
287700******************************************************************28770006
287800*    PROCESS EACH ITEM IN THE ARRAY CHECK TO SEE IF IT IS         28780006
287900*    A FISCAL DATE AND PROTECT IT IF IT IS.                       28790006
288000*                                                                 28800006
288100*    PERFORMED BY J200-CHECK-PARM-AMT-FOR-DATE                    28810006
288200******************************************************************28820006
288300                                                                  28830006
288400                                                                  28840006
288500         IF (ASC-CANNOT-UPDATE(ASC-BLOCK-SUB                      28850006
288600                          ASC-ITEM-SUB))                          28860006
288700             MOVE DP015-PRO-DRK-MDT                               28870006
288800                     TO PEKM145I-ASELA(PS-MAP-SUB)                28880006
288900         END-IF.                                                  28890006
289000 EJECT                                                            28900006
289100 K100-SET-SUBSCRIPTS.                                             28910006
289200                                                                  28920006
289300******************************************************************28930006
289400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM  28940006
289500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL 28950006
289600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                   28960006
289700*                                                                 28970006
289800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS    28980006
289900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT     28990006
290000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION   29000006
290100*    US IN THE 2ND BLOCK OF THE ARRAY.                            29010006
290200*                                                                 29020006
290300*    PERFORMED BY F100-EDIT.                                      29030006
290400*    PERFORMED BY F300-CHECK-SELECTIONS.                          29040006
290500*    PERFORMED BY J100-PROCESS-ITEMS.                             29050006
290600******************************************************************29060006
290700                                                                  29070006
290800     COMPUTE PS-ITEM-SUB =                                        29080006
290900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        29090006
291000                                                                  29100006
291100     MOVE PS-ITEM-SUB TO ASC-ITEM-SUB.                            29110006
291200                                                                  29120006
291300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-BLOCK                        29130006
291400         SUBTRACT PC-ITEMS-PER-BLOCK FROM ASC-ITEM-SUB            29140006
291500                                                                  29150006
291600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLOCK-SUB             29160006
291700     ELSE                                                         29170006
291800         MOVE +1                     TO ASC-BLOCK-SUB             29180006
291900     END-IF.                                                      29190006
292000 EJECT                                                            29200006
292100 Z050-DELETE-TEMP-STORAGE.                                        29210006
292200                                                                  29220006
292300******************************************************************29230006
292400*    DELETE THE TEMPORARY STORAGE QUEUE.                          29240006
292500*                                                                 29250006
292600*    PERFORMED BY C300-PROCESS-PANEL.                             29260006
292700******************************************************************29270006
292800                                                                  29280006
292900     EXEC CICS                                                    29290006
293000         DELETEQ TS                                               29300006
293100         QUEUE(ASC-TEMP-QUEUE-NAME)                               29310006
293200         RESP(PV-RESP)                                            29320006
293300     END-EXEC.                                                    29330006
293400                                                                  29340006
293500     IF (PV-RESP NOT = DFHRESP(NORMAL)) AND                       29350006
293600        (PV-RESP NOT = DFHRESP(QIDERR))                           29360006
293700         MOVE PV-RESP TO PM-RESP-8                                29370006
293800                                                                  29380006
293900         SET DP013-LOGIC-ABEND TO TRUE                            29390006
294000         SET DP013-NO-ROLLBACK TO TRUE                            29400006
294100                                                                  29410006
294200         MOVE 'Z050-DELETE-TEMP-STORAGE' TO DP013-PARAGRAPH       29420006
294300         MOVE PM-PROGRAM-MESSAGE-8       TO DP013-MESSAGE-TEXT(1) 29430006
294400                                                                  29440006
294500         PERFORM DP013-0000-PROCESS-ABEND                         29450006
294600     END-IF.                                                      29460006
294700                                                                  29470006
294800     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        29480006
294900 EJECT                                                            29490006
295000 Z100-READ-TEMP-STORAGE.                                          29500006
295100                                                                  29510006
295200******************************************************************29520006
295300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.          29530006
295400*                                                                 29540006
295500*    PERFORMED BY D400-REFRESH-BLOCK-ARRAY.                       29550006
295600*    PERFORMED BY G500-SCROLL-FORWARD.                            29560006
295700*    PERFORMED BY G600-SCROLL-BACKWARD.                           29570006
295800*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       29580006
295900*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    29590006
296000******************************************************************29600006
296100                                                                  29610006
296200     EXEC CICS                                                    29620006
296300         READQ TS                                                 29630006
296400         QUEUE(ASC-TEMP-QUEUE-NAME)                               29640006
296500         INTO(ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB))                   29650006
296600         LENGTH(PC-BLOCK-LENGTH)                                  29660006
296700         ITEM(PV-BLOCK-NUMBER)                                    29670006
296800         RESP(PV-RESP)                                            29680006
296900     END-EXEC.                                                    29690006
297000                                                                  29700006
297100     IF  PV-RESP NOT = DFHRESP(NORMAL)                            29710006
297200         MOVE PV-RESP TO PM-RESP-9                                29720006
297300                                                                  29730006
297400         EXEC CICS                                                29740006
297500              DELETEQ TS                                          29750006
297600              QUEUE(ASC-TEMP-QUEUE-NAME)                          29760006
297700              RESP(PV-RESP)                                       29770006
297800         END-EXEC                                                 29780006
297900                                                                  29790006
298000         SET DP013-LOGIC-ABEND TO TRUE                            29800006
298100         SET DP013-NO-ROLLBACK TO TRUE                            29810006
298200                                                                  29820006
298300         MOVE 'Z100-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         29830006
298400         MOVE PM-PROGRAM-MESSAGE-9     TO DP013-MESSAGE-TEXT(1)   29840006
298500                                                                  29850006
298600         PERFORM DP013-0000-PROCESS-ABEND                         29860006
298700     END-IF.                                                      29870006
298800                                                                  29880006
298900 EJECT                                                            29890006
299000 Z150-WRITE-TEMP-STORAGE.                                         29900006
299100                                                                  29910006
299200******************************************************************29920006
299300*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.       29930006
299400*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.     29940006
299500*                                                                 29950006
299600*    PERFORMED BY E300-NAVIGATE.                                  29960006
299700*    PERFORMED BY G500-SCROLL-FORWARD.                            29970006
299800*    PERFORMED BY G600-SCROLL-BACKWARD.                           29980006
299900*    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                       29990006
300000*    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                    30000006
300100*    PERFORMED BY H100-READ-ITEMS-FROM-DB.                        30010006
300200******************************************************************30020006
300300                                                                  30030006
300400***  IF  ASC-HIGHEST-BLOCK-WRITTEN = +0                           30040006
300500***      MOVE EIBTASKN TO DP020-SRC-TASK-NUMBER                   30050006
300600***      MOVE EIBTASKN TO ASC-TASK-NUMBER                         30060006
300700***      MOVE EIBTRMID TO ASC-TERM-ID                             30070006
300800***      MOVE PC-SEQ-1 TO ASC-SEQ                                 30080006
300900***  END-IF.                                                      30090006
301000***                                                               30100006
301100***  MOVE ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB 1) TO                30110006
301200***       PV-LIST-ITEM-NUMBER.                                    30120006
301300***                                                               30130006
301400***  COMPUTE PV-BLOCK-NUMBER =                                    30140006
301500***      1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK).    30150006
301600***                                                               30160006
301700***  IF (PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN)             30170006
301800***                                                               30180006
301900***      COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       30190006
302000***           ASC-HIGHEST-BLOCK-WRITTEN + 1                       30200006
302100***                                                               30210006
302200***      IF PV-BLOCK-NUMBER = PV-HIGHEST-BLOCK-WRITTEN            30220006
302300***                                                               30230006
302400***          EXEC CICS                                            30240006
302500***              WRITEQ TS                                        30250006
302600***              QUEUE(ASC-TEMP-QUEUE-NAME)                       30260006
302700***              FROM(ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB))           30270006
302800***              LENGTH(PC-BLOCK-LENGTH)                          30280006
302900***              ITEM(PV-BLOCK-NUMBER)                            30290006
303000***              RESP(PV-RESP)                                    30300006
303100***          END-EXEC                                             30310006
303200***                                                               30320006
303300***          IF PV-RESP NOT = DFHRESP(NORMAL)                     30330006
303400***              MOVE PV-RESP TO PM-RESP-4                        30340006
303500***                                                               30350006
303600***              EXEC CICS                                        30360006
303700***                  DELETEQ TS                                   30370006
303800***                  QUEUE(ASC-TEMP-QUEUE-NAME)                   30380006
303900***                  RESP(PV-RESP)                                30390006
304000***              END-EXEC                                         30400006
304100***                                                               30410006
304200***              SET DP013-LOGIC-ABEND TO TRUE                    30420006
304300***              SET DP013-NO-ROLLBACK TO TRUE                    30430006
304400***                                                               30440006
304500***              MOVE 'Z150-WRITE-TEMP-STORAGE' TO                30450006
304600***                   DP013-PARAGRAPH                             30460006
304700***              MOVE PM-PROGRAM-MESSAGE-4      TO                30470006
304800***                   DP013-MESSAGE-TEXT(1)                       30480006
304900***                                                               30490006
305000***              PERFORM DP013-0000-PROCESS-ABEND                 30500006
305100***          ELSE                                                 30510006
305200***                                                               30520006
305300***              ADD 1 TO ASC-HIGHEST-BLOCK-WRITTEN               30530006
305400***                                                               30540006
305500***          END-IF                                               30550006
305600***      END-IF                                                   30560006
305700***  END-IF.                                                      30570006
305800                                                                  30580006
305900     IF ASC-HIGHEST-BLOCK-WRITTEN = +0                            30590006
306000         MOVE EIBTASKN TO DP020-SRC-TASK-NUMBER                   30600006
306100         MOVE EIBTASKN TO ASC-TASK-NUMBER                         30610006
306200         MOVE EIBTRMID TO ASC-TERM-ID                             30620006
306300         MOVE PC-SEQ-1 TO ASC-SEQ                                 30630006
306400     END-IF.                                                      30640006
306500                                                                  30650006
306600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLOCK-SUB 1) TO                30660006
306700          PV-LIST-ITEM-NUMBER.                                    30670006
306800                                                                  30680006
306900     COMPUTE PV-BLOCK-NUMBER =                                    30690006
307000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK).    30700006
307100                                                                  30710006
307200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN) OR          30720006
307300        (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             30730006
307400                                                                  30740006
307500         IF ASC-BLOCK-MODIFIED(ASC-BLOCK-SUB)                     30750006
307600                                                                  30760006
307700             EXEC CICS                                            30770006
307800                 WRITEQ TS                                        30780006
307900                 QUEUE(ASC-TEMP-QUEUE-NAME)                       30790006
308000                 FROM(ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB))           30800006
308100                 LENGTH(PC-BLOCK-LENGTH)                          30810006
308200                 ITEM(PV-BLOCK-NUMBER)                            30820006
308300                 REWRITE                                          30830006
308400                 RESP(PV-CICS-RESPONSE)                           30840006
308500             END-EXEC                                             30850006
308600                                                                  30860006
308700             IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)            30870006
308800                 SET DP013-LOGIC-ABEND TO TRUE                    30880006
308900                 SET DP013-NO-ROLLBACK TO TRUE                    30890006
309000                                                                  30900006
309100                 MOVE 'Z150-WRITE-TEMP-STORAGE' TO                30910006
309200                      DP013-PARAGRAPH                             30920006
309300                                                                  30930006
309400                 MOVE PM-PROGRAM-MESSAGE-6      TO                30940006
309500                      DP013-MESSAGE-TEXT(1)                       30950006
309600                                                                  30960006
309700                 PERFORM DP013-0000-PROCESS-ABEND                 30970006
309800             END-IF                                               30980006
309900                                                                  30990006
310000         END-IF                                                   31000006
310100                                                                  31010006
310200     ELSE                                                         31020006
310300                                                                  31030006
310400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       31040006
310500             ASC-HIGHEST-BLOCK-WRITTEN + 1                        31050006
310600                                                                  31060006
310700         IF PV-BLOCK-NUMBER = PV-HIGHEST-BLOCK-WRITTEN            31070006
310800                                                                  31080006
310900             EXEC CICS                                            31090006
311000                 WRITEQ TS                                        31100006
311100                 QUEUE(ASC-TEMP-QUEUE-NAME)                       31110006
311200                 FROM(ASC-BLOCK-ENTRIES(ASC-BLOCK-SUB))           31120006
311300                 LENGTH(PC-BLOCK-LENGTH)                          31130006
311400                 ITEM(PV-BLOCK-NUMBER)                            31140006
311500                 RESP(PV-CICS-RESPONSE)                           31150006
311600             END-EXEC                                             31160006
311700                                                                  31170006
311800             IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)            31180006
311900                 SET DP013-LOGIC-ABEND TO TRUE                    31190006
312000                 SET DP013-NO-ROLLBACK TO TRUE                    31200006
312100                                                                  31210006
312200                 MOVE 'Z500-WRITE-TEMP-STORAGE' TO                31220006
312300                      DP013-PARAGRAPH                             31230006
312400                                                                  31240006
312500                 MOVE PM-PROGRAM-MESSAGE-6      TO                31250006
312600                      DP013-MESSAGE-TEXT(1)                       31260006
312700                                                                  31270006
312800                 PERFORM DP013-0000-PROCESS-ABEND                 31280006
312900             END-IF                                               31290006
313000                                                                  31300006
313100             ADD +1 TO ASC-HIGHEST-BLOCK-WRITTEN                  31310006
313200         ELSE                                                     31320006
313300             SET DP013-LOGIC-ABEND TO TRUE                        31330006
313400             SET DP013-NO-ROLLBACK TO TRUE                        31340006
313500                                                                  31350006
313600             MOVE 'Z150-WRITE-TEMP-STORAGE' TO                    31360006
313700                  DP013-PARAGRAPH                                 31370006
313800                                                                  31380006
313900             MOVE PV-BLOCK-NUMBER           TO                    31390006
314000                  PM-BLOCK-NUMBER                                 31400006
314100                                                                  31410006
314200             MOVE PM-PROGRAM-MESSAGE-6      TO                    31420006
314300                  DP013-MESSAGE-TEXT(1)                           31430006
314400                                                                  31440006
314500             PERFORM DP013-0000-PROCESS-ABEND                     31450006
314600         END-IF                                                   31460006
314700                                                                  31470006
314800     END-IF.                                                      31480006
314900                                                                  31490006
315000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLOCK-SUB) TO TRUE.           31500006
315100 EJECT                                                            31510006
315200 Z175-READ-TEMP-STORAGE.                                          31520006
315300                                                                  31530006
315400******************************************************************31540006
315500*    READ A BLOCK FROM TEMPORARY STORAGE INTO WORKING STORAGE.    31550006
315600*                                                                 31560006
315700*    PERFORMED BY D200-CHECK-FUNCTION-KEY.                        31570006
315800*    PERFORMED BY E950-FIND-FIRST-SELECTED.                       31580006
315900******************************************************************31590006
316000                                                                  31600006
316100     EXEC CICS                                                    31610006
316200         READQ TS                                                 31620006
316300         QUEUE(ASC-TEMP-QUEUE-NAME)                               31630006
316400         INTO(PV-BLOCK)                                           31640006
316500         LENGTH(PC-BLOCK-LENGTH)                                  31650006
316600         ITEM(PV-BLOCK-NUMBER)                                    31660006
316700         RESP(PV-CICS-RESPONSE)                                   31670006
316800     END-EXEC.                                                    31680006
316900                                                                  31690006
317000     IF (PV-CICS-RESPONSE NOT = DFHRESP(NORMAL) AND               31700006
317100         PV-CICS-RESPONSE NOT = DFHRESP(ITEMERR))                 31710006
317200         SET DP013-LOGIC-ABEND TO TRUE                            31720006
317300         SET DP013-NO-ROLLBACK TO TRUE                            31730006
317400                                                                  31740006
317500         MOVE 'Z175-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         31750006
317600         MOVE PM-PROGRAM-MESSAGE-9     TO DP013-MESSAGE-TEXT(1)   31760006
317700                                                                  31770006
317800         PERFORM DP013-0000-PROCESS-ABEND                         31780006
317900     END-IF.                                                      31790006
318000 EJECT                                                            31800006
318100 Z200-OPEN-CONTROL-TAB-CURSOR.                                    31810006
318200                                                                  31820006
318300******************************************************************31830006
318400*    OPEN THE REPT-LINE-CURSOR.                                   31840006
318500*                                                                 31850006
318600*    PERFORMED BY H100-READ-ITEMS-FROM-DB.                        31860006
318700******************************************************************31870006
318800                                                                  31880006
318900                                                                  31890006
319000     EXEC SQL                                                     31900006
319100         OPEN CONTROL_TAB_CURSOR                                  31910006
319200     END-EXEC.                                                    31920006
319300                                                                  31930006
319400     EVALUATE TRUE                                                31940006
319500                                                                  31950006
319600         WHEN SQLCODE = +0                                        31960006
319700         WHEN SQLCODE = +100                                      31970006
319800             CONTINUE                                             31980006
319900                                                                  31990006
320000         WHEN OTHER                                               32000006
320100             SET DP013-DB2-ABEND   TO TRUE                        32010006
320200             SET DP013-NO-ROLLBACK TO TRUE                        32020006
320300                                                                  32030006
320400             MOVE 'Z200-OPEN-CONTROL-TAB-CURSOR' TO               32040006
320500                  DP013-PARAGRAPH                                 32050006
320600             MOVE SQLCODE                 TO                      32060006
320700                  PM-SQLCODE-1                                    32070006
320800             MOVE SQLCA                   TO                      32080006
320900                  DP013-SQLCA                                     32090006
321000             MOVE PM-PROGRAM-MESSAGE-1    TO                      32100006
321100                  DP013-MESSAGE-TEXT(1)                           32110006
321200                                                                  32120006
321300             PERFORM DP013-0000-PROCESS-ABEND                     32130006
321400                                                                  32140006
321500     END-EVALUATE.                                                32150006
321600 EJECT                                                            32160006
321700 Z450-FETCH-CONTROL-TAB-CURSOR.                                   32170006
321800                                                                  32180006
321900******************************************************************32190006
322000*    FETCH A ROW FROM THE TPPCCTL TABLE USING THE STORE NUMBER    32200006
322100*                                                                 32210006
322200*                                                                 32220006
322300*    PERFORMED BY H100-READ-ITEMS-FROM-DB                         32230006
322400******************************************************************32240006
322500                                                                  32250006
322600     EXEC SQL                                                     32260006
322700         FETCH CONTROL_TAB_CURSOR                                 32270006
322800             INTO   :PPCCTL-NBR,                                  32280006
322900                    :PPCCTL-PARM-AMT,                             32290006
323000                    :PPCCTL-DESC,                                 32300006
323100                    :PPCCTL-UPD-IND                               32310006
323200     END-EXEC.                                                    32320006
323300                                                                  32330006
323400     EVALUATE TRUE                                                32340006
323500                                                                  32350006
323600         WHEN SQLCODE = +0                                        32360006
323700             CONTINUE                                             32370006
323800         WHEN SQLCODE = +100                                      32380006
323900             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  32390006
324000                                                                  32400006
324100         WHEN OTHER                                               32410006
324200             SET DP013-DB2-ABEND   TO TRUE                        32420006
324300             SET DP013-NO-ROLLBACK TO TRUE                        32430006
324400                                                                  32440006
324500             MOVE 'Z450-FETCH-CONTROL-TAB-CURSOR' TO              32450006
324600                  DP013-PARAGRAPH                                 32460006
324700             MOVE SQLCODE                  TO                     32470006
324800                  PM-SQLCODE-2                                    32480006
324900             MOVE SQLCA                    TO                     32490006
325000                  DP013-SQLCA                                     32500006
325100             MOVE PM-PROGRAM-MESSAGE-2     TO                     32510006
325200                  DP013-MESSAGE-TEXT(1)                           32520006
325300                                                                  32530006
325400             PERFORM DP013-0000-PROCESS-ABEND                     32540006
325500                                                                  32550006
325600     END-EVALUATE.                                                32560006
325700 EJECT                                                            32570006
325800 EJECT                                                            32580006
325900 Z900-CLOSE-CONTROL-TAB-CURSOR.                                   32590006
326000                                                                  32600006
326100******************************************************************32610006
326200*    CLOSE THE RPT-LINE CURSOR.                                   32620006
326300*                                                                 32630006
326400*    PERFORMED BY H100-READ-ITEMS-FROM-DB.                        32640006
326500******************************************************************32650006
326600                                                                  32660006
326700     EXEC SQL                                                     32670006
326800         CLOSE CONTROL_TAB_CURSOR                                 32680006
326900     END-EXEC.                                                    32690006
327000                                                                  32700006
327100     EVALUATE TRUE                                                32710006
327200                                                                  32720006
327300         WHEN SQLCODE = +0                                        32730006
327400         WHEN SQLCODE = +100                                      32740006
327500             CONTINUE                                             32750006
327600                                                                  32760006
327700         WHEN OTHER                                               32770006
327800             SET DP013-DB2-ABEND   TO TRUE                        32780006
327900             SET DP013-NO-ROLLBACK TO TRUE                        32790006
328000                                                                  32800006
328100             MOVE 'Z900-CLOSE-CONTROL-TAB-CURSOR' TO              32810006
328200                  DP013-PARAGRAPH                                 32820006
328300             MOVE SQLCODE              TO                         32830006
328400                  PM-SQLCODE-3                                    32840006
328500             MOVE SQLCA                TO                         32850006
328600                  DP013-SQLCA                                     32860006
328700             MOVE PM-PROGRAM-MESSAGE-3 TO                         32870006
328800                  DP013-MESSAGE-TEXT(1)                           32880006
328900                                                                  32890006
329000             PERFORM DP013-0000-PROCESS-ABEND                     32900006
329100                                                                  32910006
329200     END-EVALUATE.                                                32920006
329300 EJECT                                                            32930006
329400******************************************************************32940006
329500*    FILL IN SCREEN HEADER MODULE                                 32950006
329600******************************************************************32960006
329700                                                                  32970006
329800     COPY DPPD022.                                                32980006
329900 EJECT                                                            32990006
330000******************************************************************33000006
330100*    RETURN TO CICS MODULE                                        33010006
330200******************************************************************33020006
330300                                                                  33030006
330400     COPY DPPD003.                                                33040006
330500 EJECT                                                            33050006
330600******************************************************************33060006
330700*    FORMAT MESSAGE LINES MODULE                                  33070006
330800******************************************************************33080006
330900                                                                  33090006
331000     COPY DPPD005.                                                33100006
331100 EJECT                                                            33110006
331200******************************************************************33120006
331300*    GET PANEL MODULE                                             33130006
331400******************************************************************33140006
331500                                                                  33150006
331600     COPY DPPD007.                                                33160006
331700 EJECT                                                            33170006
331800******************************************************************33180006
331900*    WRITE PANEL MODULE                                           33190006
332000******************************************************************33200006
332100                                                                  33210006
332200     COPY DPPD008.                                                33220006
332300 EJECT                                                            33230006
332400******************************************************************33240006
332500*    TOGGLE THE FUNCTION KEY LINE MODULE                          33250006
332600******************************************************************33260006
332700                                                                  33270006
332800     COPY DPPD009.                                                33280006
332900 EJECT                                                            33290006
333000******************************************************************33300006
333100*    ABEND PROCESSOR MODULE                                       33310006
333200******************************************************************33320006
333300                                                                  33330006
333400     COPY DPPD013.                                                33340006
333500 EJECT                                                            33350006
333600******************************************************************33360006
333700*    CHECK COMMUNICATION AREA MODULE                              33370006
333800******************************************************************33380006
333900                                                                  33390006
334000     COPY DPPD015.                                                33400006
334100 EJECT                                                            33410006
334200******************************************************************33420006
334300*    UPDATE TIME AND DATE MODULE                                  33430006
334400******************************************************************33440006
334500                                                                  33450006
334600     COPY DPPD017.                                                33460006
334700*                                                                 33470006
334800                                                                  33480006
334900*                                                                 33490006
