000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SAKUT016.                                00050000
000600 AUTHOR.                 JIM HUNTER.                              00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            10-30-2006.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200** THIS IS AN AUDIT VERSION OF SAKUT006:                        **00120000
001300**   ALL DB2 AND CTLCD UPDATES HAVE BEEN REMOVED.               **00130000
001400**   PROCESSING IS LIMITED TO THE INPUT CTLCD PARAMETERS:       **00140000
001500**    - START AND END DATES (CAN BE THE SAME) SPECIFIED IN THE  **00150000
001600**      CTLCD (NO EDITTING IS PERFORMED - THEY MUST BE STANDARD **00160000
001700**      DB2 FORMAT - YYYY-MM-DD)                                **00170000
001800**    - THE FISCAL END OF WEEK IN THE SYSIN CTLCD IS STILL      **00180000
001900**      EDITTED AND MOVED TO THE OUTPUT FILE EFFECTIVE DATE,    **00190000
002000**      BUT IT'S USE IN THE CURSORS HAS BEEN REPLACED BY THE    **00200000
002100**      START AND END DATES SPECIFIED IN THE INPUT CTLCD.       **00210000
002200******************************************************************00220000
002300******************************************************************00230000
002400*  THIS PROGRAM CREATES THE COSA GENERAL LEDGER FILE.            *00240000
002500*                                                                *00250000
002600*  AN EMAIL IS CREATED TO SEND, WHICH PROVIDES THE AMOUNT OF     *00260000
002700*  DEBITS AND CREDITS.                                           *00270000
002800*                                                                *00280000
002900******************************************************************00290000
003000*  CHANGED 9/06/2001   BY GAYLE HAUPT   WR# 21811                 00300000
003100*                                                                 00310000
003200*  AUTO POST GL PROJECT--INTRODUCED NEW CATEGORY CODES THAT NEED  00320000
003300*  TO BE POSTED TO THE GENERAL LEDGER.                            00330000
003400*  ECR - E-COMMERCE RETURNS        KKT - KCK GIFT CARDS TENDERED  00340000
003500*  GWR - GIFT WRAPPING RETURNS     MAN - MANIFESTO TAX RETURNS    00350000
003600*  GWS - GIFT WRAPPING SALES       PTG - POSTAGE SALES            00360000
003700*  KKB - KCK BACK TO SCHOOL        SPN - SCANNING PENALTY         00370000
003800*  KKH - KCK HOLIDAY SALES         SHR - SHIPPING RETURNS         00380000
003900*  KKS - KCK SPRING SALES          SHS - SHIPPING SALES           00390000
003910*  BRC - BREAST CANCER AWARENESS SALES                            00400000
003920******************************************************************00410000
003930*  CHANGED 12/12/2001   BY GAYLE HAUPT   WR# 23086                00420000
003940*                                                                 00430000
003950*  INCLUDED DEBIT CARD (DBN) CATEGORY CODE IN THE TSAADSU SELECT  00440000
003960*  STATEMENT FOR DEBIT CARD PROJECT.                              00450000
003970******************************************************************00460000
003980*  CHANGED 04/30/2002   BY GAYLE HAUPT   PITS #PM00462537         00470000
003990*                                                                 00480000
004000*  CHANGED TSASUM-CSR TO USE REGISTER ROWS <> ZERO.  SALES        00490000
004100*  CORRECTIONS PUT THROUGH THE SAME DAY THE GL FILE WAS CREATED   00500000
004200*  WERE NOT BEING PICKED UP WHEN USING THE ZERO REGISTER ROWS.    00510000
004300******************************************************************00520000
004400*  CHANGED 05/08/2002   BY GAYLE HAUPT   PITS #PM00462537         00530000
004500*                                                                 00540000
004600*  ADDED ZEROROW-CSR TO PICK UP ZERO REGISTER ROWS.  CATEGORIES   00550000
004700*  KKS, KKT, KKB, KKH, MAN, PTG, SPN WERE NOT BEING PICKED UP AS  00560000
004800*  A RESULT OF THE 04/30/2002 CHANGE.                             00570000
004900******************************************************************00580000
005000*  CHANGED 08/01/2002   BY GAYLE HAUPT   PITS #PM00479457         00590000
005100*                                                                 00600000
005200*  ADDED TEPPART TABLE TO TSASUM-CSR AND ZEROROW-CSR.  THIS WILL  00610000
005300*  PREVENT DATA FROM PARTITIONS 1-4 (TEMPORARY PARTITIONS) FROM   00620000
005400*  BEING ADDED IN THE WEEKLY TOTALS.  CURSORS WILL ONLY RETRIEVE  00630000
005500*  DATA FROM PARTITIONS WITH A STR_GP_CDE OF 'A'.                 00640000
005600******************************************************************00650000
005700******************************************************************00660000
005800*  CHANGED 12/19/2005   BY SCOTT BARTELT   WR #29912              00670000
005900*                                                                 00680000
006000*  STARTING FISCAL 2006 (1/29/2006), EMPLOYEE DISCOUNTS WILL BE   00690000
006100*  REPORTED AS A MARKDOWN INSTEAD OF AN EXPENSE.  THEREFORE, THIS 00700000
006200*  PROGRAM IS BEING CHANGED TO NO LONGER SEND THE DISCOUNT        00710000
006300*  EXPENSE TO GENERAL LEDGER.                                     00720000
006400******************************************************************00730000
006500******************************************************************00740000
006600*  CHANGED 03/05/2008   BY THOMAS HANSON   WR #33714              00750000
006700*                                                                 00760000
006800*  ADDED 'TPC' AND 'TCC' TO GL FILE WRITES AS PART OF BLACKHAWK.  00770000
006900*  THIRD PARTY GIFT CARD SALES.  TPC = THIRD PARTY CARDS SOLD     00780000
007000*                                TCC = THIRD PARTY COMMISSIONS    00790000
007100******************************************************************00800000
007200*  CHANGED 05/18/2008   BY DAN PAYNTER     INC000000367880        00810000
007210*                                                                 00820000
007220*  ALLOW FOR POSSIBILITY OF NO THIRD PARTY CARD TOTALS ON TSASUM. 00830000
007230******************************************************************00840000
007240*  CHANGED 08/24/2010   BY CHERI PARMLEY   WR38834                00850000
007250*                                                                 00860000
007260*  ADDED 'BRC' TO GL FILES WRITES - BREAST CANCER AWARENESS SALES 00870000
007270******************************************************************00880000
007271*  CHANGED 07/27/2011   BY JACKIE HELING   WR39649                00890000
007273*  REMOVE HARDCODING FRO LOCATION 873                             00900000
007274******************************************************************00910000
007275*  CHANGED 11/05/2012   BY SARVESWARAN NSK INC000002411695        00920000
007276*  ADDED INVALID STR NBR CHECK FOR TSAADDP AND TSAADSU TABLE.     00930000
007277*  FIND 'INCFIX' TAG FOR THE CHANGES.                             00940000
007278******************************************************************00950000
007279*  CHANGED 07/30/2013   BY DAVID WELLER    CHG 53632              00960000
007280*  INCLUDE NEW CATEGORY 'SFS' FOR SHIP FROM STORE SALES           00970000
007281******************************************************************00980000
8446E *  CHANGED 02/13/2014   BY BARB SCHULTZ    CHG 8446E              00990000
8446E *  INCLUDE NEW CATEGORY 'BPS' FOR BUY ONLINE PICKUP FROM STORE    01000000
8446E *                                (BOPUS)                          01010000
007281******************************************************************01020000
P8612 *  CHANGED 09/05/2014   BY COGNIZANT       CHG0092405             01030000
P8612 *  INCLUDE NEW CODES 'WFC' AND 'WRC' TO WRITE THAT IN GL FILE     01040000
P8612 *                                (Market Places)                  01050000
P10530******************************************************************01060000
P10530*  CHANGED 02/20/2015   BY BARB SCHULTZ    CHG0105300             01070000
P10530*  CHANGED THE DUE TO WAYFAIR LOGIC BY REARRANGING THE IF         01080000
P10530*  STATEMENT. ALSO CHANGED WRC TO MOVE THE AMOUNT INSTEAD OF      01090000
P10530*  SUBTRACTING IT.                                                01100000
007210******************************************************************01110000
STCFEE*  CHANGE CHG0160001 - FIND 'STCFEE'                              01120000
STCFEE*  CHANGED 10/20/2016   BY JIM HUNTER                             01130000
STCFEE*  ADD 'FEE' CATEGORY FOR SALES TAX COMPLIANCE                    01140000
STCFEE*  INCLUDE 'AFE' FEE ADJUSTMENTS CATEGORY IN FEE CALCULATION.     01150000
STCFEE******************************************************************01160000
BOSS  *  CHANGED 01/23/2018   BY BARB SCHULTZ    CHG0188487             01161001
BOSS  *  INCLUDE NEW CATEGORY 'BOS' FOR BUY ONLINE SHIP TO STORE.       01162000
BOSS  *  ADDED 'BSR' AND 'BPR' FOR BOSS AND BOPUS RETURNS.              01162202
12386a******************************************************************01162305
12386a*  CHANGED 12/03/2018   BY COGNIZANT                              01162405
12386a*  INCLUDE NEW CATEGORY 'DON' FOR CHARITABLE DONATIONS AND        01162509
12386a*  OFFSETTING CREDIT TO STM.                                      01162605
255393******************************************************************01162711
255393*  CHANGED 03/26/2021   BY Jim Hunter       CHG0255393            01162811
255393*  Add new Sephora categories (TSAADSU TABLE / SAWS006 COPYBOOK)  01162911
255393*  'SCN' - SEPHORA CHARGE NET        (SA006-SEPHORA-CHARGE)       01163011
255393*  'SGS' - SEPHORA GIFT CARD SALES   (SA006-SEPHORA-GC-SALES)     01163111
255393*  'SGT' - SEPHORA GIFT CARD TENDERS (SA006-SEPHORA-GC-TENDERED)  01163211
255393******************************************************************01163311
MKTPLC*  ChANGED 02/07/2022   BY Jim Hunter   CHG0267963                01163417
MKTPLC*  Add new MARKETPLACE categories (TSASUM / SAWS006 COPYBOOK)     01163512
MKTPLC*  for the long-term Sales Hub solution.  The short term SAK131   01163614
MKTPLC*  solution will not requires changes to this program.            01163714
MKTPLC*  'MSS' - Marketplace Seller Sale                                01163814
MKTPLC*  'MSR' - Marketplace Seller Return                              01163914
MKTPLC*  'MCS' - Marketplace Commissions Sale                           01164014
MKTPLC*  'MCR' - Marketplace Commissions Return                         01164114
MKTPLC*  'MMS' - Marketplace Mirakl Sale                                01164214
MKTPLC*  'MMR' - Marketplace Mirakl Return                              01164314
MKTPLC*                                                                 01164414
MKTPLC*  Also, remove the Sephora Gift Card categories.  They will not  01164514
MKTPLC*  be on TSAADSU (except for being included in the Kohl's Gift    01164614
MKTPLC*  Card categories) and Rob does not want them broken out here.   01164714
MKTPLC******************************************************************01164814
MKTPL2*  CHANGED 07/13/2022   BY Jim Hunter   CHG0272489                01164923
MKTPL2*  Remove Marketplace categories MMS and MMR as well as the old   01165018
MKTPL2*  Wayfair categories DWF, WFC and WRC which are all obsolete.    01165118
MKTPL2*  Also, KEEP the subtraction of the marketplace categories       01165222
MKTPL2*  from the sales and returns categories as the Sales Hub         01165322
MKTPL2*  will STILL be including them in those categories.              01165422
007290******************************************************************01165600
ZX    *  CHANGED 07/17/2022   BY DAN PAYNTER  CHG0272489                01165723
ZX    *  FIX ISSUE IGNORING LATES FOR THE TCC (THIRD PARTY GIFT CARD    01165820
ZX    *  COMMISSIONS)                                                   01165920
ZX    ******************************************************************01166120
TPCFIX*  CHANGED 11/30/2022   BY JIM HUNTER    CHG0278871               01166225
TPCFIX*  POC AND THE SALES HUB ADD SEPHORA GIFT CARD DOLLARS INTO THE   01166324
TPCFIX*  TSAADSU AND TSASUM TPC BUCKETS AND THEY NEED TO BE SUBTRACTED  01166424
TPCFIX*  OUT BEFORE THE THIRD PARTY CARD NUMBERS GO TO GL.              01166524
TPCFIX*  THE ORIGINAL SEPHORA CHANGES PUT INTO SAKUT006 WERE NOT        01166624
TPCFIX*  PUT IN SAKUT016 BECAUSE THE SALES AUDIT TEAM DID NOT USE THEM  01166724
TPCFIX*  TO BALANCE.  THEY ARE BEING ADDED NOW TO SUPPORT THE TPCFIX    01166824
TPCFIX*  CHANGES, ALONG WITH THE STRFNT CHANGES BLOCKING STORE 6666.    01166924
TPCFIX******************************************************************01167324
COBRND*  CHANGED 02/27/2023   BY JIM HUNTER    CHG0286246               01167430
COBRND*  THESE CHANGES ARE FOR THE NEW COBRAND VISA CHARGE CARDS.       01167526
COBRND*  2 NEW CATEGORIES WILL BE NEEDED FOR GL:                        01167626
COBRND*  COBRAND VISA NET (CVN)                                         01167726
COBRND*  COBRAND VISA Payments (CVP)                                    01167826
COBRND*  THEY WILL COME FROM THE TSASUM TABLE.                          01167926
COBRND*  IN THE TSAADSU CASH OFFICE TABLE THEY WILL BE INCLUDED IN THE  01168026
COBRND*  BCN (BANK CARD NET) AND KCP (KOHL'S CHARGE PAYMENTS)           01168126
COBRND*  CATEGORIES.                                                    01168226
COBRND*  CVN WILL BE SUBTRACTED FROM BCN BEFORE THEY ARE SENT TO GL.    01168326
COBRND*  CVP WILL BE SUBTRACTED FROM KCP BEFORE THEY ARE SENT TO GL.    01168426
COBRND******************************************************************01168526
PAYVEN*  CHANGED 08/23/2023   BY JIM HUNTER    CHG0289055               01170843
PAYVEN*  THESE CHANGES ARE FOR THE NEW PAYPAL AND VENMO CARDS.          01170940
PAYVEN*  2 NEW CATEGORIES WILL BE NEEDED FOR GL:                        01171040
PAYVEN*  PAYPAL NET (PPN)                                               01171140
PAYVEN*  VENMO NET (vmn)                                                01171240
PAYVEN******************************************************************01171340
COBTRL*  CHANGED 10/23/2023   BY JIM HUNTER    CHG0295722               01171443
COBTRL*  ADDING LOGIC TO ADJUST CATEGORIES FOR COBRAND TRAILING         01171543
COBTRL*  TRANSACTIONS.  THESE TRANSACTIONS ARE THOSE MADE AGAINST       01171643
COBTRL*  KOHL'S CHARGE ACCOUNTS FOR CUSTOMERS WHO NOW HAVE COBRAND      01171743
COBTRL*  ACCOUNTS INSTEAD.                                              01171843
COBTRL*  THEY WILL COME FROM THE TSASUM TABLE, REGISTER ZERO, CATEGORIES01171943
COBTRL*  TTN (COBRAND TRAILING NET) AND TTP (COBRAND TRAILING PAYMENTS).01172043
COBTRL*  TTN WILL BE SUBTRACTED FROM KCN BEFORE KCN IS SENT TO GL.      01172143
COBTRL*  TTN WILL BE ADDED TO CVN BEFORE CVN IS SENT TO GL.             01172243
COBTRL*  TTP WILL BE SUBTRACTED FROM KCP BEFORE KCP IS SENT TO GL.      01172343
COBTRL*  TTP WILL BE ADDED TO CVP BEFORE CVP IS SENT TO GL.             01172443
COBTR2*  ADDED LOGIC TO DETERMINE IF THERE ARE COBRAND TRAILING         01172543
COBTR2*  TRANSACTIONS (TTN OR TTP) THAT WEREN'T PICKED UP IN THE TSASUM 01172643
COBTR2** PARAGRAPH BECAUSE THE STORE HAD NO COBRAND SALES (CVN) OR      01172743
COBTR2** PAYMENTS (CVP) FOR THE WEEK.                                   01172843
COBTR2** THE KCN AND KCP PARAGRAPHS WOULD THEN READ THE TRAILING TRANS, 01172943
COBTR2** CREATE THE CVN OR CVP GL RECORDS AND INCREMENT THE             01173043
COBTR2** KCN OR KCP GL RECORDS.                                         01173143
COBTRF** NEEDED TO INCREMENT A SIGNED FIELD AND THEN MOVE IT TO         01173243
COBTRF** GL002-MONETARY-AMT, WHICH ISN'T SIGNED, TO AVOID A PROBLEM     01173343
COBTRF** WHEN IT IS NEGATIVE.                                           01173443
COBTRL******************************************************************01173543
012300                                                                  01173640
007300 ENVIRONMENT DIVISION.                                            01173724
007400******************************************************************01173824
007500                                                                  01173900
007600 CONFIGURATION SECTION.                                           01174000
007700                                                                  01175000
007800 SOURCE-COMPUTER.        IBM-3090.                                01180000
007900 OBJECT-COMPUTER.        IBM-3090.                                01190000
008000                                                                  01200000
008100 INPUT-OUTPUT SECTION.                                            01210000
008200                                                                  01220000
008300 FILE-CONTROL.                                                    01230000
008400                                                                  01240000
008500     SELECT DATE-RANGE-FILE                                       01250000
008600         ASSIGN TO INP01.                                         01260000
008700                                                                  01270000
008800     SELECT GENERAL-LEDGER-FILE                                   01280000
008900         ASSIGN TO OUT01.                                         01290000
009000                                                                  01300000
009100     SELECT EMAIL-FILE                                            01310000
009200         ASSIGN TO OUT02.                                         01320000
009300                                                                  01330000
009400******************************************************************01340000
009500 DATA DIVISION.                                                   01350000
009600******************************************************************01360000
009700                                                                  01370000
009800 FILE SECTION.                                                    01380000
009900                                                                  01390000
010000 FD  DATE-RANGE-FILE                                              01400000
010100     RECORDING MODE IS F                                          01410000
010200     BLOCK CONTAINS 0 RECORDS                                     01420000
010300     LABEL RECORDS ARE STANDARD.                                  01430000
010400                                                                  01440000
010500 01  DATE-RANGE-RECORD           PIC X(80).                       01450000
010600                                                                  01460000
010700 FD  GENERAL-LEDGER-FILE                                          01470000
010800     RECORDING MODE IS F                                          01480000
010900     LABEL RECORDS ARE STANDARD                                   01490000
011000     BLOCK CONTAINS 0 RECORDS.                                    01500000
011100                                                                  01510000
011200 01  GENERAL-LEDGER-RECORD       PIC X(180).                      01520000
011300                                                                  01530000
011400 FD  EMAIL-FILE                                                   01540000
011500     RECORDING MODE IS F                                          01550000
011600     LABEL RECORDS ARE STANDARD                                   01560000
011700     BLOCK CONTAINS 0 RECORDS.                                    01570000
011800                                                                  01580000
011900 01  EMAIL-RECORD                PIC X(80).                       01590000
012000                                                                  01600000
012100 WORKING-STORAGE SECTION.                                         01610000
012200                                                                  01620000
012300*                                                                 01630000
012400*  GENERAL LEDGER OUTPUT FILE                                     01640000
012500*                                                                 01650000
012600                                                                  01660000
012700     COPY GLRD002.                                                01670000
012800                                                                  01680000
012900                                                                  01690000
013000 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         01700000
013100                                 COMP SYNC.                       01710000
013200     88  ABEND-4003-CC-ERROR                       VALUE +4003.   01720000
013300     88  ABEND-4013-DB2-ERROR                      VALUE +4013.   01730000
013400     88  ABEND-4019-CAL-ERROR                      VALUE +4019.   01740000
013410     88  ABEND-4020-DATA-ERROR                     VALUE +4020.   01750000
013500                                                                  01760000
013600 01  DK-DB2-KEYS.                                                 01770000
013700     05  DK-BEGIN-DATE-ISO       PIC X(10)    VALUE SPACES.       01780000
013800     05  DK-END-DATE-ISO         PIC X(10)    VALUE SPACES.       01790000
013900     05  DK-BEGIN-PARTITION      PIC S9(04)   COMP                01800000
014000                                              VALUE ZERO.         01810000
014100     05  DK-END-PARTITION        PIC S9(04)   COMP                01820000
014200                                              VALUE ZERO.         01830000
014300                                                                  01840000
014400 01  PS-PROGRAM-SWITCHES.                                         01850000
014500     05  PS-END-OF-CURSOR-SW     PIC X(01)    VALUE 'N'.          01860000
014600         88  PS-END-OF-CURSOR                 VALUE 'Y'.          01870000
014700         88  PS-NOT-END-OF-CURSOR             VALUE 'N'.          01880000
014800     05  PS-FIRST-TIME-THRU-SW   PIC X(01)    VALUE 'N'.          01890000
014900         88  PS-FIRST-TIME-THRU-YES           VALUE 'Y'.          01900000
015000         88  PS-FIRST-TIME-THRU-NO            VALUE 'N'.          01910000
015100     05  PS-SCAN-PENALTY-SW      PIC X(01)    VALUE 'N'.          01920000
015200         88  PS-SCAN-PENALTY-YES              VALUE 'Y'.          01930000
015300         88  PS-SCAN-PENALTY-NO               VALUE 'N'.          01940000
015400                                                                  01950000
015500 01  PC-PROGRAM-CONSTANTS.                                        01960000
015600     05  PC-CURRENT-PROGRAM-NAME PIC X(08)    VALUE 'SAKUT016'.   01970000
015700     05  PC-BUSINESS-UNIT        PIC X(03)    VALUE 'KDS'.        01980000
015800     05  PC-OPERATIONAL-TABLES   PIC X(01)    VALUE 'O'.          01990000
015900     05  PC-STORE-GROUP-CODE     PIC X(01)    VALUE 'A'.          02000000
016100     05  PC-CASH-CHECK-DEPOSIT   PIC X(03)    VALUE 'CCD'.        02010000
016200     05  PC-REGISTER-OVER-SHORT-MSG PIC X(20)                     02020000
016300                     VALUE 'RGSTR (OVR)SHORT WE:'.                02030000
016400     05  PC-SAFE-OVER-SHORT-MSG     PIC X(20)                     02040000
016500                     VALUE 'SAFE (OVR) SHORT WE:'.                02050000
016600     05  PC-SUM-CTG-CDE          PIC  X(03).                      02060000
016700         88  PC-SUM-CTG-CDE-SHS               VALUE 'SHS'.        02070000
016800         88  PC-SUM-CTG-CDE-SHR               VALUE 'SHR'.        02080000
016900         88  PC-SUM-CTG-CDE-GWS               VALUE 'GWS'.        02090000
017000         88  PC-SUM-CTG-CDE-GWR               VALUE 'GWR'.        02100000
017100         88  PC-SUM-CTG-CDE-ECR               VALUE 'ECR'.        02110000
017200         88  PC-SUM-CTG-CDE-KKB               VALUE 'KKB'.        02120000
017300         88  PC-SUM-CTG-CDE-BRC               VALUE 'BRC'.        02130000
017400         88  PC-SUM-CTG-CDE-KKH               VALUE 'KKH'.        02140000
017500         88  PC-SUM-CTG-CDE-KKU               VALUE 'KKU'.        02150000
017600         88  PC-SUM-CTG-CDE-KKS               VALUE 'KKS'.        02160000
017700         88  PC-SUM-CTG-CDE-KKT               VALUE 'KKT'.        02170000
017800         88  PC-SUM-CTG-CDE-MAN               VALUE 'MAN'.        02180000
017900         88  PC-SUM-CTG-CDE-PTG               VALUE 'PTG'.        02190000
017910         88  PC-SUM-CTG-CDE-SFS               VALUE 'SFS'.        02200000
018000         88  PC-SUM-CTG-CDE-SPN               VALUE 'SPN'.        02210000
8446E          88  PC-SUM-CTG-CDE-BPS               VALUE 'BPS'.        02220000
STCFEE         88  PC-SUM-CTG-CDE-FEE               VALUE 'FEE'.        02260000
STCFEE         88  PC-SUM-CTG-CDE-AFE               VALUE 'AFE'.        02270000
BOSS           88  PC-SUM-CTG-CDE-BOS               VALUE 'BOS'.        02280000
BOSS           88  PC-SUM-CTG-CDE-BSR               VALUE 'BSR'.        02281000
BOSS           88  PC-SUM-CTG-CDE-BPR               VALUE 'BPR'.        02282000
12386a         88  PC-SUM-CTG-CDE-DON               VALUE 'DON'.        02283005
MKTPLC         88  PC-SUM-CTG-CDE-MSS               VALUE 'MSS'.        02284012
MKTPLC         88  PC-SUM-CTG-CDE-MSR               VALUE 'MSR'.        02285012
MKTPLC         88  PC-SUM-CTG-CDE-MCS               VALUE 'MCS'.        02286012
MKTPLC         88  PC-SUM-CTG-CDE-MCR               VALUE 'MCR'.        02287012
MKTPL2*        88  PC-SUM-CTG-CDE-MMS               VALUE 'MMS'.        02288019
MKTPL2*        88  PC-SUM-CTG-CDE-MMR               VALUE 'MMR'.        02289019
SEPHOR         88  PC-SUM-CTG-CDE-SGS               VALUE 'SGS'.        02289124
SEPHOR         88  PC-SUM-CTG-CDE-SGT               VALUE 'SGT'.        02289224
COBRND         88  PC-SUM-CTG-CDE-CVN               VALUE 'CVN'.        02289326
COBRND         88  PC-SUM-CTG-CDE-CVP               VALUE 'CVP'.        02289426
018100                                                                  02290000
018200 01  PT-PROGRAM-TOTALS.                                           02300000
018300     05  PT-DEBITS               PIC S9(11)V99  VALUE ZEROS       02310000
018400                                 COMP-3.                          02320000
018500     05  PT-CREDITS              PIC S9(11)V99  VALUE ZEROS       02330000
018600                                 COMP-3.                          02340000
018700     05  PT-GL-RECORDS-WRITTEN   PIC S9(11)   VALUE ZEROS         02350000
018800                                 COMP-3.                          02360000
018900                                                                  02370000
019000 01  PV-PROGRAM-VARIABLES.                                        02380000
019100     05  PV-DB2-FUNCTION         PIC X(30)    VALUE SPACES.       02390000
019200     05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACES.       02400000
019300     05  PV-STORE-NUMBER-X.                                       02410000
019400         10  PV-STORE-NUMBER     PIC 9(04).                       02420000
019500     05  PV-STORE-BALANCE        PIC 9(04).                       02430000
019600     05  PV-DEBIT-HOLD-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO. 02440000
019700     05  PV-DISP-CTG-AMT         PIC  9(13)V99        VALUE ZERO. 02450000
COBTR2     05  PV-TBL-STORE            PIC S9(04)  COMP  VALUE ZEROES.  02451037
019700     05  PV-SUM-CTG-AMT          PIC S9(13)V99                    02460000
019800                                              COMP-3 VALUE ZERO.  02470000
COBTRL     05  PV-TTN-ADJUSTMENTS      PIC S9(9)V99 COMP-3 VALUE ZERO.  02471032
COBTRL     05  PV-TTP-ADJUSTMENTS      PIC S9(9)V99 COMP-3 VALUE ZERO.  02472032
COBTR2     05  PV-TRAIL-AMOUNT         PIC ---,---,--9.99  VALUE ZERO.  02472137
COBTRL     05  PV-TTN-TOTAL            PIC S9(9)V99 COMP-3 VALUE ZERO.  02473033
COBTRL     05  PV-TTP-TOTAL            PIC S9(9)V99 COMP-3 VALUE ZERO.  02474033
STCFEE     05  PV-FEE-ADJUSTMENTS      PIC S9(9)V99 COMP-3 VALUE ZERO.  02480000
019900     05  PV-HOLD-GL-AMT          PIC S9(13)V99                    02490000
020000                                              COMP-3 VALUE ZERO.  02500000
020100     05  PV-COMMISSIONS-AMT      PIC S9(13)V99                    02510000
020110                                              COMP-3 VALUE ZERO.  02520000
020120     05  PV-TBL-SUB              PIC S9(05)   COMP VALUE ZERO.    02530000
020130     05  PV-SUB                  PIC S9(05)   COMP VALUE ZERO.    02540000
020140     05  PV-CURRENT-DATE.                                         02550000
020150         10  PV-CURRENT-CCYY     PIC X(04).                       02560000
020160         10  PV-CURRENT-MM       PIC X(02).                       02570000
020170         10  PV-CURRENT-DD       PIC X(02).                       02580000
020180     05  PV-CURRENT-DATE-ISO.                                     02590000
020190         10  PV-CURRENT-CCYY-ISO PIC X(04).                       02600000
020200         10  FILLER              PIC X(01)    VALUE '-'.          02610000
020300         10  PV-CURRENT-MM-ISO   PIC X(02).                       02620000
020400         10  FILLER              PIC X(01)    VALUE '-'.          02630000
020500         10  PV-CURRENT-DD-ISO   PIC X(02).                       02640000
020600     05  PV-STORE-DEBIT-CREDIT-DIFF PIC S9(11)V99 COMP-3 VALUE 0. 02650000
020700     05  PV-DISPLAY-DIFF            PIC -(10)9.99.                02660000
020800     05  PV-SUM-TPC-NULL-IND        PIC S9(4) COMP VALUE +0.      02670000
020900                                                                  02680000
021000**  THE PV-HOLD-AMTS-TABLE WILL HOLD AMOUNTS THAT ACCUMULATE      02690000
021100**  AS A RESULT OF THE NEW CATEGORIES FROM THE AUTO POST GL       02700000
021200**  PROJCT.  THE ACCUMULATED AMOUNTS WILL BE ADDED/SUBTRACTED     02710000
021300**  FROM THE VARIOUS DEBIT/CREDIT AMOUNTS FOR THE CATEGORIES      02720000
021400**  LISTED IN THE TABLE.                                          02730000
021500 01  PV-HOLD-AMTS-TABLE.                                          02740000
021600     05  PV-HOLD-AMTS-TBL        OCCURS 9999 TIMES.               02750000
021700         10  PV-HOLD-STM-AMT     PIC S9(11)V99 COMP-3.            02760000
021800         10  PV-HOLD-TMR-AMT     PIC S9(11)V99 COMP-3.            02770000
TPCFIX         10  PV-HOLD-TPC-AMT     PIC S9(13)V99 COMP-3.            02771024
021900         10  PV-HOLD-GDT-AMT     PIC S9(11)V99 COMP-3.            02780000
022000         10  PV-HOLD-SSE-AMT     PIC S9(11)V99 COMP-3.            02790000
COBRND         10  PV-HOLD-BCN-AMT     PIC S9(13)V99 COMP-3.            02800026
COBRND         10  PV-HOLD-KCP-AMT     PIC S9(13)V99 COMP-3.            02810026
COBTRL         10  PV-HOLD-KCN-AMT     PIC S9(13)V99 COMP-3.            02820031
022100         10  PV-STORE-DEBITS     PIC S9(11)V99 COMP-3.            02830000
022200         10  PV-STORE-CREDITS    PIC S9(11)V99 COMP-3.            02840000
COBTR2         10  PV-HOLD-CVN-FOUND   PIC X.                           02841037
COBTR2         10  PV-HOLD-CVP-FOUND   PIC X.                           02842037
022300                                                                  02850000
022400                                                                  02860000
022500 01  CC-CONTROL-CARD.                                             02870000
022600     05  CC-CONTROL-CARD-DISPLAY.                                 02880000
022700         10  CC-START-DATE       PIC X(10)    VALUE SPACES.       02890000
022800         10  FILLER              PIC X        VALUE SPACE.        02900000
022900         10  CC-END-DATE         PIC X(10)    VALUE SPACES.       02910000
023000         10  FILLER              PIC X(59)    VALUE SPACE.        02920000
023100                                                                  02930000
023200 01  DATE-CONTROL-CARD.                                           02940000
023300     05  CC-WEEK-ENDING-DATE-ISO.                                 02950000
023400         10  CC-WEEK-ENDING-CC   PIC X(02).                       02960000
023500         10  CC-WEEK-ENDING-YY   PIC X(02).                       02970000
023600         10  FILLER              PIC X(01).                       02980000
023700         10  CC-WEEK-ENDING-MM   PIC X(02).                       02990000
023800         10  FILLER              PIC X(01).                       03000000
023900         10  CC-WEEK-ENDING-DD   PIC X(02).                       03010000
024000     05  FILLER                  PIC X(70).                       03020000
024100                                                                  03030000
024200 01  TD-TOTAL-DISPLAY-MESSAGE.                                    03040000
024300     05  TD-TOTAL-ID             PIC X(45)    VALUE SPACES.       03050000
024400         88  TD-DEBITS                        VALUE               03060000
024500             'DEBITS . . . . . . . . . . . . . . . . . . . '.     03070000
024600         88  TD-CREDITS                       VALUE               03080000
024700             'CREDITS. . . . . . . . . . . . . . . . . . . '.     03090000
024800         88  TD-GL-RECORDS-WRITTEN            VALUE               03100000
024900             'GL RECORDS WRITTEN . . . . . . . . . . . . . '.     03110000
025000     05  TD-TOTAL-AMOUNT         PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ            03120000
025100                                              VALUE ZEROS.        03130000
025200                                                                  03140000
025300 01  EM-EMAIL-LINE1.                                              03150000
025400     05  FILLER                  PIC X(50)    VALUE               03160000
025500         'General Ledger file was successfully created for: '.    03170000
025600     05  EM-LINE1-DATE           PIC X(10)    VALUE SPACES.       03180000
025700     05  FILLER                  PIC X(14)    VALUE SPACES.       03190000
025800     05  FILLER                  PIC X(06)    VALUE SPACES.       03200000
025900                                                                  03210000
026000 01  EM-EMAIL-LINE2A.                                             03220000
026100     05  FILLER                  PIC X(41)    VALUE               03230000
026200         'General Ledger file was NOT created for: '.             03240000
026300     05  EM-LINE2A-DATE          PIC X(10)    VALUE SPACES.       03250000
026400     05  FILLER                  PIC X(23)    VALUE SPACES.       03260000
026500     05  FILLER                  PIC X(06)    VALUE SPACES.       03270000
026600                                                                  03280000
026700 01  EM-EMAIL-LINE2B.                                             03290000
026800     05  FILLER                  PIC X(33)    VALUE               03300000
026900         'DEBITS AND CREDITS ARE NOT EQUAL.'.                     03310000
027000     05  FILLER                  PIC X(41)    VALUE SPACES.       03320000
027100     05  FILLER                  PIC X(06)    VALUE SPACES.       03330000
027200                                                                  03340000
027300 01  EM-EMAIL-LINE3.                                              03350000
027400     05  FILLER                  PIC X(09)    VALUE               03360000
027500         'Debits:  '.                                             03370000
027600     05  EM-LINE3-DEBITS         PIC ZZZ,ZZZ,ZZZ,ZZZ,ZZ9.99       03380000
027700                                              VALUE ZERO.         03390000
027800     05  FILLER                  PIC X(43)    VALUE SPACES.       03400000
027900     05  FILLER                  PIC X(06)    VALUE SPACES.       03410000
028000                                                                  03420000
028100 01  EM-EMAIL-LINE4.                                              03430000
028200     05  FILLER                  PIC X(09)    VALUE               03440000
028300         'Credits: '.                                             03450000
028400     05  EM-LINE4-CREDITS        PIC ZZZ,ZZZ,ZZZ,ZZZ,ZZ9.99       03460000
028500                                              VALUE ZERO.         03470000
028600     05  FILLER                  PIC X(43)    VALUE SPACES.       03480000
028700     05  FILLER                  PIC X(06)    VALUE SPACES.       03490000
028800                                                                  03500000
028900 01  EM-EMAIL-LINE5.                                              03510000
029000     05  FILLER                  PIC X(45)    VALUE               03520000
029100         'THE FOLLOWING STORES HAVE OUT OF BALANCES:   '.         03530000
029200     05  FILLER                  PIC X(35)    VALUE SPACES.       03540000
029300                                                                  03550000
029400 01  EM-EMAIL-LINE6.                                              03560000
029500     05  FILLER                  PIC X(43)    VALUE               03570000
029600         'STORE             DEBITS            CREDITS'.           03580000
029700     05  FILLER                  PIC X(37)    VALUE               03590000
029800         '         DIFFERENCE'.                                   03600000
029900 01  EM-EMAIL-LINE7.                                              03610000
029910     05  FILLER                  PIC X        VALUE SPACE.        03620000
029920     05  EM-LINE7-STORE          PIC 9(4)     VALUE ZEROES.       03630000
029930     05  FILLER                  PIC XX       VALUE SPACES.       03640000
029940     05  EM-LINE7-STR-DEBITS     PIC ZZ,ZZZ,ZZZ,ZZ9.99            03650000
029950                                              VALUE ZERO.         03660000
029960     05  FILLER                  PIC XX       VALUE SPACES.       03670000
029970     05  EM-LINE7-STR-CREDITS    PIC ZZ,ZZZ,ZZZ,ZZ9.99            03680000
029980                                              VALUE ZERO.         03690000
029990     05  FILLER                  PIC XX       VALUE SPACES.       03700000
030000     05  EM-LINE7-STR-DIFF       PIC ZZ,ZZZ,ZZZ,ZZ9.99            03710000
030001                                              VALUE ZERO.         03720000
030002     05  FILLER                  PIC X(18)    VALUE SPACES.       03730000
030003                                                                  03740000
030004                                                                  03750000
030005 01  EM-EMAIL-LINE8.                                              03760000
030006     05  FILLER                  PIC X(32)    VALUE               03770000
030007         'E-COMMERCE TMR CREDIT GENERATED '.                      03780000
030008     05  EM-LINE8-E-COM-CR       PIC ZZZ,ZZZ,ZZZ,ZZZ,ZZ9.99       03790000
030009                                              VALUE ZEROS.        03800000
030010                                                                  03810000
030011 01  EM-EMAIL-BLANK-LINE         PIC X(80)    VALUE SPACES.       03820000
030012                                                                  03830000
030013 01  ML-CONTROL-AREA.                                             03840000
030014     05  ML-CONTROL-DATE         PIC X(10)    VALUE SPACES.       03850000
030015     05  ML-CURRENT-DATE         PIC X(10)    VALUE SPACES.       03860000
030016     05  ML-LAST-WEEK-IND        PIC X(01)    VALUE SPACES.       03870000
030017         88  ML-LAST-FISCAL-WEEK              VALUE 'Y'.          03880000
030018         88  ML-NOT-LAST-FISCAL-WEEK          VALUE 'N'.          03890000
030019     05  FILLER                  PIC X(59)    VALUE SPACES.       03900000
030020                                                                  03910000
030030*---------------------------------------------------------------* 03920000
030040*    DATE ROUTINE WORKING STORAGE                               * 03930000
030050*---------------------------------------------------------------* 03940000
030060     COPY DPWS500.                                                03950000
030070*---------------------------------------------------------------* 03960000
030080*    SA CONSTANTS                                               * 03970000
030090*---------------------------------------------------------------* 03980000
030100     COPY SAWS006.                                                03990000
030200     COPY SAWS007.                                                04000000
030300*---------------------------------------------------------------* 04010000
030400*    DB2 ABEND AREA                                             * 04020000
030500*---------------------------------------------------------------* 04030000
030600     COPY DPWS004.                                                04040000
030700*---------------------------------------------------------------* 04050000
030800*    DB2 AREA FOR COSA DEPOSIT AMOUNT TABLE                     * 04060000
030900*---------------------------------------------------------------* 04070000
031000     EXEC SQL                                                     04080000
031100          INCLUDE TSAADDP                                         04090000
031200     END-EXEC.                                                    04100000
031300*---------------------------------------------------------------* 04110000
031400*    DB2 AREA FOR COSA PAID OUT/CASH RECEIVED TABLE             * 04120000
031500*---------------------------------------------------------------* 04130000
031600     EXEC SQL                                                     04140000
031700          INCLUDE TSAADPC                                         04150000
031800     END-EXEC.                                                    04160000
031900*---------------------------------------------------------------* 04170000
032000*    DB2 AREA FOR COSA SUMMARY TABLE                            * 04180000
032100*---------------------------------------------------------------* 04190000
032200     EXEC SQL                                                     04200000
032300          INCLUDE TSAADSU                                         04210000
032400     END-EXEC.                                                    04220000
032500*---------------------------------------------------------------* 04230000
032600*    DB2 AREA FOR COSA SUMMARY TOTAL TABLE                      * 04240000
032700*---------------------------------------------------------------* 04250000
032800     EXEC SQL                                                     04260000
032900          INCLUDE TSASUM                                          04270000
033000     END-EXEC.                                                    04280000
033100*---------------------------------------------------------------* 04290000
033200*    DB2 AREA FOR GENERAL LEDGER DATE TABLE                     * 04300000
033300*---------------------------------------------------------------* 04310000
033400     EXEC SQL                                                     04320000
033500          INCLUDE TSAGLDT                                         04330000
033600     END-EXEC.                                                    04340000
033700*---------------------------------------------------------------* 04350000
033800*    DB2 AREA FOR PARTITION TABLE                               * 04360000
033900*---------------------------------------------------------------* 04370000
034000     EXEC SQL                                                     04380000
034100          INCLUDE TEPPART                                         04390000
034200     END-EXEC.                                                    04400000
034210*---------------------------------------------------------------* 04410000
034220*    DB2 AREA FOR XST_LOC TABLE                                 * 04420000
034230*---------------------------------------------------------------* 04430000
034240     EXEC SQL                                                     04440000
034250          INCLUDE XST00001                                        04450000
034260     END-EXEC.                                                    04460000
034300*---------------------------------------------------------------* 04470000
034400*    DB2 AREA FOR COMMUNICATIONS                                * 04480000
034500*---------------------------------------------------------------* 04490000
034600     EXEC SQL                                                     04500000
034700          INCLUDE SQLCA                                           04510000
034800     END-EXEC.                                                    04520000
034900                                                                  04530000
035000*---------------------------------------------------------------* 04540000
035100*    TSAADDP CURSOR - FOR DEPOSIT TABLE                         * 04550000
035200*    *** THE PURPOSE OF THE SUBSELECT IS SO THAT NO AMOUNTS     * 04560000
035300*        WILL BE USED FOR A STORE FOR A DATE WHERE THE STATE    * 04570000
035400*        TAXABLE MDSE IS 0, BECAUSE THAT WOULD MEAN THE STORE   * 04580000
035500*        IS NOT ON THE COSA SYSTEM FOR THAT DAY.  THIS IS NEEDED* 04590000
035600*        BECAUSE THERE WILL BE AMOUNTS FOR A STORE ON THE DAY   * 04600000
035700*        BEFORE IT GETS CONVERTED TO COSA, BUT THESE SHOULD NOT * 04610000
035800*        GO TO GL.                                              * 04620000
035900*---------------------------------------------------------------* 04630000
036000     EXEC SQL                                                     04640000
036100         DECLARE TSAADDP-CSR CURSOR FOR                           04650000
036200             SELECT  D.STR_NBR,                                   04660000
036300                     SUM (D.TNDR_AMT)                             04670000
036400               FROM  TSAADDP D                                    04680000
036500               WHERE D.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO         04690000
036600                                 AND   :DK-END-DATE-ISO           04700000
STRFNT                                 AND STR_NBR <> 6666              04701024
036700               GROUP BY D.STR_NBR                                 04710000
036800             WITH UR                                              04720000
036900     END-EXEC.                                                    04730000
037000                                                                  04740000
037100*---------------------------------------------------------------* 04750000
037200*    TSAADPC CURSOR - FOR PAID OUT/CASH RECEIVED TABLE          * 04760000
037300*    *** THE PURPOSE OF THE SUBSELECT IS SO THAT NO AMOUNTS     * 04770000
037400*        WILL BE USED FOR A STORE FOR A DATE WHERE THE STATE    * 04780000
037500*        TAXABLE MDSE IS 0, BECAUSE THAT WOULD MEAN THE STORE   * 04790000
037600*        IS NOT ON THE COSA SYSTEM FOR THAT DAY.  THIS IS NEEDED* 04800000
037700*        BECAUSE THERE WILL BE AMOUNTS FOR A STORE ON THE DAY   * 04810000
037800*        BEFORE IT GETS CONVERTED TO COSA, BUT THESE SHOULD NOT * 04820000
037900*        GO TO GL.                                              * 04830000
038000*---------------------------------------------------------------* 04840000
038100     EXEC SQL                                                     04850000
038200         DECLARE TSAADPC-CSR CURSOR FOR                           04860000
038300             SELECT  P.STR_NBR,                                   04870000
038400                     P.TYP_CDE,                                   04880000
038500                     P.STR_CHRGD_NBR,                             04890000
038600                     P.RSN_CDE,                                   04900000
038700                     P.ADJ_CSH_AMT,                               04910000
038800                     P.CMNT_TXT                                   04920000
038900               FROM  TSAADPC P                                    04930000
039000               WHERE P.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO         04940000
039100                                 AND   :DK-END-DATE-ISO           04950000
STRFNT                                 AND STR_NBR <> 6666              04951024
039200             WITH UR                                              04960000
039300     END-EXEC.                                                    04970000
039400                                                                  04980000
039500*---------------------------------------------------------------* 04990000
039600*    TSAADSU CURSOR - FOR TOTALS TABLE                          * 05000000
039700*    *** THE PURPOSE OF THE SUBSELECT IS SO THAT NO AMOUNTS     * 05010000
039800*        WILL BE USED FOR A STORE FOR A DATE WHERE THE STATE    * 05020000
039900*        TAXABLE MDSE IS 0, BECAUSE THAT WOULD MEAN THE STORE   * 05030000
040000*        IS NOT ON THE COSA SYSTEM FOR THAT DAY.  THIS IS NEEDED* 05040000
040100*        BECAUSE THERE WILL BE AMOUNTS FOR A STORE ON THE DAY   * 05050000
040200*        BEFORE IT GETS CONVERTED TO COSA, BUT THESE SHOULD NOT * 05060000
040300*        GO TO GL.                                              * 05070000
040400*---------------------------------------------------------------* 05080000
040500     EXEC SQL                                                     05090000
040600         DECLARE TSAADSU-CSR CURSOR FOR                           05100000
040700             SELECT  S.STR_NBR,                                   05110000
040800                     S.SUM_CTG_CDE,                               05120000
040810                     L.E_BUS_IND,                                 05130000
040900                     SUM (S.ADJ_AMT)                              05140000
041000               FROM  TSAADSU S                                    05150000
041010                    ,XST_LOC L                                    05160000
041100               WHERE S.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO         05170000
041200                                 AND   :DK-END-DATE-ISO           05180000
041210                 AND S.STR_NBR = L.LOC_NBR                        05190000
STRFNT                 AND S.STR_NBR <> 6666                            05191024
041300                 AND S.SUM_CTG_CDE IN ('KMT','POS','GTT',         05200000
041400                                       'TMR','GDT','BCN',         05210000
041500                                       'NCN','AEN','KCN',         05220000
041600                                       'ROS','SOS','COH',         05230000
041700                                       'STM','TAX','GTS',         05240000
041800                                       'GDS','CRI','KMI',         05250000
041900                                       'POR','KCP','NSF',         05260000
042000                                       'CUD','DBN','TPC',         05270040
PAYVEN                                       'PPN','VMN')               05280040
042100               GROUP BY S.STR_NBR,                                05290000
042200                        S.SUM_CTG_CDE,                            05300000
042210                        L.E_BUS_IND                               05310000
042300             WITH UR                                              05320000
042400     END-EXEC.                                                    05330000
042500                                                                  05340000
042600*---------------------------------------------------------------* 05350000
042700*    TSASUM CURSOR - FOR SUMMARY TOTAL TABLE - TO GET EMPLOYEE  * 05360000
042800*    CASH DISCOUNT.                                             * 05370000
042900*    WITH AUTO POST GL, NEW CATEGORIES WILL BE SUMMED USING     * 05380000
043000*    TSASUM.  THE NEW CATEGORIES ARE:  GWR, GWS, ECR, SHR, SHS, * 05390000
043100*    KKB, KKH, KKS, KKT, MAN, PTG, SPN, BRC.                    * 05400000
043200*    5/8/2002 - CHANGE MADE TO INCLUDE TWO TSASUM CURSORS; ONE  * 05410000
043300*    THAT USES NON-ZERO REGISTER ROWS (TSASUM-CSR) AND ONE THAT * 05420000
043400*    USES ZERO REGISTER ROWS (ZEROROW-CSR).                     * 05430000
043410*    7/30/2013 - ADD SFS category to ZEROROW-CSR                * 05440000
8446E *    2/13/2014 - ADD BPS category to ZEROROW-CSR                * 05450000
MKTPLC*    MARCH 2022 - ADD CATEGORIES MSS, MSR, MCS, MCR, MMS, MMR.  * 05461026
COBRND*    2/27/2023 - ADD COBRAND CATEGORIES CVN AND CVP.            * 05463026
043500*---------------------------------------------------------------* 05470000
043600     EXEC SQL                                                     05480000
043700         DECLARE TSASUM-CSR CURSOR FOR                            05490000
043800             SELECT  STR_NBR,                                     05500000
043900                     SUM_CTG_CDE,                                 05510000
044000                     SUM (CTG_AMT) AS PV-SUM-CTG-AMT              05520000
044100               FROM  TSASUM   SUM                                 05530000
044200                    ,TEPPART PRT                                  05540000
044300               WHERE PRT.SLS_DTE                                  05550000
044400                            BETWEEN :DK-BEGIN-DATE-ISO            05560000
044500                                AND :DK-END-DATE-ISO              05570000
044600                 AND SUM.PARTN_NBR                                05580000
044700                                  =  PRT.PARTN_NBR                05590000
044800                 AND DB_STRUC_CDE = :PC-OPERATIONAL-TABLES        05600000
044900                 AND STR_GP_CDE   = :PC-STORE-GROUP-CODE          05610000
045000                 AND SUM_TYP_CDE IN ('D', 'S')                    05620000
045100                 AND SUM_CTG_CDE IN ('ECR', 'GWR', 'GWS', 'SHR',  05630000
MKTPL2                                     'SHS', 'FEE', 'SGS', 'SGT',  05640024
MKTPL2                                     'MSS', 'MSR', 'MCS', 'MCR',  05641026
COBRND                                     'CVN', 'CVP')                05641126
MKTPL2**                                   'MMS', 'MMR')                05642018
STRFNT                 AND STR_NBR     <> 6666                          05643024
045300                 AND RGST_ID     <> 0                             05650000
045400               GROUP BY STR_NBR, SUM_CTG_CDE                      05660000
045500             WITH UR                                              05670000
045600     END-EXEC.                                                    05680000
045700                                                                  05690000
045800*---------------------------------------------------------------* 05700000
045900*    ZEROROW-CSR - PICKS UP CATEGORIES IN TSASUM THAT ONLY HAVE * 05710000
046000*    ZERO REGISTER ROWS.                                        * 05720000
BOSS  *    1/23/2018 - ADDED BOS, BPR, BSR category to ZEROROW-CSR    * 05730004
046100*---------------------------------------------------------------* 05740000
046200     EXEC SQL                                                     05750000
046300         DECLARE ZEROROW-CSR CURSOR FOR                           05760000
046400             SELECT  STR_NBR,                                     05770000
046500                     SUM_CTG_CDE,                                 05780000
046600                     SUM (CTG_AMT) AS PV-SUM-CTG-AMT              05790000
046700               FROM  TSASUM   SUM                                 05800000
046800                    ,TEPPART  PRT                                 05810000
046900               WHERE PRT.SLS_DTE                                  05820000
047000                            BETWEEN :DK-BEGIN-DATE-ISO            05830000
047100                                AND :DK-END-DATE-ISO              05840000
047200                 AND SUM.PARTN_NBR                                05850000
047300                                  =  PRT.PARTN_NBR                05860000
047400                 AND DB_STRUC_CDE = :PC-OPERATIONAL-TABLES        05870000
047500                 AND STR_GP_CDE   = :PC-STORE-GROUP-CODE          05880000
047600                 AND SUM_TYP_CDE IN ('D', 'S')                    05890000
047700                 AND SUM_CTG_CDE IN ('KKB', 'KKH', 'KKS', 'KKT',  05900000
047800                                     'MAN', 'PTG', 'SPN', 'KKU',  05910000
BOSS                                       'BRC', 'SFS', 'BPS', 'BOS',  05930000
12386a                                     'BSR', 'BPR', 'DON')         05932013
STRFNT                 AND STR_NBR     <> 6666                          05933024
048000                 AND RGST_ID      = 0                             05940000
048100               GROUP BY STR_NBR, SUM_CTG_CDE                      05950000
048200             WITH UR                                              05960000
048300     END-EXEC.                                                    05970000
048400                                                                  05980000
048500******************************************************************05990000
048600 PROCEDURE DIVISION.                                              06000000
048700******************************************************************06010000
048800 0000-MAINLINE.                                                   06020000
048900                                                                  06030000
049000     PERFORM 1000-INITIALIZE.                                     06040000
049100                                                                  06050000
049200     PERFORM 1100-PROCESS-CONTROL-CARD.                           06060000
049300                                                                  06070000
049400     PERFORM 2000-PROCESS.                                        06080000
049500                                                                  06090000
049600     PERFORM 9000-EOJ-ROUTINE.                                    06100000
049700                                                                  06110000
049800     STOP RUN.                                                    06120000
049900                                                                  06130000
050000*----------------------------------------------------------------*06140000
050100*  OPEN FILES. GET DATE FROM CONTROL CARD. CHECK IF DATE IS      *06150000
050200*  VALID, AND FIND OUT MONTH-ENDING DATE, TO SEE IF WE ARE AT    *06160000
050300*  THE END OF THE FISCAL MONTH.  PREPARE OUTPUT RECORD.          *06170000
050400*----------------------------------------------------------------*06180000
050500 1000-INITIALIZE.                                                 06190000
050600                                                                  06200000
050700     OPEN INPUT  DATE-RANGE-FILE.                                 06210000
050800     OPEN OUTPUT GENERAL-LEDGER-FILE                              06220000
050900                 EMAIL-FILE.                                      06230000
051000                                                                  06240000
051100     ACCEPT DATE-CONTROL-CARD FROM SYSIN.                         06250000
051200                                                                  06260000
051300     INITIALIZE PV-HOLD-AMTS-TABLE.                               06270000
051400     MOVE ZERO                TO PV-STORE-NUMBER.                 06280000
051500     SET PS-FIRST-TIME-THRU-YES                                   06290000
051600         PS-SCAN-PENALTY-NO                                       06300000
051700                               TO TRUE.                           06310000
051800                                                                  06320000
051900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06330000
052000     MOVE CC-WEEK-ENDING-DATE-ISO                                 06340000
052100                               TO DPG52-LK-DATE-INPUT.            06350000
052200     SET DPG52-LK-DTE-ISO-FMT  TO TRUE.                           06360000
052300     SET DPG51-FISCAL-454-CALENDAR                                06370000
052400                               TO TRUE.                           06380000
052500     SET DPG51-DO-NOT-INCR-DECR-DATE                              06390000
052600                               TO TRUE.                           06400000
052700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          06410000
052800                                             DPG53 DPG54          06420000
052900                                             DPG55 DPG56.         06430000
053000     EVALUATE TRUE                                                06440000
053100         WHEN DPG54-NO-ERROR                                      06450000
053200**           MOVE DPG55-1ST-WKDY-DB2ISO-FMT                       06460000
053300**                             TO DK-BEGIN-DATE-ISO               06470000
053400**           MOVE DPG55-LAST-WKDY-DB2ISO-FMT                      06480000
053500**                             TO DK-END-DATE-ISO                 06490000
053600             IF DPG56-LAST-FP-DB2-ISO-FMT                         06500000
053700                               = CC-WEEK-ENDING-DATE-ISO          06510000
053800                 SET ML-LAST-FISCAL-WEEK     TO TRUE              06520000
053900             ELSE                                                 06530000
054000                 SET ML-NOT-LAST-FISCAL-WEEK TO TRUE              06540000
054100             END-IF                                               06550000
054200         WHEN DPG54-SEVERE-ERROR                                  06560000
054300         WHEN DPG54-WARNING-ERROR                                 06570000
054400             DISPLAY '** ABEND **'                                06580000
054500             DISPLAY '** PROGRAM   ** = SAKUT016'                 06590000
054600             DISPLAY '** PARAGRAPH ** = 1000-INITIALIZE'          06600000
054700             DISPLAY 'BAD INPUT DATE: '                           06610000
054800                            CC-WEEK-ENDING-DATE-ISO               06620000
054900             DISPLAY DPG54-ERROR-MESSAGE                          06630000
055000             SET ABEND-4003-CC-ERROR TO TRUE                      06640000
055100             CALL 'ILBOABN0' USING ABEND-CODE                     06650000
055200     END-EVALUATE.                                                06660000
055300                                                                  06670000
055400     IF DPG55-ALPHA-WEEK-DAY-SATURDAY                             06680000
055500         CONTINUE                                                 06690000
055600     ELSE                                                         06700000
055700         DISPLAY '** ABEND **'                                    06710000
055800         DISPLAY '** PROGRAM   ** = SAKUT016'                     06720000
055900         DISPLAY '** PARAGRAPH ** = 1000-INITIALIZE'              06730000
056000         DISPLAY 'BAD INPUT DATE: '                               06740000
056100                            CC-WEEK-ENDING-DATE-ISO               06750000
056200         DISPLAY 'INPUT DATE IS NOT A WEEK ENDING DATE'           06760000
056300         SET ABEND-4003-CC-ERROR TO TRUE                          06770000
056400         CALL 'ILBOABN0' USING ABEND-CODE                         06780000
056500     END-IF.                                                      06790000
056600                                                                  06800000
056700     INITIALIZE GL002-GL-INTERFACE-TRN.                           06810000
056800     MOVE PC-BUSINESS-UNIT  TO GL002-BUSINESS-UNIT.               06820000
056900     MOVE CC-WEEK-ENDING-CC TO GL002-TRN-EFF-CC.                  06830000
057000     MOVE CC-WEEK-ENDING-YY TO GL002-TRN-EFF-YY.                  06840000
057100     MOVE CC-WEEK-ENDING-MM TO GL002-TRN-EFF-MM.                  06850000
057200     MOVE CC-WEEK-ENDING-DD TO GL002-TRN-EFF-DD.                  06860000
057300                                                                  06870000
057400                                                                  06880000
057500*----------------------------------------------------------------*06890000
057600*  READ DATE CONTROL CARD                                         06900000
057700*----------------------------------------------------------------*06910000
057800 1100-PROCESS-CONTROL-CARD.                                       06920000
057900     READ DATE-RANGE-FILE    INTO CC-CONTROL-CARD.                06930000
058000     DISPLAY 'START DATE      = ' CC-START-DATE.                  06940000
058100     DISPLAY 'END   DATE      = ' CC-END-DATE.                    06950000
058200     MOVE CC-START-DATE        TO DK-BEGIN-DATE-ISO.              06960000
058300     MOVE CC-END-DATE          TO DK-END-DATE-ISO.                06970000
058400                                                                  06980000
058500*----------------------------------------------------------------*06990000
058600*                                                                *07000000
058700*----------------------------------------------------------------*07010000
058800 2000-PROCESS.                                                    07020000
058900                                                                  07030000
059000     PERFORM 2200-PROCESS-TSAADDP-TABLE.                          07040000
059100                                                                  07050000
059200**  AUTO POST GL PROJECT:  THE TSASUM TABLE MUST BE PROCESSED     07060000
059300**  PRIOR TO THE TSAADPC AND TSAADSU TABLES BECAUSE TSASUM        07070000
059400**  WILL INCLUDE CATEGORIES WHOSE DEBITS/CREDITS MAY NEED TO      07080000
059500**  BE ADDED TO TOTAL RETURNS (TMR), SALES (STM), GIFT CARDS      07090000
059600**  (GDT) OR STORE SUNDRY EXPENSE (SSE).  THE AMOUNTS ARE         07100000
059700**  KEPT IN THE PV-HOLD-AMTS-TABLE SUBSCRIPTED BY THE STORE       07110000
059800**  NUMBER.                                                       07120000
059900     PERFORM 2500-PROCESS-TSASUM-TABLE.                           07130000
060000                                                                  07140000
060100     PERFORM 2300-PROCESS-TSAADPC-TABLE.                          07150000
060200                                                                  07160000
060300     PERFORM 2400-PROCESS-TSAADSU-TABLE.                          07170000
060400                                                                  07180000
060500     PERFORM 2600-CHECK-IF-BALANCED.                              07190000
060600                                                                  07200000
060700*----------------------------------------------------------------*07210000
060800*    PROCESS THE TSAADDP (DEPOSIT AMOUNTS) TABLE                 *07220000
060900*----------------------------------------------------------------*07230000
061000 2200-PROCESS-TSAADDP-TABLE.                                      07240000
061100                                                                  07250000
061200     SET PS-NOT-END-OF-CURSOR TO TRUE.                            07260000
061300     PERFORM 2210-OPEN-TSAADDP-CURSOR.                            07270000
061400     PERFORM 2220-FETCH-TSAADDP-CURSOR.                           07280000
061500     PERFORM UNTIL PS-END-OF-CURSOR                               07290000
061600         PERFORM 2230-PROCESS-TSAADDP                             07300000
061700         PERFORM 2220-FETCH-TSAADDP-CURSOR                        07310000
061800     END-PERFORM.                                                 07320000
061900     PERFORM 2240-CLOSE-TSAADDP-CURSOR.                           07330000
062000                                                                  07340000
062100*----------------------------------------------------------------*07350000
062200*    OPEN THE TSAADDP CURSOR.                                    *07360000
062300*----------------------------------------------------------------*07370000
062400 2210-OPEN-TSAADDP-CURSOR.                                        07380000
062500                                                                  07390000
062600     EXEC SQL                                                     07400000
062700          OPEN TSAADDP-CSR                                        07410000
062800     END-EXEC.                                                    07420000
062900     EVALUATE TRUE                                                07430000
063000         WHEN SQLCODE = ZERO                                      07440000
063100             CONTINUE                                             07450000
063200         WHEN OTHER                                               07460000
063300             MOVE '2210-OPEN-TSAADDP-CURSOR'                      07470000
063400                              TO PV-PARAGRAPH-NAME                07480000
063500             MOVE 'OPEN CURSOR FOR TABLE TSAADDP'                 07490000
063600                              TO PV-DB2-FUNCTION                  07500000
063700             PERFORM 9990-DB2-ABEND                               07510000
063800     END-EVALUATE.                                                07520000
063900                                                                  07530000
064000*----------------------------------------------------------------*07540000
064100*   FETCH THE TSAADDP CURSOR.                                    *07550000
064200*----------------------------------------------------------------*07560000
064300 2220-FETCH-TSAADDP-CURSOR.                                       07570000
064400                                                                  07580000
064500     EXEC SQL                                                     07590000
064600         FETCH TSAADDP-CSR                                        07600000
064700         INTO  :SAADDP-STR-NBR,                                   07610000
064800               :SAADDP-TNDR-AMT                                   07620000
064900     END-EXEC.                                                    07630000
065000     EVALUATE TRUE                                                07640000
065100         WHEN SQLCODE = ZERO                                      07650000
065200             CONTINUE                                             07660000
065300         WHEN SQLCODE = +100                                      07670000
065400             SET PS-END-OF-CURSOR TO TRUE                         07680000
065500         WHEN OTHER                                               07690000
065600             MOVE '2220-FETCH-TSAADDP-CURSOR'                     07700000
065700                              TO PV-PARAGRAPH-NAME                07710000
065800             MOVE 'FETCH CURSOR FOR TABLE TSAADDP'                07720000
065900                              TO PV-DB2-FUNCTION                  07730000
066000             PERFORM 9990-DB2-ABEND                               07740000
066100     END-EVALUATE.                                                07750000
066200                                                                  07760000
066300*----------------------------------------------------------------*07770000
066400*    CREATE THE OUTPUT RECORD FOR THE ROW.                       *07780000
066500*----------------------------------------------------------------*07790000
066600 2230-PROCESS-TSAADDP.                                            07800000
066700                                                                  07810000
066720     IF SAADDP-STR-NBR = 0 OR SAADDP-STR-NBR >= 9999              07820000
066730             DISPLAY 'INVALID STR NUMBER FROM TSAADDP TABLE='     07830000
066740                                              SAADDP-STR-NBR      07840000
066750             DISPLAY 'IF STR-NBR IS INVALID,JOB WILL FAIL FOR '   07850000
066760             'SUBSCRIPT PV-STORE-BALANCE OUT OF RANGE.'           07860000
066770             DISPLAY 'SKIP THE INVALID STR NBR RECORDS AND '      07870000
066780             'CONTINUE THE PROGRAM TO PROCESS OTHER RECORDS,'     07880000
066790             DISPLAY 'ALSO SEND THE TENDER AMT DETAILS TO '       07890000
066791             'SALES AUDITORS TO CHECK.'                           07900000
066792             DISPLAY 'SUM OF TENDER AMT=' SAADDP-TNDR-AMT         07910000
066793             DISPLAY 'ABEND PARA-2230-PROCESS-TSAADDP'            07920000
066794             SET ABEND-4020-DATA-ERROR TO TRUE                    07930000
066795             CALL 'ILBOABN0' USING ABEND-CODE                     07940000
066796     END-IF                                                       07950000
066797                                                                  07960000
066800     MOVE SAADDP-STR-NBR      TO PV-STORE-NUMBER                  07970000
066900                                 PV-STORE-BALANCE.                07980000
067000     MOVE PV-STORE-NUMBER-X   TO GL002-LOCATION                   07990000
067100                                 GL002-JRNL-LN-REF                08000000
067200                                 GL002-JRNL-LINE-DESC.            08010000
067300     MOVE SAADDP-TNDR-AMT     TO GL002-MONETARY-AMT.              08020000
067400     SET  GL002-MONETARY-AMT-DR                                   08030000
067500                              TO TRUE.                            08040000
067600     MOVE PC-CASH-CHECK-DEPOSIT                                   08050000
067700                              TO GL002-EXPENSE-TYPE-CDE.          08060000
067800     PERFORM 8100-WRITE-GL-RECORD.                                08070000
067900                                                                  08080000
068000*----------------------------------------------------------------*08090000
068100*   CLOSE THE TSAADDP CURSOR.                                    *08100000
068200*----------------------------------------------------------------*08110000
068300 2240-CLOSE-TSAADDP-CURSOR.                                       08120000
068400     EXEC SQL                                                     08130000
068500          CLOSE TSAADDP-CSR                                       08140000
068600     END-EXEC.                                                    08150000
068700     EVALUATE TRUE                                                08160000
068800         WHEN SQLCODE = ZERO                                      08170000
068900             CONTINUE                                             08180000
069000         WHEN OTHER                                               08190000
069100             MOVE '2240-CLOSE-TSAADDP-CURSOR'                     08200000
069200                              TO PV-PARAGRAPH-NAME                08210000
069300             MOVE 'CLOSE CURSOR FOR TABLE TSAADDP'                08220000
069400                              TO PV-DB2-FUNCTION                  08230000
069500             PERFORM 9990-DB2-ABEND                               08240000
069600     END-EVALUATE.                                                08250000
069700                                                                  08260000
069800*----------------------------------------------------------------*08270000
069900*    PROCESS THE TSAADPC (PAID OUT/CASH RECEIVED) TABLE          *08280000
070000*----------------------------------------------------------------*08290000
070100                                                                  08300000
070200 2300-PROCESS-TSAADPC-TABLE.                                      08310000
070300                                                                  08320000
070400     SET PS-NOT-END-OF-CURSOR TO TRUE.                            08330000
070500     PERFORM 2310-OPEN-TSAADPC-CURSOR.                            08340000
070600     PERFORM 2320-FETCH-TSAADPC-CURSOR.                           08350000
070700     PERFORM UNTIL PS-END-OF-CURSOR                               08360000
070800         PERFORM 2330-PROCESS-TSAADPC                             08370000
070900         PERFORM 2320-FETCH-TSAADPC-CURSOR                        08380000
071000     END-PERFORM.                                                 08390000
071100     PERFORM 2340-CLOSE-TSAADPC-CURSOR.                           08400000
071200**  AUTO POST GL:  A RECORD WILL NEED TO BE INSERTED INTO         08410000
071300**  THE FILE FOR THE SCANNING PENALTY DEBIT (DEBITED TO STORE     08420000
071400**  SUNDRY EXPENSE--SSE).                                         08430000
071500     IF PS-END-OF-CURSOR  AND  PS-SCAN-PENALTY-YES                08440000
071600         PERFORM 2350-INSERT-SPN-TOTAL                            08450000
071700          VARYING PV-TBL-SUB FROM 1 BY 1                          08460000
071800           UNTIL  PV-TBL-SUB > 9999                               08470000
071900     END-IF.                                                      08480000
072000     SET PS-SCAN-PENALTY-NO    TO TRUE.                           08490000
072100                                                                  08500000
072200*----------------------------------------------------------------*08510000
072300*    OPEN THE TSAADPC CURSOR.                                    *08520000
072400*----------------------------------------------------------------*08530000
072500 2310-OPEN-TSAADPC-CURSOR.                                        08540000
072600                                                                  08550000
072700     EXEC SQL                                                     08560000
072800          OPEN TSAADPC-CSR                                        08570000
072900     END-EXEC.                                                    08580000
073000     EVALUATE TRUE                                                08590000
073100         WHEN SQLCODE = ZERO                                      08600000
073200             CONTINUE                                             08610000
073300         WHEN OTHER                                               08620000
073400             MOVE '2310-OPEN-TSAADPC-CURSOR'                      08630000
073500                              TO PV-PARAGRAPH-NAME                08640000
073600             MOVE 'OPEN CURSOR FOR TABLE TSAADPC'                 08650000
073700                              TO PV-DB2-FUNCTION                  08660000
073800             PERFORM 9990-DB2-ABEND                               08670000
073900     END-EVALUATE.                                                08680000
074000                                                                  08690000
074100*----------------------------------------------------------------*08700000
074200*   FETCH THE TSAADPC CURSOR.                                    *08710000
074300*----------------------------------------------------------------*08720000
074400 2320-FETCH-TSAADPC-CURSOR.                                       08730000
074500                                                                  08740000
074600     EXEC SQL                                                     08750000
074700         FETCH TSAADPC-CSR                                        08760000
074800         INTO  :SAADPC-STR-NBR,                                   08770000
074900               :SAADPC-TYP-CDE,                                   08780000
075000               :SAADPC-STR-CHRGD-NBR,                             08790000
075100               :SAADPC-RSN-CDE,                                   08800000
075200               :SAADPC-ADJ-CSH-AMT,                               08810000
075300               :SAADPC-CMNT-TXT                                   08820000
075400     END-EXEC.                                                    08830000
075500     EVALUATE TRUE                                                08840000
075600         WHEN SQLCODE = ZERO                                      08850000
075700             CONTINUE                                             08860000
075800         WHEN SQLCODE = +100                                      08870000
075900             SET PS-END-OF-CURSOR TO TRUE                         08880000
076000         WHEN OTHER                                               08890000
076100             MOVE '2320-FETCH-TSAADPC-CURSOR'                     08900000
076200                              TO PV-PARAGRAPH-NAME                08910000
076300             MOVE 'FETCH CURSOR FOR TABLE TSAADPC'                08920000
076400                              TO PV-DB2-FUNCTION                  08930000
076500             PERFORM 9990-DB2-ABEND                               08940000
076600     END-EVALUATE.                                                08950000
076700                                                                  08960000
076800*----------------------------------------------------------------*08970000
076900*    CREATE THE OUTPUT RECORD FOR THE ROW.                       *08980000
077000*----------------------------------------------------------------*08990000
077100 2330-PROCESS-TSAADPC.                                            09000000
077200                                                                  09010000
077300     MOVE SAADPC-STR-NBR      TO PV-STORE-NUMBER                  09020000
077400                                 PV-STORE-BALANCE.                09030000
077500     MOVE PV-STORE-NUMBER-X   TO GL002-JRNL-LN-REF.               09040000
077600     MOVE SAADPC-ADJ-CSH-AMT  TO GL002-MONETARY-AMT.              09050000
077700     MOVE SAADPC-TYP-CDE      TO SA007-TYP-CDE.                   09060000
077800     IF SA007-PAID-OUT                                            09070000
077900         IF SAADPC-ADJ-CSH-AMT < 0                                09080000
078000             SET  GL002-MONETARY-AMT-DR                           09090000
078100                              TO TRUE                             09100000
078200         ELSE                                                     09110000
078300             SET  GL002-MONETARY-AMT-CR                           09120000
078400                              TO TRUE                             09130000
078500         END-IF                                                   09140000
078600     ELSE                                                         09150000
078700         IF SAADPC-ADJ-CSH-AMT >= 0                               09160000
078800             SET  GL002-MONETARY-AMT-CR                           09170000
078900                              TO TRUE                             09180000
079000         ELSE                                                     09190000
079100             SET  GL002-MONETARY-AMT-DR                           09200000
079200                              TO TRUE                             09210000
079300         END-IF                                                   09220000
079400     END-IF.                                                      09230000
079500     MOVE SAADPC-RSN-CDE      TO GL002-EXPENSE-TYPE-CDE.          09240000
079600     MOVE SAADPC-STR-CHRGD-NBR                                    09250000
079700                              TO PV-STORE-NUMBER.                 09260000
079800     MOVE PV-STORE-NUMBER-X   TO GL002-LOCATION.                  09270000
079900     MOVE SAADPC-CMNT-TXT     TO GL002-JRNL-LINE-DESC.            09280000
080000     PERFORM 8100-WRITE-GL-RECORD.                                09290000
080100                                                                  09300000
080200*----------------------------------------------------------------*09310000
080300*   CLOSE THE TSAADPC CURSOR.                                    *09320000
080400*----------------------------------------------------------------*09330000
080500 2340-CLOSE-TSAADPC-CURSOR.                                       09340000
080600     EXEC SQL                                                     09350000
080700          CLOSE TSAADPC-CSR                                       09360000
080800     END-EXEC.                                                    09370000
080900     EVALUATE TRUE                                                09380000
081000         WHEN SQLCODE = ZERO                                      09390000
081100             CONTINUE                                             09400000
081200         WHEN OTHER                                               09410000
081300             MOVE '2340-CLOSE-TSAADPC-CURSOR'                     09420000
081400                              TO PV-PARAGRAPH-NAME                09430000
081500             MOVE 'CLOSE CURSOR FOR TABLE TSAADPC'                09440000
081600                              TO PV-DB2-FUNCTION                  09450000
081700             PERFORM 9990-DB2-ABEND                               09460000
081800     END-EVALUATE.                                                09470000
081900                                                                  09480000
082000*----------------------------------------------------------------*09490000
082100*    INSERT THE DEBIT TO THE STORE SUNDRY EXPENSE HERE FOR ANY   *09500000
082200*    AND ALL SCANNING PENALTIES.                                 *09510000
082300*----------------------------------------------------------------*09520000
082400 2350-INSERT-SPN-TOTAL.                                           09530000
082500                                                                  09540000
082600     MOVE PV-TBL-SUB          TO PV-STORE-NUMBER                  09550000
082700                                 PV-STORE-BALANCE.                09560000
082800     IF (PV-HOLD-SSE-AMT (PV-TBL-SUB)                             09570000
082900                       NOT EQUAL ZERO)                            09580000
083000         MOVE PV-STORE-NUMBER-X                                   09590000
083100                              TO GL002-JRNL-LN-REF                09600000
083200                                 GL002-LOCATION                   09610000
083300         MOVE 'SSE'           TO GL002-EXPENSE-TYPE-CDE           09620000
083400         MOVE 'Scan Penalty'  TO GL002-JRNL-LINE-DESC             09630000
083500         SET  GL002-MONETARY-AMT-DR                               09640000
083600                              TO TRUE                             09650000
083700         IF PV-HOLD-SSE-AMT (PV-TBL-SUB)                          09660000
083800                               > ZERO                             09670000
083900             MOVE 'C'         TO SA007-TYP-CDE                    09680000
084000         ELSE                                                     09690000
084100             MOVE 'P'         TO SA007-TYP-CDE                    09700000
084200         END-IF                                                   09710000
084300         MOVE PV-HOLD-SSE-AMT (PV-TBL-SUB)                        09720000
084400                              TO GL002-MONETARY-AMT               09730000
084500         PERFORM 8100-WRITE-GL-RECORD                             09740000
084600     END-IF.                                                      09750000
084700                                                                  09760000
084800*----------------------------------------------------------------*09770000
084900*    PROCESS THE TSAADSU (SUMMARY AMOUNTS) TABLE                 *09780000
085000*----------------------------------------------------------------*09790000
085100                                                                  09800000
085200 2400-PROCESS-TSAADSU-TABLE.                                      09810000
085300                                                                  09820000
085400     SET PS-NOT-END-OF-CURSOR TO TRUE.                            09830000
085500     PERFORM 2410-OPEN-TSAADSU-CURSOR.                            09840000
085600     PERFORM 2420-FETCH-TSAADSU-CURSOR.                           09850000
085700     PERFORM UNTIL PS-END-OF-CURSOR                               09860000
085800         PERFORM 2430-PROCESS-TSAADSU                             09870000
085900         PERFORM 2420-FETCH-TSAADSU-CURSOR                        09880000
086000     END-PERFORM.                                                 09890000
086100     PERFORM 2440-CLOSE-TSAADSU-CURSOR.                           09900000
086200                                                                  09910000
086300*----------------------------------------------------------------*09920000
086400*    OPEN THE TSAADSU CURSOR.                                    *09930000
086500*----------------------------------------------------------------*09940000
086600 2410-OPEN-TSAADSU-CURSOR.                                        09950000
086700                                                                  09960000
086800     EXEC SQL                                                     09970000
086900          OPEN TSAADSU-CSR                                        09980000
087000     END-EXEC.                                                    09990000
087100     EVALUATE TRUE                                                10000000
087200         WHEN SQLCODE = ZERO                                      10010000
087300             CONTINUE                                             10020000
087400         WHEN OTHER                                               10030000
087500             MOVE '2410-OPEN-TSAADSU-CURSOR'                      10040000
087600                              TO PV-PARAGRAPH-NAME                10050000
087700             MOVE 'OPEN CURSOR FOR TABLE TSAADSU'                 10060000
087800                              TO PV-DB2-FUNCTION                  10070000
087900             PERFORM 9990-DB2-ABEND                               10080000
088000     END-EVALUATE.                                                10090000
088100                                                                  10100000
088200*----------------------------------------------------------------*10110000
088300*   FETCH THE TSAADSU CURSOR.                                    *10120000
088400*----------------------------------------------------------------*10130000
088500 2420-FETCH-TSAADSU-CURSOR.                                       10140000
088600                                                                  10150000
088700     EXEC SQL                                                     10160000
088800         FETCH TSAADSU-CSR                                        10170000
088900         INTO  :SAADSU-STR-NBR,                                   10180000
089000               :SAADSU-SUM-CTG-CDE,                               10190000
089010               :XST00001-E-BUS-IND,                               10200000
089100               :SAADSU-ADJ-AMT                                    10210000
089200     END-EXEC.                                                    10220000
089300     EVALUATE TRUE                                                10230000
089400         WHEN SQLCODE = ZERO                                      10240000
089500             CONTINUE                                             10250000
089600         WHEN SQLCODE = +100                                      10260000
089700             SET PS-END-OF-CURSOR TO TRUE                         10270000
089800         WHEN OTHER                                               10280000
089900             MOVE '2420-FETCH-TSAADSU-CURSOR'                     10290000
090000                              TO PV-PARAGRAPH-NAME                10300000
090100             MOVE 'FETCH CURSOR FOR TABLE TSAADSU'                10310000
090200                              TO PV-DB2-FUNCTION                  10320000
090300             PERFORM 9990-DB2-ABEND                               10330000
090400     END-EVALUATE.                                                10340000
090500                                                                  10350000
090600*----------------------------------------------------------------*10360000
090700*    CREATE THE OUTPUT RECORD FOR THE ROW.                       *10370000
090800*----------------------------------------------------------------*10380000
090900 2430-PROCESS-TSAADSU.                                            10390000
091000                                                                  10400000
091010     IF SAADSU-STR-NBR = 0 OR SAADSU-STR-NBR >= 9999              10410000
091020             DISPLAY 'INVALID STR NUMBER FROM TSAADSU TABLE='     10420000
091030                                              SAADSU-STR-NBR      10430000
091040             DISPLAY 'IF STR-NBR IS INVALID,JOB WILL FAIL FOR '   10440000
091050             'SUBSCRIPT PV-STORE-BALANCE OUT OF RANGE.'           10450000
091060             DISPLAY 'SKIP THE INVALID STR NBR RECORDS AND '      10460000
091070             'CONTINUE THE PROGRAM TO PROCESS OTHER RECORDS,'     10470000
091080             DISPLAY ' ALSO SEND THE AMT AND OTHER DETAILS TO '   10480000
091090             'SALES AUDITORS TO CHECK.'                           10490000
091091             DISPLAY 'SUM-CTG-CDE=' SAADSU-SUM-CTG-CDE            10500000
091092             DISPLAY 'E-BUS-IND  =' XST00001-E-BUS-IND            10510000
091093             DISPLAY 'ADJUST AMT =' SAADSU-ADJ-AMT                10520000
091094             DISPLAY 'TENDER AMT =' SAADDP-TNDR-AMT               10530000
091095             DISPLAY 'ABEND PARA-2430-PROCESS-TSAADSU'            10540000
091096             SET ABEND-4020-DATA-ERROR TO TRUE                    10550000
091097             CALL 'ILBOABN0' USING ABEND-CODE                     10560000
091098     END-IF                                                       10570000
091099                                                                  10580000
091100     MOVE SAADSU-STR-NBR      TO PV-STORE-NUMBER                  10590000
091200                                 PV-STORE-BALANCE                 10600000
091300                                 PV-TBL-SUB.                      10610000
091400     MOVE PV-STORE-NUMBER-X   TO GL002-JRNL-LN-REF                10620000
091500                                 GL002-LOCATION                   10630000
091600                                 GL002-JRNL-LINE-DESC.            10640000
091700     MOVE SAADSU-SUM-CTG-CDE  TO GL002-EXPENSE-TYPE-CDE           10650000
091800                                 SA006-SUM-CTG-CDE.               10660000
091900     IF SA006-REGISTER-OVER-SHORT                                 10670000
092000       STRING PC-REGISTER-OVER-SHORT-MSG,                         10680000
092100              CC-WEEK-ENDING-CC, CC-WEEK-ENDING-YY,               10690000
092200              '-', CC-WEEK-ENDING-MM,                             10700000
092300              '-', CC-WEEK-ENDING-DD                              10710000
092400              DELIMITED BY SIZE INTO GL002-JRNL-LINE-DESC         10720000
092500       END-STRING                                                 10730000
092600     END-IF.                                                      10740000
092700     IF SA006-SAFE-OVER-SHORT                                     10750000
092800       STRING PC-SAFE-OVER-SHORT-MSG,                             10760000
092900              CC-WEEK-ENDING-CC, CC-WEEK-ENDING-YY,               10770000
093000              '-', CC-WEEK-ENDING-MM,                             10780000
093100              '-', CC-WEEK-ENDING-DD                              10790000
093200              DELIMITED BY SIZE INTO GL002-JRNL-LINE-DESC         10800000
093300       END-STRING                                                 10810000
093400     END-IF.                                                      10820000
093500                                                                  10830000
093600     MOVE SAADSU-ADJ-AMT      TO GL002-MONETARY-AMT.              10840000
093700                                                                  10850000
093800     EVALUATE TRUE                                                10860000
093900         WHEN SA006-KMRC-TENDERED                                 10870000
094000         WHEN SA006-PO-RECEIVABLE                                 10880000
094100         WHEN SA006-GIFT-CERT-TENDERED                            10890000
094200             SET GL002-MONETARY-AMT-DR                            10900000
094300                              TO TRUE                             10910000
094400             PERFORM 8100-WRITE-GL-RECORD                         10920000
094500         WHEN SA006-TOTAL-MDSE-RETURNS                            10930000
094600             MOVE SAADSU-ADJ-AMT                                  10940000
094700                              TO PV-HOLD-GL-AMT                   10950000
094800             SUBTRACT PV-HOLD-TMR-AMT (PV-TBL-SUB)                10960000
094900                 FROM PV-HOLD-GL-AMT                              10970000
095000                                                                  10980000
095100             IF PV-HOLD-GL-AMT < 0                                10990000
095200                SET GL002-MONETARY-AMT-DR TO TRUE                 11000000
095300             ELSE                                                 11010000
095410                IF XST00001-E-BUS-IND = 'Y'                       11020000
095500                   SET GL002-MONETARY-AMT-CR TO TRUE              11030000
095600                   MOVE PV-HOLD-GL-AMT       TO EM-LINE8-E-COM-CR 11040000
095700                END-IF                                            11050000
095800             END-IF                                               11060000
095900                                                                  11070000
096000             MOVE PV-HOLD-GL-AMT                                  11080000
096100                              TO GL002-MONETARY-AMT               11090000
096200             PERFORM 8100-WRITE-GL-RECORD                         11100000
096300         WHEN SA006-GIFT-CARD-TENDERED                            11110000
SEPHOR**           KKT AND SEPHORA GC TENDERS ARE SUBTRACTED FROM       11201024
SEPHOR**           THE KOHL'S GIFT CARDS TENDERED.                      11202024
115600             MOVE SAADSU-ADJ-AMT    TO PV-HOLD-GL-AMT             11203024
115700             SUBTRACT PV-HOLD-GDT-AMT (PV-TBL-SUB)                11204024
115800                 FROM PV-HOLD-GL-AMT                              11205024
115900             MOVE PV-HOLD-GL-AMT    TO GL002-MONETARY-AMT         11206024
SEPHOR             IF PV-HOLD-GL-AMT >= ZERO                            11207024
SEPHOR                 SET GL002-MONETARY-AMT-DR   TO TRUE              11208024
SEPHOR             ELSE                                                 11209024
SEPHOR                 SET GL002-MONETARY-AMT-CR   TO TRUE              11209124
SEPHOR             END-IF                                               11209224
116100             PERFORM 8100-WRITE-GL-RECORD                         11209324
097300         WHEN SA006-BANK-CHARGE                                   11210000
COBRND**           CVN (COBRAND VISA NET) IS SUBTRACTED FROM            11211026
COBRND**           BCN (BANK CHARGE NET).                               11212026
COBRND             MOVE SAADSU-ADJ-AMT    TO PV-HOLD-GL-AMT             11213026
COBRND             SUBTRACT PV-HOLD-BCN-AMT (PV-TBL-SUB)                11214026
COBRND                 FROM PV-HOLD-GL-AMT                              11215026
COBRND             MOVE PV-HOLD-GL-AMT    TO GL002-MONETARY-AMT         11216026
COBRND             IF PV-HOLD-GL-AMT >= ZERO                            11217026
COBRND                 SET GL002-MONETARY-AMT-DR   TO  TRUE             11218026
COBRND             ELSE                                                 11219026
COBRND                 SET GL002-MONETARY-AMT-CR   TO  TRUE             11219126
COBRND             END-IF                                               11219226
COBRND             PERFORM 8100-WRITE-GL-RECORD                         11219326
097400         WHEN SA006-NOVUS-CHARGE                                  11220000
097500         WHEN SA006-AMERICAN-EXPRESS                              11230000
097700         WHEN SA006-DEBIT-CARDS                                   11250000
097800         WHEN SA006-REGISTER-OVER-SHORT                           11260000
097900         WHEN SA006-SAFE-OVER-SHORT                               11270000
098000         WHEN SA006-CHANGE-IN-CASH-ON-HAND                        11280000
PAYVEN         WHEN SA006-PAYPAL                                        11281040
PAYVEN         WHEN SA006-VENMO                                         11282040
098100             IF SAADSU-ADJ-AMT >= ZERO                            11290000
098200                 SET GL002-MONETARY-AMT-DR                        11300000
098300                              TO TRUE                             11310000
098400             ELSE                                                 11320000
098500                 SET GL002-MONETARY-AMT-CR                        11330000
098600                              TO TRUE                             11340000
098700             END-IF                                               11350000
098800             PERFORM 8100-WRITE-GL-RECORD                         11360000
097600         WHEN SA006-KOHLS-CHARGE                                  11360131
COBTRL**           TTN (COBRAND TRAILING NET) IS SUBTRACTED FROM        11360232
COBTRL**           KCN (KOHLS CHARGE NET).                              11360331
COBTR2**           NEED TO DETERMINE IF THERE ARE COBRAND TRAILING      11360437
COBTR2**           TRANSACTIONS THAT WEREN'T PICKED UP IN THE TSASUM    11360537
COBTR2**           PARAGRAPH BECAUSE THE STORE HAD NO COBRAND SALES OR  11360637
COBTR2**           RETURNS (CVN) FOR THE WEEK.                          11360737
COBTR2**           THE CVN LOGIC WILL SET THE CVN INDICATOR TO 'Y'      11360837
COBTR2**           WHEN IT IS EXECUTED.                                 11360937
COBTR2**           IF CVN INDICATOR = 'N', CALL TO GET TRAILING TRANS.  11361037
COBTR2**           IF FOUND AND IT IS NOT ZERO, WRITE A CVN RECORD      11361137
COBTR2**           WITH THE TTN AMT AND ADD TTN AMT TO THE HOLD KCN AMT.11361237
COBTR2**           THEN CONTINUE TO WRITE THE KCN RECORD.               11361337
COBTR2**                                                                11361437
COBTR2             IF PV-HOLD-CVN-FOUND (PV-TBL-SUB) NOT = 'Y'          11361537
COBTR2                 MOVE SAADSU-STR-NBR TO PV-TBL-STORE              11361637
COBTR2                 PERFORM 2547-GET-TTN-ADJUSTMENTS                 11361737
COBTR2                 IF PV-TTN-ADJUSTMENTS NOT = 0                    11361837
COBTR2                     MOVE 'CVN'      TO GL002-EXPENSE-TYPE-CDE    11361937
COBTR2                     ADD PV-TTN-ADJUSTMENTS  TO                   11362037
COBTR2                                     PV-HOLD-KCN-AMT (PV-TBL-SUB) 11362137
COBTR2                                     PV-TTN-TOTAL                 11362237
COBTR2                     MOVE PV-TTN-ADJUSTMENTS TO GL002-MONETARY-AMT11362337
COBTR2                     IF PV-TTN-ADJUSTMENTS >= 0                   11362437
COBTR2                         SET GL002-MONETARY-AMT-DR  TO TRUE       11362537
COBTR2                     ELSE                                         11362637
COBTR2                         SET GL002-MONETARY-AMT-CR  TO TRUE       11362737
COBTR2                     END-IF                                       11362837
COBTR2                     PERFORM 8100-WRITE-GL-RECORD                 11362937
COBTR2**                   RESET ORIG EXPENSE TYPE CODE (KCN)           11363037
COBTR2                     MOVE SAADSU-SUM-CTG-CDE                      11363137
COBTR2                                     TO GL002-EXPENSE-TYPE-CDE    11363237
COBTR2                 END-IF                                           11363337
COBTR2             END-IF                                               11363437
COBTR2**           PROCESS KCN                                          11363537
COBTRL             MOVE SAADSU-ADJ-AMT    TO PV-HOLD-GL-AMT             11363631
COBTRL             SUBTRACT PV-HOLD-KCN-AMT (PV-TBL-SUB)                11363731
COBTRL                 FROM PV-HOLD-GL-AMT                              11363831
COBTRL             MOVE PV-HOLD-GL-AMT    TO GL002-MONETARY-AMT         11363931
COBTRL             IF PV-HOLD-GL-AMT >= ZERO                            11364031
COBTRL                 SET GL002-MONETARY-AMT-DR   TO  TRUE             11364135
COBTRL             ELSE                                                 11364231
COBTRL                 SET GL002-MONETARY-AMT-CR   TO  TRUE             11364335
COBTRL             END-IF                                               11364431
COBTRL             PERFORM 8100-WRITE-GL-RECORD                         11364531
099200         WHEN SA006-KOHLS-PAYMENTS                                11364626
COBTRL**           CVP (COBRAND VISA PAYMENTS) AND TTP (COBRAND         11364732
COBTRL**           TRAILING PAYMENTS) ARE SUBTRACTED FROM               11364832
COBRND**           KCP (KOHLS CHARGE PAYMENTS).                         11364932
COBTR2**           NEED TO DETERMINE IF THERE ARE COBRAND TRAILING      11365037
COBTR2**           TRANSACTIONS THAT WEREN'T PICKED UP IN THE TSASUM    11365137
COBTR2**           PARAGRAPH BECAUSE THE STORE HAD NO COBRAND PAYMENTS  11365237
COBTR2**           (CVP) FOR THE WEEK.                                  11365337
COBTR2**           THE CVP LOGIC WILL SET THE CVP INDICATOR TO 'Y'      11365437
COBTR2**           WHEN IT IS EXECUTED.                                 11365537
COBTR2**           IF CVP INDICATOR = 'N', CALL TO GET TRAILING TRANS.  11365637
COBTR2**           IF FOUND AND IT IS NOT ZERO, WRITE A CVP RECORD      11365737
COBTR2**           WITH THE TTP AMT AND ADD TTP AMT TO THE HOLD KCP AMT.11365837
COBTR2**           THEN CONTINUE TO WRITE THE KCP RECORD.               11365937
COBTR2**                                                                11366037
COBTR2             IF PV-HOLD-CVP-FOUND (PV-TBL-SUB) NOT = 'Y'          11366137
COBTR2                 MOVE SAADSU-STR-NBR TO PV-TBL-STORE              11366237
COBTR2                 PERFORM 2546-GET-TTP-ADJUSTMENTS                 11366337
COBTR2                 IF PV-TTP-ADJUSTMENTS NOT = 0                    11366437
COBTR2                     MOVE 'CVP'      TO GL002-EXPENSE-TYPE-CDE    11366537
COBTR2                     ADD PV-TTP-ADJUSTMENTS  TO                   11366637
COBTR2                                     PV-HOLD-KCP-AMT (PV-TBL-SUB) 11366737
COBTR2                                     PV-TTP-TOTAL                 11366837
COBTR2                     MOVE PV-TTP-ADJUSTMENTS TO GL002-MONETARY-AMT11366937
COBTR2                     IF PV-TTP-ADJUSTMENTS >= 0                   11367037
COBTR2                         SET GL002-MONETARY-AMT-CR  TO TRUE       11367137
COBTR2                     ELSE                                         11367237
COBTR2                         SET GL002-MONETARY-AMT-DR  TO TRUE       11367337
COBTR2                     END-IF                                       11367437
COBTR2                     PERFORM 8100-WRITE-GL-RECORD                 11367537
COBTR2**                   RESET ORIG EXPENSE TYPE CODE (KCP)           11367637
COBTR2                     MOVE SAADSU-SUM-CTG-CDE                      11367737
COBTR2                                     TO GL002-EXPENSE-TYPE-CDE    11367837
COBTR2                 END-IF                                           11367937
COBTR2             END-IF                                               11368037
COBTR2**           PROCESS KCP                                          11368137
COBRND             MOVE SAADSU-ADJ-AMT    TO PV-HOLD-GL-AMT             11368226
COBRND             SUBTRACT PV-HOLD-KCP-AMT (PV-TBL-SUB)                11368326
COBRND                 FROM PV-HOLD-GL-AMT                              11368426
COBRND             MOVE PV-HOLD-GL-AMT    TO GL002-MONETARY-AMT         11368526
COBRND             IF PV-HOLD-GL-AMT >= ZERO                            11368626
COBRND                 SET GL002-MONETARY-AMT-CR   TO  TRUE             11369026
COBRND             ELSE                                                 11369126
COBRND                 SET GL002-MONETARY-AMT-DR   TO  TRUE             11369226
COBRND             END-IF                                               11369326
COBRND             PERFORM 8100-WRITE-GL-RECORD                         11369426
098900         WHEN SA006-CORPORATE-REFUNDS-ISSUED                      11370000
099000         WHEN SA006-KMRC-ISSUED                                   11380000
099100         WHEN SA006-PO-RETURNS                                    11390000
099300         WHEN SA006-NSF-PAYMENTS                                  11410000
099400         WHEN SA006-CURRENCY-DELIVERY                             11420000
099500             SET GL002-MONETARY-AMT-CR                            11430000
099600                              TO TRUE                             11440000
099700             PERFORM 8100-WRITE-GL-RECORD                         11450000
099800         WHEN SA006-STATE-TAXABLE-MDSE                            11460000
099900             MOVE SAADSU-ADJ-AMT                                  11470000
100000                              TO PV-HOLD-GL-AMT                   11480000
100100             SUBTRACT PV-HOLD-STM-AMT (PV-TBL-SUB)                11490000
100200                            FROM PV-HOLD-GL-AMT                   11500000
100300             MOVE PV-HOLD-GL-AMT                                  11510000
100400                              TO GL002-MONETARY-AMT               11520000
100500             IF PV-HOLD-GL-AMT >= ZERO                            11530000
100600                 SET GL002-MONETARY-AMT-CR                        11540000
100700                              TO TRUE                             11550000
100800             ELSE                                                 11560000
100900                 SET GL002-MONETARY-AMT-DR                        11570000
101000                              TO TRUE                             11580000
101100             END-IF                                               11590000
101200             PERFORM 8100-WRITE-GL-RECORD                         11600000
101300         WHEN SA006-STATE-TAX                                     11610000
101400         WHEN SA006-GIFT-CERT-SALES                               11620000
101500         WHEN SA006-GIFT-CARD-SALES                               11630000
101600             IF SAADSU-ADJ-AMT >= ZERO                            11640000
101700                 SET GL002-MONETARY-AMT-CR                        11650000
101800                              TO TRUE                             11660000
101900             ELSE                                                 11670000
102000                 SET GL002-MONETARY-AMT-DR                        11680000
102100                              TO TRUE                             11690000
102200             END-IF                                               11700000
102300             PERFORM 8100-WRITE-GL-RECORD                         11710000
102400         WHEN SA006-THIRD-PARTY-CARD-SALES                        11720000
TPCFIX             MOVE SAADSU-ADJ-AMT    TO PV-HOLD-GL-AMT             11721024
102500             PERFORM 2435-GET-COMMISSIONS                         11730000
TPCFIX             SUBTRACT PV-COMMISSIONS-AMT FROM PV-HOLD-GL-AMT      11731024
TPCFIX**           POC AND THE SALES HUB ADD SEPHORA GIFT CARDS INTO    11732024
TPCFIX**           THE TPC BUCKETS AND THEY NEED TO BE SUBTRACTED       11733024
TPCFIX**           OUT BEFORE GOING TO GL.                              11734024
TPCFIX             SUBTRACT PV-HOLD-TPC-AMT (PV-TBL-SUB)                11735024
TPCFIX                 FROM PV-HOLD-GL-AMT                              11736024
TPCFIX             MOVE PV-HOLD-GL-AMT    TO GL002-MONETARY-AMT         11737024
TPCFIX             IF PV-HOLD-GL-AMT >= ZERO                            11738024
121700                 SET GL002-MONETARY-AMT-CR TO TRUE                11739024
121800             ELSE                                                 11739124
121900                 SET GL002-MONETARY-AMT-DR TO TRUE                11739224
122000             END-IF                                               11739324
122100             PERFORM 8100-WRITE-GL-RECORD                         11739424
102940                                                                  11810000
102950***          SEND THIRD PARTY CARD COMMISSIONS TO GL              11820000
102960             MOVE 'TCC' TO GL002-EXPENSE-TYPE-CDE                 11830000
102970             MOVE PV-COMMISSIONS-AMT TO GL002-MONETARY-AMT        11840000
102980             SET GL002-MONETARY-AMT-CR TO TRUE                    11850000
102990             PERFORM 8100-WRITE-GL-RECORD                         11860000
102991                                                                  12010000
102992         WHEN OTHER                                               12020000
102993             CONTINUE                                             12030000
102994     END-EVALUATE.                                                12040000
102995                                                                  12050000
102996*----------------------------------------------------------------*12060000
102997*    COMMISSIONS NEED TO BE SUBTRACTED FROM SALES BEFORE THEY ARE 12070000
102998*    PASSED ON TO GL. THESE COMMISSIONS WOULD BE FROM KOHLS       12080000
102999*    SELLING 3RD PARTY GIFT CARDS.                                12090000
103000*----------------------------------------------------------------*12100000
103100 2435-GET-COMMISSIONS.                                            12110000
103200                                                                  12120000
103210     EXEC SQL                                                     12130000
103220         SELECT SUM (CTG_AMT)                                     12140000
103230         INTO  :PV-COMMISSIONS-AMT :PV-SUM-TPC-NULL-IND           12150000
103240         FROM   TSASUM   SUM                                      12160000
103250               ,TEPPART  PRT                                      12170000
103260         WHERE PRT.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO             12180000
103270                               AND :DK-END-DATE-ISO               12190000
103280           AND SUM.PARTN_NBR =  PRT.PARTN_NBR                     12200000
103290           AND STR_NBR       = :SAADSU-STR-NBR                    12210000
103291           AND STR_GP_CDE    = :PC-STORE-GROUP-CODE               12220000
ZX               AND SUM_TYP_CDE   IN ('D','S')                         12230022
103293           AND SUM_CTG_CDE   = 'TCC'                              12240000
103294           AND RGST_ID       = 0                                  12250000
103295     END-EXEC.                                                    12260000
103296                                                                  12270000
103297     EVALUATE TRUE                                                12280000
103298         WHEN SQLCODE = ZERO                                      12290000
103299             IF PV-SUM-TPC-NULL-IND = -1                          12300000
103300                 MOVE ZEROES             TO PV-COMMISSIONS-AMT    12310000
103310             END-IF                                               12320000
103311         WHEN SQLCODE = +100                                      12330000
103312             MOVE ZEROES                 TO PV-COMMISSIONS-AMT    12340000
103313         WHEN OTHER                                               12350000
103314             MOVE '2435-GET-COMMISSIONS' TO PV-PARAGRAPH-NAME     12360000
103315             MOVE 'SELECT FROM TSASUM'   TO PV-DB2-FUNCTION       12370000
103316             DISPLAY 'SAADSU-STR-NBR ' SAADSU-STR-NBR             12380000
103317             DISPLAY 'PC-STORE-GROUP-CODE ' PC-STORE-GROUP-CODE   12390000
103318             PERFORM 9990-DB2-ABEND                               12400000
103319     END-EVALUATE.                                                12410000
103320                                                                  12420000
103330*----------------------------------------------------------------*12430000
103340*   CLOSE THE TSAADSU CURSOR.                                    *12440000
103350*----------------------------------------------------------------*12450000
103360 2440-CLOSE-TSAADSU-CURSOR.                                       12460000
103370     EXEC SQL                                                     12470000
103380          CLOSE TSAADSU-CSR                                       12480000
103390     END-EXEC.                                                    12490000
103400     EVALUATE TRUE                                                12500000
103500         WHEN SQLCODE = ZERO                                      12510000
103600             CONTINUE                                             12520000
103700         WHEN OTHER                                               12530000
103800             MOVE '2440-CLOSE-TSAADSU-CURSOR'                     12540000
103900                              TO PV-PARAGRAPH-NAME                12550000
104000             MOVE 'CLOSE CURSOR FOR TABLE TSAADSU'                12560000
104100                              TO PV-DB2-FUNCTION                  12570000
104200             PERFORM 9990-DB2-ABEND                               12580000
104300     END-EVALUATE.                                                12590000
104400                                                                  12600000
104500*----------------------------------------------------------------*12610000
104600*  RETRIEVE DATA FROM THE TSASUM TABLE.                          *12620000
104700*----------------------------------------------------------------*12630000
104800                                                                  12640000
104900 2500-PROCESS-TSASUM-TABLE.                                       12650000
105000                                                                  12660000
105100     SET PS-NOT-END-OF-CURSOR TO TRUE.                            12670000
105200     PERFORM 2520-OPEN-TSASUM-CURSOR.                             12680000
105300     PERFORM 2530-FETCH-TSASUM-CURSOR.                            12690000
105400     PERFORM UNTIL PS-END-OF-CURSOR                               12700000
105500         PERFORM 2540-PROCESS-TSASUM                              12710000
105600         PERFORM 2530-FETCH-TSASUM-CURSOR                         12720000
105700     END-PERFORM.                                                 12730000
105800     PERFORM 2550-CLOSE-TSASUM-CURSOR.                            12740000
105900**  5/8/2002  ADDITIONAL ZEROROW-CSR ADDED TO PICK UP ZERO        12750000
106000**  REGISTER ROWS FOR CATEGORIES THAT DO NOT HAVE NON-ZERO        12760000
106100**  REGISTER ROWS.                                                12770000
106200     SET PS-NOT-END-OF-CURSOR TO TRUE.                            12780000
106300     PERFORM 2560-OPEN-ZEROROW-CURSOR.                            12790000
106400     PERFORM 2570-FETCH-ZEROROW-CURSOR.                           12800000
106500     PERFORM UNTIL PS-END-OF-CURSOR                               12810000
106600         PERFORM 2540-PROCESS-TSASUM                              12820000
106700         PERFORM 2570-FETCH-ZEROROW-CURSOR                        12830000
106800     END-PERFORM                                                  12840000
106900     PERFORM 2580-CLOSE-ZEROROW-CURSOR.                           12850000
107000                                                                  12860000
107100*----------------------------------------------------------------*12870000
107200*    OPEN THE TSASUM CURSOR.                                     *12880000
107300*----------------------------------------------------------------*12890000
107400 2520-OPEN-TSASUM-CURSOR.                                         12900000
107500                                                                  12910000
107600     EXEC SQL                                                     12920000
107700          OPEN TSASUM-CSR                                         12930000
107800     END-EXEC.                                                    12940000
107900     EVALUATE TRUE                                                12950000
108000         WHEN SQLCODE = ZERO                                      12960000
108100             CONTINUE                                             12970000
108200         WHEN OTHER                                               12980000
108300             MOVE '2520-OPEN-TSASUM-CURSOR'                       12990000
108400                              TO PV-PARAGRAPH-NAME                13000000
108500             MOVE 'OPEN CURSOR FOR TABLE TSASUM'                  13010000
108600                              TO PV-DB2-FUNCTION                  13020000
108700             PERFORM 9990-DB2-ABEND                               13030000
108800     END-EVALUATE.                                                13040000
108900                                                                  13050000
109000*----------------------------------------------------------------*13060000
109100*   FETCH THE TSASUM CURSOR.                                     *13070000
109200*----------------------------------------------------------------*13080000
109300 2530-FETCH-TSASUM-CURSOR.                                        13090000
109400                                                                  13100000
109500     EXEC SQL                                                     13110000
109600         FETCH TSASUM-CSR                                         13120000
109700         INTO  :SASUM-STR-NBR,                                    13130000
109800               :SASUM-SUM-CTG-CDE,                                13140000
109900               :PV-SUM-CTG-AMT                                    13150000
110000     END-EXEC.                                                    13160000
110100     EVALUATE TRUE                                                13170000
110200         WHEN SQLCODE = ZERO                                      13180000
110300             MOVE SASUM-SUM-CTG-CDE  TO PC-SUM-CTG-CDE            13190000
110400         WHEN SQLCODE = +100                                      13200000
110500             SET PS-END-OF-CURSOR TO TRUE                         13210000
110600         WHEN OTHER                                               13220000
110700             MOVE '2530-FETCH-TSASUM-CURSOR'                      13230000
110800                              TO PV-PARAGRAPH-NAME                13240000
110900             MOVE 'FETCH CURSOR FOR TABLE TSASUM'                 13250000
111000                              TO PV-DB2-FUNCTION                  13260000
111100             PERFORM 9990-DB2-ABEND                               13270000
111200     END-EVALUATE.                                                13280000
111300                                                                  13290000
111400*----------------------------------------------------------------*13300000
111500*    CREATE TWO OUTPUT RECORDS FOR THE ROW, ONE DEBIT AND ONE    *13310000
111600*    CREDIT.                                                     *13320000
111700*----------------------------------------------------------------*13330000
111800 2540-PROCESS-TSASUM.                                             13340000
111900                                                                  13350000
112000     MOVE SASUM-STR-NBR       TO PV-STORE-NUMBER                  13360000
112100                                 PV-STORE-BALANCE                 13370000
112200                                 PV-TBL-SUB.                      13380000
112300     MOVE PV-STORE-NUMBER-X   TO GL002-JRNL-LN-REF                13390000
112400                                 GL002-LOCATION                   13400000
112500                                 GL002-JRNL-LINE-DESC.            13410000
112600     MOVE PV-SUM-CTG-AMT      TO GL002-MONETARY-AMT.              13420000
112700                                                                  13430000
112800     EVALUATE TRUE                                                13440000
STCFEE**  FEES WILL BE SENT THROUGH AS A CREDIT IF THE AMOUNT IS        13450000
STCFEE**  POSITIVE (WITH AN OFFSETTING DEBIT TO STM); OR A DEBIT IF THE 13460000
STCFEE**  AMOUNT IS NEGATIVE (WITH AN OFFSETTING CREDIT TO TMR)         13470000
STCFEE**  NEED TO RESET GL002-MONETARY-AMT AFTER FEE ADJUSTMENTS ARE    13480000
STCFEE**  SUBTRACTED FROM FEES.                                         13490000
STCFEE         WHEN PC-SUM-CTG-CDE-FEE                                  13500000
STCFEE             PERFORM 2545-GET-FEE-ADJUSTMENTS                     13510000
STCFEE             SUBTRACT PV-FEE-ADJUSTMENTS FROM PV-SUM-CTG-AMT      13520000
STCFEE             MOVE PV-SUM-CTG-AMT           TO GL002-MONETARY-AMT  13530000
STCFEE             IF PV-SUM-CTG-AMT < 0                                13540000
STCFEE                 ADD PV-SUM-CTG-AMT                               13550000
STCFEE                              TO PV-HOLD-TMR-AMT (PV-TBL-SUB)     13560000
STCFEE                 SET GL002-MONETARY-AMT-DR                        13570000
STCFEE                              TO TRUE                             13580000
STCFEE             ELSE                                                 13590000
STCFEE                 ADD PV-SUM-CTG-AMT                               13600000
STCFEE                              TO PV-HOLD-STM-AMT (PV-TBL-SUB)     13610000
STCFEE                 SET GL002-MONETARY-AMT-CR                        13620000
STCFEE                              TO TRUE                             13630000
STCFEE             END-IF                                               13640000
STCFEE             MOVE PC-SUM-CTG-CDE                                  13650000
STCFEE                              TO GL002-EXPENSE-TYPE-CDE           13660000
STCFEE             PERFORM 8100-WRITE-GL-RECORD                         13670000
112900**  SHIPPING SALES WILL BE SENT THROUGH AS A CREDIT; AN           13680000
113000**  OFFSETTING DEBIT WILL BE TO THE STM (STATE TAXABLE            13690000
113100**  MERCHANDISE) ACCOUNT                                          13700000
113200         WHEN PC-SUM-CTG-CDE-SHS                                  13710000
113300             ADD PV-SUM-CTG-AMT                                   13720000
113400                              TO PV-HOLD-STM-AMT (PV-TBL-SUB)     13730000
113500             MOVE PC-SUM-CTG-CDE                                  13740000
113600                              TO GL002-EXPENSE-TYPE-CDE           13750000
113700             SET GL002-MONETARY-AMT-CR                            13760000
113800                              TO TRUE                             13770000
113900             PERFORM 8100-WRITE-GL-RECORD                         13780000
114000**  SHIPPING RETURNS WILL BE SENT THROUGH AS A DEBIT; AN          13790000
114100**  OFSETTING CREDIT WILL BE TO THE TMR (TOTAL MERCHANDISE        13800000
114200**  RETURNS) ACCOUNT                                              13810000
114300         WHEN PC-SUM-CTG-CDE-SHR                                  13820000
114400             ADD PV-SUM-CTG-AMT                                   13830000
114500                              TO PV-HOLD-TMR-AMT (PV-TBL-SUB)     13840000
114600             MOVE PC-SUM-CTG-CDE                                  13850000
114700                              TO GL002-EXPENSE-TYPE-CDE           13860000
114800             SET GL002-MONETARY-AMT-DR                            13870000
114900                              TO TRUE                             13880000
115000             PERFORM 8100-WRITE-GL-RECORD                         13890000
115100**  GIFT WRAPPING SALES WILL BE SENT THROUGH AS A CREDIT; AN      14120000
115200**  OFFSETTING DEBIT WILL BE TO THE STM (STATE TAXABLE            14130000
115300**  MERCHANDISE) ACCOUNT                                          14140000
115400         WHEN PC-SUM-CTG-CDE-GWS                                  14150000
115500             ADD PV-SUM-CTG-AMT                                   14160000
115600                              TO PV-HOLD-STM-AMT (PV-TBL-SUB)     14170000
115700             MOVE PC-SUM-CTG-CDE                                  14180000
115800                              TO GL002-EXPENSE-TYPE-CDE           14190000
115900             SET GL002-MONETARY-AMT-CR                            14200000
116000                              TO TRUE                             14210000
116100             PERFORM 8100-WRITE-GL-RECORD                         14220000
116200**  GIFT WRAPPING RETURNS WILL BE SENT THROUGH AS A DEBIT; AN     14230000
116300**  OFFSETTING CREDIT WILL BE TO THE TMR (TOTAL MERCHANDISE       14240000
116400**  RETURNS) ACCOUNT                                              14250000
116500         WHEN PC-SUM-CTG-CDE-GWR                                  14260000
116600             ADD PV-SUM-CTG-AMT                                   14270000
116700                              TO PV-HOLD-TMR-AMT (PV-TBL-SUB)     14280000
116800             MOVE PC-SUM-CTG-CDE                                  14290000
116900                              TO GL002-EXPENSE-TYPE-CDE           14300000
117000             SET GL002-MONETARY-AMT-DR                            14310000
117100                              TO TRUE                             14320000
117200             PERFORM 8100-WRITE-GL-RECORD                         14330000
117300**  E-COMMERCE RETURNS WILL BE SENT THROUGH AS A DEBIT; AN        14340000
117400**  OFFSETTING CREDIT WILL BE TO THE TMR (TOTAL MERCHANDISE       14350000
117500**  RETURNS) ACCOUNT                                              14360000
117600         WHEN PC-SUM-CTG-CDE-ECR                                  14370000
117700             ADD PV-SUM-CTG-AMT                                   14380000
117800                              TO PV-HOLD-TMR-AMT (PV-TBL-SUB)     14390000
117900             MOVE PC-SUM-CTG-CDE                                  14400000
118000                              TO GL002-EXPENSE-TYPE-CDE           14410000
118100             SET GL002-MONETARY-AMT-DR                            14420000
118200                              TO TRUE                             14430000
118300             PERFORM 8100-WRITE-GL-RECORD                         14440000
118400**  NON-MERCHANDISE AND POSTAGE SALES, AND MANIFESTO TAX RETURNS  14450000
118500**  WILL BE SENT THROUGH AS A CREDIT IF THE AMOUNT IS POSITIVE    14460000
118600**  (WITH AN OFFSETTING DEBIT TO STM); OR A DEBIT IF THE AMOUNT   14470000
118700**  IS POSITIVE (WITH AN OFFSETTING CREDIT TO TMR)                14480000
118800         WHEN PC-SUM-CTG-CDE-KKB                                  14490000
118900         WHEN PC-SUM-CTG-CDE-BRC                                  14500000
119000         WHEN PC-SUM-CTG-CDE-KKH                                  14510000
119100         WHEN PC-SUM-CTG-CDE-KKU                                  14520000
119200         WHEN PC-SUM-CTG-CDE-KKS                                  14530000
119300         WHEN PC-SUM-CTG-CDE-PTG                                  14540000
119400         WHEN PC-SUM-CTG-CDE-MAN                                  14550000
119410         WHEN PC-SUM-CTG-CDE-SFS                                  14560000
8446E          WHEN PC-SUM-CTG-CDE-BPS                                  14570000
BOSS           WHEN PC-SUM-CTG-CDE-BPR                                  14580004
BOSS           WHEN PC-SUM-CTG-CDE-BOS                                  14580102
BOSS           WHEN PC-SUM-CTG-CDE-BSR                                  14580202
MKTPL2         WHEN PC-SUM-CTG-CDE-MSS                                  14580322
MKTPL2         WHEN PC-SUM-CTG-CDE-MSR                                  14580422
MKTPL2         WHEN PC-SUM-CTG-CDE-MCS                                  14580522
MKTPL2         WHEN PC-SUM-CTG-CDE-MCR                                  14580622
MKTPL2**       WHEN PC-SUM-CTG-CDE-MMS                                  14580722
MKTPL2**       WHEN PC-SUM-CTG-CDE-MMR                                  14580822
119500             IF PV-SUM-CTG-AMT < 0                                14590002
119600                ADD PV-SUM-CTG-AMT                                14600002
119700                              TO PV-HOLD-TMR-AMT (PV-TBL-SUB)     14610000
119750                MOVE PV-SUM-CTG-AMT TO PV-DISP-CTG-AMT            14620002
119800                SET GL002-MONETARY-AMT-DR                         14630002
119900                              TO TRUE                             14640002
120000             ELSE                                                 14650002
120100                  ADD PV-SUM-CTG-AMT                              14660000
120200                              TO PV-HOLD-STM-AMT (PV-TBL-SUB)     14670000
                        MOVE PV-SUM-CTG-AMT TO PV-DISP-CTG-AMT          14680000
120300                  SET GL002-MONETARY-AMT-CR                       14690000
120400                              TO TRUE                             14700000
120500             END-IF                                               14710002
120600             MOVE PC-SUM-CTG-CDE                                  14720000
120700                              TO GL002-EXPENSE-TYPE-CDE           14730000
120800             PERFORM 8100-WRITE-GL-RECORD                         14740000
MKTPL2**************************************************************    14740122
MKTPL2***  7/19/22 - It was decided that for now the Sales Hub will     14740222
MKTPL2***            include the Marketplace dollars in the Sales       14740322
MKTPL2***            and Returns categories, so this code may be        14740422
MKTPL2***            needed in the future, but not now!!!!              14740522
MKTPL2**************************************************************    14740622
MKTPL2**       WHEN PC-SUM-CTG-CDE-MSS                                  14740722
MKTPL2**       WHEN PC-SUM-CTG-CDE-MSR                                  14740822
MKTPL2**       WHEN PC-SUM-CTG-CDE-MCS                                  14740922
MKTPL2**       WHEN PC-SUM-CTG-CDE-MCR                                  14741022
MKTPL2***  The Sales Hub will not include marketplace categories        14741322
MKTPL2***  in the Sales (SAL/STM) and Returns (RET/TMR) buckets so      14741422
MKTPL2***  they should not be subtracted from them here.                14741522
MKTPL2**           IF PV-SUM-CTG-AMT < 0                                14741622
MKTPL2**                SET GL002-MONETARY-AMT-DR  TO TRUE              14741722
MKTPL2**           ELSE                                                 14741822
MKTPL2**                SET GL002-MONETARY-AMT-CR  TO TRUE              14742022
MKTPL2**           END-IF                                               14742222
MKTPL2**           MOVE PC-SUM-CTG-CDE                                  14742322
MKTPL2**                            TO GL002-EXPENSE-TYPE-CDE           14742422
MKTPL2**           PERFORM 8100-WRITE-GL-RECORD                         14742522
12386a         WHEN PC-SUM-CTG-CDE-DON                                  14743014
12386a             ADD  PV-SUM-CTG-AMT TO PV-HOLD-STM-AMT (PV-TBL-SUB)  14746006
12386a             MOVE PC-SUM-CTG-CDE TO GL002-EXPENSE-TYPE-CDE        14747006
12386a             IF PV-SUM-CTG-AMT >= ZERO                            14748007
12386a                SET GL002-MONETARY-AMT-CR TO TRUE                 14749006
12386a             ELSE                                                 14749106
12386a                SET GL002-MONETARY-AMT-DR TO TRUE                 14749206
12386a             END-IF                                               14749306
12386a             PERFORM 8100-WRITE-GL-RECORD                         14749406
120900**  KCK CARDS TENDERED WILL BE SENT THROUGH AS A DEBIT; AN        14750000
121000**  OFFSETTING CREDIT WILL BE TO THE GDT (GIFT CARDS TENDERED)    14760000
121100**  ACCOUNT                                                       14770000
121200         WHEN PC-SUM-CTG-CDE-KKT                                  14780000
121300             ADD PV-SUM-CTG-AMT                                   14790000
121400                              TO PV-HOLD-GDT-AMT (PV-TBL-SUB)     14800000
121500             MOVE PC-SUM-CTG-CDE                                  14810000
121600                              TO GL002-EXPENSE-TYPE-CDE           14820000
121700             IF PV-SUM-CTG-AMT >= 0                               14830000
121800                 SET GL002-MONETARY-AMT-DR  TO TRUE               14840000
121900             ELSE                                                 14850000
122000                 SET GL002-MONETARY-AMT-CR  TO TRUE               14860000
122100             END-IF                                               14870000
122200             PERFORM 8100-WRITE-GL-RECORD                         14880000
122300**  SCANNING PENALTIES WILL BE CREDITED TO STM.                   14890000
122400**  STORE SUNDRY EXPENSE (SSE) WILL BE DEBITED.                   14900000
122500**  PV-HOLD-TMR-AMT, PV-HOLD-STM-AMT AND PV-HOLD-SSE-AMT ARE      14910000
122600**  SIGNED FIELDS.                                                14920000
122700**  8100-WRITE-GL-RECORD IS NOT PERFORMED HERE AS THE TOTALS      14930000
122800**  WILL BE INSERTED WHEN THE TSAADPC CURSOR IS PROCESSED.        14940000
122900         WHEN PC-SUM-CTG-CDE-SPN                                  14950000
123000             SET PS-SCAN-PENALTY-YES                              14960000
123100                              TO TRUE                             14970000
123200             ADD PV-SUM-CTG-AMT                                   14980000
123300                              TO PV-HOLD-STM-AMT (PV-TBL-SUB)     14990000
123400             MOVE PV-SUM-CTG-AMT                                  15000000
123500                              TO PV-HOLD-GL-AMT                   15010000
123600             COMPUTE PV-HOLD-GL-AMT = PV-HOLD-GL-AMT * -1         15020000
123700             ADD PV-HOLD-GL-AMT                                   15030000
123800                              TO PV-HOLD-SSE-AMT (PV-TBL-SUB)     15040000
SEPHOR**  SEPHORA GIFT CARD SALES WILL BE SENT THROUGH AS A CREDIT.     15040124
TPCFIX**  AN OFFSETTING DEBIT WILL BE MADE TO THE TPC (THIRD PARTY      15041024
TPCFIX**  GIFT CARD SALES), WHICH IS UPDATED BY POC (TSAADSU) AND       15042024
TPCFIX**  THE SALES HUB (TSASUM).                                       15043024
SEPHOR         WHEN PC-SUM-CTG-CDE-SGS                                  15044024
TPCFIX             ADD PV-SUM-CTG-AMT                                   15045024
TPCFIX                              TO PV-HOLD-TPC-AMT (PV-TBL-SUB)     15046024
SEPHOR             MOVE PC-SUM-CTG-CDE                                  15047024
SEPHOR                              TO GL002-EXPENSE-TYPE-CDE           15048024
SEPHOR             IF PV-SUM-CTG-AMT >= 0                               15049024
SEPHOR                 SET GL002-MONETARY-AMT-CR  TO TRUE               15049124
SEPHOR             ELSE                                                 15049224
SEPHOR                 SET GL002-MONETARY-AMT-DR  TO TRUE               15049324
SEPHOR             END-IF                                               15049424
SEPHOR             PERFORM 8100-WRITE-GL-RECORD                         15049524
SEPHOR**  SEPHORA GIFT CARDS TENDERED WILL BE SENT THROUGH AS A DEBIT.  15049624
SEPHOR**  AN OFFSETTING CREDIT WILL BE TO THE GDT (GIFT CARDS TENDERED) 15049724
SEPHOR**  ACCOUNT.                                                      15049824
SEPHOR         WHEN PC-SUM-CTG-CDE-SGT                                  15049924
SEPHOR             ADD PV-SUM-CTG-AMT                                   15050024
SEPHOR                              TO PV-HOLD-GDT-AMT (PV-TBL-SUB)     15051024
SEPHOR             MOVE PC-SUM-CTG-CDE                                  15052024
SEPHOR                              TO GL002-EXPENSE-TYPE-CDE           15053024
SEPHOR             IF PV-SUM-CTG-AMT >= 0                               15054024
SEPHOR                 SET GL002-MONETARY-AMT-DR  TO TRUE               15055024
SEPHOR             ELSE                                                 15056024
SEPHOR                 SET GL002-MONETARY-AMT-CR  TO TRUE               15057024
SEPHOR             END-IF                                               15058024
SEPHOR             PERFORM 8100-WRITE-GL-RECORD                         15059024
COBRND**  COBRAND VISA PAYMENTS (CVP) WILL BE SENT THROUGH AS A CREDIT. 15059126
COBRND**  AN OFFSETTING DEBIT WILL BE MADE TO THE KCP (KOHLS CHARGE     15059226
COBRND**  PAYMENTS) ACCOUNT, WHICH IS UPDATED BY POC (TSAADSU).         15059326
COBTRL**  COBRAND TRAILING PAYMENTS (TTP) NEED TO BE ADDED TO THE       15059432
COBTRL**  COBRAND VISA PAYMENTS (CVP) AND THE HOLD-KCP-AMT SO THAT      15059531
COBTRL**  THEY CAN BE SUBTRACTED FROM KCP.                              15059631
COBRND         WHEN PC-SUM-CTG-CDE-CVP                                  15059726
COBTR2             MOVE SASUM-STR-NBR  TO PV-TBL-STORE                  15059837
COBTRL             PERFORM 2546-GET-TTP-ADJUSTMENTS                     15059932
COBTRL             ADD PV-TTP-ADJUSTMENTS TO PV-SUM-CTG-AMT             15060032
COBTRL                                       PV-TTP-TOTAL               15060233
COBTRF             MOVE PV-SUM-CTG-AMT TO GL002-MONETARY-AMT            15060341
COBRND             ADD PV-SUM-CTG-AMT  TO PV-HOLD-KCP-AMT (PV-TBL-SUB)  15060432
COBRND             MOVE PC-SUM-CTG-CDE TO GL002-EXPENSE-TYPE-CDE        15060532
COBRND             IF PV-SUM-CTG-AMT >= 0                               15060632
COBRND                 SET GL002-MONETARY-AMT-CR  TO TRUE               15060732
COBRND             ELSE                                                 15060832
COBRND                 SET GL002-MONETARY-AMT-DR  TO TRUE               15060932
COBRND             END-IF                                               15061026
COBRND             PERFORM 8100-WRITE-GL-RECORD                         15062026
COBTR2**           SET PV-HOLD-CVP-FOUND TO TELL KCP THAT CVP PROCESSED 15062137
COBTR2**           THE TRAILING TRANSACTIONS AND KCP DOESN'T NEED TO.   15062237
COBTR2             MOVE 'Y' TO PV-HOLD-CVP-FOUND (PV-TBL-SUB)           15062337
COBTRL**                                                                15062437
COBRND**  COBRAND VISA NET TENDERED WILL BE SENT THROUGH AS A DEBIT.    15063026
COBRND**  AN OFFSETTING CREDIT WILL BE TO THE BCN (BANK CHARGE NET)     15064026
COBRND**  ACCOUNT, WHICH IS UPDATED BY POC (TSAADSU).                   15065026
COBTRL**  COBRAND TRAILING NET (TTN) NEEDS TO BE ADDED TO THE           15065132
COBTRL**  COBRAND VISA NET (CVN) AND THE HOLD-KCN-AMT SO THAT           15065231
COBTRL**  THEY CAN BE SUBTRACTED FROM KCN.  THEY SHOULD NOT IMPACT      15065331
COBTRL**  BCN, SO THEY SHOULDN'T BE ADDED TO CVN UNTIL AFTER CVN IS     15065431
COBTRL**  MOVED TO THE HOLD-BCN-AMT BUCKET.                             15065531
COBRND         WHEN PC-SUM-CTG-CDE-CVN                                  15066026
COBRND             ADD PV-SUM-CTG-AMT  TO PV-HOLD-BCN-AMT (PV-TBL-SUB)  15067026
COBTR2             MOVE SASUM-STR-NBR  TO PV-TBL-STORE                  15067137
COBTRL             PERFORM 2547-GET-TTN-ADJUSTMENTS                     15067232
COBTRL             ADD PV-TTN-ADJUSTMENTS TO PV-SUM-CTG-AMT             15067332
COBTRL                                    PV-HOLD-KCN-AMT (PV-TBL-SUB)  15067532
COBTRL                                       PV-TTN-TOTAL               15067633
COBTRF             MOVE PV-SUM-CTG-AMT TO GL002-MONETARY-AMT            15067741
COBRND             MOVE PC-SUM-CTG-CDE TO GL002-EXPENSE-TYPE-CDE        15068026
COBRND             IF PV-SUM-CTG-AMT >= 0                               15069026
COBRND                 SET GL002-MONETARY-AMT-DR  TO TRUE               15069126
COBRND             ELSE                                                 15069226
COBRND                 SET GL002-MONETARY-AMT-CR  TO TRUE               15069326
COBRND             END-IF                                               15069426
COBRND             PERFORM 8100-WRITE-GL-RECORD                         15069526
COBTR2**           SET PV-HOLD-CVN-FOUND TO TELL KCN THAT CVN PROCESSED 15069637
COBTR2**           THE TRAILING TRANSACTIONS AND KCN DOESN'T NEED TO.   15069737
COBTR2             MOVE 'Y' TO PV-HOLD-CVN-FOUND (PV-TBL-SUB)           15069837
123900     END-EVALUATE.                                                15070000
STCFEE*----------------------------------------------------------------*15080000
STCFEE*    EMPLOYEE DISCOUNTS CALCULATED BY THE SALES HUB CAN RESULT    15090000
STCFEE*    IN ADJUSTMENTS WHICH WILL REDUCE THE FEES.                   15100000
STCFEE*----------------------------------------------------------------*15110000
STCFEE 2545-GET-FEE-ADJUSTMENTS.                                        15120000
STCFEE                                                                  15130000
STCFEE     EXEC SQL                                                     15140000
STCFEE         SELECT SUM (CTG_AMT)                                     15150000
STCFEE         INTO  :PV-FEE-ADJUSTMENTS                                15160000
STCFEE         FROM   TSASUM   SUM                                      15170000
STCFEE               ,TEPPART  PRT                                      15180000
STCFEE         WHERE PRT.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO             15190000
STCFEE                               AND :DK-END-DATE-ISO               15200000
STCFEE           AND SUM.PARTN_NBR =  PRT.PARTN_NBR                     15210000
STCFEE           AND STR_GP_CDE    = :PC-STORE-GROUP-CODE               15220000
STCFEE           AND SUM_TYP_CDE  IN ('D','S')                          15230000
STCFEE           AND STR_NBR       = :SASUM-STR-NBR                     15240000
STCFEE           AND SUM_CTG_CDE   = 'AFE'                              15250000
STCFEE           AND RGST_ID      <> 0                                  15260000
STCFEE         WITH UR                                                  15270000
STCFEE     END-EXEC.                                                    15280000
STCFEE                                                                  15290000
STCFEE     EVALUATE TRUE                                                15300000
STCFEE         WHEN SQLCODE = ZERO                                      15310000
STCFEE             CONTINUE                                             15320000
STCFEE         WHEN SQLCODE = +100 OR -305                              15330000
STCFEE             MOVE ZEROES                 TO PV-FEE-ADJUSTMENTS    15340000
STCFEE         WHEN OTHER                                               15350000
STCFEE             MOVE '2545-GET-FEE-ADJUSTMENTS'                      15360000
STCFEE                                         TO PV-PARAGRAPH-NAME     15370000
STCFEE             MOVE 'SELECT FROM TSASUM'   TO PV-DB2-FUNCTION       15380000
STCFEE             DISPLAY 'SAADSU-STR-NBR ' SAADSU-STR-NBR             15390000
STCFEE             DISPLAY 'PC-STORE-GROUP-CODE ' PC-STORE-GROUP-CODE   15400000
STCFEE             PERFORM 9990-DB2-ABEND                               15410000
STCFEE     END-EVALUATE.                                                15420000
STCFEE                                                                  15430000
COBTRL                                                                  15431031
COBTRL*----------------------------------------------------------------*15432031
COBTRL*    COBRAND TRAILING PAYMENTS (TTP) NEED TO BE SUBTRACTED        15433032
COBTRL*    FROM KCP AND ADDED TO CVP.                                   15434031
COBTRL*----------------------------------------------------------------*15435031
COBTRL 2546-GET-TTP-ADJUSTMENTS.                                        15436032
COBTRL                                                                  15437031
COBTRL     EXEC SQL                                                     15438031
COBTRL         SELECT SUM (CTG_AMT)                                     15439031
COBTRL         INTO  :PV-TTP-ADJUSTMENTS                                15439132
COBTRL         FROM   TSASUM   SUM                                      15439231
COBTRL               ,TEPPART  PRT                                      15439331
COBTRL         WHERE PRT.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO             15439431
COBTRL                               AND :DK-END-DATE-ISO               15439531
COBTRL           AND SUM.PARTN_NBR =  PRT.PARTN_NBR                     15439631
COBTRL           AND STR_GP_CDE    = :PC-STORE-GROUP-CODE               15439731
COBTRL           AND SUM_TYP_CDE  IN ('D','S')                          15439831
COBTR2           AND STR_NBR       = :PV-TBL-STORE                      15439937
COBTRL           AND SUM_CTG_CDE   = 'TTP'                              15440032
COBTRL           AND RGST_ID       = 0                                  15440132
COBTRL         WITH UR                                                  15440231
COBTRL     END-EXEC.                                                    15440331
COBTRL                                                                  15440431
COBTRL     EVALUATE TRUE                                                15440531
COBTRL         WHEN SQLCODE = ZERO                                      15440631
COBTRL             CONTINUE                                             15440731
COBTRL         WHEN SQLCODE = +100 OR -305                              15440831
COBTRL             MOVE ZEROES                 TO PV-TTP-ADJUSTMENTS    15440932
COBTRL         WHEN OTHER                                               15441031
COBTRL             MOVE '2546-GET-TTP-ADJUSTMENTS'                      15441132
COBTRL                                         TO PV-PARAGRAPH-NAME     15441231
COBTRL             MOVE 'SELECT FROM TSASUM'   TO PV-DB2-FUNCTION       15441331
COBTRL             DISPLAY 'SASUM-STR-NBR  ' SASUM-STR-NBR              15441431
COBTRL             DISPLAY 'PC-STORE-GROUP-CODE ' PC-STORE-GROUP-CODE   15441531
COBTRL             PERFORM 9990-DB2-ABEND                               15441631
COBTRL     END-EVALUATE.                                                15441731
COBTRL                                                                  15441831
COBTRL                                                                  15441931
COBTRL*----------------------------------------------------------------*15442031
COBTRL*    COBRAND TRAILING NET (TTN) NEEDS TO BE SUBTRACTED            15442132
COBTRL*    FROM BCN AND ADDED TO CVN.                                   15442231
COBTRL*----------------------------------------------------------------*15442331
COBTRL 2547-GET-TTN-ADJUSTMENTS.                                        15442432
COBTRL                                                                  15442531
COBTRL     EXEC SQL                                                     15442631
COBTRL         SELECT SUM (CTG_AMT)                                     15442731
COBTRL         INTO  :PV-TTN-ADJUSTMENTS                                15442832
COBTRL         FROM   TSASUM   SUM                                      15442931
COBTRL               ,TEPPART  PRT                                      15443031
COBTRL         WHERE PRT.SLS_DTE BETWEEN :DK-BEGIN-DATE-ISO             15443131
COBTRL                               AND :DK-END-DATE-ISO               15443231
COBTRL           AND SUM.PARTN_NBR =  PRT.PARTN_NBR                     15443331
COBTRL           AND STR_GP_CDE    = :PC-STORE-GROUP-CODE               15443431
COBTRL           AND SUM_TYP_CDE  IN ('D','S')                          15443531
COBTR2           AND STR_NBR       = :PV-TBL-STORE                      15443637
COBTRL           AND SUM_CTG_CDE   = 'TTN'                              15443732
COBTRL           AND RGST_ID       = 0                                  15443834
COBTRL         WITH UR                                                  15443931
COBTRL     END-EXEC.                                                    15444031
COBTRL                                                                  15444131
COBTRL     EVALUATE TRUE                                                15444231
COBTRL         WHEN SQLCODE = ZERO                                      15444331
COBTRL             CONTINUE                                             15444431
COBTRL         WHEN SQLCODE = +100 OR -305                              15444531
COBTRL             MOVE ZEROES                 TO PV-TTN-ADJUSTMENTS    15444632
COBTRL         WHEN OTHER                                               15444731
COBTRL             MOVE '2547-GET-TTN-ADJUSTMENTS'                      15444832
COBTRL                                         TO PV-PARAGRAPH-NAME     15444931
COBTRL             MOVE 'SELECT FROM TSASUM'   TO PV-DB2-FUNCTION       15445031
COBTRL             DISPLAY 'SASUM-STR-NBR  ' SASUM-STR-NBR              15445131
COBTRL             DISPLAY 'PC-STORE-GROUP-CODE ' PC-STORE-GROUP-CODE   15445231
COBTRL             PERFORM 9990-DB2-ABEND                               15445331
COBTRL     END-EVALUATE.                                                15445431
COBTRL                                                                  15445531
133600                                                                  15446000
124100                                                                  15450000
124200*----------------------------------------------------------------*15460000
124300*   CLOSE THE TSASUM CURSOR.                                     *15470000
124400*----------------------------------------------------------------*15480000
124500 2550-CLOSE-TSASUM-CURSOR.                                        15490000
124600     EXEC SQL                                                     15500000
124700          CLOSE TSASUM-CSR                                        15510000
124800     END-EXEC.                                                    15520000
124900     EVALUATE TRUE                                                15530000
125000         WHEN SQLCODE = ZERO                                      15540000
125100             CONTINUE                                             15550000
125200         WHEN OTHER                                               15560000
125300             MOVE '2550-CLOSE-TSASUM-CURSOR'                      15570000
125400                              TO PV-PARAGRAPH-NAME                15580000
125500             MOVE 'CLOSE CURSOR FOR TABLE TSASUM'                 15590000
125600                              TO PV-DB2-FUNCTION                  15600000
125700             PERFORM 9990-DB2-ABEND                               15610000
125800     END-EVALUATE.                                                15620000
125900                                                                  15630000
126000*----------------------------------------------------------------*15640000
126100*    OPEN THE ZEROROW CURSOR.                                    *15650000
126200*----------------------------------------------------------------*15660000
126300 2560-OPEN-ZEROROW-CURSOR.                                        15670000
126400                                                                  15680000
126500     EXEC SQL                                                     15690000
126600          OPEN ZEROROW-CSR                                        15700000
126700     END-EXEC.                                                    15710000
126800     EVALUATE TRUE                                                15720000
126900         WHEN SQLCODE = ZERO                                      15730000
127000             CONTINUE                                             15740000
127100         WHEN OTHER                                               15750000
127200             MOVE '2560-OPEN-ZEROROW-CURSOR'                      15760000
127300                              TO PV-PARAGRAPH-NAME                15770000
127400             MOVE 'OPEN CURSOR FOR ZERO ROWS'                     15780000
127500                              TO PV-DB2-FUNCTION                  15790000
127600             PERFORM 9990-DB2-ABEND                               15800000
127700     END-EVALUATE.                                                15810000
127800                                                                  15820000
127900*----------------------------------------------------------------*15830000
128000*   FETCH THE ZEROROW CURSOR.                                    *15840000
128100*----------------------------------------------------------------*15850000
128200 2570-FETCH-ZEROROW-CURSOR.                                       15860000
128300                                                                  15870000
128400     EXEC SQL                                                     15880000
128500         FETCH ZEROROW-CSR                                        15890000
128600         INTO  :SASUM-STR-NBR,                                    15900000
128700               :SASUM-SUM-CTG-CDE,                                15910000
128800               :PV-SUM-CTG-AMT                                    15920000
128900     END-EXEC.                                                    15930000
129000     EVALUATE TRUE                                                15940000
129100         WHEN SQLCODE = ZERO                                      15950000
129200             MOVE SASUM-SUM-CTG-CDE  TO PC-SUM-CTG-CDE            15960000
129300         WHEN SQLCODE = +100                                      15970000
129400             SET PS-END-OF-CURSOR TO TRUE                         15980000
129500         WHEN OTHER                                               15990000
129600             MOVE '2570-FETCH-ZEROROW-CURSOR'                     16000000
129700                              TO PV-PARAGRAPH-NAME                16010000
129800             MOVE 'FETCH CURSOR FOR ZERO ROWS'                    16020000
129900                              TO PV-DB2-FUNCTION                  16030000
130000             PERFORM 9990-DB2-ABEND                               16040000
130100     END-EVALUATE.                                                16050000
130200                                                                  16060000
130300*----------------------------------------------------------------*16070000
130400*   CLOSE THE ZEROROW CURSOR.                                    *16080000
130500*----------------------------------------------------------------*16090000
130600 2580-CLOSE-ZEROROW-CURSOR.                                       16100000
130700     EXEC SQL                                                     16110000
130800          CLOSE ZEROROW-CSR                                       16120000
130900     END-EXEC.                                                    16130000
131000     EVALUATE TRUE                                                16140000
131100         WHEN SQLCODE = ZERO                                      16150000
131200             CONTINUE                                             16160000
131300         WHEN OTHER                                               16170000
131400             MOVE '2580-CLOSE-ZEROROW-CURSOR'                     16180000
131500                              TO PV-PARAGRAPH-NAME                16190000
131600             MOVE 'CLOSE CURSOR FOR ZERO ROWS'                    16200000
131700                              TO PV-DB2-FUNCTION                  16210000
131800             PERFORM 9990-DB2-ABEND                               16220000
131900     END-EVALUATE.                                                16230000
132000                                                                  16240000
132100*----------------------------------------------------------------*16250000
132200*  CHECK IF THE DEBITS AND CREDITS BALANCE.                      *16260000
132300*----------------------------------------------------------------*16270000
132400                                                                  16280000
132500 2600-CHECK-IF-BALANCED.                                          16290000
132600                                                                  16300000
132700     WRITE EMAIL-RECORD       FROM EM-EMAIL-BLANK-LINE.           16310000
132800     IF PT-DEBITS = PT-CREDITS                                    16320000
132900         MOVE ZERO            TO RETURN-CODE                      16330000
133000         MOVE CC-WEEK-ENDING-DATE-ISO                             16340000
133100                              TO EM-LINE1-DATE                    16350000
133200         WRITE EMAIL-RECORD   FROM EM-EMAIL-LINE1                 16360000
133300     ELSE                                                         16370000
133400*        THIS VERSION OF THE PROGRAM SHOULD NOT STOP THE          16380000
133500*        GENERAL LEDGER FILE FROM BEING CREATED WHEN THERE IS AN  16390000
133600*        OUT OF BALANCE - SET THE RETURN CODE TO ZERO.            16400000
133700*        MOVE 4090            TO RETURN-CODE                      16410000
133800         MOVE ZERO            TO RETURN-CODE                      16420000
133900         MOVE CC-WEEK-ENDING-DATE-ISO                             16430000
134000                              TO EM-LINE1-DATE                    16440000
134100         WRITE EMAIL-RECORD   FROM EM-EMAIL-LINE1                 16450000
134200         WRITE EMAIL-RECORD   FROM EM-EMAIL-BLANK-LINE            16460000
134300         WRITE EMAIL-RECORD   FROM EM-EMAIL-LINE2B                16470000
134400     END-IF.                                                      16480000
134500     WRITE EMAIL-RECORD       FROM EM-EMAIL-BLANK-LINE.           16490000
134600     MOVE PT-DEBITS           TO   EM-LINE3-DEBITS.               16500000
134700     MOVE PT-CREDITS          TO   EM-LINE4-CREDITS.              16510000
134800     WRITE EMAIL-RECORD       FROM EM-EMAIL-LINE3.                16520000
134900     WRITE EMAIL-RECORD       FROM EM-EMAIL-LINE4.                16530000
135000     IF EM-LINE8-E-COM-CR NOT EQUAL ZEROS                         16540000
135100       WRITE EMAIL-RECORD   FROM EM-EMAIL-BLANK-LINE              16550000
135200       WRITE EMAIL-RECORD   FROM EM-EMAIL-LINE8                   16560000
135300     END-IF.                                                      16570000
135400                                                                  16580000
135500*                                                                 16590000
135600*----------------------------------------------------------------*16600000
135700*  WRITE GENERAL LEDGER RECORD.                                  *16610000
135800*----------------------------------------------------------------*16620000
135900                                                                  16630000
136000 8100-WRITE-GL-RECORD.                                            16640000
136100                                                                  16650000
136200     IF GL002-MONETARY-AMT = 0                                    16660000
136300         CONTINUE                                                 16670000
136400     ELSE                                                         16680000
136500         WRITE GENERAL-LEDGER-RECORD                              16690000
136600                           FROM GL002-GL-INTERFACE-TRN            16700000
136700         IF GL002-MONETARY-AMT-DR                                 16710000
STCFEE             DISPLAY 'CODE ' GL002-EXPENSE-TYPE-CDE               16720000
STCFEE                     '   STORE = ' PV-STORE-BALANCE               16730000
136900                     '   DEBIT AMT = ' GL002-MONETARY-AMT         16740000
137000             ADD GL002-MONETARY-AMT                               16750000
137100                           TO PT-DEBITS                           16760000
137200                              PV-STORE-DEBITS (PV-STORE-BALANCE)  16770000
137300         ELSE                                                     16780000
STCFEE             DISPLAY 'CODE ' GL002-EXPENSE-TYPE-CDE               16790000
STCFEE                     '   STORE = ' PV-STORE-BALANCE               16800000
137500                     '  CREDIT AMT = ' GL002-MONETARY-AMT         16810000
137600             ADD GL002-MONETARY-AMT                               16820000
137700                           TO PT-CREDITS                          16830000
137800                              PV-STORE-CREDITS (PV-STORE-BALANCE) 16840000
137900         END-IF                                                   16850000
138000         ADD 1             TO PT-GL-RECORDS-WRITTEN               16860000
138100     END-IF.                                                      16870000
138200                                                                  16880000
138300*----------------------------------------------------------------*16890000
138400*  CLOSE ALL FILES.                                              *16900000
138500*----------------------------------------------------------------*16910000
138600 9000-EOJ-ROUTINE.                                                16920000
138700                                                                  16930000
138800     SET TD-DEBITS                 TO TRUE.                       16940000
138900     MOVE PT-DEBITS                TO TD-TOTAL-AMOUNT.            16950000
139000     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       16960000
139100               TD-TOTAL-DISPLAY-MESSAGE.                          16970000
139200                                                                  16980000
139300     SET TD-CREDITS                TO TRUE.                       16990000
139400     MOVE PT-CREDITS               TO TD-TOTAL-AMOUNT.            17000000
139500     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       17010000
139600               TD-TOTAL-DISPLAY-MESSAGE.                          17020000
139700                                                                  17030000
139800     SET TD-GL-RECORDS-WRITTEN     TO TRUE.                       17040000
139900     MOVE PT-GL-RECORDS-WRITTEN    TO TD-TOTAL-AMOUNT.            17050000
140000     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       17060000
140100               TD-TOTAL-DISPLAY-MESSAGE.                          17070000
140200                                                                  17080000
COBTRL     DISPLAY '     '.                                             17080136
COBTR2     MOVE PV-TTN-TOTAL              TO PV-TRAIL-AMOUNT.           17081038
COBTRL     DISPLAY 'TOTAL TRAILING TENDER  TRANSACTION DOLLARS = '      17082036
COBTR2              PV-TRAIL-AMOUNT.                                    17083038
COBTR2     MOVE PV-TTP-TOTAL              TO PV-TRAIL-AMOUNT.           17084038
COBTRL     DISPLAY 'TOTAL TRAILING PAYMENT TRANSACTION DOLLARS = '      17085036
COBTR2              PV-TRAIL-AMOUNT.                                    17086038
COBTRL     DISPLAY '     '.                                             17086136
COBTRL                                                                  17087036
140300     DISPLAY 'STORE         DEBITS        CREDITS     DIFFERENCE'.17090000
140400                                                                  17100000
140500     IF PT-DEBITS = PT-CREDITS                                    17110000
140600         CONTINUE                                                 17120000
140700     ELSE                                                         17130000
140800         WRITE EMAIL-RECORD   FROM EM-EMAIL-BLANK-LINE            17140000
140900         WRITE EMAIL-RECORD   FROM EM-EMAIL-LINE5                 17150000
141000         WRITE EMAIL-RECORD   FROM EM-EMAIL-LINE6                 17160000
141100     END-IF.                                                      17170000
141200                                                                  17180000
141300     PERFORM 9100-DISPLAY-STORE-TOTALS                            17190000
141400         VARYING PV-TBL-SUB FROM 1 BY 1                           17200000
141500           UNTIL PV-TBL-SUB > 9999.                               17210000
141600                                                                  17220000
141700     CLOSE DATE-RANGE-FILE                                        17230000
141800           GENERAL-LEDGER-FILE                                    17240000
141900           EMAIL-FILE.                                            17250000
142000                                                                  17260000
142100                                                                  17270000
142200 9100-DISPLAY-STORE-TOTALS.                                       17280000
142300                                                                  17290000
142400     IF PV-STORE-DEBITS  (PV-TBL-SUB) = 0   AND                   17300000
142500        PV-STORE-CREDITS (PV-TBL-SUB) = 0                         17310000
142600         CONTINUE                                                 17320000
142700     ELSE                                                         17330000
142800         COMPUTE PV-STORE-DEBIT-CREDIT-DIFF =                     17340000
142900                 PV-STORE-DEBITS  (PV-TBL-SUB)  -                 17350000
143000                 PV-STORE-CREDITS (PV-TBL-SUB)                    17360000
143100         MOVE PV-STORE-DEBIT-CREDIT-DIFF TO PV-DISPLAY-DIFF       17370000
143200         IF PV-STORE-DEBIT-CREDIT-DIFF = 0                        17380000
143300             DISPLAY PV-TBL-SUB '  '                              17390000
143400                     PV-STORE-DEBITS (PV-TBL-SUB) '  '            17400000
143500                     PV-STORE-CREDITS (PV-TBL-SUB) ' '            17410000
143600                     PV-DISPLAY-DIFF                              17420000
143700         ELSE                                                     17430000
143800             DISPLAY PV-TBL-SUB '  '                              17440000
143900                     PV-STORE-DEBITS (PV-TBL-SUB) '  '            17450000
144000                     PV-STORE-CREDITS (PV-TBL-SUB) ' '            17460000
144100                     PV-DISPLAY-DIFF '   '                        17470000
144200                     ' *** OUT OF BALANCE ***'                    17480000
144300             MOVE PV-TBL-SUB            TO EM-LINE7-STORE         17490000
144400             MOVE PV-STORE-DEBITS (PV-TBL-SUB)                    17500000
144500                                        TO EM-LINE7-STR-DEBITS    17510000
144600             MOVE PV-STORE-CREDITS (PV-TBL-SUB)                   17520000
144700                                        TO EM-LINE7-STR-CREDITS   17530000
144800             MOVE PV-DISPLAY-DIFF       TO EM-LINE7-STR-DIFF      17540000
144900             WRITE EMAIL-RECORD       FROM EM-EMAIL-LINE7         17550000
145000         END-IF                                                   17560000
145100     END-IF.                                                      17570000
145200                                                                  17580000
145300                                                                  17590000
145400*----------------------------------------------------------------*17600000
145500*      PERFORMS ABENDS AFTER UNEXPECTED SQLCODE                  *17610000
145600*----------------------------------------------------------------*17620000
145700 9990-DB2-ABEND.                                                  17630000
145800                                                                  17640000
145900     DISPLAY '** ABEND **'.                                       17650000
146000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        17660000
146100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              17670000
146200     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                17680000
146300                                                                  17690000
146400* ROUTINE TO DISPLAY ABEND IN READABLE FORMAT                     17700000
146500     COPY DPPD004.                                                17710000
146600                                                                  17720000
146700     SET ABEND-4013-DB2-ERROR TO TRUE.                            17730000
146800     CALL 'ILBOABN0' USING ABEND-CODE.                            17740000
