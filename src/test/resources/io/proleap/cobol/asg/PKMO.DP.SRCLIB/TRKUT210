000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.   TRKUT210.                                                  
000600 AUTHOR.       THERESE RAMSEYER AND MIKE FRIESS.                          
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                                   
000800 DATE-WRITTEN. APRIL, 1999.                                               
000900 DATE-COMPILED.                                                           
001000                                                                          
001002******************************************************************        
001003*                                                                *        
001004*  READ AN INPUT FILE CONSISTING OF ALL OF THE COMPONANTS OF A   *        
001005*  CONTAINER MANIFEST AND CHECK THAT ALL RECORDS ARE PRESENT AND *        
001006*  IN THE CORRECT ORDER, EDIT THE DATA AND PASS IT ON TO LOAD    *        
001007*  PROGRAM TMKUP215, AND/OR WRITE ERROR OR WARNING RECORDS FOR   *        
001008*  PROGRAM TRKRP211.  IF ERRORS ARE ENCOUNTERED AT A HIGHER      *        
001009*  LEVEL, SPIN THROUGH THE INPUT WRITING ONLY ERROR RECORDS      *        
001010*  UNTIL THE GROUP CHANGES.                                      *        
001011*                                                                *        
001012*  INPUT/OUTPUT                                                  *        
001013*                                                                *        
001014*   TRRD013 - CONTAINER MANIFEST INPUT RECORDS                   *        
001015*                                                                *        
001016*   TRRD023 - EDITED FILE (OUTPUT)                               *        
001017*                                                                *        
001018*    CNTR   INCLUDES CVYA, CVYB, CONA & CONB  FROM INPUT TRRD013 *        
001019*    CONPO  INCLUDES CONPOA, CONPOB, & CONPOC FROM INPUT TRRD013 *        
001021*    CONUPC INCLUDES CONUPA, CONUPB, & CONUPC FROM INPUT TRRD013 *        
001022*                                                                *        
001023*   TRRD211 - RPT FILE.  THE OUTPUT REPORT FILE WILL BE A LENGTH *        
001024*                        OF 254 AND CONSIST OF ERROR OR WARNING  *        
001025*                        RECORDS PLUS HEADER RECORDS FOR BOTH    *        
001026*                        THE LOAD DETAIL AND ERROR REPORTS.      *        
002000******************************************************************        
002100* NOTE: 02/20/03 - THE CONTAINER VENDOR STYLE RECORD             *        
002110*                  TR013-REC-TYP-CONVS LOGIC WAS REMOVED.        *        
002200*        DORSEY JACKSON:                                         *        
002300*        PROJECT NUMBER:                                         *        
002400*****************************************************************         
002401******************************************************************        
002402 ENVIRONMENT DIVISION.                                                    
002403******************************************************************        
002404                                                                          
002405 CONFIGURATION SECTION.                                                   
002406                                                                          
002407 SOURCE-COMPUTER.        IBM-3090.                                        
002408 OBJECT-COMPUTER.        IBM-3090.                                        
002409                                                                          
002410 INPUT-OUTPUT SECTION.                                                    
002411                                                                          
002412 FILE-CONTROL.                                                            
002500                                                                          
002600     SELECT TR013-CONTAINER-FILE                                          
002700         ASSIGN TO INP01.                                                 
002800                                                                          
002900     SELECT TR023-UPDATE-CONTAINER-FILE                                   
003000         ASSIGN TO OUT01.                                                 
003100                                                                          
003200     SELECT TR211-CONTAINER-ERROR-FILE                                    
003300         ASSIGN TO OUT02.                                                 
003400                                                                          
003500******************************************************************        
003600 DATA DIVISION.                                                           
003700******************************************************************        
003800                                                                          
003900 FILE SECTION.                                                            
004000                                                                          
004100 FD  TR013-CONTAINER-FILE                                                 
004200     RECORDING MODE IS F                                                  
004300     LABEL RECORDS ARE STANDARD                                           
004400     BLOCK CONTAINS 0 RECORDS.                                            
004500                                                                          
004600 01  TR013-CONTAINER-RECORD          PIC X(300).                          
004700                                                                          
004800 FD  TR023-UPDATE-CONTAINER-FILE                                          
004900     RECORDING MODE IS F                                                  
005000     LABEL RECORDS ARE STANDARD                                           
005100     BLOCK CONTAINS 0 RECORDS.                                            
005200                                                                          
005300 01  TR023-UPDATE-CONTAINER-RECORD   PIC X(400).                          
005400                                                                          
005500 FD  TR211-CONTAINER-ERROR-FILE                                           
005600     RECORDING MODE IS F                                                  
005700     LABEL RECORDS ARE STANDARD                                           
005800     BLOCK CONTAINS 0 RECORDS.                                            
005900                                                                          
006000 01  TR211-CONTAINER-ERROR-RECORD    PIC X(508).                          
006100                                                                          
006200******************************************************************        
006300 WORKING-STORAGE SECTION.                                                 
006400******************************************************************        
006500                                                                          
006600******************************************************************        
006700*  DB2 FORMATTED MESSAGE AREA                                             
006800******************************************************************        
006900     COPY DPWS004.                                                        
007000                                                                          
007100******************************************************************        
007200*  CALL LIST PARAMETERS FOR THE CALENDAR ROUTINE.                         
007300******************************************************************        
007400     COPY DPWS500.                                                        
007500                                                                          
007600******************************************************************        
007700*  COMMUNICATIONS AREA FOR DB2                                            
007800******************************************************************        
007900     EXEC SQL                                                             
008000          INCLUDE SQLCA                                                   
008100     END-EXEC.                                                            
009000                                                                          
009900******************************************************************        
010000*  DB2 TABLE DECLARATION -  ENTERPRISE NAME TABLE.                        
010100*      (TENTNME)                                                          
010200******************************************************************        
010300     EXEC SQL                                                             
010400          INCLUDE TENTNME                                                 
010500     END-EXEC.                                                            
010510******************************************************************        
010600*  DB2 TABLE DECLARATION - PURCHASE ORDER PURCHASE TABLE (TPURCHS)        
010700******************************************************************        
010800     EXEC SQL                                                             
010900          INCLUDE TPURCHS                                                 
011000     END-EXEC.                                                            
017061******************************************************************        
017062*    CONTAINER MANIFEST EDIT COPYBOOK LAYOUT                              
017063******************************************************************        
017064     COPY TRRD013.                                                        
017065 EJECT                                                                    
017066                                                                          
017067******************************************************************        
017068*    CONTAINER MANIFEST LOAD COPYBOOK LAYOUT                              
017069******************************************************************        
017070     COPY TRRD023.                                                        
017071 EJECT                                                                    
017072                                                                          
017073******************************************************************        
017074*  CONTAINER REPORT RECORD LAYOUT - EXTRACT FOR THE DETAIL AND   *        
017075*  ERROR REPORTS. THIS ERROR FILE WILL BE SORTED WITH THE ERRORS *        
017076*  FROM TRKUP215 LOAD PROGRAM TO PRODUCE THE ERROR REPORT FOR A  *        
017077*  PARTICULAR RUN. ONLY RECORDS WHICH PASS THE PRELIMINARY EDITS *        
017078*  OF THIS PROGRAM WILL BE PASSED TO THE LOAD PROGRAM TRKUP215.  *        
017079******************************************************************        
017080     COPY TRRD211.                                                        
017081 EJECT                                                                    
017082                                                                          
017083                                                                          
017084 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
017085                                                   COMP SYNC.             
017086 01  PA-PROGRAM-ACCUMULATORS.                                             
017087     05  PA-TOTALS.                                                       
017088         10 PA-INPUT-COUNT            PIC  S9(13)  VALUE +0               
017089                                                     COMP-3.              
017090         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0               
017091                                                     COMP-3.              
017092         10 PA-TOTAL-UPDATE           PIC  S9(13)  VALUE +0               
017093                                                     COMP-3.              
017094         10 PA-TOTAL-UPDATE-ISA       PIC  S9(13)  VALUE +0               
017095                                                     COMP-3.              
017096         10 PA-TOTAL-UPDATE-CNTR      PIC  S9(13)  VALUE +0               
017097                                                     COMP-3.              
017098         10 PA-TOTAL-UPDATE-CONPO     PIC  S9(13)  VALUE +0               
017099                                                     COMP-3.              
017100         10 PA-TOTAL-UPDATE-CONUPC    PIC  S9(13)  VALUE +0               
017101                                                     COMP-3.              
017102         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0               
017103                                                     COMP-3.              
017104         10 PA-SSCC-SPACE-CNT         PIC  S9(04)  VALUE +0               
017105                                                     COMP SYNC.           
017106                                                                          
017107 01  PS-PROGRAM-SWITCHES.                                                 
017108     05  PS-END-OF-CONTAINERS-SW       PIC  X(01)    VALUE 'N'.           
017109         88  PS-END-OF-CONTAINERS                    VALUE 'Y'.           
017110         88  PS-END-OF-CONTAINERS-NO                 VALUE 'N'.           
017111     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.           
017112         88  PS-EDIT-ERROR                           VALUE 'Y'.           
017113         88  PS-EDIT-ERROR-NO                        VALUE 'N'.           
017114     05  PS-SEQUENCE-ERROR-SW          PIC  X(01)    VALUE 'N'.           
017115         88  PS-SEQUENCE-ERROR                       VALUE 'Y'.           
017116         88  PS-SEQUENCE-ERROR-NO                    VALUE 'N'.           
017117     05  PS-CNCART-ERROR-SW            PIC  X(01)    VALUE 'N'.           
017118         88  PS-CNCART-ERROR                         VALUE 'Y'.           
017119         88  PS-CNCART-ERROR-NO                      VALUE 'N'.           
017120     05  PS-CNSEAL-ERROR-SW            PIC  X(01)    VALUE 'Y'.           
017121         88  PS-CNSEAL-ERROR                         VALUE 'Y'.           
017122         88  PS-CNSEAL-ERROR-NO                      VALUE 'N'.           
017123     05  PS-EDIT-WARNING-SW            PIC  X(01)    VALUE 'N'.           
017124         88  PS-EDIT-WARNING                         VALUE 'Y'.           
017125         88  PS-EDIT-WARNING-NO                      VALUE 'N'.           
017126     05  PS-SPIN-CONTAINER-SW          PIC  X(01)    VALUE 'N'.           
017127         88  PS-SPIN-CONTAINER                       VALUE 'Y'.           
017128         88  PS-SPIN-CONTAINER-NO                    VALUE 'N'.           
017129     05  PS-SPIN-GROUP-SW              PIC  X(01)    VALUE 'N'.           
017130         88  PS-SPIN-GROUP                           VALUE 'Y'.           
017140         88  PS-SPIN-GROUP-NO                        VALUE 'N'.           
017200     05  PS-PREV-GRP-COMPLETE-SW       PIC  X(01)    VALUE 'N'.           
017300         88  PS-PREV-GRP-COMPLETE                    VALUE 'Y'.           
017400         88  PS-PREV-GRP-COMPLETE-NO                 VALUE 'N'.           
017500     05  PS-KEY-FIELDS-OK-SW           PIC  X(01)    VALUE 'N'.           
017600         88  PS-KEY-FIELDS-OK                        VALUE 'Y'.           
017700         88  PS-KEY-FIELDS-OK-NO                     VALUE 'N'.           
017800     05  PS-EDI-RECORD-SW              PIC  X(01)    VALUE 'N'.           
017900         88  PS-EDI-RECORD                           VALUE 'Y'.           
018000         88  PS-EDI-RECORD-NO                        VALUE 'N'.           
018100     05  PS-CONTAINER-RECORD-SW        PIC  X(01)    VALUE 'N'.           
018200         88  PS-CONTAINER-RECORD                     VALUE 'Y'.           
018300         88  PS-CONTAINER-RECORD-NO                  VALUE 'N'.           
018400     05 PS-CVY-CON-WRITTEN-SW          PIC  X(01)    VALUE 'N'.           
018500         88 PS-CVY-CON-WRITTEN                       VALUE 'Y'.           
018600         88 PS-CVY-CON-WRITTEN-NO                    VALUE 'N'.           
018700     05 PS-CONPO-WRITTEN-SW            PIC  X(01)    VALUE 'N'.           
018800         88 PS-CONPO-WRITTEN                         VALUE 'Y'.           
018900         88 PS-CONPO-WRITTEN-NO                      VALUE 'N'.           
019300     05 PS-CONUP-WRITTEN-SW            PIC  X(01)    VALUE 'N'.           
019400         88 PS-CONUP-WRITTEN                         VALUE 'Y'.           
019500         88 PS-CONUP-WRITTEN-NO                      VALUE 'N'.           
019600     05  PS-NEW-CONTAINER-SW           PIC  X(01)    VALUE 'N'.           
019700         88  PS-NEW-CONTAINER                        VALUE 'Y'.           
019800         88  PS-NEW-CONTAINER-NO                     VALUE 'N'.           
019900     05  PS-NEW-GROUP-SW               PIC  X(01)    VALUE 'N'.           
020000         88  PS-NEW-GROUP                            VALUE 'Y'.           
020100         88  PS-NEW-GROUP-NO                         VALUE 'N'.           
020200     05  PS-NEW-TRAN-TYP-SW            PIC  X(01)    VALUE 'N'.           
020300         88  PS-NEW-TRAN-TYP                         VALUE 'Y'.           
020400         88  PS-NEW-TRAN-TYP-NO                      VALUE 'N'.           
020500     05  PS-NEW-PO-SW                  PIC  X(01)    VALUE 'N'.           
020600         88  PS-NEW-PO                               VALUE 'Y'.           
020700         88  PS-NEW-PO-NO                            VALUE 'N'.           
021100     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.           
021200         88  PS-NEW-UPC                              VALUE 'Y'.           
021300         88  PS-NEW-UPC-NO                           VALUE 'N'.           
021400     05  PS-WARNING-TIME-SW            PIC  X(01)    VALUE 'N'.           
021500         88  PS-WARNING-TIME                         VALUE 'Y'.           
021600         88  PS-WARNING-TIME-NO                      VALUE 'N'.           
021700     05  PS-WARNING-DATE-SW            PIC  X(01)    VALUE 'N'.           
021800         88  PS-WARNING-DATE                         VALUE 'Y'.           
021900         88  PS-WARNING-DATE-NO                      VALUE 'N'.           
022000     05  PS-ENTNME-SW                  PIC X(01)     VALUE 'Y'.           
022100         88  PS-VALID-ENTNME                         VALUE 'Y'.           
022200         88  PS-INVALID-ENTNME                       VALUE 'N'.           
022201     05  PS-SEAL-ERR-WRITEN-SW         PIC X(01)     VALUE 'Y'.           
022202         88  PS-SEAL-ERR-WRITEN                      VALUE 'Y'.           
022203         88  PS-SEAL-ERR-WRITEN-NO                   VALUE 'N'.           
022204     05  PS-CONA-WRITEN-SW             PIC X(01)     VALUE 'N'.           
022205         88  PS-CONA-WRITEN                          VALUE 'Y'.           
022206         88  PS-CONA-WRITEN-NO                       VALUE 'N'.           
022300                                                                          
022400 01  PC-PROGRAM-CONSTANTS.                                                
022500     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE                  
022600         'TRKUT210'.                                                      
022700     05  PC-01                       PIC X(02)     VALUE '01'.            
022800     05  PC-10                       PIC X(02)     VALUE '10'.            
022900     05  PC-11                       PIC X(02)     VALUE '11'.            
023000     05  PC-19                       PIC X(02)     VALUE '19'.            
023100     05  PC-20                       PIC X(02)     VALUE '20'.            
023200     05  PC-21                       PIC X(02)     VALUE '21'.            
023300     05  PC-30                       PIC X(02)     VALUE '30'.            
023400     05  PC-31                       PIC X(02)     VALUE '31'.            
023500     05  PC-32                       PIC X(02)     VALUE '32'.            
023600     05  PC-40                       PIC X(02)     VALUE '40'.            
023700     05  PC-50                       PIC X(02)     VALUE '50'.            
023800     05  PC-51                       PIC X(02)     VALUE '51'.            
023900     05  PC-52                       PIC X(02)     VALUE '52'.            
023901     05  PC-60                       PIC X(02)     VALUE '60'.            
023902     05  PC-70                       PIC X(02)     VALUE '70'.            
024000     05  PC-98                       PIC X(02)     VALUE '98'.            
024100     05  PC-99                       PIC X(02)     VALUE '99'.            
024110     05  PC-SPACE                    PIC X(01)     VALUE ' '.             
024200     05  PC-A                        PIC X(01)     VALUE 'A'.             
024300     05  PC-C                        PIC X(01)     VALUE 'C'.             
024400     05  PC-D                        PIC X(01)     VALUE 'D'.             
024500     05  PC-E                        PIC X(01)     VALUE 'E'.             
024600     05  PC-M                        PIC X(01)     VALUE 'M'.             
024700     05  PC-O                        PIC X(01)     VALUE 'O'.             
024800     05  PC-U                        PIC X(01)     VALUE 'U'.             
024900     05  PC-A0                       PIC X(02)     VALUE 'A0'.            
025000     05  PC-AC                       PIC X(02)     VALUE 'AC'.            
025100     05  PC-AP                       PIC X(02)     VALUE 'AP'.            
025200     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.           
025300     05  PC-CTT                      PIC X(03)     VALUE 'CTT'.           
025310     05  PC-CVYA                     PIC X(06)     VALUE 'CVYA  '.        
025400     05  PC-CVYB                     PIC X(06)     VALUE 'CVYB  '.        
025500     05  PC-CONA                     PIC X(06)     VALUE 'CONA  '.        
025600     05  PC-CONB                     PIC X(06)     VALUE 'CONB  '.        
025700     05  PC-CONPOA                   PIC X(06)     VALUE 'CONPOA'.        
025800     05  PC-CONPOB                   PIC X(06)     VALUE 'CONPOB'.        
025900     05  PC-CONPOC                   PIC X(06)     VALUE 'CONPOC'.        
026100     05  PC-CONUPA                   PIC X(06)     VALUE 'CONUPA'.        
026200     05  PC-CONUPB                   PIC X(06)     VALUE 'CONUPB'.        
026300     05  PC-CONUPC                   PIC X(06)     VALUE 'CONUPC'.        
026301     05  PC-CNCART                   PIC X(06)     VALUE 'CNCART'.        
026302     05  PC-CNSEAL                   PIC X(06)     VALUE 'CNSEAL'.        
026400     05  PC-CONUP                    PIC X(05)     VALUE 'CONUP'.         
026500     05  PC-CNTR                     PIC X(06)     VALUE 'CNTR  '.        
026600     05  PC-CONPO                    PIC X(05)     VALUE 'CONPO'.         
026700     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.           
026800     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.           
026900     05  PC-EMPTY                    PIC X(03)     VALUE 'EMT'.           
027000     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.        
027100     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.           
027200     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.           
027300     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.           
027400     05  PC-IEA                      PIC X(03)     VALUE 'IEA'.           
027500     05  PC-DASH                     PIC X(01)     VALUE '-'.             
027600     05  PC-DEFAULT-NINES-TMST       PIC X(26)     VALUE                  
027700                                     '9999-09-09-00.00.00.000000'.        
027800     05  PC-DEFAULT-TMST             PIC X(26)     VALUE                  
027900                                     '0001-01-01-00.00.00.000000'.        
028000     05  PC-DEFAULT-DATE             PIC X(10)     VALUE                  
028100                                     '0001-01-01'.                        
028200     05  PC-DEFAULT-TIME             PIC X(04)     VALUE  '0000'.         
028300                                                                          
028400     05  PC-DEFAULT-DTE-NO-DASHES    PIC X(08)     VALUE                  
028500                                     '00010101'.                          
028600     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5               
028700                                                     COMP-3.              
028800     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.             
028900     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.             
029000                                                                          
029100 01  PV-PROGRAM-VARIABLES.                                                
029200                                                                          
029300     05  PV-HOLD-CONTNR-ID           PIC X(12)     VALUE SPACE.           
029400     05  PV-HOLD-ACTL-DPRTR-DTE-MOM  PIC X(08)     VALUE SPACE.           
029500     05  PV-HOLD-ACTL-DPRTR-TM-MOM   PIC X(04)     VALUE SPACE.           
029600     05  PV-CHECK-TIME               PIC X(04)     VALUE SPACE.           
029700     05  PV-HOLD-TRN-TYP-CDE         PIC X(06)     VALUE SPACE.           
029800     05  PV-HOLD-CONTNR-SEQ-NBR      PIC S9(04)    VALUE +0 COMP.         
029900     05  PV-CONTNR-SEQ-NBR-MAX       PIC S9(04)    VALUE +0 COMP.         
030000     05  PV-PROCESS-SEQ-NBR          PIC S9(06)    VALUE +0 COMP.         
030201     05  PV-ENT-ID-SIGNED            PIC S9(09)    VALUE +0               
030210                                                   COMP.                  
030211     05  PV-PO-NUMBER                PIC S9(09)    VALUE +0               
030212                                                   COMP.                  
030300     05  PV-VEND-ID-QUAL             PIC X(02)     VALUE SPACES.          
030400     05  PV-VEND-ID                  PIC X(15)     VALUE SPACES.          
030500     05  PV-HOLD-TR023-ENT-ID        PIC S9(09) VALUE ZEROES COMP.        
030600     05  PV-HOLD-TR211-RPT-TYP       PIC X(01)     VALUE SPACES.          
030700     05  PV-HOLD-TR211-CONTNR-ID     PIC X(12)     VALUE SPACES.          
030800     05  PV-HOLD-TR211-ACTL-DPRTR-DTE-M PIC X(08) VALUE SPACES.           
030900     05  PV-HOLD-TR211-ACTL-DPRTR-TM-M PIC X(04) VALUE SPACES.            
031100     05  PV-HOLD-TR211-TRN-TYP       PIC X(01)     VALUE SPACES.          
031200     05  PV-HOLD-TR211-DATA-IN-ERROR PIC X(15)     VALUE SPACES.          
031300     05  PV-HOLD-TR211-DATA-VALUE-NUM.                                    
031400         10 PV-HOLD-TR211-DATA-VALUE-X PIC 9(02)  VALUE ZEROS.            
031500         10 PV-HOLD-TR211-DATA-VALUE-N PIC 9(15)V9(3) VALUE ZERO.         
031600     05  PV-HOLD-TR211-DATA-VALUE REDEFINES                               
031700         PV-HOLD-TR211-DATA-VALUE-NUM PIC X(20).                          
031800     05  PV-HOLD-TR211-ERROR-TYPE    PIC X(03)     VALUE SPACES.          
031900     05  PV-HOLD-TR211-ERROR-MSG     PIC X(50)     VALUE SPACES.          
032000     05  PV-HOLD-TR211-PO-NBR        PIC  9(09)    VALUE ZEROS.           
032100     05  PV-HOLD-TR211-PO-NBR-X   REDEFINES                               
032200         PV-HOLD-TR211-PO-NBR        PIC X(09).                           
032300     05  PV-HOLD-TR211-UPC-NBR       PIC  9(15)    VALUE ZEROS.           
032400     05  PV-HOLD-TR211-UPC-NBR-X  REDEFINES                               
032500         PV-HOLD-TR211-UPC-NBR       PIC X(15).                           
032600     05  PV-CURR-PO-NBR              PIC  9(09)    VALUE ZEROS.           
032700     05  PV-CURR-PO-NBR-X         REDEFINES                               
032800         PV-CURR-PO-NBR              PIC X(09).                           
032900     05  PV-PREV-PO-NBR              PIC  9(09)    VALUE ZEROS.           
033000     05  PV-PREV-PO-NBR-X         REDEFINES                               
033100         PV-PREV-PO-NBR              PIC X(09).                           
033200     05  PV-SAVE-PREV-PO-NBR         PIC  9(09)    VALUE ZEROS.           
033300     05  PV-SAVE-PREV-PO-NBR-X    REDEFINES                               
033400         PV-SAVE-PREV-PO-NBR         PIC X(09).                           
033500     05  PV-LAST-GOOD-PO-NBR         PIC  9(09)    VALUE ZEROS.           
033600     05  PV-LAST-GOOD-PO-NBR-X       REDEFINES                            
033700         PV-LAST-GOOD-PO-NBR         PIC X(09).                           
033800                                                                          
034300     05  PV-CURR-UPC-NBR             PIC 9(15)     VALUE ZEROES.          
034400     05  PV-CURR-UPC-NBR-X        REDEFINES                               
034500         PV-CURR-UPC-NBR             PIC X(15).                           
034600     05  PV-PREV-UPC-NBR             PIC 9(15)     VALUE ZEROES.          
034700     05  PV-PREV-UPC-NBR-X        REDEFINES                               
034800         PV-PREV-UPC-NBR             PIC X(15).                           
034900                                                                          
035000     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.          
035100     05  PV-HOLD-LAST-REC-TYP        PIC X(03)     VALUE SPACES.          
035200                                                                  00057002
035300     05 PV-PREV-REC-KEY-A                PIC X(81) VALUE SPACES.          
035310     05 PV-PREV-REC-KEY.                                                  
035400        10 PV-PREV-REC-TYP-CDE           PIC X(06).                       
035500         88  PREV-TYP-ISA                          VALUE 'ISA   '.        
035600         88  PREV-TYP-CVY-CON                      VALUE 'CVYA  ',        
035700                                                         'CVYB  ',        
035800                                                         'CONA  ',        
035900                                                         'CONB  ',        
035910                                                         'CNSEAL'.        
036000         88  PREV-TYP-CVY                          VALUE 'CVYA  ',        
036100                                                         'CVYB  '.        
036200         88  PREV-TYP-CON                          VALUE 'CONA  ',        
036300                                                         'CONB  '.        
036400         88  PREV-TYP-CONPO                        VALUE 'CONPOA',        
036500                                                         'CONPOB',        
036600                                                         'CONPOC'.        
036800         88  PREV-TYP-CONUP                        VALUE 'CONUPA',        
036900                                                         'CONUPB',        
037000                                                         'CONUPC',        
037010                                                         'CNCART'.        
037100         88  PREV-TYP-CVYA                         VALUE 'CVYA  '.        
037200         88  PREV-TYP-CVYB                         VALUE 'CVYB  '.        
037300         88  PREV-TYP-CONA                         VALUE 'CONA  '.        
037400         88  PREV-TYP-CONB                         VALUE 'CONB  '.        
037500         88  PREV-TYP-CONPOA                       VALUE 'CONPOA'.        
037600         88  PREV-TYP-CONPOB                       VALUE 'CONPOB'.        
037700         88  PREV-TYP-CONPOC                       VALUE 'CONPOC'.        
037800         88  PREV-TYP-CONUPA                       VALUE 'CONUPA'.        
037900         88  PREV-TYP-CONUPB                       VALUE 'CONUPB'.        
038000         88  PREV-TYP-CONUPC                       VALUE 'CONUPC'.        
038001         88  PREV-TYP-CNCART                       VALUE 'CNCART'.        
038002         88  PREV-TYP-CNSEAL                       VALUE 'CNSEAL'.        
038100        10 PV-PREV-SEQ-NBR               PIC X(02).                       
038200        10 PV-PREV-3RD-PARTY-CDE         PIC X(06).                       
038300        10 PV-PREV-CONTNR-ID             PIC X(12).                       
038400        10 PV-PREV-ACTL-DPRTR-DTE-MOM PIC X(08).                          
038500        10 PV-PREV-ACTL-DPRTR-TM-MOM     PIC X(04).                       
039100                                                                          
039200     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                           
039300         88  TRN-TYP-ADD                           VALUE 'A'.             
039400         88  TRN-TYP-CHG                           VALUE 'C'.             
039500         88  TRN-TYP-DEL                           VALUE 'D'.             
039600         88  VALID-TRN-TYP-CDE                     VALUE 'A',             
039700                                                         'C',             
039800                                                         'D'.             
097900                                                                          
097901     05  PV-PREV-TRN-TYP-CDE-A       PIC X(01).                           
097902     05  PV-PREV-TRN-TYP-CDE         PIC X(01).                           
097903     05  PV-PREV-TRN-TYP-CDE-CVA     PIC X(01).                           
097904                                                                          
097905     05  PV-EVAL-REC-TYP-CDE         PIC X(06).                           
097906         88  REC-TYP-CVY-CON                       VALUE 'CVYA  ',        
097907                                                         'CVYB  ',        
097908                                                         'CONA  ',        
097909                                                         'CONB  ',        
097910                                                         'CNSEAL'.        
097911         88  REC-TYP-CVY                           VALUE 'CVYA  ',        
097912                                                         'CVYB  '.        
097913         88  REC-TYP-CON                           VALUE 'CONA  ',        
097914                                                         'CONB  '.        
097915         88  REC-TYP-CONPO                         VALUE 'CONPOA',        
097916                                                         'CONPOB',        
097917                                                         'CONPOC'.        
097918         88  REC-TYP-CONUP                         VALUE 'CONUPA',        
097919                                                         'CONUPB',        
097920                                                         'CONUPC',        
097921                                                         'CNCART'.        
097922         88  REC-TYP-CVYA                          VALUE 'CVYA  '.        
097923         88  REC-TYP-CVYB                          VALUE 'CVYB  '.        
097924         88  REC-TYP-CONA                          VALUE 'CONA  '.        
097925         88  REC-TYP-CONB                          VALUE 'CONB  '.        
097926         88  REC-TYP-CONPOA                        VALUE 'CONPOA'.        
097927         88  REC-TYP-CONPOB                        VALUE 'CONPOB'.        
097928         88  REC-TYP-CONPOC                        VALUE 'CONPOC'.        
097929         88  REC-TYP-CONUPA                        VALUE 'CONUPA'.        
097930         88  REC-TYP-CONUPB                        VALUE 'CONUPB'.        
097931         88  REC-TYP-CONUPC                        VALUE 'CONUPC'.        
097932         88  REC-TYP-CNCART                        VALUE 'CNCART'.        
097933         88  REC-TYP-CNSEAL                        VALUE 'CNSEAL'.        
097934         88  VALID-REC-TYP-CDE                     VALUE 'CVYA  ',        
097935                                                         'CVYB  ',        
097936                                                         'CONA  ',        
097937                                                         'CONB  ',        
097938                                                         'CONPOA',        
097939                                                         'CONPOB',        
097940                                                         'CONPOC',        
097941                                                         'CONUPA',        
097942                                                         'CONUPB',        
097943                                                         'CONUPC',        
097944                                                         'CNCART',        
097945                                                         'CNSEAL',        
097946                                                         'CTT   ',        
097947                                                         'IEA   ',        
097948                                                         'ISA   '.        
097949                                                                          
097950     05  PV-EDI-RECORDS              PIC  X(03).                          
097951         88  EDI-RECORD                            VALUE 'CTT',           
097952                                                         'IEA',           
097953                                                         'ISA'.           
097954         88  EDI-IEA-RECORD                        VALUE 'IEA'.           
097955                                                                          
097956     05  PV-HOLD-EDI-RECORD.                                              
097957         10  FILLER                  PIC X(32)     VALUE SPACES.          
097958         10  PV-EDI-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.          
097959         10  FILLER                  PIC X(01)     VALUE SPACES.          
097960         10  PV-EDI-VEND-ID          PIC X(15)     VALUE SPACES.          
097961         10  FILLER                  PIC X(20)     VALUE SPACES.          
097962         10  PV-EDI-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.          
097963         10  FILLER                  PIC X(01)     VALUE SPACES.          
097964         10  PV-EDI-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.          
097965         10  FILLER                  PIC X(09)     VALUE SPACES.          
097966         10  PV-EDI-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.          
097967         10  FILLER                  PIC X(51)     VALUE SPACES.          
097968         10  PV-INPUT-FILE-ID        PIC X(09)     VALUE SPACES.          
097969         10  PV-INPUT-ENT-ID         PIC X(09)     VALUE SPACES.          
097970         10  PV-INPUT-ENT-ID-9  REDEFINES                                 
097971             PV-INPUT-ENT-ID         PIC 9(09).                           
097972         10  FILLER                  PIC X(132)    VALUE SPACES.          
097973                                                                          
097974     05  PV-EXTENT-SCAC-CDE          PIC X(04)     VALUE SPACES.          
097975     05  PV-EXTENT-ENT-ID            PIC S9(09)    VALUE ZEROES           
097976                                                   COMP.                  
097977     05  PV-TMST                     PIC X(26)     VALUE SPACES.          
097978     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.          
097979     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.          
097980     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.          
097981     05  PV-CONT-INPUT-COUNT         PIC 9(09)     VALUE ZERO             
097982                                                    COMP-3.               
097983     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0               
097984                                                    COMP SYNC.            
097985     05  PV-FORMAT-DTE.                                                   
097986         10  PV-FORMAT-DTE-CCYY           PIC X(04)  VALUE SPACES.        
097987         10  PV-FORMAT-DTE-DASH1          PIC X(01)  VALUE '-'.           
097988         10  PV-FORMAT-DTE-MM             PIC X(02)  VALUE SPACES.        
097989         10  PV-FORMAT-DTE-DASH2          PIC X(01)  VALUE '-'.           
097990         10  PV-FORMAT-DTE-DD             PIC X(02)  VALUE SPACES.        
097991                                                                          
097992     05  PV-FORMAT-TM.                                                    
097993         10  PV-FORMAT-TM-HH              PIC X(02)  VALUE SPACES.        
097994         10  PV-FORMAT-TM-MM              PIC X(02)  VALUE SPACES.        
097995                                                                          
097996     05  PV-REFORMAT-10BYTE-FIELD         PIC X(10)  VALUE SPACES.        
097997                                                                          
097998     05  PV-REFORMAT-TMST.                                                
097999         10  PV-REFORMAT-TMST-DTE.                                        
098000             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.        
098001             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.        
098002             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.        
098003         10  PV-REFORMAT-TMST-TM.                                         
098004             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.        
098005             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.        
098006                                                                          
098007     05  PV-HDR-CONSOL-TRNS-DTE.                                          
098008         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.        
098009         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.        
098010                                                                          
098011     05  PV-QUANTITY-UNIT-VALUES.                                         
098012         10  PV-QUANTITY-VALUE            PIC Z(09)  VALUE ZEROES.        
098013         10  FILLER                       PIC X(02)  VALUE ' /'.          
098014         10  PV-UNIT-VALUE                PIC Z(09)  VALUE ZEROES.        
098015                                                                          
098016***************************************************************** 00010000
098017*    RECORD PURPOSE: RECORD LAYOUT FOR INITIALIZING             * 00020000
098018*                    CONTAINER MANIFEST - AREA                  * 00030000
098019*    RECORD LENGTH:  355                                        * 00040000
098020*    RECORD FORMAT:  BASED ON TRRD023                           * 00050000
098021***************************************************************** 00051000
098022 01  PV-23-INITIALIZE-CNTR.                                       00054000
098023     05 PV-23-IZCN-REC-KEY.                                       00055000
098024        10 PV-23-IZCN-TRN-TYP           PIC X(01).                00056000
098025        10 PV-23-IZCN-REC-TYP-CDE       PIC X(06).                00080000
098026        10 PV-23-IZCN-SEQ-NBR           PIC X(02).                00100000
098027        10 PV-23-IZCN-3RD-PARTY-CDE     PIC X(06).                00120000
098028        10 PV-23-IZCN-CONTNR-ID         PIC X(12).                00140000
098029        10 PV-23-IZCN-ACTL-DPRTR-DTE-MOM PIC X(08).               00141000
098030        10 PV-23-IZCN-ACTL-DPRTR-TM-MOM PIC X(04).                00142000
098031        10 PV-23-IZCN-EST-POE-DELY-DT-MOM PIC X(08).              00210000
098032        10 PV-23-IZCN-EST-POE-DELY-TM-MOM PIC X(04).              00210000
098033     05 PV-23-IZCN-IMPRT-TRIP-ID-MOM    PIC X(12).                        
098034     05 PV-23-IZCN-CARR-SCAC-ID-MOM     PIC X(04).                        
098035     05 PV-23-IZCN-IMP-VEH-NM-MOM       PIC X(25).                00223000
098036     05 PV-23-IZCN-ACTL-FOB-CDE-MOM     PIC X(05).                00230000
098037     05 PV-23-IZCN-DEST-POE-CDE-MOM     PIC X(04).                00240000
098038     05 PV-23-IZCN-TRIP-TYP-CDE-MOM     PIC X(01).                00250000
098039     05 PV-23-IZCN-EST-LBD-NM           PIC X(18).                00290000
098040     05 PV-23-IZCN-EST-LBD-DTE          PIC X(08).                00300000
098050     05 PV-23-IZCN-EST-LBD-TM           PIC X(04).                00310000
098060     05 PV-23-IZCN-POL-CDE-MOM          PIC X(05).                        
098061     05 PV-23-IZCN-POR-CDE-MOM          PIC X(05).                        
098062     05 PV-23-IZCN-ACTL-DPRTR-DTE-FDR   PIC X(08).                00311000
098063     05 PV-23-IZCN-ACTL-DPRTR-TM-FDR    PIC X(04).                00312000
098064     05 PV-23-IZCN-EST-POE-DELY-DT-FDR  PIC X(08).                00313000
098065     05 PV-23-IZCN-EST-POE-DELY-TM-FDR  PIC X(04).                00314000
098066     05 PV-23-IZCN-IMPRT-TRIP-ID-FDR    PIC X(12).                        
098067     05 PV-23-IZCN-CARR-SCAC-ID-FDR     PIC X(04).                        
098068     05 PV-23-IZCN-IMP-VEH-NM-FDR       PIC X(25).                00315000
098069     05 PV-23-IZCN-ACTL-FOB-CDE-FDR     PIC X(05).                00330000
098070     05 PV-23-IZCN-DEST-POE-CDE-FDR     PIC X(04).                00331000
098080     05 PV-23-IZCN-TRIP-TYP-CDE-FDR     PIC X(01).                00332000
098090     05 PV-23-IZCN-POL-CDE-FDR          PIC X(05).                        
098091     05 PV-23-IZCN-POR-CDE-FDR          PIC X(05).                        
098092     05 PV-23-IZCN-CONSOL-SCAC-ID       PIC X(04).                00336000
098093     05 PV-23-IZCN-CART-CNT             PIC 9(09).                00337000
098094     05 PV-23-IZCN-CART-CNT-X REDEFINES                           00338000
098095        PV-23-IZCN-CART-CNT             PIC X(09).                00339000
098096     05 PV-23-IZCN-UNT-QTY              PIC 9(09).                00339100
098097     05 PV-23-IZCN-UNT-QTY-X REDEFINES                            00339200
098098        PV-23-IZCN-UNT-QTY              PIC X(09).                00339300
098099     05 PV-23-IZCN-CBMT-QTY             PIC 9(09)V99.             00339400
098100     05 PV-23-IZCN-CBMT-QTY-X REDEFINES                           00339500
098101        PV-23-IZCN-CBMT-QTY             PIC X(11).                00339600
098102     05 PV-23-IZCN-WT-KGRM-QTY          PIC 9(09).                00339700
098103     05 PV-23-IZCN-WT-KGRM-QTY-X REDEFINES                        00339800
098104        PV-23-IZCN-WT-KGRM-QTY          PIC X(09).                00339900
098105     05 PV-23-IZCN-ORGN-SHPD-FR-CDE     PIC X(03).                00340000
098106     05 PV-23-IZCN-ORGN-SHPD-TO-CDE     PIC X(03).                00340300
098107     05 PV-23-IZCN-SIZE-CDE             PIC X(05).                00341200
098108     05 FILLER                          PIC X(18).                00342200
098109     05 PV-23-IZCN-FILE-ID              PIC X(09).                        
098110     05 PV-23-IZCN-DAT-SRC-ENT-ID       PIC 9(09).                00342301
098111     05 PV-23-IZCN-PROCESS-SEQ-NBR-1    PIC 9(06).                00342400
098112     05 PV-23-IZCN-PROCESS-SEQ-NBR-2    PIC 9(06).                00342500
098113     05 PV-23-IZCN-PROCESS-SEQ-NBR-3    PIC 9(06).                00342600
098114     05 PV-23-IZCN-PROCESS-SEQ-NBR-4    PIC 9(06).                00342700
098115*                                                                 00343000
098116 01  PV-23-INITIALIZE-CONPO.                                            00
098117     05 PV-23-IZPOA-REC-KEY.                                      00343600
098118        10 PV-23-IZPO-TRN-TYP           PIC X(01).                00344000
098119        10 PV-23-IZPO-REC-TYP-CDE      PIC X(06).                 00350000
098120        10 PV-23-IZPO-SEQ-NBR          PIC X(02).                 00370000
098121        10 PV-23-IZPO-3RD-PARTY-CDE    PIC X(06).                 00390000
098122        10 PV-23-IZPO-CONTNR-ID        PIC X(12).                 00410000
098123        10 PV-23-IZPO-ACTL-DPRTR-DTE   PIC X(08).                 00411000
098124        10 PV-23-IZPO-ACTL-DPRTR-TM    PIC X(04).                 00412000
098125        10 PV-23-IZPO-PO-NBR           PIC 9(09).                 00490000
098126        10 PV-23-IZPO-PO-NBR-X REDEFINES                          00500000
098127           PV-23-IZPO-PO-NBR           PIC X(09).                 00510000
098128        10 PV-23-IZPO-PO-RCVD-DELY-DTE PIC X(08).                 00520000
098129     05 PV-23-IZPO-CART-CNT            PIC 9(09).                 00530000
098130     05 PV-23-IZPO-CART-CNT-X REDEFINES                           00540000
098131        PV-23-IZPO-CART-CNT            PIC X(09).                 00550000
098132     05 PV-23-IZPO-UNT-QTY             PIC 9(09).                 00560000
098133     05 PV-23-IZPO-UNT-QTY-X REDEFINES                            00570000
098134        PV-23-IZPO-UNT-QTY             PIC X(09).                 00580000
098135     05 PV-23-IZPO-CBMT-QTY            PIC 9(07)V99.              00590000
098136     05 PV-23-IZPO-CBMT-QTY-X REDEFINES                           00600000
098137        PV-23-IZPO-CBMT-QTY            PIC X(09).                 00610000
098138     05 PV-23-IZPO-WT-KGRM-QTY         PIC 9(09).                 00620000
098139     05 PV-23-IZPO-WT-KGRM-QTY-X REDEFINES                        00630000
098140        PV-23-IZPO-WT-KGRM-QTY         PIC X(09).                 00640000
098141     05 PV-23-IZPO-LTR-OF-CR-NBR       PIC X(15).                 00650000
098142     05 PV-23-IZPO-HSE-BOL-NBR         PIC X(30).                 00660000
098143     05 PV-23-IZPO-MSTR-BOL-NBR        PIC X(30).                 00670000
098144     05 PV-23-IZPO-PO-C-O-PROD-CDE     PIC X(03).                 00680000
098145     05 FILLER                         PIC X(100).                00690000
098146     05 PV-23-IZPO-FILE-ID             PIC X(09).                 00691001
098147     05 PV-23-IZPO-DAT-SRC-ENT-ID      PIC 9(09).                 00691001
098148     05 PV-23-IZPO-PROCESS-SEQ-NBR-1   PIC 9(06).                 00700000
098149     05 PV-23-IZPO-PROCESS-SEQ-NBR-2   PIC 9(06).                 00701000
098150     05 PV-23-IZPO-PROCESS-SEQ-NBR-3   PIC 9(06).                 00702000
098151     05 PV-23-IZPO-FILLER-SEQ-NBR-4    PIC 9(06).                 00702000
098152*                                                                 00710000
098153 01 PV-23-INITIALIZE-CONUPC.                                      01190000
098154     05 PV-23-IZUPC-REC-KEY.                                      01200000
098155        10 PV-23-IZUPC-TRN-TYP             PIC X(01).             01210000
098156        10 PV-23-IZUPC-REC-TYP-CDE      PIC X(06).                01270000
098157        10 PV-23-IZUPC-SEQ-NBR          PIC X(02).                01290000
098158        10 PV-23-IZUPC-3RD-PARTY-CDE    PIC X(06).                01310000
098159        10 PV-23-IZUPC-CONTNR-ID        PIC X(12).                01330000
098160        10 PV-23-IZUPC-ACTL-DPRTR-DTE   PIC X(08).                01331000
098161        10 PV-23-IZUPC-ACTL-DPRTR-TM    PIC X(04).                01332000
098162        10 PV-23-IZUPC-PO-NBR           PIC 9(09).                01410000
098163        10 PV-23-IZUPC-PO-NBR-X REDEFINES                         01420000
098164           PV-23-IZUPC-PO-NBR           PIC X(09).                01430000
098165        10 PV-23-IZUPC-UPC-NBR          PIC 9(15).                01450000
098166        10 PV-23-IZUPC-UPC-NBR-X REDEFINES                        01460000
098167           PV-23-IZUPC-UPC-NBR          PIC X(15).                01470000
098168     05 PV-23-IZUPC-VS-NBR              PIC X(30).                01440000
098169     05 PV-23-IZUPC-CART-CNT            PIC 9(09).                01480000
098170     05 PV-23-IZUPC-CART-CNT-X REDEFINES                          01490000
098171        PV-23-IZUPC-CART-CNT            PIC X(09).                01500000
098172     05 PV-23-IZUPC-UNT-QTY             PIC 9(09).                01510000
098173     05 PV-23-IZUPC-UNT-QTY-X REDEFINES                           01520000
098174        PV-23-IZUPC-UNT-QTY             PIC X(09).                01530000
098175     05 PV-23-IZUPC-CBMT-QTY            PIC 9(07)V99.             01540000
098176     05 PV-23-IZUPC-CBMT-QTY-X REDEFINES                          01550000
098177        PV-23-IZUPC-CBMT-QTY            PIC X(09).                01560000
098178     05 PV-23-IZUPC-WT-KGRM-QTY         PIC 9(09).                01570000
098179     05 PV-23-IZUPC-WT-KGRM-QTY-X REDEFINES                       01580000
098180        PV-23-IZUPC-WT-KGRM-QTY         PIC X(09).                01590000
098181     05 PV-23-IZUPC-SKU                 PIC 9(08).                01630000
098182     05 PV-23-IZUPC-ASN-PKG-CDE         PIC X(02).                01630000
098183     05 FILLER                          PIC X(129).               01630000
098184     05 PV-23-IZUPC-FILE-ID             PIC X(09).                        
098185     05 PV-23-IZUPC-DAT-SRC-ENT-ID      PIC 9(09).                01631001
098186     05 PV-23-IZUPC-PROCESS-SEQ-NBR-1   PIC 9(06).                01640000
098187     05 PV-23-IZUPC-PROCESS-SEQ-NBR-2   PIC 9(06).                01650000
098188     05 PV-23-IZUPC-PROCESS-SEQ-NBR-3   PIC 9(06).                01660000
098189     05 PV-23-IZUPC-FILLER-SEQ-NBR-3    PIC 9(06).                01660000
098190                                                                          
098191 01  PV-GROUP-TABLE-VARIABLES.                                            
098192     05  PV-GRP-SUB                     PIC 9(4) COMP                     
098193                                                   VALUE ZERO.            
098194     05  PV-TBL-ROW-COUNT               PIC 9(4) COMP                     
098195                                                   VALUE ZERO.            
098196     05  PV-HOLD-CURRENT-TR013          PIC X(180) VALUE SPACES.          
098197     05  PV-HOLD-SEQ-NBR                PIC 9(6) COMP.                    
098198     05  PC-GRP-TBL-MAX                 PIC 9(4) COMP VALUE 10.           
098199     05  PV-HOLD-REC-TYP-CDE            PIC X(06).                        
098200                                                                          
098201 01  PV-GROUP-TABLE.                                                      
098202     05  PV-GRP-TBL-ROW  OCCURS 10 TIMES.                                 
098203        10  PV-GRP-TBL-TR013-REC  PIC X(150).                             
098204        10  PV-GRP-TBL-SEQ-NBR    PIC 9(6) COMP.                          
098205                                                                          
098206 01  PV-HOLD-GROUP-SEAL.                                                  
098207     05  PV-HOLD-GRP-REC-SEAL            PIC X(150).                      
098208     05  PV-HOLD-GRP-SEQ-SEAL            PIC 9(6) COMP.                   
098209                                                                          
098210 01  PV-HOLD-GROUP-CART.                                                  
098211     05  PV-HOLD-GRP-REC-CART            PIC X(150).                      
098212     05  PV-HOLD-GRP-SEQ-CART            PIC 9(6) COMP.                   
098213                                                                          
098214                                                                          
098215******************************************************************        
098216                                                                          
098217 LINKAGE SECTION.                                                         
098218                                                                          
098219                                                                          
098220 PROCEDURE DIVISION.                                                      
098221                                                                          
098222*******************************************************************       
098223*                                                                 *       
098224* PARAGRAPGHS                                                     *       
098225*                                                                 *       
098226*    1000-INITIALIZE.                                             *       
098227*                                                                         
098228*    2000-MAIN-LINE-PROCESS.                                      *       
098229*                                                                         
098230*    2010-CHECK-NEW-CONTAINER.                                    *       
098231*    2020-CHECK-NEW-GROUP.                                        *       
098232*    2030-CHECK-NEW-PO.                                           *       
098233*    2050-CHECK-NEW-UPC.                                          *       
098234*                                                                         
098235*    2100-NEW-GROUP.                                              *       
098236*    2200-FINISH-PREV-GROUP.                                      *       
098237*    2300-WRITE-ERRORS-FROM-TBL.                                  *       
098238*    2400-EDIT-KEY-FIELDS.                                        *       
098239*                                                                 *       
098240*  PROCESS TRIP/VEHICLE AND CONTAINER RECORDS                     *       
098241*                                                                 *       
098242*    3000-CHECK-CVY-CON-SEQUENCE.                                 *       
098243*    3100-CVYA-CVYB-CONA-CONB-RECS.                               *       
098244*    3200-EDIT-CVYA-FIELDS.                                       *       
098245*    3300-MOVE-CVYA-FIELDS.                                       *       
098246*    3400-EDIT-CVYB-FIELDS.                                       *       
098247*    3500-MOVE-CVYB-FIELDS.                                       *       
098248*    3600-EDIT-MOVE-CONA-FIELDS.                                  *       
098249*    3700-EDIT-MOVE-CONB-FIELDS.                                  *       
098250*                                                                 *       
098251*  PROCESS PURCHASE ORDER RECORDS                                 *       
098252*                                                                 *       
098253*    4000-EDIT-PO-NUMBER.                                         *       
098254*    4010-CHECK-CONPO-SEQUENCE.                                   *       
098255*    4100-CONPOA-CONPOB-CONPOC.                                   *       
098256*    4200-EDIT-MOVE-CONPOA-FIELDS.                                *       
098257*                                                                 *       
098258*  PROCESS UPC RECORDS                                            *       
098259*                                                                 *       
098260*    5500-EDIT-UPC-NUMBER.                                        *       
098261*    5510-CHECK-CONUP-SEQUENCE.                                   *       
098262*    5600-CONUPA-CONUPB-CONUPC.                                   *       
098263*    5610-EDIT-MOVE-CONUPA-FIELDS.                                *       
098264*    5620-EDIT-MOVE-CONUPB-FIELDS.                                *       
098265*    5630-EDIT-MOVE-CONUPC-FIELDS.                                *       
098266*                                                                 *       
098267*    6000-READ-CONTAINER-FILE.                                    *       
098268*                                                                 *       
098269*    6030-PROCESS-EDI-RECORD.                                     *       
098270*    6035-PROCESS-ISA-RECORD.                                     *       
098271*    6040-CHECK-IEA-RECORD.                                       *       
098272*                                                                         
098273*    6200-WRITE-ERR-REPORT.                                       *       
098274*                                                                 *       
098275*    6400-WRITE-UPDATE-RECORD.                                    *       
098276*                                                                 *       
098277*    6500-CALENDAR-ROUTINE-SET-UP.                                *       
098278*    6510-CALENDAR-ROUTINE.                                       *       
098279*    6515-VALIDATE-TIME.                                          *       
098280*    6600-SET-CURRENT-TMST.                                       *       
098281*    6700-SELECT-TENTNME.                                         *       
098282*                                                                 *       
098283*    7000-BUILD-ERROR-FILE.                                       *       
098284*    7010-CVYA-ERROR.                                             *       
098285*    7020-CVYB-ERROR.                                             *       
098286*    7030-CONA-ERROR.                                             *       
098287*    7040-CONB-ERROR.                                             *       
098288*    7050-CONPOA-ERROR.                                           *       
098289*    7060-CONPOB-ERROR.                                           *       
098290*    7070-CONPOC-ERROR.                                           *       
098291*    7090-CONUPA-ERROR.                                           *       
098292*    7100-CONUPB-ERROR.                                           *       
098293*    7110-CONUPC-ERROR.                                           *       
098294*                                                                 *       
098295*    7200-LOAD-GROUP-TABLE.                                       *       
098296*    7300-EDIT-COMMON-FIELDS.                                     *       
098297*                                                                 *       
098298*    8000-EOJ-ROUTINE.                                            *       
098299*                                                                 *       
098300*    9100-USER-ABEND.                                             *       
098301*******************************************************************       
098302******************************************************************        
098303*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *        
098304******************************************************************        
098305 0000-PROGRAM-MAINLINE.                                                   
098306                                                                          
098307     PERFORM 1000-INITIALIZE.                                             
098308                                                                          
098309     PERFORM 2000-MAIN-LINE-PROCESS                                       
098310         UNTIL PS-END-OF-CONTAINERS.                                      
098311                                                                          
098312     PERFORM 8000-EOJ-ROUTINE.                                            
098313     STOP RUN.                                                            
098314                                                                          
098315******************************************************************        
098316*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *        
098317*  JOB PROCESSES.                                                *        
098318******************************************************************        
098319                                                                          
098320 1000-INITIALIZE.                                                         
098321                                                                          
098322     OPEN INPUT TR013-CONTAINER-FILE                                      
098323         OUTPUT TR023-UPDATE-CONTAINER-FILE                               
098324                TR211-CONTAINER-ERROR-FILE.                               
098325                                                                          
098326     INITIALIZE PV-23-INITIALIZE-CNTR                                     
098327                PV-23-INITIALIZE-CONPO                                    
098328                PV-23-INITIALIZE-CONUPC.                                  
098329     MOVE PC-DEFAULT-DTE-NO-DASHES                                        
098330                            TO PV-23-IZCN-ACTL-DPRTR-DTE-FDR              
098331                              PV-23-IZCN-EST-POE-DELY-DT-FDR.             
098332     MOVE PC-DEFAULT-TIME   TO PV-23-IZCN-ACTL-DPRTR-TM-FDR               
098333                              PV-23-IZCN-EST-POE-DELY-TM-FDR.             
098334                                                                          
098335     MOVE PC-IEA TO PV-HOLD-LAST-REC-TYP.                                 
098336                                                                          
098337     PERFORM 6000-READ-CONTAINER-FILE                                     
098338         UNTIL PS-CONTAINER-RECORD OR PS-END-OF-CONTAINERS.               
098339     SET PS-CONTAINER-RECORD-NO TO TRUE.                                  
098340                                                                          
098341     IF PS-END-OF-CONTAINERS                                              
098342         MOVE PC-EMPTY       TO PV-HOLD-TR211-ERROR-TYPE                  
098343     END-IF.                                                              
098344                                                                          
098345 EJECT                                                                    
098346******************************************************************        
098347* MAIN PROCESSING PARAGRAPH.                                     *        
098348******************************************************************        
098349                                                                          
098350 2000-MAIN-LINE-PROCESS.                                                  
098351                                                                          
098352     MOVE TR013-CVYA-REC-TYP-CDE        TO PV-EVAL-REC-TYP-CDE.           
098353     MOVE TR013-CVYA-TRN-TYP            TO PV-EVAL-TRN-TYP-CDE.           
098354                                                                          
098355     IF PREV-TYP-ISA                                                      
098356       SET PS-NEW-CONTAINER     TO TRUE                                   
098357       SET PS-NEW-GROUP         TO TRUE                                   
098358     ELSE                                                                 
098359       SET PS-NEW-CONTAINER-NO  TO TRUE                                   
098360       SET PS-NEW-GROUP-NO      TO TRUE                                   
098361       SET PS-NEW-PO-NO         TO TRUE                                   
098362       SET PS-NEW-UPC-NO        TO TRUE                                   
098363       PERFORM 2010-CHECK-NEW-CONTAINER                                   
098364       IF PS-NEW-CONTAINER                                                
098365        CONTINUE                                                          
098366       ELSE                                                               
098367         IF PS-SPIN-CONTAINER                                             
098368           CONTINUE                                                       
098369         ELSE                                                             
098370           PERFORM 2020-CHECK-NEW-GROUP                                   
098371       END-IF                                                             
098372     END-IF.                                                              
098373                                                                          
098374     EVALUATE TRUE                                                        
098375                                                                          
098376      WHEN PS-NEW-CONTAINER                                               
098377                                                                          
098378        SET PS-NEW-GROUP                                                  
098379            PS-CVY-CON-WRITTEN-NO                                         
098380            PS-CONPO-WRITTEN-NO                                           
098381            PS-CONUP-WRITTEN-NO         TO TRUE                           
098382            MOVE TR013-CVYA-TRN-TYP                                       
098383                                 TO PV-PREV-TRN-TYP-CDE-CVA               
098384        PERFORM 2200-FINISH-PREV-GROUP                                    
098385        SET PS-SPIN-CONTAINER-NO TO TRUE                                  
098386                                                                          
098387        PERFORM 2400-EDIT-KEY-FIELDS                                      
098388        IF PS-KEY-FIELDS-OK                                               
098389          IF PS-EDIT-WARNING                                              
098390            PERFORM 7000-BUILD-ERROR-FILE                                 
098391          END-IF                                                          
098392          PERFORM 2100-NEW-GROUP                                          
098393        ELSE                                                              
098394          SET PS-SPIN-CONTAINER TO TRUE                                   
098395        END-IF                                                            
098396                                                                          
098397      WHEN PS-NEW-GROUP                                                   
098398                                                                          
098399        PERFORM 2200-FINISH-PREV-GROUP                                    
098400        PERFORM 2100-NEW-GROUP                                            
098401                                                                          
098402                                                                          
098403     END-EVALUATE.                                                        
098404                                                                          
098405                                                                          
098406     EVALUATE TRUE                                                        
098407                                                                          
098408        WHEN PS-SPIN-CONTAINER                                            
098409            PERFORM 7000-BUILD-ERROR-FILE                                 
098410                                                                          
098411        WHEN PS-SPIN-GROUP                                                
098412            IF  TR013-CVYA-TRN-TYP-DEL                                    
098413              IF  REC-TYP-CVYA                                            
098414                MOVE 'DUPLICATE DELETE RECORD SENT'                       
098415                                   TO PV-HOLD-TR211-ERROR-MSG             
098416              END-IF                                                      
098417            END-IF                                                        
098418            PERFORM 7000-BUILD-ERROR-FILE                                 
098419                                                                          
098420        WHEN REC-TYP-CVY-CON                                              
098421            PERFORM 3000-CHECK-CVY-CON-SEQUENCE                           
098422            IF PS-SEQUENCE-ERROR                                          
098423              SET PS-SPIN-GROUP TO TRUE                                   
098424            ELSE                                                          
098425              PERFORM 3100-CVYA-CVYB-CONA-CONB-RECS                       
098426            END-IF                                                        
098427                                                                          
098428        WHEN REC-TYP-CONPO                                                
098429          PERFORM 4010-CHECK-CONPO-SEQUENCE                               
098430          IF PS-SEQUENCE-ERROR                                            
098431            SET PS-SPIN-GROUP TO TRUE                                     
098432          ELSE                                                            
098433            PERFORM 4000-EDIT-PO-NUMBER                                   
098434            IF PS-EDIT-ERROR                                              
098435             MOVE PC-ERROR         TO PV-HOLD-TR211-ERROR-TYPE            
098436             MOVE 'CONPO LEVEL    '                                       
098437                               TO PV-HOLD-TR211-DATA-IN-ERROR             
098438             MOVE 'CONPO DATA MISSING'                                    
098439                                   TO PV-HOLD-TR211-ERROR-MSG             
098440             MOVE SPACES           TO PV-HOLD-TR211-DATA-VALUE            
098441             MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP             
098442             SET PS-SPIN-GROUP TO TRUE                                    
098443            ELSE                                                          
098444             PERFORM 4100-CONPOA-CONPOB-CONPOC                            
098445            END-IF                                                        
098446          END-IF                                                          
098447                                                                          
098448        WHEN REC-TYP-CONUP                                                
098449          PERFORM 5510-CHECK-CONUP-SEQUENCE                               
098450          IF PS-SEQUENCE-ERROR                                            
098451            SET PS-SPIN-GROUP TO TRUE                                     
098452          ELSE                                                            
098453            PERFORM 4000-EDIT-PO-NUMBER                                   
098454            PERFORM 5000-EDIT-VS-NUMBER                                   
098455            PERFORM 5500-EDIT-UPC-NUMBER                                  
098456            IF PS-EDIT-ERROR                                              
098457              MOVE PC-ERROR         TO PV-HOLD-TR211-ERROR-TYPE           
098458              MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP            
098459              MOVE 'CONUP LEVEL    '                                      
098460                                TO PV-HOLD-TR211-DATA-IN-ERROR            
098461              MOVE 'UPC DATA MISSING'                                     
098462                                    TO PV-HOLD-TR211-ERROR-MSG            
098463              MOVE SPACES           TO PV-HOLD-TR211-DATA-VALUE           
098464              SET PS-EDIT-ERROR-NO TO TRUE                                
098465              SET PS-SPIN-GROUP TO TRUE                                   
098466            ELSE                                                          
098467               PERFORM 5600-CONUPA-CONUPB-CONUPC                          
098468            END-IF                                                        
098469          END-IF                                                          
098470                                                                          
098471     END-EVALUATE.                                                        
098472                                                                          
098473     MOVE TR013-CVYA-REC-KEY          TO PV-PREV-REC-KEY                  
098474                                         PV-PREV-REC-KEY-A.               
098475     MOVE TR013-CVYA-TRN-TYP          TO PV-PREV-TRN-TYP-CDE              
098476                                         PV-PREV-TRN-TYP-CDE.             
098477                                                                          
098478     SET PS-CONTAINER-RECORD-NO TO TRUE.                                  
098479                                                                          
098500     PERFORM 6000-READ-CONTAINER-FILE                                     
098600         UNTIL PS-CONTAINER-RECORD OR PS-END-OF-CONTAINERS.               
098700                                                                          
098800 EJECT                                                                    
098900************************************************************************  
099000                                                                          
099100 2010-CHECK-NEW-CONTAINER.                                                
099200                                                                          
099300     IF   TR013-CVYA-CONTNR-ID   NOT =   PV-PREV-CONTNR-ID                
099400      OR TR013-CVYA-ACTL-DPRTR-DTE-MOM   NOT =                            
099500                                PV-PREV-ACTL-DPRTR-DTE-MOM                
099600      OR TR013-CVYA-ACTL-DPRTR-TM-MOM    NOT =                            
099700                                PV-PREV-ACTL-DPRTR-TM-MOM                 
099800       SET PS-NEW-CONTAINER    TO TRUE                                    
099900     END-IF.                                                              
100000                                                                          
100100************************************************************************  
100200                                                                          
100300 2020-CHECK-NEW-GROUP.                                                    
100400                                                                          
100500     EVALUATE TRUE                                                        
100600                                                                          
100700      WHEN TR013-CVYA-TRN-TYP  NOT =  PV-PREV-TRN-TYP-CDE                 
100800       SET PS-NEW-GROUP    TO TRUE                                        
100900                                                                          
101000                                                                          
101100      WHEN REC-TYP-CVY-CON                                                
101200                                                                          
101300       IF PREV-TYP-CVY-CON                                                
101400         CONTINUE                                                         
101500       ELSE                                                               
101600         SET PS-NEW-GROUP TO TRUE                                         
101700       END-IF                                                             
101800                                                                          
101900                                                                          
102000      WHEN REC-TYP-CONPO                                                  
102100                                                                          
102200       IF PREV-TYP-CONPO                                                  
102300         MOVE TR013-CONPOA-PO-NBR-X TO PV-CURR-PO-NBR-X                   
102400         MOVE PV-SAVE-PREV-PO-NBR-X TO PV-PREV-PO-NBR-X                   
102500         PERFORM 2030-CHECK-NEW-PO                                        
102600       ELSE                                                               
102700         SET PS-NEW-PO    TO TRUE                                         
102800       END-IF                                                             
102900       IF PS-NEW-PO                                                       
103000         SET PS-NEW-GROUP TO TRUE                                         
103100         IF TR013-CONPOA-PO-NBR NUMERIC                                   
103200           MOVE TR013-CONPOA-PO-NBR  TO PV-SAVE-PREV-PO-NBR               
103300         ELSE                                                             
103400           MOVE TR013-CONPOA-PO-NBR-X TO PV-SAVE-PREV-PO-NBR-X            
103500         END-IF                                                           
103600       END-IF                                                             
105700                                                                          
105800      WHEN REC-TYP-CONUP                                                  
105900                                                                          
106000       IF PREV-TYP-CONUP                                                  
106100         PERFORM 2050-CHECK-NEW-UPC                                       
106200       ELSE                                                               
106300         SET PS-NEW-UPC TO TRUE                                           
106400       END-IF                                                             
106500       IF PS-NEW-UPC                                                      
106600         SET PS-NEW-GROUP TO TRUE                                         
106700         IF TR013-CONUPA-UPC-NBR NUMERIC                                  
106800           MOVE TR013-CONUPA-UPC-NBR TO PV-PREV-UPC-NBR                   
106900         ELSE                                                             
107000           MOVE TR013-CONUPA-UPC-NBR-X TO PV-PREV-UPC-NBR-X               
107100         END-IF                                                           
107200       END-IF                                                             
107300                                                                          
107400       MOVE PV-LAST-GOOD-PO-NBR    TO PV-PREV-PO-NBR                      
107500       MOVE TR013-CONUPA-PO-NBR-X  TO PV-CURR-PO-NBR-X                    
107600       PERFORM 2030-CHECK-NEW-PO                                          
108100                                                                          
108200     END-EVALUATE.                                                        
108300                                                                          
108400************************************************************************  
108500                                                                          
108600 2030-CHECK-NEW-PO.                                                       
108700                                                                          
108800     IF PV-CURR-PO-NBR   NUMERIC                                          
108900       AND PV-PREV-PO-NBR     NUMERIC                                     
109000         IF PV-CURR-PO-NBR   NOT =  PV-PREV-PO-NBR                        
109100           SET PS-NEW-PO TO TRUE                                          
109200         END-IF                                                           
109300     ELSE                                                                 
109400       SET PS-NEW-PO TO TRUE                                              
109500     END-IF.                                                              
110600                                                                          
110700************************************************************************  
110800                                                                          
110900 2050-CHECK-NEW-UPC.                                                      
111000                                                                          
111100     IF TR013-CONUPA-UPC-NBR   NUMERIC                                    
111200       AND PV-PREV-UPC-NBR     NUMERIC                                    
111300         IF TR013-CONUPA-UPC-NBR  =  PV-PREV-UPC-NBR                      
111400           CONTINUE                                                       
111500         ELSE                                                             
111600           SET PS-NEW-UPC TO TRUE                                         
111700         END-IF                                                           
111800     ELSE                                                                 
111900       SET PS-NEW-UPC TO TRUE                                             
112000     END-IF.                                                              
112100                                                                          
112200 EJECT                                                                    
112300                                                                          
112400************************************************************************  
112500                                                                          
112600 2100-NEW-GROUP.                                                          
112700                                                                          
112800     IF VALID-REC-TYP-CDE                                                 
112900       CONTINUE                                                           
113000     ELSE                                                                 
113100       MOVE PC-ERROR         TO  PV-HOLD-TR211-ERROR-TYPE                 
113200       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
113300       MOVE 'RECORD TYPE    '  TO  PV-HOLD-TR211-DATA-IN-ERROR            
113400       MOVE 'INVALID RECORD TYPE'                                         
113500                                 TO  PV-HOLD-TR211-ERROR-MSG              
113600       MOVE TR013-CVYA-REC-TYP-CDE                                        
113700                                 TO  PV-HOLD-TR211-DATA-VALUE             
113800       SET PS-SPIN-GROUP     TO TRUE                                      
113900     END-IF.                                                              
114000                                                                          
114100     IF VALID-TRN-TYP-CDE                                                 
114200       CONTINUE                                                           
114300     ELSE                                                                 
114400       MOVE PC-ERROR         TO  PV-HOLD-TR211-ERROR-TYPE                 
114500       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
114600       MOVE 'TRAN TYPE      '    TO  PV-HOLD-TR211-DATA-IN-ERROR          
114700       MOVE 'INVALID TRANSACTION TYPE'                                    
114800                                 TO  PV-HOLD-TR211-ERROR-MSG              
114900       MOVE TR013-CVYA-TRN-TYP                                            
115000                                 TO  PV-HOLD-TR211-DATA-VALUE             
115100       SET PS-SPIN-GROUP     TO TRUE                                      
115200     END-IF.                                                              
115300                                                                          
115400     EVALUATE TRUE                                                        
115500                                                                          
115600*     ********************************************************            
115700*     * NEW CONTAINERS MUST START WITH CVYA                  *            
115800*     * DELETE GROUPS MUST START WITH CVYA                   *            
115900*     ********************************************************            
116000        WHEN PS-NEW-CONTAINER                                             
116100        WHEN TR013-CVYA-TRN-TYP-DEL                                       
116200         IF REC-TYP-CVYA                                                  
116300           CONTINUE                                                       
116400         ELSE                                                             
116500           MOVE PC-ERROR         TO  PV-HOLD-TR211-ERROR-TYPE             
116600           MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP               
116700           MOVE PV-EVAL-REC-TYP-CDE                                       
116800                        TO  PV-HOLD-TR211-DATA-IN-ERROR (1:6)             
116900           MOVE ' LEVEL   '                                               
117000                        TO  PV-HOLD-TR211-DATA-IN-ERROR (7:9)             
117100           MOVE 'CVYA DATA MISSING'                                       
117200                                 TO  PV-HOLD-TR211-ERROR-MSG              
117300           MOVE SPACES           TO  PV-HOLD-TR211-DATA-VALUE             
117400           SET PS-SPIN-GROUP     TO  TRUE                                 
117500         END-IF                                                           
117600                                                                          
117700*     ********************************************************            
117800*     * NEW TRAN TYPE (ADD DELETE CHANGE) MUST START W/ CVYA *            
117900*     ********************************************************            
118000        WHEN TR013-CVYA-TRN-TYP                                           
118100                              NOT =    PV-PREV-TRN-TYP-CDE-CVA            
118200         IF REC-TYP-CVYA                                                  
118300           MOVE TR013-CVYA-TRN-TYP                                        
118400                                 TO PV-PREV-TRN-TYP-CDE-CVA               
118500         ELSE                                                             
118600           MOVE PC-ERROR         TO  PV-HOLD-TR211-ERROR-TYPE             
118700           MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP               
118800           MOVE 'TRAN TYPE'      TO PV-HOLD-TR211-DATA-IN-ERROR           
118900           MOVE 'TRAN TYPE CHANGED'                                       
119000                                 TO  PV-HOLD-TR211-ERROR-MSG              
119100           MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-DATA-VALUE            
119200           SET PS-SPIN-GROUP     TO  TRUE                                 
119300         END-IF                                                           
119400                                                                          
119500     END-EVALUATE.                                                        
119600                                                                          
119700 EJECT                                                                    
119800                                                                          
119900************************************************************************  
120000* CHECK TO SEE IF THERE ARE ANY UNPROCESSED INPUT RECORDS FROM THE PREV   
120100* GROUP THAT NEED TO WRITTEN TO THE ERROR FILE.                           
120200* (IF YOU WERE SPINNING THE PREV CNTNR OR GRP DON'T CHECK IF COMPLETE.)   
120300* ALSO RESET GROUP SWITCHES AND CLEAR ERROR TABLE.                        
120400************************************************************************  
120500                                                                          
120600 2200-FINISH-PREV-GROUP.                                                  
120700                                                                          
120800     EVALUATE TRUE                                                        
120900                                                                          
121000       WHEN PS-SPIN-GROUP                                                 
121100       WHEN PS-SPIN-CONTAINER                                             
121200       WHEN PV-GRP-SUB = ZERO                                             
121300         CONTINUE                                                         
121400                                                                          
121500       WHEN OTHER                                                         
121600         MOVE PC-ERROR       TO  PV-HOLD-TR211-ERROR-TYPE                 
121700         MOVE PV-PREV-REC-TYP-CDE                                         
121800                    TO  PV-HOLD-TR211-DATA-IN-ERROR (1:6)                 
121900         MOVE ' LEVEL   '                                                 
122000                    TO  PV-HOLD-TR211-DATA-IN-ERROR (7:9)                 
122100         EVALUATE TRUE                                                    
122200           WHEN PREV-TYP-CVYA                                             
122300           WHEN PREV-TYP-CVYB                                             
122400               MOVE 'CON DATA MISSING'                                    
122500                              TO  PV-HOLD-TR211-ERROR-MSG                 
122600           WHEN PREV-TYP-CONA                                             
122700               MOVE 'CONB DATA MISSING'                                   
122800                              TO  PV-HOLD-TR211-ERROR-MSG                 
122900           WHEN PREV-TYP-CONPOA                                           
123000               MOVE 'CONPOB DATA MISSING'                                 
123100                              TO  PV-HOLD-TR211-ERROR-MSG                 
123200           WHEN PREV-TYP-CONPOB                                           
123300               MOVE 'CONPOC DATA MISSING'                                 
123400                              TO  PV-HOLD-TR211-ERROR-MSG                 
123500           WHEN PREV-TYP-CONUPA                                           
123600               MOVE 'CONUPB DATA MISSING'                                 
123700                              TO  PV-HOLD-TR211-ERROR-MSG                 
123800           WHEN PREV-TYP-CONUPB                                           
123900               MOVE 'CONUPC DATA MISSING'                                 
124000                              TO  PV-HOLD-TR211-ERROR-MSG                 
124100           WHEN PREV-TYP-CONUPC                                           
124200              MOVE PC-WARNING      TO PV-HOLD-TR211-ERROR-TYPE            
124300              MOVE PV-HOLD-GRP-REC-CART TO PV-GRP-TBL-TR013-REC(1))       
124400              MOVE PV-HOLD-GRP-SEQ-CART TO PV-GRP-TBL-SEQ-NBR(1)          
124500              MOVE 1               TO PV-GRP-SUB                          
124600              MOVE SPACES          TO PV-HOLD-TR211-DATA-VALUE            
124700              MOVE                                                        
124800               'FACTORY SET UP FOR LABELING BUT NO SSCC IDS SENT'         
124801                                   TO  PV-HOLD-TR211-ERROR-MSG            
124802         END-EVALUATE                                                     
124803         PERFORM 2300-WRITE-ERRORS-FROM-TBL                               
124804                                                                          
124805     END-EVALUATE.                                                        
124806                                                                          
124807     IF  (PS-NEW-CONTAINER OR EDI-RECORD)                                 
124808     AND PS-SEAL-ERR-WRITEN-NO                                            
124809         MOVE 1                   TO PV-GRP-SUB                           
124810         MOVE PV-HOLD-GRP-REC-SEAL TO PV-GRP-TBL-TR013-REC(1)             
124820         ADD  +1                   TO PV-PROCESS-SEQ-NBR                  
124830         MOVE PV-PROCESS-SEQ-NBR   TO PV-GRP-TBL-SEQ-NBR(1)               
124840         MOVE 'CON LEVEL'                                                 
124850                    TO  PV-HOLD-TR211-DATA-IN-ERROR                       
124860         MOVE 'CNSEAL'              TO PV-HOLD-TR211-DATA-VALUE           
124870         MOVE PC-WARNING            TO PV-HOLD-TR211-ERROR-TYPE           
124880         MOVE 'CNSEAL DATA MISSING' TO PV-HOLD-TR211-ERROR-MSG            
124890         SET PS-SEAL-ERR-WRITEN     TO TRUE                               
124900         PERFORM 2300-WRITE-ERRORS-FROM-TBL                               
125000     END-IF.                                                              
125100                                                                          
125200     IF PS-NEW-CONTAINER                                                  
125300     OR EDI-RECORD                                                        
125400        SET PS-CONA-WRITEN-NO TO TRUE                                     
125501     END-IF.                                                              
125502                                                                          
125503     SET PS-SPIN-GROUP-NO       TO TRUE.                                  
125504                                                                          
125505     INITIALIZE PV-GROUP-TABLE                                            
125506                PV-GRP-SUB.                                               
125507                                                                          
125508************************************************************************  
125509* ALL OF THE GOOD RECORDS FOR EACH GROUP (CNTNR, PO, OR UPC) ARE  E    *  
125510* SAVED ON A TABLE.  IF THE COMPLETE GROUP DOESN'T GET SENT OR RECORDS *  
125511* AREN'T IN THE RIGHT ORDER, THEY GET WRITTEN AS ERRORS.               *  
125512************************************************************************  
125600                                                                          
125700 2300-WRITE-ERRORS-FROM-TBL.                                              
125800                                                                          
125810     DISPLAY TR013-REC-TYP-CVYA '1'.                                      
125900     MOVE TR013-REC-TYP-CVYA    TO PV-HOLD-CURRENT-TR013.                 
125910     DISPLAY PV-HOLD-CURRENT-TR013 '1'.                                   
126000     MOVE PV-EVAL-REC-TYP-CDE   TO PV-HOLD-REC-TYP-CDE.                   
126100     MOVE PV-PROCESS-SEQ-NBR    TO PV-HOLD-SEQ-NBR.                       
126200     MOVE PV-GRP-SUB            TO PV-TBL-ROW-COUNT.                      
126300                                                                          
126400     PERFORM  VARYING PV-GRP-SUB FROM 1 BY 1                              
126500           UNTIL PV-GRP-SUB > PV-TBL-ROW-COUNT                            
126600       MOVE PV-GRP-TBL-SEQ-NBR (PV-GRP-SUB)                               
126700                                    TO PV-PROCESS-SEQ-NBR                 
126800       MOVE PV-GRP-TBL-TR013-REC (PV-GRP-SUB)                             
126900                                    TO TR013-REC-TYP-CVYA                 
127000       MOVE TR013-CVYA-REC-TYP-CDE  TO PV-EVAL-REC-TYP-CDE                
127100       MOVE TR013-CVYA-TRN-TYP      TO PV-HOLD-TR211-TRN-TYP              
127200       PERFORM 7000-BUILD-ERROR-FILE                                      
127300     END-PERFORM.                                                         
127400                                                                          
127500     MOVE PV-HOLD-CURRENT-TR013   TO TR013-REC-TYP-CVYA.                  
127600     MOVE PV-HOLD-SEQ-NBR         TO PV-PROCESS-SEQ-NBR.                  
127700     MOVE PV-HOLD-REC-TYP-CDE     TO PV-EVAL-REC-TYP-CDE.                 
127800                                                                          
127900 EJECT                                                                    
128000                                                                          
128100************************************************************************  
128200* EDIT CONTAINER KEY FIELDS AND SET A SWITCH IF THEY PASS.  ERRORS     *  
128300* WILL CAUSE ALL RECORDS MATCHING THE KEY TO SPIN THROUGH.  WARNINGS   *  
128400* DON'T CAUSE A SPIN.                                                  *  
128500************************************************************************  
128600                                                                          
128700 2400-EDIT-KEY-FIELDS.                                                    
128800                                                                          
128900     SET PS-KEY-FIELDS-OK                                                 
129000         PS-EDIT-WARNING-NO      TO TRUE.                                 
129100                                                                          
129200     MOVE TR013-CVYA-CONTNR-ID TO PV-HOLD-TR211-CONTNR-ID.                
129300     MOVE TR013-CVYA-ACTL-DPRTR-DTE-MOM                                   
129400                          TO PV-HOLD-TR211-ACTL-DPRTR-DTE-M.              
129500     MOVE TR013-CVYA-ACTL-DPRTR-TM-MOM                                    
129600                          TO PV-HOLD-TR211-ACTL-DPRTR-TM-M.               
129700                                                                          
129800     IF TR013-CVYA-CONTNR-ID (1:1)  NUMERIC                               
129900       OR TR013-CVYA-CONTNR-ID (2:1)  NUMERIC                             
130000       OR TR013-CVYA-CONTNR-ID (3:1)  NUMERIC                             
130100       OR TR013-CVYA-CONTNR-ID (4:1)  NUMERIC                             
130200       IF TR013-CVYA-TRIP-TYP-CDE-MOM = PC-A                              
130300         CONTINUE                                                         
130400       ELSE                                                               
130500         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
130600         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
130700         SET  PS-EDIT-WARNING      TO TRUE                                
130800         MOVE 'CONTAINER ID'    TO PV-HOLD-TR211-DATA-IN-ERROR            
130900         MOVE                                                             
131000          'CONTAINER DOES NOT BEGIN WITH 4 ALPHA CHARACTERS'              
131100                                  TO PV-HOLD-TR211-ERROR-MSG              
131200         MOVE TR013-CVYA-CONTNR-ID                                        
131300                                  TO  PV-HOLD-TR211-DATA-VALUE            
131400       END-IF                                                             
131500     END-IF                                                               
131600                                                                          
131700     EVALUATE TRUE                                                        
131800                                                                          
131900      WHEN TR013-CVYA-CONTNR-ID    EQUAL SPACES                           
132000        SET  PS-KEY-FIELDS-OK-NO  TO TRUE                                 
132100        MOVE PC-ERROR             TO PV-HOLD-TR211-ERROR-TYPE             
132200        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
132300        MOVE 'CONTAINER ID ' TO                                           
132400                          PV-HOLD-TR211-DATA-IN-ERROR                     
132500        MOVE 'CONTAINER NUMBER NOT SENT'                                  
132600                               TO PV-HOLD-TR211-ERROR-MSG                 
132700        MOVE SPACES            TO  PV-HOLD-TR211-DATA-VALUE               
132800                                                                          
132900      WHEN TR013-CVYA-CONTNR-ID (1:1)  EQUAL SPACE                        
133000        MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE             
133100        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
133200        SET  PS-EDIT-WARNING      TO TRUE                                 
133300        MOVE 'CONTAINER ID'      TO PV-HOLD-TR211-DATA-IN-ERROR           
133400        MOVE 'CONTAINER NUMBER HAS SPACE IN FIRST POSITION'               
133500                                  TO PV-HOLD-TR211-ERROR-MSG              
133600        MOVE TR013-CVYA-CONTNR-ID TO  PV-HOLD-TR211-DATA-VALUE            
133700                                                                          
133800      WHEN TR013-CVYA-ACTL-DPRTR-DTE-MOM EQUAL SPACES                     
133900        SET  PS-KEY-FIELDS-OK-NO  TO TRUE                                 
134000        MOVE PC-ERROR             TO PV-HOLD-TR211-ERROR-TYPE             
134100        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
134200        MOVE 'ACTL DPTR DTE'                                              
134300                             TO PV-HOLD-TR211-DATA-IN-ERROR               
134400        MOVE 'ACTUAL DEPARTURE DATE NOT SENT'                             
134500                              TO PV-HOLD-TR211-ERROR-MSG                  
134600        MOVE SPACES           TO  PV-HOLD-TR211-DATA-VALUE                
134700                                                                          
134800      WHEN OTHER                                                          
134900        MOVE TR013-CVYA-ACTL-DPRTR-DTE-MOM (1:4)  TO                      
135000                PV-FORMAT-DTE-CCYY                                        
135100        MOVE TR013-CVYA-ACTL-DPRTR-DTE-MOM (5:2)  TO                      
135200                PV-FORMAT-DTE-MM                                          
135300        MOVE TR013-CVYA-ACTL-DPRTR-DTE-MOM (7:2)  TO                      
135400                PV-FORMAT-DTE-DD                                          
135500        PERFORM 6500-CALENDAR-ROUTINE-SET-UP                              
135600        PERFORM 6510-CALENDAR-ROUTINE                                     
135700        IF PS-WARNING-DATE                                                
135800          SET  PS-KEY-FIELDS-OK-NO  TO TRUE                               
135900          MOVE PC-ERROR           TO PV-HOLD-TR211-ERROR-TYPE             
136000          MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                
136100          MOVE 'ACTL DPTR DTE'                                            
136200                               TO PV-HOLD-TR211-DATA-IN-ERROR             
136300          MOVE 'ACTUTAL DEPARTURE DATE NOT VALID'                         
136400                               TO PV-HOLD-TR211-ERROR-MSG                 
136500          MOVE TR013-CVYA-ACTL-DPRTR-DTE-MOM                              
136600                               TO  PV-HOLD-TR211-DATA-VALUE               
136700        END-IF                                                            
136800                                                                          
136900      END-EVALUATE.                                                       
137000                                                                          
137100      MOVE TR013-CVYA-ACTL-DPRTR-TM-MOM   TO PV-CHECK-TIME.               
137200      PERFORM 6515-VALIDATE-TIME.                                         
137300      IF PS-WARNING-TIME                                                  
137400        MOVE PC-DEFAULT-TIME TO PV-HOLD-TR211-ACTL-DPRTR-TM-M             
137500      END-IF.                                                             
137600                                                                          
137700 EJECT                                                                    
137800                                                                          
137900************************************************************************  
138000                                                                          
138100 3000-CHECK-CVY-CON-SEQUENCE.                                             
138200                                                                          
138300     SET PS-SEQUENCE-ERROR-NO   TO TRUE.                                  
138400                                                                          
138500     EVALUATE TRUE                                                        
138600                                                                          
138700       WHEN REC-TYP-CVYA                                                  
138800         IF PS-NEW-GROUP                                                  
138900           CONTINUE                                                       
139000         ELSE                                                             
139100           SET PS-SEQUENCE-ERROR    TO TRUE                               
139200           MOVE 'CVYA SEQUENCE ERROR'                                     
139300                            TO PV-HOLD-TR211-ERROR-MSG                    
139400         END-IF                                                           
139500                                                                          
139600       WHEN REC-TYP-CVYB                                                  
139700         IF   NOT PS-NEW-GROUP                                            
139800          AND PREV-TYP-CVYA                                               
139900           CONTINUE                                                       
140000         ELSE                                                             
140100           MOVE 'CVY DATA MISSING'                                        
140200                            TO PV-HOLD-TR211-ERROR-MSG                    
140300           SET PS-SEQUENCE-ERROR    TO TRUE                               
140400         END-IF                                                           
140500                                                                          
140600       WHEN REC-TYP-CONA                                                  
140700         IF   NOT PS-NEW-GROUP                                            
140800          AND (PREV-TYP-CVYA OR PREV-TYP-CVYB)                            
140900           CONTINUE                                                       
141000         ELSE                                                             
141100           MOVE 'CVY DATA MISSING'                                        
141200                            TO PV-HOLD-TR211-ERROR-MSG                    
141300           SET PS-SEQUENCE-ERROR    TO TRUE                               
141400         END-IF                                                           
141500                                                                          
141600       WHEN REC-TYP-CONB                                                  
141700         IF   NOT PS-NEW-GROUP                                            
141800          AND PREV-TYP-CONA                                               
141900           CONTINUE                                                       
142000         ELSE                                                             
142100           MOVE 'CONA DATA MISSING'                                       
142200                            TO PV-HOLD-TR211-ERROR-MSG                    
142300           SET PS-SEQUENCE-ERROR    TO TRUE                               
142400         END-IF                                                           
142500                                                                          
142600     END-EVALUATE.                                                        
142700                                                                          
142800     IF PS-SEQUENCE-ERROR                                                 
142900       MOVE PC-ERROR        TO PV-HOLD-TR211-ERROR-TYPE                   
143000       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
143100       MOVE 'CVY/CON LEVEL'                                               
143200                            TO PV-HOLD-TR211-DATA-IN-ERROR                
143300       MOVE TR013-CVYA-REC-TYP-CDE                                        
143400                            TO PV-HOLD-TR211-DATA-VALUE                   
143500       PERFORM 7000-BUILD-ERROR-FILE                                      
143600     END-IF.                                                              
143700                                                                          
143800 EJECT                                                                    
143900                                                                          
144000**********************************************************************    
144100* PROCESS CVY-CON RECORDS                                            *    
144200* THERE ARE NO EDIT ERRORS, ONLY WARNINGS FOR CVY AND CON RECORDS    *    
144300**********************************************************************    
144400                                                                          
144500 3100-CVYA-CVYB-CONA-CONB-RECS.                                           
144600                                                                          
144700     EVALUATE TRUE                                                        
144800                                                                          
144900*                                                                         
145000*      ************************************                               
145100*      * PROCESS CVYA RECORDS             *                               
145200*      ************************************                               
145300       WHEN REC-TYP-CVYA                                                  
145400                                                                          
145500          MOVE PV-23-INITIALIZE-CNTR    TO TR023-REC-TYP-CNTR             
145600                                                                          
145700          EVALUATE TRUE                                                   
145800                                                                          
145900           WHEN TR013-CVYA-TRN-TYP-DEL                                    
146000            PERFORM 3300-MOVE-CVYA-FIELDS                                 
146100            PERFORM 6400-WRITE-UPDATE-RECORD                              
146200            ADD +1 TO PA-TOTAL-UPDATE-CNTR                                
146300                      PA-TOTAL-UPDATE                                     
146400*           **************************************************            
146410*           *** SAVE DATA FOR RECS YOU MAY SPIN THRU LATER ***            
146420*           **************************************************            
146500            MOVE PC-WARNING        TO PV-HOLD-TR211-ERROR-TYPE            
146600            MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP              
146700            MOVE 'DELETE RECORDS'  TO PV-HOLD-TR211-DATA-IN-ERROR         
146800            MOVE 'NON CVYA RECORD SENT FOR DELETE'                        
146900                                   TO PV-HOLD-TR211-ERROR-MSG             
147000            MOVE TR013-CVYA-REC-TYP-CDE                                   
147100                                   TO PV-HOLD-TR211-DATA-VALUE            
147200            SET PS-SPIN-GROUP TO TRUE                                     
147300                                                                          
147400           WHEN TR013-CVYA-TRN-TYP-ADD                                    
147500           WHEN TR013-CVYA-TRN-TYP-CHG                                    
147600            PERFORM 7300-EDIT-COMMON-FIELDS                               
147700            PERFORM 3200-EDIT-CVYA-FIELDS                                 
147800            PERFORM 3300-MOVE-CVYA-FIELDS                                 
147900            PERFORM 7200-LOAD-GROUP-TABLE                                 
148000          END-EVALUATE                                                    
148100                                                                          
148200                                                                          
148300       WHEN REC-TYP-CVYB                                                  
148400                                                                          
148500          PERFORM 3400-EDIT-CVYB-FIELDS                                   
148600          PERFORM 3500-MOVE-CVYB-FIELDS                                   
148700          PERFORM 7200-LOAD-GROUP-TABLE                                   
148800                                                                          
148900*      ************************************                               
149000*      * PROCESS CONA RECORD              *                               
149100*      ************************************                               
149200       WHEN REC-TYP-CONA                                                  
149300                                                                          
149400          PERFORM 3600-EDIT-MOVE-CONA-FIELDS                              
149500          PERFORM 7200-LOAD-GROUP-TABLE                                   
149600                                                                          
149700*      *************************************************************      
149800*      * PROCESS CONB RECORD                                       *      
149900*      *  THIS PROCESS IS DIFFERENT IN THAT CONB IS THE LAST TYPE  *      
150000*      *  IN THE GROUP.  IF IT PASSES EDITS, WRITE AN UPDATE REC   *      
150100*      *  AND YOU DON'T NEED TO SAVE THE TR013 ON THE ERROR TABLE. *      
150200*      *  IF IT DOESN'T PASS, YOU DON'T NEED TO SPIN THE GROUP     *      
150300*      *  BECAUSE YOU'RE ALREADY AT END AND THE CNVA, CNVB AND     *      
150400*      *  CONA RECS ON THE ERROR TABLE WILL GO TO ERROR FILE.      *      
150500*      *************************************************************      
150600                                                                          
150700       WHEN REC-TYP-CONB                                                  
150800                                                                          
150900          PERFORM 3700-EDIT-MOVE-CONB-FIELDS                              
151000          PERFORM 6400-WRITE-UPDATE-RECORD                                
151300          INITIALIZE PV-GROUP-TABLE                                       
151400                     PV-GRP-SUB                                           
151401          ADD +1 TO PA-TOTAL-UPDATE-CNTR                                  
151402                    PA-TOTAL-UPDATE                                       
151500          SET PS-CVY-CON-WRITTEN  TO TRUE                                 
151600                                                                          
151700       WHEN REC-TYP-CNSEAL                                                
151800                                                                          
151801          SET PS-CNSEAL-ERROR-NO    TO TRUE                               
151802          PERFORM 3800-EDIT-MOVE-CNSEAL-FIELDS                            
151803          IF PS-CNSEAL-ERROR                                              
151804          OR PS-CONA-WRITEN-NO                                            
151805             CONTINUE                                                     
151806          ELSE                                                            
151807             PERFORM 6400-WRITE-UPDATE-RECORD                             
151808          END-IF                                                          
151809                                                                          
151810     END-EVALUATE.                                                        
151820                                                                          
151900 EJECT                                                                    
152000                                                                          
152100************************************************************************  
152200                                                                          
152300 3200-EDIT-CVYA-FIELDS.                                                   
152400                                                                          
152500     IF TR013-CVYA-IMP-VEH-NM-MOM      EQUAL SPACES                       
152600         MOVE PC-WARNING          TO PV-HOLD-TR211-ERROR-TYPE             
152700         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
152800         MOVE 'IMP VEH NM'        TO PV-HOLD-TR211-DATA-IN-ERROR          
152900         MOVE TR013-CVYA-IMP-VEH-NM-MOM                                   
153000                                  TO PV-HOLD-TR211-DATA-VALUE             
153100         MOVE 'DATA NOT SENT'                                             
153200                                  TO PV-HOLD-TR211-ERROR-MSG              
153300         PERFORM 7000-BUILD-ERROR-FILE                                    
153400     END-IF.                                                              
153500                                                                          
153600     IF TR013-CVYA-ACTL-FOB-CDE-MOM          EQUAL SPACES                 
153700         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
153800         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
153900         MOVE 'ACTL FOB CDE'       TO PV-HOLD-TR211-DATA-IN-ERROR         
154000         MOVE TR013-CVYA-ACTL-FOB-CDE-MOM                                 
154100                                   TO PV-HOLD-TR211-DATA-VALUE            
154200         MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG             
154300         PERFORM 7000-BUILD-ERROR-FILE                                    
154400     END-IF.                                                              
154500                                                                          
154600     IF TR013-CVYA-DEST-POE-CDE-MOM          EQUAL SPACES                 
154700         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
154800         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
154900         MOVE 'DEST POE CDE'       TO PV-HOLD-TR211-DATA-IN-ERROR         
155000         MOVE TR013-CVYA-DEST-POE-CDE-MOM TO                              
155100                                PV-HOLD-TR211-DATA-VALUE                  
155200         MOVE 'DATA NOT SENT'      TO  PV-HOLD-TR211-ERROR-MSG            
155300         PERFORM 7000-BUILD-ERROR-FILE                                    
155400     END-IF.                                                              
155500                                                                          
155600     IF TR013-CVYA-TRIP-TYP-CDE-MOM EQUAL PC-A OR PC-O OR PC-M            
155700         CONTINUE                                                         
155800     ELSE                                                                 
155900         IF TR013-CVYA-TRIP-TYP-CDE-MOM       EQUAL SPACES                
156000             MOVE PC-WARNING          TO PV-HOLD-TR211-ERROR-TYPE         
156100             MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP             
156200             MOVE 'TRIP TYP CDE'   TO PV-HOLD-TR211-DATA-IN-ERROR         
156300             MOVE TR013-CVYA-TRIP-TYP-CDE-MOM     TO                      
156400                   PV-HOLD-TR211-DATA-VALUE                               
156500             MOVE 'DATA NOT SENT'                 TO                      
156600                   PV-HOLD-TR211-ERROR-MSG                                
156700             PERFORM 7000-BUILD-ERROR-FILE                                
156800         ELSE                                                             
156900             MOVE PC-WARNING          TO PV-HOLD-TR211-ERROR-TYPE         
157000             MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP             
157100             MOVE 'TRIP TYP CDE'   TO PV-HOLD-TR211-DATA-IN-ERROR         
157200             MOVE TR013-CVYA-TRIP-TYP-CDE-MOM      TO                     
157300                   PV-HOLD-TR211-DATA-VALUE                               
157400             MOVE 'INVALID TRIP TYPE'         TO                          
157500                   PV-HOLD-TR211-ERROR-MSG                                
157600             PERFORM 7000-BUILD-ERROR-FILE                                
157700         END-IF                                                           
157800     END-IF.                                                              
157900                                                                          
158000     IF TR013-CVYA-EST-LBD-DTE         EQUAL SPACES                       
158010      MOVE PC-DEFAULT-DTE-NO-DASHES TO TR013-CVYA-EST-LBD-DTE             
158020      IF TR013-CVYA-EST-LBD-NM     NOT EQUAL  SPACES                      
158100       MOVE PC-WARNING               TO PV-HOLD-TR211-ERROR-TYPE          
158200       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
158300       MOVE TR013-CVYA-EST-LBD-DTE                TO                      
158400             PV-HOLD-TR211-DATA-VALUE                                     
158500       MOVE 'EST LBD DTE'                    TO                           
158600             PV-HOLD-TR211-DATA-IN-ERROR                                  
158700       MOVE 'ESTIMATED LAND BRIDGE DESTINATION DATE NOT SENT' TO          
158800             PV-HOLD-TR211-ERROR-MSG                                      
159000       PERFORM 7000-BUILD-ERROR-FILE                                      
159010      END-IF                                                              
159100     ELSE                                                                 
159200       MOVE TR013-CVYA-EST-LBD-DTE         (1:4)   TO                     
159300               PV-FORMAT-DTE-CCYY                                         
159400       MOVE TR013-CVYA-EST-LBD-DTE         (5:2)   TO                     
159500               PV-FORMAT-DTE-MM                                           
159600       MOVE TR013-CVYA-EST-LBD-DTE         (7:2)   TO                     
159700               PV-FORMAT-DTE-DD                                           
159800       PERFORM 6500-CALENDAR-ROUTINE-SET-UP                               
159900       PERFORM 6510-CALENDAR-ROUTINE                                      
160000       IF PS-WARNING-DATE                                                 
160100          MOVE PC-WARNING      TO PV-HOLD-TR211-ERROR-TYPE                
160200          MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                
160300          MOVE TR013-CVYA-EST-LBD-DTE           TO                        
160400                PV-HOLD-TR211-DATA-VALUE                                  
160500          MOVE 'EST LBD DTE'                    TO                        
160600                PV-HOLD-TR211-DATA-IN-ERROR                               
160700          MOVE 'INVALID DATE'                   TO                        
160800                PV-HOLD-TR211-ERROR-MSG                                   
160900          MOVE PC-DEFAULT-DTE-NO-DASHES TO TR013-CVYA-EST-LBD-DTE         
161000          PERFORM 7000-BUILD-ERROR-FILE                                   
161100       END-IF                                                             
161200     END-IF.                                                              
161300                                                                          
161400     MOVE TR013-CVYA-EST-LBD-TM TO PV-CHECK-TIME.                         
161500     PERFORM 6515-VALIDATE-TIME.                                          
161600     IF PS-WARNING-TIME                                                   
161700        MOVE PC-DEFAULT-TIME    TO TR013-CVYA-EST-LBD-TM                  
161800     END-IF.                                                              
161900                                                                          
161901     IF TR013-CVYA-POL-CDE-MOM               EQUAL SPACES                 
161902         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
161903         MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP               
161904         MOVE 'ACTL POL CDE'       TO PV-HOLD-TR211-DATA-IN-ERROR         
161905         MOVE TR013-CVYA-POL-CDE-MOM                                      
161906                                   TO PV-HOLD-TR211-DATA-VALUE            
161907         MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG             
161908         PERFORM 7000-BUILD-ERROR-FILE                                    
161909     END-IF.                                                              
161910                                                                          
161911     IF TR013-CVYA-POR-CDE-MOM               EQUAL SPACES                 
161912         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
161913         MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP               
161914         MOVE 'ACTL POR CDE'       TO PV-HOLD-TR211-DATA-IN-ERROR         
161915         MOVE TR013-CVYA-POR-CDE-MOM                                      
161916                                   TO PV-HOLD-TR211-DATA-VALUE            
161917         MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG             
161918         PERFORM 7000-BUILD-ERROR-FILE                                    
161919     END-IF.                                                              
161920                                                                          
162000 EJECT                                                                    
162100                                                                          
162200************************************************************************  
162300                                                                          
162400 3300-MOVE-CVYA-FIELDS.                                                   
162500                                                                          
162600     MOVE TR013-CVYA-TRN-TYP                                              
162700                          TO TR023-CNTR-TRN-TYP.                          
162800     MOVE PC-CNTR         TO TR023-CNTR-REC-TYP-CDE.                      
162900     MOVE PC-10           TO TR023-CNTR-SEQ-NBR.                          
163000     MOVE SPACES          TO TR023-CNTR-3RD-PARTY-CDE.                    
163100     MOVE PV-HOLD-TR211-CONTNR-ID                                         
163200                          TO TR023-CNTR-CONTNR-ID.                        
163300     MOVE PV-HOLD-TR211-ACTL-DPRTR-DTE-M                                  
163400                          TO TR023-CNTR-ACTL-DPRTR-DTE-MOM.               
163500     MOVE PV-HOLD-TR211-ACTL-DPRTR-TM-M                                   
163600                          TO TR023-CNTR-ACTL-DPRTR-TM-MOM.                
163700     MOVE TR013-CVYA-EST-POE-DELY-DTE                                     
163800                          TO TR023-CNTR-EST-POE-DELY-DT-MOM.              
163900     MOVE TR013-CVYA-EST-POE-DELY-TM                                      
164000                          TO TR023-CNTR-EST-POE-DELY-TM-MOM.              
164100     MOVE TR013-CVYA-IMPRT-TRIP-ID                                        
164200                          TO TR023-CNTR-IMPRT-TRIP-ID-MOM.                
164300     MOVE TR013-CVYA-CARR-SCAC-ID                                         
164400                          TO TR023-CNTR-CARR-SCAC-ID-MOM.                 
164500     MOVE TR013-CVYA-IMP-VEH-NM-MOM                                       
164600                          TO TR023-CNTR-IMP-VEH-NM-MOM.                   
164700     MOVE TR013-CVYA-ACTL-FOB-CDE-MOM                                     
164800                          TO TR023-CNTR-ACTL-FOB-CDE-MOM.                 
164900     MOVE TR013-CVYA-DEST-POE-CDE-MOM                                     
165000                          TO TR023-CNTR-DEST-POE-CDE-MOM.                 
165100     MOVE TR013-CVYA-TRIP-TYP-CDE-MOM                                     
165200                          TO TR023-CNTR-TRIP-TYP-CDE-MOM.                 
165300     MOVE TR013-CVYA-EST-LBD-NM                                           
165400                          TO TR023-CNTR-EST-LBD-NM.                       
165500     MOVE TR013-CVYA-EST-LBD-DTE                                          
165600                          TO TR023-CNTR-EST-LBD-DTE.                      
165700     MOVE TR013-CVYA-EST-LBD-TM                                           
165800                          TO TR023-CNTR-EST-LBD-TM.                       
165801     MOVE TR013-CVYA-POL-CDE-MOM                                          
165802                          TO TR023-CNTR-POL-CDE-MOM.                      
165803     MOVE TR013-CVYA-POR-CDE-MOM                                          
165804                          TO TR023-CNTR-POR-CDE-MOM.                      
165900     MOVE TR013-CVYA-ENT-ID       TO TR023-CNTR-DAT-SRC-ENT-ID.           
165901     MOVE TR013-CVYA-FILE-ID      TO TR023-CNTR-FILE-ID.                  
165910*    MOVE PV-HOLD-TR023-ENT-ID    TO TR023-CNTR-DAT-SRC-ENT-ID.           
166000     MOVE PV-PROCESS-SEQ-NBR                                              
166100                            TO TR023-CNTR-PROCESS-SEQ-NBR-1.              
166200                                                                          
166300 EJECT                                                                    
166400                                                                          
166500************************************************************************  
166600                                                                          
166700 3400-EDIT-CVYB-FIELDS.                                                   
166800                                                                          
166900     IF TR013-CVYB-IMP-VEH-NM-FDR      EQUAL SPACES                       
167000         MOVE PC-WARNING          TO PV-HOLD-TR211-ERROR-TYPE             
167100         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
167200         MOVE 'IMP VEH NM FDR '   TO PV-HOLD-TR211-DATA-IN-ERROR          
167300         MOVE TR013-CVYB-IMP-VEH-NM-FDR                                   
167400                                  TO PV-HOLD-TR211-DATA-VALUE             
167500         MOVE 'DATA NOT SENT'                                             
167600                                  TO PV-HOLD-TR211-ERROR-MSG              
167700         PERFORM 7000-BUILD-ERROR-FILE                                    
167800     END-IF.                                                              
167900                                                                          
168000     IF TR013-CVYB-ACTL-FOB-CDE-FDR          EQUAL SPACES                 
168100         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
168200         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
168300         MOVE 'ACTL POL CD FDR'    TO PV-HOLD-TR211-DATA-IN-ERROR         
168400         MOVE TR013-CVYB-ACTL-FOB-CDE-FDR                                 
168500                                   TO PV-HOLD-TR211-DATA-VALUE            
168600         MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG             
168700         PERFORM 7000-BUILD-ERROR-FILE                                    
168800     END-IF.                                                              
168900                                                                          
169000     IF TR013-CVYB-DEST-POE-CDE-FDR          EQUAL SPACES                 
169100         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
169200         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
169300         MOVE 'DEST POE CD FDR'    TO PV-HOLD-TR211-DATA-IN-ERROR         
169400         MOVE TR013-CVYB-DEST-POE-CDE-FDR                                 
169500                             TO PV-HOLD-TR211-DATA-VALUE                  
169600         MOVE 'DATA NOT SENT'      TO  PV-HOLD-TR211-ERROR-MSG            
169700         PERFORM 7000-BUILD-ERROR-FILE                                    
169800     END-IF.                                                              
169900                                                                          
170000     IF TR013-CVYB-TRIP-TYP-CDE-FDR EQUAL PC-A OR PC-O OR PC-M            
170100         CONTINUE                                                         
170200     ELSE                                                                 
170300         IF TR013-CVYB-TRIP-TYP-CDE-FDR       EQUAL SPACES                
170400             MOVE PC-WARNING          TO PV-HOLD-TR211-ERROR-TYPE         
170500             MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP             
170600             MOVE 'TRIP TYP CD FDR'                                       
170700                                   TO PV-HOLD-TR211-DATA-IN-ERROR         
170800             MOVE TR013-CVYB-TRIP-TYP-CDE-FDR     TO                      
170900                   PV-HOLD-TR211-DATA-VALUE                               
171000             MOVE 'DATA NOT SENT'                 TO                      
171100                   PV-HOLD-TR211-ERROR-MSG                                
171200             PERFORM 7000-BUILD-ERROR-FILE                                
171300         ELSE                                                             
171400             MOVE PC-WARNING          TO PV-HOLD-TR211-ERROR-TYPE         
171500             MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP             
171600             MOVE 'TRIP TYP CD FDR'                                       
171700                                   TO PV-HOLD-TR211-DATA-IN-ERROR         
171800             MOVE TR013-CVYB-TRIP-TYP-CDE-FDR      TO                     
171900                   PV-HOLD-TR211-DATA-VALUE                               
172000             MOVE 'INVALID TRIP TYPE'         TO                          
172100                   PV-HOLD-TR211-ERROR-MSG                                
172200             PERFORM 7000-BUILD-ERROR-FILE                                
172300         END-IF                                                           
172400     END-IF.                                                              
172500                                                                          
172600     IF TR013-CVYB-ACTL-DPRTR-DTE-FDR EQUAL SPACES                        
172700       MOVE PC-WARNING      TO PV-HOLD-TR211-ERROR-TYPE                   
172800       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
172900       MOVE 'ACTL DPT DT FDR'                                             
173000                            TO PV-HOLD-TR211-DATA-IN-ERROR                
173100       MOVE 'ACTUTAL DEPARTURE DATE FDR NOT SENT'                         
173200                             TO  PV-HOLD-TR211-ERROR-MSG                  
173300       MOVE SPACES           TO  PV-HOLD-TR211-DATA-VALUE                 
173400       PERFORM 7000-BUILD-ERROR-FILE                                      
173500       MOVE PC-DEFAULT-DTE-NO-DASHES                                      
173600                   TO TR013-CVYB-ACTL-DPRTR-DTE-FDR                       
173700     ELSE                                                                 
173800       MOVE TR013-CVYB-ACTL-DPRTR-DTE-FDR (1:4)  TO                       
173900               PV-FORMAT-DTE-CCYY                                         
174000       MOVE TR013-CVYB-ACTL-DPRTR-DTE-FDR (5:2)  TO                       
174100               PV-FORMAT-DTE-MM                                           
174200       MOVE TR013-CVYB-ACTL-DPRTR-DTE-FDR (7:2)  TO                       
174300               PV-FORMAT-DTE-DD                                           
174400       PERFORM 6500-CALENDAR-ROUTINE-SET-UP                               
174500       PERFORM 6510-CALENDAR-ROUTINE                                      
174600       IF PS-WARNING-DATE                                                 
174700         SET  PS-KEY-FIELDS-OK-NO  TO TRUE                                
174800         MOVE PC-WARNING         TO PV-HOLD-TR211-ERROR-TYPE              
174900         MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                 
175000         MOVE 'ACTL DPT DT FDR'                                           
175100                              TO PV-HOLD-TR211-DATA-IN-ERROR              
175200         MOVE 'ACTUTAL DEPARTURE DATE FDR NOT VALID'                      
175300                              TO PV-HOLD-TR211-ERROR-MSG                  
175400         MOVE TR013-CVYB-ACTL-DPRTR-DTE-FDR                               
175500                              TO  PV-HOLD-TR211-DATA-VALUE                
175600         PERFORM 7000-BUILD-ERROR-FILE                                    
175700         MOVE PC-DEFAULT-DTE-NO-DASHES                                    
175800                     TO TR013-CVYB-ACTL-DPRTR-DTE-FDR                     
175900       END-IF                                                             
176000     END-IF.                                                              
176100                                                                          
176200     MOVE TR013-CVYB-ACTL-DPRTR-TM-FDR   TO PV-CHECK-TIME.                
176300     PERFORM 6515-VALIDATE-TIME.                                          
176400     IF PS-WARNING-TIME                                                   
176500       MOVE PC-DEFAULT-TIME TO TR013-CVYB-ACTL-DPRTR-TM-FDR               
176600     END-IF.                                                              
176700                                                                          
176800     IF TR013-CVYB-EST-POE-DELY-DTE EQUAL SPACES                          
176900       MOVE PC-DEFAULT-DTE-NO-DASHES                                      
177000                   TO TR013-CVYB-EST-POE-DELY-DTE                         
177100     ELSE                                                                 
177200       MOVE TR013-CVYB-EST-POE-DELY-DTE (1:4) TO                          
177300               PV-FORMAT-DTE-CCYY                                         
177400       MOVE TR013-CVYB-EST-POE-DELY-DTE (5:2) TO                          
177500               PV-FORMAT-DTE-MM                                           
177600       MOVE TR013-CVYB-EST-POE-DELY-DTE (7:2) TO                          
177700               PV-FORMAT-DTE-DD                                           
177800       PERFORM 6500-CALENDAR-ROUTINE-SET-UP                               
177900       PERFORM 6510-CALENDAR-ROUTINE                                      
178000       IF PS-WARNING-DATE                                                 
178100         MOVE PC-DEFAULT-DTE-NO-DASHES                                    
178200                     TO TR013-CVYB-EST-POE-DELY-DTE                       
178300       END-IF                                                             
178400     END-IF.                                                              
178500                                                                          
178600     MOVE TR013-CVYB-EST-POE-DELY-TM TO PV-CHECK-TIME.                    
178700     PERFORM 6515-VALIDATE-TIME.                                          
178800     IF PS-WARNING-TIME                                                   
178900       MOVE PC-DEFAULT-TIME TO TR013-CVYB-EST-POE-DELY-TM                 
179000     END-IF.                                                              
179100                                                                          
179101     IF TR013-CVYB-POL-CDE-FDR               EQUAL SPACES                 
179102         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
179103         MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP               
179104         MOVE 'ACTL POL CDE'       TO PV-HOLD-TR211-DATA-IN-ERROR         
179105         MOVE TR013-CVYB-POL-CDE-FDR                                      
179106                                   TO PV-HOLD-TR211-DATA-VALUE            
179107         MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG             
179108         PERFORM 7000-BUILD-ERROR-FILE                                    
179109     END-IF.                                                              
179110                                                                          
179111     IF TR013-CVYB-POR-CDE-FDR               EQUAL SPACES                 
179112         MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE            
179113         MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP               
179114         MOVE 'ACTL POR CDE'       TO PV-HOLD-TR211-DATA-IN-ERROR         
179115         MOVE TR013-CVYB-POR-CDE-FDR                                      
179116                                   TO PV-HOLD-TR211-DATA-VALUE            
179117         MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG             
179118         PERFORM 7000-BUILD-ERROR-FILE                                    
179119     END-IF.                                                              
179120                                                                          
179200 EJECT                                                                    
179300                                                                          
179400************************************************************************  
179500                                                                          
179600 3500-MOVE-CVYB-FIELDS.                                                   
179700                                                                          
179800     MOVE TR013-CVYB-ACTL-DPRTR-DTE-FDR                                   
179900                          TO TR023-CNTR-ACTL-DPRTR-DTE-FDR.               
180000     MOVE TR013-CVYB-ACTL-DPRTR-TM-FDR                                    
180100                          TO TR023-CNTR-ACTL-DPRTR-TM-FDR.                
180200     MOVE TR013-CVYB-EST-POE-DELY-DTE                                     
180300                          TO TR023-CNTR-EST-POE-DELY-DT-FDR.              
180400     MOVE TR013-CVYB-EST-POE-DELY-TM                                      
180500                          TO TR023-CNTR-EST-POE-DELY-TM-FDR.              
180600     MOVE TR013-CVYB-IMP-VEH-NM-FDR                                       
180700                          TO TR023-CNTR-IMP-VEH-NM-FDR.                   
180800     MOVE TR013-CVYB-IMPRT-TRIP-ID                                        
180900                          TO TR023-CNTR-IMPRT-TRIP-ID-FDR.                
181000     MOVE TR013-CVYB-CARR-SCAC-ID                                         
181100                          TO TR023-CNTR-CARR-SCAC-ID-FDR.                 
181200     MOVE TR013-CVYB-ACTL-FOB-CDE-FDR                                     
181300                          TO TR023-CNTR-ACTL-FOB-CDE-FDR.                 
181400     MOVE TR013-CVYB-DEST-POE-CDE-FDR                                     
181500                          TO TR023-CNTR-DEST-POE-CDE-FDR.                 
181600     MOVE TR013-CVYB-TRIP-TYP-CDE-FDR                                     
181700                          TO TR023-CNTR-TRIP-TYP-CDE-FDR.                 
181800     MOVE PV-PROCESS-SEQ-NBR                                              
181900                          TO TR023-CNTR-PROCESS-SEQ-NBR-2.                
181901     MOVE TR013-CVYB-POL-CDE-FDR                                          
181902                          TO TR023-CNTR-POL-CDE-FDR.                      
181903     MOVE TR013-CVYB-POR-CDE-FDR                                          
181904                          TO TR023-CNTR-POR-CDE-FDR.                      
182000                                                                          
182100 EJECT                                                                    
182200                                                                          
182300************************************************************************  
182400                                                                          
182500 3600-EDIT-MOVE-CONA-FIELDS.                                              
182600                                                                          
182700     MOVE TR013-CONA-CONSOL-SCAC-ID         TO                            
182800               TR023-CNTR-CONSOL-SCAC-ID.                                 
182900     IF TR013-CONA-CONSOL-SCAC-ID = SPACES                                
183000        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
183100        MOVE TR013-CVYA-TRN-TYP     TO PV-HOLD-TR211-TRN-TYP              
183200        MOVE 'CONSOL SCAC ID'       TO PV-HOLD-TR211-DATA-IN-ERROR        
183300        MOVE TR013-CONA-CONSOL-SCAC-ID                                    
183400                                    TO PV-HOLD-TR211-DATA-VALUE           
183500        MOVE 'DATA NOT SENT'                                              
183600                                    TO PV-HOLD-TR211-ERROR-MSG            
183700        PERFORM 7000-BUILD-ERROR-FILE                                     
183800     END-IF.                                                              
183900                                                                          
184000     IF TR013-CONA-CART-CNT       NUMERIC                                 
184100        MOVE TR013-CONA-CART-CNT TO TR023-CNTR-CART-CNT                   
184200     ELSE                                                                 
184300        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
184400        MOVE TR013-CVYA-TRN-TYP     TO PV-HOLD-TR211-TRN-TYP              
184500        MOVE 'CARTON COUNT'         TO PV-HOLD-TR211-DATA-IN-ERROR        
184600        MOVE TR013-CONA-CART-CNT TO PV-HOLD-TR211-DATA-VALUE              
184700        MOVE 'INVALID CARTON COUNT' TO PV-HOLD-TR211-ERROR-MSG            
184800        PERFORM 7000-BUILD-ERROR-FILE                                     
184900     END-IF.                                                              
185000                                                                          
185100     IF TR013-CONA-UNT-QTY        NUMERIC                                 
185200        MOVE TR013-CONA-UNT-QTY TO TR023-CNTR-UNT-QTY                     
185300     ELSE                                                                 
185400        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
185500        MOVE TR013-CVYA-TRN-TYP     TO PV-HOLD-TR211-TRN-TYP              
185600        MOVE 'UNIT QUANTITY'        TO PV-HOLD-TR211-DATA-IN-ERROR        
185700        MOVE TR013-CONA-UNT-QTY     TO PV-HOLD-TR211-DATA-VALUE           
185800        MOVE 'INVALID UNIT QTY'     TO PV-HOLD-TR211-ERROR-MSG            
185900        PERFORM 7000-BUILD-ERROR-FILE                                     
186000     END-IF.                                                              
186100                                                                          
186200     IF TR013-CONA-CBMT-QTY       NUMERIC                                 
186300        MOVE TR013-CONA-CBMT-QTY TO TR023-CNTR-CBMT-QTY                   
186400     ELSE                                                                 
186500        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
186600        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
186700        MOVE 'CBMT QUANTITY'        TO PV-HOLD-TR211-DATA-IN-ERROR        
186800        MOVE TR013-CONA-CBMT-QTY-X TO PV-HOLD-TR211-DATA-VALUE            
186900        MOVE 'INVALID CBMT QTY'     TO PV-HOLD-TR211-ERROR-MSG            
187000        PERFORM 7000-BUILD-ERROR-FILE                                     
187100     END-IF.                                                              
187200                                                                          
187300     IF TR013-CONA-WT-KGRM-QTY       NUMERIC                              
187400        MOVE TR013-CONA-WT-KGRM-QTY TO TR023-CNTR-WT-KGRM-QTY             
187500     ELSE                                                                 
187600        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
187700        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
187800        MOVE 'KGRM QUANTITY'        TO PV-HOLD-TR211-DATA-IN-ERROR        
187900        MOVE TR013-CONA-WT-KGRM-QTY TO PV-HOLD-TR211-DATA-VALUE           
188000        MOVE 'INVALID KGRM QTY'     TO PV-HOLD-TR211-ERROR-MSG            
188100        PERFORM 7000-BUILD-ERROR-FILE                                     
188200     END-IF.                                                              
188300                                                                          
188400     MOVE PV-PROCESS-SEQ-NBR                                              
188500                       TO TR023-CNTR-PROCESS-SEQ-NBR-3.                   
188600                                                                          
188700     MOVE PV-PROCESS-SEQ-NBR TO PV-HOLD-GRP-SEQ-SEAL                      
188800     MOVE TR013-REC-TYP-CVYA TO PV-HOLD-GRP-REC-SEAL                      
188900     SET PS-SEAL-ERR-WRITEN-NO TO TRUE.                                   
188901     SET PS-CONA-WRITEN        TO TRUE.                                   
188902                                                                          
188903 EJECT                                                                    
188904                                                                          
188905************************************************************************  
189000                                                                          
189100 3700-EDIT-MOVE-CONB-FIELDS.                                              
189200                                                                          
189300     MOVE TR013-CONB-ORGN-SHPD-FR-CDE       TO                            
189400               TR023-CNTR-ORGN-SHPD-FR-CDE.                               
189500     IF TR013-CONB-ORGN-SHPD-FR-CDE         EQUAL SPACES                  
189600        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
189700        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
189800        MOVE 'ORGN SHPD FR CD'      TO PV-HOLD-TR211-DATA-IN-ERROR        
189900        MOVE TR013-CONB-ORGN-SHPD-FR-CDE TO                               
190000               PV-HOLD-TR211-DATA-VALUE                                   
190100        MOVE 'DATA NOT SENT'                TO                            
190200               PV-HOLD-TR211-ERROR-MSG                                    
190300        PERFORM 7000-BUILD-ERROR-FILE                                     
190400     END-IF.                                                              
190500                                                                          
190600     MOVE TR013-CONB-ORGN-SHPD-TO-CDE       TO                            
190700               TR023-CNTR-ORGN-SHPD-TO-CDE.                               
190800     IF TR013-CONB-ORGN-SHPD-TO-CDE         EQUAL SPACES                  
190900        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
191000        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
191100        MOVE 'ORGN SHPD TO CD'      TO PV-HOLD-TR211-DATA-IN-ERROR        
191200        MOVE TR013-CONB-ORGN-SHPD-TO-CDE TO                               
191300               PV-HOLD-TR211-DATA-VALUE                                   
191400        MOVE 'DATA NOT SENT'                TO                            
191500               PV-HOLD-TR211-ERROR-MSG                                    
191600        PERFORM 7000-BUILD-ERROR-FILE                                     
191700     END-IF.                                                              
191800                                                                          
194700     MOVE TR013-CONB-SIZE-CDE       TO TR023-CNTR-SIZE-CDE.               
194800                                                                          
194900     IF TR013-CONB-TRIP-TYP-CDE     = PC-O                                
195000         CONTINUE                                                         
195100     ELSE                                                                 
195200         IF TR013-CONB-SIZE-CDE     EQUAL SPACES                          
195300            MOVE PC-WARNING         TO PV-HOLD-TR211-ERROR-TYPE           
195400            MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP              
195500            MOVE 'SIZE CODE'        TO PV-HOLD-TR211-DATA-IN-ERROR        
195600            MOVE TR013-CONB-SIZE-CDE             TO                       
195700                      PV-HOLD-TR211-DATA-VALUE                            
195800            MOVE 'DATA NOT SENT'    TO PV-HOLD-TR211-ERROR-MSG            
195900            PERFORM 7000-BUILD-ERROR-FILE                                 
196000         END-IF                                                           
196100     END-IF.                                                              
196200                                                                          
196300     MOVE PV-PROCESS-SEQ-NBR                                              
196400                              TO TR023-CNTR-PROCESS-SEQ-NBR-4.            
196500                                                                          
268400******************************************************************        
268500 3800-EDIT-MOVE-CNSEAL-FIELDS.                                            
268600                                                                          
268700     MOVE TR013-REC-TYP-CNSEAL TO TR023-REC-TYP-CNSEAL.                   
268701                                                                          
268702     IF TR013-CNSEAL-CONTNR-SEAL-NBR = SPACES                             
268703        SET  PS-CNSEAL-ERROR      TO TRUE                                 
268704        MOVE PC-ERROR             TO PV-HOLD-TR211-ERROR-TYPE             
268705        MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP                
268706        MOVE 'SEAL NBR'           TO PV-HOLD-TR211-DATA-IN-ERROR          
268707        MOVE SPACES               TO PV-HOLD-TR211-DATA-VALUE             
268708        MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG              
268709        PERFORM 7000-BUILD-ERROR-FILE                                     
268710     END-IF.                                                              
268711                                                                          
268712     MOVE PV-HOLD-TR211-ACTL-DPRTR-DTE-M                                  
268713                          TO TR023-CNSEAL-ACTL-DPRTR-DTE.                 
268714     MOVE PV-HOLD-TR211-ACTL-DPRTR-TM-M                                   
268715                          TO TR023-CNSEAL-ACTL-DPRTR-TM.                  
268716                                                                          
268717     MOVE TR013-CNSEAL-ENT-ID  TO TR023-CNSEAL-DAT-SRC-ENT-ID.            
268718     MOVE TR013-CNSEAL-FILE-ID TO TR023-CNSEAL-FILE-ID.                   
268719     MOVE PV-PROCESS-SEQ-NBR   TO TR023-CNSEAL-PROCESS-SEQ-NBR-1.         
268720     SET  PS-SEAL-ERR-WRITEN   TO TRUE.                                   
268721                                                                          
268722 EJECT                                                                    
268723                                                                          
268724************************************************************************  
268725                                                                          
268726 4000-EDIT-PO-NUMBER.                                                     
268727                                                                          
268728     SET PS-EDIT-ERROR-NO   TO TRUE.                                      
268729                                                                          
268730     IF TR013-CONPOA-PO-NBR  EQUAL SPACES OR ZEROS                        
268731        MOVE 'PO NUMBER MISSING '                                         
268732                       TO PV-HOLD-TR211-ERROR-MSG                         
268733        SET PS-EDIT-ERROR  TO TRUE                                        
268734     ELSE                                                                 
268735       IF TR013-CONPOA-PO-NBR    NOT NUMERIC                              
268736          MOVE 'INVALID PO NUMBER'  TO PV-HOLD-TR211-ERROR-MSG            
268737          SET PS-EDIT-ERROR  TO TRUE                                      
268738       END-IF                                                             
268739     END-IF.                                                              
268740                                                                          
268741     IF PS-EDIT-ERROR                                                     
268742       MOVE PC-ERROR        TO PV-HOLD-TR211-ERROR-TYPE                   
268743       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
268744       MOVE 'PO NUMBER'                                                   
268745                            TO PV-HOLD-TR211-DATA-IN-ERROR                
268746       MOVE TR013-CONPOA-PO-NBR                                           
268747                            TO PV-HOLD-TR211-DATA-VALUE                   
268748       PERFORM 7000-BUILD-ERROR-FILE                                      
268749     END-IF.                                                              
268750                                                                          
268751************************************************************************  
268752                                                                          
268753 4010-CHECK-CONPO-SEQUENCE.                                               
268754                                                                          
268755     SET PS-SEQUENCE-ERROR-NO   TO TRUE.                                  
268756                                                                          
268757     EVALUATE TRUE                                                        
268758                                                                          
268759       WHEN  PS-CVY-CON-WRITTEN-NO                                        
268760         SET PS-SEQUENCE-ERROR    TO TRUE                                 
268761         IF TR013-CONPOA-PO-NBR NUMERIC                                   
268762           MOVE TR013-CONPOA-PO-NBR  TO PV-SAVE-PREV-PO-NBR               
268763         ELSE                                                             
268764           MOVE TR013-CONPOA-PO-NBR-X TO PV-SAVE-PREV-PO-NBR-X            
268765         END-IF                                                           
268766         IF PREV-TYP-CVY                                                  
268767           MOVE 'CON DATA MISSING'                                        
268768                      TO PV-HOLD-TR211-ERROR-MSG                          
268769         ELSE                                                             
268770           IF PREV-TYP-CONA                                               
268771             MOVE 'CONB DATA MISSING'                                     
268772                        TO PV-HOLD-TR211-ERROR-MSG                        
268773           ELSE                                                           
268774             MOVE 'CVY & CON DATA MISSING'                                
268775                        TO PV-HOLD-TR211-ERROR-MSG                        
268776           END-IF                                                         
268777         END-IF                                                           
268778                                                                          
268779       WHEN REC-TYP-CONPOA                                                
268780                                                                          
268781           EVALUATE TRUE                                                  
268782                                                                          
268783             WHEN PS-NEW-GROUP                                            
268784               IF PS-NEW-PO                                               
268785                IF PS-CONPO-WRITTEN                                       
268786                  SET PS-CONPO-WRITTEN-NO  TO TRUE                        
268787                END-IF                                                    
268788               END-IF                                                     
268789                                                                          
268790             END-EVALUATE                                                 
268791                                                                          
268792       WHEN REC-TYP-CONPOB                                                
268793         IF   NOT   PS-NEW-GROUP                                          
268794          AND PREV-TYP-CONPOA                                             
268795           CONTINUE                                                       
268796         ELSE                                                             
268797           MOVE 'CONPOA DATA MISSING'                                     
268798                            TO PV-HOLD-TR211-ERROR-MSG                    
268799           SET PS-SEQUENCE-ERROR    TO TRUE                               
268800         END-IF                                                           
268801                                                                          
268802       WHEN REC-TYP-CONPOC                                                
268803         IF   NOT   PS-NEW-GROUP                                          
268804          AND PREV-TYP-CONPOB                                             
268805           CONTINUE                                                       
268806         ELSE                                                             
268807           MOVE 'CONPOB DATA MISSING'                                     
268808                            TO PV-HOLD-TR211-ERROR-MSG                    
268809           SET PS-SEQUENCE-ERROR    TO TRUE                               
268810         END-IF                                                           
268811                                                                          
268812     END-EVALUATE.                                                        
268813                                                                          
268814     IF PS-SEQUENCE-ERROR                                                 
268815       MOVE PC-ERROR        TO PV-HOLD-TR211-ERROR-TYPE                   
268816       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
268817       MOVE 'CONPO LEVEL'                                                 
268818                            TO PV-HOLD-TR211-DATA-IN-ERROR                
268819       MOVE TR013-CVYA-REC-TYP-CDE                                        
268820                            TO PV-HOLD-TR211-DATA-VALUE                   
268821       PERFORM 7000-BUILD-ERROR-FILE                                      
268822     END-IF.                                                              
268823                                                                          
268824 EJECT                                                                    
268825                                                                          
268826************************************************************************  
268827 4100-CONPOA-CONPOB-CONPOC.                                               
268828                                                                          
268829*    ***********************************************************          
268830*    * HBOL AND MBOL EDIT                                      *          
268831*    ***********************************************************          
268832     EVALUATE TRUE                                                        
268833                                                                          
268834       WHEN REC-TYP-CONPOB                                                
268835         MOVE TR013-CONPOB-HSE-BOL-NBR TO PV-23-IZPO-HSE-BOL-NBR          
268836                                                                          
268837       WHEN REC-TYP-CONPOC                                                
268838         IF TR013-CONPOC-MSTR-BOL-NBR > SPACES                            
268839             CONTINUE                                                     
268840         ELSE                                                             
268841             IF PV-23-IZPO-HSE-BOL-NBR > SPACES                           
268842                 CONTINUE                                                 
268843             ELSE                                                         
268844                 MOVE PC-WARNING                                          
268845                 TO   PV-HOLD-TR211-ERROR-TYPE                            
268846                 MOVE PV-EVAL-REC-TYP-CDE                                 
268847                 TO   PV-HOLD-TR211-TRN-TYP                               
268848                 MOVE 'CONPO LEVEL    '                                   
268849                 TO   PV-HOLD-TR211-DATA-IN-ERROR                         
268850                 MOVE SPACES                                              
268851                 TO   PV-HOLD-TR211-DATA-VALUE                            
268852                 MOVE 'NEITHER HBOL OR MBOL SENT'                         
268853                 TO   PV-HOLD-TR211-ERROR-MSG                             
268854                 PERFORM 7000-BUILD-ERROR-FILE                            
268855              END-IF                                                      
268856         END-IF                                                           
268857     END-EVALUATE.                                                        
268858                                                                          
268859     EVALUATE TRUE                                                        
268860                                                                          
268861       WHEN REC-TYP-CONPOA                                                
268862                                                                          
268863                                                                          
268864          MOVE PV-23-INITIALIZE-CONPO   TO TR023-REC-TYP-CONPO            
268865          PERFORM 4200-EDIT-MOVE-CONPOA-FIELDS                            
268866          PERFORM 7200-LOAD-GROUP-TABLE                                   
268867                                                                          
268868       WHEN REC-TYP-CONPOB                                                
268869                                                                          
268870          MOVE TR013-CONPOB-LTR-OF-CR-NBR                                 
268871                               TO TR023-CONPO-LTR-OF-CR-NBR               
268872          MOVE TR013-CONPOB-HSE-BOL-NBR                                   
268873                               TO TR023-CONPO-HSE-BOL-NBR                 
268874          MOVE PV-PROCESS-SEQ-NBR                                         
268875                               TO TR023-CONPO-PROCESS-SEQ-NBR-2           
268876          PERFORM 7200-LOAD-GROUP-TABLE                                   
268877                                                                          
268878       WHEN REC-TYP-CONPOC                                                
268879                                                                          
268880          MOVE TR013-CONPOC-MSTR-BOL-NBR                                  
268881                               TO TR023-CONPO-MSTR-BOL-NBR                
268882          MOVE TR013-CONPOC-PO-C-O-PROD-CDE                               
268883                               TO TR023-CONPO-PO-C-O-PROD-CDE             
268884          IF TR013-CONPOC-PO-C-O-PROD-CDE     EQUAL SPACES                
268885             MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE               
268886             MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP             
268887             MOVE 'CNTRY PROD CDE'                                        
268888                                TO PV-HOLD-TR211-DATA-IN-ERROR            
268889             MOVE TR013-CONPOC-PO-C-O-PROD-CDE                            
268890                                TO PV-HOLD-TR211-DATA-VALUE               
268891             MOVE 'DATA NOT SENT'                                         
268892                                TO PV-HOLD-TR211-ERROR-MSG                
268893             PERFORM 7000-BUILD-ERROR-FILE                                
268894          END-IF                                                          
268895          MOVE PV-PROCESS-SEQ-NBR                                         
268896                               TO TR023-CONPO-PROCESS-SEQ-NBR-3           
268897                                                                          
268898          IF TR013-CONPOC-DOC-RCVD-ORGN-DTE EQUAL SPACES                  
268899            MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE                
268900            MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP              
269000            MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE   TO                      
269100                  PV-HOLD-TR211-DATA-VALUE                                
269200            MOVE 'DOC RCVD DATE'                  TO                      
269300                  PV-HOLD-TR211-DATA-IN-ERROR                             
269400            MOVE 'DOC RCVD ORGN DATE NOT SENT'    TO                      
269500                  PV-HOLD-TR211-ERROR-MSG                                 
269600            PERFORM 7000-BUILD-ERROR-FILE                                 
269700            MOVE PC-DEFAULT-DTE-NO-DASHES                                 
269800                                 TO TR013-CONPOC-DOC-RCVD-ORGN-DTE        
269900          ELSE                                                            
270000            MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE (1:4)    TO               
270100                    PV-FORMAT-DTE-CCYY                                    
270200            MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE (5:2)    TO               
270300                    PV-FORMAT-DTE-MM                                      
270400            MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE (7:2)    TO               
270500                    PV-FORMAT-DTE-DD                                      
270600            PERFORM 6500-CALENDAR-ROUTINE-SET-UP                          
270700            PERFORM 6510-CALENDAR-ROUTINE                                 
270800            IF PS-WARNING-DATE                                            
270900               MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE             
271000               MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP           
271100               MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE   TO                   
271200                     PV-HOLD-TR211-DATA-VALUE                             
271300               MOVE 'DOC RCVD ORGN DT'               TO                   
271400                     PV-HOLD-TR211-DATA-IN-ERROR                          
271500               MOVE 'INVALID DATE'                   TO                   
271600                     PV-HOLD-TR211-ERROR-MSG                              
271700               PERFORM 7000-BUILD-ERROR-FILE                              
271800               MOVE  PC-DEFAULT-DTE-NO-DASHES        TO                   
271900                     TR013-CONPOC-DOC-RCVD-ORGN-DTE                       
272000            END-IF                                                        
272100          END-IF                                                          
272200          MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE                             
272300                                TO TR023-CONPO-DOC-RCVD-ORGN-DTE          
272400                                                                          
272500          MOVE TR013-CONPOC-DOC-RCVD-ORGN-TM TO PV-CHECK-TIME             
272600          PERFORM 6515-VALIDATE-TIME                                      
272700          IF PS-WARNING-TIME                                              
272800             MOVE PC-DEFAULT-TIME TO TR013-CONPOC-DOC-RCVD-ORGN-TM        
272900          END-IF                                                          
273000          MOVE TR013-CONPOC-DOC-RCVD-ORGN-TM                              
273001                                  TO TR023-CONPO-DOC-RCVD-ORGN-TM         
273002                                                                          
273003     PERFORM 6400-WRITE-UPDATE-RECORD                                     
273004          ADD +1 TO PA-TOTAL-UPDATE-CONPO                                 
273005                    PA-TOTAL-UPDATE                                       
273006          INITIALIZE PV-GROUP-TABLE                                       
273007                     PV-GRP-SUB                                           
273008          SET PS-CONPO-WRITTEN  TO TRUE                                   
273009          MOVE TR013-CONPOA-PO-NBR TO PV-LAST-GOOD-PO-NBR                 
273010                                                                          
273011     END-EVALUATE.                                                        
273012                                                                          
273013************************************************************************  
273014                                                                          
273015 4200-EDIT-MOVE-CONPOA-FIELDS.                                            
273016                                                                          
273017     MOVE TR013-CONPOA-TRN-TYP                                            
273018                          TO TR023-CONPO-TRN-TYP.                         
273019     MOVE PC-CONPO        TO TR023-CONPO-REC-TYP-CDE.                     
273020     MOVE PC-20           TO TR023-CONPO-SEQ-NBR.                         
273021     MOVE SPACES          TO TR023-CONPO-3RD-PARTY-CDE.                   
273022     MOVE PV-HOLD-TR211-CONTNR-ID                                         
273023                          TO TR023-CONPO-CONTNR-ID.                       
273024     MOVE PV-HOLD-TR211-ACTL-DPRTR-DTE-M                                  
273025                          TO TR023-CONPO-ACTL-DPRTR-DTE.                  
273026     MOVE PV-HOLD-TR211-ACTL-DPRTR-TM-M                                   
273027                          TO TR023-CONPO-ACTL-DPRTR-TM.                   
273028     MOVE TR013-CONPOA-EXTL-REF-NBR                                       
273029                          TO TR023-CONPO-EXTL-REF-NBR.                    
273030     MOVE TR013-CONPOA-PO-NBR                                             
273031                          TO TR023-CONPO-PO-NBR                           
273032                                                                          
273033     IF TR013-CONPOA-EXTL-REF-NBR = SPACES                                
273034        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273035        MOVE TR013-CVYA-TRN-TYP     TO PV-HOLD-TR211-TRN-TYP              
273036        MOVE 'EXTL REF NBR'         TO PV-HOLD-TR211-DATA-IN-ERROR        
273037        MOVE  SPACES                TO PV-HOLD-TR211-DATA-VALUE           
273038        MOVE 'EXTERNAL REFERENCE NUMBER NOT SENT'                         
273039                                    TO PV-HOLD-TR211-ERROR-MSG            
273040        PERFORM 7000-BUILD-ERROR-FILE                                     
273050     END-IF.                                                              
273051                                                                          
273052     IF TR013-CONPOA-PO-RCVD-DELY-DTE = SPACES                            
273053       MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE                     
273054       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
273055       MOVE TR013-CONPOA-PO-RCVD-DELY-DTE                                 
273056             TO PV-HOLD-TR211-DATA-VALUE                                  
273057       MOVE 'PO RCVD DELY DT'                TO                           
273058             PV-HOLD-TR211-DATA-IN-ERROR                                  
273059       MOVE 'PO RECEIVED DELIVERY DATE NOT SENT' TO                       
273060             PV-HOLD-TR211-ERROR-MSG                                      
273061       MOVE PC-DEFAULT-DTE-NO-DASHES                                      
273062                            TO TR013-CONPOA-PO-RCVD-DELY-DTE              
273063       PERFORM 7000-BUILD-ERROR-FILE                                      
273064     ELSE                                                                 
273065       MOVE TR013-CONPOA-PO-RCVD-DELY-DTE           (1:4)                 
273066               TO PV-FORMAT-DTE-CCYY                                      
273067       MOVE TR013-CONPOA-PO-RCVD-DELY-DTE           (5:2)                 
273068               TO PV-FORMAT-DTE-MM                                        
273069       MOVE TR013-CONPOA-PO-RCVD-DELY-DTE           (7:2)                 
273070               TO PV-FORMAT-DTE-DD                                        
273071       PERFORM 6500-CALENDAR-ROUTINE-SET-UP                               
273072       PERFORM 6510-CALENDAR-ROUTINE                                      
273073       IF PS-WARNING-DATE                                                 
273074          MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE                  
273075          MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                
273076          MOVE TR013-CONPOA-PO-RCVD-DELY-DTE                              
273077                           TO PV-HOLD-TR211-DATA-VALUE                    
273078          MOVE 'PO RCVD DELY DT'                                          
273079                           TO PV-HOLD-TR211-DATA-IN-ERROR                 
273080          MOVE 'PO RECEIVED DELIVERY DATE INVALID'                        
273081                           TO PV-HOLD-TR211-ERROR-MSG                     
273082          MOVE PC-DEFAULT-DTE-NO-DASHES                                   
273083                           TO TR013-CONPOA-PO-RCVD-DELY-DTE               
273084          PERFORM 7000-BUILD-ERROR-FILE                                   
273085       END-IF                                                             
273086     END-IF                                                               
273087     MOVE TR013-CONPOA-PO-RCVD-DELY-DTE                                   
273088                          TO TR023-CONPO-PO-RCVD-DELY-DTE                 
273089                                                                          
273090     IF TR013-CONPOA-CART-CNT     NUMERIC                                 
273091        MOVE TR013-CONPOA-CART-CNT TO TR023-CONPO-CART-CNT                
273092     ELSE                                                                 
273093        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273094        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273095        MOVE 'CARTON COUNT'         TO PV-HOLD-TR211-DATA-IN-ERROR        
273096        MOVE TR013-CONPOA-CART-CNT  TO PV-HOLD-TR211-DATA-VALUE           
273097        MOVE 'INVALID CARTON COUNT' TO PV-HOLD-TR211-ERROR-MSG            
273098        PERFORM 7000-BUILD-ERROR-FILE                                     
273099     END-IF.                                                              
273100                                                                          
273101     IF TR013-CONPOA-UNT-QTY      NUMERIC                                 
273102        MOVE TR013-CONPOA-UNT-QTY TO TR023-CONPO-UNT-QTY                  
273103     ELSE                                                                 
273104        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273105        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273106        MOVE 'UNIT QUANTITY'        TO PV-HOLD-TR211-DATA-IN-ERROR        
273107        MOVE TR013-CONPOA-UNT-QTY TO PV-HOLD-TR211-DATA-VALUE             
273108        MOVE 'INVALID UNIT QTY'     TO PV-HOLD-TR211-ERROR-MSG            
273109        PERFORM 7000-BUILD-ERROR-FILE                                     
273110     END-IF.                                                              
273111                                                                          
273112     IF TR013-CONPOA-CBMT-QTY     NUMERIC                                 
273113        MOVE TR013-CONPOA-CBMT-QTY TO TR023-CONPO-CBMT-QTY                
273114     ELSE                                                                 
273115        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273116        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273117        MOVE 'CBMT QUANTITY'        TO PV-HOLD-TR211-DATA-IN-ERROR        
273118        MOVE TR013-CONPOA-CBMT-QTY-X TO PV-HOLD-TR211-DATA-VALUE          
273119        MOVE 'INVALID CBMT QTY'     TO PV-HOLD-TR211-ERROR-MSG            
273120        PERFORM 7000-BUILD-ERROR-FILE                                     
273121     END-IF.                                                              
273122                                                                          
273123     IF TR013-CONPOA-WT-KGRM-QTY     NUMERIC                              
273124        MOVE TR013-CONPOA-WT-KGRM-QTY  TO TR023-CONPO-WT-KGRM-QTY         
273125     ELSE                                                                 
273126        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273127        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273128        MOVE 'KGRM QUANTITY'        TO PV-HOLD-TR211-DATA-IN-ERROR        
273129        MOVE TR013-CONPOA-WT-KGRM-QTY-X                                   
273130                                    TO PV-HOLD-TR211-DATA-VALUE           
273131        MOVE 'INVALID KGRM QTY'     TO PV-HOLD-TR211-ERROR-MSG            
273132        PERFORM 7000-BUILD-ERROR-FILE                                     
273133     END-IF.                                                              
273134                                                                          
273135     MOVE TR013-CONPOA-ENT-ID     TO TR023-CONPO-DAT-SRC-ENT-ID.          
273136     MOVE TR013-CONPOA-FILE-ID    TO TR023-CONPO-FILE-ID.                 
273137*    MOVE PV-HOLD-TR023-ENT-ID    TO TR023-CONPO-DAT-SRC-ENT-ID.          
273138     MOVE PV-PROCESS-SEQ-NBR   TO TR023-CONPO-PROCESS-SEQ-NBR-1.          
273139                                                                          
273140 EJECT                                                                    
273141                                                                          
273142************************************************************************  
273143                                                                          
273144 5000-EDIT-VS-NUMBER.                                                     
273145                                                                          
273146     SET PS-EDIT-ERROR-NO   TO TRUE.                                      
273147                                                                          
273148*    IF TR013-CONUPA-VS-NBR   = SPACES                                    
273149*DLJ    MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE             
273150*3/27   MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273151*PER    MOVE TR013-CONUPA-VS-NBR   TO PV-HOLD-TR211-DATA-VALUE            
273152*ALICE  MOVE 'VS NUMBER'          TO PV-HOLD-TR211-DATA-IN-ERROR          
273153*EBERT  MOVE 'DATA NOT SENT    '  TO PV-HOLD-TR211-ERROR-MSG              
273154*       PERFORM 7000-BUILD-ERROR-FILE                                     
273155*    END-IF.                                                              
273156                                                                          
273157                                                                          
273158 EJECT                                                                    
273159                                                                          
273160************************************************************************  
273161                                                                          
273162 5500-EDIT-UPC-NUMBER.                                                    
273163                                                                          
273164     SET PS-EDIT-ERROR-NO   TO TRUE.                                      
273165                                                                          
273166     IF TR013-CONUPA-UPC-NBR EQUAL SPACES OR ZEROS                        
273167        MOVE 'UPC NUMBER MISSING' TO PV-HOLD-TR211-ERROR-MSG              
273168        SET PS-EDIT-ERROR    TO TRUE                                      
273169     ELSE                                                                 
273170       IF TR013-CONUPA-UPC-NBR NOT NUMERIC                                
273171          MOVE 'INVALID UPC NUMBER' TO PV-HOLD-TR211-ERROR-MSG            
273172          SET PS-EDIT-ERROR  TO TRUE                                      
273173       END-IF                                                             
273174     END-IF.                                                              
273175                                                                          
273176     IF PS-EDIT-ERROR                                                     
273177       MOVE PC-ERROR        TO PV-HOLD-TR211-ERROR-TYPE                   
273178       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
273179       MOVE 'UPC NUMBER'                                                  
273180                            TO PV-HOLD-TR211-DATA-IN-ERROR                
273181       MOVE TR013-CONUPA-UPC-NBR                                          
273182                            TO PV-HOLD-TR211-DATA-VALUE                   
273183       PERFORM 7000-BUILD-ERROR-FILE                                      
273184     END-IF.                                                              
273185                                                                          
273186************************************************************************  
273187                                                                          
273188 5510-CHECK-CONUP-SEQUENCE.                                               
273189                                                                          
273190     SET PS-SEQUENCE-ERROR-NO   TO TRUE.                                  
273191                                                                          
273192     EVALUATE TRUE                                                        
273193                                                                          
273194       WHEN PS-CVY-CON-WRITTEN-NO                                         
273195         MOVE 'CVY & CON DATA MISSING'                                    
273196                      TO PV-HOLD-TR211-ERROR-MSG                          
273197         SET PS-SEQUENCE-ERROR      TO TRUE                               
273198         IF TR013-CONUPA-UPC-NBR NUMERIC                                  
273199           MOVE TR013-CONUPA-UPC-NBR TO PV-PREV-UPC-NBR                   
273200         ELSE                                                             
273201           MOVE TR013-CONUPA-UPC-NBR-X TO PV-PREV-UPC-NBR-X               
273202         END-IF                                                           
273203                                                                          
273204       WHEN PS-CONPO-WRITTEN-NO                                           
273205       WHEN PS-NEW-PO                                                     
273206         SET PS-SEQUENCE-ERROR      TO TRUE                               
273207         IF TR013-CONUPA-PO-NBR   EQUAL SPACES OR ZEROS                   
273208            MOVE 'PO NUMBER MISSING '                                     
273209                           TO PV-HOLD-TR211-ERROR-MSG                     
273210         ELSE                                                             
273211           IF TR013-CONUPA-PO-NBR     NOT NUMERIC                         
273212              MOVE 'INVALID PO NUMBER'                                    
273213                              TO PV-HOLD-TR211-ERROR-MSG                  
273214           ELSE                                                           
273215              MOVE 'CONPO DATA MISSING'                                   
273216                         TO PV-HOLD-TR211-ERROR-MSG                       
273217           END-IF                                                         
273218         END-IF                                                           
273219         IF TR013-CONUPA-UPC-NBR NUMERIC                                  
273220           MOVE TR013-CONUPA-UPC-NBR TO PV-PREV-UPC-NBR                   
273221         ELSE                                                             
273222           MOVE TR013-CONUPA-UPC-NBR-X TO PV-PREV-UPC-NBR-X               
273223         END-IF                                                           
273224                                                                          
273225       WHEN REC-TYP-CONUPA                                                
273226                                                                          
273227           EVALUATE TRUE                                                  
273228                                                                          
273229             WHEN PS-NEW-GROUP-NO                                         
273230               SET PS-SEQUENCE-ERROR    TO TRUE                           
273231               MOVE 'DUPLICATE UPC DATA'                                  
273232                     TO PV-HOLD-TR211-ERROR-MSG                           
273233                                                                          
273234             WHEN PS-NEW-GROUP                                            
273235               IF PS-NEW-UPC                                              
273236                IF PS-CONUP-WRITTEN                                       
273237                  SET PS-CONUP-WRITTEN-NO  TO TRUE                        
273238                END-IF                                                    
273239               END-IF                                                     
273240             END-EVALUATE                                                 
273241                                                                          
273242       WHEN REC-TYP-CONUPB                                                
273243         IF   NOT   PS-NEW-GROUP                                          
273244          AND PREV-TYP-CONUPA                                             
273245           CONTINUE                                                       
273246         ELSE                                                             
273247           SET PS-SEQUENCE-ERROR    TO TRUE                               
273248           MOVE 'CONUPA DATA MISSING'                                     
273249                 TO PV-HOLD-TR211-ERROR-MSG                               
273250         END-IF                                                           
273251                                                                          
273252       WHEN REC-TYP-CONUPC                                                
273253         IF   NOT   PS-NEW-GROUP                                          
273254          AND PREV-TYP-CONUPB                                             
273255           CONTINUE                                                       
273256         ELSE                                                             
273257           MOVE 'CONUPB DATA MISSING'                                     
273258                 TO PV-HOLD-TR211-ERROR-MSG                               
273259           SET PS-SEQUENCE-ERROR    TO TRUE                               
273260         END-IF                                                           
273261                                                                          
273262       WHEN REC-TYP-CNCART                                                
273263         IF   NOT   PS-NEW-GROUP                                          
273264          AND (PREV-TYP-CONUPC OR PREV-TYP-CNCART)                        
273265           CONTINUE                                                       
273266         ELSE                                                             
273267           MOVE 'CONUP DATA MISSING'                                      
273268                 TO PV-HOLD-TR211-ERROR-MSG                               
273269           SET PS-SEQUENCE-ERROR    TO TRUE                               
273270         END-IF                                                           
273271                                                                          
273272     END-EVALUATE.                                                        
273273                                                                          
273274     IF PS-SEQUENCE-ERROR                                                 
273275       MOVE PC-ERROR        TO PV-HOLD-TR211-ERROR-TYPE                   
273276       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
273277       IF REC-TYP-CNCART                                                  
273278          MOVE 'CNCART LEVEL' TO PV-HOLD-TR211-DATA-IN-ERROR              
273279       ELSE                                                               
273280          MOVE 'CONUP LEVEL' TO PV-HOLD-TR211-DATA-IN-ERROR               
273281       END-IF                                                             
273282       MOVE TR013-CVYA-REC-TYP-CDE                                        
273283                            TO PV-HOLD-TR211-DATA-VALUE                   
273284       PERFORM 7000-BUILD-ERROR-FILE                                      
273285     END-IF.                                                              
273286                                                                          
273287************************************************************************  
273288                                                                          
273289 5600-CONUPA-CONUPB-CONUPC.                                               
273290                                                                          
273291                                                                          
273292     EVALUATE TRUE                                                        
273293                                                                          
273294       WHEN REC-TYP-CONUPA                                                
273295                                                                          
273296          MOVE PV-23-INITIALIZE-CONUPC                                    
273297                              TO TR023-REC-TYP-CONUPC                     
273298          PERFORM 5610-EDIT-MOVE-CONUPA-FIELDS                            
273299          PERFORM 7200-LOAD-GROUP-TABLE                                   
273300                                                                          
273301       WHEN REC-TYP-CONUPB                                                
273302                                                                          
273303          PERFORM 5620-EDIT-MOVE-CONUPB-FIELDS                            
273304          PERFORM 7200-LOAD-GROUP-TABLE                                   
273305                                                                          
273306       WHEN REC-TYP-CONUPC                                                
273307                                                                          
273308          PERFORM 5630-EDIT-MOVE-CONUPC-FIELDS                            
273309          PERFORM 6400-WRITE-UPDATE-RECORD                                
273310          ADD +1 TO PA-TOTAL-UPDATE-CONUPC                                
273311                           PA-TOTAL-UPDATE                                
273312          SET PS-CONUP-WRITTEN  TO TRUE                                   
273313                                                                          
273314       WHEN REC-TYP-CNCART                                                
273315                                                                          
273316          SET PS-CNCART-ERROR-NO TO TRUE                                  
273317          PERFORM 5640-EDIT-MOVE-CNCART-FIELDS                            
273318          IF PS-CNCART-ERROR                                              
273319             CONTINUE                                                     
273320          ELSE                                                            
273330             PERFORM 6400-WRITE-UPDATE-RECORD                             
273340          END-IF                                                          
273350          INITIALIZE PV-GROUP-TABLE                                       
273360                     PV-GRP-SUB                                           
273361                                                                          
273362     END-EVALUATE.                                                        
273363                                                                          
273364************************************************************************  
273365                                                                          
273366 5610-EDIT-MOVE-CONUPA-FIELDS.                                            
273367                                                                          
273368     MOVE TR013-CONUPA-TRN-TYP                                            
273369                          TO TR023-CONUPC-TRN-TYP.                        
273370     MOVE PC-CONUPC       TO TR023-CONUPC-REC-TYP-CDE.                    
273371     MOVE PC-40           TO TR023-CONUPC-SEQ-NBR.                        
273372     MOVE SPACES          TO TR023-CONUPC-3RD-PARTY-CDE.                  
273373     MOVE PV-HOLD-TR211-CONTNR-ID                                         
273374                          TO TR023-CONUPC-CONTNR-ID.                      
273375     MOVE PV-HOLD-TR211-ACTL-DPRTR-DTE-M                                  
273376                          TO TR023-CONUPC-ACTL-DPRTR-DTE.                 
273377     MOVE PV-HOLD-TR211-ACTL-DPRTR-TM-M                                   
273378                          TO TR023-CONUPC-ACTL-DPRTR-TM.                  
273379     MOVE TR013-CONUPA-PO-NBR                                             
273380                          TO TR023-CONUPC-PO-NBR                          
273381*DLJ MOVE TR013-CONUPA-VS-NBR                                             
273382*DLJ                      TO TR023-CONUPC-VS-NBR                          
273383     MOVE TR013-CONUPA-UPC-NBR                                            
273384                          TO TR023-CONUPC-UPC-NBR                         
273385                                                                          
273386     IF TR013-CONUPA-CART-CNT  NUMERIC                                    
273387        MOVE TR013-CONUPA-CART-CNT  TO TR023-CONUPC-CART-CNT              
273388     ELSE                                                                 
273389        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273390        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273391        MOVE 'CARTON COUNT'      TO PV-HOLD-TR211-DATA-IN-ERROR           
273392        MOVE TR013-CONUPA-CART-CNT  TO PV-HOLD-TR211-DATA-VALUE           
273393        MOVE 'INVALID CARTON COUNT' TO PV-HOLD-TR211-ERROR-MSG            
273394        PERFORM 7000-BUILD-ERROR-FILE                                     
273395     END-IF.                                                              
273396                                                                          
273397     IF TR013-CONUPA-UNT-QTY   NUMERIC                                    
273398        MOVE TR013-CONUPA-UNT-QTY   TO TR023-CONUPC-UNT-QTY               
273399     ELSE                                                                 
273400        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273401        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273402        MOVE 'UNIT QUANTITY'     TO PV-HOLD-TR211-DATA-IN-ERROR           
273403        MOVE TR013-CONUPA-UNT-QTY   TO PV-HOLD-TR211-DATA-VALUE           
273404        MOVE 'INVALID UNIT QTY'     TO PV-HOLD-TR211-ERROR-MSG            
273405        PERFORM 7000-BUILD-ERROR-FILE                                     
273406     END-IF.                                                              
273407                                                                          
273408     IF (TR013-CONUPA-CART-CNT  NUMERIC AND                               
273409         TR013-CONUPA-UNT-QTY   NUMERIC)                                  
273410      IF (TR013-CONUPA-CART-CNT > ZEROES AND                              
273411             TR013-CONUPA-UNT-QTY > ZEROES)                               
273412       IF TR013-CONUPA-CART-CNT > TR013-CONUPA-UNT-QTY                    
273413         MOVE PC-WARNING                                                  
273414         TO  PV-HOLD-TR211-ERROR-TYPE                                     
273415         MOVE TR013-CVYA-TRN-TYP                                          
273416         TO  PV-HOLD-TR211-TRN-TYP                                        
273417         MOVE 'CTNS OR UNITS     '                                        
273418         TO  PV-HOLD-TR211-DATA-IN-ERROR                                  
273419         MOVE TR013-CONUPA-CART-CNT                                       
273420         TO  PV-QUANTITY-VALUE                                            
273421         MOVE TR013-CONUPA-UNT-QTY                                        
273422         TO  PV-UNIT-VALUE                                                
273423         MOVE PV-QUANTITY-UNIT-VALUES                                     
273424         TO  PV-HOLD-TR211-DATA-VALUE                                     
273425         MOVE 'CARTONS > UNITS'                                           
273426         TO  PV-HOLD-TR211-ERROR-MSG                                      
273427         PERFORM 7000-BUILD-ERROR-FILE                                    
273428       END-IF                                                             
273429      END-IF                                                              
273430     END-IF.                                                              
273431                                                                          
273432     MOVE TR013-CONUPA-ASN-PKG-CDE                                        
273433                          TO TR023-CONUPC-ASN-PKG-CDE.                    
273434     IF TR013-CONUPA-ASN-PKG-CDE = SPACES                                 
273435        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273436        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273437        MOVE 'ASN PKG CDE  '     TO PV-HOLD-TR211-DATA-IN-ERROR           
273438        MOVE TR013-CONUPA-ASN-PKG-CDE  TO                                 
273439             PV-HOLD-TR211-DATA-VALUE                                     
273440        MOVE 'DATA NOT SENT    ' TO PV-HOLD-TR211-ERROR-MSG               
273441        PERFORM 7000-BUILD-ERROR-FILE                                     
273442     ELSE                                                                 
273443     IF TR013-CONUPA-ASN-PKG-CDE = ('AS' OR 'EA')                         
273444       CONTINUE                                                           
273445     ELSE                                                                 
273446        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273447        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273448        MOVE 'ASN PKG CDE  '     TO PV-HOLD-TR211-DATA-IN-ERROR           
273449        MOVE TR013-CONUPA-ASN-PKG-CDE  TO                                 
273450             PV-HOLD-TR211-DATA-VALUE                                     
273451        MOVE 'UPC PKG CODE NOT VALID' TO PV-HOLD-TR211-ERROR-MSG          
273452        PERFORM 7000-BUILD-ERROR-FILE                                     
273453     END-IF                                                               
273454     END-IF.                                                              
273455                                                                          
273456     MOVE TR013-CONUPA-SKU                                                
273457                                  TO TR023-CONUPC-SKU                     
273458     IF TR013-CONUPA-SKU-X = SPACES                                       
273459        MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE             
273460        MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP                
273461        MOVE 'SKU     '           TO PV-HOLD-TR211-DATA-IN-ERROR          
273462        MOVE TR013-CONUPA-SKU                                             
273463                                  TO PV-HOLD-TR211-DATA-VALUE             
273464        MOVE 'DATA NOT SENT  '    TO PV-HOLD-TR211-ERROR-MSG              
273465        PERFORM 7000-BUILD-ERROR-FILE                                     
273466     END-IF.                                                              
273467                                                                          
273468     MOVE TR013-CONUPA-ENT-ID     TO TR023-CONUPC-DAT-SRC-ENT-ID.         
273469     MOVE TR013-CONUPA-FILE-ID    TO TR023-CONUPC-FILE-ID.                
273470*    MOVE PV-HOLD-TR023-ENT-ID    TO TR023-CONUPC-DAT-SRC-ENT-ID.         
273471     MOVE PV-PROCESS-SEQ-NBR                                              
273472                          TO TR023-CONUPC-PROCESS-SEQ-NBR-1.              
273473                                                                          
273474************************************************************************  
273475                                                                          
273476 5620-EDIT-MOVE-CONUPB-FIELDS.                                            
273477                                                                          
273478     IF TR013-CONUPB-CBMT-QTY  NUMERIC                                    
273479        MOVE TR013-CONUPB-CBMT-QTY  TO TR023-CONUPC-CBMT-QTY              
273480     ELSE                                                                 
273481        MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE           
273482        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
273483        MOVE 'CBMT QUANTITY'     TO PV-HOLD-TR211-DATA-IN-ERROR           
273484        MOVE TR013-CONUPB-CBMT-QTY-X TO PV-HOLD-TR211-DATA-VALUE          
273485        MOVE 'INVALID CBMT QTY'     TO PV-HOLD-TR211-ERROR-MSG            
273486        PERFORM 7000-BUILD-ERROR-FILE                                     
273487     END-IF.                                                              
273488                                                                          
273489     IF TR013-CONUPB-WT-KGRM-QTY  NUMERIC                                 
273490        MOVE TR013-CONUPB-WT-KGRM-QTY                                     
273491                                  TO TR023-CONUPC-WT-KGRM-QTY             
273492     ELSE                                                                 
273493        MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE             
273494        MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP                
273495        MOVE 'KGRM QUANTITY'      TO PV-HOLD-TR211-DATA-IN-ERROR          
273496        MOVE TR013-CONUPB-WT-KGRM-QTY-X                                   
273497                                  TO PV-HOLD-TR211-DATA-VALUE             
273498        MOVE 'INVALID KGRM QTY'   TO PV-HOLD-TR211-ERROR-MSG              
273499        PERFORM 7000-BUILD-ERROR-FILE                                     
273500     END-IF.                                                              
273501                                                                          
273502     MOVE PV-PROCESS-SEQ-NBR                                              
273503                          TO TR023-CONUPC-PROCESS-SEQ-NBR-2.              
273504                                                                          
273505************************************************************************  
273506                                                                          
273507 5630-EDIT-MOVE-CONUPC-FIELDS.                                            
273508                                                                          
273509     MOVE PV-PROCESS-SEQ-NBR TO TR023-CONUPC-PROCESS-SEQ-NBR-3.           
273520                                                                          
273540     INITIALIZE PV-GROUP-TABLE.                                           
273550     INITIALIZE PV-GRP-SUB.                                               
273602 EJECT                                                                    
273640                                                                          
273641******************************************************************        
273642 5640-EDIT-MOVE-CNCART-FIELDS.                                            
273643                                                                          
273644     MOVE TR013-REC-TYP-CNCART TO TR023-REC-TYP-CNCART.                   
273645     MOVE PV-HOLD-TR211-ACTL-DPRTR-DTE-M                                  
273646                          TO TR023-CNCART-ACTL-DPRTR-DTE.                 
273647     MOVE PV-HOLD-TR211-ACTL-DPRTR-TM-M                                   
273648                          TO TR023-CNCART-ACTL-DPRTR-TM.                  
273649                                                                          
273660                                                                          
273661     IF TR013-CNCART-UNT-QTY EQUAL ZEROES                                 
273662        MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE             
273663        MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP                
273664        MOVE 'UNIT QUANTITY'      TO PV-HOLD-TR211-DATA-IN-ERROR          
273665        MOVE '0'                  TO PV-HOLD-TR211-DATA-VALUE-NUM         
273666        MOVE 'DATA NOT SENT'      TO PV-HOLD-TR211-ERROR-MSG              
273667        PERFORM 7000-BUILD-ERROR-FILE                                     
273668     ELSE                                                                 
273669        MOVE TR013-CNCART-UNT-QTY TO TR023-CNCART-UNT-QTY                 
273670     END-IF.                                                              
273671                                                                          
273672     IF TR013-CNCART-UNT-QTY NUMERIC                                      
273673        MOVE TR013-CNCART-UNT-QTY TO TR023-CNCART-UNT-QTY                 
273674     ELSE                                                                 
273675        MOVE PC-WARNING           TO PV-HOLD-TR211-ERROR-TYPE             
273676        MOVE TR013-CVYA-TRN-TYP   TO PV-HOLD-TR211-TRN-TYP                
273677        MOVE 'UNIT QUANTITY'      TO PV-HOLD-TR211-DATA-IN-ERROR          
273678        MOVE TR013-CNCART-UNT-QTY-X                                       
273679                                  TO PV-HOLD-TR211-DATA-VALUE             
273680        MOVE ZEROES               TO TR023-CNCART-UNT-QTY                 
273681        MOVE 'INVALID DATA'       TO PV-HOLD-TR211-ERROR-MSG              
273682        PERFORM 7000-BUILD-ERROR-FILE                                     
273683     END-IF.                                                              
273684                                                                          
273685     MOVE ZERO TO PA-SSCC-SPACE-CNT.                                      
273686     INSPECT TR013-CNCART-SSCC-NBR(3:18) TALLYING                         
273687     PA-SSCC-SPACE-CNT FOR ALL PC-SPACE.                                  
273688                                                                          
273689     EVALUATE TRUE                                                        
273690       WHEN TR013-CNCART-SSCC-NBR(3:18) EQUAL SPACES                      
273691         SET  PS-CNCART-ERROR       TO TRUE                               
273692         MOVE PC-ERROR              TO PV-HOLD-TR211-ERROR-TYPE           
273693         MOVE TR013-CVYA-TRN-TYP    TO PV-HOLD-TR211-TRN-TYP              
273694         MOVE 'SSCC ID'             TO PV-HOLD-TR211-DATA-IN-ERROR        
273695         MOVE SPACES                TO PV-HOLD-TR211-DATA-VALUE           
273696         MOVE 'DATA NOT SENT'       TO PV-HOLD-TR211-ERROR-MSG            
273697         PERFORM 7000-BUILD-ERROR-FILE                                    
273698                                                                          
273699       WHEN PA-SSCC-SPACE-CNT > 0                                         
273700         SET  PS-CNCART-ERROR       TO TRUE                               
273701         MOVE PC-ERROR              TO PV-HOLD-TR211-ERROR-TYPE           
273702         MOVE TR013-CVYA-TRN-TYP    TO PV-HOLD-TR211-TRN-TYP              
273703         MOVE 'SSCC ID'             TO PV-HOLD-TR211-DATA-IN-ERROR        
273704         MOVE TR013-CNCART-SSCC-NBR TO PV-HOLD-TR211-DATA-VALUE           
273705         MOVE 'INVALID DATA'        TO PV-HOLD-TR211-ERROR-MSG            
273706         PERFORM 7000-BUILD-ERROR-FILE                                    
273707                                                                          
273708       WHEN TR013-CNCART-SSCC-NBR(1:2) NOT EQUAL ZEROES                   
273709         SET  PS-CNCART-ERROR       TO TRUE                               
273710         MOVE PC-ERROR              TO PV-HOLD-TR211-ERROR-TYPE           
273711         MOVE TR013-CVYA-TRN-TYP    TO PV-HOLD-TR211-TRN-TYP              
273712         MOVE 'SSCC ID'             TO PV-HOLD-TR211-DATA-IN-ERROR        
273713         MOVE TR013-CNCART-SSCC-NBR TO PV-HOLD-TR211-DATA-VALUE           
273714         MOVE 'INVALID DATA'        TO PV-HOLD-TR211-ERROR-MSG            
273715         PERFORM 7000-BUILD-ERROR-FILE                                    
273716     END-EVALUATE.                                                        
273717                                                                          
273718     IF TR013-CNCART-SSCC-NBR(21:28) NOT EQUAL SPACES                     
273719        MOVE PC-WARNING            TO PV-HOLD-TR211-ERROR-TYPE            
273720        MOVE TR013-CVYA-TRN-TYP    TO PV-HOLD-TR211-TRN-TYP               
273721        MOVE 'SSCC ID'             TO PV-HOLD-TR211-DATA-IN-ERROR         
273722        MOVE TR013-CNCART-SSCC-NBR(21:28)                                 
273723                                   TO PV-HOLD-TR211-DATA-VALUE            
273724        MOVE SPACES                TO TR023-CNCART-SSCC-NBR(21:28)        
273725        MOVE 'INVALID DATA'        TO PV-HOLD-TR211-ERROR-MSG             
273726        PERFORM 7000-BUILD-ERROR-FILE                                     
273727     END-IF.                                                              
273728                                                                          
273729     MOVE TR013-CNCART-ENT-ID  TO TR023-CNCART-DAT-SRC-ENT-ID.            
273730     MOVE TR013-CNCART-FILE-ID TO TR023-CNCART-FILE-ID.                   
273740     MOVE PV-PROCESS-SEQ-NBR   TO TR023-CNCART-PROCESS-SEQ-NBR-1.         
273741                                                                          
273742                                                                          
273743******************************************************************        
273744* READ A RECORD FROM THE CONTAINER FILE.                                  
273745******************************************************************        
273746 6000-READ-CONTAINER-FILE.                                                
273747                                                                          
273748     READ TR013-CONTAINER-FILE                                            
273749         INTO TR013-REC-TYP-CVYA                                          
273750         AT END                                                           
273751           SET PS-END-OF-CONTAINERS TO TRUE.                              
273752                                                                          
273753     IF PS-END-OF-CONTAINERS                                              
273754         CONTINUE                                                         
273755     ELSE                                                                 
273756         ADD +1 TO PA-INPUT-COUNT                                         
273757         MOVE TR013-CONTAINER-RECORD (1:3) TO PV-EDI-RECORDS              
273758         IF EDI-RECORD                                                    
273759             SET PS-EDI-RECORD TO TRUE                                    
273760             PERFORM 6030-PROCESS-EDI-RECORD                              
273761             MOVE PV-PREV-REC-KEY-A     TO PV-PREV-REC-KEY                
273762             MOVE PV-PREV-TRN-TYP-CDE-A TO PV-PREV-TRN-TYP-CDE            
273763         ELSE                                                             
273764             SET PS-CONTAINER-RECORD TO TRUE                              
273765             ADD +1 TO PV-PROCESS-SEQ-NBR                                 
273766     END-IF.                                                              
273767                                                                          
273768     IF PS-END-OF-CONTAINERS-NO                                           
273769         MOVE TR013-REC-TYP-CVYA (1:3) TO PV-HOLD-LAST-REC-TYP            
273770     END-IF.                                                              
273771                                                                          
273772*****************************************************************         
273773* CHECK EDI RECORDS FOR AN ISA RECORD TO DETERMINE THE          *         
273774* CONSOLIDATOR NAME.                                            *         
273775*****************************************************************         
273776 6030-PROCESS-EDI-RECORD.                                                 
273777                                                                          
273778     IF TR013-CONTAINER-RECORD (1:3) EQUAL PC-ISA                         
273779         PERFORM 6040-CHECK-IEA-RECORD                                    
273780         ADD +1 TO PV-PROCESS-SEQ-NBR                                     
273781         MOVE TR013-CONTAINER-RECORD  TO PV-HOLD-EDI-RECORD               
273782         MOVE PV-EDI-VEND-ID-QUAL     TO PV-VEND-ID-QUAL                  
273783         MOVE PV-EDI-VEND-ID          TO PV-VEND-ID                       
273784         PERFORM 6035-PROCESS-ISA-RECORD                                  
273785         SET PREV-TYP-ISA   TO TRUE                                       
273786     END-IF.                                                              
273787                                                                          
273788     IF TR013-CONTAINER-RECORD (1:3) EQUAL PC-CTT                         
273789         PERFORM 2200-FINISH-PREV-GROUP                                   
273790     END-IF.                                                              
273791                                                                          
273792*****************************************************************         
273793* PROCESS THE ISA RECORD TO OBTAIN HEADER RECORD FIELDS.        *         
273794*****************************************************************         
273795 6035-PROCESS-ISA-RECORD.                                                 
273796                                                                          
273797     INITIALIZE TR211-COMMON-FIELDS                                       
273798                TR211-REC-TYP-HDR.                                        
273799     MOVE PC-HEADER1           TO TR211-ERROR-TYPE.                       
273800     MOVE PC-HDR               TO TR211-REC-TYP-HDR-CDE.                  
273801     MOVE PC-01                TO TR211-SEQ-NBR-HDR.                      
273802     MOVE PV-PROCESS-SEQ-NBR   TO TR211-PROCESS-SEQ-NBR.                  
273900     MOVE PC-E                 TO TR211-RPT-TYP.                          
274000                                                                          
274100     PERFORM 6700-SELECT-TENTNME.                                         
274200     IF PS-VALID-ENTNME                                                   
274300         MOVE ENTNME-ENT-NAME-DESC TO TR211-HDR-CONSOL-ENTNME             
274400*        MOVE ENTNME-ENT-ID        TO PV-HOLD-TR023-ENT-ID                
274510*                                     TR211-DAT-SRC-ENT-ID                
274520         MOVE PV-INPUT-ENT-ID      TO PV-HOLD-TR023-ENT-ID                
274530                                      TR211-DAT-SRC-ENT-ID                
274600     ELSE                                                                 
274700         MOVE 'UNKNOWN ENT ID - EI USED'                                  
274800                                   TO TR211-HDR-CONSOL-ENTNME             
275000         MOVE +10594               TO PV-HOLD-TR023-ENT-ID                
275001                                      TR211-DAT-SRC-ENT-ID                
275010*        MOVE +10594               TO PV-HOLD-TR023-ENT-ID                
275020*                                     TR211-DAT-SRC-ENT-ID                
275100     END-IF.                                                              
275200                                                                          
275300     MOVE PV-EDI-CONSOL-TRNS-DTE   TO PV-HDR-CONSOL-TRNS-DTE-REST.        
275400     IF PV-EDI-CONSOL-TRNS-DTE (1:2) EQUAL PC-98 OR PC-99                 
275500         MOVE PC-19 TO PV-HDR-CONSOL-TRNS-DTE-CC                          
275600     ELSE                                                                 
275700         MOVE PC-20 TO PV-HDR-CONSOL-TRNS-DTE-CC                          
275800     END-IF.                                                              
275900     MOVE PV-HDR-CONSOL-TRNS-DTE   TO TR211-HDR-CONSOL-TRNS-DTE.          
276000                                                                          
276100     MOVE PV-EDI-CONSOL-TRNS-TM    TO TR211-HDR-CONSOL-TRNS-TM.           
276200     MOVE PV-EDI-CONSOL-FIL-ID     TO TR211-HDR-CONSOL-FIL-ID.            
276300                                                                          
276400     PERFORM 6600-SET-CURRENT-TMST.                                       
276500     MOVE PV-CURRENT-TMST (1:4) TO                                        
276600                      PV-REFORMAT-TMST-DTE-CY.                            
276700     MOVE PV-CURRENT-TMST (6:2) TO                                        
276800                      PV-REFORMAT-TMST-DTE-MM.                            
276900     MOVE PV-CURRENT-TMST (9:2) TO                                        
277000                      PV-REFORMAT-TMST-DTE-DD.                            
277100     MOVE PV-CURRENT-TMST (12:2) TO                                       
277200                      PV-REFORMAT-TMST-TM-HH.                             
277300     MOVE PV-CURRENT-TMST (15:2) TO                                       
277400                      PV-REFORMAT-TMST-TM-MM.                             
277500     MOVE PV-REFORMAT-TMST-DTE     TO TR211-HDR-LOAD-DTE.                 
277600     MOVE PV-REFORMAT-TMST-TM      TO TR211-HDR-LOAD-TM.                  
277700     PERFORM 6200-WRITE-ERR-REPORT.                                       
277800                                                                          
277900     MOVE PC-HEADER2               TO PV-HOLD-TR211-ERROR-TYPE.           
278000     MOVE PC-D                     TO TR211-RPT-TYP.                      
278100     MOVE PV-PROCESS-SEQ-NBR       TO TR211-PROCESS-SEQ-NBR.              
278200     PERFORM 6200-WRITE-ERR-REPORT.                                       
278300                                                                          
278400     MOVE PV-23-INITIALIZE-CNTR TO TR023-REC-TYP-CNTR.                    
278500     MOVE TR013-REC-TYP-CVYA    TO TR023-REC-TYP-CNTR.                    
278510     MOVE PV-INPUT-FILE-ID      TO TR023-CNTR-FILE-ID.                    
278600     MOVE PV-INPUT-ENT-ID       TO TR023-CNTR-DAT-SRC-ENT-ID.             
278610*    MOVE PV-HOLD-TR023-ENT-ID  TO TR023-CNTR-DAT-SRC-ENT-ID.             
278700     MOVE PV-PROCESS-SEQ-NBR    TO TR023-CNTR-PROCESS-SEQ-NBR-1.          
278800                                                                          
278900     PERFORM 6400-WRITE-UPDATE-RECORD.                                    
279000     ADD +1 TO PA-TOTAL-UPDATE-ISA                                        
279100               PA-TOTAL-UPDATE.                                           
279200                                                                          
279300*****************************************************************         
279400* CHECK TO SEE IF PREVIOUS RECORD WAS AN IEA RECORD.            *         
279500*****************************************************************         
279600                                                                          
279700 6040-CHECK-IEA-RECORD.                                                   
279800                                                                          
279900     IF PV-HOLD-LAST-REC-TYP EQUAL PC-IEA                                 
280000         CONTINUE                                                         
280100     ELSE                                                                 
280200       INITIALIZE TR211-COMMON-FIELDS                                     
280300       MOVE PC-E                        TO TR211-RPT-TYP                  
280400       MOVE PC-EDI                      TO TR211-ERROR-TYPE               
280500       MOVE 'NO IEA RECORD - MSG 2 - CALL PROGRAMMING'                    
280600                                        TO TR211-ERROR-MSG                
280700       ADD +1 TO PV-PROCESS-SEQ-NBR                                       
280800       MOVE PV-PROCESS-SEQ-NBR          TO TR211-PROCESS-SEQ-NBR          
280900       PERFORM 6200-WRITE-ERR-REPORT                                      
281000     END-IF.                                                              
281100                                                                          
281200*****************************************************************         
281300* WRITE TO ERROR FILE.                                          *         
281400*****************************************************************         
281500                                                                          
281600 6200-WRITE-ERR-REPORT.                                                   
281700                                                                          
281800     ADD +1 TO PA-TOTAL-ERROR-COUNT.                                      
281900                                                                          
282000     WRITE TR211-CONTAINER-ERROR-RECORD FROM                              
282100           TR211-RECORD.                                                  
282200                                                                          
282300                                                                          
282400*****************************************************************         
282500* SETUP THE EDITED UPDATE RECORD PRIOR TO WRITING TO THE UPDATE *         
282600* FILE THAT WILL BE PASSED TO PROGRAM TRKUP215.                 *         
282700*****************************************************************         
282800 6400-WRITE-UPDATE-RECORD.                                                
283000     WRITE TR023-UPDATE-CONTAINER-RECORD FROM                             
283100           TR023-REC-TYP-CNTR.                                            
283200                                                                          
283300 EJECT                                                                    
283400                                                                          
283500*****************************************************************         
283600* SETUP FIELDS FOR CALENDAR ROUTINE TO CHECK VALIDITY OF DATES  *         
283700*****************************************************************         
283800 6500-CALENDAR-ROUTINE-SET-UP.                                            
283900                                                                          
284000     INITIALIZE  DPG51 DPG52 DPG53                                        
284100                 DPG54 DPG55 DPG56.                                       
284200                                                                          
284300     SET DPG52-LK-DTE-ISO-FMT TO TRUE.                                    
284400     MOVE PV-FORMAT-DTE        TO DPG52-LK-DATE-INPUT.                    
284500     MOVE PC-A0                TO DPG51-CALENDAR-TYPE.                    
284600                                                                          
284700*****************************************************************         
284800* CALENDAR ROUTINE CALL TO CHECK VALIDITY OF DATES.             *         
284900*****************************************************************         
285000 6510-CALENDAR-ROUTINE.                                                   
285100                                                                          
285200     SET PS-WARNING-DATE-NO                  TO TRUE.                     
285300                                                                          
285400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52                  
285500                                             DPG53 DPG54                  
285600                                             DPG55 DPG56.                 
285700                                                                          
285800     EVALUATE TRUE                                                        
285900         WHEN DPG54-SEVERE-ERROR                                          
286000         WHEN DPG54-WARNING-ERROR                                         
286100             SET PS-WARNING-DATE TO TRUE                                  
286200     END-EVALUATE.                                                        
286300                                                                          
286400 EJECT                                                                    
286500                                                                          
286600*****************************************************************         
286700*  VALIDATE THE TIME FIELD                                      *         
286800*  TIME EDITS:                                                  *         
286900*  IF INPUT = SPACES, PASS (0000).                              *         
287000*  IF INPUT = 0000, PASS (0000).                                *         
287100*  IF INPUT NOT = SPACES, CHECK FOR VALID TIME.                 *         
287200*  IF TIME VALID, PASS IT.                                      *         
287300*  IF TIME NOT VALID, PASS (0000).                              *         
287400*****************************************************************         
287500 6515-VALIDATE-TIME.                                                      
287600                                                                          
287700         SET PS-WARNING-TIME-NO       TO TRUE.                            
287800                                                                          
287900         IF PV-CHECK-TIME     EQUAL SPACES OR                             
288000            PV-CHECK-TIME     EQUAL ZEROES                                
288100              SET PS-WARNING-TIME TO TRUE                                 
288111         ELSE                                                             
288112              IF PV-CHECK-TIME (1:1) = SPACES OR                          
288113                 PV-CHECK-TIME (2:1) = SPACES OR                          
288114                 PV-CHECK-TIME (3:1) = SPACES OR                          
288115                 PV-CHECK-TIME (4:1) = SPACES                             
288116                  SET PS-WARNING-TIME TO TRUE                             
288200              ELSE                                                        
288300                  IF ((PV-CHECK-TIME (1:2) > '0' AND                      
288400                       PV-CHECK-TIME (1:2) < '24')   AND                  
288500                      (PV-CHECK-TIME (3:2) > '0' AND                      
288600                       PV-CHECK-TIME (3:2) < '60'))                       
288700                        CONTINUE                                          
288800                  ELSE                                                    
288900                      SET PS-WARNING-TIME TO TRUE                         
289000                  END-IF                                                  
289010              END-IF                                                      
289100         END-IF.                                                          
289200                                                                          
289300******************************************************************        
289400* SET THE CURRENT TIMESTAMP.                                     *        
289500******************************************************************        
289600 6600-SET-CURRENT-TMST.                                                   
289700                                                                          
289800          EXEC SQL                                                        
289900              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                    
290000          END-EXEC                                                        
290100                                                                          
290200         EVALUATE TRUE                                                    
290300             WHEN SQLCODE = ZERO                                          
290400                 CONTINUE                                                 
290500                                                                          
290600             WHEN SQLWARN0 NOT EQUAL SPACE                                
290700             WHEN SQLCODE NOT EQUAL ZERO                                  
290800                 DISPLAY '**************************************'         
290900                 DISPLAY '** ABEND                            **'         
291000                 DISPLAY '** PROGRAM = TRKUT210               **'         
291100                 DISPLAY '** PARAGRAPH = 6600-SET-CURRENT-TMST**'         
291200                 DISPLAY '** SET CURRENT TIMESTAMP            **'         
291300                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST           
291400                 DISPLAY '**************************************'         
291500                 PERFORM 9100-USER-ABEND                                  
291600         END-EVALUATE.                                                    
291700                                                                          
298301******************************************************************        
298302* SELECT THE CONSOLIDATOR ENTERPRISE NAME FOR HEADER RECORD.     *        
298303******************************************************************        
298304 6700-SELECT-TENTNME.                                                     
298305                                                                          
298306     MOVE PV-INPUT-ENT-ID-9      TO PV-ENT-ID-SIGNED.                     
298307                                                                          
298308     PERFORM                                                              
298309         WITH TEST AFTER                                                  
298310         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
298311         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
298312                 SQLCODE = ZERO                     OR                    
298313                 SQLCODE = +100                                           
298314                                                                          
298315         EXEC SQL                                                         
298316             SELECT DISTINCT                                              
298317                    ENT_NAME_DESC                                         
298318              INTO :ENTNME-ENT-NAME-DESC                                  
298319              FROM  TENTNME                                               
298320              WHERE ENT_ID    = :PV-ENT-ID-SIGNED                         
298321              AND   TYPE_CDE  = '01'                                      
298322         END-EXEC                                                         
298323                                                                          
298324         EVALUATE TRUE                                                    
298325             WHEN SQLCODE = ZERO                                          
298326             WHEN SQLCODE = -811                                          
298327                 SET PS-VALID-ENTNME   TO TRUE                            
298328                                                                          
298329             WHEN SQLCODE = +100                                          
298330                 SET PS-INVALID-ENTNME TO TRUE                            
298331                                                                          
298332             WHEN SQLWARN0 NOT EQUAL SPACE                                
298333             WHEN SQLCODE NOT EQUAL ZERO                                  
298334                 DISPLAY '**************************************'         
298335                 DISPLAY '** ABEND                            **'         
298336                 DISPLAY '** PROGRAM = TRKUT210               **'         
298337                 DISPLAY '** PARAGRAPH = 6700-SELECT-TENTNME  **'         
298338                 DISPLAY '** SELECT CONSOLIDATOR NAME         **'         
298339                 DISPLAY '** FROM ISA RECORD.                 **'         
298340                 DISPLAY '** VEND ID      = ' PV-VEND-ID                  
298341                 DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL             
298342                 DISPLAY '**************************************'         
298343                 PERFORM 9100-USER-ABEND                                  
298344         END-EVALUATE                                                     
298345     END-PERFORM.                                                         
298346                                                                          
298347     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
298348         (SQLCODE NOT = ZERO    AND                                       
298349             SQLCODE NOT = +100 AND                                       
298350             SQLCODE NOT = -811)                                          
298351         DISPLAY '****************************************'               
298352         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
298353         DISPLAY '** SELECT FROM TENTNME                **'               
298354         DISPLAY '** PARAGRAPH = 6700-SELECT-TENTNME    **'               
298355         DISPLAY '** VEND ID      = ' PV-VEND-ID                          
298356         DISPLAY '** VEND ID QUAL = ' PV-VEND-ID-QUAL                     
298357         DISPLAY '****************************************'               
298358         PERFORM 9100-USER-ABEND                                          
298359     END-IF.                                                              
298360                                                                          
298361 EJECT                                                                    
298370                                                                          
298400********************************************************                  
298500* CREATE FILE A FILE TO BE USED AS INPUT IN AN ERROR   *                  
298600* REPORT.                                              *                  
298700********************************************************                  
298800                                                                          
298900 7000-BUILD-ERROR-FILE.                                                   
299000                                                                          
299100     INITIALIZE TR211-COMMON-FIELDS.                                      
299200                                                                          
299300     MOVE PC-E                        TO TR211-RPT-TYP.                   
299400     MOVE PV-PROCESS-SEQ-NBR          TO TR211-PROCESS-SEQ-NBR.           
299500     MOVE PV-HOLD-TR211-TRN-TYP       TO TR211-TRN-TYP.                   
299600     MOVE PV-HOLD-TR211-CONTNR-ID     TO TR211-CONTNR-ID.                 
299700     MOVE PV-HOLD-TR211-ACTL-DPRTR-DTE-M                                  
299800                                   TO TR211-ACTL-DPRTR-DTE-MOM.           
299900     MOVE PV-HOLD-TR211-ACTL-DPRTR-TM-M                                   
300000                                   TO TR211-ACTL-DPRTR-TM-MOM.            
300100     MOVE PV-HOLD-TR211-DATA-IN-ERROR TO TR211-DATA-IN-ERROR.             
300200                                                                          
300300     IF PS-SEQUENCE-ERROR                                                 
300400       MOVE TR013-CVYA-REC-TYP-CDE                                        
300500                            TO TR211-DATA-VALUE                           
300600     ELSE                                                                 
300700       MOVE PV-HOLD-TR211-DATA-VALUE                                      
300800                            TO TR211-DATA-VALUE                           
300900     END-IF.                                                              
301000                                                                          
301100     MOVE PV-HOLD-TR211-ERROR-TYPE    TO TR211-ERROR-TYPE.                
301200     MOVE PV-HOLD-TR211-ERROR-MSG     TO TR211-ERROR-MSG.                 
301300     MOVE PV-HOLD-TR023-ENT-ID        TO TR211-DAT-SRC-ENT-ID.            
301400                                                                          
301500     EVALUATE TRUE                                                        
301600                                                                          
301700       WHEN REC-TYP-CVYA                                                  
301800         INITIALIZE TR211-REC-TYP-CVYA                                    
301900         PERFORM 7010-CVYA-ERROR                                          
302000                                                                          
302100       WHEN REC-TYP-CVYB                                                  
302200         INITIALIZE TR211-REC-TYP-CVYB                                    
302300         PERFORM 7020-CVYB-ERROR                                          
302400                                                                          
302500       WHEN REC-TYP-CONA                                                  
302600         INITIALIZE TR211-REC-TYP-CONA                                    
302700         PERFORM 7030-CONA-ERROR                                          
302800                                                                          
302900       WHEN REC-TYP-CONB                                                  
303000         INITIALIZE TR211-REC-TYP-CONB                                    
303100         PERFORM 7040-CONB-ERROR                                          
303200                                                                          
303300       WHEN REC-TYP-CONPOA                                                
303400         INITIALIZE TR211-REC-TYP-CONPOA                                  
303500         PERFORM 7050-CONPOA-ERROR                                        
303600                                                                          
303700       WHEN REC-TYP-CONPOB                                                
303800         INITIALIZE TR211-REC-TYP-CONPOB                                  
303900         PERFORM 7060-CONPOB-ERROR                                        
304000                                                                          
304100       WHEN REC-TYP-CONPOC                                                
304200         INITIALIZE TR211-REC-TYP-CONPOC                                  
304300         PERFORM 7070-CONPOC-ERROR                                        
304800                                                                          
304900       WHEN REC-TYP-CONUPA                                                
305000         INITIALIZE TR211-REC-TYP-CONUPA                                  
305100         PERFORM 7090-CONUPA-ERROR                                        
305200                                                                          
305300       WHEN REC-TYP-CONUPB                                                
305400         INITIALIZE TR211-REC-TYP-CONUPB                                  
305500         PERFORM 7100-CONUPB-ERROR                                        
305600                                                                          
305700       WHEN REC-TYP-CONUPC                                                
305800         INITIALIZE TR211-REC-TYP-CONUPC                                  
305900         PERFORM 7110-CONUPC-ERROR                                        
305901                                                                          
305902       WHEN REC-TYP-CNCART                                                
305903         INITIALIZE TR211-REC-TYP-CNCART                                  
305904         PERFORM 7120-CNCART-ERROR                                        
305905                                                                          
305906       WHEN REC-TYP-CNSEAL                                                
305907         INITIALIZE TR211-REC-TYP-CNSEAL                                  
305908         PERFORM 7130-CNSEAL-ERROR                                        
306100     END-EVALUATE.                                                        
306200                                                                          
306300     PERFORM 6200-WRITE-ERR-REPORT.                                       
306400                                                                          
306500 EJECT                                                                    
306600                                                                          
306700***********************************************                           
306800* MOVE FIELDS TO CVYA AREA OF TR011 RECORD.   *                           
306900***********************************************                           
307000                                                                          
307100 7010-CVYA-ERROR.                                                         
307200                                                                          
307300     MOVE PC-CVYA                  TO TR211-REC-TYP-CVYA-CDE.             
307400     MOVE PC-10                    TO TR211-SEQ-NBR-CVYA.                 
307500     MOVE TR013-CVYA-3RD-PARTY-CDE TO TR211-3RD-PARTY-CDE.                
307600     MOVE TR013-CVYA-EST-POE-DELY-DTE                                     
307700                              TO TR211-CVYA-EST-POE-DELY-DTE.             
307800     MOVE TR013-CVYA-EST-POE-DELY-TM                                      
307900                              TO TR211-CVYA-EST-POE-DELY-TM.              
308000     MOVE TR013-CVYA-IMPRT-TRIP-ID                                        
308100                              TO TR211-CVYA-IMPRT-TRIP-ID.                
308200     MOVE TR013-CVYA-CARR-SCAC-ID                                         
308300                              TO TR211-CVYA-CARR-SCAC-ID.                 
308400     MOVE TR013-CVYA-IMP-VEH-NM-MOM                                       
308500                              TO TR211-CVYA-IMP-VEH-NM-MOM.               
308600     MOVE TR013-CVYA-ACTL-FOB-CDE-MOM                                     
308700                              TO TR211-CVYA-ACTL-FOB-CDE-MOM.             
308800     MOVE TR013-CVYA-DEST-POE-CDE-MOM                                     
308900                              TO TR211-CVYA-DEST-POE-CDE-MOM.             
309000     MOVE TR013-CVYA-TRIP-TYP-CDE-MOM                                     
309100                              TO TR211-CVYA-TRIP-TYP-CDE-MOM.             
309200     MOVE TR013-CVYA-TRIP-TYP-CDE-MOM                                     
309300                              TO TR211-CVYA-EST-LBD-NM.                   
309400     MOVE TR013-CVYA-EST-LBD-DTE                                          
309500                              TO TR211-CVYA-EST-LBD-DTE.                  
309600     MOVE TR013-CVYA-EST-LBD-TM                                           
309700                              TO TR211-CVYA-EST-LBD-TM.                   
309701     MOVE TR013-CVYA-POL-CDE-MOM                                          
309702                              TO TR211-CVYA-POL-CDE-MOM.                  
309703     MOVE TR013-CVYA-POR-CDE-MOM                                          
309704                              TO TR211-CVYA-POR-CDE-MOM.                  
309800                                                                          
309900 EJECT                                                                    
310000                                                                          
310100***********************************************                           
310200* MOVE FIELDS TO CVYB AREA OF TR011 RECORD.   *                           
310300***********************************************                           
310400                                                                          
310500 7020-CVYB-ERROR.                                                         
310600                                                                          
310700     MOVE PC-CVYB                     TO TR211-REC-TYP-CVYB-CDE.          
310800     MOVE PC-11                       TO TR211-SEQ-NBR-CVYB.              
310900     MOVE TR013-CVYB-3RD-PARTY-CDE                                        
311000                              TO TR211-3RD-PARTY-CDE-CVYB.                
311100     MOVE TR013-CVYB-EST-POE-DELY-DTE                                     
311200                              TO TR211-CVYB-EST-POE-DELY-DTE.             
311300     MOVE TR013-CVYB-EST-POE-DELY-TM                                      
311400                              TO TR211-CVYB-EST-POE-DELY-TM.              
311500     MOVE TR013-CVYB-IMPRT-TRIP-ID                                        
311600                              TO TR211-CVYB-IMPRT-TRIP-ID.                
311700     MOVE TR013-CVYB-CARR-SCAC-ID                                         
311800                              TO TR211-CVYB-CARR-SCAC-ID.                 
311900     MOVE TR013-CVYB-ACTL-DPRTR-DTE-FDR                                   
312000                              TO TR211-CVYB-ACTL-DPRTR-DTE-FDR.           
312100     MOVE TR013-CVYB-ACTL-DPRTR-TM-FDR                                    
312200                              TO TR211-CVYB-ACTL-DPRTR-TM-FDR.            
312300     MOVE TR013-CVYB-IMP-VEH-NM-FDR                                       
312400                              TO TR211-CVYB-IMP-VEH-NM-FDR.               
312500     MOVE TR013-CVYB-ACTL-FOB-CDE-FDR                                     
312600                              TO TR211-CVYB-ACTL-FOB-CDE-FDR.             
312700     MOVE TR013-CVYB-DEST-POE-CDE-FDR                                     
312800                              TO TR211-CVYB-DEST-POE-CDE-FDR.             
312900     MOVE TR013-CVYB-TRIP-TYP-CDE-FDR                                     
313000                              TO TR211-CVYB-TRIP-TYP-CDE-FDR.             
313001     MOVE TR013-CVYB-POL-CDE-FDR                                          
313002                              TO TR211-CVYB-POL-CDE-FDR.                  
313003     MOVE TR013-CVYB-POR-CDE-FDR                                          
313004                              TO TR211-CVYB-POR-CDE-FDR.                  
313100                                                                          
313200 EJECT                                                                    
313300                                                                          
313400***********************************************                           
313500* MOVE FIELDS TO CONA AREA OF TR011 RECORD.   *                           
313600***********************************************                           
313700                                                                          
313800 7030-CONA-ERROR.                                                         
313900                                                                          
314000     MOVE PC-CONA                  TO TR211-REC-TYP-CONA-CDE.             
314100     MOVE PC-20                    TO TR211-SEQ-NBR-CONA.                 
314200     MOVE TR013-CONA-3RD-PARTY-CDE                                        
314300                              TO TR211-3RD-PARTY-CDE-CONA.                
315200     MOVE TR013-CONA-CONSOL-SCAC-ID                                       
315300                              TO TR211-CONA-CONSOL-SCAC-ID.               
315400                                                                          
315500     IF TR013-CONA-CART-CNT NUMERIC                                       
315600       MOVE TR013-CONA-CART-CNT   TO TR211-CONA-CART-CNT                  
315700     ELSE                                                                 
315800       MOVE TR013-CONA-CART-CNT-X TO TR211-CONA-CART-CNT-X                
315900     END-IF.                                                              
316000                                                                          
316100     IF TR013-CONA-UNT-QTY NUMERIC                                        
316200       MOVE TR013-CONA-UNT-QTY    TO TR211-CONA-UNT-QTY                   
316300     ELSE                                                                 
316400       MOVE TR013-CONA-UNT-QTY-X  TO TR211-CONA-UNT-QTY-X                 
316500     END-IF.                                                              
316600                                                                          
316700     IF TR013-CONA-CBMT-QTY NUMERIC                                       
316800       MOVE TR013-CONA-CBMT-QTY   TO TR211-CONA-CBMT-QTY                  
316900     ELSE                                                                 
317000       MOVE TR013-CONA-CBMT-QTY-X TO TR211-CONA-CBMT-QTY-X                
317100     END-IF.                                                              
317200                                                                          
317300     IF TR013-CONA-WT-KGRM-QTY NUMERIC                                    
317400       MOVE TR013-CONA-WT-KGRM-QTY TO TR211-CONA-WT-KGRM-QTY              
317500     ELSE                                                                 
317600       MOVE TR013-CONA-WT-KGRM-QTY-X                                      
317700                                   TO TR211-CONA-WT-KGRM-QTY-X            
317800     END-IF.                                                              
317900                                                                          
318000 EJECT                                                                    
318100                                                                          
318200***********************************************                           
318300* MOVE FIELDS TO CONB AREA OF TR011 RECORD.   *                           
318400***********************************************                           
318500                                                                          
318600 7040-CONB-ERROR.                                                         
318700                                                                          
318800     MOVE PC-CONB            TO TR211-REC-TYP-CONB-CDE.                   
318900     MOVE PC-21              TO TR211-SEQ-NBR-CONB.                       
319000     MOVE TR013-CONB-3RD-PARTY-CDE                                        
319100                             TO TR211-3RD-PARTY-CDE-CONB.                 
320000     MOVE TR013-CONB-ORGN-SHPD-FR-CDE                                     
320100                             TO TR211-CONB-ORGN-SHPD-FR-CDE.              
320200     MOVE TR013-CONB-ORGN-SHPD-TO-CDE                                     
320300                             TO TR211-CONB-ORGN-SHPD-TO-CDE.              
322100     MOVE TR013-CONB-SIZE-CDE                                             
322110                             TO TR211-CONB-SIZE-CDE.                      
322200     MOVE TR013-CONB-TRIP-TYP-CDE                                         
322210                             TO TR211-CONB-TRIP-TYP-CDE.                  
322300                                                                          
322400 EJECT                                                                    
322500                                                                          
322600***********************************************                           
322700* MOVE FIELDS TO CONPOA AREA OF TR011 RECORD. *                           
322800***********************************************                           
322900                                                                          
323000 7050-CONPOA-ERROR.                                                       
323100                                                                          
323200     MOVE PC-CONPOA                  TO TR211-REC-TYP-CONPOA-CDE.         
323300     MOVE PC-30                      TO TR211-SEQ-NBR-CONPOA.             
323400     MOVE TR013-CONPOA-3RD-PARTY-CDE                                      
323500                                TO TR211-3RD-PARTY-CDE-CONPOA.            
324600                                                                          
324601     MOVE TR013-CONPOA-EXTL-REF-NBR                                       
324602                              TO TR211-CONPOA-EXTL-REF-NBR.               
324700     IF TR013-CONPOA-PO-NBR NUMERIC                                       
324800         MOVE TR013-CONPOA-PO-NBR   TO TR211-CONPOA-PO-NBR                
324900     ELSE                                                                 
325000         MOVE TR013-CONPOA-PO-NBR-X TO TR211-CONPOA-PO-NBR-X              
325100     END-IF.                                                              
325200                                                                          
325300     IF TR013-CONPOA-CART-CNT NUMERIC                                     
325400         MOVE TR013-CONPOA-CART-CNT                                       
325500                                 TO TR211-CONPOA-CART-CNT                 
325600     ELSE                                                                 
325700         MOVE TR013-CONPOA-CART-CNT-X                                     
325800                                 TO TR211-CONPOA-CART-CNT-X               
325900     END-IF.                                                              
326000                                                                          
326100     IF TR013-CONPOA-UNT-QTY NUMERIC                                      
326200         MOVE TR013-CONPOA-UNT-QTY                                        
326300                                 TO TR211-CONPOA-UNT-QTY                  
326400     ELSE                                                                 
326500         MOVE TR013-CONPOA-UNT-QTY-X                                      
326600                                 TO TR211-CONPOA-UNT-QTY-X                
326700     END-IF.                                                              
326800                                                                          
326900     IF TR013-CONPOA-CBMT-QTY NUMERIC                                     
327000         MOVE TR013-CONPOA-CBMT-QTY                                       
327100                                 TO TR211-CONPOA-CBMT-QTY                 
327200     ELSE                                                                 
327300         MOVE TR013-CONPOA-CBMT-QTY-X                                     
327400                                 TO TR211-CONPOA-CBMT-QTY-X               
327500     END-IF.                                                              
327600                                                                          
327700     IF TR013-CONPOA-WT-KGRM-QTY NUMERIC                                  
327800         MOVE TR013-CONPOA-WT-KGRM-QTY                                    
327900                                 TO TR211-CONPOA-WT-KGRM-QTY              
328000     ELSE                                                                 
328100         MOVE TR013-CONPOA-WT-KGRM-QTY-X                                  
328200                                 TO TR211-CONPOA-WT-KGRM-QTY-X            
328300     END-IF.                                                              
328400                                                                          
328500 EJECT                                                                    
328600                                                                          
328700***********************************************                           
328800* MOVE FIELDS TO CONPOB AREA OF TR011 RECORD. *                           
328900***********************************************                           
329000                                                                          
329100 7060-CONPOB-ERROR.                                                       
329200                                                                          
329300     MOVE PC-CONPOB           TO TR211-REC-TYP-CONPOB-CDE.                
329400     MOVE PC-31               TO TR211-SEQ-NBR-CONPOB.                    
329500     MOVE TR013-CONPOB-3RD-PARTY-CDE                                      
329600                              TO TR211-3RD-PARTY-CDE-CONPOB.              
330700                                                                          
330800     IF TR013-CONPOB-PO-NBR NUMERIC                                       
330900         MOVE TR013-CONPOB-PO-NBR    TO TR211-CONPOB-PO-NBR               
331000     ELSE                                                                 
331100         MOVE TR013-CONPOB-PO-NBR-X  TO TR211-CONPOB-PO-NBR-X             
331200     END-IF.                                                              
331300                                                                          
331400     MOVE TR013-CONPOB-PO-RCVD-DELY-DTE                                   
331500                              TO TR211-CONPOB-PO-ACTL-DELY-DTE.           
331600                                                                          
331700     MOVE TR013-CONPOB-LTR-OF-CR-NBR                                      
331800                              TO TR211-CONPOB-LTR-OF-CR-NBR.              
331900                                                                          
332000     MOVE TR013-CONPOB-HSE-BOL-NBR                                        
332100                              TO TR211-CONPOB-HSE-BOL-NBR.                
332200                                                                          
332300 EJECT                                                                    
332400                                                                          
332500***********************************************                           
332600* MOVE FIELDS TO CONPOC AREA OF TR011 RECORD. *                           
332700***********************************************                           
332800                                                                          
332900 7070-CONPOC-ERROR.                                                       
333000                                                                          
333100     MOVE PC-CONPOC           TO TR211-REC-TYP-CONPOC-CDE.                
333200     MOVE PC-32               TO TR211-SEQ-NBR-CONPOC.                    
333300     MOVE TR013-CONPOC-3RD-PARTY-CDE                                      
333400                              TO TR211-3RD-PARTY-CDE-CONPOC.              
334500                                                                          
334600     IF TR013-CONPOC-PO-NBR NUMERIC                                       
334700         MOVE TR013-CONPOC-PO-NBR TO TR211-CONPOC-PO-NBR                  
334800     ELSE                                                                 
334900         MOVE TR013-CONPOC-PO-NBR-X TO TR211-CONPOC-PO-NBR-X              
335000     END-IF.                                                              
335100                                                                          
335200     MOVE TR013-CONPOC-PO-RCVD-DELY-DTE                                   
335300                              TO TR211-CONPOC-PO-ACTL-DELY-DTE.           
335400     MOVE TR013-CONPOC-MSTR-BOL-NBR                                       
335500                              TO TR211-CONPOC-MSTR-BOL-NBR.               
335600     MOVE TR013-CONPOC-PO-C-O-PROD-CDE                                    
335700                              TO TR211-CONPOC-PO-C-O-PROD-CDE.            
335800     MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE                                  
335900                              TO TR211-CONPOC-DOC-RCVD-ORGN-DTE.          
336000     MOVE TR013-CONPOC-DOC-RCVD-ORGN-DTE                                  
336001                              TO TR211-CONPOC-DOC-RCVD-ORGN-DTE.          
336002                                                                          
336003 EJECT                                                                    
336004                                                                          
342100                                                                          
342200 EJECT                                                                    
342300                                                                          
342400***********************************************                           
342500* MOVE FIELDS TO CONUPA AREA OF TR011 RECORD. *                           
342600***********************************************                           
342700                                                                          
342800 7090-CONUPA-ERROR.                                                       
342900                                                                          
343000     MOVE PC-CONUPA           TO TR211-REC-TYP-CONUPA-CDE.                
343100     MOVE PC-50               TO TR211-SEQ-NBR-CONUPA.                    
343200     MOVE TR013-CONUPA-3RD-PARTY-CDE                                      
343300                              TO TR211-3RD-PARTY-CDE-CONUPA.              
344400     IF TR013-CONUPA-PO-NBR NUMERIC                                       
344500         MOVE TR013-CONUPA-PO-NBR TO TR211-CONUPA-PO-NBR                  
344600     ELSE                                                                 
344700         MOVE TR013-CONUPA-PO-NBR-X TO TR211-CONUPA-PO-NBR-X              
344800     END-IF.                                                              
344900                                                                          
345000*DLJ MOVE TR013-CONUPA-VS-NBR TO TR211-CONUPA-VS-NBR.                     
345100                                                                          
345200     IF TR013-CONUPA-UPC-NBR        NUMERIC                               
345300         MOVE TR013-CONUPA-UPC-NBR TO TR211-CONUPA-UPC-NBR                
345400     ELSE                                                                 
345500         MOVE TR013-CONUPA-UPC-NBR-X                                      
345600                                 TO TR211-CONUPA-UPC-NBR-X                
345700     END-IF.                                                              
345800                                                                          
345900     IF TR013-CONUPA-CART-CNT NUMERIC                                     
346000         MOVE TR013-CONUPA-CART-CNT                                       
346100                                 TO TR211-CONUPA-CART-CNT                 
346200     ELSE                                                                 
346300         MOVE TR013-CONUPA-CART-CNT-X                                     
346400                                 TO TR211-CONUPA-CART-CNT-X               
346500     END-IF.                                                              
346600                                                                          
346700     IF TR013-CONUPA-UNT-QTY NUMERIC                                      
346800         MOVE TR013-CONUPA-UNT-QTY                                        
346900                                 TO TR211-CONUPA-UNT-QTY                  
347000     ELSE                                                                 
347100         MOVE TR013-CONUPA-UNT-QTY-X                                      
347200                                 TO TR211-CONUPA-UNT-QTY-X                
347300     END-IF.                                                              
347301                                                                          
347302     IF TR013-CONUPA-SKU NUMERIC                                          
347303         MOVE TR013-CONUPA-SKU                                            
347304                                 TO TR211-CONUPA-SKU                      
347305     ELSE                                                                 
347306         MOVE TR013-CONUPA-SKU-X                                          
347307                                 TO TR211-CONUPA-SKU-X                    
347308     END-IF.                                                              
347309     MOVE TR013-CONUPA-ASN-PKG-CDE                                        
347310                                 TO TR211-CONUPA-ASN-PKG-CDE.             
347400                                                                          
347500 EJECT                                                                    
347600                                                                          
347700***********************************************                           
347800* MOVE FIELDS TO CONUPB AREA OF TR011 RECORD. *                           
347900***********************************************                           
348000                                                                          
348100 7100-CONUPB-ERROR.                                                       
348200                                                                          
348300     MOVE PC-CONUPB           TO TR211-REC-TYP-CONUPB-CDE.                
348400     MOVE PC-51               TO TR211-SEQ-NBR-CONUPB.                    
348500     MOVE TR013-CONUPB-3RD-PARTY-CDE                                      
348600                              TO TR211-3RD-PARTY-CDE-CONUPB.              
349700                                                                          
349800     IF TR013-CONUPB-PO-NBR NUMERIC                                       
349900         MOVE TR013-CONUPB-PO-NBR TO TR211-CONUPB-PO-NBR                  
350000     ELSE                                                                 
350100         MOVE TR013-CONUPB-PO-NBR-X TO TR211-CONUPB-PO-NBR-X              
350200     END-IF.                                                              
350300                                                                          
350400*    MOVE TR013-CONUPB-VS-NBR TO TR211-CONUPB-VS-NBR.                     
350500                                                                          
350600     IF TR013-CONUPB-UPC-NBR        NUMERIC                               
350700         MOVE TR013-CONUPB-UPC-NBR TO TR211-CONUPB-UPC-NBR                
350800     ELSE                                                                 
350900         MOVE TR013-CONUPB-UPC-NBR-X                                      
351000                                 TO TR211-CONUPB-UPC-NBR-X                
351100     END-IF.                                                              
351200                                                                          
351300     IF TR013-CONUPB-CBMT-QTY NUMERIC                                     
351400         MOVE TR013-CONUPB-CBMT-QTY                                       
351500                                 TO TR211-CONUPB-CBMT-QTY                 
351600     ELSE                                                                 
351700         MOVE TR013-CONUPB-CBMT-QTY-X                                     
351800                                 TO TR211-CONUPB-CBMT-QTY-X               
351900     END-IF.                                                              
352000                                                                          
352100     IF TR013-CONUPB-WT-KGRM-QTY NUMERIC                                  
352200         MOVE TR013-CONUPB-WT-KGRM-QTY                                    
352300                                 TO TR211-CONUPB-WT-KGRM-QTY              
352400     ELSE                                                                 
352500         MOVE TR013-CONUPB-WT-KGRM-QTY-X                                  
352600                                 TO TR211-CONUPB-WT-KGRM-QTY-X            
352700     END-IF.                                                              
352800                                                                          
352900 EJECT                                                                    
353000                                                                          
353100***********************************************                           
353200* MOVE FIELDS TO CONUPC AREA OF TR011 RECORD. *                           
353300***********************************************                           
353400                                                                          
353500 7110-CONUPC-ERROR.                                                       
353600                                                                          
353700     MOVE PC-CONUPC           TO TR211-REC-TYP-CONUPC-CDE.                
353800     MOVE PC-52               TO TR211-SEQ-NBR-CONUPC.                    
353900     MOVE TR013-CONUPC-3RD-PARTY-CDE                                      
354000                              TO TR211-3RD-PARTY-CDE-CONUPC.              
355100                                                                          
355200     IF TR013-CONUPC-PO-NBR NUMERIC                                       
355300         MOVE TR013-CONUPC-PO-NBR   TO TR211-CONUPC-PO-NBR                
355400     ELSE                                                                 
355500         MOVE TR013-CONUPC-PO-NBR-X TO TR211-CONUPC-PO-NBR-X              
355600     END-IF.                                                              
355700                                                                          
355800     MOVE TR013-CONUPC-VS-NBR       TO TR211-CONUPC-VS-NBR.               
355900                                                                          
356000     IF TR013-CONUPC-UPC-NBR        NUMERIC                               
356100         MOVE TR013-CONUPC-UPC-NBR  TO TR211-CONUPC-UPC-NBR               
356200     ELSE                                                                 
356300         MOVE TR013-CONUPC-UPC-NBR-X                                      
356400                                TO TR211-CONUPC-UPC-NBR-X                 
356500     END-IF.                                                              
356501 EJECT                                                                    
356502                                                                          
356503***********************************************                           
356504* MOVE FIELDS TO CNCART AREA OF TR011 RECORD. *                           
356505***********************************************                           
356506                                                                          
356507 7120-CNCART-ERROR.                                                       
356508                                                                          
356509     MOVE PC-CNCART           TO TR211-REC-TYP-CNCART-CDE.                
356510     MOVE PC-60               TO TR211-SEQ-NBR-CNCART.                    
356511     MOVE TR013-CNCART-3RD-PARTY-CDE                                      
356512                              TO TR211-3RD-PARTY-CDE-CNCART.              
356513                                                                          
356514     IF TR013-CNCART-PO-NBR NUMERIC                                       
356515         MOVE TR013-CNCART-PO-NBR   TO TR211-CNCART-PO-NBR                
356516     ELSE                                                                 
356517         MOVE TR013-CNCART-PO-NBR-X TO TR211-CNCART-PO-NBR-X              
356518     END-IF.                                                              
356519                                                                          
356520     IF TR013-CNCART-UPC-NBR        NUMERIC                               
356521         MOVE TR013-CNCART-UPC-NBR  TO TR211-CNCART-UPC-NBR               
356522     ELSE                                                                 
356523         MOVE TR013-CNCART-UPC-NBR-X                                      
356524                                TO TR211-CNCART-UPC-NBR-X                 
356525     END-IF.                                                              
356526                                                                          
356527     IF TR211-CNCART-UNT-QTY NUMERIC                                      
356528         MOVE TR013-CNCART-UNT-QTY  TO TR211-CNCART-UNT-QTY               
356529     ELSE                                                                 
356530         MOVE TR013-CNCART-UNT-QTY-X TO TR211-CNCART-UNT-QTY-X            
356540     END-IF.                                                              
356550                                                                          
356560     MOVE TR013-CNCART-SSCC-NBR TO TR211-CNCART-SSCC-NBR.                 
356561                                                                          
356562 EJECT                                                                    
356563                                                                          
356564***********************************************                           
356565* MOVE FIELDS TO CNSEAL AREA OF TR011 RECORD. *                           
356566***********************************************                           
356567                                                                          
356568 7130-CNSEAL-ERROR.                                                       
356569                                                                          
356570     MOVE PC-CNSEAL           TO TR211-REC-TYP-CNCART-CDE.                
356580     MOVE PC-70               TO TR211-SEQ-NBR-CNCART.                    
356590     MOVE TR013-CNCART-3RD-PARTY-CDE                                      
356600                              TO TR211-3RD-PARTY-CDE-CNCART.              
356700                                                                          
356800     MOVE TR013-CNSEAL-CONTNR-SEAL-NBR                                    
356801                            TO TR211-CNSEAL-CONTNR-SEAL-NBR.              
356802                                                                          
357500 EJECT                                                                    
357600                                                                          
357700********************************************************                  
357800* SAVE TR013 RECORDS ON A TABLE SO THAT IF, PART OF A  *                  
357900* GROUP IS MISSING, YOU CAN WRITE THEM OUT AS ERRORS.  *                  
358000********************************************************                  
358100                                                                          
358200 7200-LOAD-GROUP-TABLE.                                                   
358300                                                                          
358400     ADD +1 TO PV-GRP-SUB.                                                
358500                                                                          
358600     IF PV-GRP-SUB > PC-GRP-TBL-MAX                                       
358700         DISPLAY '*******************************************'            
358800         DISPLAY '** INTERNAL TABLE FULL                   **'            
358900         DISPLAY '** PARAGRAPH     = 7200-LOAD-GROUP-TABLE **'            
359000         DISPLAY '** TABLE MAX     = ' PC-GRP-TBL-MAX                     
359100         DISPLAY '** TBL SUBSCRIPT = ' PV-GRP-SUB                         
359200         DISPLAY '********* *********************************'            
359300         PERFORM 9100-USER-ABEND                                          
359400     ELSE                                                                 
359500      MOVE TR013-REC-TYP-CVYA                                             
359600                          TO PV-GRP-TBL-TR013-REC (PV-GRP-SUB)            
359700      MOVE PV-PROCESS-SEQ-NBR                                             
359800                          TO PV-GRP-TBL-SEQ-NBR (PV-GRP-SUB)              
359900     END-IF.                                                              
360000                                                                          
360100 EJECT                                                                    
360200                                                                          
360300************************************************************************  
360400* THESE FIELDS ARE COMMON TO ALL RECORDS BUT NOT PART OF THE TRUE KEY. *  
360500************************************************************************  
360600                                                                          
360700 7300-EDIT-COMMON-FIELDS.                                                 
360800                                                                          
360900     IF TR013-CVYA-EST-POE-DELY-DTE EQUAL SPACES                          
361000       MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE                     
361100       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
361200       MOVE TR013-CVYA-EST-POE-DELY-DTE           TO                      
361300             PV-HOLD-TR211-DATA-VALUE                                     
361400       MOVE 'EST POE DELY DT'                TO                           
361500             PV-HOLD-TR211-DATA-IN-ERROR                                  
361600       MOVE 'ESTIMATED POE DELIVERY DATE NOT SENT' TO                     
361700             PV-HOLD-TR211-ERROR-MSG                                      
361800       MOVE PC-DEFAULT-DTE-NO-DASHES                                      
361900                            TO TR013-CVYA-EST-POE-DELY-DTE                
362000       PERFORM 7000-BUILD-ERROR-FILE                                      
362100     ELSE                                                                 
362200       MOVE TR013-CVYA-EST-POE-DELY-DTE (1:4)    TO                       
362300               PV-FORMAT-DTE-CCYY                                         
362400       MOVE TR013-CVYA-EST-POE-DELY-DTE (5:2)    TO                       
362500               PV-FORMAT-DTE-MM                                           
362600       MOVE TR013-CVYA-EST-POE-DELY-DTE (7:2)    TO                       
362700               PV-FORMAT-DTE-DD                                           
362800       PERFORM 6500-CALENDAR-ROUTINE-SET-UP                               
362900       PERFORM 6510-CALENDAR-ROUTINE                                      
363000       IF PS-WARNING-DATE                                                 
363100          MOVE PC-WARNING    TO PV-HOLD-TR211-ERROR-TYPE                  
363200          MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                
363300          MOVE TR013-CVYA-EST-POE-DELY-DTE      TO                        
363400                PV-HOLD-TR211-DATA-VALUE                                  
363500          MOVE 'EST POE DELY DT'                TO                        
363600                PV-HOLD-TR211-DATA-IN-ERROR                               
363700          MOVE 'INVALID DATE'                   TO                        
363800                PV-HOLD-TR211-ERROR-MSG                                   
363900          MOVE PC-DEFAULT-DTE-NO-DASHES                                   
364000                           TO TR013-CVYA-EST-POE-DELY-DTE                 
364100          PERFORM 7000-BUILD-ERROR-FILE                                   
364200       END-IF                                                             
364300     END-IF.                                                              
364400                                                                          
364500     MOVE TR013-CVYA-EST-POE-DELY-TM TO PV-CHECK-TIME.                    
364600     PERFORM 6515-VALIDATE-TIME.                                          
364700     IF PS-WARNING-TIME                                                   
364800       MOVE PC-DEFAULT-TIME    TO TR013-CVYA-EST-POE-DELY-TM              
364900     END-IF.                                                              
365000                                                                          
365100     IF TR013-CVYA-IMPRT-TRIP-ID            EQUAL SPACES                  
365200       MOVE PC-WARNING             TO PV-HOLD-TR211-ERROR-TYPE            
365300       MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                   
365400       MOVE 'IMPRT TRIP ID'        TO PV-HOLD-TR211-DATA-IN-ERROR         
365500       MOVE TR013-CVYA-IMPRT-TRIP-ID       TO                             
365600              PV-HOLD-TR211-DATA-VALUE                                    
365700       MOVE 'DATA NOT SENT'                TO                             
365800              PV-HOLD-TR211-ERROR-MSG                                     
365900       PERFORM 7000-BUILD-ERROR-FILE                                      
366000     END-IF.                                                              
366100                                                                          
366200     IF TR013-CVYA-CARR-SCAC-ID     EQUAL SPACES                          
366300        MOVE PC-WARNING            TO PV-HOLD-TR211-ERROR-TYPE            
366400        MOVE TR013-CVYA-TRN-TYP TO PV-HOLD-TR211-TRN-TYP                  
366500        MOVE 'CARRIER SCAC ID'     TO PV-HOLD-TR211-DATA-IN-ERROR         
366800        MOVE 'DATA NOT SENT'       TO PV-HOLD-TR211-ERROR-MSG             
366900        PERFORM 7000-BUILD-ERROR-FILE                                     
367000     END-IF.                                                              
367100                                                                          
367200 EJECT                                                                    
367300                                                                          
367400******************************************************************        
367500* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *        
367600* JOB SUMMARY INFORMATION.                                       *        
367700* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *        
367800* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *        
367900* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TO LONG, THE EDI   *        
368000* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*        
368100* NO RETURN CODE OR MESSAGE IS SENT.                             *        
368200******************************************************************        
368300 8000-EOJ-ROUTINE.                                                        
368400                                                                          
368500     IF EDI-IEA-RECORD OR                                                 
368600        PV-HOLD-TR211-ERROR-TYPE = PC-EMPTY                               
368700         CONTINUE                                                         
368800     ELSE                                                                 
368900       INITIALIZE TR211-COMMON-FIELDS                                     
369000       MOVE PC-E                        TO TR211-RPT-TYP                  
369100       MOVE PC-EDI                      TO TR211-ERROR-TYPE               
369200       MOVE 'NO IEA RECORD - MSG 1 - CALL PROGRAMMING'                    
369300                                        TO TR211-ERROR-MSG                
369400       ADD +1 TO PV-PROCESS-SEQ-NBR                                       
369500       MOVE PV-PROCESS-SEQ-NBR          TO TR211-PROCESS-SEQ-NBR          
369600       PERFORM 6200-WRITE-ERR-REPORT                                      
369700     END-IF.                                                              
369800                                                                          
369900     CLOSE TR013-CONTAINER-FILE                                           
370000           TR023-UPDATE-CONTAINER-FILE                                    
370100           TR211-CONTAINER-ERROR-FILE.                                    
370200                                                                          
370300     DISPLAY '*************************************************'.         
370400     DISPLAY '** TRKUT210 SUMMARY                            **'.         
370500     DISPLAY '*************************************************'.         
370600     DISPLAY 'TOTAL RECORDS READ     = ' PA-INPUT-COUNT.                  
370700     DISPLAY '*************************************************'.         
370800     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.            
370900     DISPLAY '*************************************************'.         
371000     DISPLAY 'TOTAL UPDATE ISA       = ' PA-TOTAL-UPDATE-ISA.             
371100     DISPLAY 'TOTAL UPDATE CNTR      = ' PA-TOTAL-UPDATE-CNTR.            
371200     DISPLAY 'TOTAL UPDATE CONPO     = ' PA-TOTAL-UPDATE-CONPO.           
371400     DISPLAY 'TOTAL UPDATE CONUPC    = ' PA-TOTAL-UPDATE-CONUPC.          
371500     DISPLAY '                         --------------'.                   
371600     DISPLAY 'TOTAL UPDATE RECORDS   = ' PA-TOTAL-UPDATE.                 
371700     DISPLAY '*************************************************'.         
371800                                                                          
371900 EJECT                                                                    
372000                                                                          
372100******************************************************************        
372200* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *        
372300* ERROR OR WARNING CODE OCCURS.                                  *        
372400******************************************************************        
372500 9100-USER-ABEND.                                                         
372600******************************************************************        
372700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *        
372800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *        
372900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *        
373000* FORMAT.                                                        *        
373100******************************************************************        
373200                                                                          
373300     COPY DPPD004.                                                        
373400                                                                          
373500     DISPLAY '**************************************************'.        
373600     DISPLAY 'CNTNR ID          '  TR013-CVYA-CONTNR-ID.                  
373700     DISPLAY 'ACTL DPTR DTE MOM '  TR013-CVYA-ACTL-DPRTR-DTE-MOM.         
373800     DISPLAY 'PROCESS SEQ NBR   '  PV-PROCESS-SEQ-NBR.                    
373900     DISPLAY '**************************************************'.        
374000     MOVE +4013 TO ABEND-CODE.                                            
374100     CALL 'ILBOABN0' USING ABEND-CODE.                                    
