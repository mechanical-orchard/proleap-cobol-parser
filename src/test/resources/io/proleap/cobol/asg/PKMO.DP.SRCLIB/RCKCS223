000100 IDENTIFICATION DIVISION.                                         00010005
000200 PROGRAM-ID.    RCKCS223.                                         00020005
000300 AUTHOR.        TOM RUSKA. GREENBRIER & RUSSEL.                   00030005
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040005
000500 DATE-WRITTEN.  03-31-93.                                         00050005
000600 DATE-COMPILED.                                                   00060005
000700                                                                  00070005
000800*----------------------------------------------------------------*00080005
000900*                                                                *00090005
001000*    TRANID      - E223                                          *00100005
001100*    TYPE        - CICS ARCHITECTURE INQUIRY - DB2               *00110005
001200*    DESCRIPTION - PO/RECEIVER INQUIRY PROGRAM                   *00120005
001300*    MAPSET      - RCKM223                                       *00130005
001400*                                                                *00140005
001500*    LISTS PURCHASE ORDER AND RECEIPT INFORMATION FOR A SPECIFIC *00150005
001600*    PURCHASE ORDER OR RECEIVER.                                 *00160005
001700*                                                                *00170005
001800*----------------------------------------------------------------*00180005
001900* DATE  06/28/2010                                                00190014
002000* CHANGE MADE: ADDED REPLENISHMENT INDICATOR(WHSE_RPLNT_IND)      00200005
002100* DISPLAY IN SCREEN IF WHSE_RPLNT_IND = Y, ELSE SPACE             00210005
002200* CHANGES ARE TAGGED AS CLT 06/28/2010                            00220005
002300*                                                                 00230005
002400* DATE 12/01/2011 CHRISTINE TWIEHAUS WR40574                      00240005
002500*      CHANGE MADE: ADDED CAN (CARR-AUTH-ID)                      00250005
002600*----------------------------------------------------------------*00260006
002700* DATE  10/03/2013                        PR# 5148D               00270006
002800* CHANGE MADE: 2 NEW FIELDS WERE ADDED TO THE SCREEN ON LINE 3    00280006
002900* AFTER REC LOC AREA AND DOOR. FIRST FIELD WILL DISPLAY 'RFID'    00290006
003000* AND SECOND FIELD WILL DISPLAY THE VENDOR AGREEMENT TYPE.  THE   00300006
003100* AGREEMENT TYPE WILL ONLY DISPLAY IF A RFID PO.                  00310006
003200* CHANGES ARE TAGGED AS CLP 10/03/2013                            00320006
003300*                                                                 00330006
003400*----------------------------------------------------------------*00340005
003500                                                                  00350005
003600 ENVIRONMENT DIVISION.                                            00360005
003700 DATA DIVISION.                                                   00370005
003800/                                                                 00380005
003900 WORKING-STORAGE SECTION.                                         00390005
004000                                                                  00400005
004100 01  DN-DB2-NULL-INDICATORS.                                      00410005
004200     05  DN-AD-EVNT-DTE               PIC S9(04) VALUE +0         00420005
004300                                                  COMP.           00430005
004400     05  DN-SUBAREA-OF-ID             PIC S9(04) VALUE +0         00440005
004500                                                  COMP.           00450005
004600     05  DN-TKT-FMT-ID                PIC S9(04) VALUE +0         00460005
004700                                                  COMP.           00470005
004800     05  DN-UNRESOLVED-ID             PIC S9(04) VALUE +0         00480005
004900                                                  COMP.           00490005
005000     05  DN-VEH-NBR                   PIC S9(04) VALUE +0         00500005
005100                                                  COMP.           00510005
005200     05  DN-TKT-FMT-ID-MAX            PIC S9(04) COMP VALUE +0.   00520005
005300     05  DN-TKT-FMT-ID-MIN            PIC S9(04) COMP VALUE +0.   00530005
005400     05  DN-TKT-DESC                  PIC S9(04) COMP VALUE +0.   00540005
005500                                                                  00550005
005600 01  DK-DB2-KEYS.                                                 00560005
005700     05  DK-PO-NBR                    PIC S9(09) VALUE +0         00570005
005800                                                 COMP.            00580005
005900     05  DK-REC-SEQ-NBR               PIC S9(09) VALUE +0         00590005
006000                                                 COMP.            00600005
006100     05  DK-OPER-UNT-ID               PIC S9(04) VALUE +0         00610005
006200                                                 COMP.            00620005
006300     05  DK-FCLTY-ID                  PIC S9(04) VALUE +0         00630005
006400                                                 COMP.            00640005
006500     05  DK-TRIP-ID                   PIC S9(09) VALUE +0         00650005
006600                                                 COMP.            00660005
006700     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    00670005
006800     05  DK-STORE-NMBR                PIC X(04)  VALUE SPACES.    00680005
006900     05  DK-TKT-FMT-ID                PIC X(06)  VALUE SPACES.    00690005
007000     05  DK-TKT-FMT-ID-MIN            PIC X(06)  VALUE SPACES.    00700005
007100     05  DK-TKT-FMT-ID-MAX            PIC X(06)  VALUE SPACES.    00710005
007200     05  DK-TKT-DESC                  PIC X(20)  VALUE SPACES.    00720005
007300     05  DK-TKT-DESC-MIN              PIC X(20)  VALUE SPACES.    00730005
007400     05  DK-TKT-DESC-MAX              PIC X(20)  VALUE SPACES.    00740005
007500     05  DK-SUBCLASS-NBR              PIC X(03) VALUE SPACE.      00750005
007600     05  DK-MAJCLASS-NBR              PIC X(02) VALUE SPACE.      00760005
007700     05  DK-CHARTC-SEQ-NBR            PIC S9(4) COMP VALUE +0.    00770005
007800     05  DK-TKT-TYP-SEQ-NBR           PIC S9(4) COMP VALUE +0.    00780005
007900     05  DK-MDSEAR-ID                 PIC S9(9) COMP VALUE +0.    00790005
008000     05  DK-ENT-ID                    PIC S9(09) COMP VALUE +0.   00800005
008100                                                                  00810005
008200 01  PA-PROGRAM-ACCUMULATORS.                                     00820005
008300     05  PA-INVOICED-COUNT            PIC S9(09) VALUE +0         00830005
008400                                                 COMP-3.          00840005
008500     05  PA-AP-VERIFIED-COUNT         PIC S9(09) VALUE +0         00850005
008600                                                 COMP-3.          00860005
008700     05  PA-EXPECTED-COUNT            PIC S9(09) VALUE +0         00870005
008800                                                 COMP-3.          00880005
008900                                                                  00890005
009000 01  PC-PROGRAM-CONSTANTS.                                        00900005
009100     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E223'.    00910005
009200     05  PC-E20X                      PIC X(04)  VALUE 'E20X'.    00920005
009300     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS223'.00930005
009400     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC223A  '.00940005
009500     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM223 '.00950005
009600     05  PC-RCKCS279                  PIC X(08)  VALUE 'RCKCS279'.00960005
009700     05  PC-RCKCS280                  PIC X(08)  VALUE 'RCKCS280'.00970005
009800     05  PC-RCKPV818                  PIC X(08)  VALUE 'RCKPV818'.00980005
009900     05  PC-RCKPV819                  PIC X(08)  VALUE 'RCKPV819'.00990005
010000     05  PC-RCKPV820                  PIC X(08)  VALUE 'RCKPV820'.01000005
010100     05  PC-SUKPV702                  PIC X(08)  VALUE 'SUKPV702'.01010005
010200     05  PC-CURRENT-DATE          PIC X(10) VALUE SPACE.          01020005
010400     05  PC-RFID                      PIC X(04)  VALUE 'RFID'.    01040010
010500     05  PC-C                         PIC X(01)  VALUE 'C'.       01050010
010700     05  PC-I                         PIC X(01)  VALUE 'I'.       01070005
010800     05  PC-N                         PIC X(01)  VALUE 'N'.       01080005
010900     05  PC-Y                         PIC X(01)  VALUE 'Y'.       01090005
011000     05  PC-T                         PIC X(01)  VALUE 'T'.       01100005
011100     05  PC-A                         PIC X(01)  VALUE 'A'.       01110005
011200     05  PC-R                         PIC X(01)  VALUE 'R'.       01120005
011300     05  PC-AC                        PIC X(02)  VALUE 'AC'.      01130005
011400     05  PC-VERIFIED                  PIC  X(20)  VALUE           01140005
011500                                             'VERIFIED'.          01150005
011600     05  PC-VERIF-ADJ                 PIC  X(20)  VALUE           01160005
011700                                             'VERIFIED (ADJ)'.    01170005
011800     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        01180005
011900                                                 COMP.            01190005
012000     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        01200005
012100                                                 COMP.            01210005
012200     05  PC-INTER-APPL-CODES.                                     01220005
012300         10  PC-INTER-APPL-CRIT-DETAIL PIC X(01) VALUE '1'.       01230005
012400         10  PC-INTER-APPL-LIST        PIC X(01) VALUE '2'.       01240005
012500         10  PC-INTER-APPL-ADD-TO-RCVR PIC X(01) VALUE '3'.       01250005
012600         10  PC-INTER-APPL-RCVG-PO-LIST PIC X(01) VALUE '4'.      01260005
012700                                                                  01270005
012800*---------------------------------------------------------------* 01280005
012900* SYSTEM MESSAGES                                               * 01290005
013000*---------------------------------------------------------------* 01300005
013100* 00005 - THE DATA ENTERED IS NOT A VALID VALUE FOR THE FIELD   * 01310005
013200* 00057 - AN ITEM ACTION WAS REQUESTED WITHOUT SELECTING AN ITEM* 01320005
013300* 00069 - THE PAGE DISPLAYED IS THE FIRST PAGE OF THE LIST      * 01330005
013400* 00070 - THE PAGE DISPLAYED IS THE LAST PAGE OF THE LIST       * 01340005
013500* 00083 - THE PURCHASE ORDER NUMBER, THAT WAS REQUESTED FOR     * 01350005
013600* 00148 - THE DATA THAT YOU ENTERED HAS NOT BEEN DEFINED        * 01360005
013700* 00330 - ENTER DATA IN THE APPROPRIATE FIELD FOR THE FUNCTION  * 01370005
013800* 00737 - RECEIVER SEQUENCE NUMBER REQUIRED                     * 01380005
013900* 00789 - INVALID CURRENT LOCATION OPERATING UNIT/FACILITY ID   * 01390005
014000* 01090 -                                                       * 01400005
014100*---------------------------------------------------------------* 01410005
014200     05  PC-TSYMSG-NUMBERS.                                       01420005
014300         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     01430005
014400         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01440005
014500         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01450005
014600         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01460005
014700         10  PC-TSYMSG-00083          PIC 9(05)  VALUE 00083.     01470005
014800         10  PC-TSYMSG-00148          PIC 9(05)  VALUE 00148.     01480005
014900         10  PC-TSYMSG-00330          PIC 9(05)  VALUE 00330.     01490005
015000         10  PC-TSYMSG-00737          PIC 9(05)  VALUE 00737.     01500005
015100         10  PC-TSYMSG-00789          PIC 9(05)  VALUE 00789.     01510005
015200         10  PC-TSYMSG-01090          PIC 9(05)  VALUE 01090.     01520005
015300     05  PC-VS-TICKET-TYPE-CDE       PIC S9(04) COMP              01530005
015400                                                VALUE +2.         01540005
015500     05  PC-SUBCLASS-MDSELV-CDE   PIC X(03) VALUE 'SCL'.          01550005
015600     05  PC-MAJCLASS-MDSELV-CDE   PIC X(03) VALUE 'MCL'.          01560005
015700     05  PC-DPT-MDSELV-CDE        PIC X(03) VALUE 'DPT'.          01570005
015800                                                                  01580005
015900 01  PS-PROGRAM-SWITCHES.                                         01590005
016000     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01600005
016100         88  PS-ERROR                            VALUE 'Y'.       01610005
016200         88  PS-NO-ERROR                         VALUE 'N'.       01620005
016300     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       01630005
016400         88  PS-LIST-END                         VALUE 'Y'.       01640005
016500         88  PS-NO-LIST-END                      VALUE 'N'.       01650005
016600     05  PS-VSM-SW                PIC X       VALUE 'N'.          01660005
016700         88  PS-NOT-VSM                       VALUE 'N'.          01670005
016800         88  PS-VSM                           VALUE 'Y'.          01680005
016900     05  PS-CITM-FOUND-SW         PIC  X(01)  VALUE 'N'.          01690005
017000         88  PS-CITM-FOUND                    VALUE 'Y'.          01700005
017100         88  PS-NO-CITM-FOUND                 VALUE 'N'.          01710005
017200     05  PS-PRETIC-FOUND-SW       PIC  X(01)  VALUE 'N'.          01720005
017300         88  PS-PRETIC-FOUND                  VALUE 'Y'.          01730005
017400         88  PS-NO-PRETIC-FOUND               VALUE 'N'.          01740005
017500     05  PS-ITM-NBR-FOUND-SW      PIC  X(01)  VALUE 'N'.          01750005
017600         88  PS-ITM-NBR-FOUND                 VALUE 'Y'.          01760005
017700         88  PS-NO-ITM-NBR-FOUND              VALUE 'N'.          01770005
017800                                                                  01780005
017900 01  PV-PROGRAM-VARIABLES.                                        01790005
018000     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.01800005
018100     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      01810005
018200                                                 COMP.            01820005
018300     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         01830005
018400                                                 COMP SYNC.       01840005
018500     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         01850005
018600                                                 COMP SYNC.       01860005
018700     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01870005
018800                                                 COMP-3.          01880005
018900     05  PV-CURRENT-DATE              PIC X(06)  VALUE SPACE.     01890005
019000     05  PV-DB2-DATE                  PIC  X(10).                 01900005
019100     05  FILLER  REDEFINES PV-DB2-DATE.                           01910005
019200         10  FILLER                   PIC  X(02).                 01920005
019300         10  PV-DB2-DATE-YY           PIC  X(02).                 01930005
019400         10  FILLER                   PIC  X(01).                 01940005
019500         10  PV-DB2-DATE-MM           PIC  X(02).                 01950005
019600         10  FILLER                   PIC  X(01).                 01960005
019700         10  PV-DB2-DATE-DD           PIC  X(02).                 01970005
019800     05  PV-DISPLAY-DATE.                                         01980005
019900         10  PV-DISPLAY-DATE-MM       PIC  X(02).                 01990005
020000         10  FILLER                   PIC  X(01) VALUE '/'.       02000005
020100         10  PV-DISPLAY-DATE-DD       PIC  X(02).                 02010005
020200         10  FILLER                   PIC  X(01) VALUE '/'.       02020005
020300         10  PV-DISPLAY-DATE-YY       PIC  X(02).                 02030005
020400     05  PV-DB2-TIMESTAMP             PIC  X(26).                 02040005
020500     05  FILLER  REDEFINES PV-DB2-TIMESTAMP.                      02050005
020600         10  FILLER                   PIC  X(02).                 02060005
020700         10  PV-DB2-TMST-YY           PIC  X(02).                 02070005
020800         10  FILLER                   PIC  X(01).                 02080005
020900         10  PV-DB2-TMST-MM           PIC  X(02).                 02090005
021000         10  FILLER                   PIC  X(01).                 02100005
021100         10  PV-DB2-TMST-DD           PIC  X(02).                 02110005
021200         10  FILLER                   PIC  X(01).                 02120005
021300         10  PV-DB2-TMST-HH           PIC  X(02).                 02130005
021400         10  FILLER                   PIC  X(01).                 02140005
021500         10  PV-DB2-TMST-MIN          PIC  X(02).                 02150005
021600         10  FILLER                   PIC  X(01).                 02160005
021700         10  FILLER                   PIC  X(02).                 02170005
021800         10  FILLER                   PIC  X(01).                 02180005
021900         10  FILLER                   PIC  X(06).                 02190005
022000     05  PV-OPER-UNT-ID               PIC 9(04).                  02200005
022100     05  PV-OPER-UNT-ID-X REDEFINES                               02210005
022200         PV-OPER-UNT-ID               PIC X(04).                  02220005
022300     05  PV-NULL-IND                  PIC S9(04)  VALUE +0        02230005
022400                                                  COMP SYNC.      02240005
022500     05  ST-ABSTIME                   PIC S9(16) VALUE +0         02250005
022600                                                 COMP SYNC.       02260005
022700     05  PV-SUBCLASS-NBR.                                         02270005
022800         10  FILLER                   PIC X(01) VALUE '0'.        02280005
022900         10  PV-SUBCLASS              PIC X(02).                  02290005
023000                                                                  02300031
023100     05  PV-RECEIVER-NBR.                                         02310013
023200         10  PV-RN-PO                 PIC X(08).                  02320014
023300         10  FILLER                   PIC X(01)  VALUE '-'.       02330014
023400         10  PV-RN-SEQ                PIC X(04).                  02340014
023401                                                                  02340131
023410     05  PV-BULK-MULT-SKU             PIC S9(09)  VALUE +0        02341024
023420                                                  COMP-3.         02342024
023500/                                                                 02350005
023600*----------------------------------------------------------------*02360005
023700*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *02370005
023800*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *02380005
023900*----------------------------------------------------------------*02390005
024000                                                                  02400005
024100     COPY RCWS013.                                                02410005
024200/                                                                 02420005
024300                                                                  02430005
024400*----------------------------------------------------------------*02440005
024500*    MAP LAYOUT                                                  *02450005
024600*----------------------------------------------------------------*02460005
024700                                                                  02470005
024800     COPY RCKM223.                                                02480005
024900                                                                  02490005
025000/                                                                 02500005
025100*----------------------------------------------------------------*02510005
025200*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *02520005
025300*----------------------------------------------------------------*02530005
025400                                                                  02540005
025500     COPY DPWS003.                                                02550005
025600                                                                  02560005
025700/                                                                 02570005
025800*----------------------------------------------------------------*02580005
025900*    COPYBOOK FOR LOCATION CALL MODULE                            02590005
026000*-----------------------------------------------------------------02600005
026100     COPY XLWS071.                                                02610005
026200                                                                  02620005
026300/                                                                 02630005
026400*----------------------------------------------------------------*02640005
026500*    COPYBOOK FOR ITEM DATA CALL MODULE                           02650005
026600*-----------------------------------------------------------------02660005
026700     COPY XLWS001.                                                02670005
026800                                                                  02680005
026900/                                                                 02690005
027000*----------------------------------------------------------------*02700005
027100*    ATTRIBUTE SETTINGS COPYBOOK.                                *02710005
027200*----------------------------------------------------------------*02720005
027300                                                                  02730005
027400     COPY DPWS015.                                                02740005
027500                                                                  02750005
027600/                                                                 02760005
027700*----------------------------------------------------------------*02770005
027800*    FUNCTION KEYS COPYBOOK                                      *02780005
027900*----------------------------------------------------------------*02790005
028000                                                                  02800005
028100     COPY DPWS016.                                                02810005
028200                                                                  02820005
028300/                                                                 02830005
028400*----------------------------------------------------------------*02840005
028500*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *02850005
028600*    SUB-ROUTINE (RCKUT100).                                     *02860005
028700*----------------------------------------------------------------*02870005
028800     COPY DPWS010I.                                               02880005
028900                                                                  02890005
029000/                                                                 02900005
029100******************************************************************02910032
029200** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **02920032
029300** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02930032
029400******************************************************************02940032
029500     COPY DPWS030.                                                02950005
029510     COPY DPWS930.                                                02951032
029600                                                                  02960005
029700/                                                                 02970005
029800*----------------------------------------------------------------*02980005
029900*    STANDARD COMMAREA.                                          *02990005
030000*----------------------------------------------------------------*03000005
030100                                                                  03010005
030200     COPY DPWS020.                                                03020005
030300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03030005
030400                                                                  03040005
030500*----------------------------------------------------------------*03050005
030600*    INTER-APPLICATION COMMAREA.                                 *03060005
030700*----------------------------------------------------------------*03070005
030800                                                                  03080005
030900         10  INTER-APPL-COMM-AREA PIC X(200).                     03090005
031000     COPY RCWS012.                                                03100005
031100     COPY RCWS015.                                                03110005
031200     COPY POWS017.                                                03120005
031300     COPY SUWS008.                                                03130005
031400*----------------------------------------------------------------*03140005
031500*    SPECIFIC COMMMAREA FOR RCKCS223.                            *03150005
031600*----------------------------------------------------------------*03160005
031700         10  ASC-SPECIFIC-COMMAREA.                               03170005
031800             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03180005
031900             15  ASC-USE-SELECTION-QUEUE-IND                      03190005
032000                                           PIC X(01).             03200005
032100                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        03210005
032200             15  ASC-SEL-QUEUE-NAME        PIC X(08).             03220005
032300             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     03230005
032400             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03240005
032500                                           PIC S9(09) COMP-3.     03250005
032600             15  ASC-SEL-SUB               PIC S9(04) COMP.       03260005
032700             15  ASC-SEL-ITEM              PIC S9(04) COMP.       03270005
032800             15  ASC-MULT-SHIP-SW          PIC X(01).             03280005
032900                 88  ASC-MULT-SHIP               VALUE 'Y'.       03290005
033000                                                                  03300005
033100             15  ASC-KEY-FIELDS.                                  03310005
033200                 20  ASC-KEY-PO-NBR        PIC S9(09) COMP.       03320005
033300                 20  ASC-KEY-REC-SEQ-NBR   PIC S9(09) COMP.       03330005
033500                 20  ASC-PO-NBR            PIC X(08).             03350012
033600                 20  ASC-PO-NBR-N REDEFINES ASC-PO-NBR            03360005
033700                                           PIC 9(08).             03370012
033800                 20  ASC-REC-SEQ-NBR       PIC X(04).             03380005
033900                 20  ASC-REC-SEQ-NBR-N REDEFINES                  03390005
034000                     ASC-REC-SEQ-NBR       PIC 9(04).             03400005
034100                 20  ASC-OPER-UNT-ID       PIC S9(04) COMP.       03410005
034200                 20  ASC-FCLTY-ID          PIC S9(04) COMP.       03420005
034300             15  ASC-SCREEN-FIELDS.                               03430005
034400                 20  ASC-PO-STATUS         PIC X(10).             03440005
034500                 20  ASC-RCVR-STATUS       PIC X(20).             03450005
034600                 20  ASC-ADJUSTED-SW       PIC X(01).             03460005
034700                     88 ASC-ADJUSTED-PO     VALUE 'Y'.            03470005
034800                     88 ASC-NOT-ADJUSTED    VALUE ' '.            03480005
034900                 20  ASC-VENDOR-NAME       PIC X(25).             03490005
035200                 20  ASC-BUYER-NAME        PIC X(25).             03520005
035300                 20  ASC-RCVR-CREATOR      PIC X(08).             03530005
035400                 20  ASC-REC-CLERK         PIC X(03).             03540005
035500                 20  ASC-DEPT              PIC X(03).             03550005
035600                 20  ASC-TROUB-STATUS-1    PIC X(11).             03560005
035700                 20  ASC-DO-NOT-SHIP-DATE  PIC X(08).             03570005
035800                 20  ASC-CARRIER           PIC X(04).             03580005
035900                 20  ASC-TRIP              PIC 9(09).             03590005
036000                 20  ASC-CANCEL-DATE       PIC X(08).             03600005
036100                 20  ASC-TRAILER-NBR       PIC X(10).             03610005
036200                 20  ASC-AD-DATE           PIC X(08).             03620005
036400                 20  ASC-CARR-AUTH-ID      PIC X(30).             03640005
036600                 20  ASC-PRO-NUMBER        PIC X(22).             03660005
036700                 20  ASC-BOL-NUMBER        PIC X(16).             03670005
036800                 20  ASC-AD-INFO           PIC X(04).             03680005
036900                 20  ASC-VDR-SHIP-DATE     PIC X(08).             03690005
037000                 20  ASC-SPEC-INSTRC       PIC X(25).             03700005
037100                 20  ASC-CARR-SHIP-DTE     PIC X(08).             03710005
037200                 20  ASC-TKT-FMT-ID        PIC X(06).             03720005
037300                 20  ASC-TKT-DESC          PIC X(20).             03730005
037400                 20  ASC-RCVR-NBR          PIC 9(08).             03740005
037500                 20  ASC-ARRIVAL-DATE      PIC X(08).             03750005
037600                 20  ASC-OPER-SET-ID       PIC X(03).             03760005
037700                 20  ASC-OPER-SET-ID-N REDEFINES                  03770005
037800                     ASC-OPER-SET-ID       PIC 9(03).             03780005
037900                 20  ASC-OPER-SET-DESC     PIC X(22).             03790005
038000                 20  ASC-PROC-INFO-ASN     PIC X(14).             03800005
038100                 20  ASC-PROC-INFO-PRE     PIC X(14).             03810005
038200                 20  ASC-PROC-INFO-GOH     PIC X(14).             03820005
038300                 20  ASC-PROC-INFO-PACK    PIC X(14).             03830005
038400                 20  ASC-PROC-INFO-PKG-TYP PIC X(14).             03840005
038500                 20  ASC-RCV-CRE-DATE      PIC X(05).             03850005
038600                 20  ASC-RCV-CRE-TIME      PIC X(05).             03860005
038700                 20  ASC-EXPTED-CART-CNT   PIC X(05).             03870005
038800                 20  ASC-EXPTED-CART-CNT-N REDEFINES              03880005
038900                     ASC-EXPTED-CART-CNT   PIC 9(05).             03890005
039000                 20  ASC-PROC-INFO-EDI     PIC X(14).             03900005
039100                 20  ASC-TRANSCRIBE-DATE   PIC X(05).             03910005
039200                 20  ASC-TRANSCRIBE-TIME   PIC X(05).             03920005
039300                 20  ASC-IN-TROUB-DATE     PIC X(05).             03930005
039400                 20  ASC-IN-TROUB-TIME     PIC X(05).             03940005
039500                 20  ASC-ACTL-CART-CNT     PIC X(05).             03950005
039600                 20  ASC-ACTL-CART-CNT-N REDEFINES                03960005
039700                     ASC-ACTL-CART-CNT     PIC 9(05).             03970005
039800                 20  ASC-PROC-INFO-DET     PIC X(14).             03980005
039900                 20  ASC-MK-APRN-DATE      PIC X(05).             03990005
040000                 20  ASC-MK-APRN-TIME      PIC X(05).             04000005
040100                 20  ASC-OUT-TROUB-DATE    PIC X(05).             04010005
040200                 20  ASC-OUT-TROUB-TIME    PIC X(05).             04020005
040300                 20  ASC-DMG-CART-CNT      PIC X(05).             04030005
040400                 20  ASC-DMG-CART-CNT-N REDEFINES                 04040005
040500                     ASC-DMG-CART-CNT      PIC 9(05).             04050005
040600                 20  ASC-MK-HDR-DATE       PIC X(05).             04060005
040700                 20  ASC-MK-HDR-TIME       PIC X(05).             04070005
040800                 20  ASC-LAST-CHNG-DATE    PIC X(05).             04080005
040900                 20  ASC-LAST-CHNG-TIME    PIC X(05).             04090005
041000                 20  ASC-PCS-INVCD         PIC X(07).             04100005
041100                 20  ASC-PCS-INVCD-N REDEFINES ASC-PCS-INVCD      04110005
041200                                           PIC 9(07).             04120005
041300                 20  ASC-CHANGD-BY         PIC X(08).             04130005
041400                 20  ASC-VRFD-USR-UID      PIC X(08).             04140005
041500                                                                  04150031
041600                 20  ASC-PCS-VERFD         PIC X(07).             04160005
041700                 20  ASC-PCS-VERFD-N    REDEFINES                 04170005
041800                     ASC-PCS-VERFD         PIC ZZZZZZ9.           04180005
041900                                                                  04190005
042000                 20  ASC-PCS-VER-DATE      PIC X(05).             04200005
042100                 20  ASC-PCS-VER-TIME      PIC X(05).             04210005
042200                 20  ASC-ATL-OPER-UNT-ID   PIC  9(04).            04220005
042300                 20  ASC-ATL-FCLTY-ID      PIC  9(04).            04230005
042400                 20  ASC-CUR-OPER-UNT-ID   PIC  9(04).            04240005
042500                 20  ASC-CUR-FCLTY-ID      PIC  9(04).            04250005
042600                 20  ASC-ORIG-OPER-UNT-ID  PIC  9(04).            04260005
042700                 20  ASC-ORIG-FCLTY-ID     PIC  9(04).            04270005
042800                 20  ASC-APRON-LOC-DESC    PIC  X(08).            04280005
042900                 20  ASC-MULT-INSTR-SW     PIC  X(01).            04290005
043000                     88  ASC-MULT-INSTR-YES VALUE 'Y'.            04300005
043100                     88  ASC-MULT-INSTR-NO  VALUE 'N'.            04310005
043200                 20  ASC-FRE-ASTRA-IND     PIC X(03).             04320005
043400                 20  ASC-REPLENISH-IND     PIC X(01).             04340005
043600                 20  ASC-REC-TYP           PIC  X(02).            04360005
043700                 20  ASC-PCS-EXPECTED      PIC 9(07).             04370005
043900                 20  ASC-RFID-DISPLAYED    PIC X(04).             04390006
044000                 20  ASC-VNDR-DISPLAYED    PIC X(01).             04400006
044110                 20  ASC-PKSLIP-BOL-NBR    PIC X(16).             04411015
044120                 20  ASC-EFC-SHIPMT        PIC X(10).             04412018
044130                 20  ASC-BULK-MIX-SKU-SW   PIC X(01).             04413024
044131                     88  ASC-BULK-MIX-SKU-YES  VALUE 'Y'.         04413124
044132                     88  ASC-BULK-MIX-SKU-NO   VALUE 'N'.         04413224
044140             15  FILLER                PIC X(69).                 04414028
044200                                                                  04420005
044300/                                                                 04430005
044400*----------------------------------------------------------------*04440005
044500*    ABEND PROCESSING COPYBOOK.                                  *04450005
044600*----------------------------------------------------------------*04460005
044700                                                                  04470005
044800     COPY DPWS013.                                                04480005
044900                                                                  04490005
045000/                                                                 04500005
045200******************************************************************04520006
045300* RFID CALLED MODULE COPYBOOK                                     04530006
045400******************************************************************04540006
045500     COPY SUWS093.                                                04550006
045700*                                                                 04570006
045800*----------------------------------------------------------------*04580005
045900*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION AUDIT TABLE          04590005
046000*----------------------------------------------------------------*04600005
046100     EXEC SQL                                                     04610005
046200          INCLUDE TAURECD                                         04620005
046300     END-EXEC.                                                    04630005
046400                                                                  04640005
046500/                                                                 04650005
046600*---------------------------------------------------------------* 04660005
046700*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 04670005
046800*---------------------------------------------------------------* 04680005
046900     EXEC SQL                                                     04690005
047000          INCLUDE TPURCHS                                         04700005
047100     END-EXEC.                                                    04710005
047200                                                                  04720005
047300/                                                                 04730005
047400*---------------------------------------------------------------* 04740005
047500*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 04750005
047600*---------------------------------------------------------------* 04760005
047700     EXEC SQL                                                     04770005
047800          INCLUDE TPURITM                                         04780005
047900     END-EXEC.                                                    04790005
048000                                                                  04800005
048100/                                                                 04810005
048200*---------------------------------------------------------------* 04820005
048300*    DB2 AREA FOR THE PO STATUS CODE TABLE                      * 04830005
048400*---------------------------------------------------------------* 04840005
048500     EXEC SQL                                                     04850005
048600          INCLUDE TSTATCD                                         04860005
048700     END-EXEC.                                                    04870005
048800                                                                  04880005
048900/                                                                 04890005
049000*---------------------------------------------------------------* 04900005
049100*    DB2 AREA FOR THE PO INSTRUCTIONS TABLE                     * 04910005
049200*---------------------------------------------------------------* 04920005
049300     EXEC SQL                                                     04930005
049400          INCLUDE TPOINST                                         04940005
049500     END-EXEC.                                                    04950005
049600                                                                  04960005
049700/                                                                 04970005
049800*---------------------------------------------------------------* 04980005
049900*    DB2 AREA FOR THE PO INSTRUCTION CODE TABLE                 * 04990005
050000*---------------------------------------------------------------* 05000005
050100     EXEC SQL                                                     05010005
050200          INCLUDE TINSTCD                                         05020005
050300     END-EXEC.                                                    05030005
050400                                                                  05040005
050500/                                                                 05050005
050600*---------------------------------------------------------------* 05060005
050700*    DB2 AREA FOR THE PLANNED SHIPMENTS TABLE                   * 05070005
050800*---------------------------------------------------------------* 05080005
050900     EXEC SQL                                                     05090005
051000          INCLUDE TPLNSHP                                         05100005
051100     END-EXEC.                                                    05110005
051200                                                                  05120005
051300/                                                                 05130005
051400*---------------------------------------------------------------* 05140005
051500*    DB2 AREA FOR THE ENTERPRISE TABLE                          * 05150005
051600*---------------------------------------------------------------* 05160005
051700     EXEC SQL                                                     05170005
051800          INCLUDE TEXTENT                                         05180005
051900     END-EXEC.                                                    05190005
052000                                                                  05200005
052100/                                                                 05210005
052200*---------------------------------------------------------------* 05220005
052300*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 05230005
052400*---------------------------------------------------------------* 05240005
052500     EXEC SQL                                                     05250005
052600          INCLUDE TENTNME                                         05260005
052700     END-EXEC.                                                    05270005
052800                                                                  05280005
052900/                                                                 05290005
053000*---------------------------------------------------------------* 05300005
053100*    DB2 AREA FOR RECEIVER TABLE                                * 05310005
053200*---------------------------------------------------------------* 05320005
053300     EXEC SQL                                                     05330005
053400          INCLUDE TRECEIV                                         05340005
053500     END-EXEC.                                                    05350005
053600                                                                  05360005
053700/                                                                 05370005
053800*---------------------------------------------------------------* 05380005
053900*    DB2 AREA FOR RECEIVER ITEM TABLE                           * 05390005
054000*---------------------------------------------------------------* 05400005
054100     EXEC SQL                                                     05410005
054200          INCLUDE TRECITM                                         05420005
054300     END-EXEC.                                                    05430005
054400                                                                  05440005
054500/                                                                 05450005
054600*---------------------------------------------------------------* 05460005
054700*    DB2 AREA FOR RECEIVER DISTRIBUTION TABLE                   * 05470005
054800*---------------------------------------------------------------* 05480005
054900     EXEC SQL                                                     05490005
055000          INCLUDE TRECDIS                                         05500005
055100     END-EXEC.                                                    05510005
055200                                                                  05520005
055300/                                                                 05530005
055400*---------------------------------------------------------------* 05540005
055500*    DB2 AREA FOR SHIPMENT TABLE                                * 05550005
055600*---------------------------------------------------------------* 05560005
055700     EXEC SQL                                                     05570005
055800          INCLUDE TSHIPMT                                         05580005
055900     END-EXEC.                                                    05590005
056000                                                                  05600005
056100/                                                                 05610005
056200*---------------------------------------------------------------* 05620005
056300*    DB2 AREA FOR SHIPMENT PO TABLE                             * 05630005
056400*---------------------------------------------------------------* 05640005
056500     EXEC SQL                                                     05650005
056600          INCLUDE TSHPTPO                                         05660005
056700     END-EXEC.                                                    05670005
056800                                                                  05680005
056900/                                                                 05690005
057000*---------------------------------------------------------------* 05700005
057100*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 05710005
057200*---------------------------------------------------------------* 05720005
057300     EXEC SQL                                                     05730005
057400          INCLUDE TVHTRIP                                         05740005
057500     END-EXEC.                                                    05750005
057600                                                                  05760005
057700/                                                                 05770005
057800*---------------------------------------------------------------* 05780005
057900*    DB2 AREA FOR TRIP STATUS TABLE                             * 05790005
058000*---------------------------------------------------------------* 05800005
058100     EXEC SQL                                                     05810005
058200          INCLUDE TTRIPST                                         05820005
058300     END-EXEC.                                                    05830005
058400                                                                  05840005
058500/                                                                 05850005
058600*---------------------------------------------------------------* 05860005
058700*    DB2 AREA FOR TRIP STATUS CODE TABLE                        * 05870005
058800*---------------------------------------------------------------* 05880005
058900     EXEC SQL                                                     05890005
059000          INCLUDE TTRSTYP                                         05900005
059100     END-EXEC.                                                    05910005
059200                                                                  05920005
059300/                                                                 05930005
059400*---------------------------------------------------------------* 05940005
059500*    DB2 AREA FOR VEHICLE TABLE                                 * 05950005
059600*---------------------------------------------------------------* 05960005
059700     EXEC SQL                                                     05970005
059800          INCLUDE TVEHICL                                         05980005
059900     END-EXEC.                                                    05990005
060000                                                                  06000005
060100/                                                                 06010005
061000*---------------------------------------------------------------* 06100005
061100*    DB2 AREA FOR DEPT/CLASS FACILITY LOC. ASSIGNMENTS          * 06110005
061200*---------------------------------------------------------------* 06120005
061300     EXEC SQL                                                     06130005
061400          INCLUDE TDCFAAS                                         06140005
061500     END-EXEC.                                                    06150005
061600                                                                  06160005
061700/                                                                 06170005
063400*---------------------------------------------------------------* 06340005
063500*    DB2 AREA FOR THE PACKING SLIP TABLE                        * 06350005
063600*---------------------------------------------------------------* 06360005
063700     EXEC SQL                                                     06370005
063800          INCLUDE TPKSLIP                                         06380005
063900     END-EXEC.                                                    06390005
064000                                                                  06400005
064100     EXEC SQL                                                     06410005
064200          INCLUDE TPKITEM                                         06420005
064300     END-EXEC.                                                    06430005
064400                                                                  06440005
064500/                                                                 06450005
064600*----------------------------------------------------------------*06460005
064700*    DB2 AREA FOR OPERATION SET TABLE                            *06470005
064800*----------------------------------------------------------------*06480005
064900                                                                  06490005
065000     EXEC SQL                                                     06500005
065100          INCLUDE TOPRSET                                         06510005
065200     END-EXEC.                                                    06520005
065300                                                                  06530005
065400/                                                                 06540005
065500*----------------------------------------------------------------*06550005
065600*    DB2 AREA FOR WORK ORDER TABLE                               *06560005
065700*----------------------------------------------------------------*06570005
065800                                                                  06580005
065900     EXEC SQL                                                     06590005
066000          INCLUDE TWRKORD                                         06600005
066100     END-EXEC.                                                    06610005
066200                                                                  06620005
066300/                                                                 06630005
066400*----------------------------------------------------------------*06640005
066500*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06650005
066600*----------------------------------------------------------------*06660005
066700     EXEC SQL                                                     06670005
066800          INCLUDE TTRBNTF                                         06680005
066900     END-EXEC.                                                    06690005
067000                                                                  06700005
067100/                                                                 06710005
067200*----------------------------------------------------------------*06720005
067300*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      06730005
067400*----------------------------------------------------------------*06740005
067500     EXEC SQL                                                     06750005
067600          INCLUDE TTRBRSN                                         06760005
067700     END-EXEC.                                                    06770005
067800                                                                  06780005
067900*----------------------------------------------------------------*06790005
068000*    DB2 DCLGEN FOR THE TPTKREQ TABLE                             06800005
068100*----------------------------------------------------------------*06810005
068200     EXEC SQL                                                     06820005
068300          INCLUDE TPTKREQ                                         06830005
068400     END-EXEC.                                                    06840005
068500/                                                                 06850005
068600*----------------------------------------------------------------*06860005
068700*    DB2 DCLGEN FOR THE TPTKREQ TABLE                             06870005
068800*----------------------------------------------------------------*06880005
068900     EXEC SQL                                                     06890005
069000          INCLUDE TPTKLNE                                         06900005
069100     END-EXEC.                                                    06910005
069200/                                                                 06920005
069300*----------------------------------------------------------------*06930005
069400*    DB2 DCLGEN FOR THE TTKTFMT TABLE                             06940005
069500*----------------------------------------------------------------*06950005
069600     EXEC SQL                                                     06960005
069700          INCLUDE TTKTFMT                                         06970005
069800     END-EXEC.                                                    06980005
069900/                                                                 06990005
070000*----------------------------------------------------------------*07000005
070100*    DB2 DCLGEN FOR THE TMDSEAR TABLE                             07010005
070200*----------------------------------------------------------------*07020005
070300     EXEC SQL                                                     07030005
070400          INCLUDE TMDSEAR                                         07040005
070500     END-EXEC.                                                    07050005
070600/                                                                 07060005
070700/                                                                 07070005
070800*----------------------------------------------------------------*07080005
070900*    DB2 DCLGEN FOR THE TDCVSVL TABLE                             07090005
071000*----------------------------------------------------------------*07100005
071100     EXEC SQL                                                     07110005
071200          INCLUDE TDCVSVL                                         07120005
071300     END-EXEC.                                                    07130005
071400/                                                                 07140005
071500*----------------------------------------------------------------*07150005
071600*    DB2 DCLGEN FOR THE TVSCHVL TABLE                             07160005
071700*----------------------------------------------------------------*07170005
071800     EXEC SQL                                                     07180005
071900          INCLUDE TVSCHVL                                         07190005
072000     END-EXEC.                                                    07200005
072100/                                                                 07210005
072200*----------------------------------------------------------------*07220005
072300*    DB2 DCLGEN FOR THE TVNDSTL TABLE                             07230005
072400*----------------------------------------------------------------*07240005
072500     EXEC SQL                                                     07250005
072600          INCLUDE TVNDSTL                                         07260005
072700     END-EXEC.                                                    07270005
072800/                                                                 07280005
072900*----------------------------------------------------------------*07290005
073000*    DB2 DCLGEN FOR THE TMDARVS TABLE                             07300005
073100*----------------------------------------------------------------*07310005
073200     EXEC SQL                                                     07320005
073300          INCLUDE TMDARVS                                         07330005
073400     END-EXEC.                                                    07340005
073500                                                                  07350018
073510*----------------------------------------------------------------*07351018
073520*    WST_SHPMT_XREF_NDR                                           07352018
073530*----------------------------------------------------------------*07353018
073540     EXEC SQL                                                     07354018
073550          INCLUDE WST00001                                        07355018
073560     END-EXEC.                                                    07356018
073570/                                                                 07357018
073580*----------------------------------------------------------------*07358024
073590*    TINPKSU                                                      07359024
073591*----------------------------------------------------------------*07359124
073592     EXEC SQL                                                     07359224
073593          INCLUDE TINPKSU                                         07359324
073594     END-EXEC.                                                    07359424
073595                                                                  07359524
073596*----------------------------------------------------------------*07359624
073597*    TSHUUPC                                                      07359724
073598*----------------------------------------------------------------*07359824
073599     EXEC SQL                                                     07359924
073600          INCLUDE TSHUUPC                                         07360024
073601     END-EXEC.                                                    07360124
073602                                                                  07360224
073610*---------------------------------------------------------------* 07361005
073700*    DB2 AREA FOR COMMUNICATIONS                                * 07370005
073800*---------------------------------------------------------------* 07380005
073900     EXEC SQL                                                     07390005
074000          INCLUDE SQLCA                                           07400005
074100     END-EXEC.                                                    07410005
074200                                                                  07420005
074300/                                                                 07430005
074400 LINKAGE SECTION.                                                 07440005
074500                                                                  07450005
074600 01  DFHCOMMAREA.                                                 07460005
074700     05  FILLER                       OCCURS  1 TO 4072 TIMES     07470005
074800                                      DEPENDING ON EIBCALEN.      07480005
074900         10  FILLER                   PIC X.                      07490005
075000                                                                  07500005
075100/                                                                 07510005
075200 PROCEDURE DIVISION.                                              07520005
075300                                                                  07530005
075400*----------------------------------------------------------------*07540005
075500*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *07550005
075600*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *07560005
075700*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *07570005
075800*                                                                *07580005
075900*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *07590005
076000*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *07600005
076100*----------------------------------------------------------------*07610005
076200 0000-MAIN-MODULE.                                                07620005
076300     INITIALIZE DP030-CICS-API-FIELDS.                            07630005
076400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07640005
076500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07650005
076600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07660005
076700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07670005
076800     MOVE LENGTH OF RC223AI        TO DP030-MAP-LENGTH (1).       07680005
076900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07690005
077000     PERFORM 0001-CALL-CICS-ARCH-API.                             07700005
077100                                                                  07710005
077200     PERFORM 1000-CONTROL-PROCESSING.                             07720005
077300                                                                  07730005
077400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07740005
077500     PERFORM 0001-CALL-CICS-ARCH-API.                             07750005
077600                                                                  07760005
077700/                                                                 07770005
077800 0001-CALL-CICS-ARCH-API.                                         07780005
077900                                                                  07790005
078010     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07801032
078100                                    DFHCOMMAREA                   07810032
078200                                    DP030-CICS-API-FIELDS         07820032
078300                                    DP020-STANDARD-COMMAREA       07830032
078400                                    RC223AI.                      07840032
078500                                                                  07850005
078600     IF  DP030-RC-CALL-SUCCESSFUL                                 07860005
078700         CONTINUE                                                 07870005
078800     ELSE                                                         07880005
078900         SET DP013-NO-ROLLBACK                                    07890005
079000             DP013-XCTL-DISPLAY-RESTART                           07900005
079100             DP013-CICS-ABEND      TO TRUE                        07910005
079200         MOVE 'BEFORE 0000-MAIN-MODULE'                           07920005
079300                                   TO DP013-PARAGRAPH             07930005
079510         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O07951032
079520-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07952032
079600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07960005
079700         PERFORM DP013-0000-PROCESS-ABEND                         07970005
079800     END-IF.                                                      07980005
079900                                                                  07990005
080000/                                                                 08000005
080100*----------------------------------------------------------------*08010005
080200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *08020005
080300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *08030005
080400*----------------------------------------------------------------*08040005
080500                                                                  08050005
080600 1000-CONTROL-PROCESSING.                                         08060005
080700                                                                  08070005
080800     EVALUATE TRUE                                                08080005
080900         WHEN DP020-NEXT-ACT-INITIAL                              08090005
081000              PERFORM 1100-FIND-OBJECT-KEYS                       08100005
081100              IF  PS-ERROR                                        08110005
081200                  CONTINUE                                        08120005
081300              ELSE                                                08130005
081400                  PERFORM 4000-BUILD-INITIAL-PANEL                08140005
081500                  PERFORM 3200-RESET-ATTRIBUTES                   08150005
081600              END-IF                                              08160005
081700                                                                  08170005
081800         WHEN DP020-NEXT-ACT-READ-MAP                             08180005
081900              PERFORM 2000-PROCESS-PANEL                          08190005
082000                                                                  08200005
082100         WHEN DP020-NEXT-ACT-RETURN                               08210005
082200              MOVE ASC-PO-NBR-N           TO                      08220005
082300                                      DK-PO-NBR                   08230005
082400              MOVE ASC-REC-SEQ-NBR-N  TO                          08240005
082500                                      DK-REC-SEQ-NBR              08250005
082600              MOVE SPACES       TO ASC-TKT-DESC                   08260005
082700              PERFORM 4260-SELECT-TICKET-TYPE                     08270005
082800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08280005
082900              PERFORM 3200-RESET-ATTRIBUTES                       08290005
083000                                                                  08300005
083100         WHEN OTHER                                               08310005
083200              SET DP013-LOGIC-ABEND                               08320005
083300                  DP013-NO-ROLLBACK TO TRUE                       08330005
083400              MOVE '1000-CONTROL-PROCESSING'                      08340005
083500                                    TO DP013-PARAGRAPH            08350005
083600              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  08360005
083700                                    TO DP013-MESSAGE-TEXT(1)      08370005
083800              MOVE DP020-NEXT-APPL-ACTIVITY                       08380005
083900                                    TO DP013-MESSAGE-TEXT(2)      08390005
084000              PERFORM DP013-0000-PROCESS-ABEND                    08400005
084100     END-EVALUATE.                                                08410005
084200                                                                  08420005
084300/                                                                 08430005
084400*----------------------------------------------------------------*08440005
084500*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *08450005
084600*    INTER-APPLICATION FORMAT CODE.                              *08460005
084700*----------------------------------------------------------------*08470005
084800 1100-FIND-OBJECT-KEYS.                                           08480005
084900                                                                  08490005
085000     INITIALIZE ASC-SPECIFIC-COMMAREA.                            08500005
085100                                                                  08510005
085200     MOVE DP020-INT-APPL-FORMAT-IND                               08520005
085300                                   TO ASC-INT-APPL-FORMAT-IND.    08530005
085400                                                                  08540005
085500     EVALUATE DP020-INT-APPL-FORMAT-IND                           08550005
085600         WHEN PC-INTER-APPL-CRIT-DETAIL                           08560005
085700             IF  RC012-PO-NBR      = ZEROES                       08570005
085800             AND RC012-REC-SEQ-NBR = ZEROES                       08580005
085900                 MOVE PC-TSYMSG-00330                             08590005
086000                                   TO DP020-MSG-NUMBER            08600005
086100                 SET PS-ERROR                                     08610005
086200                     DP020-MSG-FATAL                              08620005
086300                     DP020-NEXT-ACT-APPL-ERROR                    08630005
086400                                   TO TRUE                        08640005
086500             END-IF                                               08650005
086600                                                                  08660005
086700             IF  PS-NO-ERROR                                      08670005
086800             AND RC012-OPER-UNT-ID = ZEROES                       08680005
086900             AND RC012-FCLTY-ID    = ZEROES                       08690005
087000                 MOVE PC-TSYMSG-00789                             08700005
087100                                   TO DP020-MSG-NUMBER            08710005
087200                 SET PS-ERROR                                     08720005
087300                     DP020-MSG-FATAL                              08730005
087400                     DP020-NEXT-ACT-APPL-ERROR                    08740005
087500                                   TO TRUE                        08750005
087600             ELSE                                                 08760005
087700                 MOVE RC012-OPER-UNT-ID                           08770005
087800                                   TO ASC-OPER-UNT-ID             08780005
087900                 MOVE RC012-FCLTY-ID                              08790005
088000                                   TO ASC-FCLTY-ID                08800005
088100                 MOVE RC012-PO-NBR TO ASC-KEY-PO-NBR              08810005
088200                                      ASC-PO-NBR-N                08820005
088300                 MOVE RC012-REC-SEQ-NBR                           08830005
088400                                   TO ASC-KEY-REC-SEQ-NBR         08840005
088500                                      ASC-REC-SEQ-NBR-N           08850005
088600             END-IF                                               08860005
088700                                                                  08870005
090000         WHEN PC-INTER-APPL-LIST                                  09000005
090100         WHEN PC-INTER-APPL-ADD-TO-RCVR                           09010005
090200         WHEN PC-INTER-APPL-RCVG-PO-LIST                          09020005
090300             IF  RC015-NUMBER-OF-SELECTED-ITEMS > ZERO            09030005
090400                 SET ASC-USE-SELECTION-QUEUE                      09040005
090500                                   TO TRUE                        09050005
090600                 MOVE RC015-NUMBER-OF-SELECTED-ITEMS              09060005
090700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS09070005
090800                 MOVE RC015-NUMBER-OF-TS-ITEMS                    09080005
090900                                   TO ASC-NUMBER-OF-TS-ITEMS      09090005
091000                 MOVE RC015-SEL-QUEUE-NAME                        09100005
091100                                   TO ASC-SEL-QUEUE-NAME          09110005
091200                 PERFORM 1120-PREPARE-LIST-ENTRY                  09120005
091300                 IF  ASC-OPER-UNT-ID = ZEROES                     09130005
091400                 AND ASC-FCLTY-ID    = ZEROES                     09140005
091500                     MOVE RC015-OPER-UNT-ID                       09150005
091600                                   TO ASC-OPER-UNT-ID             09160005
091700                     MOVE RC015-FCLTY-ID                          09170005
091800                                   TO ASC-FCLTY-ID                09180005
091900                 END-IF                                           09190005
092000             ELSE                                                 09200005
092100                 SET DP030-OVERRIDE-GO                            09210005
092200                                   TO TRUE                        09220005
092300                 MOVE PC-TSYMSG-00057                             09230005
092400                                   TO DP020-MSG-NUMBER            09240005
092500                 SET DP020-MSG-WARNING                            09250005
092600                     DP020-NEXT-ACT-APPL-ERROR                    09260005
092700                                   TO TRUE                        09270005
092800             END-IF                                               09280005
092900                                                                  09290005
093000         WHEN OTHER                                               09300005
093100             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            09310005
093200             SET DP020-MSG-FATAL                                  09320005
093300                 DP020-NEXT-ACT-APPL-ERROR                        09330005
093400                                   TO TRUE                        09340005
093500     END-EVALUATE.                                                09350005
093600                                                                  09360005
093700/                                                                 09370005
093800*----------------------------------------------------------------*09380005
093900*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *09390005
094000*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *09400005
094100*----------------------------------------------------------------*09410005
094200 1120-PREPARE-LIST-ENTRY.                                         09420005
094300                                                                  09430005
094400     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                09440005
094500     MOVE ZERO                     TO ASC-SEL-ITEM.               09450005
094600     PERFORM 2110-GET-NEXT-RECORD.                                09460005
094700                                                                  09470005
094800/                                                                 09480005
094900*----------------------------------------------------------------*09490005
095000*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*09500005
095100*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*09510005
095200*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *09520005
095300*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *09530005
095400*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *09540005
095500*----------------------------------------------------------------*09550005
095600                                                                  09560005
095700 2000-PROCESS-PANEL.                                              09570005
095800                                                                  09580005
095900     EVALUATE TRUE                                                09590005
096000                                                                  09600005
096100         WHEN DP020-SRC-AID = DP016-CLEAR                         09610005
096200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09620005
096300                                                                  09630005
096400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     09640005
096500             PERFORM 4000-BUILD-INITIAL-PANEL                     09650005
096600             PERFORM 3200-RESET-ATTRIBUTES                        09660005
096700                                                                  09670005
096800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09680005
096900             IF  ASC-USE-SELECTION-QUEUE                          09690005
097000                 PERFORM 2110-GET-NEXT-RECORD                     09700005
097100                 IF PS-LIST-END                                   09710005
097200                    SET PS-NO-LIST-END                            09720005
097300                                   TO TRUE                        09730005
097400                 ELSE                                             09740005
097500                    PERFORM 4000-BUILD-INITIAL-PANEL              09750005
097600                    PERFORM 3200-RESET-ATTRIBUTES                 09760005
097700                 END-IF                                           09770005
097800             ELSE                                                 09780005
097900*                --- BOTTOM OF LIST ---                           09790005
098000                 MOVE PC-TSYMSG-00070                             09800005
098100                                   TO DP020-MSG-NUMBER            09810005
098200                 SET DP020-MSG-INFORMATIONAL                      09820005
098300                     PS-LIST-END   TO TRUE                        09830005
098400             END-IF                                               09840005
098500                                                                  09850005
098600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09860005
098700             IF  ASC-USE-SELECTION-QUEUE                          09870005
098800                 PERFORM 2120-GET-PREV-RECORD                     09880005
098900                 IF PS-LIST-END                                   09890005
099000                    SET PS-NO-LIST-END                            09900005
099100                                   TO TRUE                        09910005
099200                 ELSE                                             09920005
099300                    PERFORM 4000-BUILD-INITIAL-PANEL              09930005
099400                    PERFORM 3200-RESET-ATTRIBUTES                 09940005
099500                 END-IF                                           09950005
099600             ELSE                                                 09960005
099700*                --- TOP OF LIST ---                              09970005
099800                 MOVE PC-TSYMSG-00069                             09980005
099900                                   TO DP020-MSG-NUMBER            09990005
100000                 SET DP020-MSG-INFORMATIONAL                      10000005
100100                     PS-LIST-END   TO TRUE                        10010005
100200             END-IF                                               10020005
100300                                                                  10030005
100400         WHEN OTHER                                               10040005
100500             PERFORM 2100-CHECK-FUNCTION-KEY                      10050005
100600     END-EVALUATE.                                                10060005
100700                                                                  10070005
100800/                                                                 10080005
100900*----------------------------------------------------------------*10090005
101000*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *10100005
101100*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*10110005
101200*    FROM THE CICS ARCHITECTURE API.                             *10120005
101300*----------------------------------------------------------------*10130005
101400                                                                  10140005
101500 2100-CHECK-FUNCTION-KEY.                                         10150005
101600                                                                  10160005
101700     EVALUATE TRUE                                                10170005
101800         WHEN DP020-SRC-AID = DP016-ENTER                         10180005
101900             CONTINUE                                             10190005
102000                                                                  10200005
102100         WHEN DP020-FK-LOCAL-RETURN (DP020-SRC-AID)               10210005
102200             CONTINUE                                             10220005
102300                                                                  10230005
102400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10240005
102500             INITIALIZE PO017-INTER-APPL-COMMAREA                 10250005
102600             MOVE ASC-KEY-PO-NBR TO PO017-PO-NBR                  10260005
102700                                    DK-PO-NBR                     10270005
102800             PERFORM 2130-GET-ENT-NAME-DESC                       10280005
102900             IF SQLCODE = +100                                    10290005
103000                 MOVE SPACES  TO PO017-ENT-NAME-DESC              10300005
103100             ELSE                                                 10310005
103200                 MOVE ENTNME-ENT-NAME-DESC TO PO017-ENT-NAME-DESC 10320005
103300             END-IF                                               10330005
103400                                                                  10340005
103500         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  10350005
103600             INITIALIZE RC012-INTER-APPL-COMMAREA                 10360005
103700             MOVE ASC-KEY-PO-NBR      TO RC012-PO-NBR             10370005
103800             MOVE ASC-KEY-REC-SEQ-NBR TO RC012-REC-SEQ-NBR        10380005
103900             MOVE ASC-OPER-UNT-ID     TO RC012-OPER-UNT-ID        10390005
104000             MOVE ASC-FCLTY-ID        TO RC012-FCLTY-ID           10400005
104100             MOVE ASC-CARRIER         TO RC012-OWNER-SCAC-ID      10410005
104200             MOVE ASC-TRAILER-NBR     TO RC012-VEH-NBR            10420005
104300                                                                  10430005
104400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10440005
104600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              10460005
104800             INITIALIZE RC012-INTER-APPL-COMMAREA                 10480005
104900             MOVE ASC-KEY-PO-NBR      TO RC012-PO-NBR             10490005
105000             MOVE ASC-KEY-REC-SEQ-NBR TO RC012-REC-SEQ-NBR        10500005
105100             MOVE ASC-OPER-UNT-ID     TO RC012-OPER-UNT-ID        10510005
105200             MOVE ASC-FCLTY-ID        TO RC012-FCLTY-ID           10520005
105300             MOVE ASC-CARRIER         TO RC012-OWNER-SCAC-ID      10530005
105400             MOVE ASC-TRAILER-NBR     TO RC012-VEH-NBR            10540005
105500                                                                  10550005
105600*** GOTO PO INSTRUCTION SCREEN                                    10560005
105700          WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)             10570005
105800              INITIALIZE PO017-INTER-APPL-COMMAREA                10580005
105900              MOVE ASC-PO-NBR     TO PO017-PO-NBR                 10590005
106000                                                                  10600005
106100*F14 SU-OUTBOUND PO LINE LIST (SUKCS598)                          10610005
106200         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              10620005
106300             INITIALIZE SU008-INTER-APPL-COMMAREA                 10630005
106400             MOVE ASC-KEY-PO-NBR                                  10640005
106500                              TO SU008-PO-NBR                     10650005
106600             MOVE ASC-KEY-REC-SEQ-NBR                             10660005
106700                              TO SU008-RCVR-NBR                   10670005
106800                                                                  10680005
106900         WHEN OTHER                                               10690005
107000             SET DP013-NO-ROLLBACK                                10700005
107100                 DP013-XCTL-DISPLAY-RESTART                       10710005
107200                 DP013-CICS-ABEND  TO TRUE                        10720005
107300             MOVE '2100-CHECK-FUNCTION-KEY'                       10730005
107400                                   TO DP013-PARAGRAPH             10740005
107500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10750005
107600                                   TO DP013-MESSAGE-TEXT (1)      10760005
107700             PERFORM DP013-0000-PROCESS-ABEND                     10770005
107800     END-EVALUATE.                                                10780005
107900                                                                  10790005
108000/                                                                 10800005
108100*----------------------------------------------------------------*10810005
108200*    GET THE RECEIVER NUMBER (KEY) OF THE NEXT SELECTED OBJECT   *10820005
108300*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *10830005
108400*----------------------------------------------------------------*10840005
108500 2110-GET-NEXT-RECORD.                                            10850005
108600                                                                  10860005
108700     ADD +1                        TO ASC-SEL-SUB.                10870005
108800     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            10880005
108900         ADD +1                    TO ASC-SEL-ITEM                10890005
109000         MOVE +1                   TO ASC-SEL-SUB                 10900005
109100     END-IF.                                                      10910005
109200                                                                  10920005
109300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10930005
109400         PERFORM 9100-READ-SEL-QUEUE                              10940005
109500         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      10950005
109600             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      10960005
109700                                   TO ASC-KEY-PO-NBR              10970005
109800                                      ASC-PO-NBR-N                10980005
109900             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 10990005
110000                                   TO ASC-KEY-REC-SEQ-NBR         11000005
110100                                      ASC-REC-SEQ-NBR-N           11010005
110200             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 11020005
110300                                   TO ASC-OPER-UNT-ID             11030005
110400             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    11040005
110500                                   TO ASC-FCLTY-ID                11050005
110600             SET RC013-INQ (ASC-SEL-SUB)                          11060005
110700                                   TO TRUE                        11070005
110800             PERFORM 9200-REWRITE-LIST-QUEUE                      11080005
110900             INITIALIZE ASC-SCREEN-FIELDS                         11090005
111000         ELSE                                                     11100005
111100             SUBTRACT +1 FROM ASC-SEL-SUB                         11110005
111200*            --- BOTTOM OF LIST ---                               11120005
111300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11130005
111400             SET DP020-MSG-INFORMATIONAL                          11140005
111500                 PS-LIST-END                                      11150005
111600                                   TO TRUE                        11160005
111700         END-IF                                                   11170005
111800     ELSE                                                         11180005
111900         SUBTRACT +1 FROM ASC-SEL-ITEM                            11190005
112000         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 11200005
112100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11210005
112200         SET DP020-MSG-INFORMATIONAL                              11220005
112300             PS-LIST-END                                          11230005
112400                                   TO TRUE                        11240005
112500     END-IF.                                                      11250005
112600                                                                  11260005
112700/                                                                 11270005
112800*----------------------------------------------------------------*11280005
112900*    GET THE RECEIVER NUMBER (KEY) OF THE PREVIOUS SELECTED      *11290005
113000*    OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.         *11300005
113100*----------------------------------------------------------------*11310005
113200 2120-GET-PREV-RECORD.                                            11320005
113300                                                                  11330005
113400     SUBTRACT +1 FROM ASC-SEL-SUB.                                11340005
113500     IF  ASC-SEL-SUB < +1                                         11350005
113600         SUBTRACT +1 FROM ASC-SEL-ITEM                            11360005
113700         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 11370005
113800     END-IF.                                                      11380005
113900                                                                  11390005
114000     IF  ASC-SEL-ITEM > ZERO                                      11400005
114100         PERFORM 9100-READ-SEL-QUEUE                              11410005
114200         MOVE RC013-PO-NBR (ASC-SEL-SUB)                          11420005
114300                                   TO ASC-KEY-PO-NBR              11430005
114400                                      ASC-PO-NBR-N                11440005
114500         MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                     11450005
114600                                   TO ASC-KEY-REC-SEQ-NBR         11460005
114700                                      ASC-REC-SEQ-NBR-N           11470005
114800         MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                     11480005
114900                                   TO ASC-OPER-UNT-ID             11490005
115000         MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                        11500005
115100                                   TO ASC-FCLTY-ID                11510005
115200         INITIALIZE ASC-SCREEN-FIELDS                             11520005
115300     ELSE                                                         11530005
115400         MOVE +1                   TO ASC-SEL-ITEM                11540005
115500                                      ASC-SEL-SUB                 11550005
115600*        --- TOP OF LIST ---                                      11560005
115700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11570005
115800         SET DP020-MSG-INFORMATIONAL                              11580005
115900             PS-LIST-END           TO TRUE                        11590005
116000     END-IF.                                                      11600005
116100                                                                  11610005
116200 2130-GET-ENT-NAME-DESC.                                          11620005
116300                                                                  11630005
116400     EXEC SQL                                                     11640005
116500        SELECT  ENT_NAME_DESC                                     11650005
116600          INTO :ENTNME-ENT-NAME-DESC                              11660005
116700          FROM  TENTNME A                                         11670005
116800               ,TEXTENT B                                         11680005
116900               ,TPURCHS C                                         11690005
117000      WHERE C.PO_NBR         = :DK-PO-NBR                         11700005
117100        AND C.VER_STATUS_CDE = 'A'                                11710005
117200        AND A.SEQ_NBR =                                           11720005
117300            (SELECT MAX(SEQ_NBR)                                  11730005
117400             FROM TENTNME                                         11740005
117500             WHERE ENT_ID   = C.ENT_ID                            11750005
117600               AND TYPE_CDE = '01')                               11760005
117700        AND A.ENT_ID = B.ENT_ID                                   11770005
117800        AND B.ENT_ID = C.ENT_ID                                   11780005
117900      WITH UR                                                     11790011
118000     END-EXEC.                                                    11800005
118100                                                                  11810005
118200     EVALUATE TRUE                                                11820005
118300         WHEN SQLCODE = +0                                        11830005
118400         WHEN SQLCODE = +100                                      11840005
118500             CONTINUE                                             11850005
118600                                                                  11860005
118700         WHEN SQLWARN0 NOT = SPACE                                11870005
118800         WHEN SQLCODE < +0                                        11880005
118900         WHEN SQLCODE > +0                                        11890005
119000             MOVE '2130-GET-ENT-NAME-DESC'                        11900005
119100                             TO DP013-PARAGRAPH                   11910005
119200             MOVE 'SELECT ENTERPRISE NAME'                        11920005
119300                             TO DP013-MESSAGE-TEXT (1)            11930005
119400             MOVE SQLCA      TO DP013-SQLCA                       11940005
119500             MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (1)          11950005
119600             MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (2)          11960005
119700             SET DP013-DB2-ABEND                                  11970005
119800                             TO TRUE                              11980005
119900             SET DP013-XCTL-DISPLAY-RESTART                       11990005
120000                             TO TRUE                              12000005
120100             PERFORM DP013-0000-PROCESS-ABEND                     12010005
120200     END-EVALUATE.                                                12020005
120300                                                                  12030005
120400/                                                                 12040005
120500*----------------------------------------------------------------*12050005
120600*    RESET THE ATTRIBUTES OF CERTAIN FIELDS ON THE MAP.          *12060005
120700*----------------------------------------------------------------*12070005
120800                                                                  12080005
120900 3200-RESET-ATTRIBUTES.                                           12090005
121000                                                                  12100005
121100     IF  ASC-AD-INFO = 'PICT'                                     12110005
121200         IF  ASC-AD-DATE > SPACES                                 12120005
121300             MOVE DP015-YELLOW     TO AADDATEC                    12130005
121400                                      AADINFOC                    12140005
121500         END-IF                                                   12150005
121600     ELSE                                                         12160005
121700         MOVE DP015-BLUE           TO AADDATEC                    12170005
121800                                      AADINFOC                    12180005
121900     END-IF.                                                      12190005
122000                                                                  12200005
122100     IF ASC-MULT-SHIP                                             12210005
122200        MOVE DP015-REVERSE         TO ACARRH                      12220005
122300                                      ATRIPH                      12230005
122400                                      ATRLRNOH                    12240005
122500                                      APROH                       12250005
122600                                      ABOLH                       12260005
122700                                      AVSHPDTH                    12270005
122800                                      ACSHPDTH                    12280005
122810                                      AEFCSHPH                    12281018
122900     ELSE                                                         12290005
123000        MOVE DP015-HL-OFF          TO ACARRH                      12300005
123100                                      ATRIPH                      12310005
123200                                      ATRLRNOH                    12320005
123300                                      APROH                       12330005
123400                                      ABOLH                       12340005
123500                                      AVSHPDTH                    12350005
123600                                      ACSHPDTH                    12360005
123610                                      AEFCSHPH                    12361018
123700     END-IF.                                                      12370005
123800                                                                  12380005
124200     MOVE DP015-YELLOW                 TO ASPCINSC.               12420005
124300/                                                                 12430005
124400*----------------------------------------------------------------*12440005
124500*   -IF THE PO NUMBER WAS PASSED, GET PO INFORMATION FROM THE    *12450005
124600*    PO TABLES AND DISPLAY.                                      *12460005
124700*   -IF THE RECEIVER NUMBER WAS PASSED, GET RECEIPTS INFORMATION *12470005
124800*    FROM THE RECEIPTS TABLES AND DISPLAY.                       *12480005
124900*----------------------------------------------------------------*12490005
125000                                                                  12500005
125100 4000-BUILD-INITIAL-PANEL.                                        12510005
125200                                                                  12520005
125300     SET DP030-SET-CURSOR-TRAILER                                 12530005
125400         PS-NO-ERROR             TO TRUE.                         12540005
125500                                                                  12550005
125600     MOVE ZEROES TO ASC-EXPTED-CART-CNT-N                         12560005
125700                    ASC-ACTL-CART-CNT-N                           12570005
125800                    ASC-DMG-CART-CNT-N                            12580005
125900                    ASC-PCS-INVCD-N                               12590005
126000                    ASC-PCS-VERFD-N                               12600005
126100                    ASC-OPER-SET-ID-N                             12610005
126200                    ASC-PCS-EXPECTED                              12620005
126300                                                                  12630005
126400     IF  ASC-KEY-PO-NBR > ZEROES                                  12640005
126500         MOVE ASC-KEY-PO-NBR       TO DK-PO-NBR                   12650005
126600         PERFORM 4100-GET-PO-INFO                                 12660005
126700         IF  SQLCODE = +0                                         12670005
126800             PERFORM 4110-LOAD-PO-FIELDS                          12680005
126900         END-IF                                                   12690005
127000     END-IF.                                                      12700005
127100                                                                  12710005
127200     IF  ASC-KEY-REC-SEQ-NBR > ZEROES                             12720005
127300         MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID              12730005
127400         MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID                 12740005
127500         MOVE ASC-KEY-PO-NBR       TO DK-PO-NBR                   12750005
127600         MOVE ASC-KEY-REC-SEQ-NBR  TO DK-REC-SEQ-NBR              12760005
127700         PERFORM 4200-SELECT-TRECEIV                              12770005
127800         IF  SQLCODE = +0                                         12780005
127900             PERFORM 4210-LOAD-RECEIPT-FIELDS                     12790005
128000         END-IF                                                   12800005
128100     END-IF.                                                      12810005
128200                                                                  12820005
128300     PERFORM 4300-FILL-TROUBLE-FIELDS.                            12830005
128400                                                                  12840005
128500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12850005
128600                                                                  12860005
128700/                                                                 12870005
128800*----------------------------------------------------------------*12880005
128900*    GET PURCHASE ORDER INFO                                     *12890005
129000*----------------------------------------------------------------*12900005
129100 4100-GET-PO-INFO.                                                12910005
129200                                                                  12920005
129300     PERFORM                                                      12930005
129400         WITH TEST AFTER                                          12940005
129500         VARYING PV-RETRY-COUNTER                                 12950005
129600         FROM 1 BY 1                                              12960005
129700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12970005
129800            OR (SQLCODE = +0)                                     12980005
129900            OR (SQLCODE = +100))                                  12990005
130000                                                                  13000005
130200         EXEC SQL                                                 13020005
130300            SELECT  DISTINCT                                      13030005
130400                    A.PO_NBR                                      13040005
130500                   ,A.DEPT_NBR                                    13050005
130600                   ,A.EDI_IND                                     13060005
130700                   ,B.STATUS_DESC                                 13070005
130800                   ,C.ENT_NAME_DESC                               13080005
130900                   ,C.ENT_ID                                      13090005
131000                   ,A.WHSE_RPLNT_IND                              13100005
131100              INTO :PURCHS-PO-NBR                                 13110005
131200                  ,:PURCHS-DEPT-NBR                               13120005
131300                  ,:PURCHS-EDI-IND                                13130005
131400                  ,:STATCD-STATUS-DESC                            13140005
131500                  ,:ENTNME-ENT-NAME-DESC                          13150005
131600                  ,:ENTNME-ENT-ID                                 13160005
131700                  ,:PURCHS-WHSE-RPLNT-IND                         13170005
131800              FROM  TPURCHS A                                     13180005
131900                   ,TSTATCD B                                     13190005
132000                   ,TENTNME C                                     13200005
132100          WHERE A.PO_NBR         = :DK-PO-NBR                     13210005
132200            AND A.VER_STATUS_CDE = 'A'                            13220005
132300            AND C.TYPE_CDE       = '01'                           13230005
132400            AND A.STATUS_CDE = B.STATUS_CDE                       13240005
132500            AND A.ENT_ID     = C.ENT_ID                           13250005
132510         WITH UR                                                  13251029
132600         END-EXEC                                                 13260005
132700                                                                  13270005
132800         EVALUATE TRUE                                            13280005
132900             WHEN SQLCODE = +0                                    13290005
133000             WHEN SQLCODE = +100                                  13300005
133100             WHEN SQLCODE = -904                                  13310005
133200             WHEN SQLCODE = -913                                  13320005
133300                 CONTINUE                                         13330005
133400                                                                  13340005
133500             WHEN SQLWARN0 NOT = SPACE                            13350005
133600             WHEN SQLCODE < +0                                    13360005
133700             WHEN SQLCODE > +0                                    13370005
133800                 MOVE '4100-GET-PO-INFO'                          13380005
133900                                 TO DP013-PARAGRAPH               13390005
134000                 MOVE 'SELECT ON TPURCHS'                         13400005
134100                                 TO DP013-MESSAGE-TEXT (1)        13410005
134200                 MOVE SQLCA      TO DP013-SQLCA                   13420005
134300                 MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)      13430005
134400                 SET DP013-DB2-ABEND                              13440005
134500                                 TO TRUE                          13450005
134600                 SET DP013-XCTL-DISPLAY-RESTART                   13460005
134700                                 TO TRUE                          13470005
134800                 PERFORM DP013-0000-PROCESS-ABEND                 13480005
134900         END-EVALUATE                                             13490005
135000     END-PERFORM.                                                 13500005
135100                                                                  13510005
135200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13520005
135300             AND (SQLCODE = -904 OR -913)                         13530005
135400         MOVE '4100-GET-PO-INFO'                                  13540005
135500                                 TO DP013-PARAGRAPH               13550005
135600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     13560005
135700                                 TO DP013-MESSAGE-TEXT (1)        13570005
135800         MOVE 'PO INFO    '                                       13580005
135900                                 TO DP013-MESSAGE-TEXT (2)        13590005
136000         MOVE SQLCA              TO DP013-SQLCA                   13600005
136100         MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)      13610005
136200         SET DP013-DB2-ABEND     TO TRUE                          13620005
136300         SET DP013-XCTL-DISPLAY-RESTART                           13630005
136400                                 TO TRUE                          13640005
136500         PERFORM DP013-0000-PROCESS-ABEND                         13650005
136600     END-IF.                                                      13660005
136700                                                                  13670005
136800/                                                                 13680005
136900*----------------------------------------------------------------*13690005
137000*    MOVE THE PO DATABASE FIELDS INTO THE COMMAREA               *13700005
137100*----------------------------------------------------------------*13710005
137200 4110-LOAD-PO-FIELDS.                                             13720005
137300                                                                  13730005
137400     MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR.                  13740005
137500                                                                  13750005
137600*  SPECIAL INSTRUCTIONS                                           13760005
137700     PERFORM 4120-GET-SPECIAL-INSTR.                              13770005
137800                                                                  13780005
137900     IF  SQLCODE = ZERO                                           13790005
138000         MOVE INSTCD-INSTR-DESC(1:25)                             13800005
138100                                   TO ASC-SPEC-INSTRC             13810005
138200     ELSE                                                         13820005
138300         IF  SQLCODE = -811                                       13830005
138400             MOVE '** MULTIPLE **' TO ASC-SPEC-INSTRC             13840005
138500         END-IF                                                   13850005
138600     END-IF.                                                      13860005
138700                                                                  13870005
138800*  PO STATUS                                                      13880005
138900     MOVE STATCD-STATUS-DESC       TO ASC-PO-STATUS.              13890005
139000                                                                  13900005
139100*  DO NOT SHIP DATE                                               13910005
139200*  CANCEL DATE                                                    13920005
139300     PERFORM 4130-GET-PLANNED-SHIP-INFO.                          13930005
139400                                                                  13940005
139500     IF  SQLCODE = +0                                             13950005
139600         IF  PLNSHP-DONT-SHIP-BEF-DTE > SPACES                    13960005
139700         AND PLNSHP-DONT-SHIP-BEF-DTE NOT = '0001-01-01'          13970005
139800             MOVE PLNSHP-DONT-SHIP-BEF-DTE                        13980005
139900                                  TO PV-DB2-DATE                  13990005
140000             MOVE PV-DB2-DATE-MM  TO PV-DISPLAY-DATE-MM           14000005
140100             MOVE PV-DB2-DATE-DD  TO PV-DISPLAY-DATE-DD           14010005
140200             MOVE PV-DB2-DATE-YY  TO PV-DISPLAY-DATE-YY           14020005
140300             MOVE PV-DISPLAY-DATE TO ASC-DO-NOT-SHIP-DATE         14030005
140400         ELSE                                                     14040005
140500             MOVE SPACES          TO ASC-DO-NOT-SHIP-DATE         14050005
140600         END-IF                                                   14060005
140700         IF  PLNSHP-CAN-IFNOT-SHIP-DTE > SPACES                   14070005
140800         AND PLNSHP-CAN-IFNOT-SHIP-DTE NOT = '0001-01-01'         14080005
140900             MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                       14090005
141000                                  TO PV-DB2-DATE                  14100005
141100             MOVE PV-DB2-DATE-MM  TO PV-DISPLAY-DATE-MM           14110005
141200             MOVE PV-DB2-DATE-DD  TO PV-DISPLAY-DATE-DD           14120005
141300             MOVE PV-DB2-DATE-YY  TO PV-DISPLAY-DATE-YY           14130005
141400             MOVE PV-DISPLAY-DATE TO                              14140005
141500                                  ASC-CANCEL-DATE                 14150005
141600         ELSE                                                     14160005
141700             MOVE SPACES          TO                              14170005
141800                                  ASC-CANCEL-DATE                 14180005
141900         END-IF                                                   14190005
142000     END-IF.                                                      14200005
142100                                                                  14210005
142200*  AD DATE                                                        14220005
142300     PERFORM 4140-GET-AD-DATE.                                    14230005
142400                                                                  14240005
142500     IF  SQLCODE = -305                                           14250005
142600         MOVE SPACES               TO ASC-AD-DATE                 14260005
142700     ELSE                                                         14270005
142800         IF  DN-AD-EVNT-DTE = -1                                  14280005
142900             MOVE SPACES           TO ASC-AD-DATE                 14290005
143000         ELSE                                                     14300005
143100             MOVE PURITM-AD-EVNT-DTE TO PV-DB2-DATE               14310005
143200             MOVE PV-DB2-DATE-MM   TO PV-DISPLAY-DATE-MM          14320005
143300             MOVE PV-DB2-DATE-DD   TO PV-DISPLAY-DATE-DD          14330005
143400             MOVE PV-DB2-DATE-YY   TO PV-DISPLAY-DATE-YY          14340005
143500             MOVE PV-DISPLAY-DATE  TO ASC-AD-DATE                 14350005
143600         END-IF                                                   14360005
143700     END-IF.                                                      14370005
143800                                                                  14380005
143900*  GET THE ITEM NUMBER                                            14390005
144000     PERFORM 4150-GET-ITM-NBR.                                    14400005
144100                                                                  14410005
144200*  DEPARTMENT                                                     14420005
144300     MOVE   PURCHS-DEPT-NBR  TO ASC-DEPT.                         14430005
144400                                                                  14440005
144500     IF PS-ITM-NBR-FOUND                                          14450005
144600         INITIALIZE XL001-ITEM-COMMAREA                           14460005
144700         PERFORM 4151-CALL-XLKUT001                               14470005
144800     END-IF                                                       14480005
144900                                                                  14490005
145100     PERFORM 4330-DETERMINE-IF-RFID.                              14510007
145300                                                                  14530007
145400*  VENDOR NAME                                                    14540005
145500     MOVE ENTNME-ENT-NAME-DESC     TO ASC-VENDOR-NAME.            14550005
145600                                                                  14560005
145700*  BUYER NAME                                                     14570005
145800     PERFORM 7000-GET-BUYER-NAME.                                 14580005
145900                                                                  14590005
146000/                                                                 14600005
146100*----------------------------------------------------------------*14610005
146200*    GET SPECIAL INSTRUCTION FOR PO                              *14620005
146300*----------------------------------------------------------------*14630005
146400 4120-GET-SPECIAL-INSTR.                                          14640005
146500                                                                  14650005
146600     PERFORM                                                      14660005
146700         WITH TEST AFTER                                          14670005
146800         VARYING PV-RETRY-COUNTER                                 14680005
146900         FROM 1 BY 1                                              14690005
147000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14700005
147100            OR (SQLCODE = +0)                                     14710005
147200            OR (SQLCODE = -811)                                   14720005
147300            OR (SQLCODE = +100))                                  14730005
147400                                                                  14740005
147500         EXEC SQL                                                 14750005
147600            SELECT  B.INSTR_DESC                                  14760005
147700              INTO :INSTCD-INSTR-DESC                             14770005
147800              FROM  TPOINST A                                     14780005
147900                   ,TINSTCD B                                     14790005
148000          WHERE A.PO_NBR    = :DK-PO-NBR                          14800005
148100            AND A.RECIP_CDE = 'DC'                                14810005
148200            AND A.INSTR_NBR = B.INSTR_NBR                         14820005
148210         WITH UR                                                  14821029
148300         END-EXEC                                                 14830005
148400                                                                  14840005
148500         EVALUATE TRUE                                            14850005
148600             WHEN SQLCODE = +0                                    14860005
148700                 SET ASC-MULT-INSTR-NO  TO TRUE                   14870005
148800             WHEN SQLCODE = -811                                  14880005
148900                 SET ASC-MULT-INSTR-YES TO TRUE                   14890005
149000             WHEN SQLCODE = +100                                  14900005
149100             WHEN SQLCODE = -904                                  14910005
149200             WHEN SQLCODE = -913                                  14920005
149300                 CONTINUE                                         14930005
149400                                                                  14940005
149500             WHEN SQLWARN0 NOT = SPACE                            14950005
149600             WHEN SQLCODE < +0                                    14960005
149700             WHEN SQLCODE > +0                                    14970005
149800                 MOVE '4120-GET-SPECIAL-INSTR'                    14980005
149900                                 TO DP013-PARAGRAPH               14990005
150000                 MOVE 'SELECT ON TPOINST'                         15000005
150100                                 TO DP013-MESSAGE-TEXT (1)        15010005
150200                 MOVE SQLCA      TO DP013-SQLCA                   15020005
150300                 MOVE 'TPOINST'  TO DP013-DB2-TABLE-NAME (1)      15030005
150400                 MOVE 'TINSTCD'  TO DP013-DB2-TABLE-NAME (2)      15040005
150500                 SET DP013-DB2-ABEND                              15050005
150600                                 TO TRUE                          15060005
150700                 SET DP013-XCTL-DISPLAY-RESTART                   15070005
150800                                 TO TRUE                          15080005
150900                 PERFORM DP013-0000-PROCESS-ABEND                 15090005
151000         END-EVALUATE                                             15100005
151100     END-PERFORM.                                                 15110005
151200                                                                  15120005
151300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15130005
151400             AND (SQLCODE = -904 OR -913)                         15140005
151500         MOVE '4120-GET-SPECIAL-INSTR'                            15150005
151600                                 TO DP013-PARAGRAPH               15160005
151700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15170005
151800                                 TO DP013-MESSAGE-TEXT (1)        15180005
151900         MOVE 'SPECIAL INSTRUCTIONS FOR PO'                       15190005
152000                                 TO DP013-MESSAGE-TEXT (2)        15200005
152100         MOVE SQLCA              TO DP013-SQLCA                   15210005
152200         MOVE 'TPOINST'          TO DP013-DB2-TABLE-NAME (1)      15220005
152300         MOVE 'TINSTCD'          TO DP013-DB2-TABLE-NAME (2)      15230005
152400         SET DP013-DB2-ABEND     TO TRUE                          15240005
152500         SET DP013-XCTL-DISPLAY-RESTART                           15250005
152600                                 TO TRUE                          15260005
152700         PERFORM DP013-0000-PROCESS-ABEND                         15270005
152800     END-IF.                                                      15280005
152900                                                                  15290005
153000/                                                                 15300005
153100*----------------------------------------------------------------*15310005
153200*    GET PLANNED SHIPMENT INFO                                   *15320005
153300*----------------------------------------------------------------*15330005
153400 4130-GET-PLANNED-SHIP-INFO.                                      15340005
153500                                                                  15350005
153600     PERFORM                                                      15360005
153700         WITH TEST AFTER                                          15370005
153800         VARYING PV-RETRY-COUNTER                                 15380005
153900         FROM 1 BY 1                                              15390005
154000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15400005
154100            OR (SQLCODE = +0)                                     15410005
154200            OR (SQLCODE = +100))                                  15420005
154300                                                                  15430005
154400         EXEC SQL                                                 15440005
154500            SELECT  DONT_SHIP_BEF_DTE                             15450005
154600                   ,CAN_IFNOT_SHIP_DTE                            15460005
154700              INTO :PLNSHP-DONT-SHIP-BEF-DTE                      15470005
154800                  ,:PLNSHP-CAN-IFNOT-SHIP-DTE                     15480005
154900              FROM  TPLNSHP                                       15490005
155000          WHERE PO_NBR         = :DK-PO-NBR                       15500005
155100            AND VER_STATUS_CDE = 'A'                              15510005
155110         WITH UR                                                  15511029
155200         END-EXEC                                                 15520005
155300                                                                  15530005
155400         EVALUATE TRUE                                            15540005
155500             WHEN SQLCODE = +0                                    15550005
155600             WHEN SQLCODE = +100                                  15560005
155700             WHEN SQLCODE = -904                                  15570005
155800             WHEN SQLCODE = -913                                  15580005
155900                 CONTINUE                                         15590005
156000                                                                  15600005
156100             WHEN SQLWARN0 NOT = SPACE                            15610005
156200             WHEN SQLCODE < +0                                    15620005
156300             WHEN SQLCODE > +0                                    15630005
156400                 MOVE '4130-GET-PLANNED-SHIP-INFO'                15640005
156500                                 TO DP013-PARAGRAPH               15650005
156600                 MOVE 'SELECT ON TPLNSHP'                         15660005
156700                                 TO DP013-MESSAGE-TEXT (1)        15670005
156800                 MOVE SQLCA      TO DP013-SQLCA                   15680005
156900                 MOVE 'TPLNSHP'  TO DP013-DB2-TABLE-NAME (1)      15690005
157000                 SET DP013-DB2-ABEND                              15700005
157100                                 TO TRUE                          15710005
157200                 SET DP013-XCTL-DISPLAY-RESTART                   15720005
157300                                 TO TRUE                          15730005
157400                 PERFORM DP013-0000-PROCESS-ABEND                 15740005
157500         END-EVALUATE                                             15750005
157600     END-PERFORM.                                                 15760005
157700                                                                  15770005
157800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15780005
157900             AND (SQLCODE = -904 OR -913)                         15790005
158000         MOVE '4130-GET-PLANNED-SHIP-INFO'                        15800005
158100                                 TO DP013-PARAGRAPH               15810005
158200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15820005
158300                                 TO DP013-MESSAGE-TEXT (1)        15830005
158400         MOVE 'PLANNED SHIPMENT INFO FOR PO'                      15840005
158500                                 TO DP013-MESSAGE-TEXT (2)        15850005
158600         MOVE SQLCA              TO DP013-SQLCA                   15860005
158700         MOVE 'TPLNSHP'          TO DP013-DB2-TABLE-NAME (1)      15870005
158800         SET DP013-DB2-ABEND     TO TRUE                          15880005
158900         SET DP013-XCTL-DISPLAY-RESTART                           15890005
159000                                 TO TRUE                          15900005
159100         PERFORM DP013-0000-PROCESS-ABEND                         15910005
159200     END-IF.                                                      15920005
159300                                                                  15930005
159400/                                                                 15940005
159500*----------------------------------------------------------------*15950005
159600*    GET THE EARLIEST AD DATE                                    *15960005
159700*----------------------------------------------------------------*15970005
159800 4140-GET-AD-DATE.                                                15980005
159900                                                                  15990005
160000     PERFORM                                                      16000005
160100         WITH TEST AFTER                                          16010005
160200         VARYING PV-RETRY-COUNTER                                 16020005
160300         FROM 1 BY 1                                              16030005
160400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16040005
160500             OR (SQLCODE = +0)                                    16050005
160600             OR (SQLCODE = -305))                                 16060005
160700                                                                  16070005
160800         EXEC SQL                                                 16080005
160900              SELECT MIN(AD_EVNT_DTE)                             16090005
161000                INTO :PURITM-AD-EVNT-DTE                          16100005
161100                       :DN-AD-EVNT-DTE                            16110005
161200                FROM TPURITM                                      16120005
161300               WHERE PO_NBR         = :DK-PO-NBR                  16130005
161400                 AND VER_STATUS_CDE = 'A'                         16140005
161500                 AND AD_EVNT_DTE > '0001-01-01'                   16150005
161510         WITH UR                                                  16151029
161600         END-EXEC                                                 16160005
161700                                                                  16170005
161800         EVALUATE TRUE                                            16180005
161900             WHEN SQLCODE = +0                                    16190005
162000             WHEN SQLCODE = -305                                  16200005
162100             WHEN SQLCODE = -904                                  16210005
162200             WHEN SQLCODE = -913                                  16220005
162300                  CONTINUE                                        16230005
162400                                                                  16240005
162500             WHEN SQLWARN0 NOT = SPACES                           16250005
162600             WHEN SQLCODE < +0                                    16260005
162700             WHEN SQLCODE > +0                                    16270005
162800                  MOVE '4140-GET-AD-DATE'                         16280005
162900                                  TO DP013-PARAGRAPH              16290005
163000                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           16300005
163100                                  TO DP013-MESSAGE-TEXT (1)       16310005
163200                  MOVE SQLCA      TO DP013-SQLCA                  16320005
163300                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     16330005
163400                  SET DP013-DB2-ABEND                             16340005
163500                      DP013-XCTL-DISPLAY-RESTART                  16350005
163600                                  TO TRUE                         16360005
163700                  PERFORM DP013-0000-PROCESS-ABEND                16370005
163800         END-EVALUATE                                             16380005
163900     END-PERFORM.                                                 16390005
164000                                                                  16400005
164100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16410005
164200             AND (SQLCODE = -904 OR -913)                         16420005
164300         MOVE '4140-GET-AD-DATE'                                  16430005
164400                                  TO DP013-PARAGRAPH              16440005
164500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            16450005
164600                                  TO DP013-MESSAGE-TEXT (1)       16460005
164700         MOVE SQLCA               TO DP013-SQLCA                  16470005
164800         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     16480005
164900         SET DP013-DB2-ABEND                                      16490005
165000             DP013-XCTL-DISPLAY-RESTART                           16500005
165100                                  TO TRUE                         16510005
165200         PERFORM DP013-0000-PROCESS-ABEND                         16520005
165300     END-IF.                                                      16530005
165400                                                                  16540005
165500/                                                                 16550005
165600*----------------------------------------------------------------*16560005
165700*    GET THE CLASS NUMBER                                        *16570005
165800*----------------------------------------------------------------*16580005
165900 4150-GET-ITM-NBR.                                                16590005
166000                                                                  16600005
166100     PERFORM                                                      16610005
166200         WITH TEST AFTER                                          16620005
166300         VARYING PV-RETRY-COUNTER                                 16630005
166400         FROM 1 BY 1                                              16640005
166500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16650005
166600             OR (SQLCODE = +0)                                    16660005
166700             OR (SQLCODE = +100))                                 16670005
166800                                                                  16680005
166900         EXEC SQL                                                 16690005
167000              SELECT A.ITM_NBR                                    16700005
167100                INTO :PURITM-ITM-NBR                              16710005
167200                FROM TPURITM A                                    16720005
167300               WHERE A.PO_NBR         = :DK-PO-NBR                16730005
167400                 AND A.VER_STATUS_CDE = 'A'                       16740005
167500                 AND A.PO_LNE_NBR =                               16750005
167600                  (SELECT MIN(B.PO_LNE_NBR)                       16760005
167700                    FROM TPURITM B                                16770005
167800                   WHERE B.PO_NBR = A.PO_NBR                      16780005
167900                     AND B.VER_STATUS_CDE = 'A')                  16790005
167910         WITH UR                                                  16791029
168000         END-EXEC                                                 16800005
168100                                                                  16810005
168200         EVALUATE TRUE                                            16820005
168300             WHEN SQLCODE = +0                                    16830005
168400             WHEN SQLCODE = +100                                  16840005
168500             WHEN SQLCODE = -904                                  16850005
168600             WHEN SQLCODE = -913                                  16860005
168700                  SET PS-ITM-NBR-FOUND TO TRUE                    16870005
168800                                                                  16880005
168900             WHEN SQLWARN0 NOT = SPACES                           16890005
169000             WHEN SQLCODE < +0                                    16900005
169100             WHEN SQLCODE > +0                                    16910005
169200                  MOVE '4150-GET-ITM-NBR'                         16920005
169300                                  TO DP013-PARAGRAPH              16930005
169400                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           16940005
169500                                  TO DP013-MESSAGE-TEXT (1)       16950005
169600                  MOVE SQLCA      TO DP013-SQLCA                  16960005
169700                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     16970005
169800                  SET DP013-DB2-ABEND                             16980005
169900                      DP013-XCTL-DISPLAY-RESTART                  16990005
170000                                  TO TRUE                         17000005
170100                  PERFORM DP013-0000-PROCESS-ABEND                17010005
170200         END-EVALUATE                                             17020005
170300     END-PERFORM.                                                 17030005
170400                                                                  17040005
170500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17050005
170600             AND (SQLCODE = -904 OR -913)                         17060005
170700         MOVE '4150-GET-ITM-NBR '                                 17070005
170800                                  TO DP013-PARAGRAPH              17080005
170900         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            17090005
171000                                  TO DP013-MESSAGE-TEXT (1)       17100005
171100         MOVE SQLCA               TO DP013-SQLCA                  17110005
171200         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     17120005
171300         SET DP013-DB2-ABEND                                      17130005
171400             DP013-XCTL-DISPLAY-RESTART                           17140005
171500                                  TO TRUE                         17150005
171600         PERFORM DP013-0000-PROCESS-ABEND                         17160005
171700     END-IF.                                                      17170005
171800                                                                  17180005
171900/                                                                 17190005
172000*----------------------------------------------------------------*17200005
172100*    CALL XLKUT001 FOR ITM NUMBER                                *17210005
172200*----------------------------------------------------------------*17220005
172300 4151-CALL-XLKUT001.                                              17230005
172400                                                                  17240005
172500     MOVE PURITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             17250005
172600                                                                  17260005
172700     SET  XL001-BY-ITEM                                           17270005
172800          XL001-SELECT-VND-STYL TO TRUE.                          17280005
172900                                                                  17290005
173000     CALL XL001-VSM-PGM USING  DFHEIBLK                           17300005
173100                                      XL001-COMMAREA              17310005
173200                                      XL001-ITEM-COMMAREA.        17320005
173300     EVALUATE TRUE                                                17330005
173400                                                                  17340005
173500          WHEN XL001-SUCCESSFUL                                   17350005
173600              WHEN XL001-SKU-SQLCODE      =                       17360005
173700                             (0 OR +100 OR -904 OR -913)          17370005
173800              WHEN XL001-VND-STYL-SQLCODE =                       17380005
173900                             (0 OR +100 OR -904 OR -913)          17390005
174000                  CONTINUE                                        17400005
174100                                                                  17410005
174200              WHEN OTHER                                          17420005
174300                  MOVE '4151-CALL-XLKUT001'                       17430005
174400                                 TO DP013-PARAGRAPH               17440005
174500                  MOVE 'UNSUCCESSFUL SELECT OF SUB CLASS'         17450005
174600                                 TO DP013-MESSAGE-TEXT (1)        17460005
174700                  MOVE XL001-VND-STYL-SQLCODE                     17470005
174800                                 TO SQLCODE                       17480005
174900                  MOVE SQLCA     TO DP013-SQLCA                   17490005
175000                  MOVE 'SKU VEND' TO DP013-DB2-TABLE-NAME (1)     17500005
175100                  SET DP013-DB2-ABEND                             17510005
175200                      DP013-XCTL-DISPLAY-RESTART                  17520005
175300                                 TO TRUE                          17530005
175400                  PERFORM DP013-0000-PROCESS-ABEND                17540005
175500             END-EVALUATE.                                        17550005
175600/                                                                 17560005
175700*----------------------------------------------------------------*17570005
175800*    GET MOST RECENT RECEIVER INFO                               *17580005
175900*----------------------------------------------------------------*17590005
176000 4200-SELECT-TRECEIV.                                             17600005
176100                                                                  17610005
176200     PERFORM                                                      17620005
176300         WITH TEST AFTER                                          17630005
176400         VARYING PV-RETRY-COUNTER                                 17640005
176500         FROM 1 BY 1                                              17650005
176600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17660005
176700            OR (SQLCODE = +0)                                     17670005
176800            OR (SQLCODE = +100))                                  17680005
176900                                                                  17690005
177000         EXEC SQL                                                 17700005
177100            SELECT  A.OPER_UNT_ID                                 17710005
177200                   ,A.FCLTY_ID                                    17720005
177300                   ,A.CRE_UID                                     17730005
177400                   ,A.CRE_TMST                                    17740005
177500                   ,A.EXPTED_CART_CNT                             17750005
177600                   ,A.ACTL_CART_CNT                               17760005
177700                   ,A.REC_TMST                                    17770005
177800                   ,A.PRE_TKT_IND                                 17780005
177900                   ,A.GOH_IND                                     17790005
178000                   ,A.AD_INFO_DESC                                17800005
178100                   ,A.REC_TYP_CDE                                 17810005
178200                   ,A.RCVG_CLERK_INIT_ID                          17820005
178300                   ,A.RCVR_NBR                                    17830005
178400                   ,A.STATUS_CDE                                  17840005
178500                   ,A.VERFYD_TMST                                 17850005
178600                   ,B.STATUS_DESC                                 17860005
178700                   ,A.CURR_OPER_UNT_ID                            17870005
178800                   ,A.CURR_FCLTY_ID                               17880005
178900                   ,A.CRE_OPER_UNT_ID                             17890005
179000                   ,A.CRE_FCLTY_ID                                17900005
179100                   ,A.APRON_LOC_DESC                              17910005
179200                   ,A.UPD_TMST                                    17920005
179300                   ,A.PACK_BY_ST_IND                              17930005
179400                   ,A.MKNG_APRN_PRT_TMST                          17940005
179500                   ,A.UPD_UID                                     17950005
179600                   ,A.VRFD_USR_ID                                 17960005
179700                   ,A.PKGNG_CDE                                   17970005
179800                   ,A.FRE_ASTRA_IND                               17980005
179900              INTO :RECEIV-OPER-UNT-ID                            17990005
180000                  ,:RECEIV-FCLTY-ID                               18000005
180100                  ,:RECEIV-CRE-UID                                18010005
180200                  ,:RECEIV-CRE-TMST                               18020005
180300                  ,:RECEIV-EXPTED-CART-CNT                        18030005
180400                  ,:RECEIV-ACTL-CART-CNT                          18040005
180500                  ,:RECEIV-REC-TMST                               18050005
180600                  ,:RECEIV-PRE-TKT-IND                            18060005
180700                  ,:RECEIV-GOH-IND                                18070005
180800                  ,:RECEIV-AD-INFO-DESC                           18080005
180900                  ,:RECEIV-REC-TYP-CDE                            18090005
181000                  ,:RECEIV-RCVG-CLERK-INIT-ID                     18100005
181100                  ,:RECEIV-RCVR-NBR                               18110005
181200                  ,:RECEIV-STATUS-CDE                             18120005
181300                  ,:RECEIV-VERFYD-TMST                            18130005
181400                  ,:STATCD-STATUS-DESC                            18140005
181500                  ,:RECEIV-CURR-OPER-UNT-ID                       18150005
181600                  ,:RECEIV-CURR-FCLTY-ID                          18160005
181700                  ,:RECEIV-CRE-OPER-UNT-ID                        18170005
181800                  ,:RECEIV-CRE-FCLTY-ID                           18180005
181900                  ,:RECEIV-APRON-LOC-DESC                         18190005
182000                  ,:RECEIV-UPD-TMST                               18200005
182100                  ,:RECEIV-PACK-BY-ST-IND                         18210005
182200                  ,:RECEIV-MKNG-APRN-PRT-TMST                     18220005
182300                  ,:RECEIV-UPD-UID                                18230005
182400                  ,:RECEIV-VRFD-USR-ID                            18240005
182500                  ,:RECEIV-PKGNG-CDE                              18250005
182600                  ,:RECEIV-FRE-ASTRA-IND                          18260005
182700              FROM  TRECEIV A                                     18270005
182800                   ,TSTATCD B                                     18280005
182900             WHERE A.OPER_UNT_ID = :DK-OPER-UNT-ID                18290005
183000               AND A.FCLTY_ID    = :DK-FCLTY-ID                   18300005
183100               AND A.ORD_NBR     = :DK-PO-NBR                     18310005
183200               AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                18320005
183300               AND A.VER_STATUS_CDE = 'A'                         18330005
183400               AND B.STATUS_TYP_CDE = 'R'                         18340005
183500               AND A.STATUS_CDE     = B.STATUS_CDE                18350005
183510         WITH UR                                                  18351029
183600         END-EXEC                                                 18360005
183700                                                                  18370005
183800         EVALUATE TRUE                                            18380005
183900             WHEN SQLCODE = +0                                    18390005
184000             WHEN SQLCODE = +100                                  18400005
184100             WHEN SQLCODE = -904                                  18410005
184200             WHEN SQLCODE = -913                                  18420005
184300                 CONTINUE                                         18430005
184400                                                                  18440005
184500             WHEN SQLWARN0 NOT = SPACE                            18450005
184600             WHEN SQLCODE < +0                                    18460005
184700             WHEN SQLCODE > +0                                    18470005
184800                 MOVE '4200-SELECT-TRECEIV'                       18480005
184900                                 TO DP013-PARAGRAPH               18490005
185000                 MOVE 'SELECT ON TRECEIV'                         18500005
185100                                 TO DP013-MESSAGE-TEXT (1)        18510005
185200                 MOVE SQLCA      TO DP013-SQLCA                   18520005
185300                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      18530005
185400                 MOVE 'TSTATCD'  TO DP013-DB2-TABLE-NAME (2)      18540005
185500                 SET DP013-DB2-ABEND                              18550005
185600                                 TO TRUE                          18560005
185700                 SET DP013-XCTL-DISPLAY-RESTART                   18570005
185800                                 TO TRUE                          18580005
185900                 PERFORM DP013-0000-PROCESS-ABEND                 18590005
186000         END-EVALUATE                                             18600005
186100     END-PERFORM.                                                 18610005
186200                                                                  18620005
186300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18630005
186400             AND (SQLCODE = -904 OR -913)                         18640005
186500         MOVE '4200-SELECT-TRECEIV'                               18650005
186600                                 TO DP013-PARAGRAPH               18660005
186700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     18670005
186800                                 TO DP013-MESSAGE-TEXT (1)        18680005
186900         MOVE 'RECEIVER INFO'                                     18690005
187000                                 TO DP013-MESSAGE-TEXT (2)        18700005
187100         MOVE SQLCA              TO DP013-SQLCA                   18710005
187200         MOVE 'TRECEIV'          TO DP013-DB2-TABLE-NAME (1)      18720005
187300         MOVE 'TSTATCD'          TO DP013-DB2-TABLE-NAME (2)      18730005
187400         SET DP013-DB2-ABEND     TO TRUE                          18740005
187500         SET DP013-XCTL-DISPLAY-RESTART                           18750005
187600                                 TO TRUE                          18760005
187700         PERFORM DP013-0000-PROCESS-ABEND                         18770005
187800     END-IF.                                                      18780005
187900                                                                  18790005
188000/                                                                 18800005
188100*----------------------------------------------------------------*18810005
188200*    LOAD THE RECEIPTS DATABSE FIELDS INTO THE COMMAREA          *18820005
188300*----------------------------------------------------------------*18830005
188400 4210-LOAD-RECEIPT-FIELDS.                                        18840005
188500                                                                  18850005
188600*  RECEIVER NUMBER                                                18860005
188700     MOVE ASC-KEY-PO-NBR           TO DK-PO-NBR.                  18870005
188800     MOVE ASC-KEY-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.             18880005
188900                                                                  18890005
189000*  RECEIVER LOCATION                                              18900005
189100     MOVE RECEIV-OPER-UNT-ID       TO ASC-ATL-OPER-UNT-ID.        18910005
189200     MOVE RECEIV-FCLTY-ID          TO ASC-ATL-FCLTY-ID.           18920005
189300     MOVE RECEIV-CURR-OPER-UNT-ID  TO ASC-CUR-OPER-UNT-ID.        18930005
189400     MOVE RECEIV-CURR-FCLTY-ID     TO ASC-CUR-FCLTY-ID.           18940005
189500     MOVE RECEIV-CRE-OPER-UNT-ID  TO ASC-ORIG-OPER-UNT-ID.        18950005
189600     MOVE RECEIV-CRE-FCLTY-ID     TO ASC-ORIG-FCLTY-ID.           18960005
189700     MOVE RECEIV-REC-TYP-CDE      TO ASC-REC-TYP.                 18970005
189800     IF RECEIV-MKNG-APRN-PRT-TMST = '9999-09-09-09.09.09.999999'  18980005
189900        MOVE SPACES                TO ASC-MK-HDR-DATE             18990005
190000                                      ASC-MK-HDR-TIME             19000005
190100     ELSE                                                         19010005
190200        MOVE RECEIV-MKNG-APRN-PRT-TMST                            19020005
190300                                   TO PV-DB2-TIMESTAMP            19030005
190400         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  19040005
190500                '/'            DELIMITED BY SIZE                  19050005
190600                PV-DB2-TMST-DD DELIMITED BY SIZE                  19060005
190700                                 INTO ASC-MK-HDR-DATE             19070005
190800         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 19080005
190900                ':'             DELIMITED BY SIZE                 19090005
191000                PV-DB2-TMST-MIN DELIMITED BY SIZE                 19100005
191100                                 INTO ASC-MK-HDR-TIME             19110005
191200     END-IF.                                                      19120005
191300                                                                  19130005
191400*  AD INFO                                                        19140005
191500     MOVE RECEIV-AD-INFO-DESC      TO ASC-AD-INFO.                19150005
191600                                                                  19160005
191700*  RCVR STATUS                                                    19170005
191800     SET ASC-NOT-ADJUSTED TO TRUE.                                19180005
191900     IF STATCD-STATUS-DESC = PC-VERIFIED                          19190005
192000         PERFORM 4217-CHECK-IF-ADJUSTED                           19200005
192100             IF PV-DB2-COUNT > ZERO                               19210005
192200                 MOVE PC-VERIF-ADJ TO ASC-RCVR-STATUS             19220005
192300                 SET ASC-ADJUSTED-PO TO TRUE                      19230005
192400             ELSE                                                 19240005
192500                 MOVE STATCD-STATUS-DESC TO                       19250005
192600                            ASC-RCVR-STATUS                       19260005
192700             END-IF                                               19270005
192800     ELSE                                                         19280005
192900         MOVE STATCD-STATUS-DESC       TO ASC-RCVR-STATUS         19290005
193000     END-IF.                                                      19300005
193100                                                                  19310005
193200*  RCVR CREATOR                                                   19320005
193300     MOVE RECEIV-CRE-UID           TO ASC-RCVR-CREATOR.           19330005
193400                                                                  19340005
193500*  REC CLERK ID                                                   19350005
193600     MOVE RECEIV-RCVG-CLERK-INIT-ID TO ASC-REC-CLERK              19360005
193700                                                                  19370005
193800*  DOCK AREA AND DOOR                                             19380005
193900     INITIALIZE DCLTSHPTPO                                        19390005
194000                DCLTVHTRIP                                        19400005
194100                DCLTVEHICL.                                       19410005
194200                                                                  19420005
194300     PERFORM 4220-GET-SHIPMENT-INFO.                              19430005
194400     MOVE VHTRIP-TRIP-ID           TO DK-TRIP-ID.                 19440005
196300                                                                  19630005
196400*  CARRIER                                                        19640005
196500     MOVE VHTRIP-OWNER-SCAC-ID     TO ASC-CARRIER.                19650005
196600     MOVE VHTRIP-TRIP-ID           TO ASC-TRIP.                   19660005
196700                                                                  19670005
196701* EFC SHIPMENT #                                                  19670121
196702     IF  ASC-TRIP > 0                                             19670221
196710         PERFORM 4225-GET-EFC-SHIPMENT                            19671021
196720     ELSE                                                         19672021
196730         MOVE SPACES  TO   ASC-EFC-SHIPMT                         19673021
196740     END-IF.                                                      19674021
196750                                                                  19675021
196800*  TRAILER NBR                                                    19680005
196900     IF DN-VEH-NBR = -1                                           19690005
197000         MOVE SPACES               TO ASC-TRAILER-NBR             19700005
197100     ELSE                                                         19710005
197200         MOVE VHTRIP-VEH-NBR       TO ASC-TRAILER-NBR             19720005
197300     END-IF.                                                      19730005
197400                                                                  19740005
197500*  PRO NUMBER                                                     19750005
197600*  BOL NUMBER                                                     19760005
197700     MOVE SHIPMT-PRO-NBR       TO ASC-PRO-NUMBER.                 19770005
197800     MOVE SHIPMT-BOL-NBR       TO ASC-BOL-NUMBER.                 19780005
198000     MOVE SHIPMT-CARR-AUTH-ID  TO ASC-CARR-AUTH-ID.               19800005
198200                                                                  19820005
198300*  VENDOR SHIP DATE                                               19830005
198400     IF  SHIPMT-VEND-SHIP-DTE = '0001-01-01'                      19840005
198500     OR  SHIPMT-VEND-SHIP-DTE = SPACES                            19850005
198600         MOVE SPACES               TO ASC-VDR-SHIP-DATE           19860005
198700     ELSE                                                         19870005
198800         MOVE SHIPMT-VEND-SHIP-DTE TO PV-DB2-DATE                 19880005
198900         MOVE PV-DB2-DATE-MM       TO PV-DISPLAY-DATE-MM          19890005
199000         MOVE PV-DB2-DATE-DD       TO PV-DISPLAY-DATE-DD          19900005
199100         MOVE PV-DB2-DATE-YY       TO PV-DISPLAY-DATE-YY          19910005
199200         MOVE PV-DISPLAY-DATE      TO ASC-VDR-SHIP-DATE           19920005
199300     END-IF.                                                      19930005
199400                                                                  19940005
199500*  CARRIER SHIP DATE                                              19950005
199600     IF  VHTRIP-OWNR-SCAC-SHIP-DTE = '0001-01-01'                 19960005
199700     OR  VHTRIP-OWNR-SCAC-SHIP-DTE = SPACES                       19970005
199800         MOVE SPACES               TO ASC-CARR-SHIP-DTE           19980005
199900     ELSE                                                         19990005
200000         MOVE VHTRIP-OWNR-SCAC-SHIP-DTE                           20000005
200100                                   TO PV-DB2-DATE                 20010005
200200         MOVE PV-DB2-DATE-MM       TO PV-DISPLAY-DATE-MM          20020005
200300         MOVE PV-DB2-DATE-DD       TO PV-DISPLAY-DATE-DD          20030005
200400         MOVE PV-DB2-DATE-YY       TO PV-DISPLAY-DATE-YY          20040005
200500         MOVE PV-DISPLAY-DATE      TO ASC-CARR-SHIP-DTE           20050005
200600     END-IF.                                                      20060005
200700                                                                  20070005
200800*  RECEIPT DATE                                                   20080005
200900     IF RECEIV-REC-TMST = '9999-09-09-09.09.09.999999'            20090005
201000        MOVE 'ENROUTE'             TO ASC-ARRIVAL-DATE            20100005
201100     ELSE                                                         20110005
201200        MOVE RECEIV-REC-TMST       TO PV-DB2-TIMESTAMP            20120005
201300        MOVE PV-DB2-TMST-MM        TO PV-DISPLAY-DATE-MM          20130005
201400        MOVE PV-DB2-TMST-DD        TO PV-DISPLAY-DATE-DD          20140005
201500        MOVE PV-DB2-TMST-YY        TO PV-DISPLAY-DATE-YY          20150005
201600        MOVE PV-DISPLAY-DATE       TO ASC-ARRIVAL-DATE.           20160005
201700                                                                  20170005
201800*  PROC AREA INFO (ASN)                                           20180005
201900     INITIALIZE DCLTPKSLIP.                                       20190005
202000                                                                  20200005
202100     PERFORM 4270-SELECT-SRCCDE-TPKSLIP.                          20210005
202200     MOVE PKSLIP-CRE-SRC-CDE       TO ASC-PROC-INFO-ASN.          20220005
202210     MOVE PKSLIP-BOL-NBR           TO ASC-PKSLIP-BOL-NBR.         20221015
202300                                                                  20230005
202400     PERFORM 4275-SELECT-CRETMST-TPKSLIP.                         20240005
202500*  TRANSCRIBE DATE AND TIME                                       20250005
202600     IF  SQLCODE = +0                                             20260005
202700         MOVE PKSLIP-CRE-TMST      TO PV-DB2-TIMESTAMP            20270005
202800         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  20280005
202900                '/'            DELIMITED BY SIZE                  20290005
203000                PV-DB2-TMST-DD DELIMITED BY SIZE                  20300005
203100                                 INTO ASC-TRANSCRIBE-DATE         20310005
203200         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 20320005
203300                ':'             DELIMITED BY SIZE                 20330005
203400                PV-DB2-TMST-MIN DELIMITED BY SIZE                 20340005
203500                                 INTO ASC-TRANSCRIBE-TIME         20350005
203600     ELSE                                                         20360005
203700         MOVE SPACES               TO ASC-TRANSCRIBE-DATE         20370005
203800                                      ASC-TRANSCRIBE-TIME         20380005
203900     END-IF.                                                      20390005
204000                                                                  20400005
204100*  PROC AREA INFO (HANGER INSERTION)                              20410005
204200     IF RECEIV-GOH-IND     = PC-Y                                 20420005
204300         MOVE 'HANGER        '     TO ASC-PROC-INFO-GOH           20430005
204400     ELSE                                                         20440005
204500         MOVE SPACES               TO ASC-PROC-INFO-GOH           20450005
204600     END-IF.                                                      20460005
204700                                                                  20470005
204800*  PROC AREA INFO (PRE-TICKETING)                                 20480005
204900     IF RECEIV-PRE-TKT-IND = PC-Y                                 20490005
205000         MOVE 'PRE-TICKET'         TO ASC-PROC-INFO-PRE           20500005
205100     ELSE                                                         20510005
205200         MOVE SPACES               TO ASC-PROC-INFO-PRE           20520005
205300     END-IF.                                                      20530005
205400                                                                  20540005
205500*  PROC AREA INFO (PACK BY STORE)                                 20550005
205600     IF RECEIV-PACK-BY-ST-IND = PC-Y                              20560005
205700         MOVE 'PACK-BY-STORE'      TO ASC-PROC-INFO-PACK          20570005
205800     ELSE                                                         20580005
205900         MOVE SPACES               TO ASC-PROC-INFO-PACK          20590005
206000     END-IF.                                                      20600005
206100                                                                  20610005
206200*  PROC AREA INFO (EDI)                                           20620005
206300     IF PURCHS-EDI-IND = PC-Y                                     20630005
206400         MOVE 'EDI'                TO ASC-PROC-INFO-EDI           20640005
206500     ELSE                                                         20650005
206600         MOVE SPACES               TO ASC-PROC-INFO-EDI           20660005
206700     END-IF.                                                      20670005
206800                                                                  20680005
207000     MOVE PURCHS-WHSE-RPLNT-IND    TO ASC-REPLENISH-IND.          20700005
207200                                                                  20720005
207300     PERFORM 4320-CHECK-PKSL-IND.                                 20730005
207400     IF PV-DB2-COUNT > ZERO                                       20740005
207500         MOVE 'DETAIL CHECK'       TO ASC-PROC-INFO-DET           20750005
207600     ELSE                                                         20760005
207700         MOVE SPACES               TO ASC-PROC-INFO-DET           20770005
207800     END-IF.                                                      20780005
207900                                                                  20790005
208000*  PROC AREA INFO (PACKAGE TYPE)                                  20800005
208010     MOVE  SPACE  TO  ASC-BULK-MIX-SKU-SW.                        20801024
208100     IF RECEIV-PKGNG-CDE      = 'B'                               20810005
208200         MOVE 'BULK'               TO ASC-PROC-INFO-PKG-TYP       20820005
208210         PERFORM 4235-CHECK-BULK-SINGLE-SKU                       20821024
208220         IF  PV-BULK-MULT-SKU > 1                                 20822024
208221             SET  ASC-BULK-MIX-SKU-YES  TO TRUE                   20822124
208222         ELSE                                                     20822224
208223             SET  ASC-BULK-MIX-SKU-NO   TO TRUE                   20822324
208240         END-IF                                                   20824024
208300     ELSE IF RECEIV-PKGNG-CDE = 'C'                               20830005
208400         MOVE 'CASE'               TO ASC-PROC-INFO-PKG-TYP       20840005
208500     ELSE IF RECEIV-PKGNG-CDE = 'I'                               20850005
208600         MOVE 'INNER'              TO ASC-PROC-INFO-PKG-TYP       20860005
208700     ELSE IF RECEIV-PKGNG-CDE = 'M'                               20870005
208800         MOVE 'MULTI'              TO ASC-PROC-INFO-PKG-TYP       20880005
208900     ELSE IF RECEIV-PKGNG-CDE = 'S'                               20890005
209000         MOVE 'SINGLE'             TO ASC-PROC-INFO-PKG-TYP       20900005
209100     ELSE                                                         20910005
209200         MOVE SPACES               TO ASC-PROC-INFO-PKG-TYP       20920005
209300     END-IF.                                                      20930005
209400                                                                  20940005
209500*  TICKET TYPE                                                    20950005
209700     MOVE ASC-DEPT                 TO DK-DEPT-NBR.                20970005
209900     PERFORM 4260-SELECT-TICKET-TYPE.                             20990005
210000                                                                  21000005
211200*  AP RCVR NBR                                                    21120005
211300     MOVE RECEIV-RCVR-NBR          TO ASC-RCVR-NBR.               21130005
211400                                                                  21140005
211500*  OPERATION SET AND DESCRIPTION                                  21150005
211600     IF  RECEIV-REC-TYP-CDE = 'EX'                                21160005
211700         MOVE ZEROES               TO ASC-OPER-SET-ID-N           21170005
211800         MOVE 'EXPENSE RECEIPT'    TO ASC-OPER-SET-DESC           21180005
211900     ELSE                                                         21190005
212000         PERFORM 4280-GET-OPER-SET-DESC                           21200005
212100         MOVE WRKORD-OPER-SET-ID   TO ASC-OPER-SET-ID-N           21210005
212200         MOVE OPRSET-OPER-SET-DESC TO ASC-OPER-SET-DESC           21220005
212300     END-IF.                                                      21230005
212400                                                                  21240005
212500     INITIALIZE PV-DB2-COUNT.                                     21250005
212600     MOVE RECEIV-OPER-UNT-ID       TO PV-OPER-UNT-ID.             21260005
212700     MOVE PV-OPER-UNT-ID-X         TO DK-STORE-NMBR.              21270005
212800     PERFORM 4290-CHECK-DIRECT-STORE.                             21280005
212900     IF  XL071-NO-ERRORS AND XL071-LOC-TYP-CDE = 'DS'             21290005
213000         MOVE RECEIV-OPER-UNT-ID   TO ASC-OPER-SET-ID-N           21300005
213100         MOVE 'DIRECT STORE SHIPMENT'                             21310005
213200                                   TO ASC-OPER-SET-DESC           21320005
213300     END-IF.                                                      21330005
213400                                                                  21340005
213500*  MARKING APRON LOCATION COUNT                                   21350005
213600     MOVE RECEIV-APRON-LOC-DESC    TO ASC-APRON-LOC-DESC.         21360005
213700                                                                  21370005
213800*  CARTON COUNT                                                   21380005
213900     MOVE RECEIV-EXPTED-CART-CNT   TO ASC-EXPTED-CART-CNT-N.      21390005
214000                                                                  21400005
214100*  ACTL CARTON COUNT                                              21410005
214200     MOVE RECEIV-ACTL-CART-CNT     TO ASC-ACTL-CART-CNT-N.        21420005
214300                                                                  21430005
214400*  DAMAGED CARTON COUNT                                           21440005
214500     MOVE SHPTPO-DMG-CART-CNT      TO ASC-DMG-CART-CNT-N.         21450005
214600                                                                  21460005
214700*  RECEIVER CREATE DATE AND TIME                                  21470005
214800     MOVE RECEIV-CRE-TMST          TO PV-DB2-TIMESTAMP.           21480005
214900     STRING PV-DB2-TMST-MM DELIMITED BY SIZE                      21490005
215000            '/'            DELIMITED BY SIZE                      21500005
215100            PV-DB2-TMST-DD DELIMITED BY SIZE                      21510005
215200                                   INTO ASC-RCV-CRE-DATE.         21520005
215300     STRING PV-DB2-TMST-HH DELIMITED BY SIZE                      21530005
215400            ':'             DELIMITED BY SIZE                     21540005
215500            PV-DB2-TMST-MIN DELIMITED BY SIZE                     21550005
215600                                   INTO ASC-RCV-CRE-TIME.         21560005
215700                                                                  21570005
215800*  MARKING APRON DATE AND TIME                                    21580005
215900     INITIALIZE DCLTRECITM.                                       21590005
216000     PERFORM 4240-GET-MARKING-INFO.                               21600005
216100     IF  SQLCODE = +0                                             21610005
216200         IF RECITM-MKING-APRON-TMST                               21620005
216300                            = '9999-09-09-09.09.09.999999'        21630005
216400             MOVE SPACES           TO ASC-MK-APRN-DATE            21640005
216500                                      ASC-MK-APRN-TIME            21650005
216600         ELSE                                                     21660005
216700             MOVE RECITM-MKING-APRON-TMST                         21670005
216800                                   TO PV-DB2-TIMESTAMP            21680005
216900             STRING PV-DB2-TMST-MM DELIMITED BY SIZE              21690005
217000                '/'            DELIMITED BY SIZE                  21700005
217100                PV-DB2-TMST-DD DELIMITED BY SIZE                  21710005
217200                                 INTO ASC-MK-APRN-DATE            21720005
217300             STRING PV-DB2-TMST-HH  DELIMITED BY SIZE             21730005
217400                ':'             DELIMITED BY SIZE                 21740005
217500                PV-DB2-TMST-MIN DELIMITED BY SIZE                 21750005
217600                                 INTO ASC-MK-APRN-TIME            21760005
217700         END-IF                                                   21770005
217800     ELSE                                                         21780005
217900         MOVE SPACES               TO ASC-MK-APRN-DATE            21790005
218000                                      ASC-MK-APRN-TIME            21800005
218100     END-IF.                                                      21810005
218200                                                                  21820005
218300                                                                  21830005
218400*  LAST CHANGE DATE AND TIME                                      21840005
218500     MOVE RECEIV-UPD-TMST          TO PV-DB2-TIMESTAMP            21850005
218600     STRING PV-DB2-TMST-MM DELIMITED BY SIZE                      21860005
218700            '/'            DELIMITED BY SIZE                      21870005
218800            PV-DB2-TMST-DD DELIMITED BY SIZE                      21880005
218900                                  INTO ASC-LAST-CHNG-DATE         21890005
219000     STRING PV-DB2-TMST-HH DELIMITED BY SIZE                      21900005
219100            ':'             DELIMITED BY SIZE                     21910005
219200            PV-DB2-TMST-MIN DELIMITED BY SIZE                     21920005
219300                                  INTO ASC-LAST-CHNG-TIME.        21930005
219400                                                                  21940005
219500*  SHIPPED DATE AND TIME IS ACTUALLY THE DATE AND TIME THAT THE   21950005
219600*  RECEIVER WAS VERIFIED.                                         21960005
219700     IF  RECEIV-VERFYD-TMST = '9999-09-09-09.09.09.999999'        21970005
219800         MOVE SPACES               TO ASC-PCS-VER-DATE            21980005
219900         MOVE SPACES               TO ASC-PCS-VER-TIME            21990005
220000     ELSE                                                         22000005
220100         MOVE RECEIV-VERFYD-TMST   TO PV-DB2-TIMESTAMP            22010005
220200         STRING PV-DB2-TMST-MM DELIMITED BY SIZE                  22020005
220300                '/'            DELIMITED BY SIZE                  22030005
220400                PV-DB2-TMST-DD DELIMITED BY SIZE                  22040005
220500                                 INTO ASC-PCS-VER-DATE            22050005
220600         STRING PV-DB2-TMST-HH  DELIMITED BY SIZE                 22060005
220700                ':'             DELIMITED BY SIZE                 22070005
220800                PV-DB2-TMST-MIN DELIMITED BY SIZE                 22080005
220900                                 INTO ASC-PCS-VER-TIME            22090005
221000     END-IF.                                                      22100005
221100                                                                  22110005
221200*  CHANGD BY                                                      22120005
221300     MOVE RECEIV-UPD-UID           TO ASC-CHANGD-BY.              22130005
221400                                                                  22140005
221500*  VERIFIED BY                                                    22150005
221600     MOVE RECEIV-VRFD-USR-ID       TO ASC-VRFD-USR-UID            22160005
221700                                                                  22170005
221800*  PCS INVCD AND VERFD                                            22180005
221900     INITIALIZE PA-INVOICED-COUNT                                 22190005
222000                PA-EXPECTED-COUNT                                 22200005
222100                PA-AP-VERIFIED-COUNT.                             22210005
222200                                                                  22220005
222300     PERFORM 4230-SUM-QTY.                                        22230005
222400                                                                  22240005
222500     MOVE PA-EXPECTED-COUNT        TO ASC-PCS-EXPECTED            22250005
222600*                                                                 22260005
222700     IF  RECEIV-STATUS-CDE = 'VE'                                 22270005
222800         MOVE PA-AP-VERIFIED-COUNT TO ASC-PCS-VERFD-N             22280005
222900     ELSE                                                         22290005
223000         MOVE SPACES               TO ASC-PCS-VERFD               22300005
223100     END-IF.                                                      22310005
223200                                                                  22320005
223300*    INVOICED PIECES                                              22330005
223400     PERFORM 7050-GET-INVOICED-PCS.                               22340005
223500     MOVE PA-INVOICED-COUNT        TO ASC-PCS-INVCD-N.            22350005
223600                                                                  22360005
223700*  FREE ASTRAY INDICATOR                                          22370005
223800                                                                  22380005
223900     IF  RECEIV-FRE-ASTRA-IND  = 'Y'                              22390005
224000         MOVE 'F/A'                TO ASC-FRE-ASTRA-IND           22400005
224100     ELSE                                                         22410005
224200         MOVE SPACES               TO ASC-FRE-ASTRA-IND           22420005
224300     END-IF.                                                      22430005
224400                                                                  22440005
224500/                                                                 22450005
224600*----------------------------------------------------------------*22460005
224700* CHECK IF PO/RECEIVER WAS ADJUSTED AFTER VERIFICATION           *22470005
224800*----------------------------------------------------------------*22480005
224900                                                                  22490005
225000 4217-CHECK-IF-ADJUSTED.                                          22500005
225100     MOVE ZERO                    TO PV-DB2-COUNT.                22510005
225200                                                                  22520005
225300         EXEC SQL                                                 22530005
225400              SELECT COUNT(*)                                     22540005
225500                INTO :PV-DB2-COUNT :PV-NULL-IND                   22550005
225600                FROM TAURECD A                                    22560005
225700               WHERE A.ORD_NBR       = :DK-PO-NBR                 22570005
225800                 AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR            22580005
225900                 AND NOT A.AUD_FUNC_CDE  = :PC-T                  22590005
226000                AND (A.UPD_PGM_ID    = :PC-RCKCS279               22600005
226100                  OR A.UPD_PGM_ID    = :PC-RCKCS280               22610005
226200                  OR A.UPD_PGM_ID    = :PC-RCKPV818               22620005
226300                  OR A.UPD_PGM_ID    = :PC-RCKPV819               22630005
226400                  OR A.UPD_PGM_ID    = :PC-RCKPV820               22640005
226500                  OR A.UPD_PGM_ID    = :PC-SUKPV702)              22650005
226510         WITH UR                                                  22651029
226600         END-EXEC                                                 22660005
226700                                                                  22670005
226800         EVALUATE TRUE                                            22680005
226900             WHEN SQLCODE = +0                                    22690005
227000             WHEN SQLCODE = +100                                  22700005
227100                 CONTINUE                                         22710005
227200                                                                  22720005
227300             WHEN SQLWARN0 NOT = SPACES                           22730005
227400             WHEN SQLCODE < +0                                    22740005
227500             WHEN SQLCODE > +0                                    22750005
227600                  MOVE '4217-CHECK-IF-ADJUSTED'                   22760005
227700                                  TO DP013-PARAGRAPH              22770005
227800                  MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'        22780005
227900                                  TO DP013-MESSAGE-TEXT (1)       22790005
228000                  MOVE SQLCA      TO DP013-SQLCA                  22800005
228100                  MOVE 'TAURECD ' TO DP013-DB2-TABLE-NAME (1)     22810005
228200                  SET DP013-DB2-ABEND                             22820005
228300                      DP013-XCTL-DISPLAY-RESTART                  22830005
228400                                  TO TRUE                         22840005
228500                  PERFORM DP013-0000-PROCESS-ABEND                22850005
228600         END-EVALUATE.                                            22860005
228700/                                                                 22870005
228800*----------------------------------------------------------------*22880005
228900*    GET VEHICLE INFO                                            *22890005
229000*----------------------------------------------------------------*22900005
229100 4220-GET-SHIPMENT-INFO.                                          22910005
229200                                                                  22920005
229300     MOVE 'N' TO ASC-MULT-SHIP-SW.                                22930005
229400                                                                  22940005
229600     PERFORM                                                      22960005
229700         WITH TEST AFTER                                          22970005
229800         VARYING PV-RETRY-COUNTER                                 22980005
229900         FROM 1 BY 1                                              22990005
230000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23000005
230100            OR (SQLCODE = +0)                                     23010005
230200            OR (SQLCODE = +100)                                   23020005
230300            OR (SQLCODE = -305)                                   23030005
230400            OR (SQLCODE = -811))                                  23040005
230500                                                                  23050005
230600          EXEC SQL                                                23060005
230700             SELECT  DISTINCT                                     23070005
230800                     A.DMG_CART_CNT                               23080005
230900                    ,C.OWNER_SCAC_ID                              23090005
231000                    ,C.VEH_NBR                                    23100005
231100                    ,C.OWNR_SCAC_SHIP_DTE                         23110005
231200                    ,C.TRIP_ID                                    23120005
231300                    ,B.PRO_NBR                                    23130005
231400                    ,B.BOL_NBR                                    23140005
231500                    ,B.VEND_SHIP_DTE                              23150005
231600                    ,B.CARR_AUTH_ID                               23160005
231700               INTO :SHPTPO-DMG-CART-CNT                          23170005
231800                   ,:VHTRIP-OWNER-SCAC-ID                         23180005
231900                   ,:VHTRIP-VEH-NBR :DN-VEH-NBR                   23190005
232000                   ,:VHTRIP-OWNR-SCAC-SHIP-DTE                    23200005
232100                   ,:VHTRIP-TRIP-ID                               23210005
232200                   ,:SHIPMT-PRO-NBR                               23220005
232300                   ,:SHIPMT-BOL-NBR                               23230005
232400                   ,:SHIPMT-VEND-SHIP-DTE                         23240005
232500                   ,:SHIPMT-CARR-AUTH-ID                          23250005
232600               FROM  TSHPTPO A                                    23260005
232700                    ,TSHIPMT B                                    23270005
232800                    ,TVHTRIP C                                    23280005
232900           WHERE A.PO_NBR      = :DK-PO-NBR                       23290005
233000             AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                  23300005
233100             AND A.SHIPT_ID        = B.SHIPT_ID                   23310005
233200             AND B.TRIP_ID         = C.TRIP_ID                    23320005
233210         WITH UR                                                  23321029
233300          END-EXEC                                                23330005
233400                                                                  23340005
233500          EVALUATE TRUE                                           23350005
233600              WHEN SQLCODE = +0                                   23360005
233601                   CONTINUE                                       23360121
233620                                                                  23362017
233700              WHEN SQLCODE = +100                                 23370005
233800              WHEN SQLCODE = -904                                 23380005
233900              WHEN SQLCODE = -913                                 23390005
233910                   MOVE ZEROES  TO  SHPTPO-DMG-CART-CNT           23391017
233911                                    VHTRIP-TRIP-ID                23391117
233920                   MOVE SPACES  TO  VHTRIP-OWNER-SCAC-ID          23392017
233930                                    VHTRIP-VEH-NBR                23393017
233940                                    VHTRIP-OWNR-SCAC-SHIP-DTE     23394017
233960                                    SHIPMT-PRO-NBR                23396017
233970                                    SHIPMT-BOL-NBR                23397017
233980                                    SHIPMT-VEND-SHIP-DTE          23398017
233990                                    SHIPMT-CARR-AUTH-ID           23399017
234100                                                                  23410005
234200              WHEN SQLCODE = -811                                 23420005
234300                 SET ASC-MULT-SHIP TO TRUE                        23430005
234400              WHEN SQLWARN0 NOT = SPACE                           23440005
234500              WHEN SQLCODE < +0                                   23450005
234600              WHEN SQLCODE > +0                                   23460005
234700                  MOVE '4220-GET-SHIPMENT-INFO'                   23470005
234800                                  TO DP013-PARAGRAPH              23480005
234900                  MOVE 'SELECT SHIPMENT INFO'                     23490005
235000                                  TO DP013-MESSAGE-TEXT (1)       23500005
235100                  MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)       23510005
235200                  MOVE DK-REC-SEQ-NBR                             23520005
235300                                  TO DP013-MESSAGE-TEXT (3)       23530005
235400                  MOVE SQLCA      TO DP013-SQLCA                  23540005
235500                  MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)     23550005
235600                  MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)     23560005
235700                  MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (3)     23570005
235800                  SET DP013-DB2-ABEND                             23580005
235900                                  TO TRUE                         23590005
236000                  SET DP013-XCTL-DISPLAY-RESTART                  23600005
236100                                  TO TRUE                         23610005
236200                  PERFORM DP013-0000-PROCESS-ABEND                23620005
236300          END-EVALUATE                                            23630005
236400     END-PERFORM                                                  23640005
236500                                                                  23650005
236600      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                       23660005
236700          AND (SQLCODE = -904 OR -913)                            23670005
236800          MOVE '4220-GET-SHIPMENT INFO'                           23680005
236900                                  TO DP013-PARAGRAPH              23690005
237000          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'    23700005
237100                                  TO DP013-MESSAGE-TEXT (1)       23710005
237200          MOVE 'SHIPMENT INFO'                                    23720005
237300                                  TO DP013-MESSAGE-TEXT (2)       23730005
237400          MOVE SQLCA              TO DP013-SQLCA                  23740005
237500          MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)     23750005
237600          MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (2)     23760005
237700          MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (3)     23770005
237800          SET DP013-DB2-ABEND     TO TRUE                         23780005
237900          SET DP013-XCTL-DISPLAY-RESTART                          23790005
238000                                  TO TRUE                         23800005
238100          PERFORM DP013-0000-PROCESS-ABEND                        23810005
238200      END-IF.                                                     23820005
238300                                                                  23830005
238400     IF ASC-MULT-SHIP                                             23840005
238500        PERFORM 4221-GET-PRIM-SHIP                                23850005
238600     END-IF.                                                      23860005
238700/                                                                 23870005
238800*----------------------------------------------------------------*23880005
238900*    CHECK IF THE MULTIPLE SHIPMENTS ARE WITHIN THE SAME SCAC.   *23890005
239000*----------------------------------------------------------------*23900005
239100 4221-GET-PRIM-SHIP.                                              23910005
239200                                                                  23920005
239400     PERFORM                                                      23940005
239500         WITH TEST AFTER                                          23950005
239600         VARYING PV-RETRY-COUNTER                                 23960005
239700         FROM 1 BY 1                                              23970005
239800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23980005
239900            OR (SQLCODE = +0)                                     23990005
240000            OR (SQLCODE = +100)                                   24000005
240100            OR (SQLCODE = -811))                                  24010005
240200                                                                  24020005
240300         EXEC SQL                                                 24030005
240400              SELECT A.DMG_CART_CNT                               24040005
240500                    ,C.OWNER_SCAC_ID                              24050005
240600                    ,C.VEH_NBR                                    24060005
240700                    ,C.OWNR_SCAC_SHIP_DTE                         24070005
240800                    ,C.TRIP_ID                                    24080005
240900                    ,B.PRO_NBR                                    24090005
241000                    ,B.BOL_NBR                                    24100005
241100                    ,B.VEND_SHIP_DTE                              24110005
241200                    ,B.CARR_AUTH_ID                               24120005
241300               INTO :SHPTPO-DMG-CART-CNT                          24130005
241400                   ,:VHTRIP-OWNER-SCAC-ID                         24140005
241500                   ,:VHTRIP-VEH-NBR :DN-VEH-NBR                   24150005
241600                   ,:VHTRIP-OWNR-SCAC-SHIP-DTE                    24160005
241700                   ,:VHTRIP-TRIP-ID                               24170005
241800                   ,:SHIPMT-PRO-NBR                               24180005
241900                   ,:SHIPMT-BOL-NBR                               24190005
242000                   ,:SHIPMT-VEND-SHIP-DTE                         24200005
242100                   ,:SHIPMT-CARR-AUTH-ID                          24210005
242200                FROM TSHPTPO A                                    24220005
242300                    ,TSHIPMT B                                    24230005
242400                    ,TVHTRIP C                                    24240005
242500               WHERE A.PO_NBR      = :DK-PO-NBR                   24250005
242600                 AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR              24260005
242700                 AND A.SHIPT_ID = B.SHIPT_ID                      24270005
242800                 AND B.TRIP_ID  = C.TRIP_ID                       24280005
242900                 AND A.PRIM_SHIPT_IND = 'Y'                       24290005
242910         WITH UR                                                  24291029
243000         END-EXEC                                                 24300005
243100                                                                  24310005
243200                                                                  24320005
243300          EVALUATE TRUE                                           24330005
243400              WHEN SQLCODE = +0                                   24340005
243401                  CONTINUE                                        24340117
243402                                                                  24340217
243420              WHEN SQLCODE = +100                                 24342017
243430              WHEN SQLCODE = -904                                 24343017
243440              WHEN SQLCODE = -913                                 24344017
243450                   MOVE ZEROES  TO  SHPTPO-DMG-CART-CNT           24345017
243460                                    VHTRIP-TRIP-ID                24346017
243470                   MOVE SPACES  TO  VHTRIP-OWNER-SCAC-ID          24347017
243480                                    VHTRIP-VEH-NBR                24348017
243490                                    VHTRIP-OWNR-SCAC-SHIP-DTE     24349017
243491                                    SHIPMT-PRO-NBR                24349117
243492                                    SHIPMT-BOL-NBR                24349217
243493                                    SHIPMT-VEND-SHIP-DTE          24349317
243494                                    SHIPMT-CARR-AUTH-ID           24349417
243496                                                                  24349617
243900                                                                  24390005
244000              WHEN SQLWARN0 NOT = SPACE                           24400005
244100              WHEN SQLCODE < +0                                   24410005
244200              WHEN SQLCODE > +0                                   24420005
244300                  MOVE '4221-GET-PRIM-SHIP   '                    24430005
244400                                  TO DP013-PARAGRAPH              24440005
244500                  MOVE 'GET PRIMARY SHIPMENT   '                  24450005
244600                                  TO DP013-MESSAGE-TEXT (1)       24460005
244700                  MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)       24470005
244800                  MOVE DK-REC-SEQ-NBR                             24480005
244900                                  TO DP013-MESSAGE-TEXT (3)       24490005
245000                  MOVE SQLCA      TO DP013-SQLCA                  24500005
245100                  MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)     24510005
245200                  MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)     24520005
245300                  MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (3)     24530005
245400                  SET DP013-DB2-ABEND                             24540005
245500                                  TO TRUE                         24550005
245600                  SET DP013-XCTL-DISPLAY-RESTART                  24560005
245700                                  TO TRUE                         24570005
245800                  PERFORM DP013-0000-PROCESS-ABEND                24580005
245900          END-EVALUATE                                            24590005
246000     END-PERFORM                                                  24600005
246100                                                                  24610005
246200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24620005
246300         AND (SQLCODE = -904 OR -913)                             24630005
246400         MOVE '4221-GET-PRIM-SHIP   '                             24640005
246500                                 TO DP013-PARAGRAPH               24650005
246600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     24660005
246700                                 TO DP013-MESSAGE-TEXT (1)        24670005
246800         MOVE 'PRIMARY SHIPMENT'                                  24680005
246900                                 TO DP013-MESSAGE-TEXT (2)        24690005
247000         MOVE SQLCA              TO DP013-SQLCA                   24700005
247100         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      24710005
247200         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (2)      24720005
247300         MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (3)      24730005
247400         SET DP013-DB2-ABEND     TO TRUE                          24740005
247500         SET DP013-XCTL-DISPLAY-RESTART                           24750005
247600                                 TO TRUE                          24760005
247700         PERFORM DP013-0000-PROCESS-ABEND                         24770005
247800     END-IF.                                                      24780005
247900/                                                                 24790005
247910*----------------------------------------------------------------*24791018
247920*    GET EFC SHIPMENT INFORMATION                                *24792018
247930*----------------------------------------------------------------*24793018
247940 4225-GET-EFC-SHIPMENT.                                           24794018
247950                                                                  24795018
247960     MOVE ASC-TRIP  TO  WST00001-INTR-TRIP-ID.                    24796018
247970                                                                  24797018
247990     PERFORM                                                      24799018
247991         WITH TEST AFTER                                          24799118
247992         VARYING PV-RETRY-COUNTER                                 24799218
247993         FROM 1 BY 1                                              24799318
247994         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24799418
247995            OR (SQLCODE = +0)                                     24799518
247996            OR (SQLCODE = +100)                                   24799618
247997            OR (SQLCODE = -305)                                   24799718
247998            OR (SQLCODE = -811))                                  24799818
247999                                                                  24799918
248000          EXEC SQL                                                24800018
248001             SELECT  DISTINCT (SUBSTR(EXT_SHP_ID,1,10))           24800118
248011               INTO :ASC-EFC-SHIPMT                               24801118
248020               FROM  WST_SHPMT_XREF_HDR                           24802018
248023              WHERE  INTR_TRIP_ID = :WST00001-INTR-TRIP-ID        24802318
248024         WITH UR                                                  24802429
248027          END-EXEC                                                24802718
248028                                                                  24802818
248029          EVALUATE TRUE                                           24802918
248030              WHEN SQLCODE = +0                                   24803018
248031                  CONTINUE                                        24803118
248032                                                                  24803218
248034              WHEN SQLCODE = +100                                 24803418
248035              WHEN SQLCODE = -904                                 24803518
248036              WHEN SQLCODE = -913                                 24803618
248039                   MOVE SPACES  TO  ASC-EFC-SHIPMT                24803918
248047                                                                  24804718
248048              WHEN SQLCODE = -811                                 24804818
248049                   MOVE 'MULTIPLE' TO  ASC-EFC-SHIPMT             24804918
248051              WHEN SQLWARN0 NOT = SPACE                           24805118
248052              WHEN SQLCODE < +0                                   24805218
248053              WHEN SQLCODE > +0                                   24805318
248054                  MOVE '4225-GET-EFC-SHIPMENT'                    24805418
248055                                  TO DP013-PARAGRAPH              24805518
248056                  MOVE 'SELECT EFC SHIPMENT INFO'                 24805618
248057                                  TO DP013-MESSAGE-TEXT (1)       24805718
248058                  MOVE DK-PO-NBR  TO DP013-MESSAGE-TEXT (2)       24805818
248059                  MOVE DK-REC-SEQ-NBR                             24805918
248060                                  TO DP013-MESSAGE-TEXT (3)       24806018
248061                  MOVE SQLCA      TO DP013-SQLCA                  24806118
248062                  MOVE 'WST00001' TO DP013-DB2-TABLE-NAME (1)     24806218
248065                  SET DP013-DB2-ABEND                             24806518
248066                                  TO TRUE                         24806618
248067                  SET DP013-XCTL-DISPLAY-RESTART                  24806718
248068                                  TO TRUE                         24806818
248069                  PERFORM DP013-0000-PROCESS-ABEND                24806918
248070          END-EVALUATE                                            24807018
248071     END-PERFORM                                                  24807118
248072                                                                  24807218
248073      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                       24807318
248074          AND (SQLCODE = -904 OR -913)                            24807418
248075          MOVE '4220-GET-SHIPMENT INFO'                           24807518
248076                                  TO DP013-PARAGRAPH              24807618
248077          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'    24807718
248078                                  TO DP013-MESSAGE-TEXT (1)       24807818
248079          MOVE 'SHIPMENT INFO'                                    24807918
248080                                  TO DP013-MESSAGE-TEXT (2)       24808018
248081          MOVE SQLCA              TO DP013-SQLCA                  24808118
248082          MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)     24808218
248083          MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (2)     24808318
248084          MOVE 'TVHTRIP'          TO DP013-DB2-TABLE-NAME (3)     24808418
248085          SET DP013-DB2-ABEND     TO TRUE                         24808518
248086          SET DP013-XCTL-DISPLAY-RESTART                          24808618
248087                                  TO TRUE                         24808718
248088          PERFORM DP013-0000-PROCESS-ABEND                        24808818
248089      END-IF.                                                     24808918
248090                                                                  24809018
248091*----------------------------------------------------------------*24809105
248100*    SUM THE LINE ITEM QUANTITIES                                *24810005
248200*----------------------------------------------------------------*24820005
248300 4230-SUM-QTY.                                                    24830005
248400                                                                  24840005
248500     PERFORM                                                      24850005
248600         WITH TEST AFTER                                          24860005
248700         VARYING PV-RETRY-COUNTER                                 24870005
248800         FROM 1 BY 1                                              24880005
248900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24890005
249000            OR (SQLCODE = +0)                                     24900005
249100            OR (SQLCODE = -305))                                  24910005
249200                                                                  24920005
249300         EXEC SQL                                                 24930005
249400            SELECT  SUM(EXPTED_ITM_QTY)                           24940005
249500                   ,SUM(AP_VERIFY_ITM_QTY)                        24950005
249600              INTO :PA-EXPECTED-COUNT                             24960005
249700                  ,:PA-AP-VERIFIED-COUNT                          24970005
249800              FROM  TRECDIS                                       24980005
249900            WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                24990005
250000              AND FCLTY_ID       = :DK-FCLTY-ID                   25000005
250100              AND ORD_NBR        = :DK-PO-NBR                     25010005
250200              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                25020005
250310         WITH UR                                                  25031029
250400         END-EXEC                                                 25040005
250500                                                                  25050005
250600         EVALUATE TRUE                                            25060005
250700             WHEN SQLCODE = +0                                    25070005
250800             WHEN SQLCODE = -305                                  25080005
250900             WHEN SQLCODE = -904                                  25090005
251000             WHEN SQLCODE = -913                                  25100005
251100                 CONTINUE                                         25110005
251200                                                                  25120005
251300             WHEN SQLWARN0 NOT = SPACE                            25130005
251400             WHEN SQLCODE < +0                                    25140005
251500             WHEN SQLCODE > +0                                    25150005
251600                 MOVE '4230-SUM-QTY'                              25160005
251700                                 TO DP013-PARAGRAPH               25170005
251800                 MOVE 'SELECT ON TRECDIS'                         25180005
251900                                 TO DP013-MESSAGE-TEXT (1)        25190005
252000                 MOVE SQLCA      TO DP013-SQLCA                   25200005
252100                 MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME (1)      25210005
252200                 SET DP013-DB2-ABEND                              25220005
252300                                 TO TRUE                          25230005
252400                 SET DP013-XCTL-DISPLAY-RESTART                   25240005
252500                                 TO TRUE                          25250005
252600                 PERFORM DP013-0000-PROCESS-ABEND                 25260005
252700         END-EVALUATE                                             25270005
252800     END-PERFORM.                                                 25280005
252900                                                                  25290005
253000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25300005
253100             AND (SQLCODE = -904 OR -913)                         25310005
253200         MOVE '4230-SUM-QTY'                                      25320005
253300                                 TO DP013-PARAGRAPH               25330005
253400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25340005
253500                                 TO DP013-MESSAGE-TEXT (1)        25350005
253600         MOVE 'REC ITEM QTY INFO'                                 25360005
253700                                 TO DP013-MESSAGE-TEXT (2)        25370005
253800         MOVE SQLCA              TO DP013-SQLCA                   25380005
253900         MOVE 'TRECDIS'          TO DP013-DB2-TABLE-NAME (1)      25390005
254000         SET DP013-DB2-ABEND     TO TRUE                          25400005
254100         SET DP013-XCTL-DISPLAY-RESTART                           25410005
254200                                 TO TRUE                          25420005
254300         PERFORM DP013-0000-PROCESS-ABEND                         25430005
254400     END-IF.                                                      25440005
254500                                                                  25450005
254501                                                                  25450124
254510*----------------------------------------------------------------*25451024
254520* CHECK BULK RECEIVER HAS ONLY SINGLE SKU CARTONS                *25452024
254530*----------------------------------------------------------------*25453024
254540 4235-CHECK-BULK-SINGLE-SKU.                                      25454024
254550                                                                  25455024
254560     MOVE  ZEROES  TO  PV-BULK-MULT-SKU.                          25456024
254570                                                                  25457024
254580     PERFORM                                                      25458024
254590         WITH TEST AFTER                                          25459024
254591         VARYING PV-RETRY-COUNTER                                 25459124
254592         FROM 1 BY 1                                              25459224
254593         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25459324
254594            OR (SQLCODE = +0)                                     25459424
254595            OR (SQLCODE = -811)                                   25459524
254596            OR (SQLCODE = +100))                                  25459624
254597                                                                  25459724
254598         EXEC SQL                                                 25459824
254599              SELECT D.SHIPT_UNT_ID                               25459924
254600                   , COUNT(DISTINCT(D.TRN_LNE_NBR))               25460024
254601                INTO :SHUUPC-SHIPT-UNT-ID                         25460124
254602                   , :PV-BULK-MULT-SKU                            25460224
254604                FROM TPKSLIP B                                    25460424
254605                   , TINPKSU C                                    25460524
254606                   , TSHUUPC D                                    25460624
254610               WHERE B.PO_NBR        = :DK-PO-NBR                 25461026
254611                 AND B.REC_SEQ_NBR   = :DK-REC-SEQ-NBR            25461124
254612                 AND B.PO_NBR        =  C.PO_NBR                  25461224
254613                 AND B.SEQ_NBR       =  C.SEQ_NBR                 25461324
254614                 AND C.SHIPT_UNT_ID  =  D.SHIPT_UNT_ID            25461424
254615               GROUP BY D.SHIPT_UNT_ID                            25461524
254616               HAVING COUNT(DISTINCT(D.TRN_LNE_NBR)) > 1          25461624
254617               FETCH FIRST 1 ROW ONLY                             25461724
254618           WITH UR                                                25461824
254619         END-EXEC                                                 25461924
254620                                                                  25462024
254621         EVALUATE TRUE                                            25462124
254622             WHEN SQLCODE = +0                                    25462224
254623             WHEN SQLCODE = +100                                  25462324
254624             WHEN SQLCODE = -811                                  25462424
254625             WHEN SQLCODE = -904                                  25462524
254626             WHEN SQLCODE = -913                                  25462624
254627                 CONTINUE                                         25462724
254628                                                                  25462824
254629             WHEN SQLWARN0 NOT = SPACE                            25462924
254630             WHEN SQLCODE < +0                                    25463024
254631             WHEN SQLCODE > +0                                    25463124
254632                 MOVE '4235-CHECK-BULK-SINGLE-SKU'                25463224
254633                                 TO DP013-PARAGRAPH               25463324
254634                 MOVE 'CHECK BULK FOR SINGLE SKU CARTONS'         25463424
254635                                 TO DP013-MESSAGE-TEXT (1)        25463524
254636                 MOVE SQLCA      TO DP013-SQLCA                   25463624
254638                 MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME (1)      25463824
254639                 MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME (2)      25463924
254640                 MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME (3)      25464024
254641                 SET DP013-DB2-ABEND                              25464124
254642                                 TO TRUE                          25464224
254643                 SET DP013-XCTL-DISPLAY-RESTART                   25464324
254644                                 TO TRUE                          25464424
254645                 PERFORM DP013-0000-PROCESS-ABEND                 25464524
254646         END-EVALUATE                                             25464624
254647     END-PERFORM.                                                 25464724
254648                                                                  25464824
254649     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25464924
254650         SQLCODE NOT = +0                                         25465024
254651         MOVE '4235-CHECK-BULK-SINGLE-SKU'                        25465124
254652                                 TO DP013-PARAGRAPH               25465224
254653         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25465324
254654                                 TO DP013-MESSAGE-TEXT (1)        25465424
254655         MOVE 'CHECK BULK FOR SINGLE SKU CARTONS'                 25465524
254656                                 TO DP013-MESSAGE-TEXT (2)        25465624
254657         MOVE SQLCA              TO DP013-SQLCA                   25465724
254659         MOVE 'TPKSLIP'          TO DP013-DB2-TABLE-NAME (1)      25465924
254660         MOVE 'TINPKSU'          TO DP013-DB2-TABLE-NAME (2)      25466024
254661         MOVE 'TSHUUPC'          TO DP013-DB2-TABLE-NAME (3)      25466124
254662         SET DP013-DB2-ABEND     TO TRUE                          25466224
254663         SET DP013-XCTL-DISPLAY-RESTART                           25466324
254664                                 TO TRUE                          25466424
254665         PERFORM DP013-0000-PROCESS-ABEND                         25466524
254666     END-IF.                                                      25466624
254667                                                                  25466724
254670/                                                                 25467005
254700*----------------------------------------------------------------*25470005
254800*    RETRIEVE THE MARKING DATE AND TIME                          *25480005
254900*----------------------------------------------------------------*25490005
255000 4240-GET-MARKING-INFO.                                           25500005
255100                                                                  25510005
255200     PERFORM                                                      25520005
255300         WITH TEST AFTER                                          25530005
255400         VARYING PV-RETRY-COUNTER                                 25540005
255500         FROM 1 BY 1                                              25550005
255600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25560005
255700            OR (SQLCODE = +0)                                     25570005
255800            OR (SQLCODE = -305))                                  25580005
255900                                                                  25590005
256000         EXEC SQL                                                 25600005
256100            SELECT  MIN(MKING_APRON_TMST)                         25610005
256300              INTO :RECITM-MKING-APRON-TMST                       25630005
256500              FROM  TRECITM                                       25650005
256600            WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                25660005
256700              AND FCLTY_ID       = :DK-FCLTY-ID                   25670005
256800              AND ORD_NBR        = :DK-PO-NBR                     25680005
256900              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                25690005
256910         WITH UR                                                  25691029
257000         END-EXEC                                                 25700005
257100                                                                  25710005
257200         EVALUATE TRUE                                            25720005
257300             WHEN SQLCODE = +0                                    25730005
257400             WHEN SQLCODE = -305                                  25740005
257500             WHEN SQLCODE = -904                                  25750005
257600             WHEN SQLCODE = -913                                  25760005
257700                 CONTINUE                                         25770005
257800                                                                  25780005
257900             WHEN SQLWARN0 NOT = SPACE                            25790005
258000             WHEN SQLCODE < +0                                    25800005
258100             WHEN SQLCODE > +0                                    25810005
258200                 MOVE '4240-GET-MARKING-INFO'                     25820005
258300                                 TO DP013-PARAGRAPH               25830005
258400                 MOVE 'SELECT ON TRECITM'                         25840005
258500                                 TO DP013-MESSAGE-TEXT (1)        25850005
258600                 MOVE SQLCA      TO DP013-SQLCA                   25860005
258700                 MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME (1)      25870005
258800                 SET DP013-DB2-ABEND                              25880005
258900                                 TO TRUE                          25890005
259000                 SET DP013-XCTL-DISPLAY-RESTART                   25900005
259100                                 TO TRUE                          25910005
259200                 PERFORM DP013-0000-PROCESS-ABEND                 25920005
259300         END-EVALUATE                                             25930005
259400     END-PERFORM.                                                 25940005
259500                                                                  25950005
259600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25960005
259700             AND (SQLCODE = -904 OR -913)                         25970005
259800         MOVE '4240-GET-MARKING-INFO'                             25980005
259900                                 TO DP013-PARAGRAPH               25990005
260000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26000005
260100                                 TO DP013-MESSAGE-TEXT (1)        26010005
260200         MOVE 'MARKING INFO     '                                 26020005
260300                                 TO DP013-MESSAGE-TEXT (2)        26030005
260400         MOVE SQLCA              TO DP013-SQLCA                   26040005
260500         MOVE 'TRECITM'          TO DP013-DB2-TABLE-NAME (1)      26050005
260600         SET DP013-DB2-ABEND     TO TRUE                          26060005
260700         SET DP013-XCTL-DISPLAY-RESTART                           26070005
260800                                 TO TRUE                          26080005
260900         PERFORM DP013-0000-PROCESS-ABEND                         26090005
261000     END-IF.                                                      26100005
261100                                                                  26110005
261200/                                                                 26120005
273200 4260-SELECT-TICKET-TYPE.                                         27320005
273300     PERFORM 4261-SELECT-ONE-TKT-FMT.                             27330005
273400     IF ASC-TKT-FMT-ID = SPACE                                    27340005
273500         SET PS-NO-CITM-FOUND TO TRUE                             27350005
273600     ELSE                                                         27360005
273700         IF ASC-TKT-DESC = 'MULTIPLE'                             27370005
273800             SET PS-CITM-FOUND TO TRUE                            27380005
273900         ELSE                                                     27390005
274000             PERFORM 4265-GET-TKT-DESC                            27400005
274100             SET PS-CITM-FOUND TO TRUE                            27410005
274200         END-IF                                                   27420005
274300     END-IF.                                                      27430005
274400     IF PS-NO-CITM-FOUND                                          27440005
274500         PERFORM 4262-SELECT-PRETIC-TKT-FMT                       27450005
274600           IF PS-PRETIC-FOUND                                     27460005
274700               CONTINUE                                           27470005
274800           ELSE                                                   27480005
274900               PERFORM 4266-GET-VSM-TKTTYPE                       27490005
275000               IF PS-VSM                                          27500005
275100                   MOVE VSCHVL-CHARTC-VAL-DESC                    27510005
275200                       TO ASC-TKT-DESC                            27520005
275300               ELSE                                               27530005
275400                   PERFORM 4268-SELECT-DEFAULT-TYPE               27540005
275500                   MOVE VSCHVL-CHARTC-VAL-DESC                    27550005
275600                       TO ASC-TKT-DESC                            27560005
275700               END-IF                                             27570005
275800          END-IF                                                  27580005
275900     END-IF.                                                      27590005
276000 4261-SELECT-ONE-TKT-FMT.                                         27600005
276100     EXEC SQL                                                     27610005
276200         SELECT MIN(TKT_FMT_ID)                                   27620005
276300              , MAX(TKT_FMT_ID)                                   27630005
276400             INTO :DK-TKT-FMT-ID-MIN  :DN-TKT-FMT-ID-MIN          27640005
276500                 ,:DK-TKT-FMT-ID-MAX  :DN-TKT-FMT-ID-MAX          27650005
276600             FROM                                                 27660005
276700              TRECITM                                             27670005
276800              WHERE                                               27680005
276900                  ORD_NBR =     :DK-PO-NBR                        27690005
277000              AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                   27700005
277010         WITH UR                                                  27701029
277100      END-EXEC                                                    27710005
277200         EVALUATE TRUE                                            27720005
277300             WHEN SQLCODE = +0                                    27730005
277400                  IF  DN-TKT-FMT-ID-MIN = -1                      27740005
277500                      MOVE SPACES        TO ASC-TKT-FMT-ID        27750005
277600                      SET PS-NO-CITM-FOUND TO TRUE                27760005
277700                  ELSE                                            27770005
277800                      IF DK-TKT-FMT-ID-MIN =                      27780005
277900                            DK-TKT-FMT-ID-MAX                     27790005
278000                           MOVE DK-TKT-FMT-ID-MIN                 27800005
278100                                         TO DK-TKT-FMT-ID         27810005
278200                                            ASC-TKT-FMT-ID        27820005
278300                            SET PS-CITM-FOUND TO TRUE             27830005
278400                        ELSE                                      27840005
278500                            MOVE 'MULTIPLE' TO ASC-TKT-DESC       27850005
278600                                               ASC-TKT-FMT-ID     27860005
278700                            SET PS-CITM-FOUND TO TRUE             27870005
278800                  END-IF                                          27880005
278900             END-IF                                               27890005
279000                                                                  27900005
279100             WHEN SQLCODE = +100                                  27910005
279200                  MOVE SPACES            TO ASC-TKT-FMT-ID        27920005
279300                  SET PS-NO-CITM-FOUND TO TRUE                    27930005
279400                                                                  27940005
279500             WHEN SQLCODE = -904                                  27950005
279600             WHEN SQLCODE = -913                                  27960005
279700                  CONTINUE                                        27970005
279800                                                                  27980005
279900             WHEN SQLWARN0 NOT = SPACES                           27990005
280000             WHEN SQLCODE < +0                                    28000005
280100             WHEN SQLCODE > +0                                    28010005
280200                  MOVE '4261-SELECT-TICKET-TYPE'                  28020005
280300                                  TO DP013-PARAGRAPH              28030005
280400                  MOVE 'UNSUCCESSFUL SELECT ON TRECITM TABLE'     28040031
280500                                  TO DP013-MESSAGE-TEXT (1)       28050005
280600                  MOVE SQLCA      TO DP013-SQLCA                  28060005
280700                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     28070031
280800                  SET DP013-DB2-ABEND                             28080005
280900                      DP013-XCTL-DISPLAY-RESTART                  28090005
281000                                  TO TRUE                         28100005
281100                  PERFORM DP013-0000-PROCESS-ABEND                28110005
281200     END-EVALUATE.                                                28120005
281300 4262-SELECT-PRETIC-TKT-FMT.                                      28130005
281400     EXEC SQL                                                     28140005
281500         SELECT MIN(TKT_DESC)                                     28150005
281600              , MAX(TKT_DESC)                                     28160005
281700             INTO :DK-TKT-DESC-MIN  :DN-TKT-DESC                  28170005
281800                , :DK-TKT-DESC-MAX  :DN-TKT-DESC                  28180005
281900             FROM                                                 28190005
282000              TPTKREQ A                                           28200005
282100            , TPTKLNE B                                           28210005
282200              WHERE                                               28220005
282300                   A.PO_NBR      =     :DK-PO-NBR                 28230005
282400              AND  A.PO_REQ_NBR  =   B.PO_REQ_NBR                 28240005
282410         WITH UR                                                  28241029
282500      END-EXEC                                                    28250005
282600         EVALUATE TRUE                                            28260005
282700             WHEN SQLCODE = +0                                    28270005
282800                  IF  DN-TKT-DESC   = -1                          28280005
282900                      MOVE SPACES        TO ASC-TKT-DESC          28290005
283000                      SET PS-NO-PRETIC-FOUND TO TRUE              28300005
283100                  ELSE                                            28310005
283200                      IF DK-TKT-DESC-MIN =                        28320005
283300                                  DK-TKT-DESC-MAX                 28330005
283400                          MOVE DK-TKT-DESC-MIN                    28340005
283500                                         TO ASC-TKT-DESC          28350005
283600                          SET PS-PRETIC-FOUND TO TRUE             28360005
283700                      ELSE                                        28370005
283800                          MOVE 'MULTIPLE' TO ASC-TKT-DESC         28380005
283900                          SET PS-PRETIC-FOUND TO TRUE             28390005
284000                      END-IF                                      28400005
284100                  END-IF                                          28410005
284200                                                                  28420005
284300             WHEN SQLCODE = +100                                  28430005
284400                  MOVE SPACES            TO ASC-TKT-DESC          28440005
284500                  SET PS-NO-PRETIC-FOUND TO TRUE                  28450005
284600                                                                  28460005
284700             WHEN SQLCODE = -904                                  28470005
284800             WHEN SQLCODE = -913                                  28480005
284900                  CONTINUE                                        28490005
285000                                                                  28500005
285100             WHEN SQLWARN0 NOT = SPACES                           28510005
285200             WHEN SQLCODE < +0                                    28520005
285300             WHEN SQLCODE > +0                                    28530005
285400                  MOVE '4120-SELECT-PRETIC-TKT-FMT'               28540005
285500                                  TO DP013-PARAGRAPH              28550005
285600                  MOVE 'UNSUCCESSFUL SELECT ON TPTKREQ TABLE'     28560005
285700                                  TO DP013-MESSAGE-TEXT (1)       28570005
285800                  MOVE SQLCA      TO DP013-SQLCA                  28580005
285900                  MOVE 'TPTKREQ ' TO DP013-DB2-TABLE-NAME (1)     28590031
285910                  MOVE 'TPTKLNE ' TO DP013-DB2-TABLE-NAME (2)     28591031
286000                  SET DP013-DB2-ABEND                             28600005
286100                      DP013-XCTL-DISPLAY-RESTART                  28610005
286200                                  TO TRUE                         28620005
286300                  PERFORM DP013-0000-PROCESS-ABEND                28630005
286400     END-EVALUATE.                                                28640005
286500 4265-GET-TKT-DESC.                                               28650005
286600      EXEC SQL                                                    28660005
286700          SELECT DISTINCT TKT_FMT_DESC                            28670005
286800                INTO :TKTFMT-TKT-FMT-DESC                         28680005
286900              FROM TTKTFMT                                        28690005
287000           WHERE                                                  28700005
287100              TKT_FMT_ID   = :DK-TKT-FMT-ID                       28710005
287110         WITH UR                                                  28711029
287200     END-EXEC                                                     28720005
287300                                                                  28730005
287400     EVALUATE TRUE                                                28740005
287500           WHEN SQLCODE = +0                                      28750005
287600             MOVE TKTFMT-TKT-FMT-DESC TO ASC-TKT-DESC             28760005
287700           WHEN SQLCODE = +100                                    28770005
287800                  MOVE SPACES    TO ASC-TKT-DESC                  28780005
287900             WHEN SQLCODE = -904                                  28790005
288000             WHEN SQLCODE = -911                                  28800005
288100             WHEN SQLCODE = -913                                  28810005
288200                  CONTINUE                                        28820005
288300             WHEN SQLWARN0 NOT = SPACES                           28830005
288400             WHEN SQLCODE  NOT = ZERO                             28840005
288500                  MOVE '4265-GET-TKT-DESC'                        28850005
288600                                 TO DP013-PARAGRAPH               28860005
288700                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'           28870005
288800                                 TO DP013-MESSAGE-TEXT (1)        28880005
288900                  MOVE DK-TKT-DESC                                28890005
289000                                 TO DP013-MESSAGE-TEXT (2)        28900005
289100                  MOVE SQLCA     TO DP013-SQLCA                   28910005
289200                  MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)      28920005
289300                  SET DP013-DB2-ABEND                             28930005
289400                      DP013-XCTL-DISPLAY-RESTART                  28940005
289500                                 TO TRUE                          28950005
289600                  PERFORM DP013-0000-PROCESS-ABEND                28960005
289700         END-EVALUATE.                                            28970005
289710                                                                  28971029
289720                                                                  28972029
289800 4266-GET-VSM-TKTTYPE.                                            28980005
289900     MOVE ENTNME-ENT-ID       TO DK-ENT-ID.                       28990005
290000                                                                  29000005
290100     MOVE   XL001-SUB-CL-NBR-2CH                                  29010005
290200                             TO  PV-SUBCLASS                      29020005
290500                                                                  29050005
290600     MOVE PV-SUBCLASS-NBR      TO  DK-SUBCLASS-NBR.               29060005
290700                                                                  29070005
290800     MOVE XL001-MAJ-CL-NBR-2CH TO  DK-MAJCLASS-NBR .              29080005
290900                                                                  29090005
291000     EXEC SQL                                                     29100005
291100         SELECT DISTINCT                                          29110005
291200              A.MDSEAR_DKEY,                                      29120005
291300              B.VS_ID,                                            29130005
291400              B.ENT_ID,                                           29140005
291500              B.EFF_BEG_DTE,                                      29150005
291600              B.EFF_END_DTE,                                      29160005
291700              C.TKT_TYP_SEQ_NBR,                                  29170005
291800              C.HNG_FOLD_SEQ_NBR,                                 29180005
291900              CURRENT_DATE                                        29190005
292000         INTO                                                     29200005
292100             :MDSEAR-DKEY,                                        29210005
292200             :VNDSTL-VS-ID,                                       29220005
292300             :VNDSTL-ENT-ID,                                      29230005
292400             :VNDSTL-EFF-BEG-DTE     :PV-NULL-IND,                29240005
292500             :VNDSTL-EFF-END-DTE     :PV-NULL-IND,                29250005
292600             :MDARVS-TKT-TYP-SEQ-NBR :PV-NULL-IND,                29260005
292700             :MDARVS-HNG-FOLD-SEQ-NBR :PV-NULL-IND,               29270005
292800             :PC-CURRENT-DATE                                     29280005
292900         FROM                                                     29290005
293000              TMDSEAR A                                           29300005
293100            , TVNDSTL B                                           29310005
293200            , TMDARVS C                                           29320005
293300         WHERE                                                    29330005
293400                 A.MDSELV_CDE = :PC-SUBCLASS-MDSELV-CDE           29340005
293600           AND   A.STRT_DTE  <=  CURRENT DATE                     29360005
293700           AND   A.END_DTE   >=  CURRENT DATE                     29370005
293900           AND   A.DEPT_NBR   = :DK-DEPT-NBR                      29390005
294000           AND   B.ENT_ID     = :DK-ENT-ID                        29400005
294100           AND   A.SUB_CL_NBR = :DK-SUBCLASS-NBR                  29410005
294200           AND   C.SUB_CL_MDSEAR_ID = A.MDSEAR_DKEY               29420005
294300           AND   B.VS_ID      = C.VS_ID                           29430005
294400           AND   C.ACTV_IND   = 'Y'                               29440005
294500           AND   B.EFF_BEG_DTE <= CURRENT_DATE                    29450005
294600           AND   B.EFF_END_DTE IS NULL                            29460005
294610         WITH UR                                                  29461029
294700         END-EXEC.                                                29470005
294800                                                                  29480005
294900         EVALUATE TRUE                                            29490005
295000             WHEN SQLCODE = ZERO                                  29500005
295100             WHEN SQLCODE = -811                                  29510005
295200                  MOVE MDARVS-TKT-TYP-SEQ-NBR TO                  29520005
295300                                            DK-TKT-TYP-SEQ-NBR    29530005
295400                  MOVE MDSEAR-DKEY TO DK-MDSEAR-ID                29540005
295500                  PERFORM  4269-SELECT-PRETIC-TYPE                29550005
295600             WHEN SQLCODE = +100                                  29560005
295700                  SET PS-NOT-VSM    TO TRUE                       29570005
295800             WHEN SQLCODE = -904                                  29580005
295900             WHEN SQLCODE = -911                                  29590005
296000             WHEN SQLCODE = -913                                  29600005
296100                  CONTINUE                                        29610005
296200             WHEN SQLWARN0 NOT = SPACE                            29620005
296300             WHEN SQLCODE NOT = ZERO                              29630005
296400                  MOVE '4266-GET-VSM-TKTTYPE'                     29640005
296500                                   TO DP013-PARAGRAPH             29650005
296600                  MOVE 'SELECT TICKET TYPE FROM VNDR STYLE TABLE' 29660005
296700                                   TO DP013-MESSAGE-TEXT (1)      29670005
296800                  MOVE SQLCA       TO DP013-SQLCA                 29680005
296900                  SET DP013-DB2-ABEND                             29690005
297000                                   TO TRUE                        29700005
297100                  PERFORM DP013-0000-PROCESS-ABEND                29710005
297200         END-EVALUATE.                                            29720005
297300 4269-SELECT-PRETIC-TYPE.                                         29730005
297400         EXEC SQL                                                 29740005
297500             SELECT                                               29750005
297600                     CHARTC_VAL_DESC                              29760005
297700             INTO                                                 29770005
297800                    :VSCHVL-CHARTC-VAL-DESC                       29780005
297900             FROM                                                 29790005
298000                    TDCVSVL A                                     29800005
298100                   ,TVSCHVL B                                     29810005
298200             WHERE                                                29820005
298300                   A.MDSEAR_ID      = :DK-MDSEAR-ID               29830005
298400               AND B.CHARTC_CDE     = :PC-VS-TICKET-TYPE-CDE      29840005
298500               AND A.PRIM_IND       = 'Y'                         29850005
298600               AND A.CHARTC_CDE     = B.CHARTC_CDE                29860005
298700               AND A.CHARTC_SEQ_NBR = :DK-TKT-TYP-SEQ-NBR         29870005
298800               AND A.CHARTC_SEQ_NBR = B.CHARTC_SEQ_NBR            29880005
298900               AND B.STAT_CDE       = 'A'                         29890005
298910         WITH UR                                                  29891029
299000         END-EXEC.                                                29900005
299100                                                                  29910005
299200                                                                  29920005
299300         EVALUATE TRUE                                            29930005
299400             WHEN SQLCODE = ZERO                                  29940005
299500                  MOVE  VSCHVL-CHARTC-VAL-DESC  TO                29950005
299600                       ASC-TKT-DESC                               29960005
299700                  SET PS-VSM   TO TRUE                            29970005
299800             WHEN SQLCODE = +100                                  29980005
299900                  SET PS-NOT-VSM    TO TRUE                       29990005
300000             WHEN SQLCODE = -904                                  30000005
300100             WHEN SQLCODE = -911                                  30010005
300200             WHEN SQLCODE = -913                                  30020005
300300                  CONTINUE                                        30030005
300400             WHEN SQLWARN0 NOT = SPACE                            30040005
300500             WHEN SQLCODE NOT = ZERO                              30050005
300600                  MOVE '7373-SELECT-PRETIC-TYPE'                  30060005
300700                                   TO DP013-PARAGRAPH             30070005
300800                  MOVE 'SELECT TICKET TYPE FROM VNDR STYLE TABLE' 30080005
300900                                   TO DP013-MESSAGE-TEXT (1)      30090005
301000                  MOVE SQLCA       TO DP013-SQLCA                 30100005
301100                  SET DP013-DB2-ABEND                             30110005
301200                                   TO TRUE                        30120005
301300                  PERFORM DP013-0000-PROCESS-ABEND                30130005
301400         END-EVALUATE.                                            30140005
301500 4268-SELECT-DEFAULT-TYPE.                                        30150005
301600*  MOVE TSK-MERCH-DEPT-NMBR                                       30160005
301700*                            TO DK-DEPT-NBR                       30170005
301800                                                                  30180005
301900     MOVE   XL001-SUB-CL-NBR-2CH                                  30190005
302000                               TO  PV-SUBCLASS                    30200005
302100     MOVE PV-SUBCLASS-NBR      TO  DK-SUBCLASS-NBR                30210005
302200                                                                  30220005
302300     MOVE XL001-MAJ-CL-NBR-2CH TO  DK-MAJCLASS-NBR                30230005
302400                                                                  30240005
302500     PERFORM                                                      30250005
302600         WITH TEST AFTER                                          30260005
302700         VARYING PV-RETRY-COUNTER                                 30270005
302800         FROM 1 BY 1                                              30280005
302900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30290005
303000                   OR (SQLCODE = ZERO)                            30300005
303100                   OR (SQLCODE = +100))                           30310005
303200                                                                  30320005
303300*  FIRST TRY THE DEFAULT AT THE SUBCLASS LEVEL                    30330005
303400         EXEC SQL                                                 30340005
303500             SELECT                                               30350005
303600                     CHARTC_VAL_DESC                              30360005
303700             INTO                                                 30370005
303800                    :VSCHVL-CHARTC-VAL-DESC                       30380005
303900             FROM                                                 30390005
304000                    TMDSEAR A                                     30400005
304100                   ,TDCVSVL B                                     30410005
304200                   ,TVSCHVL C                                     30420005
304300             WHERE                                                30430005
304400                   A.MDSELV_CDE     = :PC-SUBCLASS-MDSELV-CDE     30440005
304600               AND A.STRT_DTE      <=  CURRENT DATE               30460005
304700               AND A.END_DTE       >=  CURRENT DATE               30470005
304900               AND A.DEPT_NBR       = :DK-DEPT-NBR                30490005
305000               AND A.SUB_CL_NBR     = :DK-SUBCLASS-NBR            30500005
305100               AND A.MDSEAR_DKEY    = B.MDSEAR_ID                 30510005
305200               AND B.CHARTC_CDE     = :PC-VS-TICKET-TYPE-CDE      30520005
305300               AND B.PRIM_IND       = 'Y'                         30530005
305400               AND B.CHARTC_CDE     = C.CHARTC_CDE                30540005
305500               AND B.CHARTC_SEQ_NBR = C.CHARTC_SEQ_NBR            30550005
305600               AND C.STAT_CDE       = 'A'                         30560005
305610         WITH UR                                                  30561029
305700         END-EXEC                                                 30570005
305800                                                                  30580005
305900         EVALUATE TRUE                                            30590005
306000             WHEN SQLCODE = ZERO                                  30600005
306100             WHEN SQLCODE = +100                                  30610005
306200             WHEN SQLCODE = -904                                  30620005
306300             WHEN SQLCODE = -913                                  30630005
306400                 CONTINUE                                         30640005
306500                                                                  30650005
306600             WHEN SQLWARN0 NOT = SPACES                           30660005
306700             WHEN SQLCODE < ZERO                                  30670005
306800             WHEN SQLCODE > ZERO                                  30680005
306900                 MOVE '4320-GET-DEFAULT-TICKET-TYPE'              30690005
307000                                   TO DP013-PARAGRAPH             30700005
307100                 MOVE 'SELECT THE SUBCLASS DEFAULT TICKET TYPE'   30710005
307200                                   TO DP013-MESSAGE-TEXT (1)      30720005
307300                 MOVE DK-DEPT-NBR  TO DP013-MESSAGE-TEXT (2)      30730005
307400                 MOVE DK-SUBCLASS-NBR                             30740005
307500                                   TO DP013-MESSAGE-TEXT (3)      30750005
307600                 MOVE SQLCA        TO DP013-SQLCA                 30760005
307700                 MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    30770005
307800                 MOVE 'TDCVSVL'    TO DP013-DB2-TABLE-NAME (2)    30780005
307900                 MOVE 'TVSCHVL'    TO DP013-DB2-TABLE-NAME (3)    30790005
308000                 SET DP013-DB2-ABEND                              30800005
308100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           30810005
308200                 PERFORM DP013-0000-PROCESS-ABEND                 30820005
308300         END-EVALUATE                                             30830005
308400                                                                  30840005
308500*  IF NOT SUBCLASS LEVEL, TRY AS THE MAJOR CLASS LEVEL            30850005
308600         IF SQLCODE = +100                                        30860005
308700             EXEC SQL                                             30870005
308800                 SELECT                                           30880005
308900                         CHARTC_VAL_DESC                          30890005
309000                 INTO                                             30900005
309100                        :VSCHVL-CHARTC-VAL-DESC                   30910005
309200                 FROM                                             30920005
309300                        TMDSEAR A                                 30930005
309400                       ,TDCVSVL B                                 30940005
309500                       ,TVSCHVL C                                 30950005
309600                 WHERE                                            30960005
309700                       A.MDSELV_CDE     = :PC-MAJCLASS-MDSELV-CDE 30970005
309900                   AND A.STRT_DTE      <=  CURRENT DATE           30990005
310000                   AND A.END_DTE       >=  CURRENT DATE           31000005
310200                   AND A.DEPT_NBR       = :DK-DEPT-NBR            31020005
310300                   AND A.MAJ_CL_NBR     = :DK-MAJCLASS-NBR        31030005
310400                   AND A.MDSEAR_DKEY    = B.MDSEAR_ID             31040005
310500                   AND B.CHARTC_CDE     = :PC-VS-TICKET-TYPE-CDE  31050005
310600                   AND B.PRIM_IND       = 'Y'                     31060005
310700                   AND B.CHARTC_CDE     = C.CHARTC_CDE            31070005
310800                   AND B.CHARTC_SEQ_NBR = C.CHARTC_SEQ_NBR        31080005
310900                   AND C.STAT_CDE       = 'A'                     31090005
310910                  WITH UR                                         31091030
311000             END-EXEC                                             31100005
311100                                                                  31110005
311200             EVALUATE TRUE                                        31120005
311300                 WHEN SQLCODE = ZERO                              31130005
311400                 WHEN SQLCODE = +100                              31140005
311500                 WHEN SQLCODE = -904                              31150005
311600                 WHEN SQLCODE = -913                              31160005
311700                     CONTINUE                                     31170005
311800                                                                  31180005
311900                 WHEN SQLWARN0 NOT = SPACES                       31190005
312000                 WHEN SQLCODE < ZERO                              31200005
312100                 WHEN SQLCODE > ZERO                              31210005
312200                     MOVE '4320-GET-DEFAULT-TICKET-TYPE'          31220005
312300                                       TO DP013-PARAGRAPH         31230005
312400                     MOVE 'SELECT THE MAJOR CLASS TICKET TYPE'    31240005
312500                                       TO DP013-MESSAGE-TEXT (1)  31250005
312600                     MOVE DK-DEPT-NBR  TO DP013-MESSAGE-TEXT (2)  31260005
312700                     MOVE DK-MAJCLASS-NBR                         31270005
312800                                       TO DP013-MESSAGE-TEXT (3)  31280005
312900                     MOVE SQLCA        TO DP013-SQLCA             31290005
313000                     MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)31300005
313100                     MOVE 'TDCVSVL'    TO DP013-DB2-TABLE-NAME (2)31310005
313200                     MOVE 'TVSCHVL'    TO DP013-DB2-TABLE-NAME (3)31320005
313300                     SET DP013-DB2-ABEND                          31330005
313400                         DP013-XCTL-DISPLAY-RESTART TO TRUE       31340005
313500                     PERFORM DP013-0000-PROCESS-ABEND             31350005
313600             END-EVALUATE                                         31360005
313700         END-IF                                                   31370005
313800                                                                  31380005
313900* OTHERWISE TRY AT THE DEPARTMENT LEVEL                           31390005
314000       IF SQLCODE = +100                                          31400005
314100           EXEC SQL                                               31410005
314200               SELECT                                             31420005
314300                       CHARTC_VAL_DESC                            31430005
314400               INTO                                               31440005
314500                      :VSCHVL-CHARTC-VAL-DESC                     31450005
314600               FROM                                               31460005
314700                      TMDSEAR A                                   31470005
314800                     ,TDCVSVL B                                   31480005
314900                     ,TVSCHVL C                                   31490005
315000               WHERE                                              31500005
315100                     A.MDSELV_CDE     = :PC-DPT-MDSELV-CDE        31510005
315300                 AND A.STRT_DTE      <=  CURRENT DATE             31530005
315400                 AND A.END_DTE       >=  CURRENT DATE             31540005
315600                 AND A.DEPT_NBR       = :DK-DEPT-NBR              31560005
315700                 AND A.MDSEAR_DKEY    = B.MDSEAR_ID               31570005
315800                 AND B.CHARTC_CDE     = :PC-VS-TICKET-TYPE-CDE    31580005
315900                 AND B.PRIM_IND       = 'Y'                       31590005
316000                 AND B.CHARTC_CDE     = C.CHARTC_CDE              31600005
316100                 AND B.CHARTC_SEQ_NBR = C.CHARTC_SEQ_NBR          31610005
316200                 AND C.STAT_CDE       = 'A'                       31620005
316210                WITH UR                                           31621030
316300           END-EXEC                                               31630005
316400                                                                  31640005
316500           EVALUATE TRUE                                          31650005
316600               WHEN SQLCODE = ZERO                                31660005
316700               WHEN SQLCODE = +100                                31670005
316800               WHEN SQLCODE = -904                                31680005
316900               WHEN SQLCODE = -913                                31690005
317000                   CONTINUE                                       31700005
317100                                                                  31710005
317200               WHEN SQLWARN0 NOT = SPACES                         31720005
317300               WHEN SQLCODE < ZERO                                31730005
317400               WHEN SQLCODE > ZERO                                31740005
317500                   MOVE '4320-GET-DEFAULT-TICKET-TYPE'            31750005
317600                                    TO DP013-PARAGRAPH            31760005
317700                   MOVE 'SELECT THE DEFAULT TICKET TYPE'          31770005
317800                                    TO DP013-MESSAGE-TEXT (1)     31780005
317900                   MOVE DK-DEPT-NBR  TO DP013-MESSAGE-TEXT (2)    31790005
318000                   MOVE SQLCA       TO DP013-SQLCA                31800005
318100                   MOVE 'TMDSEAR'   TO DP013-DB2-TABLE-NAME (1)   31810005
318200                   MOVE 'TDCVSVL'   TO DP013-DB2-TABLE-NAME (2)   31820005
318300                   MOVE 'TVSCHVL'   TO DP013-DB2-TABLE-NAME (3)   31830005
318400                   SET DP013-DB2-ABEND                            31840005
318500                       DP013-XCTL-DISPLAY-RESTART TO TRUE         31850005
318600                   PERFORM DP013-0000-PROCESS-ABEND               31860005
318700           END-EVALUATE                                           31870005
318800       END-IF                                                     31880005
318900                                                                  31890005
319000     END-PERFORM.                                                 31900005
319100                                                                  31910005
319200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31920005
319300         MOVE '4110-GET-LEAD-TIME' TO DP013-PARAGRAPH             31930005
319400         MOVE 'MAXIMUM RETRIES EXCEEDED SELECTING VND LEAD TIME'  31940005
319500                                   TO DP013-MESSAGE-TEXT (1)      31950005
319600         MOVE DK-DEPT-NBR          TO DP013-MESSAGE-TEXT (2)      31960005
319700         MOVE DK-SUBCLASS-NBR      TO DP013-MESSAGE-TEXT (3)      31970005
319800         MOVE SQLCA                TO DP013-SQLCA                 31980005
319900         MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    31990005
320000         MOVE 'TDCVSVL'            TO DP013-DB2-TABLE-NAME (2)    32000005
320100         MOVE 'TVSCHVL'            TO DP013-DB2-TABLE-NAME (3)    32010005
320200         SET DP013-DB2-ABEND                                      32020005
320300             DP013-XCTL-DISPLAY-RESTART                           32030005
320400                                   TO TRUE                        32040005
320500         PERFORM DP013-0000-PROCESS-ABEND                         32050005
320600     END-IF.                                                      32060005
320700                                                                  32070005
320800     IF SQLCODE = +100                                            32080005
320900         MOVE SPACES       TO ASC-TKT-DESC                        32090005
321000     END-IF.                                                      32100005
327200                                                                  32720005
327400*----------------------------------------------------------------*32740005
327500*    RETRIEVE PACKING SLIP INFO                                  *32750005
327600*----------------------------------------------------------------*32760005
327700 4270-SELECT-SRCCDE-TPKSLIP.                                      32770005
327800                                                                  32780005
327900     PERFORM                                                      32790005
328000         WITH TEST AFTER                                          32800005
328100         VARYING PV-RETRY-COUNTER                                 32810005
328200         FROM 1 BY 1                                              32820005
328300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32830005
328400             OR (SQLCODE = +0)                                    32840005
328500             OR (SQLCODE = +100)                                  32850005
328600             OR (SQLCODE = -811))                                 32860005
328700                                                                  32870005
328800         EXEC SQL                                                 32880005
328900              SELECT CRE_SRC_CDE                                  32890005
328910                   , BOL_NBR                                      32891015
329000                INTO :PKSLIP-CRE-SRC-CDE                          32900005
329010                   , :PKSLIP-BOL-NBR                              32901015
329100                FROM TPKSLIP                                      32910005
329200               WHERE OPER_UNT_ID   = :DK-OPER-UNT-ID              32920005
329300                 AND FCLTY_ID      = :DK-FCLTY-ID                 32930005
329400                 AND PO_NBR        = :DK-PO-NBR                   32940005
329500                 AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR              32950005
329600                 AND VER_STAT_CDE  = 'A'                          32960005
329610                WITH UR                                           32961030
329700         END-EXEC                                                 32970005
329800                                                                  32980005
329900         EVALUATE TRUE                                            32990005
330000             WHEN SQLCODE = +0                                    33000005
330100             WHEN SQLCODE = +100                                  33010005
330200             WHEN SQLCODE = -811                                  33020005
330300             WHEN SQLCODE = -904                                  33030005
330400             WHEN SQLCODE = -913                                  33040005
330500                  CONTINUE                                        33050005
330600                                                                  33060005
330700             WHEN SQLWARN0 NOT = SPACES                           33070005
330800             WHEN SQLCODE < +0                                    33080005
330900             WHEN SQLCODE > +0                                    33090005
331000                  MOVE '4270-SELECT-SRCCDE-TPKSLIP'               33100005
331100                                  TO DP013-PARAGRAPH              33110005
331200                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  '         33120005
331300                                  TO DP013-MESSAGE-TEXT (1)       33130005
331400                  MOVE SQLCA      TO DP013-SQLCA                  33140005
331500                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     33150005
331600                  SET DP013-DB2-ABEND                             33160005
331700                      DP013-XCTL-DISPLAY-RESTART                  33170005
331800                                  TO TRUE                         33180005
331900                  PERFORM DP013-0000-PROCESS-ABEND                33190005
332000         END-EVALUATE                                             33200005
332100     END-PERFORM.                                                 33210005
332200                                                                  33220005
332300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33230005
332400             AND (SQLCODE = -904 OR -913)                         33240005
332500         MOVE '4270-SELECT-TPKSLIP'                               33250005
332600                                  TO DP013-PARAGRAPH              33260005
332700         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TPKSLIP  '       33270005
332800                                  TO DP013-MESSAGE-TEXT (1)       33280005
332900         MOVE SQLCA               TO DP013-SQLCA                  33290005
333000         MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1)     33300005
333100         SET DP013-DB2-ABEND                                      33310005
333200             DP013-XCTL-DISPLAY-RESTART                           33320005
333300                                  TO TRUE                         33330005
333400         PERFORM DP013-0000-PROCESS-ABEND                         33340005
333500     END-IF.                                                      33350005
333600                                                                  33360005
333700*----------------------------------------------------------------*33370005
333800*    RETRIEVE PACKING SLIP INFO                                  *33380005
333900*----------------------------------------------------------------*33390005
334000 4275-SELECT-CRETMST-TPKSLIP.                                     33400005
334100                                                                  33410005
334200     PERFORM                                                      33420005
334300         WITH TEST AFTER                                          33430005
334400         VARYING PV-RETRY-COUNTER                                 33440005
334500         FROM 1 BY 1                                              33450005
334600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33460005
334700             OR (SQLCODE = +0 OR +100 OR -305 OR -811))           33470005
334800                                                                  33480005
334900         EXEC SQL                                                 33490005
335000            SELECT MIN(CRE_TMST)                                  33500005
335100              INTO :PKSLIP-CRE-TMST                               33510005
335200              FROM TPKSLIP                                        33520005
335300              WHERE OPER_UNT_ID   = :DK-OPER-UNT-ID               33530005
335400                AND FCLTY_ID      = :DK-FCLTY-ID                  33540005
335500                AND PO_NBR        = :DK-PO-NBR                    33550005
335600                AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR               33560005
335700                AND PKSL_STAT_CDE = :PC-AC                        33570005
335710               WITH UR                                            33571030
335800         END-EXEC                                                 33580005
335900                                                                  33590005
336000         EVALUATE TRUE                                            33600005
336100             WHEN SQLCODE = +0                                    33610005
336200             WHEN SQLCODE = +100                                  33620005
336300             WHEN SQLCODE = -305                                  33630005
336400             WHEN SQLCODE = -811                                  33640005
336500             WHEN SQLCODE = -904                                  33650005
336600             WHEN SQLCODE = -913                                  33660005
336700                  CONTINUE                                        33670005
336800                                                                  33680005
336900             WHEN SQLWARN0 NOT = SPACES                           33690005
337000             WHEN SQLCODE < +0                                    33700005
337100             WHEN SQLCODE > +0                                    33710005
337200                  MOVE '4275-SELECT-CRETMST-TPKSLIP'              33720005
337300                                  TO DP013-PARAGRAPH              33730005
337400                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  '         33740005
337500                                  TO DP013-MESSAGE-TEXT (1)       33750005
337600                  MOVE SQLCA      TO DP013-SQLCA                  33760005
337700                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     33770005
337800                  SET DP013-DB2-ABEND                             33780005
337900                      DP013-XCTL-DISPLAY-RESTART                  33790005
338000                                  TO TRUE                         33800005
338100                  PERFORM DP013-0000-PROCESS-ABEND                33810005
338200         END-EVALUATE                                             33820005
338300     END-PERFORM.                                                 33830005
338400                                                                  33840005
338500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33850005
338600             AND (SQLCODE = -904 OR -913)                         33860005
338700         MOVE '4275-SELECT-CRETMST-TPKSLIP'                       33870005
338800                                  TO DP013-PARAGRAPH              33880005
338900         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TPKSLIP  '       33890005
339000                                  TO DP013-MESSAGE-TEXT (1)       33900005
339100         MOVE SQLCA               TO DP013-SQLCA                  33910005
339200         MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1)     33920005
339300         SET DP013-DB2-ABEND                                      33930005
339400             DP013-XCTL-DISPLAY-RESTART                           33940005
339500                                  TO TRUE                         33950005
339600         PERFORM DP013-0000-PROCESS-ABEND                         33960005
339700     END-IF.                                                      33970005
339800                                                                  33980005
339900/                                                                 33990005
340000*----------------------------------------------------------------*34000005
340100*    RETRIEVE OPERATION SET DESCRIPTION                          *34010005
340200*----------------------------------------------------------------*34020005
340300 4280-GET-OPER-SET-DESC.                                          34030005
340400                                                                  34040005
340500     PERFORM                                                      34050005
340600         WITH TEST AFTER                                          34060005
340700         VARYING PV-RETRY-COUNTER                                 34070005
340800         FROM 1 BY 1                                              34080005
340900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34090005
341000             OR (SQLCODE = +0)                                    34100005
341100             OR (SQLCODE = +100))                                 34110005
341200                                                                  34120005
341300         EXEC SQL                                                 34130005
341400            SELECT  DISTINCT                                      34140005
341500                    B.OPER_SET_ID                                 34150005
341600                  , C.OPER_SET_DESC                               34160005
341700              INTO :WRKORD-OPER-SET-ID                            34170005
341800                  ,:OPRSET-OPER-SET-DESC                          34180005
341900              FROM  TRECEIV A                                     34190005
342000                   ,TWRKORD B                                     34200005
342100                   ,TOPRSET C                                     34210005
342200             WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID            34220005
342300               AND  A.FCLTY_ID       = :DK-FCLTY-ID               34230005
342400               AND  A.ORD_NBR        = :DK-PO-NBR                 34240005
342500               AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR            34250005
342600               AND  B.ORD_LNE_NBR    = 0                          34260005
342700               AND  A.VER_STATUS_CDE = 'A'                        34270005
342800               AND  B.VER_STATUS_CDE = 'A'                        34280005
342900               AND  A.OPER_UNT_ID    = B.OPER_UNT_ID              34290005
343000               AND  A.FCLTY_ID       = B.FCLTY_ID                 34300005
343100               AND  A.ORD_NBR        = B.ORD_NBR                  34310005
343200               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             34320005
343300               AND  B.OPER_SET_ID    = C.OPER_SET_ID              34330005
343400               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         34340005
343410              WITH UR                                             34341030
343500         END-EXEC                                                 34350005
343600                                                                  34360005
343700         EVALUATE TRUE                                            34370005
343800             WHEN SQLCODE = +0                                    34380005
343900             WHEN SQLCODE = -904                                  34390005
344000             WHEN SQLCODE = -913                                  34400005
344100                  CONTINUE                                        34410005
344200                                                                  34420005
344300             WHEN SQLCODE = +100                                  34430005
344400                  PERFORM 4285-GET-OPER-SET-DESC                  34440005
344500                                                                  34450005
344600             WHEN SQLWARN0 NOT = SPACES                           34460005
344700             WHEN SQLCODE < +0                                    34470005
344800             WHEN SQLCODE > +0                                    34480005
344900                  MOVE '4280-GET-OPER-SET-DESC'                   34490005
345000                                  TO DP013-PARAGRAPH              34500005
345100                  MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '         34510005
345200                                  TO DP013-MESSAGE-TEXT (1)       34520005
345300                  MOVE SQLCA      TO DP013-SQLCA                  34530005
345400                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     34540005
345500                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (2)     34550005
345600                  MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (3)     34560005
345700                  SET DP013-DB2-ABEND                             34570005
345800                      DP013-XCTL-DISPLAY-RESTART                  34580005
345900                                  TO TRUE                         34590005
346000                  PERFORM DP013-0000-PROCESS-ABEND                34600005
346100         END-EVALUATE                                             34610005
346200     END-PERFORM.                                                 34620005
346300                                                                  34630005
346400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34640005
346500             AND (SQLCODE = -904 OR -913)                         34650005
346600         MOVE '4280-GET-OPER-SET-DESC'                            34660005
346700                                  TO DP013-PARAGRAPH              34670005
346800         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TOPRSET  '       34680005
346900                                  TO DP013-MESSAGE-TEXT (1)       34690005
347000         MOVE SQLCA               TO DP013-SQLCA                  34700005
347100         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     34710005
347200         MOVE 'TWRKORD '          TO DP013-DB2-TABLE-NAME (2)     34720005
347300         MOVE 'TOPRSET '          TO DP013-DB2-TABLE-NAME (3)     34730005
347400         SET DP013-DB2-ABEND                                      34740005
347500             DP013-XCTL-DISPLAY-RESTART                           34750005
347600                                  TO TRUE                         34760005
347700         PERFORM DP013-0000-PROCESS-ABEND                         34770005
347800     END-IF.                                                      34780005
347900                                                                  34790005
348000*----------------------------------------------------------------*34800005
348100*    RETRIEVE OPERATION SET DESCRIPTION  - NO OPER UNIT ID       *34810005
348200*----------------------------------------------------------------*34820005
348300 4285-GET-OPER-SET-DESC.                                          34830005
348400                                                                  34840005
348500     PERFORM                                                      34850005
348600         WITH TEST AFTER                                          34860005
348700         VARYING PV-RETRY-COUNTER                                 34870005
348800         FROM 1 BY 1                                              34880005
348900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34890005
349000             OR (SQLCODE = +0)                                    34900005
349100             OR (SQLCODE = +100))                                 34910005
349200                                                                  34920005
349300         EXEC SQL                                                 34930005
349400            SELECT  DISTINCT                                      34940005
349500                    B.OPER_SET_ID                                 34950005
349600                  , C.OPER_SET_DESC                               34960005
349700              INTO :WRKORD-OPER-SET-ID                            34970005
349800                  ,:OPRSET-OPER-SET-DESC                          34980005
349900              FROM  TRECEIV A                                     34990005
350000                   ,TWRKORD B                                     35000005
350100                   ,TOPRSET C                                     35010005
350200             WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID            35020005
350300               AND  A.FCLTY_ID       = :DK-FCLTY-ID               35030005
350400               AND  A.ORD_NBR        = :DK-PO-NBR                 35040005
350500               AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR            35050005
350600               AND  B.ORD_LNE_NBR    = 0                          35060005
350700               AND  A.VER_STATUS_CDE = 'A'                        35070005
350800               AND  B.VER_STATUS_CDE = 'A'                        35080005
350900               AND  A.CURR_OPER_UNT_ID    = B.OPER_UNT_ID         35090005
351000               AND  A.CURR_FCLTY_ID       = B.FCLTY_ID            35100005
351100               AND  A.ORD_NBR        = B.ORD_NBR                  35110005
351200               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             35120005
351300               AND  B.OPER_SET_ID    = C.OPER_SET_ID              35130005
351400               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         35140005
351410              WITH UR                                             35141030
351500         END-EXEC                                                 35150005
351600                                                                  35160005
351700         EVALUATE TRUE                                            35170005
351800             WHEN SQLCODE = +0                                    35180005
351900             WHEN SQLCODE = +100                                  35190005
352000             WHEN SQLCODE = -904                                  35200005
352100             WHEN SQLCODE = -913                                  35210005
352200                  CONTINUE                                        35220005
352300                                                                  35230005
352400             WHEN SQLWARN0 NOT = SPACES                           35240005
352500             WHEN SQLCODE < +0                                    35250005
352600             WHEN SQLCODE > +0                                    35260005
352700                  MOVE '4285-GET-OPER-SET-DESC'                   35270005
352800                                  TO DP013-PARAGRAPH              35280005
352900                  MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '         35290005
353000                                  TO DP013-MESSAGE-TEXT (1)       35300005
353100                  MOVE SQLCA      TO DP013-SQLCA                  35310005
353200                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     35320005
353300                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (2)     35330005
353400                  MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (3)     35340005
353500                  SET DP013-DB2-ABEND                             35350005
353600                      DP013-XCTL-DISPLAY-RESTART                  35360005
353700                                  TO TRUE                         35370005
353800                  PERFORM DP013-0000-PROCESS-ABEND                35380005
353900         END-EVALUATE                                             35390005
354000     END-PERFORM.                                                 35400005
354100                                                                  35410005
354200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35420005
354300             AND (SQLCODE = -904 OR -913)                         35430005
354400         MOVE '4285-GET-OPER-SET-DESC'                            35440005
354500                                  TO DP013-PARAGRAPH              35450005
354600         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TOPRSET  '       35460005
354700                                  TO DP013-MESSAGE-TEXT (1)       35470005
354800         MOVE SQLCA               TO DP013-SQLCA                  35480005
354900         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     35490005
355000         MOVE 'TWRKORD '          TO DP013-DB2-TABLE-NAME (2)     35500005
355100         MOVE 'TOPRSET '          TO DP013-DB2-TABLE-NAME (3)     35510005
355200         SET DP013-DB2-ABEND                                      35520005
355300             DP013-XCTL-DISPLAY-RESTART                           35530005
355400                                  TO TRUE                         35540005
355500         PERFORM DP013-0000-PROCESS-ABEND                         35550005
355600     END-IF.                                                      35560005
355700                                                                  35570005
355800/                                                                 35580005
355900*----------------------------------------------------------------*35590005
356000*     CHECK TO SEE IF OPERATING UNIT IS A STORE                  *35600005
356100*----------------------------------------------------------------*35610005
356200 4290-CHECK-DIRECT-STORE.                                         35620005
356300                                                                  35630005
356400     INITIALIZE XL071-COMMAREA-REC.                               35640005
356500     MOVE DK-STORE-NMBR   TO XL071-LOCATION-NUMBER.               35650005
356600                                                                  35660005
356700     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    35670005
356800                                XL071-COMMAREA                    35680005
356900                                XL071-COMMAREA-REC.               35690005
357000                                                                  35700005
357100     EVALUATE TRUE                                                35710005
357200         WHEN XL071-NO-ERRORS                                     35720005
357300         WHEN XL071-LOC-NOT-FOUND                                 35730005
357400         WHEN XL071-DC-ASGMT-NOT-FND                              35740005
357500             CONTINUE                                             35750005
357600                                                                  35760005
357700         WHEN OTHER                                               35770005
357800             MOVE '4290-CHECK-DIRECT-STORE'                       35780005
357900                                    TO DP013-PARAGRAPH            35790005
358000             MOVE 'CALL TO XLKUT071'                              35800005
358100                                    TO DP013-MESSAGE-TEXT (1)     35810005
358200             MOVE XL071-SQLCODE-N   TO SQLCODE                    35820005
358300             MOVE XL071-SQLCA       TO DP013-SQLCA                35830005
358400             MOVE 'XLT_LOC'         TO DP013-DB2-TABLE-NAME (1)   35840005
358500             SET DP013-DB2-ABEND                                  35850005
358600                                    TO TRUE                       35860005
358700             SET DP013-XCTL-DISPLAY-RESTART                       35870005
358800                                    TO TRUE                       35880005
358900             PERFORM DP013-0000-PROCESS-ABEND                     35890005
359000     END-EVALUATE.                                                35900005
359100                                                                  35910005
359200/                                                                 35920005
359300 4300-FILL-TROUBLE-FIELDS.                                        35930005
359400     PERFORM 4310-CHECK-FOR-UNRESOLVED.                           35940005
359500     EVALUATE PV-DB2-COUNT                                        35950005
359600     WHEN ZERO                                                    35960005
359700         MOVE SPACES          TO ASC-TROUB-STATUS-1               35970005
359800                                 ASC-IN-TROUB-DATE                35980005
359900                                 ASC-IN-TROUB-TIME                35990005
360000                                 ASC-OUT-TROUB-DATE               36000005
360100                                 ASC-OUT-TROUB-TIME               36010005
360200     WHEN 1                                                       36020005
360300         PERFORM 4311-TROUBLE-DESC                                36030005
360400         PERFORM 4312-LATEST-NOTIF-DATE                           36040005
360500         PERFORM 4313-LATEST-RESOLVE-DATE                         36050005
360600     WHEN OTHER                                                   36060005
360700         PERFORM 4311-TROUBLE-DESC                                36070005
360800         MOVE '*'             TO ASC-TROUB-STATUS-1 (11:1)        36080005
360900         PERFORM 4312-LATEST-NOTIF-DATE                           36090005
361000         PERFORM 4313-LATEST-RESOLVE-DATE                         36100005
361100     END-EVALUATE.                                                36110005
361200                                                                  36120005
361300                                                                  36130005
361400                                                                  36140005
361500                                                                  36150005
361600 4310-CHECK-FOR-UNRESOLVED.                                       36160005
361700                                                                  36170005
361800     PERFORM                                                      36180005
361900         WITH TEST AFTER                                          36190005
362000         VARYING PV-RETRY-COUNTER                                 36200005
362100         FROM 1 BY 1                                              36210005
362200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36220005
362300            OR (SQLCODE = +0)                                     36230005
362400            OR (SQLCODE = +100))                                  36240005
362500                                                                  36250005
362600         EXEC SQL                                                 36260005
362700             SELECT COUNT(*)                                      36270005
362800              INTO :PV-DB2-COUNT :DN-UNRESOLVED-ID                36280005
362900              FROM  TTRBNTF A                                     36290005
363000             WHERE A.PO_NBR      = :DK-PO-NBR                     36300005
363100               AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                36310005
363200               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               36320005
363210              WITH UR                                             36321030
363300         END-EXEC                                                 36330005
363400                                                                  36340005
363500         EVALUATE TRUE                                            36350005
363600             WHEN SQLCODE = +0                                    36360005
363700             WHEN SQLCODE = +100                                  36370005
363800             WHEN SQLCODE = -904                                  36380005
363900             WHEN SQLCODE = -913                                  36390005
364000                 CONTINUE                                         36400005
364100                                                                  36410005
364200             WHEN SQLWARN0 NOT = SPACE                            36420005
364300             WHEN SQLCODE < +0                                    36430005
364400             WHEN SQLCODE > +0                                    36440005
364500                 MOVE '4310-CHECK-FOR-UNRESOLVED'                 36450005
364600                                 TO DP013-PARAGRAPH               36460005
364700                 MOVE 'COUNT ON TTRBNTF'                          36470005
364800                                 TO DP013-MESSAGE-TEXT (1)        36480005
364900                 MOVE SQLCA      TO DP013-SQLCA                   36490005
365000                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      36500005
365100                 SET DP013-DB2-ABEND                              36510005
365200                                 TO TRUE                          36520005
365300                 SET DP013-XCTL-DISPLAY-RESTART                   36530005
365400                                 TO TRUE                          36540005
365500                 PERFORM DP013-0000-PROCESS-ABEND                 36550005
365600         END-EVALUATE                                             36560005
365700     END-PERFORM.                                                 36570005
365800                                                                  36580005
365900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36590005
366000             AND (SQLCODE = -904 OR -913)                         36600005
366100         MOVE '4310-CHECK-FOR-UNRESOLVED'                         36610005
366200                                 TO DP013-PARAGRAPH               36620005
366300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     36630005
366400                                 TO DP013-MESSAGE-TEXT (1)        36640005
366500         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        36650005
366600         MOVE SQLCA              TO DP013-SQLCA                   36660005
366700         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      36670005
366800         SET DP013-DB2-ABEND     TO TRUE                          36680005
366900         SET DP013-XCTL-DISPLAY-RESTART                           36690005
367000                                 TO TRUE                          36700005
367100         PERFORM DP013-0000-PROCESS-ABEND                         36710005
367200     END-IF.                                                      36720005
367300                                                                  36730005
367400 4311-TROUBLE-DESC.                                               36740005
367500                                                                  36750005
367600     PERFORM                                                      36760005
367700         WITH TEST AFTER                                          36770005
367800         VARYING PV-RETRY-COUNTER                                 36780005
367900         FROM 1 BY 1                                              36790005
368000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36800005
368100            OR (SQLCODE = +0 OR +100 OR -811))                    36810005
368200                                                                  36820005
368300         EXEC SQL                                                 36830005
368400             SELECT B.TRBL_SHT_DESC                               36840005
368500             INTO :TRBRSN-TRBL-SHT-DESC                           36850005
368600             FROM  TTRBNTF A                                      36860005
368700                  ,TTRBRSN B                                      36870005
368800             WHERE A.PO_NBR           = :DK-PO-NBR                36880005
368900                   AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR           36890005
369000                   AND A.RESOLVED_IND IN (:PC-N, :PC-I)           36900005
369100                   AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE            36910005
369110              WITH UR                                             36911030
369200         END-EXEC                                                 36920005
369300                                                                  36930005
369400         EVALUATE TRUE                                            36940005
369500             WHEN SQLCODE = +0                                    36950005
369600             WHEN SQLCODE = -811                                  36960005
369700                 MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUB-STATUS-1  36970005
369800             WHEN SQLCODE = +100                                  36980005
369900                 MOVE SPACES               TO ASC-TROUB-STATUS-1  36990005
370000             WHEN SQLCODE = -904                                  37000005
370100             WHEN SQLCODE = -913                                  37010005
370200                 CONTINUE                                         37020005
370300                                                                  37030005
370400             WHEN SQLWARN0 NOT = SPACE                            37040005
370500             WHEN SQLCODE < ZERO                                  37050005
370600             WHEN SQLCODE > ZERO                                  37060005
370700                 MOVE '4311-TROUBLE-DESC'                         37070005
370800                                 TO DP013-PARAGRAPH               37080005
370900                 MOVE 'SELECT ON TTRBNTF/TTRBRSN'                 37090005
371000                                 TO DP013-MESSAGE-TEXT (1)        37100005
371100                 MOVE SQLCA      TO DP013-SQLCA                   37110005
371200                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      37120005
371300                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      37130005
371400                 SET DP013-DB2-ABEND                              37140005
371500                                 TO TRUE                          37150005
371600                 SET DP013-XCTL-DISPLAY-RESTART                   37160005
371700                                 TO TRUE                          37170005
371800                 PERFORM DP013-0000-PROCESS-ABEND                 37180005
371900         END-EVALUATE                                             37190005
372000     END-PERFORM.                                                 37200005
372100                                                                  37210005
372200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37220005
372300             AND (SQLCODE = -904 OR -913)                         37230005
372400         MOVE '4311-TROUBLE-DESC'                                 37240005
372500                                 TO DP013-PARAGRAPH               37250005
372600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     37260005
372700                                 TO DP013-MESSAGE-TEXT (1)        37270005
372800         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        37280005
372900         MOVE SQLCA              TO DP013-SQLCA                   37290005
373000         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      37300005
373100         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      37310005
373200         SET DP013-DB2-ABEND     TO TRUE                          37320005
373300         SET DP013-XCTL-DISPLAY-RESTART                           37330005
373400                                 TO TRUE                          37340005
373500         PERFORM DP013-0000-PROCESS-ABEND                         37350005
373600     END-IF.                                                      37360005
373700                                                                  37370005
373800 4312-LATEST-NOTIF-DATE.                                          37380005
373900                                                                  37390005
374000     PERFORM                                                      37400005
374100         WITH TEST AFTER                                          37410005
374200         VARYING PV-RETRY-COUNTER                                 37420005
374300         FROM 1 BY 1                                              37430005
374400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37440005
374500            OR (SQLCODE = ZERO OR +100 OR -305))                  37450005
374600                                                                  37460005
374700         EXEC SQL                                                 37470005
374800             SELECT MAX(A.NOTIF_TMST)                             37480005
374900             INTO :TRBNTF-NOTIF-TMST                              37490005
375000             FROM  TTRBNTF A                                      37500005
375100             WHERE A.PO_NBR          = :DK-PO-NBR                 37510005
375200                   AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR            37520005
375300                   AND A.RESOLVED_IND IN (:PC-N, :PC-I)           37530005
375310              WITH UR                                             37531030
375400         END-EXEC                                                 37540005
375500                                                                  37550005
375600         EVALUATE TRUE                                            37560005
375700             WHEN SQLCODE = ZERO                                  37570005
375800                 MOVE TRBNTF-NOTIF-TMST TO PV-DB2-TIMESTAMP       37580005
375900                 STRING PV-DB2-TMST-MM  '/'                       37590005
376000                        PV-DB2-TMST-DD DELIMITED BY SIZE          37600005
376100                                      INTO ASC-IN-TROUB-DATE      37610005
376200                 STRING PV-DB2-TMST-HH ':'                        37620005
376300                        PV-DB2-TMST-MIN DELIMITED BY SIZE         37630005
376400                                      INTO ASC-IN-TROUB-TIME      37640005
376500                                                                  37650005
376600             WHEN SQLCODE = +100                                  37660005
376700             WHEN SQLCODE = -305                                  37670005
376800                 MOVE SPACES            TO ASC-IN-TROUB-DATE      37680005
376900                                           ASC-IN-TROUB-TIME      37690005
377000             WHEN SQLCODE = -904                                  37700005
377100             WHEN SQLCODE = -913                                  37710005
377200                 CONTINUE                                         37720005
377300                                                                  37730005
377400             WHEN SQLWARN0 NOT = SPACE                            37740005
377500             WHEN SQLCODE < ZERO                                  37750005
377600             WHEN SQLCODE > ZERO                                  37760005
377700                 MOVE '4312-LATEST-NOTIF-DATE'                    37770005
377800                                 TO DP013-PARAGRAPH               37780005
377900                 MOVE 'MAX DATE ON TTRBRSN'                       37790005
378000                                 TO DP013-MESSAGE-TEXT (1)        37800005
378100                 MOVE SQLCA      TO DP013-SQLCA                   37810005
378200                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      37820005
378300                 SET DP013-DB2-ABEND                              37830005
378400                                 TO TRUE                          37840005
378500                 SET DP013-XCTL-DISPLAY-RESTART                   37850005
378600                                 TO TRUE                          37860005
378700                 PERFORM DP013-0000-PROCESS-ABEND                 37870005
378800         END-EVALUATE                                             37880005
378900     END-PERFORM.                                                 37890005
379000                                                                  37900005
379100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37910005
379200             AND (SQLCODE = -904 OR -913)                         37920005
379300         MOVE '4312-LATEST-NOTIF-DATE'                            37930005
379400                                 TO DP013-PARAGRAPH               37940005
379500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     37950005
379600                                 TO DP013-MESSAGE-TEXT (1)        37960005
379700         MOVE 'MAX DATE ON TTRBRSN'                               37970005
379800                                 TO DP013-MESSAGE-TEXT (2)        37980005
379900         MOVE SQLCA              TO DP013-SQLCA                   37990005
380000         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      38000005
380100         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      38010005
380200         SET DP013-DB2-ABEND     TO TRUE                          38020005
380300         SET DP013-XCTL-DISPLAY-RESTART                           38030005
380400                                 TO TRUE                          38040005
380500         PERFORM DP013-0000-PROCESS-ABEND                         38050005
380600     END-IF.                                                      38060005
380700                                                                  38070005
380800 4313-LATEST-RESOLVE-DATE.                                        38080005
380900                                                                  38090005
381000     PERFORM                                                      38100005
381100         WITH TEST AFTER                                          38110005
381200         VARYING PV-RETRY-COUNTER                                 38120005
381300         FROM 1 BY 1                                              38130005
381400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38140005
381500            OR (SQLCODE = ZERO OR +100 OR -305))                  38150005
381600                                                                  38160005
381700         EXEC SQL                                                 38170005
381800             SELECT MAX(A.RESOLVED_TMST)                          38180005
381900             INTO :TRBNTF-RESOLVED-TMST                           38190005
382000             FROM  TTRBNTF A                                      38200005
382100             WHERE A.PO_NBR           = :DK-PO-NBR                38210005
382200                   AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR           38220005
382300                   AND A.RESOLVED_IND IN (:PC-R, :PC-A)           38230005
382310              WITH UR                                             38231030
382400         END-EXEC                                                 38240005
382500                                                                  38250005
382600         EVALUATE TRUE                                            38260005
382700             WHEN SQLCODE = ZERO                                  38270005
382800                 MOVE TRBNTF-RESOLVED-TMST                        38280005
382900                                        TO PV-DB2-TIMESTAMP       38290005
383000                 STRING PV-DB2-TMST-MM  '/'                       38300005
383100                        PV-DB2-TMST-DD DELIMITED BY SIZE          38310005
383200                                      INTO ASC-OUT-TROUB-DATE     38320005
383300                 STRING PV-DB2-TMST-HH ':'                        38330005
383400                        PV-DB2-TMST-MIN DELIMITED BY SIZE         38340005
383500                                      INTO ASC-OUT-TROUB-TIME     38350005
383600             WHEN SQLCODE = +100                                  38360005
383700             WHEN SQLCODE = -305                                  38370005
383800                 MOVE SPACES            TO ASC-OUT-TROUB-DATE     38380005
383900                                           ASC-OUT-TROUB-TIME     38390005
384000             WHEN SQLCODE = -904                                  38400005
384100             WHEN SQLCODE = -913                                  38410005
384200                 CONTINUE                                         38420005
384300                                                                  38430005
384400             WHEN SQLWARN0 NOT = SPACE                            38440005
384500             WHEN SQLCODE < ZERO                                  38450005
384600             WHEN SQLCODE > ZERO                                  38460005
384700                 MOVE '4312-LATEST-NOTIF-DATE'                    38470005
384800                                 TO DP013-PARAGRAPH               38480005
384900                 MOVE 'MAX DATE ON TTRBRSN'                       38490005
385000                                 TO DP013-MESSAGE-TEXT (1)        38500005
385100                 MOVE SQLCA      TO DP013-SQLCA                   38510005
385200                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      38520005
385300                 SET DP013-DB2-ABEND                              38530005
385400                                 TO TRUE                          38540005
385500                 SET DP013-XCTL-DISPLAY-RESTART                   38550005
385600                                 TO TRUE                          38560005
385700                 PERFORM DP013-0000-PROCESS-ABEND                 38570005
385800         END-EVALUATE                                             38580005
385900     END-PERFORM.                                                 38590005
386000                                                                  38600005
386100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38610005
386200             AND (SQLCODE = -904 OR -913)                         38620005
386300         MOVE '4312-LATEST-NOTIF-DATE'                            38630005
386400                                 TO DP013-PARAGRAPH               38640005
386500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38650005
386600                                 TO DP013-MESSAGE-TEXT (1)        38660005
386700         MOVE 'MAX DATE ON TTRBRSN'                               38670005
386800                                 TO DP013-MESSAGE-TEXT (2)        38680005
386900         MOVE SQLCA              TO DP013-SQLCA                   38690005
387000         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      38700005
387100         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      38710005
387200         SET DP013-DB2-ABEND     TO TRUE                          38720005
387300         SET DP013-XCTL-DISPLAY-RESTART                           38730005
387400                                 TO TRUE                          38740005
387500         PERFORM DP013-0000-PROCESS-ABEND                         38750005
387600     END-IF.                                                      38760005
387700                                                                  38770005
387800                                                                  38780005
387900/                                                                 38790005
388000*----------------------------------------------------------------*38800005
388100*    CHECK TO SEE IF ALL PACKING SLIP IND FIELDS HAVE SAME VALUE *38810005
388200*----------------------------------------------------------------*38820005
388300 4320-CHECK-PKSL-IND.                                             38830005
388400                                                                  38840005
388500     PERFORM                                                      38850005
388600         WITH TEST AFTER                                          38860005
388700         VARYING PV-RETRY-COUNTER                                 38870005
388800         FROM 1 BY 1                                              38880005
388900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38890005
389000             OR (SQLCODE = +0)                                    38900005
389100             OR (SQLCODE = +100))                                 38910005
389200                                                                  38920005
389300         EXEC SQL                                                 38930005
389400              SELECT COUNT(*)                                     38940005
389500                INTO :PV-DB2-COUNT                                38950005
389600                FROM TSHPTPO A                                    38960005
389700               WHERE A.PO_NBR      = :DK-PO-NBR                   38970005
389800                 AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR              38980005
389900                 AND A.PKSL_IND    = :PC-N                        38990005
389910                WITH UR                                           38991030
390000         END-EXEC                                                 39000005
390100                                                                  39010005
390200         EVALUATE TRUE                                            39020005
390300             WHEN SQLCODE = +0                                    39030005
390400             WHEN SQLCODE = +100                                  39040005
390500             WHEN SQLCODE = -904                                  39050005
390600             WHEN SQLCODE = -913                                  39060005
390700                  CONTINUE                                        39070005
390800                                                                  39080005
390900             WHEN SQLWARN0 NOT = SPACES                           39090005
391000             WHEN SQLCODE < +0                                    39100005
391100             WHEN SQLCODE > +0                                    39110005
391200                  MOVE '4320-CHECK-PKSL-IND'                      39120005
391300                                  TO DP013-PARAGRAPH              39130005
391400                  MOVE 'UNSUCCESSFUL COUNT ON TSHPTPO  '          39140005
391500                                  TO DP013-MESSAGE-TEXT (1)       39150005
391600                  MOVE SQLCA      TO DP013-SQLCA                  39160005
391700                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     39170005
391800                  SET DP013-DB2-ABEND                             39180005
391900                      DP013-XCTL-DISPLAY-RESTART                  39190005
392000                                  TO TRUE                         39200005
392100                  PERFORM DP013-0000-PROCESS-ABEND                39210005
392200         END-EVALUATE                                             39220005
392300     END-PERFORM.                                                 39230005
392400                                                                  39240005
392500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39250005
392600         MOVE '4320-CHECK-PKSL-IND'                               39260005
392700                                  TO DP013-PARAGRAPH              39270005
392800         MOVE 'MAX RETRIES EXCEEDED ON COUNT FOR SHIPMENTS'       39280005
392900                                  TO DP013-MESSAGE-TEXT (1)       39290005
393000         MOVE SQLCA               TO DP013-SQLCA                  39300005
393100         MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (1)     39310005
393200         SET DP013-DB2-ABEND                                      39320005
393300             DP013-XCTL-DISPLAY-RESTART                           39330005
393400                                  TO TRUE                         39340005
393500         PERFORM DP013-0000-PROCESS-ABEND                         39350005
393600     END-IF.                                                      39360005
393700/                                                                 39370005
393900*----------------------------------------------------------------*39390006
394000*    DETERMINE IF PO IS RFID, IF SO DISPLAY ON LINE 03           *39400006
394100*    IF RFID CHECK ON THE VENDOR AGREEMENT FLAG AND DISPLAY ALSO *39410006
394200*----------------------------------------------------------------*39420006
394300 4330-DETERMINE-IF-RFID.                                          39430006
394400     SET SU093-PO-LEVEL-CHECK            TO TRUE.                 39440006
394500     SET SU093-RFID-STR-CHK-NEEDED-NO    TO TRUE.                 39450006
394600     SET SU093-CHECK-BY-DEPT-SUBCLS-YES  TO TRUE                  39460006
394700     SET SU093-CHECK-BY-DC               TO TRUE                  39470006
394800                                                                  39480006
394900     MOVE ASC-KEY-PO-NBR               TO SU093-KEY-PO.           39490008
395000     MOVE ASC-OPER-UNT-ID              TO SU093-KEY-OPER-UNT-ID.  39500008
395100                                                                  39510006
395200     CALL SU093-RFID-PGM       USING DFHEIBLK                     39520006
395300                                     SU093-COMMAREA               39530006
395400                                     SU093-ITEM-COMMAREA.         39540006
395500                                                                  39550006
395600     EVALUATE TRUE                                                39560006
395700       WHEN SU093-SUCCESSFUL                                      39570006
395800         IF SU093-RFID-YES                                        39580006
395900            MOVE PC-RFID    TO ASC-RFID-DISPLAYED                 39590010
396000            EVALUATE TRUE                                         39600006
396100              WHEN SU093-VNDR-DPT-RFID-COMPLI-YES                 39610006
396200                   MOVE PC-C TO ASC-VNDR-DISPLAYED                39620010
396300              WHEN SU093-VNDR-DPT-RFID-TAGS-YES                   39630006
396400                   MOVE PC-T TO ASC-VNDR-DISPLAYED                39640010
396500              WHEN OTHER                                          39650009
396600                   MOVE PC-N TO ASC-VNDR-DISPLAYED                39660010
396700             END-EVALUATE                                         39670006
396800         END-IF                                                   39680006
396900      WHEN OTHER                                                  39690006
397000            MOVE '4330-DETERMINE-IF-RFID' TO DP013-PARAGRAPH      39700006
397100            MOVE 'PROBLEM WITH RETURN FROM SUKUT149'              39710006
397200                                       TO DP013-MESSAGE-TEXT (1)  39720006
397300            SET DP013-CICS-ABEND       TO TRUE                    39730006
397400            SET DP013-NO-ROLLBACK      TO TRUE                    39740006
397500            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                39750006
397600     END-EVALUATE.                                                39760006
397800                                                                  39780006
397900*----------------------------------------------------------------*39790005
398000*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *39800005
398100*----------------------------------------------------------------*39810005
398200 4400-MOVE-COMMAREA-TO-SCREEN.                                    39820005
398300                                                                  39830013
398500     MOVE ASC-PO-NBR               TO PV-RN-PO.                   39850014
398600     MOVE ASC-REC-SEQ-NBR          TO PV-RN-SEQ.                  39860014
398700     MOVE PV-RECEIVER-NBR          TO APONBRO.                    39870013
398800     MOVE ASC-PO-STATUS            TO APOSTATO.                   39880005
398900     MOVE ASC-RCVR-STATUS          TO ARCVSTAO.                   39890005
399000     IF ASC-ADJUSTED-PO                                           39900005
399100         MOVE DP015-YELLOW         TO ARCVSTAC                    39910005
399200                                      APCSVERC                    39920005
399300     END-IF.                                                      39930005
399400     MOVE ASC-VENDOR-NAME          TO AVNAMEO.                    39940005
399700     MOVE ASC-BUYER-NAME           TO ABNAMEO.                    39970005
399800     MOVE ASC-RCVR-CREATOR         TO ARCVCRO.                    39980005
399900     MOVE ASC-REC-CLERK            TO ARCVCLO.                    39990005
400000     MOVE ASC-DEPT                 TO ADEPTO.                     40000005
400100     MOVE ASC-TROUB-STATUS-1       TO ATROUBO.                    40010005
400200     MOVE ASC-DO-NOT-SHIP-DATE     TO ADNSHIPO.                   40020005
400300     MOVE ASC-CANCEL-DATE          TO ACANDTEO.                   40030005
400400     MOVE ASC-TRAILER-NBR          TO ATRLRNOO.                   40040005
400500     MOVE ASC-CARRIER              TO ACARRO.                     40050005
400600     IF ASC-TRIP > ZEROES                                         40060005
400700         MOVE ASC-TRIP             TO ATRIPO                      40070005
400800     ELSE                                                         40080005
400900         MOVE SPACES               TO ATRIPO                      40090005
401000     END-IF.                                                      40100005
401100                                                                  40110005
401110     IF ASC-EFC-SHIPMT > SPACES                                   40111020
401120         MOVE ASC-EFC-SHIPMT       TO AEFCSHPO                    40112018
401130     ELSE                                                         40113018
401140         MOVE SPACES               TO AEFCSHPO                    40114018
401150     END-IF.                                                      40115018
401160                                                                  40116018
401200     MOVE ASC-AD-DATE              TO AADDATEO.                   40120005
401400     MOVE ASC-CARR-AUTH-ID         TO ACANO.                      40140005
401600     MOVE ASC-PRO-NUMBER           TO APROO.                      40160005
401601                                                                  40160115
401610     IF  ASC-BOL-NUMBER  >  SPACES                                40161015
401700         MOVE ASC-BOL-NUMBER           TO ABOLO                   40170015
401701     ELSE                                                         40170115
401710         MOVE ASC-PKSLIP-BOL-NBR              TO ABOLO            40171016
401720     END-IF.                                                      40172015
401730                                                                  40173015
401800     MOVE ASC-AD-INFO              TO AADINFOO.                   40180005
401900     MOVE ASC-VDR-SHIP-DATE        TO AVSHPDTO.                   40190005
402000     MOVE ASC-SPEC-INSTRC          TO ASPCINSO.                   40200005
402100     MOVE ASC-CARR-SHIP-DTE        TO ACSHPDTO.                   40210005
402200     MOVE ASC-TKT-DESC             TO ATTYPEO.                    40220005
402300     MOVE ASC-RCVR-NBR             TO ARCVRO.                     40230005
402400     MOVE ASC-ARRIVAL-DATE         TO AARRVDTO.                   40240005
402500     MOVE ASC-OPER-SET-ID-N        TO AOPSETO.                    40250005
402600     MOVE ASC-OPER-SET-DESC        TO AOPDESCO.                   40260005
402700     MOVE ASC-RCV-CRE-DATE         TO ARCVDTEO.                   40270005
402800     MOVE ASC-RCV-CRE-TIME         TO ARCVTMEO.                   40280005
402900     MOVE ASC-APRON-LOC-DESC       TO AAPRLOCO.                   40290005
403000     MOVE ASC-EXPTED-CART-CNT-N    TO ACTNSO.                     40300005
403100     MOVE ASC-TRANSCRIBE-DATE      TO ATRSDTEO.                   40310005
403200     MOVE ASC-TRANSCRIBE-TIME      TO ATRSTMEO.                   40320005
403300     MOVE ASC-IN-TROUB-DATE        TO AINTDTEO.                   40330005
403400     MOVE ASC-IN-TROUB-TIME        TO AINTTMEO.                   40340005
403500     MOVE ASC-ACTL-CART-CNT-N      TO AADJCTNO.                   40350005
403600     MOVE ASC-MK-APRN-DATE         TO AMADTEO.                    40360005
403700     MOVE ASC-MK-APRN-TIME         TO AMATMEO.                    40370005
403800     MOVE ASC-OUT-TROUB-DATE       TO AOUTDTEO.                   40380005
403900     MOVE ASC-OUT-TROUB-TIME       TO AOUTTMEO.                   40390005
404000     MOVE ASC-DMG-CART-CNT-N       TO ADMGCTNO.                   40400005
404100     MOVE ASC-MK-HDR-DATE          TO AMHDTEO.                    40410005
404200     MOVE ASC-MK-HDR-TIME          TO AMHTMEO.                    40420005
404300     MOVE ASC-LAST-CHNG-DATE       TO ALCDTEO.                    40430005
404400     MOVE ASC-LAST-CHNG-TIME       TO ALCTMEO.                    40440005
404500     MOVE ASC-PCS-INVCD-N          TO APCSINVO.                   40450005
404600     MOVE ASC-CHANGD-BY            TO ACBIDO.                     40460005
404700*                                                                 40470005
404800     IF RECEIV-STATUS-CDE = 'VE'                                  40480005
404900        MOVE ASC-PCS-VERFD-N          TO APCSVERO                 40490005
405000     ELSE                                                         40500005
405100        MOVE ASC-PCS-VERFD            TO APCSVERO                 40510005
405200     END-IF                                                       40520005
405300                                                                  40530005
405400     MOVE ASC-ATL-OPER-UNT-ID      TO AOPERO.                     40540005
405500     MOVE ASC-ATL-FCLTY-ID         TO AFCLTYO.                    40550005
405600     MOVE ASC-CUR-OPER-UNT-ID      TO ACOPERO.                    40560005
405700     MOVE ASC-CUR-FCLTY-ID         TO ACFCLTYO.                   40570005
405800     MOVE ASC-ORIG-OPER-UNT-ID      TO AOOPERO.                   40580005
405900     MOVE ASC-ORIG-FCLTY-ID         TO AOFCLTYO.                  40590005
406000     MOVE ASC-VRFD-USR-UID          TO AUPDUIDO.                  40600005
406100     MOVE ASC-PCS-VER-DATE         TO ASHPDTEO.                   40610005
406200     MOVE ASC-PCS-VER-TIME         TO ASHPTMEO.                   40620005
406300                                                                  40630031
406400     IF ASC-REPLENISH-IND = 'Y'                                   40640005
406500         MOVE 'RPLEN'              TO AREPLENO                    40650005
406600     ELSE                                                         40660005
406700         MOVE SPACES               TO AREPLENO                    40670005
406800     END-IF.                                                      40680005
406900                                                                  40690031
407000     MOVE ASC-FRE-ASTRA-IND        TO AFRASIDO.                   40700005
407100     MOVE ASC-REC-TYP              TO ARECTYPO.                   40710005
407200     MOVE ASC-PCS-EXPECTED         TO APCSEXPO                    40720005
407300                                                                  40730031
407400*    THIS IS ON LINE 3 ON THE END OF THE LINE                     40740006
407500     MOVE ASC-RFID-DISPLAYED       TO ARFIDTAO.                   40750006
407600     MOVE ASC-VNDR-DISPLAYED       TO AVNDSTAO.                   40760006
407800                                                                  40780005
407900                                                                  40790005
408000* THIS IS WHAT IS SHOWN INSIDE THE LITTLE BOX AT THE              40800005
408100* LOWER RIGHT OF THE SCREEN                                       40810005
408200     MOVE ASC-PROC-INFO-ASN        TO APIASNO.                    40820005
408300     MOVE ASC-PROC-INFO-GOH        TO APIGOHO.                    40830005
408400     MOVE ASC-PROC-INFO-PRE        TO APIPREO.                    40840005
408500     MOVE ASC-PROC-INFO-PACK       TO APIPACKO.                   40850005
408600     MOVE ASC-PROC-INFO-EDI        TO APIEDIO.                    40860005
408700     MOVE ASC-PROC-INFO-PKG-TYP    TO APKTYPO.                    40870005
408800     MOVE ASC-PROC-INFO-DET        TO APIDETO.                    40880005
408900                                                                  40890005
409000     IF ASC-MULT-SHIP                                             40900005
409100        MOVE PC-TSYMSG-01090 TO DP020-MSG-NUMBER                  40910005
409200        SET  DP020-MSG-WARNING TO TRUE                            40920005
409300     END-IF.                                                      40930005
409310                                                                  40931024
409320     IF  ASC-BULK-MIX-SKU-YES                                     40932024
409330         MOVE 'BULK RCVR W/MIXED SKU CASE'  TO ABMSGO             40933024
409331         MOVE DP015-RED                     TO ABMSGC             40933124
409332     ELSE                                                         40933224
409333         MOVE DP015-BLUE                    TO ABMSGC             40933324
409340     END-IF.                                                      40934024
409350                                                                  40935024
409400/                                                                 40940005
409500*----------------------------------------------------------------*40950005
409600*    GET THE BUYER NAME AND NUMBER INFORMATION FROM THE MBS      *40960005
409700*    TABLES USING SUBROUTINE 'DPKUT038'.                         *40970005
409800*----------------------------------------------------------------*40980005
409900 7000-GET-BUYER-NAME.                                             40990005
410000                                                                  41000005
410100     INITIALIZE ASC-BUYER-NAME.                                   41010005
410200                                                                  41020005
410300     EXEC CICS                                                    41030005
410400         ASKTIME ABSTIME (ST-ABSTIME)                             41040005
410500     END-EXEC.                                                    41050005
410600                                                                  41060005
410700     EXEC CICS                                                    41070005
410800         FORMATTIME ABSTIME (ST-ABSTIME)                          41080005
410900                    YYMMDD  (PV-CURRENT-DATE)                     41090005
411000     END-EXEC.                                                    41100005
411100                                                                  41110005
411200     MOVE PURCHS-DEPT-NBR              TO DP003-DPT-INPUT.        41120005
411300     SET DP003-BYR-LOOKUP-NAME         TO TRUE.                   41130005
411400     SET DP003-BYR-NAME-FIRST-LAST     TO TRUE.                   41140005
411500                                                                  41150005
411600     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      41160005
411700     MOVE '03'                         TO DP003-OP-CO-NMBR.       41170005
411800     MOVE PV-CURRENT-DATE              TO DP003-CURRENT-DATE      41180005
411900                                          DP003-EFF-DATE.         41190005
412000                                                                  41200005
412100     EXEC CICS                                                    41210005
412200         LINK PROGRAM  (PV-DPKUT038)                              41220005
412300              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              41230005
412400              LENGTH   (PV-DPKUT038-CA-LENGTH)                    41240005
412500              RESP     (PV-CICS-RESPONSE)                         41250005
412600     END-EXEC.                                                    41260005
412700                                                                  41270005
412800     EVALUATE TRUE                                                41280005
412900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 41290005
413000              CONTINUE                                            41300005
413100         WHEN OTHER                                               41310005
413200              MOVE '7000-GET-BUYER-NAME' TO DP013-PARAGRAPH       41320005
413300              MOVE 'CANNOT LINK TO DPKUT038'                      41330005
413400                                         TO DP013-MESSAGE-TEXT (1)41340005
413500              SET DP013-CICS-ABEND       TO TRUE                  41350005
413600              SET DP013-NO-ROLLBACK      TO TRUE                  41360005
413700              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              41370005
413800     END-EVALUATE.                                                41380005
413900                                                                  41390005
414000     IF  PS-NO-ERROR                                              41400005
414100         EVALUATE TRUE                                            41410005
414200             WHEN DP003-SUCCESSFUL                                41420005
414300                  MOVE DP003-BYR-NAME  TO ASC-BUYER-NAME          41430005
414400                                                                  41440005
414500             WHEN DP003-BYR-NAME-NOT-FOUND                        41450005
414600                  MOVE '* NO BUYER NAME FOUND * '                 41460005
414700                                       TO ASC-BUYER-NAME          41470005
414800                                                                  41480005
414900             WHEN DP003-BYR-NAME-DB2-ERROR                        41490005
415000                  MOVE '7000-GET-BUYER-NAME'                      41500005
415100                                       TO DP013-PARAGRAPH         41510005
415200                  MOVE DP003-RETURN-MSG                           41520005
415300                                       TO DP013-MESSAGE-TEXT (1)  41530005
415400                  MOVE DP003-DPT-INPUT TO DP013-MESSAGE-TEXT (2)  41540005
415500                  MOVE DP003-SQLCA     TO DP013-SQLCA             41550005
415600                  MOVE 'TMDSEAR'       TO DP013-DB2-TABLE-NAME (1)41560005
415700                  MOVE 'TAPLAVL'       TO DP013-DB2-TABLE-NAME (2)41570005
415800                  MOVE 'TRSPBAR'       TO DP013-DB2-TABLE-NAME (3)41580005
415900                  SET DP013-DB2-ABEND    TO TRUE                  41590005
416000                  SET DP013-NO-ROLLBACK  TO TRUE                  41600005
416100                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          41610005
416200                                                                  41620005
416300             WHEN DP003-BYR-NAME-MAX-RETRIES                      41630005
416400                  MOVE '7000-GET-BUYER-NAME'                      41640005
416500                                       TO DP013-PARAGRAPH         41650005
416600                  MOVE DP003-RETURN-MSG                           41660005
416700                                       TO DP013-MESSAGE-TEXT (1)  41670005
416800                  MOVE DP003-DPT-INPUT TO DP013-MESSAGE-TEXT (2)  41680005
416900                  MOVE DP003-SQLCA     TO DP013-SQLCA             41690005
417000                  MOVE 'TMDSEAR'       TO DP013-DB2-TABLE-NAME (1)41700005
417100                  MOVE 'TAPLAVL'       TO DP013-DB2-TABLE-NAME (2)41710005
417200                  MOVE 'TRSPBAR'       TO DP013-DB2-TABLE-NAME (3)41720005
417300                  SET DP013-DB2-ABEND     TO TRUE                 41730005
417400                  SET DP013-NO-ROLLBACK   TO TRUE                 41740005
417500                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          41750005
417600                                                                  41760005
417700             WHEN OTHER                                           41770005
417800                  MOVE '7000-GET-BUYER-NAME'                      41780005
417900                                       TO DP013-PARAGRAPH         41790005
418000                  MOVE DP003-RETURN-MSG                           41800005
418100                      TO DP013-MESSAGE-TEXT (1)                   41810005
418200                  MOVE DP003-DPT-INPUT TO DP013-MESSAGE-TEXT (2)  41820005
418300                  MOVE DP003-SQLCA     TO DP013-SQLCA             41830005
418400                  MOVE 'TMDSEAR'       TO DP013-DB2-TABLE-NAME (1)41840005
418500                  MOVE 'TAPLAVL'       TO DP013-DB2-TABLE-NAME (2)41850005
418600                  MOVE 'TRSPBAR'       TO DP013-DB2-TABLE-NAME (3)41860005
418700                  SET DP013-OTHER-ABEND  TO TRUE                  41870005
418800                  SET DP013-NO-ROLLBACK  TO TRUE                  41880005
418900                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          41890005
419000       END-EVALUATE.                                              41900005
419100                                                                  41910005
419200 7050-GET-INVOICED-PCS.                                           41920005
419300                                                                  41930005
419400     INITIALIZE PA-INVOICED-COUNT                                 41940005
419500     EXEC SQL                                                     41950005
419600         SELECT                                                   41960005
419700             SUM(ITEM.ORIG_PKSL_ITM_QTY)                          41970005
419800                INTO                                              41980005
419900                   :PA-INVOICED-COUNT                             41990005
420000                FROM                                              42000005
420100                   TPKSLIP SLIP                                   42010005
420200                 , TPKITEM ITEM                                   42020005
420300               WHERE                                              42030005
420400                     SLIP.PO_NBR        = :DK-PO-NBR              42040005
420500                 AND SLIP.REC_SEQ_NBR   = :DK-REC-SEQ-NBR         42050005
420600                 AND SLIP.PO_NBR        = ITEM.PO_NBR             42060005
420700                 AND SLIP.SEQ_NBR       = ITEM.SEQ_NBR            42070005
420800                 AND SLIP.VER_STAT_CDE  = 'A'                     42080005
420810                WITH UR                                           42081030
420900         END-EXEC                                                 42090005
421000                                                                  42100005
421100         EVALUATE TRUE                                            42110005
421200             WHEN SQLCODE = +0                                    42120005
421300             WHEN SQLCODE = +100                                  42130005
421400             WHEN SQLCODE = -305                                  42140005
421500                 CONTINUE                                         42150005
421600                                                                  42160031
421800             WHEN SQLCODE = -904                                  42180005
421900             WHEN SQLCODE = -913                                  42190005
422000             WHEN SQLCODE = -911                                  42200005
422100                 MOVE '4270-SELECT-TPKSLIP'                       42210005
422200                                  TO DP013-PARAGRAPH              42220005
422300                 MOVE 'DEADLOCK SELECTING TPKSLIP  '              42230005
422400                                  TO DP013-MESSAGE-TEXT (1)       42240005
422500                 MOVE SQLCA       TO DP013-SQLCA                  42250005
422600                 MOVE 'TPKSLIP '  TO DP013-DB2-TABLE-NAME (1)     42260005
422700                 MOVE 'TPKITEM '  TO DP013-DB2-TABLE-NAME (2)     42270005
422800                 SET DP013-DB2-ABEND                              42280005
422900                     DP013-XCTL-DISPLAY-RESTART                   42290005
423000                                          TO TRUE                 42300005
423100                 PERFORM DP013-0000-PROCESS-ABEND                 42310005
423200                                                                  42320005
423300             WHEN SQLWARN0 NOT = SPACES                           42330005
423400             WHEN SQLCODE < +0                                    42340005
423500             WHEN SQLCODE > +0                                    42350005
423600                  MOVE '7050-GET-EXPECTED-PCS'                    42360005
423700                                  TO DP013-PARAGRAPH              42370005
423800                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP  '         42380005
423900                                  TO DP013-MESSAGE-TEXT (1)       42390005
424000                  MOVE SQLCA      TO DP013-SQLCA                  42400005
424100                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)     42410005
424200                  MOVE 'TPKITEM ' TO DP013-DB2-TABLE-NAME (2)     42420005
424300                  SET DP013-DB2-ABEND                             42430005
424400                      DP013-XCTL-DISPLAY-RESTART                  42440005
424500                                  TO TRUE                         42450005
424600                  PERFORM DP013-0000-PROCESS-ABEND                42460005
424700     END-EVALUATE.                                                42470005
424800/                                                                 42480005
424900*----------------------------------------------------------------*42490005
425000*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *42500005
425100*----------------------------------------------------------------*42510005
425200                                                                  42520005
425300 9100-READ-SEL-QUEUE.                                             42530005
425400     EXEC CICS                                                    42540005
425500         READQ TS                                                 42550005
425600             QUEUE (ASC-SEL-QUEUE-NAME)                           42560005
425700             INTO  (RC013-DC-SELECT-RECORD)                       42570005
425800             ITEM  (ASC-SEL-ITEM)                                 42580005
425900             RESP  (PV-CICS-RESPONSE)                             42590005
426000     END-EXEC.                                                    42600005
426100                                                                  42610005
426200     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   42620005
426300         CONTINUE                                                 42630005
426400     ELSE                                                         42640005
426500         SET DP013-LOGIC-ABEND                                    42650005
426600             DP013-NO-ROLLBACK     TO TRUE                        42660005
426700         MOVE '9100-READ-SEL-QUEUE'                               42670005
426800                                   TO DP013-PARAGRAPH             42680005
426900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   42690005
427000                                   TO DP013-MESSAGE-TEXT (1)      42700005
427100         PERFORM DP013-0000-PROCESS-ABEND                         42710005
427200     END-IF.                                                      42720005
427300                                                                  42730005
427400/                                                                 42740005
427500*----------------------------------------------------------------*42750005
427600*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *42760005
427700*----------------------------------------------------------------*42770005
427800 9200-REWRITE-LIST-QUEUE.                                         42780005
427900     EXEC CICS                                                    42790005
428000          WRITEQ TS                                               42800005
428100              QUEUE  (ASC-SEL-QUEUE-NAME)                         42810005
428200              FROM   (RC013-DC-SELECT-RECORD)                     42820005
428300              ITEM   (ASC-SEL-ITEM)                               42830005
428400              RESP   (PV-CICS-RESPONSE)                           42840005
428500              REWRITE                                             42850005
428600     END-EXEC.                                                    42860005
428700                                                                  42870005
428800     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               42880005
428900         SET DP013-CICS-ABEND                                     42890005
429000             DP013-NO-ROLLBACK     TO TRUE                        42900005
429100         MOVE '9200-REWRITE-LIST-QUEUE'                           42910005
429200                                   TO DP013-PARAGRAPH             42920005
429300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   42930005
429400                                   TO DP013-MESSAGE-TEXT (1)      42940005
429500         PERFORM DP013-0000-PROCESS-ABEND                         42950005
429600     END-IF.                                                      42960005
429700                                                                  42970005
429800/                                                                 42980005
429900*----------------------------------------------------------------*42990005
430000*    WRITE A FORMATTED MESSAGE OUT TO THE CICS LOG FILE          *43000005
430100*----------------------------------------------------------------*43010005
430200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  43020005
430300                                                                  43030005
430400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              43040005
430500     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             43050005
430600     INITIALIZE DP013-SRC-TASK-NUMBER                             43060005
430700                DP013-STACK.                                      43070005
430800     SET DP013-LINK-RETURN         TO TRUE.                       43080005
430900                                                                  43090005
431000     EXEC CICS                                                    43100005
431100         LINK PROGRAM  (DP013-NAME)                               43110005
431200              COMMAREA (DP013-PARAMETERS)                         43120005
431300              LENGTH   (DP013-LENGTH)                             43130005
431400     END-EXEC.                                                    43140005
431500/                                                                 43150005
431600*----------------------------------------------------------------*43160005
431700*    ABEND PROCESSOR MODULE                                      *43170005
431800*----------------------------------------------------------------*43180005
431900                                                                  43190005
432000     COPY DPPD013.                                                43200005
