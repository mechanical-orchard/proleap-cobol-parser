000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400                                                                  00040001
000500 PROGRAM-ID.             SUKRP005.                                00050001
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN            JUNE, 1996.                              00080001
000900 DATE-COMPILED.                                                   00090001
001000***************************************************************** 00100001
001100***************************************************************** 00110001
001200*                                                               * 00120001
001300*  THIS PROGRAM WILL PRINT THE FREE ASTRAY SHIPPING UNITS REPORT* 00130001
001400*  THIS IS PRODUCED FOLLOWING THE CHECK-IN OF A TRAILER         * 00140001
001500*  WHICH HAS HAD THE CARTONS SCANNED USING THE LRT TERMINAL.    * 00150001
001600***************************************************************** 00160001
001700*  CHANGED 08/07/2000 BY LARRY SCHLEICHER                       * 00170001
001800*   WR# 20694 USE THE DEST-OPER-UNT-ID FIELD FROM THE TSULBXF   * 00180001
001900*             TABLE TO FILL IN THE 'STR NBR' FIELD ON THE REPORT* 00190001
002000***************************************************************** 00200001
002100*  CHANGED 10/25/02 BY ALBERT A VINOD                           * 00210001
002200*   WR# 21361 THE REFERENCES TO TSK TABLE IS REMOVED AND DEPT,  * 00220001
002300*             CLASS AND 8 DIGIT SKU NUMBER IS RETRIVED BY       * 00230001
002400*             CALLING XLKUT001. REPORT LAYOUT WAS MODIFIED TO   * 00240001
002500*             ACCOMODATE 8 DIGIT SKU NUMBER.                    * 00250001
002000***************************************************************** 00251003
002100*  CHANGED 09/30/14 BY CHERI PARMLEY                            * 00252003
002200*   CHG# 0094517  EXPANED PO FROM 7 TO 8 DIGITS                 * 00253004
002600***************************************************************** 00260001
002700*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00270001
002800*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00280001
002900*                                                               * 00290001
003000***************************************************************** 00300001
003100***************************************************************** 00310001
003200 ENVIRONMENT DIVISION.                                            00320001
003300***************************************************************** 00330001
003400                                                                  00340001
003500 CONFIGURATION SECTION.                                           00350001
003600                                                                  00360001
003700 SOURCE-COMPUTER.        IBM-3090.                                00370001
003800 OBJECT-COMPUTER.        IBM-3090.                                00380001
003900                                                                  00390001
004000 INPUT-OUTPUT SECTION.                                            00400001
004100                                                                  00410001
004200 FILE-CONTROL.                                                    00420001
004300*                                                                 00430001
004400     SELECT EXTRACT-FILE                                          00440001
004500         ASSIGN TO INP01.                                         00450001
004600                                                                  00460001
004700     SELECT SU-CARTON-NOT-RCVD-FILE                               00470001
004800         ASSIGN TO RPT01.                                         00480001
004900*                                                                 00490001
005000***************************************************************** 00500001
005100 DATA DIVISION.                                                   00510001
005200***************************************************************** 00520001
005300*                                                                 00530001
005400 FILE SECTION.                                                    00540001
005500*                                                                 00550001
005600 FD  EXTRACT-FILE                                                 00560001
005700     LABEL RECORDS ARE STANDARD                                   00570001
005800     RECORDING MODE IS F                                          00580001
005900     BLOCK CONTAINS 0 RECORDS                                     00590001
006000     RECORD CONTAINS 200 CHARACTERS.                              00600001
006100 01  EXTRACT-RECORD                  PIC X(200).                  00610001
006200                                                                  00620001
006300 FD  SU-CARTON-NOT-RCVD-FILE                                      00630001
006400     RECORDING MODE IS F                                          00640001
006500     BLOCK CONTAINS 0  RECORDS.                                   00650001
006600 01  SU-CARTON-NOT-RCVD-RECORD       PIC  X(132).                 00660001
006700*                                                                 00670001
006800                                                                  00680001
006900 WORKING-STORAGE SECTION.                                         00690001
007000**************************************************************    00700001
007100* FORMAT OF THE CONTROL CARD INFORMATION PASSED INTO THE PGM *    00710001
007200**************************************************************    00720001
007300 01  CC-CONTROL-CARD.                                             00730001
007400     05  CC-PRINTER-ID                PIC  X(08).                 00740001
007500     05  CC-PRTR-CNTL-IND             PIC  X(01).                 00750001
007600     05  CC-TRACK-NBR                 PIC  9(01).                 00760001
007700     05  FILLER                       PIC  X(01).                 00770001
007800     05  CC-CUT-REPORT                PIC  X(01).                 00780001
007900         88 CC-CUT-REPORT-AT-END                   VALUE 'C'.     00790001
008000     05  CC-REQUESTOR-ID              PIC  X(08).                 00800001
008100     05  CC-PRINT-SUKRP002-IND        PIC  X(01).                 00810001
008200         88 CC-PRINT-SUKRP002                      VALUE 'Y'.     00820001
008300     05  CC-PRINT-SUKRP003-IND        PIC  X(01).                 00830001
008400         88 CC-PRINT-SUKRP003                      VALUE 'Y'.     00840001
008500     05  CC-PRINT-SUKRP004-IND        PIC  X(01).                 00850001
008600         88 CC-PRINT-SUKRP004                      VALUE 'Y'.     00860001
008700     05  CC-PRINT-SUKRP005-IND        PIC  X(01).                 00870001
008800         88 CC-PRINT-SUKRP005                      VALUE 'Y'.     00880001
008900     05  CC-PRINT-SUKRP006-IND        PIC  X(01).                 00890001
009000         88 CC-PRINT-SUKRP006                      VALUE 'Y'.     00900001
009100     05  CC-PRINT-SUKRP007-IND        PIC  X(01).                 00910001
009200         88 CC-PRINT-SUKRP007                      VALUE 'Y'.     00920001
009300     05  CC-PRINT-SUKRP008-IND        PIC  X(01).                 00930001
009400         88 CC-PRINT-SUKRP008                      VALUE 'Y'.     00940001
009500     05  CC-PRINT-SUKRP023-IND        PIC  X(01).                 00950001
009600         88 CC-PRINT-SUKRP023                      VALUE 'Y'.     00960001
009700     05  FILLER                       PIC  X(01).                 00970001
009800     05  CC-PRINT-ALL-PO-IND          PIC  X(01).                 00980001
009900         88 CC-PRINT-ENTIRE-TRIP                   VALUE 'Y'.     00990001
010000         88 CC-PRINT-SELECTED-PO                   VALUE 'N'.     01000001
010100*                                                                 01010001
010200 01  PROGRAM-SWITCHES.                                            01020001
010300     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     01030001
010400         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     01040001
010500     05  PS-STATUS-FOUND-SW          PIC  X(01)    VALUE 'N'.     01050001
010600         88  PS-STATUS-FOUND                       VALUE 'Y'.     01060001
010700         88  PS-STATUS-NOT-FOUND                   VALUE 'N'.     01070001
010800     05  PS-EOF-UPC-CURSOR-IND       PIC  X(01)    VALUE 'N'.     01080001
010900         88  PS-EOF-UPC-CURSOR                     VALUE 'Y'.     01090001
011000         88  PS-NOT-EOF-UPC-CURSOR                 VALUE 'N'.     01100001
011100     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     01110001
011200         88  PS-ERROR-RECORD                       VALUE 'A'.     01120001
011300         88  PS-DETAIL-RECORD                      VALUE 'B'.     01130001
011400     05  PS-PRT-HEADING-SW           PIC  X(01)    VALUE 'Y'.     01140001
011500         88  PS-PRT-HEADING                        VALUE 'Y'.     01150001
011600         88  PS-NOT-PRT-HEADING                    VALUE 'N'.     01160001
011700*                                                                 01170001
011800 01  DN-DB2-NULL-INDICATORS.                                      01180001
011900     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01190001
012000*                                                                 01200001
012100 01  PC-CONSTANTS.                                                01210001
012200     05  PC-1                        PIC S9(03)    VALUE +1       01220001
012300                                                   COMP-3.        01230001
012400     05  PC-2                        PIC S9(03)    VALUE +2       01240001
012500                                                   COMP-3.        01250001
012600     05  PC-3                        PIC S9(03)    VALUE +3       01260001
012700                                                   COMP-3.        01270001
012800     05  PC-7                        PIC S9(01)    VALUE +7.      01280001
012900     05  PC-11                       PIC S9(03)    VALUE +11      01290001
013000                                                   COMP-3.        01300001
013100     05  PC-56                       PIC S9(03)    VALUE +56      01310001
013200                                                   COMP-3.        01320001
013300     05  PC-60                       PIC S9(03)    VALUE +60      01330001
013400                                                   COMP-3.        01340001
013500     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01350001
013600     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01360001
013700     05  PC-00                       PIC  X(02)    VALUE '00'.    01370001
013800     05  PC-UG                       PIC  X(02)    VALUE 'UG'.    01380001
013900     05  PC-UN                       PIC  X(02)    VALUE 'UN'.    01390001
014000     05  PC-AR                       PIC  X(02)    VALUE 'AR'.    01400001
014100     05  PC-MLT                      PIC  X(03)    VALUE 'MLT'.   01410001
014200     05  PC-A                        PIC  X(01)    VALUE 'A'.     01420001
014300     05  PC-SUKRP005                 PIC  X(08)    VALUE          01430001
014400         'SUKRP005'.                                              01440001
014500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01450001
014600     05  PC-NO-SKU                   PIC  X(11)    VALUE          01460001
014700         '  NO SKU'.                                              01470001
014800                                                                  01480001
014900 01  DK-DB2-KEYS.                                                 01490001
      *CLP 09/30/14                                                     01491003
015000     05  DK-PO-NBR                 PIC S9(08)  VALUE +0 COMP.     01500003
015100     05  DK-REC-SEQ-NBR            PIC S9(09)  VALUE +0 COMP.     01510001
015200     05  DK-SHIPT-UNT-ID           PIC S9(18)V COMP-3.            01520001
015300*                                                                 01530001
015400 01  PV-MISC-FIELDS.                                              01540001
015500     05  PV-LINE-SUB                 PIC S9(03)    VALUE +0       01550001
015600                                                   COMP-3.        01560001
015700     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01570001
015800                                                   COMP-3.        01580001
015900     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01590001
016000                                                   COMP-3.        01600001
016100     05  PV-STATUS                   PIC  X(02).                  01610001
      *CLP 09/30/14                                                     01611003
016200     05  PV-SAVE-PO-RECEIVER         PIC  X(12).                  01620003
016300     05  PV-SAVE-STORE-NBR           PIC  X(04).                  01630001
016400     05  PV-DISPLAY-SKU-SQLCODE      PIC  ZZZZZZZZ9.              01640001
016500     05  PV-DISPLAY-UPC-SQLCODE      PIC  ZZZZZZZZ9.              01650001
016600     05  PV-DISPLAY-VS-SQLCODE       PIC  ZZZZZZZZ9.              01660001
016700     05  PV-DISPLAY-PO-NBR           PIC  X(08).                  01670001
016800     05  PV-DISPLAY-REC-SEQ-NBR      PIC  X(08).                  01680001
016900     05  PV-TRIP-ID                  PIC S9(9) COMP.              01690001
017000     05  SAVE-SHIPT-UNT-ID           PIC S9(18) COMP-3.           01700001
017100     05  PV-MANIFEST-X               PIC  X(09).                  01710001
017200     05  PV-MANIFEST REDEFINES PV-MANIFEST-X                      01720001
017300                                     PIC  9(09).                  01730001
017400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01740001
017500                                                   COMP SYNC.     01750001
017600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01760001
017700     05  PV-UPC-NBR                  PIC  9(15)    VALUE ZERO.    01770001
017800     05  PV-PO-RECEIVER.                                          01780001
      *CLP 09/30/14                                                     01781003
017900         10  PV-PO                   PIC  9(08)    VALUE ZERO.    01790003
018000         10  FILLER                  PIC  X(01)    VALUE '-'.     01800001
018100         10  PV-RECEIVER             PIC  9(03)    VALUE ZERO.    01810001
018200     05  PV-STORE-NBR-CHAR           PIC  X(03)    VALUE SPACES.  01820001
018300     05  PV-TODAYS-DATE.                                          01830001
018400         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01840001
018500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01850001
018600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01860001
018700     05  PV-TODAYS-TIME.                                          01870001
018800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01880001
018900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01890001
019000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01900001
019100         10  FILLER                  PIC  9(02)    VALUE ZERO.    01910001
019200     05  PV-DB2-DATE.                                             01920001
019300         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    01930001
019400         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    01940001
019500         10  FILLER                  PIC  X(01)    VALUE ZERO.    01950001
019600         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    01960001
019700         10  FILLER                  PIC  X(01)    VALUE ZERO.    01970001
019800         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    01980001
019900     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 01990001
020000     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    02000001
020100         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 02010001
020200         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 02020001
020300         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 02030001
020400         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 02040001
020500     05  PV-OUT-SERIAL-SHIP-CODE.                                 02050001
020600         10  FILLER                   PIC  X(05)    VALUE '(00) '.02060001
020700         10  PV-OUT-S-S-C-1           PIC  X(01).                 02070001
020800         10  FILLER                   PIC  X(01) VALUE SPACES.    02080001
020900         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 02090001
021000         10  FILLER                   PIC  X(01) VALUE SPACES.    02100001
021100         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 02110001
021200         10  FILLER                   PIC  X(01) VALUE SPACES.    02120001
021300         10  PV-OUT-S-S-C-18          PIC  X(01).                 02130001
021400     05  PV-STR-NBR-NUMERIC           PIC  9(4).                  02140001
021500     05  PV-STR-NBR REDEFINES PV-STR-NBR-NUMERIC.                 02150001
021600         10  PV-STR-NBR-1             PIC  X(01).                 02160001
021700         10  PV-STR-NBR-2-4           PIC  X(03).                 02170001
021800     05  PV-EXPTED-QTY                PIC S9(05)    VALUE ZERO    02180001
021900                                                    COMP-3.       02190001
022000     05  PV-LINE-TOT-QTY              PIC S9(05)    VALUE ZERO    02200001
022100                                                    COMP-3.       02210001
022200     05  PV-SAVE-TRN-LNE-NBR          PIC S9(09) COMP.            02220001
022300     05  PV-SAVE-MERCH-DEPT-NMBR      PIC  X(03).                 02230001
022400     05  PV-SAVE-MERCH-CLASS-NMBR     PIC  X(02).                 02240001
022500******************************************************************02250001
022600*  REMOVED VARIABLE PV-SAVE-SEQ-NMBR AND ADDED NEW     WR# 21361 *02260001
022700*  PV-SAVE-SKU-NBR 9(8)COMP-3.                                   *02270001
022800******************************************************************02280001
022900     05  PV-SAVE-SKU-NBR              PIC  9(08) COMP-3.          02290001
023000******************************************************************02300001
023100*  REPLACED VARAIBLE PV-SKU-SEQ WITH NEW VARIABLE      WR# 21361 *02310001
023200*  PV-SKU-NBR 9(8). CHANGED THE VALUE OF FILLER TO SPACES.       *02320001
023300******************************************************************02330001
023400     05  PV-SKU.                                                  02340001
023500         10  PV-SKU-DEPT              PIC  X(03)    VALUE SPACES. 02350001
023600         10  FILLER                   PIC  X(01)    VALUE SPACES. 02360001
023700         10  PV-SKU-CLASS             PIC  X(02)    VALUE SPACES. 02370001
023800         10  FILLER                   PIC  X(01)    VALUE SPACES. 02380001
023900         10  PV-SKU-NBR               PIC  9(08)    VALUE ZEROS.  02390001
024000*                                                                 02400001
024100******************************************************************02410001
024200*  ADDED COPYBOOK FOR XLKUT001                         WR# 21361 *02420001
024300******************************************************************02430001
024400     COPY XLWS001.                                                02440001
024500                                                                  02450001
024600******************************************************************02460001
024700*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *02470001
024800******************************************************************02480001
024900*                                                                 02490001
025000     COPY DPWS024.                                                02500001
025100*                                                                 02510001
025200     COPY SURD001.                                                02520001
025300 EJECT                                                            02530001
025400*                                                                 02540001
025500******************************************************************02550001
025600*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02560001
025700******************************************************************02570001
025800     COPY DPWS132O.                                               02580001
025900*                                                                 02590001
026000*                                                                 02600001
026100 01  HEADING-LINES.                                               02610001
026200     05  HEADING-LINE-0.                                          02620001
026300         10  FILLER                  PIC  X(50)    VALUE SPACES.  02630001
026400         10  FILLER                  PIC  X(32)    VALUE          02640001
026500             'CHECK-IN COMPLETION - EXCEPTIONS'.                  02650001
026600         10  FILLER                  PIC  X(50)    VALUE SPACES.  02660001
026700*                                                                 02670001
026800     05  HEADING-LINE-1.                                          02680001
026900         10  FILLER                  PIC  X(05)    VALUE SPACES.  02690001
027000         10  FILLER                  PIC  X(40)    VALUE          02700001
027100             '****************************************'.          02710001
027200         10  FILLER                  PIC  X(08)    VALUE SPACES.  02720001
027300         10  FILLER                  PIC  X(26)    VALUE          02730001
027400             'FREE ASTRAY SHIPPING UNITS' .                       02740001
027500         10  FILLER                  PIC  X(53)    VALUE SPACES.  02750001
027600*                                                                 02760001
027700     05  HEADING-LINE-1A.                                         02770001
027800         10  FILLER                  PIC  X(05)    VALUE SPACES.  02780001
027900         10  FILLER                  PIC  X(03)    VALUE '*  '.   02790001
028000         10  HL1A-CC-IND-DESC        PIC  X(36)    VALUE SPACES.  02800001
028100         10  FILLER                  PIC  X(01)    VALUE '*'.     02810001
028200         10  FILLER                  PIC  X(87)    VALUE SPACES.  02820001
028300*                                                                 02830001
028400     05  HEADING-LINE-1B.                                         02840001
028500         10  FILLER                  PIC  X(05)    VALUE SPACES.  02850001
028600         10  FILLER                  PIC  X(40)    VALUE          02860001
028700             '****************************************'.          02870001
028800         10  FILLER                  PIC  X(87)    VALUE SPACES.  02880001
028900*                                                                 02890001
029000     05  HEADING-LINE-2.                                          02900001
029100         10  FILLER                  PIC  X(03)    VALUE SPACE.   02910001
029200         10  FILLER                  PIC  X(09)    VALUE          02920001
029300             'CARRIER: '.                                         02930001
029400         10  HL2-SCAC                PIC  X(04)    VALUE SPACES.  02940001
029500         10  FILLER                  PIC  X(03)    VALUE SPACE.   02950001
029600         10  FILLER                  PIC  X(09)    VALUE          02960001
029700             'TRAILER: '.                                         02970001
029800         10  HL2-TRAILER             PIC  X(10)    VALUE SPACES.  02980001
029900         10  FILLER                  PIC  X(04)    VALUE SPACE.   02990001
030000         10  FILLER                  PIC  X(09)    VALUE          03000001
030100             'TRIP ID: '.                                         03010001
030200         10  HL2-TRIP-ID             PIC  X(11)    VALUE SPACES.  03020001
030300         10  FILLER                  PIC  X(14)    VALUE SPACE.   03030001
030400         10  FILLER                  PIC  X(16)    VALUE          03040001
030500             'TRAILER STATUS: '.                                  03050001
030600         10  HL2-TRAILER-STAT        PIC  X(02)    VALUE SPACES.  03060001
030700         10  FILLER                  PIC  X(38)    VALUE SPACES.  03070001
030800*                                                                 03080001
030900     05  HEADING-LINE-3.                                          03090001
031000         10  FILLER                  PIC  X(03)    VALUE SPACES.  03100001
031100         10  FILLER                  PIC  X(16)    VALUE          03110001
031200             'ARRIVAL DATE:   '.                                  03120001
031300         10  HL3-ARRIVAL-DATE.                                    03130001
031400             15  HL3-ARRIVAL-DATE-MM                              03140001
031500                                     PIC  X(02)    VALUE SPACES.  03150001
031600             15  FILLER              PIC  X(01)    VALUE '/'.     03160001
031700             15  HL3-ARRIVAL-DATE-DD                              03170001
031800                                     PIC  X(02)    VALUE SPACES.  03180001
031900             15  FILLER              PIC  X(01)    VALUE '/'.     03190001
032000             15  HL3-ARRIVAL-DATE-CC                              03200001
032100                                     PIC  X(02)    VALUE SPACES.  03210001
032200             15  HL3-ARRIVAL-DATE-YY                              03220001
032300                                     PIC  X(02)    VALUE SPACES.  03230001
032400         10  FILLER                  PIC  X(11)    VALUE SPACES.  03240001
032500         10  FILLER                  PIC  X(23)    VALUE          03250001
032600             'BEGIN UNLOADING DATE:  '.                           03260001
032700         10  HL3-BEG-UNLOAD-DATE.                                 03270001
032800             15  HL3-BEG-UNLOAD-DATE-MM                           03280001
032900                                     PIC  X(02)    VALUE SPACES.  03290001
033000             15  FILLER              PIC  X(01)    VALUE '/'.     03300001
033100             15  HL3-BEG-UNLOAD-DATE-DD                           03310001
033200                                     PIC  X(02)    VALUE SPACES.  03320001
033300             15  FILLER              PIC  X(01)    VALUE '/'.     03330001
033400             15  HL3-BEG-UNLOAD-DATE-CC                           03340001
033500                                     PIC  X(02)    VALUE SPACES.  03350001
033600             15  HL3-BEG-UNLOAD-DATE-YY                           03360001
033700                                     PIC  X(02)    VALUE SPACES.  03370001
033800         10  FILLER                  PIC  X(03)    VALUE SPACES.  03380001
033900         10  FILLER                  PIC  X(15)    VALUE          03390001
034000             'UNLOADED DATE: '.                                   03400001
034100         10  HL3-UNLOADED-DATE.                                   03410001
034200             15  HL3-UNLOADED-DATE-MM                             03420001
034300                                     PIC  X(02)    VALUE SPACES.  03430001
034400             15  FILLER              PIC  X(01)    VALUE '/'.     03440001
034500             15  HL3-UNLOADED-DATE-DD                             03450001
034600                                     PIC  X(02)    VALUE SPACES.  03460001
034700             15  FILLER              PIC  X(01)    VALUE '/'.     03470001
034800             15  HL3-UNLOADED-DATE-CC                             03480001
034900                                     PIC  X(02)    VALUE SPACES.  03490001
035000             15  HL3-UNLOADED-DATE-YY                             03500001
035100                                     PIC  X(02)    VALUE SPACES.  03510001
035200         10  FILLER                  PIC  X(31)    VALUE SPACES.  03520001
035300*                                                                 03530001
035400     05  HEADING-LINE-4.                                          03540001
035500         10  FILLER                  PIC  X(05)    VALUE SPACES.  03550001
035600         10  FILLER                  PIC  X(08)    VALUE          03560001
035700             'ORIGINAL'.                                          03570001
035800         10  FILLER                  PIC  X(28)    VALUE SPACES.  03580001
035900         10  FILLER                  PIC  X(28)    VALUE          03590001
036000             '--------------------------- '.                      03600001
036100         10  FILLER                  PIC  X(29)    VALUE          03610001
036200             'ORIGINAL TRAILER INFORMATION '.                     03620001
036300         10  FILLER                  PIC  X(28)    VALUE          03630001
036400             '--------------------------- '.                      03640001
036500*                                                                 03650001
036600******************************************************************03660001
036700*  ADJUSTED THE FILLERS.                               WR# 21361 *03670001
036800******************************************************************03680001
036900     05  HEADING-LINE-5.                                          03690001
037000         10  FILLER                  PIC  X(03)    VALUE SPACES.  03700001
037100         10  FILLER                  PIC  X(11)    VALUE          03710001
037200             'PO/RECEIVER'.                                       03720001
037300         10  FILLER                  PIC  X(05)    VALUE SPACES.  03730001
037400         10  FILLER                  PIC  X(16)    VALUE          03740001
037500             'SERIAL SHIP CODE'.                                  03750001
037600         10  FILLER                  PIC  X(09)    VALUE SPACES.  03760001
037700         10  FILLER                  PIC  X(04)    VALUE          03770001
037800             'SCAC'.                                              03780001
037900         10  FILLER                  PIC  X(02)    VALUE SPACES.  03790001
038000         10  FILLER                  PIC  X(07)    VALUE          03800001
038100             'TRAILER'.                                           03810001
038200         10  FILLER                  PIC  X(03)    VALUE SPACES.  03820001
038300         10  FILLER                  PIC  X(04)    VALUE          03830001
038400             'STAT'.                                              03840001
038500         10  FILLER                  PIC  X(08)    VALUE SPACES.  03850001
038600         10  FILLER                  PIC  X(11)    VALUE          03860001
038700             'TRIP ID'.                                           03870001
038800         10  FILLER                  PIC  X(04)    VALUE SPACES.  03880001
038900         10  FILLER                  PIC  X(10)    VALUE          03890001
039000             'BOL NUMBER'.                                        03900001
039100         10  FILLER                  PIC  X(08)    VALUE SPACES.  03910001
039200         10  FILLER                  PIC  X(10)    VALUE          03920001
039300             'ASN NUMBER'.                                        03930001
039400         10  FILLER                  PIC  X(16)    VALUE SPACES.  03940001
039500                                                                  03950001
039600******************************************************************03960001
039700*  INCREASED THE SIZE FILLER AFTER FILLER VALUE        WR# 21361 *03970001
039800*  'LNE' TO 22 AND REDUCED THE SIZE OF LAST FILLER 45.           *03980001
039900******************************************************************03990001
040000     05  HEADING-LINE-6.                                          04000001
040100         10  FILLER                  PIC  X(17)    VALUE SPACES.  04010001
040200         10  FILLER                  PIC  X(16)    VALUE          04020001
040300             'CARTON CONTENTS:'.                                  04030001
040400         10  FILLER                  PIC  X(08)    VALUE SPACES.  04040001
040500         10  FILLER                  PIC  X(03)    VALUE          04050001
040600             'STR'.                                               04060001
040700         10  FILLER                  PIC  X(03)    VALUE SPACES.  04070001
040800         10  FILLER                  PIC  X(03)    VALUE          04080001
040900             'LNE'.                                               04090001
041000         10  FILLER                  PIC  X(22)    VALUE SPACES.  04100001
041100         10  FILLER                  PIC  X(05)    VALUE          04110001
041200             'EXPTD'.                                             04120001
041300         10  FILLER                  PIC  X(06)    VALUE SPACES.  04130001
041400         10  FILLER                  PIC  X(04)    VALUE          04140001
041500             'LINE'.                                              04150001
041600         10  FILLER                  PIC  X(45)    VALUE SPACES.  04160001
041700*                                                                 04170001
041800******************************************************************04180001
041900*  REDUCED THE SIZE OF FILLER BEFORE FILLER VALUE      WR# 21361 *04190001
042000*  'SKU'TO 5 AND ADDED NEW FILLER VALUE 'DPT CL ', FILLER        *04200001
042100*  X(3) AND REDUCED THE SIZE OF FILLER AFTER FILLER VALUE 'SKU'  *04210001
042200*  TO 6 AND REDUCED THE SIZE OF LAST FILLER TO 44.               *04220001
042300******************************************************************04230001
042400     05  HEADING-LINE-7.                                          04240001
042500         10  FILLER                  PIC  X(41)    VALUE SPACES.  04250001
042600         10  FILLER                  PIC  X(03)    VALUE          04260001
042700             'NBR'.                                               04270001
042800         10  FILLER                  PIC  X(03)    VALUE SPACES.  04280001
042900         10  FILLER                  PIC  X(03)    VALUE          04290001
043000             'NBR'.                                               04300001
043100         10  FILLER                  PIC  X(05)    VALUE SPACES.  04310001
043200         10  FILLER                  PIC  X(07)    VALUE          04320001
043300             'DPT CL '.                                           04330001
043400         10  FILLER                  PIC  X(02)    VALUE SPACES.  04340001
043500         10  FILLER                  PIC  X(03)    VALUE          04350001
043600             'SKU'.                                               04360001
043700         10  FILLER                  PIC  X(06)    VALUE SPACES.  04370001
043800         10  FILLER                  PIC  X(03)    VALUE          04380001
043900             'QTY'.                                               04390001
044000         10  FILLER                  PIC  X(05)    VALUE SPACES.  04400001
044100         10  FILLER                  PIC  X(07)    VALUE          04410001
044200             'TOT QTY'.                                           04420001
044300         10  FILLER                  PIC  X(44)    VALUE SPACES.  04430001
044400******************************************************************04440001
044500*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *04450001
044600******************************************************************04460001
044700*                                                                 04470001
044800*                                                                 04480001
044900*                                                                 04490001
045000 01  MISCELLANEOUS-LINES.                                         04500001
045100     05  END-OF-REPORT-LINE.                                      04510001
045200         10  FILLER                  PIC  X(44)    VALUE SPACES.  04520001
045300         10  FILLER                  PIC  X(45)    VALUE          04530001
045400             '*******   E N D   O F   R E P O R T   *******'.     04540001
045500         10  FILLER                  PIC  X(43)    VALUE SPACES.  04550001
045600*                                                                 04560001
045700 01  DETAIL-LINES.                                                04570001
045800     05  DETAIL-LINE1.                                            04580001
045900         10  FILLER                  PIC  X(03)    VALUE SPACES.  04590001
      *CLP 09/30/14                                                     04591003
046000         10  DL1-PO-RECEIVER         PIC  X(12)    VALUE SPACES.  04600003
046100         10  FILLER                  PIC  X(01)    VALUE SPACES.  04610003
046200         10  DL1-SERIAL-SHIP-CODE    PIC  X(26)    VALUE SPACES.  04620001
046300         10  FILLER                  PIC  X(02)    VALUE SPACES.  04630001
046400         10  DL1-SCAC                PIC  X(04)    VALUE SPACES.  04640001
046500         10  FILLER                  PIC  X(02)    VALUE SPACES.  04650001
046600         10  DL1-TRAILER             PIC  X(10)    VALUE SPACES.  04660001
046700         10  FILLER                  PIC  X(01)    VALUE SPACES.  04670001
046800         10  DL1-STAT                PIC  X(02)    VALUE SPACES.  04680001
046900         10  FILLER                  PIC  X(03)    VALUE SPACES.  04690001
047000         10  DL1-TRIP-ID             PIC  ZZZZZZZZZZ9             04700001
047100                                                   VALUE ZERO.    04710001
047200         10  DL1-TRIP-ID-X REDEFINES DL1-TRIP-ID                  04720001
047300                                     PIC  X(11).                  04730001
047400         10  FILLER                  PIC  X(02)    VALUE SPACES.  04740001
047500*LMM     10  DL1-BOL                 PIC  X(16)    VALUE SPACES.  04750001
047600         10  DL1-BOL                 PIC  X(17)    VALUE SPACES.  04760001
047700         10  FILLER                  PIC  X(02)    VALUE SPACES.  04770001
047800         10  DL1-ASN                 PIC  X(30)    VALUE SPACES.  04780001
047900                                                                  04790001
048000******************************************************************04800001
048100*  INCREASED THE SIZE OF DL1-SKU TO 15. REDUCED THE    WR# 21361 *04810001
048200*  SIZE OF LAST FILLER TO 45.                                    *04820001
048300******************************************************************04830001
048400     05  DETAIL-LINE2.                                            04840001
048500         10  FILLER                  PIC  X(40)    VALUE SPACES.  04850001
048600         10  DL2-STORE-NBR           PIC  X(04)    VALUE SPACES.  04860001
048700         10  FILLER                  PIC  X(03)    VALUE SPACES.  04870001
048800         10  DL2-LINE-NBR            PIC  ZZZ9.                   04880001
048900         10  DL2-LINE-NBR-RDF REDEFINES DL2-LINE-NBR              04890001
049000                                     PIC  X(04).                  04900001
049100         10  FILLER                  PIC  X(04)    VALUE SPACES.  04910001
049200         10  DL2-SKU                 PIC  X(15)    VALUE SPACES.  04920001
049300         10  FILLER                  PIC  X(02)    VALUE SPACES.  04930001
049400         10  DL2-EXPTED-QTY          PIC  ZZZZ9    VALUE ZERO.    04940001
049500         10  FILLER                  PIC  X(05)    VALUE SPACES.  04950001
049600         10  DL2-LINE-TOT-QTY        PIC  ZZZZZ    VALUE ZERO.    04960001
049700         10  FILLER                  PIC  X(45)    VALUE SPACES.  04970001
049800******************************************************************04980001
049900*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *04990001
050000******************************************************************05000001
050100                                                                  05010001
050200 01  EL1-ERROR-LINE-1F.                                           05020001
050300     05  FILLER                      PIC  X(02)     VALUE SPACES. 05030001
050400     05  FILLER                      PIC  X(48)     VALUE         05040001
050500         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05050001
050600     05  FILLER                      PIC  X(49)     VALUE         05060001
050700         'CREATING YOUR REPORTS.  YOUR REQUEST COULD NOT BE'.     05070001
050800     05  FILLER                      PIC  X(33)     VALUE         05080001
050900         ' COMPLETED.                      '.                     05090001
051000                                                                  05100001
051100 01  EL1-ERROR-LINE-1P.                                           05110001
051200     05  FILLER                      PIC  X(02)     VALUE SPACES. 05120001
051300     05  FILLER                      PIC  X(48)     VALUE         05130001
051400         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05140001
051500     05  FILLER                      PIC  X(49)     VALUE         05150001
051600         'CREATING YOUR REPORTS.  THIS REPORT COULD NOT BE '.     05160001
051700     05  FILLER                      PIC  X(33)     VALUE         05170001
051800         'COMPLETED.                       '.                     05180001
051900                                                                  05190001
052000 01  EL2-ERROR-LINE-2F.                                           05200001
052100     05  FILLER                      PIC  X(02)     VALUE SPACES. 05210001
052200     05  FILLER                      PIC  X(36)     VALUE         05220001
052300         'NONE OF YOUR REPORTS WERE CREATED.  '.                  05230001
052400     05  FILLER                      PIC  X(36)     VALUE         05240001
052500         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  05250001
052600     05  FILLER                      PIC  X(58)     VALUE SPACES. 05260001
052700                                                                  05270001
052800 01  EL2-ERROR-LINE-2P.                                           05280001
052900     05  FILLER                      PIC  X(02)     VALUE SPACES. 05290001
053000     05  FILLER                      PIC  X(49)     VALUE         05300001
053100         'PLEASE RE-SUBMIT A REQUEST TO CREATE THIS REPORT '.     05310001
053200     05  FILLER                      PIC  X(41)     VALUE         05320001
053300         '(YOUR OTHER REPORTS SHOULD BE CHECKED TO '.             05330001
053400     05  FILLER                      PIC  X(40)     VALUE         05340001
053500         'DETERMINE IF THEY NEED TO BE CREATED).  '.              05350001
053600                                                                  05360001
053700 01  EL3-ERROR-LINE-3.                                            05370001
053800     05  FILLER                      PIC  X(02)     VALUE SPACES. 05380001
053900     05  FILLER                      PIC  X(50)     VALUE         05390001
054000         'YOUR REQUEST WAS AS FOLLOWS:                      '.    05400001
054100     05  FILLER                      PIC  X(81)     VALUE SPACES. 05410001
054200                                                                  05420001
054300 01  EL4-ERROR-LINE-4.                                            05430001
054400     05  FILLER                      PIC  X(07)     VALUE SPACES. 05440001
054500     05  FILLER                      PIC  X(12)     VALUE         05450001
054600         'REQUESTOR:  '.                                          05460001
054700     05  EL4-REQUESTOR-ID            PIC  X(08)     VALUE SPACES. 05470001
054800     05  FILLER                      PIC  X(10)     VALUE SPACES. 05480001
054900     05  FILLER                      PIC  X(22)     VALUE         05490001
055000         'PRINTER DESTINATION:  '.                                05500001
055100     05  EL4-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05510001
055200     05  FILLER                      PIC  X(65)     VALUE SPACES. 05520001
055300                                                                  05530001
055400 01  EL5-ERROR-LINE-5.                                            05540001
055500     05  FILLER                      PIC  X(07)     VALUE SPACES. 05550001
055600     05  FILLER                      PIC  X(20)     VALUE         05560001
055700         'REQUESTED REPORTS:  '.                                  05570001
055800*JPL                                                              05580001
055900     05  FILLER                      PIC  X(105)    VALUE SPACES. 05590001
056000*JPL 05  FILLER                      PIC  X(08)     VALUE         05600001
056100*JPL     'STATS   '.                                              05610001
056200*JPL 05  FILLER                      PIC  X(18)     VALUE         05620001
056300*JPL     'PO/STR WRKSHEET   '.                                    05630001
056400*JPL 05  FILLER                      PIC  X(17)     VALUE         05640001
056500*JPL     'CRTNS NOT RCVD   '.                                     05650001
056600*JPL 05  FILLER                      PIC  X(14)     VALUE         05660001
056700*JPL     'FREE ASTRAY   '.                                        05670001
056800*JPL 05  FILLER                      PIC  X(12)     VALUE         05680001
056900*JPL     'MISDIRECT   '.                                          05690001
057000*JPL 05  FILLER                      PIC  X(17)     VALUE         05700001
057100*JPL     'DUPLICATE SCAN   '.                                     05710001
057200*JPL 05  FILLER                      PIC  X(14)     VALUE         05720001
057300*JPL     'SCAN NOT FOUND'.                                        05730001
057400*JPL 05  FILLER                      PIC  X(05)     VALUE SPACES. 05740001
057500                                                                  05750001
057600 01  EL5-ERROR-LINE-5B.                                           05760001
057700     05  FILLER                      PIC  X(07)     VALUE SPACES. 05770001
057800     05  FILLER                      PIC  X(04)     VALUE SPACES. 05780001
057900     05  FILLER                      PIC  X(08)     VALUE         05790001
058000         'STATS   '.                                              05800001
058100     05  FILLER                      PIC  X(18)     VALUE         05810001
058200         'PO/STR UNT ADJ    '.                                    05820001
058300     05  FILLER                      PIC  X(17)     VALUE         05830001
058400         'CRTNS NOT RCVD   '.                                     05840001
058500     05  FILLER                      PIC  X(14)     VALUE         05850001
058600         'FREE ASTRAY   '.                                        05860001
058700     05  FILLER                      PIC  X(12)     VALUE         05870001
058800         'MISDIRECT   '.                                          05880001
058900     05  FILLER                      PIC  X(17)     VALUE         05890001
059000         'DUPLICATE SCAN   '.                                     05900001
059100     05  FILLER                      PIC  X(18)     VALUE         05910001
059200         'SCAN NOT FOUND    '.                                    05920001
059300     05  FILLER                      PIC  X(17)     VALUE         05930001
059400         'UNUSED LABELS    '.                                     05940001
059500*JPL                                                              05950001
059600*01  EL6-ERROR-LINE-6.                                            05960001
059700*    05  FILLER                      PIC  X(29)     VALUE SPACES. 05970001
059800*    05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 05980001
059900*    05  FILLER                      PIC  X(12)     VALUE SPACES. 05990001
060000*    05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 06000001
060100*    05  FILLER                      PIC  X(16)     VALUE SPACES. 06010001
060200*    05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 06020001
060300*    05  FILLER                      PIC  X(15)     VALUE SPACES. 06030001
060400*    05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 06040001
060500*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06050001
060600*    05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 06060001
060700*    05  FILLER                      PIC  X(13)     VALUE SPACES. 06070001
060800*    05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 06080001
060900*    05  FILLER                      PIC  X(16)     VALUE SPACES. 06090001
061000*    05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 06100001
061100*    05  FILLER                      PIC  X(12)     VALUE SPACES. 06110001
061200                                                                  06120001
061300 01  EL6-ERROR-LINE-6B.                                           06130001
061400     05  FILLER                      PIC  X(13)     VALUE SPACES. 06140001
061500     05  EL6-SUKRP002-IND            PIC  X(01)     VALUE SPACES. 06150001
061600     05  FILLER                      PIC  X(12)     VALUE SPACES. 06160001
061700     05  EL6-SUKRP007-IND            PIC  X(01)     VALUE SPACES. 06170001
061800     05  FILLER                      PIC  X(16)     VALUE SPACES. 06180001
061900     05  EL6-SUKRP003-IND            PIC  X(01)     VALUE SPACES. 06190001
062000     05  FILLER                      PIC  X(15)     VALUE SPACES. 06200001
062100     05  EL6-SUKRP005-IND            PIC  X(01)     VALUE SPACES. 06210001
062200     05  FILLER                      PIC  X(12)     VALUE SPACES. 06220001
062300     05  EL6-SUKRP004-IND            PIC  X(01)     VALUE SPACES. 06230001
062400     05  FILLER                      PIC  X(13)     VALUE SPACES. 06240001
062500     05  EL6-SUKRP006-IND            PIC  X(01)     VALUE SPACES. 06250001
062600     05  FILLER                      PIC  X(16)     VALUE SPACES. 06260001
062700     05  EL6-SUKRP008-IND            PIC  X(01)     VALUE SPACES. 06270001
062800     05  FILLER                      PIC  X(17)     VALUE SPACES. 06280001
062900*JPL                                                              06290001
063000     05  EL6-SUKRP023-IND            PIC  X(01)     VALUE SPACES. 06300001
063100     05  FILLER                      PIC  X(10)     VALUE SPACES. 06310001
063200                                                                  06320001
063300*                                                                 06330001
063400*  COPY BOOK FOR SHIPMENT TABLE                                   06340001
063500*                                                                 06350001
063600     EXEC SQL                                                     06360001
063700          INCLUDE TSHIPMT                                         06370001
063800     END-EXEC.                                                    06380001
063900*                                                                 06390001
064000*  COPY BOOK FOR SHIPMENT UNIT TABLE                              06400001
064100*                                                                 06410001
064200     EXEC SQL                                                     06420001
064300          INCLUDE TSHPUNT                                         06430001
064400     END-EXEC.                                                    06440001
064500*                                                                 06450001
064600*  COPY BOOK FOR SHIPMENT PO TABLE                                06460001
064700*                                                                 06470001
064800     EXEC SQL                                                     06480001
064900          INCLUDE TSHPTPO                                         06490001
065000     END-EXEC.                                                    06500001
065100*                                                                 06510001
065200*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    06520001
065300*                                                                 06530001
065400     EXEC SQL                                                     06540001
065500          INCLUDE TSHUUPC                                         06550001
065600     END-EXEC.                                                    06560001
065700*                                                                 06570001
065800*  COPY BOOK FOR THE RECEIVER TABLE                               06580001
065900*                                                                 06590001
066000     EXEC SQL                                                     06600001
066100          INCLUDE TRECEIV                                         06610001
066200     END-EXEC.                                                    06620001
066300******************************************************************06630001
066400*  REMOVED REFERENCES OF DB2 TABLE TSK                 WR# 21361 *06640001
066500******************************************************************06650001
066600******************************************************************06660001
066700*  REMOVED REFERENCES OF DB2 TABLE TUPCSKU             WR# 21361 *06670001
066800******************************************************************06680001
066900******************************************************************06690001
067000*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *06700001
067100******************************************************************06710001
067200*                                                                 06720001
067300*  COPY BOOK FOR PACKSLIP TABLE                                   06730001
067400*                                                                 06740001
067500     EXEC SQL                                                     06750001
067600          INCLUDE TPKSLIP                                         06760001
067700     END-EXEC.                                                    06770001
067800*                                                                 06780001
067900*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T06790001
068000*                                                                 06800001
068100     EXEC SQL                                                     06810001
068200          INCLUDE TINPKSU                                         06820001
068300     END-EXEC.                                                    06830001
068400*                                                                 06840001
068500*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           06850001
068600*                                                                 06860001
068700     EXEC SQL                                                     06870001
068800          INCLUDE TSHUNLO                                         06880001
068900     END-EXEC.                                                    06890001
069000*                                                                 06900001
069100*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           06910001
069200*                                                                 06920001
069300     EXEC SQL                                                     06930001
069400          INCLUDE TVHTRIP                                         06940001
069500     END-EXEC.                                                    06950001
069600*                                                                 06960001
069700*  COPY BOOK FOR TRIP STATUS TABLE                                06970001
069800*                                                                 06980001
069900     EXEC SQL                                                     06990001
070000          INCLUDE TTRIPST                                         07000001
070100     END-EXEC.                                                    07010001
070200*                                                                 07020001
070300*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           07030001
070400*                                                                 07040001
070500     EXEC SQL                                                     07050001
070600          INCLUDE TTRSTYP                                         07060001
070700     END-EXEC.                                                    07070001
070800*                                                                 07080001
070900*  COPY BOOK FOR SHIPMENT UNIT BARCODE NUMBER                    T07090001
071000*                                                                 07100001
071100     EXEC SQL                                                     07110001
071200          INCLUDE TSULBXF                                         07120001
071300     END-EXEC.                                                    07130001
071400 EJECT                                                            07140001
071500*  DB2 COMMUNICATION AREA                                         07150001
071600*                                                                 07160001
071700     EXEC SQL                                                     07170001
071800         INCLUDE SQLCA                                            07180001
071900     END-EXEC.                                                    07190001
072000 EJECT                                                            07200001
072100*  DB2 COMMUNICATION AREA2                                        07210001
072200*                                                                 07220001
072300     COPY SQLCA2.                                                 07230001
072400 EJECT                                                            07240001
072500                                                                  07250001
072600     EXEC SQL                                                     07260001
072700        DECLARE UPC-CSR CURSOR FOR                                07270001
072800        SELECT  A.TRN_LNE_NBR                                     07280001
072900              , A.UPC_NBR                                         07290001
073000              , A.SHPD_QTY                                        07300001
073100          FROM  TSHUUPC A                                         07310001
073200          WHERE A.SHIPT_UNT_ID  = :SHUUPC-SHIPT-UNT-ID            07320001
073300       ORDER BY A.TRN_LNE_NBR                                     07330001
073400     END-EXEC.                                                    07340001
073500                                                                  07350001
073600*                                                                 07360001
073700 PROCEDURE DIVISION.                                              07370001
073800*                                                                 07380001
073900 0000-MAINLINE-PROCESSING.                                        07390001
074000***************************************************************** 07400001
074100*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 07410001
074200* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM    * 07420001
074300* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                    * 07430001
074400***************************************************************** 07440001
074500     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           07450001
074600     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   07460001
074700                                                                  07470001
074800     IF CC-PRINT-SUKRP005                                         07480001
074900         PERFORM 0100-INITIALIZATION                              07490001
075000         IF SU001-DETAIL-RECORD                                   07500001
075100             PERFORM 1000-PROCESS-EXTRACT-FILE                    07510001
075200             IF PS-ERROR-RECORD                                   07520001
075300                 PERFORM 7000-WRITE-ERROR-REPORT                  07530001
075400             END-IF                                               07540001
075500         ELSE                                                     07550001
075600             IF CC-PRINT-SUKRP002                                 07560001
075700             OR CC-PRINT-SUKRP003                                 07570001
075800             OR CC-PRINT-SUKRP004                                 07580001
075900                 CONTINUE                                         07590001
076000             ELSE                                                 07600001
076100                 PERFORM 7000-WRITE-ERROR-REPORT                  07610001
076200             END-IF                                               07620001
076300         END-IF                                                   07630001
076400         CLOSE EXTRACT-FILE                                       07640001
076500               SU-CARTON-NOT-RCVD-FILE                            07650001
076600     END-IF.                                                      07660001
076700                                                                  07670001
076800     GOBACK.                                                      07680001
076900*                                                                 07690001
077000*                                                                 07700001
077100 0100-INITIALIZATION.                                             07710001
077200******************************************************************07720001
077300**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               07730001
077400******************************************************************07740001
077500     ACCEPT PV-TODAYS-DATE                                        07750001
077600       FROM DATE.                                                 07760001
077700                                                                  07770001
077800     ACCEPT PV-TODAYS-TIME                                        07780001
077900       FROM TIME.                                                 07790001
078000                                                                  07800001
078100     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         07810001
078200     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             07820001
078300     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               07830001
078400     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              07840001
078500                                                                  07850001
078600     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              07860001
078700     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            07870001
078800     MOVE PC-SUKRP005            TO DP132O-PROGRAM-NAME.          07880001
078900                                                                  07890001
079000******************************************************************07900001
079100**  CHECK PO IND ON CONTROL CARD AND MOVE DESCRIPTION TO HEADER.  07910001
079200******************************************************************07920001
079300     IF CC-PRINT-ENTIRE-TRIP                                      07930001
079400        STRING 'ENTIRE TRIP-REQUESTED BY '                        07940001
079500               CC-REQUESTOR-ID  DELIMITED BY SIZE                 07950001
079600               INTO HL1A-CC-IND-DESC                              07960001
079700     ELSE                                                         07970001
079800        STRING 'SELECTED PO''S REQUESTED BY '                     07980001
079900               CC-REQUESTOR-ID  DELIMITED BY SIZE                 07990001
080000               INTO HL1A-CC-IND-DESC.                             08000001
080100                                                                  08010001
080200     OPEN INPUT  EXTRACT-FILE                                     08020001
080300          OUTPUT SU-CARTON-NOT-RCVD-FILE.                         08030001
080400                                                                  08040001
080500     PERFORM 2200-READ-EXTRACT.                                   08050001
080600                                                                  08060001
080700     MOVE SU001-MANIFEST-NBR     TO PV-MANIFEST                   08070001
080800                                    VHTRIP-TRIP-ID.               08080001
080900                                                                  08090001
081000     SET PS-DETAIL-RECORD        TO TRUE.                         08100001
081100                                                                  08110001
081200     PERFORM 1100-SELECT-TRAILER.                                 08120001
081300                                                                  08130001
081400     MOVE VHTRIP-OWNER-SCAC-ID   TO HL2-SCAC.                     08140001
081500     MOVE PV-MANIFEST            TO HL2-TRIP-ID.                  08150001
081600     MOVE VHTRIP-VEH-NBR         TO HL2-TRAILER.                  08160001
081700     MOVE TRIPST-TRIP-STATUS-CDE TO HL2-TRAILER-STAT.             08170001
081800*                                                                 08180001
081900 1000-PROCESS-EXTRACT-FILE.                                       08190001
082000******************************************************************08200001
082100**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               08210001
082200******************************************************************08220001
082300     IF PS-DETAIL-RECORD                                          08230001
082400         MOVE PC-AR    TO PV-STATUS                               08240001
082500         SET PS-STATUS-NOT-FOUND TO TRUE                          08250001
082600         PERFORM 1200-SELECT-STATUS                               08260001
082700     END-IF.                                                      08270001
082800*                                                                 08280001
082900     IF PS-DETAIL-RECORD                                          08290001
083000         IF PS-STATUS-FOUND                                       08300001
083100             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08310001
083200             MOVE PV-DB2-DATE-CC TO HL3-ARRIVAL-DATE-CC           08320001
083300             MOVE PV-DB2-DATE-YY TO HL3-ARRIVAL-DATE-YY           08330001
083400             MOVE PV-DB2-DATE-MM TO HL3-ARRIVAL-DATE-MM           08340001
083500             MOVE PV-DB2-DATE-DD TO HL3-ARRIVAL-DATE-DD           08350001
083600         ELSE                                                     08360001
083700             MOVE PC-00          TO HL3-ARRIVAL-DATE-CC           08370001
083800             MOVE PC-00          TO HL3-ARRIVAL-DATE-YY           08380001
083900             MOVE PC-00          TO HL3-ARRIVAL-DATE-MM           08390001
084000             MOVE PC-00          TO HL3-ARRIVAL-DATE-DD           08400001
084100         END-IF                                                   08410001
084200         MOVE PC-UG    TO PV-STATUS                               08420001
084300         SET PS-STATUS-NOT-FOUND TO TRUE                          08430001
084400         PERFORM 1200-SELECT-STATUS                               08440001
084500     END-IF.                                                      08450001
084600*                                                                 08460001
084700     IF PS-DETAIL-RECORD                                          08470001
084800         IF PS-STATUS-FOUND                                       08480001
084900             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08490001
085000             MOVE PV-DB2-DATE-CC TO HL3-BEG-UNLOAD-DATE-CC        08500001
085100             MOVE PV-DB2-DATE-YY TO HL3-BEG-UNLOAD-DATE-YY        08510001
085200             MOVE PV-DB2-DATE-MM TO HL3-BEG-UNLOAD-DATE-MM        08520001
085300             MOVE PV-DB2-DATE-DD TO HL3-BEG-UNLOAD-DATE-DD        08530001
085400         ELSE                                                     08540001
085500             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-CC        08550001
085600             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-YY        08560001
085700             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-MM        08570001
085800             MOVE PC-00          TO HL3-BEG-UNLOAD-DATE-DD        08580001
085900         END-IF                                                   08590001
086000         MOVE PC-UN    TO PV-STATUS                               08600001
086100         SET PS-STATUS-NOT-FOUND TO TRUE                          08610001
086200         PERFORM 1200-SELECT-STATUS                               08620001
086300     END-IF.                                                      08630001
086400*                                                                 08640001
086500     IF PS-DETAIL-RECORD                                          08650001
086600         IF PS-STATUS-FOUND                                       08660001
086700             MOVE TRIPST-STATUS-DTE   TO PV-DB2-DATE              08670001
086800             MOVE PV-DB2-DATE-CC TO HL3-UNLOADED-DATE-CC          08680001
086900             MOVE PV-DB2-DATE-YY TO HL3-UNLOADED-DATE-YY          08690001
087000             MOVE PV-DB2-DATE-MM TO HL3-UNLOADED-DATE-MM          08700001
087100             MOVE PV-DB2-DATE-DD TO HL3-UNLOADED-DATE-DD          08710001
087200         ELSE                                                     08720001
087300             MOVE PC-00          TO HL3-UNLOADED-DATE-CC          08730001
087400             MOVE PC-00          TO HL3-UNLOADED-DATE-YY          08740001
087500             MOVE PC-00          TO HL3-UNLOADED-DATE-MM          08750001
087600             MOVE PC-00          TO HL3-UNLOADED-DATE-DD          08760001
087700         END-IF                                                   08770001
087800         PERFORM 8000-WRITE-REPORT-HEADERS                        08780001
087900         INITIALIZE SAVE-SHIPT-UNT-ID                             08790001
088000         PERFORM 2200-READ-EXTRACT                                08800001
088100         PERFORM 2000-PROCESS-SU                                  08810001
088200     END-IF.                                                      08820001
088300*                                                                 08830001
088400     IF PS-DETAIL-RECORD                                          08840001
088500         WRITE SU-CARTON-NOT-RCVD-RECORD                          08850001
088600           FROM END-OF-REPORT-LINE                                08860001
088700             AFTER ADVANCING 2 LINES                              08870001
088800     END-IF.                                                      08880001
088900*                                                                 08890001
089000 1100-SELECT-TRAILER.                                             08900001
089100     MOVE '1100-SELECT-TRAILER '                                  08910001
089200                                 TO PV-ABEND-PARAGRAPH.           08920001
089300     EXEC SQL                                                     08930001
089400       SELECT A.OWNER_SCAC_ID                                     08940001
089500             ,A.VEH_NBR                                           08950001
089600             ,B.TRIP_STATUS_CDE                                   08960001
089700       INTO  :VHTRIP-OWNER-SCAC-ID                                08970001
089800            ,:VHTRIP-VEH-NBR :DN-VEH-NBR                          08980001
089900            ,:TRIPST-TRIP-STATUS-CDE                              08990001
090000       FROM   TVHTRIP A                                           09000001
090100             ,TTRIPST B                                           09010001
090200             ,TTRSTYP C                                           09020001
090300       WHERE  A.TRIP_ID          = :VHTRIP-TRIP-ID                09030001
090400         AND  B.TRIP_STATUS_CDE ^= 'DE'                           09040001
090500         AND  C.PRTY_CDE =                                        09050001
090600              (SELECT MAX(E.PRTY_CDE)                             09060001
090700                 FROM TTRIPST D                                   09070001
090800                     ,TTRSTYP E                                   09080001
090900                WHERE D.TRIP_ID         = A.TRIP_ID               09090001
091000                  AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)      09100001
091100         AND  A.TRIP_ID         = B.TRIP_ID                       09110001
091200         AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE               09120001
091300     END-EXEC.                                                    09130001
091400                                                                  09140001
091500     EVALUATE TRUE                                                09150001
091600       WHEN SQLCODE = ZEROS                                       09160001
091700         CONTINUE                                                 09170001
091800       WHEN SQLCODE = +100                                        09180001
091900         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      09190001
092000                        VHTRIP-VEH-NBR                            09200001
092100                        TRIPST-TRIP-STATUS-CDE                    09210001
092200       WHEN SQLCODE = -904                                        09220001
092300       WHEN SQLCODE = -911                                        09230001
092400       WHEN SQLCODE = -913                                        09240001
092500         SET PS-ERROR-RECORD TO TRUE                              09250001
092600         MOVE SPACES TO VHTRIP-OWNER-SCAC-ID                      09260001
092700                        VHTRIP-VEH-NBR                            09270001
092800                        TRIPST-TRIP-STATUS-CDE                    09280001
092900       WHEN OTHER                                                 09290001
093000         DISPLAY PV-ABEND-PARAGRAPH                               09300001
093100         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      09310001
093200         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        09320001
093300         PERFORM Z999-SQL-ERROR                                   09330001
093400     END-EVALUATE.                                                09340001
093500                                                                  09350001
093600 1200-SELECT-STATUS.                                              09360001
093700     MOVE '1200-SELECT-STATUS  '                                  09370001
093800                                 TO PV-ABEND-PARAGRAPH.           09380001
093900     EXEC SQL                                                     09390001
094000       SELECT STATUS_DTE                                          09400001
094100       INTO  :TRIPST-STATUS-DTE                                   09410001
094200       FROM   TTRIPST                                             09420001
094300       WHERE  TRIP_ID            = :VHTRIP-TRIP-ID                09430001
094400         AND  TRIP_STATUS_CDE    = :PV-STATUS                     09440001
094500     END-EXEC.                                                    09450001
094600                                                                  09460001
094700     EVALUATE TRUE                                                09470001
094800       WHEN SQLCODE = ZEROS                                       09480001
094900         SET PS-STATUS-FOUND TO TRUE                              09490001
095000       WHEN SQLCODE = +100                                        09500001
095100         SET PS-STATUS-NOT-FOUND TO TRUE                          09510001
095200       WHEN SQLCODE = -904                                        09520001
095300       WHEN SQLCODE = -911                                        09530001
095400       WHEN SQLCODE = -913                                        09540001
095500         SET PS-ERROR-RECORD TO TRUE                              09550001
095600       WHEN OTHER                                                 09560001
095700         DISPLAY PV-ABEND-PARAGRAPH                               09570001
095800         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      09580001
095900         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        09590001
096000         PERFORM Z999-SQL-ERROR                                   09600001
096100     END-EVALUATE.                                                09610001
096200                                                                  09620001
096300*                                                                 09630001
096400 2000-PROCESS-SU.                                                 09640001
096500******************************************************************09650001
096600*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *09660001
096700*  CARTONS NOT RECEIVED REPORT.                                  *09670001
096800******************************************************************09680001
096900     MOVE PV-MANIFEST  TO SHIPMT-TRIP-ID.                         09690001
097000     PERFORM 2300-PROCESS-EXTRACT                                 09700001
097100         UNTIL PS-END-OF-EXTRACT                                  09710001
097200            OR PS-ERROR-RECORD.                                   09720001
097300                                                                  09730001
097400 2200-READ-EXTRACT.                                               09740001
097500     MOVE '2200-READ-EXTRACT   '                                  09750001
097600                                 TO PV-ABEND-PARAGRAPH.           09760001
097700     READ EXTRACT-FILE INTO SU001-EXTRACT-RECORD                  09770001
097800        AT END                                                    09780001
097900           SET PS-END-OF-EXTRACT TO TRUE.                         09790001
098000                                                                  09800001
098100 2300-PROCESS-EXTRACT.                                            09810001
098200     IF SAVE-SHIPT-UNT-ID = SU001-SHIPT-UNT-ID                    09820001
098300        CONTINUE                                                  09830001
098400     ELSE                                                         09840001
098500        PERFORM 2400-PROCESS-SHIPT-UNT                            09850001
098600        IF PS-DETAIL-RECORD                                       09860001
098700            MOVE SU001-SHIPT-UNT-ID TO SAVE-SHIPT-UNT-ID          09870001
098800        END-IF                                                    09880001
098900     END-IF.                                                      09890001
099000                                                                  09900001
099100     IF PS-DETAIL-RECORD                                          09910001
099200         PERFORM 2200-READ-EXTRACT                                09920001
099300     END-IF.                                                      09930001
099400                                                                  09940001
099500 2400-PROCESS-SHIPT-UNT.                                          09950001
099600     MOVE SU001-SHIPT-UNT-ID     TO PV-SERIAL-SHIP-CODE           09960001
099700                                    SHUUPC-SHIPT-UNT-ID           09970001
099800                                    DK-SHIPT-UNT-ID               09980001
099900     PERFORM 2450-SELECT-SHIPMT.                                  09990001
100000                                                                  10000001
100100     IF PS-DETAIL-RECORD                                          10010001
100200         IF SQLCODE = +100                                        10020001
100300             PERFORM 2470-SELECT-SHUUPC                           10030001
100400         END-IF                                                   10040001
100500     END-IF.                                                      10050001
100600                                                                  10060001
100700     IF PS-DETAIL-RECORD                                          10070001
100800         IF PKSLIP-PO-NBR = ZERO                                  10080001
100900             MOVE SHUUPC-TRN-NBR         TO PV-PO                 10090001
101000         ELSE                                                     10100001
101100             MOVE PKSLIP-PO-NBR          TO PV-PO                 10110001
101200         END-IF                                                   10120001
101300         MOVE PKSLIP-REC-SEQ-NBR     TO PV-RECEIVER               10130001
101400         MOVE PV-PO-RECEIVER         TO DL1-PO-RECEIVER           10140001
101500         MOVE SU001-SHIPT-UNT-ID     TO PV-SERIAL-SHIP-CODE       10150001
101600         MOVE PV-SERIAL-SHIP-CODE-1    TO PV-OUT-S-S-C-1          10160001
101700         MOVE PV-SERIAL-SHIP-CODE-2-8  TO PV-OUT-S-S-C-2-8        10170001
101800         MOVE PV-SERIAL-SHIP-CODE-9-17 TO PV-OUT-S-S-C-9-17       10180001
101900         MOVE PV-SERIAL-SHIP-CODE-18   TO PV-OUT-S-S-C-18         10190001
102000         MOVE PV-OUT-SERIAL-SHIP-CODE TO DL1-SERIAL-SHIP-CODE     10200001
102100         MOVE PKSLIP-BOL-NBR          TO DL1-BOL                  10210001
102200         MOVE PKSLIP-ASN-NBR          TO DL1-ASN                  10220001
102300         IF SHIPMT-TRIP-ID > 0                                    10230001
102400             MOVE SHIPMT-TRIP-ID      TO VHTRIP-TRIP-ID           10240001
102500             IF SU001-AUTO-VE-NO                                  10250001
102600                PERFORM 2500-SELECT-VEHICLE                       10260001
102700             ELSE                                                 10270001
102800                MOVE SU001-PO-NUMBER   TO DK-PO-NBR               10280001
102900                MOVE SU001-REC-SEQ-NBR TO DK-REC-SEQ-NBR          10290001
103000                PERFORM 2510-GET-ORIG-RCVR-NBR                    10300001
103100                                                                  10310001
103200                IF SQLCODE = +100                                 10320001
103300                  PERFORM 2500-SELECT-VEHICLE                     10330001
103400                ELSE                                              10340001
103500                  IF PKSLIP-REC-SEQ-NBR > 0                       10350001
103600                      PERFORM 2540-GET-VEHICLE-INFO               10360001
103700                  ELSE                                            10370001
103800                      MOVE 0      TO VHTRIP-TRIP-ID               10380001
103900                      MOVE SPACES TO VHTRIP-OWNER-SCAC-ID         10390001
104000                                     VHTRIP-VEH-NBR               10400001
104100                                     TRIPST-TRIP-STATUS-CDE       10410001
104200                  END-IF                                          10420001
104300                  PERFORM 2550-SELECT-TPKSLIP                     10430001
104400                END-IF                                            10440001
104500                                                                  10450001
104600             END-IF                                               10460001
104700                                                                  10470001
104800             IF PS-DETAIL-RECORD                                  10480001
104900                 IF DN-VEH-NBR = -1                               10490001
105000                     MOVE 'EN'        TO DL1-STAT                 10500001
105100                     MOVE SPACES      TO DL1-SCAC                 10510001
105200                                         DL1-TRAILER              10520001
105300                                         DL1-TRIP-ID-X            10530001
105400                 ELSE                                             10540001
105500                     MOVE VHTRIP-OWNER-SCAC-ID TO DL1-SCAC        10550001
105600                     MOVE VHTRIP-VEH-NBR       TO DL1-TRAILER     10560001
105700*LMM                 MOVE SHIPMT-TRIP-ID       TO DL1-TRIP-ID     10570001
105800                     MOVE VHTRIP-TRIP-ID       TO DL1-TRIP-ID     10580001
105900*GB                  IF SU001-AUTO-VE-YES                         10590001
106000*GB                      MOVE SHIPMT-BOL-NBR   TO DL1-BOL         10600001
106100*GB                  ELSE                                         10610001
106200                         MOVE PKSLIP-BOL-NBR   TO DL1-BOL         10620001
106300*GB                  END-IF                                       10630001
106400                     MOVE PKSLIP-ASN-NBR       TO DL1-ASN         10640001
106500                 END-IF                                           10650001
106600             END-IF                                               10660001
106700         ELSE                                                     10670001
106800             MOVE SPACES             TO DL1-STAT                  10680001
106900                                        DL1-SCAC                  10690001
107000                                        DL1-TRAILER               10700001
107100                                        DL1-TRIP-ID-X             10710001
107200                                        DL1-BOL                   10720001
107300                                        DL1-ASN                   10730001
107400         END-IF                                                   10740001
107500                                                                  10750001
107600         IF  PV-LINE-CNT > PC-60                                  10760001
107700             PERFORM 8000-WRITE-REPORT-HEADERS                    10770001
107800         END-IF                                                   10780001
107900         PERFORM 8400-WRITE-DETAIL-LINES                          10790001
108000         MOVE SU001-SHIPT-UNT-ID  TO SHPUNT-SHIPT-UNT-ID          10800001
108100                                     SHUUPC-SHIPT-UNT-ID          10810001
108200         PERFORM 2600-SELECT-SHPUNT                               10820001
108300     END-IF.                                                      10830001
108400                                                                  10840001
108500     IF PS-DETAIL-RECORD                                          10850001
108600         PERFORM 2800-SELECT-DEST                                 10860001
108700         IF SQLCODE = +100                                        10870001
108800             MOVE SHPUNT-DEST-OPER-UNT-ID TO PV-STR-NBR-NUMERIC   10880001
108900             MOVE PV-STR-NBR              TO DL2-STORE-NBR        10890001
109000         ELSE                                                     10900001
109100             IF SQLCODE = -811                                    10910001
109200                 MOVE PC-MLT              TO DL2-STORE-NBR        10920001
109300             ELSE                                                 10930001
109400                 MOVE SULBXF-DEST-OPER-UNT-ID                     10940001
109500                                          TO PV-STR-NBR-NUMERIC   10950001
109600                 MOVE PV-STR-NBR          TO DL2-STORE-NBR        10960001
109700             END-IF                                               10970001
109800         END-IF                                                   10980001
109900         SET PS-NOT-EOF-UPC-CURSOR    TO TRUE                     10990001
110000         MOVE ZERO                    TO PV-EXPTED-QTY            11000001
110100         MOVE ZERO                    TO PV-LINE-TOT-QTY          11010001
110200         PERFORM 2700-OPEN-UPC-CURSOR                             11020001
110300     END-IF.                                                      11030001
110400                                                                  11040001
110500     IF PS-DETAIL-RECORD                                          11050001
110600         PERFORM 2710-FETCH-UPC-CURSOR                            11060001
110700     END-IF.                                                      11070001
110800                                                                  11080001
110900******************************************************************11090001
111000*  CALL TO 3000-SELECT-SKU IS REPLACED WITH CALL TO    WR# 21361 *11100001
111100*  3000-CALL-XLKUT-DOMAIN-PGM.                                   *11110001
111200******************************************************************11120001
111300     IF PS-DETAIL-RECORD                                          11130001
111400         PERFORM 3000-CALL-XLKUT-DOMAIN-PGM                       11140001
111500     END-IF.                                                      11150001
111600                                                                  11160001
111700******************************************************************11170001
111800*  REPLACED TSK VARAIBLES WITH XL001 VARAIBLES         WR# 21361 *11180001
111900*  AND PV-SAVE-SEQ-NMBR IS REPLACED WITH VARIABLE                *11190001
112000*  PV-SAVE-SKU-NBR.                                              *11200001
112100******************************************************************11210001
112200     IF PS-DETAIL-RECORD                                          11220001
112300         MOVE SHUUPC-TRN-LNE-NBR     TO PV-SAVE-TRN-LNE-NBR       11230001
112400         MOVE XL001-DEPT-NBR-3CH     TO PV-SAVE-MERCH-DEPT-NMBR   11240001
112500         MOVE XL001-SUB-CL-NBR-2CH   TO PV-SAVE-MERCH-CLASS-NMBR  11250001
112600         MOVE XL001-SKU-NBR          TO PV-SAVE-SKU-NBR           11260001
112700         PERFORM 8100-WRITE-REPORT-HEADERS                        11270001
112800         PERFORM 2720-PROCESS-CURSOR                              11280001
112900             UNTIL PS-EOF-UPC-CURSOR                              11290001
113000                OR PS-ERROR-RECORD                                11300001
113100     END-IF.                                                      11310001
113200******************************************************************11320001
113300*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *11330001
113400******************************************************************11340001
113500                                                                  11350001
113600     IF PS-DETAIL-RECORD                                          11360001
113700         PERFORM 2730-CLOSE-UPC-CURSOR                            11370001
113800         MOVE SPACES TO PV-SAVE-STORE-NBR                         11380001
113900     END-IF.                                                      11390001
114000                                                                  11400001
114100 2450-SELECT-SHIPMT.                                              11410001
114200     MOVE SU001-MANIFEST-NBR TO PV-TRIP-ID.                       11420001
114300                                                                  11430001
114400     EXEC SQL                                                     11440001
114500         SELECT A.TRIP_ID                                         11450001
114600              , C.PO_NBR                                          11460001
114700              , C.REC_SEQ_NBR                                     11470001
114800              , C.BOL_NBR                                         11480001
114900              , C.ASN_NBR                                         11490001
115000              , D.SHIPT_UNT_ID                                    11500001
115100          INTO  :SHIPMT-TRIP-ID                                   11510001
115200              , :PKSLIP-PO-NBR                                    11520001
115300              , :PKSLIP-REC-SEQ-NBR                               11530001
115400              , :PKSLIP-BOL-NBR                                   11540001
115500              , :PKSLIP-ASN-NBR                                   11550001
115600              , :INPKSU-SHIPT-UNT-ID                              11560001
115700          FROM  TSHIPMT A                                         11570001
115800              , TSHPTPO B                                         11580001
115900              , TPKSLIP C                                         11590001
116000              , TINPKSU D                                         11600001
116100              , TSHUNLO E                                         11610001
116200*LMM      WHERE A.TRIP_ID          ^= :PV-TRIP-ID                 11620001
116300          WHERE A.SHIPT_ID          = B.SHIPT_ID                  11630001
116400            AND B.PO_NBR            = C.PO_NBR                    11640001
116500            AND B.REC_SEQ_NBR       = C.REC_SEQ_NBR               11650001
116600            AND C.PO_NBR            = D.PO_NBR                    11660001
116700            AND C.SEQ_NBR           = D.SEQ_NBR                   11670001
116800            AND C.SEQ_NBR           = D.SEQ_NBR                   11680001
116900            AND C.VER_STAT_CDE      = :PC-A                       11690001
117000            AND D.SHIPT_UNT_ID      = :SU001-SHIPT-UNT-ID         11700001
117100            AND D.SHIPT_UNT_ID      = E.SHIPT_UNT_ID              11710001
117200            AND E.TRIP_ID           = :PV-TRIP-ID                 11720001
117300     END-EXEC.                                                    11730001
117400                                                                  11740001
117500     EVALUATE TRUE                                                11750001
117600       WHEN SQLCODE = ZEROS                                       11760001
117700       WHEN SQLCODE = -811                                        11770001
117800         CONTINUE                                                 11780001
117900       WHEN SQLCODE = +100                                        11790001
118000            MOVE ZEROES    TO PKSLIP-PO-NBR                       11800001
118100                              PKSLIP-REC-SEQ-NBR                  11810001
118200                              SHIPMT-TRIP-ID                      11820001
118300            MOVE SPACES    TO PKSLIP-BOL-NBR                      11830001
118400                              PKSLIP-ASN-NBR                      11840001
118500       WHEN SQLCODE = -904                                        11850001
118600       WHEN SQLCODE = -911                                        11860001
118700       WHEN SQLCODE = -913                                        11870001
118800         SET PS-ERROR-RECORD TO TRUE                              11880001
118900       WHEN OTHER                                                 11890001
119000         MOVE '2450-SELECT-SHIPMT  '                              11900001
119100                                 TO PV-ABEND-PARAGRAPH            11910001
119200         DISPLAY PV-ABEND-PARAGRAPH                               11920001
119300         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      11930001
119400         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        11940001
119500         PERFORM Z999-SQL-ERROR                                   11950001
119600     END-EVALUATE.                                                11960001
119700                                                                  11970001
119800 2470-SELECT-SHUUPC.                                              11980001
119900                                                                  11990001
120000     EXEC SQL                                                     12000001
120100         SELECT DISTINCT                                          12010001
120200                TRN_NBR                                           12020001
120300          INTO  :SHUUPC-TRN-NBR                                   12030001
120400          FROM  TSHUUPC                                           12040001
120500          WHERE SHIPT_UNT_ID        = :SHUUPC-SHIPT-UNT-ID        12050001
120600     END-EXEC.                                                    12060001
120700                                                                  12070001
120800     EVALUATE TRUE                                                12080001
120900       WHEN SQLCODE = ZEROS                                       12090001
121000       WHEN SQLCODE = -811                                        12100001
121100         CONTINUE                                                 12110001
121200       WHEN SQLCODE = +100                                        12120001
121300            MOVE ZEROES    TO SHUUPC-TRN-NBR                      12130001
121400       WHEN SQLCODE = -904                                        12140001
121500       WHEN SQLCODE = -911                                        12150001
121600       WHEN SQLCODE = -913                                        12160001
121700         SET PS-ERROR-RECORD TO TRUE                              12170001
121800       WHEN OTHER                                                 12180001
121900         MOVE '2470-SELECT-SHUUPC  '                              12190001
122000                                 TO PV-ABEND-PARAGRAPH            12200001
122100         DISPLAY PV-ABEND-PARAGRAPH                               12210001
122200         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      12220001
122300         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        12230001
122400         PERFORM Z999-SQL-ERROR                                   12240001
122500     END-EVALUATE.                                                12250001
122600                                                                  12260001
122700 2500-SELECT-VEHICLE.                                             12270001
122800     MOVE '2500-SELECT-VEHICLE'                                   12280001
122900                                 TO PV-ABEND-PARAGRAPH.           12290001
123000                                                                  12300001
123100     EXEC SQL                                                     12310001
123200         SELECT OWNER_SCAC_ID                                     12320001
123300               ,VEH_NBR                                           12330001
123400           INTO :VHTRIP-OWNER-SCAC-ID                             12340001
123500               ,:VHTRIP-VEH-NBR :DN-VEH-NBR                       12350001
123600           FROM TVHTRIP                                           12360001
123700          WHERE TRIP_ID   = :VHTRIP-TRIP-ID                       12370001
123800     END-EXEC.                                                    12380001
123900     EVALUATE TRUE                                                12390001
124000       WHEN SQLCODE = ZEROS                                       12400001
124100           CONTINUE                                               12410001
124200       WHEN SQLCODE = -904                                        12420001
124300       WHEN SQLCODE = -911                                        12430001
124400       WHEN SQLCODE = -913                                        12440001
124500         SET PS-ERROR-RECORD TO TRUE                              12450001
124600       WHEN OTHER                                                 12460001
124700           DISPLAY PV-ABEND-PARAGRAPH                             12470001
124800           MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                    12480001
124900           MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR      12490001
125000           PERFORM Z999-SQL-ERROR                                 12500001
125100     END-EVALUATE.                                                12510001
125200                                                                  12520001
125300 2510-GET-ORIG-RCVR-NBR.                                          12530001
125400     MOVE '2510-GET-ORIG-RCVR-NBR'                                12540001
125500                                 TO PV-ABEND-PARAGRAPH.           12550001
125600     EXEC SQL                                                     12560001
125700        SELECT B.REC_SEQ_NBR                                      12570001
125900         INTO :PKSLIP-REC-SEQ-NBR                                 12590001
126100         FROM TINPKSU A                                           12610001
126200            , TPKSLIP B                                           12620001
126300        WHERE A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID              12630001
126400          AND A.PO_NBR            = B.PO_NBR                      12640001
126500          AND A.ORIG_PKSL_SEQ_NBR = B.SEQ_NBR                     12650001
126600          AND B.VER_STAT_CDE      = :PC-A                         12660001
126700     END-EXEC                                                     12670001
126800                                                                  12680001
126900     EVALUATE TRUE                                                12690001
127000       WHEN SQLCODE = ZEROS                                       12700001
127100       WHEN SQLCODE = +100                                        12710001
127200         CONTINUE                                                 12720001
127300       WHEN SQLCODE = -904                                        12730001
127400       WHEN SQLCODE = -911                                        12740001
127500       WHEN SQLCODE = -913                                        12750001
127600         SET PS-ERROR-RECORD TO TRUE                              12760001
127700       WHEN OTHER                                                 12770001
127800         DISPLAY PV-ABEND-PARAGRAPH                               12780001
127900         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      12790001
128000         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        12800001
128100         PERFORM Z999-SQL-ERROR                                   12810001
128200     END-EVALUATE.                                                12820001
128300                                                                  12830001
128400                                                                  12840001
128500                                                                  12850001
128600 2540-GET-VEHICLE-INFO.                                           12860001
128700     MOVE '2540-GET-VEHICLE-INFO'                                 12870001
128800                                 TO PV-ABEND-PARAGRAPH.           12880001
128900     EXEC SQL                                                     12890001
129000          SELECT B.BOL_NBR                                        12900001
129100               , C.TRIP_ID                                        12910001
129200               , C.OWNER_SCAC_ID                                  12920001
129300               , C.VEH_NBR                                        12930001
129400            INTO :SHIPMT-BOL-NBR                                  12940001
129500               , :VHTRIP-TRIP-ID                                  12950001
129600               , :VHTRIP-OWNER-SCAC-ID                            12960001
129700                ,:VHTRIP-VEH-NBR :DN-VEH-NBR                      12970001
129800            FROM TSHPTPO A                                        12980001
129900               , TSHIPMT B                                        12990001
130000               , TVHTRIP C                                        13000001
130100           WHERE A.PO_NBR         = :DK-PO-NBR                    13010001
130200             AND A.REC_SEQ_NBR    = :PKSLIP-REC-SEQ-NBR           13020001
130300             AND A.PRIM_SHIPT_IND = :PC-Y                         13030001
130400             AND A.SHIPT_ID       = B.SHIPT_ID                    13040001
130500             AND B.TRIP_ID        = C.TRIP_ID                     13050001
130600     END-EXEC.                                                    13060001
130700                                                                  13070001
130800     EVALUATE TRUE                                                13080001
130900       WHEN SQLCODE = ZEROS                                       13090001
131000         CONTINUE                                                 13100001
131100       WHEN SQLCODE = -904                                        13110001
131200       WHEN SQLCODE = -911                                        13120001
131300       WHEN SQLCODE = -913                                        13130001
131400         SET PS-ERROR-RECORD TO TRUE                              13140001
131500       WHEN OTHER                                                 13150001
131600         DISPLAY PV-ABEND-PARAGRAPH                               13160001
131700         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      13170001
131800         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        13180001
131900         PERFORM Z999-SQL-ERROR                                   13190001
132000     END-EVALUATE.                                                13200001
132100                                                                  13210001
132200 2550-SELECT-TPKSLIP.                                             13220001
132300     MOVE '2550-SELECT-TPKSLIP '                                  13230001
132400                                 TO PV-ABEND-PARAGRAPH.           13240001
132500     EXEC SQL                                                     13250001
132600          SELECT ASN_NBR                                          13260001
132700                ,BOL_NBR                                          13270001
132800            INTO :PKSLIP-ASN-NBR                                  13280001
132900                ,:PKSLIP-BOL-NBR                                  13290001
133000            FROM TPKSLIP                                          13300001
133100           WHERE PO_NBR           = :DK-PO-NBR                    13310001
133200             AND REC_SEQ_NBR      = :PKSLIP-REC-SEQ-NBR           13320001
133400             AND VER_STAT_CDE     = :PC-A                         13340001
133500     END-EXEC.                                                    13350001
133600                                                                  13360001
133700     EVALUATE TRUE                                                13370001
133800       WHEN SQLCODE = ZEROS                                       13380001
133900       WHEN SQLCODE = -811                                        13390001
134000         CONTINUE                                                 13400001
134100       WHEN SQLCODE = -904                                        13410001
134200       WHEN SQLCODE = -911                                        13420001
134300       WHEN SQLCODE = -913                                        13430001
134400         SET PS-ERROR-RECORD TO TRUE                              13440001
134500       WHEN OTHER                                                 13450001
134600         DISPLAY PV-ABEND-PARAGRAPH                               13460001
134700         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      13470001
134800         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        13480001
134900         PERFORM Z999-SQL-ERROR                                   13490001
135000     END-EVALUATE.                                                13500001
135100                                                                  13510001
135200                                                                  13520001
135300 2600-SELECT-SHPUNT.                                              13530001
135400     MOVE '2600-SELECT-SHPUNT '                                   13540001
135500                                 TO PV-ABEND-PARAGRAPH.           13550001
135600     EXEC SQL                                                     13560001
135700         SELECT A.DEST_OPER_UNT_ID                                13570001
135800           INTO :SHPUNT-DEST-OPER-UNT-ID                          13580001
135900          FROM  TSHPUNT A                                         13590001
136000          WHERE A.SHIPT_UNT_ID      = :SHPUNT-SHIPT-UNT-ID        13600001
136100     END-EXEC.                                                    13610001
136200     EVALUATE TRUE                                                13620001
136300       WHEN SQLCODE = ZEROS                                       13630001
136400         CONTINUE                                                 13640001
136500       WHEN SQLCODE = -904                                        13650001
136600       WHEN SQLCODE = -911                                        13660001
136700       WHEN SQLCODE = -913                                        13670001
136800         SET PS-ERROR-RECORD TO TRUE                              13680001
136900       WHEN OTHER                                                 13690001
137000         DISPLAY PV-ABEND-PARAGRAPH                               13700001
137100         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      13710001
137200         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        13720001
137300         PERFORM Z999-SQL-ERROR                                   13730001
137400     END-EVALUATE.                                                13740001
137500                                                                  13750001
137600 2700-OPEN-UPC-CURSOR.                                            13760001
137700     MOVE '2700-OPEN-UPC-CURSOR   '                               13770001
137800                                 TO PV-ABEND-PARAGRAPH.           13780001
137900     EXEC SQL                                                     13790001
138000         OPEN UPC-CSR                                             13800001
138100     END-EXEC.                                                    13810001
138200     EVALUATE TRUE                                                13820001
138300       WHEN SQLCODE = ZEROS                                       13830001
138400         CONTINUE                                                 13840001
138500       WHEN SQLCODE = -904                                        13850001
138600       WHEN SQLCODE = -911                                        13860001
138700       WHEN SQLCODE = -913                                        13870001
138800         SET PS-ERROR-RECORD TO TRUE                              13880001
138900       WHEN OTHER                                                 13890001
139000         DISPLAY PV-ABEND-PARAGRAPH                               13900001
139100         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      13910001
139200         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        13920001
139300         PERFORM Z999-SQL-ERROR                                   13930001
139400     END-EVALUATE.                                                13940001
139500                                                                  13950001
139600 2710-FETCH-UPC-CURSOR.                                           13960001
139700     MOVE '2710-FETCH-UPC-CURSOR   '                              13970001
139800                                 TO PV-ABEND-PARAGRAPH.           13980001
139900     EXEC SQL                                                     13990001
140000          FETCH UPC-CSR                                           14000001
140100          INTO  :SHUUPC-TRN-LNE-NBR                               14010001
140200              , :SHUUPC-UPC-NBR                                   14020001
140300              , :SHUUPC-SHPD-QTY                                  14030001
140400     END-EXEC.                                                    14040001
140500                                                                  14050001
140600     EVALUATE TRUE                                                14060001
140700       WHEN SQLCODE = ZEROS                                       14070001
140800         CONTINUE                                                 14080001
140900       WHEN SQLCODE = +100                                        14090001
141000           SET PS-EOF-UPC-CURSOR TO TRUE                          14100001
141100       WHEN SQLCODE = -904                                        14110001
141200       WHEN SQLCODE = -911                                        14120001
141300       WHEN SQLCODE = -913                                        14130001
141400         SET PS-ERROR-RECORD TO TRUE                              14140001
141500       WHEN OTHER                                                 14150001
141600         DISPLAY PV-ABEND-PARAGRAPH                               14160001
141700         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      14170001
141800         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        14180001
141900         PERFORM Z999-SQL-ERROR                                   14190001
142000     END-EVALUATE.                                                14200001
142100                                                                  14210001
142200 2720-PROCESS-CURSOR.                                             14220001
142300     MOVE SHUUPC-TRN-LNE-NBR     TO DL2-LINE-NBR.                 14230001
142400     ADD SHUUPC-SHPD-QTY         TO PV-EXPTED-QTY.                14240001
142500     ADD SHUUPC-SHPD-QTY         TO PV-LINE-TOT-QTY.              14250001
142600     PERFORM 2710-FETCH-UPC-CURSOR.                               14260001
142700                                                                  14270001
142800     IF PS-DETAIL-RECORD                                          14280001
142900******************************************************************14290001
143000*  REPLACED TSK VARAIBLES WITH XL001 VARIABLES         WR# 21361 *14300001
143100*  AND PV-SAVE-SEQ-NMBR IS REPLACED WITH VARIABLE                *14310001
143200*  PV-SAVE-SKU-NBR.                                              *14320001
143300******************************************************************14330001
143400         IF SHUUPC-TRN-LNE-NBR   NOT = PV-SAVE-TRN-LNE-NBR        14340001
143500         OR XL001-DEPT-NBR-3CH   NOT = PV-SAVE-MERCH-DEPT-NMBR    14350001
143600         OR XL001-SUB-CL-NBR-2CH NOT = PV-SAVE-MERCH-CLASS-NMBR   14360001
143700         OR XL001-SKU-NBR        NOT = PV-SAVE-SKU-NBR            14370001
143800         OR PS-EOF-UPC-CURSOR                                     14380001
143900             IF  PV-LINE-CNT > PC-60                              14390001
144000                  PERFORM 8000-WRITE-REPORT-HEADERS               14400001
144100             END-IF                                               14410001
144200             IF SHUUPC-TRN-LNE-NBR NOT = PV-SAVE-TRN-LNE-NBR      14420001
144300             OR PS-EOF-UPC-CURSOR                                 14430001
144400                 MOVE PV-LINE-TOT-QTY TO DL2-LINE-TOT-QTY         14440001
144500                 MOVE ZERO            TO PV-LINE-TOT-QTY          14450001
144600             ELSE                                                 14460001
144700                 MOVE ZERO            TO DL2-LINE-TOT-QTY         14470001
144800             END-IF                                               14480001
144900             MOVE PV-EXPTED-QTY      TO DL2-EXPTED-QTY            14490001
145000             MOVE ZERO               TO PV-EXPTED-QTY             14500001
145100             PERFORM 8500-WRITE-DETAIL-LINES                      14510001
145200             MOVE PC-1               TO PV-LINE-SUB               14520001
145300         END-IF                                                   14530001
145400******************************************************************14540001
145500*  CALL TO 3000-SELECT-SKU IS REPLACED WITH CALL TO    WR# 21361 *14550001
145600*  3000-CALL-XLKUT-DOMAIN-PGM.                                   *14560001
145700******************************************************************14570001
145800         PERFORM 3000-CALL-XLKUT-DOMAIN-PGM                       14580001
145900     END-IF.                                                      14590001
146000                                                                  14600001
146100******************************************************************14610001
146200*  REPLACED TSK VARAIBLES WITH XL001 VARAIBLES         WR# 21361 *14620001
146300*  AND PV-SAVE-SEQ-NMBR IS REPLACED WITH VARIABLE                *14630001
146400*  PV-SAVE-SKU-NBR.                                              *14640001
146500******************************************************************14650001
146600     IF PS-DETAIL-RECORD                                          14660001
146700         MOVE SHUUPC-TRN-LNE-NBR     TO PV-SAVE-TRN-LNE-NBR       14670001
146800         MOVE XL001-DEPT-NBR-3CH     TO PV-SAVE-MERCH-DEPT-NMBR   14680001
146900         MOVE XL001-SUB-CL-NBR-2CH   TO PV-SAVE-MERCH-CLASS-NMBR  14690001
147000         MOVE XL001-SKU-NBR          TO PV-SAVE-SKU-NBR           14700001
147100     END-IF.                                                      14710001
147200******************************************************************14720001
147300*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *14730001
147400******************************************************************14740001
147500                                                                  14750001
147600 2730-CLOSE-UPC-CURSOR.                                           14760001
147700     MOVE '2730-CLOSE-UPC-CURSOR   '                              14770001
147800                                 TO PV-ABEND-PARAGRAPH.           14780001
147900     EXEC SQL                                                     14790001
148000         CLOSE UPC-CSR                                            14800001
148100     END-EXEC.                                                    14810001
148200     EVALUATE TRUE                                                14820001
148300       WHEN SQLCODE = ZEROS                                       14830001
148400         CONTINUE                                                 14840001
148500       WHEN SQLCODE = -904                                        14850001
148600       WHEN SQLCODE = -911                                        14860001
148700       WHEN SQLCODE = -913                                        14870001
148800         SET PS-ERROR-RECORD TO TRUE                              14880001
148900       WHEN OTHER                                                 14890001
149000         DISPLAY PV-ABEND-PARAGRAPH                               14900001
149100         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      14910001
149200         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        14920001
149300         PERFORM Z999-SQL-ERROR                                   14930001
149400     END-EVALUATE.                                                14940001
149500                                                                  14950001
149600 2800-SELECT-DEST.                                                14960001
149700     MOVE '2800-SELECT-DEST    '                                  14970001
149800                                 TO PV-ABEND-PARAGRAPH.           14980001
149900     EXEC SQL                                                     14990001
150000       SELECT DISTINCT                                            15000001
150100              DEST_OPER_UNT_ID                                    15010001
150200       INTO  :SULBXF-DEST-OPER-UNT-ID                             15020001
150300       FROM   TSULBXF                                             15030001
150400       WHERE  SHIPT_UNT_ID       = :SHPUNT-SHIPT-UNT-ID           15040001
150500         AND  STAT_CDE           = :PC-A                          15050001
150600     END-EXEC.                                                    15060001
150700                                                                  15070001
150800     EVALUATE TRUE                                                15080001
150900       WHEN SQLCODE = ZEROS                                       15090001
151000       WHEN SQLCODE = +100                                        15100001
151100       WHEN SQLCODE = -811                                        15110001
151200         CONTINUE                                                 15120001
151300       WHEN SQLCODE = -904                                        15130001
151400       WHEN SQLCODE = -911                                        15140001
151500       WHEN SQLCODE = -913                                        15150001
151600         SET PS-ERROR-RECORD TO TRUE                              15160001
151700       WHEN OTHER                                                 15170001
151800         DISPLAY PV-ABEND-PARAGRAPH                               15180001
151900         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      15190001
152000         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        15200001
152100         PERFORM Z999-SQL-ERROR                                   15210001
152200     END-EVALUATE.                                                15220001
152300                                                                  15230001
152400*                                                                 15240001
152500******************************************************************15250001
152600*  REMOVED PARAGRAPH 3000-SELECT-SKU                   WR# 21361 *15260001
152700******************************************************************15270001
152800******************************************************************15280001
152900*  ADDED NEW PARAGRAPH 3000-CALL-XLKUT-DOMAIN-PGM      WR# 21361 *15290001
153000******************************************************************15300001
153100 3000-CALL-XLKUT-DOMAIN-PGM.                                      15310001
153200     MOVE '3000-CALL-XLKUT-DOMAIN-PGM'                            15320001
153300                                 TO PV-ABEND-PARAGRAPH.           15330001
153400     INITIALIZE XL001-ITEM-COMMAREA.                              15340001
153500                                                                  15350001
153600     MOVE SHUUPC-UPC-NBR  TO XL001-KEY-UPC-NBR.                   15360001
153700                                                                  15370001
153800     SET XL001-BY-UPC-NBR TO TRUE.                                15380001
153900                                                                  15390001
154000     SET XL001-SELECT-SKU                                         15400001
154100         XL001-SELECT-VND-STYL                                    15410001
154200         XL001-SELECT-UPC TO TRUE.                                15420001
154300                                                                  15430001
154400     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                15440001
154500                                                                  15450001
154600     EVALUATE TRUE                                                15460001
154700       WHEN XL001-UPC-SQLCODE = ZEROS                             15470001
154800         PERFORM 3100-INTERROGATE-SKU-SQLCODE                     15480001
154900       WHEN XL001-UPC-SQLCODE = +100                              15490001
155000         MOVE '000'      TO XL001-DEPT-NBR-3CH                    15500001
155100         MOVE '00'       TO XL001-SUB-CL-NBR-2CH                  15510001
155200         MOVE ZEROS      TO XL001-SKU-NBR                         15520001
155300         MOVE PC-NO-SKU  TO DL2-SKU                               15530001
155400       WHEN XL001-UPC-SQLCODE = -904                              15540001
155500       WHEN XL001-UPC-SQLCODE = -911                              15550001
155600       WHEN XL001-UPC-SQLCODE = -913                              15560001
155700         SET PS-ERROR-RECORD TO TRUE                              15570001
155800         MOVE XL001-SKU-SQLCODE TO  PV-DISPLAY-SKU-SQLCODE        15580001
155900         MOVE XL001-UPC-SQLCODE TO  PV-DISPLAY-UPC-SQLCODE        15590001
156000         MOVE XL001-VND-STYL-SQLCODE TO                           15600001
156100                                 PV-DISPLAY-VS-SQLCODE            15610001
156200         DISPLAY PV-DISPLAY-SKU-SQLCODE ' '                       15620001
156300         PV-DISPLAY-VS-SQLCODE ' '  PV-DISPLAY-UPC-SQLCODE        15630001
156400         DISPLAY ' XLKUT001 PARA #' XL001-ERROR-PARAGRAPH-NBR     15640001
156500       WHEN OTHER                                                 15650001
156600         DISPLAY PV-ABEND-PARAGRAPH                               15660001
156700         MOVE XL001-SKU-SQLCODE TO PV-DISPLAY-SKU-SQLCODE         15670001
156800         MOVE XL001-UPC-SQLCODE TO PV-DISPLAY-UPC-SQLCODE         15680001
156900         MOVE XL001-VND-STYL-SQLCODE TO                           15690001
157000                                 PV-DISPLAY-VS-SQLCODE            15700001
157100         DISPLAY PV-DISPLAY-SKU-SQLCODE ' '                       15710001
157200         PV-DISPLAY-VS-SQLCODE ' '  PV-DISPLAY-UPC-SQLCODE        15720001
157300         DISPLAY ' XLKUT001 PARA #' XL001-ERROR-PARAGRAPH-NBR     15730001
157400         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      15740001
157500         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        15750001
157600         PERFORM Z999-SQL-ERROR                                   15760001
157700     END-EVALUATE.                                                15770001
157800                                                                  15780001
157900 3100-INTERROGATE-SKU-SQLCODE.                                    15790001
158000     MOVE '3100-INTERROGATE-SKU-SQLCODE'                          15800001
158100                                 TO PV-ABEND-PARAGRAPH.           15810001
158200                                                                  15820001
158300     EVALUATE TRUE                                                15830001
158400       WHEN XL001-SKU-SQLCODE = ZEROS                             15840001
158500         MOVE XL001-SKU-NBR        TO PV-SKU-NBR                  15850001
158600         PERFORM 3200-INTERROGATE-VND-SQLCODE                     15860001
158700         MOVE PV-SKU               TO DL2-SKU                     15870001
158800       WHEN XL001-SKU-SQLCODE = +100                              15880001
158900         MOVE '000'      TO XL001-DEPT-NBR-3CH                    15890001
159000         MOVE '00'       TO XL001-SUB-CL-NBR-2CH                  15900001
159100         MOVE ZEROS      TO XL001-SKU-NBR                         15910001
159200         MOVE PC-NO-SKU  TO DL2-SKU                               15920001
159300       WHEN XL001-SKU-SQLCODE = -904                              15930001
159400       WHEN XL001-SKU-SQLCODE = -911                              15940001
159500       WHEN XL001-SKU-SQLCODE = -913                              15950001
159600         SET PS-ERROR-RECORD TO TRUE                              15960001
159700       WHEN OTHER                                                 15970001
159800         DISPLAY PV-ABEND-PARAGRAPH                               15980001
159900         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      15990001
160000         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        16000001
160100         PERFORM Z999-SQL-ERROR                                   16010001
160200     END-EVALUATE.                                                16020001
160300                                                                  16030001
160400 3200-INTERROGATE-VND-SQLCODE.                                    16040001
160500     MOVE '3200-INTERROGATE-VND-SQLCODE'                          16050001
160600                                 TO PV-ABEND-PARAGRAPH.           16060001
160700                                                                  16070001
160800     EVALUATE TRUE                                                16080001
160900       WHEN XL001-VND-STYL-SQLCODE = ZEROS                        16090001
161000         MOVE XL001-DEPT-NBR-3CH   TO PV-SKU-DEPT                 16100001
161100         MOVE XL001-SUB-CL-NBR-2CH TO PV-SKU-CLASS                16110001
161200       WHEN XL001-VND-STYL-SQLCODE = +100                         16120001
161300         MOVE '000'      TO XL001-DEPT-NBR-3CH                    16130001
161400         MOVE '00'       TO XL001-SUB-CL-NBR-2CH                  16140001
161500       WHEN XL001-VND-STYL-SQLCODE = -904                         16150001
161600       WHEN XL001-VND-STYL-SQLCODE = -911                         16160001
161700       WHEN XL001-VND-STYL-SQLCODE = -913                         16170001
161800         SET PS-ERROR-RECORD TO TRUE                              16180001
161900       WHEN OTHER                                                 16190001
162000         DISPLAY PV-ABEND-PARAGRAPH                               16200001
162100         MOVE DK-PO-NBR TO PV-DISPLAY-PO-NBR                      16210001
162200         MOVE PKSLIP-REC-SEQ-NBR TO PV-DISPLAY-REC-SEQ-NBR        16220001
162300         PERFORM Z999-SQL-ERROR                                   16230001
162400     END-EVALUATE.                                                16240001
162500******************************************************************16250001
162600*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *16260001
162700******************************************************************16270001
162800*                                                                 16280001
162900 7000-WRITE-ERROR-REPORT.                                         16290001
163000******************************************************************16300001
163100*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *16310001
163200******************************************************************16320001
163300     PERFORM 8200-WRITE-TOP-LINE.                                 16330001
163400*                                                                 16340001
163500     WRITE SU-CARTON-NOT-RCVD-RECORD                              16350001
163600       FROM HEADING-LINE-0                                        16360001
163700         AFTER ADVANCING 1 LINE.                                  16370001
163800*                                                                 16380001
163900     WRITE SU-CARTON-NOT-RCVD-RECORD                              16390001
164000       FROM HEADING-LINE-1                                        16400001
164100         AFTER ADVANCING 1 LINE.                                  16410001
164200*                                                                 16420001
164300     WRITE SU-CARTON-NOT-RCVD-RECORD                              16430001
164400       FROM HEADING-LINE-1A                                       16440001
164500         AFTER ADVANCING 1 LINE.                                  16450001
164600*                                                                 16460001
164700     WRITE SU-CARTON-NOT-RCVD-RECORD                              16470001
164800       FROM HEADING-LINE-1B                                       16480001
164900         AFTER ADVANCING 1 LINE.                                  16490001
165000*                                                                 16500001
165100     WRITE SU-CARTON-NOT-RCVD-RECORD                              16510001
165200       FROM HEADING-LINE-2                                        16520001
165300         AFTER ADVANCING 4 LINES.                                 16530001
165400*                                                                 16540001
165500     IF SU001-DETAIL-RECORD                                       16550001
165600         WRITE SU-CARTON-NOT-RCVD-RECORD                          16560001
165700           FROM EL1-ERROR-LINE-1P                                 16570001
165800             AFTER ADVANCING 3 LINES                              16580001
165900                                                                  16590001
166000         WRITE SU-CARTON-NOT-RCVD-RECORD                          16600001
166100           FROM EL2-ERROR-LINE-2P                                 16610001
166200             AFTER ADVANCING 2 LINES                              16620001
166300     ELSE                                                         16630001
166400         WRITE SU-CARTON-NOT-RCVD-RECORD                          16640001
166500           FROM EL1-ERROR-LINE-1F                                 16650001
166600             AFTER ADVANCING 3 LINES                              16660001
166700                                                                  16670001
166800         WRITE SU-CARTON-NOT-RCVD-RECORD                          16680001
166900           FROM EL2-ERROR-LINE-2F                                 16690001
167000             AFTER ADVANCING 2 LINES                              16700001
167100     END-IF.                                                      16710001
167200*                                                                 16720001
167300     WRITE SU-CARTON-NOT-RCVD-RECORD                              16730001
167400       FROM EL3-ERROR-LINE-3                                      16740001
167500         AFTER ADVANCING 2 LINES.                                 16750001
167600*                                                                 16760001
167700     MOVE CC-REQUESTOR-ID TO EL4-REQUESTOR-ID                     16770001
167800     MOVE CC-PRINTER-ID   TO EL4-PRINTER-ID.                      16780001
167900     WRITE SU-CARTON-NOT-RCVD-RECORD                              16790001
168000       FROM EL4-ERROR-LINE-4                                      16800001
168100         AFTER ADVANCING 3 LINES.                                 16810001
168200*                                                                 16820001
168300     WRITE SU-CARTON-NOT-RCVD-RECORD                              16830001
168400       FROM EL5-ERROR-LINE-5                                      16840001
168500         AFTER ADVANCING 2 LINE.                                  16850001
168600*JPL                                                              16860001
168700     WRITE SU-CARTON-NOT-RCVD-RECORD                              16870001
168800       FROM EL5-ERROR-LINE-5B                                     16880001
168900         AFTER ADVANCING 2 LINE.                                  16890001
169000*                                                                 16900001
169100     MOVE CC-PRINT-SUKRP002-IND TO EL6-SUKRP002-IND.              16910001
169200     MOVE CC-PRINT-SUKRP003-IND TO EL6-SUKRP003-IND.              16920001
169300     MOVE CC-PRINT-SUKRP004-IND TO EL6-SUKRP004-IND.              16930001
169400     MOVE CC-PRINT-SUKRP005-IND TO EL6-SUKRP005-IND.              16940001
169500     MOVE CC-PRINT-SUKRP006-IND TO EL6-SUKRP006-IND.              16950001
169600     MOVE CC-PRINT-SUKRP007-IND TO EL6-SUKRP007-IND.              16960001
169700     MOVE CC-PRINT-SUKRP008-IND TO EL6-SUKRP008-IND.              16970001
169800*JPL                                                              16980001
169900     MOVE CC-PRINT-SUKRP023-IND TO EL6-SUKRP023-IND.              16990001
170000                                                                  17000001
170100*JPL WRITE SU-CARTON-NOT-RCVD-RECORD                              17010001
170200*JPL   FROM EL6-ERROR-LINE-6                                      17020001
170300*JPL     AFTER ADVANCING 1 LINE.                                  17030001
170400*JPL                                                              17040001
170500     WRITE SU-CARTON-NOT-RCVD-RECORD                              17050001
170600       FROM EL6-ERROR-LINE-6B                                     17060001
170700         AFTER ADVANCING 1 LINE.                                  17070001
170800*                                                                 17080001
170900     WRITE SU-CARTON-NOT-RCVD-RECORD                              17090001
171000       FROM END-OF-REPORT-LINE                                    17100001
171100         AFTER ADVANCING 6 LINES.                                 17110001
171200*                                                                 17120001
171300*                                                                 17130001
171400 8000-WRITE-REPORT-HEADERS.                                       17140001
171500******************************************************************17150001
171600*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *17160001
171700*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *17170001
171800******************************************************************17180001
171900     SET PS-PRT-HEADING TO TRUE.                                  17190001
172000     PERFORM 8200-WRITE-TOP-LINE.                                 17200001
172100*                                                                 17210001
172200     WRITE SU-CARTON-NOT-RCVD-RECORD                              17220001
172300       FROM HEADING-LINE-0                                        17230001
172400         AFTER ADVANCING 1 LINE.                                  17240001
172500*                                                                 17250001
172600     WRITE SU-CARTON-NOT-RCVD-RECORD                              17260001
172700       FROM HEADING-LINE-1                                        17270001
172800         AFTER ADVANCING 1 LINE.                                  17280001
172900*                                                                 17290001
173000     WRITE SU-CARTON-NOT-RCVD-RECORD                              17300001
173100       FROM HEADING-LINE-1A                                       17310001
173200         AFTER ADVANCING 1 LINE.                                  17320001
173300*                                                                 17330001
173400     WRITE SU-CARTON-NOT-RCVD-RECORD                              17340001
173500       FROM HEADING-LINE-1B                                       17350001
173600         AFTER ADVANCING 1 LINE.                                  17360001
173700*                                                                 17370001
173800     WRITE SU-CARTON-NOT-RCVD-RECORD                              17380001
173900       FROM HEADING-LINE-2                                        17390001
174000         AFTER ADVANCING 1 LINES.                                 17400001
174100*                                                                 17410001
174200     WRITE SU-CARTON-NOT-RCVD-RECORD                              17420001
174300       FROM HEADING-LINE-3                                        17430001
174400         AFTER ADVANCING 2 LINES.                                 17440001
174500*                                                                 17450001
174600     WRITE SU-CARTON-NOT-RCVD-RECORD                              17460001
174700       FROM HEADING-LINE-4                                        17470001
174800         AFTER ADVANCING 2 LINES.                                 17480001
174900*                                                                 17490001
175000     WRITE SU-CARTON-NOT-RCVD-RECORD                              17500001
175100       FROM HEADING-LINE-5                                        17510001
175200         AFTER ADVANCING 1 LINE.                                  17520001
175300*                                                                 17530001
175400     MOVE PC-11                   TO PV-LINE-CNT.                 17540001
175500*                                                                 17550001
175600*                                                                 17560001
175700 8100-WRITE-REPORT-HEADERS.                                       17570001
175800******************************************************************17580001
175900*                                                                 17590001
176000     IF  PV-LINE-CNT > PC-56                                      17600001
176100          PERFORM 8000-WRITE-REPORT-HEADERS                       17610001
176200     END-IF                                                       17620001
176300                                                                  17630001
176400     WRITE SU-CARTON-NOT-RCVD-RECORD                              17640001
176500       FROM HEADING-LINE-6                                        17650001
176600         AFTER ADVANCING 2 LINES.                                 17660001
176700*                                                                 17670001
176800     WRITE SU-CARTON-NOT-RCVD-RECORD                              17680001
176900       FROM HEADING-LINE-7                                        17690001
177000         AFTER ADVANCING 1 LINE.                                  17700001
177100                                                                  17710001
177200     ADD PC-3                     TO PV-LINE-CNT.                 17720001
177300     MOVE PC-2                    TO PV-LINE-SUB.                 17730001
177400                                                                  17740001
177500 8200-WRITE-TOP-LINE.                                             17750001
177600******************************************************************17760001
177700*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *17770001
177800*     NEEDED FOR AN ASN NUMBER.                                  *17780001
177900******************************************************************17790001
178000     ADD 1                        TO PV-PAGE-CNT.                 17800001
178100*                                                                 17810001
178200     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          17820001
178300*                                                                 17830001
178400     WRITE SU-CARTON-NOT-RCVD-RECORD                              17840001
178500       FROM DP132O-STANDRD-HEADER-132-COLS                        17850001
178600         AFTER ADVANCING PAGE.                                    17860001
178700*                                                                 17870001
178800*                                                                 17880001
178900 8400-WRITE-DETAIL-LINES.                                         17890001
179000******************************************************************17900001
179100*     WRITES THE DETAIL LINE INFORMATION.                        *17910001
179200******************************************************************17920001
179300     IF DL1-PO-RECEIVER = PV-SAVE-PO-RECEIVER                     17930001
179400         IF PS-PRT-HEADING                                        17940001
179500             SET PS-NOT-PRT-HEADING TO TRUE                       17950001
179600         ELSE                                                     17960001
179700             MOVE SPACES TO DL1-PO-RECEIVER                       17970001
179800         END-IF                                                   17980001
179900     ELSE                                                         17990001
180000         MOVE DL1-PO-RECEIVER      TO PV-SAVE-PO-RECEIVER         18000001
180100         SET PS-NOT-PRT-HEADING TO TRUE                           18010001
180200     END-IF.                                                      18020001
180300                                                                  18030001
180400     MOVE PC-2 TO PV-LINE-SUB.                                    18040001
180500     WRITE SU-CARTON-NOT-RCVD-RECORD                              18050001
180600       FROM DETAIL-LINE1                                          18060001
180700         AFTER ADVANCING PV-LINE-SUB LINES.                       18070001
180800*                                                                 18080001
180900     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              18090001
181000*                                                                 18100001
181100*                                                                 18110001
181200 8500-WRITE-DETAIL-LINES.                                         18120001
181300******************************************************************18130001
181400*     WRITES THE DETAIL LINE INFORMATION.                        *18140001
181500******************************************************************18150001
181600     IF DL2-STORE-NBR = PV-SAVE-STORE-NBR                         18160001
181700         MOVE SPACES TO DL2-STORE-NBR                             18170001
181800     ELSE                                                         18180001
181900         MOVE DL2-STORE-NBR        TO PV-SAVE-STORE-NBR           18190001
182000     END-IF.                                                      18200001
182100     WRITE SU-CARTON-NOT-RCVD-RECORD                              18210001
182200       FROM DETAIL-LINE2                                          18220001
182300         AFTER ADVANCING PV-LINE-SUB LINES.                       18230001
182400*                                                                 18240001
182500     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              18250001
182600*                                                                 18260001
182700*                                                                 18270001
182800******************************************************************18280001
182900*     SQL WARNING OR ERROR PROCESSING                            *18290001
183000*                                                                *18300001
183100******************************************************************18310001
183200                                                                  18320001
183300*                                                                 18330001
183400 Z999-SQL-ERROR.                                                  18340001
183500*---------------                                                  18350001
183600                                                                  18360001
183700     MOVE SQLCODE    TO SQLCODE2.                                 18370001
183800     MOVE SQLERRD(3) TO SQLERRD3.                                 18380001
183900     DISPLAY '** ABEND **       ** = SQLERROR'.                   18390001
184000     DISPLAY '** PROGRAM        ** = SUKRP005'.                   18400001
184100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  18410001
184200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  18420001
184300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   18430001
184400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  18440001
184500     DISPLAY '** PO NBR    ** = ' PV-DISPLAY-PO-NBR               18450001
184600     DISPLAY '** REC SEQ NBR ** = ' PV-DISPLAY-REC-SEQ-NBR        18460001
184700     EXEC SQL                                                     18470001
184800         COMMIT                                                   18480001
184900     END-EXEC.                                                    18490001
185000     MOVE +4013 TO PV-ABEND-CODE.                                 18500001
185100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18510001
