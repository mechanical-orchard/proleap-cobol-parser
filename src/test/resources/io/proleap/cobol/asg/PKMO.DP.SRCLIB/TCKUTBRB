000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TCKUTBRB.                                00050000
000600 AUTHOR.                 BARB SCHULTZ                             00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            04/2013.                                 00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  PURPOSE:                                                       00120000
001300*  INCREASE THE SIZE OF THE TCRD005 FILE FOR THE VANTIV PROJECT.  00130000
001400*  THE SIZE WAS 240 AND IS GOING TO 298.                          00140000
002000***************************************************************** 00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200***************************************************************** 00220000
002300                                                                  00230000
002400 CONFIGURATION SECTION.                                           00240000
002500                                                                  00250000
002600 SOURCE-COMPUTER.        IBM-3090.                                00260000
002700                                                                  00270000
002800 OBJECT-COMPUTER.        IBM-3090.                                00280000
002900                                                                  00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100                                                                  00310000
003200 FILE-CONTROL.                                                    00320000
003300                                                                  00330000
003400     SELECT AJB-EXTRACT-IN-FILE                                   00340015
003500         ASSIGN TO INP01.                                         00350015
003600                                                                  00360000
003400     SELECT UNP-BANK-SETTLE-IN-FILE                               00370000
003500         ASSIGN TO INP02.                                         00380025
003600                                                                  00390000
004300     SELECT AJB-EXTRACT-OUT-FILE                                  00430015
004400         ASSIGN TO OUT01.                                         00440015
004500                                                                  00450000
004600     SELECT UNP-BANK-SETTLE-OUT-FILE                              00460000
004700         ASSIGN TO OUT02.                                         00470025
004800                                                                  00480000
005200******************************************************************00520000
005300 DATA DIVISION.                                                   00530000
005400******************************************************************00540000
005500                                                                  00550000
005600 FILE SECTION.                                                    00560000
005700                                                                  00570000
005800 FD  AJB-EXTRACT-IN-FILE                                          00580015
005900     RECORDING MODE IS F                                          00590015
005900     LABEL RECORDS ARE OMITTED                                    00591023
006000     BLOCK CONTAINS 0 RECORDS.                                    00600015
006100                                                                  00610015
006200 01  AJB-EXTRACT-IN-REC          PIC X(240).                      00620015
006300                                                                  00630000
008600 FD  UNP-BANK-SETTLE-IN-FILE                                      00860000
008700     RECORDING MODE IS F                                          00870000
005900     LABEL RECORDS ARE OMITTED                                    00880023
008900     BLOCK CONTAINS 0 RECORDS.                                    00890006
009100                                                                  00910000
009200 01  UNP-BANK-SETTLE-IN-REC      PIC X(240).                      00920002
009300                                                                  00930000
005800 FD  AJB-EXTRACT-OUT-FILE                                         00931015
005900     RECORDING MODE IS F                                          00932015
005900     LABEL RECORDS ARE OMITTED                                    00932124
006000     BLOCK CONTAINS 0 RECORDS.                                    00933015
006100                                                                  00934015
006200 01  AJB-EXTRACT-OUT-REC         PIC X(298).                      00935015
006300                                                                  00936000
008600 FD  UNP-BANK-SETTLE-OUT-FILE                                     00937000
008700     RECORDING MODE IS F                                          00938000
005900     LABEL RECORDS ARE OMITTED                                    00939024
008900     BLOCK CONTAINS 0 RECORDS.                                    00939106
009100                                                                  00939300
009200 01  UNP-BANK-SETTLE-OUT-REC     PIC X(298).                      00939402
009300                                                                  00939500
010100                                                                  01010000
010200******************************************************************01020000
010300 WORKING-STORAGE SECTION.                                         01030000
010400******************************************************************01040000
010500 01  FILLER                            PIC X(50)  VALUE           01050000
010600     ' *** WORKING STORAGE STARTS HERE FOR TCKUTBRB *** '.        01060000
010700                                                                  01070000
012000  01  PS-PROGRAM-SWITCHES.                                        01200000
012100     05  PS-END-OF-UNP-BANK-SW     PIC X(01)  VALUE 'N'.          01210001
012200         88  PS-END-OF-UNP-BANK-FILE          VALUE 'Y'.          01220001
012300     05  PS-END-OF-AJB-SW          PIC X(01)  VALUE 'N'.          01230001
012500         88  PS-END-OF-AJB-FILE               VALUE 'Y'.          01250001
014700                                                                  01470000
014800******************************************************************01480000
014900*   PROGRAM CONSTANTS                                            *01490000
015000******************************************************************01500000
015100 01  PC-CONSTANTS.                                                01510000
015200     05  PC-PROGRAM-NAME               PIC  X(08) VALUE           01520000
015300                                                 'TCKUTBRB'.      01530000
015400                                                                  01540000
017100 01  PV-PROGRAM-VARIABLES.                                        01640000
017200     05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    01650000
017300     05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    01660000
017400     05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    01670000
108500     05  AC-ABEND-CODE                 PIC S9(04) VALUE +0 COMP.  01700005
066900     05  PV-AJB-COUNTER                PIC  9(08) VALUE ZERO.     01710027
066900     05  PV-BANK-SETTLE-COUNTER        PIC  9(08) VALUE ZERO.     01765027
018000                                                                  01770000
018700******************************************************************01840001
018800*  PREV SETTLEMENT FILE -                                        *01850001
000200*  THIS COPYBOOK IS THE LAYOUT FOR THE EXTRACT FILE TO BE USED   *01872001
000300*  FOR THE EARLY EXTRACT OF CREDIT TRANSACTIONS FOR SETTLEMENT   *01873001
000400*  WITH FIFTH THIRD BANK.   LRECL = 240                          *01874001
000400*  UNP-BANK-SETTLE-IN-FILE                                       *01874101
000500******************************************************************01875001
000600 01  TC005-EXTRACT-RECORD.                                        01876001
000700     05  TC005-PARTN-NBR             PIC S9(04)    COMP.          01877001
000800     05  TC005-STR-NBR               PIC S9(04)    COMP.          01878001
000900     05  TC005-RGST-ID               PIC S9(04)    COMP.          01879001
001000     05  TC005-TRN-NBR               PIC S9(04)    COMP.          01879101
001100     05  TC005-STRT-TM               PIC  X(08).                  01879201
001200     05  TC005-SLS-CORR-SEQ-NBR      PIC S9(04)    COMP.          01879301
001300     05  TC005-TRN-TYP-CDE           PIC  X(02).                  01879401
001400     05  TC005-SLS-DTE               PIC  X(10).                  01879501
001500     05  TC005-TRN-DTE               PIC  X(10).                  01879601
001600     05  TC005-TNDR-SEQ-NBR          PIC S9(04)    COMP.          01879701
001700     05  TC005-TNDR-TYP-CDE          PIC  X(02).                  01879801
001800     05  TC005-TNDR-ID               PIC  X(33).                  01879901
001900     05  TC005-TNDR-AMT              PIC S9(07)V99 COMP-3.        01880001
002000     05  TC005-TNDR-ID-SRC-CDE       PIC  X(02).                  01881001
002100     05  TC005-AUTH-NBR              PIC  X(06).                  01882001
002200     05  TC005-AUTH-SRC-CDE          PIC  X(02).                  01883001
002300     05  TC005-CPS-TRN-ID            PIC S9(15)    COMP-3.        01884001
002400     05  TC005-MC-CMPLIN-CDE         PIC  X(04).                  01885001
002500     05  TC005-VIP-SRC-CDE           PIC  X(01).                  01886001
002600     05  TC005-VIP-RSPN-CDE          PIC  X(02).                  01887001
002700     05  TC005-BNKNET-NBR            PIC  X(15).                  01888001
002800     05  TC005-SETTLE-STORE-NBR      PIC  9(04).                  01889001
002900     05  TC005-ECOMM-REAUTH-IND      PIC  X(01).                  01889101
003000     05  TC005-ECOMM-ORD-NBR         PIC  X(25).                  01889201
003100     05  TC005-AUTH-REF-NBR          PIC  X(45).                  01889301
003200     05  TC005-TRAN-CDE              PIC  X(01).                  01889401
003300         88  TC005-PREV-DAY-TRAN    VALUE 'P'.                    01889501
003400         88  TC005-CURR-DAY-TRAN    VALUE SPACE.                  01889601
003500     05  TC005-MERCHANT-NBR          PIC  X(15).                  01889701
002600     05  TC005-AVS-RSPN-CDE          PIC  X(01).                  01889801
003800     05  TC005-VOID-ABRT-CDE         PIC  X(01).                  01889901
001900     05  TC005-SLS-TX-AMT            PIC S9(07)V99 COMP-3.        01890001
001900     05  TC005-CRD-LVL-RSLT-CDE      PIC  X(02).                  01891001
001900     05  TC005-CVV-RSPN-CDE          PIC  X(01).                  01892001
001900     05  TC005-E-BUS-IND             PIC  X(01).                  01893001
003900     05  FILLER                      PIC  X(16).                  01894001
003900                                                                  01894101
000100******************************************************************01895001
018800*  NEW SETTLEMENT FILE -                                         *01895101
000200*  THIS COPYBOOK IS THE LAYOUT FOR THE EXTRACT FILE TO BE USED   *01896001
000300*  FOR THE EARLY EXTRACT OF CREDIT TRANSACTIONS FOR SETTLEMENT   *01897001
000400*  WITH FIFTH THIRD BANK.  LRECL = 298                           *01898001
000400*  UNP-BANK-SETTLE-OUT-FILE                                      *01898101
000500******************************************************************01899001
000600 01  TC005N-EXTRACT-RECORD.                                       01899101
000700     05  TC005N-PARTN-NBR             PIC S9(04)    COMP.         01899201
000800     05  TC005N-STR-NBR               PIC S9(04)    COMP.         01899301
000900     05  TC005N-RGST-ID               PIC S9(04)    COMP.         01899401
001000     05  TC005N-TRN-NBR               PIC S9(04)    COMP.         01899501
001100     05  TC005N-STRT-TM               PIC  X(08).                 01899601
001200     05  TC005N-SLS-CORR-SEQ-NBR      PIC S9(04)    COMP.         01899701
001300     05  TC005N-TRN-TYP-CDE           PIC  X(02).                 01899801
001400     05  TC005N-SLS-DTE               PIC  X(10).                 01899901
001500     05  TC005N-TRN-DTE               PIC  X(10).                 01900001
001600     05  TC005N-TNDR-SEQ-NBR          PIC S9(04)    COMP.         01901001
001700     05  TC005N-TNDR-TYP-CDE          PIC  X(02).                 01902001
001800     05  TC005N-TNDR-ID               PIC  X(33).                 01903001
001900     05  TC005N-TNDR-AMT              PIC S9(07)V99 COMP-3.       01904001
002000     05  TC005N-TNDR-ID-SRC-CDE       PIC  X(02).                 01905001
002100     05  TC005N-AUTH-NBR              PIC  X(06).                 01906001
002200     05  TC005N-AUTH-SRC-CDE          PIC  X(02).                 01907001
002300     05  TC005N-CPS-TRN-ID            PIC S9(15)    COMP-3.       01908001
002400     05  TC005N-MC-CMPLIN-CDE         PIC  X(04).                 01909001
002500     05  TC005N-VIP-SRC-CDE           PIC  X(01).                 01909101
002600     05  TC005N-VIP-RSPN-CDE          PIC  X(02).                 01909201
002700     05  TC005N-BNKNET-NBR            PIC  X(15).                 01909301
002800     05  TC005N-SETTLE-STORE-NBR      PIC  9(04).                 01909401
002900     05  TC005N-ECOMM-REAUTH-IND      PIC  X(01).                 01909501
003000     05  TC005N-ECOMM-ORD-NBR         PIC  X(25).                 01909601
003100     05  TC005N-AUTH-REF-NBR          PIC  X(45).                 01909701
003200     05  TC005N-TRAN-CDE              PIC  X(01).                 01909801
003300         88  TC005N-PREV-DAY-TRAN    VALUE 'P'.                   01909901
003400         88  TC005N-CURR-DAY-TRAN    VALUE SPACE.                 01910001
003500     05  TC005N-MERCHANT-NBR          PIC  X(15).                 01911001
002600     05  TC005N-AVS-RSPN-CDE          PIC  X(01).                 01912001
003800     05  TC005N-VOID-ABRT-CDE         PIC  X(01).                 01913001
001900     05  TC005N-SLS-TX-AMT            PIC S9(07)V99 COMP-3.       01914001
001900     05  TC005N-CRD-LVL-RSLT-CDE      PIC  X(02).                 01915001
001900     05  TC005N-CVV-RSPN-CDE          PIC  X(01).                 01916001
001900     05  TC005N-E-BUS-IND             PIC  X(01).                 01917001
001900     05  TC005N-NETWK-REF-ID          PIC  X(15).                 01918001
001900     05  TC005N-TRSM-TMST             PIC  X(26).                 01919001
001900     05  TC005N-SYS-TRC-AUD-NBR       PIC  9(06).                 01919101
001900     05  TC005N-TRK-DAT-CND-CDE       PIC  X(02).                 01919201
003900     05  FILLER                       PIC  X(25).                 01919328
019100                                                                  01920000
018700******************************************************************01930001
018800*  PREV REAUTH INPUT FILE                                        *01940001
000200*  THIS COPYBOOK IS THE LAYOUT FOR THE EXTRACT FILE TO BE USED   *01950001
000300*  FOR THE EARLY EXTRACT OF CREDIT TRANSACTIONS FOR SETTLEMENT   *01960001
000400*  WITH FIFTH THIRD BANK.   LRECL = 240                          *01970001
000400*  AJB-EXTRACT-IN-FILE                                           *01980001
000500******************************************************************01990001
000600 01  TC005I-EXTRACT-RECORD.                                       02000003
000700     05  TC005I-PARTN-NBR             PIC S9(04)    COMP.         02010001
000800     05  TC005I-STR-NBR               PIC S9(04)    COMP.         02020001
000900     05  TC005I-RGST-ID               PIC S9(04)    COMP.         02030001
001000     05  TC005I-TRN-NBR               PIC S9(04)    COMP.         02040001
001100     05  TC005I-STRT-TM               PIC  X(08).                 02050001
001200     05  TC005I-SLS-CORR-SEQ-NBR      PIC S9(04)    COMP.         02060001
001300     05  TC005I-TRN-TYP-CDE           PIC  X(02).                 02070001
001400     05  TC005I-SLS-DTE               PIC  X(10).                 02080001
001500     05  TC005I-TRN-DTE               PIC  X(10).                 02090001
001600     05  TC005I-TNDR-SEQ-NBR          PIC S9(04)    COMP.         02100001
001700     05  TC005I-TNDR-TYP-CDE          PIC  X(02).                 02110001
001800     05  TC005I-TNDR-ID               PIC  X(33).                 02120001
001900     05  TC005I-TNDR-AMT              PIC S9(07)V99 COMP-3.       02130001
002000     05  TC005I-TNDR-ID-SRC-CDE       PIC  X(02).                 02140001
002100     05  TC005I-AUTH-NBR              PIC  X(06).                 02150001
002200     05  TC005I-AUTH-SRC-CDE          PIC  X(02).                 02160001
002300     05  TC005I-CPS-TRN-ID            PIC S9(15)    COMP-3.       02170001
002400     05  TC005I-MC-CMPLIN-CDE         PIC  X(04).                 02180001
002500     05  TC005I-VIP-SRC-CDE           PIC  X(01).                 02190001
002600     05  TC005I-VIP-RSPN-CDE          PIC  X(02).                 02200001
002700     05  TC005I-BNKNET-NBR            PIC  X(15).                 02210001
002800     05  TC005I-SETTLE-STORE-NBR      PIC  9(04).                 02220001
002900     05  TC005I-ECOMM-REAUTH-IND      PIC  X(01).                 02230001
003000     05  TC005I-ECOMM-ORD-NBR         PIC  X(25).                 02240001
003100     05  TC005I-AUTH-REF-NBR          PIC  X(45).                 02250001
003200     05  TC005I-TRAN-CDE              PIC  X(01).                 02260001
003300         88  TC005I-PREV-DAY-TRAN    VALUE 'P'.                   02270001
003400         88  TC005I-CURR-DAY-TRAN    VALUE SPACE.                 02280001
003500     05  TC005I-MERCHANT-NBR          PIC  X(15).                 02290001
002600     05  TC005I-AVS-RSPN-CDE          PIC  X(01).                 02300001
003800     05  TC005I-VOID-ABRT-CDE         PIC  X(01).                 02310001
001900     05  TC005I-SLS-TX-AMT            PIC S9(07)V99 COMP-3.       02320001
001900     05  TC005I-CRD-LVL-RSLT-CDE      PIC  X(02).                 02330001
001900     05  TC005I-CVV-RSPN-CDE          PIC  X(01).                 02340001
001900     05  TC005I-E-BUS-IND             PIC  X(01).                 02350001
003900     05  FILLER                      PIC  X(16).                  02360001
003900                                                                  02370001
000100******************************************************************02380001
018800*  NEW REAUTH OUTPUT FILE                                        *02391001
000200*  THIS COPYBOOK IS THE LAYOUT FOR THE EXTRACT FILE TO BE USED   *02400001
000300*  FOR THE EARLY EXTRACT OF CREDIT TRANSACTIONS FOR SETTLEMENT   *02410001
000400*  WITH FIFTH THIRD BANK.  LRECL = 298                           *02420001
000400*  AJB-EXTRACT-OUT-FILE                                          *02421001
000500******************************************************************02430001
000600 01  TC005O-EXTRACT-RECORD.                                       02440001
000700     05  TC005O-PARTN-NBR             PIC S9(04)    COMP.         02450001
000800     05  TC005O-STR-NBR               PIC S9(04)    COMP.         02460001
000900     05  TC005O-RGST-ID               PIC S9(04)    COMP.         02470001
001000     05  TC005O-TRN-NBR               PIC S9(04)    COMP.         02480001
001100     05  TC005O-STRT-TM               PIC  X(08).                 02490001
001200     05  TC005O-SLS-CORR-SEQ-NBR      PIC S9(04)    COMP.         02500001
001300     05  TC005O-TRN-TYP-CDE           PIC  X(02).                 02510001
001400     05  TC005O-SLS-DTE               PIC  X(10).                 02520001
001500     05  TC005O-TRN-DTE               PIC  X(10).                 02530001
001600     05  TC005O-TNDR-SEQ-NBR          PIC S9(04)    COMP.         02540001
001700     05  TC005O-TNDR-TYP-CDE          PIC  X(02).                 02550001
001800     05  TC005O-TNDR-ID               PIC  X(33).                 02560001
001900     05  TC005O-TNDR-AMT              PIC S9(07)V99 COMP-3.       02570001
002000     05  TC005O-TNDR-ID-SRC-CDE       PIC  X(02).                 02580001
002100     05  TC005O-AUTH-NBR              PIC  X(06).                 02590001
002200     05  TC005O-AUTH-SRC-CDE          PIC  X(02).                 02600001
002300     05  TC005O-CPS-TRN-ID            PIC S9(15)    COMP-3.       02610001
002400     05  TC005O-MC-CMPLIN-CDE         PIC  X(04).                 02620001
002500     05  TC005O-VIP-SRC-CDE           PIC  X(01).                 02630001
002600     05  TC005O-VIP-RSPN-CDE          PIC  X(02).                 02640001
002700     05  TC005O-BNKNET-NBR            PIC  X(15).                 02650001
002800     05  TC005O-SETTLE-STORE-NBR      PIC  9(04).                 02660001
002900     05  TC005O-ECOMM-REAUTH-IND      PIC  X(01).                 02670001
003000     05  TC005O-ECOMM-ORD-NBR         PIC  X(25).                 02680001
003100     05  TC005O-AUTH-REF-NBR          PIC  X(45).                 02690001
003200     05  TC005O-TRAN-CDE              PIC  X(01).                 02691001
003300         88  TC005O-PREV-DAY-TRAN    VALUE 'P'.                   02692001
003400         88  TC005O-CURR-DAY-TRAN    VALUE SPACE.                 02693001
003500     05  TC005O-MERCHANT-NBR          PIC  X(15).                 02694001
002600     05  TC005O-AVS-RSPN-CDE          PIC  X(01).                 02695001
003800     05  TC005O-VOID-ABRT-CDE         PIC  X(01).                 02696001
001900     05  TC005O-SLS-TX-AMT            PIC S9(07)V99 COMP-3.       02697001
001900     05  TC005O-CRD-LVL-RSLT-CDE      PIC  X(02).                 02698001
001900     05  TC005O-CVV-RSPN-CDE          PIC  X(01).                 02699001
001900     05  TC005O-E-BUS-IND             PIC  X(01).                 02699101
001900     05  TC005O-NETWK-REF-ID          PIC  X(15).                 02699201
001900     05  TC005O-TRSM-TMST             PIC  X(26).                 02699301
001900     05  TC005O-SYS-TRC-AUD-NBR       PIC  9(06).                 02699401
001900     05  TC005O-TRK-DAT-CND-CDE       PIC  X(02).                 02699501
003900     05  FILLER                      PIC  X(25).                  02699601
019100                                                                  02699701
027600 PROCEDURE DIVISION.                                              02700000
027700                                                                  02710000
027800******************************************************************02720000
027900* 0000-MAINLINE-PARAGRAPH                                         02730000
028000******************************************************************02740000
028100 0000-MAINLINE-PARAGRAPH.                                         02750000
028200                                                                  02760000
028300     PERFORM 1000-INITIALIZE-PROGRAM.                             02770000
028600                                                                  02780008
102600     PERFORM 8100-READ-UNP-BANK-SETTLE.                           02790015
028700     PERFORM 2000-PROCESS                                         02800214
028800           UNTIL PS-END-OF-UNP-BANK-FILE.                         02800314
028600                                                                  02800508
028600     PERFORM 8000-READ-AJB.                                       02800615
028700     PERFORM 2100-PROCESS                                         02810015
028800           UNTIL PS-END-OF-AJB-FILE.                              02820015
028900                                                                  02830000
066900     DISPLAY 'PV-AJB-COUNTER '  PV-AJB-COUNTER.                   02831027
066900     DISPLAY 'PV-BANK-SETTLE-COUNTER ' PV-BANK-SETTLE-COUNTER.    02832027
028900                                                                  02833027
029000     CLOSE AJB-EXTRACT-IN-FILE                                    02840015
029300           UNP-BANK-SETTLE-IN-FILE                                02850015
029200           AJB-EXTRACT-OUT-FILE                                   02860015
029300           UNP-BANK-SETTLE-OUT-FILE.                              02871001
029600                                                                  02900000
029700     GOBACK.                                                      02910000
029800                                                                  02920000
029900******************************************************************02930000
030000* 1000-INITIALIZE-PROGRAM                                         02940000
030100*     OPEN FILES                                                  02950000
030200******************************************************************02960000
030300 1000-INITIALIZE-PROGRAM.                                         02970000
030400                                                                  02980000
003400     OPEN INPUT  AJB-EXTRACT-IN-FILE                              03000015
003400                 UNP-BANK-SETTLE-IN-FILE                          03001015
030700          OUTPUT AJB-EXTRACT-OUT-FILE                             03010015
030900                 UNP-BANK-SETTLE-OUT-FILE.                        03030015
031100                                                                  03050000
059600     INITIALIZE  TC005O-EXTRACT-RECORD.                           03050126
059600     INITIALIZE  TC005N-EXTRACT-RECORD.                           03050226
031100                                                                  03051027
031200***************************************************************** 03060000
031300* 2000-PROCESS                                                    03070000
032200*      MOVE THE FIELDS FROM THE 240 LRECL TO 298 LRECL FOR THE    03170001
032200*      TWO FILES.                                                 03171001
032300***************************************************************** 03180000
032400  2000-PROCESS.                                                   03190000
032500                                                                  03200000
028800     IF PS-END-OF-UNP-BANK-FILE                                   03210012
028800         NEXT SENTENCE                                            03220027
028800     ELSE                                                         03230012
035000         PERFORM 5000-MOVE-FIELDS                                 03650012
           END-IF.                                                      03660012
032500                                                                  03660112
031200***************************************************************** 03661008
031300* 2100-PROCESS                                                    03662008
032200*      MOVE THE FIELDS FROM THE 240 LRECL TO 298 LRECL FOR THE    03663008
032200*      TWO FILES.                                                 03664008
032300***************************************************************** 03665008
032400 2100-PROCESS.                                                    03666015
032400                                                                  04334715
028800     IF PS-END-OF-AJB-FILE                                        04334815
028800         NEXT SENTENCE                                            04334927
028800     ELSE                                                         04335115
035000         PERFORM 5100-MOVE-FIELDS                                 04335215
           END-IF.                                                      04335315
037900                                                                  04335408
041200***************************************************************** 04335508
041300* 5000-MOVE-FIELDS                                                04335608
041400*     MOVE FIELDS FROM THE OLD 240 CHARACTER LAYOUT TO THE NEW    04335708
041500*     298 CHARACTER LAYOUT.                                       04335808
041700***************************************************************** 04335908
041800 5000-MOVE-FIELDS.                                                04336015
041900                                                                  04340008
059800     MOVE TC005-PARTN-NBR        TO  TC005N-PARTN-NBR.            05790012
059900     MOVE TC005-STR-NBR          TO  TC005N-STR-NBR.              05800012
060000     MOVE TC005-RGST-ID          TO  TC005N-RGST-ID.              05810012
060100     MOVE TC005-TRN-NBR          TO  TC005N-TRN-NBR.              05820012
060200     MOVE TC005-STRT-TM          TO  TC005N-STRT-TM.              05830012
060300     MOVE TC005-SLS-CORR-SEQ-NBR TO  TC005N-SLS-CORR-SEQ-NBR.     05840012
060400     MOVE TC005-TRN-TYP-CDE      TO  TC005N-TRN-TYP-CDE.          05850012
060500     MOVE TC005-SLS-DTE          TO  TC005N-SLS-DTE.              05860012
060600     MOVE TC005-TRN-DTE          TO  TC005N-TRN-DTE.              05870012
060800     MOVE TC005-TNDR-SEQ-NBR     TO  TC005N-TNDR-SEQ-NBR.         05890012
060900     MOVE TC005-TNDR-TYP-CDE     TO  TC005N-TNDR-TYP-CDE.         05900012
061000     MOVE TC005-TNDR-ID          TO  TC005N-TNDR-ID.              05910012
001900     MOVE TC005-TNDR-AMT         TO  TC005N-TNDR-AMT.             05911028
061100     MOVE TC005-TNDR-ID-SRC-CDE  TO  TC005N-TNDR-ID-SRC-CDE.      05920012
061200     MOVE TC005-AUTH-NBR         TO  TC005N-AUTH-NBR.             05930012
061300     MOVE TC005-AUTH-SRC-CDE     TO  TC005N-AUTH-SRC-CDE.         05940012
061400     MOVE TC005-CPS-TRN-ID       TO  TC005N-CPS-TRN-ID.           05950012
061500     MOVE TC005-MC-CMPLIN-CDE    TO  TC005N-MC-CMPLIN-CDE.        05960012
061600     MOVE TC005-VIP-SRC-CDE      TO  TC005N-VIP-SRC-CDE.          05970012
061700     MOVE TC005-VIP-RSPN-CDE     TO  TC005N-VIP-RSPN-CDE.         05980012
061800     MOVE TC005-BNKNET-NBR       TO  TC005N-BNKNET-NBR.           05990012
002800     MOVE TC005-SETTLE-STORE-NBR TO  TC005N-SETTLE-STORE-NBR.     05992028
002900     MOVE TC005-ECOMM-REAUTH-IND TO  TC005N-ECOMM-REAUTH-IND.     05993028
003000     MOVE TC005-ECOMM-ORD-NBR    TO  TC005N-ECOMM-ORD-NBR.        05994028
003100     MOVE TC005-AUTH-REF-NBR     TO  TC005N-AUTH-REF-NBR.         05995028
003200     MOVE TC005-TRAN-CDE         TO  TC005N-TRAN-CDE.             05996028
003500     MOVE TC005-MERCHANT-NBR     TO  TC005N-MERCHANT-NBR.         05997028
061800     MOVE TC005-AVS-RSPN-CDE     TO  TC005N-AVS-RSPN-CDE.         06000012
060700     MOVE TC005-VOID-ABRT-CDE    TO  TC005N-VOID-ABRT-CDE.        06001028
061800     MOVE TC005-SLS-TX-AMT       TO  TC005N-SLS-TX-AMT.           06002028
061800     MOVE TC005-CRD-LVL-RSLT-CDE TO  TC005N-CRD-LVL-RSLT-CDE.     06003028
061800     MOVE TC005-CVV-RSPN-CDE     TO  TC005N-CVV-RSPN-CDE.         06010012
001900     MOVE TC005-E-BUS-IND        TO  TC005N-E-BUS-IND.            06073012
001900     MOVE SPACES TO TC005N-NETWK-REF-ID                           06074012
001900                    TC005N-TRSM-TMST                              06075012
001900                     TC005N-TRK-DAT-CND-CDE.                      06077012
001900     MOVE ZEROES TO TC005N-SYS-TRC-AUD-NBR.                       06078012
                                                                        06078112
037800     PERFORM 6400-WRITE-UNP-BANK-SETTLE-REC.                      06079012
                                                                        06410409
102600     PERFORM 8100-READ-UNP-BANK-SETTLE.                           06410512
                                                                        06410612
041200***************************************************************** 06411001
041300* 5100-MOVE-FIELDS                                                06412006
041400*     MOVE THE FIELDS FROM THE 240 LRECL FORMAT TO THE 298        06413006
041500*     LRECL FORMAT.                                               06414006
041700***************************************************************** 06416001
041800 5100-MOVE-FIELDS.                                                06417015
041900                                                                  06418015
059800     MOVE TC005I-PARTN-NBR        TO  TC005O-PARTN-NBR.           06419215
059900     MOVE TC005I-STR-NBR          TO  TC005O-STR-NBR.             06419315
060000     MOVE TC005I-RGST-ID          TO  TC005O-RGST-ID.             06419415
060100     MOVE TC005I-TRN-NBR          TO  TC005O-TRN-NBR.             06419515
060200     MOVE TC005I-STRT-TM          TO  TC005O-STRT-TM.             06419615
060300     MOVE TC005I-SLS-CORR-SEQ-NBR TO  TC005O-SLS-CORR-SEQ-NBR.    06419715
060400     MOVE TC005I-TRN-TYP-CDE      TO  TC005O-TRN-TYP-CDE.         06419815
060500     MOVE TC005I-SLS-DTE          TO  TC005O-SLS-DTE.             06419915
060600     MOVE TC005I-TRN-DTE          TO  TC005O-TRN-DTE.             06420015
060800     MOVE TC005I-TNDR-SEQ-NBR     TO  TC005O-TNDR-SEQ-NBR.        06420215
060900     MOVE TC005I-TNDR-TYP-CDE     TO  TC005O-TNDR-TYP-CDE.        06420315
061000     MOVE TC005I-TNDR-ID          TO  TC005O-TNDR-ID.             06420415
061000     MOVE TC005I-TNDR-AMT         TO  TC005O-TNDR-AMT.            06420529
061100     MOVE TC005I-TNDR-ID-SRC-CDE  TO  TC005O-TNDR-ID-SRC-CDE.     06420629
061200     MOVE TC005I-AUTH-NBR         TO  TC005O-AUTH-NBR.            06420729
061300     MOVE TC005I-AUTH-SRC-CDE     TO  TC005O-AUTH-SRC-CDE.        06420829
061400     MOVE TC005I-CPS-TRN-ID       TO  TC005O-CPS-TRN-ID.          06420929
061500     MOVE TC005I-MC-CMPLIN-CDE    TO  TC005O-MC-CMPLIN-CDE.       06421029
061600     MOVE TC005I-VIP-SRC-CDE      TO  TC005O-VIP-SRC-CDE.         06421129
061700     MOVE TC005I-VIP-RSPN-CDE     TO  TC005O-VIP-RSPN-CDE.        06421229
061800     MOVE TC005I-BNKNET-NBR       TO  TC005O-BNKNET-NBR.          06421329
061800     MOVE TC005I-SETTLE-STORE-NBR TO  TC005O-SETTLE-STORE-NBR.    06421429
061800     MOVE TC005I-ECOMM-REAUTH-IND TO  TC005O-ECOMM-REAUTH-IND.    06421529
061800     MOVE TC005I-ECOMM-ORD-NBR    TO  TC005O-ECOMM-ORD-NBR.       06421629
061800     MOVE TC005I-AUTH-REF-NBR     TO  TC005O-AUTH-REF-NBR.        06421729
061800     MOVE TC005I-TRAN-CDE         TO  TC005O-TRAN-CDE.            06421830
061800     MOVE TC005I-MERCHANT-NBR     TO  TC005O-MERCHANT-NBR.        06421929
061800     MOVE TC005I-AVS-RSPN-CDE     TO  TC005O-AVS-RSPN-CDE.        06422029
060700     MOVE TC005I-VOID-ABRT-CDE    TO  TC005O-VOID-ABRT-CDE.       06422129
060700     MOVE TC005I-SLS-TX-AMT       TO  TC005O-SLS-TX-AMT.          06422229
061800     MOVE TC005I-CRD-LVL-RSLT-CDE TO  TC005O-CRD-LVL-RSLT-CDE.    06422329
061800     MOVE TC005I-CVV-RSPN-CDE     TO  TC005O-CVV-RSPN-CDE.        06422429
001900     MOVE TC005I-E-BUS-IND        TO  TC005O-E-BUS-IND.           06422829
001900     MOVE SPACES TO TC005O-NETWK-REF-ID                           06422929
001900                    TC005O-TRSM-TMST                              06423029
001900                    TC005O-TRK-DAT-CND-CDE.                       06423129
001900     MOVE ZEROES TO TC005O-SYS-TRC-AUD-NBR.                       06423229
                                                                        06423329
037800     PERFORM 6300-WRITE-UPDATE-EXTRACT-REC.                       06423429
                                                                        06423529
035000     PERFORM 8000-READ-AJB.                                       06423629
                                                                        06423729
066200***************************************************************** 06424029
066300*  6300-WRITE-UPDATE-EXTRACT-REC.                                 06430001
066400*      WRITE AJB-EXTRACT-OUT-REC   INPUT TO OUTPUT RECORDS        06440006
066600***************************************************************** 06460000
066700 6300-WRITE-UPDATE-EXTRACT-REC.                                   06470015
066800                                                                  06480015
066900     WRITE AJB-EXTRACT-OUT-REC   FROM TC005O-EXTRACT-RECORD.      06490015
066900                                                                  06491027
066900     ADD 1 TO PV-AJB-COUNTER.                                     06492027
067000                                                                  06500000
066200***************************************************************** 06501001
066300*  6400-WRITE-UNP-BANK-SETTLE-REC.                                06502001
066400*      WRITE UNPROCESSED BANK SETTLE RECORDS OLD TO NEW RECORDS   06503006
066600***************************************************************** 06504001
066700 6400-WRITE-UNP-BANK-SETTLE-REC.                                  06505001
066800                                                                  06506001
066900     WRITE UNP-BANK-SETTLE-OUT-REC   FROM TC005N-EXTRACT-RECORD.  06507001
067000                                                                  06510016
066900     ADD 1 TO PV-BANK-SETTLE-COUNTER.                             06520027
067000                                                                  06530027
102200******************************************************************09960000
102300* 8000-READ-AJB                                                   09970001
102400*     READ THE PREV BANK SETTLE FILE INPUT                        09980000
102500******************************************************************09990000
102600 8000-READ-AJB.                                                   10000001
000400*  AJB-EXTRACT-IN-FILE                                           *10001026
102700                                                                  10010000
059600     INITIALIZE  TC005O-EXTRACT-RECORD.                           10010126
102700                                                                  10010326
102800     READ AJB-EXTRACT-IN-FILE  INTO TC005I-EXTRACT-RECORD         10020001
102900         AT END                                                   10030000
103000             SET PS-END-OF-AJB-FILE TO TRUE.                      10040017
103200                                                                  10060000
102200******************************************************************10200001
102300* 8100-READ-UNP-BANK-SETTLE                                       10210001
102400*     READ THE PREV BANK SETTLE FILE INPUT                        10220001
102500******************************************************************10230001
102600 8100-READ-UNP-BANK-SETTLE.                                       10240001
000400*  UNPROCESSED BANK SETTLE FILE                                  *10241026
102700                                                                  10250001
059600     INITIALIZE  TC005N-EXTRACT-RECORD.                           10250126
102700                                                                  10252026
102800     READ UNP-BANK-SETTLE-IN-FILE INTO TC005-EXTRACT-RECORD       10270001
102900         AT END                                                   10280001
103000             SET PS-END-OF-UNP-BANK-FILE TO TRUE.                 10290017
028800                                                                  10301009
109900******************************************************************10750000
110000* 9999-ABEND                                                      10760000
110100*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  10770000
110200******************************************************************10780000
110300 9999-ABEND.                                                      10790000
110400     DISPLAY '** ABEND           **'.                             10800000
110500     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          10810000
110600     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        10820000
110700     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       10830000
110800     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       10840000
110900     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         10850000
