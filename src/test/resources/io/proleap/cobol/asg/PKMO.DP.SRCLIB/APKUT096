000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT096.                                        00020006
000300 AUTHOR.         NANCY EILBES.                                    00030000
000400 DATE-WRITTEN.   02/11/2003.                                      00040000
000500*************************************************************     00050000
000600*    COBOL 2                                                *     00060000
000700*************************************************************     00070005
000800*  CREATE MONTH-TO-DATE DEPARTMENT FREIGHT TOTALS FTP FILE  *     00080007
000900*************************************************************     00090005
001000*                                                           *     00100005
001100*     REFORMATS ADJUSTMENT JOURNAL EXTRACT TRANSACTIONS TO  *     00110000
001200*     TEXT FORMAT TO FTP TO THE SERVER.  ONLY INCLUDES DEPT *     00120000
001300*     POSTING FISCAL MONTH AND NET COST.                    *     00130000
001400*                                                           *     00140003
001500* INPUT:                                                    *     00150004
001600*  1. ADJUSTMENT JOURNAL EXTRACT FILE  COPYBOOK APRD046     *     00160004
001700*  2. CONTROL CARD                                          *     00170008
001800*                                                           *     00180004
001900* OUTPUT:                                                   *     00190004
002000*  1. FTP FILE                         COPYBOOK APRD072     *     00200004
002100*                                                           *     00210004
002200*************************************************************     00220004
002300*   CHANGES:                                                *     00230008
002400*   DATE  10/16/2003                                        *     00240008
002500*       CHANGE MADE: MODIFIED PROGRAM TO ACCEPT A CONTROL   *     00250008
002600*       CARD VALUE. THIS WILL BE USED TO DETERMINE WHICH    *     00260008
002700*       AMOUNT TO MOVE TO THE AP072-FTP-AMT FIELD. IT WILL  *     00270008
002800*       BE THE FREIGHT AMT FOR FREIGHT CHARGEBACKS WHEN THE *     00280008
002900*       CONTROL CARD VALUE IS 'F'. OTHERWISE IT WILL USE THE*     00290008
003000*       NET COST AMOUNT.                                    *     00300008
003100*       MADE BY: MIKE BESKE              WR/IR #: WR24481   *     00310008
003200*                                                           *     00320008
003300*************************************************************     00330008
003400   EJECT                                                          00340008
003500 ENVIRONMENT DIVISION.                                            00350008
003600 CONFIGURATION SECTION.                                           00360008
003700 SOURCE-COMPUTER.    IBM-3090.                                    00370008
003800 OBJECT-COMPUTER.    IBM-3090.                                    00380008
003900                                                                  00390008
004000 INPUT-OUTPUT SECTION.                                            00400008
004100 FILE-CONTROL.                                                    00410008
004200     SELECT ADJUST-IN-FILE       ASSIGN TO UT-S-INP01.            00420008
004300     SELECT ADJUST-OUT-FILE      ASSIGN TO UT-S-OUT01.            00430008
004400                                                                  00440008
004500 DATA DIVISION.                                                   00450008
004600 FILE SECTION.                                                    00460008
004700                                                                  00470008
004800 FD  ADJUST-IN-FILE                                               00480008
004900     RECORDING MODE IS F                                          00490008
005000     LABEL RECORDS ARE STANDARD                                   00500008
005100     BLOCK CONTAINS 0 RECORDS                                     00510008
005200     DATA RECORD IS ADJUST-IN-REC.                                00520008
005300 01  ADJUST-IN-REC.                                               00530008
005400     05  FILLER                       PIC  X(250).                00540008
005500                                                                  00550008
005600 FD  ADJUST-OUT-FILE                                              00560008
005700     RECORDING MODE IS F                                          00570008
005800     LABEL RECORDS ARE STANDARD                                   00580008
005900     BLOCK CONTAINS 0 RECORDS                                     00590008
006000     DATA RECORD IS ADJUST-OUT-REC.                               00600008
006100 01  ADJUST-OUT-REC.                                              00610008
006200     05  FILLER                       PIC  X(28).                 00620008
006300                                                                  00630008
006400 EJECT                                                            00640008
006500 WORKING-STORAGE SECTION.                                         00650008
006600                                                                  00660008
006700*********************************************************         00670008
006800* THE CONTROL CARD THAT DETERMINES WHICH AMOUNT TO MOVE           00680008
006900* TO THE FTP FILE.                                                00690008
007000*********************************************************         00700008
007100 01  CONTROL-CARD.                                                00710008
007200     05  CC-AMOUNT-TO-USE        PIC  X(01).                      00720008
007300     05  FILLER                  PIC  X(79).                      00730008
007400                                                                  00740008
007500 01  EOF-SW                           PIC X     VALUE 'N'.        00750008
007600     88  IN-EOF                                 VALUE 'Y'.        00760008
007700                                                                  00770008
007800 01  PV-PROGRAM-VARIABLES.                                        00780008
007900     05  PV-INPUT-COUNT               PIC 9(09) VALUE 0.          00790008
008000     05  PV-OUTPUT-COUNT              PIC 9(09) VALUE 0.          00800008
008100                                                                  00810008
008200******************************************************************00820008
008300* INPUT RECORD FORMAT.                                            00830008
008400******************************************************************00840008
008500     COPY APRD046.                                                00850008
008600                                                                  00860008
008700******************************************************************00870008
008800* OUTPUT RECORD FORMAT.                                           00880008
008900******************************************************************00890008
009000     COPY APRD072.                                                00900008
009100                                                                  00910008
009200 EJECT                                                            00920008
009300 PROCEDURE DIVISION.                                              00930008
009400*----------------------------------------------------------------*00940008
009500*    MAIN DRIVER PARAGRAPH.                                      *00950008
009600*----------------------------------------------------------------*00960008
009700 A100-MAIN.                                                       00970008
009800                                                                  00980008
009900     PERFORM B100-INITIALIZE.                                     00990008
010000                                                                  01000008
010100     PERFORM B200-PROCESS                                         01010008
010200         UNTIL IN-EOF.                                            01020008
010300                                                                  01030008
010400     PERFORM B300-TERMINATION.                                    01040008
010500                                                                  01050008
010600     GOBACK.                                                      01060008
010700 EJECT                                                            01070008
010800*----------------------------------------------------------------*01080008
010900*    INITIALIZATION PROCESSING.                                  *01090008
011000*----------------------------------------------------------------*01100008
011100 B100-INITIALIZE.                                                 01110008
011200                                                                  01120008
011300     ACCEPT CONTROL-CARD.                                         01130008
011400     DISPLAY 'CONTROL CARD FOR AMT TO USE : ' CONTROL-CARD.       01140008
011500                                                                  01150008
011600     OPEN INPUT  ADJUST-IN-FILE                                   01160008
011700          OUTPUT ADJUST-OUT-FILE.                                 01170008
011800                                                                  01180008
011900     INITIALIZE AP072-ADJUST-FILE.                                01190008
012000                                                                  01200008
012100     PERFORM R100-READ-INPUT.                                     01210008
012200                                                                  01220008
012300*----------------------------------------------------------------*01230008
012400*    FORMAT THE INPUT RECORD TO THE FTP RECORD LAYOUT.           *01240008
012500*    WRITE OUT THE FTP RECORD.                                   *01250008
012600*    READ THE NEXT INPUT RECORD.                                 *01260008
012700*----------------------------------------------------------------*01270008
012800 B200-PROCESS.                                                    01280008
012900                                                                  01290008
013000     MOVE AP046-DEPT-NBR     TO AP072-DEPT-NBR.                   01300008
013100     MOVE AP046-PSTG-FMN-NBR TO AP072-PSTG-FMN-NBR.               01310008
013200     MOVE AP046-PSTG-FWK-NBR TO AP072-PSTG-FWK-NBR.               01320008
013300                                                                  01330008
013400     IF CC-AMOUNT-TO-USE = 'F'                                    01340008
013500        MOVE AP046-FRGT-AMT     TO AP072-FTP-AMT                  01350008
013600     ELSE                                                         01360008
013700        MOVE AP046-NET-COST-AMT TO AP072-FTP-AMT                  01370008
013800     END-IF.                                                      01380008
013900                                                                  01390008
014000     PERFORM W100-WRITE-OUTPUT.                                   01400008
014100                                                                  01410008
014200     INITIALIZE AP072-ADJUST-FILE.                                01420008
014300                                                                  01430008
014400     PERFORM R100-READ-INPUT.                                     01440008
014500                                                                  01450008
014600*----------------------------------------------------------------*01460008
014700*    END OF PROGRAM PROCESSING.                                  *01470008
014800*----------------------------------------------------------------*01480008
014900 B300-TERMINATION.                                                01490008
015000     DISPLAY '**********************************************'.    01500008
015100     DISPLAY '**         APKUT096 RECORD COUNTS           **'.    01510008
015200     DISPLAY '**********************************************'.    01520008
015300     DISPLAY 'RECORDS READ        = ' PV-INPUT-COUNT.             01530008
015400     DISPLAY 'FTP RECORDS WRITTEN = ' PV-OUTPUT-COUNT.            01540008
015500     DISPLAY '**********************************************'.    01550008
015600                                                                  01560008
015700     CLOSE ADJUST-IN-FILE                                         01570008
015800           ADJUST-OUT-FILE.                                       01580008
015900                                                                  01590008
016000*----------------------------------------------------------------*01600008
016100*    READ THE INPUT FILE.                                        *01610008
016200*----------------------------------------------------------------*01620008
016300 R100-READ-INPUT.                                                 01630008
016400                                                                  01640008
016500     READ ADJUST-IN-FILE INTO AP046-EXTRACT-FILE                  01650008
016600         AT END SET IN-EOF TO TRUE.                               01660008
016700                                                                  01670008
016800     IF EOF-SW = 'N'                                              01680008
016900        ADD 1 TO PV-INPUT-COUNT                                   01690008
017000     END-IF.                                                      01700008
017100                                                                  01710008
017200*----------------------------------------------------------------*01720008
017300*    WRITE A FTP RECORD TO THE OUTPUT FILE.                      *01730008
017400*----------------------------------------------------------------*01740008
017500 W100-WRITE-OUTPUT.                                               01750008
017600                                                                  01760008
017700     WRITE ADJUST-OUT-REC FROM AP072-ADJUST-FILE.                 01770008
017800                                                                  01780008
017900     ADD 1 TO PV-OUTPUT-COUNT.                                    01790008
