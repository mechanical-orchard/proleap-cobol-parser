       IDENTIFICATION DIVISION.                                         00010037
       PROGRAM-ID.       ETKRP001.                                      00020037
       AUTHOR.           COGNIZANT                                      00030046
       DATE-WRITTEN.     NOVEMBER 2017.                                 00040037
       DATE-COMPILED.                                                   00050037
      ****************************************************************  00060037
      *     PROGRAM DESCRIPTION                                      *  00070037
      ****************************************************************  00080037
       ENVIRONMENT DIVISION.                                            00090037
       CONFIGURATION SECTION.                                           00100037
       SOURCE-COMPUTER.        IBM-3090.                                00110037
       OBJECT-COMPUTER.        IBM-3090.                                00120037
       INPUT-OUTPUT SECTION.                                            00130037
       FILE-CONTROL.                                                    00140037
           SELECT PO-EDIPO-D855-INPUT  ASSIGN TO INP01.                 00150037
           SELECT PO-REPORT-FILE       ASSIGN TO RPT01.                 00160038
                                                                        00170037
       DATA DIVISION.                                                   00180037
       FILE SECTION.                                                    00190037
                                                                        00200037
       FD  PO-EDIPO-D855-INPUT                                          00210037
           RECORDING MODE F                                             00220037
           LABEL RECORDS ARE OMITTED                                    00230037
           BLOCK CONTAINS 0 RECORDS                                     00240037
           RECORD CONTAINS 305 CHARACTERS.                              00250037
       01  INPUT-RECORD                     PIC X(305).                 00260038
                                                                        00270037
       FD  PO-REPORT-FILE                                               00280038
           RECORDING MODE F                                             00290037
           LABEL RECORDS ARE STANDARD                                   00300037
           BLOCK CONTAINS 0 CHARACTERS                                  00310037
           RECORD CONTAINS 132 CHARACTERS.                              00320041
       01  REPORT-RECORD                    PIC X(132).                 00330041
                                                                        00570037
       WORKING-STORAGE SECTION.                                         00580037
                                                                        00590037
       01  PROGRAM-SWITCHES.                                            00600037
           05  PS-EOF-D855-FILE-SW        PIC X(01)  VALUE 'N'.         00610037
               88  PS-EOF-D855-FILE                  VALUE 'Y'.         00620037
               88  PS-NOT-EOF-D855-FILE              VALUE 'N'.         00630037
                                                                        00640037
      ******************************************************************00650037
      *   PROGRAM ACCUMULATERS.                                        *00660037
      ******************************************************************00670037
       01  PA-ACCUMULATORS                 COMP-3.                      00680037
           05  PA-PAGE-CNT                 PIC S9(05)    VALUE ZERO.    00690037
           05  PV-LINE-COUNT               PIC S9(03)    VALUE ZERO.    00700037
                                                                        00710037
       01  PROGRAM-VARIABLES.                                           00720037
           05  PV-RECORDS-READ            PIC 9(09)  VALUE ZEROES.      00730037
           05  PV-LINE-LIMIT              PIC 9(03)  VALUE 38.          00750037
           05  PV-POS-CCYY-MM-DD          PIC X(10)  VALUE SPACE.       00760037
           05  PV-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE              00770037
                                                     'ETKRP001'.        00780037
           05  PV-REPORT-NBR-1            PIC 9(01)  VALUE 1.           00790037
           05  PV-POS-CCYY-MM-DD          PIC X(10)  VALUE SPACE.       00800037
           05  PV-POS-CCYY-MM-DD          PIC X(10)  VALUE SPACE.       00810037
           05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      00820037
               10  PV-POS-CCYY            PIC X(04).                    00830037
               10  FILLER                 PIC X(01).                    00840037
               10  PV-POS-MM              PIC X(02).                    00850037
               10  FILLER                 PIC X(01).                    00860037
               10  PV-POS-DD              PIC X(02).                    00870037
           05  PV-CURR-DATE-CCYYMMDD.                                   00880037
               10  PV-CURR-DATE-CCYY      PIC  9(04).                   00890037
               10  PV-CURR-DATE-MM        PIC  9(02).                   00900037
               10  PV-CURR-DATE-DD        PIC  9(02).                   00910037
           05  PV-CURR-TIME.                                            01290037
               10  PV-CURR-TIME-HH        PIC  9(02) VALUE ZERO.        01300037
               10  PV-CURR-TIME-MM        PIC  9(02) VALUE ZERO.        01310037
               10  PV-CURR-TIME-SSHH      PIC  9(04) VALUE ZERO.        01320037
           05  PV-PO-NBR2                 PIC  X(10) VALUE SPACES.      01330040
                                                                        01380037
      *----------------------------------------------------------------*01621038
      * RECORD LAYOUT FOR INPUT 855 FILE                                01640038
      *----------------------------------------------------------------*01641038
       01  PV-INPUT-FILE-LAYOUT.                                        01642038
           05  PV-PO-NBR                PIC    X(22)   VALUE SPACES.    01643037
           05  PV-DEPT-NBR              PIC    X(03)   VALUE SPACES.    01645037
           05  PV-HOLD-DTE              PIC    X(10)   VALUE SPACES.    01647037
           05  PV-TRN-SET-CDE           PIC    X(03)   VALUE SPACES.    01649037
           05  PV-ENT-NAME-DES          PIC    X(250)  VALUE SPACES.    01660037
           05  PV-TRAN-SET-NME-ID       PIC    X(03)   VALUE SPACES.    01680037
           05  PV-UPC                   PIC    X(14)   VALUE SPACES.    01700045
                                                                        01710037
                                                                        01890137
      *----------------------------------------------------------------*01891038
      * STANDARD HEADER LAYOUT                                         *01900038
      *----------------------------------------------------------------*01901038
           COPY DPWS132O.                                               01902038
                                                                        01903038
       01  BLANK-LINE                    PIC X(132) VALUE SPACES.       01907038
                                                                        01908038
      *--------------------------------------------------------------*  01909038
      * REPORT HEADER LAYOUT                                         *  01909138
      *--------------------------------------------------------------*  01909238
       01  HL-HEADER1.                                                  01909338
           05  FILLER                  PIC  X(48)     VALUE SPACES.     01909438
           05  HL-TITLE                PIC  X(38)     VALUE             01909538
               '855 DOCUMENTS ON HOLD REPORT'.                          01909638
           05  FILLER                  PIC  X(46)     VALUE SPACES.     01909738
                                                                        01910238
       01  HL-HEADER2.                                                  01910338
           05  FILLER             PIC   X(08) VALUE 'PO_NBR  '.         01910538
           05  FILLER             PIC   X(05) VALUE SPACES.             01910739
           05  FILLER             PIC   X(08) VALUE 'DEPT_NBR'.         01910838
           05  FILLER             PIC   X(03) VALUE SPACES.             01911038
           05  FILLER             PIC   X(08) VALUE 'HOLD_DTE'.         01911138
           05  FILLER             PIC   X(05) VALUE SPACES.             01911238
           05  FILLER             PIC   X(11) VALUE 'TRN_SET_CDE'.      01911338
           05  FILLER             PIC   X(03) VALUE SPACES.             01911538
           05  FILLER             PIC   X(12) VALUE 'ENT_NAME_DES'.     01911638
           05  FILLER             PIC   X(14) VALUE SPACES.             01911843
           05  FILLER             PIC   X(15) VALUE 'TRAN_SET_NME_ID'.  01911938
           05  FILLER             PIC   X(03) VALUE SPACES.             01912038
           05  FILLER             PIC   X(14) VALUE 'UPC'.              01912145
                                                                        01913038
      *--------------------------------------------------------------*  01913938
      * REPORT DETAIL LAYOUT                                         *  01914038
      *--------------------------------------------------------------*  01914138
       01  DL-DETAIL.                                                   01914238
           05  DL-PO-NBR               PIC    X(10)   VALUE SPACES.     01914339
           05  FILLER                  PIC    X(03)   VALUE SPACES.     01914438
           05  DL-DEPT-NBR             PIC    X(08)   VALUE SPACES.     01914538
           05  FILLER                  PIC    X(03)   VALUE SPACES.     01914638
           05  DL-HOLD-DTE             PIC    X(10)   VALUE SPACES.     01914738
           05  FILLER                  PIC    X(03)   VALUE SPACES.     01914838
           05  DL-TRN-SET-CDE          PIC    X(11)   VALUE SPACES.     01914938
           05  FILLER                  PIC    X(03)   VALUE SPACES.     01915038
           05  DL-ENT-NAME-DES         PIC    X(23)   VALUE SPACES.     01915141
           05  FILLER                  PIC    X(03)   VALUE SPACES.     01915238
           05  DL-TRAN-SET-NME-ID      PIC    X(15)   VALUE SPACES.     01915338
           05  FILLER                  PIC    X(03)   VALUE SPACES.     01915438
           05  DL-UPC                  PIC    X(14)   VALUE SPACES.     01915545
                                                                        01915938
      *--------------------------------------------------------------*  01916038
      * NO INPUT DATA                                                *  01916138
      *--------------------------------------------------------------*  01916238
       01  NO-DATA-LINE.                                                01916338
           05  FILLER               PIC X(52) VALUE SPACES.             01916438
           05  FILLER               PIC X(27) VALUE                     01916538
               'NO DATA FOUND ON INPUT FILE'.                           01916638
           05  FILLER               PIC X(61) VALUE SPACES.             01916738
                                                                        01916838
      *--------------------------------------------------------------*  01916938
      * END OF REPORT                                                *  01917138
      *--------------------------------------------------------------*  01917238
       01  END-OF-REPORT.                                               01917338
           05  FILLER                  PIC  X(47)     VALUE SPACES.     01918038
           05  FILLER                  PIC  X(37)     VALUE             01919038
               '**********  END OF REPORT  **********'.                 01920038
           05  FILLER                  PIC  X(48)     VALUE SPACES.     01930038
                                                                        01940038
       LINKAGE SECTION.                                                 02340038
      *----------------------------------------------------------------*02341038
       PROCEDURE DIVISION.                                              02360038
      *----------------------------------------------------------------*02360138
       1000-MAINLINE-ROUTINE.                                           02380038
                                                                        02390038
           PERFORM 1100-INITIALIZATION.                                 02400038
                                                                        02410038
           PERFORM 2000-PROCESS-INPUT-FILE                              02420038
             UNTIL PS-EOF-D855-FILE.                                    02430038
                                                                        02440038
           PERFORM 4000-TERMINATION.                                    02450038
                                                                        02451038
           GOBACK.                                                      02460038
                                                                        02470038
      *--------------------------------------------------------------*  02480038
      *  INITIALIZATION PROCESSING                                   *  02490038
      *--------------------------------------------------------------*  02500038
       1100-INITIALIZATION.                                             02510038
                                                                        02520038
           DISPLAY ' '.                                                 02530038
           DISPLAY '**--------------- ETKRP001 --------------------**'. 02540038
                                                                        02570038
           OPEN INPUT  PO-EDIPO-D855-INPUT                              02580038
                OUTPUT PO-REPORT-FILE.                                  02590038
                                                                        02600038
           PERFORM 2500-FORMAT-HEADINGS.                                02601038
                                                                        02602038
           PERFORM 3000-READ-INPUT-FILE.                                02610038
                                                                        02611038
           PERFORM 2600-WRITE-PAGE-HEADINGS-1.                          02620038
                                                                        02630038
                                                                        02740038
           IF PS-EOF-D855-FILE                                          02741038
              DISPLAY 'NO DATA RETRIEVED FROM CURSOR'                   02742038
              WRITE REPORT-RECORD FROM NO-DATA-LINE                     02743038
                    AFTER 2 LINES                                       02744038
              ADD 2  TO PV-LINE-COUNT                                   02745038
      *    ELSE                                                         02746038
      *       MOVE PV-PO-NBR            TO PV-PO-NBR2                   02747038
           END-IF.                                                      02748038
      *--------------------------------------------------------------*  02750038
      *  PROCESS                                                     *  02760038
      *--------------------------------------------------------------*  02770038
       2000-PROCESS-INPUT-FILE.                                         02780038
                                                                        02791038
           PERFORM 2300-MOVE-FIELDS-TO-DETAIL.                          02950038
                                                                        02960038
           PERFORM 2400-WRITE-RPT-FILE.                                 03010038
                                                                        03020038
           PERFORM 3000-READ-INPUT-FILE.                                03030038
                                                                        03040038
      *--------------------------------------------------------------*  03595738
      *  MOVE THE FIELDS TO THE DETAIL LINE                          *  03595838
      *--------------------------------------------------------------*  03595938
       2300-MOVE-FIELDS-TO-DETAIL.                                      03596038
           MOVE PV-PO-NBR            TO DL-PO-NBR.                      03596138
           MOVE PV-DEPT-NBR          TO DL-DEPT-NBR.                    03596438
           MOVE PV-HOLD-DTE          TO DL-HOLD-DTE.                    03596738
           MOVE PV-TRN-SET-CDE       TO DL-TRN-SET-CDE.                 03596938
           MOVE PV-ENT-NAME-DES      TO DL-ENT-NAME-DES.                03597238
           MOVE PV-TRAN-SET-NME-ID   TO DL-TRAN-SET-NME-ID.             03597338
           MOVE PV-UPC               TO DL-UPC.                         03597445
                                                                        03597638
      *--------------------------------------------------------------*  03597738
      *  THIS ROUTINE WRITES THE DETAIL TO THE REPORT                *  03597838
      *--------------------------------------------------------------*  03597938
       2400-WRITE-RPT-FILE.                                             03598038
           ADD +1                TO PV-LINE-COUNT.                      03598138
                                                                        03598238
           IF PV-LINE-COUNT > PV-LINE-LIMIT                             03598338
               PERFORM 2600-WRITE-PAGE-HEADINGS-1                       03598438
           WRITE REPORT-RECORD FROM DL-DETAIL AFTER 1                   03598544
           ELSE IF DL-PO-NBR NOT EQUAL PV-PO-NBR2                       03598644
           MOVE DL-PO-NBR TO PV-PO-NBR2                                 03598744
           WRITE REPORT-RECORD FROM DL-DETAIL AFTER 1                   03598944
           ELSE                                                         03599044
           INITIALIZE DL-DETAIL                                         03599144
           MOVE PV-UPC               TO DL-UPC                          03599245
           WRITE REPORT-RECORD FROM DL-DETAIL AFTER 1                   03599344
           END-IF.                                                      03599538
                                                                        03599638
      ******************************************************************03600238
      * GET CURRENT DATE AND TIME FROM SYSTEM.                         *03600338
      * FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.             *03600438
      * FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.                 *03600538
      ******************************************************************03600638
       2500-FORMAT-HEADINGS.                                            03601038
                                                                        03610038
           MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   03622038
           ACCEPT PV-CURR-TIME FROM TIME.                               03622138
           DISPLAY 'DATE ' FUNCTION CURRENT-DATE(1:8)                   03622238
                 '  TIME ' FUNCTION CURRENT-DATE(9:6).                  03622338
                                                                        03622538
           MOVE PV-CURR-DATE-MM             TO DP132O-RUN-MONTH.        03622638
           MOVE PV-CURR-DATE-DD             TO DP132O-RUN-DAY.          03622738
           MOVE PV-CURR-DATE-CCYY           TO DP132O-RUN-YEAR.         03622838
                                                                        03622938
           MOVE PV-CURR-TIME-HH             TO DP132O-RUN-HOUR.         03623038
           MOVE PV-CURR-TIME-MM             TO DP132O-RUN-MINUTE.       03623138
           MOVE PV-CURRENT-PROGRAM-NAME     TO DP132O-PROGRAM-NAME.     03623238
           MOVE PV-REPORT-NBR-1             TO DP132O-REPORT-NUMBER.    03624038
                                                                        03628038
      ******************************************************************03629138
      * WRITE PAGE HEADINGS                                            *03629238
      ******************************************************************03629338
       2600-WRITE-PAGE-HEADINGS-1.                                      03629438
                                                                        03629538
           INITIALIZE PV-LINE-COUNT.                                    03629638
           ADD 1                             TO PA-PAGE-CNT.            03629738
           MOVE PA-PAGE-CNT                  TO DP132O-PAGE-NUMBER.     03629838
                                                                        03629938
           WRITE REPORT-RECORD                                          03630038
                 FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.        03630138
                                                                        03630238
           WRITE REPORT-RECORD               FROM HL-HEADER1 AFTER 1.   03630338
           WRITE REPORT-RECORD               FROM BLANK-LINE AFTER 1.   03630438
           WRITE REPORT-RECORD               FROM HL-HEADER2 AFTER 1.   03630538
           WRITE REPORT-RECORD               FROM BLANK-LINE AFTER 1.   03630638
           ADD 7                             TO PV-LINE-COUNT.          03630738
                                                                        03630838
      *--------------------------------------------------------------*  03631038
      *  READS THE CHECK INPUT FILE                                  *  03640038
      *--------------------------------------------------------------*  03650038
       3000-READ-INPUT-FILE.                                            03660038
           READ PO-EDIPO-D855-INPUT INTO PV-INPUT-FILE-LAYOUT           03670038
             AT END                                                     03680038
                SET PS-EOF-D855-FILE TO TRUE                            03690038
             NOT AT END                                                 03700038
                ADD 1 TO PV-RECORDS-READ                                03710038
           END-READ.                                                    03720038
                                                                        03740038
      *--------------------------------------------------------------*  04301038
      *  END OF PROGRAM PROCESSING                                   *  04302038
      *--------------------------------------------------------------*  04303038
       4000-TERMINATION.                                                04304038
                                                                        04304138
           WRITE REPORT-RECORD FROM END-OF-REPORT AFTER 2.              04313338
                                                                        04313438
           DISPLAY '** TOTAL RECORDS READ    = ' PV-RECORDS-READ.       04313538
           DISPLAY '**************************************'.            04314238
           DISPLAY '****  RECORD COUNTS FOR ETKRP001  ****'.            04314338
           DISPLAY '**************************************'.            04314438
           DISPLAY 'PO RECORDS READ    ' PV-RECORDS-READ.               04314538
           DISPLAY '**************************************'.            04314638
           DISPLAY '****   END OF PROGRAM ETKRP001    ****'.            04314742
           DISPLAY '**************************************'.            04314838
                                                                        04314938
           CLOSE PO-EDIPO-D855-INPUT                                    04315038
                 PO-REPORT-FILE.                                        04320038
