000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS597.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  05-15-02.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    S597 - TRAILER SHIP/RELEASE                                 *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO SHIP OR RELEASE A           *00120000
001300*    TRAILER.  WHEN THE USER IS SHIPPING THE TRAILER, INFO       *00130000
001400*    MUST BE ENTERED ON THE SCREEN TO COMPLETE THE SHIPPING.     *00140000
001500*----------------------------------------------------------------*00150000
001510******************************************************************00151000
001520* 03/04/2010 MICHAEL J. WATTS                                     00152000
001521*            MADE CHANGES FOR EFC2 PROJECT (WR38216)              00152100
001523*            REMOVED HARDCODED EFC # FROM 4100C  AND REPLACED     00152300
001524*            WITH LOGIC FOR TABLE XLT_LOC                         00152400
001130*                                                                 00152554
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00152654
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00152754
001550*                                                                 00155000
001560*                                                                 00156000
001570******************************************************************00157000
001580                                                                  00158000
001600 ENVIRONMENT DIVISION.                                            00160000
001700 DATA DIVISION.                                                   00170000
001800                                                                  00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     05  DK-TRLR-SRL-NBR                PIC S9(09)  VALUE ZERO    00220000
002300                                                    COMP.         00230000
002400     05  DK-TRIP-ID                     PIC S9(09)  VALUE ZERO    00240000
002500                                                    COMP.         00250000
002600     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00260000
002700                                                    COMP.         00270000
002800     05  DK-CURR-STAT-CDE               PIC  X(02).               00280000
002900     05  DK-NEXT-STAT-CDE               PIC  X(02).               00290000
003000     05  DK-SEAL-ID                     PIC  X(20).               00300000
003010     05  DK-SEAL-ID-CHECK               PIC  X(20).               00301033
003100     05  DK-OTBND-TMST                  PIC  X(26).               00310000
003200     05  DK-DOOR-ID                     PIC  X(04).               00320000
003210* JAK 02/07 - ADD 1 KEY FIELD                                     00321000
003220     05  DK-LOC-ID                      PIC S9(04)  VALUE ZERO    00322000
003230                                                    COMP.         00323000
003231*PK 11/25/13 HAZ SUMRY RPT ADD 2 FIELD                            00323102
003232     05  DK-HAZDS-IND                   PIC  X(01)  VALUE 'Y'.    00323202
003233     05  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00323302
003234                                                         COMP.    00323403
003240*                                                                 00324000
003250 01  PC-PROGRAM-CONSTANTS.                                        00325000
003260     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'SUKCS597'.  00326000
003270     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'SU597A  '.  00327000
003280     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'SUKM597 '.  00328000
003290     05  PC-TRAILER-PROGRAM       PIC  X(08)  VALUE  'PCKCS714'.  00329000
003300     05  PC-SUMMARY-PROGRAM       PIC  X(08)  VALUE  'SUKCS574'.  00330000
003400     05  PC-LOCATION-MODULE       PIC  X(08)  VALUE  'XLKUT071'.  00340000
003410*** PK 11/25/13 HAZ SUMRY ADDED 2 FIELD                           00341006
003420     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE  'DPKCS060'.  00342003
003430     05  PC-REPORT-PGM            PIC  X(08)  VALUE  'SUKCS597'.  00343002
003500     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00350000
003600                                              COMP.               00360000
003700     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00370000
003800                                              COMP.               00380000
003900     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           00390000
004000                                              COMP.               00400000
004100     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00410000
004200     05  PC-INTER-APPL-CODES.                                     00420000
004300         10  PC-INTER-APPL-CRIT-SPEC                              00430000
004400                                  PIC  X(01)  VALUE '1'.          00440000
004500         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00450000
004600     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00460000
004700* JAK 02/07 - ADD 2 SHIP-CNTL FIELDS TO CALL WSKCS306             00470000
004800     05  PC-SHIP-CNTL-MOD            PIC X(08)  VALUE             00480000
004900                                                 'WSKCS306'.      00490000
005000     05  PC-SHIP-CNTL-MOD-LENGTH     PIC S9(4) VALUE +125         00500000
005100                                                COMP SYNC.        00510000
005110* PK 11/25/13 HAZ SUMRY ADDED 7 FIELDS                            00511006
005120     05  PC-01                   PIC X(02)    VALUE '01'.         00512002
005130     05  PC-TEST                 PIC X(01)    VALUE 'T'.          00513002
005140     05  PC-QA                   PIC X(01)    VALUE 'Q'.          00514002
005150     05  PC-LEARN                PIC X(01)    VALUE 'L'.          00515002
005160     05  PC-STATUS-REPORT-DESC   PIC X(18)    VALUE               00516002
005170                                 'HAZ SUMMARY REPORT'.            00517002
005180     05  PC-STATUS-REPORT-PROC   PIC X(07)    VALUE               00518002
005190                                  'SUK9141'.                      00519002
005191     05  PC-STATUS-REPORT-JOB    PIC X(07)    VALUE               00519102
005192                                  'SUK914 '.                      00519202
005200                                                                  00520000
005210                                                                  00521000
005220                                                                  00522000
005230*----------------------------------------------------------------*00523000
005240*  SYSTEM MESSAGES                                               *00524000
005250*----------------------------------------------------------------*00525000
005260*                                                                 00526000
005270*   00007 - REQUIRED ENTRY                                        00527000
005271*   00016 - UPDATE MUST BE REQUESTED BEFORE CONFIRM               00527100
005272*   00059 - UPDATE MUST BE REQUESTED BEFORE CONFIRM               00527200
005273*   00069 - TOP OF LIST                                           00527300
005274*   00070 - BOTTOM OF LIST                                        00527400
005275*   00095 - APPLICATION SYSTEM DOES NOT EXIST                     00527500
005276*   00148 - DATA DOES NOT EXIST                                   00527600
005277*   00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID            00527700
005278*   00388 - ONLY ONE REPLACEABLE SYMBOLIC VARIABLE (&VAR) CAN BE E00527800
005279*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES          00527900
005280*   02816 - INVALID TRAILER STATUS FOR UPDATE FUNCTION            00528000
005281*   02931 - THE SEAL # DOES NOT MATCH THE SEAL # FROM THE TRLR CLO00528100
005282*   02941 - RELEASE FUNCTION ONLY VALID FOR SHUTTLE AND STORAGE TR00528200
005283*   02943 - TRAILER HAS NO DIVERTED CARTONS - F2 TO SHIP TRAILER  00528300
005284*   02944 - TRAILER IS EMPTY - F2 TO SHIP TRAILER                 00528400
005285*   02967 - SHIPPING TRAILER MUST BE EMPTY TO RELEASE TRAILER     00528500
005286*   02969 - YOU DO NOT HAVE AUTHORITY TO UPDATE THE STATUS OF THIS00528600
005287*   02992 - SHIP FUNCTION ONLY VALID FOR SHIP/SHUTTLE TRAILERS    00528700
005288*   03010 - UNLOAD/RELEASE STRG TRLR FUNC ONLY VALID FOR STORAGE  00528800
005289*   03011 - UNLOAD/RELEASE STORAGE TRAILER - F2 TO CONFIRM        00528900
005290*   03038 - TRLR MUST BE CLOSED AT LEAST ONCE TO PERFORM THIS FUNC00529000
005291*   03039 - CRTN DETACHED FROM TRLR, TRLR MUST BE RELEASED TO USE 00529100
005292*   03044 - TRAILER HAS NO DIVERTED CARTONS                       00529200
005293*   03047 - UNABLE TO RELEASE TRAILER, END DIVERT MUST BE SET 1ST 00529300
005294*   03382 - UNLOAD/RELEASE STORAGE/SHUTTLE TRAILER - F2 TO CONFIRM00529400
005295*   99901 - INVALID COMMAND WAS ENTERED                           00529500
005296*   03741 - DC IS NOT TURNED ON FOR HAZMAT                        00529602
005297*   03742 - NO HAZMAT ON THIS TRUCK - NO REPRT WILL PRINT         00529702
005298*   03743 - HAZMAT REPORT PRINT HAS BEEN REQUESTED                00529802
005299*   03765 - TRAILER IS EMPTY - PLEASE USE RELEASE TRAILER FUNCTION00529925
005300*   03800 - TRAILER SEAL USED ON TRIP &VAR - MUST USE A DIFF SEAL 00530033
005301*----------------------------------------------------------------*00530133
005302     05  PC-TSYMSG-NUMBERS.                                       00530233
005303         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00530333
005304         10  PC-TSYMSG-00016      PIC  9(05)  VALUE  00016.       00530433
005310         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00531000
005400         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00540000
005500         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00550000
005600         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00560000
005700         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00570000
005800         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00580000
005900         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       00590000
006000         10  PC-TSYMSG-00984      PIC  9(05)  VALUE  00984.       00600000
006100         10  PC-TSYMSG-02816      PIC  9(05)  VALUE  02816.       00610000
006200         10  PC-TSYMSG-02931      PIC  9(05)  VALUE  02931.       00620000
006300         10  PC-TSYMSG-02941      PIC  9(05)  VALUE  02941.       00630000
006400         10  PC-TSYMSG-02943      PIC  9(05)  VALUE  02943.       00640000
006500         10  PC-TSYMSG-02944      PIC  9(05)  VALUE  02944.       00650000
006600         10  PC-TSYMSG-02967      PIC  9(05)  VALUE  02967.       00660000
006700         10  PC-TSYMSG-02969      PIC  9(05)  VALUE  02969.       00670000
006800         10  PC-TSYMSG-02992      PIC  9(05)  VALUE  02992.       00680000
006900         10  PC-TSYMSG-03010      PIC  9(05)  VALUE  03010.       00690000
006910         10  PC-TSYMSG-03011      PIC  9(05)  VALUE  03011.       00691000
006920         10  PC-TSYMSG-03038      PIC  9(05)  VALUE  03038.       00692000
006930         10  PC-TSYMSG-03039      PIC  9(05)  VALUE  03039.       00693000
006940         10  PC-TSYMSG-03044      PIC  9(05)  VALUE  03044.       00694000
006950         10  PC-TSYMSG-03047      PIC  9(05)  VALUE  03047.       00695000
006960         10  PC-TSYMSG-03382      PIC  9(05)  VALUE  03382.       00696000
006970* JAK 02/07 - ADD MSG 03546 & 03548                               00697000
006971         10  PC-TSYMSG-03546      PIC  9(05)  VALUE  03546.       00697100
006972         10  PC-TSYMSG-03548      PIC  9(05)  VALUE  03548.       00697200
006973         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00697300
006974* PK 11/25/13 ADDED MSG 03743, 00746 & 03741                      00697402
006975         10  PC-TSYMSG-03743      PIC  9(05)  VALUE  03743.       00697502
006976         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00697602
006977         10  PC-TSYMSG-03741      PIC  9(05)  VALUE  03741.       00697702
006978         10  PC-TSYMSG-03742      PIC  9(05)  VALUE  03742.       00697802
006979* DANH 03/19/15 ADDED MSG 03765                                   00697924
006980         10  PC-TSYMSG-03765      PIC  9(05)  VALUE  03765.       00698021
006981         10  PC-TSYMSG-03800      PIC  9(05)  VALUE  03800.       00698134
006982*                                                                 00698234
006985 01  PS-PROGRAM-SWITCHES.                                         00698516
006986     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00698616
006987         88  PS-ERROR                         VALUE  'Y'.         00698716
006988         88  PS-NO-ERROR                      VALUE  'N'.         00698816
006989     05  PS-TRAILER-NOT-FOUND-SW  PIC  X(01)  VALUE  'Y'.         00698916
006990         88  PS-TRAILER-NOT-FOUND             VALUE  'N'.         00699016
006991         88  PS-TRAILER-FOUND                 VALUE  'Y'.         00699100
007000     05  PS-INITIAL-BUILD-SW      PIC  X(01)  VALUE  'N'.         00700000
007100         88  PS-NOT-INITIAL-BUILD             VALUE  'N'.         00710000
007200         88  PS-INITIAL-BUILD                 VALUE  'Y'.         00720000
007300     05  PS-VALID-STATUS-CHANGE-SW PIC X(01)  VALUE  'N'.         00730000
007400         88  PS-VALID-STATUS-CHANGE           VALUE  'Y'.         00740000
007500         88  PS-NOT-VALID-STATUS-CHANGE       VALUE  'N'.         00750000
007600     05  PS-ACCESS-SW             PIC  X(01)  VALUE 'N'.          00760000
007700         88  PS-ACCESS-ALLOWED                VALUE 'Y'.          00770000
007800         88  PS-ACCESS-NOT-ALLOWED            VALUE 'N'.          00780000
007900     05  PS-YES-NO-SW             PIC  S9(03) COMP-3.             00790000
008000         88  PS-THERE-ARE-SUMMARIES           VALUE ZERO.         00800000
008100         88  PS-THERE-ARE-NO-SUMMARIES        VALUE 1.            00810000
008200* JAK 02/07 - ADD DWNLD-ASN SWITCH                                00820000
008300     05  PS-DWNLD-ASN-TO-WMS      PIC  X(01)  VALUE 'N'.          00830000
008400         88  PS-DWNLD-ASN-TO-WMS-YES          VALUE 'Y'.          00840000
008500         88  PS-DWNLD-ASN-TO-WMS-NO           VALUE 'N'.          00850000
008510*** PK 11/25/13 HAZMAT SUMMARY BEGIN                              00851002
008520     05  PS-HAZ-EOCUR-WS          PIC  X(01)  VALUE 'N'.          00852002
008530         88  PS-HAZCUR-END                    VALUE 'Y'.          00853002
008540         88  PS-HAZCUR-NOT-END                VALUE 'N'.          00854002
008550     05  PS-TRIP-EXCPT-SKU        PIC  X(01)  VALUE 'N'.          00855002
008560         88  PS-TRIP-EXCPT-SKU-Y              VALUE 'Y'.          00856002
008570         88  PS-TRIP-EXCPT-SKU-N              VALUE 'N'.          00857002
008580     05  PS-TRIP-EXCPT-WGT        PIC  X(01)  VALUE 'N'.          00858002
008590         88  PS-TRIP-EXCPT-WGT-Y              VALUE 'Y'.          00859002
008591         88  PS-TRIP-EXCPT-WGT-N              VALUE 'N'.          00859102
008592     05  PS-HAZ-PRCSS             PIC  X(01)  VALUE 'N'.          00859202
008593         88  PS-HAZ-PRCSS-YES                 VALUE 'Y'.          00859302
008594         88  PS-HAZ-PRCSS-NO                  VALUE 'N'.          00859402
008595     05  PS-INTERNAL-READER-ENQ-DEQ-IND                           00859502
008596                                  PIC X(1)    VALUE 'N'.          00859602
008597         88  PS-INTERNAL-READER-ENQUEUED      VALUE 'Y'.          00859702
008598         88  PS-INTERNAL-READER-DEQUEUED      VALUE 'N'.          00859802
008599*** PK 11/25/13 HAZMAT SUMMARY END                                00859902
008600*                                                                 00860000
008700 01  PV-PROGRAM-VARIABLES.                                        00870000
008800     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00880000
008900                                              COMP SYNC.          00890000
009000     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00900000
009100                                              COMP SYNC.          00910000
009200     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            00920000
009300                                              COMP SYNC.          00930000
009400     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            00940000
009500                                              COMP SYNC.          00950000
009600     05  PV-TRIP-ID               PIC  9(09).                     00960000
009700     05  PV-OPER-UNIT-ID          PIC  9(04).                     00970000
009800     05  PV-USA-DATE              PIC  X(10).                     00980000
009900     05  PV-MAX-TMST              PIC  X(26).                     00990000
010000                                                                  01000000
010100     05  PV-DISP-RETAIL           PIC ZZZZZZZZ.99 BLANK ZERO.     01010000
010200     05  PV-DISP-COST             PIC ZZZZZZZZ.99 BLANK ZERO.     01020000
010300     05  PV-DEFAULT-TMST          PIC X(26)  VALUE                01030000
010400                                  '9999-09-09-09.09.09.999999'.   01040000
010500     05  PV-END-TMST              PIC X(26)  VALUE SPACES.        01050000
010600     05  PV-DISP-OPER             PIC Z(04)  VALUE ZERO.          01060000
010700     05  PV-DISP-TRIP             PIC Z(09)  VALUE ZERO.          01070000
010800* JAK 02/07 - ADD LOC-ID FIELD                                    01080000
010810     05  PV-LOC-ID                PIC  9(04).                     01081000
010811     05  PV-LOC-TYP-CDE           PIC X(02)  VALUE 'DS'.          01081100
010812     05  PV-E-BUS-IND             PIC X(01)  VALUE 'Y'.           01081200
010813                                                                  01081300
010814*** PK 11/25/13 HAZMAT SUMMARY BEGIN                              01081402
010815     05  PV-SYS-TRLG-CDE          PIC X(03)      VALUE SPACES.    01081502
010816     05  PV-HAZ-SKU-NBR           PIC S9(8)V COMP-3 VALUE ZEROES. 01081602
010817     05  PV-CRIT-SKU-WGT          PIC S9(7)V9(5) COMP-3.          01081702
010818     05  PV-TOT-SKU-CNT           PIC S9(9)      COMP.            01081802
010819     05  PV-PREV-SKU-NBR          PIC S9(8)V COMP-3 VALUE -1.     01081902
010820     05  PV-CURR-SKU-NBR          PIC S9(8)V COMP-3 VALUE ZEROES. 01082002
010821     05  PV-USER-ID               PIC X(8)       VALUE SPACES.    01082102
010822     05  PV-SKU-TOT-WGT           PIC S9(10)V9(5) COMP-3.         01082202
010823     05  PV-SKU-TOT-WGT-CMP       PIC S9(10)V9(5) COMP-3.         01082302
010824     05  PV-SKU-UOM               PIC X(4).                       01082402
010825     05  PV-SKU-UOM-GRP.                                          01082502
010826         10 PV-SKU-UOM-CMP        PIC X(2).                       01082602
010827         10 FILLER                PIC X(2).                       01082702
010828     05  PV-SYSTEM-ID.                                            01082802
010829         10 FILLER                PIC X(04) VALUE SPACE.          01082902
010830         10 PV-REGION-IND         PIC X(01).                      01083002
010831            88  PV-TEST-CICS                VALUE 'T'.            01083102
010832            88  PV-QA-CICS                  VALUE 'Q'.            01083202
010833            88  PV-PROD-CICS                VALUE 'P'.            01083302
010834            88  PV-LEARN-CICS               VALUE 'L'.            01083402
010835         10 FILLER                PIC X(03) VALUE SPACES.         01083502
010836                                                                  01083602
010837     05  PV-JOB-DESCRIPTION       PIC X(18) VALUE SPACES.         01083702
010838     05  PV-JOB-PROC              PIC X(07) VALUE SPACES.         01083802
010839     05  PV-JOB-NAME              PIC X(07) VALUE SPACES.         01083902
010840     05  PV-PRINTER-DESTINATION   PIC X(05) VALUE SPACES.         01084002
010841     05  PV-NULL-IND-1            PIC S9(04)  VALUE ZEROS         01084102
010842                                              COMP SYNC.          01084202
010843     05  PV-NULL-IND-2            PIC S9(04)  VALUE ZEROS         01084302
010844                                              COMP SYNC.          01084402
010845     05  PV-NULL-IND-3            PIC S9(04)  VALUE ZEROS         01084502
010846                                              COMP SYNC.          01084602
010847     05  PV-NULL-IND-4            PIC S9(04)  VALUE ZEROS         01084702
010848                                              COMP SYNC.          01084802
010849     05  PV-STORE-SCAN-COUNT      PIC S9(09)  COMP.               01084927
010850* DMH 10/8/17                                                     01085034
010851     05  PV-OTBND-TRIP-ID         PIC S9(09)  COMP.               01085134
010852     05  PV-DC-OPER               PIC  S9(4) COMP.                01085241
010853                                                                  01085334
010854*-----------------------------------------------------------------01085434
010855*  JCL LINES FOR A STATUS REPORTS REQUEST                         01085534
010856*-----------------------------------------------------------------01085634
010857  01  JL-JCL-LINE-AREA.                                           01085734
010858      05  JL-JCL-LINE-1           PIC X(80)    VALUE SPACE.       01085834
010859      05  JL-JOB-LINE-PROD.                                       01085934
010860          10  FILLER              PIC X(02)    VALUE '//'.        01086034
010861          10  JL-PROD-JOB-NAME    PIC X(07)    VALUE SPACE.       01086134
010862          10  FILLER              PIC X(12)    VALUE              01086234
010863              '  JOB KOHLS,'.                                     01086334
010864          10  FILLER              PIC X(1)     VALUE QUOTE.       01086434
010865* START INC1030982                                                01086534
010866          10  JL-PROD-JOB-DESC    PIC X(18)    VALUE SPACES.      01086634
010867* END INC1030982                                                  01086734
010868          10  FILLER              PIC X(1)     VALUE QUOTE.       01086834
010869          10  FILLER              PIC X(29)    VALUE              01086934
010870              ',MSGCLASS=P,CLASS=P'.                              01087034
010871* START INC1030982                                                01087134
010872          10  FILLER              PIC X(10)    VALUE SPACES.      01087234
010873* END INC1030982                                                  01087334
010874      05  JL-JOB-LINE-TEST.                                       01087434
010875          10  FILLER              PIC X(02)    VALUE '//'.        01087534
010876          10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACE.       01087634
010877          10  FILLER              PIC X(01)    VALUE 'Q'.         01087734
010878          10  FILLER              PIC X(11)    VALUE              01087834
010879              ' JOB KOHLS,'.                                      01087934
010880          10  FILLER              PIC X(1)     VALUE QUOTE.       01088034
010881          10  JL-TEST-JOB-DESC    PIC X(18)    VALUE SPACES.      01088134
010882          10  FILLER              PIC X(1)     VALUE QUOTE.       01088234
010883          10  FILLER              PIC X(29)    VALUE              01088334
010884              ',MSGCLASS=X,CLASS=E'.                              01088434
010885          10  FILLER              PIC X(10)    VALUE SPACES.      01088534
010886      05  JL-JCL-LINE-2.                                          01088634
010887          10  FILLER              PIC X(34)    VALUE              01088734
010888          '//JOBOUT01 OUTPUT FORMS=STD,CLASS='.                   01088834
010889          10  JL-LINE-2-CLASS     PIC X(1)     VALUE SPACES.      01088934
010890          10  FILLER              PIC X(15)    VALUE              01089034
010891          ',COPIES=1,DEST='.                                      01089134
010892          10  JL-LINE-2-PRINTER   PIC X(8)     VALUE SPACES.      01089234
010893          10  FILLER              PIC X(22)    VALUE SPACES.      01089334
010894      05  JL-PROC-DSN.                                            01089434
010895          10  FILLER              PIC X(38)    VALUE              01089534
010896          '//PROCDSN  JCLLIB ORDER=(TKMA.PROCLIB)'.               01089634
010897          10  FILLER              PIC X(42)    VALUE SPACES.      01089734
010898      05  JL-JCL-LINE-3-PROD.                                     01089834
010899          10  FILLER              PIC X(40)    VALUE              01089934
010900               '//JOBLIB    DD DSN=PKMO.LOADLIB,DISP=SHR'.        01090034
010901          10  FILLER              PIC X(40)    VALUE SPACES.      01090134
010902      05  JL-JCL-LINE-3-TEST.                                     01090234
010903          10  FILLER              PIC X(40)    VALUE              01090334
010904               '//JOBLIB    DD DSN=TKMA.LOADLIB,DISP=SHR'.        01090434
010905          10  FILLER              PIC X(40)    VALUE SPACES.      01090534
010906      05  JL-JCL-LINE-4.                                          01090634
010907          10  FILLER              PIC X(16)    VALUE              01090734
010908              '//PS020    EXEC '.                                 01090834
010909          10  JL-LINE-4-PROC      PIC X(07)    VALUE SPACES.      01090934
010910          10  JL-LINE-4-PROC-T    PIC X(01)    VALUE SPACE.       01091034
010911          10  FILLER              PIC X(56)    VALUE SPACES.      01091134
010912      05  JL-JCL-LINE-5.                                          01091234
010913          10  FILLER              PIC X(18)    VALUE              01091334
010914              '//S010.SYSUT1 DD *'.                               01091434
010915          10  FILLER              PIC X(62)    VALUE SPACES.      01091534
010916      05  JL-JCL-LINE-6.                                          01091634
010917          10  JL-LINE-6-USER-ID     PIC X(07)    VALUE SPACES.    01091734
010918          10  FILLER                PIC X(01)    VALUE SPACES.    01091834
010919          10  JL-LINE-6-TRIP-ID     PIC X(09)    VALUE SPACES.    01091934
010920          10  FILLER                PIC X(01)    VALUE SPACES.    01092034
010921          10  JL-LINE-6-OPRUNT-ID   PIC X(04)    VALUE SPACES.    01092134
010922          10  FILLER                PIC X(01)    VALUE SPACE.     01092234
010923          10  JL-LINE-6-TO-STR      PIC X(04)    VALUE SPACES.    01092334
010924          10  FILLER                PIC X(01)    VALUE SPACE.     01092434
010925          10  JL-LINE-6-TRIP-CD     PIC X(02)    VALUE SPACES.    01092534
010926          10  FILLER                PIC X(01)    VALUE SPACE.     01092634
010927          10  JL-LINE-6-STAT-DATE   PIC X(10)    VALUE SPACES.    01092734
010928          10  JL-LINE-6-TRLR-ID     PIC X(12)    VALUE SPACES.    01092834
010929          10  JL-LINE-6-SYS-TRL-CD  PIC X(03)    VALUE SPACES.    01092934
010930          10  JL-LINE-6-SCAC        PIC X(04)    VALUE SPACES.    01093034
010931          10  JL-LINE-6-TRLR-SL-NBR PIC 9(09)    VALUE ZEROES.    01093134
010932          10  JL-LINE-6-PRINTER-ID  PIC X(08)    VALUE SPACES.    01093234
010933          10  JL-LINE-6-PRTR-CNTL   PIC X(01)    VALUE SPACES.    01093334
010934          10  JL-LINE-6-TRACK-NBR   PIC 9(01)    VALUE ZEROES.    01093434
010935          10  FILLER                PIC X(01)    VALUE SPACE.     01093534
010936      05  JL-JCL-LINE-EOF.                                        01093634
010937          10  FILLER              PIC X(5)     VALUE '/*EOF'.     01093734
010938          10  FILLER              PIC X(75)    VALUE SPACES.      01093834
010939 01  TD-TRANSIENT-DATA-AREA.                                      01093934
010940     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            01094034
010941                                 COMP SYNC.                       01094134
010942     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           01094234
010943                                 COMP SYNC.                       01094334
010944     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       01094434
010945     05  TD-JCL-LINE             PIC X(80)    VALUE SPACES.       01094534
010946*** PK 11/25/13 HAZMAT SUMMARY END                                01094634
010947                                                                  01094734
010948**--------------------------------------------------------------**01094834
010949** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **01094934
010950** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **01095034
010951**--------------------------------------------------------------**01095134
010952     COPY SUWS010.                                                01095234
010953                                                                  01095334
010954                                                                  01095434
010955**  COMMAREA TO PASS DATA TO THE PCKRF714 PROGRAM                 01095534
010960**  -  OR  - CALL THE SUMMARIZE TRAILER MODULE                    01096000
011000**--------------------------------------------------------------**01100000
011100     COPY PCWS047.                                                01110000
011200                                                                  01120000
011300*----------------------------------------------------------------*01130000
011400*    MAP LAYOUT                                                  *01140000
011500*----------------------------------------------------------------*01150000
011600     COPY SUKM597.                                                01160000
011700                                                                  01170000
011710*----------------------------------------------------------------*01171000
011720*    ATTRIBUTE SETTINGS COPYBOOK.                                *01172000
011730*----------------------------------------------------------------*01173000
011740     COPY DPWS015.                                                01174000
011750                                                                  01175000
011760     COPY DPWS008.                                                01176000
011770                                                                  01177000
011780*----------------------------------------------------------------*01178000
011790*    FUNCTION KEYS COPYBOOK                                      *01179000
011800*----------------------------------------------------------------*01180000
011900                                                                  01190000
012000     COPY DPWS016.                                                01200000
012100                                                                  01210000
012200**--------------------------------------------------------------**01220000
012300** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01230000
012400** SUB-ROUTINE (DPKUT100).                                      **01240000
012500**--------------------------------------------------------------**01250000
012600     COPY DPWS010I.                                               01260000
012700                                                                  01270000
012800**--------------------------------------------------------------**01280000
013000** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **01300054
013100**--------------------------------------------------------------**01310000
013200     COPY DPWS030.                                                01320000
013200     COPY DPWS930.                                                01321054
013300                                                                  01330000
013400**--------------------------------------------------------------**01340000
013500** LOCATION MODULE COPYBOOK                                       01350000
013600**--------------------------------------------------------------**01360000
013700     COPY XLWS071.                                                01370000
013800                                                                  01380000
013900* JAK 02/07 - ADD WSWS004                                         01390000
014000**--------------------------------------------------------------* 01400000
014100** SHIPMENT CONTROL MODULE COPYBOOK                               01410000
014110**--------------------------------------------------------------* 01411000
014120     COPY WSWS004.                                                01412000
014130                                                                  01413000
014140**--------------------------------------------------------------**01414000
014150*    STANDARD COMMAREA.                                           01415000
014160**--------------------------------------------------------------**01416000
014170     COPY DPWS020.                                                01417000
014180     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01418000
014190                                                                  01419000
014200***************************************************************** 01420000
014300*    INTER-APPLICATION COMMAREA.                                  01430000
014400***************************************************************** 01440000
014500                                                                  01450000
014600         10  INTER-APPL-COMM-AREA PIC X(200).                     01460000
014700     COPY SUWS008.                                                01470000
014800     COPY SUWS009.                                                01480000
014900***************************************************************** 01490000
015000*    SPECIFIC COMMMAREA FOR SUKCS597.                             01500000
015100***************************************************************** 01510000
015200         10  ASC-SPECIFIC-COMMAREA.                               01520000
015300             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            01530000
015400             15  ASC-TRLR-SRL-NBR          PIC  9(09).            01540000
015500             15  ASC-SCAC                  PIC  X(04).            01550000
015600             15  ASC-TRAILER-ID            PIC  X(12).            01560000
015700             15  ASC-TRIP-ID               PIC  9(09).            01570000
015800             15  ASC-OPER-UNT-ID           PIC  9(04).            01580000
015900             15  ASC-TRIP-STATUS           PIC  X(30).            01590000
016000             15  ASC-DOOR-TYP-CDE          PIC  X(02).            01600000
016100             15  ASC-TRIP-STAT-CDE         PIC  X(02).            01610000
016200             15  ASC-TRIP-STATUS-DATE      PIC  X(10).            01620000
016300             15  ASC-DOOR-SLOT             PIC  X(06).            01630000
016400             15  ASC-DOOR-SLOT-DESC        PIC  X(20).            01640000
016500             15  ASC-DESTINATION-ID        PIC  9(04).            01650000
016600             15  ASC-DESTINATION-DESC      PIC  X(25).            01660000
016700             15  ASC-UNIT-COUNT            PIC  S9(11) COMP-3.    01670000
016800             15  ASC-CARTON-COUNT          PIC  S9(11) COMP-3.    01680000
016900             15  ASC-ESTIMATED-WEIGHT      PIC  S9(11) COMP-3.    01690000
017000             15  ASC-RETAIL                PIC  S9(15)V99 COMP-3. 01700000
017100             15  ASC-COST                  PIC  S9(15)V99 COMP-3. 01710000
017200             15  ASC-PALLETS               PIC  S9(09) COMP-3.    01720000
017300             15  ASC-ORIG-TRLR-SEAL-NBR    PIC  X(20).            01730000
017400             15  ASC-TRAILER-SEAL-NBR      PIC  X(20).            01740000
017500             15  ASC-SHIP-SCAC-CODE        PIC  X(04).            01750000
017600             15  ASC-DRIVER-FIRST-NAME     PIC  X(30).            01760000
017700             15  ASC-DRIVER-LAST-NAME      PIC  X(30).            01770000
017800             15  ASC-DRIVER-ID             PIC  X(20).            01780000
017900             15  ASC-DOOR-TYPE-CODE        PIC  X(02).            01790000
018000             15  ASC-USE-SELECTION-QUEUE-IND                      01800000
018100                                           PIC  X(01).            01810000
018200                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 01820000
018300             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            01830000
018400             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    01840000
018500             15  ASC-NUMBER-OF-SELECTED-ITEMS                     01850000
018600                                           PIC S9(09)  COMP-3.    01860000
018700             15  ASC-SEL-SUB               PIC S9(04)  COMP.      01870000
018800             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      01880000
018900                                                                  01890000
019000             15  ASC-RACF-SHIP-AUTH-FOUND-SW PIC  X(01).          01900000
019100                 88  ASC-RACF-SHIP-AUTH-YES      VALUE  'Y'.      01910000
019200                 88  ASC-RACF-SHIP-AUTH-NO       VALUE  'N'.      01920000
019300             15  ASC-RACF-RLSE-AUTH-FOUND-SW PIC  X(01).          01930000
019400                 88  ASC-RACF-RLSE-AUTH-YES      VALUE  'Y'.      01940000
019500                 88  ASC-RACF-RLSE-AUTH-NO       VALUE  'N'.      01950000
019600                                                                  01960000
019700             15  ASC-SECOND-CONFIRM-REQSTD-SW PIC X(01).          01970000
019800                 88  ASC-SECOND-CONFIRM-REQUESTED  VALUE 'N' 'E'. 01980000
019900                 88  ASC-NO-DIVERT-CONFIRM         VALUE 'N'.     01990000
020000                 88  ASC-EMPTY-CONFIRM             VALUE 'E'.     02000000
020100                 88  ASC-NO-SECOND-CONFIRM-REQSTD  VALUE ' '.     02010000
020200                 88  ASC-UNLD-RLSE-CONFIRM-REQSTD  VALUE 'U'.     02020000
020300             15  ASC-CONFIRM-REQUESTED-SW  PIC  X(01).            02030000
020400                 88  ASC-CONFIRM-REQUESTED     VALUE 'Y'.         02040000
020500                 88  ASC-NO-CONFIRM-REQUESTED  VALUE ' '.         02050000
020510*** PK 11/25/13 HAZMAT SUMRY RPT BEGIN                            02051002
020520             15  ASC-HAZ-RPT-STAT-SW       PIC  X(02).            02052002
020530                 88  ASC-HAZ-EXCPT-SKU         VALUE 'EH'.        02053002
020540                 88  ASC-HAZ-EXCPT-WGT         VALUE 'EW'.        02054002
020550                 88  ASC-HAZ-RPT-NOT-RQRD      VALUE 'NR'.        02055002
020560                 88  ASC-HAZ-RPT-RQRD          VALUE 'RR'.        02056002
020570                 88  ASC-HAZ-RPT-NOT-AVLBL     VALUE 'NA'.        02057002
020580             15  ASC-HAZ-FACILITY-SW       PIC  X(01).            02058002
020590                 88  ASC-HAZ-FACILITY-YES      VALUE 'Y'.         02059002
020591                 88  ASC-HAZ-FACILITY-NO       VALUE 'N'.         02059102
020592             15  ASC-DEST-PRINTR-ID        PIC  X(08).            02059202
020593             15  ASC-HGH-SYS-TRL-CDE       PIC  X(03).            02059302
020594             15  ASC-LOW-SYS-TRL-CDE       PIC  X(03).            02059402
020595*** PK 11/25/13 HAZMAT SUMRY RPT END                              02059502
020596*** DMH 8/17 BEGIN                                                02059627
020597             15  ASC-STR-SCAN-CNT          PIC  S9(11) COMP-3.    02059726
020598             15  ASC-STR-SCAN-FROM-DIFF    PIC  S9(11) COMP-3.    02059826
020599             15  ASC-STR-SCAN-ONTO-DIFF    PIC  S9(11) COMP-3.    02059926
020600             15  ASC-STR-SCAN-ASSUME       PIC  S9(11) COMP-3.    02060026
020601*** DMH 8/17 END                                                  02060127
020602             15  FILLER                    PIC  X(26).            02060227
020610                                                                  02061026
020700*----------------------------------------------------------------*02070000
020800*    ABEND PROCESSING COPYBOOK.                                  *02080000
020900*----------------------------------------------------------------*02090000
021000                                                                  02100000
021100     COPY DPWS013.                                                02110000
021200                                                                  02120000
021300*-----------------------------------------------------------------02130000
021400*  TRAILER ID TABLE                                               02140000
021500*-----------------------------------------------------------------02150000
021600     EXEC SQL                                                     02160000
021700          INCLUDE TCNTRID                                         02170000
021800     END-EXEC.                                                    02180000
021900                                                                  02190000
022000     EXEC SQL                                                     02200000
022100          INCLUDE TSHUNLO                                         02210000
022200     END-EXEC.                                                    02220000
022300                                                                  02230000
022400     EXEC SQL                                                     02240000
022500          INCLUDE SUT00007                                        02250000
022600     END-EXEC.                                                    02260000
022700                                                                  02270000
022800* JAK 02/07 - ADD TKRPRPM DATABASE                                02280000
022900     EXEC SQL                                                     02290000
023000          INCLUDE TKRPRPM                                         02300000
023100     END-EXEC.                                                    02310000
023200                                                                  02320000
023300*---------------------------------------------------------------* 02330000
023400*  SQL AND COBOL DECLARATIONS FOR THE STATUS CODE ASSOCIATION     02340000
023500*---------------------------------------------------------------* 02350000
023600     EXEC SQL                                                     02360000
023700          INCLUDE SUT00005                                        02370000
023800     END-EXEC.                                                    02380000
023900                                                                  02390000
024000*---------------------------------------------------------------* 02400000
024100*  SQL AND COBOL DECLARATIONS FOR THE SUT_OTBND_CART TABLE        02410000
024200*---------------------------------------------------------------* 02420000
024300     EXEC SQL                                                     02430000
024400          INCLUDE SUT00024                                        02440000
024500     END-EXEC.                                                    02450000
024600                                                                  02460000
024700*---------------------------------------------------------------* 02470000
024800*  SQL AND COBOL DECLARATIONS FOR THE SUT_OTBND_LOC TABLE         02480000
024900*---------------------------------------------------------------* 02490000
025000     EXEC SQL                                                     02500000
025100          INCLUDE SUT00027                                        02510000
025200     END-EXEC.                                                    02520000
025300                                                                  02530000
025400*---------------------------------------------------------------* 02540000
025500*  SQL AND COBOL DECLARATIONS FOR THE SUT_OTBND_UPC TABLE         02550000
025600*---------------------------------------------------------------* 02560000
025700     EXEC SQL                                                     02570000
025800          INCLUDE SUT00028                                        02580000
025900     END-EXEC.                                                    02590000
026000                                                                  02600000
026100*---------------------------------------------------------------* 02610000
026101*  SQL AND COBOL DECLARATIONS FOR THE SUT_TRIP_WRKR_AUD TABLE     02610100
026102*---------------------------------------------------------------* 02610200
026103     EXEC SQL                                                     02610300
026104          INCLUDE SUT00006                                        02610400
026105     END-EXEC.                                                    02610500
026106                                                                  02610600
026107*---------------------------------------------------------------* 02610700
026108*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 02610800
026109*---------------------------------------------------------------* 02610900
026110     EXEC SQL                                                     02611000
026120          INCLUDE TSUOBTR                                         02612000
026130     END-EXEC.                                                    02613000
026140                                                                  02614000
026150*---------------------------------------------------------------* 02615000
026160*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 02616000
026170*---------------------------------------------------------------* 02617000
026180     EXEC SQL                                                     02618000
026190          INCLUDE TSUOBTS                                         02619000
026200     END-EXEC.                                                    02620000
026300                                                                  02630000
026400*---------------------------------------------------------------* 02640000
026500*    TSUOBSC - TRIP STATUS CODE DESCRIPTION                       02650000
026600*---------------------------------------------------------------* 02660000
026700     EXEC SQL                                                     02670000
026800          INCLUDE TSUOBSC                                         02680000
026900     END-EXEC.                                                    02690000
027000                                                                  02700000
027100*---------------------------------------------------------------* 02710000
027200*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 02720000
027300*---------------------------------------------------------------* 02730000
027400     EXEC SQL                                                     02740000
027500          INCLUDE TCNDCDR                                         02750000
027600     END-EXEC.                                                    02760000
027700                                                                  02770000
027800*---------------------------------------------------------------* 02780000
027900*    TSUCRDV - CARTON DIVERT TABLE                              * 02790000
028000*---------------------------------------------------------------* 02800000
028100     EXEC SQL                                                     02810000
028200          INCLUDE TSUCRDV                                         02820000
028300     END-EXEC.                                                    02830000
028400                                                                  02840000
028500*---------------------------------------------------------------* 02850000
028600*    TSUCDOT                                                      02860000
028700*---------------------------------------------------------------* 02870000
028800     EXEC SQL                                                     02880000
028900          INCLUDE TSUCDOT                                         02890000
029000     END-EXEC.                                                    02900000
029100                                                                  02910000
029200*---------------------------------------------------------------* 02920000
029300*    TCNDRST - DOOR TO STORE ASSIGNMENT TABLE                     02930000
029400*---------------------------------------------------------------* 02940000
029500     EXEC SQL                                                     02950000
029510          INCLUDE TCNDRST                                         02951000
029520     END-EXEC.                                                    02952000
029530                                                                  02953000
029532*---------------------------------------------------------------* 02953200
029533*    XLT_LOC - LOCATION TABLE ADDED FOR (WR38216)                 02953300
029534*---------------------------------------------------------------* 02953400
029535     EXEC SQL                                                     02953500
029536          INCLUDE XLT00010                                        02953600
029537     END-EXEC.                                                    02953700
029538                                                                  02953800
029539*** PK 11/25/13 HAZ SMRY RPT BEGIN                                02953902
029540                                                                  02954002
029541*---------------------------------------------------------------* 02954102
029542*  SUT_TRIP_DTL_SUM   - HAZARDOUS MATERIAL SKU ATTRIBUTE        * 02954202
029543*---------------------------------------------------------------* 02954302
029544     EXEC SQL                                                     02954402
029545          INCLUDE SUT00095                                        02954502
029546     END-EXEC.                                                    02954602
029547*---------------------------------------------------------------* 02954702
029548*  XLT_HAZDS_MTRL_SKU - HAZARDOUS MATERIAL SKU ATTRIBUTE        * 02954802
029549*---------------------------------------------------------------* 02954902
029550     EXEC SQL                                                     02955002
029551          INCLUDE XLT00042                                        02955102
029552     END-EXEC.                                                    02955202
029553                                                                  02955302
029554*---------------------------------------------------------------* 02955402
029555*  WST_INTGRTN_TYP                                                02955502
029556*---------------------------------------------------------------* 02955602
029557     EXEC SQL                                                     02955702
029558          INCLUDE WST00008                                        02955802
029559     END-EXEC.                                                    02955902
029560                                                                  02956002
029561*---------------------------------------------------------------* 02956102
029562* WST_ATTR_DEFN                                                   02956202
029563*---------------------------------------------------------------* 02956302
029564     EXEC SQL                                                     02956402
029565          INCLUDE WST00009                                        02956502
029566     END-EXEC.                                                    02956602
029567                                                                  02956702
029568*---------------------------------------------------------------* 02956802
029569* WST_ATTR_ELEM                                                   02956902
029570*---------------------------------------------------------------* 02957002
029571     EXEC SQL                                                     02957102
029572          INCLUDE WST00010                                        02957202
029573     END-EXEC.                                                    02957302
029574*** PK 11/25/13 HAZ SMRY RPT END                                  02957402
029575                                                                  02957527
029576*---------------------------------------------------------------* 02957627
029577* SUT_OTBND_STR_SCN                                               02957727
029578* DMH 8/17                                                        02957827
029579*---------------------------------------------------------------* 02957927
029580     EXEC SQL                                                     02958027
029581          INCLUDE SUT00121                                        02958127
029582     END-EXEC.                                                    02958227
029583                                                                  02958327
029584*---------------------------------------------------------------* 02958400
029585*    DB2 AREA FOR COMMUNICATIONS                                  02958500
029586*---------------------------------------------------------------* 02958600
029587     EXEC SQL                                                     02958700
029588          INCLUDE SQLCA                                           02958800
029590     END-EXEC.                                                    02959000
029600                                                                  02960000
029610*** PK 11/25/13 HAZ SMRY RPT BEGIN                                02961002
029620*---------------------------------------------------------------* 02962002
029630*    CURSOR TO FETCH HAZ SKU IN THE TRIP                        * 02963002
029640*---------------------------------------------------------------* 02964002
029650     EXEC SQL                                                     02965002
029660      DECLARE TRIP-HAZ-INFO CURSOR FOR                            02966002
029670       SELECT                                                     02967002
029680             MAX(T.SYS_TRLG_CDE)                                  02968002
029690           , T.SKU_NBR                                            02969002
029691           , SUM(T.UNT_QTY)                                       02969102
029692           , SUM(T.SKU_WEIGHT)                                    02969202
029693           , T.WT_UOM                                             02969302
029694       FROM                                                       02969402
029695           ( SELECT                                               02969502
029696                    B.SKU_NBR                                     02969602
029697                  , C.SYS_TRLG_CDE                                02969702
029698                  , C.WT_QTY                                      02969802
029699                  , B.UNT_QTY                                     02969902
029700                  , (C.WT_QTY * B.UNT_QTY) AS SKU_WEIGHT          02970002
029701                  , C.WT_UOM                                      02970102
029702             FROM                                                 02970202
029703                    SUT_TRIP_SUM A                                02970302
029704                  , SUT_TRIP_DTL_SUM B                            02970402
029705                  , XLT_HAZDS_MTRL_SKU C                          02970502
029706             WHERE                                                02970602
029707                       A.OTBND_TRIP_ID  IN  (:DK-TRIP-ID)         02970702
029708                   AND A.CRE_TMST  IN                             02970802
029709              (SELECT  MAX(D.CRE_TMST)                            02970902
029710               FROM    SUT_TRIP_SUM D                             02971002
029711               WHERE   D.OTBND_TRIP_ID = A.OTBND_TRIP_ID)         02971102
029712                   AND A.TRIP_OCRNC_ID = B.TRIP_OCRNC_ID          02971202
029713                   AND B.SKU_NBR       = C.SKU_NBR                02971302
029714                   AND C.HAZDS_IND     = 'Y'                      02971402
029715              ) AS T                                              02971502
029716       GROUP BY                                                   02971602
029717            T.SYS_TRLG_CDE                                        02971702
029718          , T.SKU_NBR                                             02971802
029719          , T.WT_UOM                                              02971902
029720       ORDER BY                                                   02972002
029721            T.SYS_TRLG_CDE DESC                                   02972102
029722          , T.SKU_NBR                                             02972202
029723       WITH UR                                                    02972302
029724     END-EXEC.                                                    02972402
029725*** PK 11/25/13 HAZ SMRY RPT END                                  02972502
029730**--------------------------------------------------------------**02973000
029800** THE LAYOUT FOR THE TRAILER CURSORS                             02980000
029900**--------------------------------------------------------------**02990000
030000     COPY PCWS049.                                                03000000
030100     COPY PCWS050.                                                03010000
030101*** PK 11/25/13 HAZ SMRY RPT BEGIN                                03010102
030102*----------------------------------------------------------------*03010202
030103*  SENDING/RECEIVING AREA FOR THE                                 03010302
030104*  PRINTER VALIDATION ROUTING (DPKCS060)                          03010402
030105*----------------------------------------------------------------*03010502
030106     COPY DPWS072.                                                03010602
030107*** PK 11/25/13 HAZ SMRY RPT END                                  03010702
030110                                                                  03011000
030120                                                                  03012000
030130 LINKAGE SECTION.                                                 03013000
030140                                                                  03014000
030150 01  DFHCOMMAREA.                                                 03015000
030160     05  FILLER                         OCCURS  1 TO 4072 TIMES   03016000
030170                                        DEPENDING ON EIBCALEN.    03017000
030180         10  FILLER                     PIC X.                    03018000
030190                                                                  03019000
030200                                                                  03020000
030300 PROCEDURE DIVISION.                                              03030000
030400***************************************************************** 03040000
030500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03050000
030600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03060000
030700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03070000
030800**                                                             ** 03080000
030900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03090000
031000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03100000
031100***************************************************************** 03110000
031200 0000-MAIN-MODULE.                                                03120000
031300     INITIALIZE DP030-CICS-API-FIELDS.                            03130000
031400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03140000
031500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03150000
031600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03160000
031700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03170000
031800     MOVE LENGTH OF SU597AI        TO DP030-MAP-LENGTH (1).       03180000
031900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03190000
032000     PERFORM 0001-CALL-CICS-ARCH-API.                             03200000
032100*                                                                 03210000
032200     PERFORM 1000-CONTROL-PROCESSING                              03220000
032300*                                                                 03230000
032400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03240000
032500     PERFORM 0001-CALL-CICS-ARCH-API.                             03250000
032600                                                                  03260000
032700 0001-CALL-CICS-ARCH-API.                                         03270000
032800*    CALL 'DPKCS030' USING DFHEIBLK                               03280054
032800     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03281054
032900                           DFHCOMMAREA                            03290000
033000                           DP030-CICS-API-FIELDS                  03300000
033100                           DP020-STANDARD-COMMAREA                03310000
033200                           SU597AI.                               03320000
033300*                                                                 03330000
033400     IF  DP030-RC-CALL-SUCCESSFUL                                 03340000
033500         CONTINUE                                                 03350000
033600     ELSE                                                         03360000
033700         SET DP013-NO-ROLLBACK                                    03370000
033800             DP013-XCTL-DISPLAY-RESTART                           03380000
033900             DP013-CICS-ABEND      TO TRUE                        03390000
034000         MOVE 'BEFORE 0000-MAIN-MODULE'                           03400000
034100                                   TO DP013-PARAGRAPH             03410000
034200*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX03420054
034300*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      03430054
034200         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03431054
034300-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03432054
034400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03440000
034500         PERFORM DP013-0000-PROCESS-ABEND                         03450000
034600     END-IF.                                                      03460000
034700                                                                  03470000
034800*----------------------------------------------------------------*03480000
034900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03490000
035000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03500000
035100*----------------------------------------------------------------*03510000
035200                                                                  03520000
035300 1000-CONTROL-PROCESSING.                                         03530000
035400                                                                  03540000
035500     EVALUATE TRUE                                                03550000
035600         WHEN DP020-NEXT-ACT-INITIAL                              03560000
035700              PERFORM 1100-FIND-OBJECT-KEYS                       03570000
035800              IF  PS-ERROR                                        03580000
035900                  CONTINUE                                        03590000
036000              ELSE                                                03600000
036100                  SET PS-INITIAL-BUILD TO TRUE                    03610000
036200                                                                  03620000
036300                  MOVE 'SUSHPTRL' TO DP008-FUNCTION-NAME          03630000
036400                  PERFORM 2105-RACF-ACCESS                        03640000
036500                  IF DP008-ACCESS-ALLOWED                         03650000
036600                     SET ASC-RACF-SHIP-AUTH-YES TO TRUE           03660000
036700                  ELSE                                            03670000
036800                     SET ASC-RACF-SHIP-AUTH-NO  TO TRUE           03680000
036900                  END-IF                                          03690000
037000                                                                  03700000
037100                  MOVE 'SURELTRL' TO DP008-FUNCTION-NAME          03710000
037200                  PERFORM 2105-RACF-ACCESS                        03720000
037300                  IF DP008-ACCESS-ALLOWED                         03730000
037400                     SET ASC-RACF-RLSE-AUTH-YES TO TRUE           03740000
037500                  ELSE                                            03750000
037600                     SET ASC-RACF-RLSE-AUTH-NO  TO TRUE           03760000
037700                  END-IF                                          03770000
037800                                                                  03780000
037900                                                                  03790000
038000                  PERFORM 4000-BUILD-INITIAL-PANEL                03800000
038100                  PERFORM 3200-RESET-ATTRIBUTES                   03810000
038200                  IF PS-TRAILER-NOT-FOUND                         03820000
038300                      SET DP020-NEXT-ACT-APPL-ERROR TO TRUE       03830000
038400                      MOVE PC-TSYMSG-00148                        03840000
038500                                   TO DP020-MSG-NUMBER            03850000
038600                      SET DP020-MSG-INFORMATIONAL TO TRUE         03860000
038700                  END-IF                                          03870000
038800              END-IF                                              03880000
038900                                                                  03890000
039000         WHEN DP020-NEXT-ACT-READ-MAP                             03900000
039100             PERFORM 2000-PROCESS-PANEL                           03910000
039200                                                                  03920000
039300         WHEN DP020-NEXT-ACT-RETURN                               03930000
039400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03940000
039500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03950000
039600                                                                  03960000
039700         WHEN OTHER                                               03970000
039800             SET DP013-LOGIC-ABEND TO TRUE                        03980000
039900             SET DP013-NO-ROLLBACK TO TRUE                        03990000
040000             MOVE '1000-CONTROL-PROCESSING'                       04000000
040100                                   TO DP013-PARAGRAPH             04010000
040200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04020000
040300                                   TO DP013-MESSAGE-TEXT(1)       04030000
040400             MOVE DP020-NEXT-APPL-ACTIVITY                        04040000
040500                                   TO DP013-MESSAGE-TEXT(2)       04050000
040600             PERFORM DP013-0000-PROCESS-ABEND                     04060000
040700     END-EVALUATE.                                                04070000
040800******************************************************************04080000
040900** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04090000
041000** INTER-APPLICATION FORMAT CODE.                               **04100000
041100******************************************************************04110000
041200 1100-FIND-OBJECT-KEYS.                                           04120000
041300     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04130000
041400     MOVE DP020-INT-APPL-FORMAT-IND                               04140000
041500                                   TO ASC-INT-APPL-FORMAT-IND.    04150000
041600     EVALUATE DP020-INT-APPL-FORMAT-IND                           04160000
041700         WHEN PC-INTER-APPL-CRIT-SPEC                             04170000
041800             MOVE SU008-TRIP-ID      TO ASC-TRIP-ID               04180000
041900                                         DK-TRIP-ID               04190000
042000             MOVE SU008-TRLR-SEAL-NBR TO ASC-TRAILER-SEAL-NBR     04200000
042100                                         DK-SEAL-ID               04210000
042200                                                                  04220000
042300                                                                  04230000
042400         WHEN PC-INTER-APPL-LIST                                  04240000
042500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04250000
042600             MOVE SU009-NUMBER-OF-SELECTED-ITEMS                  04260000
042700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04270000
042800             MOVE SU009-NUMBER-OF-TS-ITEMS                        04280000
042900                                   TO ASC-NUMBER-OF-TS-ITEMS      04290000
043000             MOVE SU009-SEL-QUEUE-NAME                            04300000
043100                                   TO ASC-SEL-QUEUE-NAME          04310000
043200             PERFORM 1120-PREPARE-LIST-ENTRY                      04320000
043300                                                                  04330000
043400         WHEN OTHER                                               04340000
043500             MOVE PC-TSYMSG-00148                                 04350000
043600                               TO DP020-MSG-NUMBER                04360000
043700             SET DP020-MSG-FATAL                                  04370000
043800                 DP020-NEXT-ACT-APPL-ERROR                        04380000
043900                               TO TRUE                            04390000
044000     END-EVALUATE.                                                04400000
044100*----------------------------------------------------------------*04410000
044200* ENTRY IS FROM A LIST.  GET THE TRIP ID FROM THE TEMP           *04420000
044300* STORAGE QUEUE PASSED FROM THE LIST.                            *04430000
044400*----------------------------------------------------------------*04440000
044500 1120-PREPARE-LIST-ENTRY.                                         04450000
044600     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                04460000
044700     MOVE ZERO                     TO ASC-SEL-ITEM.               04470000
044800     PERFORM 2110-GET-NEXT-TRIP.                                  04480000
044900*----------------------------------------------------------------*04490000
045000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *04500000
045100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *04510000
045200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *04520000
045300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *04530000
045400* FUNCTION KEYS CAN GET THIS FAR.                                *04540000
045500*----------------------------------------------------------------*04550000
045600                                                                  04560000
045700 2000-PROCESS-PANEL.                                              04570000
045800                                                                  04580000
045900     EVALUATE TRUE                                                04590000
046000                                                                  04600000
046100         WHEN DP020-SRC-AID = DP016-CLEAR                         04610000
046200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04620000
046300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04630000
046400                                                                  04640000
046500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04650051
046600             SET DP030-DONT-ERASE                                 04660000
046700                 DP030-SEND-DATAONLY (PC-APPL-MAP)                04670000
046800                                   TO TRUE                        04680000
046810                                                                  04681049
046850             SET ASC-NO-SECOND-CONFIRM-REQSTD                     04685049
046890                 ASC-NO-CONFIRM-REQUESTED  TO TRUE                04689049
046891                 MOVE SPACES TO ASC-TRAILER-SEAL-NBR              04689151
046892                                DK-SEAL-ID                        04689251
046893                                ASEALO                            04689353
046894                                                                  04689452
046900             PERFORM 4000-BUILD-INITIAL-PANEL                     04690000
047000             PERFORM 3200-RESET-ATTRIBUTES                        04700000
047100                                                                  04710000
047200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             04720000
047300             IF  ASC-USE-SELECTION-QUEUE                          04730000
047400                 PERFORM 2110-GET-NEXT-TRIP                       04740000
047500                 SET PS-INITIAL-BUILD TO TRUE                     04750000
047600                 PERFORM 4000-BUILD-INITIAL-PANEL                 04760000
047700                 PERFORM 3200-RESET-ATTRIBUTES                    04770000
047800             ELSE                                                 04780000
047900*                --- BOTTOM OF LIST ---                           04790000
048000                 MOVE PC-TSYMSG-00070                             04800000
048100                                   TO DP020-MSG-NUMBER            04810000
048200                 SET DP020-MSG-INFORMATIONAL                      04820000
048300                                   TO TRUE                        04830000
048400             END-IF                                               04840000
048500                                                                  04850000
048600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             04860000
048700             IF  ASC-USE-SELECTION-QUEUE                          04870000
048800                 PERFORM 2120-GET-PREV-TRIP                       04880000
048900                 SET PS-INITIAL-BUILD TO TRUE                     04890000
049000                 PERFORM 4000-BUILD-INITIAL-PANEL                 04900000
049100                 PERFORM 3200-RESET-ATTRIBUTES                    04910000
049200             ELSE                                                 04920000
049300*                --- TOP OF LIST ---                              04930000
049400                 MOVE PC-TSYMSG-00069                             04940000
049500                                   TO DP020-MSG-NUMBER            04950000
049600                 SET DP020-MSG-INFORMATIONAL                      04960000
049700                                   TO TRUE                        04970000
049800             END-IF                                               04980000
049900                                                                  04990000
050000         WHEN OTHER                                               05000000
050100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05010000
050200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05020000
050300             IF  PS-NO-ERROR                                      05030000
050400                 SET DP030-CONTINUE-GO                            05040000
050500                                   TO TRUE                        05050000
050600                 PERFORM 2100-CHECK-FUNCTION-KEY                  05060000
050700             ELSE                                                 05070000
050800                 SET DP030-OVERRIDE-GO                            05080000
050900                                   TO TRUE                        05090000
051000             END-IF                                               05100000
051100     END-EVALUATE.                                                05110000
051200*----------------------------------------------------------------*05120000
051300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *05130000
051400* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *05140000
051500* FROM THE CICS ARCHITECTURE API.                                *05150000
051600*----------------------------------------------------------------*05160000
051700                                                                  05170000
051800 2100-CHECK-FUNCTION-KEY.                                         05180000
051900     EVALUATE TRUE                                                05190000
052000         WHEN DP020-SRC-AID = DP016-ENTER                         05200000
052100             CONTINUE                                             05210000
052200                                                                  05220000
052300**      F17 - SHIP TRAILER                                        05230000
052400**      F2=CONFIRM (UPDATE)                                       05240000
052500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05250000
052600         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    05260000
052700             IF ASC-RACF-SHIP-AUTH-NO                             05270000
052800                 SET  PS-ERROR                                    05280000
052900                      DP020-MSG-FATAL TO TRUE                     05290000
053000                 MOVE PC-TSYMSG-02969 TO DP020-MSG-NUMBER         05300000
053100                 MOVE -1              TO ASEALL                   05310000
053200                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             05320000
053300                 SET  DP030-OVERRIDE-GO TO TRUE                   05330000
053400             END-IF                                               05340000
053500                                                                  05350000
053600             IF DP020-FK-CONFIRM (DP020-SRC-AID) AND              05360000
053700                  ASC-NO-CONFIRM-REQUESTED                        05370000
053800                 SET PS-ERROR                                     05380000
053900                     DP020-MSG-FATAL         TO TRUE              05390000
054000                 MOVE PC-TSYMSG-00016        TO DP020-MSG-NUMBER  05400000
054100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05410000
054200             ELSE                                                 05420000
054300                 IF ASC-SECOND-CONFIRM-REQUESTED                  05430000
054400                     IF ASC-NO-DIVERT-CONFIRM                     05440000
054500                         MOVE PC-TSYMSG-02943  TO DP020-MSG-NUMBER05450000
054600                     ELSE                                         05460000
054700                         MOVE PC-TSYMSG-02944  TO DP020-MSG-NUMBER05470018
054800                     END-IF                                       05480000
054900*** 10/04/2022       MOVE DP015-UNP-ALP-BRT-OFF                   05490046
054910                     MOVE DP015-PRO-BRT-MDT                       05491047
055000                                               TO ASEALA          05500000
055100                     MOVE DP015-RED            TO ASEALC          05510000
055200                     MOVE DP015-REVERSE        TO ASEALH          05520000
055300                     MOVE -1                   TO ASEALL          05530000
055400                     SET DP030-SET-CURSOR-APPL-1                  05540000
055500                                               TO TRUE            05550000
055600                     SET ASC-NO-SECOND-CONFIRM-REQSTD TO TRUE     05560000
055700                     SET PS-ERROR                                 05570000
055800                         DP020-MSG-FATAL       TO TRUE            05580000
055900                 ELSE                                             05590000
056000                     IF ASC-UNLD-RLSE-CONFIRM-REQSTD              05600000
056100                         PERFORM 2300-RETREIVE-OTBND-TMST         05610000
056200                         IF PS-NO-ERROR OR PC049-DIVERT-CUTOFFS-NO05620000
056300                             PERFORM 4100-GET-TRAILER-INFO        05630000
056400                             PERFORM 8300-LINK-SUKCS574           05640000
056500                             PERFORM 4300-GET-COST-RETAIL         05650000
056600                             IF SUT00007-CART-QTY = ZERO          05660000
056700                                 PERFORM 2350-RELEASE-TRLR        05670000
056710                             END-IF                               05671000
056720                             PERFORM 4100-GET-TRAILER-INFO        05672000
056730                             PERFORM 4010-CONTINUE-BUILD-MAP      05673000
056740                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 05674000
056750                         ELSE                                     05675000
056760                             SET DP030-OVERRIDE-GO TO TRUE        05676000
056770                         END-IF                                   05677000
056780                     ELSE                                         05678000
056790                         MOVE 'DS'             TO DK-NEXT-STAT-CDE05679000
056800                         PERFORM 4500-VALIDATE-STAT-CDE           05680000
056900                         IF PS-NOT-VALID-STATUS-CHANGE            05690000
057000                             SET PS-ERROR                         05700000
057100                                 DP020-MSG-FATAL   TO TRUE        05710000
057200                             MOVE PC-TSYMSG-02816  TO             05720000
057300                                                  DP020-MSG-NUMBER05730000
057400                             SET DP030-SET-CURSOR-APPL-1 TO TRUE  05740000
057500                         ELSE                                     05750000
057600                             SET DP030-CONTINUE-GO TO TRUE        05760000
057700                             PERFORM 5000-INSERT-NEW-STATUS       05770000
057800*                --- UPDATES SUCCESSFUL ---                       05780000
057810*** PK 11/25/13  HAZ SUMMARY BEGIN                                05781002
057820*IF THE DC PRINTS THE HAZMAT REPORT AND THE REPORT IS REQUIRED    05782002
057830                             IF ASC-HAZ-FACILITY-YES              05783002
057840                               IF ASC-HAZ-EXCPT-SKU OR            05784002
057850                                  ASC-HAZ-EXCPT-WGT OR            05785002
057860                                  ASC-HAZ-RPT-RQRD                05786002
057870                                                                  05787002
057880                                  PERFORM 5400-PRINT-HAZ-REPORT   05788002
057890                                                                  05789002
057891                               END-IF                             05789102
057892                             END-IF                               05789202
057893*** PK 11/25/13  HAZ SUMMARY END                                  05789302
057900                              SET DP030-DONT-ERASE                05790000
058000                                 DP030-SEND-DATAONLY (PC-APPL-MAP)05800000
058100                                                          TO TRUE 05810000
058200                             SET PS-INITIAL-BUILD TO TRUE         05820000
058300                             PERFORM 4000-BUILD-INITIAL-PANEL     05830000
058400                             PERFORM 3200-RESET-ATTRIBUTES        05840000
058500                             MOVE PC-TSYMSG-00059  TO             05850000
058600                                                  DP020-MSG-NUMBER05860000
058700                             SET DP020-MSG-INFORMATIONAL TO TRUE  05870000
058800                         END-IF                                   05880000
058900                     END-IF                                       05890000
059000                 END-IF                                           05900000
059100             END-IF                                               05910000
059200                                                                  05920000
059300**      F23 - RELEASE TRAILER                                     05930000
059400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              05940000
059500*            MUST BE A SHUTTLE OR STORAGE DOOR                    05950000
059600             EVALUATE TRUE                                        05960000
059700             WHEN ASC-DOOR-TYPE-CODE = 'DS'                       05970000
059800             WHEN ASC-DOOR-TYPE-CODE = 'ST'                       05980000
059801                                                                  05980100
059802* DMH - 2/8/2005 - BEGIN                                          05980200
059803* DMH            PERFORM 2101-RELEASE-THE-TRAILER                 05980300
059804                     IF ASC-RACF-RLSE-AUTH-NO                     05980400
059805                         SET  PS-ERROR                            05980500
059806                              DP020-MSG-FATAL                     05980600
059807                              DP030-SET-CURSOR-APPL-1             05980700
059808                              DP030-OVERRIDE-GO TO TRUE           05980800
059809                         MOVE PC-TSYMSG-02969 TO DP020-MSG-NUMBER 05980900
059810                         MOVE -1              TO ASEALL           05981000
059820                     ELSE                                         05982000
059830                         SET ASC-CONFIRM-REQUESTED                05983000
059840                             ASC-UNLD-RLSE-CONFIRM-REQSTD TO TRUE 05984000
059850                         MOVE PC-TSYMSG-03382 TO DP020-MSG-NUMBER 05985000
059860                         SET  DP030-OVERRIDE-GO TO TRUE           05986000
059870                         SET PS-ERROR                             05987000
059880                             DP020-MSG-WARNING  TO TRUE           05988000
059890                     END-IF                                       05989000
059900* DMH - 2/8/2005 - END                                            05990000
059910                                                                  05991000
059911*  IF SHIPPING/RECEIVING/STRIPPING TRAILER MUST BE EMPTY TO RLSE  05991100
059912             WHEN ASC-DOOR-TYPE-CODE = 'SH'                       05991200
059913             WHEN ASC-DOOR-TYPE-CODE = 'RC'                       05991300
059914             WHEN ASC-DOOR-TYPE-CODE = 'SG'                       05991400
059915                 MOVE 'DR'             TO DK-NEXT-STAT-CDE        05991500
059916                 PERFORM 4500-VALIDATE-STAT-CDE                   05991600
059917                 IF PS-NOT-VALID-STATUS-CHANGE                    05991700
059918                     SET PS-ERROR                                 05991800
059919                         DP020-MSG-FATAL   TO TRUE                05991900
059920                     MOVE PC-TSYMSG-02816  TO DP020-MSG-NUMBER    05992000
059930                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          05993000
059940                 ELSE                                             05994000
059950                                                                  05995000
059960                     IF ASC-UNIT-COUNT = ZERO                     05996000
059970*                   (OKAY TO RELEASE IF THE TRAILER IS EMPTY)     05997000
059980                       PERFORM 2101-RELEASE-THE-TRAILER           05998000
059990                     ELSE                                         05999000
060000                         SET PS-ERROR                             06000000
060100                             DP020-MSG-FATAL                      06010000
060200                             DP030-SET-CURSOR-APPL-1              06020000
060300                                             TO TRUE              06030000
060400                         MOVE PC-TSYMSG-02967 TO DP020-MSG-NUMBER 06040000
060500                     END-IF                                       06050000
060600                 END-IF                                           06060000
060700             WHEN OTHER                                           06070000
060800                 SET PS-ERROR                                     06080000
060900                     DP020-MSG-FATAL     TO TRUE                  06090000
061000                 MOVE PC-TSYMSG-02941    TO DP020-MSG-NUMBER      06100000
061100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06110000
061200             END-EVALUATE                                         06120000
061300                                                                  06130000
061400**    F24 - RELEASE STORAGE TRAILER                               06140000
061500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06150000
061600**** MUST BE A STORAGE DOOR                                       06160000
061700             EVALUATE TRUE                                        06170000
061800                 WHEN ASC-DOOR-TYP-CDE = 'ST'                     06180000
061900                     IF ASC-RACF-RLSE-AUTH-NO                     06190000
062000                         SET  PS-ERROR                            06200000
062100                              DP020-MSG-FATAL                     06210000
062200                              DP030-SET-CURSOR-APPL-1             06220000
062300                              DP030-OVERRIDE-GO TO TRUE           06230000
062400                         MOVE PC-TSYMSG-02969 TO DP020-MSG-NUMBER 06240000
062500                         MOVE -1              TO ASEALL           06250000
062600                     ELSE                                         06260000
062700                         SET ASC-CONFIRM-REQUESTED                06270000
062710                             ASC-UNLD-RLSE-CONFIRM-REQSTD TO TRUE 06271000
062720                         MOVE PC-TSYMSG-03011 TO DP020-MSG-NUMBER 06272000
062730                         SET  DP030-OVERRIDE-GO TO TRUE           06273000
062740                         SET PS-ERROR                             06274000
062750                             DP020-MSG-WARNING  TO TRUE           06275000
062760                     END-IF                                       06276000
062761                 WHEN OTHER                                       06276100
062762                     SET PS-ERROR                                 06276200
062763                         DP020-MSG-FATAL     TO TRUE              06276300
062764                     MOVE PC-TSYMSG-03010    TO DP020-MSG-NUMBER  06276400
062765                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          06276500
062766             END-EVALUATE                                         06276600
062767                                                                  06276700
062768*** PK 11/25/13 HAZ SUMRY RPT BEGIN                               06276802
062769*NEW FUNCTION KEY F18 ADDED TO ENABLE HAZ SUMRY REPORT REPRINTING 06276906
062770         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              06277002
062771               IF ASC-HAZ-FACILITY-YES                            06277102
062772                  IF ASC-HAZ-EXCPT-SKU OR                         06277202
062773                     ASC-HAZ-EXCPT-WGT OR                         06277302
062774                     ASC-HAZ-RPT-RQRD                             06277402
062775                     PERFORM 5400-PRINT-HAZ-REPORT                06277502
062776                  ELSE                                            06277602
062777                     MOVE PC-TSYMSG-03742 TO DP020-MSG-NUMBER     06277702
062778                     SET DP020-MSG-INFORMATIONAL TO TRUE          06277802
062779                  END-IF                                          06277902
062780               ELSE                                               06278002
062781                  MOVE PC-TSYMSG-03741 TO DP020-MSG-NUMBER        06278102
062782                  SET DP020-MSG-INFORMATIONAL TO TRUE             06278202
062783               END-IF                                             06278302
062784*** PK 11/25/13 HAZ SUMRY RPT END                                 06278402
062785         WHEN OTHER                                               06278500
062786             SET DP013-NO-ROLLBACK                                06278600
062787                 DP013-XCTL-DISPLAY-RESTART                       06278700
062788                 DP013-CICS-ABEND  TO TRUE                        06278800
062789             MOVE '2000-PROCESS-PANEL'                            06278900
062790                                   TO DP013-PARAGRAPH             06279000
062791             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06279100
062792                                   TO DP013-MESSAGE-TEXT (1)      06279200
062793             PERFORM DP013-0000-PROCESS-ABEND                     06279300
062794     END-EVALUATE.                                                06279400
062795                                                                  06279500
062796 2101-RELEASE-THE-TRAILER.                                        06279600
062797                                                                  06279700
062798     IF ASC-RACF-RLSE-AUTH-NO                                     06279800
062800         SET  PS-ERROR                                            06280000
062900              DP020-MSG-FATAL                                     06290000
063000              DP030-SET-CURSOR-APPL-1                             06300000
063100              DP030-OVERRIDE-GO TO TRUE                           06310000
063200         MOVE PC-TSYMSG-02969 TO DP020-MSG-NUMBER                 06320000
063300         MOVE -1              TO ASEALL                           06330000
063400     END-IF.                                                      06340000
063500                                                                  06350000
063600     IF PS-NO-ERROR                                               06360000
063700         PERFORM 4500-VALIDATE-STAT-CDE                           06370000
063800             IF PS-NOT-VALID-STATUS-CHANGE                        06380000
063900                 SET PS-ERROR                                     06390000
064000                     DP020-MSG-FATAL   TO TRUE                    06400000
064100                 MOVE PC-TSYMSG-02816  TO DP020-MSG-NUMBER        06410000
064200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06420000
064300             ELSE                                                 06430000
064400                 SET DP030-CONTINUE-GO TO TRUE                    06440000
064500                 SET DP030-CONTINUE-GO TO TRUE                    06450000
064600                 PERFORM 5000-INSERT-NEW-STATUS                   06460000
064700                 IF  PS-NO-ERROR                                  06470000
064800*                    --- UPDATES SUCCESSFUL ---                   06480000
064900                     MOVE PC-TSYMSG-00059                         06490000
065000                                       TO DP020-MSG-NUMBER        06500000
065100                     SET DP020-MSG-INFORMATIONAL   TO TRUE        06510000
065200                 END-IF                                           06520000
065300             END-IF                                               06530000
065400     END-IF.                                                      06540000
065500                                                                  06550000
065600*----------------------------------------------------------------*06560000
065700* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     06570000
065800*----------------------------------------------------------------*06580000
065900 2105-RACF-ACCESS.                                                06590000
066000                                                                  06600000
066100      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  06610000
066200      SET DP008-ACCESS-TYPE-USE          TO TRUE                  06620000
066300                                                                  06630000
066400      EXEC CICS                                                   06640000
066500         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 06650000
066600              COMMAREA (DP008-SECURITY-COMMAREA)                  06660000
066700              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             06670000
066800      END-EXEC                                                    06680000
066900                                                                  06690000
067000      IF DP008-CALL-SUCCESSFUL                                    06700000
067100         CONTINUE                                                 06710000
067200     ELSE                                                         06720000
067300         MOVE '2105-RACF-ACCESS'                                  06730000
067400                               TO DP013-PARAGRAPH                 06740000
067500          MOVE 'UNABLE TO ACCESS CICS'                            06750000
067600                               TO DP013-MESSAGE-TEXT (1)          06760000
067700          MOVE SQLCA                 TO DP013-SQLCA               06770000
067800          SET DP013-DB2-ABEND                                     06780000
067900              DP013-XCTL-DISPLAY-RESTART                          06790000
068000                               TO TRUE                            06800000
068100          PERFORM DP013-0000-PROCESS-ABEND                        06810000
068200      END-IF.                                                     06820000
068300                                                                  06830000
068400 2110-GET-NEXT-TRIP.                                              06840000
068500     ADD +1                        TO ASC-SEL-SUB.                06850000
068600     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            06860000
068700         ADD +1                    TO ASC-SEL-ITEM                06870000
068800         MOVE +1                   TO ASC-SEL-SUB                 06880000
068900     END-IF.                                                      06890000
069000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06900000
069100         PERFORM 9100-READ-SEL-QUEUE                              06910000
069200         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      06920000
069300             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)                06930000
069400                                   TO ASC-TRLR-SRL-NBR            06940000
069500             MOVE SU010-TRIP-ID (ASC-SEL-SUB)                     06950000
069600                                   TO ASC-TRIP-ID                 06960000
069700                                      DK-TRIP-ID                  06970000
069800             SET SU010-INQ (ASC-SEL-SUB)                          06980000
069900                                   TO TRUE                        06990000
070000             PERFORM 9200-REWRITE-LIST-QUEUE                      07000000
070100         ELSE                                                     07010000
070200             SUBTRACT +1 FROM ASC-SEL-SUB                         07020000
070300*            --- BOTTOM OF LIST ---                               07030000
070400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07040000
070500             SET DP020-MSG-INFORMATIONAL                          07050000
070600                                   TO TRUE                        07060000
070700         END-IF                                                   07070000
070800     ELSE                                                         07080000
070900         SUBTRACT +1 FROM ASC-SEL-ITEM                            07090000
071000         MOVE SU010-MAX-ITEMS      TO ASC-SEL-SUB                 07100000
071100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07110000
071200         SET DP020-MSG-INFORMATIONAL                              07120000
071300                                   TO TRUE                        07130000
071400     END-IF.                                                      07140000
071500******************************************************************07150000
071600** GET THE TRIP ID (KEY) OF THE PREVIOUS SELECTED               **07160000
071700** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **07170000
071800******************************************************************07180000
071900 2120-GET-PREV-TRIP.                                              07190000
072000     SUBTRACT +1 FROM ASC-SEL-SUB.                                07200000
072100     IF  ASC-SEL-SUB < +1                                         07210000
072200         SUBTRACT +1 FROM ASC-SEL-ITEM                            07220000
072300         MOVE SU010-MAX-ITEMS      TO ASC-SEL-SUB                 07230000
072400     END-IF.                                                      07240000
072500*                                                                 07250000
072600     IF  ASC-SEL-ITEM > ZERO                                      07260000
072700         PERFORM 9100-READ-SEL-QUEUE                              07270000
072800         MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)                    07280000
072900                                   TO ASC-TRLR-SRL-NBR            07290000
073000         MOVE SU010-TRIP-ID (ASC-SEL-SUB)                         07300000
073100                                   TO ASC-TRIP-ID                 07310000
073200                                      DK-TRIP-ID                  07320000
073300     ELSE                                                         07330000
073400         MOVE +1                   TO ASC-SEL-ITEM                07340000
073500                                      ASC-SEL-SUB                 07350000
073600*        --- TOP OF LIST ---                                      07360000
073700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07370000
073800         SET DP020-MSG-INFORMATIONAL                              07380000
073900                                   TO TRUE                        07390000
074000     END-IF.                                                      07400000
074100                                                                  07410000
074200*----------------------------------------------------------------*07420000
074300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *07430000
074400* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *07440000
074500* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *07450000
074600*----------------------------------------------------------------*07460000
074700 2200-MOVE-SCREEN-TO-COMMAREA.                                    07470000
074800     IF  ASEALL > ZERO                                            07480000
074900         MOVE ASEALI               TO ASC-TRAILER-SEAL-NBR        07490000
075000     ELSE                                                         07500000
075100         IF  ASEALF = DP015-ERASE-EOF                             07510000
075200             MOVE SPACE            TO ASC-TRAILER-SEAL-NBR        07520000
075300         END-IF                                                   07530000
075400     END-IF.                                                      07540000
075500                                                                  07550000
075600     IF  ASSCACL > ZERO                                           07560000
075700         MOVE ASSCACI              TO ASC-SHIP-SCAC-CODE          07570000
075800     ELSE                                                         07580000
075900         IF  ASSCACF = DP015-ERASE-EOF                            07590000
076000             MOVE SPACE            TO ASC-SHIP-SCAC-CODE          07600000
076100         END-IF                                                   07610000
076200     END-IF.                                                      07620000
076300                                                                  07630000
076400     IF  AFNAMEL > ZERO                                           07640000
076500         MOVE AFNAMEI              TO ASC-DRIVER-FIRST-NAME       07650000
076600     ELSE                                                         07660000
076700         IF  AFNAMEF = DP015-ERASE-EOF                            07670000
076800             MOVE SPACE            TO ASC-DRIVER-FIRST-NAME       07680000
076900         END-IF                                                   07690000
077000     END-IF.                                                      07700000
077100                                                                  07710000
077200     IF  ALNAMEL > ZERO                                           07720000
077300         MOVE ALNAMEI              TO ASC-DRIVER-LAST-NAME        07730000
077400     ELSE                                                         07740000
077500         IF  ALNAMEF = DP015-ERASE-EOF                            07750000
077600             MOVE SPACE            TO ASC-DRIVER-LAST-NAME        07760000
077700         END-IF                                                   07770000
077800     END-IF.                                                      07780000
077900                                                                  07790000
078000     IF  ADRIVIDL > ZERO                                          07800000
078100         MOVE ADRIVIDI             TO ASC-DRIVER-ID               07810000
078200     ELSE                                                         07820000
078300         IF  ADRIVIDF = DP015-ERASE-EOF                           07830000
078400             MOVE SPACE            TO ASC-DRIVER-ID               07840000
078500         END-IF                                                   07850000
078600     END-IF.                                                      07860000
078601                                                                  07860102
078610*** PK 11/25/13 HAZ SMRY RPT BEGIN                                07861002
078620     IF  APRINIDL  > ZERO                                         07862002
078630         MOVE APRINIDI            TO ASC-DEST-PRINTR-ID           07863002
078640     ELSE                                                         07864002
078650         IF  APRINIDF = DP015-ERASE-EOF                           07865002
078660             MOVE SPACE           TO ASC-DEST-PRINTR-ID           07866002
078670         END-IF                                                   07867002
078680     END-IF.                                                      07868002
078690*** PK 11/25/13 HAZ SMRY RPT END                                  07869002
078700                                                                  07870000
078800*----------------------------------------------------------------*07880000
078900* BEGIN THE PROCESS TO RELEASE A STORAGE TRAILER.                 07890000
079000* BEGIN BY RETRIEVING THE LAST CLOSE TMST                         07900000
079100*----------------------------------------------------------------*07910000
079200 2300-RETREIVE-OTBND-TMST.                                        07920000
079300                                                                  07930000
079400     MOVE ASC-TRIP-ID  TO  DK-TRIP-ID.                            07940000
079500     EXEC SQL                                                     07950000
079600           SELECT A.OTBND_STAT_TMST                               07960000
079700                 ,A.DOOR_ID                                       07970000
079800             INTO :SUOBTS-OTBND-STAT-TMST                         07980000
079900                 ,:SUOBTS-DOOR-ID                                 07990000
079910             FROM TSUOBTS A                                       07991000
079920            WHERE A.TRIP_STAT_CDE  = 'DC'                         07992000
079930              AND A.OTBND_TRIP_ID  = :DK-TRIP-ID                  07993000
079940              AND A.OTBND_STAT_TMST IN                            07994000
079950                  (SELECT MAX(B.OTBND_STAT_TMST)                  07995000
079960                    FROM TSUOBTS B                                07996000
079970               WHERE B.OTBND_TRIP_ID  =  A.OTBND_TRIP_ID)         07997000
079980     END-EXEC                                                     07998000
079990                                                                  07999000
080000     EVALUATE TRUE                                                08000000
080010         WHEN SQLCODE = ZERO                                      08001000
080011             MOVE SUOBTS-OTBND-STAT-TMST TO DK-OTBND-TMST         08001100
080012             MOVE SUOBTS-DOOR-ID         TO DK-DOOR-ID            08001200
080013         WHEN SQLCODE = +100                                      08001300
080014             SET PS-ERROR                TO TRUE                  08001400
080015             SET DP020-MSG-WARNING       TO TRUE                  08001500
080016             MOVE PC-TSYMSG-03038        TO DP020-MSG-NUMBER      08001600
080017             MOVE -1                     TO ASEALL                08001700
080018             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08001800
080019             MOVE SPACES                 TO DK-OTBND-TMST         08001900
080020                                            DK-DOOR-ID            08002000
080030         WHEN SQLCODE = -904                                      08003000
080040         WHEN SQLCODE = -913                                      08004000
080041             CONTINUE                                             08004100
080042         WHEN SQLWARN0 NOT = SPACES                               08004200
080043         WHEN SQLCODE < ZERO                                      08004300
080044         WHEN SQLCODE > ZERO                                      08004400
080045             MOVE '2300-RETREIVE-OTBND-TMST'  TO DP013-PARAGRAPH  08004500
080046             MOVE 'SELECT OTBND TMST '                            08004600
080047                                   TO DP013-MESSAGE-TEXT (1)      08004700
080048             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      08004800
080049             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          08004900
080050             MOVE SQLCA        TO DP013-SQLCA                     08005000
080051             MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)        08005100
080052             SET PS-ERROR                                         08005200
080053                 DP013-DB2-ABEND                                  08005300
080054                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08005400
080055             PERFORM DP013-0000-PROCESS-ABEND                     08005500
080056     END-EVALUATE.                                                08005600
080057                                                                  08005700
080058     IF PS-NO-ERROR                                               08005800
080059         MOVE DK-TRIP-ID TO PC049-DK-OTBND-TRIP-ID                08005900
080060         PERFORM P4000-STRT-END-DVRT                              08006000
080061         MOVE ASC-OPER-UNT-ID TO PC049-DK-OPER-UNT-ID             08006100
080062                                 DK-OPER-UNT-ID                   08006200
080063                                                                  08006300
080064*DMH - BEGIN 4/24/03                                              08006400
080065         IF  PC049-DIVERT-CUTOFFS-NO                              08006500
080066             PERFORM P4000-CNT-SCAN-CRTN                          08006600
080067             MOVE  PV-DEFAULT-TMST  TO  PC049-DK-START-TMST       08006700
080068                                        PC049-DK-END-TMST         08006800
080069         END-IF                                                   08006900
080070*DMH - END   4/24/03                                              08007000
080071                                                                  08007100
080072         IF (PC049-DIVERT-CUTOFFS-YES  OR                         08007200
080073             PC049-PV-SCAN-COUNT  >  0)                           08007300
080074             PERFORM P7340-OPEN-SHTLACTV-CRTN-CSR                 08007400
080075             PERFORM UNTIL PC049-EOF-STLACTV-CRTN OR PC049-ERROR  08007500
080076                 PERFORM P7345-FETCH-SHTLACTV-CRTN-CSR            08007600
080077                 IF SQLCODE = 0                                   08007700
080078                      PERFORM 2310-INSERT-OTBND-LOC               08007800
080079                 END-IF                                           08007900
080080             END-PERFORM                                          08008000
080081             PERFORM P7350-CLOSE-SHTLACTV-CRTN-CSR                08008100
080082             IF PS-NO-ERROR                                       08008200
080083                 PERFORM 9000-SYNCPOINT                           08008300
080084             END-IF                                               08008400
080085         ELSE                                                     08008500
080086             SET PS-ERROR                TO TRUE                  08008600
080087             SET DP020-MSG-WARNING       TO TRUE                  08008700
080088             MOVE PC-TSYMSG-03044        TO DP020-MSG-NUMBER      08008800
080089         END-IF                                                   08008900
080090     END-IF.                                                      08009000
080100                                                                  08010000
080110*----------------------------------------------------------------*08011000
080120* INSERT ROW INTO SUT_OTBND_LOC TO INDICATE THE CARTON WAS SCANNED08012000
080130* OFF                                                             08013000
080140*----------------------------------------------------------------*08014000
080150 2310-INSERT-OTBND-LOC.                                           08015000
080151                                                                  08015100
080152     EXEC SQL                                                     08015200
080153         INSERT INTO SUT_OTBND_LOC                                08015300
080154               (SHIPT_UNT_ID                                      08015400
080155             ,  CRE_TMST                                          08015500
080156             ,  OTBND_TRIP_ID                                     08015600
080157             ,  LOC_NBR                                           08015700
080158             ,  SCN_CDE                                           08015800
080159             ,  CRE_USR_ID                                        08015900
080160             ,  ACTV_CDE                                          08016000
080161             ,  INBD_TRIP_ID)                                     08016100
080162       VALUES  (:SUCRDV-SHIPT-UNT-ID                              08016200
080163             ,  CURRENT TIMESTAMP                                 08016300
080164             ,  :SUCDOT-OTBND-TRIP-ID                             08016400
080165             ,  :DK-OPER-UNT-ID                                   08016500
080166             ,  'SHOF'                                            08016600
080167             ,  'UNLD/RLS'                                        08016700
080168             ,  'I'                                               08016800
080169             ,  0)                                                08016900
080170     END-EXEC                                                     08017000
080171                                                                  08017100
080172     EVALUATE TRUE                                                08017200
080173         WHEN SQLCODE = ZERO                                      08017300
080174         WHEN SQLCODE = -530                                      08017400
080175             IF PC049-PV-TYP-SHON                                 08017500
080176                 PERFORM 2320-INACTIVE-OTBND-LOC                  08017600
080177             ELSE                                                 08017700
080178                 PERFORM 2330-INACTIVE-DIVERTS                    08017800
080179             END-IF                                               08017900
080180         WHEN SQLCODE = -904                                      08018000
080181         WHEN SQLCODE = -913                                      08018100
080182             CONTINUE                                             08018200
080183         WHEN SQLWARN0 NOT = SPACES                               08018300
080184         WHEN SQLCODE < ZERO                                      08018400
080185         WHEN SQLCODE > ZERO                                      08018500
080186             MOVE '2310-INSERT-OTBND-LOC  '  TO DP013-PARAGRAPH   08018600
080187             MOVE 'INSERT OTBND LOC '                             08018700
080188                                   TO DP013-MESSAGE-TEXT (1)      08018800
080189             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      08018900
080190             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          08019000
080191             MOVE SQLCA        TO DP013-SQLCA                     08019100
080192             MOVE 'OTBNDLOC'    TO DP013-DB2-TABLE-NAME (1)       08019200
080193             SET PS-ERROR                                         08019300
080194                 DP013-DB2-ABEND                                  08019400
080195                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08019500
080196             PERFORM DP013-0000-PROCESS-ABEND                     08019600
080197     END-EVALUATE.                                                08019700
080198                                                                  08019800
080199*----------------------------------------------------------------*08019900
080200* INACTIVATE ALL OF THE SCAN ON ROWS FOR A CARTON                 08020000
080201*----------------------------------------------------------------*08020100
080202 2320-INACTIVE-OTBND-LOC.                                         08020200
080203                                                                  08020300
080204     EXEC SQL                                                     08020400
080205         UPDATE SUT_OTBND_LOC                                     08020500
080206           SET  ACTV_CDE      = 'I'                               08020600
080207         WHERE  SHIPT_UNT_ID  = :SUCRDV-SHIPT-UNT-ID              08020700
080208           AND  SCN_CDE      <= 'SHON'                            08020800
080209           AND OTBND_TRIP_ID  = :SUCDOT-OTBND-TRIP-ID             08020900
080210     END-EXEC                                                     08021000
080211                                                                  08021100
080212     EVALUATE TRUE                                                08021200
080213         WHEN SQLCODE = ZERO                                      08021300
080214         WHEN SQLCODE = +100                                      08021400
080215             CONTINUE                                             08021500
080216         WHEN SQLCODE = -904                                      08021600
080217         WHEN SQLCODE = -913                                      08021700
080218             CONTINUE                                             08021800
080219         WHEN SQLWARN0 NOT = SPACES                               08021900
080220         WHEN SQLCODE < ZERO                                      08022000
080221         WHEN SQLCODE > ZERO                                      08022100
080222             MOVE '2320-INACTIVE-OTBND-LOC'  TO DP013-PARAGRAPH   08022200
080223             MOVE 'INACTV OTBND LOC '                             08022300
080224                                   TO DP013-MESSAGE-TEXT (1)      08022400
080225             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      08022500
080226             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          08022600
080227             MOVE SQLCA        TO DP013-SQLCA                     08022700
080228             MOVE 'OTBNDLOC'    TO DP013-DB2-TABLE-NAME (1)       08022800
080229             SET PS-ERROR                                         08022900
080230                 DP013-DB2-ABEND                                  08023000
080231                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08023100
080232             PERFORM DP013-0000-PROCESS-ABEND                     08023200
080233     END-EVALUATE.                                                08023300
080234                                                                  08023400
080235*----------------------------------------------------------------*08023500
080236* INACTIVATE ALL OF THE DIVERTS FOR THE CARTON WITH A DIVERT      08023600
080237* TIMESTAMP PRIOR TO THE LAST CLOSE OF THE TRAILER.               08023700
080238*----------------------------------------------------------------*08023800
080239 2330-INACTIVE-DIVERTS.                                           08023900
080240                                                                  08024000
080241     EXEC SQL                                                     08024100
080242         UPDATE TSUCRDV                                           08024200
080243           SET  ACTV_CDE      =  'I'                              08024300
080244         WHERE  SHIPT_UNT_ID  =  :SUCRDV-SHIPT-UNT-ID             08024400
080245          AND DIVERT_TMST    <= :DK-OTBND-TMST                    08024500
080246     END-EXEC.                                                    08024600
080247                                                                  08024700
080248     EVALUATE TRUE                                                08024800
080249         WHEN SQLCODE = ZERO                                      08024900
080250             CONTINUE                                             08025000
080251         WHEN SQLCODE = -904                                      08025100
080252         WHEN SQLCODE = -913                                      08025200
080253             CONTINUE                                             08025300
080254         WHEN SQLCODE = +100                                      08025400
080255         WHEN SQLWARN0 NOT = SPACES                               08025500
080256         WHEN SQLCODE < ZERO                                      08025600
080257         WHEN SQLCODE > ZERO                                      08025700
080258             MOVE '2330-INACTV-DIVERTS  '  TO DP013-PARAGRAPH     08025800
080259             MOVE 'INACTV DIVERTS '                               08025900
080260                                   TO DP013-MESSAGE-TEXT (1)      08026000
080261             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      08026100
080262             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          08026200
080263             MOVE SQLCA        TO DP013-SQLCA                     08026300
080264             MOVE 'TSUCRDV '    TO DP013-DB2-TABLE-NAME (1)       08026400
080265             SET PS-ERROR                                         08026500
080266                 DP013-DB2-ABEND                                  08026600
080267                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08026700
080268             PERFORM DP013-0000-PROCESS-ABEND                     08026800
080269     END-EVALUATE.                                                08026900
080270                                                                  08027000
080271*----------------------------------------------------------------*08027100
080272* IF THE TRAILER SUMMARY SHOWS 0 CARTONS ATTACHED TO THE TRAILER  08027200
080273* RELEASE THE TRAILER TO ALLOW IT TO BE REUSED.                   08027300
080274*----------------------------------------------------------------*08027400
080275 2350-RELEASE-TRLR.                                               08027500
080276                                                                  08027600
080277         EXEC SQL                                                 08027700
080278             INSERT INTO TSUOBTS                                  08027800
080279                   (OTBND_TRIP_ID                                 08027900
080280                 ,  OTBND_STAT_TMST                               08028000
080281                 ,  TRIP_STAT_CDE                                 08028100
080282                 ,  STAT_OPER_UNT_ID                              08028200
080283                 ,  OTBND_STAT_USR_ID                             08028300
080284                 ,  DOOR_ID                                       08028400
080285                 ,  TRLR_SEAL_ID                                  08028500
080286                 ,  SHIP_SCAC_CDE                                 08028600
080287                 ,  SHIP_DRV_LAST_NM                              08028700
080288                 ,  SHIP_DRV_FRST_NM                              08028800
080289                 ,  SHIP_DRV_ID                                   08028900
080290                 ,  TRLR_PRKG_LOC_DESC                            08029000
080291                 ,  TRLR_PRKG_SLOT_NBR                            08029100
080292                 ,  FINCL_POST_TMST                               08029200
080293                 ,  CPCTY_PCT                                     08029300
080294                 ,  UNUSD_PLLT_QTY                                08029400
080295                 ,  LOD_BR_QTY)                                   08029500
080296           VALUES  (:DK-TRIP-ID                                   08029600
080297                 ,  CURRENT TIMESTAMP                             08029700
080298                 ,  'DR'                                          08029800
080299                 ,  :DK-OPER-UNT-ID                               08029900
080300                 ,  :DP020-USERID                                 08030000
080301                 ,  :DK-DOOR-ID                                   08030100
080302                 ,  :SUOBTS-TRLR-SEAL-ID                          08030200
080303                 ,  :SUOBTS-SHIP-SCAC-CDE                         08030300
080304                 ,  :SUOBTS-SHIP-DRV-LAST-NM                      08030400
080305                 ,  :SUOBTS-SHIP-DRV-FRST-NM                      08030500
080306                 ,  :SUOBTS-SHIP-DRV-ID                           08030600
080307                 ,  :SUOBTS-TRLR-PRKG-LOC-DESC                    08030700
080308                 ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                    08030800
080309                 ,  :SUOBTS-FINCL-POST-TMST                       08030900
080310                 ,  :SUOBTS-CPCTY-PCT                             08031000
080311                 ,  :SUOBTS-UNUSD-PLLT-QTY                        08031100
080312                 ,  :SUOBTS-LOD-BR-QTY)                           08031200
080313                                                                  08031300
080314     END-EXEC.                                                    08031400
080315                                                                  08031500
080316     EVALUATE TRUE                                                08031600
080317         WHEN SQLCODE = ZERO                                      08031700
080318             MOVE PC-TSYMSG-00059      TO DP020-MSG-NUMBER        08031800
080319             SET DP020-MSG-WARNING     TO TRUE                    08031900
080320         WHEN OTHER                                               08032000
080321             SET PS-ERROR                TO TRUE                  08032100
080322             SET DP020-MSG-FATAL         TO TRUE                  08032200
080323             MOVE PC-TSYMSG-03039        TO DP020-MSG-NUMBER      08032300
080324             MOVE -1                     TO ASEALL                08032400
080325             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08032500
080326     END-EVALUATE.                                                08032600
080327                                                                  08032700
080328*----------------------------------------------------------------*08032800
080329* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *08032900
080330* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *08033000
080340* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *08034000
080350*----------------------------------------------------------------*08035000
080360 3000-EDIT-DATA-IN-COMMAREA.                                      08036000
080370     PERFORM 3200-RESET-ATTRIBUTES.                               08037000
080380     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  AND               08038000
080390        (ASC-DOOR-TYP-CDE  =  'DS'  OR                            08039000
080400         ASC-DOOR-TYP-CDE  =  'SH')                               08040000
080410*                                                                 08041033
080420* DMH 2017-10-06 BEGIN                                            08042033
080421       IF  ASC-TRAILER-SEAL-NBR > SPACE                           08042133
080430             PERFORM 4170-CHECK-SEAL-PREV-USED                    08043033
080431       END-IF                                                     08043133
080440* DMH 2017-10-06 END                                              08044033
080450*                                                                 08045033
080500                                                                  08050000
080600       IF  ASC-TRAILER-SEAL-NBR = SPACE AND                       08060000
080700             PS-NO-ERROR                                          08070000
080800             SET PS-ERROR              TO TRUE                    08080000
080810             SET DP020-MSG-FATAL       TO TRUE                    08081000
080820             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        08082000
080830             MOVE DP015-UNP-ALP-BRT-OFF                           08083000
080840                                       TO ASEALA                  08084000
080850             MOVE DP015-RED            TO ASEALC                  08085000
080860             MOVE DP015-REVERSE        TO ASEALH                  08086000
080870             MOVE -1                   TO ASEALL                  08087000
080880             SET DP030-SET-CURSOR-APPL-1                          08088000
080890                                       TO TRUE                    08089000
080910       ELSE                                                       08091033
081000         IF  ASC-TRAILER-SEAL-NBR NOT = ASC-ORIG-TRLR-SEAL-NBR AND08100000
081100             PS-NO-ERROR                                          08110000
081200             SET PS-ERROR              TO TRUE                    08120000
081300             SET DP020-MSG-FATAL       TO TRUE                    08130000
081400             MOVE PC-TSYMSG-02931      TO DP020-MSG-NUMBER        08140000
081500*** 10/04/2022OVE DP015-UNP-ALP-BRT-OFF                           08150050
081510             MOVE DP015-PRO-BRT-MDT                               08151050
081600                                       TO ASEALA                  08160000
081700             MOVE DP015-RED            TO ASEALC                  08170000
081800             MOVE DP015-REVERSE        TO ASEALH                  08180000
081900             MOVE -1                   TO ASEALL                  08190000
082000             SET DP030-SET-CURSOR-APPL-1                          08200000
082100                                       TO TRUE                    08210000
082200             SET ASC-CONFIRM-REQUESTED TO TRUE                    08220000
082300         END-IF                                                   08230000
082400         IF ASC-UNIT-COUNT = ZERO                                 08240000
082500             IF ASC-CONFIRM-REQUESTED                             08250000
082600                 SET ASC-EMPTY-CONFIRM     TO TRUE                08260000
082700             ELSE                                                 08270000
082701* DANH - 03/19/15 - BEGIN                                         08270124
082710                 IF  ASC-DOOR-TYP-CDE = 'SH'                      08271019
082800                     SET PS-ERROR          TO TRUE                08280019
082900                     SET DP020-MSG-FATAL   TO TRUE                08290019
083000                     MOVE PC-TSYMSG-03765  TO DP020-MSG-NUMBER    08300024
083100                     MOVE DP015-UNP-ALP-BRT-OFF                   08310019
083200                                           TO ASEALA              08320000
083300                     MOVE DP015-RED        TO ASEALC              08330019
083400                     MOVE DP015-REVERSE    TO ASEALH              08340019
083500                     MOVE -1               TO ASEALL              08350019
083600                     SET DP030-SET-CURSOR-APPL-1                  08360019
083700                                           TO TRUE                08370000
083800                 ELSE                                             08380019
083810                     SET PS-ERROR          TO TRUE                08381019
083820                     SET DP020-MSG-FATAL   TO TRUE                08382019
083830                     MOVE PC-TSYMSG-02944  TO DP020-MSG-NUMBER    08383019
083850*** 10/04/2022       MOVE DP015-UNP-ALP-BRT-OFF                   08385048
083851                     MOVE DP015-PRO-BRT-MDT                       08385148
083860                                           TO ASEALA              08386019
083870                     MOVE DP015-RED        TO ASEALC              08387019
083880                     MOVE DP015-REVERSE    TO ASEALH              08388019
083890                     MOVE -1               TO ASEALL              08389019
083891                     SET DP030-SET-CURSOR-APPL-1                  08389119
083892                                           TO TRUE                08389219
083893                     SET ASC-CONFIRM-REQUESTED                    08389319
083894                                           TO TRUE                08389419
083900                 END-IF                                           08390019
083901* DANH - 03/19/15 - END                                           08390124
083910             END-IF                                               08391019
084000         END-IF                                                   08400000
084100       END-IF                                                     08410000
084200     ELSE                                                         08420000
084300     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                   08430000
084400         SET  PS-ERROR                                            08440000
084500              DP020-MSG-FATAL TO TRUE                             08450000
084600              MOVE PC-TSYMSG-02992 TO DP020-MSG-NUMBER            08460000
084700              MOVE -1              TO ASEALL                      08470000
084800              SET  DP030-SET-CURSOR-APPL-1 TO TRUE                08480000
084900              SET  DP030-OVERRIDE-GO TO TRUE                      08490000
085000     END-IF                                                       08500000
085100     END-IF.                                                      08510000
085200                                                                  08520000
085300* DMH - 03/06/03 - BEGIN                                          08530000
085400     IF  DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  OR               08540000
085500         DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                   08550000
085600                                                                  08560000
085700         PERFORM 4160-CHECK-END-DIVERT                            08570000
085701     END-IF.                                                      08570100
085702* DMH - 03/06/03 - END                                            08570200
085703                                                                  08570300
085704* THIS PREVENTS THE CURSOR FROM JUMPING FROM THE COMMAND          08570400
085705* LINE BACK TO THE SEAL WHEN ENTER IS PRESSED                     08570500
085706     IF DP030-SET-CURSOR-TRAILER                                  08570600
085707         CONTINUE                                                 08570700
085708     ELSE                                                         08570800
085709         IF  PS-NO-ERROR                                          08570900
085710             MOVE -1                     TO ASEALL                08571000
085720             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08572000
085730         END-IF                                                   08573000
085740     END-IF.                                                      08574000
085750*                                                                 08575000
085760*----------------------------------------------------------------*08576000
085770* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *08577000
085780* MAP.                                                           *08578000
085790*----------------------------------------------------------------*08579000
085800 3200-RESET-ATTRIBUTES.                                           08580000
085900                                                                  08590000
086000*    ASSUME AUTHORITY TO DO BOTH SHIP AND RELEASE                 08600000
086100     MOVE DP015-UNP-ALP-NOR-OFF        TO ASEALA                  08610000
086200                                          ASSCACA                 08620000
086300                                          AFNAMEA                 08630000
086400                                          ALNAMEA                 08640000
086500                                          ADRIVIDA                08650000
086600     MOVE DP015-GREEN                  TO ASEALC                  08660000
086700                                          ASSCACC                 08670000
086800                                          AFNAMEC                 08680000
086900                                          ALNAMEC                 08690000
087000                                          ADRIVIDC                08700000
087100     MOVE DP015-UNDERLINE              TO ASEALH                  08710000
087200                                          ASSCACH                 08720000
087300                                          AFNAMEH                 08730000
087400                                          ALNAMEH                 08740000
087500                                          ADRIVIDH                08750000
087600                                                                  08760000
087700     EVALUATE TRUE                                                08770000
087800     WHEN ASC-RACF-SHIP-AUTH-YES AND                              08780000
087900          ASC-RACF-RLSE-AUTH-YES                                  08790000
088000*         YOU REALLY DO HAVE AUTHORITY FOR BOTH                   08800000
088100         CONTINUE                                                 08810000
088200                                                                  08820000
088300     WHEN ASC-RACF-SHIP-AUTH-NO AND                               08830000
088400          ASC-RACF-RLSE-AUTH-NO                                   08840000
088500*        YOU CAN DO NEITHER                                       08850000
088600         MOVE DP015-ASK-NOR-OFF        TO ASEALA                  08860000
088700                                          ASSCACA                 08870000
088800                                          AFNAMEA                 08880000
088900                                          ALNAMEA                 08890000
089000                                          ADRIVIDA                08900000
089100                                          ATSEALA                 08910000
089200                                          ATSCACA                 08920000
089300                                          ATFNMEA                 08930000
089400                                          ATLNMEA                 08940000
089500                                          ATDRIDA                 08950000
089600         MOVE DP015-BLUE               TO ASEALC                  08960000
089700                                          ASSCACC                 08970000
089800                                          AFNAMEC                 08980000
089900                                          ALNAMEC                 08990000
090000                                          ADRIVIDC                09000000
090100         SET DP030-SET-CURSOR-TRAILER                             09010000
090200             DP030-OVERRIDE-GO         TO TRUE                    09020000
090300                                                                  09030000
090400     WHEN ASC-RACF-SHIP-AUTH-NO                                   09040000
090500*        YOU CAN RELEASE BUT NOT SHIP                             09050000
090600         MOVE DP015-ASK-NOR-OFF        TO ASEALA                  09060000
090700                                          ASSCACA                 09070000
090800                                          AFNAMEA                 09080000
090900                                          ALNAMEA                 09090000
091000                                          ADRIVIDA                09100000
091100                                          ATSEALA                 09110000
091200                                          ATSCACA                 09120000
091300                                          ATFNMEA                 09130000
091400                                          ATLNMEA                 09140000
091500                                          ATDRIDA                 09150000
091600         MOVE DP015-BLUE               TO ASEALC                  09160000
091700                                          ASSCACC                 09170000
091800                                          AFNAMEC                 09180000
091900                                          ALNAMEC                 09190000
092000                                          ADRIVIDC                09200000
092100                                                                  09210000
092200*        POSITION CURSOR ON COMMAND LINE                          09220000
092300         SET DP030-SET-CURSOR-TRAILER                             09230000
092400             DP030-OVERRIDE-GO         TO TRUE                    09240000
092500     WHEN OTHER                                                   09250000
092600*        YOU CAN SHIP BUT NOT RELEASE                             09260000
092700         CONTINUE                                                 09270000
092800     END-EVALUATE.                                                09280000
092900/                                                                 09290000
093000*----------------------------------------------------------------*09300000
093100*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *09310000
093200*    ENTRY.                                                      *09320000
093300*----------------------------------------------------------------*09330000
093400                                                                  09340000
093500 4000-BUILD-INITIAL-PANEL.                                        09350000
093600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        09360000
093700     MOVE -1                       TO ASEALL.                     09370000
093800     MOVE ASC-TRIP-ID              TO DK-TRIP-ID.                 09380000
093900     PERFORM 4100-GET-TRAILER-INFO.                               09390000
094000                                                                  09400000
094100*    WE'RE CHECKING TO MAKE SURE THAT SUMMARY ROWS WERE CREATED   09410000
094200*    WHEN THE TRAILER WAS CLOSED.  IF THERE ARE NO SUMMARY        09420000
094300*    RECORDS FOR THIS TRIP THEN LINK TO SUKCS574 TO CREATE THEM.  09430000
094400                                                                  09440000
094500*    THE TRAILER IS NOT CLOSED YOU CAN'T DO ANY UPDATING HERE AND 09450000
094600*    IF THERE ARE NO SUMMARY ROWS THE COUNT AND DOLLAR AMOUNTS    09460000
094700*    WILL BE BLANK.                                               09470000
094800                                                                  09480000
094900     IF PS-INITIAL-BUILD  AND PS-TRAILER-FOUND                    09490000
095000         EVALUATE TRUE                                            09500000
095100         WHEN SUOBTS-TRIP-STAT-CDE = 'DC'                         09510000
095200             PERFORM 7210-CHECK-FOR-TRIP-SUM                      09520000
095300                                                                  09530000
095400             IF PS-THERE-ARE-SUMMARIES                            09540000
095500                 CONTINUE                                         09550000
095600             ELSE                                                 09560000
095700                 PERFORM 8300-LINK-SUKCS574                       09570000
095800             END-IF                                               09580000
095900                                                                  09590000
096000         WHEN SUOBTS-TRIP-STAT-CDE = 'DO'                         09600000
096100             PERFORM 8300-LINK-SUKCS574                           09610000
096200         END-EVALUATE                                             09620000
096300                                                                  09630000
096400         PERFORM 4010-CONTINUE-BUILD-MAP                          09640000
096410*** PK 11/25/13 HAZMAT SUMMARY BEGIN                              09641002
096411*** HAZ REPORT STATUS CHECK AND PARM FETCH                        09641107
096420         PERFORM 4650-CHK-WHTR-HAZ-FACLTY                         09642002
096430         IF ASC-HAZ-FACILITY-YES                                  09643002
096440            PERFORM 4670-GET-SYS-TRLG-CDES                        09644002
096450            PERFORM 4600-CHK-HAZSMRY-STAT                         09645002
096460            PERFORM 4660-GET-DFLT-PRNT-ID                         09646002
096470         END-IF                                                   09647002
096480*** PK 11/25/13 HAZMAT SUMMARY END                                09648002
096500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09650000
096600     END-IF.                                                      09660000
096700                                                                  09670000
096800 4010-CONTINUE-BUILD-MAP.                                         09680000
096900                                                                  09690000
097100     PERFORM 4300-GET-COST-RETAIL                                 09710000
097200     MOVE SUOBTS-STAT-OPER-UNT-ID      TO ASC-OPER-UNT-ID         09720000
097300     MOVE SUOBTR-TRLR-SRL-NBR          TO ASC-TRLR-SRL-NBR        09730000
097400     MOVE CNTRID-SCAC-CDE              TO ASC-SCAC                09740000
097500     MOVE CNTRID-TRLR-ID               TO ASC-TRAILER-ID          09750000
097600     MOVE SUOBTS-OTBND-TRIP-ID         TO ASC-TRIP-ID             09760000
097700     MOVE SUOBSC-TRIP-STAT-DESC        TO ASC-TRIP-STATUS         09770000
097800     MOVE SUOBTR-DOOR-TYP-CDE          TO ASC-DOOR-TYP-CDE        09780000
097900     MOVE SUOBTS-TRIP-STAT-CDE         TO ASC-TRIP-STAT-CDE       09790000
098000*    MOVE SUOBTS-OTBND-STAT-TMST       TO ASC-TRIP-STATUS-DATE    09800000
098100     MOVE PV-USA-DATE                  TO ASC-TRIP-STATUS-DATE    09810000
098200*    MOVE SUOBTS-DOOR-ID               TO ASC-DOOR-SLOT           09820000
098300*LMM MOVE CNDCDR-DOOR-LOC-DESC         TO ASC-DOOR-SLOT-DESC      09830000
098400*    MOVE SUOBTS-TRLR-PRKG-LOC-DESC TO ASC-DOOR-SLOT-DESC         09840000
098500     MOVE SUOBTR-DEST-OPER-UNT-ID      TO ASC-DESTINATION-ID      09850000
098600                                      DK-OPER-UNT-ID              09860000
098700     PERFORM 4350-SELECT-FACILTY-DSC                              09870000
098800     MOVE XL071-LOC-NM                 TO ASC-DESTINATION-DESC    09880000
098900     MOVE SUT00007-RTL-DOL-AMT         TO ASC-RETAIL              09890000
099000     MOVE SUT00007-COST-DOL-AMT        TO ASC-COST                09900000
099100     MOVE SUT00007-CART-QTY            TO ASC-CARTON-COUNT        09910000
099200     MOVE SUT00007-UNT-QTY             TO ASC-UNIT-COUNT          09920000
099300     MOVE SUOBTS-TRLR-SEAL-ID          TO ASC-ORIG-TRLR-SEAL-NBR  09930000
099400     MOVE CNDCDR-DOOR-TYP-CDE          TO ASC-DOOR-TYPE-CODE      09940000
099500     MOVE SPACES                       TO ASC-TRAILER-SEAL-NBR    09950000
099600     MOVE SPACES                       TO ASC-SHIP-SCAC-CODE      09960000
099700     MOVE SPACES                       TO ASC-DRIVER-FIRST-NAME   09970000
099800     MOVE SPACES                       TO ASC-DRIVER-LAST-NAME    09980000
099900     MOVE SPACES                       TO ASC-DRIVER-ID           09990000
100000     PERFORM 7000-SUM-PALLETS.                                    10000000
100100                                                                  10010000
100101* DMH 08/17 - BEGIN                                               10010127
100102     IF  ASC-TRIP-STAT-CDE  = 'SO'  OR                            10010227
100103         ASC-TRIP-STAT-CDE  = 'SU'  OR                            10010330
100104         ASC-TRIP-STAT-CDE  = 'DS'                                10010429
100105         PERFORM 4200-GET-STORE-SCAN-COUNTS                       10010529
100106     ELSE                                                         10010627
100107         MOVE ZEROES  TO  ASC-STR-SCAN-CNT                        10010727
100108                          ASC-STR-SCAN-FROM-DIFF                  10010827
100109                          ASC-STR-SCAN-ONTO-DIFF                  10010927
100110                          ASC-STR-SCAN-ASSUME                     10011027
100111     END-IF.                                                      10011127
100112* DMH 08/17 - END                                                 10011227
100113                                                                  10011327
100120                                                                  10012027
100200*----------------------------------------------------------------*10020000
100300* SELECT THE TRAILER INFORMATION                                 *10030000
100400*----------------------------------------------------------------*10040000
100500 4100-GET-TRAILER-INFO.                                           10050000
100600                                                                  10060000
100700     IF ASC-TRAILER-SEAL-NBR > SPACES                             10070000
100800* FIRST TRY THE NEW SEAL NBR.  IF IT FAILS, TRY THE OLD ONE.      10080000
100900         MOVE ASC-TRAILER-SEAL-NBR    TO DK-SEAL-ID               10090000
101000         PERFORM 4100B-TRAILER-BY-SEAL                            10100000
101100         IF PS-TRAILER-NOT-FOUND                                  10110000
101200             MOVE ASC-ORIG-TRLR-SEAL-NBR TO DK-SEAL-ID            10120000
101300             PERFORM 4100B-TRAILER-BY-SEAL                        10130000
101400         END-IF                                                   10140000
101500         MOVE SUOBTS-OTBND-TRIP-ID       TO DK-TRIP-ID            10150000
101600     ELSE                                                         10160000
101700         PERFORM 4100A-TRAILER-BY-TRIP                            10170000
101800     END-IF.                                                      10180000
101900                                                                  10190000
102000 4100A-TRAILER-BY-TRIP.                                           10200000
102100     SET PS-TRAILER-FOUND             TO TRUE                     10210000
102200     PERFORM                                                      10220000
102300         WITH TEST AFTER                                          10230000
102400         VARYING PV-RETRY-COUNTER                                 10240000
102500         FROM 1 BY 1                                              10250000
102600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10260000
102700                   OR (SQLCODE = ZERO)                            10270000
102800                   OR (SQLCODE = +100))                           10280000
102900*                                                                 10290000
103000         EXEC SQL                                                 10300000
103100              SELECT  B.TRLR_SRL_NBR                              10310000
103200                   ,  C.SCAC_CDE                                  10320000
103300                   ,  C.TRLR_ID                                   10330000
103400                   ,  A.STAT_OPER_UNT_ID                          10340000
103500                   ,  A.OTBND_TRIP_ID                             10350000
103600                   ,  A.TRIP_STAT_CDE                             10360000
103700                   ,  A.OTBND_STAT_TMST                           10370000
103800                   ,  CHAR(DATE(A.OTBND_STAT_TMST),USA)           10380000
103900                   ,  A.DOOR_ID                                   10390000
104000                   ,  D.DOOR_LOC_DESC                             10400000
104100                   ,  B.DEST_OPER_UNT_ID                          10410000
104200                   ,  E.TRIP_STAT_DESC                            10420000
104300                   ,  D.DOOR_TYP_CDE                              10430000
104400                   ,  A.TRLR_SEAL_ID                              10440000
104500                   ,  B.DOOR_TYP_CDE                              10450000
104600                   ,  A.TRLR_PRKG_SLOT_NBR                        10460000
104700                   ,  A.TRLR_PRKG_LOC_DESC                        10470000
104800                   ,  A.OTBND_STAT_USR_ID                         10480000
104900                   ,  A.FINCL_POST_TMST                           10490000
105000                   ,  A.CPCTY_PCT                                 10500000
105100                   ,  A.UNUSD_PLLT_QTY                            10510000
105200                   ,  A.LOD_BR_QTY                                10520000
105300              INTO    :SUOBTR-TRLR-SRL-NBR                        10530000
105400                   ,  :CNTRID-SCAC-CDE                            10540000
105500                   ,  :CNTRID-TRLR-ID                             10550000
105600                   ,  :SUOBTS-STAT-OPER-UNT-ID                    10560000
105700                   ,  :SUOBTS-OTBND-TRIP-ID                       10570000
105800                   ,  :SUOBTS-TRIP-STAT-CDE                       10580000
105900                   ,  :SUOBTS-OTBND-STAT-TMST                     10590000
106000                   ,  :PV-USA-DATE                                10600000
106100                   ,  :SUOBTS-DOOR-ID                             10610000
106200                   ,  :CNDCDR-DOOR-LOC-DESC                       10620000
106300                   ,  :SUOBTR-DEST-OPER-UNT-ID                    10630000
106400                   ,  :SUOBSC-TRIP-STAT-DESC                      10640000
106500                   ,  :CNDCDR-DOOR-TYP-CDE                        10650000
106600                   ,  :SUOBTS-TRLR-SEAL-ID                        10660000
106700                   ,  :SUOBTR-DOOR-TYP-CDE                        10670000
106800                   ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                  10680000
106900                   ,  :SUOBTS-TRLR-PRKG-LOC-DESC                  10690000
107000                   ,  :SUOBTS-OTBND-STAT-USR-ID                   10700000
107100                   ,  :SUOBTS-FINCL-POST-TMST                     10710000
107200                   ,  :SUOBTS-CPCTY-PCT                           10720000
107300                   ,  :SUOBTS-UNUSD-PLLT-QTY                      10730000
107400                   ,  :SUOBTS-LOD-BR-QTY                          10740000
107500               FROM  TSUOBTS A                                    10750000
107600                   , TSUOBTR B                                    10760000
107700                   , TCNTRID C                                    10770000
107800                   , TCNDCDR D                                    10780000
107900                   , TSUOBSC E                                    10790000
108000             WHERE  A.OTBND_TRIP_ID          =  :DK-TRIP-ID       10800000
108100               AND  A.OTBND_TRIP_ID          =  B.OTBND_TRIP_ID   10810000
108200               AND  B.TRLR_SRL_NBR           =  C.TRLR_SRL_NBR    10820000
108300               AND  A.DOOR_ID                =  D.DOOR_ID         10830000
108400               AND  B.ORGN_OPER_UNT_ID       =  D.OPER_UNT_ID     10840000
108500               AND  A.TRIP_STAT_CDE          =  E.TRIP_STAT_CDE   10850000
108600               AND  A.OTBND_STAT_TMST  =                          10860000
108700                  (SELECT  MAX(F.OTBND_STAT_TMST)                 10870000
108800                     FROM  TSUOBTS F                              10880000
108900                   WHERE  F.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  10890000
109000         END-EXEC                                                 10900000
109100                                                                  10910000
109200         EVALUATE TRUE                                            10920000
109300             WHEN SQLCODE = ZERO                                  10930000
109400                 IF SUOBTS-TRLR-PRKG-SLOT-NBR > SPACES AND        10940000
109500                    SUOBTS-TRLR-PRKG-LOC-DESC > SPACES            10950000
109600                    MOVE SUOBTS-TRLR-PRKG-SLOT-NBR                10960000
109700                         TO ASC-DOOR-SLOT                         10970000
109800                    MOVE SUOBTS-TRLR-PRKG-LOC-DESC                10980000
109900                         TO ASC-DOOR-SLOT-DESC                    10990000
110000                 ELSE                                             11000000
110100                    MOVE SUOBTS-DOOR-ID                           11010000
110200                         TO ASC-DOOR-SLOT                         11020000
110300                    PERFORM 4150-GET-DOOR-ID-DESC                 11030000
110400                    MOVE CNDCDR-DOOR-LOC-DESC                     11040000
110500                         TO ASC-DOOR-SLOT-DESC                    11050000
110600                 END-IF                                           11060000
110700             WHEN SQLCODE = +100                                  11070000
110800                 PERFORM 4100C-TRAILER-BY-TRIP-NO-DOOR            11080000
110900             WHEN SQLCODE = -904                                  11090000
111000             WHEN SQLCODE = -913                                  11100000
111100                 CONTINUE                                         11110000
111200             WHEN SQLWARN0 NOT = SPACES                           11120000
111300             WHEN SQLCODE < ZERO                                  11130000
111400             WHEN SQLCODE > ZERO                                  11140000
111500                 MOVE '4100-GET-TRAILER-INFO'                     11150000
111600                                   TO DP013-PARAGRAPH             11160000
111700                 MOVE 'SELECT TRAILER INFO'                       11170000
111800                                   TO DP013-MESSAGE-TEXT (1)      11180000
111900                 MOVE DK-TRIP-ID   TO PV-TRIP-ID                  11190000
112000                 MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)      11200000
112100                 MOVE SQLCA        TO DP013-SQLCA                 11210000
112200                 MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)    11220000
112300                 MOVE 'TSUOBTR'    TO DP013-DB2-TABLE-NAME (2)    11230000
112400                 MOVE 'TCNTRID'    TO DP013-DB2-TABLE-NAME (3)    11240000
112500                 MOVE 'TCNDCDR'    TO DP013-DB2-TABLE-NAME (4)    11250000
112600                 MOVE 'TSUOBSC'    TO DP013-DB2-TABLE-NAME (5)    11260000
112700                 SET DP013-DB2-ABEND                              11270000
112800                     DP013-XCTL-DISPLAY-RESTART                   11280000
112900                                   TO TRUE                        11290000
113000                 PERFORM DP013-0000-PROCESS-ABEND                 11300000
113100         END-EVALUATE                                             11310000
113200     END-PERFORM.                                                 11320000
113300*                                                                 11330000
113400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11340000
113500         MOVE '4100-GET-TRAILER-INFO'                             11350000
113600                                   TO DP013-PARAGRAPH             11360000
113700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11370000
113800                                   TO DP013-MESSAGE-TEXT (1)      11380000
113900         MOVE 'TRAILER INFO '      TO DP013-MESSAGE-TEXT (2)      11390000
114000         MOVE SQLCA                TO DP013-SQLCA                 11400000
114100         MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)    11410000
114200         MOVE 'TSUOBTR'            TO DP013-DB2-TABLE-NAME (2)    11420000
114300         MOVE 'TCNTRID'            TO DP013-DB2-TABLE-NAME (3)    11430000
114400         MOVE 'TCNDCDR'            TO DP013-DB2-TABLE-NAME (4)    11440000
114500         MOVE 'TSUOBSC'            TO DP013-DB2-TABLE-NAME (5)    11450000
114600         SET DP013-DB2-ABEND                                      11460000
114700             DP013-XCTL-DISPLAY-RESTART                           11470000
114800                                   TO TRUE                        11480000
114900         PERFORM DP013-0000-PROCESS-ABEND                         11490000
115000     END-IF.                                                      11500000
115100                                                                  11510000
115200 4100B-TRAILER-BY-SEAL.                                           11520000
115300     SET PS-TRAILER-FOUND             TO TRUE                     11530000
115400*    MOVE ASC-TRAILER-SEAL-NBR        TO DK-SEAL-ID               11540000
115500                                                                  11550000
115600     PERFORM                                                      11560000
115700         WITH TEST AFTER                                          11570000
115800         VARYING PV-RETRY-COUNTER                                 11580000
115900         FROM 1 BY 1                                              11590000
116000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11600000
116100                   OR (SQLCODE = ZERO)                            11610000
116200                   OR (SQLCODE = +100))                           11620000
116300*                                                                 11630000
116400         EXEC SQL                                                 11640000
116500              SELECT  B.TRLR_SRL_NBR                              11650000
116600                   ,  C.SCAC_CDE                                  11660000
116700                   ,  C.TRLR_ID                                   11670000
116800                   ,  A.STAT_OPER_UNT_ID                          11680000
116900                   ,  A.OTBND_TRIP_ID                             11690000
117000                   ,  A.TRIP_STAT_CDE                             11700000
117100                   ,  A.OTBND_STAT_TMST                           11710000
117200                   ,  CHAR(DATE(A.OTBND_STAT_TMST),USA)           11720000
117300                   ,  A.DOOR_ID                                   11730000
117400                   ,  D.DOOR_LOC_DESC                             11740000
117500                   ,  B.DEST_OPER_UNT_ID                          11750000
117600                   ,  E.TRIP_STAT_DESC                            11760000
117700                   ,  D.DOOR_TYP_CDE                              11770000
117800                   ,  A.TRLR_SEAL_ID                              11780000
117900                   ,  B.DOOR_TYP_CDE                              11790000
118000                   ,  A.TRLR_PRKG_SLOT_NBR                        11800000
118100                   ,  A.TRLR_PRKG_LOC_DESC                        11810000
118200                   ,  A.OTBND_STAT_USR_ID                         11820000
118300                   ,  A.FINCL_POST_TMST                           11830000
118400                   ,  A.CPCTY_PCT                                 11840000
118500                   ,  A.UNUSD_PLLT_QTY                            11850000
118600                   ,  A.LOD_BR_QTY                                11860000
118700              INTO    :SUOBTR-TRLR-SRL-NBR                        11870000
118710                   ,  :CNTRID-SCAC-CDE                            11871000
118720                   ,  :CNTRID-TRLR-ID                             11872000
118730                   ,  :SUOBTS-STAT-OPER-UNT-ID                    11873000
118740                   ,  :SUOBTS-OTBND-TRIP-ID                       11874000
118750                   ,  :SUOBTS-TRIP-STAT-CDE                       11875000
118760                   ,  :SUOBTS-OTBND-STAT-TMST                     11876000
118770                   ,  :PV-USA-DATE                                11877000
118780                   ,  :SUOBTS-DOOR-ID                             11878000
118790                   ,  :CNDCDR-DOOR-LOC-DESC                       11879000
118800                   ,  :SUOBTR-DEST-OPER-UNT-ID                    11880000
118900                   ,  :SUOBSC-TRIP-STAT-DESC                      11890000
119000                   ,  :CNDCDR-DOOR-TYP-CDE                        11900000
119100                   ,  :SUOBTS-TRLR-SEAL-ID                        11910000
119200                   ,  :SUOBTR-DOOR-TYP-CDE                        11920000
119300                   ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                  11930000
119400                   ,  :SUOBTS-TRLR-PRKG-LOC-DESC                  11940000
119500                   ,  :SUOBTS-OTBND-STAT-USR-ID                   11950000
119600                   ,  :SUOBTS-FINCL-POST-TMST                     11960000
119700                   ,  :SUOBTS-CPCTY-PCT                           11970000
119800                   ,  :SUOBTS-UNUSD-PLLT-QTY                      11980000
119900                   ,  :SUOBTS-LOD-BR-QTY                          11990000
120000               FROM  TSUOBTS A                                    12000000
120100                   , TSUOBTR B                                    12010000
120200                   , TCNTRID C                                    12020000
120300                   , TCNDCDR D                                    12030000
120400                   , TSUOBSC E                                    12040000
120500             WHERE  A.TRLR_SEAL_ID           =  :DK-SEAL-ID       12050000
120600               AND  A.OTBND_TRIP_ID          =  B.OTBND_TRIP_ID   12060000
120700               AND  B.TRLR_SRL_NBR           =  C.TRLR_SRL_NBR    12070000
120800               AND  A.DOOR_ID                =  D.DOOR_ID         12080000
120900               AND  B.ORGN_OPER_UNT_ID       =  D.OPER_UNT_ID     12090000
121000               AND  A.TRIP_STAT_CDE          =  E.TRIP_STAT_CDE   12100000
121100               AND  A.OTBND_STAT_TMST  =                          12110000
121200                  (SELECT  MAX(F.OTBND_STAT_TMST)                 12120000
121300                     FROM  TSUOBTS F                              12130000
121400                   WHERE  F.TRLR_SEAL_ID     = A.TRLR_SEAL_ID)    12140000
121500         END-EXEC                                                 12150000
121600                                                                  12160000
121700         EVALUATE TRUE                                            12170000
121800             WHEN SQLCODE = ZERO                                  12180000
121900                 IF SUOBTS-TRLR-PRKG-SLOT-NBR > SPACES AND        12190000
122000                    SUOBTS-TRLR-PRKG-LOC-DESC > SPACES            12200000
122100                    MOVE SUOBTS-TRLR-PRKG-SLOT-NBR                12210000
122200                         TO ASC-DOOR-SLOT                         12220000
122300                    MOVE SUOBTS-TRLR-PRKG-LOC-DESC                12230000
122400                         TO ASC-DOOR-SLOT-DESC                    12240000
122500                 ELSE                                             12250000
122600                    MOVE SUOBTS-DOOR-ID                           12260000
122700                         TO ASC-DOOR-SLOT                         12270000
122800                    PERFORM 4150-GET-DOOR-ID-DESC                 12280000
122900                    MOVE CNDCDR-DOOR-LOC-DESC                     12290000
123000                         TO ASC-DOOR-SLOT-DESC                    12300000
123100                 END-IF                                           12310000
123200             WHEN SQLCODE = +100                                  12320000
123300                 SET PS-TRAILER-NOT-FOUND TO TRUE                 12330000
123400             WHEN SQLCODE = -904                                  12340000
123500             WHEN SQLCODE = -913                                  12350000
123600                 CONTINUE                                         12360000
123700             WHEN SQLWARN0 NOT = SPACES                           12370000
123800             WHEN SQLCODE < ZERO                                  12380000
123900             WHEN SQLCODE > ZERO                                  12390000
124000                 MOVE '4100-GET-TRAILER-INFO'                     12400000
124100                                   TO DP013-PARAGRAPH             12410000
124200                 MOVE 'SELECT TRAILER INFO'                       12420000
124300                                   TO DP013-MESSAGE-TEXT (1)      12430000
124400                 MOVE DK-TRIP-ID   TO PV-TRIP-ID                  12440000
124500                 MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)      12450000
124600                 MOVE SQLCA        TO DP013-SQLCA                 12460000
124700                 MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)    12470000
124800                 MOVE 'TSUOBTR'    TO DP013-DB2-TABLE-NAME (2)    12480000
124900                 MOVE 'TCNTRID'    TO DP013-DB2-TABLE-NAME (3)    12490000
125000                 MOVE 'TCNDCDR'    TO DP013-DB2-TABLE-NAME (4)    12500000
125100                 MOVE 'TSUOBSC'    TO DP013-DB2-TABLE-NAME (5)    12510000
125200                 SET DP013-DB2-ABEND                              12520000
125300                     DP013-XCTL-DISPLAY-RESTART                   12530000
125400                                   TO TRUE                        12540000
125500                 PERFORM DP013-0000-PROCESS-ABEND                 12550000
125600         END-EVALUATE                                             12560000
125700     END-PERFORM.                                                 12570000
125800*                                                                 12580000
125900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12590000
126000         MOVE '4100-GET-TRAILER-INFO'                             12600000
126100                                   TO DP013-PARAGRAPH             12610000
126200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     12620000
126300                                   TO DP013-MESSAGE-TEXT (1)      12630000
126400         MOVE 'TRAILER INFO '      TO DP013-MESSAGE-TEXT (2)      12640000
126500         MOVE SQLCA                TO DP013-SQLCA                 12650000
126600         MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)    12660000
126700         MOVE 'TSUOBTR'            TO DP013-DB2-TABLE-NAME (2)    12670000
126800         MOVE 'TCNTRID'            TO DP013-DB2-TABLE-NAME (3)    12680000
126900         MOVE 'TCNDCDR'            TO DP013-DB2-TABLE-NAME (4)    12690000
127000         MOVE 'TSUOBSC'            TO DP013-DB2-TABLE-NAME (5)    12700000
127100         SET DP013-DB2-ABEND                                      12710000
127200             DP013-XCTL-DISPLAY-RESTART                           12720000
127300                                   TO TRUE                        12730000
127400         PERFORM DP013-0000-PROCESS-ABEND                         12740000
127500     END-IF.                                                      12750000
127600                                                                  12760000
127700 4100C-TRAILER-BY-TRIP-NO-DOOR.                                   12770000
127701* ADDED TABLE XLT_LOC AND CHANGED WHERE FOR IT (WR38216)          12770100
127710                                                                  12771000
127712*  ADDED           , XLT_LOC G                                    12771200
127713*  REMOVED     AND  B.DEST_OPER_UNT_ID       =  873               12771300
127714*  REP WITH    AND  B.DEST_OPER_UNT_ID       =  G.LOC_NBR         12771400
127717*              AND  G.LOC_TYP_CDE            =  PV-LOC-TYP-CDE    12771700
127718*              AND  G.E_BUS_IND              =  PV-E-BUS-IND      12771800
127730                                                                  12773000
127800     SET PS-TRAILER-FOUND             TO TRUE                     12780000
127900     PERFORM                                                      12790000
128000         WITH TEST AFTER                                          12800000
128100         VARYING PV-RETRY-COUNTER                                 12810000
128110         FROM 1 BY 1                                              12811000
128120         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12812000
128130                   OR (SQLCODE = ZERO)                            12813000
128140                   OR (SQLCODE = +100))                           12814000
128150*                                                                 12815000
128160         EXEC SQL                                                 12816000
128170              SELECT  B.TRLR_SRL_NBR                              12817000
128180                   ,  C.SCAC_CDE                                  12818000
128190                   ,  C.TRLR_ID                                   12819000
128191                   ,  A.STAT_OPER_UNT_ID                          12819100
128192                   ,  A.OTBND_TRIP_ID                             12819200
128193                   ,  A.TRIP_STAT_CDE                             12819300
128194                   ,  A.OTBND_STAT_TMST                           12819400
128195                   ,  CHAR(DATE(A.OTBND_STAT_TMST),USA)           12819500
128196                   ,  ' '                                         12819600
128197                   ,  ' '                                         12819700
128198                   ,  B.DEST_OPER_UNT_ID                          12819800
128199                   ,  E.TRIP_STAT_DESC                            12819900
128200                   ,  ' '                                         12820000
128201                   ,  A.TRLR_SEAL_ID                              12820100
128202                   ,  B.DOOR_TYP_CDE                              12820200
128203                   ,  A.TRLR_PRKG_SLOT_NBR                        12820300
128204                   ,  A.TRLR_PRKG_LOC_DESC                        12820400
128205                   ,  A.OTBND_STAT_USR_ID                         12820500
128206                   ,  A.FINCL_POST_TMST                           12820600
128207                   ,  A.CPCTY_PCT                                 12820700
128208                   ,  A.UNUSD_PLLT_QTY                            12820800
128209                   ,  A.LOD_BR_QTY                                12820900
128210              INTO    :SUOBTR-TRLR-SRL-NBR                        12821000
128211                   ,  :CNTRID-SCAC-CDE                            12821100
128212                   ,  :CNTRID-TRLR-ID                             12821200
128213                   ,  :SUOBTS-STAT-OPER-UNT-ID                    12821300
128214                   ,  :SUOBTS-OTBND-TRIP-ID                       12821400
128215                   ,  :SUOBTS-TRIP-STAT-CDE                       12821500
128216                   ,  :SUOBTS-OTBND-STAT-TMST                     12821600
128217                   ,  :PV-USA-DATE                                12821700
128218                   ,  :SUOBTS-DOOR-ID                             12821800
128219                   ,  :CNDCDR-DOOR-LOC-DESC                       12821900
128220                   ,  :SUOBTR-DEST-OPER-UNT-ID                    12822000
128221                   ,  :SUOBSC-TRIP-STAT-DESC                      12822100
128222                   ,  :CNDCDR-DOOR-TYP-CDE                        12822200
128223                   ,  :SUOBTS-TRLR-SEAL-ID                        12822300
128224                   ,  :SUOBTR-DOOR-TYP-CDE                        12822400
128225                   ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                  12822500
128226                   ,  :SUOBTS-TRLR-PRKG-LOC-DESC                  12822600
128227                   ,  :SUOBTS-OTBND-STAT-USR-ID                   12822700
128228                   ,  :SUOBTS-FINCL-POST-TMST                     12822800
128229                   ,  :SUOBTS-CPCTY-PCT                           12822900
128230                   ,  :SUOBTS-UNUSD-PLLT-QTY                      12823000
128231                   ,  :SUOBTS-LOD-BR-QTY                          12823100
128232               FROM  TSUOBTS A                                    12823200
128233                   , TSUOBTR B                                    12823300
128234                   , TCNTRID C                                    12823400
128235                   , TSUOBSC E                                    12823500
128236                   , XLT_LOC G                                    12823600
128237             WHERE  A.OTBND_TRIP_ID          =  :DK-TRIP-ID       12823700
128238               AND  A.OTBND_TRIP_ID          =  B.OTBND_TRIP_ID   12823800
128239               AND  B.TRLR_SRL_NBR           =  C.TRLR_SRL_NBR    12823900
128240               AND  A.DOOR_ID                =  '    '            12824000
128242               AND  B.DEST_OPER_UNT_ID       =  G.LOC_NBR         12824200
128245               AND  G.LOC_TYP_CDE            =  :PV-LOC-TYP-CDE   12824500
128246               AND  G.E_BUS_IND              =  :PV-E-BUS-IND     12824600
128247               AND  A.TRIP_STAT_CDE          =  E.TRIP_STAT_CDE   12824700
128248               AND  A.OTBND_STAT_TMST  =                          12824800
128249                  (SELECT  MAX(F.OTBND_STAT_TMST)                 12824900
128250                     FROM  TSUOBTS F                              12825000
128251                   WHERE  F.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  12825100
128252         END-EXEC                                                 12825200
128253                                                                  12825300
128254         EVALUATE TRUE                                            12825400
128255             WHEN SQLCODE = ZERO                                  12825500
128256                 IF SUOBTS-TRLR-PRKG-SLOT-NBR > SPACES AND        12825600
128257                    SUOBTS-TRLR-PRKG-LOC-DESC > SPACES            12825700
128258                    MOVE SUOBTS-TRLR-PRKG-SLOT-NBR                12825800
128259                         TO ASC-DOOR-SLOT                         12825900
128260                    MOVE SUOBTS-TRLR-PRKG-LOC-DESC                12826000
128261                         TO ASC-DOOR-SLOT-DESC                    12826100
128262                 ELSE                                             12826200
128263                    MOVE SUOBTS-DOOR-ID                           12826300
128264                         TO ASC-DOOR-SLOT                         12826400
128265                    MOVE SPACES                                   12826500
128266                         TO ASC-DOOR-SLOT-DESC                    12826600
128267                 END-IF                                           12826700
128268             WHEN SQLCODE = +100                                  12826800
128269                 SET PS-TRAILER-NOT-FOUND TO TRUE                 12826900
128270             WHEN SQLCODE = -904                                  12827000
128271             WHEN SQLCODE = -913                                  12827100
128272                 CONTINUE                                         12827200
128273             WHEN SQLWARN0 NOT = SPACES                           12827300
128274             WHEN SQLCODE < ZERO                                  12827400
128275             WHEN SQLCODE > ZERO                                  12827500
128276                 MOVE '4100C-GET-TRAILER-INFO-NO-DOOR'            12827600
128277                                   TO DP013-PARAGRAPH             12827700
128278                 MOVE 'SELECT TRAILER INFO'                       12827800
128279                                   TO DP013-MESSAGE-TEXT (1)      12827900
128280                 MOVE DK-TRIP-ID   TO PV-TRIP-ID                  12828000
128281                 MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)      12828100
128282                 MOVE SQLCA        TO DP013-SQLCA                 12828200
128283                 MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)    12828300
128284                 MOVE 'TSUOBTR'    TO DP013-DB2-TABLE-NAME (2)    12828400
128285                 MOVE 'TCNTRID'    TO DP013-DB2-TABLE-NAME (3)    12828500
128286                 MOVE 'TSUOBSC'    TO DP013-DB2-TABLE-NAME (4)    12828600
128287                 SET DP013-DB2-ABEND                              12828700
128288                     DP013-XCTL-DISPLAY-RESTART                   12828800
128289                                   TO TRUE                        12828900
128290                 PERFORM DP013-0000-PROCESS-ABEND                 12829000
128291         END-EVALUATE                                             12829100
128292     END-PERFORM.                                                 12829200
128293*                                                                 12829300
128294     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12829400
128295         MOVE '4100C-GET-TRAILER-INFO-NO-DOOR'                    12829500
128296                                   TO DP013-PARAGRAPH             12829600
128297         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     12829700
128298                                   TO DP013-MESSAGE-TEXT (1)      12829800
128299         MOVE 'TRAILER INFO '      TO DP013-MESSAGE-TEXT (2)      12829900
128300         MOVE SQLCA                TO DP013-SQLCA                 12830000
128301         MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)    12830100
128302         MOVE 'TSUOBTR'            TO DP013-DB2-TABLE-NAME (2)    12830200
128303         MOVE 'TCNTRID'            TO DP013-DB2-TABLE-NAME (3)    12830300
128304         MOVE 'TSUOBSC'            TO DP013-DB2-TABLE-NAME (4)    12830400
128305         SET DP013-DB2-ABEND                                      12830500
128306             DP013-XCTL-DISPLAY-RESTART                           12830600
128310                                   TO TRUE                        12831000
128311         PERFORM DP013-0000-PROCESS-ABEND                         12831100
128312     END-IF.                                                      12831200
128313                                                                  12831300
128315*----------------------------------------------------------------*12831500
128316* RETRIEVE DOOR ID DESCRIPTION FROM TCNDCDR TABLE                 12831600
128317*----------------------------------------------------------------*12831700
128318 4150-GET-DOOR-ID-DESC.                                           12831800
128319     EXEC SQL                                                     12831900
128320          SELECT DOOR_LOC_DESC                                    12832000
128321               , DOOR_ID                                          12832100
128330          INTO  :CNDCDR-DOOR-LOC-DESC                             12833000
128340               ,:CNDCDR-DOOR-ID                                   12834000
128350           FROM  TCNDCDR                                          12835000
128360          WHERE  OPER_UNT_ID  =  :SUOBTS-STAT-OPER-UNT-ID         12836000
128370            AND  DOOR_ID      =  :SUOBTS-DOOR-ID                  12837000
128380     END-EXEC                                                     12838000
128390     EVALUATE TRUE                                                12839000
128400         WHEN SQLCODE = ZERO                                      12840000
128500             CONTINUE                                             12850000
128600         WHEN SQLCODE = +100                                      12860000
128700             MOVE SPACES TO ASC-DOOR-SLOT-DESC                    12870000
128800             MOVE ZERO   TO SQLCODE                               12880000
128900         WHEN SQLWARN0 NOT = SPACE                                12890000
129000         WHEN SQLCODE NOT = ZERO                                  12900000
129100              MOVE '4150-GET-DOOR-ID-DESC' TO DP013-PARAGRAPH     12910000
129200              MOVE 'GET DOOR ID DESCRIPTION'                      12920000
129300                               TO DP013-MESSAGE-TEXT (1)          12930000
129400              MOVE SQLCA       TO DP013-SQLCA                     12940000
129500              MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)       12950000
129600              SET DP013-DB2-ABEND TO TRUE                         12960000
129700              PERFORM DP013-0000-PROCESS-ABEND                    12970000
129800     END-EVALUATE.                                                12980000
129900                                                                  12990000
130000                                                                  13000000
130100*----------------------------------------------------------------*13010000
130200* CHECK TO SEE IF TRIP HAS END-DIVERT SET                         13020000
130300*----------------------------------------------------------------*13030000
130400 4160-CHECK-END-DIVERT.                                           13040000
130500     MOVE ASC-TRIP-ID                TO DK-TRIP-ID                13050000
130600                                        SUOBTS-OTBND-TRIP-ID.     13060045
130700     EXEC SQL                                                     13070000
130800          SELECT END_DIVERT_TMST                                  13080000
130900          INTO  :PV-END-TMST                                      13090000
131000           FROM  TSUCDOT                                          13100000
131100          WHERE  OTBND_TRIP_ID    = :DK-TRIP-ID                   13110000
131110            AND  END_DIVERT_TMST  = :PV-DEFAULT-TMST              13111000
131111     END-EXEC                                                     13111100
131112     EVALUATE TRUE                                                13111200
131113         WHEN SQLCODE = ZERO                                      13111300
131114         WHEN SQLCODE = -811                                      13111400
131115             PERFORM 4165-DELETE-END-DIVERT                       13111500
131116             PERFORM 8300-LINK-SUKCS574                           13111600
131117             PERFORM 4300-GET-COST-RETAIL                         13111700
131118             MOVE SUT00007-RTL-DOL-AMT  TO ASC-RETAIL             13111800
131119             MOVE SUT00007-COST-DOL-AMT TO ASC-COST               13111900
131120             MOVE SUT00007-CART-QTY     TO ASC-CARTON-COUNT       13112000
131121             MOVE SUT00007-UNT-QTY      TO ASC-UNIT-COUNT         13112100
131131         WHEN SQLCODE = +100                                      13113100
131132             CONTINUE                                             13113200
131133         WHEN SQLWARN0 NOT = SPACE                                13113300
131134         WHEN SQLCODE NOT = ZERO                                  13113400
131135              MOVE '4160-CHECK-END-DIVERT' TO DP013-PARAGRAPH     13113500
131136              MOVE 'CHECK FOR END DIVERT   '                      13113600
131137                                TO DP013-MESSAGE-TEXT (1)         13113700
131138              MOVE SQLCA        TO DP013-SQLCA                    13113800
131140              MOVE DK-TRIP-ID   TO PV-TRIP-ID                     13114000
131141              MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)         13114100
131142              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)       13114200
131143              SET DP013-DB2-ABEND TO TRUE                         13114300
131144              PERFORM DP013-0000-PROCESS-ABEND                    13114400
131145     END-EVALUATE.                                                13114500
131146                                                                  13114600
131147                                                                  13114700
131148 4165-DELETE-END-DIVERT.                                          13114800
131149                                                                  13114900
131152      EXEC SQL                                                    13115200
131153         DELETE                                                   13115300
131154             FROM  TSUCDOT                                        13115400
131156            WHERE  OTBND_TRIP_ID    = :DK-TRIP-ID                 13115600
131157              AND  END_DIVERT_TMST  = :PV-DEFAULT-TMST            13115700
131161      END-EXEC                                                    13116100
131162                                                                  13116200
131163     EVALUATE TRUE                                                13116300
131169         WHEN SQLCODE = ZERO                                      13116900
131170         WHEN SQLCODE = -904                                      13117000
131171         WHEN SQLCODE = -911                                      13117100
131172         WHEN SQLCODE = -913                                      13117200
131173             CONTINUE                                             13117300
131174                                                                  13117400
131175         WHEN SQLCODE = +100                                      13117500
131176         WHEN SQLCODE < ZERO                                      13117600
131177              MOVE '4165-DELETE-END-DIVERT' TO DP013-PARAGRAPH    13117700
131178              MOVE 'DELETE THE END DIVERT   '                     13117800
131179                                TO DP013-MESSAGE-TEXT (1)         13117900
131180              MOVE SQLCA        TO DP013-SQLCA                    13118000
131181              MOVE DK-TRIP-ID   TO PV-TRIP-ID                     13118100
131182              MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)         13118200
131183              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)       13118300
131184              SET DP013-DB2-ABEND TO TRUE                         13118400
131185              PERFORM DP013-0000-PROCESS-ABEND                    13118500
131193     END-EVALUATE.                                                13119300
131194                                                                  13119427
131195                                                                  13119533
131196*----------------------------------------------------------------*13119633
131197* CHECK TO SEE IF THE SEAL WAS PREVIOUSLY USED ON ANOTHER TRAILER*13119733
131198* DMH 10/6/17                                                    *13119833
131199*----------------------------------------------------------------*13119933
131200 4170-CHECK-SEAL-PREV-USED.                                       13120033
131201                                                                  13120127
131202     MOVE ASC-TRAILER-SEAL-NBR  TO  DK-SEAL-ID-CHECK.             13120233
131203     MOVE ASC-TRIP-ID           TO  DK-TRIP-ID.                   13120344
131204                                                                  13120444
131205     EXEC SQL                                                     13120544
131206          SELECT  OTBND_TRIP_ID                                   13120644
131207               ,  STAT_OPER_UNT_ID                                13120744
131208            INTO :PV-OTBND-TRIP-ID                                13120844
131209               , :PV-DC-OPER                                      13120944
131210            FROM  TSUOBTS                                         13121044
131211           WHERE  TRLR_SEAL_ID   =  :DK-SEAL-ID-CHECK             13121144
131212             AND  TRIP_STAT_CDE IN ('DS','DC')                    13121244
131213             AND  NOT OTBND_TRIP_ID  =  :DK-TRIP-ID               13121344
131214           FETCH FIRST 1 ROW ONLY                                 13121444
131215     END-EXEC.                                                    13121544
131216                                                                  13121644
131217     EVALUATE TRUE                                                13121744
131218         WHEN SQLCODE = ZERO                                      13121844
131219              SET PS-ERROR              TO TRUE                   13121934
131220              SET DP020-MSG-FATAL       TO TRUE                   13122034
131221              MOVE PV-OTBND-TRIP-ID     TO PV-DISP-TRIP           13122134
131222              MOVE PV-DC-OPER           TO PV-DISP-OPER           13122241
131224              STRING PV-DISP-OPER '-'                             13122441
131225                     PV-DISP-TRIP          DELIMITED BY SIZE      13122542
131226                                      INTO DP020-MSG-TEXT         13122642
131227              MOVE PC-TSYMSG-03800      TO DP020-MSG-NUMBER       13122742
131228              MOVE DP015-UNP-ALP-BRT-OFF                          13122842
131229                                        TO ASEALA                 13122942
131230              MOVE DP015-RED            TO ASEALC                 13123042
131231              MOVE DP015-REVERSE        TO ASEALH                 13123142
131232              MOVE -1                   TO ASEALL                 13123242
131233              SET DP030-SET-CURSOR-APPL-1                         13123342
131234                                        TO TRUE                   13123442
131235                                                                  13123542
131236         WHEN SQLCODE = +100                                      13123642
131237              CONTINUE                                            13123742
131238         WHEN SQLWARN0 NOT = SPACE                                13123842
131239         WHEN SQLCODE NOT = ZERO                                  13123942
131240              MOVE '4170-CHECK-SEAL-PREV-USED'                    13124042
131241                                         TO   DP013-PARAGRAPH     13124142
131242              MOVE 'CHECK IF SEAL WAS PREVIOUSLY USED'            13124242
131243                               TO DP013-MESSAGE-TEXT (1)          13124342
131244              MOVE DK-SEAL-ID-CHECK                               13124442
131245                               TO DP013-MESSAGE-TEXT (2)          13124542
131246              MOVE SQLCA       TO DP013-SQLCA                     13124642
131247              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (1)       13124742
131248              SET DP013-DB2-ABEND TO TRUE                         13124842
131249              PERFORM DP013-0000-PROCESS-ABEND                    13124942
131250     END-EVALUATE.                                                13125042
131251                                                                  13125142
131252                                                                  13125242
131258*----------------------------------------------------------------*13125834
131259* CALCULATE STORE SCAN COUNTS                                    *13125934
131260* DMH 8/17                                                       *13126034
131261*----------------------------------------------------------------*13126134
131262 4200-GET-STORE-SCAN-COUNTS.                                      13126234
131263     PERFORM 4210-STORE-SCAN.                                     13126334
131264     PERFORM 4220-STORE-SCAN-FROM.                                13126434
131265     PERFORM 4230-STORE-SCAN-ONTO.                                13126534
131266     PERFORM 4240-STORE-SCAN-ASSUME.                              13126634
131267                                                                  13126734
131268                                                                  13126834
131269*----------------------------------------------------------------*13126934
131270* CALCULATE STORE SCAN COUNTS                                    *13127034
131271* LOOKING TO ONLY GET WHAT WOULD BE A TRUE COUNT OF VALID        *13127134
131272* CARTON SCANS.  THIS MEANS WE WILL NOT BE INCLUDING THE         *13127234
131273* FOLLOWING:                                                     *13127334
131274* SSAM - ASSUMPTIVE MISLOADS (GENERATED BY JOB SUK041)           *13127434
131275* SSAR - ASSUMPTIVE RECEIPTS (GENERATED BY JOB SUK041)           *13127534
131276* SSAU - LOGGED AFTER STORE UNLOAD (MEMO ONLY TYPE ENTRIES)      *13127634
131277* SSMS - MULTIPLE OCCURRENCES OF A CARTON SCAN                   *13127734
131278* DMH 8/17                                                       *13127834
131279*----------------------------------------------------------------*13127934
131280 4210-STORE-SCAN.                                                 13128034
131281*                                                                 13128134
131282     MOVE ZEROES  TO  PV-STORE-SCAN-COUNT.                        13128234
131283*                                                                 13128334
131284     EXEC SQL                                                     13128434
131290          SELECT  COUNT(*)                                        13129033
131350            INTO :PV-STORE-SCAN-COUNT                             13135027
131480            FROM  SUT_OTBND_STR_SCN                               13148027
131494           WHERE  SCN_OTBND_TRIP_ID         =  :DK-TRIP-ID        13149428
131495             AND  NOT SCN_TYP_CDE           IN                    13149531
131496                  ('SSAR','SSAM','SSMS','SSAU')                   13149631
131497            WITH UR                                               13149727
131540     END-EXEC.                                                    13154027
131550                                                                  13155027
131560     EVALUATE TRUE                                                13156027
131570         WHEN SQLCODE = ZERO                                      13157027
131571         WHEN SQLCODE = +100                                      13157127
131580              MOVE PV-STORE-SCAN-COUNT  TO  ASC-STR-SCAN-CNT      13158027
131640         WHEN SQLCODE = -904                                      13164027
131650         WHEN SQLCODE = -913                                      13165027
131660              CONTINUE                                            13166027
131670         WHEN SQLWARN0 NOT = SPACES                               13167027
131680         WHEN SQLCODE < ZERO                                      13168027
131690         WHEN SQLCODE > ZERO                                      13169027
131691              MOVE '4210-STORE-SCAN'                              13169127
131692                                   TO DP013-PARAGRAPH             13169227
131693              MOVE 'COUNT NUMBER OF CARTONS SCANNED BY STORE'     13169327
131694                                   TO DP013-MESSAGE-TEXT (1)      13169427
131695              MOVE DK-TRIP-ID      TO PV-TRIP-ID                  13169527
131696              MOVE PV-TRIP-ID      TO DP013-MESSAGE-TEXT (2)      13169627
131697              MOVE SQLCA           TO DP013-SQLCA                 13169727
131698              MOVE 'SUT00121'      TO DP013-DB2-TABLE-NAME (1)    13169827
131730              SET DP013-DB2-ABEND                                 13173027
131740                  DP013-XCTL-DISPLAY-RESTART                      13174027
131750                                   TO TRUE                        13175027
131760              PERFORM DP013-0000-PROCESS-ABEND                    13176027
131770     END-EVALUATE.                                                13177027
131800                                                                  13180027
132800                                                                  13280000
132810*----------------------------------------------------------------*13281027
132820* CALCULATE STORE SCAN COUNTS, WHERE CARTON WAS MANIFESTED TO    *13282027
132821* A DIFFERENT TRAILER, BUT RECEIVED ON CURRENT TRAILER           *13282127
132830* DMH 8/17                                                       *13283027
132840*----------------------------------------------------------------*13284027
132850 4220-STORE-SCAN-FROM.                                            13285027
132860*                                                                 13286027
132870     MOVE ZEROES  TO  PV-STORE-SCAN-COUNT.                        13287027
132880*                                                                 13288027
132890     EXEC SQL                                                     13289027
132891          SELECT  COUNT(*)                                        13289127
132892            INTO :PV-STORE-SCAN-COUNT                             13289227
132893            FROM  SUT_OTBND_STR_SCN                               13289327
132894           WHERE  SCN_OTBND_TRIP_ID      =  :DK-TRIP-ID           13289428
132895            AND SCN_TYP_CDE              = 'SSTM'                 13289527
132896            WITH UR                                               13289627
132897     END-EXEC.                                                    13289727
132898                                                                  13289827
132899     EVALUATE TRUE                                                13289927
132900         WHEN SQLCODE = ZERO                                      13290027
132901         WHEN SQLCODE = +100                                      13290127
132902              MOVE PV-STORE-SCAN-COUNT TO ASC-STR-SCAN-FROM-DIFF  13290227
132903         WHEN SQLCODE = -904                                      13290327
132904         WHEN SQLCODE = -913                                      13290427
132905              CONTINUE                                            13290527
132906         WHEN SQLWARN0 NOT = SPACES                               13290627
132907         WHEN SQLCODE < ZERO                                      13290727
132908         WHEN SQLCODE > ZERO                                      13290827
132909              MOVE '4220-STORE-SCAN-FROM'                         13290927
132910                                   TO DP013-PARAGRAPH             13291027
132911              MOVE 'CNT NBR OF CTRNS FROM DIFFERENT TRAILER '     13291127
132912                                   TO DP013-MESSAGE-TEXT (1)      13291227
132913              MOVE DK-TRIP-ID      TO PV-TRIP-ID                  13291327
132914              MOVE PV-TRIP-ID      TO DP013-MESSAGE-TEXT (2)      13291427
132915              MOVE SQLCA           TO DP013-SQLCA                 13291527
132916              MOVE 'SUT00121'      TO DP013-DB2-TABLE-NAME (1)    13291627
132917              SET DP013-DB2-ABEND                                 13291727
132918                  DP013-XCTL-DISPLAY-RESTART                      13291827
132919                                   TO TRUE                        13291927
132920              PERFORM DP013-0000-PROCESS-ABEND                    13292027
132921     END-EVALUATE.                                                13292127
132922                                                                  13292227
132923                                                                  13292327
132924*----------------------------------------------------------------*13292427
132925* CALCULATE STORE SCAN COUNTS, WHERE CARTON WAS MANIFESTED TO    *13292527
132926* CURRENT TRAILER, BUT WERE SCANNED ONTO A DIFFERENT TRAILER     *13292627
132927* DMH 8/17                                                       *13292727
132928*----------------------------------------------------------------*13292827
132929 4230-STORE-SCAN-ONTO.                                            13292927
132930*                                                                 13293027
132931     MOVE ZEROES  TO  PV-STORE-SCAN-COUNT.                        13293127
132932*                                                                 13293227
132933     EXEC SQL                                                     13293327
132934          SELECT  COUNT(*)                                        13293427
132935            INTO :PV-STORE-SCAN-COUNT                             13293527
132936            FROM  SUT_OTBND_STR_SCN                               13293627
132937           WHERE  ORIG_OTBND_TRIP_ID     =  :DK-TRIP-ID           13293727
132938            AND SCN_TYP_CDE              = 'SSTM'                 13293827
132939            WITH UR                                               13293927
132940     END-EXEC.                                                    13294027
132941                                                                  13294127
132942     EVALUATE TRUE                                                13294227
132943         WHEN SQLCODE = ZERO                                      13294327
132944         WHEN SQLCODE = +100                                      13294427
132945              MOVE PV-STORE-SCAN-COUNT TO ASC-STR-SCAN-ONTO-DIFF  13294527
132947         WHEN SQLCODE = -904                                      13294727
132948         WHEN SQLCODE = -913                                      13294827
132949              CONTINUE                                            13294927
132950         WHEN SQLWARN0 NOT = SPACES                               13295027
132951         WHEN SQLCODE < ZERO                                      13295127
132952         WHEN SQLCODE > ZERO                                      13295227
132953              MOVE '4230-STORE-SCAN-ONTO'                         13295327
132954                                   TO DP013-PARAGRAPH             13295427
132955              MOVE 'CNT NBR OF CTRNS WENT TO DIFF TRLR      '     13295527
132956                                   TO DP013-MESSAGE-TEXT (1)      13295627
132957              MOVE DK-TRIP-ID      TO PV-TRIP-ID                  13295727
132958              MOVE PV-TRIP-ID      TO DP013-MESSAGE-TEXT (2)      13295827
132959              MOVE SQLCA           TO DP013-SQLCA                 13295927
132960              MOVE 'SUT00121'      TO DP013-DB2-TABLE-NAME (1)    13296027
132961              SET DP013-DB2-ABEND                                 13296127
132962                  DP013-XCTL-DISPLAY-RESTART                      13296227
132963                                   TO TRUE                        13296327
132964              PERFORM DP013-0000-PROCESS-ABEND                    13296427
132965     END-EVALUATE.                                                13296527
132966                                                                  13296627
132967                                                                  13296727
132968*----------------------------------------------------------------*13296827
132969* CALCULATE STORE SCAN COUNTS, WHERE CARTON WAS ASSUMED TO HAVE  *13296927
132970* ARRIVED ON THE TRAILER (XDAYS AFTER TRAILER HAS BEEN UNLOADED) *13297027
132971* DMH 8/17                                                       *13297127
132972*----------------------------------------------------------------*13297227
132973 4240-STORE-SCAN-ASSUME.                                          13297327
132974*                                                                 13297427
132975     MOVE ZEROES  TO  PV-STORE-SCAN-COUNT.                        13297527
132976*                                                                 13297627
132977     EXEC SQL                                                     13297727
132978          SELECT  COUNT(*)                                        13297827
132979            INTO :PV-STORE-SCAN-COUNT                             13297927
132980            FROM  SUT_OTBND_STR_SCN                               13298027
132981           WHERE  SCN_OTBND_TRIP_ID     =  :DK-TRIP-ID            13298128
132982            AND SCN_TYP_CDE             IN ('SSAR','SSAM')        13298227
132983            WITH UR                                               13298327
132984     END-EXEC.                                                    13298427
132985                                                                  13298527
132986     EVALUATE TRUE                                                13298627
132987         WHEN SQLCODE = ZERO                                      13298727
132988         WHEN SQLCODE = +100                                      13298827
132989              MOVE PV-STORE-SCAN-COUNT TO ASC-STR-SCAN-ASSUME     13298927
132991         WHEN SQLCODE = -904                                      13299127
132992         WHEN SQLCODE = -913                                      13299227
132993              CONTINUE                                            13299327
132994         WHEN SQLWARN0 NOT = SPACES                               13299427
132995         WHEN SQLCODE < ZERO                                      13299527
132996         WHEN SQLCODE > ZERO                                      13299627
132997              MOVE '4230-STORE-SCAN-ONTO'                         13299727
132998                                   TO DP013-PARAGRAPH             13299827
132999              MOVE 'CNT NBR OF CTRNS WENT TO DIFF TRLR      '     13299927
133000                                   TO DP013-MESSAGE-TEXT (1)      13300027
133001              MOVE DK-TRIP-ID      TO PV-TRIP-ID                  13300127
133002              MOVE PV-TRIP-ID      TO DP013-MESSAGE-TEXT (2)      13300227
133003              MOVE SQLCA           TO DP013-SQLCA                 13300327
133004              MOVE 'SUT00121'      TO DP013-DB2-TABLE-NAME (1)    13300427
133005              SET DP013-DB2-ABEND                                 13300527
133006                  DP013-XCTL-DISPLAY-RESTART                      13300627
133007                                   TO TRUE                        13300727
133008              PERFORM DP013-0000-PROCESS-ABEND                    13300827
133009     END-EVALUATE.                                                13300927
133010                                                                  13301027
133011                                                                  13301127
133012*----------------------------------------------------------------*13301200
133020* SELECT THE RETAIL AND COST FOR THE TRIP                        *13302000
133100*----------------------------------------------------------------*13310000
133200 4300-GET-COST-RETAIL.                                            13320000
133300                                                                  13330000
133310     PERFORM 4310-GET-FUNC-QTY                                    13331000
133320                                                                  13332000
133400     INITIALIZE DCLSUT00007                                       13340000
133500                                                                  13350000
133600     PERFORM                                                      13360000
133700         WITH TEST AFTER                                          13370000
133800         VARYING PV-RETRY-COUNTER                                 13380000
133900         FROM 1 BY 1                                              13390000
134000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13400000
134100                   OR (SQLCODE = ZERO)                            13410000
134200                   OR (SQLCODE = +100))                           13420000
134300*                                                                 13430000
134400         EXEC SQL                                                 13440000
134500              SELECT  A.RTL_DOL_AMT                               13450000
134600                 ,    A.COST_DOL_AMT                              13460000
134700                 ,    A.CART_QTY                                  13470000
134800                 ,    A.UNT_QTY                                   13480000
135000              INTO    :SUT00007-RTL-DOL-AMT                       13500000
135100                ,     :SUT00007-COST-DOL-AMT                      13510000
135200                ,     :SUT00007-CART-QTY                          13520000
135300                ,     :SUT00007-UNT-QTY                           13530000
135500              FROM  SUT_TRIP_SUM A                                13550000
135600              WHERE  A.OTBND_TRIP_ID   = :DK-TRIP-ID              13560000
135700                AND  A.CRE_TMST  =                                13570000
135800                 (SELECT  MAX(B.CRE_TMST)                         13580000
135900                  FROM  SUT_TRIP_SUM B                            13590000
136000                  WHERE  B.OTBND_TRIP_ID   = A.OTBND_TRIP_ID)     13600000
136100         END-EXEC                                                 13610000
136200                                                                  13620000
136300         EVALUATE TRUE                                            13630000
136400             WHEN SQLCODE = ZERO                                  13640000
136500             WHEN SQLCODE = +100                                  13650000
136600             WHEN SQLCODE = -904                                  13660000
136700             WHEN SQLCODE = -913                                  13670000
136800                 CONTINUE                                         13680000
136900             WHEN SQLWARN0 NOT = SPACES                           13690000
137000             WHEN SQLCODE < ZERO                                  13700000
137100             WHEN SQLCODE > ZERO                                  13710000
137200                 MOVE '4300-GET-COST-RETAIL'                      13720000
137300                                   TO DP013-PARAGRAPH             13730000
137400                 MOVE 'SELECT COST AND RETAIL'                    13740000
137500                                   TO DP013-MESSAGE-TEXT (1)      13750000
137600                 MOVE DK-TRIP-ID   TO PV-TRIP-ID                  13760000
137700                 MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)      13770000
137800                 MOVE SQLCA        TO DP013-SQLCA                 13780000
137900                 MOVE 'SUT00007'   TO DP013-DB2-TABLE-NAME (1)    13790000
138000                 SET DP013-DB2-ABEND                              13800000
138100                     DP013-XCTL-DISPLAY-RESTART                   13810000
138200                                   TO TRUE                        13820000
138300                 PERFORM DP013-0000-PROCESS-ABEND                 13830000
138400         END-EVALUATE                                             13840000
138410         COMPUTE ASC-ESTIMATED-WEIGHT  = ( SUT00007-CART-QTY *    13841000
138420                                           KRPRPM-FUNC-QTY )      13842000
138500     END-PERFORM.                                                 13850000
138600*                                                                 13860000
138700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13870000
138800         MOVE '4300-GET-COST-RETAIL'                              13880000
138900                                   TO DP013-PARAGRAPH             13890000
139000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     13900000
139100                                   TO DP013-MESSAGE-TEXT (1)      13910000
139200         MOVE 'COST AND RETAIL'    TO DP013-MESSAGE-TEXT (2)      13920000
139300         MOVE SQLCA                TO DP013-SQLCA                 13930000
139400         MOVE 'SUT00007'           TO DP013-DB2-TABLE-NAME (1)    13940000
139500         SET DP013-DB2-ABEND                                      13950000
139600             DP013-XCTL-DISPLAY-RESTART                           13960000
139700                                   TO TRUE                        13970000
139800         PERFORM DP013-0000-PROCESS-ABEND                         13980000
139900     END-IF.                                                      13990000
139910*----------------------------------------------------------------*13991000
139920* SELECT THE FUNC QTY FROM TKRPRPM TABLE.                        *13992000
139930*----------------------------------------------------------------*13993000
139940 4310-GET-FUNC-QTY.                                               13994000
140000                                                                  14000000
140010         EXEC SQL                                                 14001000
140020              SELECT  FUNC_QTY                                    14002000
140070                INTO  :KRPRPM-FUNC-QTY                            14007000
140093                FROM  TKRPRPM                                     14009300
140094               WHERE  LOC_ID = 90                                 14009400
140095                 AND  INTFC_SYS_CDE = 'KHL'                       14009500
140096                 AND  SYS_PRC_FUNC_CDE = 'AVGWGT'                 14009600
140097         END-EXEC                                                 14009700
140098         EVALUATE TRUE                                            14009800
140099             WHEN SQLCODE = ZERO                                  14009900
140101             WHEN SQLCODE = -904                                  14010100
140102             WHEN SQLCODE = -913                                  14010200
140103                 CONTINUE                                         14010300
140104             WHEN SQLCODE = +100                                  14010400
140105             WHEN SQLWARN0 NOT = SPACES                           14010500
140106             WHEN SQLCODE < ZERO                                  14010600
140107             WHEN SQLCODE > ZERO                                  14010700
140108                 MOVE '4310-GET-FUNC-QTY'                         14010800
140109                                   TO DP013-PARAGRAPH             14010900
140110                 MOVE 'SELECT FUNC QUANTITY'                      14011000
140111                                   TO DP013-MESSAGE-TEXT (1)      14011100
140114                 MOVE SQLCA        TO DP013-SQLCA                 14011400
140115                 MOVE 'TKRPRPM'    TO DP013-DB2-TABLE-NAME (1)    14011500
140116                 SET DP013-DB2-ABEND                              14011600
140117                     DP013-XCTL-DISPLAY-RESTART                   14011700
140118                                   TO TRUE                        14011800
140119                 PERFORM DP013-0000-PROCESS-ABEND                 14011900
140120         END-EVALUATE.                                            14012000
140121*----------------------------------------------------------------*14012100
140130 4350-SELECT-FACILTY-DSC.                                         14013000
140200                                                                  14020000
140300     INITIALIZE XL071-COMMAREA-REC.                               14030000
140400     MOVE DK-OPER-UNT-ID     TO XL071-LOCATION-NUMBER.            14040000
140500                                                                  14050000
140600     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      14060000
140700                                    XL071-COMMAREA                14070000
140800                                    XL071-COMMAREA-REC.           14080000
140900                                                                  14090000
141000     IF XL071-NO-ERRORS                                           14100000
141100          CONTINUE                                                14110000
141200     ELSE                                                         14120000
141210         IF XL071-BAD-DB2-RETURN                                  14121000
141220              MOVE '4350-SELECT-FACILTY-DSC'    TO DP013-PARAGRAPH14122000
141230              MOVE 'SELECT FACILITY NME' TO DP013-MESSAGE-TEXT (1)14123000
141240              MOVE DK-OPER-UNT-ID  TO PV-OPER-UNIT-ID             14124000
141250              MOVE PV-OPER-UNIT-ID TO DP013-MESSAGE-TEXT (2)      14125000
141260              MOVE SQLCA           TO DP013-SQLCA                 14126000
141270              MOVE 'XLT_LOC '      TO DP013-DB2-TABLE-NAME (1)    14127000
141280              SET DP013-DB2-ABEND                                 14128000
141290                  DP013-XCTL-DISPLAY-RESTART  TO TRUE             14129000
141300              PERFORM DP013-0000-PROCESS-ABEND                    14130000
141301         END-IF                                                   14130100
141302     END-IF.                                                      14130200
141303                                                                  14130300
141304*----------------------------------------------------------------*14130400
141305*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *14130500
141306*----------------------------------------------------------------*14130600
141307                                                                  14130700
141308 4400-MOVE-COMMAREA-TO-SCREEN.                                    14130800
141309     MOVE ASC-TRLR-SRL-NBR         TO ATRLNBRO.                   14130900
141310     EVALUATE TRUE                                                14131000
141320         WHEN ASC-DOOR-TYP-CDE = 'SH'                             14132000
141330             MOVE 'SHIPPING TRLR'          TO ATRLSTAO            14133000
141340         WHEN ASC-DOOR-TYP-CDE = 'RC'                             14134000
141350             MOVE 'RECEIVING TRLR'         TO ATRLSTAO            14135000
141360         WHEN ASC-DOOR-TYP-CDE = 'DS'                             14136000
141370             MOVE 'SHUTTLE TRLR'           TO ATRLSTAO            14137000
141380         WHEN ASC-DOOR-TYP-CDE = 'ST'                             14138000
141390             MOVE 'STORAGE TRLR'           TO ATRLSTAO            14139000
141400         WHEN ASC-DOOR-TYP-CDE = 'SG'                             14140000
141500             MOVE 'STRIPPING TRLR'         TO ATRLSTAO            14150000
141600         WHEN OTHER                                               14160000
141700             MOVE SPACES                   TO ATRLSTAO            14170000
141800     END-EVALUATE.                                                14180000
141900     MOVE ASC-SCAC                 TO ASCACO.                     14190000
142000     MOVE ASC-TRAILER-ID           TO ATRLIDO.                    14200000
142100     MOVE ASC-TRIP-ID              TO ATRIPO.                     14210000
142200     MOVE ASC-TRIP-STATUS          TO ATRIPSTO.                   14220000
142300     MOVE ASC-TRIP-STATUS-DATE     TO ASTATDTO.                   14230000
142400     MOVE ASC-DOOR-SLOT            TO ADORSLTO.                   14240000
142500     MOVE ASC-DOOR-SLOT-DESC       TO ADORDSCO.                   14250000
142600     MOVE ASC-DESTINATION-ID       TO ADESTIDO.                   14260000
142700     MOVE ASC-DESTINATION-DESC     TO ADDESCO.                    14270000
142800     MOVE ASC-CARTON-COUNT         TO ACOUNTO                     14280000
142900     MOVE ASC-UNIT-COUNT           TO AUCOUNTO                    14290000
143000     MOVE ASC-ESTIMATED-WEIGHT     TO AWEIGHTO                    14300000
143100     MOVE ASC-RETAIL               TO PV-DISP-RETAIL              14310000
143200     MOVE PV-DISP-RETAIL           TO ARETAILO                    14320000
143300     MOVE ASC-COST                 TO PV-DISP-COST                14330000
143400     MOVE PV-DISP-COST             TO ACOSTO                      14340000
143500     MOVE ASC-PALLETS              TO APALLETO                    14350000
143600     MOVE ASC-TRAILER-SEAL-NBR     TO ASEALO.                     14360000
143700     MOVE ASC-SHIP-SCAC-CODE       TO ASSCACO.                    14370000
143800     MOVE ASC-DRIVER-FIRST-NAME    TO AFNAMEO.                    14380000
143900     MOVE ASC-DRIVER-LAST-NAME     TO ALNAMEO.                    14390000
144000     MOVE ASC-DRIVER-ID            TO ADRIVIDO.                   14400000
144010*** PK 11/25/13 HAZ SUMRY RPT BEGIN                               14401002
144020*IT POPULATES THE HAZ REPORT STATUS AND DFLT DEST PRINTER ID      14402002
144030     IF ASC-HAZ-FACILITY-YES                                      14403002
144040       EVALUATE TRUE                                              14404002
144050         WHEN ASC-HAZ-EXCPT-SKU                                   14405002
144060              MOVE 'SKU EXCPTN'    TO AHAZSTAO                    14406002
144070              MOVE DP015-YELLOW    TO AHAZSTAC                    14407002
144080         WHEN ASC-HAZ-EXCPT-WGT                                   14408002
144090              MOVE 'WGT EXCPTN'    TO AHAZSTAO                    14409002
144091              MOVE DP015-YELLOW    TO AHAZSTAC                    14409102
144092         WHEN ASC-HAZ-RPT-RQRD                                    14409202
144093              MOVE 'REQUIRED'      TO AHAZSTAO                    14409302
144094              MOVE DP015-YELLOW    TO AHAZSTAC                    14409402
144095         WHEN OTHER                                               14409502
144096              PERFORM 4640-CHK-TRIP-DTLS                          14409602
144097              IF ASC-HAZ-RPT-NOT-AVLBL                            14409702
144098                 MOVE 'NOT AVALBLE'   TO AHAZSTAO                 14409802
144099              ELSE                                                14409902
144100                 MOVE 'NOT REQUIRED' TO AHAZSTAO                  14410002
144101              END-IF                                              14410102
144102       END-EVALUATE                                               14410202
144103       IF PS-TRIP-EXCPT-SKU-Y                                     14410302
144104         MOVE 'SKU EXCPTN'    TO AHAZSTAO                         14410402
144105         MOVE DP015-YELLOW    TO AHAZSTAC                         14410502
144106       END-IF                                                     14410602
144107       IF PS-TRIP-EXCPT-WGT-Y                                     14410702
144108         MOVE 'WGT EXCPTN'    TO AHAZSTAO                         14410802
144109         MOVE DP015-YELLOW    TO AHAZSTAC                         14410902
144110       END-IF                                                     14411002
144111       MOVE ASC-DEST-PRINTR-ID       TO APRINIDO                  14411102
144112     ELSE                                                         14411202
144113       MOVE 'NOT AVALBLE'      TO AHAZSTAO                        14411307
144114       MOVE ASC-DEST-PRINTR-ID TO APRINIDO                        14411402
144115     END-IF.                                                      14411502
144116*** PK 11/25/13 HAZ SUMRY RPT END                                 14411602
144117                                                                  14411727
144118* DMH 8/17 BEGIN                                                  14411827
144119      MOVE  ASC-STR-SCAN-CNT         TO ASTR01O.                  14411927
144120      MOVE  ASC-STR-SCAN-FROM-DIFF   TO ASTR02O.                  14412027
144121      MOVE  ASC-STR-SCAN-ONTO-DIFF   TO ASTR03O.                  14412127
144122      MOVE  ASC-STR-SCAN-ASSUME      TO ASTR04O.                  14412227
144123* DMH 8/17 BEGIN                                                  14412327
144130                                                                  14413000
144200 4500-VALIDATE-STAT-CDE.                                          14420000
144300                                                                  14430000
144400     PERFORM 7220-GET-CURRENT-TRIP-STAT                           14440000
144500     MOVE ASC-TRIP-STAT-CDE          TO DK-CURR-STAT-CDE.         14450000
144600                                                                  14460000
144700     PERFORM                                                      14470000
144800         WITH TEST AFTER                                          14480000
144900         VARYING PV-RETRY-COUNTER                                 14490000
145000         FROM 1 BY 1                                              14500000
145100         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES                14510000
145200            OR   SQLCODE = +0                                     14520000
145300            OR   SQLCODE = +100)                                  14530000
145400                                                                  14540000
145500         EXEC SQL                                                 14550000
145600            SELECT CURR_TRIP_STAT_CDE                             14560000
145700              INTO :SUT00005-CURR-TRIP-STAT-CDE                   14570000
145800              FROM SUT_STAT_ASSN                                  14580000
145900             WHERE CURR_TRIP_STAT_CDE  = :DK-CURR-STAT-CDE        14590000
146000               AND NEXT_TRIP_STAT_CDE  = :DK-NEXT-STAT-CDE        14600000
146100         END-EXEC                                                 14610000
146200                                                                  14620000
146300         EVALUATE TRUE                                            14630000
146400             WHEN SQLCODE = -904                                  14640000
146500             WHEN SQLCODE = -913                                  14650000
146600             WHEN SQLCODE = +0                                    14660000
146700                 SET PS-VALID-STATUS-CHANGE TO TRUE               14670000
146800             WHEN SQLCODE = +100                                  14680000
146900                 SET PS-NOT-VALID-STATUS-CHANGE TO TRUE           14690000
147000             WHEN SQLCODE < +0                                    14700000
147100             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     14710000
147200             WHEN SQLWARN0 NOT = SPACES                           14720000
147300                  MOVE '4500-VALIDATE-STAT-CDE'                   14730000
147400                                   TO DP013-PARAGRAPH             14740000
147500                  MOVE 'SELECT STATUS ASSN'                       14750000
147600                                   TO DP013-MESSAGE-TEXT (1)      14760000
147700                  MOVE DK-CURR-STAT-CDE TO DP013-MESSAGE-TEXT (2) 14770000
147800                  MOVE DK-NEXT-STAT-CDE TO DP013-MESSAGE-TEXT (3) 14780000
147900                  MOVE SQLCA       TO DP013-SQLCA                 14790000
148000                  MOVE 'SUT00005'  TO DP013-DB2-TABLE-NAME (1)    14800000
148100                  SET DP013-DB2-ABEND                             14810000
148200                      DP013-XCTL-DISPLAY-RESTART                  14820000
148300                                   TO TRUE                        14830000
148400                  PERFORM DP013-0000-PROCESS-ABEND                14840000
148500         END-EVALUATE                                             14850000
148600     END-PERFORM.                                                 14860000
148700                                                                  14870000
148800     IF  PV-RETRY-COUNTER GREATER THAN PC-MAX-RETRIES             14880000
148900         MOVE '4500-VALIDATE-STAT-CDE'                            14890000
149000                               TO  DP013-PARAGRAPH                14900000
149100         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   14910000
149200                               TO  DP013-MESSAGE-TEXT (1)         14920000
149300         MOVE 'OF STATUS ASSN                 '                   14930000
149400                               TO  DP013-MESSAGE-TEXT (2)         14940000
149500         MOVE SQLCA            TO  DP013-SQLCA                    14950000
149600         MOVE 'SUT00005'       TO DP013-DB2-TABLE-NAME (1)        14960000
149700         SET DP013-DB2-ABEND                                      14970000
149800             DP013-XCTL-DISPLAY-RESTART                           14980000
149900                               TO  TRUE                           14990000
150000         PERFORM DP013-0000-PROCESS-ABEND                         15000000
150100     END-IF.                                                      15010000
150200                                                                  15020000
150210*** PK 11/25/13 HAZMAT SUMMARY BEGIN                              15021002
150220*------------------------------------------------------------     15022002
150230*          CHECKS THE HAZ SUMMARY REPORT STATUS                   15023002
150240*------------------------------------------------------------     15024002
150250 4600-CHK-HAZSMRY-STAT.                                           15025002
150260         MOVE ASC-TRIP-ID  TO  DK-TRIP-ID                         15026002
150270         EXEC SQL                                                 15027002
150280           OPEN TRIP-HAZ-INFO                                     15028002
150290         END-EXEC.                                                15029002
150291                                                                  15029102
150292         EVALUATE TRUE                                            15029202
150293             WHEN SQLCODE = ZERO                                  15029302
150294                  PERFORM 4610-FTCH-HAZ-SUMRY UNTIL PS-HAZCUR-END 15029402
150295                  PERFORM 4630-CLOSE-HAZ-CSR                      15029502
150296             WHEN SQLCODE = -904                                  15029602
150297             WHEN SQLCODE = -913                                  15029702
150298                  CONTINUE                                        15029802
150299             WHEN SQLWARN0 NOT = SPACES                           15029902
150300             WHEN SQLCODE < ZERO                                  15030002
150301             WHEN SQLCODE > ZERO                                  15030102
150302                 MOVE '4600-CHK-HAZSMRY-STAT'                     15030202
150303                                   TO DP013-PARAGRAPH             15030302
150304                 MOVE 'FETCH HAZMAT SUMMARY DTLS FOR A TRIP'      15030402
150305                                   TO DP013-MESSAGE-TEXT(1)       15030502
150306                 MOVE SQLCA        TO DP013-SQLCA                 15030602
150307                 MOVE 'SUT_TRIP_SUM' TO DP013-DB2-TABLE-NAME (1)  15030702
150308                 MOVE 'SUT_TRIP_DTL_SUM' TO                       15030802
150309                                       DP013-DB2-TABLE-NAME (2)   15030902
150310                 MOVE 'XLT_HAZDS_MTRL_SKU' TO                     15031002
150311                                       DP013-DB2-TABLE-NAME (3)   15031102
150312                 SET DP013-DB2-ABEND                              15031202
150313                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15031302
150314                 PERFORM DP013-0000-PROCESS-ABEND                 15031402
150315         END-EVALUATE.                                            15031502
150316                                                                  15031602
150317*------------------------------------------------------------     15031708
150318*          FETCHES THE HAZ SUMMARY CURSOR                         15031806
150319*------------------------------------------------------------     15031906
150320 4610-FTCH-HAZ-SUMRY.                                             15032002
150321         EXEC SQL                                                 15032102
150322           FETCH TRIP-HAZ-INFO                                    15032202
150323           INTO :PV-SYS-TRLG-CDE                                  15032302
150324              , :PV-HAZ-SKU-NBR                                   15032402
150325              , :PV-TOT-SKU-CNT   :PV-NULL-IND-1                  15032502
150326              , :PV-SKU-TOT-WGT   :PV-NULL-IND-2                  15032602
150327              , :PV-SKU-UOM       :PV-NULL-IND-3                  15032702
150328         END-EXEC.                                                15032802
150329                                                                  15032902
150330         EVALUATE TRUE                                            15033002
150331             WHEN SQLCODE = ZERO                                  15033102
150332                  IF PV-NULL-IND-1 = -1                           15033202
150333                     MOVE ZEROES TO PV-TOT-SKU-CNT                15033302
150334                  END-IF                                          15033402
150335                  IF PV-NULL-IND-2 = -1                           15033502
150336                     MOVE ZEROES TO PV-SKU-TOT-WGT                15033602
150337                  END-IF                                          15033702
150338                  IF PV-NULL-IND-3 = -1                           15033802
150339                     MOVE SPACES TO PV-SKU-UOM                    15033902
150340                  END-IF                                          15034002
150341                  PERFORM 4620-PRCS-HAZ-SUMRY                     15034102
150342             WHEN SQLCODE = +100                                  15034202
150343                  SET PS-HAZCUR-END  TO TRUE                      15034302
150344             WHEN SQLCODE = -904                                  15034402
150345             WHEN SQLCODE = -913                                  15034502
150346                 CONTINUE                                         15034602
150347             WHEN SQLWARN0 NOT = SPACES                           15034702
150348             WHEN SQLCODE < ZERO                                  15034802
150349             WHEN SQLCODE > ZERO                                  15034902
150350                 MOVE '4620-FTCH-HAZ-SUMRY'                       15035002
150351                                   TO DP013-PARAGRAPH             15035102
150352                 MOVE 'FECTH HAZMAT SUMMARY FOR A TRIP'           15035202
150353                                   TO DP013-MESSAGE-TEXT(1)       15035302
150354                 MOVE SQLCA        TO DP013-SQLCA                 15035402
150355                 MOVE 'SUT_TRIP_SUM' TO DP013-DB2-TABLE-NAME (1)  15035502
150356                 MOVE 'SUT_TRIP_DTL_SUM' TO                       15035602
150357                                       DP013-DB2-TABLE-NAME (2)   15035702
150358                 MOVE 'XLT_HAZDS_MTRL_SKU' TO                     15035802
150359                                       DP013-DB2-TABLE-NAME (3)   15035902
150360                 SET DP013-DB2-ABEND                              15036002
150361                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15036102
150362                 PERFORM DP013-0000-PROCESS-ABEND                 15036202
150363         END-EVALUATE.                                            15036302
150364                                                                  15036402
150365*------------------------------------------------------------     15036506
150366* CALCULATING THE STATUS OF THE TRAILER FOR HAZ REPORT            15036606
150367*------------------------------------------------------------     15036706
150368 4620-PRCS-HAZ-SUMRY.                                             15036802
150369                                                                  15036902
150370       IF PV-SYS-TRLG-CDE >= ASC-HGH-SYS-TRL-CDE                  15037002
150371          SET ASC-HAZ-EXCPT-SKU   TO TRUE                         15037102
150372          SET PS-TRIP-EXCPT-SKU-Y TO TRUE                         15037202
150373       ELSE IF PV-SYS-TRLG-CDE <  ASC-HGH-SYS-TRL-CDE AND         15037302
150374               PV-SYS-TRLG-CDE >= ASC-LOW-SYS-TRL-CDE             15037402
150375               SET  ASC-HAZ-RPT-RQRD TO TRUE                      15037502
150376       END-IF                                                     15037602
150377       END-IF                                                     15037702
150378       PERFORM 4625-SKU-CRIT-WGT                                  15037802
150379       MOVE PV-SKU-UOM TO PV-SKU-UOM-GRP                          15037902
150380       EVALUATE PV-SKU-UOM-CMP                                    15038002
150381          WHEN 'OZ'                                               15038102
150382             DIVIDE  PV-SKU-TOT-WGT BY 16                         15038202
150383                     GIVING PV-SKU-TOT-WGT-CMP                    15038302
150384          WHEN 'KG'                                               15038402
150385             COMPUTE PV-SKU-TOT-WGT-CMP = PV-SKU-TOT-WGT * 2.2046215038502
150386          WHEN OTHER                                              15038602
150387             MOVE PV-SKU-TOT-WGT TO PV-SKU-TOT-WGT-CMP            15038702
150388       END-EVALUATE                                               15038802
150389                                                                  15038902
150390       IF PV-SKU-TOT-WGT-CMP  > PV-CRIT-SKU-WGT AND               15039002
150391          PV-SYS-TRLG-CDE >= ASC-LOW-SYS-TRL-CDE                  15039102
150392               SET ASC-HAZ-EXCPT-WGT TO TRUE                      15039202
150393               SET PS-TRIP-EXCPT-WGT-Y TO TRUE                    15039302
150394       END-IF.                                                    15039402
150395*--------------------------------------------------------------*  15039502
150396*    FETCHES THE MAXIMUM ALLOWED WEIGHT OF THIS SKU WHICH CAN BE  15039602
150397*                      CARRIED IN THE TRAILER                     15039702
150398*--------------------------------------------------------------*  15039802
150399 4625-SKU-CRIT-WGT.                                               15039902
150400      EXEC SQL                                                    15040002
150401      SELECT                                                      15040102
150402             D.ATTR_ELEM_NBR                                      15040202
150403      INTO                                                        15040302
150404            :PV-CRIT-SKU-WGT :PV-NULL-IND-4                       15040402
150405      FROM                                                        15040502
150406            WST_INTGRTN_TYP  A                                    15040602
150407         ,  WST_ATTR_DEFN    B                                    15040702
150408         ,  WST_ATTR_ELEM    C                                    15040802
150409         ,  WST_ATTR_ELEM    D                                    15040902
150410      WHERE                                                       15041002
150411            A.INTGRTN_TYP_CDE   = 'HZCRITWT'                      15041102
150412        AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE               15041202
150413        AND B.ATTR_DEFN_SEQ_NBR = 1                               15041302
150414        AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE               15041402
150415        AND C.ATTR_DEFN_SEQ_NBR = 1                               15041502
150416        AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE               15041602
150417        AND D.ATTR_DEFN_SEQ_NBR = 2                               15041702
150418        AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR             15041802
150419        AND C.ATTR_ELEM_TXT     = :PV-SYS-TRLG-CDE                15041902
150420      END-EXEC.                                                   15042002
150421         EVALUATE TRUE                                            15042102
150422             WHEN SQLCODE = ZERO                                  15042202
150423                  IF PV-NULL-IND-4  = -1                          15042302
150424                     MOVE ZEROES TO PV-CRIT-SKU-WGT               15042402
150425                  END-IF                                          15042502
150426             WHEN SQLCODE = +100                                  15042602
150427                  MOVE ZEROES TO PV-CRIT-SKU-WGT                  15042702
150428             WHEN SQLCODE = -904                                  15042802
150429             WHEN SQLCODE = -913                                  15042902
150430                 CONTINUE                                         15043002
150431             WHEN SQLWARN0 NOT = SPACES                           15043102
150432             WHEN SQLCODE < ZERO                                  15043202
150433             WHEN SQLCODE > ZERO                                  15043302
150434                 MOVE '4625-SKU-CRIT-WGT'                         15043402
150435                                   TO DP013-PARAGRAPH             15043502
150436                 MOVE 'FETCH THE MAX ALLWD WGT'                   15043602
150437                                   TO DP013-MESSAGE-TEXT(1)       15043702
150438                 MOVE SQLCA        TO DP013-SQLCA                 15043802
150439                 MOVE 'WST_INTGRTN_TYP' TO                        15043902
150440                                       DP013-DB2-TABLE-NAME (1)   15044002
150441                 MOVE 'WST_ATTR_DEFN'    TO                       15044102
150442                                       DP013-DB2-TABLE-NAME (2)   15044202
150443                 MOVE 'WST_ATTR_ELEM'    TO                       15044302
150444                                       DP013-DB2-TABLE-NAME (3)   15044402
150445                 SET DP013-DB2-ABEND                              15044502
150446                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15044602
150447                 PERFORM DP013-0000-PROCESS-ABEND                 15044702
150448         END-EVALUATE.                                            15044802
150449 4630-CLOSE-HAZ-CSR.                                              15044902
150450         EXEC SQL                                                 15045002
150451           CLOSE TRIP-HAZ-INFO                                    15045102
150452         END-EXEC.                                                15045202
150453                                                                  15045302
150454*------------------------------------------------------------     15045402
150455*CHECKS WHETHER THE SUMMARY DETAILS ARE AVAILABLE FOR THE TRIP    15045502
150456*------------------------------------------------------------     15045602
150457 4640-CHK-TRIP-DTLS.                                              15045702
150458     EXEC SQL                                                     15045802
150459          SELECT                                                  15045902
150460               A.OTBND_TRIP_ID                                    15046002
150461          INTO                                                    15046102
150462               :SUT00007-OTBND-TRIP-ID                            15046202
150463          FROM                                                    15046302
150464               SUT_TRIP_SUM A                                     15046402
150465          WHERE                                                   15046502
150466               OTBND_TRIP_ID     = :DK-TRIP-ID                    15046602
150467               AND  A.CRE_TMST   =                                15046702
150468                   (SELECT MAX(B.CRE_TMST)                        15046802
150469                    FROM   SUT_TRIP_SUM B                         15046902
150470                    WHERE  B.OTBND_TRIP_ID   = A.OTBND_TRIP_ID)   15047002
150471          WITH UR                                                 15047102
150472     END-EXEC.                                                    15047202
150473         EVALUATE TRUE                                            15047302
150474             WHEN SQLCODE = +0                                    15047402
150475                  CONTINUE                                        15047502
150476             WHEN SQLCODE = +100                                  15047602
150477                  SET ASC-HAZ-RPT-NOT-AVLBL TO TRUE               15047702
150478             WHEN SQLCODE = -904                                  15047802
150479             WHEN SQLCODE = -913                                  15047902
150480                 CONTINUE                                         15048002
150481             WHEN SQLWARN0 NOT = SPACES                           15048102
150482             WHEN SQLCODE < ZERO                                  15048202
150483             WHEN SQLCODE > ZERO                                  15048302
150484                 MOVE '4640-CHK-TRIP-DTLS'                        15048402
150485                                   TO DP013-PARAGRAPH             15048502
150486                 MOVE 'CHECK WHTHR TRIP IS AVABLE'                15048602
150487                                   TO DP013-MESSAGE-TEXT(1)       15048702
150488                 MOVE SQLCA        TO DP013-SQLCA                 15048802
150489                 MOVE 'SUT_TRIP_SUM' TO DP013-DB2-TABLE-NAME (1)  15048902
150490                 SET DP013-DB2-ABEND                              15049002
150491                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15049102
150492                 PERFORM DP013-0000-PROCESS-ABEND                 15049202
150493         END-EVALUATE.                                            15049302
150494*------------------------------------------------------------     15049402
150495*CHECKS WHETHER THE DC PRINTS THE HAZ SUMMARY REPORT              15049502
150496*------------------------------------------------------------     15049602
150497 4650-CHK-WHTR-HAZ-FACLTY.                                        15049702
150498     MOVE ASC-OPER-UNT-ID TO DK-FCLTY-ID                          15049802
150499     EXEC SQL                                                     15049902
150500          SELECT  FUNC_TXT                                        15050002
150501            INTO :ASC-HAZ-FACILITY-SW                             15050102
150502            FROM  TKRPRPM                                         15050202
150503           WHERE  LOC_ID            = :DK-FCLTY-ID                15050302
150504             AND  INTFC_SYS_CDE     = 'KHL'                       15050402
150505             AND  SYS_PRC_FUNC_CDE  = 'HZDCRP'                    15050502
150506             AND  FUNC_PRC_STAT_CDE = 'AC'                        15050602
150507             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          15050702
150508             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          15050802
150509           WITH UR                                                15050902
150510     END-EXEC.                                                    15051002
150511                                                                  15051102
150512         EVALUATE TRUE                                            15051202
150513             WHEN SQLCODE = +0                                    15051302
150514                  CONTINUE                                        15051402
150515             WHEN SQLCODE = +100                                  15051502
150516                 SET ASC-HAZ-FACILITY-NO       TO  TRUE           15051602
150517             WHEN SQLCODE = -904                                  15051702
150518             WHEN SQLCODE = -913                                  15051802
150519                 CONTINUE                                         15051902
150520             WHEN SQLWARN0 NOT = SPACES                           15052002
150521             WHEN SQLCODE < ZERO                                  15052102
150522             WHEN SQLCODE > ZERO                                  15052202
150523                 MOVE '4650-CHK-WHTR-HAZ-FACLTY'                  15052302
150524                                   TO DP013-PARAGRAPH             15052402
150525                 MOVE 'CHECK IF DC HANDLES HAZMAT ITEM'           15052502
150526                                   TO DP013-MESSAGE-TEXT(1)       15052602
150527                 MOVE SQLCA        TO DP013-SQLCA                 15052702
150528                 MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)  15052802
150529                 SET DP013-DB2-ABEND                              15052902
150530                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15053002
150531                 PERFORM DP013-0000-PROCESS-ABEND                 15053102
150532         END-EVALUATE.                                            15053202
150533                                                                  15053302
150534*------------------------------------------------------------     15053402
150535*FETCHES THE DEFAULT PRINTER ID FOR THE DC FOR HAZ SMRY REPORT    15053502
150536*------------------------------------------------------------     15053602
150537 4660-GET-DFLT-PRNT-ID.                                           15053702
150538     MOVE ASC-OPER-UNT-ID TO DK-FCLTY-ID                          15053802
150539     EXEC SQL                                                     15053902
150540          SELECT  FUNC_TXT                                        15054002
150541            INTO :ASC-DEST-PRINTR-ID                              15054102
150542            FROM  TKRPRPM                                         15054202
150543           WHERE  LOC_ID            = :DK-FCLTY-ID                15054302
150544             AND  INTFC_SYS_CDE     = 'KHL'                       15054402
150545             AND  SYS_PRC_FUNC_CDE  = 'HZBLDP'                    15054502
150546             AND  FUNC_PRC_STAT_CDE = 'AC'                        15054602
150547             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          15054702
150548             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          15054802
150549           WITH UR                                                15054902
150550     END-EXEC.                                                    15055002
150551                                                                  15055102
150552     EVALUATE TRUE                                                15055202
150553             WHEN SQLCODE = +0                                    15055302
150554                  CONTINUE                                        15055402
150555             WHEN SQLCODE = +100                                  15055502
150556                 MOVE SPACE TO ASC-DEST-PRINTR-ID                 15055602
150557             WHEN SQLCODE = -904                                  15055702
150558             WHEN SQLCODE = -913                                  15055802
150559                 CONTINUE                                         15055902
150560             WHEN SQLWARN0 NOT = SPACES                           15056002
150561             WHEN SQLCODE < ZERO                                  15056102
150562             WHEN SQLCODE > ZERO                                  15056202
150563                 MOVE '4660-GET-DFLT-PRNT-ID'                     15056302
150564                                   TO DP013-PARAGRAPH             15056402
150565                 MOVE 'CHECK PRINTER AVAILABILITY'                15056502
150566                                   TO DP013-MESSAGE-TEXT(1)       15056602
150567                 MOVE SQLCA        TO DP013-SQLCA                 15056702
150568                 MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)  15056802
150569                 SET DP013-DB2-ABEND                              15056902
150570                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15057002
150571                 PERFORM DP013-0000-PROCESS-ABEND                 15057102
150572         END-EVALUATE.                                            15057202
150573*------------------------------------------------------------     15057302
150574*FETCHES THE UPPER AND LOWER SYS TRAILING CODES ALLOWED           15057402
150575*------------------------------------------------------------     15057502
150576 4670-GET-SYS-TRLG-CDES.                                          15057602
150577     EXEC SQL                                                     15057702
150578          SELECT                                                  15057802
150579                  C.ATTR_ELEM_TXT                                 15057902
150580                , D.ATTR_ELEM_TXT                                 15058002
150581          INTO                                                    15058102
150582                  :ASC-LOW-SYS-TRL-CDE                            15058202
150583                , :ASC-HGH-SYS-TRL-CDE                            15058302
150584          FROM                                                    15058402
150585                  WST_INTGRTN_TYP  A                              15058502
150586                , WST_ATTR_DEFN    B                              15058602
150587                , WST_ATTR_ELEM    C                              15058702
150588                , WST_ATTR_ELEM    D                              15058802
150589          WHERE                                                   15058902
150590                A.INTGRTN_TYP_CDE   = 'HZRPTRANGE'                15059002
150591           AND  A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           15059102
150592           AND  B.ATTR_DEFN_SEQ_NBR = 1                           15059202
150593           AND  B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           15059302
150594           AND  C.ATTR_DEFN_SEQ_NBR = 1                           15059402
150595           AND  B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           15059502
150596           AND  D.ATTR_DEFN_SEQ_NBR = 2                           15059602
150597           AND  C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         15059702
150598          WITH UR                                                 15059802
150599     END-EXEC.                                                    15059902
150600     EVALUATE TRUE                                                15060002
150601             WHEN SQLCODE = +0                                    15060102
150602                  CONTINUE                                        15060202
150603             WHEN SQLCODE = -904                                  15060302
150604             WHEN SQLCODE = -913                                  15060402
150605                 CONTINUE                                         15060502
150606             WHEN SQLCODE = +100                                  15060602
150607             WHEN SQLWARN0 NOT = SPACES                           15060702
150608             WHEN SQLCODE < ZERO                                  15060802
150609             WHEN SQLCODE > ZERO                                  15060902
150610                 MOVE '4670-GET-SYS-TRLG-CDES'                    15061002
150611                                   TO DP013-PARAGRAPH             15061102
150612                 MOVE 'HIGHEST LOWEST SYS TRLG CDE CHK'           15061202
150613                                   TO DP013-MESSAGE-TEXT(1)       15061302
150614                 MOVE SQLCA        TO DP013-SQLCA                 15061402
150615                 MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)  15061502
150616                 SET DP013-DB2-ABEND                              15061602
150617                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15061702
150618                 PERFORM DP013-0000-PROCESS-ABEND                 15061802
150619         END-EVALUATE.                                            15061902
150620*** PK 11/25/13 HAZMAT SUMMARY END                                15062002
150621*----------------------------------------------------------------*15062100
150622* INSERT A NEW ROW INTO THE TRAILER STATUS TABLE                 *15062200
150623*----------------------------------------------------------------*15062300
150630 5000-INSERT-NEW-STATUS.                                          15063000
150700     MOVE ASC-TRIP-ID                  TO DK-TRIP-ID.             15070000
150800                                                                  15080000
150900     PERFORM 4100A-TRAILER-BY-TRIP                                15090000
151000     PERFORM 5100-SELECT-TRIP-STATUS.                             15100000
151100     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR                 15110000
151200        DP020-FK-CONFIRM (DP020-SRC-AID)                          15120000
151300*      SHIP A TRAILER                                             15130000
151400                                                                  15140000
151500         MOVE ASC-TRAILER-SEAL-NBR     TO SUOBTS-TRLR-SEAL-ID     15150000
151600         IF ASC-SHIP-SCAC-CODE > SPACES                           15160000
151700             MOVE ASC-SHIP-SCAC-CODE   TO SUOBTS-SHIP-SCAC-CDE    15170000
151800         END-IF                                                   15180000
151900                                                                  15190000
152000         IF ASC-DRIVER-FIRST-NAME > SPACES                        15200000
152100             MOVE ASC-DRIVER-FIRST-NAME TO SUOBTS-SHIP-DRV-LAST-NM15210000
152200         END-IF                                                   15220000
152300         IF ASC-DRIVER-LAST-NAME > SPACES                         15230000
152400             MOVE ASC-DRIVER-LAST-NAME TO SUOBTS-SHIP-DRV-FRST-NM 15240000
152500         END-IF                                                   15250000
152600                                                                  15260000
152700         IF ASC-DRIVER-ID  > SPACES                               15270000
152800             MOVE ASC-DRIVER-ID        TO SUOBTS-SHIP-DRV-ID      15280000
152900         END-IF                                                   15290000
153000                                                                  15300000
153100         MOVE 'DS'                     TO SUOBTS-TRIP-STAT-CDE    15310000
153200         PERFORM 5200-INSERT-TRIP-STATUS                          15320000
153300                                                                  15330000
153400* JAK 02/07 - ADD ASN LOGIC                                       15340000
153500         PERFORM 9300-CHECK-ASN-TO-WMS-STATUS                     15350000
153600         IF PS-DWNLD-ASN-TO-WMS-YES                               15360000
153700             PERFORM 9350-CALL-ASN-SHIP-CNTL-MOD                  15370000
153800         END-IF                                                   15380000
153900                                                                  15390000
154000     ELSE                                                         15400000
154100         MOVE 'DR'                     TO SUOBTS-TRIP-STAT-CDE    15410000
154200         PERFORM 5200-INSERT-TRIP-STATUS                          15420000
154300     END-IF.                                                      15430000
154400                                                                  15440000
154500     IF  PS-NO-ERROR                                              15450000
154600         IF  ASC-USE-SELECTION-QUEUE                              15460000
154700             PERFORM 6000-UPDATE-SELECTION-QUEUE                  15470000
154800         END-IF                                                   15480000
154900     END-IF.                                                      15490000
155000                                                                  15500000
155100                                                                  15510000
155200******************************************************************15520000
155300 5100-SELECT-TRIP-STATUS.                                         15530000
155400     PERFORM                                                      15540000
155500         WITH TEST AFTER                                          15550000
155600         VARYING PV-RETRY-COUNTER                                 15560000
155700         FROM 1 BY 1                                              15570000
155800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15580000
155900                   OR (SQLCODE = ZERO))                           15590000
156000         EXEC SQL                                                 15600000
156100             SELECT A.OTBND_TRIP_ID                               15610000
156200                 ,  CHAR(DATE(A.OTBND_STAT_TMST),USA)             15620000
156300                 ,  A.TRIP_STAT_CDE                               15630000
156400                 ,  A.STAT_OPER_UNT_ID                            15640000
156500                 ,  A.OTBND_STAT_USR_ID                           15650000
156600                 ,  A.DOOR_ID                                     15660000
156700                 ,  A.TRLR_SEAL_ID                                15670000
156800                 ,  A.SHIP_SCAC_CDE                               15680000
156900                 ,  A.SHIP_DRV_LAST_NM                            15690000
157000                 ,  A.SHIP_DRV_FRST_NM                            15700000
157100                 ,  A.SHIP_DRV_ID                                 15710000
157200                 ,  A.TRLR_PRKG_LOC_DESC                          15720000
157300                 ,  A.TRLR_PRKG_SLOT_NBR                          15730000
157400                 ,  A.FINCL_POST_TMST                             15740000
157500                 ,  A.CPCTY_PCT                                   15750000
157600                 ,  A.UNUSD_PLLT_QTY                              15760000
157700                 ,  A.LOD_BR_QTY                                  15770000
157800              INTO  :SUOBTS-OTBND-TRIP-ID                         15780000
157900                 ,  :PV-USA-DATE                                  15790000
158000                 ,  :SUOBTS-TRIP-STAT-CDE                         15800000
158100                 ,  :SUOBTS-STAT-OPER-UNT-ID                      15810000
158200                 ,  :SUOBTS-OTBND-STAT-USR-ID                     15820000
158300                 ,  :SUOBTS-DOOR-ID                               15830000
158400                 ,  :SUOBTS-TRLR-SEAL-ID                          15840000
158500                 ,  :SUOBTS-SHIP-SCAC-CDE                         15850000
158600                 ,  :SUOBTS-SHIP-DRV-LAST-NM                      15860000
158700                 ,  :SUOBTS-SHIP-DRV-FRST-NM                      15870000
158800                 ,  :SUOBTS-SHIP-DRV-ID                           15880000
158900                 ,  :SUOBTS-TRLR-PRKG-LOC-DESC                    15890000
159000                 ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                    15900000
159100                 ,  :SUOBTS-FINCL-POST-TMST                       15910000
159200                 ,  :SUOBTS-CPCTY-PCT                             15920000
159300                 ,  :SUOBTS-UNUSD-PLLT-QTY                        15930000
159400                 ,  :SUOBTS-LOD-BR-QTY                            15940000
159500              FROM  TSUOBTS A                                     15950000
159600             WHERE  A.OTBND_TRIP_ID   = :SUOBTS-OTBND-TRIP-ID     15960000
159700               AND  A.OTBND_STAT_TMST  =                          15970000
159800                  (SELECT  MAX(B.OTBND_STAT_TMST)                 15980000
159900                     FROM  TSUOBTS B                              15990000
160000                   WHERE  B.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  16000000
160100         END-EXEC                                                 16010000
160200                                                                  16020000
160300         EVALUATE TRUE                                            16030000
160400             WHEN SQLCODE = ZERO                                  16040000
160500             WHEN SQLCODE = -904                                  16050000
160600             WHEN SQLCODE = -913                                  16060000
160700                 CONTINUE                                         16070000
160800             WHEN SQLWARN0 NOT = SPACES                           16080000
160900             WHEN SQLCODE < ZERO                                  16090000
161000             WHEN SQLCODE > ZERO                                  16100000
161100                 MOVE '5100-SELECT-TRIP-STATUS'                   16110000
161200                                   TO DP013-PARAGRAPH             16120000
161300                 MOVE 'SELECT A ROW ON THE TRIP STATUS TABLE'     16130000
161400                                   TO DP013-MESSAGE-TEXT(1)       16140000
161500                 MOVE SQLCA        TO DP013-SQLCA                 16150000
161600                 MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)    16160000
161700                 MOVE SUOBTS-OTBND-TRIP-ID                        16170000
161800                                   TO PV-TRIP-ID                  16180000
161900                 MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT(2)       16190000
162000                 MOVE SUOBTS-OTBND-STAT-TMST                      16200000
162100                                   TO DP013-MESSAGE-TEXT(3)       16210000
162200                 SET DP013-DB2-ABEND                              16220000
162300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16230000
162400                 PERFORM DP013-0000-PROCESS-ABEND                 16240000
162500         END-EVALUATE                                             16250000
162600     END-PERFORM.                                                 16260000
162700*                                                                 16270000
162800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16280000
162900         MOVE '5100-SELECT-TRIP-STATUS'                           16290000
163000                                   TO DP013-PARAGRAPH             16300000
163100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT A TRI16310000
163200-             'P STATUS   '        TO DP013-MESSAGE-TEXT (1)      16320000
163300         MOVE SQLCA                TO DP013-SQLCA                 16330000
163400         MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)    16340000
163500         SET DP013-DB2-ABEND                                      16350000
163600             DP013-XCTL-DISPLAY-RESTART                           16360000
163700                                   TO TRUE                        16370000
163800         PERFORM DP013-0000-PROCESS-ABEND                         16380000
163900     END-IF.                                                      16390000
164000                                                                  16400000
164100******************************************************************16410000
164200 5200-INSERT-TRIP-STATUS.                                         16420000
164300                                                                  16430000
164400     MOVE  DP020-USERID                                           16440000
164500       TO  SUOBTS-OTBND-STAT-USR-ID.                              16450000
164600                                                                  16460000
164700     EXEC SQL                                                     16470000
164800          INSERT INTO TSUOBTS                                     16480000
164900                (OTBND_TRIP_ID                                    16490000
165000              ,  OTBND_STAT_TMST                                  16500000
165100              ,  TRIP_STAT_CDE                                    16510000
165200              ,  STAT_OPER_UNT_ID                                 16520000
165300              ,  OTBND_STAT_USR_ID                                16530000
165400              ,  DOOR_ID                                          16540000
165500              ,  TRLR_SEAL_ID                                     16550000
165600              ,  SHIP_SCAC_CDE                                    16560000
165700              ,  SHIP_DRV_LAST_NM                                 16570000
165800              ,  SHIP_DRV_FRST_NM                                 16580000
165900              ,  SHIP_DRV_ID                                      16590000
166000              ,  TRLR_PRKG_LOC_DESC                               16600000
166100              ,  TRLR_PRKG_SLOT_NBR                               16610000
166200              ,  FINCL_POST_TMST                                  16620000
166300              ,  CPCTY_PCT                                        16630000
166400              ,  UNUSD_PLLT_QTY                                   16640000
166500              ,  LOD_BR_QTY)                                      16650000
166600        VALUES  (:SUOBTS-OTBND-TRIP-ID                            16660000
166700              ,  CURRENT TIMESTAMP                                16670000
166800              ,  :SUOBTS-TRIP-STAT-CDE                            16680000
166900              ,  :SUOBTS-STAT-OPER-UNT-ID                         16690000
167000              ,  :SUOBTS-OTBND-STAT-USR-ID                        16700000
167100              ,  :SUOBTS-DOOR-ID                                  16710000
167200              ,  :SUOBTS-TRLR-SEAL-ID                             16720000
167300              ,  :SUOBTS-SHIP-SCAC-CDE                            16730000
167400              ,  :SUOBTS-SHIP-DRV-LAST-NM                         16740000
167500              ,  :SUOBTS-SHIP-DRV-FRST-NM                         16750000
167600              ,  :SUOBTS-SHIP-DRV-ID                              16760000
167700              ,  :SUOBTS-TRLR-PRKG-LOC-DESC                       16770000
167800              ,  :SUOBTS-TRLR-PRKG-SLOT-NBR                       16780000
167900              ,  :SUOBTS-FINCL-POST-TMST                          16790000
168000              ,  :SUOBTS-CPCTY-PCT                                16800000
168100              ,  :SUOBTS-UNUSD-PLLT-QTY                           16810000
168200              ,  :SUOBTS-LOD-BR-QTY)                              16820000
168300     END-EXEC.                                                    16830000
168400                                                                  16840000
168500     EVALUATE TRUE                                                16850000
168600          WHEN SQLCODE = ZERO                                     16860000
168700               PERFORM 5210-INSERT-WRKR                           16870000
168800                                                                  16880000
168900          WHEN SQLCODE = -904                                     16890000
169000          WHEN SQLCODE = -913                                     16900000
169100               SET PS-ERROR                TO TRUE                16910000
169200               SET DP020-MSG-FATAL         TO TRUE                16920000
169300               MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER    16930000
169400               MOVE DP015-UNP-ALP-BRT-OFF  TO ASEALA              16940000
169500               MOVE -1                     TO ASEALL              16950000
169600               SET DP030-SET-CURSOR-APPL-1 TO TRUE                16960000
169700               SET DP013-ROLLBACK          TO TRUE                16970000
169800                                                                  16980000
169900               SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE            16990000
170000                                                                  17000000
170100               MOVE SUOBTS-STAT-OPER-UNT-ID TO PV-DISP-OPER       17010000
170200               MOVE SUOBTS-OTBND-TRIP-ID    TO PV-DISP-TRIP       17020000
170300               MOVE '5200-INSERT-TRIP-STATUS'                     17030000
170400                                 TO DP013-PARAGRAPH               17040000
170500               MOVE 'INSERT A ROW ON THE TRIP STATUS TABLE'       17050000
170600                                 TO DP013-MESSAGE-TEXT(1)         17060000
170700               STRING PV-DISP-OPER '   TRIP = '                   17070000
170800                      PV-DISP-TRIP '   USERID = '                 17080000
170900                      SUOBTS-OTBND-STAT-USR-ID                    17090000
171000                                    DELIMITED BY SIZE             17100000
171100                               INTO DP013-MESSAGE-TEXT(2)         17110000
171200               MOVE SQLCA        TO DP013-SQLCA                   17120000
171300               MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)      17130000
171400               SET DP013-DB2-ABEND                                17140000
171500                   DP013-LINK-RETURN          TO TRUE             17150000
171600               PERFORM DP013-0000-PROCESS-ABEND                   17160000
171700                                                                  17170000
171800          WHEN SQLWARN0 NOT = SPACES                              17180000
171900          WHEN SQLCODE < ZERO                                     17190000
172000          WHEN SQLCODE > ZERO                                     17200000
172100               MOVE SUOBTS-STAT-OPER-UNT-ID TO PV-DISP-OPER       17210000
172200               MOVE SUOBTS-OTBND-TRIP-ID    TO PV-DISP-TRIP       17220000
172300               MOVE '5200-INSERT-TRIP-STATUS'                     17230000
172400                                 TO DP013-PARAGRAPH               17240000
172500               MOVE 'INSERT A ROW ON THE TRIP STATUS TABLE'       17250000
172600                                 TO DP013-MESSAGE-TEXT(1)         17260000
172700               STRING PV-DISP-OPER '   TRIP = '                   17270000
172800                      PV-DISP-TRIP '   USERID = '                 17280000
172900                      SUOBTS-OTBND-STAT-USR-ID                    17290000
173000                                    DELIMITED BY SIZE             17300000
173100                               INTO DP013-MESSAGE-TEXT(2)         17310000
173200               MOVE SQLCA        TO DP013-SQLCA                   17320000
173300               MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)      17330000
173400               SET DP013-DB2-ABEND                                17340000
173500                   DP013-XCTL-DISPLAY-RESTART TO TRUE             17350000
173600               PERFORM DP013-0000-PROCESS-ABEND                   17360000
173700     END-EVALUATE.                                                17370000
173800                                                                  17380000
173900                                                                  17390000
174000******************************************************************17400000
174100* INSERT INTO WORKER DATABASE - WHO PERFORMED FUNCTION           *17410000
174200******************************************************************17420000
174300 5210-INSERT-WRKR.                                                17430000
174400                                                                  17440000
174500     MOVE  SUOBTS-OTBND-TRIP-ID   TO  SUT00006-OTBND-TRIP-ID      17450000
174600     MOVE  DP020-USERID           TO  SUT00006-USR-ID.            17460000
174700                                                                  17470000
174800     EVALUATE TRUE                                                17480000
174900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              17490000
175000              MOVE  'SUKC597A'     TO  SUT00006-CRE-BY-PGM-NM     17500000
175100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              17510000
175200              MOVE  'SUKC597B'     TO  SUT00006-CRE-BY-PGM-NM     17520000
175300         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              17530000
175400              MOVE  'SUKC597C'     TO  SUT00006-CRE-BY-PGM-NM     17540000
175500         WHEN OTHER                                               17550000
175600              MOVE  'SUKCS597'     TO  SUT00006-CRE-BY-PGM-NM     17560000
175700     END-EVALUATE.                                                17570000
175800                                                                  17580000
175900     EXEC SQL                                                     17590000
176000          INSERT INTO SUT_TRIP_WRKR_AUD                           17600000
176100                (OTBND_TRIP_ID                                    17610000
176200              ,  USR_ID                                           17620000
176300              ,  CRE_TMST                                         17630000
176400              ,  CRE_BY_PGM_NM)                                   17640000
176500        VALUES  (:SUT00006-OTBND-TRIP-ID                          17650000
176600              ,  :SUT00006-USR-ID                                 17660000
176700              ,  CURRENT TIMESTAMP                                17670000
176800              ,  :SUT00006-CRE-BY-PGM-NM)                         17680000
176900     END-EXEC.                                                    17690000
177000                                                                  17700000
177100     EVALUATE TRUE                                                17710000
177200         WHEN SQLCODE = ZERO                                      17720000
177300              CONTINUE                                            17730000
177400                                                                  17740000
177500         WHEN SQLCODE = -904                                      17750000
177600         WHEN SQLCODE = -913                                      17760000
177700              SET PS-ERROR                TO TRUE                 17770000
177800              SET DP020-MSG-FATAL         TO TRUE                 17780000
177900              MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER     17790000
178000              MOVE DP015-UNP-ALP-BRT-OFF  TO ASEALA               17800000
178100              MOVE -1                     TO ASEALL               17810000
178200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 17820000
178300              SET DP013-ROLLBACK          TO TRUE                 17830000
178400                                                                  17840000
178500              SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE             17850000
178600                                                                  17860000
178610              MOVE SUOBTS-STAT-OPER-UNT-ID TO PV-DISP-OPER        17861000
178620              MOVE SUT00006-OTBND-TRIP-ID  TO PV-DISP-TRIP        17862000
178630                                                                  17863000
178640              MOVE '5210-INSERT-WRKR       '                      17864000
178650                                TO DP013-PARAGRAPH                17865000
178651              MOVE 'INSERT A ROW ON THE TRIP WRKR   TABLE'        17865100
178652                                TO DP013-MESSAGE-TEXT(1)          17865200
178653              STRING PV-DISP-OPER '   TRIP = '                    17865300
178654                     PV-DISP-TRIP '   USERID = '                  17865400
178655                     SUT00006-USR-ID  DELIMITED BY SIZE           17865500
178656                                 INTO DP013-MESSAGE-TEXT(2)       17865600
178657              MOVE SQLCA        TO DP013-SQLCA                    17865700
178658              MOVE 'SUT_TRIP_WRKR_AUD'                            17865800
178659                                TO DP013-DB2-TABLE-NAME (1)       17865900
178660              STRING PV-DISP-OPER '   TRIP = '                    17866000
178661                     PV-DISP-TRIP '   USERID = '                  17866100
178662                     SUT00006-USR-ID  DELIMITED BY SIZE           17866200
178663                                 INTO DP013-MESSAGE-TEXT(2)       17866300
178664              SET DP013-DB2-ABEND                                 17866400
178665                  DP013-LINK-RETURN          TO TRUE              17866500
178666              PERFORM DP013-0000-PROCESS-ABEND                    17866600
178667                                                                  17866700
178668         WHEN SQLWARN0 NOT = SPACES                               17866800
178669         WHEN SQLCODE < ZERO                                      17866900
178670         WHEN SQLCODE > ZERO                                      17867000
178671              MOVE SUOBTS-STAT-OPER-UNT-ID TO PV-DISP-OPER        17867100
178672              MOVE SUT00006-OTBND-TRIP-ID  TO PV-DISP-TRIP        17867200
178673             MOVE '5210-INSERT-WRKR       '                       17867300
178674                               TO DP013-PARAGRAPH                 17867400
178675             MOVE 'INSERT A ROW ON THE TRIP WRKR   TABLE'         17867500
178676                               TO DP013-MESSAGE-TEXT(1)           17867600
178677             MOVE SQLCA        TO DP013-SQLCA                     17867700
178678             MOVE 'SUT_TRIP_WRKR_AUD'                             17867800
178679                               TO DP013-DB2-TABLE-NAME (1)        17867900
178680             SET DP013-DB2-ABEND                                  17868000
178681                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17868100
178682             PERFORM DP013-0000-PROCESS-ABEND                     17868200
178683     END-EVALUATE.                                                17868300
178684                                                                  17868400
178685                                                                  17868500
178686******************************************************************17868601
178687* INSERT INTO WORKER DATABASE - WHO PERFORMED FUNCTION           *17868701
178688******************************************************************17868801
178689 5220-INSERT-WRKR-SUM.                                            17868901
178690                                                                  17869001
178691     MOVE  SUOBTS-OTBND-TRIP-ID   TO  SUT00006-OTBND-TRIP-ID      17869101
178692     MOVE  DP020-USERID           TO  SUT00006-USR-ID.            17869201
178693                                                                  17869301
178702     MOVE  'SUKC597D'             TO  SUT00006-CRE-BY-PGM-NM.     17870201
178704                                                                  17870401
178705     EXEC SQL                                                     17870501
178706          INSERT INTO SUT_TRIP_WRKR_AUD                           17870601
178707                (OTBND_TRIP_ID                                    17870701
178708              ,  USR_ID                                           17870801
178709              ,  CRE_TMST                                         17870901
178710              ,  CRE_BY_PGM_NM)                                   17871001
178711        VALUES  (:SUT00006-OTBND-TRIP-ID                          17871101
178712              ,  :SUT00006-USR-ID                                 17871201
178713              ,  CURRENT TIMESTAMP                                17871301
178714              ,  :SUT00006-CRE-BY-PGM-NM)                         17871401
178715     END-EXEC.                                                    17871501
178716                                                                  17871601
178717     EVALUATE TRUE                                                17871701
178718         WHEN SQLCODE = ZERO                                      17871801
178719              CONTINUE                                            17871901
178720                                                                  17872001
178721         WHEN SQLCODE = -904                                      17872101
178722         WHEN SQLCODE = -913                                      17872201
178723              SET PS-ERROR                TO TRUE                 17872301
178724              SET DP020-MSG-FATAL         TO TRUE                 17872401
178725              MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER     17872501
178726              MOVE DP015-UNP-ALP-BRT-OFF  TO ASEALA               17872601
178727              MOVE -1                     TO ASEALL               17872701
178728              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 17872801
178729              SET DP013-ROLLBACK          TO TRUE                 17872901
178730                                                                  17873001
178731              SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE             17873101
178732                                                                  17873201
178733              MOVE SUOBTS-STAT-OPER-UNT-ID TO PV-DISP-OPER        17873301
178734              MOVE SUT00006-OTBND-TRIP-ID  TO PV-DISP-TRIP        17873401
178735                                                                  17873501
178736              MOVE '5220-INSERT-WRKR-SUM   '                      17873601
178737                                TO DP013-PARAGRAPH                17873701
178738              MOVE 'INSERT A ROW ON THE TRIP WRKR   TABLE'        17873801
178739                                TO DP013-MESSAGE-TEXT(1)          17873901
178740              STRING PV-DISP-OPER '   TRIP = '                    17874001
178741                     PV-DISP-TRIP '   USERID = '                  17874101
178742                     SUT00006-USR-ID  DELIMITED BY SIZE           17874201
178743                                 INTO DP013-MESSAGE-TEXT(2)       17874301
178744              MOVE SQLCA        TO DP013-SQLCA                    17874401
178745              MOVE 'SUT_TRIP_WRKR_AUD'                            17874501
178746                                TO DP013-DB2-TABLE-NAME (1)       17874601
178747              STRING PV-DISP-OPER '   TRIP = '                    17874701
178748                     PV-DISP-TRIP '   USERID = '                  17874801
178749                     SUT00006-USR-ID  DELIMITED BY SIZE           17874901
178750                                 INTO DP013-MESSAGE-TEXT(2)       17875001
178751              SET DP013-DB2-ABEND                                 17875101
178752                  DP013-LINK-RETURN          TO TRUE              17875201
178753              PERFORM DP013-0000-PROCESS-ABEND                    17875301
178754                                                                  17875401
178755         WHEN SQLWARN0 NOT = SPACES                               17875501
178756         WHEN SQLCODE < ZERO                                      17875601
178757         WHEN SQLCODE > ZERO                                      17875701
178758              MOVE SUOBTS-STAT-OPER-UNT-ID TO PV-DISP-OPER        17875801
178759              MOVE SUT00006-OTBND-TRIP-ID  TO PV-DISP-TRIP        17875901
178760             MOVE '5220-INSERT-WRKR-SUM   '                       17876001
178761                               TO DP013-PARAGRAPH                 17876101
178762             MOVE 'INSERT A ROW ON THE TRIP WRKR   TABLE'         17876201
178763                               TO DP013-MESSAGE-TEXT(1)           17876301
178764             MOVE SQLCA        TO DP013-SQLCA                     17876401
178765             MOVE 'SUT_TRIP_WRKR_AUD'                             17876501
178766                               TO DP013-DB2-TABLE-NAME (1)        17876601
178767             SET DP013-DB2-ABEND                                  17876701
178768                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17876801
178769             PERFORM DP013-0000-PROCESS-ABEND                     17876901
178770     END-EVALUATE.                                                17877001
178771                                                                  17877101
178772*** PK 11/25/13 HAZ SUMRY RPT BEGIN                               17877202
178773*-----------------------------------------------------------------17877302
178774*  5300-VALIDATE-PRINTER.                                         17877402
178775*      CALLS SPKCS060 TO VALIDATE THE PRINTER ID                  17877502
178776*-----------------------------------------------------------------17877602
178777 5300-VALIDATE-PRINTER.                                           17877702
178778     MOVE ASC-DEST-PRINTR-ID         TO DP072-PRINTER-ID.         17877802
178779                                                                  17877902
178780     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        17878002
178781     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     17878102
178782     MOVE ASC-OPER-UNT-ID            TO DP072-ORIGIN-OPER-UNT-ID. 17878202
178783     MOVE ASC-OPER-UNT-ID            TO DP072-OPER-UNT-ID.        17878302
178784     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     17878402
178785                                        DP072-FCLTY-ID.           17878502
178786     SET DP072-VALIDATE              TO TRUE.                     17878602
178787                                                                  17878702
178788     EXEC CICS                                                    17878802
178789          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  17878902
178790               COMMAREA (DP072-COMM-AREA)                         17879002
178791               RESP     (PV-CICS-RESPONSE)                        17879102
178792     END-EXEC                                                     17879202
178793                                                                  17879302
178794     EVALUATE TRUE                                                17879402
178795         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17879502
178796             CONTINUE                                             17879602
178797         WHEN OTHER                                               17879702
178798             MOVE '5300-VALIDATE-PRINTER'                         17879802
178799                                 TO DP013-PARAGRAPH               17879902
178800             MOVE PV-CICS-RESPONSE                                17880002
178801                                 TO DP013-MESSAGE-TEXT(1)         17880102
178802             SET DP013-LINK-RETURN                                17880202
178803                 DP013-CICS-ABEND                                 17880302
178804                 DP013-NO-ROLLBACK TO TRUE                        17880402
178805             PERFORM DP013-0000-PROCESS-ABEND                     17880502
178806     END-EVALUATE.                                                17880602
178807*-----------------------------------------------------------      17880702
178808* THIS ROUTINE SUBMITS THE BATCH JOB TO PRINT THE HAZ REPORT      17880806
178809*-----------------------------------------------------------      17880906
178810 5400-PRINT-HAZ-REPORT.                                           17881006
178811      IF ASC-DEST-PRINTR-ID > SPACES                              17881106
178812        PERFORM 5300-VALIDATE-PRINTER                             17881206
178813        IF DP072-PRTR-PRTR-TRK-STAT-CDE EQUAL 'A'                 17881306
178814          PERFORM 5410-SUBMIT-JOB                                 17881406
178815        ELSE                                                      17881506
178816             MOVE DP015-UNP-ALP-BRT-OFF TO APRINIDA               17881606
178817             MOVE DP015-RED      TO APRINIDC                      17881706
178818             MOVE DP015-REVERSE  TO APRINIDH                      17881806
178819             MOVE -1             TO APRINIDL                      17881906
178820             MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER             17882006
178821             SET DP020-MSG-INFORMATIONAL TO TRUE                  17882106
178822             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17882206
178823             MOVE SPACES TO  ASC-DEST-PRINTR-ID                   17882306
178824        END-IF                                                    17882406
178825      ELSE                                                        17882506
178826        MOVE DP015-UNP-ALP-BRT-OFF TO APRINIDA                    17882606
178827        MOVE DP015-RED      TO APRINIDC                           17882706
178828        MOVE DP015-REVERSE  TO APRINIDH                           17882806
178829        MOVE -1             TO APRINIDL                           17882906
178830        MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER                  17883006
178831        SET DP020-MSG-INFORMATIONAL TO TRUE                       17883106
178832      END-IF.                                                     17883206
178833*-----------------------------------------------------------      17883306
178834*     5410-SUBMIT-JOB - SUBMITS A BATCH JOB TO PRINT THE HAZ      17883406
178835*                       SUMMARY REPORT                            17883506
178836*-----------------------------------------------------------      17883606
178837 5410-SUBMIT-JOB.                                                 17883706
178838                                                                  17883806
178839     MOVE  PC-STATUS-REPORT-DESC TO PV-JOB-DESCRIPTION.           17883906
178840     MOVE  PC-STATUS-REPORT-PROC TO PV-JOB-PROC.                  17884006
178841     MOVE  PC-STATUS-REPORT-JOB  TO PV-JOB-NAME.                  17884106
178842                                                                  17884206
178843      EXEC CICS                                                   17884306
178844          ASSIGN                                                  17884406
178845              APPLID(PV-SYSTEM-ID)                                17884506
178846              USERID (PV-USER-ID)                                 17884606
178847      END-EXEC.                                                   17884706
178848                                                                  17884806
178849      PERFORM 5420-ENQUEUE-INTERNAL-READER.                       17884906
178850                                                                  17885006
178851      MOVE '*5410-SUBMIT-JOB            *' TO DP013-PARAGRAPH     17885106
178852                                                                  17885206
178853*-----------------------------------------------------------      17885306
178854* PROD/LEARN JCL SETUP                                            17885406
178855*     //SUK914   JOB KOHLS,'HAZ SUMRY RPT',MSGCLASS=P,CLASS=U     17885506
178856*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,DEST=UNNNNNNN            17885606
178857*     //JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR                     17885706
178858*     //PS020    EXEC SUK9141                                     17885806
178859*     //S010.SYSUT1 DD *                                          17885906
178860*     TKXXXXX NNNNNNNNN NNNN NNNN CC MM/DD/YYYYXXXXXXXXXXXXN.NC   17886006
178861*     CCCNNNNNNNNNXX                                              17886106
178862*     /*EOF                                                       17886206
178863*-----------------------------------------------------------      17886306
178864* TEST JCL SETUP                                                  17886406
178865*     //XXXXXXXQ JOB KOHLS,'HAZ SUMRY RPT',MSGCLASS=X,CLASS=E     17886506
178866*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S,DEST=UNNNNNNN            17886606
178867*     //JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR                     17886706
178868*     //PS020    EXEC SUK9141                                     17886806
178869*     //S010.SYSUT1 DD *                                          17886906
178870*     TKXXXXX NNNNNNNNN NNNN NNNN CC MM/DD/YYYYXXXXXXXXXXXXN.NC   17887006
178871*     CCCNNNNNNNNNXX                                              17887106
178872*     /*EOF                                                       17887206
178873*-----------------------------------------------------------      17887306
178874                                                                  17887406
178875      IF  ASC-DEST-PRINTR-ID       =  SPACES                      17887506
178876          MOVE 'LOCAL'  TO  PV-PRINTER-DESTINATION                17887606
178877      ELSE                                                        17887706
178878          MOVE ASC-DEST-PRINTR-ID                                 17887806
178879                        TO  PV-PRINTER-DESTINATION.               17887906
178880                                                                  17888006
178881      IF PV-PROD-CICS                                             17888106
178882          MOVE PV-JOB-NAME            TO  JL-PROD-JOB-NAME        17888206
178883          MOVE PV-JOB-DESCRIPTION     TO  JL-PROD-JOB-DESC        17888306
178884          MOVE JL-JOB-LINE-PROD       TO  JL-JCL-LINE-1           17888406
178885          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             17888506
178886          PERFORM 5430-WRITE-TD-LINE                              17888606
178887          MOVE 'A'                    TO  JL-LINE-2-CLASS         17888706
178888          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-2-PRINTER       17888806
178889          MOVE JL-JCL-LINE-2          TO  TD-JCL-LINE             17888906
178890          PERFORM 5430-WRITE-TD-LINE                              17889006
178891          MOVE JL-JCL-LINE-3-PROD     TO  TD-JCL-LINE             17889106
178892          PERFORM 5430-WRITE-TD-LINE                              17889206
178893          MOVE PV-JOB-PROC            TO  JL-LINE-4-PROC          17889306
178894          MOVE SPACE                  TO  JL-LINE-4-PROC-T        17889406
178895          MOVE JL-JCL-LINE-4          TO  TD-JCL-LINE             17889506
178896          PERFORM 5430-WRITE-TD-LINE                              17889606
178897          MOVE JL-JCL-LINE-5          TO  TD-JCL-LINE             17889706
178898          PERFORM 5430-WRITE-TD-LINE                              17889806
178899      ELSE                                                        17889906
178900      IF PV-TEST-CICS                                             17890006
178901          MOVE DP020-USERID           TO  JL-TEST-JOB-NAME        17890106
178902          MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC        17890206
178903          MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1           17890306
178904          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             17890406
178905          PERFORM 5430-WRITE-TD-LINE                              17890506
178906          MOVE 'A'                    TO  JL-LINE-2-CLASS         17890606
178907          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-2-PRINTER       17890706
178908          MOVE JL-JCL-LINE-2          TO  TD-JCL-LINE             17890806
178909          PERFORM 5430-WRITE-TD-LINE                              17890906
178910          MOVE JL-PROC-DSN            TO  TD-JCL-LINE             17891006
178911          PERFORM 5430-WRITE-TD-LINE                              17891106
178912          MOVE JL-JCL-LINE-3-TEST     TO  TD-JCL-LINE             17891206
178913          PERFORM 5430-WRITE-TD-LINE                              17891306
178914          MOVE PV-JOB-PROC            TO  JL-LINE-4-PROC          17891406
178915          MOVE PC-TEST                TO  JL-LINE-4-PROC-T        17891506
178916          MOVE JL-JCL-LINE-4          TO  TD-JCL-LINE             17891606
178917          PERFORM 5430-WRITE-TD-LINE                              17891706
178918          MOVE JL-JCL-LINE-5          TO  TD-JCL-LINE             17891806
178919          PERFORM 5430-WRITE-TD-LINE                              17891906
178920      ELSE                                                        17892006
178921      IF PV-QA-CICS                                               17892106
178922          MOVE DP020-USERID           TO  JL-TEST-JOB-NAME        17892206
178923          MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC        17892306
178924          MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1           17892406
178925          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             17892506
178926          PERFORM 5430-WRITE-TD-LINE                              17892606
178927          MOVE 'A'                    TO  JL-LINE-2-CLASS         17892706
178928          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-2-PRINTER       17892806
178929          MOVE JL-JCL-LINE-2          TO  TD-JCL-LINE             17892906
178930          PERFORM 5430-WRITE-TD-LINE                              17893006
178931          MOVE JL-JCL-LINE-3-TEST     TO  TD-JCL-LINE             17893106
178932          PERFORM 5430-WRITE-TD-LINE                              17893206
178933          MOVE PV-JOB-PROC            TO  JL-LINE-4-PROC          17893306
178934          MOVE PC-QA                  TO  JL-LINE-4-PROC-T        17893406
178935          MOVE JL-JCL-LINE-4          TO  TD-JCL-LINE             17893506
178936          PERFORM 5430-WRITE-TD-LINE                              17893606
178937          MOVE JL-JCL-LINE-5          TO  TD-JCL-LINE             17893706
178938          PERFORM 5430-WRITE-TD-LINE                              17893806
178939      ELSE                                                        17893906
178940          MOVE DP020-USERID           TO  JL-TEST-JOB-NAME        17894006
178941          MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC        17894106
178942          MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1           17894206
178943          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             17894306
178944          PERFORM 5430-WRITE-TD-LINE                              17894406
178945          MOVE 'A'                    TO  JL-LINE-2-CLASS         17894506
178946          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-2-PRINTER       17894606
178947          MOVE JL-JCL-LINE-2          TO  TD-JCL-LINE             17894706
178948          PERFORM 5430-WRITE-TD-LINE                              17894806
178949          MOVE JL-JCL-LINE-3-TEST     TO  TD-JCL-LINE             17894906
178950          PERFORM 5430-WRITE-TD-LINE                              17895006
178951          MOVE PV-JOB-PROC            TO  JL-LINE-4-PROC          17895106
178952          MOVE PC-LEARN               TO  JL-LINE-4-PROC-T        17895206
178953          MOVE JL-JCL-LINE-4          TO  TD-JCL-LINE             17895306
178954          PERFORM 5430-WRITE-TD-LINE                              17895406
178955          MOVE JL-JCL-LINE-5          TO  TD-JCL-LINE             17895506
178956          PERFORM 5430-WRITE-TD-LINE.                             17895606
178957                                                                  17895706
178958     MOVE DP020-USERID                TO  JL-LINE-6-USER-ID.      17895806
178959     MOVE ASC-TRIP-ID                 TO  JL-LINE-6-TRIP-ID.      17895906
178960     MOVE ASC-OPER-UNT-ID             TO  JL-LINE-6-OPRUNT-ID.    17896006
178961     MOVE ASC-DESTINATION-ID          TO  JL-LINE-6-TO-STR.       17896106
178962     MOVE ASC-TRIP-STAT-CDE           TO  JL-LINE-6-TRIP-CD.      17896206
178963     MOVE ASC-TRIP-STATUS-DATE        TO  JL-LINE-6-STAT-DATE.    17896306
178964     MOVE ASC-TRAILER-ID              TO  JL-LINE-6-TRLR-ID.      17896406
178965     MOVE ASC-OPER-UNT-ID             TO  JL-LINE-6-OPRUNT-ID.    17896506
178966     MOVE ASC-LOW-SYS-TRL-CDE         TO  JL-LINE-6-SYS-TRL-CD.   17896606
178967     MOVE ASC-SCAC                    TO  JL-LINE-6-SCAC.         17896706
178968     MOVE ASC-TRLR-SRL-NBR            TO  JL-LINE-6-TRLR-SL-NBR.  17896806
178969     MOVE ASC-DEST-PRINTR-ID          TO  JL-LINE-6-PRINTER-ID.   17896906
178970     MOVE DP072-PRTR-PRTR-CNTL-IND    TO  JL-LINE-6-PRTR-CNTL.    17897006
178971     MOVE DP072-PRTR-TRACK-NBR        TO  JL-LINE-6-TRACK-NBR.    17897106
178972     MOVE JL-JCL-LINE-6               TO  TD-JCL-LINE.            17897206
178973     PERFORM 5430-WRITE-TD-LINE.                                  17897306
178974                                                                  17897406
178975     MOVE JL-JCL-LINE-EOF             TO  TD-JCL-LINE.            17897506
178976     PERFORM 5430-WRITE-TD-LINE.                                  17897606
178977                                                                  17897706
178978     PERFORM 9800-DEQUEUE-INTERNAL-READER.                        17897806
178979                                                                  17897906
178980     MOVE PC-TSYMSG-03743        TO DP020-MSG-NUMBER.             17898006
178981                                                                  17898106
178982     SET DP020-MSG-INFORMATIONAL TO TRUE.                         17898206
178983                                                                  17898306
178984                                                                  17898406
178985*-----------------------------------------------------------      17898506
178986  5420-ENQUEUE-INTERNAL-READER.                                   17898606
178987      MOVE '*5420-ENQUEUE-INTERNAL-READER.   *' TO DP013-PARAGRAPH17898706
178988      EXEC CICS                                                   17898806
178989          ENQ                                                     17898906
178990              RESOURCE(TD-QUEUE-NAME)                             17899006
178991              LENGTH(TD-QUEUE-NAME-LENGTH)                        17899106
178992              RESP(PV-CICS-RESPONSE)                              17899206
178993      END-EXEC.                                                   17899306
178994                                                                  17899406
178995      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   17899506
178996          STRING 'ENQUEUE '            DELIMITED BY SIZE          17899606
178997                 TD-QUEUE-NAME         DELIMITED BY SIZE          17899706
178998                 ' (INTERNAL READER)'  DELIMITED BY SIZE          17899806
178999              INTO DP013-MESSAGE-TEXT(1)                          17899906
179000              SET DP013-CICS-ABEND                                17900006
179001                 DP013-ROLLBACK                                   17900106
179002                 DP013-DB2-ABEND                                  17900206
179003                 DP013-XCTL-DISPLAY-RESTART                       17900306
179004                               TO TRUE                            17900406
179005              PERFORM DP013-0000-PROCESS-ABEND                    17900506
179006      END-IF.                                                     17900606
179007                                                                  17900706
179008      SET PS-INTERNAL-READER-ENQUEUED TO TRUE.                    17900806
179009*-----------------------------------------------------------      17900906
179010*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL  17901006
179011*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE     17901106
179012*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST            17901206
179013*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST),  17901306
179014*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE      17901406
179015*  CICS.                                                          17901506
179016*-----------------------------------------------------------      17901606
179017  5430-WRITE-TD-LINE.                                             17901706
179018      MOVE '*5430-WRITE-TD-LINE.             *' TO DP013-PARAGRAPH17901806
179019      EXEC CICS                                                   17901906
179020          WRITEQ TD                                               17902006
179021              QUEUE(TD-QUEUE-NAME)                                17902106
179022              FROM(TD-JCL-LINE)                                   17902206
179023              LENGTH(TD-JCL-LINE-LENGTH)                          17902306
179024              RESP(PV-CICS-RESPONSE)                              17902406
179025      END-EXEC.                                                   17902506
179026                                                                  17902606
179027      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   17902706
179028          STRING 'WRITE TO TRANSIENT DATA QUEUE '                 17902806
179029                                                 DELIMITED BY SIZE17902906
179030                 TD-QUEUE-NAME                   DELIMITED BY SIZE17903006
179031                 ' (INTERNAL READER)'            DELIMITED BY SIZE17903106
179032              INTO DP013-MESSAGE-TEXT(1)                          17903206
179033              PERFORM 9800-DEQUEUE-INTERNAL-READER                17903306
179034              SET DP013-CICS-ABEND                                17903406
179035                 DP013-ROLLBACK                                   17903506
179036                 DP013-DB2-ABEND                                  17903606
179037                 DP013-XCTL-DISPLAY-RESTART                       17903706
179038                               TO TRUE                            17903806
179039              PERFORM DP013-0000-PROCESS-ABEND                    17903906
179040      END-IF.                                                     17904006
179041                                                                  17904106
179042*-----------------------------------------------------------      17904206
179043**  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     17904306
179044**  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     17904406
179045**  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  17904506
179046**  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   17904606
179047**  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      17904706
179048**  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  17904806
179049**  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL 17904906
179050**  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    17905006
179051**  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   17905106
179052**  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           17905206
179053**  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), 17905306
179054**  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     17905406
179055**  CICS.                                                         17905506
179056*-----------------------------------------------------------      17905606
179057  9800-DEQUEUE-INTERNAL-READER.                                   17905706
179058                                                                  17905806
179059      SET PS-INTERNAL-READER-DEQUEUED TO TRUE.                    17905906
179060                                                                  17906006
179061      EXEC CICS                                                   17906106
179062          DEQ                                                     17906206
179063              RESOURCE(TD-QUEUE-NAME)                             17906306
179064              LENGTH(TD-QUEUE-NAME-LENGTH)                        17906406
179065              RESP(PV-CICS-RESPONSE)                              17906506
179066      END-EXEC.                                                   17906606
179067                                                                  17906706
179068      IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   17906806
179069          STRING 'DEQUEUE '                DELIMITED BY SIZE      17906906
179070                 TD-QUEUE-NAME             DELIMITED BY SIZE      17907006
179071                 ' (INTERNAL READER)'      DELIMITED BY SIZE      17907106
179072              INTO DP013-MESSAGE-TEXT(1)                          17907206
179073              SET DP013-CICS-ABEND                                17907306
179074                 DP013-ROLLBACK                                   17907406
179075                 DP013-DB2-ABEND                                  17907506
179076                 DP013-XCTL-DISPLAY-RESTART                       17907606
179077                               TO TRUE                            17907706
179078             PERFORM DP013-0000-PROCESS-ABEND                     17907806
179079      END-IF.                                                     17907906
179080                                                                  17908006
179081*** PK 11/25/13 HAZ SUMRY RPT END                                 17908106
179082                                                                  17908206
179083*----------------------------------------------------------------*17908306
179084* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *17908406
179085* OBJECT WAS UDPATED.                                            *17908506
179086*----------------------------------------------------------------*17908606
179087 6000-UPDATE-SELECTION-QUEUE.                                     17908706
179088     PERFORM 9100-READ-SEL-QUEUE.                                 17908806
179089     SET SU010-UPD (ASC-SEL-SUB) TO TRUE.                         17908906
179090     PERFORM 9200-REWRITE-LIST-QUEUE.                             17909006
179091                                                                  17909106
179092 7000-SUM-PALLETS.                                                17909206
179093     EXEC SQL                                                     17909306
179094         SELECT SUM(OBTS.UNUSD_PLLT_QTY)                          17909406
179095         INTO  :ASC-PALLETS                                       17909506
179096         FROM  TSUOBTS OBTS                                       17909606
179097         WHERE  OBTS.OTBND_TRIP_ID  = :DK-TRIP-ID                 17909706
179098     END-EXEC                                                     17909806
179099                                                                  17909906
179100     EVALUATE TRUE                                                17910006
179110         WHEN SQLCODE = ZERO                                      17911006
179200             CONTINUE                                             17920000
179300         WHEN SQLCODE = -305                                      17930000
179400             MOVE ZERO              TO ASC-PALLETS                17940000
179500         WHEN SQLCODE = -904                                      17950000
179600         WHEN SQLCODE = -911                                      17960000
179700         WHEN SQLCODE = -913                                      17970000
179800             MOVE '7000-SUM-PALLETS'                              17980000
179900                                       TO DP013-PARAGRAPH         17990000
180000             MOVE 'DB2 TIMEOUT ATTEMPTING TO ACCESS TRIP STATUS'  18000000
180100                                       TO DP013-MESSAGE-TEXT (1)  18010000
180200             MOVE SQLCA                TO DP013-SQLCA             18020000
180300             MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)18030000
180400             SET DP013-DB2-ABEND                                  18040000
180500                 DP013-XCTL-DISPLAY-RESTART                       18050000
180600                                   TO TRUE                        18060000
180700             PERFORM DP013-0000-PROCESS-ABEND                     18070000
180800         WHEN SQLWARN0 NOT = SPACES                               18080000
180900         WHEN SQLCODE < ZERO                                      18090000
181000         WHEN SQLCODE > ZERO                                      18100000
181100             MOVE '7000-SUM-PALLETS'                              18110000
181200                                   TO DP013-PARAGRAPH             18120000
181300             MOVE 'SUM UNUSED PALLETS'                            18130000
181400                                   TO DP013-MESSAGE-TEXT (1)      18140000
181500             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      18150000
181600             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          18160000
181700             MOVE SQLCA        TO DP013-SQLCA                     18170000
181800             MOVE 'SUTOBTS7'   TO DP013-DB2-TABLE-NAME (1)        18180000
181900             SET DP013-DB2-ABEND                                  18190000
182000                 DP013-XCTL-DISPLAY-RESTART                       18200000
182100                                   TO TRUE                        18210000
182200             PERFORM DP013-0000-PROCESS-ABEND                     18220000
182300     END-EVALUATE.                                                18230000
182400                                                                  18240000
182500                                                                  18250000
182600 7210-CHECK-FOR-TRIP-SUM.                                         18260000
182700                                                                  18270000
182800     SET PS-THERE-ARE-NO-SUMMARIES      TO TRUE                   18280000
182900     EXEC SQL                                                     18290000
183000         SELECT DISTINCT 1                                        18300000
183100         INTO :PS-YES-NO-SW                                       18310000
183200                                                                  18320000
183300         FROM SUT_TRIP_SUM TRIP                                   18330000
183400         WHERE                                                    18340000
183500              TRIP.OTBND_TRIP_ID  = :DK-TRIP-ID                   18350000
183600          AND TRIP.CART_QTY       > 0                             18360000
183700          AND TRIP.CRE_TMST >=                                    18370000
183800        (                                                         18380000
183900         SELECT MAX(OTBND_STAT_TMST)                              18390000
184000         FROM  TSUOBTS OBTS                                       18400000
184100         WHERE  OBTS.OTBND_TRIP_ID  = TRIP.OTBND_TRIP_ID          18410000
184200            AND TRIP_STAT_CDE = 'DC')                             18420000
184300     END-EXEC                                                     18430000
184400                                                                  18440000
184500     EVALUATE TRUE                                                18450000
184600         WHEN SQLCODE = ZERO                                      18460000
184700             SET PS-THERE-ARE-SUMMARIES TO TRUE                   18470000
184800         WHEN SQLCODE = -305                                      18480000
184900         WHEN SQLCODE = +100                                      18490000
185000             SET PS-THERE-ARE-NO-SUMMARIES TO TRUE                18500000
185100         WHEN SQLCODE = -904                                      18510000
185200         WHEN SQLCODE = -911                                      18520000
185300         WHEN SQLCODE = -913                                      18530000
185400             MOVE '7210-SELECT-CLOSED-TMST'                       18540000
185500                                       TO DP013-PARAGRAPH         18550000
185600             MOVE 'DB2 TIMEOUT ATTEMPTING TO ACCESS TRIP STATUS'  18560000
185700                                       TO DP013-MESSAGE-TEXT (1)  18570000
185800             MOVE SQLCA                TO DP013-SQLCA             18580000
185900             MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)18590000
186000             MOVE 'SUT00007'           TO DP013-DB2-TABLE-NAME (2)18600000
186100             SET DP013-DB2-ABEND                                  18610000
186200                 DP013-XCTL-DISPLAY-RESTART                       18620000
186300                                   TO TRUE                        18630000
186400             PERFORM DP013-0000-PROCESS-ABEND                     18640000
186500         WHEN SQLWARN0 NOT = SPACES                               18650000
186600         WHEN SQLCODE < ZERO                                      18660000
186700         WHEN SQLCODE > ZERO                                      18670000
186800             MOVE '7210-SELECT-CLOSED-TMST'                       18680000
186900                                   TO DP013-PARAGRAPH             18690000
187000             MOVE 'CHECK FOR TRIP SUMMARY'                        18700000
187100                                   TO DP013-MESSAGE-TEXT (1)      18710000
187200             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      18720000
187300             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          18730000
187400             MOVE SQLCA        TO DP013-SQLCA                     18740000
187500             MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)        18750000
187600             MOVE 'SUT00007'   TO DP013-DB2-TABLE-NAME (2)        18760000
187700             SET DP013-DB2-ABEND                                  18770000
187800                 DP013-XCTL-DISPLAY-RESTART                       18780000
187900                                   TO TRUE                        18790000
188000             PERFORM DP013-0000-PROCESS-ABEND                     18800000
188100     END-EVALUATE.                                                18810000
188200                                                                  18820000
188300 7220-GET-CURRENT-TRIP-STAT.                                      18830000
188400                                                                  18840000
188500     INITIALIZE ASC-TRIP-STAT-CDE                                 18850000
188600     MOVE ASC-TRIP-ID                 TO DK-TRIP-ID               18860000
188700     EXEC SQL                                                     18870000
188800         SELECT                                                   18880000
188900             OBTS.TRIP_STAT_CDE                                   18890000
189000         INTO                                                     18900000
189100            :SUOBTS-TRIP-STAT-CDE                                 18910000
189200         FROM  TSUOBTS OBTS                                       18920000
189300         WHERE  OBTS.OTBND_TRIP_ID     = :DK-TRIP-ID              18930000
189400           AND  OBTS.OTBND_STAT_TMST   =                          18940000
189500           (SELECT  MAX(OBTS1.OTBND_STAT_TMST)                    18950000
189600               FROM  TSUOBTS OBTS1                                18960000
189700            WHERE  OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)      18970000
189800     END-EXEC.                                                    18980000
189900                                                                  18990000
190000     EVALUATE TRUE                                                19000000
190100         WHEN SQLCODE = ZERO                                      19010000
190200         WHEN SQLCODE = -305                                      19020000
190300         WHEN SQLCODE = +100                                      19030000
190400             MOVE SUOBTS-TRIP-STAT-CDE TO ASC-TRIP-STAT-CDE       19040000
190500         WHEN SQLCODE = -904                                      19050000
190600         WHEN SQLCODE = -911                                      19060000
190700         WHEN SQLCODE = -913                                      19070000
190800             MOVE '7220-GET-CURRENT-TRIP-STAT'                    19080000
190900                                       TO DP013-PARAGRAPH         19090000
191000             MOVE 'DB2 TIMEOUT ATTEMPTING TO ACCESS TRIP STATUS'  19100000
191100                                       TO DP013-MESSAGE-TEXT (1)  19110000
191200             MOVE SQLCA                TO DP013-SQLCA             19120000
191300             MOVE 'TSUOBTS'            TO DP013-DB2-TABLE-NAME (1)19130000
191400             SET DP013-DB2-ABEND                                  19140000
191500                 DP013-XCTL-DISPLAY-RESTART                       19150000
191600                                   TO TRUE                        19160000
191700             PERFORM DP013-0000-PROCESS-ABEND                     19170000
191800         WHEN SQLWARN0 NOT = SPACES                               19180000
191900         WHEN SQLCODE < ZERO                                      19190000
192000         WHEN SQLCODE > ZERO                                      19200000
192100             MOVE '7220-GET-CURRENT-TRIP-STAT'                    19210000
192200                                   TO DP013-PARAGRAPH             19220000
192300             MOVE 'CHECK FOR CURRENT TRIP STATUS'                 19230000
192400                                   TO DP013-MESSAGE-TEXT (1)      19240000
192500             MOVE DK-TRIP-ID   TO PV-TRIP-ID                      19250000
192600             MOVE PV-TRIP-ID   TO DP013-MESSAGE-TEXT (2)          19260000
192700             MOVE SQLCA        TO DP013-SQLCA                     19270000
192800             MOVE 'TSUOBTS'    TO DP013-DB2-TABLE-NAME (1)        19280000
192900             SET DP013-DB2-ABEND                                  19290000
193000                 DP013-XCTL-DISPLAY-RESTART                       19300000
193100                                   TO TRUE                        19310000
193200             PERFORM DP013-0000-PROCESS-ABEND                     19320000
193300     END-EVALUATE.                                                19330000
193400/                                                                 19340000
193500 8000-LINK.                                                       19350000
193600     MOVE 'SUKCS597'                  TO PC047-CALLING-PROGRAM    19360000
193700     MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH       19370000
193800     EXEC CICS                                                    19380000
193900         LINK                                                     19390000
194000             PROGRAM   (PC-TRAILER-PROGRAM)                       19400000
194100             COMMAREA  (PC047-COMMAREA)                           19410000
194200             LENGTH    (PV-COMMAREA-LENGTH)                       19420000
194300     END-EXEC.                                                    19430000
194400                                                                  19440000
194500                                                                  19450000
194600 8300-LINK-SUKCS574.                                              19460000
194700                                                                  19470000
194800     INITIALIZE PC047-COMMAREA.                                   19480000
194900     MOVE SUOBTS-STAT-OPER-UNT-ID     TO PC047-OPER-UNT-ID.       19490000
195000     MOVE SUOBTS-DOOR-ID              TO PC047-DOOR-ID.           19500000
195100*LMM                                                              19510000
195300     MOVE SUOBTR-DEST-OPER-UNT-ID     TO PC047-DEST-OPER-UNT-ID.  19530000
195400     MOVE ASC-TRIP-ID                 TO PC047-OTBND-TRIP-ID.     19540000
195500     MOVE CNDCDR-DOOR-TYP-CDE         TO PC047-DOOR-TYPE-CDE.     19550000
195600                                                                  19560000
195700     MOVE LENGTH OF PC047-COMMAREA    TO PV-COMMAREA-LENGTH.      19570000
195800                                                                  19580000
195900     EXEC CICS                                                    19590000
196000         LINK  PROGRAM   (PC-SUMMARY-PROGRAM)                     19600000
196100               COMMAREA  (PC047-COMMAREA)                         19610000
196200               LENGTH    (PV-COMMAREA-LENGTH)                     19620000
196300               RESP      (PV-CICS-RESPONSE)                       19630000
196400     END-EXEC.                                                    19640000
196500                                                                  19650000
196600     EVALUATE TRUE                                                19660000
196700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 19670000
196800             CONTINUE                                             19680000
196900         WHEN OTHER                                               19690000
197000             MOVE '8300-LINK-SUKCS574'                            19700000
197100                                      TO DP013-PARAGRAPH          19710000
197200             MOVE 'SUKCS597 - UNABLE TO XCTL TO PROGRAM: '        19720000
197300                                      TO DP013-MESSAGE-TEXT (1)   19730000
197400             MOVE PC-SUMMARY-PROGRAM  TO DP013-MESSAGE-TEXT (2)   19740000
197500             SET DP013-CICS-ABEND                                 19750000
197600                 DP013-ROLLBACK                                   19760000
197700                 DP013-DB2-ABEND                                  19770000
197800                 DP013-XCTL-DISPLAY-RESTART                       19780000
197900                               TO TRUE                            19790000
198000             PERFORM DP013-0000-PROCESS-ABEND                     19800000
198100     END-EVALUATE.                                                19810000
198200                                                                  19820000
198210     PERFORM 5220-INSERT-WRKR-SUM.                                19821001
198220                                                                  19822001
198230                                                                  19823001
198300*----------------------------------------------------------------*19830000
198400* PERFORM A CICS SYNCPOINT                                        19840000
198500*----------------------------------------------------------------*19850000
198600 9000-SYNCPOINT.                                                  19860000
198700     EXEC CICS                                                    19870000
198800         SYNCPOINT                                                19880000
198900     END-EXEC.                                                    19890000
199000                                                                  19900000
199100*----------------------------------------------------------------*19910000
199200* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *19920000
199300*----------------------------------------------------------------*19930000
199400 9100-READ-SEL-QUEUE.                                             19940000
199410     EXEC CICS                                                    19941000
199420         READQ TS                                                 19942000
199430             QUEUE (ASC-SEL-QUEUE-NAME)                           19943000
199440             INTO  (SU010-SELECT-RECORD)                          19944000
199450             ITEM  (ASC-SEL-ITEM)                                 19945000
199460             RESP  (PV-CICS-RESPONSE)                             19946000
199470     END-EXEC.                                                    19947000
199480                                                                  19948000
199490     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   19949000
199500         CONTINUE                                                 19950000
199600     ELSE                                                         19960000
199700         SET DP013-LOGIC-ABEND                                    19970000
199800             DP013-NO-ROLLBACK     TO TRUE                        19980000
199900         MOVE '9100-READ-SEL-QUEUE'                               19990000
200000                                   TO DP013-PARAGRAPH             20000000
200100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   20010000
200200                                   TO DP013-MESSAGE-TEXT (1)      20020000
200300         PERFORM DP013-0000-PROCESS-ABEND                         20030000
200400     END-IF.                                                      20040000
200500*----------------------------------------------------------------*20050000
200600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *20060000
200700*----------------------------------------------------------------*20070000
200800 9200-REWRITE-LIST-QUEUE.                                         20080000
200900     EXEC CICS                                                    20090000
201000          WRITEQ TS                                               20100000
201100              QUEUE  (ASC-SEL-QUEUE-NAME)                         20110000
201200              FROM   (SU010-SELECT-RECORD)                        20120000
201300              ITEM   (ASC-SEL-ITEM)                               20130000
201400              RESP   (PV-CICS-RESPONSE)                           20140000
201500              REWRITE                                             20150000
201600     END-EXEC.                                                    20160000
201700                                                                  20170000
201800     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               20180000
201900         SET DP013-CICS-ABEND                                     20190000
202000             DP013-NO-ROLLBACK     TO TRUE                        20200000
202100         MOVE '9200-REWRITE-LIST-QUEUE'                           20210000
202200                                   TO DP013-PARAGRAPH             20220000
202300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   20230000
202400                                   TO DP013-MESSAGE-TEXT (1)      20240000
202500         PERFORM DP013-0000-PROCESS-ABEND                         20250000
202600     END-IF.                                                      20260000
202700                                                                  20270000
202800* JAK 02/07 - START NEW CODE                                      20280000
202900*----------------------------------------------------------------*20290000
203000* CHECK TO SEE IF DC IS DOWNLOADING ASN TO WMS                   *20300000
203100*----------------------------------------------------------------*20310000
203200 9300-CHECK-ASN-TO-WMS-STATUS.                                    20320000
203300     SET PS-DWNLD-ASN-TO-WMS-NO       TO TRUE.                    20330000
203310     MOVE ASC-DESTINATION-ID          TO DK-LOC-ID.               20331000
203320                                                                  20332000
203330     EXEC SQL                                                     20333000
203340          SELECT  FUNC_TXT                                        20334000
203350          INTO    :KRPRPM-FUNC-TXT                                20335000
203360          FROM  TKRPRPM                                           20336000
203370         WHERE  LOC_ID                   =  :DK-LOC-ID            20337000
203380           AND  SYS_PRC_FUNC_CDE         =  'SASNDN'              20338000
203390           AND  FUNC_PRC_STAT_CDE        =  'AC'                  20339000
203391           AND  INTFC_SYS_CDE            =  'KHL'                 20339100
203392           AND  FUNC_BEG_TMST            <  CURRENT TIMESTAMP     20339200
203393     END-EXEC.                                                    20339300
203394                                                                  20339400
203395     EVALUATE TRUE                                                20339500
203396         WHEN SQLCODE = ZERO                                      20339600
203397             IF KRPRPM-FUNC-TXT = 'Y'                             20339700
203398                 SET PS-DWNLD-ASN-TO-WMS-YES TO TRUE              20339800
203399             END-IF                                               20339900
203400         WHEN SQLCODE = +100                                      20340000
203401         WHEN SQLCODE = -904                                      20340100
203402         WHEN SQLCODE = -913                                      20340200
203403             CONTINUE                                             20340300
203404         WHEN SQLWARN0 NOT = SPACES                               20340400
203405         WHEN SQLCODE < ZERO                                      20340500
203406         WHEN SQLCODE > ZERO                                      20340600
203407             MOVE '9300-CHECK-ASN-TO-WMS-STATUS'                  20340700
203408                                   TO DP013-PARAGRAPH             20340800
203409             MOVE 'SELECT FUNC TXT'                               20340900
203410                                   TO DP013-MESSAGE-TEXT (1)      20341000
203411             MOVE DK-LOC-ID    TO PV-LOC-ID                       20341100
203412             MOVE PV-LOC-ID    TO DP013-MESSAGE-TEXT (2)          20341200
203413             MOVE SQLCA        TO DP013-SQLCA                     20341300
203414             MOVE 'TKRPRPM'    TO DP013-DB2-TABLE-NAME (1)        20341400
203415             SET DP013-DB2-ABEND                                  20341500
203416                 DP013-XCTL-DISPLAY-RESTART                       20341600
203417                                   TO TRUE                        20341700
203418             PERFORM DP013-0000-PROCESS-ABEND                     20341800
203419     END-EVALUATE.                                                20341900
203420*                                                                 20342000
203421                                                                  20342100
203422*----------------------------------------------------------------*20342200
203423* CALL THE ASN SHIPMENT CONTROL MODULE                           *20342300
203424*----------------------------------------------------------------*20342400
203425 9350-CALL-ASN-SHIP-CNTL-MOD.                                     20342500
203426     INITIALIZE WS004-FIELDS.                                     20342600
203427     SET WS004-SHIP-TRAILER        TO TRUE.                       20342700
203428     MOVE ASC-TRIP-ID              TO WS004-OTBND-TRIP-ID.        20342800
203429* JAK 08/2007 - CHANGE OPER-UNT-ID TO BE DESTINATION-ID           20342900
203430*    MOVE ASC-OPER-UNT-ID          TO WS004-OPER-UNT-ID.          20343000
203431     MOVE ASC-DESTINATION-ID       TO WS004-OPER-UNT-ID.          20343100
203432     SET WS004-SOURCE-SHIP         TO TRUE.                       20343200
203433     MOVE DP020-USERID             TO WS004-USER-ID.              20343300
203434     MOVE 'SUKCS597'               TO WS004-CALLING-PROGRAM-NAME. 20343400
203435     MOVE DP020-SRC-TASK-NUMBER    TO WS004-SRC-TASK-NUMBER.      20343500
203436                                                                  20343600
203437*    CALL PC-SHIP-CNTL-MOD         USING  DFHEIBLK                20343700
203438*                                       PC-SHIP-CNTL-MOD-LENGTH   20343800
203439*                                       WS004-FIELDS.             20343900
203440                                                                  20344000
203441     MOVE LENGTH OF WS004-FIELDS  TO  PV-COMMAREA-LENGTH.         20344100
203442     EXEC CICS                                                    20344200
203443         LINK PROGRAM  (PC-SHIP-CNTL-MOD)                         20344300
203444              COMMAREA (WS004-FIELDS)                             20344400
203445              LENGTH   (PV-COMMAREA-LENGTH)                       20344500
203446     END-EXEC.                                                    20344600
203447                                                                  20344700
203448     EVALUATE TRUE                                                20344800
203449         WHEN WS004-SUCCESSFUL                                    20344900
203450              CONTINUE                                            20345000
203451         WHEN WS004-INVALID-SQL                                   20345100
203452         WHEN WS004-DATABASE-BUSY                                 20345200
203453              SET DP013-LOGIC-ABEND TO TRUE                       20345300
203454              SET DP013-NO-ROLLBACK TO TRUE                       20345400
203455              MOVE PC-TSYMSG-03546                                20345500
203456                               TO DP020-MSG-NUMBER                20345600
203457              SET DP020-MSG-FATAL TO TRUE                         20345700
203458              MOVE '9300-CALL-ASN-SHIP-CNTL-MOD'                  20345800
203459                                   TO DP013-PARAGRAPH             20345900
203460              STRING 'BAD RETURN FROM '                           20346000
203461                   PC-SHIP-CNTL-MOD                               20346100
203462                   DELIMITED BY SIZE                              20346200
203463                                 INTO DP013-MESSAGE-TEXT(1)       20346300
203464              MOVE ' '             TO DP013-MESSAGE-TEXT(2)       20346400
203465         WHEN OTHER                                               20346500
203466              SET DP013-LOGIC-ABEND TO TRUE                       20346600
203467              SET DP013-NO-ROLLBACK TO TRUE                       20346700
203468              MOVE PC-TSYMSG-03548                                20346800
203469                               TO DP020-MSG-NUMBER                20346900
203470              SET DP020-MSG-FATAL TO TRUE                         20347000
203471              MOVE '9300-CALL-ASN-SHIP-CNTL-MOD'                  20347100
203472                                   TO DP013-PARAGRAPH             20347200
203473              STRING 'BAD RETURN FROM '                           20347300
203474                   PC-SHIP-CNTL-MOD                               20347400
203475                   DELIMITED BY SIZE                              20347500
203476                                 INTO DP013-MESSAGE-TEXT(1)       20347600
203477              MOVE ' '             TO DP013-MESSAGE-TEXT(2)       20347700
203478     END-EVALUATE.                                                20347800
203479* JAK 02/07 - END NEW CODE                                        20347900
203480                                                                  20348000
203490*----------------------------------------------------------------*20349000
203500*    ABEND PROCESSOR MODULE                                      *20350000
203600*----------------------------------------------------------------*20360000
203700     COPY DPPD013.                                                20370000
203800***************************************************************** 20380000
203900* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 20390000
204000     COPY PCPD049.                                                20400000
