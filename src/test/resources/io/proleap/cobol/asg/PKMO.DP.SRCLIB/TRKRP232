000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    TRKRP232.                                         00050000
000600 AUTHOR.        DAVE PHELPS                                       00060000
000700*               MIKE FRIESS - MAJOR REVISION 11/22/99             00070000
000800 INSTALLATION.  KOHLS.                                            00080000
000900 DATE-WRITTEN   AUG.,1998.                                        00090000
001000 DATE-COMPILED.                                                   00100000
001100                                                                  00110000
001200*----------------------------------------------------------------*00120000
001300*  THIS PROGRAM CREATES A DETAIL REPORT OF DATA THAT WAS LOADED   00130000
001400*  TO THE DB2 TABLES IN TRKUP235.                                 00140000
001500*----------------------------------------------------------------*00150000
001600                                                                  00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000                                                                  00200000
002100 CONFIGURATION SECTION.                                           00210000
002200                                                                  00220000
002300 SOURCE-COMPUTER.        IBM-3090.                                00230000
002400 OBJECT-COMPUTER.        IBM-3090.                                00240000
002500                                                                  00250000
002600 INPUT-OUTPUT SECTION.                                            00260000
002700                                                                  00270000
002800 FILE-CONTROL.                                                    00280000
002900                                                                  00290000
003000     SELECT LOAD-FILE                                             00300000
003100         ASSIGN TO INP01.                                         00310000
003200                                                                  00320000
003300     SELECT LOAD-REPORT-FILE                                      00330000
003400         ASSIGN TO RPT01.                                         00340000
003500                                                                  00350000
003600******************************************************************00360000
003700 DATA DIVISION.                                                   00370000
003800******************************************************************00380000
003900                                                                  00390000
004000 FILE SECTION.                                                    00400000
004100                                                                  00410000
004200 FD  LOAD-FILE                                                    00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     BLOCK CONTAINS 0 RECORDS.                                    00450000
004600                                                                  00460000
004700 01  LOAD-RECORD                      PIC  X(508).                00470000
004800                                                                  00480000
004900                                                                  00490000
005000 FD  LOAD-REPORT-FILE                                             00500000
005100     RECORDING MODE IS F                                          00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     BLOCK CONTAINS 0 RECORDS.                                    00530000
005400                                                                  00540000
005500 01  LOAD-REPORT-RECORD               PIC  X(132).                00550000
005600                                                                  00560000
005700                                                                  00570000
005800*----------------------------------------------------------------*00580000
005900 WORKING-STORAGE SECTION.                                         00590000
006000*----------------------------------------------------------------*00600000
006100                                                                  00610000
006200*----------------------------------------------------------------*00620000
006300***  WORK FIELDS FOR THE LOAD REPORT                              00630000
006400*----------------------------------------------------------------*00640000
006500     COPY TRRD231.                                                00650010
006600                                                                  00660000
006700*----------------------------------------------------------------*00670000
006800***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00680000
006900*----------------------------------------------------------------*00690000
007000     COPY DPWS132O.                                               00700009
007100                                                                  00710000
007200 01  HL-P1-PAGE-HEADER-1.                                         00720000
007300         10 FILLER                   PIC  X(02)      VALUE SPACES.00730000
007400     05  HL-P1-TRANS-DATE.                                        00740000
007500         10 HL-P1-TRANS-MM           PIC  X(02)      VALUE SPACE. 00750000
007600         10 FILLER                   PIC  X(01)      VALUE '/'.   00760000
007700         10 HL-P1-TRANS-DD           PIC  X(02)      VALUE SPACE. 00770000
007800         10 FILLER                   PIC  X(01)      VALUE '/'.   00780000
007900         10 HL-P1-TRANS-YY           PIC  X(02)      VALUE SPACE. 00790000
008000     05  FILLER                      PIC  X(02)      VALUE SPACE. 00800000
008100     05  HL-P1-TRANS-TIME.                                        00810000
008200         10 HL-P1-TRANS-TIME-HH      PIC  X(02)      VALUE SPACE. 00820000
008300         10 FILLER                   PIC  X(01)      VALUE ':'.   00830000
008400         10 HL-P1-TRANS-TIME-MM      PIC  X(02)      VALUE SPACE. 00840000
008500     05  FILLER                      PIC  X(01)      VALUE SPACE. 00850000
008600     05  FILLER                      PIC  X(13)      VALUE        00860000
008700         'TRANSMIT DATE'.                                         00870000
008800     05  FILLER                      PIC  X(16)      VALUE SPACE. 00880000
008900     05  FILLER                      PIC  X(38)      VALUE        00890000
009000         '    IMPORT PURCHASE ORDER TRACKING    '.                00900000
009100     05  FILLER                      PIC  X(16)      VALUE SPACE. 00910000
009200     05  FILLER                      PIC  X(07)      VALUE        00920000
009300         'FILE ID'.                                               00930000
009400     05  FILLER                      PIC  X(02)      VALUE SPACE. 00940000
009500     05  HL-P1-FILE-ID               PIC  X(09)      VALUE SPACE. 00950000
009600     05  FILLER                      PIC  X(13)      VALUE SPACE. 00960000
009700                                                                  00970000
009800 01  HL-P2-PAGE-HEADER-2.                                         00980000
009900         10 FILLER                   PIC  X(02)      VALUE SPACES.00990000
010000     05  HL-P2-LOAD-DATE.                                         01000000
010100         10 HL-P2-LOAD-MM            PIC  X(02)      VALUE SPACE. 01010000
010200         10 FILLER                   PIC  X(01)      VALUE '/'.   01020000
010300         10 HL-P2-LOAD-DD            PIC  X(02)      VALUE SPACE. 01030000
010400         10 FILLER                   PIC  X(01)      VALUE '/'.   01040000
010500         10 HL-P2-LOAD-YY            PIC  X(02)      VALUE SPACE. 01050000
010600     05  FILLER                      PIC  X(02)      VALUE SPACE. 01060000
010700     05  HL-P2-LOAD-TIME.                                         01070000
010800         10 HL-P2-LOAD-TIME-HH       PIC  X(02)      VALUE SPACE. 01080000
010900         10 FILLER                   PIC  X(01)      VALUE ':'.   01090000
011000         10 HL-P2-LOAD-TIME-MM       PIC  X(02)      VALUE SPACE. 01100000
011100     05  FILLER                      PIC  X(01)      VALUE SPACE. 01110000
011200     05  FILLER                      PIC  X(13)      VALUE        01120000
011300         'LOAD DATE    '.                                         01130000
011400     05  FILLER                      PIC  X(16)      VALUE SPACE. 01140000
011500     05  FILLER                      PIC  X(38)      VALUE        01150000
011600         ' VESSEL / VOYAGE ARRIVAL LOAD DETAILS '.                01160000
011700     05  FILLER                      PIC  X(16)      VALUE SPACE. 01170000
011800     05  HL-P2-ENTITY                PIC  X(30)      VALUE SPACE. 01180000
011900     05  FILLER                      PIC  X(01)      VALUE SPACE. 01190000
012000                                                                  01200000
012100 01  HL-C1-CNTNR-HEADER-1.                                        01210000
012200     05  FILLER                      PIC  X(14)      VALUE SPACE. 01220000
012300     05  FILLER                      PIC  X(07)      VALUE        01230000
012400         'CARRIER'.                                               01240000
012500     05  FILLER                      PIC  X(23)      VALUE SPACE. 01250000
012600     05  FILLER                      PIC  X(06)      VALUE        01260000
012700         'VOYAGE'.                                                01270000
012800     05  FILLER                      PIC  X(82)      VALUE SPACE. 01280000
012900                                                                  01290000
013000                                                                  01300000
013100 01  HL-C2-CNTNR-HEADER-2.                                        01310000
013200     05  FILLER                      PIC  X(09)      VALUE        01320000
013300         'CONTAINER'.                                             01330000
013400     05  FILLER                      PIC  X(05)      VALUE SPACE. 01340000
013500     05  FILLER                      PIC  X(04)      VALUE        01350000
013600         'SCAC'.                                                  01360000
013700     05  FILLER                      PIC  X(08)      VALUE SPACE. 01370000
013800     05  FILLER                      PIC  X(14)      VALUE        01380000
013900         'TRIP TYPE CODE'.                                        01390000
014000     05  FILLER                      PIC  X(04)      VALUE SPACE. 01400000
014100     05  FILLER                      PIC  X(06)      VALUE        01410000
014200         'NUMBER'.                                                01420000
014300     05  FILLER                      PIC  X(09)      VALUE SPACE. 01430000
014400     05  FILLER                      PIC  X(11)      VALUE        01440000
014500         'VESSEL NAME'.                                           01450000
014600     05  FILLER                      PIC  X(07)      VALUE SPACE. 01460008
014700     05  HL-C2-TEXT-MSG              PIC  X(40)      VALUE SPACE. 01470001
014800     05  FILLER                      PIC  X(15)      VALUE SPACE. 01480008
014900                                                                  01490000
015000 01  DL-C1-CNTNR-LINE.                                            01500000
015100     05  DL-C1-CONTAINER            PIC  X(12)    VALUE SPACES.   01510000
015200     05  FILLER                     PIC  X(02)    VALUE SPACES.   01520000
015300     05  DL-C1-CARRIER-SCAC         PIC  X(04)    VALUE SPACES.   01530000
015400     05  FILLER                     PIC  X(13)    VALUE SPACES.   01540000
015500     05  DL-C1-TRIP-TYPE            PIC  X(01)    VALUE SPACES.   01550000
015600     05  FILLER                     PIC  X(12)    VALUE SPACES.   01560000
015700     05  DL-C1-VOYAGE-NBR           PIC  X(10)    VALUE SPACES.   01570000
015800     05  FILLER                     PIC  X(05)    VALUE SPACES.   01580000
015900     05  DL-C1-VESSEL-NAME          PIC  X(25)    VALUE SPACES.   01590000
016000     05  FILLER                     PIC  X(60)    VALUE SPACES.   01600000
016100                                                                  01610000
016200 01  HL-D1-DETAIL-HEADER-1.                                       01620000
016300     05  FILLER                      PIC  X(04)      VALUE        01630000
016400         'RECD'.                                                  01640000
016500     05  FILLER                      PIC  X(03)      VALUE SPACE. 01650000
016600     05  FILLER                      PIC  X(03)      VALUE        01660000
016700         'TRN'.                                                   01670000
016800     05  FILLER                      PIC  X(16)      VALUE SPACE. 01680000
016900     05  FILLER                      PIC  X(08)      VALUE        01690000
017000         'EXTERNAL'.                                              01700000
017100     05  FILLER                      PIC  X(43)      VALUE SPACE. 01710000
017200     05  FILLER                      PIC  X(05)      VALUE        01720000
017300         'KOHLS'.                                                 01730000
017400     05  FILLER                      PIC  X(04)      VALUE SPACE. 01740000
017500     05  FILLER                      PIC  X(05)      VALUE        01750000
017600         'KOHLS'.                                                 01760000
017700     05  FILLER                      PIC  X(41)      VALUE SPACE. 01770000
017800                                                                  01780000
017900 01  HL-D2-DETAIL-HEADER-2.                                       01790000
018000     05  FILLER                      PIC  X(04)      VALUE        01800000
018100         'TYPE'.                                                  01810000
018200     05  FILLER                      PIC  X(03)      VALUE SPACE. 01820000
018300     05  FILLER                      PIC  X(04)      VALUE        01830000
018400         'TYPE'.                                                  01840000
018500     05  FILLER                      PIC  X(03)      VALUE SPACE. 01850000
018600     05  FILLER                      PIC  X(09)      VALUE        01860000
018700         'PO NUMBER'.                                             01870000
018800     05  FILLER                      PIC  X(03)      VALUE SPACE. 01880000
018900     05  FILLER                      PIC  X(13)      VALUE        01890000
019000         'REFERENCE NBR'.                                         01900000
019100     05  FILLER                      PIC  X(05)      VALUE SPACE. 01910000
019200     05  HL-D2-POE-COL-HDR           PIC  X(30)      VALUE SPACE. 01920000
019300     05  FILLER                      PIC  X(03)      VALUE SPACE. 01930000
019400     05  FILLER                      PIC  X(06)      VALUE        01940000
019500         'PO FOB'.                                                01950000
019600     05  FILLER                      PIC  X(03)      VALUE SPACE. 01960000
019700     05  FILLER                      PIC  X(04)      VALUE        01970000
019800         'SCAC'.                                                  01980000
019900     05  FILLER                      PIC  X(05)      VALUE SPACE. 01990000
020000     05  HL-D2-TIME-1-COL-HDR        PIC  X(17)      VALUE SPACE. 02000000
020100     05  FILLER                      PIC  X(20)      VALUE SPACE. 02010000
020200                                                                  02020000
020300 01  DL-D1-DETAIL-LINE.                                           02030000
020400     05  DL-D1-RECD-TYPE            PIC  X(06)    VALUE SPACES.   02040000
020500     05  FILLER                     PIC  X(03)    VALUE SPACES.   02050000
020600     05  DL-D1-TRN-TYP              PIC  X(01)    VALUE SPACES.   02060000
020700     05  FILLER                     PIC  X(04)    VALUE SPACES.   02070000
020800     05  DL-D1-PO-NBR               PIC  X(09)    VALUE SPACES.   02080000
020900     05  FILLER                     PIC  X(03)    VALUE SPACES.   02090000
021000     05  DL-D1-EXTL-REF-NBR         PIC  X(15)    VALUE SPACES.   02100000
021100     05  FILLER                     PIC  X(03)    VALUE SPACES.   02110000
021200     05  DL-D1-POE-NM               PIC  X(30)    VALUE SPACES.   02120000
021300     05  FILLER REDEFINES DL-D1-POE-NM.                           02130000
021400         10 DL-D1-ACTL-LBD-NME  PIC  X(18).                       02140000
021500         10 FILLER              PIC  X(12).                       02150000
021600     05  FILLER                     PIC  X(03)    VALUE SPACES.   02160000
021700     05  DL-D1-FOB-CDE              PIC  X(03)    VALUE SPACES.   02170000
021800     05  FILLER                     PIC  X(06)    VALUE SPACES.   02180000
021900     05  DL-D1-KOHLS-SCAC-CDE       PIC  X(04)    VALUE SPACES.   02190000
022000     05  FILLER                     PIC  X(05)    VALUE SPACES.   02200000
022100     05  DL-D1-DATE-1.                                            02210000
022200         10  DL-D1-DATE-1-MM        PIC  X(02)    VALUE SPACES.   02220000
022300         10  DL-D1-DATE-1-SLASH-1   PIC  X(01)    VALUE SPACES.   02230000
022400         10  DL-D1-DATE-1-DD        PIC  X(02)    VALUE SPACES.   02240000
022500         10  DL-D1-DATE-1-SLASH-2   PIC  X(01)    VALUE SPACES.   02250000
022600         10  DL-D1-DATE-1-CCYY      PIC  X(04)    VALUE SPACES.   02260000
022700     05  FILLER                     PIC  X(02)    VALUE SPACES.   02270000
022800     05  DL-D1-TIME-1.                                            02280000
022900         10  DL-D1-TIME-1-HH        PIC  X(02)    VALUE SPACES.   02290000
023000         10  DL-D1-TIME-1-COLON     PIC  X(01)    VALUE SPACES.   02300000
023100         10  DL-D1-TIME-1-MM        PIC  X(02)    VALUE SPACES.   02310000
023200     05  FILLER                     PIC  X(30)    VALUE SPACES.   02320000
023300                                                                  02330000
023400 01  TRL-HEADING-LINE-1.                                          02340000
023500     05  FILLER                      PIC  X(31)      VALUE        02350000
023600         'A = ADD, C = CHANGE, D = DELETE'.                       02360000
023700     05  FILLER                      PIC  X(101)     VALUE SPACE. 02370000
023800                                                                  02380000
023900 01  ER-END-OF-REPORT-LINE.                                       02390000
024000     05  FILLER                     PIC  X(54)    VALUE SPACE.    02400000
024100     05  FILLER                     PIC  X(25)    VALUE           02410000
024200         '***** END OF REPORT *****'.                             02420000
024300     05  FILLER                     PIC  X(53)    VALUE SPACE.    02430000
024400                                                                  02440000
024500 01  EP-EMPTY-REPORT-LINE.                                        02450000
024600     05  FILLER                     PIC  X(25)    VALUE           02460000
024700         '******* NO DATA *********'.                             02470000
024800     05  FILLER                     PIC  X(107)   VALUE SPACE.    02480000
024900                                                                  02490000
025000 01  PS-PROGRAM-SWITCHES.                                         02500000
025100     05  PS-EOF-LOAD-FILE-SW        PIC  X(01)    VALUE SPACE.    02510000
025200         88  PS-EOF-LOAD-FILE                     VALUE 'Y'.      02520000
025300     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    02530000
025400         88  PS-NEW-PAGE                          VALUE 'Y'.      02540000
025500         88  PS-NEW-PAGE-NO                       VALUE 'N'.      02550000
025600     05  PS-DETAIL-SW               PIC  X(01)    VALUE 'Y'.      02560000
025700         88  PS-DETAIL                            VALUE 'Y'.      02570000
025800         88  PS-DETAIL-NO                         VALUE 'N'.      02580000
025900                                                                  02590000
026000 01 PC-PROGRAM-CONSTANTS.                                         02600000
026100     05  PC-PAGE-SIZE-054           PIC S9(04)    VALUE +054      02610000
026200                                                  COMP SYNC.      02620000
026300     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      02630000
026400                                                  COMP SYNC.      02640000
026500     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +6        02650000
026600                                                  COMP SYNC.      02660000
026700     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        02670000
026800                                                  COMP SYNC.      02680000
026900     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       02690000
027000                                                  COMP SYNC.      02700000
027100     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           02710000
027200         'TRKRP232'.                                              02720000
027300     05  PC-A                       PIC  X(01)    VALUE 'A'.      02730000
027400     05  PC-01                      PIC  X(02)    VALUE '01'.     02740000
027500     05  PC-DEFAULT-DATE            PIC  X(10)    VALUE           02750000
027600         '01 01 0001'.                                            02760000
027700     05  PC-DEFAULT-TIME            PIC  X(05)    VALUE           02770000
027800         '00 00'.                                                 02780000
027900                                                                  02790000
028000 01  PV-PROGRAM-VARIABLES.                                        02800000
028100     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      02810000
028200                                                  COMP SYNC.      02820000
028300     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   02830000
028400     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   02840000
028500     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   02850000
028600         88 PV-ADU-REC-TYP-CDE-ADU       VALUE 'ADU  '.           02860000
028700         88 PV-ADD-REC-TYP-CDE-ADD       VALUE 'ADD  '.           02870000
028800         88 PV-ETA-REC-TYP-CDE-ETA       VALUE 'ETA  '.           02880000
028900     05  PV-PREV-CONTNR-ID          PIC  X(15)    VALUE SPACES.   02890000
029000     05  PV-PREV-TRN-TYP            PIC  X(01)    VALUE SPACES.   02900000
029100     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   02910000
029200     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     02920000
029300                                                                  02930000
029400 01  SD-SYSTEM-DATE.                                              02940000
029500     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   02950000
029600     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   02960000
029700     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   02970000
029800                                                                  02980000
029900 01  ST-SYSTEM-TIME.                                              02990000
030000     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   03000000
030100     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   03010000
030200     05  FILLER                     PIC  9(04)      VALUE ZERO.   03020000
030300                                                                  03030000
030400******************************************************************03040000
030500 PROCEDURE DIVISION.                                              03050000
030600******************************************************************03060000
030700                                                                  03070000
030800*----------------------------------------------------------------*03080000
030900* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     03090000
031000*      PROGRAM.                                                   03100000
031100*----------------------------------------------------------------*03110000
031200                                                                  03120000
031300 0000-PROGRAM-MAINLINE.                                           03130000
031400                                                                  03140000
031500     PERFORM 1000-INITIALIZE.                                     03150000
031600                                                                  03160000
031700     IF PS-DETAIL-NO                                              03170000
031800        CONTINUE                                                  03180000
031900     ELSE                                                         03190000
032000        PERFORM 2000-PROCESS-REPORT-DATA                          03200000
032100          UNTIL PS-EOF-LOAD-FILE.                                 03210000
032200                                                                  03220000
032300     PERFORM 9000-EOJ-ROUTINE.                                    03230000
032400                                                                  03240000
032500     STOP RUN.                                                    03250000
032600                                                                  03260000
032700******************************************************************03270000
032800*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    03280000
032900*    -- OPEN FILES                                                03290000
033000*    -- SET UP AND PRINT REPORT HEADINGS                          03300000
033100******************************************************************03310000
033200                                                                  03320000
033300 1000-INITIALIZE.                                                 03330000
033400                                                                  03340000
033500     OPEN INPUT  LOAD-FILE                                        03350000
033600          OUTPUT LOAD-REPORT-FILE.                                03360000
033700                                                                  03370000
033800     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03380000
033900     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03390000
034000                                                                  03400000
034100     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03410000
034200     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03420000
034300     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03430000
034400     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03440000
034500     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03450000
034600                                                                  03460000
034700     MOVE PC-CURRENT-PROGRAM-NAME                                 03470000
034800                                 TO DP132O-PROGRAM-NAME.          03480000
034900                                                                  03490000
035000     MOVE 1                      TO DP132O-REPORT-NUMBER.         03500000
035100                                                                  03510000
035200     INITIALIZE     PS-NEW-PAGE-SW.                               03520000
035300                                                                  03530000
035400     PERFORM 7000-READ-LOAD-FILE UNTIL                            03540000
035500             PS-EOF-LOAD-FILE OR                                  03550000
035600            (TR231-RPT-TYP-DETAIL AND                             03560000
035700             NOT TR231-REC-TYP-HDR-CDE-HDR).                      03570000
035800                                                                  03580000
035900     IF PS-EOF-LOAD-FILE                                          03590000
036000        CONTINUE                                                  03600000
036100     ELSE                                                         03610000
036200        MOVE TR231-CONTNR-ID  TO DL-C1-CONTAINER                  03620000
036300                                 PV-PREV-CONTNR-ID                03630000
036400        MOVE TR231-TRN-TYP    TO PV-PREV-TRN-TYP                  03640000
036500        MOVE TR231-ETA-CARR-SCAC-ID                               03650000
036600                              TO DL-C1-CARRIER-SCAC               03660000
036700        MOVE TR231-ETA-IMPRT-VEH-NM                               03670000
036800                              TO DL-C1-VESSEL-NAME                03680000
036900        MOVE TR231-ETA-IMPRT-TRIP-ID                              03690000
037000                              TO DL-C1-VOYAGE-NBR                 03700000
037100        MOVE TR231-ETA-TRIP-TYP-CDE-MOM                           03710000
037200                              TO DL-C1-TRIP-TYPE                  03720000
037300     END-IF.                                                      03730000
037400                                                                  03740000
037500     PERFORM  8000-WRITE-PAGE-HEADINGS.                           03750000
037600                                                                  03760000
037700     IF TR231-ERROR-TYPE = 'EMT' OR                               03770000
037800        PS-EOF-LOAD-FILE                                          03780000
037900        SET PS-DETAIL-NO TO TRUE                                  03790000
038000     ELSE                                                         03800000
038100        PERFORM 2025-BUILD-LOAD-RPT-DATA                          03810000
038200     END-IF.                                                      03820000
038300                                                                  03830000
038400****************************************************************  03840000
038500*  PROCESSING FOR LOAD RECORDS.                                   03850000
038600******************************************************************03860000
038700                                                                  03870000
038800 2000-PROCESS-REPORT-DATA.                                        03880000
038900                                                                  03890000
039000     MOVE SPACES TO TR231-RPT-TYP.                                03900000
039100                                                                  03910000
039200     PERFORM 7000-READ-LOAD-FILE UNTIL                            03920000
039300             PS-EOF-LOAD-FILE OR                                  03930000
039400            (TR231-RPT-TYP-DETAIL AND                             03940000
039500             NOT TR231-REC-TYP-HDR-CDE-HDR)                       03950000
039600                                                                  03960000
039700     IF PS-EOF-LOAD-FILE                                          03970000
039800        CONTINUE                                                  03980000
039900     ELSE                                                         03990000
040000        IF TR231-RPT-TYP-DETAIL                                   04000000
040100           PERFORM 2025-BUILD-LOAD-RPT-DATA                       04010000
040200        END-IF                                                    04020000
040300     END-IF.                                                      04030000
040400                                                                  04040000
040500******************************************************************04050000
040600*  BUILD THE LINES FOR THE REPORT.                                04060000
040700******************************************************************04070000
040800                                                                  04080000
040900 2025-BUILD-LOAD-RPT-DATA.                                        04090000
041000                                                                  04100000
041100     IF TR231-REC-TYP-ADU-CDE-ADU                                 04110000
041200        PERFORM 3100-MOVE-ADU-TO-DETAIL                           04120000
041300     END-IF.                                                      04130000
041400                                                                  04140000
041500     IF TR231-REC-TYP-ADURD-CDE-ADURDA                            04150002
041600        PERFORM 3200-MOVE-ADURD-TO-DETAIL                         04160002
041700     END-IF.                                                      04170002
041800                                                                  04180002
041900     IF TR231-REC-TYP-ETA-CDE-ETA                                 04190000
042000        PERFORM 3300-MOVE-ETA-TO-DETAIL                           04200000
042100     END-IF.                                                      04210000
042200                                                                  04220000
042300                                                                  04230000
042400*    *********************************************                04240000
042500*    * CLEAN UP DATE/TIME FIELDS BEFORE PRINT    *                04250000
042600*    *********************************************                04260000
042700     IF DL-D1-DATE-1-MM      NOT NUMERIC OR                       04270000
042800        DL-D1-DATE-1       = PC-DEFAULT-DATE                      04280000
042900        MOVE SPACES TO DL-D1-DATE-1                               04290000
043000     ELSE                                                         04300000
043100        MOVE '/'   TO DL-D1-DATE-1-SLASH-1                        04310000
043200                      DL-D1-DATE-1-SLASH-2                        04320000
043300     END-IF.                                                      04330000
043400                                                                  04340000
043500*    IF DL-D1-DATE-2-MM      NOT NUMERIC OR                       04350000
043600*       DL-D1-DATE-2       = PC-DEFAULT-DATE                      04360000
043700*       MOVE SPACES TO DL-D1-DATE-2                               04370000
043800*    ELSE                                                         04380000
043900*       MOVE '/'   TO DL-D1-DATE-2-SLASH-1                        04390000
044000*                     DL-D1-DATE-2-SLASH-2                        04400000
044100*    END-IF.                                                      04410000
044200                                                                  04420000
044300     IF DL-D1-TIME-1-HH      NOT NUMERIC OR                       04430000
044400        DL-D1-TIME-1       = PC-DEFAULT-TIME                      04440000
044500        MOVE SPACES TO DL-D1-TIME-1                               04450000
044600     ELSE                                                         04460000
044700        MOVE ':' TO DL-D1-TIME-1-COLON                            04470000
044800     END-IF.                                                      04480000
044900                                                                  04490000
045000*    IF DL-D1-TIME-2-HH      NOT NUMERIC OR                       04500000
045100*       DL-D1-TIME-2       = PC-DEFAULT-TIME                      04510000
045200*       MOVE SPACES TO DL-D1-TIME-2                               04520000
045300*    ELSE                                                         04530000
045400*       MOVE ':' TO DL-D1-TIME-2-COLON                            04540000
045500*    END-IF.                                                      04550000
045600*    *********************************************                04560000
045700                                                                  04570000
045800     PERFORM 2050-CHECK-FOR-PREVIOUS.                             04580000
045900                                                                  04590000
046000     PERFORM 8100-WRITE-LOAD-RPT-DETAIL.                          04600000
046100                                                                  04610000
046200****************************************************************  04620000
046300*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             04630000
046400*  DATA IS NOT REPEATED FOR CONTAINER-NO                          04640000
046500* *************************************************************** 04650000
046600                                                                  04660000
046700 2050-CHECK-FOR-PREVIOUS.                                         04670000
046800                                                                  04680000
046900                                                                  04690000
047000     IF TR231-CONTNR-ID = PV-PREV-CONTNR-ID  AND                  04700000
047100        TR231-TRN-TYP   = PV-PREV-TRN-TYP    AND                  04710000
047200        (TR231-ERROR-TYPE   NOT =  'EDI')                         04720000
047300        CONTINUE                                                  04730000
047400     ELSE                                                         04740000
047500        MOVE TR231-CONTNR-ID     TO DL-C1-CONTAINER               04750000
047600                                    PV-PREV-CONTNR-ID             04760000
047700        MOVE TR231-TRN-TYP    TO PV-PREV-TRN-TYP                  04770000
047800        MOVE TR231-ETA-CARR-SCAC-ID                               04780000
047900                              TO DL-C1-CARRIER-SCAC               04790000
048000        MOVE TR231-ETA-IMPRT-VEH-NM                               04800000
048100                              TO DL-C1-VESSEL-NAME                04810000
048200        MOVE TR231-ETA-IMPRT-TRIP-ID                              04820000
048300                              TO DL-C1-VOYAGE-NBR                 04830000
048400        MOVE TR231-ETA-TRIP-TYP-CDE-MOM                           04840000
048500                              TO DL-C1-TRIP-TYPE                  04850000
048600                                                                  04860000
048700        SET PS-NEW-PAGE         TO TRUE                           04870000
048800        PERFORM  8000-WRITE-PAGE-HEADINGS                         04880000
048900     END-IF.                                                      04890000
049000                                                                  04900000
049100                                                                  04910000
049200******************************************************************04920000
049300* MOVE ADU DATA TO REPORT DETAIL LINE                             04930000
049400******************************************************************04940000
049500 3100-MOVE-ADU-TO-DETAIL.                                         04950000
049600                                                                  04960000
049700     INITIALIZE   DL-D1-DETAIL-LINE.                              04970000
049800                                                                  04980000
049900     MOVE TR231-REC-TYP-ADU-CDE       TO DL-D1-RECD-TYPE.         04990000
050000     MOVE TR231-TRN-TYP               TO DL-D1-TRN-TYP.           05000000
050100     MOVE TR231-PO-NBR                TO DL-D1-PO-NBR.            05010000
050200     MOVE TR231-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05020000
050300     MOVE TR231-FOB-CDE               TO DL-D1-FOB-CDE.           05030000
050400     MOVE TR231-EXTENT-SCAC-CDE       TO DL-D1-KOHLS-SCAC-CDE.    05040000
050500                                                                  05050000
050600     MOVE TR231-ADU-ACTL-DEST-POE-NM  TO DL-D1-POE-NM.            05060000
050700                                                                  05070000
050800     MOVE TR231-ADU-ACTL-POE-DELY-DTE (1:4) TO                    05080000
050900         DL-D1-DATE-1-CCYY.                                       05090000
051000     MOVE TR231-ADU-ACTL-POE-DELY-DTE (5:2) TO                    05100000
051100         DL-D1-DATE-1-MM.                                         05110000
051200     MOVE TR231-ADU-ACTL-POE-DELY-DTE (7:2) TO                    05120000
051300         DL-D1-DATE-1-DD.                                         05130000
051400                                                                  05140000
051500     MOVE TR231-ADU-ACTL-POE-DELY-TM (1:2) TO                     05150000
051600           DL-D1-TIME-1-HH.                                       05160000
051700     MOVE TR231-ADU-ACTL-POE-DELY-TM (3:2) TO                     05170000
051800           DL-D1-TIME-1-MM.                                       05180000
051900                                                                  05190000
052000     MOVE 'ACTUAL PORT OF ENTRY         '                         05200000
052100                             TO HL-D2-POE-COL-HDR.                05210000
052200     MOVE 'ATA              '                                     05220000
052300                             TO HL-D2-TIME-1-COL-HDR.             05230000
052400*    MOVE SPACES             TO HL-D2-LBD-COL-HDR.                05240000
052500*    MOVE SPACES             TO HL-D2-TIME-2-COL-HDR.             05250000
052600                                                                  05260000
052700******************************************************************05270002
052800* MOVE ADURD DATA TO REPORT DETAIL LINE                           05280002
052900******************************************************************05290002
053000 3200-MOVE-ADURD-TO-DETAIL.                                       05300002
053100                                                                  05310002
053200     INITIALIZE   DL-D1-DETAIL-LINE.                              05320002
053300                                                                  05330002
053400     MOVE TR231-REC-TYP-ADURD-CDE (1:3)                           05340005
053500                                      TO DL-D1-RECD-TYPE.         05350002
053600     MOVE TR231-TRN-TYP               TO DL-D1-TRN-TYP.           05360002
053700     MOVE TR231-PO-NBR                TO DL-D1-PO-NBR.            05370002
053800     MOVE TR231-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05380002
053900     MOVE TR231-FOB-CDE               TO DL-D1-FOB-CDE.           05390002
054000     MOVE TR231-EXTENT-SCAC-CDE       TO DL-D1-KOHLS-SCAC-CDE.    05400002
054100     MOVE TR231-ADURD-ACTL-DEST-POE-NM        TO DL-D1-POE-NM.    05410002
054200                                                                  05420002
054300     MOVE TR231-ADURD-ACTL-POE-DELY-DTE (1:4) TO                  05430004
054400         DL-D1-DATE-1-CCYY.                                       05440002
054500     MOVE TR231-ADURD-ACTL-POE-DELY-DTE (5:2) TO                  05450002
054600         DL-D1-DATE-1-MM.                                         05460002
054700     MOVE TR231-ADURD-ACTL-POE-DELY-DTE (7:2) TO                  05470002
054800         DL-D1-DATE-1-DD.                                         05480002
054900                                                                  05490002
055000     MOVE TR231-ADURD-ACTL-POE-DELY-TM (1:2) TO                   05500002
055100           DL-D1-TIME-1-HH.                                       05510002
055200     MOVE TR231-ADURD-ACTL-POE-DELY-TM (3:2) TO                   05520002
055300           DL-D1-TIME-1-MM.                                       05530002
055400                                                                  05540002
055500     MOVE 'ACTUAL PORT OF ENTRY         '                         05550002
055600                             TO HL-D2-POE-COL-HDR.                05560002
055700     MOVE 'ATA              '                                     05570002
055800                             TO HL-D2-TIME-1-COL-HDR.             05580002
055900*    MOVE SPACES             TO HL-D2-LBD-COL-HDR.                05590002
056000*    MOVE SPACES             TO HL-D2-TIME-2-COL-HDR.             05600002
056100                                                                  05610002
056200******************************************************************05620000
056300*MOVE ETA DATA TO REPORT DETAIL LINE                              05630000
056400******************************************************************05640000
056500                                                                  05650000
056600 3300-MOVE-ETA-TO-DETAIL.                                         05660000
056700                                                                  05670000
056800     INITIALIZE   DL-D1-DETAIL-LINE.                              05680000
056900                                                                  05690000
057000     MOVE TR231-REC-TYP-ETA-CDE       TO DL-D1-RECD-TYPE.         05700000
057100     MOVE TR231-TRN-TYP               TO DL-D1-TRN-TYP.           05710000
057200     MOVE TR231-PO-NBR                TO DL-D1-PO-NBR.            05720000
057300     MOVE TR231-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05730000
057400     MOVE TR231-FOB-CDE               TO DL-D1-FOB-CDE.           05740000
057500     MOVE TR231-EXTENT-SCAC-CDE       TO DL-D1-KOHLS-SCAC-CDE.    05750000
057600                                                                  05760000
057700     MOVE TR231-ETA-DEST-POE-NM       TO DL-D1-POE-NM.            05770000
057800                                                                  05780000
057900     MOVE TR231-ETA-EST-POE-DELY-DTE (1:4) TO                     05790000
058000         DL-D1-DATE-1-CCYY.                                       05800000
058100     MOVE TR231-ETA-EST-POE-DELY-DTE (5:2) TO                     05810000
058200         DL-D1-DATE-1-MM.                                         05820000
058300     MOVE TR231-ETA-EST-POE-DELY-DTE (7:2) TO                     05830000
058400         DL-D1-DATE-1-DD.                                         05840000
058500                                                                  05850000
058600     MOVE TR231-ETA-EST-POE-DELY-TM (1:2) TO                      05860000
058700         DL-D1-TIME-1-HH.                                         05870000
058800     MOVE TR231-ETA-EST-POE-DELY-TM (3:2) TO                      05880000
058900         DL-D1-TIME-1-MM.                                         05890000
059000                                                                  05900000
059100*    MOVE TR231-ETA-EST-LBD-NM        TO                          05910000
059200*        DL-D1-EST-LBD-NM.                                        05920000
059300                                                                  05930000
059400*    MOVE TR231-ETA-EST-LBD-DTE (1:4) TO                          05940000
059500*        DL-D1-DATE-2-CCYY.                                       05950000
059600*    MOVE TR231-ETA-EST-LBD-DTE (5:2) TO                          05960000
059700*        DL-D1-DATE-2-MM.                                         05970000
059800*    MOVE TR231-ETA-EST-LBD-DTE (7:2) TO                          05980000
059900*        DL-D1-DATE-2-DD.                                         05990000
060000                                                                  06000000
060100*    MOVE TR231-ETA-EST-LBD-TM (1:2) TO                           06010000
060200*          DL-D1-TIME-2-HH.                                       06020000
060300*    MOVE TR231-ETA-EST-LBD-TM (3:2) TO                           06030000
060400*          DL-D1-TIME-2-MM.                                       06040000
060500                                                                  06050000
060600     MOVE 'ESTIMATED PORT OF ENTRY      '                         06060000
060700                             TO HL-D2-POE-COL-HDR.                06070000
060800     MOVE 'ETA              '                                     06080000
060900                             TO HL-D2-TIME-1-COL-HDR.             06090000
061000*    MOVE 'EST LBD DEST '                                         06100000
061100*                            TO HL-D2-LBD-COL-HDR.                06110000
061200*    MOVE 'EST LB DATE  TIME'                                     06120000
061300*                            TO HL-D2-TIME-2-COL-HDR.             06130000
061400                                                                  06140000
061500******************************************************************06150000
061600*  READ THE LOAD-FILE                                            *06160000
061700******************************************************************06170000
061800 7000-READ-LOAD-FILE.                                             06180000
061900                                                                  06190000
062000     READ LOAD-FILE                                               06200000
062100        INTO TR231-RECORD                                         06210000
062200           AT END                                                 06220000
062300              SET PS-EOF-LOAD-FILE TO TRUE.                       06230000
062400                                                                  06240000
062500     IF TR231-REC-TYP-HDR-CDE-HDR                                 06250000
062600        MOVE TR231-HDR-CONSOL-TRNS-DTE (5:2) TO                   06260000
062700           HL-P1-TRANS-MM                                         06270000
062800        MOVE TR231-HDR-CONSOL-TRNS-DTE (7:2) TO                   06280000
062900           HL-P1-TRANS-DD                                         06290000
063000        MOVE TR231-HDR-CONSOL-TRNS-DTE (3:2) TO                   06300000
063100           HL-P1-TRANS-YY                                         06310000
063200        MOVE TR231-HDR-CONSOL-TRNS-TM (1:2) TO                    06320000
063300           HL-P1-TRANS-TIME-HH                                    06330000
063400        MOVE TR231-HDR-CONSOL-TRNS-TM (3:2) TO                    06340000
063500           HL-P1-TRANS-TIME-MM                                    06350000
063600        MOVE TR231-HDR-CONSOL-FIL-ID TO                           06360000
063700           HL-P1-FILE-ID                                          06370000
063800        MOVE TR231-HDR-LOAD-DTE (5:2) TO                          06380000
063900           HL-P2-LOAD-MM                                          06390000
064000        MOVE TR231-HDR-LOAD-DTE (7:2) TO                          06400000
064100           HL-P2-LOAD-DD                                          06410000
064200        MOVE TR231-HDR-LOAD-DTE (3:2) TO                          06420000
064300           HL-P2-LOAD-YY                                          06430000
064400        MOVE TR231-HDR-LOAD-TM (1:2) TO                           06440000
064500           HL-P2-LOAD-TIME-HH                                     06450000
064600        MOVE TR231-HDR-LOAD-TM (3:2) TO                           06460000
064700           HL-P2-LOAD-TIME-MM                                     06470000
064800        MOVE TR231-HDR-CONSOL-ENTNME TO                           06480000
064900           HL-P2-ENTITY                                           06490000
065000        MOVE TR231-REC-TYP-HDR-CDE TO                             06500000
065100           PV-REC-TYP-CDE-PREV                                    06510000
065200     END-IF.                                                      06520000
065300                                                                  06530000
065400***************************************************************** 06540000
065500*  PRINT THE HEADINGS ON EACH PAGE.                             * 06550000
065600***************************************************************** 06560000
065700                                                                  06570000
065800 8000-WRITE-PAGE-HEADINGS.                                        06580000
065900                                                                  06590000
066000     ADD 1                TO PV-PAGE-COUNT.                       06600000
066100     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  06610000
066200                                                                  06620000
066300     IF PV-PAGE-COUNT > 1                                         06630000
066400        PERFORM                                                   06640000
066500           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          06650000
066600           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 06660000
066700                                                                  06670000
066800           WRITE LOAD-REPORT-RECORD FROM PV-BLANK-LINE            06680000
066900              AFTER ADVANCING 1 LINE                              06690000
067000                                                                  06700000
067100        END-PERFORM                                               06710000
067200                                                                  06720000
067300        IF PV-LINES-USED > PC-PAGE-SIZE-060                       06730000
067400           WRITE LOAD-REPORT-RECORD FROM TRL-HEADING-LINE-1       06740000
067500              AFTER ADVANCING 2 LINES                             06750000
067600        END-IF                                                    06760000
067700     END-IF.                                                      06770000
067800                                                                  06780000
067900     WRITE LOAD-REPORT-RECORD FROM  DP132O-STANDRD-HEADER-132-COLS06790000
068000        AFTER ADVANCING PAGE.                                     06800000
068100                                                                  06810000
068200     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       06820000
068300                                                                  06830000
068400     WRITE LOAD-REPORT-RECORD FROM HL-P1-PAGE-HEADER-1            06840000
068500        AFTER ADVANCING 1 LINE.                                   06850000
068600                                                                  06860000
068700     WRITE LOAD-REPORT-RECORD FROM HL-P2-PAGE-HEADER-2            06870000
068800        AFTER ADVANCING 1 LINE.                                   06880000
068900                                                                  06890000
069000     WRITE LOAD-REPORT-RECORD FROM HL-C1-CNTNR-HEADER-1           06900000
069100        AFTER ADVANCING 2 LINES.                                  06910000
069200                                                                  06920000
069300     IF TR231-REC-TYP-ADURD-CDE-ADURDA                            06930001
069400        MOVE TR231-ADURD-TEXT-MSG1    TO HL-C2-TEXT-MSG           06940001
069500     ELSE                                                         06950001
069600         MOVE SPACES                  TO HL-C2-TEXT-MSG           06960001
069700     END-IF.                                                      06970001
069800                                                                  06980006
069900     WRITE LOAD-REPORT-RECORD FROM HL-C2-CNTNR-HEADER-2           06990006
070000        AFTER ADVANCING 1 LINES.                                  07000006
070100                                                                  07010000
070200     WRITE LOAD-REPORT-RECORD FROM DL-C1-CNTNR-LINE               07020000
070300        AFTER ADVANCING 1 LINES.                                  07030000
070400                                                                  07040000
070500     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07050000
070600                                                                  07060000
070700******************************************************************07070000
070800*  WRITE THE LOAD REPORT DETAIL RECORD.                           07080000
070900******************************************************************07090000
071000                                                                  07100000
071100 8100-WRITE-LOAD-RPT-DETAIL.                                      07110000
071200                                                                  07120000
071300     IF PV-LINES-USED >= PC-PAGE-SIZE-054                         07130000
071400        SET PS-NEW-PAGE  TO TRUE                                  07140000
071500        PERFORM 8000-WRITE-PAGE-HEADINGS                          07150000
071600     END-IF.                                                      07160000
071700                                                                  07170000
071800     EVALUATE TRUE                                                07180000
071900                                                                  07190000
072000       WHEN TR231-REC-TYP-ADU-CDE-ADU                             07200000
072100       WHEN TR231-REC-TYP-ADURD-CDE-ADURDA                        07210003
072200       WHEN TR231-REC-TYP-ETA-CDE-ETA                             07220000
072300        PERFORM 8200-WRITE-DETAIL-RECORD                          07230000
072400                                                                  07240000
072500       WHEN OTHER                                                 07250000
072600        DISPLAY '** INVALID RECORD TYPE - '                       07260000
072700        DISPLAY  TR231-REC-TYP-ETA-CDE                            07270000
072800                                                                  07280000
072900     END-EVALUATE.                                                07290000
073000                                                                  07300000
073100******************************************************************07310000
073200*  PRINT DETAIL LOAD RECORD                                       07320000
073300******************************************************************07330000
073400                                                                  07340000
073500 8200-WRITE-DETAIL-RECORD.                                        07350000
073600                                                                  07360000
073700     IF TR231-REC-TYP-ETA-CDE = PV-REC-TYP-CDE-PREV AND           07370000
073800        PS-NEW-PAGE-NO                                            07380000
073900        CONTINUE                                                  07390000
074000     ELSE                                                         07400000
074100        WRITE LOAD-REPORT-RECORD FROM HL-D1-DETAIL-HEADER-1       07410000
074200           AFTER ADVANCING 2 LINES                                07420000
074300        WRITE LOAD-REPORT-RECORD FROM HL-D2-DETAIL-HEADER-2       07430000
074400           AFTER ADVANCING 1 LINES                                07440000
074500        ADD 3 TO PV-LINES-USED                                    07450000
074600     END-IF.                                                      07460000
074700                                                                  07470000
074800     WRITE LOAD-REPORT-RECORD FROM DL-D1-DETAIL-LINE              07480000
074900        AFTER ADVANCING 1 LINES.                                  07490000
075000     ADD 1 TO PV-LINES-USED.                                      07500000
075100                                                                  07510000
075200     SET PS-NEW-PAGE-NO TO TRUE.                                  07520000
075300     MOVE TR231-REC-TYP-ADU-CDE TO  PV-REC-TYP-CDE-PREV.          07530000
075400                                                                  07540000
075500******************************************************************07550000
075600*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  07560000
075700*  THE CURSOR.                                                    07570000
075800******************************************************************07580000
075900                                                                  07590000
076000 9000-EOJ-ROUTINE.                                                07600000
076100                                                                  07610000
076200     IF PS-DETAIL-NO                                              07620000
076300        WRITE LOAD-REPORT-RECORD FROM EP-EMPTY-REPORT-LINE        07630000
076400            AFTER ADVANCING 2 LINES                               07640000
076500                                                                  07650000
076600        WRITE LOAD-REPORT-RECORD FROM ER-END-OF-REPORT-LINE       07660000
076700            AFTER ADVANCING 2 LINES                               07670000
076800     ELSE                                                         07680000
076900        IF PV-LINES-USED > PC-PAGE-SIZE-060                       07690000
077000           PERFORM 8000-WRITE-PAGE-HEADINGS                       07700000
077100        END-IF                                                    07710000
077200                                                                  07720000
077300        WRITE LOAD-REPORT-RECORD FROM ER-END-OF-REPORT-LINE       07730000
077400            AFTER ADVANCING 2 LINES                               07740000
077500                                                                  07750000
077600        ADD 2 TO PV-LINES-USED                                    07760000
077700                                                                  07770000
077800        PERFORM                                                   07780000
077900           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          07790000
078000           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 07800000
078100                                                                  07810000
078200           WRITE LOAD-REPORT-RECORD FROM PV-BLANK-LINE            07820000
078300              AFTER ADVANCING 1 LINE                              07830000
078400                                                                  07840000
078500        END-PERFORM                                               07850000
078600                                                                  07860000
078700        IF PV-LINES-USED > PC-PAGE-SIZE-060                       07870000
078800           WRITE LOAD-REPORT-RECORD FROM TRL-HEADING-LINE-1       07880000
078900              AFTER ADVANCING 2 LINES                             07890000
079000        END-IF                                                    07900000
079100     END-IF.                                                      07910000
079200                                                                  07920000
079300     CLOSE LOAD-FILE                                              07930000
079400           LOAD-REPORT-FILE.                                      07940000
