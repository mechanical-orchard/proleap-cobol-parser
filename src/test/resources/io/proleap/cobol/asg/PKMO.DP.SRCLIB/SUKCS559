000100 TITLE 'S559 - SHIPPING DOOR STATUS  - OUTBOUND TRAILER LIST'.    00010049
000200 IDENTIFICATION DIVISION.                                         00020032
000300 PROGRAM-ID.    SUKCS559.                                         00030049
000400 AUTHOR.        DENNIS STEFFEN.                                   00040049
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050049
000600 DATE-WRITTEN.  JUNE, 2001.                                       00060049
000700 DATE-COMPILED.                                                   00070049
263968*---------------------------------------------------------------* 00071074
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00072074
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00073074
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00074074
001130*                                                                 00074175
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00074275
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00074375
263968*---------------------------------------------------------------* 00075074
000800 ENVIRONMENT DIVISION.                                            00080049
000900 DATA DIVISION.                                                   00090049
001000                                                                  00100049
001100 WORKING-STORAGE SECTION.                                         00110049
001200 01  DK-DB2-KEYS.                                                 00120049
001300     05  DK-STATUS-DAYS                 PIC S9(08)  VALUE ZERO    00130049
001400                                                    COMP-3.       00140049
001500     05  DK-FROM-TMST                   PIC  X(26)  VALUE SPACES. 00150049
001600     05  DK-TO-TMST                     PIC  X(26)  VALUE SPACES. 00160049
001700     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00170049
001800                                                    COMP.         00180049
001900     05  DK-DEST-STR-NBR                PIC S9(04)  VALUE ZERO    00190049
002000                                                    COMP.         00200049
002100     05  DK-TRLR-SRL-NBR                PIC S9(09)  VALUE ZERO    00210049
002200                                                    COMP.         00220049
002300     05  DK-TRIP-ID                     PIC S9(09)  VALUE ZERO    00230049
002400                                                    COMP.         00240049
002500     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00250049
002600                                                    COMP.         00260049
002700     05  DK-DOOR-ID                     PIC X(04)  VALUE SPACES.  00270049
002800     05  DK-DOOR-TYPE.                                            00280049
002900         10  DK-SHUTTLE                 PIC X(02) VALUE SPACES.   00290049
003000         10  DK-SHIPPING                PIC X(02) VALUE SPACES.   00300049
003100         10  DK-RECEIVING               PIC X(02) VALUE SPACES.   00310049
003200         10  DK-STORAGE                 PIC X(02) VALUE SPACES.   00320049
003300         10  DK-STRIPPING               PIC X(02) VALUE SPACES.   00330049
003400         10  DK-YARD                    PIC X(02) VALUE SPACES.   00340049
003500     05  DK-SCAC-CODE                   PIC X(04)  VALUE SPACES.  00350049
003600     05  DK-TRLR-STATUS.                                          00360049
003700         10  DK-DCOPEN                  PIC X(02)  VALUE SPACES.  00370049
003800         10  DK-DCCLOSED                PIC X(02)  VALUE SPACES.  00380049
003900         10  DK-SHIPPED                 PIC X(02)  VALUE SPACES.  00390049
004000         10  DK-AUDIT                   PIC X(02)  VALUE SPACES.  00400049
004100         10  DK-STOREOPEN               PIC X(02)  VALUE SPACES.  00410049
004200         10  DK-STOREUNLOADED           PIC X(02)  VALUE SPACES.  00420049
004300     05  DK-STAT-CODES.                                           00430049
004400         10  DK-STAT-CDE1               PIC X(02).                00440049
004500         10  DK-STAT-CDE2               PIC X(02).                00450049
004600         10  DK-STAT-CDE3               PIC X(02).                00460049
004700         10  DK-STAT-CDE4               PIC X(02).                00470049
004800         10  DK-STAT-CDE5               PIC X(02).                00480049
004900         10  DK-STAT-CDE6               PIC X(02).                00490049
005000         10  DK-STAT-CDE7               PIC X(02).                00500049
005100         10  DK-STAT-CDE8               PIC X(02).                00510049
005200                                                                  00520049
005300 01  PC-PROGRAM-CONSTANTS.                                        00530049
005400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU559A  '.  00540049
005500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM559'.   00550049
005600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS559'.  00560049
005700     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00570049
006100     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00610032
006200     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00620032
006300     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00630032
006400     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00640032
006500     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00650032
006600                                               COMP SYNC.         00660032
006700     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00670032
006800                                               COMP SYNC.         00680032
006900     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00690032
007000                                               COMP-3.            00700032
007100     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00710032
007200                                               COMP SYNC.         00720032
007300     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00730032
007400                                               COMP-3.            00740032
007500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00750032
007600     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00760032
007700     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00770032
007800     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00780032
007900     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00790032
008000     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00800032
008100     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00810032
008200                                               COMP.              00820032
008300* JAK 04/2007 - ADD FIELDS - START                                00830049
008400     05  PC-SHIP-CNTL-MOD            PIC X(08)  VALUE             00840049
008500                                                 'WSKCS306'.      00850049
008600     05  PC-SHIP-CNTL-MOD-LENGTH     PIC S9(4) VALUE +100         00860049
008700                                                COMP SYNC.        00870049
008800     05  PC-DEFAULT-NINES            PIC X(26)  VALUE             00880049
008801                              '9999-09-09-09.09.09.999999'.       00880149
008802* JAK 04/2007 - ADD FIELDS - END                                  00880232
008803*                                                                 00880332
008804*----------------------------------------------------------------*00880432
008805*  SYSTEM MESSAGES                                               *00880532
008806*----------------------------------------------------------------*00880632
008807*   00005 = INVALID VALUE                                        *00880732
008808*   00007 = REQUIRED ENTRY                                        00880832
008900*   00008 = MUST BE NUMERIC                                      *00890032
009000*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00900032
009100*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00910032
009200*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00920032
009300*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00930032
009400*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00940032
009500*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00950032
009600*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00960032
009700*   00069 - TOP OF LIST                                          *00970032
009800*   00070 - BOTTOM OF LIST                                       *00980032
009900*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00990032
010000*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01000032
010100*   00279 - MORE ITEMS TO DISPLAY                                *01010032
010200*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *01020032
010300*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01030032
010400*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01040032
010500*   99901 = INVALID COMMAND WAS ENTERED                          *01050032
010600*----------------------------------------------------------------*01060032
010700     05  PC-TSYMSG-NUMBERS.                                       01070032
010800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01080032
010900         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01090032
011000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01100032
011100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01110032
011200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01120032
011300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01130032
011400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01140032
011500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01150032
011600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01160032
011700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01170032
011800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01180032
011900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01190032
012000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01200032
012100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01210032
012200         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01220032
012300         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01230032
012400         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01240032
012500         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01250032
012600         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01260032
012700         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01270032
012800* JAK 04/2007 - ADD ERRORS 3540, 3541, 3546, 3548, 3550, 3553     01280049
012900         10  PC-TSYMSG-03540            PIC  9(05)  VALUE 03540.  01290049
013000         10  PC-TSYMSG-03541            PIC  9(05)  VALUE 03541.  01300049
013100         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01310049
013200         10  PC-TSYMSG-03548            PIC  9(05)  VALUE 03548.  01320049
013300         10  PC-TSYMSG-03550            PIC  9(05)  VALUE 03550.  01330049
013301         10  PC-TSYMSG-03553            PIC  9(05)  VALUE 03553.  01330149
013302         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01330232
013303*                                                                 01330332
013304 01  PS-PROGRAM-SWITCHES.                                         01330432
013305     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01330532
013306         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01330632
013307         88  PS-BLOCK-ERROR                         VALUE 'N'.    01330732
013400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01340032
013500         88  PS-NO-ERROR                            VALUE 'Y'.    01350032
013600         88  PS-ERROR                               VALUE 'N'.    01360032
013700     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01370032
013800         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01380032
013900         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01390032
014000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01400032
014100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01410032
014200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01420032
014300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01430032
014400         88  PS-DONE                                VALUE 'Y'.    01440032
014500         88  PS-NOT-DONE                            VALUE 'N'.    01450032
014600     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01460032
014700         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01470032
014800         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01480032
014900     05  PS-CURSOR-SW                   PIC  X(01)  VALUE  ' '.   01490032
015000         88  PS-TRLR-STAT-CSR                       VALUE  'A'.   01500032
015100         88  PS-TRLR-STAT-DATE-CSR                  VALUE  'B'.   01510032
015200         88  PS-TRLR-SRL-NBR-CSR                    VALUE  'C'.   01520032
015300         88  PS-TRIP-ID-CSR                         VALUE  'D'.   01530032
015400         88  PS-STR-NBR-CSR                         VALUE  'E'.   01540032
015500         88  PS-TRLR-STAT-DAYS-CSR                  VALUE  'F'.   01550032
015600         88  PS-TRLR-DOOR-CSR                       VALUE  'G'.   01560032
015700         88  PS-TRLR-SCAC-CSR                       VALUE  'H'.   01570032
015800* JAK 04/2007 - ADD SWITCHES - START                              01580049
015900     05  PS-DWNLD-ASN-TO-WMS      PIC  X(01)  VALUE 'N'.          01590049
016000         88  PS-DWNLD-ASN-TO-WMS-YES          VALUE 'Y'.          01600049
016100         88  PS-DWNLD-ASN-TO-WMS-NO           VALUE 'N'.          01610049
016200     05  PS-RECEIVING-BEGUN       PIC  X(01)  VALUE 'N'.          01620049
016300         88  PS-RECEIVING-BEGUN-YES           VALUE 'Y'.          01630049
016400         88  PS-RECEIVING-BEGUN-NO            VALUE 'N'.          01640049
016500     05  PS-WS-DOWNLOAD-UPDATE-SW PIC  X(01)  VALUE 'N'.          01650049
016600         88  PS-WS-DOWNLOAD-UPDATE            VALUE 'Y'.          01660049
016601         88  PS-WS-DOWNLOAD-UPDATE-NO         VALUE 'N'.          01660149
016602* JAK 04/2007 - ADD SWITCHES - END                                01660232
016603*ROOPA START                                                      01660368
016604     05  PS-TRLR-STATUS                  PIC X(02).               01660468
016605*ROOPA END                                                        01660560
016606*                                                                 01660649
016607*                                                                 01660732
016608 01  PV-PROGRAM-VARIABLES.                                        01660832
016609     05  PV-STRING-AREA                  PIC  X(25)  VALUE SPACES.01660932
016610                                                                  01661032
016611     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01661132
016612                                                     COMP SYNC.   01661232
016613     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01661332
016614     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01661432
016615     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01661532
016700     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01670032
016800                                        COMP SYNC.                01680032
016900     05  PV-SUB                         PIC S9(04)  VALUE +0      01690032
017000                                                    COMP SYNC.    01700032
017100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01710032
017200                                                    COMP SYNC.    01720032
017300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01730032
017400                                                    COMP-3.       01740032
017500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01750032
017600                                                    COMP-3.       01760032
017700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01770032
017800                                                    COMP-3.       01780032
017900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01790032
018000                                                    COMP-3.       01800032
018100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01810032
018200                                                    COMP-3.       01820032
018300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01830032
018400                                                    COMP-3.       01840032
018500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01850032
018600                                                    COMP-3.       01860032
018700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01870032
018800                                                    COMP SYNC.    01880032
018900     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01890032
019000                                                    COMP SYNC.    01900032
019100     05  PV-ITEM                        PIC S9(04)  VALUE +0      01910032
019200                                                    COMP SYNC.    01920032
019300     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01930032
019400                                                    COMP SYNC.    01940032
019500     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01950032
019600                                                    COMP SYNC.    01960032
019700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01970032
019800                                                    COMP SYNC.    01980032
019900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01990032
020000                                                    COMP SYNC.    02000032
020100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02010032
020200                                                    COMP SYNC.    02020032
020300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02030032
020400                                                    COMP SYNC.    02040032
020500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02050032
020600                                                    COMP SYNC.    02060032
020700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02070032
020800                                                    COMP SYNC.    02080032
020900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02090032
021000                                                    COMP SYNC.    02100032
021100     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02110032
021200                                                    COMP SYNC.    02120032
021300     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02130032
021400                                                    COMP SYNC.    02140032
021500     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02150032
021600                                                    COMP SYNC.    02160032
021700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02170032
021800                                                    COMP SYNC.    02180032
021900     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02190032
022000                                                    COMP.         02200032
022100     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02210032
022200                                                    COMP.         02220032
022300     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02230032
022400                                                    COMP.         02240032
022500     05  PV-SOFT-ABORT-MSG.                                       02250032
022600         10  FILLER            PIC X(12) VALUE ' SUKCS559 - '.    02260032
022700         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02270032
022800         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02280032
022900         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02290032
023000         10  PV-SOFT-PARAGRAPH PIC X(30).                         02300032
023100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02310032
023200                                                     COMP SYNC.   02320032
023300     05  PV-CICS-MSG-AREA.                                        02330032
023400         10  FILLER                      PIC X(05) VALUE 'TASK='. 02340032
023500         10  PV-CICS-TASK                PIC ZZZZ9.               02350032
023600         10  FILLER                      PIC X(01) VALUE SPACES.  02360032
023700         10  PV-CICS-MSG                 PIC X(68) VALUE SPACES.  02370032
023800                                                                  02380032
023900     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02390032
024000     05  PV-CICS-MSG-HOLD.                                        02400032
024100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02410032
024200         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02420032
024300     05  PV-CICS-MSG-HOLD2.                                       02430032
024400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02440032
024500         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02450032
024600                                                                  02460032
024700     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02470032
024800     05  PV-TMST-R REDEFINES  PV-TMST.                            02480032
024900         10   PV-TMST-MM                PIC X(02).                02490032
025000         10   PV-TMST-DD                PIC X(02).                02500032
025100         10   PV-TMST-YY                PIC X(04).                02510032
025200         10   FILLER                    PIC X(03).                02520032
025300         10   PV-TMST-HRS               PIC X(02).                02530032
025400         10   FILLER                    PIC X(01).                02540032
025500         10   PV-TMST-MIN               PIC X(02).                02550032
025600         10   FILLER                    PIC X(01).                02560032
025700         10   PV-TMST-SEC               PIC X(02).                02570032
025800         10   FILLER                    PIC X(07).                02580032
025900     05  PV-FROM-TMST.                                            02590032
026000         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              02600032
026100         10   FILLER        PIC X(01)  VALUE '-'.                 02610032
026200         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              02620032
026300         10   FILLER        PIC X(01)  VALUE '-'.                 02630032
026400         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              02640032
026500         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  02650032
026600     05  PV-TO-TMST.                                              02660032
026700         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              02670032
026800         10   FILLER        PIC X(01)  VALUE '-'.                 02680032
026900         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              02690032
027000         10   FILLER        PIC X(01)  VALUE '-'.                 02700032
027100         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              02710032
027200         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  02720032
027300     05  PV-DATE-TIME-DISPLAY.                                    02730032
027400         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 02740032
027500         10   PV-SLASH-1                PIC X(01)   VALUE SPACES. 02750032
027600         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 02760032
027700         10   PV-SLASH-2                PIC X(01)   VALUE SPACES. 02770032
027800         10   PV-DISPLAY-CCYY           PIC X(04)   VALUE SPACES. 02780032
027900         10   PV-AT                     PIC X(03)   VALUE SPACES. 02790032
028000         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 02800032
028100         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 02810032
028200         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 02820032
028300         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 02830032
028400         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 02840032
028500     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 02850032
028600     05  PV-USA-DATE                     PIC  X(10) VALUE SPACES. 02860032
028700     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02870032
028800     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02880032
028900     05  PV-SEL-TERM-ID                  PIC  X(04).              02890032
029000     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02900032
029100     05  PV-SEL-SEQ                      PIC  9(01).              02910032
029200     05  PV-HOLD-STAT                    PIC  X(02).              02920032
029300* JAK 04/2007 - ADD SQL FIELD                                     02930049
029301     05  PV-SQL-RETURN-CD                PIC S9(04) VALUE +0.     02930161
029306                                                                  02930664
029400******************************************************************02940032
029500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02950032
029600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02960032
029700**  APPLICATION-SPECIFIC COMMAREA.                              **02970032
029800******************************************************************02980032
029900 01  LQW-LIST-QUEUE-WORK-AREA.                                    02990032
030000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03000032
030100     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           03010032
030200                                        INDEXED BY LQW-IDX.       03020032
030300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03030032
030400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03040032
030500         10  LQW-SELECTED-SW            PIC  X(01).               03050032
030600             88  LQW-SELECT                         VALUE 'S'.    03060032
030700             88  LQW-DESELECT                       VALUE ' '.    03070032
030800         10  LQW-ACTION                 PIC  X(03).               03080032
030900             88  LQW-DEL                            VALUE 'DEL'.  03090032
031000             88  LQW-INQ                            VALUE 'INQ'.  03100032
031100             88  LQW-UPD                            VALUE 'UPD'.  03110032
031200             88  LQW-ERR                            VALUE 'ERR'.  03120032
031300         10  LQW-SCAC                   PIC  X(04).               03130032
031400         10  LQW-TRLR-ID                PIC  X(12).               03140032
031500         10  LQW-TRLR-SRL-NBR           PIC  9(09).               03150032
031600         10  LQW-TRIP-ID                PIC  9(09).               03160032
031700         10  LQW-TRIP-STATUS            PIC  X(02).               03170032
031800         10  LQW-STAT-DATE              PIC  X(10).               03180032
031900         10  LQW-DOOR                   PIC  X(06).               03190032
032000         10  LQW-DEST-NBR               PIC  9(04).               03200032
032100                                                                  03210032
032200*---------------------------------------------------------------* 03220032
032300* SELECTON QUEUE LAYOUT                                         * 03230032
032400*---------------------------------------------------------------* 03240032
032500     COPY SUWS010.                                                03250032
032600                                                                  03260032
032700*---------------------------------------------------------------* 03270032
032800*    MAP LAYOUT                                                 * 03280032
032900*---------------------------------------------------------------* 03290032
033000     COPY SUKM559.                                                03300032
033100*                                                                 03310032
033200 01  MR-OCCURS-LAYOUT                   REDEFINES  SU559AO.       03320032
033300     05  FILLER                         PIC X(100).               03330032
033400     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          03340032
033500         10  MR-SELECTL                 PIC S9(04) COMP.          03350032
033600         10  MR-SELECTA                 PIC  X(01).               03360032
033700         10  MR-SELECTC                 PIC  X(01).               03370032
033800         10  MR-SELECTH                 PIC  X(01).               03380032
033900         10  MR-SELECTI                 PIC  X(01).               03390032
034000                                                                  03400032
034100         10  MR-ACTIONL                 PIC S9(04) COMP.          03410032
034200         10  MR-ACTIONA                 PIC  X(01).               03420032
034300         10  MR-ACTIONC                 PIC  X(01).               03430032
034400         10  MR-ACTIONH                 PIC  X(01).               03440032
034500         10  MR-ACTION                  PIC  X(03).               03450032
034600                                                                  03460032
034700         10  MR-SCACL                   PIC S9(04) COMP.          03470032
034800         10  MR-SCACA                   PIC  X(01).               03480032
034900         10  MR-SCACC                   PIC  X(01).               03490032
035000         10  MR-SCACH                   PIC  X(01).               03500032
035100         10  MR-SCAC                    PIC  X(04).               03510032
035200                                                                  03520032
035300         10  MR-TRLR-IDL                PIC S9(04) COMP.          03530032
035400         10  MR-TRLR-IDA                PIC  X(01).               03540032
035500         10  MR-TRLR-IDC                PIC  X(01).               03550032
035600         10  MR-TRLR-IDH                PIC  X(01).               03560032
035700         10  MR-TRLR-ID                 PIC  X(12).               03570032
035800                                                                  03580032
035900         10  MR-TRLR-SRL-NBRL           PIC S9(04) COMP.          03590032
036000         10  MR-TRLR-SRL-NBRA           PIC  X(01).               03600032
036100         10  MR-TRLR-SRL-NBRC           PIC  X(01).               03610032
036200         10  MR-TRLR-SRL-NBRH           PIC  X(01).               03620032
036300         10  MR-TRLR-SRL-NBR            PIC  X(09).               03630032
036400                                                                  03640032
036500         10  MR-TRIP-IDL                PIC S9(04) COMP.          03650032
036600         10  MR-TRIP-IDA                PIC  X(01).               03660032
036700         10  MR-TRIP-IDC                PIC  X(01).               03670032
036800         10  MR-TRIP-IDH                PIC  X(01).               03680032
036900         10  MR-TRIP-ID                 PIC  X(09).               03690032
037000                                                                  03700032
037100         10  MR-TRIP-STATUSL            PIC S9(04) COMP.          03710032
037200         10  MR-TRIP-STATUSA            PIC  X(01).               03720032
037300         10  MR-TRIP-STATUSC            PIC  X(01).               03730032
037400         10  MR-TRIP-STATUSH            PIC  X(01).               03740032
037500         10  MR-TRIP-STATUS             PIC  X(02).               03750032
037600                                                                  03760032
037700         10  MR-STAT-DATEL              PIC S9(04) COMP.          03770032
037800         10  MR-STAT-DATEA              PIC  X(01).               03780032
037900         10  MR-STAT-DATEC              PIC  X(01).               03790032
038000         10  MR-STAT-DATEH              PIC  X(01).               03800032
038100         10  MR-STAT-DATE               PIC  X(10).               03810032
038200                                                                  03820032
038300         10  MR-DOORL                   PIC S9(04) COMP.          03830032
038400         10  MR-DOORA                   PIC  X(01).               03840032
038500         10  MR-DOORC                   PIC  X(01).               03850032
038600         10  MR-DOORH                   PIC  X(01).               03860032
038700         10  MR-DOOR                    PIC  X(06).               03870032
038800                                                                  03880032
038900         10  MR-DEST-NBRL               PIC S9(04) COMP.          03890032
039000         10  MR-DEST-NBRA               PIC  X(01).               03900032
039100         10  MR-DEST-NBRC               PIC  X(01).               03910032
039200         10  MR-DEST-NBRH               PIC  X(01).               03920032
039300         10  MR-DEST-NBR                PIC  X(04).               03930032
039400                                                                  03940032
039500*    ITEM COMMAREA FOR XLKUT071                                   03950049
039600     COPY XLWS071.                                                03960049
039601                                                                  03960149
039602*---------------------------------------------------------------* 03960232
039603*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03960332
039700*---------------------------------------------------------------* 03970032
039800     COPY DPWS015.                                                03980032
039900                                                                  03990032
040000*---------------------------------------------------------------* 04000032
040100*    FUNCTION KEYS COPYBOOK.                                    * 04010032
040200*---------------------------------------------------------------* 04020032
040300     COPY DPWS016.                                                04030032
040400                                                                  04040032
040500*---------------------------------------------------------------* 04050032
040600*    NUMERIC EDIT LAYOUT.                                       * 04060032
040700*---------------------------------------------------------------* 04070032
040800     COPY DPWS010I.                                               04080032
040900                                                                  04090032
041000*----------------------------------------------------------------*04100032
041100**  SECURITY SUBROUTINE PARAMETERS                                04110032
041200*----------------------------------------------------------------*04120032
041300     COPY DPWS008.                                                04130032
041400                                                                  04140032
041500*---------------------------------------------------------------* 04150032
041600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04160075
041700*---------------------------------------------------------------* 04170032
041800     COPY DPWS030.                                                04180032
041800     COPY DPWS930.                                                04181075
041900                                                                  04190032
042000*---------------------------------------------------------------* 04200032
042100*    STANDARD COMMAREA.                                         * 04210032
042200*---------------------------------------------------------------* 04220032
042300     COPY DPWS020.                                                04230032
042400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04240032
042500                                                                  04250032
042600*---------------------------------------------------------------* 04260032
042700* INTER-APPLICATION COMMAREA.                                   * 04270032
042800*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04280032
042900*             SPEC SCREEN.                                      * 04290032
043000*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04300032
043100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04310032
043110*   RCWS012 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04311053
043120*             THIS LIST PROGRAMMING FOR LOCAL-08 FUNCTION.      * 04312053
043200*---------------------------------------------------------------* 04320032
043300                                                                  04330032
043400         10  INTER-APPL-COMM-AREA       PIC X(200).               04340032
043500     COPY SUWS008.                                                04350032
043600     COPY SUWS009.                                                04360032
043601* JAK 06/2007 - ADD INTER-APPL AREA FOR CALL TO WSKCS315          04360153
043610*    COPY RCWS012.                                                04361058
043700*---------------------------------------------------------------* 04370032
043800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04380032
043900*---------------------------------------------------------------* 04390032
044000         10  ASC-SPECIFIC-COMMAREA.                               04400032
044100*  KEYS PASSED FROM CRIT SPEC OR OTHER SCREENS                    04410032
044200             15  ASC-KEY-DOOR-ID             PIC  X(04).          04420032
044300             15  ASC-KEY-STR-NBR             PIC  9(04).          04430032
044400             15  ASC-KEY-TRIP-ID             PIC  9(09).          04440032
044500             15  ASC-KEY-TRLR-SRL-NBR        PIC  9(09).          04450032
044600             15  ASC-KEY-TRLR-ID             PIC  X(12).          04460032
044700                                                                  04470032
044800                                                                  04480032
044900             15  ASC-OPER-UNT-ID             PIC  X(04).          04490032
045000             15  ASC-OPER-UNT-ID-N REDEFINES                      04500032
045100                     ASC-OPER-UNT-ID         PIC  9(04).          04510032
045200             15  ASC-OPER-UNT-NAME           PIC  X(24).          04520032
045300             15  ASC-DOOR-TYPE               PIC  X(12).          04530032
045400             15  ASC-SCAC-CODE               PIC  X(04).          04540032
045500             15  ASC-TRLR-STATUS             PIC  X(12).          04550032
045600             15  ASC-DATE-FROM.                                   04560032
045700                 20  ASC-FROM-MM             PIC  X(02).          04570032
045800                 20  ASC-FROM-DD             PIC  X(02).          04580032
045900                 20  ASC-FROM-YY             PIC  X(04).          04590032
046000             15  ASC-DATE-TO.                                     04600032
046100                 20  ASC-TO-MM               PIC  X(02).          04610032
046200                 20  ASC-TO-DD               PIC  X(02).          04620032
046300                 20  ASC-TO-YY               PIC  X(04).          04630032
046400             15  ASC-CARTONS                 PIC  X(01).          04640032
046500             15  ASC-STORE-NAME              PIC  X(20).          04650032
046600             15  ASC-TRLR-SEAL               PIC  X(20).          04660032
046700             15  ASC-TRIP-STAT-CDE           PIC  X(20).          04670032
046800             15  ASC-STATUS-DATE             PIC  X(10).          04680032
046900             15  ASC-USER-ID                 PIC  X(08).          04690032
047000             15  ASC-STATUS-DAYS             PIC  9(02).          04700032
047100             15  ASC-SEQUENCE-SW             PIC  X(01).          04710049
047200                 88  ASC-STORE-SEQ              VALUE 'S'.        04720049
047201                 88  ASC-DATE-SEQ               VALUE 'D'.        04720149
047202*            15  FILLER                      PIC  X(125).         04720232
047203*-----------------------------------------------------------------04720332
047300             15  ASC-BLK-SUB                  PIC S9(04) COMP     04730032
047400                                                         SYNC.    04740032
047500             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04750032
047600                                                         SYNC.    04760032
047700             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04770032
047800             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04780032
047900             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04790032
048000             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04800032
048100             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04810032
048200             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04820032
048300                                                         SYNC.    04830032
048400             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04840032
048500             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04850032
048600             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04860032
048700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04870032
048800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04880032
048900             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04890032
049000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04900032
049100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04910032
049200             15  ASC-LIST-QUEUE-NAME.                             04920032
049300                 20  ASC-LIST-TERM-ID         PIC  X(04).         04930032
049400                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04940032
049500                 20  ASC-LIST-SEQ             PIC  9(01).         04950032
049600                                                                  04960032
049700             15  ASC-START-ITEM-REQUEST.                          04970032
049800                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04980032
049900                                                                  04990032
050000             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05000032
050100             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05010032
050200             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05020032
050300                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05030032
050400             15  ASC-SEL-QUEUE-NAME-IN.                           05040032
050500                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05050032
050600                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05060032
050700                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05070032
050800             15  ASC-SEL-QUEUE-NAME-OUT.                          05080032
050900                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         05090032
051000                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  05100032
051100                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         05110032
051200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05120032
051300                                                                  05130032
051400*-----------------------------------------------------------------05140032
051500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05150032
051600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05160032
051700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05170032
051800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05180032
051900                                                                  05190032
052000                 20  ASC-ITEM-ARRAY.                              05200032
052100                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        05210032
052200                         30  ASC-LIST-ITEM-NUMBER                 05220032
052300                                                     PIC S9(09)   05230032
052400                                                     COMP-3.      05240032
052500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05250032
052600                             88  ASC-VALID-SELECT    VALUE ' '    05260032
052700                                                           'S'    05270032
052800                                                           'B'    05280032
052900                                                           'E'.   05290032
053000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05300032
053100                             88  ASC-TEMP-SELECT     VALUE 'S'.   05310032
053200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05320032
053300                             88  ASC-TEMP-END        VALUE 'E'.   05330032
053400                         30  ASC-SELECTED-SW         PIC  X(01).  05340032
053500                             88  ASC-NO-SELECT       VALUE ' '.   05350032
053600                             88  ASC-SELECT          VALUE 'S'.   05360032
053700                             88  ASC-BEGIN           VALUE 'B'.   05370032
053800                             88  ASC-END             VALUE 'E'.   05380032
053900                         30  ASC-ACTION              PIC  X(03).  05390032
054000                         30  ASC-SCREEN-SCAC         PIC  X(04).  05400032
054100                         30  ASC-SCREEN-TRLR-ID      PIC  X(12).  05410032
054200                         30  ASC-SCREEN-TRLR-SRL-NBR PIC  9(09).  05420032
054300                         30  ASC-SCREEN-TRIP-ID      PIC  9(09).  05430032
054400                         30  ASC-TRIP-STATUS         PIC  X(02).  05440032
054500                         30  ASC-STAT-DATE           PIC  X(10).  05450032
054600                         30  ASC-SCREEN-DOOR         PIC  X(06).  05460032
054700                         30  ASC-SCREEN-DEST-NBR     PIC  9(04).  05470032
054800                                                                  05480032
054900*---------------------------------------------------------------* 05490032
055000*    ABEND PROCESSING COPYBOOK.                                 * 05500032
055100*---------------------------------------------------------------* 05510032
055200     COPY DPWS013.                                                05520032
055300                                                                  05530032
055400* JAK 04/2007 ADD WSWS004                                         05540049
055500**--------------------------------------------------------------**05550049
055600** SHIPMENT CONTROL MODULE COPYBOOK                               05560049
055700**--------------------------------------------------------------**05570049
055800     COPY WSWS004.                                                05580049
055801                                                                  05580149
055802*---------------------------------------------------------------* 05580232
055803*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 05580332
055804*---------------------------------------------------------------* 05580432
055805     EXEC SQL                                                     05580532
055806          INCLUDE TSUOBTR                                         05580632
055900     END-EXEC.                                                    05590032
056000                                                                  05600032
056100*---------------------------------------------------------------* 05610032
056200*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 05620032
056300*---------------------------------------------------------------* 05630032
056400     EXEC SQL                                                     05640032
056500          INCLUDE TSUOBTS                                         05650032
056600     END-EXEC.                                                    05660032
056700                                                                  05670032
056800*---------------------------------------------------------------* 05680032
056900*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 05690032
057000*---------------------------------------------------------------* 05700032
057100     EXEC SQL                                                     05710032
057200          INCLUDE TCNDCDR                                         05720032
057300     END-EXEC.                                                    05730032
057400                                                                  05740032
058200*---------------------------------------------------------------* 05820032
058300*    TRAILER ID                                                   05830032
058400*---------------------------------------------------------------* 05840032
058500     EXEC SQL                                                     05850032
058600          INCLUDE TCNTRID                                         05860032
058700     END-EXEC.                                                    05870032
058800                                                                  05880032
058900* JAK 04/2007 - ADD TKRPRPM & WST00001                            05890049
059000*---------------------------------------------------------------* 05900049
059100*    PARM TABLE                                                   05910049
059200*---------------------------------------------------------------* 05920049
059300     EXEC SQL                                                     05930049
059400          INCLUDE TKRPRPM                                         05940049
059500     END-EXEC.                                                    05950049
059600                                                                  05960049
059700*---------------------------------------------------------------* 05970049
059800*    WMS SHIPMENT CROSS REFERENCE HEADER                          05980049
059900*---------------------------------------------------------------* 05990049
060000     EXEC SQL                                                     06000049
060100          INCLUDE WST00001                                        06010049
060200     END-EXEC.                                                    06020049
060201                                                                  06020149
060224*---------------------------------------------------------------* 06022432
060225*    DB2 AREA FOR COMMUNICATIONS                                * 06022532
060226*---------------------------------------------------------------* 06022632
060227     EXEC SQL                                                     06022732
060228          INCLUDE SQLCA                                           06022832
060229     END-EXEC.                                                    06022932
060230                                                                  06023032
060231*---------------------------------------------------------------* 06023132
060232*    TRAILER STATUS WITH NO DATE RANGE CURSOR                     06023232
060233*---------------------------------------------------------------* 06023332
060234     EXEC SQL                                                     06023432
060235          DECLARE STAT-CSR CURSOR FOR                             06023532
060236              SELECT  OBTR.TRLR_SRL_NBR                           06023632
060240                     ,OBTR.OTBND_TRIP_ID                          06024032
060300                     ,OBTR.DEST_OPER_UNT_ID                       06030032
060400                     ,OBTS.TRIP_STAT_CDE                          06040032
060500                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        06050032
060510                                  AS STAT_DTE                     06051049
060600                     ,OBTS.TRLR_PRKG_SLOT_NBR                     06060032
060700                     ,OBTS.DOOR_ID                                06070032
060800                     ,TRID.SCAC_CDE                               06080032
060900                     ,TRID.TRLR_ID                                06090032
061000                FROM  TSUOBTR OBTR                                06100032
061100                     ,TSUOBTS OBTS                                06110032
061200                     ,TCNTRID TRID                                06120032
061300               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   06130032
061400                 AND OBTR.TRLR_SRL_NBR    = TRID.TRLR_SRL_NBR     06140032
061500                                                                  06150032
061600                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  06160032
061700                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     06170032
061800                                                                  06180032
061900                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       06190032
062000                                          :DK-STAT-CDE2,          06200032
062100                                          :DK-STAT-CDE3,          06210032
062200                                          :DK-STAT-CDE4,          06220032
062300                                          :DK-STAT-CDE5,          06230032
062400                                          :DK-STAT-CDE6,          06240032
062500                                          :DK-STAT-CDE7,          06250032
062600                                          :DK-STAT-CDE8)          06260032
062700                 AND OBTS.OTBND_STAT_TMST =                       06270032
062800                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           06280032
062900                                                                  06290032
063000                FROM TSUOBTS OBTS1                                06300032
063100               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    06310032
063200                                                                  06320032
063300                                                                  06330032
063400            ORDER BY OBTS.OTBND_STAT_TMST DESC                    06340034
063401                    ,OBTR.TRLR_SRL_NBR                            06340133
063410                                                                  06341033
063500     END-EXEC.                                                    06350032
063600                                                                  06360032
063601     EXEC SQL                                                     06360149
063602          DECLARE STAT-CSR-ALT CURSOR FOR                         06360232
063603              SELECT  OBTR.TRLR_SRL_NBR                           06360332
063604                     ,OBTR.OTBND_TRIP_ID                          06360432
063605                     ,OBTR.DEST_OPER_UNT_ID                       06360532
063606                     ,OBTS.TRIP_STAT_CDE                          06360632
063607                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        06360732
063608                                  AS STAT_DTE                     06360849
063609                     ,OBTS.TRLR_PRKG_SLOT_NBR                     06360932
063610                     ,OBTS.DOOR_ID                                06361032
063611                     ,TRID.SCAC_CDE                               06361132
063612                     ,TRID.TRLR_ID                                06361232
063613                FROM  TSUOBTR OBTR                                06361332
063614                     ,TSUOBTS OBTS                                06361432
063615                     ,TCNTRID TRID                                06361532
063616               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   06361632
063617                 AND OBTR.TRLR_SRL_NBR    = TRID.TRLR_SRL_NBR     06361732
063618                                                                  06361832
063619                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  06361932
063620                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     06362032
063621                                                                  06362132
063622                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       06362232
063623                                          :DK-STAT-CDE2,          06362332
063624                                          :DK-STAT-CDE3,          06362432
063625                                          :DK-STAT-CDE4,          06362532
063626                                          :DK-STAT-CDE5,          06362632
063627                                          :DK-STAT-CDE6,          06362732
063628                                          :DK-STAT-CDE7,          06362832
063629                                          :DK-STAT-CDE8)          06362932
063630                 AND OBTS.OTBND_STAT_TMST =                       06363032
063631                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           06363132
063632                                                                  06363232
063633                FROM TSUOBTS OBTS1                                06363332
063634               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    06363432
063635                                                                  06363532
063636                                                                  06363632
063637            ORDER BY OBTR.DEST_OPER_UNT_ID                        06363732
063638                 ,   OBTS.OTBND_STAT_TMST DESC                    06363834
063639                 ,   OBTR.TRLR_SRL_NBR                            06363933
063640                                                                  06364033
063641     END-EXEC.                                                    06364132
063642                                                                  06364232
063700*---------------------------------------------------------------* 06370032
063800*    TRAILER STATUS WITH A DATE RANGE CURSOR                      06380032
063900*---------------------------------------------------------------* 06390032
064000     EXEC SQL                                                     06400032
064100          DECLARE STAT-DATE-CSR CURSOR FOR                        06410032
064200              SELECT  OBTR.TRLR_SRL_NBR                           06420032
064300                     ,OBTR.OTBND_TRIP_ID                          06430032
064400                     ,OBTR.DEST_OPER_UNT_ID                       06440032
064500                     ,OBTS.TRIP_STAT_CDE                          06450032
064600                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        06460032
064700                     ,OBTS.TRLR_PRKG_SLOT_NBR                     06470032
064800                     ,OBTS.DOOR_ID                                06480032
064900                     ,TRID.SCAC_CDE                               06490032
065000                     ,TRID.TRLR_ID                                06500032
065100                FROM  TSUOBTR OBTR                                06510032
065200                     ,TSUOBTS OBTS                                06520032
065300                     ,TCNTRID TRID                                06530032
065400               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   06540032
065500                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    06550032
065600                                                                  06560032
065700                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  06570032
065800                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     06580032
065900                 AND  OBTR.DOOR_TYP_CDE IN (                      06590032
066000                                        :DK-SHUTTLE               06600032
066100                                      , :DK-SHIPPING              06610032
066200                                      , :DK-RECEIVING             06620032
066300                                      , :DK-STORAGE               06630032
066400                                      , :DK-STRIPPING             06640032
066500                                      , :DK-YARD                  06650032
066600                                        )                         06660032
066700                                                                  06670032
066800                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       06680032
066900                                          :DK-STAT-CDE2,          06690032
067000                                          :DK-STAT-CDE3,          06700032
067100                                          :DK-STAT-CDE4,          06710032
067200                                          :DK-STAT-CDE5,          06720032
067300                                          :DK-STAT-CDE6,          06730032
067400                                          :DK-STAT-CDE7,          06740032
067500                                          :DK-STAT-CDE8)          06750032
067600                 AND OBTS.OTBND_STAT_TMST BETWEEN :DK-FROM-TMST   06760032
067700                                              AND :DK-TO-TMST     06770032
067800                 AND OBTS.OTBND_STAT_TMST =                       06780032
067900                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           06790032
068000                FROM TSUOBTS OBTS1                                06800032
068100               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    06810032
068200                                                                  06820032
068300            ORDER BY OBTS.OTBND_STAT_TMST DESC                    06830034
068310                    ,OBTR.TRLR_SRL_NBR                            06831033
068400     END-EXEC.                                                    06840032
068500                                                                  06850032
068501     EXEC SQL                                                     06850149
068502          DECLARE STAT-DATE-CSR-ALT CURSOR FOR                    06850232
068503              SELECT  OBTR.TRLR_SRL_NBR                           06850332
068504                     ,OBTR.OTBND_TRIP_ID                          06850432
068505                     ,OBTR.DEST_OPER_UNT_ID                       06850532
068506                     ,OBTS.TRIP_STAT_CDE                          06850632
068507                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        06850732
068508                             AS STAT_DTE                          06850849
068509                     ,OBTS.TRLR_PRKG_SLOT_NBR                     06850932
068510                     ,OBTS.DOOR_ID                                06851032
068511                     ,TRID.SCAC_CDE                               06851132
068512                     ,TRID.TRLR_ID                                06851232
068513                FROM  TSUOBTR OBTR                                06851332
068514                     ,TSUOBTS OBTS                                06851432
068515                     ,TCNTRID TRID                                06851532
068516               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   06851632
068517                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    06851732
068518                                                                  06851832
068519                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  06851932
068520                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     06852032
068521                 AND  OBTR.DOOR_TYP_CDE IN (                      06852132
068522                                        :DK-SHUTTLE               06852232
068523                                      , :DK-SHIPPING              06852332
068524                                      , :DK-RECEIVING             06852432
068525                                      , :DK-STORAGE               06852532
068526                                      , :DK-STRIPPING             06852632
068527                                      , :DK-YARD                  06852732
068528                                        )                         06852832
068529                                                                  06852932
068530                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       06853032
068531                                          :DK-STAT-CDE2,          06853132
068532                                          :DK-STAT-CDE3,          06853232
068533                                          :DK-STAT-CDE4,          06853332
068534                                          :DK-STAT-CDE5,          06853432
068535                                          :DK-STAT-CDE6,          06853532
068536                                          :DK-STAT-CDE7,          06853632
068537                                          :DK-STAT-CDE8)          06853732
068538                 AND OBTS.OTBND_STAT_TMST BETWEEN :DK-FROM-TMST   06853832
068539                                              AND :DK-TO-TMST     06853932
068540                 AND OBTS.OTBND_STAT_TMST =                       06854032
068541                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           06854132
068542                FROM TSUOBTS OBTS1                                06854232
068543               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    06854332
068544                                                                  06854432
068545            ORDER BY OBTR.DEST_OPER_UNT_ID                        06854532
068546                 ,   OBTS.OTBND_STAT_TMST DESC                    06854634
068547                 ,   OBTR.TRLR_SRL_NBR                            06854733
068548     END-EXEC.                                                    06854832
068549                                                                  06854932
068600*---------------------------------------------------------------* 06860032
068700*    TRAILER STATUS WITH JUST DOOR ID                             06870032
068800*---------------------------------------------------------------* 06880032
068900     EXEC SQL                                                     06890032
069000          DECLARE DOOR-CSR CURSOR FOR                             06900032
069100              SELECT  OBTR.TRLR_SRL_NBR                           06910032
069200                     ,OBTR.OTBND_TRIP_ID                          06920032
069300                     ,OBTR.DEST_OPER_UNT_ID                       06930032
069400                     ,OBTS.TRIP_STAT_CDE                          06940032
069500                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        06950032
069600                     ,OBTS.TRLR_PRKG_SLOT_NBR                     06960032
069700                     ,OBTS.DOOR_ID                                06970032
069800                     ,TRID.SCAC_CDE                               06980032
069900                     ,TRID.TRLR_ID                                06990032
070000                FROM  TSUOBTR OBTR                                07000032
070100                     ,TSUOBTS OBTS                                07010032
070200                     ,TCNTRID TRID                                07020032
070300               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   07030032
070400                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    07040032
070500                                                                  07050032
070600                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  07060032
070700                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     07070032
070800                                                                  07080032
070900                 AND  OBTS.DOOR_ID        =  :DK-DOOR-ID          07090032
070910*ROOPA START                                                      07091060
070920                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       07092060
070930                                          :DK-STAT-CDE2,          07093060
070940                                          :DK-STAT-CDE3,          07094060
070950                                          :DK-STAT-CDE4,          07095060
070960                                          :DK-STAT-CDE5,          07096060
070970                                          :DK-STAT-CDE6,          07097060
070980                                          :DK-STAT-CDE7,          07098060
070990                                          :DK-STAT-CDE8)          07099060
070991*ROOPA END                                                        07099160
071000                                                                  07100032
071100                 AND OTBND_STAT_TMST =                            07110032
071200                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           07120032
071300                FROM TSUOBTS OBTS1                                07130032
071400               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    07140032
071500                                                                  07150032
071600            ORDER BY OBTS.OTBND_STAT_TMST DESC                    07160034
071610                    ,OBTR.TRLR_SRL_NBR                            07161033
071700     END-EXEC.                                                    07170032
071800                                                                  07180032
071801     EXEC SQL                                                     07180149
071802          DECLARE DOOR-CSR-ALT CURSOR FOR                         07180232
071803              SELECT  OBTR.TRLR_SRL_NBR                           07180332
071804                     ,OBTR.OTBND_TRIP_ID                          07180432
071805                     ,OBTR.DEST_OPER_UNT_ID                       07180532
071806                     ,OBTS.TRIP_STAT_CDE                          07180632
071807                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        07180732
071808                         AS STAT_DTE                              07180849
071809                     ,OBTS.TRLR_PRKG_SLOT_NBR                     07180932
071810                     ,OBTS.DOOR_ID                                07181032
071811                     ,TRID.SCAC_CDE                               07181132
071812                     ,TRID.TRLR_ID                                07181232
071813                FROM  TSUOBTR OBTR                                07181332
071814                     ,TSUOBTS OBTS                                07181432
071815                     ,TCNTRID TRID                                07181532
071816               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   07181632
071817                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    07181732
071818                                                                  07181832
071819                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  07181932
071820                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     07182032
071821                                                                  07182132
071822                 AND  OBTS.DOOR_ID        =  :DK-DOOR-ID          07182232
071823*ROOPA START                                                      07182360
071824                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       07182460
071825                                          :DK-STAT-CDE2,          07182560
071826                                          :DK-STAT-CDE3,          07182660
071827                                          :DK-STAT-CDE4,          07182760
071828                                          :DK-STAT-CDE5,          07182860
071829                                          :DK-STAT-CDE6,          07182960
071830                                          :DK-STAT-CDE7,          07183060
071831                                          :DK-STAT-CDE8)          07183160
071832*ROOPA END                                                        07183260
071833                                                                  07183332
071834                 AND OTBND_STAT_TMST =                            07183432
071835                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           07183532
071836                FROM TSUOBTS OBTS1                                07183632
071837               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    07183732
071838                                                                  07183832
071839             ORDER BY OBTR.DEST_OPER_UNT_ID                       07183932
071840                 ,   OBTS.OTBND_STAT_TMST DESC                    07184034
071841                 ,   OBTR.TRLR_SRL_NBR                            07184133
071842     END-EXEC.                                                    07184232
071850                                                                  07185032
071900*---------------------------------------------------------------* 07190032
072000*    TRAILER STATUS IN THE STATUS FOR NUMBER OF DAYS SPECIFIED    07200032
072100*---------------------------------------------------------------* 07210032
072200     EXEC SQL                                                     07220032
072300          DECLARE STAT-DAYS-CSR CURSOR FOR                        07230032
072400              SELECT  OBTR.TRLR_SRL_NBR                           07240032
072500                     ,OBTR.OTBND_TRIP_ID                          07250032
072600                     ,OBTR.DEST_OPER_UNT_ID                       07260032
072700                     ,OBTS.TRIP_STAT_CDE                          07270032
072800                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        07280032
072900                     ,OBTS.TRLR_PRKG_SLOT_NBR                     07290032
073000                     ,OBTS.DOOR_ID                                07300032
073100                     ,TRID.SCAC_CDE                               07310032
073200                     ,TRID.TRLR_ID                                07320032
073300                FROM  TSUOBTR OBTR                                07330032
073400                     ,TSUOBTS OBTS                                07340032
073500                     ,TCNTRID TRID                                07350032
073600               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   07360032
073700                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    07370032
073800                                                                  07380032
073900                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  07390032
074000                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     07400032
074100                                                                  07410032
074200                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       07420032
074300                                          :DK-STAT-CDE2,          07430032
074400                                          :DK-STAT-CDE3,          07440032
074500                                          :DK-STAT-CDE4,          07450032
074600                                          :DK-STAT-CDE5,          07460032
074700                                          :DK-STAT-CDE6,          07470032
074800                                          :DK-STAT-CDE7,          07480032
074900                                          :DK-STAT-CDE8)          07490032
075100                 AND OBTS.OTBND_STAT_TMST =                       07510032
075110                     (                                            07511049
075200                      SELECT MAX(OBTS1.OTBND_STAT_TMST)           07520032
075300                FROM TSUOBTS OBTS1                                07530032
075400               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID     07540032
075500                 AND OBTS1.OTBND_STAT_TMST <= :DK-FROM-TMST       07550049
075501                     )                                            07550149
075502                                                                  07550232
075600            ORDER BY OBTS.OTBND_STAT_TMST DESC                    07560034
075610                 ,   OBTR.TRLR_SRL_NBR                            07561033
075700     END-EXEC.                                                    07570032
075800                                                                  07580032
075801     EXEC SQL                                                     07580149
075802          DECLARE STAT-DAYS-CSR-ALT CURSOR FOR                    07580232
075803              SELECT  OBTR.TRLR_SRL_NBR                           07580332
075804                     ,OBTR.OTBND_TRIP_ID                          07580432
075805                     ,OBTR.DEST_OPER_UNT_ID                       07580532
075806                     ,OBTS.TRIP_STAT_CDE                          07580632
075807                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        07580732
075808                         AS STAT_DTE                              07580849
075809                     ,OBTS.TRLR_PRKG_SLOT_NBR                     07580932
075810                     ,OBTS.DOOR_ID                                07581032
075811                     ,TRID.SCAC_CDE                               07581132
075812                     ,TRID.TRLR_ID                                07581232
075813                FROM  TSUOBTR OBTR                                07581332
075814                     ,TSUOBTS OBTS                                07581432
075815                     ,TCNTRID TRID                                07581532
075816               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   07581632
075817                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    07581732
075818                                                                  07581832
075819                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  07581932
075820                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     07582032
075821                                                                  07582132
075822                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       07582232
075823                                          :DK-STAT-CDE2,          07582332
075824                                          :DK-STAT-CDE3,          07582432
075825                                          :DK-STAT-CDE4,          07582532
075826                                          :DK-STAT-CDE5,          07582632
075827                                          :DK-STAT-CDE6,          07582732
075828                                          :DK-STAT-CDE7,          07582832
075829                                          :DK-STAT-CDE8)          07582932
075830                 AND OBTS.OTBND_STAT_TMST =                       07583032
075831                     (                                            07583149
075832                      SELECT MAX(OBTS1.OTBND_STAT_TMST)           07583232
075833                FROM TSUOBTS OBTS1                                07583332
075834               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID     07583432
075835                 AND OBTS1.OTBND_STAT_TMST <= :DK-FROM-TMST       07583532
075836                     )                                            07583649
075837                                                                  07583732
075838            ORDER BY OBTR.DEST_OPER_UNT_ID                        07583832
075839                 ,   OBTS.OTBND_STAT_TMST DESC                    07583934
075840                 ,   OBTR.TRLR_SRL_NBR                            07584033
075841     END-EXEC.                                                    07584132
075842                                                                  07584232
075900*---------------------------------------------------------------* 07590032
076000*    TRAILER SERIAL NUMBER CURSOR                                 07600032
076100*---------------------------------------------------------------* 07610032
076200      EXEC SQL                                                    07620032
076300          DECLARE SRL-NBR-CSR CURSOR FOR                          07630032
076400           SELECT  OBTR.TRLR_SRL_NBR                              07640032
076500                  ,OBTR.OTBND_TRIP_ID                             07650032
076600                  ,OBTR.DEST_OPER_UNT_ID                          07660032
076700                  ,OBTS.TRIP_STAT_CDE                             07670032
076800                  ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)           07680032
076900                  ,OBTS.TRLR_PRKG_SLOT_NBR                        07690032
077000                  ,OBTS.DOOR_ID                                   07700032
077100                  ,TRID.SCAC_CDE                                  07710032
077200                  ,TRID.TRLR_ID                                   07720032
077300             FROM  TSUOBTR OBTR                                   07730032
077400                  ,TSUOBTS OBTS                                   07740032
077500                  ,TCNTRID TRID                                   07750032
077600            WHERE  OBTR.OTBND_TRIP_ID =  OBTS.OTBND_TRIP_ID       07760032
077700              AND  OBTR.TRLR_SRL_NBR  =  TRID.TRLR_SRL_NBR        07770032
077800                                                                  07780032
077900              AND  OBTR.TRIP_ACTV_CDE =  'A'                      07790032
078000              AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID        07800032
078100              AND  OBTR.TRLR_SRL_NBR  =  :DK-TRLR-SRL-NBR         07810032
078200                                                                  07820032
078300              AND  OBTS.OTBND_STAT_TMST =                         07830032
078400                    (SELECT MAX(OBTS1.OTBND_STAT_TMST)            07840032
078500               FROM TSUOBTS OBTS1                                 07850032
078600              WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)     07860032
078700                                                                  07870032
078800           ORDER BY OBTS.OTBND_STAT_TMST DESC                     07880032
078900         END-EXEC.                                                07890032
079000                                                                  07900032
079001      EXEC SQL                                                    07900149
079002          DECLARE SRL-NBR-CSR-ALT CURSOR FOR                      07900232
079003           SELECT  OBTR.TRLR_SRL_NBR                              07900332
079004                  ,OBTR.OTBND_TRIP_ID                             07900432
079005                  ,OBTR.DEST_OPER_UNT_ID                          07900532
079006                  ,OBTS.TRIP_STAT_CDE                             07900632
079007                  ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)           07900732
079008                       AS STAT_DTE                                07900849
079009                  ,OBTS.TRLR_PRKG_SLOT_NBR                        07900932
079010                  ,OBTS.DOOR_ID                                   07901032
079011                  ,TRID.SCAC_CDE                                  07901132
079012                  ,TRID.TRLR_ID                                   07901232
079013             FROM  TSUOBTR OBTR                                   07901332
079014                  ,TSUOBTS OBTS                                   07901432
079015                  ,TCNTRID TRID                                   07901532
079016            WHERE  OBTR.OTBND_TRIP_ID =  OBTS.OTBND_TRIP_ID       07901632
079017              AND  OBTR.TRLR_SRL_NBR  =  TRID.TRLR_SRL_NBR        07901732
079018                                                                  07901832
079019              AND  OBTR.TRIP_ACTV_CDE =  'A'                      07901932
079020              AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID        07902032
079021              AND  OBTR.TRLR_SRL_NBR  =  :DK-TRLR-SRL-NBR         07902132
079022                                                                  07902232
079023              AND  OBTS.OTBND_STAT_TMST =                         07902332
079024                    (SELECT MAX(OBTS1.OTBND_STAT_TMST)            07902432
079025               FROM TSUOBTS OBTS1                                 07902532
079026              WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)     07902632
079027                                                                  07902732
079028           ORDER BY OBTR.DEST_OPER_UNT_ID                         07902832
079029                ,   OBTS.OTBND_STAT_TMST DESC                     07902932
079030         END-EXEC.                                                07903032
079040                                                                  07904032
079100*---------------------------------------------------------------* 07910032
079200*    TRAILER SCAC CURSOR                                          07920032
079300*---------------------------------------------------------------* 07930032
079400      EXEC SQL                                                    07940032
079500          DECLARE SCAC-CSR CURSOR FOR                             07950032
079600              SELECT  OBTR.TRLR_SRL_NBR                           07960032
079700                     ,OBTR.OTBND_TRIP_ID                          07970032
079800                     ,OBTR.DEST_OPER_UNT_ID                       07980032
079900                     ,OBTS.TRIP_STAT_CDE                          07990032
080000                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        08000032
080100                     ,OBTS.TRLR_PRKG_SLOT_NBR                     08010032
080200                     ,OBTS.DOOR_ID                                08020032
080300                     ,TRID.SCAC_CDE                               08030032
080400                     ,TRID.TRLR_ID                                08040032
080500                FROM  TSUOBTR OBTR                                08050032
080600                     ,TSUOBTS OBTS                                08060032
080700                     ,TCNTRID TRID                                08070032
080800               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   08080032
080900                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    08090032
081000                                                                  08100032
081100                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  08110032
081200                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     08120032
081300                                                                  08130032
081400                 AND  OBTS.TRIP_STAT_CDE IN (                     08140032
081500                                          :DK-DCOPEN              08150032
081600                                      ,   :DK-DCCLOSED            08160032
081700                                      ,   :DK-SHIPPED             08170032
081800                                      ,   :DK-AUDIT               08180032
081900                                      ,   :DK-STOREOPEN           08190032
082000                                      ,   :DK-STOREUNLOADED       08200032
082100                                      )                           08210032
082200                                                                  08220032
082300                 AND OBTS.OTBND_STAT_TMST =                       08230032
082400                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           08240032
082500                FROM TSUOBTS OBTS1                                08250032
082600               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    08260032
082700                                                                  08270032
082800                 AND TRID.SCAC_CDE  = :DK-SCAC-CODE               08280032
082900                                                                  08290032
083000            ORDER BY OBTS.OTBND_STAT_TMST DESC                    08300034
083010                    ,OBTR.TRLR_SRL_NBR                            08301033
083100     END-EXEC.                                                    08310032
083200                                                                  08320032
083201      EXEC SQL                                                    08320149
083202          DECLARE SCAC-CSR-ALT CURSOR FOR                         08320232
083203              SELECT  OBTR.TRLR_SRL_NBR                           08320332
083204                     ,OBTR.OTBND_TRIP_ID                          08320432
083205                     ,OBTR.DEST_OPER_UNT_ID                       08320532
083206                     ,OBTS.TRIP_STAT_CDE                          08320632
083207                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        08320732
083208                         AS STAT_DTE                              08320849
083209                     ,OBTS.TRLR_PRKG_SLOT_NBR                     08320932
083210                     ,OBTS.DOOR_ID                                08321032
083211                     ,TRID.SCAC_CDE                               08321132
083212                     ,TRID.TRLR_ID                                08321232
083213                FROM  TSUOBTR OBTR                                08321332
083214                     ,TSUOBTS OBTS                                08321432
083215                     ,TCNTRID TRID                                08321532
083216               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   08321632
083217                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    08321732
083218                                                                  08321832
083219                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  08321932
083220                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     08322032
083221                                                                  08322132
083222                 AND  OBTS.TRIP_STAT_CDE IN (                     08322232
083223                                          :DK-DCOPEN              08322332
083224                                      ,   :DK-DCCLOSED            08322432
083225                                      ,   :DK-SHIPPED             08322532
083226                                      ,   :DK-AUDIT               08322632
083227                                      ,   :DK-STOREOPEN           08322732
083228                                      ,   :DK-STOREUNLOADED       08322832
083229                                      )                           08322932
083230                                                                  08323032
083231                 AND OBTS.OTBND_STAT_TMST =                       08323132
083232                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           08323232
083233                FROM TSUOBTS OBTS1                                08323332
083234               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    08323432
083235                                                                  08323532
083236                 AND TRID.SCAC_CDE  = :DK-SCAC-CODE               08323632
083237                                                                  08323732
083238            ORDER BY OBTR.DEST_OPER_UNT_ID                        08323832
083239                 ,   OBTS.OTBND_STAT_TMST DESC                    08323934
083240                 ,   OBTR.TRLR_SRL_NBR                            08324033
083241     END-EXEC.                                                    08324132
083242                                                                  08324232
083300*---------------------------------------------------------------* 08330032
083400*    STORE NUMBER CURSOR                                          08340032
083500*---------------------------------------------------------------* 08350032
083600     EXEC SQL                                                     08360032
083700          DECLARE STR-NBR-CSR CURSOR FOR                          08370032
083800              SELECT  OBTR.TRLR_SRL_NBR                           08380032
083900                     ,OBTR.OTBND_TRIP_ID                          08390032
084000                     ,OBTR.DEST_OPER_UNT_ID                       08400032
084100                     ,OBTS.TRIP_STAT_CDE                          08410032
084200                     ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)        08420032
084210                         AS STAT_DTE                              08421049
084300                     ,OBTS.TRLR_PRKG_SLOT_NBR                     08430032
084400                     ,OBTS.DOOR_ID                                08440032
084500                     ,TRID.SCAC_CDE                               08450032
084600                     ,TRID.TRLR_ID                                08460032
084700                FROM  TSUOBTR OBTR                                08470032
084800                     ,TSUOBTS OBTS                                08480032
084900                     ,TCNTRID TRID                                08490032
085000                                                                  08500032
085100               WHERE  OBTR.OTBND_TRIP_ID  =  OBTS.OTBND_TRIP_ID   08510032
085200                 AND  OBTR.TRLR_SRL_NBR   =  TRID.TRLR_SRL_NBR    08520032
085300                                                                  08530032
085400                 AND  OBTR.TRIP_ACTV_CDE  =  'A'                  08540032
085500                 AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID     08550032
085600                 AND  OBTR.DEST_OPER_UNT_ID = :DK-DEST-STR-NBR    08560032
085610*ROOPA START                                                      08561060
085620                 AND  OBTS.TRIP_STAT_CDE IN (:DK-STAT-CDE1,       08562060
085630                                          :DK-STAT-CDE2,          08563060
085640                                          :DK-STAT-CDE3,          08564060
085650                                          :DK-STAT-CDE4,          08565060
085660                                          :DK-STAT-CDE5,          08566060
085670                                          :DK-STAT-CDE6,          08567060
085680                                          :DK-STAT-CDE7,          08568060
085690                                          :DK-STAT-CDE8)          08569060
085691*ROOPA END                                                        08569160
085700                                                                  08570032
085800                 AND  OBTS.OTBND_STAT_TMST >= :DK-FROM-TMST       08580032
085900                 AND  OBTS.OTBND_STAT_TMST <= :DK-TO-TMST         08590032
086000                 AND  OBTS.OTBND_STAT_TMST =                      08600032
086100                     (SELECT MAX(OBTS1.OTBND_STAT_TMST)           08610032
086200                FROM TSUOBTS OBTS1                                08620032
086300               WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)    08630032
086400                                                                  08640032
086410            ORDER BY OBTR.DEST_OPER_UNT_ID                        08641049
086500            ,        OBTS.OTBND_STAT_TMST DESC                    08650032
086510            ,        OBTR.TRLR_SRL_NBR                            08651049
086600     END-EXEC.                                                    08660032
086700                                                                  08670032
086710                                                                  08671049
086800*-----------------------------------------------------------------08680032
086900 LINKAGE SECTION.                                                 08690032
087000                                                                  08700032
087100 01  DFHCOMMAREA.                                                 08710032
087200     05  FILLER                         OCCURS  1 TO 4072 TIMES   08720032
087300                                        DEPENDING ON EIBCALEN.    08730032
087400         10  FILLER                     PIC X.                    08740032
087500                                                                  08750032
087600                                                                  08760032
087700 PROCEDURE DIVISION.                                              08770032
087800 0000-MAIN-MODULE.                                                08780032
087900     INITIALIZE DP030-CICS-API-FIELDS.                            08790032
088000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08800032
088100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08810032
088200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08820032
088300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08830032
088400     MOVE LENGTH OF SU559AI        TO DP030-MAP-LENGTH (1).       08840032
088500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08850032
088600     PERFORM 0001-CALL-CICS-ARCH-API.                             08860032
088700*                                                                 08870032
088800     PERFORM 1000-CONTROL-PROCESSING                              08880032
088900*                                                                 08890032
089000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08900032
089100     PERFORM 0001-CALL-CICS-ARCH-API.                             08910032
089200                                                                  08920032
089300******************************************************************08930032
089400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08940032
089500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08950032
089600******************************************************************08960032
089700 0001-CALL-CICS-ARCH-API.                                         08970032
089800*    CALL 'DPKCS030' USING DFHEIBLK                               08980075
089800     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08981075
089900                           DFHCOMMAREA                            08990032
090000                           DP030-CICS-API-FIELDS                  09000032
090100                           DP020-STANDARD-COMMAREA                09010032
090200                           SU559AI.                               09020032
090300*                                                                 09030032
090400     IF  DP030-RC-CALL-SUCCESSFUL                                 09040032
090500         CONTINUE                                                 09050032
090600     ELSE                                                         09060032
090700         SET DP013-NO-ROLLBACK                                    09070032
090800             DP013-XCTL-DISPLAY-RESTART                           09080032
090900             DP013-CICS-ABEND      TO TRUE                        09090032
091000         MOVE '0001-CALL-CICS-ARCH-API'                           09100032
091100                                   TO DP013-PARAGRAPH             09110032
091200*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX09120075
091300*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      09130075
091200         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09131075
091300-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09132075
091400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09140032
091500         PERFORM DP013-0000-PROCESS-ABEND                         09150032
091600     END-IF.                                                      09160032
091700*----------------------------------------------------------------*09170032
091800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09180032
091900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09190032
092000*                                                                *09200032
092100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09210032
092200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09220032
092300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09230032
092400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09240032
092500*----------------------------------------------------------------*09250032
092600                                                                  09260032
092700 1000-CONTROL-PROCESSING.                                         09270032
092800                                                                  09280032
092900     EVALUATE TRUE                                                09290032
093000         WHEN DP020-NEXT-ACT-INITIAL                              09300032
093100             INITIALIZE ASC-SPECIFIC-COMMAREA                     09310032
093200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09320032
093300                                      ASC-SEL-TERM-ID-OUT         09330032
093400             MOVE DP020-SRC-TASK-NUMBER                           09340032
093500                                   TO ASC-LIST-TASK-NUMBER        09350032
093600                                      ASC-SEL-TASK-NUMBER-OUT     09360032
093700             MOVE PC-LIST-QUEUE-SEQ                               09370032
093800                                   TO ASC-LIST-SEQ                09380032
093900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             09390032
094000             SET ASC-DATE-SEQ      TO TRUE                        09400049
094001             MOVE 'DATE SEQUENCE'  TO ASEQO                       09400149
094002             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09400232
094100             IF  PS-COMMAREA-NOT-VALID                            09410032
094200                 SET DP020-NEXT-ACT-APPL-ERROR                    09420032
094300                                   TO TRUE                        09430032
094400             ELSE                                                 09440032
094500                 PERFORM 4000-BUILD-INITIAL-PANEL                 09450032
094600             END-IF                                               09460032
094700                                                                  09470032
094800         WHEN DP020-NEXT-ACT-READ-MAP                             09480032
094900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09490032
095000                                   TO PV-TOP-ITEM                 09500032
095100             PERFORM 2000-PROCESS-PANEL                           09510032
095200                                                                  09520032
095300         WHEN DP020-NEXT-ACT-RETURN                               09530032
095400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09540032
095500                                   TO PV-TOP-ITEM                 09550032
095600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09560032
095700             IF ASC-DATE-SEQ                                      09570049
095800                 MOVE 'DATE SEQUENCE'  TO ASEQO                   09580049
095900             ELSE                                                 09590049
096000                 MOVE 'STORE SEQUENCE' TO ASEQO                   09600049
096100             END-IF                                               09610049
096101                                                                  09610149
096102             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09610232
096103             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09610332
096104*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09610432
096105                                                                  09610532
096106         WHEN OTHER                                               09610632
096200             SET DP013-LOGIC-ABEND TO TRUE                        09620032
096300             SET DP013-NO-ROLLBACK TO TRUE                        09630032
096400             MOVE '1000-CONTROL-PROCESSING'                       09640032
096500                                   TO DP013-PARAGRAPH             09650032
096600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09660032
096700                                   TO DP013-MESSAGE-TEXT(1)       09670032
096800             PERFORM DP013-0000-PROCESS-ABEND                     09680032
096900     END-EVALUATE.                                                09690032
097000                                                                  09700032
097100 EJECT                                                            09710032
097200*----------------------------------------------------------------*09720032
097300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *09730032
097400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *09740032
097500*----------------------------------------------------------------*09750032
097600                                                                  09760032
097700 1100-PROCESS-INTER-APPL-COMM.                                    09770032
097800                                                                  09780032
097900     SET PS-COMMAREA-VALID         TO TRUE.                       09790032
098000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09800032
098100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          09810032
098200         MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        09820032
098300                                         DK-OPER-UNT-ID           09830032
098400         MOVE SU008-DOOR-ID           TO ASC-KEY-DOOR-ID          09840032
098500         MOVE SU008-DOOR-TYPE         TO ASC-DOOR-TYPE            09850032
098600                                         DK-DOOR-TYPE             09860032
098700         MOVE SU008-TRLR-SRL-NBR      TO ASC-KEY-TRLR-SRL-NBR     09870032
098800                                         DK-TRLR-SRL-NBR          09880032
098900         MOVE SU008-SCAC-CDE          TO ASC-SCAC-CODE            09890032
099000                                         DK-SCAC-CODE             09900032
099100         MOVE SU008-TRLR-STATUS       TO ASC-TRLR-STATUS          09910032
099200                                         DK-TRLR-STATUS           09920032
099300         MOVE SU008-STATUS-DAYS       TO ASC-STATUS-DAYS          09930032
099400         MOVE SU008-DATE-RANGE-FROM   TO ASC-DATE-FROM            09940032
099500         MOVE SU008-DATE-RANGE-TO     TO ASC-DATE-TO              09950032
099600         MOVE SU008-CARTONS           TO ASC-CARTONS              09960032
099700         MOVE SU008-DEST-STR-NBR      TO ASC-KEY-STR-NBR          09970032
099800                                         DK-DEST-STR-NBR          09980032
099900         MOVE SU008-TRIP-ID           TO ASC-KEY-TRIP-ID          09990032
100000                                         DK-TRIP-ID               10000032
100100         MOVE SU008-TRLR-SEAL-NBR     TO ASC-TRLR-SEAL            10010032
100200     ELSE                                                         10020032
100300         MOVE SU009-SEL-QUEUE-NAME    TO ASC-SEL-QUEUE-NAME-IN    10030032
100400         MOVE SU009-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        10040032
100500                                         DK-OPER-UNT-ID           10050032
100600         MOVE SU009-TRLR-SRL-NBR      TO ASC-KEY-TRLR-SRL-NBR     10060032
100700                                         DK-TRLR-SRL-NBR          10070032
100800         MOVE SU009-SCAC-CDE          TO ASC-SCAC-CODE            10080032
100900                                         DK-SCAC-CODE             10090032
101000         MOVE SU009-TRLR-ID           TO ASC-KEY-TRLR-ID          10100032
101100         MOVE SU009-TRLR-STATUS       TO ASC-TRLR-STATUS          10110032
101200         MOVE SU009-STATUS-DATE       TO ASC-STATUS-DATE          10120032
101300         MOVE SU009-CARTONS           TO ASC-CARTONS              10130032
101400         MOVE SU009-DEST-STR-NBR      TO ASC-KEY-STR-NBR          10140032
101500                                         DK-DEST-STR-NBR          10150032
101600         MOVE SU009-TRIP-ID           TO ASC-KEY-TRIP-ID          10160032
101700                                         DK-TRIP-ID               10170032
101800         MOVE SU009-TRLR-SEAL-NBR     TO ASC-TRLR-SEAL            10180032
101900         MOVE SU009-TRIP-STATUS       TO ASC-TRIP-STAT-CDE        10190032
102000         MOVE SU009-USER-ID           TO ASC-USER-ID              10200032
102100     END-IF.                                                      10210032
102200/                                                                 10220032
102300*----------------------------------------------------------------*10230032
102400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10240032
102500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10250032
102600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10260032
102700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10270032
102800* FUNCTION KEYS CAN GET THIS FAR.                                *10280032
102900*----------------------------------------------------------------*10290032
103000                                                                  10300032
103100 2000-PROCESS-PANEL.                                              10310032
103200     EVALUATE TRUE                                                10320032
103300         WHEN DP020-SRC-AID = DP016-CLEAR                         10330032
103400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10340032
103500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10350032
103600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10360032
103700                                                                  10370032
103800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10380032
103900             PERFORM 2050-DELETE-LIST-QUEUE                       10390032
104000             PERFORM 4000-BUILD-INITIAL-PANEL                     10400032
104100                                                                  10410032
104200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10420032
104300             PERFORM 2140-DESELECT-ALL-ITEMS                      10430032
104400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10440032
104500                                                                  10450032
104600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10460032
104700             PERFORM 2150-SELECT-ALL-ITEMS                        10470032
104800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10480032
104900                                                                  10490032
105000         WHEN OTHER                                               10500032
105100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10510032
105200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10520032
105300             IF  PS-NO-ERROR                                      10530032
105400                 SET DP030-CONTINUE-GO                            10540032
105500                                 TO TRUE                          10550032
105600                 PERFORM 2100-CHECK-FUNCTION-KEY                  10560032
105700             ELSE                                                 10570032
105800                 SET DP030-OVERRIDE-GO                            10580032
105900                                 TO TRUE                          10590032
106000             END-IF                                               10600032
106100     END-EVALUATE.                                                10610032
106200 EJECT                                                            10620032
106300*----------------------------------------------------------------*10630032
106400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10640032
106500*----------------------------------------------------------------*10650032
106600 2050-DELETE-LIST-QUEUE.                                          10660032
106700                                                                  10670032
106800     EXEC CICS                                                    10680032
106900         DELETEQ TS                                               10690032
107000             QUEUE (ASC-LIST-QUEUE-NAME)                          10700032
107100             RESP  (PV-CICS-RESP)                                 10710032
107200     END-EXEC.                                                    10720032
107300                                                                  10730032
107400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10740032
107500        (PV-CICS-RESP = DFHRESP(QIDERR))                          10750032
107600         CONTINUE                                                 10760032
107700     ELSE                                                         10770032
107800         SET DP013-CICS-ABEND      TO TRUE                        10780032
107900         SET DP013-NO-ROLLBACK     TO TRUE                        10790032
108000                                                                  10800032
108100         MOVE '2050-DELETE-LIST-QUEUE'                            10810032
108200                                   TO DP013-PARAGRAPH             10820032
108300         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10830032
108400                                   TO DP013-MESSAGE-TEXT (1)      10840032
108500         PERFORM DP013-0000-PROCESS-ABEND                         10850032
108600     END-IF.                                                      10860032
108700                                                                  10870032
108800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10880032
108900/                                                                 10890032
109000*----------------------------------------------------------------*10900032
109100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10910032
109200* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10920032
109300* CICS ARCHITECTURE API.                                         *10930032
109400*----------------------------------------------------------------*10940032
109500 2100-CHECK-FUNCTION-KEY.                                         10950032
109600     EVALUATE TRUE                                                10960032
109900         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              10990032
110000             IF ASC-DATE-SEQ                                      11000049
110100                 MOVE 'DATE SEQUENCE'  TO ASEQO                   11010049
110200                 SET ASC-STORE-SEQ     TO TRUE                    11020049
110300             ELSE                                                 11030049
110400                 MOVE 'STORE SEQUENCE' TO ASEQO                   11040049
110500                 SET ASC-DATE-SEQ      TO TRUE                    11050049
110600             END-IF                                               11060049
110700                                                                  11070049
110800             PERFORM 2050-DELETE-LIST-QUEUE                       11080049
110900             PERFORM 4100-PREPARE-CURSOR                          11090049
110901             PERFORM 4000-BUILD-INITIAL-PANEL                     11090149
110902*                                                                 11090232
110903*JAK 06/2007 - ADD F15                                            11090353
110904* F15 - WMS SHIPMENT INFO                                         11090453
110905         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              11090553
110906             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11090653
110907                 SET ASC-USE-SELECTION-QUEUE TO TRUE              11090753
110908                 INITIALIZE SU009-INTER-APPL-COMMAREA             11090858
110909                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11090953
110910                            TO SU009-NUMBER-OF-SELECTED-ITEMS     11091058
110911                 MOVE ASC-NUMBER-OF-TS-ITEMS                      11091153
110912                                  TO SU009-NUMBER-OF-TS-ITEMS     11091258
110913                 MOVE ASC-SEL-QUEUE-NAME-OUT TO                   11091353
110914                                          SU009-SEL-QUEUE-NAME    11091458
110915                 MOVE ASC-OPER-UNT-ID-N  TO SU009-OPER-UNT-ID     11091558
110921                 PERFORM 5000-PREPARE-SEL-QUEUE                   11092153
110922             ELSE                                                 11092253
110923                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11092353
110924                 SET DP030-OVERRIDE-GO TO TRUE                    11092453
110925                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11092553
110926                 SET DP020-MSG-WARNING TO TRUE                    11092653
110927             END-IF                                               11092753
110928*JAK 06/2007 - ADD F15 - END                                      11092853
110929*                                                                 11092953
110930* F16 - TRAILER SHIP / RELEASE                                    11093053
110931         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              11093153
110932             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11093253
110933                 SET ASC-USE-SELECTION-QUEUE TO TRUE              11093353
110934                 INITIALIZE SU009-INTER-APPL-COMMAREA             11093453
110935                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11093553
110936                            TO SU009-NUMBER-OF-SELECTED-ITEMS     11093653
110937                 MOVE ASC-NUMBER-OF-TS-ITEMS                      11093753
110938                                  TO SU009-NUMBER-OF-TS-ITEMS     11093853
110939                 MOVE ASC-SEL-QUEUE-NAME-OUT TO                   11093953
110940                                          SU009-SEL-QUEUE-NAME    11094053
110950                 MOVE ASC-OPER-UNT-ID-N  TO SU009-OPER-UNT-ID     11095032
111000                 PERFORM 5000-PREPARE-SEL-QUEUE                   11100032
111100             ELSE                                                 11110032
111200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11120032
111300                 SET DP030-OVERRIDE-GO TO TRUE                    11130032
111400                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11140032
111500                 SET DP020-MSG-WARNING TO TRUE                    11150032
111600             END-IF                                               11160032
111700*                                                                 11170032
111800* F17 - TRAILER HISTORY                                           11180032
111900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11190032
112000             IF ASC-OPER-UNT-ID = SPACES                          11200032
112100                 SET PS-ERROR                                     11210032
112200                     DP020-MSG-FATAL         TO TRUE              11220032
112300                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  11230032
112400                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            11240032
112500                 MOVE DP015-RED              TO AOPERC            11250032
112600                 MOVE DP015-REVERSE          TO AOPERH            11260032
112700                 MOVE -1                     TO AOPERL            11270032
112800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11280032
112900             END-IF                                               11290032
113000             IF  PS-NO-ERROR                                      11300032
113100                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          11310032
113200                     SET ASC-USE-SELECTION-QUEUE TO TRUE          11320032
113300                     INITIALIZE SU009-INTER-APPL-COMMAREA         11330032
113400                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            11340032
113500                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11350032
113600                     MOVE ASC-NUMBER-OF-TS-ITEMS                  11360032
113700                                      TO SU009-NUMBER-OF-TS-ITEMS 11370032
113800                     MOVE ASC-SEL-QUEUE-NAME-OUT TO               11380032
113900                                              SU009-SEL-QUEUE-NAME11390032
114000                     MOVE ASC-OPER-UNT-ID-N  TO SU009-OPER-UNT-ID 11400032
114100                     PERFORM 5000-PREPARE-SEL-QUEUE               11410032
114200                 ELSE                                             11420032
114300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11430032
114400                     SET DP030-OVERRIDE-GO TO TRUE                11440032
114500                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     11450032
114600                     SET DP020-MSG-WARNING TO TRUE                11460032
114700                 END-IF                                           11470032
114800             END-IF                                               11480032
114900*                                                                 11490032
115000* F18 - TRAILER CARTONS                                           11500032
115010* F14 - STORE SCAN SUMMARY                                        11501069
115100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11510032
115110         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              11511069
115200             IF ASC-OPER-UNT-ID = SPACES                          11520032
115300                 SET PS-ERROR                                     11530032
115400                     DP020-MSG-FATAL         TO TRUE              11540032
115500                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  11550032
115600                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            11560032
115700                 MOVE DP015-RED              TO AOPERC            11570032
115800                 MOVE DP015-REVERSE          TO AOPERH            11580032
115900                 MOVE -1                     TO AOPERL            11590032
116000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11600032
116100             END-IF                                               11610032
116200             IF PS-NO-ERROR                                       11620032
116300                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          11630032
116400                     SET ASC-USE-SELECTION-QUEUE TO TRUE          11640032
116500                     INITIALIZE SU009-INTER-APPL-COMMAREA         11650032
116600                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            11660032
116700                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11670032
116800                     MOVE ASC-NUMBER-OF-TS-ITEMS                  11680032
116900                                      TO SU009-NUMBER-OF-TS-ITEMS 11690032
117000                     MOVE ASC-SEL-QUEUE-NAME-OUT                  11700032
117100                                           TO SU009-SEL-QUEUE-NAME11710032
117200                     MOVE ASC-OPER-UNT-ID-N TO SU009-OPER-UNT-ID  11720032
117300                     PERFORM 5000-PREPARE-SEL-QUEUE               11730032
117400                 ELSE                                             11740032
117500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11750032
117600                     SET DP030-OVERRIDE-GO TO TRUE                11760032
117700                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     11770032
117800                     SET DP020-MSG-WARNING TO TRUE                11780032
117900                 END-IF                                           11790032
118000             END-IF                                               11800032
118100*                                                                 11810032
118200* F22 - ASSOCIATE LIST                                            11820032
118300         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              11830032
118400             IF ASC-OPER-UNT-ID = SPACES                          11840032
118500                 SET PS-ERROR                                     11850032
118600                     DP020-MSG-FATAL         TO TRUE              11860032
118700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  11870032
118800                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            11880032
118900                 MOVE DP015-RED              TO AOPERC            11890032
119000                 MOVE DP015-REVERSE          TO AOPERH            11900032
119100                 MOVE -1                     TO AOPERL            11910032
119200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11920032
119300             END-IF                                               11930032
119400             IF PS-NO-ERROR                                       11940032
119500                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          11950032
119600                     SET ASC-USE-SELECTION-QUEUE TO TRUE          11960032
119700                     INITIALIZE SU009-INTER-APPL-COMMAREA         11970032
119800                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            11980032
119900                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11990032
120000                     MOVE ASC-NUMBER-OF-TS-ITEMS                  12000032
120100                                      TO SU009-NUMBER-OF-TS-ITEMS 12010032
120200                     MOVE ASC-SEL-QUEUE-NAME-OUT                  12020032
120300                                           TO SU009-SEL-QUEUE-NAME12030032
120400                     MOVE ASC-OPER-UNT-ID-N TO SU009-OPER-UNT-ID  12040032
120500                     PERFORM 5000-PREPARE-SEL-QUEUE               12050032
120600                 ELSE                                             12060032
120700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12070032
120800                     SET DP030-OVERRIDE-GO TO TRUE                12080032
120900                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     12090032
121000                     SET DP020-MSG-WARNING TO TRUE                12100032
121100                 END-IF                                           12110032
121200             END-IF                                               12120032
121300*                                                                 12130032
121400* F23 - TRAILER SEAL LIST                                         12140032
121500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12150032
121600             MOVE 'SUTRLRSL' TO DP008-FUNCTION-NAME               12160032
121700             PERFORM 2105-RACF-ACCESS                             12170032
121800             IF  PS-ACCESS-NOT-ALLOWED                            12180032
121900                 SET  PS-ERROR                                    12190032
122000                      DP020-MSG-FATAL TO TRUE                     12200032
122100                 MOVE PC-TSYMSG-00840 TO DP020-MSG-NUMBER         12210032
122200                 MOVE -1              TO MR-SELECTL (1)           12220032
122300                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             12230032
122400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12240032
122500                 SET DP030-OVERRIDE-GO TO TRUE                    12250032
122600             END-IF                                               12260032
122700                                                                  12270032
122800             IF  PS-NO-ERROR                                      12280032
122900                 IF ASC-OPER-UNT-ID = SPACES                      12290032
123000                     SET PS-ERROR                                 12300032
123100                         DP020-MSG-FATAL         TO TRUE          12310032
123200                     MOVE PC-TSYMSG-00007     TO DP020-MSG-NUMBER 12320032
123300                     MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA        12330032
123400                     MOVE DP015-RED              TO AOPERC        12340032
123500                     MOVE DP015-REVERSE          TO AOPERH        12350032
123600                     MOVE -1                     TO AOPERL        12360032
123700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          12370032
123800                 END-IF                                           12380032
123900             END-IF                                               12390032
124000             IF  PS-NO-ERROR                                      12400032
124100                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          12410032
124200                     SET ASC-USE-SELECTION-QUEUE TO TRUE          12420032
124300                     INITIALIZE SU009-INTER-APPL-COMMAREA         12430032
124400                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            12440032
124500                                TO SU009-NUMBER-OF-SELECTED-ITEMS 12450032
124600                     MOVE ASC-NUMBER-OF-TS-ITEMS                  12460032
124700                                      TO SU009-NUMBER-OF-TS-ITEMS 12470032
124800                     MOVE ASC-SEL-QUEUE-NAME-OUT  TO              12480032
124900                                              SU009-SEL-QUEUE-NAME12490032
125000                     MOVE ASC-OPER-UNT-ID-N TO SU009-OPER-UNT-ID  12500032
125100                     PERFORM 5000-PREPARE-SEL-QUEUE               12510032
125200                 ELSE                                             12520032
125300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12530032
125400                     SET DP030-OVERRIDE-GO TO TRUE                12540032
125500                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     12550032
125600                     SET DP020-MSG-WARNING TO TRUE                12560032
125700                 END-IF                                           12570032
125800             END-IF                                               12580032
125900*                                                                 12590032
126000*JAK 04/2007 - ADD F24 LOGIC                                      12600053
126100* F24 - DOWNLOAD TO WMS                                           12610049
126200         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              12620049
126300             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               12630049
126500                 PERFORM 9000-ASN-DOWNLOAD                        12650049
126600                     VARYING PV-ITEM FROM 1 BY 1                  12660049
126700                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    12670049
126800                     OR PS-SOFT-ABORT-ERROR                       12680049
126900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12690049
127000                 IF PS-ERROR                                      12700049
127100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12710049
127200                     SET DP030-OVERRIDE-GO TO TRUE                12720049
127300                 ELSE                                             12730049
127400                     MOVE PC-TSYMSG-03550 TO DP020-MSG-NUMBER     12740049
127500                     SET DP020-MSG-INFORMATIONAL TO TRUE          12750049
127700                 END-IF                                           12770049
127800             ELSE                                                 12780049
127900                SET DP030-OVERRIDE-GO TO TRUE                     12790049
128000                MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER          12800049
128100                SET DP020-MSG-WARNING TO TRUE                     12810049
128200                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              12820049
128300             END-IF                                               12830049
128400*                                                                 12840049
128500*JAK 04/2007 - END                                                12850053
128501                                                                  12850149
128502                                                                  12850232
128503         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12850332
128504             MOVE +1               TO PV-TOP-ITEM                 12850432
128505             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12850532
128506                                                                  12850632
128507         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12850732
128508             PERFORM 2110-BROWSE-BACKWARD                         12850832
128509             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12850932
128510                                                                  12851032
128511         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12851132
128512             PERFORM 2120-BROWSE-FORWARD                          12851232
128513             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12851332
128514                                                                  12851432
128515         WHEN DP020-SRC-AID = DP016-ENTER                         12851532
128516             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12851632
128517             IF  PS-ERROR                                         12851732
128518                 CONTINUE                                         12851832
128519             ELSE                                                 12851932
128520                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12852032
128521             END-IF                                               12852132
128522                                                                  12852232
128523         WHEN OTHER                                               12852332
128524             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12852432
128525             IF  PS-ERROR                                         12852532
128526                 CONTINUE                                         12852632
128527             ELSE                                                 12852732
128600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12860032
128700             END-IF                                               12870032
128800                                                                  12880032
128900*            STRING ' SUKCS559 '                                  12890032
129000*                 '/ 2100-CHECK-FUNCTION-KEY '                    12900032
129100*                 '/ EIBAID = ' EIBAID                            12910032
129200*                 '/ DP20-AID = ' DP020-SRC-AID                   12920032
129300*                 '/ NXT APPL = ' DP020-NEXT-APPL-ACTIVITY        12930032
129400*            DELIMITED BY SIZE                                    12940032
129500*            INTO PV-CICS-MSG                                     12950032
393900*            PERFORM 8000-WRITE-CSSL                              39390011
394000*            SET DP013-NO-ROLLBACK                                39400032
394100*                DP013-XCTL-DISPLAY-RESTART                       39410032
394200*                DP013-CICS-ABEND  TO TRUE                        39420032
394300*            MOVE '2100-CHECK-FUNCTION-KEY'                       39430032
394400*                                  TO DP013-PARAGRAPH             39440032
394500*            MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      39450032
394600*                                  TO DP013-MESSAGE-TEXT (1)      39460032
394700*            PERFORM DP013-0000-PROCESS-ABEND                     39470032
394800     END-EVALUATE.                                                39480032
394900*                                                                 39490032
395000*----------------------------------------------------------------*39500032
395100* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     39510032
395200*----------------------------------------------------------------*39520032
395300 2105-RACF-ACCESS.                                                39530032
395400                                                                  39540032
395500      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  39550032
395600      SET DP008-ACCESS-TYPE-USE          TO TRUE                  39560032
395700                                                                  39570032
395800      EXEC CICS                                                   39580032
395900         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 39590032
396000              COMMAREA (DP008-SECURITY-COMMAREA)                  39600032
396100              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             39610032
396200      END-EXEC                                                    39620032
396300                                                                  39630032
396400      IF DP008-CALL-SUCCESSFUL                                    39640032
396500         IF DP008-ACCESS-ALLOWED                                  39650032
396600             SET PS-ACCESS-ALLOWED TO TRUE                        39660032
396700         ELSE                                                     39670032
396800             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    39680032
396900             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          39690032
397000             STRING ' SUKCS559- RACF -'  DELIMITED BY SIZE        39700032
397100                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        39710032
397200                      DP008-ACCESS-SW    DELIMITED BY SIZE        39720032
397300                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        39730032
397400                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        39740032
397500                                    INTO PV-CICS-MSG-AREA2        39750032
397600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     39760032
397700               TO PV-COMMAREA-LENGTH                              39770032
397800             EXEC CICS                                            39780032
397900                  WRITEQ TD                                       39790032
398000                   QUEUE  ('CSSL')                                39800032
398100                    FROM  (PV-CICS-MSG-AREA2)                     39810032
398200                  LENGTH  (PV-COMMAREA-LENGTH)                    39820032
398300                    RESP  (PV-CICS-RESP)                          39830032
398400             END-EXEC                                             39840032
398500         END-IF                                                   39850032
398600     ELSE                                                         39860032
398700         MOVE ' 2105-RACF-ACCESS' TO DP013-PARAGRAPH              39870032
398800          MOVE 'UNABLE TO ACCESS CICS'                            39880032
398900                               TO DP013-MESSAGE-TEXT (1)          39890032
399000          MOVE SQLCA           TO DP013-SQLCA                     39900032
399100          SET DP013-DB2-ABEND                                     39910032
399200              DP013-XCTL-DISPLAY-RESTART TO TRUE                  39920032
399300          PERFORM DP013-0000-PROCESS-ABEND                        39930032
399400      END-IF.                                                     39940032
399500                                                                  39950032
399600*                                                                 39960032
399700*----------------------------------------------------------------*39970032
399800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *39980032
399900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *39990032
400000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *40000032
400100*    MESSAGE.                                                    *40010032
400200*----------------------------------------------------------------*40020032
400300                                                                  40030032
400400 2110-BROWSE-BACKWARD.                                            40040032
400500     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    40050032
400600         GIVING PV-TOP-ITEM.                                      40060032
400700*                                                                 40070032
400800     IF  ((PV-TOP-ITEM < +1)                                      40080032
400900       OR (PV-TOP-ITEM = +1))                                     40090032
401000         MOVE +1                   TO PV-TOP-ITEM                 40100032
401100*        -- TOP OF LIST --                                        40110032
401200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            40120032
401300         SET DP020-MSG-INFORMATIONAL TO TRUE                      40130032
401400     END-IF.                                                      40140032
401500                                                                  40150032
401600 EJECT                                                            40160032
401700*----------------------------------------------------------------*40170032
401800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *40180032
401900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *40190032
402000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *40200032
402100*----------------------------------------------------------------*40210032
402200                                                                  40220032
402300 2120-BROWSE-FORWARD.                                             40230032
402400                                                                  40240032
402500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              40250032
402600         GIVING PV-TOP-ITEM.                                      40260032
402700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   40270032
402800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            40280032
402900                                   TO PV-TOP-ITEM                 40290032
403000*        -- BOTTOM OF LIST --                                     40300032
403100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            40310032
403200         SET DP020-MSG-INFORMATIONAL                              40320032
403300                                   TO TRUE                        40330032
403400     ELSE                                                         40340032
403500         COMPUTE PV-BOTTOM-ITEM =                                 40350032
403600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 40360032
403700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            40370032
403800*            -- BOTTOM OF LIST --                                 40380032
403900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            40390032
404000             SET DP020-MSG-INFORMATIONAL                          40400032
404100                                   TO TRUE                        40410032
404200         END-IF                                                   40420032
404300     END-IF.                                                      40430032
404400 EJECT                                                            40440032
404500*----------------------------------------------------------------*40450032
404600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *40460032
404700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *40470032
404800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *40480032
404900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *40490032
405000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *40500032
405100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *40510032
405200*----------------------------------------------------------------*40520032
405300                                                                  40530032
405400 2130-CHECK-FOR-JUMP-BROWSE.                                      40540032
405500     SET PS-NO-ERROR               TO TRUE.                       40550032
405600     IF (ASC-START-ITEM-REQUEST = SPACE)                          40560032
405700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            40570032
405800                                   TO PV-TOP-ITEM                 40580032
405900     ELSE                                                         40590032
406000         MOVE ASC-START-ITEM-REQUEST                              40600032
406100                                   TO DP010I-UNEDITED-FIELD       40610032
406200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       40620032
406300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     40630032
406400         SET DP010I-NEGATIVE-NOT-ALLOWED                          40640032
406500                                   TO TRUE                        40650032
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         40661074
263968              USING DP010I-NUMERIC-EDIT-AREA                      40662074
406700                                                                  40670032
406800         IF  NOT DP010I-ERROR-DETECTED                            40680032
406900             MOVE DP010I-NUMERIC-FIELD                            40690032
407000                                   TO  ASC-START-ITEM-REQUEST-N   40700032
407100             IF  ASC-START-ITEM-REQUEST-N > ZERO                  40710032
407200                 IF  ASC-START-ITEM-REQUEST-N >                   40720032
407300                                          ASC-NUMBER-OF-ITEMS-READ40730032
407400                     MOVE SPACE TO ASC-START-ITEM-REQUEST         40740032
407500                     COMPUTE PV-TOP-ITEM =                        40750032
407600                             ASC-NUMBER-OF-ITEMS-READ             40760032
407700                             - PC-ITEMS-PER-PANEL + 1             40770032
407800                     IF  PV-TOP-ITEM < +1                         40780032
407900                         MOVE +1   TO PV-TOP-ITEM                 40790032
408000                         MOVE PC-TSYMSG-00070                     40800032
408100                                   TO DP020-MSG-NUMBER            40810032
408200                         SET DP020-MSG-INFORMATIONAL              40820032
408300                                   TO TRUE                        40830032
408400                     END-IF                                       40840032
408500                 ELSE                                             40850032
408600                     MOVE ASC-START-ITEM-REQUEST-N                40860032
408700                                   TO PV-TOP-ITEM                 40870032
408800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      40880032
408900                     COMPUTE PV-BOTTOM-ITEM =                     40890032
409000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     40900032
409100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ40910032
409200*                        -- BOTTOM OF LIST --                     40920032
409300                         MOVE PC-TSYMSG-00070                     40930032
409400                                   TO DP020-MSG-NUMBER            40940032
409500                         SET DP020-MSG-INFORMATIONAL              40950032
409600                                   TO TRUE                        40960032
409700                     END-IF                                       40970032
409800                 END-IF                                           40980032
409900             ELSE                                                 40990032
410000*                --- VALUE OUT OF RANGE ----                      41000032
410100                 MOVE PC-TSYMSG-00101                             41010032
410200                                   TO DP020-MSG-NUMBER            41020032
410300                 MOVE -1           TO ASTRTITL                    41030032
410400                 SET DP030-SET-CURSOR-APPL-1                      41040032
410500                                   TO TRUE                        41050032
410600                 MOVE DP015-REVERSE                               41060032
410700                                   TO ASTRTITH                    41070032
410800                 MOVE DP015-RED    TO ASTRTITC                    41080032
410900                 MOVE DP015-UNP-NUM-BRT-MDT                       41090032
411000                                   TO ASTRTITA                    41100032
411100                 SET DP020-MSG-FATAL                              41110032
411200                                   TO TRUE                        41120032
411300                 SET PS-ERROR      TO TRUE                        41130032
411400             END-IF                                               41140032
411500                                                                  41150032
411600         ELSE                                                     41160032
411700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            41170032
411800             MOVE -1               TO ASTRTITL                    41180032
411900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  41190032
412000             MOVE DP015-REVERSE    TO ASTRTITH                    41200032
412100             MOVE DP015-RED        TO ASTRTITC                    41210032
412200             MOVE DP015-UNP-NUM-BRT-MDT                           41220032
412300                                   TO ASTRTITA                    41230032
412400             SET DP020-MSG-FATAL   TO TRUE                        41240032
412500             SET PS-ERROR          TO TRUE                        41250032
412600         END-IF                                                   41260032
412700     END-IF.                                                      41270032
412800 EJECT                                                            41280032
412900*----------------------------------------------------------------*41290032
413000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *41300032
413100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *41310032
413200*----------------------------------------------------------------*41320032
413300 2140-DESELECT-ALL-ITEMS.                                         41330032
413400     MOVE +1                       TO ASC-BLK-SUB.                41340032
413500                                                                  41350032
413600     PERFORM 2141-CLEAR-SELECTED-INDS                             41360032
413700         VARYING ASC-ITEM-SUB                                     41370032
413800         FROM 1 BY 1                                              41380032
413900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 41390032
414000                                                                  41400032
414100     ADD +1                        TO ASC-BLK-SUB.                41410032
414200                                                                  41420032
414300     PERFORM 2141-CLEAR-SELECTED-INDS                             41430032
414400         VARYING ASC-ITEM-SUB                                     41440032
414500         FROM 1 BY 1                                              41450032
414600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 41460032
414700                                                                  41470032
414800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               41480032
414900                                   TO PV-LIST-ITEM-NUMBER.        41490032
415000                                                                  41500032
415100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            41510032
415200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    41520032
415300                                                                  41530032
415400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     41540032
415500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      41550032
415600         MOVE +1                   TO ASC-BLK-SUB                 41560032
415700                                                                  41570032
415800         PERFORM 5100-WRITE-TEMP-STORAGE                          41580032
415900                                                                  41590032
416000         MOVE +1                   TO PV-BLOCK-NUMBER             41600032
416100                                                                  41610032
416200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         41620032
416300             PV-FIRST-BLOCK-IN-ARRAY - 1                          41630032
416400                                                                  41640032
416500         PERFORM                                                  41650032
416600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       41660032
416700                                                                  41670032
416800             PERFORM 4410-READ-TEMP-STORAGE                       41680032
416900                                                                  41690032
417000             PERFORM 2141-CLEAR-SELECTED-INDS                     41700032
417100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 41710032
417200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          41720032
417300                                                                  41730032
417400             PERFORM 5100-WRITE-TEMP-STORAGE                      41740032
417500                                                                  41750032
417600             ADD +1                TO PV-BLOCK-NUMBER             41760032
417700                                                                  41770032
417800         END-PERFORM                                              41780032
417900                                                                  41790032
418000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         41800032
418100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     41810032
418200                                                                  41820032
418300         PERFORM                                                  41830032
418400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       41840032
418500                   ASC-HIGHEST-BLOCK-WRITTEN                      41850032
418600                                                                  41860032
418700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          41870032
418800                                   TO PV-BLOCK-NUMBER             41880032
418900                                                                  41890032
419000             PERFORM 4410-READ-TEMP-STORAGE                       41900032
419100                                                                  41910032
419200             PERFORM 2141-CLEAR-SELECTED-INDS                     41920032
419300                 VARYING ASC-ITEM-SUB                             41930032
419400                 FROM 1 BY 1                                      41940032
419500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          41950032
419600                                                                  41960032
419700             PERFORM 5100-WRITE-TEMP-STORAGE                      41970032
419800                                                                  41980032
419900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      41990032
420000                                                                  42000032
420100         END-PERFORM                                              42010032
420200                                                                  42020032
420300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             42030032
420400                                   TO PV-BLOCK-NUMBER             42040032
420500                                                                  42050032
420600         PERFORM 4410-READ-TEMP-STORAGE                           42060032
420700     END-IF.                                                      42070032
420800                                                                  42080032
420900                                                                  42090032
421000     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 42100032
421100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.42110032
421200     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  42120032
421300                                                                  42130032
421400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        42140032
421500                                                                  42150032
421600 EJECT                                                            42160032
421700*----------------------------------------------------------------*42170032
421800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *42180032
421900*----------------------------------------------------------------*42190032
422000                                                                  42200032
422100 2141-CLEAR-SELECTED-INDS.                                        42210032
422200                                                                  42220032
422300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           42230032
422400             NOT EQUAL ZERO                                       42240032
422500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          42250032
422600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          42260032
422700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    42270032
422800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  42280032
422900                                   TO TRUE                        42290032
423000         END-IF                                                   42300032
423100     END-IF.                                                      42310032
423200                                                                  42320032
423300 EJECT                                                            42330032
423400*----------------------------------------------------------------*42340032
423500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *42350032
423600*  FOR ALL ITEMS.                                                *42360032
423700*----------------------------------------------------------------*42370032
423800                                                                  42380032
423900 2150-SELECT-ALL-ITEMS.                                           42390032
424000                                                                  42400032
424100     MOVE +1                       TO ASC-BLK-SUB.                42410032
424200                                                                  42420032
424300     PERFORM 2151-SET-SELECTED-INDS                               42430032
424400         VARYING ASC-ITEM-SUB                                     42440032
424500         FROM 1 BY 1                                              42450032
424600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 42460032
424700                                                                  42470032
424800     ADD +1                        TO ASC-BLK-SUB.                42480032
424900                                                                  42490032
425000     PERFORM 2151-SET-SELECTED-INDS                               42500032
425100         VARYING ASC-ITEM-SUB                                     42510032
425200         FROM 1 BY 1                                              42520032
425300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 42530032
425400                                                                  42540032
425500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               42550032
425600                                   TO PV-LIST-ITEM-NUMBER.        42560032
425700                                                                  42570032
425800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            42580032
425900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    42590032
426000                                                                  42600032
426100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     42610032
426200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    42620032
426300         MOVE +1                   TO ASC-BLK-SUB                 42630032
426400                                                                  42640032
426500         PERFORM 5100-WRITE-TEMP-STORAGE                          42650032
426600                                                                  42660032
426700         MOVE +1                   TO PV-BLOCK-NUMBER             42670032
426800                                                                  42680032
426900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         42690032
427000             PV-FIRST-BLOCK-IN-ARRAY - 1                          42700032
427100                                                                  42710032
427200         PERFORM                                                  42720032
427300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       42730032
427400                                                                  42740032
427500             PERFORM 4410-READ-TEMP-STORAGE                       42750032
427600                                                                  42760032
427700             PERFORM 2151-SET-SELECTED-INDS                       42770032
427800                 VARYING ASC-ITEM-SUB                             42780032
427900                 FROM 1 BY 1                                      42790032
428000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          42800032
428100                                                                  42810032
428200             PERFORM 5100-WRITE-TEMP-STORAGE                      42820032
428300                                                                  42830032
428400             ADD +1                TO PV-BLOCK-NUMBER             42840032
428500                                                                  42850032
428600         END-PERFORM                                              42860032
428700                                                                  42870032
428800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         42880032
428900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     42890032
429000                                                                  42900032
429100         PERFORM                                                  42910032
429200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       42920032
429300                   ASC-HIGHEST-BLOCK-WRITTEN                      42930032
429400                                                                  42940032
429500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          42950032
429600                                   TO PV-BLOCK-NUMBER             42960032
429700                                                                  42970032
429800             PERFORM 4410-READ-TEMP-STORAGE                       42980032
429900                                                                  42990032
430000             PERFORM 2151-SET-SELECTED-INDS                       43000032
430100                 VARYING ASC-ITEM-SUB                             43010032
430200                 FROM 1 BY 1                                      43020032
430300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          43030032
430400                                                                  43040032
430500             PERFORM 5100-WRITE-TEMP-STORAGE                      43050032
430600                                                                  43060032
430700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      43070032
430800                                                                  43080032
430900         END-PERFORM                                              43090032
431000                                                                  43100032
431100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             43110032
431200                                   TO PV-BLOCK-NUMBER             43120032
431300                                                                  43130032
431400         PERFORM 4410-READ-TEMP-STORAGE                           43140032
431500     END-IF.                                                      43150032
431600                                                                  43160032
431700                                                                  43170032
431800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             43180032
431900                       ASC-NUMBER-OF-SELECTED-ITEMS.              43190032
432000                                                                  43200032
432100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        43210032
432200                                                                  43220032
432300 EJECT                                                            43230032
432400*----------------------------------------------------------------*43240032
432500*    MARK EACH ITEM AS BEING SELECTED.                           *43250032
432600*----------------------------------------------------------------*43260032
432700                                                                  43270032
432800 2151-SET-SELECTED-INDS.                                          43280032
432900                                                                  43290032
433000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           43300032
433100             NOT EQUAL ZERO                                       43310032
433200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             43320032
433300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             43330032
433400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        43340032
433500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  43350032
433600                               TO  TRUE                           43360032
433700         END-IF                                                   43370032
433800     END-IF.                                                      43380032
433900******************************************************************43390032
434000** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **43400032
434100** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **43410032
434200******************************************************************43420032
434300 2200-MOVE-SCREEN-TO-COMMAREA.                                    43430032
434400                                                                  43440032
434500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             43450032
434600     MOVE +1                       TO PV-SUB.                     43460032
434700*                                                                 43470032
434800     PERFORM 3100-SET-SUBSCRIPTS.                                 43480032
434900     IF  ASTRTITL > ZERO                                          43490032
435000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          43500032
435100     ELSE                                                         43510032
435200         IF  ASTRTITF = DP015-ERASE-EOF                           43520032
435300             INITIALIZE ASC-START-ITEM-REQUEST                    43530032
435400         END-IF                                                   43540032
435500     END-IF.                                                      43550032
435600     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          43560032
435700         VARYING PV-SUB                                           43570032
435800         FROM 1 BY 1                                              43580032
435900         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      43590032
436000******************************************************************43600032
436100** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**43610032
436200******************************************************************43620032
436300 2210-MOVE-LINES-TO-COMMAREA.                                     43630032
436400     IF  MR-SELECTL (PV-SUB) > ZERO                               43640032
436500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             43650032
436600         MOVE MR-SELECTI (PV-SUB)                                 43660032
436700                                   TO ASC-TEMP-SELECTED-SW        43670032
436800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      43680032
436900     ELSE                                                         43690032
437000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                43700032
437100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     43710032
437200                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        43720032
437300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      43730032
437400         END-IF                                                   43740032
437500     END-IF.                                                      43750032
437600     ADD +1                        TO ASC-ITEM-SUB.               43760032
437700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        43770032
437800         ADD +1                    TO ASC-BLK-SUB                 43780032
437900         MOVE +1                   TO ASC-ITEM-SUB                43790032
438000     END-IF.                                                      43800032
438100******************************************************************43810032
438200** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **43820032
438300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **43830032
438400******************************************************************43840032
438500 3000-EDIT-DATA-IN-COMMAREA.                                      43850032
438600     SET PS-NO-ERROR               TO TRUE.                       43860032
438700     PERFORM 3200-RESET-ATTRIBUTES.                               43870032
438800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     43880032
438900**                                                                43890032
439000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              43900032
439100* EDITTING IS DONE FROM THE BOTTOM UP.                            43910032
439200**                                                                43920032
439300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       43930032
439400         ASC-ITEMS-DISPLAYED - 1.                                 43940032
439500     PERFORM 3100-SET-SUBSCRIPTS.                                 43950032
439600     PERFORM 3300-EDIT-SELECTIONS                                 43960032
439700         VARYING PV-SUB                                           43970032
439800         FROM PV-SUB BY -1                                        43980032
439900         UNTIL PV-SUB < +1                                        43990032
440000*                                                                 44000032
440100     IF  PS-NO-ERROR                                              44010032
440200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        44020032
440300     END-IF.                                                      44030032
440400*                                                                 44040032
440500     IF  ((PS-NO-ERROR)                                           44050032
440600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   44060032
440700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    44070032
440800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  44080032
440900     END-IF.                                                      44090032
441000/                                                                 44100032
441100*----------------------------------------------------------------*44110032
441200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *44120032
441300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*44130032
441400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *44140032
441500*                                                                *44150032
441600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *44160032
441700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *44170032
441800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *44180032
441900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *44190032
442000*----------------------------------------------------------------*44200032
442100                                                                  44210032
442200 3100-SET-SUBSCRIPTS.                                             44220032
442300                                                                  44230032
442400     COMPUTE ASC-ITEM-SUB =                                       44240032
442500         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        44250032
442600                                                                  44260032
442700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         44270032
442800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            44280032
442900                                                                  44290032
443000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               44300032
443100     ELSE                                                         44310032
443200         MOVE +1                     TO ASC-BLK-SUB               44320032
443300     END-IF.                                                      44330032
443400******************************************************************44340032
443500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **44350032
443600******************************************************************44360032
443700                                                                  44370032
443800 3200-RESET-ATTRIBUTES.                                           44380032
443900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   44390032
444000     MOVE DP015-GREEN              TO ASTRTITC.                   44400032
444100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   44410032
444200*                                                                 44420032
444300     PERFORM                                                      44430032
444400         VARYING PV-SUB                                           44440032
444500         FROM 1 BY 1                                              44450032
444600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        44460032
444700         MOVE DP015-UNP-ALP-NOR-OFF                               44470032
444800                                   TO MR-SELECTA (PV-SUB)         44480032
444900         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         44490032
445000         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         44500032
445100     END-PERFORM.                                                 44510032
445200******************************************************************44520032
445300** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **44530032
445400** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **44540032
445500** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **44550032
445600** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **44560032
445700******************************************************************44570032
445800 3300-EDIT-SELECTIONS.                                            44580032
445900     EVALUATE TRUE                                                44590032
446000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     44600032
446100             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         44610032
446200                 CONTINUE                                         44620032
446300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         44630032
446400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        44640032
446500                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   44650032
446600                 MOVE ASC-TEMP-SELECTED-SW                        44660032
446700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  44670032
446800                                TO ASC-SELECTED-SW                44680032
446900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  44690032
447000             END-IF                                               44700032
447100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     44710032
447200                 = SPACE                                          44720032
447300             EVALUATE TRUE                                        44730032
447400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       44740032
447500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS44750032
447600                     MOVE SPACE TO ASC-SELECTED-SW                44760032
447700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  44770032
447800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        44780032
447900                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    44790032
448000                     MOVE SPACE TO ASC-SELECTED-SW                44800032
448100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  44810032
448200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          44820032
448300                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      44830032
448400                     MOVE SPACE TO ASC-SELECTED-SW                44840032
448500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  44850032
448600             END-EVALUATE                                         44860032
448700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           44870032
448800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            44880032
448900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    44890032
449000             END-IF                                               44900032
449100             PERFORM 3310-EDIT-RANGE                              44910032
449200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             44920032
449300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            44930032
449400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    44940032
449500             END-IF                                               44950032
449600             PERFORM 3310-EDIT-RANGE                              44960032
449700         WHEN OTHER                                               44970032
449800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           44980032
449900             SET DP020-MSG-FATAL    TO TRUE                       44990032
450000             MOVE -1                TO MR-SELECTL (PV-SUB)        45000032
450100             SET DP030-SET-CURSOR-APPL-1                          45010032
450200                                    TO TRUE                       45020032
450300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        45030032
450400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        45040032
450500             SET PS-ERROR TO TRUE                                 45050032
450600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            45060032
450700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     45070032
450800                 MOVE SPACE         TO ASC-SELECTED-SW            45080032
450900                                        (ASC-BLK-SUB ASC-ITEM-SUB)45090032
451000             END-IF                                               45100032
451100     END-EVALUATE.                                                45110032
451200                                                                  45120032
451300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 45130032
451400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               45140032
451500     IF  ASC-ITEM-SUB < 1                                         45150032
451600         SUBTRACT +1 FROM ASC-BLK-SUB                             45160032
451700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                45170032
451800     END-IF.                                                      45180032
451900******************************************************************45190032
452000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **45200032
452100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **45210032
452200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**45220032
452300** THE ENDING.                                                  **45230032
452400******************************************************************45240032
452500 3310-EDIT-RANGE.                                                 45250032
452600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                45260032
452700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   45270032
452800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)45280032
452900                                   TO ASC-SELECTED-SW             45290032
453000                                        (ASC-BLK-SUB ASC-ITEM-SUB)45300032
453100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 45310032
453200         ELSE                                                     45320032
453300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     45330032
453400                 CONTINUE                                         45340032
453500             ELSE                                                 45350032
453600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        45360032
453700                 MOVE PC-TSYMSG-00054                             45370032
453800                                   TO DP020-MSG-NUMBER            45380032
453900                 SET DP020-MSG-FATAL                              45390032
454000                                   TO TRUE                        45400032
454100                 MOVE -1           TO MR-SELECTL (PV-SUB)         45410032
454200                 SET DP030-SET-CURSOR-APPL-1                      45420032
454300                                   TO TRUE                        45430032
454400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         45440032
454500                 MOVE DP015-UNDERLINE                             45450032
454600                                   TO MR-SELECTH (PV-SUB)         45460032
454700                 SET PS-ERROR      TO TRUE                        45470032
454800             END-IF                                               45480032
454900         END-IF                                                   45490032
455000     ELSE                                                         45500032
455100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     45510032
455200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 45520032
455300                                   TO ASC-SELECTED-SW             45530032
455400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   45540032
455500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   45550032
455600         ELSE                                                     45560032
455700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       45570032
455800                 CONTINUE                                         45580032
455900             ELSE                                                 45590032
456000*                -- ONLY ONE END-OF-RANGE ALLOWED --              45600032
456100                 MOVE PC-TSYMSG-00055                             45610032
456200                                   TO DP020-MSG-NUMBER            45620032
456300                 SET DP020-MSG-FATAL                              45630032
456400                                   TO TRUE                        45640032
456500                 MOVE -1           TO MR-SELECTL (PV-SUB)         45650032
456600                 SET DP030-SET-CURSOR-APPL-1                      45660032
456700                                   TO TRUE                        45670032
456800                 SET PS-ERROR      TO TRUE                        45680032
456900             END-IF                                               45690032
457000         END-IF                                                   45700032
457100     END-IF.                                                      45710032
457200*                                                                 45720032
457300******************************************************************45730032
457400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **45740032
457500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **45750032
457600******************************************************************45760032
457700 3400-CHECK-RANGE-SEQUENCE.                                       45770032
457800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       45780032
457900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      45790032
458000       AND  ASC-START-OF-SELECTED-RANGE >                         45800032
458100                                         ASC-END-OF-SELECTED-RANGE45810032
458200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                45820032
458300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 45830032
458400         SET DP020-MSG-FATAL TO TRUE                              45840032
458500         SET PS-ERROR TO TRUE                                     45850032
458600         PERFORM 3410-POSITION-AT-ERROR                           45860032
458700     END-IF.                                                      45870032
458800******************************************************************45880032
458900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **45890032
459000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **45900032
459100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **45910032
459200******************************************************************45920032
459300 3410-POSITION-AT-ERROR.                                          45930032
459400     SET DP030-SET-CURSOR-APPL-1                                  45940032
459500                                   TO TRUE.                       45950032
459600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 45960032
459700                    - PV-TOP-ITEM + 1.                            45970032
459800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45980032
459900         CONTINUE                                                 45990032
460000     ELSE                                                         46000032
460100         MOVE -1                   TO MR-SELECTL (PV-SUB)         46010032
460200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46020032
460300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         46030032
460400     END-IF.                                                      46040032
460500*                                                                 46050032
460600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   46060032
460700                    - PV-TOP-ITEM + 1.                            46070032
460800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      46080032
460900         CONTINUE                                                 46090032
461000     ELSE                                                         46100032
461100         MOVE -1                   TO MR-SELECTL (PV-SUB)         46110032
461200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46120032
461300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         46130032
461400     END-IF.                                                      46140032
461500 EJECT                                                            46150032
461600*----------------------------------------------------------------*46160032
461700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *46170032
461800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *46180032
461900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *46190032
462000*----------------------------------------------------------------*46200032
462100                                                                  46210032
462200 3500-MARK-RANGE-AS-SELECTED.                                     46220032
462300     MOVE +1                       TO  ASC-BLK-SUB.               46230032
462400     PERFORM 3510-MARK-SELECTED-INDS                              46240032
462500         VARYING ASC-ITEM-SUB                                     46250032
462600         FROM 1 BY 1                                              46260032
462700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 46270032
462800                                                                  46280032
462900     ADD +1                        TO ASC-BLK-SUB.                46290032
463000     PERFORM 3510-MARK-SELECTED-INDS                              46300032
463100         VARYING ASC-ITEM-SUB                                     46310032
463200         FROM 1 BY 1                                              46320032
463300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 46330032
463400                                                                  46340032
463500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               46350032
463600                                   TO  PV-LIST-ITEM-NUMBER.       46360032
463700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            46370032
463800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         46380032
463900               PC-ITEMS-PER-PANEL).                               46390032
464000                                                                  46400032
464100     MOVE ASC-START-OF-SELECTED-RANGE                             46410032
464200                                   TO PV-START-OF-SELECTED-RANGE. 46420032
464300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            46430032
464400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  46440032
464500               PC-ITEMS-PER-PANEL).                               46450032
464600                                                                  46460032
464700     MOVE ASC-END-OF-SELECTED-RANGE                               46470032
464800                                   TO  PV-END-OF-SELECTED-RANGE.  46480032
464900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             46490032
465000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    46500032
465100               PC-ITEMS-PER-PANEL).                               46510032
465200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             46520032
465300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             46530032
465400                                                                  46540032
465500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    46550032
465600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        46560032
465700         MOVE +1                   TO ASC-BLK-SUB                 46570032
465800         PERFORM 5100-WRITE-TEMP-STORAGE                          46580032
465900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         46590032
466000             PV-FIRST-BLOCK-IN-ARRAY - 1                          46600032
466100                                                                  46610032
466200         PERFORM                                                  46620032
466300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      46630032
466400                   PV-PREV-BLOCK-IN-ARRAY                         46640032
466500             MOVE PV-FIRST-BLOCK-IN-RANGE                         46650032
466600                                   TO PV-BLOCK-NUMBER             46660032
466700             PERFORM 4410-READ-TEMP-STORAGE                       46670032
466800             PERFORM 3510-MARK-SELECTED-INDS                      46680032
466900                 VARYING ASC-ITEM-SUB                             46690032
467000                 FROM 1 BY 1                                      46700032
467100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          46710032
467200             PERFORM 5100-WRITE-TEMP-STORAGE                      46720032
467300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     46730032
467400         END-PERFORM                                              46740032
467500                                                                  46750032
467600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         46760032
467700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     46770032
467800         PERFORM                                                  46780032
467900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       46790032
468000                   PV-LAST-BLOCK-IN-RANGE                         46800032
468100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          46810032
468200                                   TO PV-BLOCK-NUMBER             46820032
468300             PERFORM 4410-READ-TEMP-STORAGE                       46830032
468400             PERFORM 3510-MARK-SELECTED-INDS                      46840032
468500                 VARYING ASC-ITEM-SUB                             46850032
468600                 FROM 1 BY 1                                      46860032
468700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          46870032
468800             PERFORM 5100-WRITE-TEMP-STORAGE                      46880032
468900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      46890032
469000         END-PERFORM                                              46900032
469100                                                                  46910032
469200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             46920032
469300                                   TO PV-BLOCK-NUMBER             46930032
469400         PERFORM 4410-READ-TEMP-STORAGE                           46940032
469500     END-IF.                                                      46950032
469600                                                                  46960032
469700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 46970032
469800                                      ASC-END-OF-SELECTED-RANGE.  46980032
469900                                                                  46990032
470000 EJECT                                                            47000032
470100*----------------------------------------------------------------*47010032
470200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *47020032
470300*----------------------------------------------------------------*47030032
470400                                                                  47040032
470500 3510-MARK-SELECTED-INDS.                                         47050032
470600                                                                  47060032
470700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         47070032
470800                                ASC-ITEM-SUB) >                   47080032
470900         ASC-START-OF-SELECTED-RANGE)                             47090032
471000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         47100032
471100                                ASC-ITEM-SUB) =                   47110032
471200         ASC-START-OF-SELECTED-RANGE)                             47120032
471300                                                                  47130032
471400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     47140032
471500                                    ASC-ITEM-SUB) <               47150032
471600             ASC-END-OF-SELECTED-RANGE)                           47160032
471700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     47170032
471800                                    ASC-ITEM-SUB) =               47180032
471900             ASC-END-OF-SELECTED-RANGE)                           47190032
472000                                                                  47200032
472100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          47210032
472200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   47220032
472300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   47230032
472400                               TO TRUE                            47240032
472500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              47250032
472600                               TO TRUE                            47260032
472700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    47270032
472800             END-IF                                               47280032
472900         END-IF                                                   47290032
473000     END-IF.                                                      47300032
473100                                                                  47310032
473200 EJECT                                                            47320032
473300*----------------------------------------------------------------*47330032
473400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *47340032
473500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *47350032
473600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *47360032
473700*    DISPLAY THE PANEL TO USER.                                  *47370032
473800*----------------------------------------------------------------*47380032
473900                                                                  47390032
474000 4000-BUILD-INITIAL-PANEL.                                        47400032
474100                                                                  47410032
474200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            47420032
474300                                 ASC-BLOCK-ENTRIES (2).           47430032
474400     MOVE +1                 TO ASC-BLK-SUB.                      47440032
474500     SET ASC-ITEMS-LEFT-ON-DB                                     47450032
474600                             TO TRUE.                             47460032
474700                                                                  47470032
474800     MOVE +0                 TO ASC-ITEM-SUB                      47480032
474900                                ASC-NUMBER-OF-ITEMS-READ          47490032
475000                                ASC-NUMBER-OF-SELECTED-ITEMS      47500032
475100                                ASC-HIGHEST-BLOCK-WRITTEN         47510032
475200                                ASC-START-OF-SELECTED-RANGE       47520032
475300                                ASC-END-OF-SELECTED-RANGE         47530032
475400                                ASC-ITEM-AT-TOP-OF-PANEL.         47540032
475500                                                                  47550032
475600     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 47560032
475700     MOVE ASC-KEY-TRLR-SRL-NBR TO DK-TRLR-SRL-NBR.                47570032
475800     MOVE ASC-KEY-TRIP-ID      TO DK-TRIP-ID.                     47580032
475900     MOVE ASC-KEY-STR-NBR      TO DK-DEST-STR-NBR.                47590032
476000                                                                  47600032
476100     INITIALIZE XL071-COMMAREA-REC                                47610049
476200     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               47620049
476300                                                                  47630049
476400     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      47640049
476500                                    XL071-COMMAREA                47650049
476600                                    XL071-COMMAREA-REC.           47660049
476700                                                                  47670049
476800     IF XL071-NO-ERRORS                                           47680049
476900         MOVE XL071-LOC-NM       TO ASC-OPER-UNT-NAME             47690049
477000     ELSE                                                         47700049
477100         MOVE SPACES             TO ASC-OPER-UNT-NAME             47710049
477200     END-IF.                                                      47720049
477400                                                                  47740032
477500     PERFORM 4100-PREPARE-CURSOR                                  47750032
477600                                                                  47760032
477700     IF ASC-DATE-SEQ                                              47770049
477701         MOVE 'DATE SEQUENCE'  TO ASEQO                           47770149
477702         PERFORM 4010-OPEN-CURSOR                                 47770232
477703     ELSE                                                         47770349
477704         MOVE 'STORE SEQUENCE' TO ASEQO                           47770449
477705         PERFORM 4010A-OPEN-ALTSEQ                                47770532
477706     END-IF                                                       47770649
477800                                                                  47780032
477900     PERFORM 4300-READ-ITEMS-FROM-DB.                             47790032
478000                                                                  47800032
478010     IF ASC-DATE-SEQ                                              47801049
478100         PERFORM 4020-CLOSE-CURSOR                                47810032
478101     ELSE                                                         47810149
478102         PERFORM 4020A-CLOSE-ALTSEQ                               47810232
478103     END-IF                                                       47810349
478200                                                                  47820032
478300     MOVE +1                   TO  PV-TOP-ITEM.                   47830032
478400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          47840032
478500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    47850032
478600         SET DP020-MSG-FATAL   TO  TRUE                           47860032
478700         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               47870032
478800     ELSE                                                         47880032
478900         MOVE -1               TO MR-SELECTL (1)                  47890032
479000         SET DP030-SET-CURSOR-APPL-1                              47900032
479100                               TO TRUE                            47910032
479200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     47920032
479300     END-IF.                                                      47930032
479400/                                                                 47940032
480100                                                                  48010032
480200 4010-OPEN-CURSOR.                                                48020032
480300     PERFORM                                                      48030032
480400         WITH TEST AFTER                                          48040032
480500         VARYING PV-RETRY-COUNTER                                 48050032
480600         FROM 1 BY 1                                              48060032
480700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48070032
480800                   OR (SQLCODE = ZERO))                           48080032
480900                                                                  48090032
481000         EVALUATE TRUE                                            48100032
481100             WHEN PS-TRLR-STAT-CSR                                48110032
481200                 EXEC SQL                                         48120032
481300                      OPEN     STAT-CSR                           48130032
481400                 END-EXEC                                         48140032
481500                                                                  48150032
481600             WHEN PS-TRLR-STAT-DATE-CSR                           48160032
481700                 EXEC SQL                                         48170032
481800                      OPEN     STAT-DATE-CSR                      48180032
481900                 END-EXEC                                         48190032
482000                                                                  48200032
482100             WHEN PS-TRLR-STAT-DAYS-CSR                           48210032
482200                 EXEC SQL                                         48220032
482300                      OPEN     STAT-DAYS-CSR                      48230032
482400                 END-EXEC                                         48240032
482500                                                                  48250032
482600             WHEN PS-TRLR-SRL-NBR-CSR                             48260032
482700                 EXEC SQL                                         48270032
482800                      OPEN     SRL-NBR-CSR                        48280032
482900                 END-EXEC                                         48290032
483000                                                                  48300032
483100             WHEN PS-STR-NBR-CSR                                  48310032
483200                 EXEC SQL                                         48320032
483300                      OPEN STR-NBR-CSR                            48330032
483400                 END-EXEC                                         48340032
483500                                                                  48350032
483600             WHEN PS-TRLR-DOOR-CSR                                48360032
483700                 EXEC SQL                                         48370032
483800                      OPEN     DOOR-CSR                           48380032
483900                 END-EXEC                                         48390032
484000                                                                  48400032
484100             WHEN PS-TRLR-SCAC-CSR                                48410032
484200                 EXEC SQL                                         48420032
484300                      OPEN     SCAC-CSR                           48430032
484400                 END-EXEC                                         48440032
484500         END-EVALUATE                                             48450032
484600                                                                  48460032
484700         EVALUATE TRUE                                            48470032
484800             WHEN SQLCODE = ZERO                                  48480032
484900             WHEN SQLCODE = -904                                  48490032
485000             WHEN SQLCODE = -913                                  48500032
485100                 CONTINUE                                         48510032
485200             WHEN SQLWARN0 NOT = SPACES                           48520032
485300             WHEN SQLCODE < ZERO                                  48530032
485400             WHEN SQLCODE > ZERO                                  48540032
485500                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       48550032
485600                 MOVE 'OPEN CURSOR PROBLEM    - '                 48560032
485700                                   TO DP013-MESSAGE-TEXT (1)      48570032
485800                 MOVE SQLCA        TO DP013-SQLCA                 48580032
485900                 MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)    48590032
486000                 SET DP013-DB2-ABEND                              48600032
486100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48610032
486200                 PERFORM DP013-0000-PROCESS-ABEND                 48620032
486300         END-EVALUATE                                             48630032
486400     END-PERFORM.                                                 48640032
486500*                                                                 48650032
486600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48660032
486700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             48670032
486800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   48680032
486900                                   TO DP013-MESSAGE-TEXT (1)      48690032
487000         MOVE SQLCA                TO DP013-SQLCA                 48700032
487100         MOVE 'TSUOBTR '           TO DP013-DB2-TABLE-NAME (1)    48710032
487200         SET DP013-DB2-ABEND                                      48720032
487300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   48730032
487400         PERFORM DP013-0000-PROCESS-ABEND                         48740032
487500     END-IF.                                                      48750032
487600                                                                  48760032
487601 4010A-OPEN-ALTSEQ.                                               48760149
487602     PERFORM                                                      48760232
487603         WITH TEST AFTER                                          48760332
487604         VARYING PV-RETRY-COUNTER                                 48760432
487605         FROM 1 BY 1                                              48760532
487606         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48760632
487607                   OR (SQLCODE = ZERO))                           48760732
487608                                                                  48760832
487609         EVALUATE TRUE                                            48760932
487610             WHEN PS-TRLR-STAT-CSR                                48761032
487611                 EXEC SQL                                         48761132
487612                      OPEN STAT-CSR-ALT                           48761232
487613                 END-EXEC                                         48761332
487614                                                                  48761432
487615             WHEN PS-TRLR-STAT-DATE-CSR                           48761532
487616                 EXEC SQL                                         48761632
487617                      OPEN STAT-DATE-CSR-ALT                      48761732
487618                 END-EXEC                                         48761832
487619                                                                  48761932
487620             WHEN PS-TRLR-STAT-DAYS-CSR                           48762032
487621                 EXEC SQL                                         48762132
487622                      OPEN STAT-DAYS-CSR-ALT                      48762232
487623                 END-EXEC                                         48762332
487624                                                                  48762432
487625             WHEN PS-TRLR-SRL-NBR-CSR                             48762532
487626                 EXEC SQL                                         48762632
487627                      OPEN SRL-NBR-CSR-ALT                        48762732
487628                 END-EXEC                                         48762832
487629                                                                  48762932
487630             WHEN PS-STR-NBR-CSR                                  48763032
487631                 EXEC SQL                                         48763132
487632                      OPEN STR-NBR-CSR                            48763232
487633                 END-EXEC                                         48763332
487634                                                                  48763432
487635             WHEN PS-TRLR-DOOR-CSR                                48763532
487636                 EXEC SQL                                         48763632
487637                      OPEN DOOR-CSR-ALT                           48763732
487638                 END-EXEC                                         48763832
487639                                                                  48763932
487640             WHEN PS-TRLR-SCAC-CSR                                48764032
487641                 EXEC SQL                                         48764132
487642                      OPEN SCAC-CSR-ALT                           48764232
487643                 END-EXEC                                         48764332
487644         END-EVALUATE                                             48764432
487645                                                                  48764532
487646         EVALUATE TRUE                                            48764632
487647             WHEN SQLCODE = ZERO                                  48764732
487648             WHEN SQLCODE = -904                                  48764832
487649             WHEN SQLCODE = -913                                  48764932
487650                 CONTINUE                                         48765032
487651             WHEN SQLWARN0 NOT = SPACES                           48765132
487652             WHEN SQLCODE < ZERO                                  48765232
487653             WHEN SQLCODE > ZERO                                  48765332
487654                 MOVE '4010A-OPEN-ALTSEQ' TO DP013-PARAGRAPH      48765432
487655                 MOVE 'OPEN CURSOR PROBLEM    - '                 48765532
487656                                   TO DP013-MESSAGE-TEXT (1)      48765632
487657                 MOVE SQLCA        TO DP013-SQLCA                 48765732
487658                 MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)    48765832
487659                 SET DP013-DB2-ABEND                              48765932
487660                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48766032
487661                 PERFORM DP013-0000-PROCESS-ABEND                 48766132
487662         END-EVALUATE                                             48766232
487663     END-PERFORM.                                                 48766332
487664*                                                                 48766432
487665     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48766532
487666         MOVE '4010A-OPEN-ALTSEQ'   TO DP013-PARAGRAPH            48766632
487667         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   48766732
487668                                   TO DP013-MESSAGE-TEXT (1)      48766832
487669         MOVE SQLCA                TO DP013-SQLCA                 48766932
487670         MOVE 'TSUOBTR '           TO DP013-DB2-TABLE-NAME (1)    48767032
487671         SET DP013-DB2-ABEND                                      48767132
487672             DP013-XCTL-DISPLAY-RESTART TO TRUE                   48767232
487673         PERFORM DP013-0000-PROCESS-ABEND                         48767332
487674     END-IF.                                                      48767432
487675                                                                  48767532
487700/                                                                 48770032
487800 4020-CLOSE-CURSOR.                                               48780032
487900                                                                  48790032
488000     EVALUATE TRUE                                                48800032
488100         WHEN PS-TRLR-STAT-CSR                                    48810032
488200             EXEC SQL                                             48820032
488300                  CLOSE     STAT-CSR                              48830032
488400             END-EXEC                                             48840032
488500                                                                  48850032
488600         WHEN PS-TRLR-STAT-DATE-CSR                               48860032
488700             EXEC SQL                                             48870032
488800                  CLOSE     STAT-DATE-CSR                         48880032
488900             END-EXEC                                             48890032
489000                                                                  48900032
489100         WHEN PS-TRLR-STAT-DAYS-CSR                               48910032
489200             EXEC SQL                                             48920032
489300                  CLOSE     STAT-DAYS-CSR                         48930032
489400             END-EXEC                                             48940032
489500                                                                  48950032
489600         WHEN PS-TRLR-SRL-NBR-CSR                                 48960032
489700             EXEC SQL                                             48970032
489800                  CLOSE     SRL-NBR-CSR                           48980032
489900             END-EXEC                                             48990032
490000                                                                  49000032
490100         WHEN PS-STR-NBR-CSR                                      49010032
490200             EXEC SQL                                             49020032
490300                  CLOSE STR-NBR-CSR                               49030032
490400             END-EXEC                                             49040032
490500                                                                  49050032
490600         WHEN PS-TRLR-DOOR-CSR                                    49060032
490700             EXEC SQL                                             49070032
490800                  CLOSE     DOOR-CSR                              49080032
490900             END-EXEC                                             49090032
491000                                                                  49100032
491100         WHEN PS-TRLR-SCAC-CSR                                    49110032
491200             EXEC SQL                                             49120032
491300                  CLOSE     SCAC-CSR                              49130032
491400             END-EXEC                                             49140032
491500     END-EVALUATE.                                                49150032
491600                                                                  49160032
491700     EVALUATE TRUE                                                49170032
491800         WHEN SQLCODE = ZERO                                      49180032
491900         WHEN SQLCODE = +100                                      49190032
492000             CONTINUE                                             49200032
492100         WHEN SQLWARN0 NOT = SPACES                               49210032
492200         WHEN SQLCODE < ZERO                                      49220032
492300         WHEN SQLCODE > ZERO                                      49230032
492400             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          49240032
492500             MOVE 'CLOSE CURSOR PROBLEM   '                       49250032
492600                               TO DP013-MESSAGE-TEXT (1)          49260032
492700             MOVE SQLCA        TO DP013-SQLCA                     49270032
492800             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        49280032
492900             SET DP013-DB2-ABEND                                  49290032
493000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               49300032
493100             PERFORM DP013-0000-PROCESS-ABEND                     49310032
493200     END-EVALUATE.                                                49320032
493300                                                                  49330032
493301 4020A-CLOSE-ALTSEQ.                                              49330149
493302                                                                  49330232
493303     EVALUATE TRUE                                                49330332
493304         WHEN PS-TRLR-STAT-CSR                                    49330432
493305             EXEC SQL                                             49330532
493306                  CLOSE STAT-CSR-ALT                              49330632
493307             END-EXEC                                             49330732
493308                                                                  49330832
493309         WHEN PS-TRLR-STAT-DATE-CSR                               49330932
493310             EXEC SQL                                             49331032
493311                  CLOSE STAT-DATE-CSR-ALT                         49331132
493312             END-EXEC                                             49331232
493313                                                                  49331332
493314         WHEN PS-TRLR-STAT-DAYS-CSR                               49331432
493315             EXEC SQL                                             49331532
493316                  CLOSE STAT-DAYS-CSR-ALT                         49331632
493317             END-EXEC                                             49331732
493318                                                                  49331832
493319         WHEN PS-TRLR-SRL-NBR-CSR                                 49331932
493320             EXEC SQL                                             49332032
493321                  CLOSE SRL-NBR-CSR-ALT                           49332132
493322             END-EXEC                                             49332232
493323                                                                  49332332
493324         WHEN PS-STR-NBR-CSR                                      49332432
493325             EXEC SQL                                             49332532
493326                  CLOSE STR-NBR-CSR                               49332632
493327             END-EXEC                                             49332732
493328                                                                  49332832
493329         WHEN PS-TRLR-DOOR-CSR                                    49332932
493330             EXEC SQL                                             49333032
493331                  CLOSE DOOR-CSR-ALT                              49333132
493332             END-EXEC                                             49333232
493333                                                                  49333332
493334         WHEN PS-TRLR-SCAC-CSR                                    49333432
493335             EXEC SQL                                             49333532
493336                  CLOSE SCAC-CSR-ALT                              49333632
493337             END-EXEC                                             49333732
493338     END-EVALUATE.                                                49333832
493339                                                                  49333932
493340     EVALUATE TRUE                                                49334032
493341         WHEN SQLCODE = ZERO                                      49334132
493342         WHEN SQLCODE = +100                                      49334232
493343             CONTINUE                                             49334332
493344         WHEN SQLWARN0 NOT = SPACES                               49334432
493345         WHEN SQLCODE < ZERO                                      49334532
493346         WHEN SQLCODE > ZERO                                      49334632
493347             MOVE '4020A-CLOSE-ALTSEQ' TO DP013-PARAGRAPH         49334732
493348             MOVE 'CLOSE CURSOR PROBLEM   '                       49334832
493349                               TO DP013-MESSAGE-TEXT (1)          49334932
493350             MOVE SQLCA        TO DP013-SQLCA                     49335032
493351             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        49335132
493352             SET DP013-DB2-ABEND                                  49335232
493353                 DP013-XCTL-DISPLAY-RESTART TO TRUE               49335332
493354             PERFORM DP013-0000-PROCESS-ABEND                     49335432
493355     END-EVALUATE.                                                49335532
493356                                                                  49335632
493400/                                                                 49340032
493500*----------------------------------------------------------------*49350032
493600*    SET UP THE HOST VARIABLES.                                  *49360032
493700*----------------------------------------------------------------*49370032
493800                                                                  49380032
493900 4100-PREPARE-CURSOR.                                             49390032
494000     MOVE SPACE TO PS-CURSOR-SW.                                  49400032
494100     EVALUATE TRUE                                                49410032
494200         WHEN ASC-KEY-TRLR-SRL-NBR > ZERO                         49420032
494300             SET PS-TRLR-SRL-NBR-CSR TO TRUE                      49430032
494400                                                                  49440032
494500         WHEN ASC-KEY-STR-NBR > ZERO                              49450032
494600             SET PS-STR-NBR-CSR TO TRUE                           49460032
494700             MOVE ASC-DATE-FROM TO PV-TMST                        49470032
494800             MOVE PV-TMST-YY    TO PV-FROM-YY                     49480032
494900             MOVE PV-TMST-MM    TO PV-FROM-MM                     49490032
495000             MOVE PV-TMST-DD    TO PV-FROM-DD                     49500032
495100             MOVE PV-FROM-TMST  TO DK-FROM-TMST                   49510032
495200             MOVE ASC-DATE-TO   TO PV-TMST                        49520032
495300             MOVE PV-TMST-YY    TO PV-TO-YY                       49530032
495400             MOVE PV-TMST-MM    TO PV-TO-MM                       49540032
495500             MOVE PV-TMST-DD    TO PV-TO-DD                       49550032
495600             MOVE PV-TO-TMST    TO DK-TO-TMST                     49560032
495610*ROOPA START                                                      49561060
495620             MOVE ASC-TRLR-STATUS     TO DK-TRLR-STATUS           49562066
495630             PERFORM 4102-LOAD-STATUS-CODES                       49563066
495725*ROOPA END                                                        49572560
495730                                                                  49573032
495800         WHEN ASC-KEY-TRIP-ID > ZERO                              49580032
495900                 SET PS-TRIP-ID-CSR TO TRUE                       49590032
496000                                                                  49600032
496100         WHEN ASC-KEY-DOOR-ID > SPACES                            49610032
496200             MOVE ASC-KEY-DOOR-ID  TO DK-DOOR-ID                  49620032
496300             SET PS-TRLR-DOOR-CSR  TO TRUE                        49630032
496310*ROOPA START                                                      49631060
496320             MOVE ASC-TRLR-STATUS     TO DK-TRLR-STATUS           49632066
496321             PERFORM 4102-LOAD-STATUS-CODES                       49632166
496425*ROOPA END                                                        49642560
496430                                                                  49643032
496500         WHEN ASC-SCAC-CODE > SPACES                              49650032
496600             MOVE ASC-SCAC-CODE TO DK-SCAC-CODE                   49660032
496700             SET PS-TRLR-SCAC-CSR  TO TRUE                        49670032
497000             MOVE ASC-TRLR-STATUS TO DK-TRLR-STATUS               49700032
497001                                                                  49700149
497002         WHEN ASC-TRLR-STATUS > SPACE                             49700232
497003             MOVE ASC-TRLR-STATUS TO DK-TRLR-STATUS               49700332
497004                                                                  49700449
497005             EVALUATE TRUE                                        49700549
498500             WHEN ASC-STATUS-DAYS > ZERO                          49850032
498700                 SET PS-TRLR-STAT-DAYS-CSR TO TRUE                49870032
498800                 PERFORM 4150-SELECT-TIMESTAMP                    49880049
498801                                                                  49880149
498802             WHEN ASC-DATE-FROM  > SPACE                          49880232
498803                 SET PS-TRLR-STAT-DATE-CSR TO TRUE                49880332
498804                 MOVE ASC-DATE-FROM TO PV-TMST                    49880432
498805                 MOVE PV-TMST-YY        TO PV-FROM-YY             49880532
498806                 MOVE PV-TMST-MM        TO PV-FROM-MM             49880632
498807                 MOVE PV-TMST-DD        TO PV-FROM-DD             49880732
498808                 MOVE PV-FROM-TMST      TO DK-FROM-TMST           49880832
498809                 MOVE ASC-DATE-TO       TO PV-TMST                49880932
498810                 MOVE PV-TMST-YY        TO PV-TO-YY               49881032
498811                 MOVE PV-TMST-MM        TO PV-TO-MM               49881132
498812                 MOVE PV-TMST-DD        TO PV-TO-DD               49881232
498813                 MOVE PV-TO-TMST        TO DK-TO-TMST             49881332
498814                                                                  49881449
498815             WHEN OTHER                                           49881532
498900                 SET PS-TRLR-STAT-CSR TO TRUE                     49890032
499000             END-EVALUATE                                         49900032
499010                                                                  49901049
499100     END-EVALUATE                                                 49910032
499200                                                                  49920032
499300     IF PS-TRLR-STAT-DATE-CSR OR PS-TRLR-STAT-CSR OR              49930032
499400        PS-TRLR-STAT-DAYS-CSR                                     49940032
499500            PERFORM 4101-LOAD-STAT-CDES                           49950032
499600     END-IF.                                                      49960032
499700                                                                  49970032
499800*    DOOR TYPES                                                   49980032
499900     IF DK-DOOR-TYPE = SPACES                                     49990032
500000         MOVE 'DS'                    TO DK-SHUTTLE               50000032
500100         MOVE 'SH'                    TO DK-SHIPPING              50010032
500200         MOVE 'RC'                    TO DK-RECEIVING             50020032
500300         MOVE 'ST'                    TO DK-STORAGE               50030032
500400         MOVE 'SG'                    TO DK-STRIPPING             50040032
500500         MOVE 'YD'                    TO DK-YARD                  50050032
500600     END-IF.                                                      50060032
500700                                                                  50070032
500800 4101-LOAD-STAT-CDES.                                             50080032
500900                                                                  50090032
501000*    BEGIN BY SELECTING ALL POSSIBLE STATUSES                     50100032
501100     MOVE 'DO'                        TO DK-STAT-CDE1             50110032
501200     MOVE 'DC'                        TO DK-STAT-CDE2             50120032
501300     MOVE 'DS'                        TO DK-STAT-CDE3             50130032
501400     MOVE 'SO'                        TO DK-STAT-CDE4             50140032
501500     MOVE 'SU'                        TO DK-STAT-CDE5             50150032
501600     MOVE 'AO'                        TO DK-STAT-CDE6             50160032
501700     MOVE 'AK'                        TO DK-STAT-CDE7             50170032
501800     MOVE 'AR'                        TO DK-STAT-CDE8             50180032
501900                                                                  50190032
502000*    THEN BLANK OUT THE ONES THAT WEREN'T ACTUALLY USED           50200032
502100     IF DK-DCOPEN = SPACES                                        50210032
502200         MOVE SPACES                  TO DK-STAT-CDE1             50220032
502300     ELSE                                                         50230032
502400         MOVE DK-DCOPEN               TO PV-HOLD-STAT             50240032
502500     END-IF                                                       50250032
502600                                                                  50260032
502700     IF DK-DCCLOSED = SPACES                                      50270032
502800         MOVE SPACES                  TO DK-STAT-CDE2             50280032
502900     ELSE                                                         50290032
503000         MOVE DK-DCCLOSED             TO PV-HOLD-STAT             50300032
503100     END-IF                                                       50310032
503200                                                                  50320032
503300     IF DK-SHIPPED = SPACES                                       50330032
503400         MOVE SPACES                  TO DK-STAT-CDE3             50340032
503500     ELSE                                                         50350032
503600         MOVE DK-SHIPPED              TO PV-HOLD-STAT             50360032
503700     END-IF                                                       50370032
503800                                                                  50380032
503900                                                                  50390032
504000     IF DK-STOREOPEN = SPACES                                     50400032
504100         MOVE SPACES                  TO DK-STAT-CDE4             50410032
504200     ELSE                                                         50420032
504300         MOVE DK-STOREOPEN            TO PV-HOLD-STAT             50430032
504400     END-IF                                                       50440032
504500                                                                  50450032
504600     IF DK-STOREUNLOADED = SPACES                                 50460032
504700         MOVE SPACES                  TO DK-STAT-CDE5             50470032
504800     ELSE                                                         50480032
504900         MOVE DK-STOREUNLOADED        TO PV-HOLD-STAT             50490032
505000     END-IF                                                       50500032
505100                                                                  50510032
505200     IF DK-AUDIT = SPACES                                         50520032
505300         MOVE SPACES                  TO DK-STAT-CDE6             50530032
505400                                         DK-STAT-CDE7             50540032
505500                                         DK-STAT-CDE8             50550032
505600     ELSE                                                         50560032
505700         MOVE DK-AUDIT                TO PV-HOLD-STAT             50570032
505800     END-IF                                                       50580032
505900                                                                  50590032
506000*    FILL IN UNUSED STATUSES WITH THE HOLD FIELD FROM THE         50600032
506100*    PREVIOUS STEP.                                               50610032
506200     IF DK-STAT-CDE1 = SPACES                                     50620032
506300         MOVE PV-HOLD-STAT            TO DK-STAT-CDE1             50630032
506400     END-IF                                                       50640032
506500     IF DK-STAT-CDE2 = SPACES                                     50650032
506600         MOVE PV-HOLD-STAT            TO DK-STAT-CDE2             50660032
506700     END-IF                                                       50670032
506800     IF DK-STAT-CDE3 = SPACES                                     50680032
506900         MOVE PV-HOLD-STAT            TO DK-STAT-CDE3             50690032
507000     END-IF                                                       50700032
507100     IF DK-STAT-CDE4 = SPACES                                     50710032
507200         MOVE PV-HOLD-STAT            TO DK-STAT-CDE4             50720032
507300     END-IF                                                       50730032
507400     IF DK-STAT-CDE5 = SPACES                                     50740032
507500         MOVE PV-HOLD-STAT            TO DK-STAT-CDE5             50750032
507600     END-IF                                                       50760032
507700     IF DK-STAT-CDE6 = SPACES                                     50770032
507800         MOVE PV-HOLD-STAT            TO DK-STAT-CDE6             50780032
507900     END-IF                                                       50790032
508000     IF DK-STAT-CDE7 = SPACES                                     50800032
508100         MOVE PV-HOLD-STAT            TO DK-STAT-CDE7             50810032
508200     END-IF                                                       50820032
508300     IF DK-STAT-CDE8 = SPACES                                     50830032
508400         MOVE PV-HOLD-STAT            TO DK-STAT-CDE8             50840032
508500     END-IF.                                                      50850032
508600/                                                                 50860032
508601*ROOPA START                                                      50860166
508610 4102-LOAD-STATUS-CODES.                                          50861066
508620                                                                  50862066
508631     IF DK-DCOPEN = SPACES                                        50863166
508632        MOVE SPACES                  TO DK-STAT-CDE1              50863266
508633     ELSE                                                         50863366
508634        MOVE 'DO'                    TO DK-STAT-CDE1              50863466
508635     END-IF.                                                      50863567
508636                                                                  50863666
508637     IF DK-DCCLOSED = SPACES                                      50863766
508638        MOVE SPACES                  TO DK-STAT-CDE2              50863866
508639     ELSE                                                         50863966
508640        MOVE 'DC'                    TO DK-STAT-CDE2              50864066
508641     END-IF.                                                      50864167
508642                                                                  50864266
508643     IF DK-SHIPPED = SPACES                                       50864366
508644        MOVE SPACES                  TO DK-STAT-CDE3              50864466
508645     ELSE                                                         50864566
508646        MOVE 'DS'                    TO DK-STAT-CDE3              50864666
508647     END-IF.                                                      50864767
508648                                                                  50864866
508649                                                                  50864966
508650     IF DK-STOREOPEN = SPACES                                     50865066
508651        MOVE SPACES                  TO DK-STAT-CDE4              50865166
508652     ELSE                                                         50865266
508653        MOVE 'SO'                    TO DK-STAT-CDE4              50865366
508654     END-IF.                                                      50865467
508655                                                                  50865566
508656     IF DK-STOREUNLOADED = SPACES                                 50865666
508657        MOVE SPACES                  TO DK-STAT-CDE5              50865766
508658     ELSE                                                         50865866
508659        MOVE 'SU'                    TO DK-STAT-CDE5              50865966
508660     END-IF.                                                      50866067
508661                                                                  50866166
508662     IF DK-AUDIT = SPACES                                         50866266
508663        MOVE SPACES                  TO DK-STAT-CDE6              50866366
508664                                        DK-STAT-CDE7              50866466
508665                                        DK-STAT-CDE8              50866566
508666     ELSE                                                         50866666
508667        MOVE 'AO'                    TO DK-STAT-CDE6              50866766
508668        MOVE 'AK'                    TO DK-STAT-CDE7              50866866
508669        MOVE 'AR'                    TO DK-STAT-CDE8              50866966
508670     END-IF.                                                      50867067
508760/                                                                 50876066
508761*ROOPA END                                                        50876166
508770 4150-SELECT-TIMESTAMP.                                           50877066
508800     MOVE ASC-STATUS-DAYS TO DK-STATUS-DAYS.                      50880032
508900                                                                  50890032
509000     EXEC SQL                                                     50900032
509100         SELECT CURRENT TIMESTAMP -                               50910032
509200                 :DK-STATUS-DAYS DAYS                             50920032
509300         INTO  :DK-FROM-TMST                                      50930032
509400         FROM SYSIBM.SYSDUMMY1                                    50940032
509500     END-EXEC.                                                    50950032
509600                                                                  50960032
509700     EVALUATE TRUE                                                50970032
509800         WHEN SQLCODE = ZERO                                      50980032
509900             MOVE '-00.00.00.000000' TO DK-FROM-TMST (11:16)      50990032
510000         WHEN SQLWARN0 NOT = SPACE                                51000032
510100         WHEN SQLCODE NOT = ZERO                                  51010032
510200              MOVE '4150-SELECT-TIMESTAMP' TO DP013-PARAGRAPH     51020032
510300              MOVE 'SUBTRACT DAYS FROM TIMESTAMP'                 51030032
510400                               TO DP013-MESSAGE-TEXT (1)          51040032
510500              MOVE SQLCA       TO DP013-SQLCA                     51050032
510600              MOVE 'SYSDUMMY'   TO DP013-DB2-TABLE-NAME (1)       51060032
510700              SET DP013-DB2-ABEND TO TRUE                         51070032
510800              PERFORM DP013-0000-PROCESS-ABEND                    51080032
510900     END-EVALUATE.                                                51090032
511000                                                                  51100032
511100                                                                  51110032
511200/                                                                 51120032
511300*----------------------------------------------------------------*51130032
511400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *51140032
511500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *51150032
511600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *51160032
511700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *51170032
511800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *51180032
511900*                                                                *51190032
512000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *51200032
512100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *51210032
512200*    UPON INITIALIZATION.                                        *51220032
512300*----------------------------------------------------------------*51230032
512400                                                                  51240032
512500 4300-READ-ITEMS-FROM-DB.                                         51250032
512600                                                                  51260032
512700     PERFORM                                                      51270032
512800         VARYING PV-READ-COUNT                                    51280032
512900         FROM 1 BY 1                                              51290032
513000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    51300032
513100            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         51310032
513200                                                                  51320032
513210         IF ASC-DATE-SEQ                                          51321049
513300             PERFORM 4310-FETCH                                   51330032
513301         ELSE                                                     51330149
513302             PERFORM 4310A-FETCH-ALTSEQ                           51330232
513303         END-IF                                                   51330349
513400                                                                  51340032
513500         IF  ASC-ITEMS-LEFT-ON-DB                                 51350032
513600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                51360032
513700                 ADD +1            TO ASC-ITEM-SUB                51370032
513800             ELSE                                                 51380032
513900                 ADD +1            TO ASC-BLK-SUB                 51390032
514000                 MOVE +1           TO ASC-ITEM-SUB                51400032
514100                                                                  51410032
514200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         51420032
514300                     MOVE +1       TO ASC-BLK-SUB                 51430032
514400                     SET ASC-BLOCK-MODIFIED (1)                   51440032
514500                                   TO TRUE                        51450032
514600                     PERFORM 5100-WRITE-TEMP-STORAGE              51460032
514700                     MOVE ASC-BLOCK-ENTRIES                       51470032
514800                               (PC-MAX-BLOCKS-IN-ARRAY)           51480032
514900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 51490032
515000                     ADD +1        TO ASC-BLK-SUB                 51500032
515100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   51510032
515200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      51520032
515300                                   TO TRUE                        51530032
515400                 END-IF                                           51540032
515500             END-IF                                               51550032
515600             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    51560032
515700             MOVE ASC-NUMBER-OF-ITEMS-READ                        51570032
515800                                   TO ASC-LIST-ITEM-NUMBER        51580032
515900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  51590032
516000             MOVE SUOBTR-TRLR-SRL-NBR                             51600032
516100                   TO ASC-SCREEN-TRLR-SRL-NBR                     51610032
516200                      (ASC-BLK-SUB ASC-ITEM-SUB)                  51620032
516300             MOVE SUOBTR-OTBND-TRIP-ID                            51630032
516400                        TO ASC-SCREEN-TRIP-ID                     51640032
516500                          (ASC-BLK-SUB ASC-ITEM-SUB)              51650032
516600             MOVE PV-USA-DATE                                     51660032
516700                      TO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 51670032
516800             MOVE SUOBTR-DEST-OPER-UNT-ID                         51680032
516900                   TO ASC-SCREEN-DEST-NBR                         51690032
517000                       (ASC-BLK-SUB ASC-ITEM-SUB)                 51700032
517100             MOVE SUOBTS-TRIP-STAT-CDE                            51710032
517200                   TO ASC-TRIP-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)  51720032
517300                                                                  51730032
517400             IF SUOBTS-TRLR-PRKG-SLOT-NBR > SPACES                51740032
517500                 MOVE SUOBTS-TRLR-PRKG-SLOT-NBR                   51750032
517600                   TO ASC-SCREEN-DOOR (ASC-BLK-SUB ASC-ITEM-SUB)  51760032
517700             ELSE                                                 51770032
517800                 STRING ' ' SUOBTS-DOOR-ID ' '                    51780032
517900                     DELIMITED BY SIZE INTO                       51790032
518000                      ASC-SCREEN-DOOR (ASC-BLK-SUB ASC-ITEM-SUB)  51800032
518100             END-IF                                               51810032
518200             MOVE CNTRID-SCAC-CDE           TO ASC-SCREEN-SCAC    51820032
518300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  51830032
518400             MOVE CNTRID-TRLR-ID            TO ASC-SCREEN-TRLR-ID 51840032
518500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  51850032
518600             IF PS-TRLR-SRL-NBR-CSR OR PS-TRIP-ID-CSR             51860032
518700                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              51870032
518800             END-IF                                               51880032
518900         END-IF                                                   51890032
519000     END-PERFORM.                                                 51900032
519100                                                                  51910032
519200     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          51920032
519300         MOVE +1               TO ASC-BLK-SUB                     51930032
519400         PERFORM 5100-WRITE-TEMP-STORAGE                          51940032
519500         ADD +1                TO ASC-BLK-SUB                     51950032
519600         PERFORM 5100-WRITE-TEMP-STORAGE                          51960032
519700                                                                  51970032
519800         MOVE 1                TO ASC-BLK-SUB                     51980032
519900                                  PV-BLOCK-NUMBER                 51990032
520000         PERFORM 4410-READ-TEMP-STORAGE                           52000032
520100         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             52010032
520200             MOVE 2            TO ASC-BLK-SUB                     52020032
520300                                  PV-BLOCK-NUMBER                 52030032
520400             PERFORM 4410-READ-TEMP-STORAGE                       52040032
520500         END-IF                                                   52050032
520600     END-IF.                                                      52060032
520700 EJECT                                                            52070032
520800*----------------------------------------------------------------*52080032
520900*    FETCH THE MESSAGE CURSOR.                                   *52090032
521000*----------------------------------------------------------------*52100032
521100                                                                  52110032
521200 4310-FETCH.                                                      52120032
521300                                                                  52130032
521400     EVALUATE TRUE                                                52140032
521500         WHEN PS-TRLR-STAT-CSR                                    52150032
521600             EXEC SQL                                             52160032
521700                  FETCH     STAT-CSR                              52170032
521800                 INTO  :SUOBTR-TRLR-SRL-NBR                       52180032
521900                      ,:SUOBTR-OTBND-TRIP-ID                      52190032
522000                      ,:SUOBTR-DEST-OPER-UNT-ID                   52200032
522100                      ,:SUOBTS-TRIP-STAT-CDE                      52210032
522200                      ,:PV-USA-DATE                               52220032
522300                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 52230032
522400                      ,:SUOBTS-DOOR-ID                            52240032
522500                      ,:CNTRID-SCAC-CDE                           52250032
522600                      ,:CNTRID-TRLR-ID                            52260032
522700             END-EXEC                                             52270032
522800                                                                  52280032
522900         WHEN PS-TRLR-STAT-DATE-CSR                               52290032
523000             EXEC SQL                                             52300032
523100                  FETCH     STAT-DATE-CSR                         52310032
523200                 INTO  :SUOBTR-TRLR-SRL-NBR                       52320032
523300                      ,:SUOBTR-OTBND-TRIP-ID                      52330032
523400                      ,:SUOBTR-DEST-OPER-UNT-ID                   52340032
523500                      ,:SUOBTS-TRIP-STAT-CDE                      52350032
523600                      ,:PV-USA-DATE                               52360032
523700                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 52370032
523800                      ,:SUOBTS-DOOR-ID                            52380032
523900                      ,:CNTRID-SCAC-CDE                           52390032
524000                      ,:CNTRID-TRLR-ID                            52400032
524100             END-EXEC                                             52410032
524200                                                                  52420032
524300         WHEN PS-TRLR-STAT-DAYS-CSR                               52430032
524400             EXEC SQL                                             52440032
524500                  FETCH     STAT-DAYS-CSR                         52450032
524600                 INTO  :SUOBTR-TRLR-SRL-NBR                       52460032
524700                      ,:SUOBTR-OTBND-TRIP-ID                      52470032
524800                      ,:SUOBTR-DEST-OPER-UNT-ID                   52480032
524900                      ,:SUOBTS-TRIP-STAT-CDE                      52490032
525000                      ,:PV-USA-DATE                               52500032
525100                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 52510032
525200                      ,:SUOBTS-DOOR-ID                            52520032
525300                      ,:CNTRID-SCAC-CDE                           52530032
525400                      ,:CNTRID-TRLR-ID                            52540032
525500             END-EXEC                                             52550032
525600                                                                  52560032
525700         WHEN PS-TRLR-SRL-NBR-CSR                                 52570032
525800             EXEC SQL                                             52580032
525900                FETCH      SRL-NBR-CSR                            52590032
526000                 INTO  :SUOBTR-TRLR-SRL-NBR                       52600032
526100                      ,:SUOBTR-OTBND-TRIP-ID                      52610032
526200                      ,:SUOBTR-DEST-OPER-UNT-ID                   52620032
526300                      ,:SUOBTS-TRIP-STAT-CDE                      52630032
526400                      ,:PV-USA-DATE                               52640032
526500                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 52650032
526600                      ,:SUOBTS-DOOR-ID                            52660032
526700                      ,:CNTRID-SCAC-CDE                           52670032
526800                      ,:CNTRID-TRLR-ID                            52680032
526900             END-EXEC                                             52690032
527000                                                                  52700032
527100         WHEN PS-TRIP-ID-CSR                                      52710032
527200             EXEC SQL                                             52720032
527300                 SELECT  OBTR.TRLR_SRL_NBR                        52730032
527400                        ,OBTR.OTBND_TRIP_ID                       52740032
527500                        ,OBTR.DEST_OPER_UNT_ID                    52750032
527600                        ,OBTS.TRIP_STAT_CDE                       52760032
527700                        ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)     52770032
527800                        ,OBTS.TRLR_PRKG_SLOT_NBR                  52780032
527900                        ,OBTS.DOOR_ID                             52790032
528000                        ,TRID.SCAC_CDE                            52800032
528100                        ,TRID.TRLR_ID                             52810032
528200                  INTO  :SUOBTR-TRLR-SRL-NBR                      52820032
528300                       ,:SUOBTR-OTBND-TRIP-ID                     52830032
528400                       ,:SUOBTR-DEST-OPER-UNT-ID                  52840032
528500                       ,:SUOBTS-TRIP-STAT-CDE                     52850032
528600                       ,:PV-USA-DATE                              52860032
528700                       ,:SUOBTS-TRLR-PRKG-SLOT-NBR                52870032
528800                       ,:SUOBTS-DOOR-ID                           52880032
528900                       ,:CNTRID-SCAC-CDE                          52890032
529000                       ,:CNTRID-TRLR-ID                           52900032
529100                   FROM  TSUOBTR OBTR                             52910032
529200                        ,TSUOBTS OBTS                             52920032
529300                        ,TCNTRID TRID                             52930032
529400                  WHERE  OBTR.OTBND_TRIP_ID  = OBTS.OTBND_TRIP_ID 52940032
529500                    AND  OBTR.TRLR_SRL_NBR   = TRID.TRLR_SRL_NBR  52950032
529600                                                                  52960032
529700                    AND  OBTR.TRIP_ACTV_CDE  = 'A'                52970032
529800                    AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID  52980032
529900                    AND  OBTR.OTBND_TRIP_ID  = :DK-TRIP-ID        52990032
530000                                                                  53000032
530100                    AND OTBND_STAT_TMST =                         53010032
530200                        (SELECT MAX(OBTS1.OTBND_STAT_TMST)        53020032
530300                   FROM TSUOBTS OBTS1                             53030032
530400                  WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID) 53040032
530500                                                                  53050032
530600             END-EXEC                                             53060032
530700                                                                  53070032
530800         WHEN PS-STR-NBR-CSR                                      53080032
530900             EXEC SQL                                             53090032
531000                  FETCH STR-NBR-CSR                               53100032
531100                 INTO  :SUOBTR-TRLR-SRL-NBR                       53110032
531200                      ,:SUOBTR-OTBND-TRIP-ID                      53120032
531300                      ,:SUOBTR-DEST-OPER-UNT-ID                   53130032
531400                      ,:SUOBTS-TRIP-STAT-CDE                      53140032
531500                      ,:PV-USA-DATE                               53150032
531600                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53160032
531700                      ,:SUOBTS-DOOR-ID                            53170032
531800                      ,:CNTRID-SCAC-CDE                           53180032
531900                      ,:CNTRID-TRLR-ID                            53190032
532000             END-EXEC                                             53200032
532100                                                                  53210032
532200         WHEN PS-TRLR-DOOR-CSR                                    53220032
532300             EXEC SQL                                             53230032
532400                  FETCH     DOOR-CSR                              53240032
532500                 INTO  :SUOBTR-TRLR-SRL-NBR                       53250032
532600                      ,:SUOBTR-OTBND-TRIP-ID                      53260032
532700                      ,:SUOBTR-DEST-OPER-UNT-ID                   53270032
532800                      ,:SUOBTS-TRIP-STAT-CDE                      53280032
532900                      ,:PV-USA-DATE                               53290032
533000                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53300032
533100                      ,:SUOBTS-DOOR-ID                            53310032
533200                      ,:CNTRID-SCAC-CDE                           53320032
533300                      ,:CNTRID-TRLR-ID                            53330032
533400             END-EXEC                                             53340032
533500                                                                  53350032
533600         WHEN PS-TRLR-SCAC-CSR                                    53360032
533700             EXEC SQL                                             53370032
533800                  FETCH     SCAC-CSR                              53380032
533900                 INTO  :SUOBTR-TRLR-SRL-NBR                       53390032
534000                      ,:SUOBTR-OTBND-TRIP-ID                      53400032
534100                      ,:SUOBTR-DEST-OPER-UNT-ID                   53410032
534200                      ,:SUOBTS-TRIP-STAT-CDE                      53420032
534300                      ,:PV-USA-DATE                               53430032
534400                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53440032
534500                      ,:SUOBTS-DOOR-ID                            53450032
534600                      ,:CNTRID-SCAC-CDE                           53460032
534700                      ,:CNTRID-TRLR-ID                            53470032
534800             END-EXEC                                             53480032
534900     END-EVALUATE.                                                53490032
535000                                                                  53500032
535100     EVALUATE TRUE                                                53510032
535200         WHEN SQLCODE = ZERO                                      53520032
535300         WHEN SQLCODE = +100                                      53530032
535400              CONTINUE                                            53540032
535500         WHEN SQLWARN0 NOT = SPACE                                53550032
535600         WHEN SQLCODE NOT = ZERO                                  53560032
535700              MOVE '4310-FETCH-CURSOR'                            53570032
535800                               TO DP013-PARAGRAPH                 53580032
535900              MOVE 'FETCH MESSAGE CURSOR'                         53590032
536000                               TO DP013-MESSAGE-TEXT (1)          53600032
536100              MOVE SQLCA       TO DP013-SQLCA                     53610032
536200              SET DP013-DB2-ABEND                                 53620032
536300                               TO TRUE                            53630032
536400              PERFORM DP013-0000-PROCESS-ABEND                    53640032
536500     END-EVALUATE.                                                53650032
536600                                                                  53660032
536700     IF  SQLCODE EQUAL +100                                       53670032
536800         SET ASC-NO-ITEMS-LEFT-ON-DB                              53680032
536900                                   TO TRUE                        53690032
537000     END-IF.                                                      53700032
537001 4310A-FETCH-ALTSEQ.                                              53700149
537002                                                                  53700232
537003     EVALUATE TRUE                                                53700332
537004         WHEN PS-TRLR-STAT-CSR                                    53700432
537005             EXEC SQL                                             53700532
537006                  FETCH STAT-CSR-ALT                              53700632
537007                 INTO  :SUOBTR-TRLR-SRL-NBR                       53700732
537008                      ,:SUOBTR-OTBND-TRIP-ID                      53700832
537009                      ,:SUOBTR-DEST-OPER-UNT-ID                   53700932
537010                      ,:SUOBTS-TRIP-STAT-CDE                      53701032
537011                      ,:PV-USA-DATE                               53701132
537012                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53701232
537013                      ,:SUOBTS-DOOR-ID                            53701332
537014                      ,:CNTRID-SCAC-CDE                           53701432
537015                      ,:CNTRID-TRLR-ID                            53701532
537016             END-EXEC                                             53701632
537017                                                                  53701732
537018         WHEN PS-TRLR-STAT-DATE-CSR                               53701832
537019             EXEC SQL                                             53701932
537020                  FETCH STAT-DATE-CSR-ALT                         53702032
537021                 INTO  :SUOBTR-TRLR-SRL-NBR                       53702132
537022                      ,:SUOBTR-OTBND-TRIP-ID                      53702232
537023                      ,:SUOBTR-DEST-OPER-UNT-ID                   53702332
537024                      ,:SUOBTS-TRIP-STAT-CDE                      53702432
537025                      ,:PV-USA-DATE                               53702532
537026                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53702632
537027                      ,:SUOBTS-DOOR-ID                            53702732
537028                      ,:CNTRID-SCAC-CDE                           53702832
537029                      ,:CNTRID-TRLR-ID                            53702932
537030             END-EXEC                                             53703032
537031                                                                  53703132
537032         WHEN PS-TRLR-STAT-DAYS-CSR                               53703232
537033             EXEC SQL                                             53703332
537034                  FETCH STAT-DAYS-CSR-ALT                         53703432
537035                 INTO  :SUOBTR-TRLR-SRL-NBR                       53703532
537036                      ,:SUOBTR-OTBND-TRIP-ID                      53703632
537037                      ,:SUOBTR-DEST-OPER-UNT-ID                   53703732
537038                      ,:SUOBTS-TRIP-STAT-CDE                      53703832
537039                      ,:PV-USA-DATE                               53703932
537040                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53704032
537041                      ,:SUOBTS-DOOR-ID                            53704132
537042                      ,:CNTRID-SCAC-CDE                           53704232
537043                      ,:CNTRID-TRLR-ID                            53704332
537044             END-EXEC                                             53704432
537045                                                                  53704532
537046         WHEN PS-TRLR-SRL-NBR-CSR                                 53704632
537047             EXEC SQL                                             53704732
537048                FETCH  SRL-NBR-CSR-ALT                            53704832
537049                 INTO  :SUOBTR-TRLR-SRL-NBR                       53704932
537050                      ,:SUOBTR-OTBND-TRIP-ID                      53705032
537051                      ,:SUOBTR-DEST-OPER-UNT-ID                   53705132
537052                      ,:SUOBTS-TRIP-STAT-CDE                      53705232
537053                      ,:PV-USA-DATE                               53705332
537054                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53705432
537055                      ,:SUOBTS-DOOR-ID                            53705532
537056                      ,:CNTRID-SCAC-CDE                           53705632
537057                      ,:CNTRID-TRLR-ID                            53705732
537058             END-EXEC                                             53705832
537059                                                                  53705932
537060         WHEN PS-TRIP-ID-CSR                                      53706032
537061             EXEC SQL                                             53706132
537062                 SELECT  OBTR.TRLR_SRL_NBR                        53706232
537063                        ,OBTR.OTBND_TRIP_ID                       53706332
537064                        ,OBTR.DEST_OPER_UNT_ID                    53706432
537065                        ,OBTS.TRIP_STAT_CDE                       53706532
537066                        ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)     53706632
537067                        ,OBTS.TRLR_PRKG_SLOT_NBR                  53706732
537068                        ,OBTS.DOOR_ID                             53706832
537069                        ,TRID.SCAC_CDE                            53706932
537070                        ,TRID.TRLR_ID                             53707032
537071                  INTO  :SUOBTR-TRLR-SRL-NBR                      53707132
537072                       ,:SUOBTR-OTBND-TRIP-ID                     53707232
537073                       ,:SUOBTR-DEST-OPER-UNT-ID                  53707332
537074                       ,:SUOBTS-TRIP-STAT-CDE                     53707432
537075                       ,:PV-USA-DATE                              53707532
537076                       ,:SUOBTS-TRLR-PRKG-SLOT-NBR                53707632
537077                       ,:SUOBTS-DOOR-ID                           53707732
537078                       ,:CNTRID-SCAC-CDE                          53707832
537079                       ,:CNTRID-TRLR-ID                           53707932
537080                   FROM  TSUOBTR OBTR                             53708032
537081                        ,TSUOBTS OBTS                             53708132
537082                        ,TCNTRID TRID                             53708232
537083                  WHERE  OBTR.OTBND_TRIP_ID  = OBTS.OTBND_TRIP_ID 53708332
537084                    AND  OBTR.TRLR_SRL_NBR   = TRID.TRLR_SRL_NBR  53708432
537085                                                                  53708532
537086                    AND  OBTR.TRIP_ACTV_CDE  = 'A'                53708632
537087                    AND  OBTR.ORGN_OPER_UNT_ID = :DK-OPER-UNT-ID  53708732
537088                    AND  OBTR.OTBND_TRIP_ID  = :DK-TRIP-ID        53708832
537089                                                                  53708932
537090                    AND OTBND_STAT_TMST =                         53709032
537091                        (SELECT MAX(OBTS1.OTBND_STAT_TMST)        53709132
537092                   FROM TSUOBTS OBTS1                             53709232
537093                  WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID) 53709332
537094                                                                  53709432
537095             END-EXEC                                             53709532
537096                                                                  53709632
537097         WHEN PS-STR-NBR-CSR                                      53709732
537098             EXEC SQL                                             53709832
537099                  FETCH STR-NBR-CSR                               53709932
537100                 INTO  :SUOBTR-TRLR-SRL-NBR                       53710032
537101                      ,:SUOBTR-OTBND-TRIP-ID                      53710132
537102                      ,:SUOBTR-DEST-OPER-UNT-ID                   53710232
537103                      ,:SUOBTS-TRIP-STAT-CDE                      53710332
537104                      ,:PV-USA-DATE                               53710432
537105                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53710532
537106                      ,:SUOBTS-DOOR-ID                            53710632
537107                      ,:CNTRID-SCAC-CDE                           53710732
537108                      ,:CNTRID-TRLR-ID                            53710832
537109             END-EXEC                                             53710932
537110                                                                  53711032
537111         WHEN PS-TRLR-DOOR-CSR                                    53711132
537112             EXEC SQL                                             53711232
537113                  FETCH DOOR-CSR-ALT                              53711332
537114                 INTO  :SUOBTR-TRLR-SRL-NBR                       53711432
537115                      ,:SUOBTR-OTBND-TRIP-ID                      53711532
537116                      ,:SUOBTR-DEST-OPER-UNT-ID                   53711632
537117                      ,:SUOBTS-TRIP-STAT-CDE                      53711732
537118                      ,:PV-USA-DATE                               53711832
537119                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53711932
537120                      ,:SUOBTS-DOOR-ID                            53712032
537121                      ,:CNTRID-SCAC-CDE                           53712132
537122                      ,:CNTRID-TRLR-ID                            53712232
537123             END-EXEC                                             53712332
537124                                                                  53712432
537125         WHEN PS-TRLR-SCAC-CSR                                    53712532
537126             EXEC SQL                                             53712632
537127                  FETCH SCAC-CSR-ALT                              53712732
537128                 INTO  :SUOBTR-TRLR-SRL-NBR                       53712832
537129                      ,:SUOBTR-OTBND-TRIP-ID                      53712932
537130                      ,:SUOBTR-DEST-OPER-UNT-ID                   53713032
537131                      ,:SUOBTS-TRIP-STAT-CDE                      53713132
537132                      ,:PV-USA-DATE                               53713232
537133                      ,:SUOBTS-TRLR-PRKG-SLOT-NBR                 53713332
537134                      ,:SUOBTS-DOOR-ID                            53713432
537135                      ,:CNTRID-SCAC-CDE                           53713532
537136                      ,:CNTRID-TRLR-ID                            53713632
537137             END-EXEC                                             53713732
537138     END-EVALUATE.                                                53713832
537139                                                                  53713932
537140     EVALUATE TRUE                                                53714032
537141         WHEN SQLCODE = ZERO                                      53714132
537142         WHEN SQLCODE = +100                                      53714232
537143              CONTINUE                                            53714332
537144         WHEN SQLWARN0 NOT = SPACE                                53714432
537145         WHEN SQLCODE NOT = ZERO                                  53714532
537146              MOVE '4310A-FETCH-ALTSEQ'                           53714632
537147                               TO DP013-PARAGRAPH                 53714732
537148              MOVE 'FETCH MESSAGE CURSOR'                         53714832
537149                               TO DP013-MESSAGE-TEXT (1)          53714932
537150              MOVE SQLCA       TO DP013-SQLCA                     53715032
537151              SET DP013-DB2-ABEND                                 53715132
537152                               TO TRUE                            53715232
537153              PERFORM DP013-0000-PROCESS-ABEND                    53715332
537154     END-EVALUATE.                                                53715432
537155                                                                  53715532
537156     IF  SQLCODE EQUAL +100                                       53715632
537157         SET ASC-NO-ITEMS-LEFT-ON-DB                              53715732
537158                                   TO TRUE                        53715832
537159     END-IF.                                                      53715932
537160/                                                                 53716032
537200*----------------------------------------------------------------*53720032
537300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *53730032
537400*----------------------------------------------------------------*53740032
537500                                                                  53750032
537600 4400-MOVE-COMMAREA-TO-SCREEN.                                    53760032
537700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             53770032
537800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          53780032
537900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          53790032
538000             MOVE +1    TO ASC-BLK-SUB                            53800032
538100             PERFORM 5100-WRITE-TEMP-STORAGE                      53810032
538200             ADD +1     TO ASC-BLK-SUB                            53820032
538300             PERFORM 5100-WRITE-TEMP-STORAGE                      53830032
538400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             53840032
538500                 GIVING PV-BLOCK-NUMBER                           53850032
538600                 REMAINDER PV-REMAINDER                           53860032
538700             IF  PV-REMAINDER > ZERO                              53870032
538800                 ADD +1 TO PV-BLOCK-NUMBER                        53880032
538900             END-IF                                               53890032
539000             MOVE +1    TO ASC-BLK-SUB                            53900032
539100             PERFORM 4410-READ-TEMP-STORAGE                       53910032
539200             ADD +1     TO ASC-BLK-SUB                            53920032
539300                           PV-BLOCK-NUMBER                        53930032
539400             PERFORM 4410-READ-TEMP-STORAGE                       53940032
539500     END-IF.                                                      53950032
539600     MOVE +1            TO ASC-BLK-SUB.                           53960032
539700     COMPUTE ASC-ITEM-SUB =                                       53970032
539800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              53980032
539900         + PC-ITEMS-PER-PANEL).                                   53990032
540000*                                                                 54000032
540100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        54010032
540200         ADD +1         TO ASC-BLK-SUB                            54020032
540300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            54030032
540400     END-IF.                                                      54040032
540500*                                                                 54050032
540600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           54060032
540700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                54070032
540800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        54080032
540900     PERFORM 4420-FORMAT-LIST-LINES                               54090032
541000         VARYING PV-SUB                                           54100032
541100         FROM PC-ITEMS-PER-PANEL BY -1                            54110032
541200         UNTIL PV-SUB < +1.                                       54120032
541300*                                                                 54130032
541400     COMPUTE ASC-ITEMS-DISPLAYED =                                54140032
541500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          54150032
541600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    54160032
541700                                      ASTRTITO.                   54170032
541800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    54180032
541900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    54190032
542000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            54200032
542100                                   TO ASELITO.                    54210032
542200                                                                  54220032
542300     MOVE ASC-OPER-UNT-ID            TO AOPERO.                   54230032
542400     MOVE ASC-OPER-UNT-NAME          TO AOPRNMEO.                 54240032
542500                                                                  54250032
542600*                                                                 54260032
542700     IF  DP020-MSG-NUMBER-X = SPACE                               54270032
542800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  54280032
542900*            --- MORE ITEMS TO DISPLAY ----                       54290032
543000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            54300032
543100             SET DP020-MSG-INFORMATIONAL TO TRUE                  54310032
543200         END-IF                                                   54320032
543300     END-IF.                                                      54330032
543400*----------------------------------------------------------------*54340032
543500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *54350032
543600*----------------------------------------------------------------*54360032
543700                                                                  54370032
543800 4410-READ-TEMP-STORAGE.                                          54380032
543900                                                                  54390032
544000     EXEC CICS                                                    54400032
544100         READQ TS                                                 54410032
544200             QUEUE (ASC-LIST-QUEUE-NAME)                          54420032
544300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               54430032
544400             ITEM  (PV-BLOCK-NUMBER)                              54440032
544500             RESP  (PV-CICS-RESP)                                 54450032
544600     END-EXEC.                                                    54460032
544700                                                                  54470032
544800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       54480032
544900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     54490032
545000         CONTINUE                                                 54500032
545100     ELSE                                                         54510032
545200         SET DP013-CICS-ABEND     TO TRUE                         54520032
545300         SET DP013-NO-ROLLBACK    TO TRUE                         54530032
545400         MOVE '4410-READ-TEMP-STORAGE'                            54540032
545500                                  TO DP013-PARAGRAPH              54550032
545600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      54560032
545700                                  TO DP013-MESSAGE-TEXT(1)        54570032
545800         PERFORM DP013-0000-PROCESS-ABEND                         54580032
545900     END-IF.                                                      54590032
546000                                                                  54600032
546100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             54610032
546200*                                                                 54620032
546300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         54630032
546400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               54640032
546500     END-IF.                                                      54650032
546600 EJECT                                                            54660032
546700*----------------------------------------------------------------*54670032
546800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *54680032
546900*----------------------------------------------------------------*54690032
547000                                                                  54700032
547100 4420-FORMAT-LIST-LINES.                                          54710032
547200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      54720032
547300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                54730032
547400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           54740032
547500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           54750032
547600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           54760032
547700                                    MR-ACTION (PV-SUB)            54770032
547800                                    MR-SCAC         (PV-SUB)      54780032
547900                                    MR-TRLR-ID      (PV-SUB)      54790032
548000                                    MR-TRLR-SRL-NBR (PV-SUB)      54800032
548100                                    MR-TRIP-ID (PV-SUB)           54810032
548200                                    MR-TRIP-STATUS (PV-SUB)       54820032
548300                                    MR-STAT-DATE (PV-SUB)         54830032
548400                                    MR-DOOR (PV-SUB)              54840032
548500                                    MR-DEST-NBR (PV-SUB)          54850032
548600     ELSE                                                         54860032
548700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      54870032
548800                                                   > SPACE        54880032
548900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 54890032
549000                                 TO MR-SELECTI (PV-SUB)           54900032
549100         ELSE                                                     54910032
549200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      54920032
549300                                 TO MR-SELECTI (PV-SUB)           54930032
549400         END-IF                                                   54940032
549500*                                                                 54950032
549600         IF  DP030-SET-CURSOR-TRAILER                             54960032
549700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)54970032
549800                 > SPACE)                                         54980032
549900               OR (PV-SUB = 1))                                   54990032
550000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               55000032
550100                MOVE -1          TO MR-SELECTL (PV-SUB)           55010032
550200             END-IF                                               55020032
550300         END-IF                                                   55030032
550400*                                                                 55040032
550500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           55050032
550600             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           55060032
550700                                         TO MR-ACTION (PV-SUB)    55070032
550800             MOVE ASC-SCREEN-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)      55080032
550900                                         TO MR-SCAC (PV-SUB)      55090032
551000             MOVE ASC-SCREEN-TRLR-ID (ASC-BLK-SUB ASC-ITEM-SUB)   55100032
551100                                         TO MR-TRLR-ID (PV-SUB)   55110032
551200             MOVE ASC-SCREEN-TRLR-SRL-NBR                         55120032
551300                                  (ASC-BLK-SUB ASC-ITEM-SUB)      55130032
551400                                       TO MR-TRLR-SRL-NBR (PV-SUB)55140032
551500             MOVE ASC-SCREEN-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)   55150032
551600                                           TO MR-TRIP-ID (PV-SUB) 55160032
551700             MOVE ASC-TRIP-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)      55170032
551800                                       TO MR-TRIP-STATUS (PV-SUB) 55180032
551900             MOVE ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)        55190032
552000                                         TO MR-STAT-DATE (PV-SUB) 55200032
552100             MOVE ASC-SCREEN-DOOR (ASC-BLK-SUB ASC-ITEM-SUB)      55210032
552200                                       TO MR-DOOR (PV-SUB)        55220032
552300             MOVE ASC-SCREEN-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)  55230032
552400                                          TO MR-DEST-NBR (PV-SUB) 55240032
552500         END-IF                                                   55250032
552600     END-IF.                                                      55260032
552700     SUBTRACT +1 FROM ASC-ITEM-SUB                                55270032
552800     IF  ASC-ITEM-SUB < + 1                                       55280032
552900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  55290032
553000         MOVE +1                 TO ASC-BLK-SUB                   55300032
553100     END-IF.                                                      55310032
553200******************************************************************55320032
553300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **55330032
553400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **55340032
553500** ISSUE A WARNING.                                             **55350032
553600******************************************************************55360032
553700 4430-CHECK-FOR-BEGIN-AND-END.                                    55370032
553800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       55380032
553900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     55390032
554000*            -- NO END-OF-RANGE SPECFIED ---                      55400032
554100             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            55410032
554200             SET DP020-MSG-WARNING TO TRUE                        55420032
554300             PERFORM 4431-POSITION-AT-WARNING                     55430032
554400         END-IF                                                   55440032
554500     ELSE                                                         55450032
554600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     55460032
554700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                55470032
554800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            55480032
554900             SET DP020-MSG-WARNING TO TRUE                        55490032
555000             PERFORM 4431-POSITION-AT-WARNING                     55500032
555100         END-IF                                                   55510032
555200     END-IF.                                                      55520032
555300******************************************************************55530032
555400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **55540032
555500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **55550032
555600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **55560032
555700** POSITION THE CURSOR THERE.                                   **55570032
555800******************************************************************55580032
555900 4431-POSITION-AT-WARNING.                                        55590032
556000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 55600032
556100                    - PV-TOP-ITEM + 1.                            55610032
556200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      55620032
556300         CONTINUE                                                 55630032
556400     ELSE                                                         55640032
556500         SET DP030-SET-CURSOR-APPL-1                              55650032
556600                                   TO TRUE                        55660032
556700         MOVE -1                   TO MR-SELECTL (PV-SUB)         55670032
556800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         55680032
556900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         55690032
557000     END-IF.                                                      55700032
557100*                                                                 55710032
557200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   55720032
557300                    - PV-TOP-ITEM + 1.                            55730032
557400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      55740032
557500         CONTINUE                                                 55750032
557600     ELSE                                                         55760032
557700         SET DP030-SET-CURSOR-APPL-1                              55770032
557800                                   TO TRUE                        55780032
557900         MOVE -1                   TO MR-SELECTL (PV-SUB)         55790032
558000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         55800032
558100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         55810032
558200     END-IF.                                                      55820032
558300 EJECT                                                            55830032
558400*----------------------------------------------------------------*55840032
558500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *55850032
558600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *55860032
558700* FOR THE SELECTED ITEMS QUEUE.                                  *55870032
558800*                                                                *55880032
558900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *55890032
559000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *55900032
559100* THE ARRAY IS FULL.                                             *55910032
559200*----------------------------------------------------------------*55920032
559300                                                                  55930032
559400 5000-PREPARE-SEL-QUEUE.                                          55940032
559500                                                                  55950032
559600     MOVE +1                   TO  ASC-BLK-SUB.                   55960032
559700     PERFORM 5100-WRITE-TEMP-STORAGE.                             55970032
559800     ADD +1                    TO  ASC-BLK-SUB.                   55980032
559900     PERFORM 5100-WRITE-TEMP-STORAGE.                             55990032
560000                                                                  56000032
560100     MOVE ASC-SEL-QUEUE-NAME-OUT   TO  SU009-SEL-QUEUE-NAME.      56010032
560200     PERFORM 6010-DELETE-SEL-QUEUE.                               56020032
560300                                                                  56030032
560400     SET ASC-UPDATE-TSQ        TO  TRUE.                          56040032
560500                                                                  56050032
560600     SET SU010-IDX             TO  1.                             56060032
560700     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       56070032
560800     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        56080032
560900                                                                  56090032
561000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           56100032
561100             VARYING PV-ITEM                                      56110032
561200             FROM 1 BY 1                                          56120032
561300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     56130032
561400                                                                  56140032
561500     IF  SU010-IDX > 1                                            56150032
561600         PERFORM 5205-WRITE-SEL-QUEUE                             56160032
561700         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        56170032
561800     END-IF.                                                      56180032
561900/                                                                 56190032
562000*----------------------------------------------------------------*56200032
562100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *56210032
562200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *56220032
562300*----------------------------------------------------------------*56230032
562400                                                                  56240032
562500 5100-WRITE-TEMP-STORAGE.                                         56250032
562600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     56260032
562700                                   TO PV-LIST-ITEM-NUMBER.        56270032
562800     COMPUTE PV-BLOCK-NUMBER =                                    56280032
562900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    56290032
563000                                                                  56300032
563100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             56310032
563200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             56320032
563300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      56330032
563400             PERFORM 5105-REWRITE-ASC-LISTQ                       56340032
563500         END-IF                                                   56350032
563600     ELSE                                                         56360032
563700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       56370032
563800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            56380032
563900         PERFORM 5110-WRITE-ASC-LISTQ                             56390032
564000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   56400032
564100     END-IF.                                                      56410032
564200                                                                  56420032
564300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             56430032
564400******************************************************************56440032
564500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **56450032
564600** SPECIFIC COMMAREA.                                           **56460032
564700******************************************************************56470032
564800 5105-REWRITE-ASC-LISTQ.                                          56480032
564900     EXEC CICS                                                    56490032
565000         WRITEQ TS                                                56500032
565100             QUEUE (ASC-LIST-QUEUE-NAME)                          56510032
565200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56520032
565300             ITEM  (PV-BLOCK-NUMBER)                              56530032
565400             REWRITE                                              56540032
565500             RESP  (PV-CICS-RESP)                                 56550032
565600     END-EXEC.                                                    56560032
565700                                                                  56570032
565800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           56580032
565900         CONTINUE                                                 56590032
566000     ELSE                                                         56600032
566100         SET DP013-CICS-ABEND            TO TRUE                  56610032
566200         SET DP013-NO-ROLLBACK           TO TRUE                  56620032
566300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       56630032
566400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     56640032
566500                                         TO DP013-MESSAGE-TEXT(1) 56650032
566600         PERFORM DP013-0000-PROCESS-ABEND                         56660032
566700     END-IF.                                                      56670032
566800                                                                  56680032
566900******************************************************************56690032
567000** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **56700032
567100** SPECIFIC COMMAREA.                                           **56710032
567200******************************************************************56720032
567300 5110-WRITE-ASC-LISTQ.                                            56730032
567400     EXEC CICS                                                    56740032
567500         WRITEQ TS                                                56750032
567600             QUEUE (ASC-LIST-QUEUE-NAME)                          56760032
567700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56770032
567800             ITEM  (PV-BLOCK-NUMBER)                              56780032
567900             RESP  (PV-CICS-RESP)                                 56790032
568000     END-EXEC.                                                    56800032
568100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      56810032
568200         SET DP013-CICS-ABEND      TO TRUE                        56820032
568300         SET DP013-NO-ROLLBACK     TO TRUE                        56830032
568400         MOVE '5110-WRITE-ASC-LISTQ'                              56840032
568500                                   TO DP013-PARAGRAPH             56850032
568600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           56860032
568700                                   TO DP013-MESSAGE-TEXT(1)       56870032
568800         PERFORM DP013-0000-PROCESS-ABEND                         56880032
568900     END-IF.                                                      56890032
569000 EJECT                                                            56900032
569100*----------------------------------------------------------------*56910032
569200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *56920032
569300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *56930032
569400*----------------------------------------------------------------*56940032
569500                                                                  56950032
569600 5200-FILL-SEL-QUEUE-RECORD.                                      56960032
569700                                                                  56970032
569800     PERFORM 6112-READ-LIST-QUEUE.                                56980032
569900                                                                  56990032
570000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       57000032
570100         PERFORM                                                  57010065
570200         VARYING LQW-IDX                                          57020065
570300         FROM 1 BY 1                                              57030065
570400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            57040065
570500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          57050065
570510*        PERFORM                                                  57051065
570520*        VARYING LQW-IDX                                          57052065
570530*        FROM PC-ITEMS-PER-PANEL BY -1                            57053065
570540*        UNTIL LQW-IDX LESS THAN 1                                57054065
570550*          OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          57055065
570600                                                                  57060032
570700             IF  LQW-SELECT (LQW-IDX)                             57070032
570800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              57080032
570900                                   TO SU010-ITEM (SU010-IDX)      57090032
571000                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 57100065
571100                                                                  57110032
571200                 MOVE LQW-SCAC (LQW-IDX)                          57120049
571300                                        TO SU010-SCAC (SU010-IDX) 57130049
571400                 MOVE LQW-TRLR-ID (LQW-IDX)                       57140049
571401                                     TO SU010-TRLR-ID (SU010-IDX) 57140149
571402                 MOVE LQW-TRLR-SRL-NBR (LQW-IDX)                  57140232
571403                                TO SU010-TRLR-SRL-NBR (SU010-IDX) 57140332
571404                 MOVE LQW-TRIP-ID (LQW-IDX)                       57140432
571500                                     TO SU010-TRIP-ID (SU010-IDX) 57150032
571600                 MOVE LQW-TRIP-STATUS (LQW-IDX)                   57160032
571700                                 TO SU010-TRIP-STATUS (SU010-IDX) 57170032
571800                 MOVE LQW-STAT-DATE (LQW-IDX)                     57180032
571900                                   TO SU010-STAT-DATE (SU010-IDX) 57190032
572000                 MOVE LQW-DOOR (LQW-IDX)                          57200032
572100                                 TO SU010-DESCRIPTION (SU010-IDX) 57210032
572200                 MOVE LQW-DEST-NBR (LQW-IDX)                      57220032
572300                                    TO SU010-DEST-NBR (SU010-IDX) 57230032
572301                 MOVE LQW-TRIP-ID (LQW-IDX)                       57230159
572310                                         TO SU009-TRIP-ID         57231059
572311                 MOVE LQW-TRLR-ID (LQW-IDX)                       57231159
572320                                         TO SU009-TRLR-ID         57232059
572321                 MOVE LQW-SCAC (LQW-IDX)                          57232159
572330                                         TO SU009-SCAC-CDE        57233059
572331                 MOVE LQW-STAT-DATE (LQW-IDX)                     57233159
572340                                         TO SU009-STATUS-DATE     57234059
572400                                                                  57240032
572500                 SET SU010-IDX UP BY 1                            57250032
572600                 IF  SU010-IDX > SU010-MAX-ITEMS                  57260032
572700                     PERFORM 5205-WRITE-SEL-QUEUE                 57270032
572800                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    57280032
572900                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         57290032
573000                     SET SU010-IDX TO  1                          57300032
573100                 END-IF                                           57310032
573200             END-IF                                               57320032
573300         END-PERFORM                                              57330032
573400     END-IF.                                                      57340032
573500                                                                  57350032
573600*----------------------------------------------------------------*57360032
573700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *57370032
573800*----------------------------------------------------------------*57380032
573900                                                                  57390032
574000 5205-WRITE-SEL-QUEUE.                                            57400032
574100                                                                  57410032
574200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            57420065
574300                                   TO SU010-SELECTED-ITEMS.       57430032
574400                                                                  57440032
574500     EXEC CICS                                                    57450032
574600          WRITEQ TS                                               57460032
574700              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      57470032
574800              FROM  (SU010-SELECT-RECORD)                         57480032
574900              ITEM  (PV-SEL-QUEUE-ITEM)                           57490032
575000              RESP  (PV-CICS-RESP)                                57500032
575100     END-EXEC.                                                    57510032
575200                                                                  57520032
575300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57530032
575400         CONTINUE                                                 57540032
575500     ELSE                                                         57550032
575600         SET DP013-CICS-ABEND      TO TRUE                        57560032
575700         SET DP013-NO-ROLLBACK     TO TRUE                        57570032
575800         MOVE '5205-WRITE-SEL-QUEUE'                              57580032
575900                                   TO DP013-PARAGRAPH             57590032
576000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          57600032
576100                                   TO DP013-MESSAGE-TEXT(1)       57610032
576200         PERFORM DP013-0000-PROCESS-ABEND                         57620032
576300     END-IF.                                                      57630032
576400 EJECT                                                            57640032
576500******************************************************************57650032
576600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **57660032
576700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **57670032
576800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **57680032
576900** THE USER.                                                    **57690032
577000******************************************************************57700032
577100 6000-REFRESH-PANEL-FROM-TEMP.                                    57710032
577200     IF  ASC-UPDATE-TSQ                                           57720032
577300         SET ASC-NO-TSQ-UPDATE TO TRUE                            57730032
577400         MOVE ZERO                 TO PV-SAVE-ITEM                57740032
577500                                      PV-SEL-QUEUE-ITEM           57750032
577600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        57760032
577700                                   TO PV-HOLD-SELECTED-ITEMS      57770032
577800         MOVE +1                   TO PV-ITEMS-PROCESSED          57780032
577900         PERFORM 6100-UPDATE-TSQ                                  57790032
578000             UNTIL PV-ITEMS-PROCESSED >                           57800032
578100                                     PV-HOLD-SELECTED-ITEMS       57810032
578200         PERFORM 6010-DELETE-SEL-QUEUE                            57820032
578300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         57830032
578400                    ASC-BLOCK-ENTRIES (2)                         57840032
578500     END-IF.                                                      57850032
578600                                                                  57860032
578700*----------------------------------------------------------------*57870032
578800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *57880032
578900*----------------------------------------------------------------*57890032
579000 6010-DELETE-SEL-QUEUE.                                           57900032
579100                                                                  57910032
579200     EXEC CICS                                                    57920032
579300         DELETEQ TS                                               57930032
579400             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       57940032
579500             RESP  (PV-CICS-RESP)                                 57950032
579600     END-EXEC.                                                    57960032
579700*                                                                 57970032
579800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      57980032
579900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         57990032
580000         CONTINUE                                                 58000032
580100     ELSE                                                         58010032
580200         SET DP013-CICS-ABEND TO TRUE                             58020032
580300         SET DP013-NO-ROLLBACK TO TRUE                            58030032
580400         MOVE '6010-DELETE-SEL-QUEUE'                             58040032
580500                        TO DP013-PARAGRAPH                        58050032
580600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         58060032
580700                        TO DP013-MESSAGE-TEXT (1)                 58070032
580800         PERFORM DP013-0000-PROCESS-ABEND                         58080032
580900     END-IF.                                                      58090032
581000                                                                  58100032
581100*----------------------------------------------------------------*58110032
581200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *58120032
581300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *58130032
581400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *58140032
581500*    THE TEMP QUEUE.                                             *58150032
581600*----------------------------------------------------------------*58160032
581700                                                                  58170032
581800 6100-UPDATE-TSQ.                                                 58180032
581900                                                                  58190032
582000     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             58200032
582100     PERFORM 6105-READ-SEL-QUEUE.                                 58210032
582200     PERFORM                                                      58220032
582300         VARYING SU010-IDX                                        58230032
582400         FROM 1 BY 1                                              58240032
582500         UNTIL ((PV-ITEMS-PROCESSED >                             58250032
582600                              PV-HOLD-SELECTED-ITEMS)             58260032
582700         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             58270032
582800         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  58280032
582900             PERFORM 6110-PROCESS-ITEMS                           58290032
583000         END-IF                                                   58300032
583100         ADD +1                TO PV-ITEMS-PROCESSED              58310032
583200     END-PERFORM.                                                 58320032
583300     PERFORM 6111-WRITE-LIST-QUEUE.                               58330032
583400*----------------------------------------------------------------*58340032
583500*    READ THE LIST QUEUE RECORD.                                 *58350032
583600*----------------------------------------------------------------*58360032
583700                                                                  58370032
583800 6105-READ-SEL-QUEUE.                                             58380032
583900                                                                  58390032
584000     EXEC CICS                                                    58400032
584100          READQ TS                                                58410032
584200              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      58420032
584300              INTO  (SU010-SELECT-RECORD)                         58430032
584400              ITEM  (PV-SEL-QUEUE-ITEM)                           58440032
584500              RESP  (PV-CICS-RESP)                                58450032
584600     END-EXEC.                                                    58460032
584700*                                                                 58470032
584800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          58480032
584900         CONTINUE                                                 58490032
585000     ELSE                                                         58500032
585100         SET DP013-CICS-ABEND      TO  TRUE                       58510032
585200         SET DP013-NO-ROLLBACK     TO  TRUE                       58520032
585300         MOVE '6105-READ-SEL-QUEUE'                               58530032
585400                                   TO  DP013-PARAGRAPH            58540032
585500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           58550032
585600                                   TO  DP013-MESSAGE-TEXT(1)      58560032
585700         PERFORM DP013-0000-PROCESS-ABEND                         58570032
585800     END-IF.                                                      58580032
585900/                                                                 58590032
586000*----------------------------------------------------------------*58600032
586100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*58610032
586200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*58620032
586300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *58630032
586400*----------------------------------------------------------------*58640032
586500                                                                  58650032
586600 6110-PROCESS-ITEMS.                                              58660032
586700                                                                  58670032
586800     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          58680032
586900                     / PC-ITEMS-PER-PANEL).                       58690032
587000                                                                  58700032
587100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           58710032
587200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          58720032
587300             PERFORM 6111-WRITE-LIST-QUEUE                        58730032
587400         END-IF                                                   58740032
587500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    58750032
587600                                                                  58760032
587700         PERFORM 6112-READ-LIST-QUEUE                             58770032
587800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               58780032
587900             CONTINUE                                             58790032
588000         END-IF                                                   58800032
588100     END-IF.                                                      58810032
588200                                                                  58820032
588300     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     58830032
588400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              58840032
588500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         58850032
588600     MOVE LQW-SELECTED-SW (PV-SUB)                                58860032
588700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  58870032
588800     EVALUATE TRUE                                                58880032
588900         WHEN SU010-INQ (SU010-IDX)                               58890032
589000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             58900032
589100                                                                  58910032
589200         WHEN SU010-UPD (SU010-IDX)                               58920032
589300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             58930032
589400              PERFORM 7000-GET-UPDATED-FIELDS                     58940032
589500                                                                  58950032
589600         WHEN SU010-DEL (SU010-IDX)                               58960032
589700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             58970032
589800                                                                  58980032
589900         WHEN SU010-ERR (SU010-IDX)                               58990032
590000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             59000032
590100     END-EVALUATE.                                                59010032
590200                                                                  59020032
590300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                59030032
590400                                                                  59040032
590500*----------------------------------------------------------------*59050032
590600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *59060032
590700*----------------------------------------------------------------*59070032
590800                                                                  59080032
590900 6111-WRITE-LIST-QUEUE.                                           59090032
591000                                                                  59100032
591100     EXEC CICS                                                    59110032
591200         WRITEQ TS                                                59120032
591300             QUEUE (ASC-LIST-QUEUE-NAME)                          59130032
591400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     59140032
591500             ITEM  (PV-SAVE-ITEM)                                 59150032
591600             REWRITE                                              59160032
591700             RESP  (PV-CICS-RESP)                                 59170032
591800     END-EXEC.                                                    59180032
591900*                                                                 59190032
592000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59200032
592100         CONTINUE                                                 59210032
592200     ELSE                                                         59220032
592300         SET DP013-CICS-ABEND  TO  TRUE                           59230032
592400         SET DP013-NO-ROLLBACK TO  TRUE                           59240032
592500         MOVE '6111-WRITE-LIST-QUEUE'                             59250032
592600                               TO  DP013-PARAGRAPH                59260032
592700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  59270032
592800                               TO  DP013-MESSAGE-TEXT(1)          59280032
592900         PERFORM DP013-0000-PROCESS-ABEND                         59290032
593000     END-IF.                                                      59300032
593100                                                                  59310032
593200/                                                                 59320032
593300*----------------------------------------------------------------*59330032
593400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*59340032
593500*----------------------------------------------------------------*59350032
593600                                                                  59360032
593700 6112-READ-LIST-QUEUE.                                            59370032
593800                                                                  59380032
593900     EXEC CICS                                                    59390032
594000         READQ TS                                                 59400032
594100             QUEUE (ASC-LIST-QUEUE-NAME)                          59410032
594200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     59420032
594300             ITEM  (PV-ITEM)                                      59430032
594400             RESP  (PV-CICS-RESP)                                 59440032
594500     END-EXEC.                                                    59450032
594600*                                                                 59460032
594700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59470032
594800         CONTINUE                                                 59480032
594900     ELSE                                                         59490032
595000         SET DP013-CICS-ABEND        TO TRUE                      59500032
595100         SET DP013-NO-ROLLBACK       TO TRUE                      59510032
595200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           59520032
595300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    59530032
595400                                     TO DP013-MESSAGE-TEXT(1)     59540032
595500         PERFORM DP013-0000-PROCESS-ABEND                         59550032
595600     END-IF.                                                      59560032
595700                                                                  59570032
595800 7000-GET-UPDATED-FIELDS.                                         59580032
595900     MOVE LQW-TRIP-ID (PV-SUB)   TO DK-TRIP-ID                    59590032
596000     MOVE ASC-OPER-UNT-ID        TO DK-OPER-UNT-ID                59600032
596100     EXEC SQL                                                     59610032
596200         SELECT  OBTR.TRLR_SRL_NBR                                59620032
596300                ,OBTR.OTBND_TRIP_ID                               59630032
596400                ,OBTR.DEST_OPER_UNT_ID                            59640032
596500                ,OBTS.TRIP_STAT_CDE                               59650032
596600                ,CHAR(DATE(OBTS.OTBND_STAT_TMST),USA)             59660032
596700                ,OBTS.TRLR_PRKG_SLOT_NBR                          59670032
596800                ,OBTS.DOOR_ID                                     59680032
596900                ,TRID.SCAC_CDE                                    59690032
597000                ,TRID.TRLR_ID                                     59700032
597100         INTO  :SUOBTR-TRLR-SRL-NBR                               59710032
597200               ,:SUOBTR-OTBND-TRIP-ID                             59720032
597300               ,:SUOBTR-DEST-OPER-UNT-ID                          59730032
597400               ,:SUOBTS-TRIP-STAT-CDE                             59740032
597500               ,:PV-USA-DATE                                      59750032
597600               ,:SUOBTS-TRLR-PRKG-SLOT-NBR                        59760032
597700               ,:SUOBTS-DOOR-ID                                   59770032
597800               ,:CNTRID-SCAC-CDE                                  59780032
597900               ,:CNTRID-TRLR-ID                                   59790032
598000         FROM  TSUOBTR OBTR                                       59800032
598100              ,TSUOBTS OBTS                                       59810032
598200              ,TCNTRID TRID                                       59820032
598300         WHERE  OBTR.OTBND_TRIP_ID =  OBTS.OTBND_TRIP_ID          59830032
598400           AND  OBTR.TRLR_SRL_NBR  =  TRID.TRLR_SRL_NBR           59840032
598500                                                                  59850032
598600           AND  OBTR.OTBND_TRIP_ID =  :DK-TRIP-ID                 59860032
598700           AND  OBTR.TRIP_ACTV_CDE =  'A'                         59870032
598800                                                                  59880032
598900           AND  OBTS.OTBND_STAT_TMST =                            59890032
599000                    (SELECT MAX(OBTS1.OTBND_STAT_TMST)            59900032
599100              FROM TSUOBTS OBTS1                                  59910032
599200                  WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID) 59920032
599300         END-EXEC.                                                59930032
599400                                                                  59940032
599500     EVALUATE TRUE                                                59950032
599600         WHEN SQLCODE = ZERO                                      59960032
599700             MOVE SUOBTR-TRLR-SRL-NBR       TO LQW-TRLR-SRL-NBR   59970032
599800                                               (PV-SUB)           59980032
599900             MOVE SUOBTR-OTBND-TRIP-ID      TO LQW-TRIP-ID        59990032
600000                                               (PV-SUB)           60000032
600100             MOVE SUOBTR-DEST-OPER-UNT-ID   TO LQW-DEST-NBR       60010032
600200                                               (PV-SUB)           60020032
600300             MOVE SUOBTS-TRIP-STAT-CDE      TO LQW-TRIP-STATUS    60030032
600400                                               (PV-SUB)           60040032
600500             MOVE PV-USA-DATE               TO LQW-STAT-DATE      60050032
600600                                               (PV-SUB)           60060032
600700             IF SUOBTS-TRLR-PRKG-SLOT-NBR > SPACES                60070032
600800                 MOVE SUOBTS-TRLR-PRKG-SLOT-NBR TO LQW-DOOR       60080032
600900                                               (PV-SUB)           60090032
601000             ELSE                                                 60100032
601010                 STRING ' ' SUOBTS-DOOR-ID ' '                    60101051
601020                     DELIMITED BY SIZE        INTO LQW-DOOR       60102051
601200                                               (PV-SUB)           60120032
601300             END-IF                                               60130032
601400             MOVE CNTRID-SCAC-CDE           TO LQW-SCAC           60140032
601500                                               (PV-SUB)           60150032
601600             MOVE CNTRID-TRLR-ID            TO LQW-TRLR-ID        60160032
601700                                               (PV-SUB)           60170032
601800                                                                  60180032
601900         WHEN SQLCODE = +100                                      60190032
602000             CONTINUE                                             60200032
602100         WHEN SQLWARN0 NOT = SPACE                                60210032
602200         WHEN SQLCODE NOT = ZERO                                  60220032
602300              MOVE '7000-GET-UPDATED-FIELDS' TO DP013-PARAGRAPH   60230032
602400              MOVE 'REFRESH UPDATED FIELDS'                       60240032
602500                               TO DP013-MESSAGE-TEXT (1)          60250032
602600              MOVE SQLCA       TO DP013-SQLCA                     60260032
602700              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       60270032
602800              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       60280032
602900              SET DP013-DB2-ABEND TO TRUE                         60290032
603000              PERFORM DP013-0000-PROCESS-ABEND                    60300032
603001     END-EVALUATE.                                                60300132
603002/                                                                 60300211
603003 8000-WRITE-CSSL.                                                 60300311
603004                                                                  60300411
603005     MOVE EIBTASKN TO PV-CICS-TASK                                60300511
603006     MOVE LENGTH OF PV-CICS-MSG-AREA                              60300611
603007               TO PV-COMMAREA-LENGTH                              60300711
603008                                                                  60300811
603009     EXEC CICS                                                    60300911
603010         WRITEQ TD                                                60301011
603011             QUEUE  ('CSSL')                                      60301111
603012             FROM  (PV-CICS-MSG-AREA)                             60301211
603013             LENGTH  (PV-COMMAREA-LENGTH)                         60301311
603014             RESP  (PV-CICS-RESP)                                 60301411
603015     END-EXEC.                                                    60301511
603016/                                                                 60301632
603017* JAK 04/2007 - ADD LOGIC FOR F24                                 60301753
603018 9000-ASN-DOWNLOAD.                                               60301849
603019                                                                  60301949
603020     MOVE +1                   TO  ASC-BLK-SUB.                   60302049
603030     PERFORM 5100-WRITE-TEMP-STORAGE.                             60303049
603040     ADD +1                    TO  ASC-BLK-SUB.                   60304049
603050     PERFORM 5100-WRITE-TEMP-STORAGE.                             60305049
603060                                                                  60306049
603070     PERFORM 6112-READ-LIST-QUEUE.                                60307049
603080                                                                  60308049
603090     SET LQW-IDX TO 1.                                            60309049
603100                                                                  60310049
603200     IF PS-NO-SOFT-ABORT-ERROR                                    60320049
603300       IF PV-CICS-RESP = DFHRESP (NORMAL)                         60330049
603400         PERFORM                                                  60340049
603500         VARYING LQW-IDX  FROM 1 BY 1                             60350049
603600         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     60360049
603700            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            60370049
603800            OR   PS-SOFT-ABORT-ERROR                              60380049
603900            OR   PS-ERROR                                         60390049
604000             IF  LQW-SELECT (LQW-IDX)                             60400049
604100                 PERFORM 9010-PROCESS-TRAILER                     60410049
604200             END-IF                                               60420049
604300         END-PERFORM                                              60430049
604400       END-IF                                                     60440049
604500     END-IF.                                                      60450049
604600                                                                  60460049
604700     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           60470049
604800     PERFORM 6111-WRITE-LIST-QUEUE.                               60480049
604900                                                                  60490049
605000     MOVE +1                     TO  ASC-BLK-SUB                  60500049
605100                                     PV-BLOCK-NUMBER.             60510049
605200     PERFORM 4410-READ-TEMP-STORAGE.                              60520049
605300                                                                  60530049
605400     ADD +1                      TO  ASC-BLK-SUB                  60540049
605500                                     PV-BLOCK-NUMBER.             60550049
605600     PERFORM 4410-READ-TEMP-STORAGE.                              60560049
605700                                                                  60570049
605800                                                                  60580049
605900/                                                                 60590049
606000 9010-PROCESS-TRAILER.                                            60600049
606100                                                                  60610049
606110* IF THE TRIP STATUS IS NOT 'DS', THEN WE CANNOT DOWNLOAD TO WMS  60611052
606200     IF LQW-TRIP-STATUS (LQW-IDX)  = 'DS'  OR                     60620073
606210        LQW-TRIP-STATUS (LQW-IDX)  = 'SO'                         60621073
606220         CONTINUE                                                 60622073
606230     ELSE                                                         60623073
606300         SET PS-ERROR                                             60630049
606400             DP030-SET-CURSOR-APPL-1                              60640049
606500             DP030-OVERRIDE-GO                                    60650049
606600             DP020-MSG-FATAL         TO TRUE                      60660049
606700         MOVE PC-TSYMSG-03540        TO DP020-MSG-NUMBER          60670049
606800         SET LQW-ERR (LQW-IDX) TO TRUE                            60680049
606810     END-IF.                                                      60681073
606811                                                                  60681173
606820     IF LQW-TRIP-STATUS (LQW-IDX)  = 'DS'  OR                     60682073
606830        LQW-TRIP-STATUS (LQW-IDX)  = 'SO'                         60683073
606840                                                                  60684073
607000         MOVE LQW-TRIP-ID (LQW-IDX)                               60700049
607100                                     TO DK-TRIP-ID                60710049
607200         PERFORM 9020-GET-WMS-SHIPMENT                            60720049
607300         IF PS-RECEIVING-BEGUN-YES                                60730049
607400             SET PS-ERROR                                         60740049
607500                 DP030-SET-CURSOR-APPL-1                          60750049
607600                 DP030-OVERRIDE-GO                                60760049
607700                 DP020-MSG-FATAL      TO TRUE                     60770049
607800             MOVE PC-TSYMSG-03541     TO DP020-MSG-NUMBER         60780049
607900             SET LQW-ERR (LQW-IDX) TO TRUE                        60790049
608000         ELSE                                                     60800049
608100             MOVE LQW-DEST-NBR (LQW-IDX)                          60810049
608200                                 TO DK-DEST-STR-NBR               60820049
608300                                                                  60830049
608400             PERFORM 9030-CHECK-ASN-TO-WMS-STATUS                 60840049
608500             IF PS-DWNLD-ASN-TO-WMS-YES                           60850049
608600                 PERFORM 9040-CALL-ASN-SHIP-CNTL-MOD              60860049
608700             ELSE                                                 60870049
608800                 SET PS-ERROR                                     60880049
608900                     DP030-SET-CURSOR-APPL-1                      60890049
609000                     DP030-OVERRIDE-GO                            60900049
609100                     DP020-MSG-FATAL      TO TRUE                 60910049
609200                 SET LQW-ERR (LQW-IDX) TO TRUE                    60920049
609300                 MOVE PC-TSYMSG-03553     TO DP020-MSG-NUMBER     60930049
609400             END-IF                                               60940049
609500         END-IF                                                   60950049
609600     END-IF.                                                      60960049
609700                                                                  60970049
609800/                                                                 60980049
609900 9020-GET-WMS-SHIPMENT.                                           60990049
610000                                                                  61000049
610010* SELECT THE SHIPMENT HEADER WHERE THE RCPT-TMST IS LOADED.       61001052
610020* IF ROW(S) FOUND, THEN RECEIVING HAS BEGUN, AND WE CANNOT        61002052
610030* RE-DOWNLOAD THIS TRAILER TO WMS.                                61003052
610040                                                                  61004052
610100     EXEC SQL                                                     61010049
610200         SELECT DISTINCT                                          61020049
610300                EXT_SHP_ID                                        61030049
610400         INTO                                                     61040049
610500               :WST00001-EXT-SHP-ID                               61050049
610600         FROM                                                     61060049
610700                WST_SHPMT_XREF_HDR                                61070049
610800         WHERE  INTR_TRIP_ID  = :DK-TRIP-ID                       61080049
610900         AND    SOR_CDE       = 'SH'                              61090049
611000         AND    RCPT_TMST     <> :PC-DEFAULT-NINES                61100049
611100     END-EXEC.                                                    61110049
611200                                                                  61120049
611300     EVALUATE TRUE                                                61130049
611400         WHEN SQLCODE = ZERO                                      61140049
611500         WHEN SQLCODE = -811                                      61150049
611600             SET PS-RECEIVING-BEGUN-YES  TO TRUE                  61160049
611700         WHEN SQLCODE = -904                                      61170049
611800         WHEN SQLCODE = -913                                      61180049
611900         WHEN SQLCODE = -911                                      61190049
612000             CONTINUE                                             61200049
612100         WHEN SQLCODE =  100                                      61210049
612200             SET PS-RECEIVING-BEGUN-NO   TO TRUE                  61220049
612300         WHEN SQLWARN0 NOT = SPACES                               61230049
612400         WHEN SQLCODE NOT = ZERO                                  61240049
612500             MOVE '9020-GET-WMS-SHIPMENT'                         61250049
612600                                  TO DP013-PARAGRAPH              61260049
612700             MOVE SQLCODE         TO PV-SQL-RETURN-CD             61270049
612800             STRING 'INVALID RETURN, SQLCODE='                    61280049
612900                         PV-SQL-RETURN-CD                         61290049
613000                         DELIMITED BY SIZE                        61300049
613100                                 INTO DP013-MESSAGE-TEXT (1)      61310049
613200             MOVE 'EXT SHP ID'                                    61320049
613300                                   TO DP013-MESSAGE-TEXT (2)      61330049
613400             MOVE SQLCA        TO DP013-SQLCA                     61340049
613500             MOVE 'WST_SHPMT_XREF_HDR'                            61350049
613600                                   TO DP013-DB2-TABLE-NAME (1)    61360049
613700             SET DP013-DB2-ABEND                                  61370049
613800                 DP013-XCTL-DISPLAY-RESTART                       61380049
613900                                   TO TRUE                        61390049
614000             PERFORM DP013-0000-PROCESS-ABEND                     61400049
614100     END-EVALUATE.                                                61410049
614200                                                                  61420049
614300/                                                                 61430049
614400*----------------------------------------------------------------*61440049
614500* CHECK TO SEE IF DC IS DOWNLOADING ASN TO WMS                   *61450049
614510* IF NOT DOWNLOADING, THEN F24 IS NOT VALID FOR THIS SHIPMENT    *61451052
614600*----------------------------------------------------------------*61460049
614700 9030-CHECK-ASN-TO-WMS-STATUS.                                    61470049
614800     SET PS-DWNLD-ASN-TO-WMS-NO       TO TRUE.                    61480049
614900                                                                  61490049
615000     EXEC SQL                                                     61500049
615100          SELECT  FUNC_TXT                                        61510049
615200          INTO    :KRPRPM-FUNC-TXT                                61520049
615300          FROM    TKRPRPM                                         61530049
615400          WHERE  LOC_ID               =  :DK-DEST-STR-NBR         61540053
615500          AND    SYS_PRC_FUNC_CDE     =  'SASNDN'                 61550053
615600          AND    FUNC_PRC_STAT_CDE    =  'AC'                     61560053
615700          AND    INTFC_SYS_CDE        =  'KHL'                    61570053
615800          AND    FUNC_BEG_TMST        <  CURRENT TIMESTAMP        61580053
615900     END-EXEC.                                                    61590049
616000     EVALUATE TRUE                                                61600049
616100         WHEN SQLCODE = ZERO                                      61610049
616200             IF KRPRPM-FUNC-TXT = 'Y'                             61620049
616300                 SET PS-DWNLD-ASN-TO-WMS-YES TO TRUE              61630049
616400             END-IF                                               61640049
616500         WHEN SQLCODE = +100                                      61650049
616600         WHEN SQLCODE = -904                                      61660049
616700         WHEN SQLCODE = -913                                      61670049
616800             CONTINUE                                             61680049
616900         WHEN SQLWARN0 NOT = SPACES                               61690049
617000         WHEN SQLCODE < ZERO                                      61700049
617100         WHEN SQLCODE > ZERO                                      61710049
617200             MOVE '9030-CHECK-ASN-TO-WMS-STATUS'                  61720049
617300                                TO DP013-PARAGRAPH                61730049
617400             MOVE 'SELECT FUNC TXT'                               61740049
617500                                TO DP013-MESSAGE-TEXT (1)         61750049
617600             MOVE SQLCA        TO DP013-SQLCA                     61760049
617700             MOVE 'TKPRPRM'    TO DP013-DB2-TABLE-NAME (1)        61770049
617800             SET DP013-DB2-ABEND                                  61780049
617900                 DP013-XCTL-DISPLAY-RESTART                       61790049
618000                                   TO TRUE                        61800049
618100             PERFORM DP013-0000-PROCESS-ABEND                     61810049
618200     END-EVALUATE.                                                61820049
618300*                                                                 61830049
618400                                                                  61840049
618500*----------------------------------------------------------------*61850049
618600* CALL THE ASN SHIPMENT CONTROL MODULE - WSKCS306                *61860052
618700*----------------------------------------------------------------*61870049
618800 9040-CALL-ASN-SHIP-CNTL-MOD.                                     61880049
618900     INITIALIZE WS004-FIELDS.                                     61890049
619000     SET WS004-MANUAL-DOWNLOAD     TO TRUE.                       61900049
619100     MOVE LQW-TRIP-ID (LQW-IDX)                                   61910049
619200                                   TO WS004-OTBND-TRIP-ID.        61920049
619300     MOVE LQW-DEST-NBR (LQW-IDX)                                  61930049
619400                                   TO WS004-OPER-UNT-ID.          61940049
619500     SET WS004-SOURCE-SHIP         TO TRUE.                       61950049
619600     MOVE DP020-USERID             TO WS004-USER-ID.              61960049
619700     MOVE 'SUKCS559'               TO WS004-CALLING-PROGRAM-NAME. 61970049
619800     MOVE DP020-SRC-TASK-NUMBER    TO WS004-SRC-TASK-NUMBER.      61980049
619900                                                                  61990049
620000     MOVE LENGTH OF WS004-FIELDS  TO  PV-COMMAREA-LENGTH.         62000049
620100     EXEC CICS                                                    62010049
620200         LINK PROGRAM  (PC-SHIP-CNTL-MOD)                         62020049
620300              COMMAREA (WS004-FIELDS)                             62030049
620400              LENGTH   (PV-COMMAREA-LENGTH)                       62040049
620500     END-EXEC.                                                    62050049
620600                                                                  62060049
620700     EVALUATE TRUE                                                62070049
620800         WHEN WS004-SUCCESSFUL                                    62080049
620900              SET LQW-UPD (LQW-IDX) TO TRUE                       62090049
621000              SET LQW-DESELECT (LQW-IDX) TO TRUE                  62100049
621100              SET PS-WS-DOWNLOAD-UPDATE  TO  TRUE                 62110049
621200              SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS        62120049
621300              MOVE LQW-SELECTED-SW (LQW-IDX)                      62130049
621400                               TO LQW-TEMP-SELECTED-SW (LQW-IDX)  62140049
621500         WHEN WS004-DATABASE-BUSY                                 62150049
621600         WHEN WS004-INVALID-SQL                                   62160049
621700              MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER           62170049
621800              SET LQW-ERR (LQW-IDX) TO TRUE                       62180049
621900              SET DP030-OVERRIDE-GO TO TRUE                       62190049
622000              SET PS-ERROR          TO TRUE                       62200049
622100              SET DP020-MSG-FATAL   TO TRUE                       62210049
622200              MOVE '9040-CALL-ASN-SHIP-CNTL-MOD'                  62220049
622300                                   TO DP013-PARAGRAPH             62230049
622400              STRING 'BAD RETURN FROM '                           62240049
622500                   PC-SHIP-CNTL-MOD                               62250049
622600                   DELIMITED BY SIZE                              62260049
622700                                 INTO DP013-MESSAGE-TEXT(1)       62270049
622800              MOVE ' '             TO DP013-MESSAGE-TEXT(2)       62280049
622900         WHEN OTHER                                               62290049
623000              SET DP013-LOGIC-ABEND TO TRUE                       62300049
623100              SET DP013-NO-ROLLBACK TO TRUE                       62310049
623200              SET PS-ERROR          TO TRUE                       62320049
623300              MOVE PC-TSYMSG-03548 TO DP020-MSG-NUMBER            62330049
623400              SET DP020-MSG-FATAL   TO TRUE                       62340049
623500              MOVE '9040-CALL-ASN-SHIP-CNTL-MOD'                  62350049
623600                                   TO DP013-PARAGRAPH             62360049
623700              STRING 'BAD RETURN FROM '                           62370049
623800                   PC-SHIP-CNTL-MOD                               62380049
623900                   DELIMITED BY SIZE                              62390049
624000                                 INTO DP013-MESSAGE-TEXT(1)       62400049
624100              MOVE ' '             TO DP013-MESSAGE-TEXT(2)       62410049
624200     END-EVALUATE.                                                62420049
624300                                                                  62430049
624400* JAK 04/2007 - END LOGIC FOR F24                                 62440053
624401                                                                  62440149
624457*----------------------------------------------------------------*62445753
624458*    ABEND PROCESSOR MODULE                                      *62445853
624459*----------------------------------------------------------------*62445953
624460                                                                  62446053
624470     COPY DPPD013.                                                62447053
