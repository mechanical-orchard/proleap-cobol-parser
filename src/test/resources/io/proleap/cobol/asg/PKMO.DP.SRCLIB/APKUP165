000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    APKUP165.                                         00020001
000300 AUTHOR.        ANIL BEDEKAR                                      00030001
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040001
000500 DATE-WRITTEN.  JULY 2011.                                        00050001
000600                                                                  00060001
000700***************************************************************** 00070001
000800*  RELOAD THE FINANCIAL DOMAIN LOCATION TABLES.                 * 00080001
000900*                                                               * 00090001
001000*  THIS IS A DAILY PROGRAM THAT RELOADS THE XFT_LOC AND         * 00100001
001100*  XFT_LOC_ATTR TABLES FROM A FLAT FILE. THE FLAT FILE IS       * 00110001
001200*  AN EXTRACT OF THE ORACLE WAREHOUSE TABLE, "WH", PROVIDED BY  * 00120001
001300*  RETEK (RMS).                                                 * 00130001
001400*                                                               * 00140001
001500*  PROGRAM COPIED FROM XFKUP002, THEN COPIED FROM XFKUP133.     * 00150001
001500*  IF THIS PROGRAM CHANGES, THE ORIGINAL PROGRAM MAY ALSO NEED  * 00151001
001600*  TO CHANGE.                                                   * 00160001
001700***************************************************************** 00170001
001800*  CHANGE LOG:                                                  * 00180001
001900*                                                               * 00190001
002000*  DATE  07/26/2011                                             * 00200001
002100*      CHANGE MADE: INITIAL PROGRAM                             * 00210001
002200*      MADE BY: ANIL BEDEKAR            WR/IR  #: WR37038       * 00220001
002300*                                                               * 00230001
002400***************************************************************** 00240001
002500 ENVIRONMENT DIVISION.                                            00250001
002600                                                                  00260001
002700 CONFIGURATION SECTION.                                           00270001
002800 SOURCE-COMPUTER.       IBM-3090.                                 00280001
002900 OBJECT-COMPUTER.       IBM-3090.                                 00290001
003000                                                                  00300001
003100 INPUT-OUTPUT SECTION.                                            00310001
003200                                                                  00320001
003300 FILE-CONTROL.                                                    00330001
003400     SELECT WAREHSE-FILE              ASSIGN TO INP01.            00340001
003500                                                                  00350001
003600 DATA DIVISION.                                                   00360001
003700                                                                  00370001
003800 FILE SECTION.                                                    00380001
003900                                                                  00390001
004000 FD  WAREHSE-FILE                                                 00400001
004100     RECORDING MODE IS F                                          00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     LABEL RECORDS ARE STANDARD.                                  00430001
004400                                                                  00440001
004500 01  WAREHSE-RECORD                   PIC X(173).                 00450001
004600                                                                  00460001
004700 WORKING-STORAGE SECTION.                                         00470001
004800                                                                  00480001
004900 01  PC-PROGRAM-CONSTANTS.                                        00490001
005000     05  PC-PGM-NAME           PIC X(08)  VALUE 'APKUP165'.       00500001
005100     05  PC-DEFAULT-DATE       PIC X(10)  VALUE '9999-09-09'.     00510001
005200                                                                  00520001
005300 01  PS-PROGRAM-SWITCHES.                                         00530001
005400     05  PS-END-OF-WAREHSE-FILE-SW    PIC X(01)   VALUE 'N'.      00540001
005500         88  NOT-END-OF-WAREHSE-FILE              VALUE 'N'.      00550001
005600         88  END-OF-WAREHSE-FILE                  VALUE 'Y'.      00560001
005700                                                                  00570001
005800 01  WS-WORKING-STORAGE.                                          00580001
005900     05  WS-CURRENT-DATE              PIC  X(10)  VALUE SPACES.   00590001
006000     05  WS-CURRENT-TIME              PIC  X(08)  VALUE SPACES.   00600001
006100     05  WS-LOC-CHAR                  PIC  X(10).                 00610001
006200                                                                  00620001
006300 01  WS-PROGRAM-COUNTERS.                                         00630001
006400     05  WS-IN-WAREHSE-COUNT          PIC  9(05)  VALUE ZEROS.    00640001
006500     05  WS-INSERT-XFT-LOC            PIC  9(05)  VALUE ZEROS.    00650001
006600     05  WS-INSERT-LOC-ATTR           PIC  9(05)  VALUE ZEROS.    00660001
006700     05  WS-SKIPPED-LOCATION          PIC  9(05)  VALUE ZEROS.    00670001
006800                                                                  00680001
006900*---------------------------------------------------------------* 00690001
007000* RECORD LAYOUT FOR INPUT LOCATION FILE                         * 00700001
007100*---------------------------------------------------------------* 00710001
007200     COPY HORD007.                                                00720001
007300                                                                  00730001
007400*---------------------------------------------------------------* 00740001
007500*    STANDARD DB2 ERROR HANDLING AREA                           * 00750001
007600*---------------------------------------------------------------* 00760001
007700     COPY DPWS004.                                                00770001
007800                                                                  00780001
007900*---------------------------------------------------------------* 00790001
008000*    DCLGEN FOR THE STORE LOCATION TABLE, XFT_LOC            *    00800001
008100*---------------------------------------------------------------* 00810001
008200     EXEC SQL                                                     00820001
008300         INCLUDE XFT00017                                         00830001
008400     END-EXEC.                                                    00840001
008500                                                                  00850001
008600*---------------------------------------------------------------* 00860001
008700*    DCLGEN FOR THE LOCATION ATTRIBUTE TABLE, XFT_LOC_ATTR   *    00870001
008800*---------------------------------------------------------------* 00880001
008900     EXEC SQL                                                     00890001
009000         INCLUDE XFT00019                                         00900001
009100     END-EXEC.                                                    00910001
009200                                                                  00920001
009300*----------------------------------------------------------------*00930001
009400*    STANDARD DB2 COMMUNICATIONS AREA                            *00940001
009500*----------------------------------------------------------------*00950001
009600     EXEC SQL                                                     00960001
009700         INCLUDE SQLCA                                            00970001
009800     END-EXEC.                                                    00980001
009900                                                                  00990001
010000****************************************************************  01000001
010100* WORKING STORAGE FOR ABEND PROCESSING                            01010001
010200****************************************************************  01020001
010300                                                                  01030001
010400 01  ABEND-CODE                PIC S9(04)  VALUE ZEROS COMP SYNC. 01040001
010500     88  AC-DB2-ERROR                        VALUE +4013.         01050001
010600                                                                  01060001
010700 01  ABEND-AREAS.                                                 01070001
010800     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  01080001
010900             '*****       ABEND'.                                 01090001
011000     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  01100001
011100             '*****   PROGRAM: APKUP165'.                         01110001
011200     05  AA-PARAGRAPH-LIT.                                        01120001
011300         10  FILLER            PIC  X(17)  VALUE                  01130001
011400             '***** PARAGRAPH: '.                                 01140001
011500         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          01150001
011600     05  AA-MESSAGE-LINE.                                         01160001
011700         10  FILLER            PIC  X(06)  VALUE '*****'.         01170001
011800         10  AA-MESSAGE        PIC  X(127) VALUE SPACES.          01180001
011900         10  FILLER REDEFINES AA-MESSAGE.                         01190001
012000             15 AA-MESSAGE-1   PIC  X(45).                        01200001
012100             15 AA-MESSAGE-2   PIC  X(45).                        01210001
012200             15 AA-MESSAGE-3   PIC  X(37).                        01220001
012300     05  AA-DB2-ERROR-LIT      PIC  X(40)  VALUE                  01230001
012400             '*****    DB2 ERROR'.                                01240001
012500     05  AA-DB2-OPERATION-LIT.                                    01250001
012600         10  FILLER            PIC  X(17)  VALUE                  01260001
012700             '***** OPERATION: '.                                 01270001
012800         10  AA-DB2-OPERATION.                                    01280001
012900             15  AA-DB2-OP-1   PIC  X(25)  VALUE SPACES.          01290001
013000             15  AA-DB2-OP-2   PIC  X(25)  VALUE SPACES.          01300001
013100     05  AA-DB2-TABLE-LIT.                                        01310001
013200         10  FILLER            PIC  X(14)  VALUE                  01320001
013300             '***** TABLES: '.                                    01330001
013400         10  AA-DB2-TABLE-1    PIC  X(18)  VALUE SPACES.          01340001
013500         10  AA-DB2-TABLE-2    PIC  X(18)  VALUE SPACES.          01350001
013600         10  AA-DB2-TABLE-3    PIC  X(18)  VALUE SPACES.          01360001
013700                                                                  01370001
013800 PROCEDURE DIVISION.                                              01380001
013900                                                                  01390001
014000 A100-MAINLINE-ROUTINE.                                           01400001
014100                                                                  01410001
014200     PERFORM B100-INITIALIZATION.                                 01420001
014300                                                                  01430001
014400     PERFORM B200-PROCESS-LOCATIONS                               01440001
014500       UNTIL END-OF-WAREHSE-FILE.                                 01450001
014600                                                                  01460001
014700     PERFORM Z900-END-OF-JOB.                                     01470001
014800                                                                  01480001
014900     GOBACK.                                                      01490001
015000                                                                  01500001
015100*************************************************************     01510001
015200** INITIALIZATION ROUTINE                                         01520001
015300*************************************************************     01530001
015400 B100-INITIALIZATION.                                             01540001
015500                                                                  01550001
015600     DISPLAY '***** BEGIN PROGRAM: ' PC-PGM-NAME ' *****'.        01560001
015700     EXEC SQL                                                     01570001
015800          SELECT CURRENT DATE                                     01580001
015900                ,CURRENT TIME                                     01590001
016000            INTO :WS-CURRENT-DATE                                 01600001
016100                ,:WS-CURRENT-TIME                                 01610001
016200            FROM SYSIBM.SYSDUMMY1                                 01620001
016300     END-EXEC.                                                    01630001
016400                                                                  01640001
016500     EVALUATE TRUE                                                01650001
016600       WHEN SQLCODE NOT = ZERO                                    01660001
016700         MOVE 'B100-INITIALIZATION  '    TO AA-PARAGRAPH-NAME     01670001
016800         MOVE 'SELECT'                   TO AA-DB2-OPERATION      01680001
016900         MOVE 'SYSDUMMY1  '              TO AA-DB2-TABLE-1        01690001
017000         PERFORM Z999-DB2-ABEND                                   01700001
017100     END-EVALUATE.                                                01710001
017200                                                                  01720001
017300     DISPLAY 'DATE: ' WS-CURRENT-DATE '    '                      01730001
017400             'TIME: ' WS-CURRENT-TIME.                            01740001
017500     DISPLAY ' '.                                                 01750001
017600                                                                  01760001
017700     OPEN INPUT  WAREHSE-FILE.                                    01770001
017800                                                                  01780001
017900     PERFORM R100-READ-WAREHSE-FILE.                              01790001
018000                                                                  01800001
018100*************************************************************     01810001
018200** THIS ROUTINE PROCESS EACH LOCATION WITH TYPE CODES             01820001
018300** 'CS', 'DC', 'RV', AND 'NA'                                     01830001
018400*************************************************************     01840001
018500 B200-PROCESS-LOCATIONS.                                          01850001
018600                                                                  01860001
018700     IF (HO007-WH-TYP-CDE = 'DC' OR 'CS' OR 'RV' OR 'NA')         01870001
018800        AND (HO007-WH-NBR NOT = 87)                               01880001
018900        PERFORM C100-DOMAIN-LOCATIONS                             01890001
019000     ELSE                                                         01900001
019100        DISPLAY '********** SKIPPED LOC = ' HO007-LOC-NBR         01910001
019200        DISPLAY '***** HO007-WH-TYP-CDE = ' HO007-WH-TYP-CDE      01920001
019300        ADD 1 TO WS-SKIPPED-LOCATION                              01930001
019400     END-IF.                                                      01940001
019500                                                                  01950001
019600     PERFORM R100-READ-WAREHSE-FILE.                              01960001
019700                                                                  01970001
019800*************************************************************     01980001
019900** THIS ROUTINE POPULATES THE FIELDS FOR THE LOCATION             01990001
020000** DOMAIN TABLES.                                                 02000001
020100** SINCE WAREHOUSE TYPE LOCATIONS DO NOT HAVE A GRAND OPEN        02010001
020200** DATE, THE OPEN DATE IS BEING LOADED IN THAT COLUMN.            02020001
020300*************************************************************     02030001
020400 C100-DOMAIN-LOCATIONS.                                           02040001
020500                                                                  02050001
020600     INITIALIZE DCLXFT00017.                                      02060001
020700     INITIALIZE DCLXFT00019.                                      02070001
020800                                                                  02080001
020900     MOVE HO007-WH-NBR               TO XFT00017-LOC-NBR          02090001
021000                                        XFT00019-LOC-NBR          02100001
021100                                        WS-LOC-CHAR.              02110001
021200     MOVE 0                          TO XFT00017-REPLT-STR-NBR.   02120001
021300     MOVE HO007-WH-TYP-CDE           TO XFT00017-LOC-TYP-CDE.     02130001
021400     MOVE HO007-WH-NM                TO XFT00017-LOC-NM.          02140001
021500     MOVE HO007-WH-5-ABBR-NM         TO XFT00017-LOC-5-ABBR-NM.   02150001
021600     MOVE HO007-WH-LNE-1-ADDR        TO XFT00017-LNE-1-ADDR.      02160001
021700     MOVE HO007-WH-LNE-2-ADDR        TO XFT00017-LNE-2-ADDR.      02170001
021800     MOVE HO007-WH-CITY              TO XFT00017-CTY-NM.          02180001
021900     MOVE HO007-WH-ST-CDE            TO XFT00017-ST-CDE.          02190001
022000     MOVE HO007-WH-10-ABBR-NM        TO XFT00017-LOC-10-ABBR-NM.  02200001
022100     MOVE HO007-WH-E-BUS-IND         TO XFT00017-E-BUS-IND.       02210001
022200                                                                  02220001
022300     MOVE 'SHARE'                    TO XFT00019-SETID.           02230001
022400     MOVE SPACES                     TO XFT00019-DEPTID.          02240001
022500     MOVE WS-LOC-CHAR                TO XFT00019-LOCATION.        02250001
022600                                                                  02260001
022700     IF HO007-WH-DC-NBR NUMERIC                                   02270001
022800        MOVE HO007-WH-DC-NBR         TO XFT00017-DIST-NBR         02280001
022900     ELSE                                                         02290001
023000        MOVE 0                       TO XFT00017-DIST-NBR         02300001
023100     END-IF.                                                      02310001
023200                                                                  02320001
023300*    FORMAT ZIP CODE                                              02330001
023400     IF HO007-WH-ZIP-10-CDE(1:5) NUMERIC                          02340001
023500        MOVE HO007-WH-ZIP-10-CDE(1:5)                             02350001
023600                                  TO XFT00017-ZIP-10-CDE(1:5)     02360001
023700        IF HO007-WH-ZIP-10-CDE(6:4) NUMERIC                       02370001
023800           IF HO007-WH-ZIP-10-CDE(6:4) = '0000'                   02380001
023900              MOVE SPACES         TO XFT00017-ZIP-10-CDE(6:5)     02390001
024000           ELSE                                                   02400001
024100              MOVE '-'            TO XFT00017-ZIP-10-CDE(6:1)     02410001
024200              MOVE HO007-WH-ZIP-10-CDE(6:4)                       02420001
024300                                  TO XFT00017-ZIP-10-CDE(7:4)     02430001
024400           END-IF                                                 02440001
024500        ELSE                                                      02450001
024600           IF HO007-WH-ZIP-10-CDE(6:4) = '000 '                   02460001
024700              MOVE SPACES         TO XFT00017-ZIP-10-CDE(6:5)     02470001
024800           ELSE                                                   02480001
024900              MOVE HO007-WH-ZIP-10-CDE                            02490001
025000                                  TO XFT00017-ZIP-10-CDE          02500001
025100           END-IF                                                 02510001
025200        END-IF                                                    02520001
025300     ELSE                                                         02530001
025400        MOVE HO007-WH-ZIP-10-CDE TO XFT00017-ZIP-10-CDE           02540001
025500     END-IF.                                                      02550001
025600                                                                  02560001
025700     IF HO007-WH-OPEN-DATE = SPACES                               02570001
025800        MOVE WS-CURRENT-DATE         TO XFT00017-OPN-DTE          02580001
025900                                        XFT00017-GRND-OPN-DTE     02590001
026000        DISPLAY '*********** LOC-NBR = ' HO007-WH-NBR             02600001
026100        DISPLAY '***** HO007-WH-OPEN-DATE = SPACES'               02610001
026200        DISPLAY '***** DEFAULTING OPEN DATE TO '                  02620001
026300                WS-CURRENT-DATE                                   02630001
026400     ELSE                                                         02640001
026500        MOVE HO007-WH-OPEN-DATE      TO XFT00017-OPN-DTE          02650001
026600                                        XFT00017-GRND-OPN-DTE     02660001
026700     END-IF.                                                      02670001
026800                                                                  02680001
026900     IF HO007-WH-CLOSE-DATE = SPACES                              02690001
027000        MOVE PC-DEFAULT-DATE         TO XFT00017-CLO-DTE          02700001
027100     ELSE                                                         02710001
027200        MOVE HO007-WH-CLOSE-DATE     TO XFT00017-CLO-DTE          02720001
027300     END-IF.                                                      02730001
027400                                                                  02740001
027500     IF HO007-LOC-FINCL-CLO-DTE = SPACES                          02750001
027600        MOVE PC-DEFAULT-DATE         TO XFT00017-FINCL-CLO-DTE    02760001
027700     ELSE                                                         02770001
027800        MOVE HO007-LOC-CLOSE-DATE    TO XFT00017-FINCL-CLO-DTE    02780001
027900     END-IF.                                                      02790001
028000                                                                  02800001
028100     MOVE PC-DEFAULT-DATE            TO XFT00017-SEA-SLS-INCL-DTE.02810001
028200     MOVE 0                        TO XFT00017-TOT-SLG-SQ-FTG-QTY.02820001
028300     MOVE 0                        TO XFT00017-TOT-SQ-FTG-QTY.    02830001
028400                                                                  02840001
028500     EVALUATE HO007-WH-TYP-CDE                                    02850001
028600       WHEN 'DC'                                                  02860001
028700       WHEN 'NA'                                                  02870001
028800            MOVE '6'   TO XFT00019-KC-ACCT-TYP-CDE                02880001
028900       WHEN 'CS'                                                  02890001
029000       WHEN 'RV'                                                  02900001
029100            MOVE 0     TO XFT00019-KC-ACCT-TYP-CDE                02910001
029200     END-EVALUATE.                                                02920001
029300                                                                  02930001
029400     PERFORM I100-INSERT-XFT-LOC.                                 02940001
029500     PERFORM I200-INSERT-XFT-LOC-ATTR.                            02950001
029600                                                                  02960001
029700**************************************************************    02970001
029800** THIS ROUTINE INSERTS A ROW INTO THE XFT_LOC TABLE              02980001
029900** FOR LOCATION TYPES 'CS', 'DC', AND 'RV'                        02990001
030000**************************************************************    03000001
030100 I100-INSERT-XFT-LOC.                                             03010001
030200                                                                  03020001
030300      EXEC SQL                                                    03030001
030400         INSERT INTO XFT_LOC                                      03040001
030500             (LOC_NBR                                             03050001
030600             ,REPLT_STR_NBR                                       03060001
030700             ,DIST_NBR                                            03070001
030800             ,LOC_TYP_CDE                                         03080001
030900             ,LOC_NM                                              03090001
031000             ,LOC_5_ABBR_NM                                       03100001
031100             ,LNE_1_ADDR                                          03110001
031200             ,LNE_2_ADDR                                          03120001
031300             ,CTY_NM                                              03130001
031400             ,ST_CDE                                              03140001
031500             ,ZIP_10_CDE                                          03150001
031600             ,OPN_DTE                                             03160001
031700             ,CLO_DTE                                             03170001
031800             ,LOC_10_ABBR_NM                                      03180001
031900             ,FINCL_CLO_DTE                                       03190001
032000             ,E_BUS_IND                                           03200001
032100             ,GRND_OPN_DTE                                        03210001
032200             ,SEA_SLS_INCL_DTE                                    03220001
032300             ,TOT_SLG_SQ_FTG_QTY                                  03230001
032400             ,TOT_SQ_FTG_QTY                                      03240001
032500             )                                                    03250001
032600         VALUES                                                   03260001
032700            (:XFT00017-LOC-NBR                                    03270001
032800            ,:XFT00017-REPLT-STR-NBR                              03280001
032900            ,:XFT00017-DIST-NBR                                   03290001
033000            ,:XFT00017-LOC-TYP-CDE                                03300001
033100            ,:XFT00017-LOC-NM                                     03310001
033200            ,:XFT00017-LOC-5-ABBR-NM                              03320001
033300            ,:XFT00017-LNE-1-ADDR                                 03330001
033400            ,:XFT00017-LNE-2-ADDR                                 03340001
033500            ,:XFT00017-CTY-NM                                     03350001
033600            ,:XFT00017-ST-CDE                                     03360001
033700            ,:XFT00017-ZIP-10-CDE                                 03370001
033800            ,:XFT00017-OPN-DTE                                    03380001
033900            ,:XFT00017-CLO-DTE                                    03390001
034000            ,:XFT00017-LOC-10-ABBR-NM                             03400001
034100            ,:XFT00017-FINCL-CLO-DTE                              03410001
034200            ,:XFT00017-E-BUS-IND                                  03420001
034300            ,:XFT00017-GRND-OPN-DTE                               03430001
034400            ,:XFT00017-SEA-SLS-INCL-DTE                           03440001
034500            ,:XFT00017-TOT-SLG-SQ-FTG-QTY                         03450001
034600            ,:XFT00017-TOT-SQ-FTG-QTY                             03460001
034700            )                                                     03470001
034800      END-EXEC.                                                   03480001
034900                                                                  03490001
035000     EVALUATE TRUE                                                03500001
035100       WHEN SQLCODE = ZERO                                        03510001
035200         ADD 1 TO WS-INSERT-XFT-LOC                               03520001
035300       WHEN SQLCODE NOT = ZERO                                    03530001
035400         DISPLAY 'LOCATION NUMBER: '      XFT00017-LOC-NBR        03540001
035500         MOVE 'I100-INSERT-XFT-LOC '      TO AA-PARAGRAPH-NAME    03550001
035600         MOVE 'INSERT'                    TO AA-DB2-OPERATION     03560001
035700         MOVE 'XFT_LOC '                  TO AA-DB2-TABLE-1       03570001
035800         PERFORM Z999-DB2-ABEND                                   03580001
035900     END-EVALUATE.                                                03590001
036000                                                                  03600001
036100**************************************************************    03610001
036200** THIS ROUTINE INSERTS A ROW INTO THE XFT_LOC_ATTR TABLE         03620001
036300** FOR EACH LOCATION TYPE 'HQ'                                    03630001
036400**************************************************************    03640001
036500 I200-INSERT-XFT-LOC-ATTR.                                        03650001
036600                                                                  03660001
036700      EXEC SQL                                                    03670001
036800         INSERT INTO XFT_LOC_ATTR                                 03680001
036900               (LOC_NBR                                           03690001
037000               ,SETID                                             03700001
037100               ,DEPTID                                            03710001
037200               ,LOCATION                                          03720001
037300               ,KC_ACCT_TYP_CDE                                   03730001
037400               )                                                  03740001
037500         VALUES                                                   03750001
037600               (:XFT00019-LOC-NBR                                 03760001
037700               ,:XFT00019-SETID                                   03770001
037800               ,:XFT00019-DEPTID                                  03780001
037900               ,:XFT00019-LOCATION                                03790001
038000               ,:XFT00019-KC-ACCT-TYP-CDE                         03800001
038100               )                                                  03810001
038200      END-EXEC.                                                   03820001
038300                                                                  03830001
038400     EVALUATE TRUE                                                03840001
038500       WHEN SQLCODE = ZERO                                        03850001
038600         ADD 1 TO WS-INSERT-LOC-ATTR                              03860001
038700       WHEN SQLCODE NOT = ZERO                                    03870001
038800         DISPLAY 'LOCATION NUMBER: '      XFT00019-LOC-NBR        03880001
038900         MOVE 'I200-INSERT-XFT-LOC-ATTR'  TO AA-PARAGRAPH-NAME    03890001
039000         MOVE 'INSERT'                    TO AA-DB2-OPERATION     03900001
039100         MOVE 'XFT_LOC_ATTR'              TO AA-DB2-TABLE-1       03910001
039200         PERFORM Z999-DB2-ABEND                                   03920001
039300     END-EVALUATE.                                                03930001
039400                                                                  03940001
039500**************************************************************    03950001
039600** THIS ROUTINE READS THE WAREHSE FILE                            03960001
039700**************************************************************    03970001
039800 R100-READ-WAREHSE-FILE.                                          03980001
039900                                                                  03990001
040000     READ WAREHSE-FILE INTO HORD007-RECORD                        04000001
040100        AT END                                                    04010001
040200           SET END-OF-WAREHSE-FILE TO TRUE                        04020001
040300        NOT AT END                                                04030001
040400           ADD 1 TO WS-IN-WAREHSE-COUNT                           04040001
040500     END-READ.                                                    04050001
040600                                                                  04060001
040700*************************************************************     04070001
040800** END OF PROGRAM PROCESSING                                      04080001
040900*************************************************************     04090001
041000 Z900-END-OF-JOB.                                                 04100001
041100                                                                  04110001
041200     CLOSE WAREHSE-FILE.                                          04120001
041300                                                                  04130001
041400     DISPLAY ' '.                                                 04140001
041500     DISPLAY '******** PROGRAM COUNTERS: ********'.               04150001
041600     DISPLAY 'IN WAREHSE  REC:  ' WS-IN-WAREHSE-COUNT             04160001
041700     DISPLAY ' '.                                                 04170001
041800     DISPLAY 'INSERTS XFT LOC :  ' WS-INSERT-XFT-LOC              04180001
041900     DISPLAY 'INSERTS LOC ATTR:  ' WS-INSERT-LOC-ATTR             04190001
042000     DISPLAY ' '.                                                 04200001
042100     DISPLAY 'SKIPPED LOCATIONS: ' WS-SKIPPED-LOCATION            04210001
042200     DISPLAY '****** END PROGRAM ' PC-PGM-NAME ' *******'.        04220001
042300                                                                  04230001
042400*************************************************************     04240001
042500*     DB2 ABEND ROUTINE                                           04250001
042600*************************************************************     04260001
042700 Z999-DB2-ABEND.                                                  04270001
042800                                                                  04280001
042900     DISPLAY AA-ABEND-LIT.                                        04290001
043000     DISPLAY AA-DB2-ERROR-LIT.                                    04300001
043100     DISPLAY AA-PROGRAM-LIT.                                      04310001
043200     DISPLAY AA-PARAGRAPH-LIT.                                    04320001
043300     DISPLAY AA-DB2-OPERATION-LIT.                                04330001
043400     DISPLAY AA-DB2-TABLE-LIT.                                    04340001
043500     SET AC-DB2-ERROR TO TRUE.                                    04350001
043600                                                                  04360001
043700     COPY DPPD004.                                                04370001
043800                                                                  04380001
043900     CALL 'ILBOABN0' USING ABEND-CODE.                            04390001
044000                                                                  04400001
