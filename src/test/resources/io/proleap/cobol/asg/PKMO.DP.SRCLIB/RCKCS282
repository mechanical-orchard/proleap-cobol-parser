000100 IDENTIFICATION DIVISION.                                         00010033
000200 PROGRAM-ID.    RCKCS282.                                         00020033
000300 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00030033
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040033
000500 DATE-WRITTEN.  MARCH 1996.                                       00050033
000600 DATE-COMPILED.                                                   00060033
000610*---------------------------------------------------------------* 00061048
000620* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00062049
000630* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00063049
000640* MAKING THE CALL DYNAMIC VS STATIC.                              00064049
000650*---------------------------------------------------------------* 00065049
000700 ENVIRONMENT DIVISION.                                            00070033
000800 DATA DIVISION.                                                   00080033
000900 WORKING-STORAGE SECTION.                                         00090033
001000                                                                  00100033
001100 01  PC-PROGRAM-CONSTANTS.                                        00110033
001200     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC282A  '. 00120033
001300     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM282 '. 00130033
001400     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS282'. 00140033
001500     05  PC-LOCATION-MODULE           PIC X(8)  VALUE 'XLKUT071'. 00150049
001600     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00160033
001700     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00170033
001800     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +12         00180033
001900                                                COMP SYNC.        00190033
002000     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00200033
002100                                                COMP SYNC.        00210033
002200     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00220033
002300                                                COMP SYNC.        00230033
002400     05  PC-AC                        PIC X(02) VALUE 'AC'.       00240033
002500     05  PC-CM                        PIC X(02) VALUE 'CM'.       00250033
002600     05  PC-IP                        PIC X(02) VALUE 'IP'.       00260033
002700     05  PC-CB                        PIC X(02) VALUE 'CB'.       00270033
002800     05  PC-CA                        PIC X(02) VALUE 'CA'.       00280033
002900     05  PC-I                         PIC X(01) VALUE 'I'.        00290033
003000     05  PC-A                         PIC X(01) VALUE 'A'.        00300033
003100     05  PC-N                         PIC X(01) VALUE 'N'.        00310033
003200     05  PC-DASH                      PIC X(01) VALUE '-'.        00320033
003300     05  PC-INQ                       PIC X(03) VALUE 'INQ'.      00330033
003400                                                                  00340033
003500     05  PC-TSYMSG-NUMBERS.                                       00350033
003600         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00360033
003700*            INVALID VALUE                                        00370033
003800         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00380033
003900*            MUST BE NUMERIC                                      00390033
004000         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00400033
004100*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00410033
004200         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00420033
004300*            NO END OF RANGE HAS BEEN SPECIFIED                   00430033
004400         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00440033
004500*            END OF RANGE PRECEDES START OF RANGE                 00450033
004600         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00460033
004700*            NO START OF RANGE HAS BEEN SPECIFIED                 00470033
004800         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00480033
004900*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00490033
005000         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00500033
005100*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00510033
005200         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00520033
005300*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00530033
005400         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00540033
005500*            UPDATE(S) SUCCESSFUL                                 00550033
005600         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00560033
005700*            TOP OF LIST                                          00570033
005800         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00580033
005900*            BOTTOM OF LIST                                       00590033
006000         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00600033
006100*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00610033
006200         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      00620033
006300*            MORE ITEMS TO DISPLAY                                00630033
006400         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      00640033
006500*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 00650033
006600*            CALL HELP DESK                                       00660033
006700         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      00670033
006800*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         00680033
006900         10  PC-TSYMSG-00866          PIC 9(5)  VALUE 00866.      00690033
007000*            RCVR LNE QTY AND DISTR LNE QTY MUST MATCH            00700033
007100                                                                  00710033
007200*----------------------------------------------------------------*00720033
007300* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *00730039
007400*----------------------------------------------------------------*00740033
007500     05  PC-000                       PIC X(03) VALUE '000'.      00750033
007600     05  PC-999                       PIC X(03) VALUE '999'.      00760033
007700*----------------------------------------------------------------*00770033
007800* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *00780039
007900*----------------------------------------------------------------*00790033
008000                                                                  00800033
008100 01  PS-PROGRAM-SWITCHES.                                         00810033
008200     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        00820033
008300         88  PS-NO-ERROR                        VALUE 'N'.        00830033
008400         88  PS-ERROR                           VALUE 'Y'.        00840033
008500     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        00850033
008600         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        00860033
008700         88  PS-NEXT-SCREEN                     VALUE 'Y'.        00870033
008800     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        00880033
008900         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        00890033
009000         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        00900033
009100     05  PS-DATA-OK-SW              PIC  X(01)  VALUE 'N'.        00910033
009200         88  PS-DATA-OK                         VALUE 'Y'.        00920033
009300         88  PS-DATA-NOT-OK                     VALUE 'N'.        00930033
009400*----------------------------------------------------------------*00940033
009500*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *00950039
009600*----------------------------------------------------------------*00960033
009700     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        00970033
009800         88  PS-CALL-API-NO                     VALUE 'N'.        00980033
009900         88  PS-CALL-API-YES                    VALUE 'Y'.        00990033
010000*----------------------------------------------------------------*01000033
010100* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01010039
010200*----------------------------------------------------------------*01020033
010300                                                                  01030033
010400 01  DK-DB2-KEYS.                                                 01040033
010500     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01050033
010600     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    01060033
010700     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01070033
010800     05  DK-CYC-NBR                   PIC S9(9) COMP VALUE +0.    01080033
010900                                                                  01090033
011000 01  PV-PROGRAM-VARIABLES.                                        01100033
011100     05  PV-SUB                       PIC S9(4) VALUE ZERO        01110033
011200                                                COMP SYNC.        01120033
011300     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01130033
011400                                                COMP SYNC.        01140033
011500     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01150033
011600                                                COMP-3.           01160033
011700     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01170033
011800                                                COMP-3.           01180033
011900     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01190033
012000                                                COMP-3.           01200033
012100     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01210033
012200                                                COMP-3.           01220033
012300     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01230033
012400                                                COMP-3.           01240033
012500     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01250033
012600                                                COMP-3.           01260033
012700     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01270033
012800                                                COMP-3.           01280033
012900     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01290033
013000                                                COMP SYNC.        01300033
013100     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01310033
013200                                                COMP SYNC.        01320033
013300     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01330033
013400                                                COMP SYNC.        01340033
013500     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01350033
013600                                                COMP SYNC.        01360033
013700     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01370033
013800                                                COMP SYNC.        01380033
013900     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01390033
014000                                                COMP SYNC.        01400033
014100     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01410033
014200                                                COMP SYNC.        01420033
014300     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01430033
014400                                                COMP SYNC.        01440033
014500     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01450033
014600                                                COMP SYNC.        01460033
014700     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01470033
014800                                                COMP SYNC.        01480033
014900     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01490033
015000                                                COMP SYNC.        01500033
015100     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01510033
015200                                                COMP SYNC.        01520033
015300     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01530033
015400                                                COMP SYNC.        01540033
015500     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01550033
015600                                                COMP SYNC.        01560033
015700     05  PV-SUM-UNIT-QTY              PIC S9(07)  VALUE ZERO      01570033
015800                                                        COMP-3.   01580033
015900     05  PV-ADJ-RETAIL-QTY            PIC S9(6)V99 VALUE ZERO     01590033
016000                                                        COMP-3.   01600033
016100     05  PV-ADJ-COST                  PIC S9(6)V99 VALUE ZERO     01610033
016200                                                        COMP-3.   01620033
016300     05  PV-TOT-ADJ-QTY               PIC S9(7) VALUE ZERO        01630033
016400                                                        COMP-3.   01640033
016500*    05  PV-DISTR-LNE-QTY             PIC S9(9) VALUE ZERO        01650033
016600*                                               COMP SYNC.        01660033
016700     05  PV-AURECD-LNE-NBR            PIC S9(9) VALUE ZERO        01670033
016800                                                COMP SYNC.        01680033
016900     05  PV-SKU-NBR.                                              01690033
017000         10  PV-SN-CL-NBR             PIC  X(2).                  01700033
017100         10  FILLER                   PIC  X    VALUE ' '.        01710033
017200         10  PV-SN-SEQ-NBR            PIC  X(8).                  01720033
017300     05  PV-SN-DEPT-NBR               PIC  X(3).                  01730033
017400     05  PV-NOTIF-NBR                 PIC S9(9) COMP VALUE ZERO.  01740033
017500 01  MSG-QUEUE-ITEM.                                              01750033
017600     05  FILLER                       PIC X(11)  VALUE            01760033
017700         'QUEUE NAME '.                                           01770033
017800     05  MSG-QUEUE-NAME               PIC X(08).                  01780033
017900     05  FILLER                       PIC X(14)  VALUE            01790033
018000         '  ITEM NUMBER '.                                        01800033
018100     05  MSG-SEL-ITEM                 PIC 9(04).                  01810033
018200                                                                  01820033
018300 01  MSG1-PO-REC.                                                 01830033
018400     05  FILLER                       PIC X(07)  VALUE            01840033
018500         'PO NBR '.                                               01850033
018600     05  MSG1-PO-NBR                  PIC 9(09).                  01860033
018700     05  FILLER                       PIC X(11)  VALUE            01870033
018800         '  REC SEQ  '.                                           01880033
018900     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  01890033
019000     05  FILLER                       PIC X(12)  VALUE            01900033
019100         '  OPER UNIT '.                                          01910033
019200     05  MSG1-OPER-UNT-ID             PIC X(04).                  01920033
019300     05  FILLER                       PIC X(11)  VALUE            01930033
019400         '  FACILITY '.                                           01940033
019500     05  MSG1-FACILITY-ID             PIC X(04).                  01950033
019600                                                                  01960033
019700                                                                  01970033
019800******************************************************************01980043
019900*    LOCATION MODULE COPYBOOK                                     01990043
020000******************************************************************02000043
020100     COPY XLWS071.                                                02010043
020200                                                                  02020043
020300******************************************************************02030033
020400*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02040033
020500******************************************************************02050033
020600     COPY RCWS013.                                                02060042
020700                                                                  02070033
020800******************************************************************02080033
020900*    SELECTED ITEMS TEMPORARY STORAGE QUEUE WO ITEM LAYOUT        02090033
021000******************************************************************02100033
021100     COPY PCWS016.                                                02110042
021200                                                                  02120033
021300******************************************************************02130033
021400*    BMS MAP                                                      02140033
021500******************************************************************02150033
021600     COPY RCKM282.                                                02160033
021700                                                                  02170033
021800*----------------------------------------------------------------*02180033
021900*                                                    WR # 21361  *02190039
022000* CHANGED THE STRUCTURE OF MR-SKU FROM X(10) TO X(11) &          *02200038
022100* FILLER FROM X(137) TO X(145).                                  *02210039
022200*----------------------------------------------------------------*02220033
022300 01  MR-OCCURS-LAYOUT                 REDEFINES RC282AO.          02230033
022310*CLP 11/05/14                                                     02231046
022400     05  FILLER                       PIC X(146).                 02240046
022500                                                                  02250033
022600     05  MR-SCROLL-AREA               OCCURS 12 TIMES.            02260033
022700         10  MR-SELECTL               PIC S9(4) COMP.             02270033
022800         10  MR-SELECTA               PIC X.                      02280033
022900         10  MR-SELECTC               PIC X.                      02290033
023000         10  MR-SELECTH               PIC X.                      02300033
023100         10  MR-SELECTI               PIC X.                      02310033
023200                                                                  02320033
023300         10  MR-ACTION-L              PIC S9(4) COMP.             02330033
023400         10  MR-ACTION-A              PIC X.                      02340033
023500         10  MR-ACTION-C              PIC X.                      02350033
023600         10  MR-ACTION-H              PIC X.                      02360033
023700         10  MR-ACTION                PIC X(03).                  02370033
023800                                                                  02380033
023900         10  MR-LINE-L                PIC S9(4) COMP.             02390033
024000         10  MR-LINE-A                PIC X.                      02400033
024100         10  MR-LINE-C                PIC X.                      02410033
024200         10  MR-LINE-H                PIC X.                      02420033
024300         10  MR-LINE.                                             02430033
024400             15 MR-LINE-NUMERIC       PIC 9(03).                  02440033
024500                                                                  02450033
024600         10  MR-SKU-L                 PIC S9(4) COMP.             02460033
024700         10  MR-SKU-A                 PIC X.                      02470033
024800         10  MR-SKU-C                 PIC X.                      02480033
024900         10  MR-SKU-H                 PIC X.                      02490033
025000         10  MR-SKU                   PIC X(11).                  02500033
025100                                                                  02510033
025200         10  MR-ADJ-QTY-L             PIC S9(4) COMP.             02520033
025300         10  MR-ADJ-QTY-A             PIC X.                      02530033
025400         10  MR-ADJ-QTY-C             PIC X.                      02540033
025500         10  MR-ADJ-QTY-H             PIC X.                      02550033
025600         10  MR-ADJ-QTY.                                          02560033
025700             15  MR-ADJ-QTY-EDITED                                02570033
025800                                      PIC ZZ,ZZ9-.                02580033
025900                                                                  02590033
026000         10  MR-ADJ-RETAIL-QTY-L      PIC S9(4) COMP.             02600033
026100         10  MR-ADJ-RETAIL-QTY-A      PIC X.                      02610033
026200         10  MR-ADJ-RETAIL-QTY-C      PIC X.                      02620033
026300         10  MR-ADJ-RETAIL-QTY-H      PIC X.                      02630033
026400         10  MR-ADJ-RETAIL-QTY.                                   02640033
026500             15  MR-ADJ-RETAIL-QTY-EDITED                         02650033
026600                                      PIC ZZZ,ZZ9.99-.            02660033
026700                                                                  02670033
026800         10  MR-ADJ-COST-QTY-L        PIC S9(4) COMP.             02680033
026900         10  MR-ADJ-COST-QTY-A        PIC X.                      02690033
027000         10  MR-ADJ-COST-QTY-C        PIC X.                      02700033
027100         10  MR-ADJ-COST-QTY-H        PIC X.                      02710033
027200         10  MR-ADJ-COST-QTY.                                     02720033
027300             15  MR-ADJ-COST-QTY-EDITED                           02730033
027400                                      PIC ZZZ,ZZ9.99-.            02740033
027500                                                                  02750033
027600     05 FILLER                        PIC X(12).                  02760033
027700                                                                  02770033
027800*----------------------------------------------------------------*02780033
027900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02790039
028000*----------------------------------------------------------------*02800033
028100******************************************************************02810033
028200*    BMS ATTRIBUTES                                               02820033
028300******************************************************************02830033
028400     COPY DPWS015.                                                02840042
028500                                                                  02850033
028600******************************************************************02860033
028700*    FUNCTION KEYS                                                02870033
028800******************************************************************02880033
028900     COPY DPWS016.                                                02890042
029000                                                                  02900033
029100******************************************************************02910033
029200*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   02920033
029300******************************************************************02930033
029400     COPY DPWS010I.                                               02940042
029500                                                                  02950033
029600******************************************************************02960033
029700*    PARAMETER LIST FOR CICS API                                  02970033
029800******************************************************************02980033
029900     COPY DPWS030.                                                02990042
029910     COPY DPWS930.                                                02991049
030000                                                                  03000033
030100******************************************************************03010033
030200*    GLOBAL COMMUNICATION AREA                                    03020033
030300******************************************************************03030033
030400     COPY DPWS020.                                                03040042
030500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03050033
030600                                                                  03060033
030700******************************************************************03070033
030800*    INTER-APPLICATION COMMUNICATION AREA                         03080033
030900*    RCWS015 = INPUT FROM PACK SLIP LINE SUMMARY PROGRAM          03090033
031000******************************************************************03100033
031100         10  INTER-APPL-COMM-AREA       PIC X(200).               03110033
031200     COPY RCWS015.                                                03120042
031300     COPY PCWS000.                                                03130042
031400     COPY TMWS001.                                                03140042
031500                                                                  03150033
031600******************************************************************03160033
031700*    APPLICATION SPECIFIC COMMUNICATION AREA                      03170033
031800******************************************************************03180033
031900*----------------------------------------------------------------*03190033
032000*                                             WR # 21361         *03200039
032100* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *03210033
032200* ASC-DEPT-NBR IS ADDED.                                         *03220033
032300* ASC-SKU FIELD IS INCREASED FROM X(10) TO X(11).                *03230033
032400*----------------------------------------------------------------*03240033
032500         10  ASC-SPECIFIC-COMMAREA.                               03250033
032600             15  ASC-LIST-HEADER-INFO.                            03260033
032700                 20  ASC-KEY-RECEIVER.                            03270033
032800                     25  ASC-KEY-PO-NBR.                          03280033
032900** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03290045
033000                         30  ASC-KEY-PO-NBR-N   PIC 9(08).        03300045
033100                     25  ASC-KEY-REC-DASH       PIC X(01).        03310033
033200                     25  ASC-KEY-REC-SEQ-NBR.                     03320033
033300                         30  ASC-KEY-REC-SEQ-NBR-N                03330033
033400                                                PIC 9(04).        03340033
033500                 20  ASC-KEY-PKSL-LNE-NBR       PIC 9(04).        03350033
033600                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   03360033
033700                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   03370033
033800                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   03380033
033900                 20  ASC-KEY-FCLTY-DESC         PIC X(30).        03390033
034000                 20  ASC-KEY-CYC-NBR            PIC S9(9) COMP.   03400033
034100                 20  ASC-KEY-ADJ-DATE           PIC X(10).        03410033
034200             15  ASC-DEPT-NBR                        PIC X(03).   03420033
034300             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               03430033
034400                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       03440033
034500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03450033
034600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03460033
034700                                                                  03470033
034800                 20  ASC-ITEM-ARRAY.                              03480033
034900                     25  ASC-ITEM-ENTRIES  OCCURS 12 TIMES.       03490033
035000                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    03500033
035100                                                     COMP-3.      03510033
035200                         30  ASC-TEMP-SELECTED-SW    PIC X.       03520033
035300                             88  ASC-VALID-SELECT    VALUE ' '    03530033
035400                                                           'S'    03540033
035500                                                           'B'    03550033
035600                                                           'E'.   03560033
035700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03570033
035800                             88  ASC-TEMP-SELECT     VALUE 'S'.   03580033
035900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03590033
036000                             88  ASC-TEMP-END        VALUE 'E'.   03600033
036100                         30  ASC-SELECTED-SW         PIC  X.      03610033
036200                             88  ASC-NO-SELECT       VALUE ' '.   03620033
036300                             88  ASC-SELECT          VALUE 'S'.   03630033
036400                             88  ASC-BEGIN           VALUE 'B'.   03640033
036500                             88  ASC-END             VALUE 'E'.   03650033
036600                         30  ASC-ACTION              PIC  X(03).  03660033
036700                         30  ASC-LINE-NBR            PIC 9(04).   03670033
036800                         30  ASC-SKU-NBR             PIC X(11).   03680033
036900                         30  ASC-ADJ-QTY.                         03690033
037000                             35  ASC-ADJ-QTY-N                    03700033
037100                                                     PIC S9(05).  03710033
037200                         30  ASC-ADJ-RETAIL-QTY.                  03720033
037300                             35  ASC-ADJ-RETAIL-QTY-N             03730033
037400                                                    PIC S9(6)V99. 03740033
037500                         30  ASC-ADJ-COST.                        03750033
037600                             35  ASC-ADJ-COST-N     PIC S9(6)V99. 03760033
037700                         30  ASC-NOTIF-NBR    PIC S9(9) COMP.     03770033
037800                                                                  03780033
037900             15  ASC-BLK-SUB                         PIC S9(4)    03790033
038000                                                     COMP SYNC.   03800033
038100             15  ASC-ITEM-SUB                        PIC S9(4)    03810033
038200                                                     COMP SYNC.   03820033
038300             15  ASC-SEL-SUB                         PIC S9(4)    03830033
038400                                                     COMP.        03840033
038500             15  ASC-SEL-ITEM                        PIC S9(4)    03850033
038600                                                     COMP.        03860033
038700             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    03870033
038800                                                     COMP-3.      03880033
038900             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    03890033
039000                                                     COMP-3.      03900033
039100             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    03910033
039200                                                     COMP-3.      03920033
039300             15  ASC-ITEMS-DISPLAYED                 PIC S999     03930033
039400                                                     COMP-3.      03940033
039500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    03950033
039600                                                     COMP-3.      03960033
039700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    03970033
039800                                                     COMP-3.      03980033
039900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    03990033
040000                                                     COMP SYNC.   04000033
040100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    04010033
040200                                                     COMP-3.      04020033
040300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    04030033
040400                                                     COMP-3.      04040033
040500             15  ASC-ITEMS-LEFT-INDICATOR                         04050033
040600                                        PIC X(01).                04060033
040700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04070033
040800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04080033
040900             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       04090033
041000                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04100033
041100                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04110033
041200             15  ASC-LIST-QUEUE-NAME.                             04120033
041300                 20  ASC-LIST-TERM-ID                PIC X(4).    04130033
041400                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    04140033
041500                                                     COMP-3.      04150033
041600                 20  ASC-LIST-SEQ                    PIC 9.       04160033
041700             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    04170033
041800             15  ASC-SEL-QUEUE-NAME-OUT.                          04180033
041900                 20  ASC-SEL-TERM-ID                 PIC X(4).    04190033
042000                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    04200033
042100                                                     COMP-3.      04210033
042200                 20  ASC-SEL-SEQ                     PIC 9.       04220033
042300             15  ASC-START-ITEM-REQUEST.                          04230033
042400                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    04240033
042500             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    04250033
042600                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   04260033
042700             15  ASC-HOLD-INTER-APPL                 PIC X(200).  04270033
042800             15  ASC-INTER-APPL-CODE-IND             PIC X(01).   04280033
042900                 88  ASC-INTER-APPL-LIST             VALUE '1'.   04290033
043000             15  ASC-TOT-ADJUST-QTY    PIC S9(7) COMP-3.          04300033
043100*----------------------------------------------------------------*04310033
043200* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04320039
043300*----------------------------------------------------------------*04330033
043400*----------------------------------------------------------------*04340033
043500*                                                **   WR # 21361 *04350039
043600* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *04360033
043700*----------------------------------------------------------------*04370033
043800/                                                                 04380033
043900 01  LQW-LIST-QUEUE-WORK-AREA.                                    04390033
044000     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     04400033
044100     05  LQW-ITEM-ENTRIES             OCCURS 12 TIMES             04410033
044200                                      INDEXED BY LQW-IDX.         04420033
044300         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          04430033
044400         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  04440033
044500         10  LQW-SELECTED-SW          PIC X(01).                  04450033
044600             88  LQW-SELECT                      VALUE 'S'.       04460033
044700             88  LQW-DESELECT                    VALUE SPACE.     04470033
044800         10  LQW-ACTION               PIC X(03).                  04480033
044900         10  LQW-LINE-NBR             PIC 9(04).                  04490033
045000         10  LQW-SKU-NBR              PIC X(11).                  04500033
045100         10  LQW-ADJ-QTY.                                         04510033
045200             15  LQW-ADJ-QTY-N        PIC 9(05).                  04520033
045300         10  LQW-ADJ-RETAIL-QTY.                                  04530033
045400             15  LQW-ADJ-RETAIL-QTY-N PIC S9(6)V99.               04540033
045500         10  LQW-ADJ-COST.                                        04550033
045600             15  LQW-ADJ-COST-N       PIC S9(6)V99.               04560033
045700         10  LQW-NOTIF-NBR            PIC S9(9) COMP.             04570033
045800                                                                  04580033
045900*----------------------------------------------------------------*04590033
046000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04600039
046100*----------------------------------------------------------------*04610033
046200                                                                  04620033
046300******************************************************************04630033
046400*    ABEND PROCESSING                                             04640033
046500******************************************************************04650033
046600     COPY DPWS013.                                                04660042
046700/                                                                 04670033
046800*----------------------------------------------------------------*04680033
046900*                                                **   WR # 21361 *04690039
047000*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE         *04700033
047100*----------------------------------------------------------------*04710033
047200     COPY XLWS001.                                                04720033
047300*----------------------------------------------------------------*04730033
047400*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        04740039
047500*----------------------------------------------------------------*04750033
047600******************************************************************04760033
047700*    DB2 SQL COMMUNICATION AREA                                   04770033
047800******************************************************************04780033
047900     EXEC SQL                                                     04790033
048000          INCLUDE SQLCA                                           04800033
048100     END-EXEC.                                                    04810033
048200/                                                                 04820033
048300*---------------------------------------------------------------* 04830033
048400*    DB2 AREA FOR AUDIT TABLE FOR TAURECD  TABLE                * 04840033
048500*---------------------------------------------------------------* 04850033
048600     EXEC SQL                                                     04860033
048700          INCLUDE TAURECD                                         04870033
048800     END-EXEC.                                                    04880033
048900/                                                                 04890033
049000******************************************************************04900033
049100*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          04910033
049200******************************************************************04920033
049300     EXEC SQL                                                     04930033
049400          INCLUDE TPURCHS                                         04940033
049500     END-EXEC.                                                    04950033
049600/                                                                 04960033
049700******************************************************************04970033
049800*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     04980033
049900******************************************************************04990033
050000     EXEC SQL                                                     05000033
050100          INCLUDE TPURITM                                         05010033
050200     END-EXEC.                                                    05020033
050300                                                                  05030042
050400*---------------------------------------------------------------* 05040033
050500*    DB2 AREA FOR RECEIVING MASTER                                05050033
050600*---------------------------------------------------------------* 05060033
050700     EXEC SQL                                                     05070033
050800          INCLUDE TRECITM                                         05080033
050900     END-EXEC.                                                    05090033
051000                                                                  05100042
051100******************************************************************05110033
051200*    DB2 CURSOR FOR ALL THE AUDIT LINES BELONGING TO A SELECTED   05120033
051300*    LINE.                                                        05130033
051400******************************************************************05140033
051500     EXEC SQL                                                     05150033
051600         DECLARE TAURECD-CURSOR CURSOR FOR                        05160033
051700             SELECT ORD_LNE_NBR                                   05170033
051800                , REC_SEQ_NBR                                     05180033
051900                , UPD_TMST                                        05190033
052000                , AUD_TYP_CDE                                     05200033
052100                , AP_VERIFY_ITM_QTY                               05210033
052200                , NOTIF_NBR                                       05220033
052300             FROM TAURECD                                         05230033
052400             WHERE ORD_NBR         = :DK-PO-NBR                   05240033
052500               AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR              05250033
052600               AND VER_STATUS_CDE  = :PC-A                        05260033
052700               AND ADJ_CYC_NBR     = :DK-CYC-NBR                  05270033
052800                AND (UPD_PGM_ID    = 'RCKCS279' OR                05280033
052900                     UPD_PGM_ID    = 'RCKCS280' OR                05290040
053000                     UPD_PGM_ID    = 'RCKPV818' OR                05300040
053100                     UPD_PGM_ID    = 'RCKPV819' OR                05310040
053200                     UPD_PGM_ID    = 'RCKPV820' OR                05320041
053300                     UPD_PGM_ID    = 'SUKPV702')                  05330041
053400             ORDER BY ORD_LNE_NBR                                 05340033
053500                  , UPD_TMST                                      05350033
053600                  , AUD_TYP_CDE                                   05360033
053700     END-EXEC.                                                    05370033
053800/                                                                 05380033
053900 LINKAGE SECTION.                                                 05390033
054000                                                                  05400033
054100 01  DFHCOMMAREA.                                                 05410033
054200     05  FILLER                       OCCURS 1 TO 4072 TIMES      05420033
054300                                      DEPENDING ON EIBCALEN.      05430033
054400         10  FILLER                   PIC X.                      05440033
054500                                                                  05450033
054600                                                                  05460033
054700 PROCEDURE DIVISION.                                              05470033
054800                                                                  05480033
054900 0000-MAIN-MODULE.                                                05490033
055000                                                                  05500033
055100     INITIALIZE DP030-CICS-API-FIELDS.                            05510033
055200                                                                  05520033
055300     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         05530033
055400     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            05540033
055500     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           05550033
055600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         05560033
055700     MOVE LENGTH OF RC282AI      TO DP030-MAP-LENGTH (1).         05570033
055800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       05580033
055900     SET DP030-OVERRIDE-APPL-ERROR                                05590033
056000                                 TO TRUE.                         05600033
056100                                                                  05610033
056200     PERFORM 0001-CALL-CICS-ARCH-API.                             05620033
056300                                                                  05630033
056400     PERFORM 1000-CONTROL-PROCESSING.                             05640033
056500                                                                  05650033
056600     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       05660033
056700                                                                  05670033
056800     PERFORM 0001-CALL-CICS-ARCH-API.                             05680033
056900                                                                  05690033
057000 0001-CALL-CICS-ARCH-API.                                         05700033
057100                                                                  05710033
057210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05721049
057300                                    DFHCOMMAREA                   05730049
057400                                    DP030-CICS-API-FIELDS         05740049
057500                                    DP020-STANDARD-COMMAREA       05750049
057600                                    RC282AI.                      05760049
057700                                                                  05770033
057800     IF DP030-RC-CALL-SUCCESSFUL OR                               05780033
057900        DP030-RC-APPL-ERROR                                       05790033
058000         CONTINUE                                                 05800033
058100     ELSE                                                         05810033
058200         SET DP013-CICS-ABEND                                     05820033
058300             DP013-NO-ROLLBACK                                    05830033
058400             DP013-XCTL-DISPLAY-RESTART                           05840033
058500                                 TO TRUE                          05850033
058600         MOVE '0001-CALL-CICS-ARCH-API'                           05860033
058700                                 TO DP013-PARAGRAPH               05870033
058720         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O05872049
058730-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05873049
059000         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        05900033
059100                                                                  05910033
059200         PERFORM DP013-0000-PROCESS-ABEND.                        05920033
059300                                                                  05930033
059400 1000-CONTROL-PROCESSING.                                         05940033
059500                                                                  05950033
059600     EVALUATE TRUE                                                05960033
059700                                                                  05970033
059800         WHEN DP030-RC-APPL-ERROR                                 05980033
059900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       05990033
060000                                 TO PV-TOP-ITEM                   06000033
060100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06010033
060200                                                                  06020033
060300              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06030033
060400                                                                  06040033
060500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  06050033
060600                                                                  06060033
060700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06070033
060800              PERFORM 3200-RESET-ATTRIBUTES                       06080033
060900                                                                  06090033
061000                                                                  06100033
061100         WHEN DP020-NEXT-ACT-INITIAL                              06110033
061200              INITIALIZE ASC-SPECIFIC-COMMAREA                    06120033
061300              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              06130033
061400                                    ASC-SEL-TERM-ID               06140033
061500              MOVE DP020-SRC-TASK-NUMBER                          06150033
061600                                 TO ASC-LIST-TASK-NUMBER          06160033
061700                                    ASC-SEL-TASK-NUMBER           06170033
061800              MOVE PC-LIST-QUEUE-SEQ                              06180033
061900                                 TO ASC-LIST-SEQ                  06190033
062000              MOVE PC-SEL-QUEUE-SEQ                               06200033
062100                                 TO ASC-SEL-SEQ                   06210033
062200              SET PS-NO-ERROR    TO TRUE                          06220033
062300                                                                  06230033
062400              PERFORM 1100-PROCESS-INTER-APPL-COMM                06240033
062500                                                                  06250033
062600              IF PS-NO-ERROR                                      06260033
062700                  MOVE INTER-APPL-COMM-AREA                       06270033
062800                                 TO ASC-HOLD-INTER-APPL           06280033
062900                  PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT 06290033
063000              END-IF                                              06300033
063100                                                                  06310033
063200                                                                  06320033
063300         WHEN DP020-NEXT-ACT-READ-MAP                             06330033
063400              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06340033
063500                                 TO PV-TOP-ITEM                   06350033
063600                                                                  06360033
063700              PERFORM 2000-PROCESS-PANEL                          06370033
063800                                                                  06380033
063900                                                                  06390033
064000         WHEN DP020-NEXT-ACT-RETURN                               06400033
064100              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       06410033
064200                                 TO PV-TOP-ITEM                   06420033
064300              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06430033
064400                                                                  06440033
064500              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                06450033
064600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06460033
064700                                                                  06470033
064800         WHEN OTHER                                               06480033
064900              SET DP013-LOGIC-ABEND                               06490033
065000                  DP013-NO-ROLLBACK                               06500033
065100                                 TO TRUE                          06510033
065200              MOVE '1000-CONTROL-PROCESSING'                      06520033
065300                                 TO DP013-PARAGRAPH               06530033
065400              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   06540033
065500                                 TO DP013-MESSAGE-TEXT(1)         06550033
065600                                                                  06560033
065700              PERFORM DP013-0000-PROCESS-ABEND                    06570033
065800                                                                  06580033
065900     END-EVALUATE.                                                06590033
066000                                                                  06600033
066100 1100-PROCESS-INTER-APPL-COMM.                                    06610033
066200                                                                  06620033
066300     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       06630033
066400     MOVE DP020-INT-APPL-FORMAT-IND                               06640033
066500                                 TO ASC-INTER-APPL-CODE-IND.      06650033
066600* SINCE THERE'S ONLY ONE POSSIBLE VALUE FOR THIS CODE,            06660033
066700* THERE'S NO NEED TO INTEROGATE IT.                               06670033
066800                                                                  06680033
066900     IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO                     06690033
067000         SET ASC-NO-TSQ-UPDATE                                    06700033
067100                                 TO TRUE                          06710033
067200         SET DP020-MSG-FATAL                                      06720033
067300             DP020-NEXT-ACT-APPL-ERROR                            06730033
067400                     PS-ERROR    TO TRUE                          06740033
067500             MOVE PC-TSYMSG-00057                                 06750033
067600                                 TO DP020-MSG-NUMBER              06760033
067700     ELSE                                                         06770033
067800         MOVE RC015-PO-NBR       TO ASC-KEY-PO-NBR-N              06780033
067900                                    DK-PO-NBR                     06790033
068000                                                                  06800033
068100         SET ASC-USE-SELECTION-QUEUE                              06810033
068200                                 TO TRUE                          06820033
068300         MOVE RC015-NUMBER-OF-SELECTED-ITEMS                      06830033
068400                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  06840033
068500         MOVE RC015-NUMBER-OF-TS-ITEMS                            06850033
068600                                 TO ASC-NUMBER-OF-TS-ITEMS        06860033
068700         MOVE RC015-SEL-QUEUE-NAME                                06870033
068800                                 TO ASC-SEL-QUEUE-NAME-IN         06880033
068900         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   06890033
069000         MOVE ZERO               TO ASC-SEL-ITEM                  06900033
069100         PERFORM 2300-GET-SELQUE-RECORD                           06910033
069200     END-IF.                                                      06920033
069300     EJECT                                                        06930033
069400 2000-PROCESS-PANEL.                                              06940033
069500                                                                  06950033
069600     EVALUATE TRUE                                                06960033
069700                                                                  06970033
069800         WHEN DP020-SRC-AID = DP016-CLEAR                         06980033
069900              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      06990033
070000              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07000033
070100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07010033
070200              PERFORM 3200-RESET-ATTRIBUTES                       07020033
070300                                                                  07030033
070400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07040033
070500              PERFORM 2050-DELETE-LIST-QUEUE                      07050033
070600              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     07060033
070700                                                                  07070033
070800         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   07080033
070900              PERFORM 2140-DESELECT-ALL-ITEMS                     07090033
071000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07100033
071100              PERFORM 3200-RESET-ATTRIBUTES                       07110033
071200                                                                  07120033
071300         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 07130033
071400              PERFORM 2150-SELECT-ALL-ITEMS                       07140033
071500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07150033
071600              PERFORM 3200-RESET-ATTRIBUTES                       07160033
071700                                                                  07170033
071800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07180033
071900             IF ASC-USE-SELECTION-QUEUE                           07190033
072000                 PERFORM 6200-DEL-LIST-QUEUE                      07200033
072100                 PERFORM 2300-GET-SELQUE-RECORD                   07210033
072200                 PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT  07220033
072300             ELSE                                                 07230033
072400*                --- BOTTOM OF LIST ---                           07240033
072500                 MOVE PC-TSYMSG-00070                             07250033
072600                                 TO DP020-MSG-NUMBER              07260033
072700                 SET DP020-MSG-INFORMATIONAL                      07270033
072800                                 TO TRUE                          07280033
072900             END-IF                                               07290033
073000                                                                  07300033
073100         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07310033
073200             IF ASC-USE-SELECTION-QUEUE                           07320033
073300                 PERFORM 6200-DEL-LIST-QUEUE                      07330033
073400                     PERFORM 2310-GET-PREV-RECORD                 07340033
073500*                END-IF                                           07350033
073600                 PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT  07360033
073700             ELSE                                                 07370033
073800*                --- TOP OF LIST ---                              07380033
073900                 MOVE PC-TSYMSG-00069                             07390033
074000                                 TO DP020-MSG-NUMBER              07400033
074100                 SET DP020-MSG-INFORMATIONAL                      07410033
074200                                 TO TRUE                          07420033
074300             END-IF                                               07430033
074400                                                                  07440033
074500         WHEN OTHER                                               07450033
074600              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                07460033
074700              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07470033
074800              IF PS-NO-ERROR                                      07480033
074900                  SET DP030-CONTINUE-GO                           07490033
075000                                 TO TRUE                          07500033
075100                  PERFORM 2100-CHECK-FUNCTION-KEY                 07510033
075200              ELSE                                                07520033
075300                  SET DP030-OVERRIDE-GO                           07530033
075400                                 TO TRUE                          07540033
075500              END-IF                                              07550033
075600     END-EVALUATE.                                                07560033
075700                                                                  07570033
075800 2050-DELETE-LIST-QUEUE.                                          07580033
075900                                                                  07590033
076000     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             07600033
076100                          RESP  (PV-CICS-RESP)                    07610033
076200                          END-EXEC.                               07620033
076300                                                                  07630033
076400     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      07640033
076500        (PV-CICS-RESP = DFHRESP (QIDERR))                         07650033
076600         CONTINUE                                                 07660033
076700     ELSE                                                         07670033
076800         SET DP013-CICS-ABEND                                     07680033
076900             DP013-NO-ROLLBACK   TO TRUE                          07690033
077000         MOVE '2050-DELETE-LIST-QUEUE'                            07700033
077100                                 TO DP013-PARAGRAPH               07710033
077200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 07720033
077300                                 TO DP013-MESSAGE-TEXT (1)        07730033
077400                                                                  07740033
077500         PERFORM DP013-0000-PROCESS-ABEND                         07750033
077600     END-IF.                                                      07760033
077700                                                                  07770033
077800     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    07780033
077900                                                                  07790033
078000 2100-CHECK-FUNCTION-KEY.                                         07800033
078100                                                                  07810033
078200     SET PS-NEXT-SCREEN TO TRUE.                                  07820033
078300     EVALUATE TRUE                                                07830033
078400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 07840033
078500             IF DP020-FK-INT-APPL-FORMAT-IND (DP020-SRC-AID)      07850033
078600                                    = '4'                         07860033
078700                 MOVE ZERO       TO RC015-PKSL-LNE-NBR            07870033
078800*       TRANSFER TO TROUBLE DETAIL SCREEN, TMLDETL                07880033
078900             ELSE                                                 07890033
079000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              07900033
079100*       TRANSFER TO ADJUSTMENT BY STORE SCREEN, RCLAUSTR          07910033
079200                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            07920033
079300                                 TO RC015-NUMBER-OF-SELECTED-ITEMS07930033
079400                     MOVE ASC-KEY-PO-NBR-N                        07940033
079500                                 TO RC015-PO-NBR                  07950033
079600                     MOVE ASC-KEY-REC-SEQ-NBR-N                   07960033
079700                                 TO RC015-REC-SEQ-NBR             07970033
079800                     MOVE ASC-KEY-OPER-UNT-ID                     07980033
079900                                 TO RC015-OPER-UNT-ID             07990033
080000                     MOVE ASC-KEY-FCLTY-ID                        08000033
080100                                 TO RC015-FCLTY-ID                08010033
080200                     MOVE ASC-KEY-CYC-NBR                         08020033
080300                                 TO RC015-ADJ-CYC-NBR             08030033
080400                     PERFORM 5000-PREPARE-SEL-QUEUE               08040033
080500             ELSE                                                 08050033
080600                 SET DP030-OVERRIDE-GO                            08060033
080700                                 TO TRUE                          08070033
080800                 MOVE PC-TSYMSG-00057                             08080033
080900                                 TO DP020-MSG-NUMBER              08090033
081000                  SET DP020-MSG-WARNING                           08100033
081100                                 TO TRUE                          08110033
081200             END-IF                                               08120033
081300             END-IF                                               08130033
081400*            IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO               08140033
081500*                SET ASC-NO-TSQ-UPDATE                            08150033
081600*                                TO TRUE                          08160033
081700*            END-IF                                               08170033
081800                                                                  08180033
081900         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 08190033
082000             MOVE +1             TO PV-TOP-ITEM                   08200033
082100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08210033
082200             PERFORM 3200-RESET-ATTRIBUTES                        08220033
082300                                                                  08230033
082400         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  08240033
082500             PERFORM 2110-BROWSE-BACKWARD                         08250033
082600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08260033
082700             PERFORM 3200-RESET-ATTRIBUTES                        08270033
082800                                                                  08280033
082900         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  08290033
083000             PERFORM 2120-BROWSE-FORWARD                          08300033
083100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08310033
083200             PERFORM 3200-RESET-ATTRIBUTES                        08320033
083300                                                                  08330033
083400         WHEN DP020-SRC-AID = DP016-ENTER                         08340033
083500                                                                  08350033
083600             PERFORM 2180-CHECK-FOR-JUMP-BROWSE                   08360033
083700                                                                  08370033
083800             IF PS-NO-ERROR                                       08380033
083900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08390033
084000                 PERFORM 3200-RESET-ATTRIBUTES                    08400033
084100             END-IF                                               08410033
084200                                                                  08420033
084300         WHEN OTHER                                               08430033
084400             SET DP013-CICS-ABEND                                 08440033
084500                 DP013-NO-ROLLBACK                                08450033
084600                 DP013-XCTL-DISPLAY-RESTART                       08460033
084700                                 TO TRUE                          08470033
084800             MOVE '2100-CHECK-FUNCTION-KEY'                       08480033
084900                                 TO DP013-PARAGRAPH               08490033
085000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08500033
085100                                 TO DP013-MESSAGE-TEXT (1)        08510033
085200                                                                  08520033
085300             PERFORM DP013-0000-PROCESS-ABEND                     08530033
085400     END-EVALUATE.                                                08540033
085500                                                                  08550033
085600 2110-BROWSE-BACKWARD.                                            08560033
085700                                                                  08570033
085800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    08580033
085900         GIVING PV-TOP-ITEM.                                      08590033
086000                                                                  08600033
086100     IF PV-TOP-ITEM NOT > +1                                      08610033
086200         MOVE +1                 TO PV-TOP-ITEM                   08620033
086300         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              08630033
086400         SET DP020-MSG-INFORMATIONAL                              08640033
086500                                 TO TRUE.                         08650033
086600                                                                  08660033
086700 2120-BROWSE-FORWARD.                                             08670033
086800                                                                  08680033
086900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              08690033
087000         GIVING PV-TOP-ITEM.                                      08700033
087100                                                                  08710033
087200     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    08720033
087300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08730033
087400                                 TO PV-TOP-ITEM                   08740033
087500         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              08750033
087600         SET DP020-MSG-INFORMATIONAL                              08760033
087700                                 TO TRUE                          08770033
087800     ELSE                                                         08780033
087900         COMPUTE PV-BOTTOM-ITEM =                                 08790033
088000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08800033
088100         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             08810033
088200             MOVE PC-TSYMSG-00070                                 08820033
088300                                 TO DP020-MSG-NUMBER              08830033
088400             SET DP020-MSG-INFORMATIONAL                          08840033
088500                                 TO TRUE.                         08850033
088600                                                                  08860033
088700 2180-CHECK-FOR-JUMP-BROWSE.                                      08870033
088800                                                                  08880033
088900     SET PS-NO-ERROR             TO TRUE.                         08890033
089000                                                                  08900033
089100     IF ASC-START-ITEM-REQUEST = SPACE                            08910033
089200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08920033
089300                                 TO PV-TOP-ITEM                   08930033
089400     ELSE                                                         08940033
089500         MOVE ASC-START-ITEM-REQUEST                              08950033
089600                                 TO DP010I-UNEDITED-FIELD         08960033
089700         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         08970033
089800         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       08980033
089900         SET DP010I-NEGATIVE-NOT-ALLOWED                          08990033
090000                                 TO TRUE                          09000033
090100                                                                  09010033
090210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09021047
090220              USING DP010I-NUMERIC-EDIT-AREA                      09022047
090300                                                                  09030033
090400         IF NOT DP010I-ERROR-DETECTED                             09040033
090500             MOVE DP010I-NUMERIC-FIELD                            09050033
090600                                 TO ASC-START-ITEM-REQUEST-N      09060033
090700             IF ASC-START-ITEM-REQUEST-N > ZERO                   09070033
090800                IF ASC-START-ITEM-REQUEST-N >                     09080033
090900                                          ASC-NUMBER-OF-ITEMS-READ09090033
091000                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        09100033
091100                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ09110033
091200                                          - PC-ITEMS-PER-PANEL + 109120033
091300                    IF PV-TOP-ITEM < +1                           09130033
091400                        MOVE +1  TO PV-TOP-ITEM                   09140033
091500                        MOVE PC-TSYMSG-00070                      09150033
091600                                 TO DP020-MSG-NUMBER              09160033
091700                        SET DP020-MSG-INFORMATIONAL               09170033
091800                                 TO TRUE                          09180033
091900                    END-IF                                        09190033
092000                ELSE                                              09200033
092100                    MOVE ASC-START-ITEM-REQUEST-N                 09210033
092200                                 TO PV-TOP-ITEM                   09220033
092300                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        09230033
092400                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        09240033
092500                                            PC-ITEMS-PER-PANEL - 109250033
092600                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  09260033
092700                         MOVE PC-TSYMSG-00070                     09270033
092800                                 TO DP020-MSG-NUMBER              09280033
092900                         SET DP020-MSG-INFORMATIONAL              09290033
093000                                 TO TRUE                          09300033
093100                    END-IF                                        09310033
093200                END-IF                                            09320033
093300             ELSE                                                 09330033
093400* VALUE MUST BE GREATER THAN ZERO AND LESS THAN 1,000,000         09340033
093500                 MOVE PC-TSYMSG-00101                             09350033
093600                                 TO DP020-MSG-NUMBER              09360033
093700                 SET DP030-SET-CURSOR-APPL-1                      09370033
093800                                 TO TRUE                          09380033
093900                 MOVE -1         TO ASTRTITL                      09390033
094000                 MOVE DP015-UNP-NUM-BRT-MDT                       09400033
094100                                 TO ASTRTITA                      09410033
094200                 MOVE DP015-RED  TO ASTRTITC                      09420033
094300                 MOVE DP015-REVERSE                               09430033
094400                                 TO ASTRTITH                      09440033
094500                 SET PS-ERROR                                     09450033
094600                     DP020-MSG-FATAL                              09460033
094700                                 TO TRUE                          09470033
094800             END-IF                                               09480033
094900         ELSE                                                     09490033
095000             MOVE PC-TSYMSG-00008                                 09500033
095100                                 TO DP020-MSG-NUMBER              09510033
095200             SET DP030-SET-CURSOR-APPL-1                          09520033
095300                                 TO TRUE                          09530033
095400             MOVE -1             TO ASTRTITL                      09540033
095500             MOVE DP015-UNP-NUM-BRT-MDT                           09550033
095600                                 TO ASTRTITA                      09560033
095700             MOVE DP015-RED      TO ASTRTITC                      09570033
095800             MOVE DP015-REVERSE  TO ASTRTITH                      09580033
095900             SET PS-ERROR                                         09590033
096000                 DP020-MSG-FATAL TO TRUE                          09600033
096100         END-IF                                                   09610033
096200     END-IF.                                                      09620033
096300                                                                  09630033
096400 2140-DESELECT-ALL-ITEMS.                                         09640033
096500                                                                  09650033
096600     MOVE +1                     TO ASC-BLK-SUB.                  09660033
096700                                                                  09670033
096800     PERFORM 2141-CLEAR-SELECTED-INDS                             09680033
096900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    09690033
097000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           09700033
097100                                                                  09710033
097200     ADD +1                      TO ASC-BLK-SUB.                  09720033
097300                                                                  09730033
097400     PERFORM 2141-CLEAR-SELECTED-INDS                             09740033
097500             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    09750033
097600             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           09760033
097700                                                                  09770033
097800     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              09780033
097900                                 TO PV-LIST-ITEM-NUMBER.          09790033
098000                                                                  09800033
098100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09810033
098200             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).09820033
098300                                                                  09830033
098400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09840033
098500              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)09850033
098600         MOVE +1                 TO ASC-BLK-SUB                   09860033
098700                                                                  09870033
098800         PERFORM 5100-WRITE-TEMP-STORAGE                          09880033
098900                                                                  09890033
099000         MOVE +1                 TO PV-BLOCK-NUMBER               09900033
099100                                                                  09910033
099200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09920033
099300                                       PV-FIRST-BLOCK-IN-ARRAY - 109930033
099400                                                                  09940033
099500         PERFORM                                                  09950033
099600           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         09960033
099700                                                                  09970033
099800                 PERFORM 4410-READ-TEMP-STORAGE                   09980033
099900                                                                  09990033
100000                 PERFORM 2141-CLEAR-SELECTED-INDS                 10000033
100100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10010033
100200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10020033
100300                                                                  10030033
100400                 PERFORM 5100-WRITE-TEMP-STORAGE                  10040033
100500                                                                  10050033
100600                 ADD +1          TO PV-BLOCK-NUMBER               10060033
100700                                                                  10070033
100800         END-PERFORM                                              10080033
100900                                                                  10090033
101000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         10100033
101100                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY10110033
101200                                                                  10120033
101300         PERFORM                                                  10130033
101400           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         10140033
101500                                         ASC-HIGHEST-BLOCK-WRITTEN10150033
101600                                                                  10160033
101700                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      10170033
101800                                 TO PV-BLOCK-NUMBER               10180033
101900                                                                  10190033
102000                 PERFORM 4410-READ-TEMP-STORAGE                   10200033
102100                                                                  10210033
102200                 PERFORM 2141-CLEAR-SELECTED-INDS                 10220033
102300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10230033
102400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10240033
102500                                                                  10250033
102600                 PERFORM 5100-WRITE-TEMP-STORAGE                  10260033
102700                                                                  10270033
102800                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        10280033
102900                                                                  10290033
103000         END-PERFORM                                              10300033
103100                                                                  10310033
103200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             10320033
103300                                 TO PV-BLOCK-NUMBER               10330033
103400                                                                  10340033
103500         PERFORM 4410-READ-TEMP-STORAGE                           10350033
103600                                                                  10360033
103700     END-IF.                                                      10370033
103800                                                                  10380033
103900     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  10390033
104000                                    ASC-START-OF-SELECTED-RANGE   10400033
104100                                    ASC-END-OF-SELECTED-RANGE.    10410033
104200                                                                  10420033
104300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10430033
104400     PERFORM 3200-RESET-ATTRIBUTES.                               10440033
104500                                                                  10450033
104600 2141-CLEAR-SELECTED-INDS.                                        10460033
104700                                                                  10470033
104800     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO10480033
104900        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           10490033
105000            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          10500033
105100                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     10510033
105200                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  10520033
105300                                 TO TRUE.                         10530033
105400                                                                  10540033
105500 2150-SELECT-ALL-ITEMS.                                           10550033
105600                                                                  10560033
105700     MOVE +1                     TO ASC-BLK-SUB.                  10570033
105800                                                                  10580033
105900     PERFORM 2151-SET-SELECTED-INDS                               10590033
106000             VARYING ASC-ITEM-SUB FROM 1 BY 1                     10600033
106100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           10610033
106200                                                                  10620033
106300     ADD +1                      TO ASC-BLK-SUB.                  10630033
106400                                                                  10640033
106500     PERFORM 2151-SET-SELECTED-INDS                               10650033
106600             VARYING ASC-ITEM-SUB FROM 1 BY 1                     10660033
106700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           10670033
106800                                                                  10680033
106900     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              10690033
107000                                 TO PV-LIST-ITEM-NUMBER.          10700033
107100                                                                  10710033
107200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            10720033
107300             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).10730033
107400                                                                  10740033
107500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     10750033
107600              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)10760033
107700         MOVE +1                 TO ASC-BLK-SUB                   10770033
107800                                                                  10780033
107900         PERFORM 5100-WRITE-TEMP-STORAGE                          10790033
108000                                                                  10800033
108100         MOVE +1                 TO PV-BLOCK-NUMBER               10810033
108200                                                                  10820033
108300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         10830033
108400                                       PV-FIRST-BLOCK-IN-ARRAY - 110840033
108500                                                                  10850033
108600         PERFORM                                                  10860033
108700           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         10870033
108800                                                                  10880033
108900                 PERFORM 4410-READ-TEMP-STORAGE                   10890033
109000                                                                  10900033
109100                 PERFORM 2151-SET-SELECTED-INDS                   10910033
109200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        10920033
109300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL10930033
109400                                                                  10940033
109500                 PERFORM 5100-WRITE-TEMP-STORAGE                  10950033
109600                                                                  10960033
109700                 ADD +1          TO PV-BLOCK-NUMBER               10970033
109800                                                                  10980033
109900         END-PERFORM                                              10990033
110000                                                                  11000033
110100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11010033
110200                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY11020033
110300                                                                  11030033
110400         PERFORM                                                  11040033
110500           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         11050033
110600                                         ASC-HIGHEST-BLOCK-WRITTEN11060033
110700                                                                  11070033
110800                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      11080033
110900                                 TO PV-BLOCK-NUMBER               11090033
111000                                                                  11100033
111100                 PERFORM 4410-READ-TEMP-STORAGE                   11110033
111200                                                                  11120033
111300                 PERFORM 2151-SET-SELECTED-INDS                   11130033
111400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11140033
111500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11150033
111600                                                                  11160033
111700                 PERFORM 5100-WRITE-TEMP-STORAGE                  11170033
111800                                                                  11180033
111900                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        11190033
112000                                                                  11200033
112100         END-PERFORM                                              11210033
112200                                                                  11220033
112300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11230033
112400                                 TO PV-BLOCK-NUMBER               11240033
112500                                                                  11250033
112600         PERFORM 4410-READ-TEMP-STORAGE                           11260033
112700     END-IF.                                                      11270033
112800                                                                  11280033
112900     MOVE ASC-NUMBER-OF-ITEMS-READ                                11290033
113000                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 11300033
113100                                                                  11310033
113200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11320033
113300     PERFORM 3200-RESET-ATTRIBUTES.                               11330033
113400                                                                  11340033
113500 2151-SET-SELECTED-INDS.                                          11350033
113600                                                                  11360033
113700     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO11370033
113800        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              11380033
113900            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             11390033
114000                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        11400033
114100                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  11410033
114200                                 TO TRUE                          11420033
114300        END-IF                                                    11430033
114400     END-IF.                                                      11440033
114500                                                                  11450033
114600 2200-MOVE-SCREEN-TO-COMMAREA.                                    11460033
114700                                                                  11470033
114800     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               11480033
114900     MOVE +1                     TO PV-SUB.                       11490033
115000                                                                  11500033
115100     PERFORM 3100-SET-SUBSCRIPTS.                                 11510033
115200                                                                  11520033
115300     IF ASTRTITL > ZERO                                           11530033
115400         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        11540033
115500     ELSE                                                         11550033
115600         IF ASTRTITF = DP015-ERASE-EOF                            11560033
115700             INITIALIZE ASC-START-ITEM-REQUEST                    11570033
115800         END-IF                                                   11580033
115900     END-IF.                                                      11590033
116000                                                                  11600033
116100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          11610033
116200             VARYING PV-SUB  FROM 1 BY 1                          11620033
116300             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                11630033
116400                                                                  11640033
116500 2210-MOVE-LINES-TO-COMMAREA.                                     11650033
116600                                                                  11660033
116700     IF MR-SELECTL (PV-SUB) > ZERO                                11670033
116800         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  11680033
116900                                 TO TRUE                          11690033
117000         MOVE MR-SELECTI (PV-SUB)                                 11700033
117100                                 TO ASC-TEMP-SELECTED-SW          11710033
117200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     11720033
117300     ELSE                                                         11730033
117400         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 11740033
117500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 11750033
117600                                 TO TRUE                          11760033
117700             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          11770033
117800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     11780033
117900         END-IF                                                   11790033
118000     END-IF.                                                      11800033
118100                                                                  11810033
118200     ADD +1                      TO ASC-ITEM-SUB.                 11820033
118300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         11830033
118400         ADD  +1                 TO ASC-BLK-SUB                   11840033
118500         MOVE +1                 TO ASC-ITEM-SUB                  11850033
118600     END-IF.                                                      11860033
118700                                                                  11870033
118800******************************************************************11880033
118900* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *11890033
119000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *11900033
119100******************************************************************11910033
119200 2300-GET-SELQUE-RECORD.                                          11920033
119300                                                                  11930033
119400     ADD +1                      TO ASC-SEL-SUB.                  11940033
119500                                                                  11950033
119600     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             11960033
119700         ADD +1                  TO ASC-SEL-ITEM                  11970033
119800         MOVE +1                 TO ASC-SEL-SUB                   11980033
119900     END-IF.                                                      11990033
120000                                                                  12000033
120100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 12010033
120200         PERFORM 9100-READ-SEL-QUEUE                              12020033
120300         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       12030033
120400             PERFORM 2320-LOAD-ASC-FROM-RC013                     12040033
120500             SET RC013-INQ (ASC-SEL-SUB)                          12050033
120600                                 TO TRUE                          12060033
120700             PERFORM 9200-REWRITE-LIST-QUEUE                      12070033
120800         ELSE                                                     12080033
120900             SUBTRACT +1 FROM ASC-SEL-SUB                         12090033
121000*            --- BOTTOM OF LIST ---                               12100033
121100             MOVE PC-TSYMSG-00070                                 12110033
121200                                 TO DP020-MSG-NUMBER              12120033
121300             SET DP020-MSG-INFORMATIONAL                          12130033
121400                                 TO TRUE                          12140033
121500         END-IF                                                   12150033
121600     ELSE                                                         12160033
121700         SUBTRACT +1 FROM ASC-SEL-ITEM                            12170033
121800         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   12180033
121900         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              12190033
122000         SET DP020-MSG-INFORMATIONAL                              12200033
122100                                 TO TRUE                          12210033
122200     END-IF.                                                      12220033
122300                                                                  12230033
122400/                                                                 12240033
122500******************************************************************12250033
122600* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *12260033
122700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *12270033
122800******************************************************************12280033
122900 2310-GET-PREV-RECORD.                                            12290033
123000                                                                  12300033
123100     SUBTRACT +1 FROM ASC-SEL-SUB.                                12310033
123200                                                                  12320033
123300     IF ASC-SEL-SUB < +1                                          12330033
123400         SUBTRACT +1 FROM ASC-SEL-ITEM                            12340033
123500         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   12350033
123600     END-IF.                                                      12360033
123700                                                                  12370033
123800     IF ASC-SEL-ITEM > ZERO                                       12380033
123900         PERFORM 9100-READ-SEL-QUEUE                              12390033
124000         PERFORM 2320-LOAD-ASC-FROM-RC013                         12400033
124100     ELSE                                                         12410033
124200         MOVE +1                 TO ASC-SEL-ITEM                  12420033
124300                                    ASC-SEL-SUB                   12430033
124400*        --- TOP OF LIST ---                                      12440033
124500         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              12450033
124600         SET DP020-MSG-INFORMATIONAL                              12460033
124700                                 TO TRUE                          12470033
124800     END-IF.                                                      12480033
124900 2320-LOAD-ASC-FROM-RC013.                                        12490033
125000     MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                         12500033
125100                                 TO ASC-KEY-REC-SEQ-NBR-N         12510033
125200                                    DK-REC-SEQ-NBR                12520033
125300                                    RC015-REC-SEQ-NBR             12530033
125400     MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                         12540033
125500                                 TO ASC-KEY-OPER-UNT-ID           12550033
125600                                    RC015-OPER-UNT-ID             12560033
125700     MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                            12570033
125800                                 TO ASC-KEY-FCLTY-ID              12580033
125900                                    RC015-FCLTY-ID                12590033
126000     MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                        12600033
126100                                 TO ASC-KEY-PKSL-LNE-NBR          12610033
126200                                    DK-PKSL-LNE-NBR               12620033
126300                                    RC015-PKSL-LNE-NBR            12630033
126400     MOVE RC013-TRIP-ID  (ASC-SEL-SUB)                            12640033
126500                                 TO ASC-KEY-CYC-NBR               12650033
126600                                    DK-CYC-NBR                    12660033
126700                                    RC015-ADJ-CYC-NBR             12670033
126800     MOVE RC013-ARRIVAL-DTE (ASC-SEL-SUB)                         12680033
126900                                 TO ASC-KEY-ADJ-DATE.             12690033
127000/                                                                 12700033
127100 3000-EDIT-DATA-IN-COMMAREA.                                      12710033
127200                                                                  12720033
127300     SET PS-NO-ERROR             TO TRUE.                         12730033
127400                                                                  12740033
127500     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       12750033
127600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       12760033
127700                                          ASC-ITEMS-DISPLAYED - 1.12770033
127800     PERFORM 3100-SET-SUBSCRIPTS.                                 12780033
127900                                                                  12790033
128000     PERFORM 3300-EDIT-SELECTIONS                                 12800033
128100             VARYING PV-SUB  FROM PV-SUB BY -1                    12810033
128200             UNTIL   PV-SUB < +1.                                 12820033
128300                                                                  12830033
128400     IF PS-NO-ERROR                                               12840033
128500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        12850033
128600     END-IF.                                                      12860033
128700                                                                  12870033
128800     IF PS-NO-ERROR AND                                           12880033
128900        ASC-START-OF-SELECTED-RANGE > ZERO AND                    12890033
129000        ASC-END-OF-SELECTED-RANGE > ZERO                          12900033
129100                                                                  12910033
129200         PERFORM 3500-MARK-RANGE-AS-SELECTED                      12920033
129300     END-IF.                                                      12930033
129400                                                                  12940033
129500                                                                  12950033
129600 3100-SET-SUBSCRIPTS.                                             12960033
129700                                                                  12970033
129800     COMPUTE ASC-ITEM-SUB =                                       12980033
129900                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.12990033
130000                                                                  13000033
130100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13010033
130200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13020033
130300         MOVE PC-MAX-BLOCKS-IN-ARRAY                              13030033
130400                                 TO ASC-BLK-SUB                   13040033
130500     ELSE                                                         13050033
130600         MOVE +1                 TO ASC-BLK-SUB                   13060033
130700     END-IF.                                                      13070033
130800                                                                  13080033
130900                                                                  13090033
131000 3200-RESET-ATTRIBUTES.                                           13100033
131100     PERFORM VARYING PV-SUB FROM 1 BY 1                           13110033
131200              UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                  13120033
131300         MOVE DP015-UNP-ALP-NOR-OFF                               13130033
131400                         TO MR-SELECTA           (PV-SUB)         13140033
131500         MOVE DP015-GREEN                                         13150033
131600                         TO MR-SELECTC           (PV-SUB)         13160033
131700         MOVE DP015-UNDERLINE                                     13170033
131800                         TO MR-SELECTH           (PV-SUB)         13180033
131900     END-PERFORM.                                                 13190033
132000 3300-EDIT-SELECTIONS.                                            13200033
132100                                                                  13210033
132200     EVALUATE TRUE                                                13220033
132300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   13230033
132400                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     13240033
132500              CONTINUE                                            13250033
132600                                                                  13260033
132700         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        13270033
132800              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        13280033
132900                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  13290033
133000                  MOVE ASC-TEMP-SELECTED-SW                       13300033
133100                                        (ASC-BLK-SUB ASC-ITEM-SUB)13310033
133200                                 TO ASC-SELECTED-SW               13320033
133300                                        (ASC-BLK-SUB ASC-ITEM-SUB)13330033
133400              END-IF                                              13340033
133500                                                                  13350033
133600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   13360033
133700                                                             SPACE13370033
133800              EVALUATE TRUE                                       13380033
133900                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     13390033
134000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS13400033
134100                     MOVE SPACE  TO ASC-SELECTED-SW               13410033
134200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     13420033
134300                                                                  13430033
134400                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     13440033
134500                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   13450033
134600                       MOVE SPACE                                 13460033
134700                                 TO ASC-SELECTED-SW               13470033
134800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     13480033
134900                                                                  13490033
135000                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     13500033
135100                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     13510033
135200                       MOVE SPACE                                 13520033
135300                                 TO ASC-SELECTED-SW               13530033
135400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     13540033
135500             END-EVALUATE                                         13550033
135600                                                                  13560033
135700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           13570033
135800              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           13580033
135900                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   13590033
136000              END-IF                                              13600033
136100                                                                  13610033
136200              PERFORM 3310-EDIT-RANGE                             13620033
136300                                                                  13630033
136400         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            13640033
136500              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13650033
136600                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   13660033
136700              END-IF                                              13670033
136800                                                                  13680033
136900              PERFORM 3310-EDIT-RANGE                             13690033
137000                                                                  13700033
137100         WHEN OTHER                                               13710033
137200              MOVE PC-TSYMSG-00005                                13720033
137300                                 TO DP020-MSG-NUMBER              13730033
137400              SET PS-ERROR                                        13740033
137500                  DP020-MSG-FATAL                                 13750033
137600                  DP030-SET-CURSOR-APPL-1                         13760033
137700                                 TO TRUE                          13770033
137800              MOVE -1            TO MR-SELECTL (PV-SUB)           13780033
137900              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           13790033
138000              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           13800033
138100              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13810033
138200                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    13820033
138300                  MOVE SPACE     TO ASC-SELECTED-SW               13830033
138400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     13840033
138500              END-IF                                              13850033
138600     END-EVALUATE.                                                13860033
138700                                                                  13870033
138800     SUBTRACT +1 FROM PV-ITEM-IN-USE                              13880033
138900                      ASC-ITEM-SUB.                               13890033
139000                                                                  13900033
139100     IF ASC-ITEM-SUB < 1                                          13910033
139200         SUBTRACT +1 FROM ASC-BLK-SUB                             13920033
139300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  13930033
139400     END-IF.                                                      13940033
139500                                                                  13950033
139600 3310-EDIT-RANGE.                                                 13960033
139700                                                                  13970033
139800     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 13980033
139900        IF ASC-START-OF-SELECTED-RANGE = ZERO                     13990033
140000            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  14000033
140100                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  14010033
140200            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   14020033
140300        ELSE                                                      14030033
140400            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       14040033
140500                CONTINUE                                          14050033
140600            ELSE                                                  14060033
140700                MOVE PC-TSYMSG-00054                              14070033
140800                                 TO DP020-MSG-NUMBER              14080033
140900                SET DP020-MSG-FATAL                               14090033
141000                    PS-ERROR                                      14100033
141100                    DP030-SET-CURSOR-APPL-1                       14110033
141200                                 TO TRUE                          14120033
141300                MOVE -1          TO MR-SELECTL (PV-SUB)           14130033
141400                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           14140033
141500                MOVE DP015-UNDERLINE                              14150033
141600                                 TO MR-SELECTH (PV-SUB)           14160033
141700            END-IF                                                14170033
141800        END-IF                                                    14180033
141900     ELSE                                                         14190033
142000         IF ASC-END-OF-SELECTED-RANGE = ZERO                      14200033
142100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 14210033
142200                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 14220033
142300             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     14230033
142400         ELSE                                                     14240033
142500             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        14250033
142600                 CONTINUE                                         14260033
142700             ELSE                                                 14270033
142800                MOVE PC-TSYMSG-00055                              14280033
142900                                 TO DP020-MSG-NUMBER              14290033
143000                SET DP020-MSG-FATAL                               14300033
143100                    PS-ERROR                                      14310033
143200                    DP030-SET-CURSOR-APPL-1                       14320033
143300                                 TO TRUE                          14330033
143400                MOVE -1          TO MR-SELECTL (PV-SUB)           14340033
143500             END-IF                                               14350033
143600         END-IF                                                   14360033
143700     END-IF.                                                      14370033
143800                                                                  14380033
143900 3400-CHECK-RANGE-SEQUENCE.                                       14390033
144000                                                                  14400033
144100     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    14410033
144200        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    14420033
144300        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   14430033
144400         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              14440033
144500         SET PS-ERROR                                             14450033
144600             DP020-MSG-FATAL     TO TRUE                          14460033
144700                                                                  14470033
144800         PERFORM 3410-POSITION-AT-ERROR                           14480033
144900     END-IF.                                                      14490033
145000                                                                  14500033
145100 3410-POSITION-AT-ERROR.                                          14510033
145200                                                                  14520033
145300     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         14530033
145400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               14540033
145500                                                  PV-TOP-ITEM + 1.14550033
145600     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       14560033
145700         CONTINUE                                                 14570033
145800     ELSE                                                         14580033
145900         MOVE -1                 TO MR-SELECTL (PV-SUB)           14590033
146000         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           14600033
146100         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           14610033
146200     END-IF.                                                      14620033
146300                                                                  14630033
146400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.14640033
146500     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       14650033
146600         CONTINUE                                                 14660033
146700     ELSE                                                         14670033
146800         MOVE -1                 TO MR-SELECTL (PV-SUB)           14680033
146900         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           14690033
147000         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           14700033
147100     END-IF.                                                      14710033
147200                                                                  14720033
147300 3500-MARK-RANGE-AS-SELECTED.                                     14730033
147400                                                                  14740033
147500     MOVE +1                     TO ASC-BLK-SUB.                  14750033
147600                                                                  14760033
147700     PERFORM 3510-MARK-SELECTED-INDS                              14770033
147800             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    14780033
147900             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14790033
148000                                                                  14800033
148100     ADD +1                      TO ASC-BLK-SUB.                  14810033
148200                                                                  14820033
148300     PERFORM 3510-MARK-SELECTED-INDS                              14830033
148400             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    14840033
148500             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14850033
148600                                                                  14860033
148700     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              14870033
148800                                 TO PV-LIST-ITEM-NUMBER.          14880033
148900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        14890033
149000                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).14900033
149100     MOVE ASC-START-OF-SELECTED-RANGE                             14910033
149200                                 TO PV-START-OF-SELECTED-RANGE.   14920033
149300     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        14930033
149400             ((PV-START-OF-SELECTED-RANGE - 1) /                  14940033
149500                                              PC-ITEMS-PER-PANEL).14950033
149600     MOVE ASC-END-OF-SELECTED-RANGE                               14960033
149700                                 TO PV-END-OF-SELECTED-RANGE.     14970033
149800     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         14980033
149900             ((PV-END-OF-SELECTED-RANGE - 1) /                    14990033
150000                                              PC-ITEMS-PER-PANEL).15000033
150100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.15010033
150200                                                                  15020033
150300     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    15030033
150400        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        15040033
150500         MOVE +1                 TO ASC-BLK-SUB                   15050033
150600                                                                  15060033
150700         PERFORM 5100-WRITE-TEMP-STORAGE                          15070033
150800                                                                  15080033
150900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15090033
151000                                       PV-FIRST-BLOCK-IN-ARRAY - 115100033
151100                                                                  15110033
151200         PERFORM                                                  15120033
151300           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 15130033
151400                 MOVE PV-FIRST-BLOCK-IN-RANGE                     15140033
151500                                 TO PV-BLOCK-NUMBER               15150033
151600                                                                  15160033
151700                 PERFORM 4410-READ-TEMP-STORAGE                   15170033
151800                                                                  15180033
151900                 PERFORM 3510-MARK-SELECTED-INDS                  15190033
152000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        15200033
152100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL15210033
152200                                                                  15220033
152300                 PERFORM 5100-WRITE-TEMP-STORAGE                  15230033
152400                                                                  15240033
152500                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       15250033
152600         END-PERFORM                                              15260033
152700                                                                  15270033
152800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15280033
152900                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY15290033
153000         PERFORM                                                  15300033
153100           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  15310033
153200                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      15320033
153300                                 TO PV-BLOCK-NUMBER               15330033
153400                                                                  15340033
153500                 PERFORM 4410-READ-TEMP-STORAGE                   15350033
153600                                                                  15360033
153700                 PERFORM 3510-MARK-SELECTED-INDS                  15370033
153800                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        15380033
153900                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL15390033
154000                                                                  15400033
154100                 PERFORM 5100-WRITE-TEMP-STORAGE                  15410033
154200                                                                  15420033
154300                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        15430033
154400         END-PERFORM                                              15440033
154500                                                                  15450033
154600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15460033
154700                                 TO PV-BLOCK-NUMBER               15470033
154800                                                                  15480033
154900         PERFORM 4410-READ-TEMP-STORAGE                           15490033
155000                                                                  15500033
155100     END-IF.                                                      15510033
155200                                                                  15520033
155300     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   15530033
155400                                    ASC-END-OF-SELECTED-RANGE.    15540033
155500                                                                  15550033
155600 3510-MARK-SELECTED-INDS.                                         15560033
155700                                                                  15570033
155800     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     15580033
155900                                       ASC-START-OF-SELECTED-RANGE15590033
156000        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  15600033
156100                                         ASC-END-OF-SELECTED-RANGE15610033
156200           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           15620033
156300               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          15630033
156400                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               15640033
156500                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     15650033
156600                                 TO TRUE                          15660033
156700               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  15670033
156800           END-IF                                                 15680033
156900        END-IF                                                    15690033
157000     END-IF.                                                      15700033
157100     EJECT                                                        15710033
157200 4000-BUILD-INITIAL-PANEL.                                        15720033
157300                                                                  15730033
157400     INITIALIZE ASC-BLOCK-ENTRIES (1)                             15740033
157500                ASC-BLOCK-ENTRIES (2).                            15750033
157600                                                                  15760033
157700     MOVE +1                     TO ASC-BLK-SUB.                  15770033
157800                                                                  15780033
157900     MOVE ZERO                   TO ASC-ITEM-SUB                  15790033
158000                                    ASC-NUMBER-OF-ITEMS-READ      15800033
158100                                    ASC-NUMBER-OF-SELECTED-ITEMS  15810033
158200                                    ASC-HIGHEST-BLOCK-WRITTEN     15820033
158300                                    ASC-START-OF-SELECTED-RANGE   15830033
158400                                    ASC-END-OF-SELECTED-RANGE     15840033
158500                                    ASC-ITEM-AT-TOP-OF-PANEL      15850033
158600                                                                  15860033
158700     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    15870033
158800     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               15880033
158900     MOVE ASC-KEY-CYC-NBR        TO DK-CYC-NBR                    15890033
159000                                                                  15900033
159100     PERFORM 4010-SCREEN-HEADER.                                  15910033
159200                                                                  15920033
159300     PERFORM 7100-OPEN-CURSOR.                                    15930033
159400     PERFORM 7110-FETCH-AURECD                                    15940033
159500                                                                  15950033
159600     IF ASC-ITEMS-LEFT-ON-DB                                      15960033
159700         MOVE AURECD-ORD-LNE-NBR TO PV-AURECD-LNE-NBR             15970033
159800                                    DK-PKSL-LNE-NBR               15980033
159900         MOVE AURECD-NOTIF-NBR   TO PV-NOTIF-NBR                  15990033
160000         PERFORM 4042-LINE-INFO                                   16000033
160100     ELSE                                                         16010033
160200         MOVE PC-TSYMSG-00050    TO DP020-MSG-NUMBER              16020033
160300         SET DP020-MSG-FATAL                                      16030033
160400             DP020-NEXT-ACT-APPL-ERROR                            16040033
160500             PS-ERROR            TO TRUE                          16050033
160600         GO TO 4000-EXIT                                          16060033
160700     END-IF                                                       16070033
160800                                                                  16080033
160900     PERFORM 4040-PROCESS-CURSOR                                  16090033
161000         VARYING PV-READ-COUNT  FROM 1 BY 1                       16100033
161100         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    16110033
161200             ASC-NO-ITEMS-LEFT-ON-DB                              16120033
161300                                                                  16130033
161400     PERFORM 4043-MOVE-QTYS                                       16140033
161500                                                                  16150033
161600     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           16160033
161700         MOVE +1                 TO ASC-BLK-SUB                   16170033
161800         PERFORM 5100-WRITE-TEMP-STORAGE                          16180033
161900         ADD +1                  TO ASC-BLK-SUB                   16190033
162000         PERFORM 5100-WRITE-TEMP-STORAGE                          16200033
162100         MOVE +1                 TO ASC-BLK-SUB                   16210033
162200                                    PV-BLOCK-NUMBER               16220033
162300         PERFORM 4410-READ-TEMP-STORAGE                           16230033
162400         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         16240033
162500             MOVE +2             TO ASC-BLK-SUB                   16250033
162600                                    PV-BLOCK-NUMBER               16260033
162700             PERFORM 4410-READ-TEMP-STORAGE                       16270033
162800         END-IF                                                   16280033
162900     END-IF.                                                      16290033
163000                                                                  16300033
163100     PERFORM 7120-CLOSE-CURSOR.                                   16310033
163200                                                                  16320033
163300     MOVE +1                     TO PV-TOP-ITEM.                  16330033
163400     MOVE -1                     TO MR-SELECTL (1)                16340033
163500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16350033
163600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16360033
163700     PERFORM 3200-RESET-ATTRIBUTES.                               16370033
163800                                                                  16380033
163900 4000-EXIT.                                                       16390033
164000     EXIT.                                                        16400033
164100                                                                  16410033
164200 4010-SCREEN-HEADER.                                              16420033
164300     PERFORM 7000-GET-PO-INFO.                                    16430033
164400     PERFORM 7040-GET-FACILITY-DESC.                              16440033
164500/                                                                 16450033
164600 4040-PROCESS-CURSOR.                                             16460033
164700                                                                  16470033
164800     IF AURECD-ORD-LNE-NBR = PV-AURECD-LNE-NBR                    16480033
164900         PERFORM 4041-CALC-NET-CHANGES                            16490033
165000     ELSE                                                         16500033
165100         PERFORM 4043-MOVE-QTYS                                   16510033
165200         MOVE AURECD-ORD-LNE-NBR TO PV-AURECD-LNE-NBR             16520033
165300                                    DK-PKSL-LNE-NBR               16530033
165400         MOVE AURECD-NOTIF-NBR   TO PV-NOTIF-NBR                  16540033
165500         PERFORM 4042-LINE-INFO                                   16550033
165600         PERFORM 4041-CALC-NET-CHANGES                            16560033
165700     END-IF.                                                      16570033
165800                                                                  16580033
165900     PERFORM 7110-FETCH-AURECD.                                   16590033
166000                                                                  16600033
166100 4041-CALC-NET-CHANGES.                                           16610033
166200     EVALUATE AURECD-AUD-TYP-CDE                                  16620033
166300     WHEN 'A'                                                     16630033
166400         ADD AURECD-AP-VERIFY-ITM-QTY TO PV-SUM-UNIT-QTY          16640033
166500     WHEN 'B'                                                     16650033
166600         SUBTRACT AURECD-AP-VERIFY-ITM-QTY                        16660033
166700                                   FROM PV-SUM-UNIT-QTY           16670033
166800     END-EVALUATE.                                                16680033
166900                                                                  16690033
167000*----------------------------------------------------------------*16700033
167100*                                               **   WR # 21361  *16710039
167200* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *16720033
167300* ADDED CODE TO INCLUDE XLKUT001 LOGIC.                          *16730033
167400*----------------------------------------------------------------*16740033
167500 4042-LINE-INFO.                                                  16750033
167600     PERFORM 4800-INCR-ASC-COMM-AREA                              16760033
167700     PERFORM 7010-PURITM-DETAIL-DATA                              16770033
167800                                                                  16780033
167900         IF PURITM-ITM-NBR < 0                                    16790033
168000            MOVE '4042-LINE-INFO'                                 16800039
168100                             TO DP013-PARAGRAPH                   16810033
168200            MOVE 'PURITM-ITM-NBR < 0     '                        16820037
168300                             TO DP013-MESSAGE-TEXT (1)            16830033
168400            MOVE SQLCA       TO DP013-SQLCA                       16840033
168500            MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)          16850033
168600            SET DP013-DB2-ABEND                                   16860033
168700                DP013-XCTL-DISPLAY-RESTART                        16870033
168800                             TO TRUE                              16880033
168900            PERFORM DP013-0000-PROCESS-ABEND                      16890033
169000         END-IF                                                   16900033
169100                                                                  16910033
169200         IF PURITM-ITM-NBR = 0                                    16920033
169300            IF PURITM-SKU-SEQ-NBR = PC-000                        16930033
169400               MOVE '00000000' TO PV-SN-SEQ-NBR                   16940033
169500            ELSE                                                  16950033
169600               IF PURITM-SKU-SEQ-NBR = PC-999                     16960033
169700                  MOVE '99999999' TO PV-SN-SEQ-NBR                16970033
169800               ELSE                                               16980033
169900                  MOVE '4042-LINE-INFO'                           16990039
170000                               TO DP013-PARAGRAPH                 17000033
170100                  MOVE 'PURITM-ITM-NBR = 0     '                  17010037
170200                               TO DP013-MESSAGE-TEXT (1)          17020033
170300                  MOVE SQLCA      TO DP013-SQLCA                  17030033
170400                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     17040033
170500                  SET DP013-DB2-ABEND                             17050033
170600                      DP013-XCTL-DISPLAY-RESTART                  17060033
170700                               TO TRUE                            17070033
170800                  PERFORM DP013-0000-PROCESS-ABEND                17080033
170900               END-IF                                             17090033
171000            END-IF                                                17100033
171100         END-IF                                                   17110033
171200                                                                  17120033
171300         IF PURITM-ITM-NBR > 0 AND                                17130033
171400            PS-CALL-API-YES    AND                                17140033
171500            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                17150033
171600            (PURITM-SKU-SEQ-NBR NOT = PC-999))                    17160033
171700                                                                  17170033
171800            INITIALIZE XL001-ITEM-COMMAREA                        17180033
171900            MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR            17190033
172000                                                                  17200033
172100            SET  XL001-BY-ITEM                                    17210033
172200                 XL001-SELECT-SKU TO TRUE                         17220033
172300                                                                  17230033
172400            CALL XL001-VSM-PGM USING  DFHEIBLK                    17240033
172500                                      XL001-COMMAREA              17250033
172600                                      XL001-ITEM-COMMAREA         17260033
172700                                                                  17270033
172800            EVALUATE TRUE                                         17280033
172900                                                                  17290033
173000                WHEN XL001-SKU-SQLCODE = +0                       17300033
173100                      MOVE XL001-SKU-NBR                          17310033
173200                                       TO  PV-SN-SEQ-NBR          17320033
173300                                                                  17330033
173400                WHEN XL001-SKU-SQLCODE = +100                     17340033
173500                      MOVE SPACES      TO  PV-SN-SEQ-NBR          17350033
173600                                                                  17360033
173700                WHEN XL001-SKU-CONTENTION                         17370033
173800                      MOVE '4042-LINE-INFO'                       17380039
173900                                       TO DP013-PARAGRAPH         17390033
174000                      MOVE 'SKU CONTENTION'                       17400033
174100                                       TO DP013-MESSAGE-TEXT (1)  17410033
174200                      MOVE XL001-SQLCA TO DP013-SQLCA             17420033
174300                      MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)17430040
174400                      SET DP013-DB2-ABEND                         17440033
174500                                       TO TRUE                    17450033
174600                      PERFORM DP013-0000-PROCESS-ABEND            17460033
174700                                                                  17470033
174800                WHEN OTHER                                        17480033
174900                      MOVE '4042-LINE-INFO'                       17490039
175000                                       TO DP013-PARAGRAPH         17500033
175100                      MOVE 'INVALID RETURN'                       17510033
175200                                       TO DP013-MESSAGE-TEXT (1)  17520033
175300                      MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)17530040
175400                      MOVE XL001-SQLCA TO DP013-SQLCA             17540033
175500                      SET DP013-DB2-ABEND                         17550033
175600                                       TO TRUE                    17560033
175700                      PERFORM DP013-0000-PROCESS-ABEND            17570033
175800            END-EVALUATE                                          17580033
175900         END-IF                                                   17590033
176000                                                                  17600033
176100     MOVE AURECD-ORD-LNE-NBR     TO ASC-LINE-NBR                  17610033
176200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17620033
176300     MOVE PURCHS-DEPT-NBR                                         17630033
176400                                 TO PV-SN-DEPT-NBR                17640033
176500     MOVE PURITM-CL-NBR          TO PV-SN-CL-NBR                  17650033
176600     MOVE PV-SKU-NBR             TO ASC-SKU-NBR                   17660033
176700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17670035
176800     MOVE PV-SN-DEPT-NBR         TO ASC-DEPT-NBR.                 17680035
176900*----------------------------------------------------------------*17690033
177000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *17700039
177100*----------------------------------------------------------------*17710033
177200                                                                  17720033
177300 4043-MOVE-QTYS.                                                  17730033
177400     MOVE PV-NOTIF-NBR           TO ASC-NOTIF-NBR                 17740033
177500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17750033
177600     MOVE PV-SUM-UNIT-QTY        TO ASC-ADJ-QTY-N                 17760033
177700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17770033
177800     ADD PV-SUM-UNIT-QTY         TO PV-TOT-ADJ-QTY                17780033
177900     MOVE PV-TOT-ADJ-QTY         TO ASC-TOT-ADJUST-QTY            17790033
178000     MULTIPLY PV-SUM-UNIT-QTY BY PURITM-UNT-RTL-PR-AMT            17800033
178100                                 GIVING PV-ADJ-RETAIL-QTY         17810033
178200     MOVE PV-ADJ-RETAIL-QTY      TO ASC-ADJ-RETAIL-QTY-N          17820033
178300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17830033
178400     MULTIPLY PV-SUM-UNIT-QTY BY PURITM-UNT-COST-AMT              17840033
178500                                 GIVING PV-ADJ-COST               17850033
178600     MOVE PV-ADJ-COST            TO ASC-ADJ-COST-N                17860033
178700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17870033
178800     MOVE ZERO                   TO PV-SUM-UNIT-QTY               17880033
178900                                    PV-ADJ-RETAIL-QTY             17890033
179000                                    PV-ADJ-COST.                  17900033
179100 4400-MOVE-COMMAREA-TO-SCREEN.                                    17910033
179200                                                                  17920033
179300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         17930033
179400           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         17940033
179500           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            17950033
179600             MOVE +1             TO ASC-BLK-SUB                   17960033
179700                                                                  17970033
179800             PERFORM 5100-WRITE-TEMP-STORAGE                      17980033
179900                                                                  17990033
180000             ADD +1              TO ASC-BLK-SUB                   18000033
180100                                                                  18010033
180200             PERFORM 5100-WRITE-TEMP-STORAGE                      18020033
180300                                                                  18030033
180400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             18040033
180500                 GIVING PV-BLOCK-NUMBER                           18050033
180600                 REMAINDER PV-REMAINDER                           18060033
180700             IF PV-REMAINDER > ZERO                               18070033
180800                 ADD +1          TO PV-BLOCK-NUMBER               18080033
180900             END-IF                                               18090033
181000             MOVE +1             TO ASC-BLK-SUB                   18100033
181100                                                                  18110033
181200             PERFORM 4410-READ-TEMP-STORAGE                       18120033
181300                                                                  18130033
181400             ADD +1              TO ASC-BLK-SUB                   18140033
181500                                    PV-BLOCK-NUMBER               18150033
181600                                                                  18160033
181700             PERFORM 4410-READ-TEMP-STORAGE                       18170033
181800                                                                  18180033
181900     END-IF.                                                      18190033
182000                                                                  18200033
182100     MOVE +1                     TO ASC-BLK-SUB.                  18210033
182200     COMPUTE ASC-ITEM-SUB =                                       18220033
182300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              18230033
182400                       + PC-ITEMS-PER-PANEL).                     18240033
182500                                                                  18250033
182600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18260033
182700         ADD +1                  TO ASC-BLK-SUB                   18270033
182800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18280033
182900     END-IF.                                                      18290033
183000                                                                  18300033
183100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           18310033
183200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                18320033
183300                                                                  18330033
183400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        18340033
183500                                                                  18350033
183600     PERFORM 4420-FORMAT-LIST-LINES                               18360033
183700         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            18370033
183800         UNTIL   PV-SUB < +1.                                     18380033
183900                                                                  18390033
184000     COMPUTE ASC-ITEMS-DISPLAYED =                                18400033
184100                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).18410033
184200     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      18420033
184300                                    ASTRTITO.                     18430033
184400     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                18440033
184500                                 TO AENDITO.                      18450033
184600     MOVE ASC-NUMBER-OF-ITEMS-READ                                18460033
184700                                 TO ATOTITO.                      18470033
184800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            18480033
184900                                 TO ASELITO.                      18490033
185000                                                                  18500033
185100     MOVE PC-DASH                TO ASC-KEY-REC-DASH.             18510033
185200     MOVE ASC-KEY-RECEIVER       TO ARCVRO.                       18520033
185300     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       18530033
185400     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      18540033
185500     MOVE ASC-KEY-FCLTY-DESC     TO AFDESCO.                      18550033
185600     MOVE ASC-KEY-ADJ-DATE       TO ADATEO.                       18560033
185700                                                                  18570033
185800     MOVE ASC-DEPT-NBR           TO ADEPTO.                       18580033
185900                                                                  18590033
186000     MOVE ASC-TOT-ADJUST-QTY     TO AADJQTYO.                     18600033
186100                                                                  18610033
186200     IF DP020-MSG-NUMBER-X = SPACE                                18620033
186300        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    18630033
186400            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              18640033
186500            SET DP020-MSG-INFORMATIONAL                           18650033
186600                                 TO TRUE                          18660033
186700        END-IF                                                    18670033
186800     END-IF.                                                      18680033
186900                                                                  18690033
187000 4410-READ-TEMP-STORAGE.                                          18700033
187100                                                                  18710033
187200     EXEC CICS READQ TS                                           18720033
187300               QUEUE (ASC-LIST-QUEUE-NAME)                        18730033
187400               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            18740033
187500               ITEM  (PV-BLOCK-NUMBER)                            18750033
187600               RESP  (PV-CICS-RESP)                               18760033
187700     END-EXEC.                                                    18770033
187800                                                                  18780033
187900     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     18790033
188000         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      18800033
188100         CONTINUE                                                 18810033
188200     ELSE                                                         18820033
188300         SET DP013-CICS-ABEND                                     18830033
188400             DP013-NO-ROLLBACK   TO TRUE                          18840033
188500         MOVE '4410-READ-TEMP-STORAGE'                            18850033
188600                                 TO DP013-PARAGRAPH               18860033
188700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   18870033
188800                                 TO DP013-MESSAGE-TEXT (1)        18880033
188900                                                                  18890033
189000         PERFORM DP013-0000-PROCESS-ABEND                         18900033
189100     END-IF.                                                      18910033
189200                                                                  18920033
189300     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     18930033
189400                                 TO TRUE.                         18940033
189500                                                                  18950033
189600     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          18960033
189700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               18970033
189800     END-IF.                                                      18980033
189900                                                                  18990033
190000 4420-FORMAT-LIST-LINES.                                          19000033
190100                                                                  19010033
190200     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       19020033
190300* BLANK OUT UNUSED LINES FROM PREVIOUS SCREEN                     19030033
190400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                19040033
190500         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     19050033
190600         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     19060033
190700                                    MR-LINE          (PV-SUB)     19070033
190800                                    MR-SKU           (PV-SUB)     19080033
190900                                    MR-ADJ-QTY       (PV-SUB)     19090033
191000                                    MR-ADJ-RETAIL-QTY             19100033
191100                                                 (PV-SUB)         19110033
191200                                    MR-ADJ-COST-QTY               19120033
191300                                                 (PV-SUB)         19130033
191400     ELSE                                                         19140033
191500         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     19150033
191600                                                             SPACE19160033
191700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19170033
191800                                 TO MR-SELECTI (PV-SUB)           19180033
191900             MOVE PC-INQ         TO MR-ACTION        (PV-SUB)     19190033
192000         ELSE                                                     19200033
192100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      19210033
192200                                 TO MR-SELECTI (PV-SUB)           19220033
192300         END-IF                                                   19230033
192400                                                                  19240033
192500         IF DP030-SET-CURSOR-TRAILER                              19250033
192600            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  19260033
192700                                                             SPACE19270033
192800               OR PV-SUB = 1                                      19280033
192900                SET DP030-SET-CURSOR-APPL-1                       19290033
193000                                 TO TRUE                          19300033
193100                MOVE -1          TO MR-SELECTL (PV-SUB)           19310033
193200            END-IF                                                19320033
193300         END-IF                                                   19330033
193400                                                                  19340033
193500         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            19350033
193600             MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         19360033
193700                                 TO MR-LINE-NUMERIC (PV-SUB)      19370033
193800             MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          19380033
193900                                 TO MR-SKU (PV-SUB)               19390033
194000             MOVE ASC-ADJ-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)        19400033
194100                                 TO MR-ADJ-QTY-EDITED  (PV-SUB)   19410033
194200             MOVE ASC-ADJ-RETAIL-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB) 19420033
194300                                 TO MR-ADJ-RETAIL-QTY-EDITED      19430033
194400                                                 (PV-SUB)         19440033
194500             MOVE ASC-ADJ-COST-N (ASC-BLK-SUB ASC-ITEM-SUB)       19450033
194600                                 TO MR-ADJ-COST-QTY-EDITED        19460033
194700                                                 (PV-SUB)         19470033
194800                                                                  19480033
194900         END-IF                                                   19490033
195000     END-IF.                                                      19500033
195100                                                                  19510033
195200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19520033
195300                                                                  19530033
195400     IF ASC-ITEM-SUB < +1                                         19540033
195500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  19550033
195600         MOVE +1                 TO ASC-BLK-SUB.                  19560033
195700                                                                  19570033
195800 4430-CHECK-FOR-BEGIN-AND-END.                                    19580033
195900                                                                  19590033
196000     IF ASC-START-OF-SELECTED-RANGE > ZERO                        19600033
196100        IF ASC-END-OF-SELECTED-RANGE = ZERO                       19610033
196200            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              19620033
196300            SET DP020-MSG-WARNING                                 19630033
196400                                 TO TRUE                          19640033
196500                                                                  19650033
196600            PERFORM 4431-POSITION-AT-WARNING                      19660033
196700                                                                  19670033
196800         END-IF                                                   19680033
196900     ELSE                                                         19690033
197000         IF ASC-END-OF-SELECTED-RANGE > ZERO                      19700033
197100             MOVE PC-TSYMSG-00053                                 19710033
197200                                 TO DP020-MSG-NUMBER              19720033
197300             SET DP020-MSG-WARNING                                19730033
197400                                 TO TRUE                          19740033
197500                                                                  19750033
197600             PERFORM 4431-POSITION-AT-WARNING                     19760033
197700                                                                  19770033
197800         END-IF                                                   19780033
197900     END-IF.                                                      19790033
198000                                                                  19800033
198100 4431-POSITION-AT-WARNING.                                        19810033
198200                                                                  19820033
198300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               19830033
198400                                                  PV-TOP-ITEM + 1.19840033
198500     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       19850033
198600         CONTINUE                                                 19860033
198700     ELSE                                                         19870033
198800         SET DP030-SET-CURSOR-APPL-1                              19880033
198900                                 TO TRUE                          19890033
199000         MOVE -1                 TO MR-SELECTL (PV-SUB)           19900033
199100         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           19910033
199200         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           19920033
199300     END-IF.                                                      19930033
199400                                                                  19940033
199500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.19950033
199600                                                                  19960033
199700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       19970033
199800         CONTINUE                                                 19980033
199900     ELSE                                                         19990033
200000         SET DP030-SET-CURSOR-APPL-1                              20000033
200100                                 TO TRUE                          20010033
200200         MOVE -1                 TO MR-SELECTL (PV-SUB)           20020033
200300         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           20030033
200400         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           20040033
200500     END-IF.                                                      20050033
200600                                                                  20060033
200700 4800-INCR-ASC-COMM-AREA.                                         20070033
200800                                                                  20080033
200900     IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                         20090033
201000         ADD +1                  TO ASC-ITEM-SUB                  20100033
201100     ELSE                                                         20110033
201200         ADD +1                  TO ASC-BLK-SUB                   20120033
201300         MOVE +1                 TO ASC-ITEM-SUB                  20130033
201400                                                                  20140033
201500         IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                  20150033
201600             MOVE +1             TO ASC-BLK-SUB                   20160033
201700             SET ASC-BLOCK-MODIFIED (1)                           20170033
201800                                 TO TRUE                          20180033
201900                                                                  20190033
202000             PERFORM 5100-WRITE-TEMP-STORAGE                      20200033
202100                                                                  20210033
202200             MOVE ASC-BLOCK-ENTRIES       (PC-MAX-BLOCKS-IN-ARRAY)20220033
202300                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)20230033
202400             ADD +1              TO ASC-BLK-SUB                   20240033
202500             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           20250033
202600                 SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)         20260033
202700                                 TO TRUE                          20270033
202800             END-IF                                               20280033
202900         END-IF                                                   20290033
203000         ADD +1                  TO ASC-NUMBER-OF-ITEMS-READ      20300033
203100         MOVE ASC-NUMBER-OF-ITEMS-READ                            20310033
203200                                 TO ASC-LIST-ITEM-NUMBER          20320033
203300                                   (ASC-BLK-SUB ASC-ITEM-SUB).    20330033
203400                                                                  20340033
203500 5000-PREPARE-SEL-QUEUE.                                          20350033
203600                                                                  20360033
203700     MOVE +1                     TO ASC-BLK-SUB.                  20370033
203800     PERFORM 5100-WRITE-TEMP-STORAGE.                             20380033
203900     ADD +1                      TO ASC-BLK-SUB.                  20390033
204000     PERFORM 5100-WRITE-TEMP-STORAGE.                             20400033
204100                                                                  20410033
204200     PERFORM 5002-PREPARE-RC-QUEUE.                               20420033
204300                                                                  20430033
204400 5002-PREPARE-RC-QUEUE.                                           20440033
204500                                                                  20450033
204600     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         20460033
204700     PERFORM 6010-DELETE-SEL-QUEUE.                               20470033
204800                                                                  20480033
204900     SET ASC-UPDATE-TSQ          TO TRUE.                         20490033
205000     SET RC013-IDX               TO 1.                            20500033
205100     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     20510033
205200     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        20520033
205300                                                                  20530033
205400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           20540033
205500         VARYING PV-ITEM  FROM 1 BY 1                             20550033
205600         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                20560033
205700                                                                  20570033
205800     IF RC013-IDX > 1                                             20580033
205900         PERFORM 5205-WRITE-SEL-QUEUE                             20590033
206000         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      20600033
206100     END-IF.                                                      20610033
206200                                                                  20620033
206300 5100-WRITE-TEMP-STORAGE.                                         20630033
206400                                                                  20640033
206500     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    20650033
206600                                 TO PV-LIST-ITEM-NUMBER.          20660033
206700     COMPUTE PV-BLOCK-NUMBER = 1 +                                20670033
206800                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).20680033
206900                                                                  20690033
207000     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           20700033
207100        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       20710033
207200                                                                  20720033
207300            PERFORM 5105-REWRITE-ASC-LISTQ                        20730033
207400                                                                  20740033
207500        END-IF                                                    20750033
207600     ELSE                                                         20760033
207700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       20770033
207800                                     ASC-HIGHEST-BLOCK-WRITTEN + 120780033
207900         PERFORM 5110-WRITE-ASC-LISTQ                             20790033
208000                                                                  20800033
208100         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     20810033
208200     END-IF.                                                      20820033
208300                                                                  20830033
208400     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     20840033
208500                                 TO TRUE.                         20850033
208600                                                                  20860033
208700 5105-REWRITE-ASC-LISTQ.                                          20870033
208800                                                                  20880033
208900     EXEC CICS WRITEQ TS                                          20890033
209000               QUEUE   (ASC-LIST-QUEUE-NAME)                      20900033
209100               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           20910033
209200               ITEM    (PV-BLOCK-NUMBER)                          20920033
209300               REWRITE                                            20930033
209400               RESP    (PV-CICS-RESP)                             20940033
209500     END-EXEC.                                                    20950033
209600                                                                  20960033
209700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       20970033
209800         SET DP013-CICS-ABEND                                     20980033
209900             DP013-NO-ROLLBACK   TO TRUE                          20990033
210000         MOVE '5105-REWRITE-ASC-LISTQ'                            21000033
210100                                 TO DP013-PARAGRAPH               21010033
210200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'21020033
210300                                 TO DP013-MESSAGE-TEXT (1)        21030033
210400         PERFORM DP013-0000-PROCESS-ABEND                         21040033
210500     END-IF.                                                      21050033
210600                                                                  21060033
210700 5110-WRITE-ASC-LISTQ.                                            21070033
210800                                                                  21080033
210900     EXEC CICS WRITEQ TS                                          21090033
211000               QUEUE (ASC-LIST-QUEUE-NAME)                        21100033
211100               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            21110033
211200               ITEM  (PV-BLOCK-NUMBER)                            21120033
211300               RESP  (PV-CICS-RESP)                               21130033
211400     END-EXEC.                                                    21140033
211500                                                                  21150033
211600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      21160033
211700         SET DP013-CICS-ABEND                                     21170033
211800             DP013-NO-ROLLBACK   TO TRUE                          21180033
211900         MOVE '5110-WRITE-ASC-LISTQ'                              21190033
212000                                 TO DP013-PARAGRAPH               21200033
212100         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  21210033
212200                                 TO DP013-MESSAGE-TEXT (1)        21220033
212300         PERFORM DP013-0000-PROCESS-ABEND                         21230033
212400     END-IF.                                                      21240033
212500/                                                                 21250033
212600 5200-FILL-SEL-QUEUE-RECORD.                                      21260033
212700                                                                  21270033
212800     PERFORM 6112-READ-LIST-QUEUE.                                21280033
212900                                                                  21290033
213000     IF PV-CICS-RESP = DFHRESP (NORMAL)                           21300033
213100         PERFORM                                                  21310033
213200         VARYING LQW-IDX  FROM 1 BY 1                             21320033
213300         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  21330033
213400                     LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO        21340033
213500             IF LQW-SELECT (LQW-IDX)                              21350033
213600                 MOVE SPACE      TO RC013-ACTION-SW  (RC013-IDX)  21360033
213700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              21370033
213800                                   TO  RC013-ITEM (RC013-IDX)     21380033
213900                 MOVE LQW-LINE-NBR (LQW-IDX) TO                   21390033
214000                                  RC013-PKSL-LNE-NBR (RC013-IDX)  21400033
214100                 MOVE ASC-KEY-ADJ-DATE TO                         21410033
214200                                  RC013-ARRIVAL-DTE (RC013-IDX)   21420033
214300                 SET RC013-IDX UP BY 1                            21430033
214400                 IF RC013-IDX > RC013-MAX-ITEMS                   21440033
214500                                                                  21450033
214600                     PERFORM 5205-WRITE-SEL-QUEUE                 21460033
214700                                                                  21470033
214800                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      21480033
214900                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         21490033
215000                     SET RC013-IDX                                21500033
215100                                 TO 1                             21510033
215200                 END-IF                                           21520033
215300             END-IF                                               21530033
215400         END-PERFORM                                              21540033
215500     END-IF.                                                      21550033
215600                                                                  21560033
215700 5205-WRITE-SEL-QUEUE.                                            21570033
215800                                                                  21580033
215900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            21590033
216000                                 TO RC013-SELECTED-ITEMS.         21600033
216100                                                                  21610033
216200     EXEC CICS WRITEQ TS                                          21620033
216300               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     21630033
216400               FROM  (RC013-DC-SELECT-RECORD)                     21640033
216500               ITEM  (PV-SEL-QUEUE-ITEM)                          21650033
216600               RESP  (PV-CICS-RESP)                               21660033
216700     END-EXEC.                                                    21670033
216800                                                                  21680033
216900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       21690033
217000         SET DP013-CICS-ABEND                                     21700033
217100             DP013-NO-ROLLBACK   TO TRUE                          21710033
217200         MOVE '5205-WRITE-SEL-QUEUE'                              21720033
217300                                 TO DP013-PARAGRAPH               21730033
217400         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   21740033
217500                                 TO DP013-MESSAGE-TEXT (1)        21750033
217600         PERFORM DP013-0000-PROCESS-ABEND                         21760033
217700     END-IF.                                                      21770033
217800/                                                                 21780033
217900 6000-REFRESH-PANEL-FROM-TEMP.                                    21790033
218000                                                                  21800033
218100     IF ASC-UPDATE-TSQ                                            21810033
218200         SET ASC-NO-TSQ-UPDATE   TO TRUE                          21820033
218300         MOVE ZERO               TO PV-SAVE-ITEM                  21830033
218400                                    PV-SEL-QUEUE-ITEM             21840033
218500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        21850033
218600                                 TO PV-HOLD-SELECTED-ITEMS        21860033
218700         PERFORM 6100-UPDATE-TSQ                                  21870033
218800           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS21880033
218900                                                                  21890033
219000         PERFORM 6010-DELETE-SEL-QUEUE                            21900033
219100                                                                  21910033
219200         INITIALIZE ASC-BLOCK-ENTRIES (1)                         21920033
219300                    ASC-BLOCK-ENTRIES (2)                         21930033
219400                                                                  21940033
219500         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 21950033
219600                GIVING    PV-BLOCK-NUMBER                         21960033
219700                REMAINDER PV-REMAINDER                            21970033
219800                                                                  21980033
219900         IF PV-REMAINDER > ZERO                                   21990033
220000             ADD +1              TO PV-BLOCK-NUMBER               22000033
220100         END-IF                                                   22010033
220200                                                                  22020033
220300         MOVE +1                 TO ASC-BLK-SUB                   22030033
220400                                                                  22040033
220500         PERFORM 4410-READ-TEMP-STORAGE                           22050033
220600                                                                  22060033
220700         ADD +1                  TO ASC-BLK-SUB                   22070033
220800                            PV-BLOCK-NUMBER                       22080033
220900         PERFORM 4410-READ-TEMP-STORAGE                           22090033
221000                                                                  22100033
221100     END-IF.                                                      22110033
221200                                                                  22120033
221300 6010-DELETE-SEL-QUEUE.                                           22130033
221400                                                                  22140033
221500     EXEC CICS DELETEQ TS                                         22150033
221600               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     22160033
221700               RESP  (PV-CICS-RESP)                               22170033
221800     END-EXEC.                                                    22180033
221900                                                                  22190033
222000     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     22200033
222100         (PV-CICS-RESP = DFHRESP (QIDERR)))                       22210033
222200         CONTINUE                                                 22220033
222300     ELSE                                                         22230033
222400         SET DP013-CICS-ABEND                                     22240033
222500             DP013-NO-ROLLBACK   TO TRUE                          22250033
222600         MOVE '6010-DELETE-SEL-QUEUE'                             22260033
222700                                 TO DP013-PARAGRAPH               22270033
222800         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  22280033
222900                                 TO DP013-MESSAGE-TEXT (1)        22290033
223000         PERFORM DP013-0000-PROCESS-ABEND                         22300033
223100     END-IF.                                                      22310033
223200                                                                  22320033
223300 6100-UPDATE-TSQ.                                                 22330033
223400                                                                  22340033
223500     ADD 1                       TO PV-SEL-QUEUE-ITEM.            22350033
223600                                                                  22360033
223700     PERFORM 6105-READ-SEL-QUEUE.                                 22370033
223800                                                                  22380033
223900     PERFORM                                                      22390033
224000     VARYING RC013-IDX  FROM 1 BY 1                               22400033
224100     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       22410033
224200             RC013-IDX > RC013-MAX-ITEMS                          22420033
224300                                                                  22430033
224400         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   22440033
224500            PERFORM 6110-PROCESS-ITEMS                            22450033
224600            SET PS-WRITE-LIST-QUEUE                               22460033
224700                                 TO TRUE                          22470033
224800         END-IF                                                   22480033
224900                                                                  22490033
225000         ADD +1                  TO PV-ITEMS-PROCESSED            22500033
225100     END-PERFORM.                                                 22510033
225200                                                                  22520033
225300     IF PS-WRITE-LIST-QUEUE                                       22530033
225400         PERFORM 6111-WRITE-LIST-QUEUE                            22540033
225500     END-IF.                                                      22550033
225600                                                                  22560033
225700                                                                  22570033
225800 6105-READ-SEL-QUEUE.                                             22580033
225900                                                                  22590033
226000     EXEC CICS READQ TS                                           22600033
226100               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     22610033
226200               INTO  (RC013-DC-SELECT-RECORD)                     22620033
226300               ITEM  (PV-SEL-QUEUE-ITEM)                          22630033
226400               RESP  (PV-CICS-RESP)                               22640033
226500     END-EXEC.                                                    22650033
226600                                                                  22660033
226700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       22670033
226800         SET DP013-CICS-ABEND                                     22680033
226900             DP013-NO-ROLLBACK   TO TRUE                          22690033
227000         MOVE '6105-READ-SEL-QUEUE'                               22700033
227100                                 TO DP013-PARAGRAPH               22710033
227200         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    22720033
227300                                 TO DP013-MESSAGE-TEXT (1)        22730033
227400         PERFORM DP013-0000-PROCESS-ABEND                         22740033
227500     END-IF.                                                      22750033
227600                                                                  22760033
227700 6110-PROCESS-ITEMS.                                              22770033
227800                                                                  22780033
227900     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          22790033
228000                                            / PC-ITEMS-PER-PANEL).22800033
228100                                                                  22810033
228200     IF PV-ITEM NOT = PV-SAVE-ITEM                                22820033
228300        IF PV-SAVE-ITEM NOT = ZERO                                22830033
228400                                                                  22840033
228500            PERFORM 6111-WRITE-LIST-QUEUE                         22850033
228600                                                                  22860033
228700        END-IF                                                    22870033
228800        MOVE PV-ITEM             TO PV-SAVE-ITEM                  22880033
228900                                                                  22890033
229000        PERFORM 6112-READ-LIST-QUEUE                              22900033
229100                                                                  22910033
229200     END-IF.                                                      22920033
229300                                                                  22930033
229400     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   22940033
229500                                    LQW-LIST-ITEM-NUMBER (1)) + 1.22950033
229600     SET LQW-DESELECT (PV-SUB)   TO TRUE                          22960033
229700     MOVE LQW-SELECTED-SW (PV-SUB)                                22970033
229800                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).22980033
229900                                                                  22990033
230000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                23000033
230100                                                                  23010033
230200 6111-WRITE-LIST-QUEUE.                                           23020033
230300                                                                  23030033
230400     EXEC CICS WRITEQ TS                                          23040033
230500               QUEUE (ASC-LIST-QUEUE-NAME)                        23050033
230600               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   23060033
230700               ITEM  (PV-SAVE-ITEM)                               23070033
230800               REWRITE                                            23080033
230900               RESP  (PV-CICS-RESP)                               23090033
231000     END-EXEC.                                                    23100033
231100                                                                  23110033
231200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       23120033
231300         SET DP013-CICS-ABEND                                     23130033
231400             DP013-NO-ROLLBACK   TO TRUE                          23140033
231500         MOVE '6111-WRITE-LIST-QUEUE'                             23150033
231600                                 TO DP013-PARAGRAPH               23160033
231700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'23170033
231800                                 TO DP013-MESSAGE-TEXT(1)         23180033
231900         PERFORM DP013-0000-PROCESS-ABEND                         23190033
232000     END-IF.                                                      23200033
232100                                                                  23210033
232200 6112-READ-LIST-QUEUE.                                            23220033
232300                                                                  23230033
232400     EXEC CICS READQ TS                                           23240033
232500               QUEUE (ASC-LIST-QUEUE-NAME)                        23250033
232600               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   23260033
232700               ITEM  (PV-ITEM)                                    23270033
232800               RESP  (PV-CICS-RESP)                               23280033
232900     END-EXEC.                                                    23290033
233000                                                                  23300033
233100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       23310033
233200         SET DP013-CICS-ABEND                                     23320033
233300             DP013-NO-ROLLBACK   TO TRUE                          23330033
233400         MOVE '6112-READ-LIST-QUEUE'                              23340033
233500                                 TO DP013-PARAGRAPH               23350033
233600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   23360033
233700                                 TO DP013-MESSAGE-TEXT(1)         23370033
233800         PERFORM DP013-0000-PROCESS-ABEND                         23380033
233900     END-IF.                                                      23390033
234000                                                                  23400033
234100******************************************************************23410033
234200* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *23420033
234300******************************************************************23430033
234400 6200-DEL-LIST-QUEUE.                                             23440033
234500                                                                  23450033
234600     EXEC CICS                                                    23460033
234700         DELETEQ TS                                               23470033
234800             QUEUE (ASC-LIST-QUEUE-NAME)                          23480033
234900             RESP  (PV-CICS-RESP)                                 23490033
235000     END-EXEC.                                                    23500033
235100                                                                  23510033
235200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      23520033
235300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         23530033
235400         CONTINUE                                                 23540033
235500     ELSE                                                         23550033
235600        SET DP013-CICS-ABEND     TO TRUE                          23560033
235700        SET DP013-NO-ROLLBACK    TO TRUE                          23570033
235800        MOVE '6200-DEL-LIST-QUEUE'                                23580033
235900                                 TO DP013-PARAGRAPH               23590033
236000        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               23600033
236100                                 TO DP013-MESSAGE-TEXT (1)        23610033
236200        PERFORM DP013-0000-PROCESS-ABEND                          23620033
236300     END-IF.                                                      23630033
236400/                                                                 23640033
236500 7000-GET-PO-INFO.                                                23650033
236600                                                                  23660033
236700     EXEC SQL                                                     23670033
236800          SELECT A.DEPT_NBR                                       23680033
236900            INTO :PURCHS-DEPT-NBR                                 23690033
237000            FROM TPURCHS A                                        23700033
237100           WHERE A.VER_STATUS_CDE = :PC-A                         23710033
237200             AND A.PO_NBR             = :DK-PO-NBR                23720033
237300     END-EXEC                                                     23730033
237400                                                                  23740033
237500     EVALUATE TRUE                                                23750033
237600         WHEN SQLCODE = ZERO                                      23760033
237700             CONTINUE                                             23770033
237800         WHEN SQLCODE = +100                                      23780033
237900            MOVE  SPACES TO PURCHS-DEPT-NBR                       23790033
238000         WHEN SQLCODE = -904                                      23800033
238100         WHEN SQLCODE = -911                                      23810033
238200         WHEN SQLCODE = -913                                      23820033
238300             PERFORM 9900-SOFT-ABORT                              23830033
238400         WHEN SQLWARN0 NOT = SPACES                               23840033
238500         WHEN SQLCODE      NOT = ZERO                             23850033
238600             MOVE '7000-GET-PO-INFO'                              23860033
238700                             TO DP013-PARAGRAPH                   23870033
238800             MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'            23880033
238900                             TO DP013-MESSAGE-TEXT (1)            23890033
239000             MOVE SQLCA         TO DP013-SQLCA                    23900033
239100             MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)           23910033
239200             SET DP013-DB2-ABEND                                  23920033
239300                  DP013-XCTL-DISPLAY-RESTART                      23930033
239400                             TO TRUE                              23940033
239500             PERFORM DP013-0000-PROCESS-ABEND                     23950033
239600     END-EVALUATE.                                                23960033
239700/                                                                 23970033
239800 7010-PURITM-DETAIL-DATA.                                         23980033
239900                                                                  23990033
240000*----------------------------------------------------------------*24000033
240100* INCLUDED FETCH TO ITEM_NBR.                     WR # 21361     *24010039
240200* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *24020033
240300* TO TRUE.                                                       *24030033
240400*----------------------------------------------------------------*24040033
240500                                                                  24050033
240600     SET PS-CALL-API-NO      TO TRUE                              24060033
240700                                                                  24070033
240800     EXEC SQL                                                     24080033
240900           SELECT A.CL_NBR                                        24090033
241000                , A.SKU_SEQ_NBR                                   24100033
241100                , A.UNT_RTL_PR_AMT                                24110033
241200                , A.UNT_COST_AMT                                  24120033
241300                , A.ITM_NBR                                       24130033
241400             INTO :PURITM-CL-NBR                                  24140033
241500                , :PURITM-SKU-SEQ-NBR                             24150033
241600                , :PURITM-UNT-RTL-PR-AMT                          24160033
241700                , :PURITM-UNT-COST-AMT                            24170033
241800                , :PURITM-ITM-NBR                                 24180033
241900             FROM TPURITM A                                       24190033
242000                , TRECITM B                                       24200033
242100            WHERE A.PO_NBR         = :DK-PO-NBR                   24210033
242200              AND A.PO_NBR         = B.ORD_NBR                    24220033
242300                                                                  24230033
242400              AND A.APP_PO_LNE_NBR = :DK-PKSL-LNE-NBR             24240033
242500              AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                24250033
242600                                                                  24260033
242700              AND B.REC_SEQ_NBR    = :AURECD-REC-SEQ-NBR          24270033
242800                                                                  24280033
242900              AND B.VER_STATUS_CDE = :PC-A                        24290033
243000              AND A.VER_NBR        = B.PO_VER_NBR                 24300033
243100     END-EXEC                                                     24310033
243200                                                                  24320033
243300     EVALUATE TRUE                                                24330033
243400         WHEN SQLCODE = ZERO                                      24340033
243500              SET PS-CALL-API-YES     TO TRUE                     24350033
243600                                                                  24360033
243700         WHEN SQLCODE = +100                                      24370033
243800              CONTINUE                                            24380033
243900     WHEN SQLCODE = -904                                          24390033
244000     WHEN SQLCODE = -911                                          24400033
244100     WHEN SQLCODE = -913                                          24410033
244200         PERFORM 9900-SOFT-ABORT                                  24420033
244300         WHEN SQLWARN0 NOT = SPACES                               24430033
244400         WHEN SQLCODE      NOT = ZERO                             24440033
244500              MOVE '7010-PURITM-DETAIL-DATA'                      24450033
244600                             TO DP013-PARAGRAPH                   24460033
244700              MOVE 'UNSUCCESSFUL SELECT OF PURITM'                24470033
244800                             TO DP013-MESSAGE-TEXT (1)            24480033
244900              MOVE SQLCA         TO DP013-SQLCA                   24490033
245000              MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)          24500033
245100              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (2)          24510033
245200              SET DP013-DB2-ABEND                                 24520033
245300                  DP013-XCTL-DISPLAY-RESTART                      24530033
245400                             TO TRUE                              24540033
245500                                                                  24550033
245600              PERFORM DP013-0000-PROCESS-ABEND                    24560033
245700     END-EVALUATE.                                                24570033
245800*----------------------------------------------------------------*24580033
245900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *24590039
246000*----------------------------------------------------------------*24600033
246100                                                                  24610042
246200*---------------------------------------------------------------- 24620042
246300 7040-GET-FACILITY-DESC.                                          24630033
246400                                                                  24640033
246500     INITIALIZE XL071-COMMAREA-REC.                               24650042
246600     MOVE ASC-KEY-OPER-UNT-ID    TO XL071-LOCATION-NUMBER.        24660042
246700                                                                  24670042
246800     CALL PC-LOCATION-MODULE  USING                               24680042
246900                                    DFHEIBLK                      24690042
247000                                    XL071-COMMAREA                24700042
247100                                    XL071-COMMAREA-REC.           24710042
247200     EVALUATE TRUE                                                24720042
247300         WHEN XL071-NO-ERRORS                                     24730042
247400             MOVE XL071-LOC-NM  TO  ASC-KEY-FCLTY-DESC            24740042
247500         WHEN XL071-LOC-NOT-FOUND                                 24750042
247600             MOVE SPACES        TO  ASC-KEY-FCLTY-DESC            24760042
247700         WHEN XL071-BAD-DB2-RETURN                                24770042
247800             MOVE '7040-GET-FACILITY-DESC'   TO DP013-PARAGRAPH   24780042
247900             MOVE 'SELECT FACILITY DESC' TO DP013-MESSAGE-TEXT (1)24790042
248000             MOVE SQLCA        TO DP013-SQLCA                     24800042
248100             MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)        24810042
248200             SET DP013-DB2-ABEND             TO TRUE              24820042
248300             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              24830042
248400             PERFORM DP013-0000-PROCESS-ABEND                     24840042
248500     END-EVALUATE.                                                24850042
248600                                                                  24860042
248700/                                                                 24870033
248800 7100-OPEN-CURSOR.                                                24880033
248900                                                                  24890033
249000     EXEC SQL                                                     24900033
249100          OPEN TAURECD-CURSOR                                     24910033
249200     END-EXEC                                                     24920033
249300                                                                  24930033
249400     EVALUATE TRUE                                                24940033
249500         WHEN SQLCODE = ZERO                                      24950033
249600              CONTINUE                                            24960033
249700         WHEN SQLCODE = -904                                      24970033
249800         WHEN SQLCODE = -911                                      24980033
249900         WHEN SQLCODE = -913                                      24990033
250000             PERFORM 9900-SOFT-ABORT                              25000033
250100         WHEN SQLWARN0 NOT = SPACES                               25010033
250200         WHEN SQLCODE      NOT = ZERO                             25020033
250300              MOVE '7100-OPEN-CURSOR'                             25030033
250400                             TO DP013-PARAGRAPH                   25040033
250500              MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'              25050033
250600                             TO DP013-MESSAGE-TEXT (1)            25060033
250700              MOVE SQLCA         TO DP013-SQLCA                   25070033
250800              MOVE 'TAURECD' TO DP013-DB2-TABLE-NAME (1)          25080033
250900              SET DP013-XCTL-DISPLAY-RESTART                      25090033
251000                  DP013-DB2-ABEND                                 25100033
251100                             TO TRUE                              25110033
251200                                                                  25120033
251300              PERFORM DP013-0000-PROCESS-ABEND                    25130033
251400     END-EVALUATE.                                                25140033
251500/                                                                 25150033
251600 7110-FETCH-AURECD.                                               25160033
251700                                                                  25170033
251800     EXEC SQL                                                     25180033
251900          FETCH  TAURECD-CURSOR                                   25190033
252000         INTO :AURECD-ORD-LNE-NBR                                 25200033
252100            , :AURECD-REC-SEQ-NBR                                 25210033
252200            , :AURECD-UPD-TMST                                    25220033
252300            , :AURECD-AUD-TYP-CDE                                 25230033
252400            , :AURECD-AP-VERIFY-ITM-QTY                           25240033
252500            , :AURECD-NOTIF-NBR                                   25250033
252600     END-EXEC.                                                    25260033
252700                                                                  25270033
252800     EVALUATE TRUE                                                25280033
252900         WHEN SQLCODE = ZERO                                      25290033
253000             SET ASC-ITEMS-LEFT-ON-DB TO TRUE                     25300033
253100         WHEN SQLCODE = +100                                      25310033
253200             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  25320033
253300         WHEN SQLCODE = -904                                      25330033
253400         WHEN SQLCODE = -911                                      25340033
253500         WHEN SQLCODE = -913                                      25350033
253600             PERFORM 9900-SOFT-ABORT                              25360033
253700         WHEN SQLWARN0 NOT = SPACES                               25370033
253800         WHEN SQLCODE  NOT = ZERO                                 25380033
253900              MOVE '7110-FETCH-AURECD'                            25390033
254000                                 TO DP013-PARAGRAPH               25400033
254100              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          25410033
254200                                 TO DP013-MESSAGE-TEXT (1)        25420033
254300              MOVE SQLCA         TO DP013-SQLCA                   25430033
254400              MOVE 'TAURECD'     TO DP013-DB2-TABLE-NAME (1)      25440033
254500              SET DP013-DB2-ABEND                                 25450033
254600                  DP013-XCTL-DISPLAY-RESTART                      25460033
254700                                 TO TRUE                          25470033
254800                                                                  25480033
254900              PERFORM DP013-0000-PROCESS-ABEND                    25490033
255000     END-EVALUATE.                                                25500033
255100/                                                                 25510033
255200 7120-CLOSE-CURSOR.                                               25520033
255300                                                                  25530033
255400     EXEC SQL                                                     25540033
255500          CLOSE TAURECD-CURSOR                                    25550033
255600     END-EXEC.                                                    25560033
255700                                                                  25570033
255800     EVALUATE TRUE                                                25580033
255900         WHEN SQLCODE = ZERO                                      25590033
256000              CONTINUE                                            25600033
256100         WHEN SQLCODE = -904                                      25610033
256200         WHEN SQLCODE = -911                                      25620033
256300         WHEN SQLCODE = -913                                      25630033
256400             PERFORM 9900-SOFT-ABORT                              25640033
256500         WHEN SQLWARN0 NOT = SPACES                               25650033
256600         WHEN SQLCODE  NOT = ZERO                                 25660033
256700              MOVE '7120-CLOSE-CURSOR'                            25670033
256800                                 TO DP013-PARAGRAPH               25680033
256900              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             25690033
257000                                 TO DP013-MESSAGE-TEXT (1)        25700033
257100              MOVE SQLCA         TO DP013-SQLCA                   25710033
257200              MOVE 'TAURECD '    TO DP013-DB2-TABLE-NAME (1)      25720033
257300              SET DP013-DB2-ABEND                                 25730033
257400                  DP013-XCTL-DISPLAY-RESTART                      25740033
257500                                 TO TRUE                          25750033
257600                                                                  25760033
257700              PERFORM DP013-0000-PROCESS-ABEND                    25770033
257800     END-EVALUATE.                                                25780033
257900/                                                                 25790033
258000******************************************************************25800033
258100* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *25810033
258200* OBJECT WAS UPDATED.                                            *25820033
258300******************************************************************25830033
258400 9000-UPDATE-SELECTION-QUEUE.                                     25840033
258500                                                                  25850033
258600     PERFORM 9100-READ-SEL-QUEUE                                  25860033
258700                                                                  25870033
258800     SET RC013-INQ (ASC-SEL-SUB) TO TRUE                          25880033
258900     PERFORM 9200-REWRITE-LIST-QUEUE.                             25890033
259000                                                                  25900033
259100/                                                                 25910033
259200******************************************************************25920033
259300* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *25930033
259400******************************************************************25940033
259500 9100-READ-SEL-QUEUE.                                             25950033
259600                                                                  25960033
259700     EXEC CICS                                                    25970033
259800         READQ TS                                                 25980033
259900             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        25990033
260000             INTO  (RC013-DC-SELECT-RECORD)                       26000033
260100             ITEM  (ASC-SEL-ITEM)                                 26010033
260200             RESP  (PV-CICS-RESP)                                 26020033
260300     END-EXEC.                                                    26030033
260400                                                                  26040033
260500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        26050033
260600         CONTINUE                                                 26060033
260700     ELSE                                                         26070033
260800         SET DP013-LOGIC-ABEND                                    26080033
260900             DP013-NO-ROLLBACK   TO TRUE                          26090033
261000         MOVE '9100-READ-SEL-QUEUE'                               26100033
261100                                 TO DP013-PARAGRAPH               26110033
261200         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    26120033
261300                                 TO DP013-MESSAGE-TEXT (1)        26130033
261400         PERFORM DP013-0000-PROCESS-ABEND                         26140033
261500     END-IF.                                                      26150033
261600                                                                  26160033
261700/                                                                 26170033
261800******************************************************************26180033
261900* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *26190033
262000******************************************************************26200033
262100 9200-REWRITE-LIST-QUEUE.                                         26210033
262200     EXEC CICS                                                    26220033
262300          WRITEQ TS                                               26230033
262400              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     26240033
262500              FROM    (RC013-DC-SELECT-RECORD)                    26250033
262600              ITEM    (ASC-SEL-ITEM)                              26260033
262700              RESP    (PV-CICS-RESP)                              26270033
262800              REWRITE                                             26280033
262900     END-EXEC.                                                    26290033
263000                                                                  26300033
263100     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    26310033
263200         SET DP013-CICS-ABEND                                     26320033
263300             DP013-NO-ROLLBACK   TO TRUE                          26330033
263400         MOVE '9200-REWRITE-LIST-QUEUE'                           26340033
263500                                 TO DP013-PARAGRAPH               26350033
263600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   26360033
263700                                 TO DP013-MESSAGE-TEXT (1)        26370033
263800         PERFORM DP013-0000-PROCESS-ABEND                         26380033
263900     END-IF.                                                      26390033
264000/                                                                 26400033
264100******************************************************************26410033
264200* READ AN ITEM FROM THE INPUT SELECTED WORK ORDER ITEMS          *26420033
264300* TEMP STORAGE QUEUE.                                            *26430033
264400******************************************************************26440033
264500 9300-READ-WO-SEL-QUEUE.                                          26450033
264600                                                                  26460033
264700     EXEC CICS                                                    26470033
264800         READQ TS                                                 26480033
264900             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        26490033
265000             INTO  (PC016-TS-SEL-REC)                             26500033
265100             ITEM  (ASC-SEL-ITEM)                                 26510033
265200             RESP  (PV-CICS-RESP)                                 26520033
265300     END-EXEC.                                                    26530033
265400                                                                  26540033
265500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        26550033
265600         CONTINUE                                                 26560033
265700     ELSE                                                         26570033
265800         SET DP013-LOGIC-ABEND                                    26580033
265900             DP013-NO-ROLLBACK   TO TRUE                          26590033
266000         MOVE '9300-READ-WO-SEL-QUEUE'                            26600033
266100                                 TO DP013-PARAGRAPH               26610033
266200         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    26620033
266300                                 TO DP013-MESSAGE-TEXT (1)        26630033
266400         MOVE ASC-SEL-QUEUE-NAME-IN TO MSG-QUEUE-NAME             26640033
266500         MOVE ASC-SEL-ITEM       TO MSG-SEL-ITEM                  26650033
266600         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        26660033
266700         MOVE PC000-PO-NBR-N     TO MSG1-PO-NBR                   26670033
266800         MOVE PC000-REC-SEQ-NBR-N                                 26680033
266900                                 TO MSG1-REC-SEQ-NBR-N            26690033
267000         MOVE PC000-OPERATING-UNIT-ID                             26700033
267100                                 TO MSG1-OPER-UNT-ID              26710033
267200         MOVE PC000-FACILITY-ID  TO MSG1-FACILITY-ID              26720033
267300         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        26730033
267400         PERFORM DP013-0000-PROCESS-ABEND                         26740033
267500     END-IF.                                                      26750033
267600                                                                  26760033
267700/                                                                 26770033
267800******************************************************************26780033
267900* UPDATE AN ITEM IN THE INPUT SELECTED WORK ORDER ITEMS          *26790033
268000* TEMP STORAGE QUEUE.                                            *26800033
268100******************************************************************26810033
268200 9400-REWRITE-WO-LIST-QUEUE.                                      26820033
268300     EXEC CICS                                                    26830033
268400          WRITEQ TS                                               26840033
268500              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     26850033
268600              FROM    (PC016-TS-SEL-REC)                          26860033
268700              ITEM    (ASC-SEL-ITEM)                              26870033
268800              RESP    (PV-CICS-RESP)                              26880033
268900              REWRITE                                             26890033
269000     END-EXEC.                                                    26900033
269100                                                                  26910033
269200     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    26920033
269300         SET DP013-CICS-ABEND                                     26930033
269400             DP013-NO-ROLLBACK   TO TRUE                          26940033
269500         MOVE '9400-REWRITE-WO-LIST-QUEUE'                        26950033
269600                                 TO DP013-PARAGRAPH               26960033
269700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   26970033
269800                                 TO DP013-MESSAGE-TEXT (1)        26980033
269900         PERFORM DP013-0000-PROCESS-ABEND                         26990033
270000     END-IF.                                                      27000033
270100/                                                                 27010033
270200******************************************************************27020033
270300*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *27030033
270400*    AND THE ERROR SWITCHES.                                     *27040033
270500******************************************************************27050033
270600 9900-SOFT-ABORT.                                                 27060033
270700     SET PS-ERROR         TO TRUE.                                27070033
270800     SET DP020-MSG-FATAL  TO TRUE.                                27080033
270900     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    27090033
271000     IF PS-NO-NEXT-SCREEN                                         27100033
271100        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     27110033
271200     END-IF.                                                      27120033
271300     IF SQLCODE = -913                                            27130033
271400        PERFORM 9901-ROLLBACK                                     27140033
271500     END-IF.                                                      27150033
271600     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          27160033
271700     PERFORM 0001-CALL-CICS-ARCH-API.                             27170033
271800                                                                  27180033
271900 9901-ROLLBACK.                                                   27190033
272000     EXEC CICS SYNCPOINT                                          27200033
272100          ROLLBACK                                                27210033
272200     END-EXEC.                                                    27220033
272300/                                                                 27230033
272400******************************************************************27240033
272500*    ABEND PROCESSING                                             27250033
272600******************************************************************27260033
272700     COPY DPPD013.                                                27270042
