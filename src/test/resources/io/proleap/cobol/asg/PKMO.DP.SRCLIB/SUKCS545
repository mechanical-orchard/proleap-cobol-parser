000100*-----------------------*                                         00010019
000200 IDENTIFICATION DIVISION.                                         00020019
000300*-----------------------*                                         00030019
000400 PROGRAM-ID.    SUKCS545.                                         00040019
000500 AUTHOR.        LYNN MCADAMS.                                     00050019
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060019
000700 DATE-WRITTEN.  MARCH, 2006.                                      00070019
000800 DATE-COMPILED.                                                   00080019
000900*---------------------------------------------------------------* 00090019
001000*    S545 - TRAILER SUMMARY LIST SCREEN                         * 00100019
001100* DIVIDE TOTAL NUMBER OF CARTONS BY 4, GIVING THE BREAKDOWN OF  * 00110099
001200* THE CARTONS FOR EACH 1/4 OF THE TRAILER - AS THEY WERE LOADED * 00120099
001300* ONTO THE TRAILER.                                             * 00130099
001400* COUNTS FOR EACH 1/4 FOR # CARTONS, # SKUS, # UNITS            * 00140099
001500* HARD/SOFT COLUMNS WILL = COLUMN TOTALS                        * 00150099
001600* 1/4 COUNTS (CARTON/UNIT/SKU) WILL TOTAL LINE TOTALS AT END    * 00160099
001700*---------------------------------------------------------------* 00170019
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00172099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00173099
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00174099
263968*---------------------------------------------------------------* 00175099
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00176099
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00177099
263968*---------------------------------------------------------------* 00178099
001800 ENVIRONMENT DIVISION.                                            00180019
001900 DATA DIVISION.                                                   00190019
002000                                                                  00200019
002100 WORKING-STORAGE SECTION.                                         00210019
002200 01  DK-DB2-KEYS.                                                 00220019
002300     05  DK-TRIP-OCRNC-ID               PIC S9(09) COMP.          00230022
002400                                                                  00240023
002500 01  PC-PROGRAM-CONSTANTS.                                        00250019
002600     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU545A  '.  00260020
002700     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM545'.   00270020
002800     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS545'.  00280019
002900     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00290019
003000     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00300019
003100     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00310019
003200     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00320019
003300     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +01          00330099
003400                                               COMP SYNC.         00340019
003500     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00350019
003600                                               COMP SYNC.         00360019
003700     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00370019
003800                                               COMP-3.            00380019
003900     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00390019
004000                                               COMP SYNC.         00400019
004100     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00410019
004200                                               COMP-3.            00420019
004300     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00430019
004400     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00440019
004500     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00450019
004600     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00460019
004700     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00470019
004800     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00480019
004900                                               COMP.              00490019
005000     05  PC-01                     PIC  X(02)  VALUE '01'.        00500099
005100     05  PC-A                      PIC  X(01)  VALUE 'A'.         00510019
005200*                                                                 00520019
005300     05  PC-LEAVE-SYSTEM-LENGTH    PIC S9(04)  VALUE +160         00530099
005400                                               COMP SYNC.         00540099
005500     05  PC-TRLR-SUMM-RPT-DESC     PIC  X(22)  VALUE              00550099
005600         'TRAILER SUMMARY REPORT'.                                00560099
005700     05  PC-TRLR-SUMM-RPT-PROC     PIC  X(07)  VALUE              00570099
005800         'SUK9751'.                                               00580099
005900     05  PC-TRLR-SUMM-RPT-JOB      PIC  X(07)  VALUE              00590099
006000         'SUK975 '.                                               00600099
006100*----------------------------------------------------------------*00610019
006200*  SYSTEM MESSAGES                                               *00620019
006300*----------------------------------------------------------------*00630019
006400*   00005 = INVALID VALUE                                        *00640019
006500*   00008 = MUST BE NUMERIC                                      *00650019
006600*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00660019
006700*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00670019
006800*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00680019
006900*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00690019
007000*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00700019
007100*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00710019
007200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00720019
007300*   00069 - TOP OF LIST                                          *00730019
007400*   00070 - BOTTOM OF LIST                                       *00740019
007500*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00750019
007600*   00279 - MORE ITEMS TO DISPLAY                                *00760099
007700*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00770019
007800*   00458 - REPORT REQUEST SUCCESSFULLY SUBMITTED                *00780099
007900*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *00790019
008000*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00800019
008100*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00810019
008200*   03495 = TRAILER SUMMARY NOT AVAILABLE                        *00820099
008300*   99901 = INVALID COMMAND WAS ENTERED                          *00830019
008400*----------------------------------------------------------------*00840019
008500     05  PC-TSYMSG-NUMBERS.                                       00850019
008600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00860019
008700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00870019
008800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00880019
008900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00890019
009000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00900019
009100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00910019
009200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00920019
009300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00930019
009400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00940019
009500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00950019
009600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00960019
009700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00970019
009800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00980019
009900         10  PC-TSYMSG-00458            PIC  9(05)  VALUE 00458.  00990099
010000         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01000019
010100         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01010019
010200         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01020019
010300         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01030019
010400         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01040019
010500         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01050019
010600         10  PC-TSYMSG-03495            PIC  9(05)  VALUE 03495.  01060099
010700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01070019
010800                                                                  01080099
010900 01  PS-PROGRAM-SWITCHES.                                         01090019
011000     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01100019
011100         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01110019
011200         88  PS-BLOCK-ERROR                         VALUE 'N'.    01120019
011300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01130019
011400         88  PS-NO-ERROR                            VALUE 'Y'.    01140019
011500         88  PS-ERROR                               VALUE 'N'.    01150019
011600     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01160019
011700         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01170019
011800         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01180019
011900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01190019
012000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01200019
012100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01210019
012200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01220019
012300         88  PS-DONE                                VALUE 'Y'.    01230019
012400         88  PS-NOT-DONE                            VALUE 'N'.    01240019
012500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01250019
012600         88  PS-LIST-END                            VALUE  'Y'.   01260019
012700         88  PS-NO-LIST-END                         VALUE  'N'.   01270019
012800     05  PS-DETAIL-CSR-SW               PIC X(01)   VALUE 'N'.    01280071
012900         88  PS-EOF-DETAIL-CSR-NO                   VALUE 'N'.    01290071
013000         88  PS-EOF-DETAIL-CSR-YES                  VALUE 'Y'.    01300071
013100     05  PS-REM-USED-SW                 PIC  X(01)  VALUE  'N'.   01310027
013200         88  PS-REM-USED-YES                        VALUE  'Y'.   01320027
013300         88  PS-REM-USED-NO                         VALUE  'N'.   01330027
013400     05  PS-ABEND-IND                   PIC X(01)   VALUE 'N'.    01340099
013500         88  PS-NO-ABEND-IN-PROGRESS                VALUE 'N'.    01350099
013600         88  PS-ABEND-IN-PROGRESS                   VALUE 'Y'.    01360099
013700     05  PS-INTERNAL-READER-ENQ-DEQ-IND                           01370099
013800                                     PIC X(01)   VALUE 'D'.       01380099
013900         88  PS-INTERNAL-READER-ENQUEUED         VALUE 'E'.       01390099
014000         88  PS-INTERNAL-READER-DEQUEUED         VALUE 'D'.       01400099
014100     05   PS-QUARTER-CHANGE-SW       PIC X(01)   VALUE 'N'.       01410099
014200         88  PS-QUARTER-CHANGE-YES               VALUE 'Y'.       01420099
014300         88  PS-QUARTER-CHANGE-NO                VALUE 'N'.       01430099
014400     05   PS-FIRST-RECORD-SW         PIC X(01)   VALUE 'Y'.       01440099
014500         88  PS-FIRST-RECORD-YES                 VALUE 'Y'.       01450099
014600         88  PS-FIRST-RECORD-NO                  VALUE 'N'.       01460099
014700*                                                                 01470019
014800 01  SE-SYSTEM-ERROR-MESSAGE.                                     01480099
014900     05  FILLER                      PIC X(43)   VALUE            01490099
015000         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.           01500099
015100     05  FILLER                      PIC X(33)   VALUE            01510099
015200         'PROGRAM RFKCS215       EIBRESP = '.                     01520099
015300     05  SE-CICS-RESPONSE            PIC 9(4)    VALUE ZERO.      01530099
015400     05  FILLER                      PIC X(5)    VALUE SPACE.     01540099
015500     05  FILLER                      PIC X(14)   VALUE            01550099
015600         'ATTEMPTING TO '.                                        01560099
015700     05  SE-ATTEMPTED-ACTION         PIC X(61)   VALUE SPACE.     01570099
015800                                                                  01580099
015900 01  PV-PROGRAM-VARIABLES.                                        01590019
016000     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01600019
016100                                                     COMP SYNC.   01610019
016200     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01620019
016300     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01630019
016400     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01640019
016500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01650019
016600                                        COMP SYNC.                01660019
016700     05  PV-SUB                         PIC S9(04)  VALUE +0      01670019
016800                                                    COMP SYNC.    01680099
016900                                                                  01690099
017000     05  PV-HARDLINE-UNITS      PIC S9(09) COMP VALUE ZEROS.      01700099
017100     05  PV-SOFTLINE-UNITS      PIC S9(09) COMP VALUE ZEROS.      01710099
017200     05  PV-HANG-UNITS          PIC S9(09) COMP VALUE ZEROS.      01720099
017300     05  PV-FOLD-UNITS          PIC S9(09) COMP VALUE ZEROS.      01730099
017400                                                                  01740099
017500     05  PV-TRIP-BEGIN-TMST     PIC  X(26)      VALUE SPACES.     01750099
017600     05  PV-TRIP-END-TMST       PIC  X(26)      VALUE SPACES.     01760099
017700     05  PV-QUARTER-BEGIN-TMST  PIC  X(26)      VALUE SPACES.     01770099
017800     05  PV-QUARTER-END-TMST    PIC  X(26)      VALUE SPACES.     01780099
017900                                                                  01790099
018000     05  PV-TOTAL-CARTONS               PIC  S9(4) COMP.          01800073
018100     05  PV-CRTN-CNT                    PIC  S9(4) COMP.          01810090
018200     05  PV-NUMBER                      PIC  S9(4) COMP.          01820090
018300                                                                  01830061
018400     05  PV-QUOTIENT                    PIC  9(04)  VALUE ZEROS.  01840027
018500     05  PV-CTN-REMAINDER               PIC S9(04)  VALUE +0      01850099
018600                                                    COMP SYNC.    01860019
018700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01870099
018800                                                    COMP SYNC.    01880099
018900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01890019
019000                                                    COMP-3.       01900019
019100     05  PV-ROWS-FETCHED-COUNT          PIC S9(09)  VALUE +0      01910099
019200                                                    COMP-3.       01920099
019300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01930019
019400                                                    COMP-3.       01940019
019500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01950019
019600                                                    COMP-3.       01960019
019700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01970019
019800                                                    COMP-3.       01980019
019900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01990019
020000                                                    COMP-3.       02000019
020100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02010019
020200                                                    COMP-3.       02020019
020300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02030019
020400                                                    COMP-3.       02040019
020500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02050019
020600                                                    COMP SYNC.    02060019
020700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02070019
020800                                                    COMP SYNC.    02080019
020900     05  PV-ITEM                        PIC S9(04)  VALUE +0      02090019
021000                                                    COMP SYNC.    02100019
021100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02110019
021200                                                    COMP SYNC.    02120019
021300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02130019
021400                                                    COMP SYNC.    02140019
021500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02150019
021600                                                    COMP SYNC.    02160019
021700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02170019
021800                                                    COMP SYNC.    02180019
021900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02190019
022000                                                    COMP SYNC.    02200019
022100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02210019
022200                                                    COMP SYNC.    02220019
022300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02230019
022400                                                    COMP SYNC.    02240019
022500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02250019
022600                                                    COMP SYNC.    02260019
022700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02270019
022800                                                    COMP SYNC.    02280019
022900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02290019
023000                                                    COMP SYNC.    02300019
023100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02310019
023200                                                    COMP SYNC.    02320019
023300     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02330019
023400                                                    COMP SYNC.    02340019
023500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02350019
023600                                                    COMP SYNC.    02360019
023700     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02370019
023800                                                    COMP.         02380019
023900     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02390019
024000                                                    COMP.         02400019
024100     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02410019
024200                                                    COMP.         02420019
024300     05  PV-SOFT-ABORT-MSG.                                       02430019
024400         10  FILLER            PIC X(12) VALUE ' SUKCS545 - '.    02440019
024500         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02450019
024600         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02460019
024700         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02470019
024800         10  PV-SOFT-PARAGRAPH PIC X(30).                         02480019
024900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02490019
025000                                                     COMP SYNC.   02500019
025100     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 02510099
025200     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02520019
025300     05  PV-CICS-MSG-HOLD.                                        02530019
025400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02540019
025500         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02550019
025600     05  PV-CICS-MSG-HOLD2.                                       02560019
025700         10  FILLER                      PIC  X(01)  VALUE SPACE. 02570019
025800         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02580019
025900     05  PV-TASK                         PIC 9999.                02590019
026000     05  PV-SHIPT-UNT-ID                 PIC 9(18).               02600019
026100     05  PV-SOURCE                       PIC X(01).               02610019
026200                                                                  02620019
026300     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02630019
026400     05  PV-SEL-TERM-ID                  PIC  X(04).              02640019
026500     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02650019
026600     05  PV-SEL-SEQ                      PIC  9(01).              02660019
026700                                                                  02670019
026800     05  PV-PREV-RECORD.                                          02680030
026900         10  PV-PREV-SHIPT-UNT-ID      PIC  S9(18)V COMP-3.       02690030
027000         10  PV-PREV-SKU-NBR           PIC  S9(08)V COMP-3.       02700099
027100                                                                  02710099
027200* DB2 TIMESTAMP FORMAT = CCYY-MM-DD-HH.MM.SS.999999               02720099
027300     05 PV-DB2-CURRENT-TMST       PIC  X(26).                     02730099
027400     05 FILLER REDEFINES PV-DB2-CURRENT-TMST.                     02740099
027500         10 PV-DB2-CURRENT-DATE   PIC  X(10).                     02750099
027600         10 PV-DB2-CURRENT-TIME   PIC  X(16).                     02760099
027700                                                                  02770099
027800     05  PV-SYSTEM-ID.                                            02780099
027900         10  FILLER                      PIC  X(04) VALUE SPACE.  02790099
028000         10  PV-REGION-IND               PIC  X(01).              02800099
028100             88  PV-TEST-CICS                 VALUE 'T'.          02810099
028200             88  PV-QA-CICS                   VALUE 'Q'.          02820099
028300             88  PV-PROD-CICS                 VALUE 'P'.          02830099
028400             88  PV-LEARN-CICS                VALUE 'L'.          02840099
028500         10  FILLER                      PIC X(03)  VALUE SPACE.  02850099
028600*    05  PV-PRINTER-DESTINATION          PIC X(08)  VALUE SPACE.  02860099
028700     05  PV-LEAVE-SYSTEM-MESSAGE         PIC X(160) VALUE SPACE.  02870099
028800     05  PV-JOB-DESCRIPTION              PIC X(13)  VALUE SPACE.  02880099
028900     05  PV-JOB-PROC                     PIC X(07)  VALUE SPACE.  02890099
029000     05  PV-JOB-NAME                     PIC X(07)  VALUE SPACE.  02900099
029100*                                                                 02910099
029200     05  PV-HARD-SKU-COUNT         PIC S9(09)  COMP.              02920099
029300     05  PV-SOFT-SKU-COUNT         PIC S9(09)  COMP.              02930099
029400     05  PV-HANG-SKU-COUNT         PIC S9(09)  COMP.              02940099
029500     05  PV-FOLD-SKU-COUNT         PIC S9(09)  COMP.              02950099
029600     05  PV-OH-R-SKU-COUNT         PIC S9(09)  COMP.              02960099
029700     05  PV-OH-N-SKU-COUNT         PIC S9(09)  COMP.              02970099
029800     05  PV-EAS-SKU-COUNT          PIC S9(09)  COMP.              02980099
029900     05  PV-CLEAR-SKU-COUNT        PIC S9(09)  COMP.              02990099
030000     05  PV-TOTAL-SKU-COUNT        PIC S9(09)  COMP.              03000099
030100*                                                                 03010099
030200/                                                                 03020019
030300******************************************************************03030099
030400*  JCL LINES FOR REQUESTING THE TRAILER SUMMARY REPORT            03040099
030500******************************************************************03050099
030600                                                                  03060099
030700 01  JL-JCL-LINE-AREA.                                            03070099
030800     05  JL-JCL-LINE-1           PIC X(80).                       03080099
030900     05  JL-JOB-LINE-PROD.                                        03090099
031000         10  FILLER              PIC X(21)    VALUE               03100099
031100             '//SUK975   JOB KOHLS,'.                             03110099
031200         10  FILLER              PIC X(1)     VALUE QUOTE.        03120099
031300         10  FILLER              PIC X(13)    VALUE               03130099
031400             'REPORTS PRINT'.                                     03140099
031500         10  FILLER              PIC X(1)     VALUE QUOTE.        03150099
031600         10  FILLER              PIC X(19)    VALUE               03160099
031700             ',MSGCLASS=P,CLASS=Q'.                               03170099
031800         10  FILLER              PIC X(25)    VALUE SPACE.        03180099
031900     05  JL-JOB-LINE-TEST.                                        03190099
032000         10  FILLER              PIC X(02)    VALUE               03200099
032100             '//'.                                                03210099
032200         10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACE.        03220099
032300         10  FILLER              PIC X(01)    VALUE               03230099
032400             'Q'.                                                 03240099
032500         10  FILLER              PIC X(11)    VALUE               03250099
032600             ' JOB KOHLS,'.                                       03260099
032700         10  FILLER              PIC X(1)     VALUE QUOTE.        03270099
032800         10  FILLER              PIC X(13)    VALUE               03280099
032900             'REPORTS PRINT'.                                     03290099
033000         10  FILLER              PIC X(1)     VALUE QUOTE.        03300099
033100         10  FILLER              PIC X(19)    VALUE               03310099
033200             ',MSGCLASS=X,CLASS=E'.                               03320099
033300         10  FILLER              PIC X(25)    VALUE SPACE.        03330099
033400     05  JL-JCL-LINE-3.                                           03340099
033500         10  FILLER              PIC X(13)    VALUE               03350099
033600             '/*JOBPARM K=0'.                                     03360099
033700         10  FILLER              PIC X(67)    VALUE SPACE.        03370099
033800     05  JL-JCL-LINE-4-PROD.                                      03380099
033900         10  FILLER              PIC X(39)    VALUE               03390099
034000             '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.           03400099
034100         10  FILLER              PIC X(41)    VALUE SPACE.        03410099
034200     05  JL-JCL-LINE-4-TEST.                                      03420099
034300         10  FILLER              PIC X(39)    VALUE               03430099
034400             '//JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR'.           03440099
034500         10  FILLER              PIC X(41)    VALUE SPACE.        03450099
034600     05  JL-JCL-LINE-4-QA.                                        03460099
034700         10  FILLER              PIC X(39)    VALUE               03470099
034800             '//JOBLIB   DD DSN=QKMO.LOADLIB,DISP=SHR'.           03480099
034900         10  FILLER              PIC X(41)    VALUE SPACE.        03490099
035000     05  JL-JCL-LINE-4-LRN.                                       03500099
035100         10  FILLER              PIC X(39)    VALUE               03510099
035200             '//JOBLIB   DD DSN=LKMO.LOADLIB,DISP=SHR'.           03520099
035300         10  FILLER              PIC X(41)    VALUE SPACE.        03530099
035400                                                                  03540099
035500     05  JL-JCL-LINE-9.                                           03550099
035600         10  FILLER              PIC X(29)    VALUE               03560099
035700             '//S010     EXEC PGM=PARMSWTR,'.                     03570099
035800         10  FILLER              PIC X(51)   VALUE SPACE.         03580099
035900                                                                  03590099
036000     05  JL-JCL-LINE-10.                                          03600099
036100         10  FILLER              PIC X(08)    VALUE               03610099
036200             '// PARM='.                                          03620099
036300         10  FILLER              PIC X(1)     VALUE QUOTE.        03630099
036400         10  FILLER              PIC X(01)    VALUE SPACE.        03640099
036500         10  JL-LINE-10-OCRNC-ID PIC X(09)    VALUE               03650099
036600             '         '.                                         03660099
036700         10  FILLER              PIC X(01)    VALUE SPACE.        03670099
036800         10  JL-LINE-10-TRIP-ID  PIC X(09)    VALUE               03680099
036900             '         '.                                         03690099
037000         10  FILLER              PIC X(01)    VALUE SPACE.        03700099
037100         10  JL-LINE-10-USER-ID  PIC X(08)    VALUE               03710099
037200             '        '.                                          03720099
037300         10  FILLER              PIC X(01)    VALUE SPACE.        03730099
037400         10  JL-LINE-10-TIMESTMP PIC X(26)    VALUE               03740099
037500             '                          '.                        03750099
037600         10  FILLER              PIC X(1)     VALUE QUOTE.        03760099
037700         10  FILLER              PIC X(14)  VALUE SPACE.          03770099
037800                                                                  03780099
037900     05  JL-JCL-LINE-11.                                          03790099
038000         10  FILLER              PIC  X(26)  VALUE                03800099
038100             '//PARMSWTR DD DSN=&&TEMP1,'.                        03810099
038200         10  FILLER              PIC  X(38)  VALUE                03820099
038300             'DISP=(NEW,PASS),UNIT=VIO,SPACE=(TRK,1)'.            03830099
038400         10  FILLER              PIC  X(16)  VALUE SPACE.         03840099
038500                                                                  03850099
038600     05  JL-JCL-LINE-12.                                          03860099
038700         10  FILLER              PIC X(16)    VALUE               03870099
038800             '//PS020    EXEC '.                                  03880099
038900         10  JL-LINE-12-PROC     PIC X(06)    VALUE               03890099
039000             'SUK975'.                                            03900099
039100         10  JL-LINE-12-PROC-T   PIC X(01)    VALUE SPACE.        03910099
039200         10  JL-LINE-12-PROC-T2  PIC X(01)    VALUE SPACE.        03920099
039300         10  FILLER              PIC X(56)    VALUE SPACE.        03930099
039400     05  JL-JCL-LINE-13.                                          03940099
039500         10  FILLER              PIC  X(41)  VALUE                03950099
039600             '//PS030    EXEC IPAC123I,RGN=IPACP,CLS=Q,'.         03960099
039700         10  FILLER              PIC  X(13)  VALUE                03970099
039800             'PACKET=SUK975'.                                     03980099
039900         10  FILLER              PIC  X(26)  VALUE SPACE.         03990099
040000*BUILD TRIP CONTROL CARD-SUCC045                                  04000099
040100     05  JL-JCL-LINE-14.                                          04010099
040200         10  FILLER              PIC X(38)    VALUE               04020099
040300             '//S010.SYSUT1 DD  DSN=&&TEMP1,DISP=SHR'.            04030099
040400         10  FILLER              PIC X(42)    VALUE SPACE.        04040099
040500                                                                  04050099
040600     05  JL-JCL-LINE-15.                                          04060099
040700         10  JL-LINE-15-OCRNC-ID PIC X(09).                       04070099
040800         10  FILLER              PIC X(01)    VALUE SPACE.        04080099
040900         10  JL-LINE-15-TRIP-ID  PIC X(09).                       04090099
041000         10  FILLER              PIC X(01)    VALUE SPACE.        04100099
041100         10  JL-LINE-15-USER-ID  PIC X(08).                       04110099
041200         10  FILLER              PIC X(01)    VALUE SPACE.        04120099
041300         10  JL-LINE-15-TIMESTMP PIC X(26).                       04130099
041400         10  FILLER              PIC X(25)    VALUE SPACE.        04140099
041500*BUILD PRINTER CONTROL CARD-SUCC006                               04150099
041600*    05  JL-JCL-LINE-16.                                          04160099
041700*        10  FILLER              PIC X(18)    VALUE               04170099
041800*            '//S035.SYSUT1 DD *'.                                04180099
041900*        10  FILLER              PIC X(62)    VALUE SPACE.        04190099
042000*    05  JL-JCL-LINE-17.                                          04200099
042100*        10  JL-LINE-17-PRINTER  PIC X(08)    VALUE SPACE.        04210099
042200*        10  JL-LINE-17-PRTR-IND PIC X(01)    VALUE SPACE.        04220099
042300*        10  JL-LINE-17-TRACK-NBR                                 04230099
042400*                                PIC  9(1)    VALUE 0.            04240099
042500*        10  FILLER              PIC X(01)    VALUE SPACE.        04250099
042600*        10  JL-LINE-17-CUT-RPT  PIC X(01)    VALUE SPACE.        04260099
042700*        10  JL-LINE-17-USER-ID  PIC X(08)    VALUE SPACE.        04270099
042800*        10  JL-LINE-17-STAT-RPT PIC X(01)    VALUE SPACE.        04280099
042900*        10  JL-LINE-17-CRTN-RPT PIC X(01)    VALUE SPACE.        04290099
043000*        10  JL-LINE-17-MSDR-RPT PIC X(01)    VALUE SPACE.        04300099
043100*        10  JL-LINE-17-FREE-RPT PIC X(01)    VALUE SPACE.        04310099
043200*        10  JL-LINE-17-DUPL-RPT PIC X(01)    VALUE SPACE.        04320099
043300*        10  JL-LINE-17-WRKS-RPT PIC X(01)    VALUE SPACE.        04330099
043400*        10  JL-LINE-17-SCAN-RPT PIC X(01)    VALUE SPACE.        04340099
043500*        10  JL-LINE-17-ULBL-RPT PIC X(01)    VALUE SPACE.        04350099
043600*        10  FILLER              PIC X(01)    VALUE SPACE.        04360099
043700*        10  JL-LINE-17-ALL-PO-IND                                04370099
043800*                                PIC X(01)    VALUE SPACE.        04380099
043900*        10  FILLER              PIC X(50)    VALUE SPACE.        04390099
044000     05  JL-JCL-LINE-EOF.                                         04400099
044100         10  FILLER              PIC X(5)     VALUE '/*EOF'.      04410099
044200         10  FILLER              PIC X(75)    VALUE SPACE.        04420099
044300                                                                  04430099
044400 01  TD-TRANSIENT-DATA-AREA.                                      04440099
044500     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       04450099
044600     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            04460099
044700                                 COMP SYNC.                       04470099
044800     05  TD-JCL-LINE             PIC X(80)    VALUE SPACE.        04480099
044900     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           04490099
045000                                 COMP SYNC.                       04500099
045100/                                                                 04510099
045200 01  LQW-LIST-QUEUE-WORK-AREA.                                    04520099
045300     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04530099
045400     05  LQW-ITEM-ENTRIES               OCCURS 01 TIMES           04540099
045500                                        INDEXED BY LQW-IDX.       04550099
045600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04560099
045700         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04570099
045800         10  LQW-SELECTED-SW            PIC  X(01).               04580099
045900             88  LQW-SELECT                         VALUE 'S'.    04590099
046000             88  LQW-DESELECT                       VALUE ' '.    04600099
046100         10  LQW-ACTION                 PIC  X(03).               04610099
046200             88  LQW-DEL                         VALUE 'DEL'.     04620099
046300             88  LQW-INQ                         VALUE 'INQ'.     04630099
046400             88  LQW-UPD                         VALUE 'UPD'.     04640099
046500             88  LQW-ERR                         VALUE 'ERR'.     04650099
046600                                                                  04660099
046700                                                                  04670099
046800******************************************************************04680099
046900**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **04690099
047000**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **04700099
047100**  APPLICATION-SPECIFIC COMMAREA.                              **04710099
047200******************************************************************04720099
047300*---------------------------------------------------------------* 04730099
047400* SELECTON QUEUE LAYOUT                                         * 04740099
047500*---------------------------------------------------------------* 04750099
047600     COPY SUWS013.                                                04760099
047700                                                                  04770099
047800*---------------------------------------------------------------* 04780099
047900*    MAP LAYOUT                                                 * 04790099
048000*---------------------------------------------------------------* 04800099
048100     COPY SUKM545.                                                04810099
048200*                                                                 04820099
048300 01  MR-OCCURS-LAYOUT                   REDEFINES  SU545AO.       04830099
048400     05  FILLER                         PIC X(77).                04840099
048500     05  MR-SCROLL-AREA                 OCCURS 01 TIMES.          04850099
048600*        10  MR-SELECTL                 PIC S9(04) COMP.          04860099
048700*        10  MR-SELECTA                 PIC  X(01).               04870099
048800*        10  MR-SELECTC                 PIC  X(01).               04880099
048900*        10  MR-SELECTH                 PIC  X(01).               04890099
049000*        10  MR-SELECTI                 PIC  X(01).               04900099
049100                                                                  04910099
049200*        10  MR-ACTIONL                 PIC S9(04) COMP.          04920099
049300*        10  MR-ACTIONA                 PIC  X(01).               04930099
049400*        10  MR-ACTIONC                 PIC  X(01).               04940099
049500*        10  MR-ACTIONH                 PIC  X(01).               04950099
049600*        10  MR-ACTION                  PIC  X(03).               04960099
049700                                                                  04970099
049800* 1ST 25% CTNS                                                    04980099
049900         10  MR-1ST-CTNS-HARDL          PIC S9(04) COMP.          04990099
050000         10  MR-1ST-CTNS-HARDA          PIC  X(01).               05000099
050100         10  MR-1ST-CTNS-HARDC          PIC  X(01).               05010099
050200         10  MR-1ST-CTNS-HARDH          PIC  X(01).               05020099
050300         10  MR-1ST-CTNS-HARD           PIC  ZZZZZZ.              05030099
050400                                                                  05040099
050500         10  MR-1ST-CTNS-SOFTL          PIC S9(04) COMP.          05050099
050600         10  MR-1ST-CTNS-SOFTA          PIC  X(01).               05060099
050700         10  MR-1ST-CTNS-SOFTC          PIC  X(01).               05070099
050800         10  MR-1ST-CTNS-SOFTH          PIC  X(01).               05080099
050900         10  MR-1ST-CTNS-SOFT           PIC  ZZZZZZ.              05090099
051000                                                                  05100099
051100         10  MR-1ST-CTNS-HANGL          PIC S9(04) COMP.          05110099
051200         10  MR-1ST-CTNS-HANGA          PIC  X(01).               05120099
051300         10  MR-1ST-CTNS-HANGC          PIC  X(01).               05130099
051400         10  MR-1ST-CTNS-HANGH          PIC  X(01).               05140099
051500         10  MR-1ST-CTNS-HANG           PIC  ZZZZZZ.              05150099
051600                                                                  05160099
051700         10  MR-1ST-CTNS-FOLDL          PIC S9(04) COMP.          05170099
051800         10  MR-1ST-CTNS-FOLDA          PIC  X(01).               05180099
051900         10  MR-1ST-CTNS-FOLDC          PIC  X(01).               05190099
052000         10  MR-1ST-CTNS-FOLDH          PIC  X(01).               05200099
052100         10  MR-1ST-CTNS-FOLD           PIC  ZZZZZZ.              05210099
052200                                                                  05220099
052300         10  MR-1ST-CTNS-REPLL          PIC S9(04) COMP.          05230099
052400         10  MR-1ST-CTNS-REPLA          PIC  X(01).               05240099
052500         10  MR-1ST-CTNS-REPLC          PIC  X(01).               05250099
052600         10  MR-1ST-CTNS-REPLH          PIC  X(01).               05260099
052700         10  MR-1ST-CTNS-REPL           PIC  ZZZZZZ.              05270099
052800                                                                  05280099
052900         10  MR-1ST-CTNS-NEWL           PIC S9(04) COMP.          05290099
053000         10  MR-1ST-CTNS-NEWA           PIC  X(01).               05300099
053100         10  MR-1ST-CTNS-NEWC           PIC  X(01).               05310099
053200         10  MR-1ST-CTNS-NEWH           PIC  X(01).               05320099
053300         10  MR-1ST-CTNS-NEW            PIC  ZZZZZZ.              05330099
053400                                                                  05340099
053500         10  MR-1ST-CTNS-EASL           PIC S9(04) COMP.          05350099
053600         10  MR-1ST-CTNS-EASA           PIC  X(01).               05360099
053700         10  MR-1ST-CTNS-EASC           PIC  X(01).               05370099
053800         10  MR-1ST-CTNS-EASH           PIC  X(01).               05380099
053900         10  MR-1ST-CTNS-EAS            PIC  ZZZZZZ.              05390099
054000                                                                  05400099
054100         10  MR-1ST-CTNS-CLRNCEL        PIC S9(04) COMP.          05410099
054200         10  MR-1ST-CTNS-CLRNCEA        PIC  X(01).               05420099
054300         10  MR-1ST-CTNS-CLRNCEC        PIC  X(01).               05430099
054400         10  MR-1ST-CTNS-CLRNCEH        PIC  X(01).               05440099
054500         10  MR-1ST-CTNS-CLRNCE         PIC  ZZZZZZ.              05450099
054600                                                                  05460099
054700         10  MR-1ST-CTNS-TOTALL         PIC S9(04) COMP.          05470099
054800         10  MR-1ST-CTNS-TOTALA         PIC  X(01).               05480099
054900         10  MR-1ST-CTNS-TOTALC         PIC  X(01).               05490099
055000         10  MR-1ST-CTNS-TOTALH         PIC  X(01).               05500099
055100         10  MR-1ST-CTNS-TOTAL          PIC  ZZZZZZ.              05510099
055200                                                                  05520099
055300* 1ST 25% SKUS                                                    05530099
055400         10  MR-1ST-SKUS-HARDL          PIC S9(04) COMP.          05540099
055500         10  MR-1ST-SKUS-HARDA          PIC  X(01).               05550099
055600         10  MR-1ST-SKUS-HARDC          PIC  X(01).               05560099
055700         10  MR-1ST-SKUS-HARDH          PIC  X(01).               05570099
055800         10  MR-1ST-SKUS-HARD           PIC  ZZZZZZ.              05580099
055900                                                                  05590099
056000         10  MR-1ST-SKUS-SOFTL          PIC S9(04) COMP.          05600099
056100         10  MR-1ST-SKUS-SOFTA          PIC  X(01).               05610099
056200         10  MR-1ST-SKUS-SOFTC          PIC  X(01).               05620099
056300         10  MR-1ST-SKUS-SOFTH          PIC  X(01).               05630099
056400         10  MR-1ST-SKUS-SOFT           PIC  ZZZZZZ.              05640099
056500                                                                  05650099
056600         10  MR-1ST-SKUS-HANGL          PIC S9(04) COMP.          05660099
056700         10  MR-1ST-SKUS-HANGA          PIC  X(01).               05670099
056800         10  MR-1ST-SKUS-HANGC          PIC  X(01).               05680099
056900         10  MR-1ST-SKUS-HANGH          PIC  X(01).               05690099
057000         10  MR-1ST-SKUS-HANG           PIC  ZZZZZZ.              05700099
057100                                                                  05710099
057200         10  MR-1ST-SKUS-FOLDL          PIC S9(04) COMP.          05720099
057300         10  MR-1ST-SKUS-FOLDA          PIC  X(01).               05730099
057400         10  MR-1ST-SKUS-FOLDC          PIC  X(01).               05740099
057500         10  MR-1ST-SKUS-FOLDH          PIC  X(01).               05750099
057600         10  MR-1ST-SKUS-FOLD           PIC  ZZZZZZ.              05760099
057700                                                                  05770099
057800         10  MR-1ST-SKUS-REPLL          PIC S9(04) COMP.          05780099
057900         10  MR-1ST-SKUS-REPLA          PIC  X(01).               05790099
058000         10  MR-1ST-SKUS-REPLC          PIC  X(01).               05800099
058100         10  MR-1ST-SKUS-REPLH          PIC  X(01).               05810099
058200         10  MR-1ST-SKUS-REPL           PIC  ZZZZZZ.              05820099
058300                                                                  05830099
058400         10  MR-1ST-SKUS-NEWL           PIC S9(04) COMP.          05840099
058500         10  MR-1ST-SKUS-NEWA           PIC  X(01).               05850099
058600         10  MR-1ST-SKUS-NEWC           PIC  X(01).               05860099
058700         10  MR-1ST-SKUS-NEWH           PIC  X(01).               05870099
058800         10  MR-1ST-SKUS-NEW            PIC  ZZZZZZ.              05880099
058900                                                                  05890099
059000         10  MR-1ST-SKUS-EASL           PIC S9(04) COMP.          05900099
059100         10  MR-1ST-SKUS-EASA           PIC  X(01).               05910099
059200         10  MR-1ST-SKUS-EASC           PIC  X(01).               05920099
059300         10  MR-1ST-SKUS-EASH           PIC  X(01).               05930099
059400         10  MR-1ST-SKUS-EAS            PIC  ZZZZZZ.              05940099
059500                                                                  05950099
059600         10  MR-1ST-SKUS-CLRNCEL        PIC S9(04) COMP.          05960099
059700         10  MR-1ST-SKUS-CLRNCEA        PIC  X(01).               05970099
059800         10  MR-1ST-SKUS-CLRNCEC        PIC  X(01).               05980099
059900         10  MR-1ST-SKUS-CLRNCEH        PIC  X(01).               05990099
060000         10  MR-1ST-SKUS-CLRNCE         PIC  ZZZZZZ.              06000099
060100                                                                  06010099
060200         10  MR-1ST-SKUS-TOTALL         PIC S9(04) COMP.          06020099
060300         10  MR-1ST-SKUS-TOTALA         PIC  X(01).               06030099
060400         10  MR-1ST-SKUS-TOTALC         PIC  X(01).               06040099
060500         10  MR-1ST-SKUS-TOTALH         PIC  X(01).               06050099
060600         10  MR-1ST-SKUS-TOTAL          PIC  ZZZZZZ.              06060099
060700                                                                  06070099
060800* 1ST 25% UNITS                                                   06080099
060900         10  MR-1ST-UNTS-HARDL          PIC S9(04) COMP.          06090099
061000         10  MR-1ST-UNTS-HARDA          PIC  X(01).               06100099
061100         10  MR-1ST-UNTS-HARDC          PIC  X(01).               06110099
061200         10  MR-1ST-UNTS-HARDH          PIC  X(01).               06120099
061300         10  MR-1ST-UNTS-HARD           PIC  ZZZZZZ.              06130099
061400                                                                  06140099
061500         10  MR-1ST-UNTS-SOFTL          PIC S9(04) COMP.          06150099
061600         10  MR-1ST-UNTS-SOFTA          PIC  X(01).               06160099
061700         10  MR-1ST-UNTS-SOFTC          PIC  X(01).               06170099
061800         10  MR-1ST-UNTS-SOFTH          PIC  X(01).               06180099
061900         10  MR-1ST-UNTS-SOFT           PIC  ZZZZZZ.              06190099
062000                                                                  06200099
062100         10  MR-1ST-UNTS-HANGL          PIC S9(04) COMP.          06210099
062200         10  MR-1ST-UNTS-HANGA          PIC  X(01).               06220099
062300         10  MR-1ST-UNTS-HANGC          PIC  X(01).               06230099
062400         10  MR-1ST-UNTS-HANGH          PIC  X(01).               06240099
062500         10  MR-1ST-UNTS-HANG           PIC  ZZZZZZ.              06250099
062600                                                                  06260099
062700         10  MR-1ST-UNTS-FOLDL          PIC S9(04) COMP.          06270099
062800         10  MR-1ST-UNTS-FOLDA          PIC  X(01).               06280099
062900         10  MR-1ST-UNTS-FOLDC          PIC  X(01).               06290099
063000         10  MR-1ST-UNTS-FOLDH          PIC  X(01).               06300099
063100         10  MR-1ST-UNTS-FOLD           PIC  ZZZZZZ.              06310099
063200                                                                  06320099
063300         10  MR-1ST-UNTS-REPLL          PIC S9(04) COMP.          06330099
063400         10  MR-1ST-UNTS-REPLA          PIC  X(01).               06340099
063500         10  MR-1ST-UNTS-REPLC          PIC  X(01).               06350099
063600         10  MR-1ST-UNTS-REPLH          PIC  X(01).               06360099
063700         10  MR-1ST-UNTS-REPL           PIC  ZZZZZZ.              06370099
063800                                                                  06380099
063900         10  MR-1ST-UNTS-NEWL           PIC S9(04) COMP.          06390099
064000         10  MR-1ST-UNTS-NEWA           PIC  X(01).               06400099
064100         10  MR-1ST-UNTS-NEWC           PIC  X(01).               06410099
064200         10  MR-1ST-UNTS-NEWH           PIC  X(01).               06420099
064300         10  MR-1ST-UNTS-NEW            PIC  ZZZZZZ.              06430099
064400                                                                  06440099
064500         10  MR-1ST-UNTS-EASL           PIC S9(04) COMP.          06450099
064600         10  MR-1ST-UNTS-EASA           PIC  X(01).               06460099
064700         10  MR-1ST-UNTS-EASC           PIC  X(01).               06470099
064800         10  MR-1ST-UNTS-EASH           PIC  X(01).               06480099
064900         10  MR-1ST-UNTS-EAS            PIC  ZZZZZZ.              06490099
065000                                                                  06500099
065100         10  MR-1ST-UNTS-CLRNCEL        PIC S9(04) COMP.          06510099
065200         10  MR-1ST-UNTS-CLRNCEA        PIC  X(01).               06520099
065300         10  MR-1ST-UNTS-CLRNCEC        PIC  X(01).               06530099
065400         10  MR-1ST-UNTS-CLRNCEH        PIC  X(01).               06540099
065500         10  MR-1ST-UNTS-CLRNCE         PIC  ZZZZZZ.              06550099
065600                                                                  06560099
065700         10  MR-1ST-UNTS-TOTALL         PIC S9(04) COMP.          06570099
065800         10  MR-1ST-UNTS-TOTALA         PIC  X(01).               06580099
065900         10  MR-1ST-UNTS-TOTALC         PIC  X(01).               06590099
066000         10  MR-1ST-UNTS-TOTALH         PIC  X(01).               06600099
066100         10  MR-1ST-UNTS-TOTAL          PIC  ZZZZZZ.              06610099
066200                                                                  06620099
066300* 2ND 25% CTNS                                                    06630099
066400         10  MR-2ND-CTNS-HARDL          PIC S9(04) COMP.          06640099
066500         10  MR-2ND-CTNS-HARDA          PIC  X(01).               06650099
066600         10  MR-2ND-CTNS-HARDC          PIC  X(01).               06660099
066700         10  MR-2ND-CTNS-HARDH          PIC  X(01).               06670099
066800         10  MR-2ND-CTNS-HARD           PIC  ZZZZZZ.              06680099
066900                                                                  06690099
067000         10  MR-2ND-CTNS-SOFTL          PIC S9(04) COMP.          06700099
067100         10  MR-2ND-CTNS-SOFTA          PIC  X(01).               06710099
067200         10  MR-2ND-CTNS-SOFTC          PIC  X(01).               06720099
067300         10  MR-2ND-CTNS-SOFTH          PIC  X(01).               06730099
067400         10  MR-2ND-CTNS-SOFT           PIC  ZZZZZZ.              06740099
067500                                                                  06750099
067600         10  MR-2ND-CTNS-HANGL          PIC S9(04) COMP.          06760099
067700         10  MR-2ND-CTNS-HANGA          PIC  X(01).               06770099
067800         10  MR-2ND-CTNS-HANGC          PIC  X(01).               06780099
067900         10  MR-2ND-CTNS-HANGH          PIC  X(01).               06790099
068000         10  MR-2ND-CTNS-HANG           PIC  ZZZZZZ.              06800099
068100                                                                  06810099
068200         10  MR-2ND-CTNS-FOLDL          PIC S9(04) COMP.          06820099
068300         10  MR-2ND-CTNS-FOLDA          PIC  X(01).               06830099
068400         10  MR-2ND-CTNS-FOLDC          PIC  X(01).               06840099
068500         10  MR-2ND-CTNS-FOLDH          PIC  X(01).               06850099
068600         10  MR-2ND-CTNS-FOLD           PIC  ZZZZZZ.              06860099
068700                                                                  06870099
068800         10  MR-2ND-CTNS-REPLL          PIC S9(04) COMP.          06880099
068900         10  MR-2ND-CTNS-REPLA          PIC  X(01).               06890099
069000         10  MR-2ND-CTNS-REPLC          PIC  X(01).               06900099
069100         10  MR-2ND-CTNS-REPLH          PIC  X(01).               06910099
069200         10  MR-2ND-CTNS-REPL           PIC  ZZZZZZ.              06920099
069300                                                                  06930099
069400         10  MR-2ND-CTNS-NEWL           PIC S9(04) COMP.          06940099
069500         10  MR-2ND-CTNS-NEWA           PIC  X(01).               06950099
069600         10  MR-2ND-CTNS-NEWC           PIC  X(01).               06960099
069700         10  MR-2ND-CTNS-NEWH           PIC  X(01).               06970099
069800         10  MR-2ND-CTNS-NEW            PIC  ZZZZZZ.              06980099
069900                                                                  06990099
070000         10  MR-2ND-CTNS-EASL           PIC S9(04) COMP.          07000099
070100         10  MR-2ND-CTNS-EASA           PIC  X(01).               07010099
070200         10  MR-2ND-CTNS-EASC           PIC  X(01).               07020099
070300         10  MR-2ND-CTNS-EASH           PIC  X(01).               07030099
070400         10  MR-2ND-CTNS-EAS            PIC  ZZZZZZ.              07040099
070500                                                                  07050099
070600         10  MR-2ND-CTNS-CLRNCEL        PIC S9(04) COMP.          07060099
070700         10  MR-2ND-CTNS-CLRNCEA        PIC  X(01).               07070099
070800         10  MR-2ND-CTNS-CLRNCEC        PIC  X(01).               07080099
070900         10  MR-2ND-CTNS-CLRNCEH        PIC  X(01).               07090099
071000         10  MR-2ND-CTNS-CLRNCE         PIC  ZZZZZZ.              07100099
071100                                                                  07110099
071200         10  MR-2ND-CTNS-TOTALL         PIC S9(04) COMP.          07120099
071300         10  MR-2ND-CTNS-TOTALA         PIC  X(01).               07130099
071400         10  MR-2ND-CTNS-TOTALC         PIC  X(01).               07140099
071500         10  MR-2ND-CTNS-TOTALH         PIC  X(01).               07150099
071600         10  MR-2ND-CTNS-TOTAL          PIC  ZZZZZZ.              07160099
071700                                                                  07170099
071800* 2ND 25% SKUS                                                    07180099
071900         10  MR-2ND-SKUS-HARDL          PIC S9(04) COMP.          07190099
072000         10  MR-2ND-SKUS-HARDA          PIC  X(01).               07200099
072100         10  MR-2ND-SKUS-HARDC          PIC  X(01).               07210099
072200         10  MR-2ND-SKUS-HARDH          PIC  X(01).               07220099
072300         10  MR-2ND-SKUS-HARD           PIC  ZZZZZZ.              07230099
072400                                                                  07240099
072500         10  MR-2ND-SKUS-SOFTL          PIC S9(04) COMP.          07250099
072600         10  MR-2ND-SKUS-SOFTA          PIC  X(01).               07260099
072700         10  MR-2ND-SKUS-SOFTC          PIC  X(01).               07270099
072800         10  MR-2ND-SKUS-SOFTH          PIC  X(01).               07280099
072900         10  MR-2ND-SKUS-SOFT           PIC  ZZZZZZ.              07290099
073000                                                                  07300099
073100         10  MR-2ND-SKUS-HANGL          PIC S9(04) COMP.          07310099
073200         10  MR-2ND-SKUS-HANGA          PIC  X(01).               07320099
073300         10  MR-2ND-SKUS-HANGC          PIC  X(01).               07330099
073400         10  MR-2ND-SKUS-HANGH          PIC  X(01).               07340099
073500         10  MR-2ND-SKUS-HANG           PIC  ZZZZZZ.              07350099
073600                                                                  07360099
073700         10  MR-2ND-SKUS-FOLDL          PIC S9(04) COMP.          07370099
073800         10  MR-2ND-SKUS-FOLDA          PIC  X(01).               07380099
073900         10  MR-2ND-SKUS-FOLDC          PIC  X(01).               07390099
074000         10  MR-2ND-SKUS-FOLDH          PIC  X(01).               07400099
074100         10  MR-2ND-SKUS-FOLD           PIC  ZZZZZZ.              07410099
074200                                                                  07420099
074300         10  MR-2ND-SKUS-REPLL          PIC S9(04) COMP.          07430099
074400         10  MR-2ND-SKUS-REPLA          PIC  X(01).               07440099
074500         10  MR-2ND-SKUS-REPLC          PIC  X(01).               07450099
074600         10  MR-2ND-SKUS-REPLH          PIC  X(01).               07460099
074700         10  MR-2ND-SKUS-REPL           PIC  ZZZZZZ.              07470099
074800                                                                  07480099
074900         10  MR-2ND-SKUS-NEWL           PIC S9(04) COMP.          07490099
075000         10  MR-2ND-SKUS-NEWA           PIC  X(01).               07500099
075100         10  MR-2ND-SKUS-NEWC           PIC  X(01).               07510099
075200         10  MR-2ND-SKUS-NEWH           PIC  X(01).               07520099
075300         10  MR-2ND-SKUS-NEW            PIC  ZZZZZZ.              07530099
075400                                                                  07540099
075500         10  MR-2ND-SKUS-EASL           PIC S9(04) COMP.          07550099
075600         10  MR-2ND-SKUS-EASA           PIC  X(01).               07560099
075700         10  MR-2ND-SKUS-EASC           PIC  X(01).               07570099
075800         10  MR-2ND-SKUS-EASH           PIC  X(01).               07580099
075900         10  MR-2ND-SKUS-EAS            PIC  ZZZZZZ.              07590099
076000                                                                  07600099
076100         10  MR-2ND-SKUS-CLRNCEL        PIC S9(04) COMP.          07610099
076200         10  MR-2ND-SKUS-CLRNCEA        PIC  X(01).               07620099
076300         10  MR-2ND-SKUS-CLRNCEC        PIC  X(01).               07630099
076400         10  MR-2ND-SKUS-CLRNCEH        PIC  X(01).               07640099
076500         10  MR-2ND-SKUS-CLRNCE         PIC  ZZZZZZ.              07650099
076600                                                                  07660099
076700         10  MR-2ND-SKUS-TOTALL         PIC S9(04) COMP.          07670099
076800         10  MR-2ND-SKUS-TOTALA         PIC  X(01).               07680099
076900         10  MR-2ND-SKUS-TOTALC         PIC  X(01).               07690099
077000         10  MR-2ND-SKUS-TOTALH         PIC  X(01).               07700099
077100         10  MR-2ND-SKUS-TOTAL          PIC  ZZZZZZ.              07710099
077200                                                                  07720099
077300* 2ND 25% UNITS                                                   07730099
077400         10  MR-2ND-UNTS-HARDL          PIC S9(04) COMP.          07740099
077500         10  MR-2ND-UNTS-HARDA          PIC  X(01).               07750099
077600         10  MR-2ND-UNTS-HARDC          PIC  X(01).               07760099
077700         10  MR-2ND-UNTS-HARDH          PIC  X(01).               07770099
077800         10  MR-2ND-UNTS-HARD           PIC  ZZZZZZ.              07780099
077900                                                                  07790099
078000         10  MR-2ND-UNTS-SOFTL          PIC S9(04) COMP.          07800099
078100         10  MR-2ND-UNTS-SOFTA          PIC  X(01).               07810099
078200         10  MR-2ND-UNTS-SOFTC          PIC  X(01).               07820099
078300         10  MR-2ND-UNTS-SOFTH          PIC  X(01).               07830099
078400         10  MR-2ND-UNTS-SOFT           PIC  ZZZZZZ.              07840099
078500                                                                  07850099
078600         10  MR-2ND-UNTS-HANGL          PIC S9(04) COMP.          07860099
078700         10  MR-2ND-UNTS-HANGA          PIC  X(01).               07870099
078800         10  MR-2ND-UNTS-HANGC          PIC  X(01).               07880099
078900         10  MR-2ND-UNTS-HANGH          PIC  X(01).               07890099
079000         10  MR-2ND-UNTS-HANG           PIC  ZZZZZZ.              07900099
079100                                                                  07910099
079200         10  MR-2ND-UNTS-FOLDL          PIC S9(04) COMP.          07920099
079300         10  MR-2ND-UNTS-FOLDA          PIC  X(01).               07930099
079400         10  MR-2ND-UNTS-FOLDC          PIC  X(01).               07940099
079500         10  MR-2ND-UNTS-FOLDH          PIC  X(01).               07950099
079600         10  MR-2ND-UNTS-FOLD           PIC  ZZZZZZ.              07960099
079700                                                                  07970099
079800         10  MR-2ND-UNTS-REPLL          PIC S9(04) COMP.          07980099
079900         10  MR-2ND-UNTS-REPLA          PIC  X(01).               07990099
080000         10  MR-2ND-UNTS-REPLC          PIC  X(01).               08000099
080100         10  MR-2ND-UNTS-REPLH          PIC  X(01).               08010099
080200         10  MR-2ND-UNTS-REPL           PIC  ZZZZZZ.              08020099
080300                                                                  08030099
080400         10  MR-2ND-UNTS-NEWL           PIC S9(04) COMP.          08040099
080500         10  MR-2ND-UNTS-NEWA           PIC  X(01).               08050099
080600         10  MR-2ND-UNTS-NEWC           PIC  X(01).               08060099
080700         10  MR-2ND-UNTS-NEWH           PIC  X(01).               08070099
080800         10  MR-2ND-UNTS-NEW            PIC  ZZZZZZ.              08080099
080900                                                                  08090099
081000         10  MR-2ND-UNTS-EASL           PIC S9(04) COMP.          08100099
081100         10  MR-2ND-UNTS-EASA           PIC  X(01).               08110099
081200         10  MR-2ND-UNTS-EASC           PIC  X(01).               08120099
081300         10  MR-2ND-UNTS-EASH           PIC  X(01).               08130099
081400         10  MR-2ND-UNTS-EAS            PIC  ZZZZZZ.              08140099
081500                                                                  08150099
081600         10  MR-2ND-UNTS-CLRNCEL        PIC S9(04) COMP.          08160099
081700         10  MR-2ND-UNTS-CLRNCEA        PIC  X(01).               08170099
081800         10  MR-2ND-UNTS-CLRNCEC        PIC  X(01).               08180099
081900         10  MR-2ND-UNTS-CLRNCEH        PIC  X(01).               08190099
082000         10  MR-2ND-UNTS-CLRNCE         PIC  ZZZZZZ.              08200099
082100                                                                  08210099
082200         10  MR-2ND-UNTS-TOTALL         PIC S9(04) COMP.          08220099
082300         10  MR-2ND-UNTS-TOTALA         PIC  X(01).               08230099
082400         10  MR-2ND-UNTS-TOTALC         PIC  X(01).               08240099
082500         10  MR-2ND-UNTS-TOTALH         PIC  X(01).               08250099
082600         10  MR-2ND-UNTS-TOTAL          PIC  ZZZZZZ.              08260099
082700                                                                  08270099
082800* 3RD 25% CTNS                                                    08280099
082900         10  MR-3RD-CTNS-HARDL          PIC S9(04) COMP.          08290099
083000         10  MR-3RD-CTNS-HARDA          PIC  X(01).               08300099
083100         10  MR-3RD-CTNS-HARDC          PIC  X(01).               08310099
083200         10  MR-3RD-CTNS-HARDH          PIC  X(01).               08320099
083300         10  MR-3RD-CTNS-HARD           PIC  ZZZZZZ.              08330099
083400                                                                  08340099
083500         10  MR-3RD-CTNS-SOFTL          PIC S9(04) COMP.          08350099
083600         10  MR-3RD-CTNS-SOFTA          PIC  X(01).               08360099
083700         10  MR-3RD-CTNS-SOFTC          PIC  X(01).               08370099
083800         10  MR-3RD-CTNS-SOFTH          PIC  X(01).               08380099
083900         10  MR-3RD-CTNS-SOFT           PIC  ZZZZZZ.              08390099
084000                                                                  08400099
084100         10  MR-3RD-CTNS-HANGL          PIC S9(04) COMP.          08410099
084200         10  MR-3RD-CTNS-HANGA          PIC  X(01).               08420099
084300         10  MR-3RD-CTNS-HANGC          PIC  X(01).               08430099
084400         10  MR-3RD-CTNS-HANGH          PIC  X(01).               08440099
084500         10  MR-3RD-CTNS-HANG           PIC  ZZZZZZ.              08450099
084600                                                                  08460099
084700         10  MR-3RD-CTNS-FOLDL          PIC S9(04) COMP.          08470099
084800         10  MR-3RD-CTNS-FOLDA          PIC  X(01).               08480099
084900         10  MR-3RD-CTNS-FOLDC          PIC  X(01).               08490099
085000         10  MR-3RD-CTNS-FOLDH          PIC  X(01).               08500099
085100         10  MR-3RD-CTNS-FOLD           PIC  ZZZZZZ.              08510099
085200                                                                  08520099
085300         10  MR-3RD-CTNS-REPLL          PIC S9(04) COMP.          08530099
085400         10  MR-3RD-CTNS-REPLA          PIC  X(01).               08540099
085500         10  MR-3RD-CTNS-REPLC          PIC  X(01).               08550099
085600         10  MR-3RD-CTNS-REPLH          PIC  X(01).               08560099
085700         10  MR-3RD-CTNS-REPL           PIC  ZZZZZZ.              08570099
085800                                                                  08580099
085900         10  MR-3RD-CTNS-NEWL           PIC S9(04) COMP.          08590099
086000         10  MR-3RD-CTNS-NEWA           PIC  X(01).               08600099
086100         10  MR-3RD-CTNS-NEWC           PIC  X(01).               08610099
086200         10  MR-3RD-CTNS-NEWH           PIC  X(01).               08620099
086300         10  MR-3RD-CTNS-NEW            PIC  ZZZZZZ.              08630099
086400                                                                  08640099
086500         10  MR-3RD-CTNS-EASL           PIC S9(04) COMP.          08650099
086600         10  MR-3RD-CTNS-EASA           PIC  X(01).               08660099
086700         10  MR-3RD-CTNS-EASC           PIC  X(01).               08670099
086800         10  MR-3RD-CTNS-EASH           PIC  X(01).               08680099
086900         10  MR-3RD-CTNS-EAS            PIC  ZZZZZZ.              08690099
087000                                                                  08700099
087100         10  MR-3RD-CTNS-CLRNCEL        PIC S9(04) COMP.          08710099
087200         10  MR-3RD-CTNS-CLRNCEA        PIC  X(01).               08720099
087300         10  MR-3RD-CTNS-CLRNCEC        PIC  X(01).               08730099
087400         10  MR-3RD-CTNS-CLRNCEH        PIC  X(01).               08740099
087500         10  MR-3RD-CTNS-CLRNCE         PIC  ZZZZZZ.              08750099
087600                                                                  08760099
087700         10  MR-3RD-CTNS-TOTALL         PIC S9(04) COMP.          08770099
087800         10  MR-3RD-CTNS-TOTALA         PIC  X(01).               08780099
087900         10  MR-3RD-CTNS-TOTALC         PIC  X(01).               08790099
088000         10  MR-3RD-CTNS-TOTALH         PIC  X(01).               08800099
088100         10  MR-3RD-CTNS-TOTAL          PIC  ZZZZZZ.              08810099
088200                                                                  08820099
088300* 3RD 25% SKUS                                                    08830099
088400         10  MR-3RD-SKUS-HARDL          PIC S9(04) COMP.          08840099
088500         10  MR-3RD-SKUS-HARDA          PIC  X(01).               08850099
088600         10  MR-3RD-SKUS-HARDC          PIC  X(01).               08860099
088700         10  MR-3RD-SKUS-HARDH          PIC  X(01).               08870099
088800         10  MR-3RD-SKUS-HARD           PIC  ZZZZZZ.              08880099
088900                                                                  08890099
089000         10  MR-3RD-SKUS-SOFTL          PIC S9(04) COMP.          08900099
089100         10  MR-3RD-SKUS-SOFTA          PIC  X(01).               08910099
089200         10  MR-3RD-SKUS-SOFTC          PIC  X(01).               08920099
089300         10  MR-3RD-SKUS-SOFTH          PIC  X(01).               08930099
089400         10  MR-3RD-SKUS-SOFT           PIC  ZZZZZZ.              08940099
089500                                                                  08950099
089600         10  MR-3RD-SKUS-HANGL          PIC S9(04) COMP.          08960099
089700         10  MR-3RD-SKUS-HANGA          PIC  X(01).               08970099
089800         10  MR-3RD-SKUS-HANGC          PIC  X(01).               08980099
089900         10  MR-3RD-SKUS-HANGH          PIC  X(01).               08990099
090000         10  MR-3RD-SKUS-HANG           PIC  ZZZZZZ.              09000099
090100                                                                  09010099
090200         10  MR-3RD-SKUS-FOLDL          PIC S9(04) COMP.          09020099
090300         10  MR-3RD-SKUS-FOLDA          PIC  X(01).               09030099
090400         10  MR-3RD-SKUS-FOLDC          PIC  X(01).               09040099
090500         10  MR-3RD-SKUS-FOLDH          PIC  X(01).               09050099
090600         10  MR-3RD-SKUS-FOLD           PIC  ZZZZZZ.              09060099
090700                                                                  09070099
090800         10  MR-3RD-SKUS-REPLL          PIC S9(04) COMP.          09080099
090900         10  MR-3RD-SKUS-REPLA          PIC  X(01).               09090099
091000         10  MR-3RD-SKUS-REPLC          PIC  X(01).               09100099
091100         10  MR-3RD-SKUS-REPLH          PIC  X(01).               09110099
091200         10  MR-3RD-SKUS-REPL           PIC  ZZZZZZ.              09120099
091300                                                                  09130099
091400         10  MR-3RD-SKUS-NEWL           PIC S9(04) COMP.          09140099
091500         10  MR-3RD-SKUS-NEWA           PIC  X(01).               09150099
091600         10  MR-3RD-SKUS-NEWC           PIC  X(01).               09160099
091700         10  MR-3RD-SKUS-NEWH           PIC  X(01).               09170099
091800         10  MR-3RD-SKUS-NEW            PIC  ZZZZZZ.              09180099
091900                                                                  09190099
092000         10  MR-3RD-SKUS-EASL           PIC S9(04) COMP.          09200099
092100         10  MR-3RD-SKUS-EASA           PIC  X(01).               09210099
092200         10  MR-3RD-SKUS-EASC           PIC  X(01).               09220099
092300         10  MR-3RD-SKUS-EASH           PIC  X(01).               09230099
092400         10  MR-3RD-SKUS-EAS            PIC  ZZZZZZ.              09240099
092500                                                                  09250099
092600         10  MR-3RD-SKUS-CLRNCEL        PIC S9(04) COMP.          09260099
092700         10  MR-3RD-SKUS-CLRNCEA        PIC  X(01).               09270099
092800         10  MR-3RD-SKUS-CLRNCEC        PIC  X(01).               09280099
092900         10  MR-3RD-SKUS-CLRNCEH        PIC  X(01).               09290099
093000         10  MR-3RD-SKUS-CLRNCE         PIC  ZZZZZZ.              09300099
093100                                                                  09310099
093200         10  MR-3RD-SKUS-TOTALL         PIC S9(04) COMP.          09320099
093300         10  MR-3RD-SKUS-TOTALA         PIC  X(01).               09330099
093400         10  MR-3RD-SKUS-TOTALC         PIC  X(01).               09340099
093500         10  MR-3RD-SKUS-TOTALH         PIC  X(01).               09350099
093600         10  MR-3RD-SKUS-TOTAL          PIC  ZZZZZZ.              09360099
093700                                                                  09370099
093800* 3ND 25% UNITS                                                   09380099
093900         10  MR-3RD-UNTS-HARDL          PIC S9(04) COMP.          09390099
094000         10  MR-3RD-UNTS-HARDA          PIC  X(01).               09400099
094100         10  MR-3RD-UNTS-HARDC          PIC  X(01).               09410099
094200         10  MR-3RD-UNTS-HARDH          PIC  X(01).               09420099
094300         10  MR-3RD-UNTS-HARD           PIC  ZZZZZZ.              09430099
094400                                                                  09440099
094500         10  MR-3RD-UNTS-SOFTL          PIC S9(04) COMP.          09450099
094600         10  MR-3RD-UNTS-SOFTA          PIC  X(01).               09460099
094700         10  MR-3RD-UNTS-SOFTC          PIC  X(01).               09470099
094800         10  MR-3RD-UNTS-SOFTH          PIC  X(01).               09480099
094900         10  MR-3RD-UNTS-SOFT           PIC  ZZZZZZ.              09490099
095000                                                                  09500099
095100         10  MR-3RD-UNTS-HANGL          PIC S9(04) COMP.          09510099
095200         10  MR-3RD-UNTS-HANGA          PIC  X(01).               09520099
095300         10  MR-3RD-UNTS-HANGC          PIC  X(01).               09530099
095400         10  MR-3RD-UNTS-HANGH          PIC  X(01).               09540099
095500         10  MR-3RD-UNTS-HANG           PIC  ZZZZZZ.              09550099
095600                                                                  09560099
095700         10  MR-3RD-UNTS-FOLDL          PIC S9(04) COMP.          09570099
095800         10  MR-3RD-UNTS-FOLDA          PIC  X(01).               09580099
095900         10  MR-3RD-UNTS-FOLDC          PIC  X(01).               09590099
096000         10  MR-3RD-UNTS-FOLDH          PIC  X(01).               09600099
096100         10  MR-3RD-UNTS-FOLD           PIC  ZZZZZZ.              09610099
096200                                                                  09620099
096300         10  MR-3RD-UNTS-REPLL          PIC S9(04) COMP.          09630099
096400         10  MR-3RD-UNTS-REPLA          PIC  X(01).               09640099
096500         10  MR-3RD-UNTS-REPLC          PIC  X(01).               09650099
096600         10  MR-3RD-UNTS-REPLH          PIC  X(01).               09660099
096700         10  MR-3RD-UNTS-REPL           PIC  ZZZZZZ.              09670099
096800                                                                  09680099
096900         10  MR-3RD-UNTS-NEWL           PIC S9(04) COMP.          09690099
097000         10  MR-3RD-UNTS-NEWA           PIC  X(01).               09700099
097100         10  MR-3RD-UNTS-NEWC           PIC  X(01).               09710099
097200         10  MR-3RD-UNTS-NEWH           PIC  X(01).               09720099
097300         10  MR-3RD-UNTS-NEW            PIC  ZZZZZZ.              09730099
097400                                                                  09740099
097500         10  MR-3RD-UNTS-EASL           PIC S9(04) COMP.          09750099
097600         10  MR-3RD-UNTS-EASA           PIC  X(01).               09760099
097700         10  MR-3RD-UNTS-EASC           PIC  X(01).               09770099
097800         10  MR-3RD-UNTS-EASH           PIC  X(01).               09780099
097900         10  MR-3RD-UNTS-EAS            PIC  ZZZZZZ.              09790099
098000                                                                  09800099
098100         10  MR-3RD-UNTS-CLRNCEL        PIC S9(04) COMP.          09810099
098200         10  MR-3RD-UNTS-CLRNCEA        PIC  X(01).               09820099
098300         10  MR-3RD-UNTS-CLRNCEC        PIC  X(01).               09830099
098400         10  MR-3RD-UNTS-CLRNCEH        PIC  X(01).               09840099
098500         10  MR-3RD-UNTS-CLRNCE         PIC  ZZZZZZ.              09850099
098600                                                                  09860099
098700         10  MR-3RD-UNTS-TOTALL         PIC S9(04) COMP.          09870099
098800         10  MR-3RD-UNTS-TOTALA         PIC  X(01).               09880099
098900         10  MR-3RD-UNTS-TOTALC         PIC  X(01).               09890099
099000         10  MR-3RD-UNTS-TOTALH         PIC  X(01).               09900099
099100         10  MR-3RD-UNTS-TOTAL          PIC  ZZZZZZ.              09910099
099200                                                                  09920099
099300* 4TH 25% CTNS                                                    09930099
099400         10  MR-4TH-CTNS-HARDL          PIC S9(04) COMP.          09940099
099500         10  MR-4TH-CTNS-HARDA          PIC  X(01).               09950099
099600         10  MR-4TH-CTNS-HARDC          PIC  X(01).               09960099
099700         10  MR-4TH-CTNS-HARDH          PIC  X(01).               09970099
099800         10  MR-4TH-CTNS-HARD           PIC  ZZZZZZ.              09980099
099900                                                                  09990099
100000         10  MR-4TH-CTNS-SOFTL          PIC S9(04) COMP.          10000099
100100         10  MR-4TH-CTNS-SOFTA          PIC  X(01).               10010099
100200         10  MR-4TH-CTNS-SOFTC          PIC  X(01).               10020099
100300         10  MR-4TH-CTNS-SOFTH          PIC  X(01).               10030099
100400         10  MR-4TH-CTNS-SOFT           PIC  ZZZZZZ.              10040099
100500                                                                  10050099
100600         10  MR-4TH-CTNS-HANGL          PIC S9(04) COMP.          10060099
100700         10  MR-4TH-CTNS-HANGA          PIC  X(01).               10070099
100800         10  MR-4TH-CTNS-HANGC          PIC  X(01).               10080099
100900         10  MR-4TH-CTNS-HANGH          PIC  X(01).               10090099
101000         10  MR-4TH-CTNS-HANG           PIC  ZZZZZZ.              10100099
101100                                                                  10110099
101200         10  MR-4TH-CTNS-FOLDL          PIC S9(04) COMP.          10120099
101300         10  MR-4TH-CTNS-FOLDA          PIC  X(01).               10130099
101400         10  MR-4TH-CTNS-FOLDC          PIC  X(01).               10140099
101500         10  MR-4TH-CTNS-FOLDH          PIC  X(01).               10150099
101600         10  MR-4TH-CTNS-FOLD           PIC  ZZZZZZ.              10160099
101700                                                                  10170099
101800         10  MR-4TH-CTNS-REPLL          PIC S9(04) COMP.          10180099
101900         10  MR-4TH-CTNS-REPLA          PIC  X(01).               10190099
102000         10  MR-4TH-CTNS-REPLC          PIC  X(01).               10200099
102100         10  MR-4TH-CTNS-REPLH          PIC  X(01).               10210099
102200         10  MR-4TH-CTNS-REPL           PIC  ZZZZZZ.              10220099
102300                                                                  10230099
102400         10  MR-4TH-CTNS-NEWL           PIC S9(04) COMP.          10240099
102500         10  MR-4TH-CTNS-NEWA           PIC  X(01).               10250099
102600         10  MR-4TH-CTNS-NEWC           PIC  X(01).               10260099
102700         10  MR-4TH-CTNS-NEWH           PIC  X(01).               10270099
102800         10  MR-4TH-CTNS-NEW            PIC  ZZZZZZ.              10280099
102900                                                                  10290099
103000         10  MR-4TH-CTNS-EASL           PIC S9(04) COMP.          10300099
103100         10  MR-4TH-CTNS-EASA           PIC  X(01).               10310099
103200         10  MR-4TH-CTNS-EASC           PIC  X(01).               10320099
103300         10  MR-4TH-CTNS-EASH           PIC  X(01).               10330099
103400         10  MR-4TH-CTNS-EAS            PIC  ZZZZZZ.              10340099
103500                                                                  10350099
103600         10  MR-4TH-CTNS-CLRNCEL        PIC S9(04) COMP.          10360099
103700         10  MR-4TH-CTNS-CLRNCEA        PIC  X(01).               10370099
103800         10  MR-4TH-CTNS-CLRNCEC        PIC  X(01).               10380099
103900         10  MR-4TH-CTNS-CLRNCEH        PIC  X(01).               10390099
104000         10  MR-4TH-CTNS-CLRNCE         PIC  ZZZZZZ.              10400099
104100                                                                  10410099
104200         10  MR-4TH-CTNS-TOTALL         PIC S9(04) COMP.          10420099
104300         10  MR-4TH-CTNS-TOTALA         PIC  X(01).               10430099
104400         10  MR-4TH-CTNS-TOTALC         PIC  X(01).               10440099
104500         10  MR-4TH-CTNS-TOTALH         PIC  X(01).               10450099
104600         10  MR-4TH-CTNS-TOTAL          PIC  ZZZZZZ.              10460099
104700                                                                  10470099
104800* 4TH 25% SKUS                                                    10480099
104900         10  MR-4TH-SKUS-HARDL          PIC S9(04) COMP.          10490099
105000         10  MR-4TH-SKUS-HARDA          PIC  X(01).               10500099
105100         10  MR-4TH-SKUS-HARDC          PIC  X(01).               10510099
105200         10  MR-4TH-SKUS-HARDH          PIC  X(01).               10520099
105300         10  MR-4TH-SKUS-HARD           PIC  ZZZZZZ.              10530099
105400                                                                  10540099
105500         10  MR-4TH-SKUS-SOFTL          PIC S9(04) COMP.          10550099
105600         10  MR-4TH-SKUS-SOFTA          PIC  X(01).               10560099
105700         10  MR-4TH-SKUS-SOFTC          PIC  X(01).               10570099
105800         10  MR-4TH-SKUS-SOFTH          PIC  X(01).               10580099
105900         10  MR-4TH-SKUS-SOFT           PIC  ZZZZZZ.              10590099
106000                                                                  10600099
106100         10  MR-4TH-SKUS-HANGL          PIC S9(04) COMP.          10610099
106200         10  MR-4TH-SKUS-HANGA          PIC  X(01).               10620099
106300         10  MR-4TH-SKUS-HANGC          PIC  X(01).               10630099
106400         10  MR-4TH-SKUS-HANGH          PIC  X(01).               10640099
106500         10  MR-4TH-SKUS-HANG           PIC  ZZZZZZ.              10650099
106600                                                                  10660099
106700         10  MR-4TH-SKUS-FOLDL          PIC S9(04) COMP.          10670099
106800         10  MR-4TH-SKUS-FOLDA          PIC  X(01).               10680099
106900         10  MR-4TH-SKUS-FOLDC          PIC  X(01).               10690099
107000         10  MR-4TH-SKUS-FOLDH          PIC  X(01).               10700099
107100         10  MR-4TH-SKUS-FOLD           PIC  ZZZZZZ.              10710099
107200                                                                  10720099
107300         10  MR-4TH-SKUS-REPLL          PIC S9(04) COMP.          10730099
107400         10  MR-4TH-SKUS-REPLA          PIC  X(01).               10740099
107500         10  MR-4TH-SKUS-REPLC          PIC  X(01).               10750099
107600         10  MR-4TH-SKUS-REPLH          PIC  X(01).               10760099
107700         10  MR-4TH-SKUS-REPL           PIC  ZZZZZZ.              10770099
107800                                                                  10780099
107900         10  MR-4TH-SKUS-NEWL           PIC S9(04) COMP.          10790099
108000         10  MR-4TH-SKUS-NEWA           PIC  X(01).               10800099
108100         10  MR-4TH-SKUS-NEWC           PIC  X(01).               10810099
108200         10  MR-4TH-SKUS-NEWH           PIC  X(01).               10820099
108300         10  MR-4TH-SKUS-NEW            PIC  ZZZZZZ.              10830099
108400                                                                  10840099
108500         10  MR-4TH-SKUS-EASL           PIC S9(04) COMP.          10850099
108600         10  MR-4TH-SKUS-EASA           PIC  X(01).               10860099
108700         10  MR-4TH-SKUS-EASC           PIC  X(01).               10870099
108800         10  MR-4TH-SKUS-EASH           PIC  X(01).               10880099
108900         10  MR-4TH-SKUS-EAS            PIC  ZZZZZZ.              10890099
109000                                                                  10900099
109100         10  MR-4TH-SKUS-CLRNCEL        PIC S9(04) COMP.          10910099
109200         10  MR-4TH-SKUS-CLRNCEA        PIC  X(01).               10920099
109300         10  MR-4TH-SKUS-CLRNCEC        PIC  X(01).               10930099
109400         10  MR-4TH-SKUS-CLRNCEH        PIC  X(01).               10940099
109500         10  MR-4TH-SKUS-CLRNCE         PIC  ZZZZZZ.              10950099
109600                                                                  10960099
109700         10  MR-4TH-SKUS-TOTALL         PIC S9(04) COMP.          10970099
109800         10  MR-4TH-SKUS-TOTALA         PIC  X(01).               10980099
109900         10  MR-4TH-SKUS-TOTALC         PIC  X(01).               10990099
110000         10  MR-4TH-SKUS-TOTALH         PIC  X(01).               11000099
110100         10  MR-4TH-SKUS-TOTAL          PIC  ZZZZZZ.              11010099
110200                                                                  11020099
110300* 4TH 25% UNITS                                                   11030099
110400         10  MR-4TH-UNTS-HARDL          PIC S9(04) COMP.          11040099
110500         10  MR-4TH-UNTS-HARDA          PIC  X(01).               11050099
110600         10  MR-4TH-UNTS-HARDC          PIC  X(01).               11060099
110700         10  MR-4TH-UNTS-HARDH          PIC  X(01).               11070099
110800         10  MR-4TH-UNTS-HARD           PIC  ZZZZZZ.              11080099
110900                                                                  11090099
111000         10  MR-4TH-UNTS-SOFTL          PIC S9(04) COMP.          11100099
111100         10  MR-4TH-UNTS-SOFTA          PIC  X(01).               11110099
111200         10  MR-4TH-UNTS-SOFTC          PIC  X(01).               11120099
111300         10  MR-4TH-UNTS-SOFTH          PIC  X(01).               11130099
111400         10  MR-4TH-UNTS-SOFT           PIC  ZZZZZZ.              11140099
111500                                                                  11150099
111600         10  MR-4TH-UNTS-HANGL          PIC S9(04) COMP.          11160099
111700         10  MR-4TH-UNTS-HANGA          PIC  X(01).               11170099
111800         10  MR-4TH-UNTS-HANGC          PIC  X(01).               11180099
111900         10  MR-4TH-UNTS-HANGH          PIC  X(01).               11190099
112000         10  MR-4TH-UNTS-HANG           PIC  ZZZZZZ.              11200099
112100                                                                  11210099
112200         10  MR-4TH-UNTS-FOLDL          PIC S9(04) COMP.          11220099
112300         10  MR-4TH-UNTS-FOLDA          PIC  X(01).               11230099
112400         10  MR-4TH-UNTS-FOLDC          PIC  X(01).               11240099
112500         10  MR-4TH-UNTS-FOLDH          PIC  X(01).               11250099
112600         10  MR-4TH-UNTS-FOLD           PIC  ZZZZZZ.              11260099
112700                                                                  11270099
112800         10  MR-4TH-UNTS-REPLL          PIC S9(04) COMP.          11280099
112900         10  MR-4TH-UNTS-REPLA          PIC  X(01).               11290099
113000         10  MR-4TH-UNTS-REPLC          PIC  X(01).               11300099
113100         10  MR-4TH-UNTS-REPLH          PIC  X(01).               11310099
113200         10  MR-4TH-UNTS-REPL           PIC  ZZZZZZ.              11320099
113300                                                                  11330099
113400         10  MR-4TH-UNTS-NEWL           PIC S9(04) COMP.          11340099
113500         10  MR-4TH-UNTS-NEWA           PIC  X(01).               11350099
113600         10  MR-4TH-UNTS-NEWC           PIC  X(01).               11360099
113700         10  MR-4TH-UNTS-NEWH           PIC  X(01).               11370099
113800         10  MR-4TH-UNTS-NEW            PIC  ZZZZZZ.              11380099
113900                                                                  11390099
114000         10  MR-4TH-UNTS-EASL           PIC S9(04) COMP.          11400099
114100         10  MR-4TH-UNTS-EASA           PIC  X(01).               11410099
114200         10  MR-4TH-UNTS-EASC           PIC  X(01).               11420099
114300         10  MR-4TH-UNTS-EASH           PIC  X(01).               11430099
114400         10  MR-4TH-UNTS-EAS            PIC  ZZZZZZ.              11440099
114500                                                                  11450099
114600         10  MR-4TH-UNTS-CLRNCEL        PIC S9(04) COMP.          11460099
114700         10  MR-4TH-UNTS-CLRNCEA        PIC  X(01).               11470099
114800         10  MR-4TH-UNTS-CLRNCEC        PIC  X(01).               11480099
114900         10  MR-4TH-UNTS-CLRNCEH        PIC  X(01).               11490099
115000         10  MR-4TH-UNTS-CLRNCE         PIC  ZZZZZZ.              11500099
115100                                                                  11510099
115200         10  MR-4TH-UNTS-TOTALL         PIC S9(04) COMP.          11520099
115300         10  MR-4TH-UNTS-TOTALA         PIC  X(01).               11530099
115400         10  MR-4TH-UNTS-TOTALC         PIC  X(01).               11540099
115500         10  MR-4TH-UNTS-TOTALH         PIC  X(01).               11550099
115600         10  MR-4TH-UNTS-TOTAL          PIC  ZZZZZZ.              11560099
115700                                                                  11570099
115800* TOTAL ALL QUARTERS CTNS                                         11580099
115900         10  MR-TOT-CTNS-HARDL          PIC S9(04) COMP.          11590099
116000         10  MR-TOT-CTNS-HARDA          PIC  X(01).               11600099
116100         10  MR-TOT-CTNS-HARDC          PIC  X(01).               11610099
116200         10  MR-TOT-CTNS-HARDH          PIC  X(01).               11620099
116300         10  MR-TOT-CTNS-HARD           PIC  ZZZZZZ.              11630099
116400                                                                  11640099
116500         10  MR-TOT-CTNS-SOFTL          PIC S9(04) COMP.          11650099
116600         10  MR-TOT-CTNS-SOFTA          PIC  X(01).               11660099
116700         10  MR-TOT-CTNS-SOFTC          PIC  X(01).               11670099
116800         10  MR-TOT-CTNS-SOFTH          PIC  X(01).               11680099
116900         10  MR-TOT-CTNS-SOFT           PIC  ZZZZZZ.              11690099
117000                                                                  11700099
117100         10  MR-TOT-CTNS-HANGL          PIC S9(04) COMP.          11710099
117200         10  MR-TOT-CTNS-HANGA          PIC  X(01).               11720099
117300         10  MR-TOT-CTNS-HANGC          PIC  X(01).               11730099
117400         10  MR-TOT-CTNS-HANGH          PIC  X(01).               11740099
117500         10  MR-TOT-CTNS-HANG           PIC  ZZZZZZ.              11750099
117600                                                                  11760099
117700         10  MR-TOT-CTNS-FOLDL          PIC S9(04) COMP.          11770099
117800         10  MR-TOT-CTNS-FOLDA          PIC  X(01).               11780099
117900         10  MR-TOT-CTNS-FOLDC          PIC  X(01).               11790099
118000         10  MR-TOT-CTNS-FOLDH          PIC  X(01).               11800099
118100         10  MR-TOT-CTNS-FOLD           PIC  ZZZZZZ.              11810099
118200                                                                  11820099
118300         10  MR-TOT-CTNS-REPLL          PIC S9(04) COMP.          11830099
118400         10  MR-TOT-CTNS-REPLA          PIC  X(01).               11840099
118500         10  MR-TOT-CTNS-REPLC          PIC  X(01).               11850099
118600         10  MR-TOT-CTNS-REPLH          PIC  X(01).               11860099
118700         10  MR-TOT-CTNS-REPL           PIC  ZZZZZZ.              11870099
118800                                                                  11880099
118900         10  MR-TOT-CTNS-NEWL           PIC S9(04) COMP.          11890099
119000         10  MR-TOT-CTNS-NEWA           PIC  X(01).               11900099
119100         10  MR-TOT-CTNS-NEWC           PIC  X(01).               11910099
119200         10  MR-TOT-CTNS-NEWH           PIC  X(01).               11920099
119300         10  MR-TOT-CTNS-NEW            PIC  ZZZZZZ.              11930099
119400                                                                  11940099
119500         10  MR-TOT-CTNS-EASL           PIC S9(04) COMP.          11950099
119600         10  MR-TOT-CTNS-EASA           PIC  X(01).               11960099
119700         10  MR-TOT-CTNS-EASC           PIC  X(01).               11970099
119800         10  MR-TOT-CTNS-EASH           PIC  X(01).               11980099
119900         10  MR-TOT-CTNS-EAS            PIC  ZZZZZZ.              11990099
120000                                                                  12000099
120100         10  MR-TOT-CTNS-CLRNCEL        PIC S9(04) COMP.          12010099
120200         10  MR-TOT-CTNS-CLRNCEA        PIC  X(01).               12020099
120300         10  MR-TOT-CTNS-CLRNCEC        PIC  X(01).               12030099
120400         10  MR-TOT-CTNS-CLRNCEH        PIC  X(01).               12040099
120500         10  MR-TOT-CTNS-CLRNCE         PIC  ZZZZZZ.              12050099
120600                                                                  12060099
120700         10  MR-TOT-CTNS-TOTALL         PIC S9(04) COMP.          12070099
120800         10  MR-TOT-CTNS-TOTALA         PIC  X(01).               12080099
120900         10  MR-TOT-CTNS-TOTALC         PIC  X(01).               12090099
121000         10  MR-TOT-CTNS-TOTALH         PIC  X(01).               12100099
121100         10  MR-TOT-CTNS-TOTAL          PIC  ZZZZZZ.              12110099
121200                                                                  12120099
121300* TOTAL ALL QUARTERS SKUS                                         12130099
121400         10  MR-TOT-SKUS-HARDL          PIC S9(04) COMP.          12140099
121500         10  MR-TOT-SKUS-HARDA          PIC  X(01).               12150099
121600         10  MR-TOT-SKUS-HARDC          PIC  X(01).               12160099
121700         10  MR-TOT-SKUS-HARDH          PIC  X(01).               12170099
121800         10  MR-TOT-SKUS-HARD           PIC  ZZZZZZ.              12180099
121900                                                                  12190099
122000         10  MR-TOT-SKUS-SOFTL          PIC S9(04) COMP.          12200099
122100         10  MR-TOT-SKUS-SOFTA          PIC  X(01).               12210099
122200         10  MR-TOT-SKUS-SOFTC          PIC  X(01).               12220099
122300         10  MR-TOT-SKUS-SOFTH          PIC  X(01).               12230099
122400         10  MR-TOT-SKUS-SOFT           PIC  ZZZZZZ.              12240099
122500                                                                  12250099
122600         10  MR-TOT-SKUS-HANGL          PIC S9(04) COMP.          12260099
122700         10  MR-TOT-SKUS-HANGA          PIC  X(01).               12270099
122800         10  MR-TOT-SKUS-HANGC          PIC  X(01).               12280099
122900         10  MR-TOT-SKUS-HANGH          PIC  X(01).               12290099
123000         10  MR-TOT-SKUS-HANG           PIC  ZZZZZZ.              12300099
123100                                                                  12310099
123200         10  MR-TOT-SKUS-FOLDL          PIC S9(04) COMP.          12320099
123300         10  MR-TOT-SKUS-FOLDA          PIC  X(01).               12330099
123400         10  MR-TOT-SKUS-FOLDC          PIC  X(01).               12340099
123500         10  MR-TOT-SKUS-FOLDH          PIC  X(01).               12350099
123600         10  MR-TOT-SKUS-FOLD           PIC  ZZZZZZ.              12360099
123700                                                                  12370099
123800         10  MR-TOT-SKUS-REPLL          PIC S9(04) COMP.          12380099
123900         10  MR-TOT-SKUS-REPLA          PIC  X(01).               12390099
124000         10  MR-TOT-SKUS-REPLC          PIC  X(01).               12400099
124100         10  MR-TOT-SKUS-REPLH          PIC  X(01).               12410099
124200         10  MR-TOT-SKUS-REPL           PIC  ZZZZZZ.              12420099
124300                                                                  12430099
124400         10  MR-TOT-SKUS-NEWL           PIC S9(04) COMP.          12440099
124500         10  MR-TOT-SKUS-NEWA           PIC  X(01).               12450099
124600         10  MR-TOT-SKUS-NEWC           PIC  X(01).               12460099
124700         10  MR-TOT-SKUS-NEWH           PIC  X(01).               12470099
124800         10  MR-TOT-SKUS-NEW            PIC  ZZZZZZ.              12480099
124900                                                                  12490099
125000         10  MR-TOT-SKUS-EASL           PIC S9(04) COMP.          12500099
125100         10  MR-TOT-SKUS-EASA           PIC  X(01).               12510099
125200         10  MR-TOT-SKUS-EASC           PIC  X(01).               12520099
125300         10  MR-TOT-SKUS-EASH           PIC  X(01).               12530099
125400         10  MR-TOT-SKUS-EAS            PIC  ZZZZZZ.              12540099
125500                                                                  12550099
125600         10  MR-TOT-SKUS-CLRNCEL        PIC S9(04) COMP.          12560099
125700         10  MR-TOT-SKUS-CLRNCEA        PIC  X(01).               12570099
125800         10  MR-TOT-SKUS-CLRNCEC        PIC  X(01).               12580099
125900         10  MR-TOT-SKUS-CLRNCEH        PIC  X(01).               12590099
126000         10  MR-TOT-SKUS-CLRNCE         PIC  ZZZZZZ.              12600099
126100                                                                  12610099
126200         10  MR-TOT-SKUS-TOTALL         PIC S9(04) COMP.          12620099
126300         10  MR-TOT-SKUS-TOTALA         PIC  X(01).               12630099
126400         10  MR-TOT-SKUS-TOTALC         PIC  X(01).               12640099
126500         10  MR-TOT-SKUS-TOTALH         PIC  X(01).               12650099
126600         10  MR-TOT-SKUS-TOTAL          PIC  ZZZZZZ.              12660099
126700                                                                  12670099
126800* TOTAL ALL QUARTERS UNITS                                        12680099
126900         10  MR-TOT-UNTS-HARDL          PIC S9(04) COMP.          12690099
127000         10  MR-TOT-UNTS-HARDA          PIC  X(01).               12700099
127100         10  MR-TOT-UNTS-HARDC          PIC  X(01).               12710099
127200         10  MR-TOT-UNTS-HARDH          PIC  X(01).               12720099
127300         10  MR-TOT-UNTS-HARD           PIC  ZZZZZZ.              12730099
127400                                                                  12740099
127500         10  MR-TOT-UNTS-SOFTL          PIC S9(04) COMP.          12750099
127600         10  MR-TOT-UNTS-SOFTA          PIC  X(01).               12760099
127700         10  MR-TOT-UNTS-SOFTC          PIC  X(01).               12770099
127800         10  MR-TOT-UNTS-SOFTH          PIC  X(01).               12780099
127900         10  MR-TOT-UNTS-SOFT           PIC  ZZZZZZ.              12790099
128000                                                                  12800099
128100         10  MR-TOT-UNTS-HANGL          PIC S9(04) COMP.          12810099
128200         10  MR-TOT-UNTS-HANGA          PIC  X(01).               12820099
128300         10  MR-TOT-UNTS-HANGC          PIC  X(01).               12830099
128400         10  MR-TOT-UNTS-HANGH          PIC  X(01).               12840099
128500         10  MR-TOT-UNTS-HANG           PIC  ZZZZZZ.              12850099
128600                                                                  12860099
128700         10  MR-TOT-UNTS-FOLDL          PIC S9(04) COMP.          12870099
128800         10  MR-TOT-UNTS-FOLDA          PIC  X(01).               12880099
128900         10  MR-TOT-UNTS-FOLDC          PIC  X(01).               12890099
129000         10  MR-TOT-UNTS-FOLDH          PIC  X(01).               12900099
129100         10  MR-TOT-UNTS-FOLD           PIC  ZZZZZZ.              12910099
129200                                                                  12920099
129300         10  MR-TOT-UNTS-REPLL          PIC S9(04) COMP.          12930099
129400         10  MR-TOT-UNTS-REPLA          PIC  X(01).               12940099
129500         10  MR-TOT-UNTS-REPLC          PIC  X(01).               12950099
129600         10  MR-TOT-UNTS-REPLH          PIC  X(01).               12960099
129700         10  MR-TOT-UNTS-REPL           PIC  ZZZZZZ.              12970099
129800                                                                  12980099
129900         10  MR-TOT-UNTS-NEWL           PIC S9(04) COMP.          12990099
130000         10  MR-TOT-UNTS-NEWA           PIC  X(01).               13000099
130100         10  MR-TOT-UNTS-NEWC           PIC  X(01).               13010099
130200         10  MR-TOT-UNTS-NEWH           PIC  X(01).               13020099
130300         10  MR-TOT-UNTS-NEW            PIC  ZZZZZZ.              13030099
130400                                                                  13040099
130500         10  MR-TOT-UNTS-EASL           PIC S9(04) COMP.          13050099
130600         10  MR-TOT-UNTS-EASA           PIC  X(01).               13060099
130700         10  MR-TOT-UNTS-EASC           PIC  X(01).               13070099
130800         10  MR-TOT-UNTS-EASH           PIC  X(01).               13080099
130900         10  MR-TOT-UNTS-EAS            PIC  ZZZZZZ.              13090099
131000                                                                  13100099
131100         10  MR-TOT-UNTS-CLRNCEL        PIC S9(04) COMP.          13110099
131200         10  MR-TOT-UNTS-CLRNCEA        PIC  X(01).               13120099
131300         10  MR-TOT-UNTS-CLRNCEC        PIC  X(01).               13130099
131400         10  MR-TOT-UNTS-CLRNCEH        PIC  X(01).               13140099
131500         10  MR-TOT-UNTS-CLRNCE         PIC  ZZZZZZ.              13150099
131600                                                                  13160099
131700         10  MR-TOT-UNTS-TOTALL         PIC S9(04) COMP.          13170099
131800         10  MR-TOT-UNTS-TOTALA         PIC  X(01).               13180099
131900         10  MR-TOT-UNTS-TOTALC         PIC  X(01).               13190099
132000         10  MR-TOT-UNTS-TOTALH         PIC  X(01).               13200099
132100         10  MR-TOT-UNTS-TOTAL          PIC  ZZZZZZ.              13210099
132200                                                                  13220099
132300***************************************************************** 13230099
132400                                                                  13240099
132500*---------------------------------------------------------------* 13250099
132600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 13260099
132700*---------------------------------------------------------------* 13270099
132800     COPY DPWS015.                                                13280099
132900                                                                  13290099
133000*---------------------------------------------------------------* 13300099
133100*    FUNCTION KEYS COPYBOOK.                                    * 13310099
133200*---------------------------------------------------------------* 13320099
133300     COPY DPWS016.                                                13330099
133400                                                                  13340099
133500*---------------------------------------------------------------* 13350099
133600*    NUMERIC EDIT LAYOUT.                                       * 13360099
133700*---------------------------------------------------------------* 13370099
133800     COPY DPWS010I.                                               13380099
133900                                                                  13390099
134000*----------------------------------------------------------------*13400099
134100**  SECURITY SUBROUTINE PARAMETERS                                13410099
134200*----------------------------------------------------------------*13420099
134300     COPY DPWS008.                                                13430099
134400                                                                  13440099
134500*---------------------------------------------------------------* 13450099
134600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 13460099
134700*---------------------------------------------------------------* 13470099
134800     COPY DPWS030.                                                13480099
134800     COPY DPWS930.                                                13481099
134900                                                                  13490099
135000*---------------------------------------------------------------* 13500099
135100*    STANDARD COMMAREA.                                         * 13510099
135200*---------------------------------------------------------------* 13520099
135300     COPY DPWS020.                                                13530099
135400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                13540099
135500                                                                  13550099
135600*---------------------------------------------------------------* 13560099
135700* INTER-APPLICATION COMMAREA.                                   * 13570099
135800*   SUWS012 - IS THE COMMAREA USED TO PASS NON-SELECT ITEMS     * 13580099
135900*             FROM THE TRAILER STATUS LIST.                     * 13590099
136000*---------------------------------------------------------------* 13600099
136100                                                                  13610099
136200         10  INTER-APPL-COMM-AREA       PIC X(200).               13620099
136300     COPY SUWS012.                                                13630099
136400*---------------------------------------------------------------* 13640099
136500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 13650099
136600*---------------------------------------------------------------* 13660099
136700         10  ASC-SPECIFIC-COMMAREA.                               13670099
136800             15  ASC-RQST-TMST               PIC  X(26).          13680099
136900             15  ASC-TRLR-SRL-NMBR           PIC  X(10).          13690099
137000             15  ASC-TRLR-ID                 PIC  X(12).          13700099
137100             15  ASC-STR-NBR-X               PIC  X(04).          13710099
137200             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           13720099
137300                 20  ASC-STR-NBR             PIC  9(04).          13730099
137400             15  ASC-STORE-NAME              PIC  X(20).          13740099
137500             15  ASC-OCRNC-TRIP-ID           PIC  9(09).          13750099
137600             15  ASC-OUTBOUND-TRIP-ID        PIC  9(09).          13760099
137700             15  FILLER                      PIC  X(025).         13770099
137800*-----------------------------------------------------------------13780099
137900             15  ASC-BLK-SUB                  PIC S9(04) COMP     13790099
138000                                                         SYNC.    13800099
138100             15  ASC-ITEM-SUB                 PIC S9(04) COMP     13810099
138200                                                         SYNC.    13820099
138300             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  13830099
138400             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  13840099
138500             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  13850099
138600             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  13860099
138700             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  13870099
138800             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     13880099
138900                                                         SYNC.    13890099
139000             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  13900099
139100             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  13910099
139200             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         13920099
139300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     13930099
139400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     13940099
139500             15  ASC-CARTONS-FOUND-SW        PIC  X(01).          13950099
139600                 88  ASC-CARTONS-FOUND-YES         VALUE 'Y'.     13960099
139700                 88  ASC-CARTONS-FOUND-NO          VALUE 'N'.     13970099
139800             15  ASC-CARTON-HARD-SOFT-SW     PIC X(01).           13980099
139900                 88  ASC-HARDLINE-CARTON           VALUE 'H'.     13990099
140000                 88  ASC-SOFTLINE-CARTON           VALUE 'S'.     14000099
140100                 88  ASC-HARD-SOFT-NO              VALUE ' '.     14010099
140200             15  ASC-CARTON-HANG-FOLD-SW     PIC X(01).           14020099
140300                 88  ASC-HANG-CARTON               VALUE 'H'.     14030099
140400                 88  ASC-FOLD-CARTON               VALUE 'F'.     14040099
140500                 88  ASC-HANG-FOLD-NO              VALUE ' '.     14050099
140600             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         14060099
140700                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     14070099
140800                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     14080099
140900             15  ASC-LIST-QUEUE-NAME.                             14090099
141000                 20  ASC-LIST-TERM-ID         PIC  X(04).         14100099
141100                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  14110099
141200                 20  ASC-LIST-SEQ             PIC  9(01).         14120099
141300                                                                  14130099
141400             15  ASC-START-ITEM-REQUEST.                          14140099
141500                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         14150099
141600                                                                  14160099
141700             15  ASC-SEL-SUB                  PIC S9(4) COMP.     14170099
141800             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     14180099
141900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          14190099
142000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 14200099
142100             15  ASC-SEL-QUEUE-NAME-IN.                           14210099
142200                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         14220099
142300                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  14230099
142400                 20  ASC-SEL-SEQ-IN           PIC  9(01).         14240099
142500             15  ASC-SEL-QUEUE-NAME-OUT.                          14250099
142600                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         14260099
142700                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  14270099
142800                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         14280099
142900             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  14290099
143000                                                                  14300099
143100*-----------------------------------------------------------------14310099
143200             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                14320099
143300                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  14330099
143400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   14340099
143500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   14350099
143600                                                                  14360099
143700                 20  ASC-ITEM-ARRAY.                              14370099
143800                     25  ASC-ITEM-ENTRIES OCCURS 01 TIMES.        14380099
143900                         30  ASC-LIST-ITEM-NUMBER                 14390099
144000                                                     PIC S9(09)   14400099
144100                                                     COMP-3.      14410099
144200                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  14420099
144300                             88  ASC-VALID-SELECT    VALUE ' '    14430099
144400                                                           'S'    14440099
144500                                                           'B'    14450099
144600                                                           'E'.   14460099
144700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   14470099
144800                             88  ASC-TEMP-SELECT     VALUE 'S'.   14480099
144900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   14490099
145000                             88  ASC-TEMP-END        VALUE 'E'.   14500099
145100                         30  ASC-SELECTED-SW         PIC  X(01).  14510099
145200                             88  ASC-NO-SELECT       VALUE ' '.   14520099
145300                             88  ASC-SELECT          VALUE 'S'.   14530099
145400                             88  ASC-BEGIN           VALUE 'B'.   14540099
145500                             88  ASC-END             VALUE 'E'.   14550099
145600                         30  ASC-ACTION              PIC  X(03).  14560099
145700             15  DETAILS-ARRAY.                                   14570099
145800                 20  ASC-QUARTER-ENTRIES OCCURS 5 TIMES           14580099
145900                          INDEXED BY SUB1.                        14590099
146000                                                                  14600099
146100                    25  ASC-COUNT-ENTRIES OCCURS 3 TIMES          14610099
146200                          INDEXED BY SUB2.                        14620099
146300                                                                  14630099
146400                         30  ASC-CATEGORY-ENTRIES OCCURS 9 TIMES  14640099
146500                              INDEXED BY SUB3.                    14650099
146600                                                                  14660099
146700                             35  ASC-COUNT         PIC S9(6) COMP 14670099
146800                                                             SYNC.14680099
146900                                                                  14690099
147000*---------------------------------------------------------------* 14700099
147100*    ABEND PROCESSING COPYBOOK.                                 * 14710099
147200*---------------------------------------------------------------* 14720099
147300     COPY DPWS013.                                                14730099
147400                                                                  14740099
147500*---------------------------------------------------------------* 14750099
147600*    SUT_TRIP_SUM  - SU - TRIP SUMMARY TABLE                    * 14760099
147700*---------------------------------------------------------------* 14770099
147800     EXEC SQL                                                     14780099
147900          INCLUDE SUT00007                                        14790099
148000     END-EXEC.                                                    14800099
148100                                                                  14810099
148200*---------------------------------------------------------------* 14820099
148300*    SUT_TRIP_DTL_SUM  - SU - TRIP SUMMARY TABLE                * 14830099
148400*---------------------------------------------------------------* 14840099
148500     EXEC SQL                                                     14850099
148600          INCLUDE SUT00095                                        14860099
148700     END-EXEC.                                                    14870099
148800                                                                  14880099
148900                                                                  14890099
149000*---------------------------------------------------------------* 14900099
149100*    DETAIL CURSOR                                                14910099
149200*---------------------------------------------------------------* 14920099
149300     EXEC SQL                                                     14930099
149400          DECLARE DTL-CSR CURSOR FOR                              14940099
149500              SELECT  TRIP_OCRNC_ID                               14950099
149600                     ,DIVERT_TMST                                 14960099
149700                     ,SHIPT_UNT_ID                                14970099
149800                     ,SKU_NBR                                     14980099
149900                     ,MDSE_LNE_CDE                                14990099
150000                     ,HNG_FOLD_SEQ_NBR                            15000099
150100                     ,PRC_MSG_CDE                                 15010099
150200                     ,EAS_TAG_IND                                 15020099
150300                     ,UNT_QTY                                     15030099
150400                FROM  SUT_TRIP_DTL_SUM                            15040099
150500               WHERE  TRIP_OCRNC_ID       = :DK-TRIP-OCRNC-ID     15050099
150600            ORDER BY  DIVERT_TMST DESC                            15060099
150700                     ,SHIPT_UNT_ID                                15070099
150800                     ,SKU_NBR                                     15080099
150900     END-EXEC.                                                    15090099
151000                                                                  15100099
151100*---------------------------------------------------------------* 15110099
151200*    DB2 AREA FOR COMMUNICATIONS                                * 15120099
151300*---------------------------------------------------------------* 15130099
151400     EXEC SQL                                                     15140099
151500          INCLUDE SQLCA                                           15150099
151600     END-EXEC.                                                    15160099
151700                                                                  15170099
151800*-----------------------------------------------------------------15180099
151900 LINKAGE SECTION.                                                 15190099
152000                                                                  15200099
152100 01  DFHCOMMAREA.                                                 15210099
152200     05  FILLER                         OCCURS  1 TO 4072 TIMES   15220099
152300                                        DEPENDING ON EIBCALEN.    15230099
152400         10  FILLER                     PIC X.                    15240099
152500                                                                  15250099
152600                                                                  15260099
152700 PROCEDURE DIVISION.                                              15270099
152800******************************************************************15280099
152900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **15290099
153000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **15300099
153100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **15310099
153200******************************************************************15320099
153300 0000-MAIN-MODULE.                                                15330099
153400     INITIALIZE DP030-CICS-API-FIELDS.                            15340099
153500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       15350099
153600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          15360099
153700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         15370099
153800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       15380099
153900     MOVE LENGTH OF SU545AI        TO DP030-MAP-LENGTH (1).       15390099
154000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     15400099
154100     PERFORM 0001-CALL-CICS-ARCH-API.                             15410099
154200*                                                                 15420099
154300     PERFORM 1000-CONTROL-PROCESSING                              15430099
154400*                                                                 15440099
154500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     15450099
154600     PERFORM 0001-CALL-CICS-ARCH-API.                             15460099
154700                                                                  15470099
154800******************************************************************15480099
154900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **15490099
155000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **15500099
155100******************************************************************15510099
155200 0001-CALL-CICS-ARCH-API.                                         15520099
155300*    CALL 'DPKCS030' USING DFHEIBLK                               15530099
155300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      15531099
155400                           DFHCOMMAREA                            15540099
155500                           DP030-CICS-API-FIELDS                  15550099
155600                           DP020-STANDARD-COMMAREA                15560099
155700                           SU545AI.                               15570099
155800*                                                                 15580099
155900     IF  DP030-RC-CALL-SUCCESSFUL                                 15590099
156000         CONTINUE                                                 15600099
156100     ELSE                                                         15610099
156200         SET DP013-NO-ROLLBACK                                    15620099
156300             DP013-XCTL-DISPLAY-RESTART                           15630099
156400             DP013-CICS-ABEND      TO TRUE                        15640099
156500         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        15650099
156600*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX15660099
156700*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      15670099
156600         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O15671099
156700-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      15672099
156800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      15680099
156900         PERFORM DP013-0000-PROCESS-ABEND                         15690099
157000     END-IF.                                                      15700099
157100                                                                  15710099
157200*----------------------------------------------------------------*15720099
157300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *15730099
157400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *15740099
157500*                                                                *15750099
157600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *15760099
157700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *15770099
157800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *15780099
157900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *15790099
158000*----------------------------------------------------------------*15800099
158100 1000-CONTROL-PROCESSING.                                         15810099
158200                                                                  15820099
158300     EVALUATE TRUE                                                15830099
158400         WHEN DP020-NEXT-ACT-INITIAL                              15840099
158500             INITIALIZE ASC-SPECIFIC-COMMAREA                     15850099
158600             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            15860099
158700                                      ASC-SEL-TERM-ID-OUT         15870099
158800             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   15880099
158900                                        ASC-SEL-TASK-NUMBER-OUT   15890099
159000             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              15900099
159100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             15910099
159200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 15920099
159300             PERFORM 4000-BUILD-INITIAL-PANEL                     15930099
159400                                                                  15940099
159500         WHEN DP020-NEXT-ACT-READ-MAP                             15950099
159600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         15960099
159700             PERFORM 2000-PROCESS-PANEL                           15970099
159800                                                                  15980099
159900         WHEN DP020-NEXT-ACT-RETURN                               15990099
160000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         16000099
160100             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               16010099
160200             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 16020099
160300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16030099
160400                                                                  16040099
160500         WHEN OTHER                                               16050099
160600             SET DP013-LOGIC-ABEND TO TRUE                        16060099
160700             SET DP013-NO-ROLLBACK TO TRUE                        16070099
160800             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    16080099
160900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    16090099
161000                                   TO DP013-MESSAGE-TEXT(1)       16100099
161100             PERFORM DP013-0000-PROCESS-ABEND                     16110099
161200     END-EVALUATE.                                                16120099
161300                                                                  16130099
161400*----------------------------------------------------------------*16140099
161500* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *16150099
161600* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *16160099
161700*----------------------------------------------------------------*16170099
161800 1100-PROCESS-INTER-APPL-COMM.                                    16180099
161900                                                                  16190099
162000     SET PS-COMMAREA-VALID         TO TRUE.                       16200099
162100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     16210099
162200                                                                  16220099
162300     IF  DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT               16230099
162400         SET ASC-USE-SELECTION-QUEUE TO TRUE                      16240099
162500         MOVE SU012-NUMBER-OF-SELECTED-ITEMS TO                   16250099
162600                                      ASC-NUMBER-OF-SELECTED-ITEMS16260099
162700         MOVE SU012-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  16270099
162800         MOVE SU012-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   16280099
162900         MOVE SU012-STR-NBR            TO ASC-STR-NBR             16290099
163000         MOVE SU012-STR-NAME           TO ASC-STORE-NAME          16300099
163100         PERFORM 1120-PREPARE-LIST-ENTRY                          16310099
163200     END-IF.                                                      16320099
163300                                                                  16330099
163400*-----------------------------------------------------------------16340099
163500*  PREPARE LIST ENTRY                                             16350099
163600*-----------------------------------------------------------------16360099
163700 1120-PREPARE-LIST-ENTRY.                                         16370099
163800                                                                  16380099
163900     MOVE SU013-MAX-ITEMS          TO ASC-SEL-SUB.                16390099
164000     MOVE ZERO                     TO ASC-SEL-ITEM.               16400099
164100     PERFORM 1130-GET-NEXT-RECORD.                                16410099
164200                                                                  16420099
164300*-----------------------------------------------------------------16430099
164400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*16440099
164500*-----------------------------------------------------------------16450099
164600 1130-GET-NEXT-RECORD.                                            16460099
164700     ADD +1                       TO ASC-SEL-SUB.                 16470099
164800                                                                  16480099
164900     IF  ASC-SEL-SUB > SU013-MAX-ITEMS                            16490099
165000         ADD +1                   TO ASC-SEL-ITEM                 16500099
165100         MOVE +1                  TO ASC-SEL-SUB                  16510099
165200     END-IF.                                                      16520099
165300                                                                  16530099
165400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                16540099
165500         PERFORM 9100-READ-SEL-QUEUE                              16550099
165600                                                                  16560099
165700         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      16570099
165800             INITIALIZE DETAILS-ARRAY                             16580099
165900             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               16590099
166000                                TO ASC-OCRNC-TRIP-ID              16600099
166100             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     16610099
166200                                TO ASC-OUTBOUND-TRIP-ID           16620099
166300             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     16630099
166400                                TO ASC-TRLR-ID                    16640099
166500             MOVE SU013-TRLR-SRL-NBR  (ASC-SEL-SUB)               16650099
166600                                TO ASC-TRLR-SRL-NMBR              16660099
166700             SET SU013-INQ (ASC-SEL-SUB) TO TRUE                  16670099
166800             PERFORM 9200-REWRITE-SEL-QUEUE                       16680099
166900         ELSE                                                     16690099
167000             SUBTRACT +1 FROM ASC-SEL-SUB                         16700099
167100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             16710099
167200             SET DP020-MSG-INFORMATIONAL                          16720099
167300                 PS-LIST-END             TO TRUE                  16730099
167400         END-IF                                                   16740099
167500     ELSE                                                         16750099
167600         SUBTRACT +1 FROM ASC-SEL-ITEM                            16760099
167700         MOVE SU013-MAX-ITEMS     TO ASC-SEL-SUB                  16770099
167800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             16780099
167900         SET DP020-MSG-INFORMATIONAL                              16790099
168000             PS-LIST-END             TO TRUE                      16800099
168100     END-IF.                                                      16810099
168200                                                                  16820099
168300*----------------------------------------------------------------*16830099
168400*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *16840099
168500*    PROCESSED.                                                  *16850099
168600*----------------------------------------------------------------*16860099
168700 1140-GET-PREV-RECORD.                                            16870099
168800     SUBTRACT +1 FROM ASC-SEL-SUB.                                16880099
168900                                                                  16890099
169000     IF  ASC-SEL-SUB < +1                                         16900099
169100         SUBTRACT +1 FROM ASC-SEL-ITEM                            16910099
169200         MOVE SU013-MAX-ITEMS     TO ASC-SEL-SUB                  16920099
169300     END-IF.                                                      16930099
169400                                                                  16940099
169500     IF  ASC-SEL-ITEM > ZERO                                      16950099
169600         PERFORM 9100-READ-SEL-QUEUE                              16960099
169700                                                                  16970099
169800         INITIALIZE DETAILS-ARRAY                                 16980099
169900         MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)                   16990099
170000                            TO ASC-OCRNC-TRIP-ID                  17000099
170100         MOVE SU013-TRIP-ID (ASC-SEL-SUB)                         17010099
170200                            TO ASC-OUTBOUND-TRIP-ID               17020099
170300         MOVE SU013-TRLR-ID (ASC-SEL-SUB)                         17030099
170400                            TO ASC-TRLR-ID                        17040099
170500         MOVE SU013-TRLR-SRL-NBR  (ASC-SEL-SUB)                   17050099
170600                            TO ASC-TRLR-SRL-NMBR                  17060099
170700         SET SU013-INQ (ASC-SEL-SUB) TO TRUE                      17070099
170800         PERFORM 9200-REWRITE-SEL-QUEUE                           17080099
170900     ELSE                                                         17090099
171000         MOVE +1                  TO ASC-SEL-ITEM                 17100099
171100                                     ASC-SEL-SUB                  17110099
171200         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             17120099
171300         SET DP020-MSG-INFORMATIONAL                              17130099
171400             PS-LIST-END             TO TRUE                      17140099
171500     END-IF.                                                      17150099
171600                                                                  17160099
171700*----------------------------------------------------------------*17170099
171800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *17180099
171900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *17190099
172000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *17200099
172100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *17210099
172200* FUNCTION KEYS CAN GET THIS FAR.                                *17220099
172300*----------------------------------------------------------------*17230099
172400 2000-PROCESS-PANEL.                                              17240099
172500     EVALUATE TRUE                                                17250099
172600         WHEN DP020-SRC-AID = DP016-CLEAR                         17260099
172700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    17270099
172800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17280099
172900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17290099
173000                                                                  17300099
173100*F5 REFRESH                                                       17310099
173200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    17320099
173300             IF ASC-CARTONS-FOUND-SW = 'Y'                        17330099
173400                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              17340099
173500             ELSE                                                 17350099
173600                MOVE ASC-STR-NBR              TO ASTOREO          17360099
173700                MOVE ASC-STORE-NAME           TO ASTNMEO          17370099
173800                MOVE ASC-TRLR-ID              TO ATRLRO           17380099
173900                MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO          17390099
174000                                                                  17400099
174100                SET DP020-MSG-WARNING TO  TRUE                    17410099
174200                MOVE PC-TSYMSG-03495 TO  DP020-MSG-NUMBER         17420099
174300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               17430099
174400             END-IF                                               17440099
174500                                                                  17450099
174600*F20 NEXT SELECT                                                  17460099
174700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             17470099
174800             IF  ASC-USE-SELECTION-QUEUE                          17480099
174900                 PERFORM 1130-GET-NEXT-RECORD                     17490099
175000                 IF PS-LIST-END                                   17500099
175100                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       17510099
175200                       SET PS-NO-LIST-END TO TRUE                 17520099
175300                 ELSE                                             17530099
175400                     PERFORM 2050-DELETE-LIST-QUEUE               17540099
175500***                  PERFORM 3200-RESET-ATTRIBUTES                17550099
175600                     PERFORM 4000-BUILD-INITIAL-PANEL             17560099
175700                 END-IF                                           17570099
175800              ELSE                                                17580099
175900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17590099
176000*                --- BOTTOM OF LIST ---                           17600099
176100                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         17610099
176200                 SET DP020-MSG-INFORMATIONAL TO TRUE              17620099
176300             END-IF                                               17630099
176400                                                                  17640099
176500*F19 PREV SELECT                                                  17650099
176600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             17660099
176700             IF  ASC-USE-SELECTION-QUEUE                          17670099
176800                 PERFORM 1140-GET-PREV-RECORD                     17680099
176900                 IF PS-LIST-END                                   17690099
177000                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       17700099
177100                       SET PS-NO-LIST-END TO TRUE                 17710099
177200                 ELSE                                             17720099
177300                     PERFORM 2050-DELETE-LIST-QUEUE               17730099
177400***                  PERFORM 3200-RESET-ATTRIBUTES                17740099
177500                     PERFORM 4000-BUILD-INITIAL-PANEL             17750099
177600                 END-IF                                           17760099
177700             ELSE                                                 17770099
177800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17780099
177900                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         17790099
178000                 SET DP020-MSG-INFORMATIONAL TO TRUE              17800099
178100             END-IF                                               17810099
178200                                                                  17820099
178300         WHEN OTHER                                               17830099
178400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 17840099
178500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   17850099
178600                                                                  17860099
178700             IF  PS-NO-ERROR                                      17870099
178800                 SET DP030-CONTINUE-GO TO TRUE                    17880099
178900                 PERFORM 2100-CHECK-FUNCTION-KEY                  17890099
179000             ELSE                                                 17900099
179100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17910099
179200                 SET DP030-OVERRIDE-GO TO TRUE                    17920099
179300             END-IF                                               17930099
179400     END-EVALUATE.                                                17940099
179500                                                                  17950099
179600*----------------------------------------------------------------*17960099
179700*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *17970099
179800*----------------------------------------------------------------*17980099
179900 2050-DELETE-LIST-QUEUE.                                          17990099
180000                                                                  18000099
180100     EXEC CICS                                                    18010099
180200         DELETEQ TS                                               18020099
180300             QUEUE (ASC-LIST-QUEUE-NAME)                          18030099
180400             RESP  (PV-CICS-RESP)                                 18040099
180500     END-EXEC.                                                    18050099
180600                                                                  18060099
180700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       18070099
180800        (PV-CICS-RESP = DFHRESP(QIDERR))                          18080099
180900         CONTINUE                                                 18090099
181000     ELSE                                                         18100099
181100         SET DP013-CICS-ABEND      TO TRUE                        18110099
181200         SET DP013-NO-ROLLBACK     TO TRUE                        18120099
181300                                                                  18130099
181400         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         18140099
181500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    18150099
181600                                   TO DP013-MESSAGE-TEXT (1)      18160099
181700         PERFORM DP013-0000-PROCESS-ABEND                         18170099
181800     END-IF.                                                      18180099
181900                                                                  18190099
182000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  18200099
182100                                                                  18210099
182200*----------------------------------------------------------------*18220099
182300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*18230099
182400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *18240099
182500* CICS ARCHITECTURE API.                                         *18250099
182600*----------------------------------------------------------------*18260099
182700 2100-CHECK-FUNCTION-KEY.                                         18270099
182800                                                                  18280099
182900     EVALUATE TRUE                                                18290099
183000*                                                                 18300099
183100* F6 - FIRST PAGE                                                 18310099
183200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  18320099
183300             MOVE +1               TO PV-TOP-ITEM                 18330099
183400             IF ASC-CARTONS-FOUND-SW = 'Y'                        18340099
183500                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              18350099
183600             ELSE                                                 18360099
183700                MOVE ASC-STR-NBR              TO ASTOREO          18370099
183800                MOVE ASC-STORE-NAME           TO ASTNMEO          18380099
183900                MOVE ASC-TRLR-ID              TO ATRLRO           18390099
184000                MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO          18400099
184100                                                                  18410099
184200                SET DP020-MSG-WARNING TO  TRUE                    18420099
184300                MOVE PC-TSYMSG-03495 TO  DP020-MSG-NUMBER         18430099
184400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               18440099
184500             END-IF                                               18450099
184600*                                                                 18460099
184700* F7 - PREVIOUS PAGE                                              18470099
184800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   18480099
184900             PERFORM 2110-BROWSE-BACKWARD                         18490099
185000             IF ASC-CARTONS-FOUND-SW = 'Y'                        18500099
185100                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              18510099
185200             ELSE                                                 18520099
185300                MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER          18530099
185400                SET DP020-MSG-INFORMATIONAL TO TRUE               18540099
185500             END-IF                                               18550099
185600*                                                                 18560099
185700* F8 - NEXT PAGE                                                  18570099
185800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   18580099
185900             PERFORM 2120-BROWSE-FORWARD                          18590099
186000             IF ASC-CARTONS-FOUND-SW = 'Y'                        18600099
186100                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              18610099
186200             ELSE                                                 18620099
186300                MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER          18630099
186400                SET DP020-MSG-INFORMATIONAL TO TRUE               18640099
186500             END-IF                                               18650099
186600*                                                                 18660099
186700* ENTER KEY                                                       18670099
186800         WHEN DP020-SRC-AID = DP016-ENTER                         18680099
186900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   18690099
187000             IF  PS-ERROR                                         18700099
187100                 CONTINUE                                         18710099
187200             ELSE                                                 18720099
187300                 IF ASC-CARTONS-FOUND-SW = 'Y'                    18730099
187400                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          18740099
187500                 ELSE                                             18750099
187600                    MOVE ASC-STR-NBR              TO ASTOREO      18760099
187700                    MOVE ASC-STORE-NAME           TO ASTNMEO      18770099
187800                    MOVE ASC-TRLR-ID              TO ATRLRO       18780099
187900                    MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO      18790099
188000                                                                  18800099
188100                    SET DP020-MSG-WARNING TO  TRUE                18810099
188200                    MOVE PC-TSYMSG-03495 TO  DP020-MSG-NUMBER     18820099
188300                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           18830099
188400                 END-IF                                           18840099
188500             END-IF                                               18850099
188600******************************************************************18860099
188700*F24 PRINT TRAILER SUMMARY REPORT                                 18870099
188800*    PRESSING F24-PRTRPT WILL SUBMIT A BATCH JOB TO CREATE        18880099
188900*    REQUESTED TRAILER SUMMARY REPORT(S).                         18890099
189000******************************************************************18900099
189100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              18910099
189200             IF ASC-CARTONS-FOUND-SW = 'Y'                        18920099
189300                PERFORM 7000-GET-REGION-ID                        18930099
189400                PERFORM 7100-GET-CURRENT-TIMESTAMP                18940099
189500                PERFORM 9000-SUBMIT-JOB                           18950099
189600             ELSE                                                 18960099
189700                MOVE ASC-STR-NBR              TO ASTOREO          18970099
189800                MOVE ASC-STORE-NAME           TO ASTNMEO          18980099
189900                MOVE ASC-TRLR-ID              TO ATRLRO           18990099
190000                MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO          19000099
190100                                                                  19010099
190200                SET DP020-MSG-WARNING TO  TRUE                    19020099
190300                MOVE PC-TSYMSG-03495 TO  DP020-MSG-NUMBER         19030099
190400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               19040099
190500             END-IF                                               19050099
190600         WHEN OTHER                                               19060099
190700             SET DP013-NO-ROLLBACK                                19070099
190800                 DP013-XCTL-DISPLAY-RESTART                       19080099
190900                 DP013-CICS-ABEND  TO TRUE                        19090099
191000             MOVE '2100-CHECK-FUNCTION-KEY'                       19100099
191100                                   TO DP013-PARAGRAPH             19110099
191200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      19120099
191300                                   TO DP013-MESSAGE-TEXT (1)      19130099
191400             PERFORM DP013-0000-PROCESS-ABEND                     19140099
191500     END-EVALUATE.                                                19150099
191600*                                                                 19160099
191700*----------------------------------------------------------------*19170099
191800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *19180099
191900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *19190099
192000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *19200099
192100*    MESSAGE.                                                    *19210099
192200*----------------------------------------------------------------*19220099
192300 2110-BROWSE-BACKWARD.                                            19230099
192400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    19240099
192500         GIVING PV-TOP-ITEM.                                      19250099
192600*                                                                 19260099
192700     IF  ((PV-TOP-ITEM < +1)                                      19270099
192800       OR (PV-TOP-ITEM = +1))                                     19280099
192900         MOVE +1                   TO PV-TOP-ITEM                 19290099
193000*        -- TOP OF LIST --                                        19300099
193100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            19310099
193200         SET DP020-MSG-INFORMATIONAL TO TRUE                      19320099
193300     END-IF.                                                      19330099
193400                                                                  19340099
193500*----------------------------------------------------------------*19350099
193600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *19360099
193700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *19370099
193800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *19380099
193900*----------------------------------------------------------------*19390099
194000 2120-BROWSE-FORWARD.                                             19400099
194100                                                                  19410099
194200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              19420099
194300         GIVING PV-TOP-ITEM.                                      19430099
194400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   19440099
194500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             19450099
194600*        -- BOTTOM OF LIST --                                     19460099
194700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            19470099
194800         SET DP020-MSG-INFORMATIONAL  TO TRUE                     19480099
194900     ELSE                                                         19490099
195000         COMPUTE PV-BOTTOM-ITEM =                                 19500099
195100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 19510099
195200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            19520099
195300*            -- BOTTOM OF LIST --                                 19530099
195400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            19540099
195500             SET DP020-MSG-INFORMATIONAL TO TRUE                  19550099
195600         END-IF                                                   19560099
195700     END-IF.                                                      19570099
195800                                                                  19580099
195900*----------------------------------------------------------------*19590099
196000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *19600099
196100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *19610099
196200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *19620099
196300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *19630099
196400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *19640099
196500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *19650099
196600*----------------------------------------------------------------*19660099
196700 2130-CHECK-FOR-JUMP-BROWSE.                                      19670099
196800     SET PS-NO-ERROR               TO TRUE.                       19680099
196900     IF (ASC-START-ITEM-REQUEST = SPACE)                          19690099
197000         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             19700099
197100     ELSE                                                         19710099
197200         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     19720099
197300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       19730099
197400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     19740099
197500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19750099
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19761099
263968              USING DP010I-NUMERIC-EDIT-AREA                      19762099
197700                                                                  19770099
197800         IF  NOT DP010I-ERROR-DETECTED                            19780099
197900             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N19790099
198000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  19800099
198100                 IF  ASC-START-ITEM-REQUEST-N >                   19810099
198200                                          ASC-NUMBER-OF-ITEMS-READ19820099
198300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         19830099
198400                     COMPUTE PV-TOP-ITEM =                        19840099
198500                             ASC-NUMBER-OF-ITEMS-READ             19850099
198600                             - PC-ITEMS-PER-PANEL + 1             19860099
198700                     IF  PV-TOP-ITEM < +1                         19870099
198800                         MOVE +1   TO PV-TOP-ITEM                 19880099
198900                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 19890099
199000                         SET DP020-MSG-INFORMATIONAL TO TRUE      19900099
199100                     END-IF                                       19910099
199200                 ELSE                                             19920099
199300                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 19930099
199400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      19940099
199500                     COMPUTE PV-BOTTOM-ITEM =                     19950099
199600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     19960099
199700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ19970099
199800*                        -- BOTTOM OF LIST --                     19980099
199900                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 19990099
200000                         SET DP020-MSG-INFORMATIONAL TO TRUE      20000099
200100                     END-IF                                       20010099
200200                 END-IF                                           20020099
200300             ELSE                                                 20030099
200400*                --- VALUE OUT OF RANGE ----                      20040099
200500                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        20050099
200600                 MOVE -1           TO ASTOREL                     20060099
200700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              20070099
200800                 MOVE DP015-REVERSE TO ASTOREH                    20080099
200900                 MOVE DP015-RED    TO ASTOREC                     20090099
201000                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTOREA            20100099
201100                 SET DP020-MSG-FATAL                              20110099
201200                     PS-ERROR        TO TRUE                      20120099
201300             END-IF                                               20130099
201400         ELSE                                                     20140099
201500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            20150099
201600             MOVE -1               TO ASTOREL                     20160099
201700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20170099
201800             MOVE DP015-REVERSE    TO ASTOREH                     20180099
201900             MOVE DP015-RED        TO ASTOREC                     20190099
202000             MOVE DP015-UNP-NUM-BRT-MDT TO ASTOREA                20200099
202100             SET DP020-MSG-FATAL   TO TRUE                        20210099
202200             SET PS-ERROR          TO TRUE                        20220099
202300         END-IF                                                   20230099
202400     END-IF.                                                      20240099
202500                                                                  20250099
202600******************************************************************20260099
202700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **20270099
202800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **20280099
202900******************************************************************20290099
203000 2200-MOVE-SCREEN-TO-COMMAREA.                                    20300099
203100                                                                  20310099
203200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             20320099
203300     MOVE +1                       TO PV-SUB.                     20330099
203400*                                                                 20340099
203500     PERFORM 3100-SET-SUBSCRIPTS.                                 20350099
203600     IF  ASTOREL > ZERO                                           20360099
203700         MOVE ASTOREI          TO ASC-START-ITEM-REQUEST          20370099
203800     ELSE                                                         20380099
203900         IF  ASTOREF = DP015-ERASE-EOF                            20390099
204000             INITIALIZE ASC-START-ITEM-REQUEST                    20400099
204100         END-IF                                                   20410099
204200     END-IF.                                                      20420099
204300                                                                  20430099
204400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          20440099
204500         VARYING PV-SUB                                           20450099
204600         FROM 1 BY 1                                              20460099
204700         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      20470099
204800******************************************************************20480099
204900** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**20490099
205000******************************************************************20500099
205100 2210-MOVE-LINES-TO-COMMAREA.                                     20510099
205200     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE                 20520099
205300     MOVE SPACE        TO ASC-TEMP-SELECTED-SW                    20530099
205400                          (ASC-BLK-SUB, ASC-ITEM-SUB)             20540099
205500                                                                  20550099
205600     ADD +1                        TO ASC-ITEM-SUB.               20560099
205700                                                                  20570099
205800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20580099
205900         ADD +1                    TO ASC-BLK-SUB                 20590099
206000         MOVE +1                   TO ASC-ITEM-SUB                20600099
206100     END-IF.                                                      20610099
206200******************************************************************20620099
206300** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **20630099
206400** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **20640099
206500******************************************************************20650099
206600 3000-EDIT-DATA-IN-COMMAREA.                                      20660099
206700     SET PS-NO-ERROR               TO TRUE.                       20670099
206800***  PERFORM 3200-RESET-ATTRIBUTES.                               20680099
206900     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     20690099
207000                                                                  20700099
207100**                                                                20710099
207200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              20720099
207300* EDITTING IS DONE FROM THE BOTTOM UP.                            20730099
207400**                                                                20740099
207500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       20750099
207600         ASC-ITEMS-DISPLAYED - 1.                                 20760099
207700     PERFORM 3100-SET-SUBSCRIPTS.                                 20770099
207800*                                                                 20780099
207900     IF  PS-NO-ERROR                                              20790099
208000         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        20800099
208100     END-IF.                                                      20810099
208200                                                                  20820099
208300     IF  PS-NO-ERROR                                              20830099
208400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20840099
208500     END-IF.                                                      20850099
208600*                                                                 20860099
208700     IF  ((PS-NO-ERROR)                                           20870099
208800       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   20880099
208900       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20890099
209000             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20900099
209100     END-IF.                                                      20910099
209200                                                                  20920099
209300*----------------------------------------------------------------*20930099
209400*   3005-EDIT-COMMAREA-BLOCKS                                    *20940099
209500*----------------------------------------------------------------*20950099
209600 3005-EDIT-COMMAREA-BLOCKS.                                       20960099
209700     MOVE +1                       TO PV-BLOCK-NUMBER.            20970099
209800     MOVE +1                       TO ASC-BLK-SUB.                20980099
209900     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               20990099
210000                                                                  21000099
210100     COMPUTE PV-BLOCK-NUMBER  =                                   21010099
210200        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 21020099
210300            PC-ITEMS-PER-PANEL.                                   21030099
210400                                                                  21040099
210500     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          21050099
210600                                                                  21060099
210700     PERFORM                                                      21070099
210800       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          21080099
210900          OR PS-ERROR                                             21090099
211000          OR PS-BLOCK-ERROR                                       21100099
211100                                                                  21110099
211200             COMPUTE PV-ITEMS-HOLD  =                             21120099
211300                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        21130099
211400                     PC-ITEMS-PER-PANEL - 1                       21140099
211500                                                                  21150099
211600             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       21160099
211700                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               21170099
211800                     FROM  PV-ITEMS-HOLD                          21180099
211900                   GIVING  PV-ITEMS-DIFF                          21190099
212000                 SUBTRACT  PV-ITEMS-DIFF                          21200099
212100                     FROM  PC-ITEMS-PER-PANEL                     21210099
212200                   GIVING  PV-ITEMS-HOLD                          21220099
212300                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              21230099
212400                                              ASC-ITEM-SUB        21240099
212500                                              ASC-ITEMS-DISPLAYED 21250099
212600             ELSE                                                 21260099
212700                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              21270099
212800                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        21280099
212900             END-IF                                               21290099
213000                                                                  21300099
213100             PERFORM 3300-EDIT-SELECTIONS                         21310099
213200                     VARYING PV-SUB                               21320099
213300                        FROM PV-SUB BY -1                         21330099
213400                       UNTIL PV-SUB < +1                          21340099
213500                                                                  21350099
213600             MOVE +1               TO ASC-BLK-SUB                 21360099
213700                                                                  21370099
213800             PERFORM 5105-REWRITE-ASC-LISTQ                       21380099
213900                                                                  21390099
214000             MOVE +1                TO ASC-BLK-SUB                21400099
214100                                                                  21410099
214200             IF  PS-BLOCK-ERROR                                   21420099
214300                 SET  PS-ERROR     TO TRUE                        21430099
214400                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        21440099
214500                                   TO PV-TOP-ITEM                 21450099
214600             ELSE                                                 21460099
214700                 ADD  +1           TO PV-BLOCK-NUMBER             21470099
214800                 IF  PV-BLOCK-NUMBER >                            21480099
214900                     ASC-HIGHEST-BLOCK-WRITTEN                    21490099
215000                     MOVE +2       TO ASC-BLK-SUB                 21500099
215100                     PERFORM 4410-READ-TEMP-STORAGE               21510099
215200                     MOVE +1       TO ASC-BLK-SUB                 21520099
215300                 ELSE                                             21530099
215400                     PERFORM 4410-READ-TEMP-STORAGE               21540099
215500                     ADD  +1        TO PV-BLOCK-NUMBER            21550099
215600                     MOVE +2        TO ASC-BLK-SUB                21560099
215700                     PERFORM 4410-READ-TEMP-STORAGE               21570099
215800                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            21580099
215900                     MOVE +1        TO ASC-BLK-SUB                21590099
216000                 END-IF                                           21600099
216100             END-IF                                               21610099
216200     END-PERFORM.                                                 21620099
216300                                                                  21630099
216400     IF  PV-ORIGINAL-BLOCK  = +1    OR                            21640099
216500         PS-ERROR                   OR                            21650099
216600         PS-BLOCK-ERROR                                           21660099
216700         CONTINUE                                                 21670099
216800     ELSE                                                         21680099
216900         MOVE +1                 TO PV-BLOCK-NUMBER               21690099
217000         MOVE +1                 TO ASC-BLK-SUB                   21700099
217100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  21710099
217200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           21720099
217300         PERFORM 4410-READ-TEMP-STORAGE                           21730099
217400                                                                  21740099
217500         PERFORM                                                  21750099
217600           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              21760099
217700              OR PS-ERROR                                         21770099
217800              OR PS-BLOCK-ERROR                                   21780099
217900                                                                  21790099
218000                 COMPUTE PV-ITEMS-HOLD  =                         21800099
218100                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    21810099
218200                         PC-ITEMS-PER-PANEL - 1                   21820099
218300                                                                  21830099
218400                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     21840099
218500                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           21850099
218600                         FROM  PV-ITEMS-HOLD                      21860099
218700                       GIVING  PV-ITEMS-DIFF                      21870099
218800                     SUBTRACT  PV-ITEMS-DIFF                      21880099
218900                         FROM  PC-ITEMS-PER-PANEL                 21890099
219000                       GIVING  PV-ITEMS-HOLD                      21900099
219100                         MOVE  PV-ITEMS-HOLD TO PV-SUB            21910099
219200                                                ASC-ITEM-SUB      21920099
219300                                               ASC-ITEMS-DISPLAYED21930099
219400                 ELSE                                             21940099
219500                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          21950099
219600                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    21960099
219700                 END-IF                                           21970099
219800                                                                  21980099
219900                 PERFORM 3300-EDIT-SELECTIONS                     21990099
220000                         VARYING PV-SUB                           22000099
220100                            FROM PV-SUB BY -1                     22010099
220200                           UNTIL PV-SUB < +1                      22020099
220300                                                                  22030099
220400                 MOVE +1               TO ASC-BLK-SUB             22040099
220500                                                                  22050099
220600                 PERFORM 5105-REWRITE-ASC-LISTQ                   22060099
220700                                                                  22070099
220800                 MOVE +1                TO ASC-BLK-SUB            22080099
220900                                                                  22090099
221000                 IF  PS-BLOCK-ERROR                               22100099
221100                     SET  PS-ERROR     TO TRUE                    22110099
221200                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    22120099
221300                                       TO PV-TOP-ITEM             22130099
221400                 ELSE                                             22140099
221500                     ADD  +1            TO PV-BLOCK-NUMBER        22150099
221600                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      22160099
221700                         MOVE +2        TO ASC-BLK-SUB            22170099
221800                         PERFORM 4410-READ-TEMP-STORAGE           22180099
221900                         MOVE +1        TO ASC-BLK-SUB            22190099
222000                     ELSE                                         22200099
222100                         PERFORM 4410-READ-TEMP-STORAGE           22210099
222200                         ADD  +1        TO PV-BLOCK-NUMBER        22220099
222300                         MOVE +2        TO ASC-BLK-SUB            22230099
222400                         PERFORM 4410-READ-TEMP-STORAGE           22240099
222500                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        22250099
222600                         MOVE +1        TO ASC-BLK-SUB            22260099
222700                     END-IF                                       22270099
222800                 END-IF                                           22280099
222900     END-PERFORM.                                                 22290099
223000*                                                                 22300099
223100*----------------------------------------------------------------*22310099
223200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *22320099
223300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*22330099
223400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *22340099
223500*                                                                *22350099
223600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *22360099
223700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *22370099
223800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *22380099
223900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *22390099
224000*----------------------------------------------------------------*22400099
224100 3100-SET-SUBSCRIPTS.                                             22410099
224200                                                                  22420099
224300     COMPUTE ASC-ITEM-SUB =                                       22430099
224400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        22440099
224500                                                                  22450099
224600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         22460099
224700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22470099
224800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               22480099
224900     ELSE                                                         22490099
225000         MOVE +1                     TO ASC-BLK-SUB               22500099
225100     END-IF.                                                      22510099
225200******************************************************************22520099
225300** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **22530099
225400******************************************************************22540099
225500 3200-RESET-ATTRIBUTES.                                           22550099
225600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTOREA.                    22560099
225700     MOVE DP015-GREEN              TO ASTOREC.                    22570099
225800     MOVE DP015-UNDERLINE          TO ASTOREH.                    22580099
225900                                                                  22590099
226000******************************************************************22600099
226100** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **22610099
226200** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **22620099
226300** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **22630099
226400** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **22640099
226500******************************************************************22650099
226600 3300-EDIT-SELECTIONS.                                            22660099
226700     EVALUATE TRUE                                                22670099
226800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22680099
226900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22690099
227000                 CONTINUE                                         22700099
227100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22710099
227200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22720099
227300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   22730099
227400                 MOVE ASC-TEMP-SELECTED-SW                        22740099
227500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22750099
227600                                TO ASC-SELECTED-SW                22760099
227700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22770099
227800             END-IF                                               22780099
227900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22790099
228000                 = SPACE                                          22800099
228100             EVALUATE TRUE                                        22810099
228200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22820099
228300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22830099
228400                     MOVE SPACE TO ASC-SELECTED-SW                22840099
228500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22850099
228600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22860099
228700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22870099
228800                     MOVE SPACE TO ASC-SELECTED-SW                22880099
228900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22890099
229000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22900099
229100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22910099
229200                     MOVE SPACE TO ASC-SELECTED-SW                22920099
229300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22930099
229400             END-EVALUATE                                         22940099
229500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22950099
229600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22960099
229700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22970099
229800             END-IF                                               22980099
229900             PERFORM 3310-EDIT-RANGE                              22990099
230000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             23000099
230100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23010099
230200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23020099
230300             END-IF                                               23030099
230400             PERFORM 3310-EDIT-RANGE                              23040099
230500         WHEN OTHER                                               23050099
230600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           23060099
230700             SET DP020-MSG-FATAL    TO TRUE                       23070099
230800             MOVE -1                TO ASTOREL                    23080099
230900             SET DP030-SET-CURSOR-APPL-1                          23090099
231000                                    TO TRUE                       23100099
231100             SET PS-ERROR TO TRUE                                 23110099
231200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23120099
231300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23130099
231400                 MOVE SPACE         TO ASC-SELECTED-SW            23140099
231500                                        (ASC-BLK-SUB ASC-ITEM-SUB)23150099
231600             END-IF                                               23160099
231700     END-EVALUATE.                                                23170099
231800                                                                  23180099
231900     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 23190099
232000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               23200099
232100     IF  ASC-ITEM-SUB < 1                                         23210099
232200         SUBTRACT +1 FROM ASC-BLK-SUB                             23220099
232300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                23230099
232400     END-IF.                                                      23240099
232500                                                                  23250099
232600******************************************************************23260099
232700** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **23270099
232800** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **23280099
232900** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**23290099
233000** THE ENDING.                                                  **23300099
233100******************************************************************23310099
233200 3310-EDIT-RANGE.                                                 23320099
233300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                23330099
233400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   23340099
233500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23350099
233600                                   TO ASC-SELECTED-SW             23360099
233700                                        (ASC-BLK-SUB ASC-ITEM-SUB)23370099
233800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23380099
233900         ELSE                                                     23390099
234000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     23400099
234100                 CONTINUE                                         23410099
234200             ELSE                                                 23420099
234300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23430099
234400                 MOVE PC-TSYMSG-00054                             23440099
234500                                       TO DP020-MSG-NUMBER        23450099
234600                 MOVE -1               TO ASTOREL                 23460099
234700                 SET DP020-MSG-FATAL                              23470099
234800                     DP030-SET-CURSOR-APPL-1                      23480099
234900                     PS-ERROR          TO TRUE                    23490099
235000             END-IF                                               23500099
235100         END-IF                                                   23510099
235200     ELSE                                                         23520099
235300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23530099
235400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23540099
235500                                   TO ASC-SELECTED-SW             23550099
235600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23560099
235700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23570099
235800         ELSE                                                     23580099
235900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23590099
236000                 CONTINUE                                         23600099
236100             ELSE                                                 23610099
236200*                -- ONLY ONE END-OF-RANGE ALLOWED --              23620099
236300                 MOVE PC-TSYMSG-00055                             23630099
236400                                        TO DP020-MSG-NUMBER       23640099
236500                 MOVE -1                TO ASTOREL                23650099
236600                 SET DP020-MSG-FATAL                              23660099
236700                     DP030-SET-CURSOR-APPL-1                      23670099
236800                     PS-ERROR           TO TRUE                   23680099
236900             END-IF                                               23690099
237000         END-IF                                                   23700099
237100     END-IF.                                                      23710099
237200                                                                  23720099
237300******************************************************************23730099
237400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **23740099
237500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **23750099
237600******************************************************************23760099
237700 3400-CHECK-RANGE-SEQUENCE.                                       23770099
237800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23780099
237900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23790099
238000       AND  ASC-START-OF-SELECTED-RANGE >                         23800099
238100                                         ASC-END-OF-SELECTED-RANGE23810099
238200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23820099
238300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23830099
238400         SET DP020-MSG-FATAL TO TRUE                              23840099
238500         SET PS-ERROR TO TRUE                                     23850099
238600         PERFORM 3410-POSITION-AT-ERROR                           23860099
238700     END-IF.                                                      23870099
238800******************************************************************23880099
238900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **23890099
239000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **23900099
239100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **23910099
239200******************************************************************23920099
239300 3410-POSITION-AT-ERROR.                                          23930099
239400     SET DP030-SET-CURSOR-APPL-1                                  23940099
239500                                   TO TRUE.                       23950099
239600     MOVE -1                       TO ASTOREL                     23960099
239700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23970099
239800                    - PV-TOP-ITEM + 1.                            23980099
239900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23990099
240000         CONTINUE                                                 24000099
240100     END-IF.                                                      24010099
240200                                                                  24020099
240300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24030099
240400                    - PV-TOP-ITEM + 1.                            24040099
240500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24050099
240600         CONTINUE                                                 24060099
240700     END-IF.                                                      24070099
240800                                                                  24080099
240900*----------------------------------------------------------------*24090099
241000*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *24100099
241100*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *24110099
241200*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *24120099
241300*----------------------------------------------------------------*24130099
241400 3500-MARK-RANGE-AS-SELECTED.                                     24140099
241500     MOVE +1                       TO  ASC-BLK-SUB.               24150099
241600     PERFORM 3510-MARK-SELECTED-INDS                              24160099
241700         VARYING ASC-ITEM-SUB                                     24170099
241800         FROM 1 BY 1                                              24180099
241900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24190099
242000                                                                  24200099
242100     ADD +1                        TO ASC-BLK-SUB.                24210099
242200     PERFORM 3510-MARK-SELECTED-INDS                              24220099
242300         VARYING ASC-ITEM-SUB                                     24230099
242400         FROM 1 BY 1                                              24240099
242500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24250099
242600                                                                  24260099
242700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24270099
242800                                   TO  PV-LIST-ITEM-NUMBER.       24280099
242900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24290099
243000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24300099
243100               PC-ITEMS-PER-PANEL).                               24310099
243200                                                                  24320099
243300     MOVE ASC-START-OF-SELECTED-RANGE                             24330099
243400                                   TO PV-START-OF-SELECTED-RANGE. 24340099
243500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24350099
243600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24360099
243700               PC-ITEMS-PER-PANEL).                               24370099
243800                                                                  24380099
243900     MOVE ASC-END-OF-SELECTED-RANGE                               24390099
244000                                   TO  PV-END-OF-SELECTED-RANGE.  24400099
244100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24410099
244200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24420099
244300               PC-ITEMS-PER-PANEL).                               24430099
244400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24440099
244500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24450099
244600                                                                  24460099
244700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24470099
244800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24480099
244900         MOVE +1                   TO ASC-BLK-SUB                 24490099
245000         PERFORM 5100-WRITE-TEMP-STORAGE                          24500099
245100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24510099
245200             PV-FIRST-BLOCK-IN-ARRAY - 1                          24520099
245300                                                                  24530099
245400         PERFORM                                                  24540099
245500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24550099
245600                   PV-PREV-BLOCK-IN-ARRAY                         24560099
245700             MOVE PV-FIRST-BLOCK-IN-RANGE                         24570099
245800                                   TO PV-BLOCK-NUMBER             24580099
245900             PERFORM 4410-READ-TEMP-STORAGE                       24590099
246000             PERFORM 3510-MARK-SELECTED-INDS                      24600099
246100                 VARYING ASC-ITEM-SUB                             24610099
246200                 FROM 1 BY 1                                      24620099
246300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24630099
246400             PERFORM 5100-WRITE-TEMP-STORAGE                      24640099
246500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24650099
246600         END-PERFORM                                              24660099
246700                                                                  24670099
246800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24680099
246900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24690099
247000         PERFORM                                                  24700099
247100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24710099
247200                   PV-LAST-BLOCK-IN-RANGE                         24720099
247300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24730099
247400                                   TO PV-BLOCK-NUMBER             24740099
247500             PERFORM 4410-READ-TEMP-STORAGE                       24750099
247600             PERFORM 3510-MARK-SELECTED-INDS                      24760099
247700                 VARYING ASC-ITEM-SUB                             24770099
247800                 FROM 1 BY 1                                      24780099
247900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24790099
248000             PERFORM 5100-WRITE-TEMP-STORAGE                      24800099
248100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24810099
248200         END-PERFORM                                              24820099
248300                                                                  24830099
248400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24840099
248500                                   TO PV-BLOCK-NUMBER             24850099
248600         PERFORM 4410-READ-TEMP-STORAGE                           24860099
248700     END-IF.                                                      24870099
248800                                                                  24880099
248900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24890099
249000                                      ASC-END-OF-SELECTED-RANGE.  24900099
249100*                                                                 24910099
249200*----------------------------------------------------------------*24920099
249300* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24930099
249400*----------------------------------------------------------------*24940099
249500 3510-MARK-SELECTED-INDS.                                         24950099
249600                                                                  24960099
249700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         24970099
249800                                ASC-ITEM-SUB) >                   24980099
249900         ASC-START-OF-SELECTED-RANGE)                             24990099
250000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25000099
250100                                ASC-ITEM-SUB) =                   25010099
250200         ASC-START-OF-SELECTED-RANGE)                             25020099
250300                                                                  25030099
250400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25040099
250500                                    ASC-ITEM-SUB) <               25050099
250600             ASC-END-OF-SELECTED-RANGE)                           25060099
250700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25070099
250800                                    ASC-ITEM-SUB) =               25080099
250900             ASC-END-OF-SELECTED-RANGE)                           25090099
251000                                                                  25100099
251100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25110099
251200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25120099
251300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25130099
251400                               TO TRUE                            25140099
251500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25150099
251600                               TO TRUE                            25160099
251700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    25170099
251800             END-IF                                               25180099
251900         END-IF                                                   25190099
252000     END-IF.                                                      25200099
252100                                                                  25210099
252200*----------------------------------------------------------------*25220099
252300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25230099
252400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25240099
252500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25250099
252600*    DISPLAY THE PANEL TO USER.                                  *25260099
252700*----------------------------------------------------------------*25270099
252800 4000-BUILD-INITIAL-PANEL.                                        25280099
252900                                                                  25290099
253000     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25300099
253100                                 ASC-BLOCK-ENTRIES (2).           25310099
253200     MOVE +1                 TO ASC-BLK-SUB.                      25320099
253300     SET ASC-ITEMS-LEFT-ON-DB                                     25330099
253400                             TO TRUE.                             25340099
253500                                                                  25350099
253600     MOVE +0                 TO ASC-ITEM-SUB                      25360099
253700                                ASC-NUMBER-OF-ITEMS-READ          25370099
253800                                ASC-NUMBER-OF-SELECTED-ITEMS      25380099
253900                                ASC-HIGHEST-BLOCK-WRITTEN         25390099
254000                                ASC-START-OF-SELECTED-RANGE       25400099
254100                                ASC-END-OF-SELECTED-RANGE         25410099
254200                                ASC-ITEM-AT-TOP-OF-PANEL.         25420099
254300                                                                  25430099
254400     MOVE ASC-OCRNC-TRIP-ID TO DK-TRIP-OCRNC-ID                   25440099
254500                                                                  25450099
254600     PERFORM 4005-GET-CARTON-QTY                                  25460099
254700                                                                  25470099
254800     IF ASC-CARTONS-FOUND-NO                                      25480099
254900        MOVE ASC-STR-NBR              TO ASTOREO                  25490099
255000        MOVE ASC-STORE-NAME           TO ASTNMEO                  25500099
255100        MOVE ASC-TRLR-ID              TO ATRLRO                   25510099
255200        MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO                  25520099
255300*IF ONLY 1 ITEM SELECTED IN SU-TRAILER STATUS LIST SCREEN,        25530099
255400*STAY ON THAT SCREEN AND DISPLAY TRAILER SUMMARY NOT              25540099
255500*AVAILABLE - OTHERWISE DISPLAY MSG ON SU-TRAILER SUMMARY          25550099
255600*SCREEN.                                                          25560099
255700        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                       25570099
255800            IF DP020-FK-NEXT-SELECTION (DP020-SRC-AID) OR         25580099
255900               DP020-FK-PREV-SELECTION (DP020-SRC-AID) OR         25590099
256000               (ASC-USE-SELECTION-QUEUE AND                       25600099
256100                SU012-NUMBER-OF-SELECTED-ITEMS > 1)               25610099
256200                MOVE -1               TO ASTOREL                  25620099
256300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               25630099
256400                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              25640099
256500                MOVE PC-TSYMSG-03495 TO DP020-MSG-NUMBER          25650099
256600             ELSE                                                 25660099
256700                SET DP020-NEXT-ACT-APPL-ERROR TO TRUE             25670099
256800                SET DP020-MSG-FATAL  TO TRUE                      25680099
256900                MOVE PC-TSYMSG-03495 TO DP020-MSG-NUMBER          25690099
257000             END-IF                                               25700099
257100        ELSE                                                      25710099
257200             MOVE -1              TO MR-1ST-CTNS-HARDL (1)        25720099
257300             SET DP030-SET-CURSOR-APPL-1                          25730099
257400                                  TO TRUE                         25740099
257500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25750099
257600        END-IF                                                    25760099
257700     ELSE                                                         25770099
257800        DIVIDE PV-TOTAL-CARTONS BY 4                              25780099
257900           GIVING PV-QUOTIENT                                     25790099
258000           REMAINDER PV-CTN-REMAINDER                             25800099
258100        MOVE ZEROS TO PV-PREV-SHIPT-UNT-ID                        25810099
258200                      PV-PREV-SKU-NBR                             25820099
258300                      PV-CRTN-CNT                                 25830099
258400                                                                  25840099
258500        SET SUB1 TO 1                                             25850099
258600                                                                  25860099
258700        INITIALIZE PS-REM-USED-SW                                 25870099
258800                                                                  25880099
258900        PERFORM 4010-OPEN-CURSOR                                  25890099
259000        PERFORM 4300-READ-ITEMS-FROM-DB                           25900099
259100        PERFORM 4020-CLOSE-CURSOR                                 25910099
259200                                                                  25920099
259300        MOVE +1                   TO  PV-TOP-ITEM                 25930099
259400        IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                       25940099
259500            IF DP020-FK-NEXT-SELECTION (DP020-SRC-AID) OR         25950099
259600               DP020-FK-PREV-SELECTION (DP020-SRC-AID) OR         25960099
259700               (ASC-USE-SELECTION-QUEUE AND                       25970099
259800                SU012-NUMBER-OF-SELECTED-ITEMS > 1)               25980099
259900                MOVE -1               TO ASTOREL                  25990099
260000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               26000099
260100                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              26010099
260200                MOVE PC-TSYMSG-03495 TO DP020-MSG-NUMBER          26020099
260300             ELSE                                                 26030099
260400                SET DP020-NEXT-ACT-APPL-ERROR TO TRUE             26040099
260500                SET DP020-MSG-FATAL  TO TRUE                      26050099
260600                MOVE PC-TSYMSG-03495 TO DP020-MSG-NUMBER          26060099
260700             END-IF                                               26070099
260800        ELSE                                                      26080099
260900             MOVE -1              TO MR-1ST-CTNS-HARDL (1)        26090099
261000             SET DP030-SET-CURSOR-APPL-1                          26100099
261100                                  TO TRUE                         26110099
261200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26120099
261300        END-IF                                                    26130099
261400     END-IF.                                                      26140099
261500                                                                  26150099
261600*----------------------------------------------------------------*26160099
261700* GET CARTON QTY FROM TRIP SUMMARY TABLE                          26170099
261800*----------------------------------------------------------------*26180099
261900 4005-GET-CARTON-QTY.                                             26190099
262000     EXEC SQL                                                     26200099
262100          SELECT  CART_QTY                                        26210099
262200            INTO  :SUT00007-CART-QTY                              26220099
262300            FROM  SUT_TRIP_SUM                                    26230099
262400           WHERE  TRIP_OCRNC_ID     = :DK-TRIP-OCRNC-ID           26240099
262500       END-EXEC.                                                  26250099
262600                                                                  26260099
262700     EVALUATE TRUE                                                26270099
262800         WHEN SQLCODE = ZERO                                      26280099
262900              IF SUT00007-CART-QTY > 0                            26290099
263000                 SET ASC-CARTONS-FOUND-YES TO TRUE                26300099
263100                 MOVE SUT00007-CART-QTY TO PV-TOTAL-CARTONS       26310099
263200              ELSE                                                26320099
263300                 SET ASC-CARTONS-FOUND-NO TO TRUE                 26330099
263400              END-IF                                              26340099
263500         WHEN SQLCODE = +100                                      26350099
263600              SET ASC-CARTONS-FOUND-NO TO TRUE                    26360099
263700         WHEN SQLWARN0 NOT = SPACE                                26370099
263800         WHEN SQLCODE NOT = ZERO                                  26380099
263900              MOVE '4005-GET-CARTON-QTY' TO DP013-PARAGRAPH       26390099
264000              MOVE 'GET CARTON QTY FROM TRIP SUMMARY TABLE'       26400099
264100                               TO DP013-MESSAGE-TEXT (1)          26410099
264200              MOVE SQLCA       TO DP013-SQLCA                     26420099
264300              MOVE 'SUT_TRIP_SUM '   TO DP013-DB2-TABLE-NAME (1)  26430099
264400              MOVE 'SUT00007'   TO DP013-DB2-TABLE-NAME (1)       26440099
264500              SET DP013-DB2-ABEND TO TRUE                         26450099
264600              PERFORM DP013-0000-PROCESS-ABEND                    26460099
264700     END-EVALUATE.                                                26470099
264800                                                                  26480099
264900*----------------------------------------------------------------*26490099
265000* OPEN THE CURSOR                                                 26500099
265100*----------------------------------------------------------------*26510099
265200 4010-OPEN-CURSOR.                                                26520099
265300                                                                  26530099
265400     PERFORM                                                      26540099
265500         WITH TEST AFTER                                          26550099
265600         VARYING PV-RETRY-COUNTER                                 26560099
265700         FROM 1 BY 1                                              26570099
265800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26580099
265900                   OR (SQLCODE = ZERO))                           26590099
266000                                                                  26600099
266100         EXEC SQL                                                 26610099
266200              OPEN DTL-CSR                                        26620099
266300         END-EXEC                                                 26630099
266400                                                                  26640099
266500                                                                  26650099
266600*        MOVE EIBTASKN TO PV-TASK                                 26660099
266700*        MOVE DK-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID                  26670099
266800*        STRING 'TASK '                                           26680099
266900*            PV-TASK                                              26690099
267000*        '- SUKCS545 OPEN CSR '                                   26700099
267100*          'SHIPT-UNT-ID = '                                      26710099
267200*           PV-SHIPT-UNT-ID                                       26720099
267300*          ' SOURCE = '                                           26730099
267400*           PV-SOURCE             DELIMITED BY SIZE               26740099
267500*         INTO PV-CICS-MSG-AREA                                   26750099
267600*         PERFORM 8500-WRITE-CSSL                                 26760099
267700                                                                  26770099
267800         EVALUATE TRUE                                            26780099
267900             WHEN SQLCODE = ZERO                                  26790099
268000             WHEN SQLCODE = -904                                  26800099
268100             WHEN SQLCODE = -913                                  26810099
268200                 CONTINUE                                         26820099
268300             WHEN SQLWARN0 NOT = SPACES                           26830099
268400             WHEN SQLCODE < ZERO                                  26840099
268500             WHEN SQLCODE > ZERO                                  26850099
268600                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       26860099
268700                 MOVE 'OPEN CURSOR PROBLEM    - '                 26870099
268800                                   TO DP013-MESSAGE-TEXT (1)      26880099
268900                 MOVE SQLCA        TO DP013-SQLCA                 26890099
269000                 MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)    26900099
269100                 SET DP013-DB2-ABEND                              26910099
269200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26920099
269300                 PERFORM DP013-0000-PROCESS-ABEND                 26930099
269400         END-EVALUATE                                             26940099
269500     END-PERFORM.                                                 26950099
269600*                                                                 26960099
269700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26970099
269800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             26980099
269900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   26990099
270000                                   TO DP013-MESSAGE-TEXT (1)      27000099
270100         MOVE SQLCA                TO DP013-SQLCA                 27010099
270200         MOVE 'SUT00095'           TO DP013-DB2-TABLE-NAME (1)    27020099
270300         SET DP013-DB2-ABEND                                      27030099
270400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   27040099
270500         PERFORM DP013-0000-PROCESS-ABEND                         27050099
270600     END-IF.                                                      27060099
270700                                                                  27070099
270800*----------------------------------------------------------------*27080099
270900* CLOSE THE CURSOR.                                               27090099
271000*----------------------------------------------------------------*27100099
271100 4020-CLOSE-CURSOR.                                               27110099
271200                                                                  27120099
271300     EXEC SQL                                                     27130099
271400          CLOSE DTL-CSR                                           27140099
271500     END-EXEC                                                     27150099
271600                                                                  27160099
271700     EVALUATE TRUE                                                27170099
271800         WHEN SQLCODE = ZERO                                      27180099
271900         WHEN SQLCODE = +100                                      27190099
272000             CONTINUE                                             27200099
272100         WHEN SQLWARN0 NOT = SPACES                               27210099
272200         WHEN SQLCODE < ZERO                                      27220099
272300         WHEN SQLCODE > ZERO                                      27230099
272400             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          27240099
272500             MOVE 'CLOSE CURSOR PROBLEM   '                       27250099
272600                               TO DP013-MESSAGE-TEXT (1)          27260099
272700             MOVE SQLCA        TO DP013-SQLCA                     27270099
272800             MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)        27280099
272900             SET DP013-DB2-ABEND                                  27290099
273000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27300099
273100             PERFORM DP013-0000-PROCESS-ABEND                     27310099
273200     END-EVALUATE.                                                27320099
273300                                                                  27330099
273400*----------------------------------------------------------------*27340099
273500*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *27350099
273600*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *27360099
273700*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *27370099
273800*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *27380099
273900*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *27390099
274000*                                                                *27400099
274100*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *27410099
274200*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *27420099
274300*    UPON INITIALIZATION.                                        *27430099
274400*----------------------------------------------------------------*27440099
274500 4300-READ-ITEMS-FROM-DB.                                         27450099
274600        PERFORM                                                   27460099
274700            VARYING PV-READ-COUNT                                 27470099
274800            FROM 1 BY 1                                           27480099
274900            UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                 27490099
275000               OR (ASC-NO-ITEMS-LEFT-ON-DB))                      27500099
275100                                                                  27510099
275200            PERFORM 4310-FETCH                                    27520099
275300                                                                  27530099
275400            IF  ASC-ITEMS-LEFT-ON-DB                              27540099
275500                IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL             27550099
275600                    ADD +1            TO ASC-ITEM-SUB             27560099
275700                ELSE                                              27570099
275800                    ADD +1            TO ASC-BLK-SUB              27580099
275900                    MOVE +1           TO ASC-ITEM-SUB             27590099
276000                                                                  27600099
276100                    IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY      27610099
276200                        MOVE +1       TO ASC-BLK-SUB              27620099
276300                        SET ASC-BLOCK-MODIFIED (1) TO TRUE        27630099
276400                        PERFORM 5100-WRITE-TEMP-STORAGE           27640099
276500                        MOVE ASC-BLOCK-ENTRIES                    27650099
276600                                      (PC-MAX-BLOCKS-IN-ARRAY)    27660099
276700                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)27670099
276800                        ADD +1        TO ASC-BLK-SUB              27680099
276900                        INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)27690099
277000                        SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)   27700099
277100                                                         TO TRUE  27710099
277200                    END-IF                                        27720099
277300                END-IF                                            27730099
277400                ADD +1                TO ASC-NUMBER-OF-ITEMS-READ 27740099
277500                SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE       27750099
277600                MOVE ASC-NUMBER-OF-ITEMS-READ                     27760099
277700                                      TO ASC-LIST-ITEM-NUMBER     27770099
277800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27780099
277900                                                                  27790099
278000                IF  PS-FIRST-RECORD-YES                           27800099
278100                    MOVE  SUT00095-DIVERT-TMST                    27810099
278200                      TO  PV-TRIP-BEGIN-TMST                      27820099
278300                   SET PS-FIRST-RECORD-NO  TO  TRUE               27830099
278400                END-IF                                            27840099
278500***                                                               27850099
278600***MIXED CARTONS:                                                 27860099
278700***SINCE CARTONS CAN CONTAIN BOTH HARDLINE AND SOFTLINE           27870099
278800***MERCHANDISE, WE WILL COUNT THE UNITS FOR HARDLINE AND          27880099
278900***SOFTLINE - WHICHEVER IS GREATER WILL DETERMINE THE             27890099
279000***MDSE_LNE_CDE.                                                  27900099
279100                PERFORM 4320-DETERMINE-HARD-SOFT                  27910099
279200                                                                  27920099
279300***MIXED CARTONS:                                                 27930099
279400***SINCE CARTONS CAN CONTAIN BOTH HANG AND FOLD                   27940099
279500***MERCHANDISE, WE WILL COUNT THE UNITS FOR HANG AND              27950099
279600***FOLD - WHICHEVER IS GREATER WILL DETERMINE THE                 27960099
279700***HNG_FOLD_SEQ_NBR.                                              27970099
279800                PERFORM 4325-DETERMINE-HANG-FOLD                  27980099
279900                                                                  27990099
280000                IF SUT00095-SHIPT-UNT-ID NOT =                    28000099
280100                                           PV-PREV-SHIPT-UNT-ID   28010099
280200                   IF PS-REM-USED-SW = 'Y'                        28020099
280300                      MOVE 'N' TO PS-REM-USED-SW                  28030099
280400                      MOVE 0 TO PV-CRTN-CNT                       28040099
280500                      SET SUB1 UP BY 1                            28050099
280600*** DMH BEGIN                                                     28060099
280700                      IF  SUB1  >  1                              28070099
280800                          SET  PS-QUARTER-CHANGE-YES TO TRUE      28080099
280900                      ELSE                                        28090099
281000                          SET  PS-QUARTER-CHANGE-NO TO TRUE       28100099
281100                      END-IF                                      28110099
281200*** DMH END                                                       28120099
281300                   END-IF                                         28130099
281400                                                                  28140099
281500                   ADD 1 TO PV-CRTN-CNT                           28150099
281600                                                                  28160099
281700                   IF PV-CRTN-CNT > PV-QUOTIENT                   28170099
281800***                   MOVE 1 TO PV-CRTN-CNT                       28180099
281900                      SET SUB1 UP BY 1                            28190099
282000*** DMH BEGIN                                                     28200099
282100                      IF  SUB1  >  1                              28210099
282200                          SET  PS-QUARTER-CHANGE-YES TO TRUE      28220099
282300                      ELSE                                        28230099
282400                          SET  PS-QUARTER-CHANGE-NO TO TRUE       28240099
282500                       END-IF                                     28250099
282600*** DMH END                                                       28260099
282700                                                                  28270099
282800                      IF PV-CTN-REMAINDER > 0                     28280099
282900                         SET SUB1 DOWN BY 1                       28290099
283000                         SUBTRACT 1 FROM PV-CTN-REMAINDER         28300099
283100                         MOVE 'Y' TO PS-REM-USED-SW               28310099
283200*** DMH BEGIN                                                     28320099
283300                         SET  PS-QUARTER-CHANGE-NO TO TRUE        28330099
283400*** DMH END                                                       28340099
283500                      END-IF                                      28350099
283600                   END-IF                                         28360099
283700                                                                  28370099
283800*** DMH - BEGIN                                                   28380099
283900                   IF   PS-QUARTER-CHANGE-YES                     28390099
284000                        SET SUB1 DOWN BY 1                        28400099
284100                        PERFORM 8089-COUNT-QUART-SKUS             28410099
284200                        SET SUB1 UP BY 1                          28420099
284300                        SET PS-QUARTER-CHANGE-NO TO TRUE          28430099
284400                        MOVE 1 TO PV-CRTN-CNT                     28440099
284500                   END-IF                                         28450099
284600                                                                  28460099
284700                    IF PV-CRTN-CNT = 1                            28470099
284800                        MOVE SUT00095-DIVERT-TMST                 28480099
284900                          TO PV-QUARTER-BEGIN-TMST                28490099
285000                              PV-QUARTER-END-TMST                 28500099
285100                    ELSE                                          28510099
285200                        MOVE SUT00095-DIVERT-TMST                 28520099
285300                          TO PV-QUARTER-END-TMST                  28530099
285400                    END-IF                                        28540099
285500                                                                  28550099
285600                                                                  28560099
285700*** DMH - END                                                     28570099
285800                                                                  28580099
285900                   MOVE SUT00095-SHIPT-UNT-ID TO                  28590099
286000                                        PV-PREV-SHIPT-UNT-ID      28600099
286100                   MOVE 1 TO PV-NUMBER                            28610099
286200                   SET SUB2 TO 1                                  28620099
286300                   PERFORM 4330-EVALUATE-AND-COUNT                28630099
286400                                                                  28640099
286500                   MOVE SUT00095-SKU-NBR TO PV-PREV-SKU-NBR       28650099
286600                   MOVE 1 TO PV-NUMBER                            28660099
286700***DMH          SET SUB2 TO 2                                     28670099
286800***DMH          PERFORM 4330-EVALUATE-AND-COUNT                   28680099
286900                ELSE                                              28690099
287000                                                                  28700099
287100                   IF SUT00095-SKU-NBR NOT = PV-PREV-SKU-NBR      28710099
287200                      MOVE SUT00095-SKU-NBR TO PV-PREV-SKU-NBR    28720099
287300                      MOVE 1 TO PV-NUMBER                         28730099
287400***DMH             SET SUB2 TO 2                                  28740099
287500***DMH             PERFORM 4330-EVALUATE-AND-COUNT                28750099
287600                   END-IF                                         28760099
287700                END-IF                                            28770099
287800                                                                  28780099
287900                MOVE SUT00095-UNT-QTY TO PV-NUMBER                28790099
288000                SET SUB2 TO 3                                     28800099
288100                PERFORM 4330-EVALUATE-AND-COUNT                   28810099
288200            END-IF                                                28820099
288300        END-PERFORM                                               28830099
288400                                                                  28840099
288500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          28850099
288600*** DMH BEGIN                                                     28860099
288700         PERFORM 8089-COUNT-QUART-SKUS                            28870099
288800         MOVE  PV-QUARTER-END-TMST                                28880099
288900           TO  PV-TRIP-END-TMST                                   28890099
289000         PERFORM 8100-TRIP-BREAK                                  28900099
289100*** DMH END                                                       28910099
289200         MOVE +1               TO ASC-BLK-SUB                     28920099
289300         PERFORM 5100-WRITE-TEMP-STORAGE                          28930099
289400         ADD +1                TO ASC-BLK-SUB                     28940099
289500         PERFORM 5100-WRITE-TEMP-STORAGE                          28950099
289600                                                                  28960099
289700         MOVE 1                TO ASC-BLK-SUB                     28970099
289800                                  PV-BLOCK-NUMBER                 28980099
289900         PERFORM 4410-READ-TEMP-STORAGE                           28990099
290000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             29000099
290100             MOVE 2            TO ASC-BLK-SUB                     29010099
290200                                  PV-BLOCK-NUMBER                 29020099
290300             PERFORM 4410-READ-TEMP-STORAGE                       29030099
290400         END-IF                                                   29040099
290500     END-IF.                                                      29050099
290600                                                                  29060099
290700*                                                                 29070099
290800*----------------------------------------------------------------*29080099
290900*    FETCH THE CURSOR                                             29090099
291000*----------------------------------------------------------------*29100099
291100 4310-FETCH.                                                      29110099
291200      EXEC SQL                                                    29120099
291300          FETCH DTL-CSR                                           29130099
291400          INTO  :SUT00095-TRIP-OCRNC-ID                           29140099
291500               ,:SUT00095-DIVERT-TMST                             29150099
291600               ,:SUT00095-SHIPT-UNT-ID                            29160099
291700               ,:SUT00095-SKU-NBR                                 29170099
291800               ,:SUT00095-MDSE-LNE-CDE                            29180099
291900               ,:SUT00095-HNG-FOLD-SEQ-NBR                        29190099
292000               ,:SUT00095-PRC-MSG-CDE                             29200099
292100               ,:SUT00095-EAS-TAG-IND                             29210099
292200               ,:SUT00095-UNT-QTY                                 29220099
292300      END-EXEC                                                    29230099
292400                                                                  29240099
292500*        STRING 'TASK '                                           29250099
292600*            PV-TASK                                              29260099
292700*        '- SUKCS545 FETCH '                                      29270099
292800*          'SHIPT-UNT-ID = '                                      29280099
292900*           PV-SHIPT-UNT-ID                                       29290099
293000*          ' SOURCE = '                                           29300099
293100*           PV-SOURCE             DELIMITED BY SIZE               29310099
293200*         INTO PV-CICS-MSG-AREA                                   29320099
293300*         PERFORM 8500-WRITE-CSSL                                 29330099
293400                                                                  29340099
293500     EVALUATE TRUE                                                29350099
293600         WHEN SQLCODE = ZERO                                      29360099
293700             ADD +1 TO PV-ROWS-FETCHED-COUNT                      29370099
293800         WHEN SQLCODE = +100                                      29380099
293900             SET PS-EOF-DETAIL-CSR-YES TO TRUE                    29390099
294000         WHEN SQLWARN0 NOT = SPACE                                29400099
294100         WHEN SQLCODE NOT = ZERO                                  29410099
294200              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         29420099
294300              MOVE 'FETCH CURSOR PROBLEM '                        29430099
294400                               TO DP013-MESSAGE-TEXT (1)          29440099
294500              MOVE SQLCA       TO DP013-SQLCA                     29450099
294600              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       29460099
294700              SET DP013-DB2-ABEND TO TRUE                         29470099
294800              PERFORM DP013-0000-PROCESS-ABEND                    29480099
294900     END-EVALUATE.                                                29490099
295000                                                                  29500099
295100     IF  SQLCODE EQUAL +100                                       29510099
295200         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      29520099
295300     END-IF.                                                      29530099
295400                                                                  29540099
295500******************************************************************29550099
295600 4320-DETERMINE-HARD-SOFT.                                        29560099
295700******************************************************************29570099
295800     INITIALIZE  PV-SOFTLINE-UNITS                                29580099
295900                 PV-HARDLINE-UNITS.                               29590099
296000                                                                  29600099
296100     PERFORM 8080-COUNT-SOFTLINE-UNITS.                           29610099
296200     PERFORM 8085-COUNT-HARDLINE-UNITS.                           29620099
296300                                                                  29630099
296400     SET  ASC-HARD-SOFT-NO  TO  TRUE                              29640099
296500                                                                  29650099
296600     IF  (PV-HARDLINE-UNITS  =  PV-SOFTLINE-UNITS  OR             29660099
296700          PV-HARDLINE-UNITS  >  PV-SOFTLINE-UNITS)  AND           29670099
296800         PV-HARDLINE-UNITS  >  0                                  29680099
296900         SET  ASC-HARDLINE-CARTON TO  TRUE                        29690099
297000     ELSE                                                         29700099
297100     IF  PV-SOFTLINE-UNITS  >  0                                  29710099
297200         SET  ASC-SOFTLINE-CARTON TO  TRUE                        29720099
297300     END-IF                                                       29730099
297400     END-IF.                                                      29740099
297500                                                                  29750099
297600***  DISPLAY 'HARD/SOFT:  ' ASC-CARTON-HARD-SOFT-SW.              29760099
297700***  IF  ASC-SOFTLINE-CARTON                                      29770099
297800***  DISPLAY '                            '                       29780099
297900***           ASC-CARTON-HARD-SOFT-SW                             29790099
298000***  END-IF.                                                      29800099
298100                                                                  29810099
298200                                                                  29820099
298300******************************************************************29830099
298400 4325-DETERMINE-HANG-FOLD.                                        29840099
298500******************************************************************29850099
298600     INITIALIZE  PV-HANG-UNITS                                    29860099
298700                 PV-FOLD-UNITS.                                   29870099
298800                                                                  29880099
298900     PERFORM 8086-COUNT-HANG-UNITS.                               29890099
299000     PERFORM 8087-COUNT-FOLD-UNITS.                               29900099
299100                                                                  29910099
299200     SET  ASC-HANG-FOLD-NO  TO  TRUE                              29920099
299300                                                                  29930099
299400     IF  (PV-HANG-UNITS  =  PV-FOLD-UNITS  OR                     29940099
299500          PV-HANG-UNITS  >  PV-FOLD-UNITS)  AND                   29950099
299600         PV-HANG-UNITS  >  0                                      29960099
299700         SET  ASC-HANG-CARTON TO  TRUE                            29970099
299800     ELSE                                                         29980099
299900     IF  PV-FOLD-UNITS  > 0                                       29990099
300000         SET  ASC-FOLD-CARTON TO  TRUE                            30000099
300100     END-IF                                                       30010099
300200     END-IF.                                                      30020099
300300                                                                  30030099
300400***  DISPLAY 'HANG/FOLD:  ' ASC-CARTON-HANG-FOLD-SW.              30040099
300500                                                                  30050099
300600*----------------------------------------------------------------*30060099
300700 4330-EVALUATE-AND-COUNT.                                         30070099
300800                                                                  30080099
300900     EVALUATE TRUE                                                30090099
301000        WHEN SUB2 = 1                                             30100099
301100           EVALUATE ASC-CARTON-HARD-SOFT-SW                       30110099
301200              WHEN 'H'                                            30120099
301300                 ADD PV-NUMBER                                    30130099
301400                           TO ASC-COUNT(SUB1, SUB2, 1)            30140099
301500                 ADD PV-NUMBER                                    30150099
301600                           TO ASC-COUNT(5, SUB2, 1)               30160099
301700                 ADD PV-NUMBER                                    30170099
301800                           TO ASC-COUNT(SUB1, SUB2, 9)            30180099
301900                 ADD PV-NUMBER                                    30190099
302000                           TO ASC-COUNT(5, SUB2, 9)               30200099
302100              WHEN 'S'                                            30210099
302200                 ADD PV-NUMBER                                    30220099
302300                           TO ASC-COUNT(SUB1, SUB2, 2)            30230099
302400                 ADD PV-NUMBER                                    30240099
302500                           TO ASC-COUNT(5, SUB2, 2)               30250099
302600                 ADD PV-NUMBER                                    30260099
302700                           TO ASC-COUNT(SUB1, SUB2, 9)            30270099
302800                 ADD PV-NUMBER                                    30280099
302900                           TO ASC-COUNT(5, SUB2, 9)               30290099
303000*WHEN MDSE LNE CDE IS OTHER THAN 'H' OR 'S' COUNT IN TOTALS       30300099
303100              WHEN OTHER                                          30310099
303200                 ADD PV-NUMBER                                    30320099
303300                           TO ASC-COUNT(SUB1, SUB2, 9)            30330099
303400                 ADD PV-NUMBER                                    30340099
303500                           TO ASC-COUNT(5, SUB2, 9)               30350099
303600           END-EVALUATE                                           30360099
303700                                                                  30370099
303800           EVALUATE ASC-CARTON-HANG-FOLD-SW                       30380099
303900              WHEN 'H'                                            30390099
304000                 ADD PV-NUMBER                                    30400099
304100                            TO ASC-COUNT(SUB1, SUB2, 3)           30410099
304200                 ADD PV-NUMBER                                    30420099
304300                            TO ASC-COUNT(5, SUB2, 3)              30430099
304400              WHEN 'F'                                            30440099
304500                 ADD PV-NUMBER                                    30450099
304600                            TO ASC-COUNT(SUB1, SUB2, 4)           30460099
304700                 ADD PV-NUMBER                                    30470099
304800                            TO ASC-COUNT(5, SUB2, 4)              30480099
304900           END-EVALUATE                                           30490099
305000        WHEN SUB2 = 2 OR 3                                        30500099
305100           EVALUATE SUT00095-MDSE-LNE-CDE                         30510099
305200              WHEN 'H'                                            30520099
305300                 ADD PV-NUMBER                                    30530099
305400                           TO ASC-COUNT(SUB1, SUB2, 1)            30540099
305500                 ADD PV-NUMBER                                    30550099
305600                           TO ASC-COUNT(5, SUB2, 1)               30560099
305700                 ADD PV-NUMBER                                    30570099
305800                           TO ASC-COUNT(SUB1, SUB2, 9)            30580099
305900                 ADD PV-NUMBER                                    30590099
306000                           TO ASC-COUNT(5, SUB2, 9)               30600099
306100              WHEN 'S'                                            30610099
306200                 ADD PV-NUMBER                                    30620099
306300                           TO ASC-COUNT(SUB1, SUB2, 2)            30630099
306400                 ADD PV-NUMBER                                    30640099
306500                           TO ASC-COUNT(5, SUB2, 2)               30650099
306600                 ADD PV-NUMBER                                    30660099
306700                           TO ASC-COUNT(SUB1, SUB2, 9)            30670099
306800                 ADD PV-NUMBER                                    30680099
306900                           TO ASC-COUNT(5, SUB2, 9)               30690099
307000*WHEN MDSE LNE CDE IS OTHER THAN 'H' OR 'S' COUNT IN TOTALS       30700099
307100              WHEN OTHER                                          30710099
307200                 ADD PV-NUMBER                                    30720099
307300                           TO ASC-COUNT(SUB1, SUB2, 9)            30730099
307400                 ADD PV-NUMBER                                    30740099
307500                           TO ASC-COUNT(5, SUB2, 9)               30750099
307600           END-EVALUATE                                           30760099
307700                                                                  30770099
307800           EVALUATE SUT00095-HNG-FOLD-SEQ-NBR                     30780099
307900              WHEN  1                                             30790099
308000                 ADD PV-NUMBER                                    30800099
308100                            TO ASC-COUNT(SUB1, SUB2, 3)           30810099
308200                 ADD PV-NUMBER                                    30820099
308300                            TO ASC-COUNT(5, SUB2, 3)              30830099
308400              WHEN  2                                             30840099
308500                 ADD PV-NUMBER                                    30850099
308600                            TO ASC-COUNT(SUB1, SUB2, 4)           30860099
308700                 ADD PV-NUMBER                                    30870099
308800                            TO ASC-COUNT(5, SUB2, 4)              30880099
308900           END-EVALUATE                                           30890099
309000     END-EVALUATE                                                 30900099
309100                                                                  30910099
309200     EVALUATE SUT00095-PRC-MSG-CDE                                30920099
309300        WHEN 'RP'                                                 30930099
309400           ADD PV-NUMBER                                          30940099
309500                      TO ASC-COUNT(SUB1, SUB2, 5)                 30950099
309600           ADD PV-NUMBER                                          30960099
309700                      TO ASC-COUNT(5, SUB2, 5)                    30970099
309800        WHEN 'RF'                                                 30980099
309900           ADD PV-NUMBER                                          30990099
310000                      TO ASC-COUNT(SUB1, SUB2, 6)                 31000099
310100           ADD PV-NUMBER                                          31010099
310200                      TO ASC-COUNT(5, SUB2, 6)                    31020099
310300        WHEN 'CL'                                                 31030099
310400           ADD PV-NUMBER                                          31040099
310500                      TO ASC-COUNT(SUB1, SUB2, 8)                 31050099
310600           ADD PV-NUMBER                                          31060099
310700                      TO ASC-COUNT(5, SUB2, 8)                    31070099
310800     END-EVALUATE.                                                31080099
310900                                                                  31090099
311000     IF SUT00095-EAS-TAG-IND = 'Y'                                31100099
311100        ADD PV-NUMBER                                             31110099
311200                      TO ASC-COUNT(SUB1, SUB2, 7)                 31120099
311300        ADD PV-NUMBER                                             31130099
311400                      TO ASC-COUNT(5, SUB2, 7)                    31140099
311500     END-IF.                                                      31150099
311600*                                                                 31160099
311700*----------------------------------------------------------------*31170099
311800* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31180099
311900*----------------------------------------------------------------*31190099
312000 4400-MOVE-COMMAREA-TO-SCREEN.                                    31200099
312100*    IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31210099
312200*        AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          31220099
312300*        OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          31230099
312400*            MOVE +1    TO ASC-BLK-SUB                            31240099
312500*            PERFORM 5100-WRITE-TEMP-STORAGE                      31250099
312600*            ADD +1     TO ASC-BLK-SUB                            31260099
312700*            PERFORM 5100-WRITE-TEMP-STORAGE                      31270099
312800*            DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31280099
312900*                GIVING PV-BLOCK-NUMBER                           31290099
313000*                REMAINDER PV-REMAINDER                           31300099
313100*            IF  PV-REMAINDER > ZERO                              31310099
313200*                ADD +1 TO PV-BLOCK-NUMBER                        31320099
313300*            END-IF                                               31330099
313400*            MOVE +1    TO ASC-BLK-SUB                            31340099
313500*            PERFORM 4410-READ-TEMP-STORAGE                       31350099
313600*            ADD +1     TO ASC-BLK-SUB                            31360099
313700*                          PV-BLOCK-NUMBER                        31370099
313800*            PERFORM 4410-READ-TEMP-STORAGE                       31380099
313900*    END-IF.                                                      31390099
314000*    MOVE +1            TO ASC-BLK-SUB.                           31400099
314100*    COMPUTE ASC-ITEM-SUB =                                       31410099
314200*        ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              31420099
314300*        + PC-ITEMS-PER-PANEL).                                   31430099
314400*                                                                 31440099
314500*    IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        31450099
314600*        ADD +1         TO ASC-BLK-SUB                            31460099
314700*        SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            31470099
314800*    END-IF.                                                      31480099
314900*                                                                 31490099
315000*    COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           31500099
315100*        ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                31510099
315200*    PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        31520099
315300                                                                  31530099
315400     IF ASC-CARTONS-FOUND-SW = 'Y'                                31540099
315500        PERFORM 4420-FORMAT-LIST-LINES                            31550099
315600            VARYING PV-SUB                                        31560099
315700            FROM PC-ITEMS-PER-PANEL BY -1                         31570099
315800            UNTIL PV-SUB < +1                                     31580099
315900     ELSE                                                         31590099
316000        MOVE ASC-STR-NBR              TO ASTOREO                  31600099
316100        MOVE ASC-STORE-NAME           TO ASTNMEO                  31610099
316200        MOVE ASC-TRLR-ID              TO ATRLRO                   31620099
316300        MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO                  31630099
316400                                                                  31640099
316500        SET DP020-MSG-WARNING TO  TRUE                            31650099
316600        MOVE PC-TSYMSG-03495 TO  DP020-MSG-NUMBER                 31660099
316700        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       31670099
316800     END-IF                                                       31680099
316900                                                                  31690099
317000*    COMPUTE ASC-ITEMS-DISPLAYED =                                31700099
317100*        ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          31710099
317200*    MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    31720099
317300*                                     ASTOREO.                    31730099
317400                                                                  31740099
317500     MOVE ASC-STR-NBR              TO ASTOREO                     31750099
317600     MOVE ASC-STORE-NAME           TO ASTNMEO                     31760099
317700     MOVE ASC-TRLR-ID              TO ATRLRO                      31770099
317800     MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO.                    31780099
317900                                                                  31790099
318000*----------------------------------------------------------------*31800099
318100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         =31810099
318200*----------------------------------------------------------------*31820099
318300 4410-READ-TEMP-STORAGE.                                          31830099
318400                                                                  31840099
318500     EXEC CICS                                                    31850099
318600         READQ TS                                                 31860099
318700             QUEUE (ASC-LIST-QUEUE-NAME)                          31870099
318800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31880099
318900             ITEM  (PV-BLOCK-NUMBER)                              31890099
319000             RESP  (PV-CICS-RESP)                                 31900099
319100     END-EXEC.                                                    31910099
319200                                                                  31920099
319300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       31930099
319400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     31940099
319500         CONTINUE                                                 31950099
319600     ELSE                                                         31960099
319700         SET DP013-CICS-ABEND     TO TRUE                         31970099
319800         SET DP013-NO-ROLLBACK    TO TRUE                         31980099
319900         MOVE '4410-READ-TEMP-STORAGE'                            31990099
320000                                  TO DP013-PARAGRAPH              32000099
320100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      32010099
320200                                  TO DP013-MESSAGE-TEXT(1)        32020099
320300         PERFORM DP013-0000-PROCESS-ABEND                         32030099
320400     END-IF.                                                      32040099
320500                                                                  32050099
320600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32060099
320700                                                                  32070099
320800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         32080099
320900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               32090099
321000     END-IF.                                                      32100099
321100                                                                  32110099
321200*----------------------------------------------------------------*32120099
321300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *32130099
321400*----------------------------------------------------------------*32140099
321500 4420-FORMAT-LIST-LINES.                                          32150099
321600*    IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      32160099
321700*        SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32170099
321800*        MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           32180099
321900*        MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           32190099
322000*        MOVE SPACE              TO MR-SELECTI (PV-SUB)           32200099
322100*        MOVE ZEROES             TO MR-1ST-CTNS-HARD (PV-SUB)     32210099
322200*        MOVE ZEROES             TO MR-1ST-CTNS-SOFT (PV-SUB)     32220099
322300*    ELSE                                                         32230099
322400*        IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32240099
322500*                                                  > SPACE        32250099
322600*            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32260099
322700*                                TO MR-SELECTI (PV-SUB)           32270099
322800*        ELSE                                                     32280099
322900*            MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32290099
323000*                                TO MR-SELECTI (PV-SUB)           32300099
323100*        END-IF                                                   32310099
323200*                                                                 32320099
323300     IF ASC-CARTONS-FOUND-SW = 'Y'                                32330099
323400*1ST QUARTER CTNS                                                 32340099
323500         MOVE ASC-COUNT(1, 1, 1)                                  32350099
323600                           TO MR-1ST-CTNS-HARD (PV-SUB)           32360099
323700                                                                  32370099
323800         MOVE ASC-COUNT(1, 1, 2)                                  32380099
323900                           TO MR-1ST-CTNS-SOFT (PV-SUB)           32390099
324000         MOVE ASC-COUNT(1, 1, 3)                                  32400099
324100                           TO MR-1ST-CTNS-HANG (PV-SUB)           32410099
324200         MOVE ASC-COUNT(1, 1, 4)                                  32420099
324300                           TO MR-1ST-CTNS-FOLD (PV-SUB)           32430099
324400         MOVE ASC-COUNT(1, 1, 5)                                  32440099
324500                           TO MR-1ST-CTNS-REPL (PV-SUB)           32450099
324600         MOVE ASC-COUNT(1, 1, 6)                                  32460099
324700                           TO MR-1ST-CTNS-NEW  (PV-SUB)           32470099
324800         MOVE ASC-COUNT(1, 1, 7)                                  32480099
324900                           TO MR-1ST-CTNS-EAS  (PV-SUB)           32490099
325000         MOVE ASC-COUNT(1, 1, 8)                                  32500099
325100                           TO MR-1ST-CTNS-CLRNCE (PV-SUB)         32510099
325200         MOVE ASC-COUNT(1, 1, 9)                                  32520099
325300                           TO MR-1ST-CTNS-TOTAL  (PV-SUB)         32530099
325400*                                                                 32540099
325500*1ST QUARTER SKUS                                                 32550099
325600         MOVE ASC-COUNT(1, 2, 1)                                  32560099
325700                           TO MR-1ST-SKUS-HARD (PV-SUB)           32570099
325800         MOVE ASC-COUNT(1, 2, 2)                                  32580099
325900                           TO MR-1ST-SKUS-SOFT (PV-SUB)           32590099
326000         MOVE ASC-COUNT(1, 2, 3)                                  32600099
326100                           TO MR-1ST-SKUS-HANG (PV-SUB)           32610099
326200         MOVE ASC-COUNT(1, 2, 4)                                  32620099
326300                           TO MR-1ST-SKUS-FOLD (PV-SUB)           32630099
326400         MOVE ASC-COUNT(1, 2, 5)                                  32640099
326500                           TO MR-1ST-SKUS-REPL (PV-SUB)           32650099
326600         MOVE ASC-COUNT(1, 2, 6)                                  32660099
326700                           TO MR-1ST-SKUS-NEW  (PV-SUB)           32670099
326800         MOVE ASC-COUNT(1, 2, 7)                                  32680099
326900                           TO MR-1ST-SKUS-EAS  (PV-SUB)           32690099
327000         MOVE ASC-COUNT(1, 2, 8)                                  32700099
327100                           TO MR-1ST-SKUS-CLRNCE (PV-SUB)         32710099
327200         MOVE ASC-COUNT(1, 2, 9)                                  32720099
327300                           TO MR-1ST-SKUS-TOTAL  (PV-SUB)         32730099
327400*                                                                 32740099
327500*1ST QUARTER UNITS                                                32750099
327600         MOVE ASC-COUNT(1, 3, 1)                                  32760099
327700                           TO MR-1ST-UNTS-HARD (PV-SUB)           32770099
327800         MOVE ASC-COUNT(1, 3, 2)                                  32780099
327900                           TO MR-1ST-UNTS-SOFT (PV-SUB)           32790099
328000         MOVE ASC-COUNT(1, 3, 3)                                  32800099
328100                           TO MR-1ST-UNTS-HANG (PV-SUB)           32810099
328200         MOVE ASC-COUNT(1, 3, 4)                                  32820099
328300                           TO MR-1ST-UNTS-FOLD (PV-SUB)           32830099
328400         MOVE ASC-COUNT(1, 3, 5)                                  32840099
328500                           TO MR-1ST-UNTS-REPL (PV-SUB)           32850099
328600         MOVE ASC-COUNT(1, 3, 6)                                  32860099
328700                           TO MR-1ST-UNTS-NEW  (PV-SUB)           32870099
328800         MOVE ASC-COUNT(1, 3, 7)                                  32880099
328900                           TO MR-1ST-UNTS-EAS  (PV-SUB)           32890099
329000         MOVE ASC-COUNT(1, 3, 8)                                  32900099
329100                           TO MR-1ST-UNTS-CLRNCE (PV-SUB)         32910099
329200         MOVE ASC-COUNT(1, 3, 9)                                  32920099
329300                           TO MR-1ST-UNTS-TOTAL  (PV-SUB)         32930099
329400*                                                                 32940099
329500*2ND QUARTER CTNS                                                 32950099
329600         MOVE ASC-COUNT(2, 1, 1)                                  32960099
329700                           TO MR-2ND-CTNS-HARD (PV-SUB)           32970099
329800         MOVE ASC-COUNT(2, 1, 2)                                  32980099
329900                           TO MR-2ND-CTNS-SOFT (PV-SUB)           32990099
330000         MOVE ASC-COUNT(2, 1, 3)                                  33000099
330100                           TO MR-2ND-CTNS-HANG (PV-SUB)           33010099
330200         MOVE ASC-COUNT(2, 1, 4)                                  33020099
330300                           TO MR-2ND-CTNS-FOLD (PV-SUB)           33030099
330400         MOVE ASC-COUNT(2, 1, 5)                                  33040099
330500                           TO MR-2ND-CTNS-REPL (PV-SUB)           33050099
330600         MOVE ASC-COUNT(2, 1, 6)                                  33060099
330700                           TO MR-2ND-CTNS-NEW  (PV-SUB)           33070099
330800         MOVE ASC-COUNT(2, 1, 7)                                  33080099
330900                           TO MR-2ND-CTNS-EAS  (PV-SUB)           33090099
331000         MOVE ASC-COUNT(2, 1, 8)                                  33100099
331100                           TO MR-2ND-CTNS-CLRNCE (PV-SUB)         33110099
331200         MOVE ASC-COUNT(2, 1, 9)                                  33120099
331300                           TO MR-2ND-CTNS-TOTAL  (PV-SUB)         33130099
331400*                                                                 33140099
331500*2ND QUARTER SKUS                                                 33150099
331600         MOVE ASC-COUNT(2, 2, 1)                                  33160099
331700                           TO MR-2ND-SKUS-HARD (PV-SUB)           33170099
331800         MOVE ASC-COUNT(2, 2, 2)                                  33180099
331900                           TO MR-2ND-SKUS-SOFT (PV-SUB)           33190099
332000         MOVE ASC-COUNT(2, 2, 3)                                  33200099
332100                           TO MR-2ND-SKUS-HANG (PV-SUB)           33210099
332200         MOVE ASC-COUNT(2, 2, 4)                                  33220099
332300                           TO MR-2ND-SKUS-FOLD (PV-SUB)           33230099
332400         MOVE ASC-COUNT(2, 2, 5)                                  33240099
332500                           TO MR-2ND-SKUS-REPL (PV-SUB)           33250099
332600         MOVE ASC-COUNT(2, 2, 6)                                  33260099
332700                           TO MR-2ND-SKUS-NEW  (PV-SUB)           33270099
332800         MOVE ASC-COUNT(2, 2, 7)                                  33280099
332900                           TO MR-2ND-SKUS-EAS  (PV-SUB)           33290099
333000         MOVE ASC-COUNT(2, 2, 8)                                  33300099
333100                           TO MR-2ND-SKUS-CLRNCE (PV-SUB)         33310099
333200         MOVE ASC-COUNT(2, 2, 9)                                  33320099
333300                           TO MR-2ND-SKUS-TOTAL  (PV-SUB)         33330099
333400*                                                                 33340099
333500*2ND QUARTER UNITS                                                33350099
333600         MOVE ASC-COUNT(2, 3, 1)                                  33360099
333700                           TO MR-2ND-UNTS-HARD (PV-SUB)           33370099
333800         MOVE ASC-COUNT(2, 3, 2)                                  33380099
333900                           TO MR-2ND-UNTS-SOFT (PV-SUB)           33390099
334000         MOVE ASC-COUNT(2, 3, 3)                                  33400099
334100                           TO MR-2ND-UNTS-HANG (PV-SUB)           33410099
334200         MOVE ASC-COUNT(2, 3, 4)                                  33420099
334300                           TO MR-2ND-UNTS-FOLD (PV-SUB)           33430099
334400         MOVE ASC-COUNT(2, 3, 5)                                  33440099
334500                           TO MR-2ND-UNTS-REPL (PV-SUB)           33450099
334600         MOVE ASC-COUNT(2, 3, 6)                                  33460099
334700                           TO MR-2ND-UNTS-NEW  (PV-SUB)           33470099
334800         MOVE ASC-COUNT(2, 3, 7)                                  33480099
334900                           TO MR-2ND-UNTS-EAS  (PV-SUB)           33490099
335000         MOVE ASC-COUNT(2, 3, 8)                                  33500099
335100                           TO MR-2ND-UNTS-CLRNCE (PV-SUB)         33510099
335200         MOVE ASC-COUNT(2, 3, 9)                                  33520099
335300                           TO MR-2ND-UNTS-TOTAL  (PV-SUB)         33530099
335400*                                                                 33540099
335500*3RD QUARTER CTNS                                                 33550099
335600         MOVE ASC-COUNT(3, 1, 1)                                  33560099
335700                           TO MR-3RD-CTNS-HARD (PV-SUB)           33570099
335800         MOVE ASC-COUNT(3, 1, 2)                                  33580099
335900                           TO MR-3RD-CTNS-SOFT (PV-SUB)           33590099
336000         MOVE ASC-COUNT(3, 1, 3)                                  33600099
336100                           TO MR-3RD-CTNS-HANG (PV-SUB)           33610099
336200         MOVE ASC-COUNT(3, 1, 4)                                  33620099
336300                           TO MR-3RD-CTNS-FOLD (PV-SUB)           33630099
336400         MOVE ASC-COUNT(3, 1, 5)                                  33640099
336500                           TO MR-3RD-CTNS-REPL (PV-SUB)           33650099
336600         MOVE ASC-COUNT(3, 1, 6)                                  33660099
336700                           TO MR-3RD-CTNS-NEW  (PV-SUB)           33670099
336800         MOVE ASC-COUNT(3, 1, 7)                                  33680099
336900                           TO MR-3RD-CTNS-EAS  (PV-SUB)           33690099
337000         MOVE ASC-COUNT(3, 1, 8)                                  33700099
337100                           TO MR-3RD-CTNS-CLRNCE (PV-SUB)         33710099
337200         MOVE ASC-COUNT(3, 1, 9)                                  33720099
337300                           TO MR-3RD-CTNS-TOTAL  (PV-SUB)         33730099
337400*                                                                 33740099
337500*3RD QUARTER SKUS                                                 33750099
337600         MOVE ASC-COUNT(3, 2, 1)                                  33760099
337700                           TO MR-3RD-SKUS-HARD (PV-SUB)           33770099
337800         MOVE ASC-COUNT(3, 2, 2)                                  33780099
337900                           TO MR-3RD-SKUS-SOFT (PV-SUB)           33790099
338000         MOVE ASC-COUNT(3, 2, 3)                                  33800099
338100                           TO MR-3RD-SKUS-HANG (PV-SUB)           33810099
338200         MOVE ASC-COUNT(3, 2, 4)                                  33820099
338300                           TO MR-3RD-SKUS-FOLD (PV-SUB)           33830099
338400         MOVE ASC-COUNT(3, 2, 5)                                  33840099
338500                           TO MR-3RD-SKUS-REPL (PV-SUB)           33850099
338600         MOVE ASC-COUNT(3, 2, 6)                                  33860099
338700                           TO MR-3RD-SKUS-NEW  (PV-SUB)           33870099
338800         MOVE ASC-COUNT(3, 2, 7)                                  33880099
338900                           TO MR-3RD-SKUS-EAS  (PV-SUB)           33890099
339000         MOVE ASC-COUNT(3, 2, 8)                                  33900099
339100                           TO MR-3RD-SKUS-CLRNCE (PV-SUB)         33910099
339200         MOVE ASC-COUNT(3, 2, 9)                                  33920099
339300                           TO MR-3RD-SKUS-TOTAL  (PV-SUB)         33930099
339400*                                                                 33940099
339500*3RD QUARTER UNITS                                                33950099
339600         MOVE ASC-COUNT(3, 3, 1)                                  33960099
339700                           TO MR-3RD-UNTS-HARD (PV-SUB)           33970099
339800         MOVE ASC-COUNT(3, 3, 2)                                  33980099
339900                           TO MR-3RD-UNTS-SOFT (PV-SUB)           33990099
340000         MOVE ASC-COUNT(3, 3, 3)                                  34000099
340100                           TO MR-3RD-UNTS-HANG (PV-SUB)           34010099
340200         MOVE ASC-COUNT(3, 3, 4)                                  34020099
340300                           TO MR-3RD-UNTS-FOLD (PV-SUB)           34030099
340400         MOVE ASC-COUNT(3, 3, 5)                                  34040099
340500                           TO MR-3RD-UNTS-REPL (PV-SUB)           34050099
340600         MOVE ASC-COUNT(3, 3, 6)                                  34060099
340700                           TO MR-3RD-UNTS-NEW  (PV-SUB)           34070099
340800         MOVE ASC-COUNT(3, 3, 7)                                  34080099
340900                           TO MR-3RD-UNTS-EAS  (PV-SUB)           34090099
341000         MOVE ASC-COUNT(3, 3, 8)                                  34100099
341100                           TO MR-3RD-UNTS-CLRNCE (PV-SUB)         34110099
341200         MOVE ASC-COUNT(3, 3, 9)                                  34120099
341300                           TO MR-3RD-UNTS-TOTAL  (PV-SUB)         34130099
341400*                                                                 34140099
341500*4TH QUARTER CTNS                                                 34150099
341600         MOVE ASC-COUNT(4, 1, 1)                                  34160099
341700                           TO MR-4TH-CTNS-HARD (PV-SUB)           34170099
341800         MOVE ASC-COUNT(4, 1, 2)                                  34180099
341900                           TO MR-4TH-CTNS-SOFT (PV-SUB)           34190099
342000         MOVE ASC-COUNT(4, 1, 3)                                  34200099
342100                           TO MR-4TH-CTNS-HANG (PV-SUB)           34210099
342200         MOVE ASC-COUNT(4, 1, 4)                                  34220099
342300                           TO MR-4TH-CTNS-FOLD (PV-SUB)           34230099
342400         MOVE ASC-COUNT(4, 1, 5)                                  34240099
342500                           TO MR-4TH-CTNS-REPL (PV-SUB)           34250099
342600         MOVE ASC-COUNT(4, 1, 6)                                  34260099
342700                           TO MR-4TH-CTNS-NEW  (PV-SUB)           34270099
342800         MOVE ASC-COUNT(4, 1, 7)                                  34280099
342900                           TO MR-4TH-CTNS-EAS  (PV-SUB)           34290099
343000         MOVE ASC-COUNT(4, 1, 8)                                  34300099
343100                           TO MR-4TH-CTNS-CLRNCE (PV-SUB)         34310099
343200         MOVE ASC-COUNT(4, 1, 9)                                  34320099
343300                           TO MR-4TH-CTNS-TOTAL  (PV-SUB)         34330099
343400*                                                                 34340099
343500*4TH QUARTER SKUS                                                 34350099
343600         MOVE ASC-COUNT(4, 2, 1)                                  34360099
343700                           TO MR-4TH-SKUS-HARD (PV-SUB)           34370099
343800         MOVE ASC-COUNT(4, 2, 2)                                  34380099
343900                           TO MR-4TH-SKUS-SOFT (PV-SUB)           34390099
344000         MOVE ASC-COUNT(4, 2, 3)                                  34400099
344100                           TO MR-4TH-SKUS-HANG (PV-SUB)           34410099
344200         MOVE ASC-COUNT(4, 2, 4)                                  34420099
344300                           TO MR-4TH-SKUS-FOLD (PV-SUB)           34430099
344400         MOVE ASC-COUNT(4, 2, 5)                                  34440099
344500                           TO MR-4TH-SKUS-REPL (PV-SUB)           34450099
344600         MOVE ASC-COUNT(4, 2, 6)                                  34460099
344700                           TO MR-4TH-SKUS-NEW  (PV-SUB)           34470099
344800         MOVE ASC-COUNT(4, 2, 7)                                  34480099
344900                           TO MR-4TH-SKUS-EAS  (PV-SUB)           34490099
345000         MOVE ASC-COUNT(4, 2, 8)                                  34500099
345100                           TO MR-4TH-SKUS-CLRNCE (PV-SUB)         34510099
345200         MOVE ASC-COUNT(4, 2, 9)                                  34520099
345300                           TO MR-4TH-SKUS-TOTAL  (PV-SUB)         34530099
345400*                                                                 34540099
345500*4TH QUARTER UNITS                                                34550099
345600         MOVE ASC-COUNT(4, 3, 1)                                  34560099
345700                           TO MR-4TH-UNTS-HARD (PV-SUB)           34570099
345800         MOVE ASC-COUNT(4, 3, 2)                                  34580099
345900                           TO MR-4TH-UNTS-SOFT (PV-SUB)           34590099
346000         MOVE ASC-COUNT(4, 3, 3)                                  34600099
346100                           TO MR-4TH-UNTS-HANG (PV-SUB)           34610099
346200         MOVE ASC-COUNT(4, 3, 4)                                  34620099
346300                           TO MR-4TH-UNTS-FOLD (PV-SUB)           34630099
346400         MOVE ASC-COUNT(4, 3, 5)                                  34640099
346500                           TO MR-4TH-UNTS-REPL (PV-SUB)           34650099
346600         MOVE ASC-COUNT(4, 3, 6)                                  34660099
346700                           TO MR-4TH-UNTS-NEW  (PV-SUB)           34670099
346800         MOVE ASC-COUNT(4, 3, 7)                                  34680099
346900                           TO MR-4TH-UNTS-EAS  (PV-SUB)           34690099
347000         MOVE ASC-COUNT(4, 3, 8)                                  34700099
347100                           TO MR-4TH-UNTS-CLRNCE (PV-SUB)         34710099
347200         MOVE ASC-COUNT(4, 3, 9)                                  34720099
347300                           TO MR-4TH-UNTS-TOTAL  (PV-SUB)         34730099
347400*                                                                 34740099
347500*TOTAL CARTONS                                                    34750099
347600         MOVE ASC-COUNT(5, 1, 1)                                  34760099
347700                           TO MR-TOT-CTNS-HARD (PV-SUB)           34770099
347800         MOVE ASC-COUNT(5, 1, 2)                                  34780099
347900                           TO MR-TOT-CTNS-SOFT (PV-SUB)           34790099
348000         MOVE ASC-COUNT(5, 1, 3)                                  34800099
348100                           TO MR-TOT-CTNS-HANG (PV-SUB)           34810099
348200         MOVE ASC-COUNT(5, 1, 4)                                  34820099
348300                           TO MR-TOT-CTNS-FOLD (PV-SUB)           34830099
348400         MOVE ASC-COUNT(5, 1, 5)                                  34840099
348500                           TO MR-TOT-CTNS-REPL (PV-SUB)           34850099
348600         MOVE ASC-COUNT(5, 1, 6)                                  34860099
348700                           TO MR-TOT-CTNS-NEW  (PV-SUB)           34870099
348800         MOVE ASC-COUNT(5, 1, 7)                                  34880099
348900                           TO MR-TOT-CTNS-EAS  (PV-SUB)           34890099
349000         MOVE ASC-COUNT(5, 1, 8)                                  34900099
349100                           TO MR-TOT-CTNS-CLRNCE (PV-SUB)         34910099
349200         MOVE ASC-COUNT(5, 1, 9)                                  34920099
349300                           TO MR-TOT-CTNS-TOTAL  (PV-SUB)         34930099
349400*                                                                 34940099
349500*TOTAL SKUS                                                       34950099
349600         MOVE ASC-COUNT(5, 2, 1)                                  34960099
349700                           TO MR-TOT-SKUS-HARD (PV-SUB)           34970099
349800         MOVE ASC-COUNT(5, 2, 2)                                  34980099
349900                           TO MR-TOT-SKUS-SOFT (PV-SUB)           34990099
350000         MOVE ASC-COUNT(5, 2, 3)                                  35000099
350100                           TO MR-TOT-SKUS-HANG (PV-SUB)           35010099
350200         MOVE ASC-COUNT(5, 2, 4)                                  35020099
350300                           TO MR-TOT-SKUS-FOLD (PV-SUB)           35030099
350400         MOVE ASC-COUNT(5, 2, 5)                                  35040099
350500                           TO MR-TOT-SKUS-REPL (PV-SUB)           35050099
350600         MOVE ASC-COUNT(5, 2, 6)                                  35060099
350700                           TO MR-TOT-SKUS-NEW  (PV-SUB)           35070099
350800         MOVE ASC-COUNT(5, 2, 7)                                  35080099
350900                           TO MR-TOT-SKUS-EAS  (PV-SUB)           35090099
351000         MOVE ASC-COUNT(5, 2, 8)                                  35100099
351100                           TO MR-TOT-SKUS-CLRNCE (PV-SUB)         35110099
351200         MOVE ASC-COUNT(5, 2, 9)                                  35120099
351300                           TO MR-TOT-SKUS-TOTAL  (PV-SUB)         35130099
351400*                                                                 35140099
351500*TOTAL UNITS                                                      35150099
351600         MOVE ASC-COUNT(5, 3, 1)                                  35160099
351700                           TO MR-TOT-UNTS-HARD (PV-SUB)           35170099
351800         MOVE ASC-COUNT(5, 3, 2)                                  35180099
351900                           TO MR-TOT-UNTS-SOFT (PV-SUB)           35190099
352000         MOVE ASC-COUNT(5, 3, 3)                                  35200099
352100                           TO MR-TOT-UNTS-HANG (PV-SUB)           35210099
352200         MOVE ASC-COUNT(5, 3, 4)                                  35220099
352300                           TO MR-TOT-UNTS-FOLD (PV-SUB)           35230099
352400         MOVE ASC-COUNT(5, 3, 5)                                  35240099
352500                           TO MR-TOT-UNTS-REPL (PV-SUB)           35250099
352600         MOVE ASC-COUNT(5, 3, 6)                                  35260099
352700                           TO MR-TOT-UNTS-NEW  (PV-SUB)           35270099
352800         MOVE ASC-COUNT(5, 3, 7)                                  35280099
352900                           TO MR-TOT-UNTS-EAS  (PV-SUB)           35290099
353000         MOVE ASC-COUNT(5, 3, 8)                                  35300099
353100                           TO MR-TOT-UNTS-CLRNCE (PV-SUB)         35310099
353200         MOVE ASC-COUNT(5, 3, 9)                                  35320099
353300                           TO MR-TOT-UNTS-TOTAL  (PV-SUB)         35330099
353400     ELSE                                                         35340099
353500        MOVE ASC-STR-NBR              TO ASTOREO                  35350099
353600        MOVE ASC-STORE-NAME           TO ASTNMEO                  35360099
353700        MOVE ASC-TRLR-ID              TO ATRLRO                   35370099
353800        MOVE ASC-TRLR-SRL-NMBR        TO ATRSRLO                  35380099
353900                                                                  35390099
354000        SET DP020-MSG-WARNING TO  TRUE                            35400099
354100        MOVE PC-TSYMSG-03495 TO  DP020-MSG-NUMBER                 35410099
354200        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       35420099
354300     END-IF.                                                      35430099
354400                                                                  35440099
354500     SUBTRACT +1 FROM ASC-ITEM-SUB                                35450099
354600     IF  ASC-ITEM-SUB < + 1                                       35460099
354700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35470099
354800         MOVE +1                 TO ASC-BLK-SUB                   35480099
354900     END-IF.                                                      35490099
355000                                                                  35500099
355100******************************************************************35510099
355200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **35520099
355300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **35530099
355400** ISSUE A WARNING.                                             **35540099
355500******************************************************************35550099
355600 4430-CHECK-FOR-BEGIN-AND-END.                                    35560099
355700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       35570099
355800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     35580099
355900*            -- NO END-OF-RANGE SPECFIED ---                      35590099
356000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            35600099
356100             SET DP020-MSG-WARNING TO TRUE                        35610099
356200             PERFORM 4431-POSITION-AT-WARNING                     35620099
356300         END-IF                                                   35630099
356400     ELSE                                                         35640099
356500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     35650099
356600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                35660099
356700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            35670099
356800             SET DP020-MSG-WARNING TO TRUE                        35680099
356900             PERFORM 4431-POSITION-AT-WARNING                     35690099
357000         END-IF                                                   35700099
357100     END-IF.                                                      35710099
357200******************************************************************35720099
357300** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **35730099
357400** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **35740099
357500** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **35750099
357600** POSITION THE CURSOR THERE.                                   **35760099
357700******************************************************************35770099
357800 4431-POSITION-AT-WARNING.                                        35780099
357900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 35790099
358000                    - PV-TOP-ITEM + 1.                            35800099
358100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35810099
358200         CONTINUE                                                 35820099
358300     ELSE                                                         35830099
358400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      35840099
358500         MOVE -1                    TO ASTOREL                    35850099
358600     END-IF.                                                      35860099
358700                                                                  35870099
358800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   35880099
358900                    - PV-TOP-ITEM + 1.                            35890099
359000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      35900099
359100         CONTINUE                                                 35910099
359200     ELSE                                                         35920099
359300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      35930099
359400         MOVE -1                   TO ASTOREL                     35940099
359500     END-IF.                                                      35950099
359600                                                                  35960099
359700*----------------------------------------------------------------*35970099
359800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *35980099
359900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *35990099
360000* FOR THE SELECTED ITEMS QUEUE.                                  *36000099
360100*                                                                *36010099
360200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *36020099
360300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *36030099
360400* THE ARRAY IS FULL.                                             *36040099
360500*----------------------------------------------------------------*36050099
360600*5000-PREPARE-SEL-QUEUE.                                          36060099
360700*                                                                 36070099
360800*    MOVE ASC-SEL-QUEUE-NAME     TO  SU012-SEL-QUEUE-NAME.        36080099
360900*                                                                 36090099
361000*    SET ASC-UPDATE-TSQ        TO  TRUE.                          36100099
361100*    SET SU012-UPDATE-TSQ      TO  TRUE.                          36110099
361200*                                                                 36120099
361300*    SET SU012-IDX         TO  1.                                 36130099
361400*    INITIALIZE SU012-SELECTED-ITEM-ARRAY.                        36140099
361500*                                                                 36150099
361600*    MOVE +1                   TO  ASC-BLK-SUB.                   36160099
361700*    PERFORM 5100-WRITE-TEMP-STORAGE.                             36170099
361800*    ADD +1                    TO  ASC-BLK-SUB.                   36180099
361900*    PERFORM 5100-WRITE-TEMP-STORAGE.                             36190099
362000*                                                                 36200099
362100*    MOVE ASC-SEL-QUEUE-NAME-OUT TO  SU012-SEL-QUEUE-NAME.        36210099
362200*    PERFORM 6010-DELETE-SEL-QUEUE.                               36220099
362300*                                                                 36230099
362400*    SET ASC-UPDATE-TSQ        TO  TRUE.                          36240099
362500*                                                                 36250099
362600*    SET SU013-IDX             TO  1.                             36260099
362700*    MOVE ZERO                 TO SU012-NUMBER-OF-TS-ITEMS.       36270099
362800*    INITIALIZE SU013-SELECTED-ITEM-ARRAY.                        36280099
362900*                                                                 36290099
363000*    PERFORM 5200-FILL-SEL-QUEUE-RECORD                           36300099
363100*            VARYING PV-ITEM                                      36310099
363200*            FROM 1 BY 1                                          36320099
363300*            UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     36330099
363400*                                                                 36340099
363500*    IF  SU013-IDX > 1                                            36350099
363600*        PERFORM 5205-WRITE-SEL-QUEUE                             36360099
363700*        ADD +1                TO SU012-NUMBER-OF-TS-ITEMS        36370099
363800*    END-IF.                                                      36380099
363900*                                                                 36390099
364000*----------------------------------------------------------------*36400099
364100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *36410099
364200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *36420099
364300*----------------------------------------------------------------*36430099
364400 5100-WRITE-TEMP-STORAGE.                                         36440099
364500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     36450099
364600                                   TO PV-LIST-ITEM-NUMBER.        36460099
364700     COMPUTE PV-BLOCK-NUMBER =                                    36470099
364800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36480099
364900                                                                  36490099
365000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             36500099
365100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             36510099
365200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      36520099
365300             PERFORM 5105-REWRITE-ASC-LISTQ                       36530099
365400         END-IF                                                   36540099
365500     ELSE                                                         36550099
365600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       36560099
365700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            36570099
365800         PERFORM 5110-WRITE-ASC-LISTQ                             36580099
365900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   36590099
366000     END-IF.                                                      36600099
366100                                                                  36610099
366200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             36620099
366300                                                                  36630099
366400******************************************************************36640099
366500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **36650099
366600** SPECIFIC COMMAREA.                                           **36660099
366700******************************************************************36670099
366800 5105-REWRITE-ASC-LISTQ.                                          36680099
366900     EXEC CICS                                                    36690099
367000         WRITEQ TS                                                36700099
367100             QUEUE (ASC-LIST-QUEUE-NAME)                          36710099
367200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36720099
367300             ITEM  (PV-BLOCK-NUMBER)                              36730099
367400             REWRITE                                              36740099
367500             RESP  (PV-CICS-RESP)                                 36750099
367600     END-EXEC.                                                    36760099
367700                                                                  36770099
367800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           36780099
367900         CONTINUE                                                 36790099
368000     ELSE                                                         36800099
368100         SET DP013-CICS-ABEND            TO TRUE                  36810099
368200         SET DP013-NO-ROLLBACK           TO TRUE                  36820099
368300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       36830099
368400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     36840099
368500                                         TO DP013-MESSAGE-TEXT(1) 36850099
368600         PERFORM DP013-0000-PROCESS-ABEND                         36860099
368700     END-IF.                                                      36870099
368800                                                                  36880099
368900******************************************************************36890099
369000** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **36900099
369100** SPECIFIC COMMAREA.                                           **36910099
369200******************************************************************36920099
369300 5110-WRITE-ASC-LISTQ.                                            36930099
369400     EXEC CICS                                                    36940099
369500         WRITEQ TS                                                36950099
369600             QUEUE (ASC-LIST-QUEUE-NAME)                          36960099
369700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36970099
369800             ITEM  (PV-BLOCK-NUMBER)                              36980099
369900             RESP  (PV-CICS-RESP)                                 36990099
370000     END-EXEC.                                                    37000099
370100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      37010099
370200         SET DP013-CICS-ABEND      TO TRUE                        37020099
370300         SET DP013-NO-ROLLBACK     TO TRUE                        37030099
370400         MOVE '5110-WRITE-ASC-LISTQ'                              37040099
370500                                   TO DP013-PARAGRAPH             37050099
370600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           37060099
370700                                   TO DP013-MESSAGE-TEXT(1)       37070099
370800         PERFORM DP013-0000-PROCESS-ABEND                         37080099
370900     END-IF.                                                      37090099
371000                                                                  37100099
371100*----------------------------------------------------------------*37110099
371200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *37120099
371300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *37130099
371400*----------------------------------------------------------------*37140099
371500 5200-FILL-SEL-QUEUE-RECORD.                                      37150099
371600                                                                  37160099
371700     PERFORM 6112-READ-LIST-QUEUE.                                37170099
371800                                                                  37180099
371900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37190099
372000         PERFORM                                                  37200099
372100         VARYING LQW-IDX                                          37210099
372200         FROM 1 BY 1                                              37220099
372300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37230099
372400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37240099
372500                                                                  37250099
372600             IF  LQW-SELECT (LQW-IDX)                             37260099
372700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              37270099
372800                                   TO SU013-ITEM (SU013-IDX)      37280099
372900                 MOVE SPACE        TO SU013-ACTION-SW (SU013-IDX) 37290099
373000                                                                  37300099
373100*                                                                 37310099
373200*                MOVE LQW-TRIP-ID (LQW-IDX)                       37320099
373300*                                    TO SU013-TRIP-ID (SU013-IDX) 37330099
373400                                                                  37340099
373500                 SET SU013-IDX UP BY 1                            37350099
373600                 IF  SU013-IDX > SU013-MAX-ITEMS                  37360099
373700                     PERFORM 5205-WRITE-SEL-QUEUE                 37370099
373800                     ADD +1        TO SU012-NUMBER-OF-TS-ITEMS    37380099
373900                     INITIALIZE SU013-SELECTED-ITEM-ARRAY         37390099
374000                     SET SU013-IDX TO  1                          37400099
374100                 END-IF                                           37410099
374200             END-IF                                               37420099
374300         END-PERFORM                                              37430099
374400     END-IF.                                                      37440099
374500                                                                  37450099
374600*----------------------------------------------------------------*37460099
374700*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37470099
374800*----------------------------------------------------------------*37480099
374900 5205-WRITE-SEL-QUEUE.                                            37490099
375000                                                                  37500099
375100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37510099
375200                                   TO SU013-SELECTED-ITEMS.       37520099
375300                                                                  37530099
375400     EXEC CICS                                                    37540099
375500          WRITEQ TS                                               37550099
375600              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      37560099
375700              FROM  (SU013-SELECT-RECORD)                         37570099
375800              ITEM  (PV-SEL-QUEUE-ITEM)                           37580099
375900              RESP  (PV-CICS-RESP)                                37590099
376000     END-EXEC.                                                    37600099
376100                                                                  37610099
376200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37620099
376300         CONTINUE                                                 37630099
376400     ELSE                                                         37640099
376500         SET DP013-CICS-ABEND      TO TRUE                        37650099
376600         SET DP013-NO-ROLLBACK     TO TRUE                        37660099
376700         MOVE '5205-WRITE-SEL-QUEUE'                              37670099
376800                                   TO DP013-PARAGRAPH             37680099
376900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          37690099
377000                                   TO DP013-MESSAGE-TEXT(1)       37700099
377100         PERFORM DP013-0000-PROCESS-ABEND                         37710099
377200     END-IF.                                                      37720099
377300                                                                  37730099
377400******************************************************************37740099
377500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **37750099
377600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **37760099
377700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **37770099
377800** THE USER.                                                    **37780099
377900******************************************************************37790099
378000 6000-REFRESH-PANEL-FROM-TEMP.                                    37800099
378100     IF  ASC-UPDATE-TSQ                                           37810099
378200         SET ASC-NO-TSQ-UPDATE TO TRUE                            37820099
378300         MOVE ZERO                 TO PV-SAVE-ITEM                37830099
378400                                      PV-SEL-QUEUE-ITEM           37840099
378500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        37850099
378600                                   TO PV-HOLD-SELECTED-ITEMS      37860099
378700         MOVE +1                   TO PV-ITEMS-PROCESSED          37870099
378800         PERFORM 6100-UPDATE-TSQ                                  37880099
378900             UNTIL PV-ITEMS-PROCESSED >                           37890099
379000                                     PV-HOLD-SELECTED-ITEMS       37900099
379100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         37910099
379200                    ASC-BLOCK-ENTRIES (2)                         37920099
379300     END-IF.                                                      37930099
379400                                                                  37940099
379500*----------------------------------------------------------------*37950099
379600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *37960099
379700*----------------------------------------------------------------*37970099
379800 6010-DELETE-SEL-QUEUE.                                           37980099
379900                                                                  37990099
380000     EXEC CICS                                                    38000099
380100         DELETEQ TS                                               38010099
380200             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       38020099
380300             RESP  (PV-CICS-RESP)                                 38030099
380400     END-EXEC.                                                    38040099
380500*                                                                 38050099
380600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      38060099
380700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         38070099
380800         CONTINUE                                                 38080099
380900     ELSE                                                         38090099
381000         SET DP013-CICS-ABEND TO TRUE                             38100099
381100         SET DP013-NO-ROLLBACK TO TRUE                            38110099
381200         MOVE '6010-DELETE-SEL-QUEUE'                             38120099
381300                        TO DP013-PARAGRAPH                        38130099
381400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         38140099
381500                        TO DP013-MESSAGE-TEXT (1)                 38150099
381600         PERFORM DP013-0000-PROCESS-ABEND                         38160099
381700     END-IF.                                                      38170099
381800                                                                  38180099
381900*----------------------------------------------------------------*38190099
382000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *38200099
382100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *38210099
382200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *38220099
382300*    THE TEMP QUEUE.                                             *38230099
382400*----------------------------------------------------------------*38240099
382500 6100-UPDATE-TSQ.                                                 38250099
382600                                                                  38260099
382700     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             38270099
382800     PERFORM 6150-READ-SEL-QUEUE.                                 38280099
382900     PERFORM                                                      38290099
383000         VARYING SU013-IDX                                        38300099
383100         FROM 1 BY 1                                              38310099
383200         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     38320099
383300         OR (SU013-IDX GREATER THAN SU013-MAX-ITEMS))             38330099
383400         IF  SU013-ACTION-SW (SU013-IDX) > SPACE                  38340099
383500             PERFORM 6110-PROCESS-ITEMS                           38350099
383600         END-IF                                                   38360099
383700         ADD +1                TO PV-ITEMS-PROCESSED              38370099
383800     END-PERFORM.                                                 38380099
383900     PERFORM 6111-WRITE-LIST-QUEUE.                               38390099
384000                                                                  38400099
384100*----------------------------------------------------------------*38410099
384200*    READ THE LIST QUEUE RECORD.                                 *38420099
384300*----------------------------------------------------------------*38430099
384400 6150-READ-SEL-QUEUE.                                             38440099
384500                                                                  38450099
384600     EXEC CICS                                                    38460099
384700          READQ TS                                                38470099
384800              QUEUE (ASC-SEL-QUEUE-NAME-IN)                       38480099
384900              INTO  (SU013-SELECT-RECORD)                         38490099
385000              ITEM  (PV-SEL-QUEUE-ITEM)                           38500099
385100              RESP  (PV-CICS-RESP)                                38510099
385200     END-EXEC.                                                    38520099
385300                                                                  38530099
385400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38540099
385500         CONTINUE                                                 38550099
385600     ELSE                                                         38560099
385700         SET DP013-CICS-ABEND      TO  TRUE                       38570099
385800         SET DP013-NO-ROLLBACK     TO  TRUE                       38580099
385900         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           38590099
386000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           38600099
386100                                   TO  DP013-MESSAGE-TEXT(1)      38610099
386200         PERFORM DP013-0000-PROCESS-ABEND                         38620099
386300     END-IF.                                                      38630099
386400                                                                  38640099
386500*----------------------------------------------------------------*38650099
386600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*38660099
386700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*38670099
386800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *38680099
386900*----------------------------------------------------------------*38690099
387000 6110-PROCESS-ITEMS.                                              38700099
387100                                                                  38710099
387200     COMPUTE PV-ITEM = 1 + ((SU013-ITEM (SU013-IDX) - 1)          38720099
387300                     / PC-ITEMS-PER-PANEL).                       38730099
387400                                                                  38740099
387500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           38750099
387600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          38760099
387700             PERFORM 6111-WRITE-LIST-QUEUE                        38770099
387800         END-IF                                                   38780099
387900         MOVE PV-ITEM          TO PV-SAVE-ITEM                    38790099
388000                                                                  38800099
388100         PERFORM 6112-READ-LIST-QUEUE                             38810099
388200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               38820099
388300             CONTINUE                                             38830099
388400         END-IF                                                   38840099
388500     END-IF.                                                      38850099
388600                                                                  38860099
388700     COMPUTE PV-SUB = (SU013-ITEM (SU013-IDX)                     38870099
388800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              38880099
388900     SET LQW-DESELECT (PV-SUB) TO    TRUE                         38890099
389000     MOVE LQW-SELECTED-SW (PV-SUB)                                38900099
389100                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  38910099
389200                                                                  38920099
389300     EVALUATE TRUE                                                38930099
389400         WHEN SU013-INQ (SU013-IDX)                               38940099
389500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             38950099
389600                                                                  38960099
389700         WHEN SU013-UPD (SU013-IDX)                               38970099
389800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             38980099
389900                                                                  38990099
390000         WHEN SU013-DEL (SU013-IDX)                               39000099
390100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             39010099
390200                                                                  39020099
390300         WHEN SU013-ERR (SU013-IDX)                               39030099
390400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             39040099
390500     END-EVALUATE.                                                39050099
390600                                                                  39060099
390700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                39070099
390800                                                                  39080099
390900*----------------------------------------------------------------*39090099
391000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *39100099
391100*----------------------------------------------------------------*39110099
391200 6111-WRITE-LIST-QUEUE.                                           39120099
391300                                                                  39130099
391400     EXEC CICS                                                    39140099
391500         WRITEQ TS                                                39150099
391600             QUEUE (ASC-LIST-QUEUE-NAME)                          39160099
391700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     39170099
391800             ITEM  (PV-SAVE-ITEM)                                 39180099
391900             REWRITE                                              39190099
392000             RESP  (PV-CICS-RESP)                                 39200099
392100     END-EXEC.                                                    39210099
392200                                                                  39220099
392300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39230099
392400         CONTINUE                                                 39240099
392500     ELSE                                                         39250099
392600         SET DP013-CICS-ABEND  TO  TRUE                           39260099
392700         SET DP013-NO-ROLLBACK TO  TRUE                           39270099
392800         MOVE '6111-WRITE-LIST-QUEUE'                             39280099
392900                               TO  DP013-PARAGRAPH                39290099
393000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  39300099
393100                               TO  DP013-MESSAGE-TEXT(1)          39310099
393200         PERFORM DP013-0000-PROCESS-ABEND                         39320099
393300     END-IF.                                                      39330099
393400                                                                  39340099
393500*----------------------------------------------------------------*39350099
393600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*39360099
393700*----------------------------------------------------------------*39370099
393800 6112-READ-LIST-QUEUE.                                            39380099
393900                                                                  39390099
394000     EXEC CICS                                                    39400099
394100         READQ TS                                                 39410099
394200             QUEUE (ASC-LIST-QUEUE-NAME)                          39420099
394300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     39430099
394400             ITEM  (PV-ITEM)                                      39440099
394500             RESP  (PV-CICS-RESP)                                 39450099
394600     END-EXEC.                                                    39460099
394700                                                                  39470099
394800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39480099
394900         CONTINUE                                                 39490099
395000     ELSE                                                         39500099
395100         SET DP013-CICS-ABEND        TO TRUE                      39510099
395200         SET DP013-NO-ROLLBACK       TO TRUE                      39520099
395300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           39530099
395400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    39540099
395500                                     TO DP013-MESSAGE-TEXT(1)     39550099
395600         PERFORM DP013-0000-PROCESS-ABEND                         39560099
395700     END-IF.                                                      39570099
395800*                                                                 39580099
395900*                                                                 39590099
396000 7000-GET-REGION-ID.                                              39600099
396100        EXEC CICS ASSIGN                                          39610099
396200        APPLID(PV-SYSTEM-ID)                                      39620099
396300        END-EXEC.                                                 39630099
396400                                                                  39640099
396500*----------------------------------------------------------------*39650099
396600*  GETS CURRENT DB2 TIMESTAMP.                                    39660099
396700*----------------------------------------------------------------*39670099
396800 7100-GET-CURRENT-TIMESTAMP.                                      39680099
396900         EXEC SQL                                                 39690099
397000             SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP         39700099
397100         END-EXEC.                                                39710099
397200                                                                  39720099
397300         MOVE PV-DB2-CURRENT-TMST TO ASC-RQST-TMST.               39730099
397400/                                                                 39740099
397500******************************************************************39750099
397600 8080-COUNT-SOFTLINE-UNITS.                                       39760099
397700******************************************************************39770099
397800     EXEC SQL                                                     39780099
397900          SELECT SUM(UNT_QTY)                                     39790099
398000            INTO :PV-SOFTLINE-UNITS :PV-NULL-IND-1                39800099
398100            FROM SUT_TRIP_DTL_SUM                                 39810099
398200           WHERE SHIPT_UNT_ID  =  :SUT00095-SHIPT-UNT-ID          39820099
398300             AND TRIP_OCRNC_ID =  :SUT00095-TRIP-OCRNC-ID         39830099
398400             AND MDSE_LNE_CDE  =  'S'                             39840099
398500     END-EXEC.                                                    39850099
398600                                                                  39860099
398700     EVALUATE TRUE                                                39870099
398800         WHEN SQLCODE = ZERO                                      39880099
398900              IF  PV-NULL-IND-1  =  -1                            39890099
399000                  MOVE ZEROES  TO  PV-SOFTLINE-UNITS              39900099
399100              END-IF                                              39910099
399200         WHEN SQLWARN0 NOT = SPACE                                39920099
399300         WHEN SQLCODE NOT = ZERO                                  39930099
399400              MOVE '8080-COUNT-SOFTLINE-UNITS' TO DP013-PARAGRAPH 39940099
399500              MOVE 'SUM UNT QTY FOR SOFTLINES'                    39950099
399600                               TO DP013-MESSAGE-TEXT (1)          39960099
399700              MOVE SQLCA       TO DP013-SQLCA                     39970099
399800              MOVE 'SUT_TRIP_DTL_SUM '                            39980099
399900                               TO DP013-DB2-TABLE-NAME (1)        39990099
400000              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       40000099
400100              SET DP013-DB2-ABEND TO TRUE                         40010099
400200              PERFORM DP013-0000-PROCESS-ABEND                    40020099
400300     END-EVALUATE.                                                40030099
400400                                                                  40040099
400500******************************************************************40050099
400600 8085-COUNT-HARDLINE-UNITS.                                       40060099
400700******************************************************************40070099
400800     EXEC SQL                                                     40080099
400900          SELECT SUM(UNT_QTY)                                     40090099
401000            INTO :PV-HARDLINE-UNITS :PV-NULL-IND-2                40100099
401100            FROM SUT_TRIP_DTL_SUM                                 40110099
401200           WHERE SHIPT_UNT_ID  =  :SUT00095-SHIPT-UNT-ID          40120099
401300             AND TRIP_OCRNC_ID =  :SUT00095-TRIP-OCRNC-ID         40130099
401400             AND MDSE_LNE_CDE  =  'H'                             40140099
401500     END-EXEC.                                                    40150099
401600                                                                  40160099
401700     EVALUATE TRUE                                                40170099
401800         WHEN SQLCODE = ZERO                                      40180099
401900              IF  PV-NULL-IND-2  =  -1                            40190099
402000                  MOVE ZEROES  TO  PV-HARDLINE-UNITS              40200099
402100              END-IF                                              40210099
402200         WHEN SQLWARN0 NOT = SPACE                                40220099
402300         WHEN SQLCODE NOT = ZERO                                  40230099
402400              MOVE '8085-COUNT-HARDLINE-UNITS' TO DP013-PARAGRAPH 40240099
402500              MOVE 'SUM UNT QTY FOR HARDLINES'                    40250099
402600                               TO DP013-MESSAGE-TEXT (1)          40260099
402700              MOVE SQLCA       TO DP013-SQLCA                     40270099
402800              MOVE 'SUT_TRIP_DTL_SUM '                            40280099
402900                               TO DP013-DB2-TABLE-NAME (1)        40290099
403000              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       40300099
403100              SET DP013-DB2-ABEND TO TRUE                         40310099
403200              PERFORM DP013-0000-PROCESS-ABEND                    40320099
403300     END-EVALUATE.                                                40330099
403400                                                                  40340099
403500******************************************************************40350099
403600 8086-COUNT-HANG-UNITS.                                           40360099
403700******************************************************************40370099
403800     EXEC SQL                                                     40380099
403900          SELECT SUM(UNT_QTY)                                     40390099
404000            INTO :PV-HANG-UNITS :PV-NULL-IND-2                    40400099
404100            FROM SUT_TRIP_DTL_SUM                                 40410099
404200           WHERE SHIPT_UNT_ID      =  :SUT00095-SHIPT-UNT-ID      40420099
404300             AND TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     40430099
404400             AND HNG_FOLD_SEQ_NBR  =  1                           40440099
404500     END-EXEC.                                                    40450099
404600                                                                  40460099
404700     EVALUATE TRUE                                                40470099
404800         WHEN SQLCODE = ZERO                                      40480099
404900              IF  PV-NULL-IND-2  =  -1                            40490099
405000                  MOVE ZEROES  TO  PV-HANG-UNITS                  40500099
405100              END-IF                                              40510099
405200         WHEN SQLWARN0 NOT = SPACE                                40520099
405300         WHEN SQLCODE NOT = ZERO                                  40530099
405400              MOVE '8086-COUNT-HANG-UNITS' TO DP013-PARAGRAPH     40540099
405500              MOVE 'SUM UNT QTY FOR HANG MDSE'                    40550099
405600                               TO DP013-MESSAGE-TEXT (1)          40560099
405700              MOVE SQLCA       TO DP013-SQLCA                     40570099
405800              MOVE 'SUT_TRIP_DTL_SUM '                            40580099
405900                               TO DP013-DB2-TABLE-NAME (1)        40590099
406000              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       40600099
406100              SET DP013-DB2-ABEND TO TRUE                         40610099
406200              PERFORM DP013-0000-PROCESS-ABEND                    40620099
406300     END-EVALUATE.                                                40630099
406400                                                                  40640099
406500******************************************************************40650099
406600 8087-COUNT-FOLD-UNITS.                                           40660099
406700******************************************************************40670099
406800     EXEC SQL                                                     40680099
406900          SELECT SUM(UNT_QTY)                                     40690099
407000            INTO :PV-FOLD-UNITS :PV-NULL-IND-1                    40700099
407100            FROM SUT_TRIP_DTL_SUM                                 40710099
407200           WHERE SHIPT_UNT_ID      =  :SUT00095-SHIPT-UNT-ID      40720099
407300             AND TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     40730099
407400             AND HNG_FOLD_SEQ_NBR  =  2                           40740099
407500     END-EXEC.                                                    40750099
407600                                                                  40760099
407700     EVALUATE TRUE                                                40770099
407800         WHEN SQLCODE = ZERO                                      40780099
407900              IF  PV-NULL-IND-1  =  -1                            40790099
408000                  MOVE ZEROES  TO  PV-FOLD-UNITS                  40800099
408100              END-IF                                              40810099
408200         WHEN SQLWARN0 NOT = SPACE                                40820099
408300         WHEN SQLCODE NOT = ZERO                                  40830099
408400              MOVE '8087-COUNT-FOLD-UNITS' TO DP013-PARAGRAPH     40840099
408500              MOVE 'SUM UNT QTY FOR FOLD MDSE'                    40850099
408600                               TO DP013-MESSAGE-TEXT (1)          40860099
408700              MOVE SQLCA       TO DP013-SQLCA                     40870099
408800              MOVE 'SUT_TRIP_DTL_SUM '                            40880099
408900                               TO DP013-DB2-TABLE-NAME (1)        40890099
409000              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       40900099
409100              SET DP013-DB2-ABEND TO TRUE                         40910099
409200              PERFORM DP013-0000-PROCESS-ABEND                    40920099
409300     END-EVALUATE.                                                40930099
409400                                                                  40940099
409500******************************************************************40950099
409600 8089-COUNT-QUART-SKUS.                                           40960099
409700******************************************************************40970099
409800     INITIALIZE  PV-CICS-MSG-AREA                                 40980099
409900     STRING ' SUKCS545 - 1/4 BEGIN - ' PV-QUARTER-BEGIN-TMST      40990099
410000            '  1/4 END - '            PV-QUARTER-END-TMST         41000099
410100                                      DELIMITED BY SIZE           41010099
410200                                 INTO PV-CICS-MSG-AREA            41020099
410300     PERFORM 8500-WRITE-CSSL.                                     41030099
410400                                                                  41040099
410500     PERFORM 8090-TOTAL-SKU-COUNTS.                               41050099
410600     PERFORM 8091-HARD-SKU-COUNTS.                                41060099
410700     PERFORM 8092-SOFT-SKU-COUNTS.                                41070099
410800     PERFORM 8093-HANG-SKU-COUNTS.                                41080099
410900     PERFORM 8094-FOLD-SKU-COUNTS.                                41090099
411000     PERFORM 8095-OH-R-SKU-COUNTS.                                41100099
411100     PERFORM 8096-OH-N-SKU-COUNTS.                                41110099
411200     PERFORM 8097-EAS-SKU-COUNTS.                                 41120099
411300     PERFORM 8098-CLEAR-SKU-COUNTS.                               41130099
411400                                                                  41140099
411500     ADD  PV-HARD-SKU-COUNT                                       41150099
411600                             TO ASC-COUNT(SUB1, 2, 1).            41160099
411700     ADD  PV-SOFT-SKU-COUNT                                       41170099
411800                             TO ASC-COUNT(SUB1, 2, 2).            41180099
411900     ADD  PV-HANG-SKU-COUNT                                       41190099
412000                             TO ASC-COUNT(SUB1, 2, 3).            41200099
412100     ADD  PV-FOLD-SKU-COUNT                                       41210099
412200                             TO ASC-COUNT(SUB1, 2, 4).            41220099
412300     ADD  PV-OH-R-SKU-COUNT                                       41230099
412400                             TO ASC-COUNT(SUB1, 2, 5).            41240099
412500     ADD  PV-OH-N-SKU-COUNT                                       41250099
412600                             TO ASC-COUNT(SUB1, 2, 6).            41260099
412700     ADD  PV-EAS-SKU-COUNT                                        41270099
412800                             TO ASC-COUNT(SUB1, 2, 7).            41280099
412900     ADD  PV-CLEAR-SKU-COUNT                                      41290099
413000                             TO ASC-COUNT(SUB1, 2, 8).            41300099
413100     ADD  PV-TOTAL-SKU-COUNT                                      41310099
413200                             TO ASC-COUNT(SUB1, 2, 9).            41320099
413300*                                                                 41330099
413400******************************************************************41340099
413500*                                                                 41350099
413600******************************************************************41360099
413700 8090-TOTAL-SKU-COUNTS.                                           41370099
413800                                                                  41380099
413900     EXEC SQL                                                     41390099
414000          SELECT COUNT(DISTINCT(SKU_NBR))                         41400099
414100            INTO :PV-TOTAL-SKU-COUNT                              41410099
414200            FROM SUT_TRIP_DTL_SUM                                 41420099
414300           WHERE TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID        41430099
414400             AND DIVERT_TMST   <=  :PV-QUARTER-BEGIN-TMST         41440099
414500             AND DIVERT_TMST   >=  :PV-QUARTER-END-TMST           41450099
414600     END-EXEC.                                                    41460099
414700                                                                  41470099
414800     EVALUATE TRUE                                                41480099
414900         WHEN SQLCODE = ZEROS                                     41490099
415000              CONTINUE                                            41500099
415100         WHEN SQLWARN0 NOT = SPACE                                41510099
415200         WHEN SQLCODE NOT = ZERO                                  41520099
415300              MOVE '8090-TOTAL-SKU-COUNTS' TO DP013-PARAGRAPH     41530099
415400              MOVE 'GET 1/4 SKU COUNT        '                    41540099
415500                               TO DP013-MESSAGE-TEXT (1)          41550099
415600              MOVE SQLCA       TO DP013-SQLCA                     41560099
415700              MOVE 'SUT_TRIP_DTL_SUM '                            41570099
415800                               TO DP013-DB2-TABLE-NAME (1)        41580099
415900              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       41590099
416000              SET DP013-DB2-ABEND TO TRUE                         41600099
416100              PERFORM DP013-0000-PROCESS-ABEND                    41610099
416200     END-EVALUATE.                                                41620099
416300                                                                  41630099
416400                                                                  41640099
416500******************************************************************41650099
416600*                                                                 41660099
416700******************************************************************41670099
416800 8091-HARD-SKU-COUNTS.                                            41680099
416900                                                                  41690099
417000     EXEC SQL                                                     41700099
417100          SELECT COUNT(DISTINCT(SKU_NBR))                         41710099
417200            INTO :PV-HARD-SKU-COUNT                               41720099
417300            FROM SUT_TRIP_DTL_SUM                                 41730099
417400           WHERE TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID        41740099
417500             AND DIVERT_TMST   <=  :PV-QUARTER-BEGIN-TMST         41750099
417600             AND DIVERT_TMST   >=  :PV-QUARTER-END-TMST           41760099
417700             AND MDSE_LNE_CDE   =  'H'                            41770099
417800     END-EXEC.                                                    41780099
417900                                                                  41790099
418000     EVALUATE TRUE                                                41800099
418100         WHEN SQLCODE = ZEROS                                     41810099
418200              CONTINUE                                            41820099
418300         WHEN SQLWARN0 NOT = SPACE                                41830099
418400         WHEN SQLCODE NOT = ZERO                                  41840099
418500              MOVE '8091-HARD-SKU-COUNTS ' TO DP013-PARAGRAPH     41850099
418600              MOVE 'GET 1/4 HARD SKU COUNTS  '                    41860099
418700                               TO DP013-MESSAGE-TEXT (1)          41870099
418800              MOVE SQLCA       TO DP013-SQLCA                     41880099
418900              MOVE 'SUT_TRIP_DTL_SUM '                            41890099
419000                               TO DP013-DB2-TABLE-NAME (1)        41900099
419100              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       41910099
419200              SET DP013-DB2-ABEND TO TRUE                         41920099
419300              PERFORM DP013-0000-PROCESS-ABEND                    41930099
419400     END-EVALUATE.                                                41940099
419500                                                                  41950099
419600                                                                  41960099
419700******************************************************************41970099
419800*                                                                 41980099
419900******************************************************************41990099
420000 8092-SOFT-SKU-COUNTS.                                            42000099
420100                                                                  42010099
420200     EXEC SQL                                                     42020099
420300          SELECT COUNT(DISTINCT(SKU_NBR))                         42030099
420400            INTO :PV-SOFT-SKU-COUNT                               42040099
420500            FROM SUT_TRIP_DTL_SUM                                 42050099
420600           WHERE TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID        42060099
420700             AND DIVERT_TMST   <=  :PV-QUARTER-BEGIN-TMST         42070099
420800             AND DIVERT_TMST   >=  :PV-QUARTER-END-TMST           42080099
420900             AND MDSE_LNE_CDE   =  'S'                            42090099
421000     END-EXEC.                                                    42100099
421100                                                                  42110099
421200     EVALUATE TRUE                                                42120099
421300         WHEN SQLCODE = ZEROS                                     42130099
421400              CONTINUE                                            42140099
421500         WHEN SQLWARN0 NOT = SPACE                                42150099
421600         WHEN SQLCODE NOT = ZERO                                  42160099
421700              MOVE '8092-SOFT-SKU-COUNTS ' TO DP013-PARAGRAPH     42170099
421800              MOVE 'GET 1/4 SOFT SKU COUNTS  '                    42180099
421900                               TO DP013-MESSAGE-TEXT (1)          42190099
422000              MOVE SQLCA       TO DP013-SQLCA                     42200099
422100              MOVE 'SUT_TRIP_DTL_SUM '                            42210099
422200                               TO DP013-DB2-TABLE-NAME (1)        42220099
422300              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       42230099
422400              SET DP013-DB2-ABEND TO TRUE                         42240099
422500              PERFORM DP013-0000-PROCESS-ABEND                    42250099
422600     END-EVALUATE.                                                42260099
422700                                                                  42270099
422800                                                                  42280099
422900******************************************************************42290099
423000*                                                                 42300099
423100******************************************************************42310099
423200 8093-HANG-SKU-COUNTS.                                            42320099
423300                                                                  42330099
423400     EXEC SQL                                                     42340099
423500          SELECT COUNT(DISTINCT(SKU_NBR))                         42350099
423600            INTO :PV-HANG-SKU-COUNT                               42360099
423700            FROM SUT_TRIP_DTL_SUM                                 42370099
423800           WHERE TRIP_OCRNC_ID    =  :SUT00095-TRIP-OCRNC-ID      42380099
423900             AND DIVERT_TMST     <=  :PV-QUARTER-BEGIN-TMST       42390099
424000             AND DIVERT_TMST     >=  :PV-QUARTER-END-TMST         42400099
424100             AND HNG_FOLD_SEQ_NBR  =  1                           42410099
424200     END-EXEC.                                                    42420099
424300                                                                  42430099
424400     EVALUATE TRUE                                                42440099
424500         WHEN SQLCODE = ZEROS                                     42450099
424600              CONTINUE                                            42460099
424700         WHEN SQLWARN0 NOT = SPACE                                42470099
424800         WHEN SQLCODE NOT = ZERO                                  42480099
424900              MOVE '8093-HANG-SKU-COUNTS ' TO DP013-PARAGRAPH     42490099
425000              MOVE 'GET 1/4 HANG SKU COUNTS  '                    42500099
425100                               TO DP013-MESSAGE-TEXT (1)          42510099
425200              MOVE SQLCA       TO DP013-SQLCA                     42520099
425300              MOVE 'SUT_TRIP_DTL_SUM '                            42530099
425400                               TO DP013-DB2-TABLE-NAME (1)        42540099
425500              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       42550099
425600              SET DP013-DB2-ABEND TO TRUE                         42560099
425700              PERFORM DP013-0000-PROCESS-ABEND                    42570099
425800     END-EVALUATE.                                                42580099
425900                                                                  42590099
426000                                                                  42600099
426100******************************************************************42610099
426200*                                                                 42620099
426300******************************************************************42630099
426400 8094-FOLD-SKU-COUNTS.                                            42640099
426500                                                                  42650099
426600     EXEC SQL                                                     42660099
426700          SELECT COUNT(DISTINCT(SKU_NBR))                         42670099
426800            INTO :PV-FOLD-SKU-COUNT                               42680099
426900            FROM SUT_TRIP_DTL_SUM                                 42690099
427000           WHERE TRIP_OCRNC_ID    =  :SUT00095-TRIP-OCRNC-ID      42700099
427100             AND DIVERT_TMST     <=  :PV-QUARTER-BEGIN-TMST       42710099
427200             AND DIVERT_TMST     >=  :PV-QUARTER-END-TMST         42720099
427300             AND HNG_FOLD_SEQ_NBR  =  2                           42730099
427400     END-EXEC.                                                    42740099
427500                                                                  42750099
427600     EVALUATE TRUE                                                42760099
427700         WHEN SQLCODE = ZEROS                                     42770099
427800              CONTINUE                                            42780099
427900         WHEN SQLWARN0 NOT = SPACE                                42790099
428000         WHEN SQLCODE NOT = ZERO                                  42800099
428100              MOVE '8094-FOLD-SKU-COUNTS ' TO DP013-PARAGRAPH     42810099
428200              MOVE 'GET 1/4 FOLD SKU COUNTS  '                    42820099
428300                               TO DP013-MESSAGE-TEXT (1)          42830099
428400              MOVE SQLCA       TO DP013-SQLCA                     42840099
428500              MOVE 'SUT_TRIP_DTL_SUM '                            42850099
428600                               TO DP013-DB2-TABLE-NAME (1)        42860099
428700              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       42870099
428800              SET DP013-DB2-ABEND TO TRUE                         42880099
428900              PERFORM DP013-0000-PROCESS-ABEND                    42890099
429000     END-EVALUATE.                                                42900099
429100                                                                  42910099
429200                                                                  42920099
429300******************************************************************42930099
429400*                                                                 42940099
429500******************************************************************42950099
429600 8095-OH-R-SKU-COUNTS.                                            42960099
429700                                                                  42970099
429800     EXEC SQL                                                     42980099
429900          SELECT COUNT(DISTINCT(SKU_NBR))                         42990099
430000            INTO :PV-OH-R-SKU-COUNT                               43000099
430100            FROM SUT_TRIP_DTL_SUM                                 43010099
430200           WHERE TRIP_OCRNC_ID    =  :SUT00095-TRIP-OCRNC-ID      43020099
430300             AND DIVERT_TMST     <=  :PV-QUARTER-BEGIN-TMST       43030099
430400             AND DIVERT_TMST     >=  :PV-QUARTER-END-TMST         43040099
430500             AND PRC_MSG_CDE      =  'RP'                         43050099
430600     END-EXEC.                                                    43060099
430700                                                                  43070099
430800     EVALUATE TRUE                                                43080099
430900         WHEN SQLCODE = ZEROS                                     43090099
431000              CONTINUE                                            43100099
431100         WHEN SQLWARN0 NOT = SPACE                                43110099
431200         WHEN SQLCODE NOT = ZERO                                  43120099
431300              MOVE '8095-OH-R-SKU-COUNTS ' TO DP013-PARAGRAPH     43130099
431400              MOVE 'GET 1/4 OH-R SKU COUNTS  '                    43140099
431500                               TO DP013-MESSAGE-TEXT (1)          43150099
431600              MOVE SQLCA       TO DP013-SQLCA                     43160099
431700              MOVE 'SUT_TRIP_DTL_SUM '                            43170099
431800                               TO DP013-DB2-TABLE-NAME (1)        43180099
431900              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       43190099
432000              SET DP013-DB2-ABEND TO TRUE                         43200099
432100              PERFORM DP013-0000-PROCESS-ABEND                    43210099
432200     END-EVALUATE.                                                43220099
432300                                                                  43230099
432400                                                                  43240099
432500******************************************************************43250099
432600*                                                                 43260099
432700******************************************************************43270099
432800 8096-OH-N-SKU-COUNTS.                                            43280099
432900                                                                  43290099
433000     EXEC SQL                                                     43300099
433100          SELECT COUNT(DISTINCT(SKU_NBR))                         43310099
433200            INTO :PV-OH-N-SKU-COUNT                               43320099
433300            FROM SUT_TRIP_DTL_SUM                                 43330099
433400           WHERE TRIP_OCRNC_ID    =  :SUT00095-TRIP-OCRNC-ID      43340099
433500             AND DIVERT_TMST     <=  :PV-QUARTER-BEGIN-TMST       43350099
433600             AND DIVERT_TMST     >=  :PV-QUARTER-END-TMST         43360099
433700             AND PRC_MSG_CDE      =  'RF'                         43370099
433800     END-EXEC.                                                    43380099
433900                                                                  43390099
434000     EVALUATE TRUE                                                43400099
434100         WHEN SQLCODE = ZEROS                                     43410099
434200              CONTINUE                                            43420099
434300         WHEN SQLWARN0 NOT = SPACE                                43430099
434400         WHEN SQLCODE NOT = ZERO                                  43440099
434500              MOVE '8096-OH-N-SKU-COUNTS ' TO DP013-PARAGRAPH     43450099
434600              MOVE 'GET 1/4 OH-N SKU COUNTS  '                    43460099
434700                               TO DP013-MESSAGE-TEXT (1)          43470099
434800              MOVE SQLCA       TO DP013-SQLCA                     43480099
434900              MOVE 'SUT_TRIP_DTL_SUM '                            43490099
435000                               TO DP013-DB2-TABLE-NAME (1)        43500099
435100              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       43510099
435200              SET DP013-DB2-ABEND TO TRUE                         43520099
435300              PERFORM DP013-0000-PROCESS-ABEND                    43530099
435400     END-EVALUATE.                                                43540099
435500                                                                  43550099
435600                                                                  43560099
435700******************************************************************43570099
435800*                                                                 43580099
435900******************************************************************43590099
436000 8097-EAS-SKU-COUNTS.                                             43600099
436100                                                                  43610099
436200     EXEC SQL                                                     43620099
436300          SELECT COUNT(DISTINCT(SKU_NBR))                         43630099
436400            INTO :PV-EAS-SKU-COUNT                                43640099
436500            FROM SUT_TRIP_DTL_SUM                                 43650099
436600           WHERE TRIP_OCRNC_ID    =  :SUT00095-TRIP-OCRNC-ID      43660099
436700             AND DIVERT_TMST     <=  :PV-QUARTER-BEGIN-TMST       43670099
436800             AND DIVERT_TMST     >=  :PV-QUARTER-END-TMST         43680099
436900             AND EAS_TAG_IND      =  'Y'                          43690099
437000     END-EXEC.                                                    43700099
437100                                                                  43710099
437200     EVALUATE TRUE                                                43720099
437300         WHEN SQLCODE = ZEROS                                     43730099
437400              CONTINUE                                            43740099
437500         WHEN SQLWARN0 NOT = SPACE                                43750099
437600         WHEN SQLCODE NOT = ZERO                                  43760099
437700              MOVE '8097-EAS-SKU-COUNTS  ' TO DP013-PARAGRAPH     43770099
437800              MOVE 'GET 1/4 EAS SKU COUNTS  '                     43780099
437900                               TO DP013-MESSAGE-TEXT (1)          43790099
438000              MOVE SQLCA       TO DP013-SQLCA                     43800099
438100              MOVE 'SUT_TRIP_DTL_SUM '                            43810099
438200                               TO DP013-DB2-TABLE-NAME (1)        43820099
438300              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       43830099
438400              SET DP013-DB2-ABEND TO TRUE                         43840099
438500              PERFORM DP013-0000-PROCESS-ABEND                    43850099
438600     END-EVALUATE.                                                43860099
438700                                                                  43870099
438800                                                                  43880099
438900******************************************************************43890099
439000*                                                                 43900099
439100******************************************************************43910099
439200 8098-CLEAR-SKU-COUNTS.                                           43920099
439300                                                                  43930099
439400     EXEC SQL                                                     43940099
439500          SELECT COUNT(DISTINCT(SKU_NBR))                         43950099
439600            INTO :PV-CLEAR-SKU-COUNT                              43960099
439700            FROM SUT_TRIP_DTL_SUM                                 43970099
439800           WHERE TRIP_OCRNC_ID    =  :SUT00095-TRIP-OCRNC-ID      43980099
439900             AND DIVERT_TMST     <=  :PV-QUARTER-BEGIN-TMST       43990099
440000             AND DIVERT_TMST     >=  :PV-QUARTER-END-TMST         44000099
440100             AND PRC_MSG_CDE      =  'CL'                         44010099
440200     END-EXEC.                                                    44020099
440300                                                                  44030099
440400     EVALUATE TRUE                                                44040099
440500         WHEN SQLCODE = ZEROS                                     44050099
440600              CONTINUE                                            44060099
440700         WHEN SQLWARN0 NOT = SPACE                                44070099
440800         WHEN SQLCODE NOT = ZERO                                  44080099
440900              MOVE '8098-CLEAR-SKU-COUNTS' TO DP013-PARAGRAPH     44090099
441000              MOVE 'GET 1/4 CLEAR SKU COUNTS  '                   44100099
441100                               TO DP013-MESSAGE-TEXT (1)          44110099
441200              MOVE SQLCA       TO DP013-SQLCA                     44120099
441300              MOVE 'SUT_TRIP_DTL_SUM '                            44130099
441400                               TO DP013-DB2-TABLE-NAME (1)        44140099
441500              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       44150099
441600              SET DP013-DB2-ABEND TO TRUE                         44160099
441700              PERFORM DP013-0000-PROCESS-ABEND                    44170099
441800     END-EVALUATE.                                                44180099
441900                                                                  44190099
442000                                                                  44200099
442100******************************************************************44210099
442200*                                                                 44220099
442300******************************************************************44230099
442400 8100-TRIP-BREAK.                                                 44240099
442500     INITIALIZE  PV-CICS-MSG-AREA                                 44250099
442600     STRING ' SUKCS545 - TRIP BEGIN - ' PV-TRIP-BEGIN-TMST        44260099
442700            '  TRIP END - '             PV-TRIP-END-TMST          44270099
442800                                        DELIMITED BY SIZE         44280099
442900                                   INTO PV-CICS-MSG-AREA          44290099
443000     PERFORM 8500-WRITE-CSSL.                                     44300099
443100                                                                  44310099
443200     PERFORM 8110-GET-HARDLINE-SKUS.                              44320099
443300     PERFORM 8115-GET-SOFTLINE-SKUS.                              44330099
443400     PERFORM 8120-GET-HANG-SKUS.                                  44340099
443500     PERFORM 8125-GET-FOLD-SKUS.                                  44350099
443600     PERFORM 8130-GET-OH-R-SKUS.                                  44360099
443700     PERFORM 8135-GET-OH-N-SKUS.                                  44370099
443800     PERFORM 8140-GET-EAS-SKUS.                                   44380099
443900     PERFORM 8145-GET-CLRNC-SKUS.                                 44390099
444000     PERFORM 8150-GET-GRAND-SKUS.                                 44400099
444100                                                                  44410099
444200     MOVE PV-HARD-SKU-COUNT                                       44420099
444300                             TO ASC-COUNT(5, 2, 1).               44430099
444400     MOVE PV-SOFT-SKU-COUNT                                       44440099
444500                             TO ASC-COUNT(5, 2, 2).               44450099
444600     MOVE PV-HANG-SKU-COUNT                                       44460099
444700                             TO ASC-COUNT(5, 2, 3).               44470099
444800     MOVE PV-FOLD-SKU-COUNT                                       44480099
444900                             TO ASC-COUNT(5, 2, 4).               44490099
445000     MOVE PV-OH-R-SKU-COUNT                                       44500099
445100                             TO ASC-COUNT(5, 2, 5).               44510099
445200     MOVE PV-OH-N-SKU-COUNT                                       44520099
445300                             TO ASC-COUNT(5, 2, 6).               44530099
445400     MOVE PV-EAS-SKU-COUNT                                        44540099
445500                             TO ASC-COUNT(5, 2, 7).               44550099
445600     MOVE PV-CLEAR-SKU-COUNT                                      44560099
445700                             TO ASC-COUNT(5, 2, 8).               44570099
445800     MOVE PV-TOTAL-SKU-COUNT                                      44580099
445900                             TO ASC-COUNT(5, 2, 9).               44590099
446000                                                                  44600099
446100******************************************************************44610099
446200*                                                                 44620099
446300******************************************************************44630099
446400 8110-GET-HARDLINE-SKUS.                                          44640099
446500                                                                  44650099
446600     EXEC SQL                                                     44660099
446700          SELECT COUNT(DISTINCT(SKU_NBR))                         44670099
446800            INTO :PV-HARD-SKU-COUNT                               44680099
446900            FROM SUT_TRIP_DTL_SUM                                 44690099
447000           WHERE TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID        44700099
447100             AND DIVERT_TMST   <=  :PV-TRIP-BEGIN-TMST            44710099
447200             AND DIVERT_TMST   >=  :PV-TRIP-END-TMST              44720099
447300             AND MDSE_LNE_CDE   =  'H'                            44730099
447400     END-EXEC.                                                    44740099
447500                                                                  44750099
447600     EVALUATE TRUE                                                44760099
447700         WHEN SQLCODE = ZEROS                                     44770099
447800              CONTINUE                                            44780099
447900         WHEN SQLWARN0 NOT = SPACE                                44790099
448000         WHEN SQLCODE NOT = ZERO                                  44800099
448100              MOVE '8110-GET-HARDLINE-SKU' TO DP013-PARAGRAPH     44810099
448200              MOVE 'GET TRIP HARD SKU COUNTS'                     44820099
448300                               TO DP013-MESSAGE-TEXT (1)          44830099
448400              MOVE SQLCA       TO DP013-SQLCA                     44840099
448500              MOVE 'SUT_TRIP_DTL_SUM '                            44850099
448600                               TO DP013-DB2-TABLE-NAME (1)        44860099
448700              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       44870099
448800              SET DP013-DB2-ABEND TO TRUE                         44880099
448900              PERFORM DP013-0000-PROCESS-ABEND                    44890099
449000     END-EVALUATE.                                                44900099
449100                                                                  44910099
449200                                                                  44920099
449300******************************************************************44930099
449400*                                                                 44940099
449500******************************************************************44950099
449600 8115-GET-SOFTLINE-SKUS.                                          44960099
449700     EXEC SQL                                                     44970099
449800          SELECT COUNT(DISTINCT(SKU_NBR))                         44980099
449900            INTO :PV-SOFT-SKU-COUNT                               44990099
450000            FROM SUT_TRIP_DTL_SUM                                 45000099
450100           WHERE TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID        45010099
450200             AND DIVERT_TMST   <=  :PV-TRIP-BEGIN-TMST            45020099
450300             AND DIVERT_TMST   >=  :PV-TRIP-END-TMST              45030099
450400             AND MDSE_LNE_CDE   =  'S'                            45040099
450500     END-EXEC.                                                    45050099
450600                                                                  45060099
450700     EVALUATE TRUE                                                45070099
450800         WHEN SQLCODE = ZEROS                                     45080099
450900              CONTINUE                                            45090099
451000         WHEN SQLWARN0 NOT = SPACE                                45100099
451100         WHEN SQLCODE NOT = ZERO                                  45110099
451200              MOVE '8115-GET-SOFTLINE-SKU' TO DP013-PARAGRAPH     45120099
451300              MOVE 'GET TRIP SOFT SKU COUNTS'                     45130099
451400                               TO DP013-MESSAGE-TEXT (1)          45140099
451500              MOVE SQLCA       TO DP013-SQLCA                     45150099
451600              MOVE 'SUT_TRIP_DTL_SUM '                            45160099
451700                               TO DP013-DB2-TABLE-NAME (1)        45170099
451800              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       45180099
451900              SET DP013-DB2-ABEND TO TRUE                         45190099
452000              PERFORM DP013-0000-PROCESS-ABEND                    45200099
452100     END-EVALUATE.                                                45210099
452200                                                                  45220099
452300                                                                  45230099
452400******************************************************************45240099
452500*                                                                 45250099
452600******************************************************************45260099
452700 8120-GET-HANG-SKUS.                                              45270099
452800     EXEC SQL                                                     45280099
452900          SELECT COUNT(DISTINCT(SKU_NBR))                         45290099
453000            INTO :PV-HANG-SKU-COUNT                               45300099
453100            FROM SUT_TRIP_DTL_SUM                                 45310099
453200           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     45320099
453300             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         45330099
453400             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           45340099
453500             AND HNG_FOLD_SEQ_NBR  =  1                           45350099
453600     END-EXEC.                                                    45360099
453700                                                                  45370099
453800     EVALUATE TRUE                                                45380099
453900         WHEN SQLCODE = ZEROS                                     45390099
454000              CONTINUE                                            45400099
454100         WHEN SQLWARN0 NOT = SPACE                                45410099
454200         WHEN SQLCODE NOT = ZERO                                  45420099
454300              MOVE '8120-GET-HANG-SKUS   ' TO DP013-PARAGRAPH     45430099
454400              MOVE 'GET TRIP HANG SKU COUNTS'                     45440099
454500                               TO DP013-MESSAGE-TEXT (1)          45450099
454600              MOVE SQLCA       TO DP013-SQLCA                     45460099
454700              MOVE 'SUT_TRIP_DTL_SUM '                            45470099
454800                               TO DP013-DB2-TABLE-NAME (1)        45480099
454900              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       45490099
455000              SET DP013-DB2-ABEND TO TRUE                         45500099
455100              PERFORM DP013-0000-PROCESS-ABEND                    45510099
455200     END-EVALUATE.                                                45520099
455300                                                                  45530099
455400                                                                  45540099
455500******************************************************************45550099
455600*                                                                 45560099
455700******************************************************************45570099
455800 8125-GET-FOLD-SKUS.                                              45580099
455900                                                                  45590099
456000     EXEC SQL                                                     45600099
456100          SELECT COUNT(DISTINCT(SKU_NBR))                         45610099
456200            INTO :PV-FOLD-SKU-COUNT                               45620099
456300            FROM SUT_TRIP_DTL_SUM                                 45630099
456400           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     45640099
456500             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         45650099
456600             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           45660099
456700             AND HNG_FOLD_SEQ_NBR  =  2                           45670099
456800     END-EXEC.                                                    45680099
456900                                                                  45690099
457000     EVALUATE TRUE                                                45700099
457100         WHEN SQLCODE = ZEROS                                     45710099
457200              CONTINUE                                            45720099
457300         WHEN SQLWARN0 NOT = SPACE                                45730099
457400         WHEN SQLCODE NOT = ZERO                                  45740099
457500              MOVE '8125-GET-FOLD-SKUS   ' TO DP013-PARAGRAPH     45750099
457600              MOVE 'GET TRIP FOLD SKU COUNTS'                     45760099
457700                               TO DP013-MESSAGE-TEXT (1)          45770099
457800              MOVE SQLCA       TO DP013-SQLCA                     45780099
457900              MOVE 'SUT_TRIP_DTL_SUM '                            45790099
458000                               TO DP013-DB2-TABLE-NAME (1)        45800099
458100              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       45810099
458200              SET DP013-DB2-ABEND TO TRUE                         45820099
458300              PERFORM DP013-0000-PROCESS-ABEND                    45830099
458400     END-EVALUATE.                                                45840099
458500                                                                  45850099
458600                                                                  45860099
458700******************************************************************45870099
458800*                                                                 45880099
458900******************************************************************45890099
459000 8130-GET-OH-R-SKUS.                                              45900099
459100                                                                  45910099
459200     EXEC SQL                                                     45920099
459300          SELECT COUNT(DISTINCT(SKU_NBR))                         45930099
459400            INTO :PV-OH-R-SKU-COUNT                               45940099
459500            FROM SUT_TRIP_DTL_SUM                                 45950099
459600           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     45960099
459700             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         45970099
459800             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           45980099
459900             AND PRC_MSG_CDE       =  'RP'                        45990099
460000     END-EXEC.                                                    46000099
460100                                                                  46010099
460200     EVALUATE TRUE                                                46020099
460300         WHEN SQLCODE = ZEROS                                     46030099
460400              CONTINUE                                            46040099
460500         WHEN SQLWARN0 NOT = SPACE                                46050099
460600         WHEN SQLCODE NOT = ZERO                                  46060099
460700              MOVE '8130-GET-OH-R-SKUS   ' TO DP013-PARAGRAPH     46070099
460800              MOVE 'GET TRIP OH-R SKU COUNTS'                     46080099
460900                               TO DP013-MESSAGE-TEXT (1)          46090099
461000              MOVE SQLCA       TO DP013-SQLCA                     46100099
461100              MOVE 'SUT_TRIP_DTL_SUM '                            46110099
461200                               TO DP013-DB2-TABLE-NAME (1)        46120099
461300              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       46130099
461400              SET DP013-DB2-ABEND TO TRUE                         46140099
461500              PERFORM DP013-0000-PROCESS-ABEND                    46150099
461600     END-EVALUATE.                                                46160099
461700                                                                  46170099
461800                                                                  46180099
461900******************************************************************46190099
462000*                                                                 46200099
462100******************************************************************46210099
462200 8135-GET-OH-N-SKUS.                                              46220099
462300                                                                  46230099
462400     EXEC SQL                                                     46240099
462500          SELECT COUNT(DISTINCT(SKU_NBR))                         46250099
462600            INTO :PV-OH-N-SKU-COUNT                               46260099
462700            FROM SUT_TRIP_DTL_SUM                                 46270099
462800           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     46280099
462900             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         46290099
463000             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           46300099
463100             AND PRC_MSG_CDE       =  'RF'                        46310099
463200     END-EXEC.                                                    46320099
463300                                                                  46330099
463400     EVALUATE TRUE                                                46340099
463500         WHEN SQLCODE = ZEROS                                     46350099
463600              CONTINUE                                            46360099
463700         WHEN SQLWARN0 NOT = SPACE                                46370099
463800         WHEN SQLCODE NOT = ZERO                                  46380099
463900              MOVE '8135-GET-OH-N-SKUS   ' TO DP013-PARAGRAPH     46390099
464000              MOVE 'GET TRIP OH-N SKU COUNTS'                     46400099
464100                               TO DP013-MESSAGE-TEXT (1)          46410099
464200              MOVE SQLCA       TO DP013-SQLCA                     46420099
464300              MOVE 'SUT_TRIP_DTL_SUM '                            46430099
464400                               TO DP013-DB2-TABLE-NAME (1)        46440099
464500              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       46450099
464600              SET DP013-DB2-ABEND TO TRUE                         46460099
464700              PERFORM DP013-0000-PROCESS-ABEND                    46470099
464800     END-EVALUATE.                                                46480099
464900                                                                  46490099
465000                                                                  46500099
465100******************************************************************46510099
465200*                                                                 46520099
465300******************************************************************46530099
465400 8140-GET-EAS-SKUS.                                               46540099
465500                                                                  46550099
465600     EXEC SQL                                                     46560099
465700          SELECT COUNT(DISTINCT(SKU_NBR))                         46570099
465800            INTO :PV-EAS-SKU-COUNT                                46580099
465900            FROM SUT_TRIP_DTL_SUM                                 46590099
466000           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     46600099
466100             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         46610099
466200             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           46620099
466300             AND EAS_TAG_IND       =  'Y'                         46630099
466400     END-EXEC.                                                    46640099
466500                                                                  46650099
466600     EVALUATE TRUE                                                46660099
466700         WHEN SQLCODE = ZEROS                                     46670099
466800              CONTINUE                                            46680099
466900         WHEN SQLWARN0 NOT = SPACE                                46690099
467000         WHEN SQLCODE NOT = ZERO                                  46700099
467100              MOVE '8140-GET-EAS-SKUS    ' TO DP013-PARAGRAPH     46710099
467200              MOVE 'GET TRIP EAS  SKU COUNTS'                     46720099
467300                               TO DP013-MESSAGE-TEXT (1)          46730099
467400              MOVE SQLCA       TO DP013-SQLCA                     46740099
467500              MOVE 'SUT_TRIP_DTL_SUM '                            46750099
467600                               TO DP013-DB2-TABLE-NAME (1)        46760099
467700              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       46770099
467800              SET DP013-DB2-ABEND TO TRUE                         46780099
467900              PERFORM DP013-0000-PROCESS-ABEND                    46790099
468000     END-EVALUATE.                                                46800099
468100                                                                  46810099
468200                                                                  46820099
468300******************************************************************46830099
468400*                                                                 46840099
468500******************************************************************46850099
468600 8145-GET-CLRNC-SKUS.                                             46860099
468700                                                                  46870099
468800     EXEC SQL                                                     46880099
468900          SELECT COUNT(DISTINCT(SKU_NBR))                         46890099
469000            INTO :PV-CLEAR-SKU-COUNT                              46900099
469100            FROM SUT_TRIP_DTL_SUM                                 46910099
469200           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     46920099
469300             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         46930099
469400             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           46940099
469500             AND PRC_MSG_CDE       =  'CL'                        46950099
469600     END-EXEC.                                                    46960099
469700                                                                  46970099
469800     EVALUATE TRUE                                                46980099
469900         WHEN SQLCODE = ZEROS                                     46990099
470000              CONTINUE                                            47000099
470100         WHEN SQLWARN0 NOT = SPACE                                47010099
470200         WHEN SQLCODE NOT = ZERO                                  47020099
470300              MOVE '8145-GET-CLRNC-SKUS  ' TO DP013-PARAGRAPH     47030099
470400              MOVE 'GET TRIP CLEAR SKU COUNTS'                    47040099
470500                               TO DP013-MESSAGE-TEXT (1)          47050099
470600              MOVE SQLCA       TO DP013-SQLCA                     47060099
470700              MOVE 'SUT_TRIP_DTL_SUM '                            47070099
470800                               TO DP013-DB2-TABLE-NAME (1)        47080099
470900              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       47090099
471000              SET DP013-DB2-ABEND TO TRUE                         47100099
471100              PERFORM DP013-0000-PROCESS-ABEND                    47110099
471200     END-EVALUATE.                                                47120099
471300                                                                  47130099
471400                                                                  47140099
471500******************************************************************47150099
471600*                                                                 47160099
471700******************************************************************47170099
471800 8150-GET-GRAND-SKUS.                                             47180099
471900                                                                  47190099
472000     EXEC SQL                                                     47200099
472100          SELECT COUNT(DISTINCT(SKU_NBR))                         47210099
472200            INTO :PV-TOTAL-SKU-COUNT                              47220099
472300            FROM SUT_TRIP_DTL_SUM                                 47230099
472400           WHERE TRIP_OCRNC_ID     =  :SUT00095-TRIP-OCRNC-ID     47240099
472500             AND DIVERT_TMST      <=  :PV-TRIP-BEGIN-TMST         47250099
472600             AND DIVERT_TMST      >=  :PV-TRIP-END-TMST           47260099
472700     END-EXEC.                                                    47270099
472800                                                                  47280099
472900     EVALUATE TRUE                                                47290099
473000         WHEN SQLCODE = ZEROS                                     47300099
473100              CONTINUE                                            47310099
473200         WHEN SQLWARN0 NOT = SPACE                                47320099
473300         WHEN SQLCODE NOT = ZERO                                  47330099
473400              MOVE '8150-GET-GRAND-SKUS  ' TO DP013-PARAGRAPH     47340099
473500              MOVE 'GET TRIP CLEAR SKU COUNTS'                    47350099
473600                               TO DP013-MESSAGE-TEXT (1)          47360099
473700              MOVE SQLCA       TO DP013-SQLCA                     47370099
473800              MOVE 'SUT_TRIP_DTL_SUM '                            47380099
473900                               TO DP013-DB2-TABLE-NAME (1)        47390099
474000              MOVE 'SUT00095'   TO DP013-DB2-TABLE-NAME (1)       47400099
474100              SET DP013-DB2-ABEND TO TRUE                         47410099
474200              PERFORM DP013-0000-PROCESS-ABEND                    47420099
474300     END-EVALUATE.                                                47430099
474400                                                                  47440099
474500                                                                  47450099
474600*----------------------------------------------------------------*47460099
474700 8500-WRITE-CSSL.                                                 47470099
474800*----------------------------------------------------------------*47480099
474900                                                                  47490099
475000     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH       47500099
475100     EXEC CICS                                                    47510099
475200         WRITEQ TD                                                47520099
475300         QUEUE  ('CSSL')                                          47530099
475400         FROM  (PV-CICS-MSG-AREA)                                 47540099
475500         LENGTH  (PV-COMMAREA-LENGTH)                             47550099
475600         RESP  (PV-CICS-RESP)                                     47560099
475700     END-EXEC.                                                    47570099
475800                                                                  47580099
475900*----------------------------------------------------------------*47590099
476000 9000-SUBMIT-JOB.                                                 47600099
476100*----------------------------------------------------------------*47610099
476200                                                                  47620099
476300     MOVE  PC-TRLR-SUMM-RPT-DESC TO PV-JOB-DESCRIPTION.           47630099
476400     MOVE  PC-TRLR-SUMM-RPT-PROC TO PV-JOB-PROC.                  47640099
476500     MOVE  PC-TRLR-SUMM-RPT-JOB  TO PV-JOB-NAME.                  47650099
476600                                                                  47660099
476700     PERFORM 9010-ENQUEUE-INTERNAL-READER.                        47670099
476800                                                                  47680099
476900     MOVE '*9000-SUBMIT-JOB            *' TO DP013-PARAGRAPH      47690099
477000                                                                  47700099
477100     IF PV-PROD-CICS                                              47710099
477200        MOVE '1'               TO JL-LINE-12-PROC-T               47720099
477300        MOVE ' '               TO JL-LINE-12-PROC-T2              47730099
477400        MOVE JL-JOB-LINE-PROD  TO JL-JCL-LINE-1                   47740099
477500        MOVE JL-JCL-LINE-1     TO TD-JCL-LINE                     47750099
477600        PERFORM 9020-WRITE-TD-LINE                                47760099
477700        MOVE JL-JCL-LINE-3     TO TD-JCL-LINE                     47770099
477800        PERFORM 9020-WRITE-TD-LINE                                47780099
477900        MOVE JL-JCL-LINE-4-PROD TO TD-JCL-LINE                    47790099
478000        PERFORM 9020-WRITE-TD-LINE                                47800099
478100     ELSE                                                         47810099
478200        IF PV-TEST-CICS                                           47820099
478300           MOVE '1'               TO JL-LINE-12-PROC-T            47830099
478400           MOVE 'T'               TO JL-LINE-12-PROC-T2           47840099
478500           MOVE DP020-USERID      TO  JL-TEST-JOB-NAME            47850099
478600           MOVE JL-JOB-LINE-TEST  TO  JL-JCL-LINE-1               47860099
478700           MOVE JL-JCL-LINE-1     TO TD-JCL-LINE                  47870099
478800           PERFORM 9020-WRITE-TD-LINE                             47880099
478900           MOVE JL-JCL-LINE-4-TEST TO TD-JCL-LINE                 47890099
479000           PERFORM 9020-WRITE-TD-LINE                             47900099
479100        ELSE                                                      47910099
479200           IF PV-QA-CICS                                          47920099
479300              MOVE '1'               TO JL-LINE-12-PROC-T         47930099
479400              MOVE 'Q'               TO JL-LINE-12-PROC-T2        47940099
479500*             MOVE JL-JOB-LINE-PROD  TO JL-JCL-LINE-1             47950099
479600*             MOVE JL-JCL-LINE-1     TO TD-JCL-LINE               47960099
479700              MOVE DP020-USERID      TO  JL-TEST-JOB-NAME         47970099
479800              MOVE JL-JOB-LINE-TEST  TO  JL-JCL-LINE-1            47980099
479900              MOVE JL-JCL-LINE-1     TO TD-JCL-LINE               47990099
480000              PERFORM 9020-WRITE-TD-LINE                          48000099
480100              MOVE JL-JCL-LINE-4-QA  TO TD-JCL-LINE               48010099
480200              PERFORM 9020-WRITE-TD-LINE                          48020099
480300           ELSE                                                   48030099
480400              IF PV-LEARN-CICS                                    48040099
480500                 MOVE '1'               TO JL-LINE-12-PROC-T      48050099
480600                 MOVE 'L'               TO JL-LINE-12-PROC-T2     48060099
480700*                MOVE JL-JOB-LINE-PROD  TO JL-JCL-LINE-1          48070099
480800*                MOVE JL-JCL-LINE-1     TO TD-JCL-LINE            48080099
480900                 MOVE DP020-USERID      TO  JL-TEST-JOB-NAME      48090099
481000                 MOVE JL-JOB-LINE-TEST  TO  JL-JCL-LINE-1         48100099
481100                 MOVE JL-JCL-LINE-1     TO TD-JCL-LINE            48110099
481200                 PERFORM 9020-WRITE-TD-LINE                       48120099
481300                 MOVE JL-JCL-LINE-4-QA  TO TD-JCL-LINE            48130099
481400                 PERFORM 9020-WRITE-TD-LINE                       48140099
481500              END-IF                                              48150099
481600           END-IF                                                 48160099
481700        END-IF                                                    48170099
481800     END-IF.                                                      48180099
481900*                                                                 48190099
482000*LMM BEGIN                                                        48200099
482100     MOVE JL-JCL-LINE-9 TO TD-JCL-LINE.                           48210099
482200     PERFORM 9020-WRITE-TD-LINE.                                  48220099
482300                                                                  48230099
482400     MOVE ASC-OCRNC-TRIP-ID      TO JL-LINE-10-OCRNC-ID.          48240099
482500     MOVE ASC-OUTBOUND-TRIP-ID   TO JL-LINE-10-TRIP-ID.           48250099
482600     MOVE DP020-USERID           TO JL-LINE-10-USER-ID.           48260099
482700     MOVE ASC-RQST-TMST          TO JL-LINE-10-TIMESTMP.          48270099
482800     MOVE JL-JCL-LINE-10 TO TD-JCL-LINE.                          48280099
482900     PERFORM 9020-WRITE-TD-LINE.                                  48290099
483000                                                                  48300099
483100     MOVE JL-JCL-LINE-11 TO TD-JCL-LINE.                          48310099
483200     PERFORM 9020-WRITE-TD-LINE.                                  48320099
483300                                                                  48330099
483400     MOVE JL-JCL-LINE-12 TO TD-JCL-LINE.                          48340099
483500     PERFORM 9020-WRITE-TD-LINE.                                  48350099
483600                                                                  48360099
483700     MOVE JL-JCL-LINE-14 TO TD-JCL-LINE.                          48370099
483800     PERFORM 9020-WRITE-TD-LINE.                                  48380099
483900                                                                  48390099
484000     MOVE JL-JCL-LINE-13 TO TD-JCL-LINE.                          48400099
484100     PERFORM 9020-WRITE-TD-LINE.                                  48410099
484200                                                                  48420099
484300*    MOVE ASC-OCRNC-TRIP-ID      TO JL-LINE-15-OCRNC-ID.          48430099
484400*    MOVE ASC-OUTBOUND-TRIP-ID   TO JL-LINE-15-TRIP-ID.           48440099
484500*    MOVE DP020-USERID           TO JL-LINE-15-USER-ID.           48450099
484600*    MOVE ASC-RQST-TMST          TO JL-LINE-15-TIMESTMP.          48460099
484700*    MOVE JL-JCL-LINE-15 TO TD-JCL-LINE.                          48470099
484800*    PERFORM 9020-WRITE-TD-LINE.                                  48480099
484900*LMM END                                                          48490099
485000                                                                  48500099
485100**   MOVE JL-JCL-LINE-16 TO TD-JCL-LINE.                          48510099
485200**   PERFORM 9020-WRITE-TD-LINE.                                  48520099
485300                                                                  48530099
485400**   MOVE DP072-PRTR-PRTR-CNTL-IND                                48540099
485500**                               TO JL-LINE-17-PRTR-IND.          48550099
485600**   MOVE DP072-PRTR-TRACK-NBR   TO JL-LINE-17-TRACK-NBR.         48560099
485700**   MOVE DP020-USERID           TO JL-LINE-17-USER-ID.           48570099
485800                                                                  48580099
485900**   MOVE JL-JCL-LINE-AUTO-SCHD TO TD-JCL-LINE.                   48590099
486000**   PERFORM 9020-WRITE-TD-LINE.                                  48600099
486100                                                                  48610099
486200     MOVE JL-JCL-LINE-EOF TO TD-JCL-LINE.                         48620099
486300     PERFORM 9020-WRITE-TD-LINE.                                  48630099
486400                                                                  48640099
486500     PERFORM 9030-DEQUEUE-INTERNAL-READER.                        48650099
486600                                                                  48660099
486700     MOVE PC-TSYMSG-00458 TO DP020-MSG-NUMBER.                    48670099
486800                                                                  48680099
486900     SET DP020-MSG-INFORMATIONAL TO TRUE.                         48690099
487000                                                                  48700099
487100******************************************************************48710099
487200*  ENQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *48720099
487300*  THIS WILL PREVENT INTERLEAVING OF JCL SUBMITTED CONCURRENTLY  *48730099
487400*  BY MULTIPLE USERS.  IF THE QUEUE IS BUSY, THIS PROGRAM WILL   *48740099
487500*  WAIT TO ENQUEUE IT, BY NOT SPECIFICALLY HANDLING THE QBUSY    *48750099
487600*  CONDITION.  IF ANY OTHER ERRORS OCCUR, DELETE THE TEMPORARY   *48760099
487700*  STORAGE QUEUE (TO PREVENT OLD REQUEST INFORMATION FROM        *48770099
487800*  ACCIDENTALLY APPEARING ON A FUTURE REQUEST), FORMAT AND       *48780099
487900*  DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE CICS.          *48790099
488000******************************************************************48800099
488100                                                                  48810099
488200 9010-ENQUEUE-INTERNAL-READER.                                    48820099
488300     MOVE '*9010-ENQUEUE-INTERNAL-READER.   *' TO DP013-PARAGRAPH 48830099
488400     EXEC CICS                                                    48840099
488500         ENQ                                                      48850099
488600             RESOURCE(TD-QUEUE-NAME)                              48860099
488700             LENGTH(TD-QUEUE-NAME-LENGTH)                         48870099
488800             RESP(PV-CICS-RESPONSE)                               48880099
488900     END-EXEC.                                                    48890099
489000                                                                  48900099
489100     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    48910099
489200         SET PS-ABEND-IN-PROGRESS TO TRUE                         48920099
489300         STRING 'ENQUEUE '            DELIMITED BY SIZE           48930099
489400                TD-QUEUE-NAME         DELIMITED BY SIZE           48940099
489500                ' (INTERNAL READER)'  DELIMITED BY SIZE           48950099
489600             INTO SE-ATTEMPTED-ACTION                             48960099
489700         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                48970099
489800         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  48980099
489900         PERFORM 9900-LEAVE-SYSTEM                                48990099
490000     END-IF.                                                      49000099
490100                                                                  49010099
490200     SET PS-INTERNAL-READER-ENQUEUED TO TRUE.                     49020099
490300     EJECT                                                        49030099
490400                                                                  49040099
490500******************************************************************49050099
490600*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL *49060099
490700*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE    *49070099
490800*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *49080099
490900*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *49090099
491000*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *49100099
491100*  CICS.                                                         *49110099
491200******************************************************************49120099
491300                                                                  49130099
491400 9020-WRITE-TD-LINE.                                              49140099
491500     MOVE '*9020-WRITE-TD-LINE.             *' TO DP013-PARAGRAPH 49150099
491600     EXEC CICS                                                    49160099
491700         WRITEQ TD                                                49170099
491800             QUEUE(TD-QUEUE-NAME)                                 49180099
491900             FROM(TD-JCL-LINE)                                    49190099
492000             LENGTH(TD-JCL-LINE-LENGTH)                           49200099
492100             RESP(PV-CICS-RESPONSE)                               49210099
492200     END-EXEC.                                                    49220099
492300                                                                  49230099
492400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    49240099
492500         SET PS-ABEND-IN-PROGRESS TO TRUE                         49250099
492600         STRING 'WRITE TO TRANSIENT DATA QUEUE '                  49260099
492700                                                DELIMITED BY SIZE 49270099
492800                TD-QUEUE-NAME                   DELIMITED BY SIZE 49280099
492900                ' (INTERNAL READER)'            DELIMITED BY SIZE 49290099
493000             INTO SE-ATTEMPTED-ACTION                             49300099
493100         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                49310099
493200         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  49320099
493300         PERFORM 9030-DEQUEUE-INTERNAL-READER                     49330099
493400         PERFORM 9900-LEAVE-SYSTEM                                49340099
493500     END-IF.                                                      49350099
493600     EJECT                                                        49360099
493700                                                                  49370099
493800******************************************************************49380099
493900*  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *49390099
494000*  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     *49400099
494100*  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  *49410099
494200*  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   *49420099
494300*  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      *49430099
494400*  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  *49440099
494500*  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL *49450099
494600*  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    *49460099
494700*  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   *49470099
494800*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *49480099
494900*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *49490099
495000*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *49500099
495100*  CICS.                                                         *49510099
495200******************************************************************49520099
495300                                                                  49530099
495400 9030-DEQUEUE-INTERNAL-READER.                                    49540099
495500     SET PS-INTERNAL-READER-DEQUEUED TO TRUE.                     49550099
495600                                                                  49560099
495700     EXEC CICS                                                    49570099
495800         DEQ                                                      49580099
495900             RESOURCE(TD-QUEUE-NAME)                              49590099
496000             LENGTH(TD-QUEUE-NAME-LENGTH)                         49600099
496100             RESP(PV-CICS-RESPONSE)                               49610099
496200     END-EXEC.                                                    49620099
496300                                                                  49630099
496400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    49640099
496500         IF PS-NO-ABEND-IN-PROGRESS                               49650099
496600             SET PS-ABEND-IN-PROGRESS TO TRUE                     49660099
496700             STRING 'DEQUEUE '            DELIMITED BY SIZE       49670099
496800                    TD-QUEUE-NAME         DELIMITED BY SIZE       49680099
496900                    ' (INTERNAL READER)'  DELIMITED BY SIZE       49690099
497000                 INTO SE-ATTEMPTED-ACTION                         49700099
497100             MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE            49710099
497200             MOVE SE-SYSTEM-ERROR-MESSAGE TO                      49720099
497300                       PV-LEAVE-SYSTEM-MESSAGE                    49730099
497400             PERFORM 9900-LEAVE-SYSTEM                            49740099
497500         END-IF                                                   49750099
497600     END-IF.                                                      49760099
497700     EJECT                                                        49770099
497800*-----------------------------------------------------------------49780099
497900*  READ THE LIST QUEUE RECORD                                     49790099
498000*-----------------------------------------------------------------49800099
498100 9100-READ-SEL-QUEUE.                                             49810099
498200                                                                  49820099
498300     EXEC CICS                                                    49830099
498400         READQ TS                                                 49840099
498500             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        49850099
498600             INTO  (SU013-SELECT-RECORD)                          49860099
498700             ITEM  (ASC-SEL-ITEM)                                 49870099
498800             RESP  (PV-CICS-RESP)                                 49880099
498900     END-EXEC.                                                    49890099
499000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        49900099
499100         CONTINUE                                                 49910099
499200     ELSE                                                         49920099
499300         SET DP013-LOGIC-ABEND                                    49930099
499400             DP013-NO-ROLLBACK   TO   TRUE                        49940099
499500         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          49950099
499600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   49960099
499700                                 TO   DP013-MESSAGE-TEXT (1)      49970099
499800         PERFORM DP013-0000-PROCESS-ABEND                         49980099
499900     END-IF.                                                      49990099
500000                                                                  50000099
500100*-----------------------------------------------------------------50010099
500200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *50020099
500300*-----------------------------------------------------------------50030099
500400 9200-REWRITE-SEL-QUEUE.                                          50040099
500500                                                                  50050099
500600     EXEC CICS                                                    50060099
500700          WRITEQ TS                                               50070099
500800              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      50080099
500900              FROM   (SU013-SELECT-RECORD)                        50090099
501000              ITEM   (ASC-SEL-ITEM)                               50100099
501100              RESP   (PV-CICS-RESP)                               50110099
501200              REWRITE                                             50120099
501300     END-EXEC.                                                    50130099
501400                                                                  50140099
501500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   50150099
501600         SET DP013-CICS-ABEND                                     50160099
501700             DP013-NO-ROLLBACK     TO TRUE                        50170099
501800         MOVE '9200-REWRITE-SEL-QUEUE'                            50180099
501900                                   TO DP013-PARAGRAPH             50190099
502000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   50200099
502100                                   TO DP013-MESSAGE-TEXT (1)      50210099
502200         PERFORM DP013-0000-PROCESS-ABEND                         50220099
502300     END-IF.                                                      50230099
502400                                                                  50240099
502500*----------------------------------------------------------------*50250099
502600*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *50260099
502700*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *50270099
502800*----------------------------------------------------------------*50280099
502900 9900-SOFT-ABORT.                                                 50290099
503000                                                                  50300099
503100     EXEC CICS SYNCPOINT                                          50310099
503200          ROLLBACK                                                50320099
503300     END-EXEC.                                                    50330099
503400                                                                  50340099
503500     SET  PS-ERROR                                                50350099
503600          PS-SOFT-ABORT-ERROR                                     50360099
503700          DP020-MSG-FATAL       TO  TRUE.                         50370099
503800                                                                  50380099
503900                                                                  50390099
504000******************************************************************50400099
504100*  EXIT THE SHIPT UNIT REPORT REQUEST SYSTEM, DISPLAYING A       *50410099
504200*  REASON FOR THE PROGRAM ABEND.                                 *50420099
504300******************************************************************50430099
504400                                                                  50440099
504500 9900-LEAVE-SYSTEM.                                               50450099
504600     EXEC CICS                                                    50460099
504700         SEND                                                     50470099
504800             FROM(PV-LEAVE-SYSTEM-MESSAGE)                        50480099
504900             LENGTH(PC-LEAVE-SYSTEM-LENGTH)                       50490099
505000             ERASE                                                50500099
505100     END-EXEC.                                                    50510099
505200                                                                  50520099
505300     EXEC CICS                                                    50530099
505400         RETURN                                                   50540099
505500     END-EXEC.                                                    50550099
505600     EJECT                                                        50560099
505700                                                                  50570099
505800                                                                  50580099
505900*----------------------------------------------------------------*50590099
506000*    ABEND PROCESSOR MODULE                                      *50600099
506100*----------------------------------------------------------------*50610099
506200                                                                  50620099
506300     COPY DPPD013.                                                50630099
