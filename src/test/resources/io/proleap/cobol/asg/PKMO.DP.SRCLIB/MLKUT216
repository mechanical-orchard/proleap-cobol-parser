       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    MLKUT216.                                         00020002
       AUTHOR.        B.GRAHAM - STRATAGEM.                             00030000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
       DATE-WRITTEN.  04-05-08.                                         00050000
       DATE-COMPILED.                                                   00060000
      ******************************************************************00070000
      *                                                                 00080000
      * MLKUT216 - IDENTIFY CURR/PREV SKU ATTRIBUTE CHANGES             00090002
      *                                                                 00100000
      *                                                                 00110000
      ******************** HISTORY OF CHANGES **************************00120000
      * CHG ID/                                                        *00130000
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *00140000
      * -------  ----------  ----------------------------------------  *00150000
      * W34517   06-06-2008  B.GRAHAM - STRATAGEM                       00160002
      *                      INITIAL IMPLEMENTATION                     00170000
      ******************************************************************00180000
      *                                                                 00190000
       ENVIRONMENT DIVISION.                                            00200000
      *                                                                 00210000
       CONFIGURATION SECTION.                                           00220000
      *                                                                 00230000
       SOURCE-COMPUTER.        IBM-3090.                                00240000
       OBJECT-COMPUTER.        IBM-3090.                                00250000
      *                                                                 00260000
       INPUT-OUTPUT SECTION.                                            00270000
       FILE-CONTROL.                                                    00280000
                                                                        00290000
           SELECT SKU-CURR-PREV-ATTR-FILE                               00300000
               ASSIGN TO INP01.                                         00310000
                                                                        00320000
           SELECT UPD-SKU-CURR-PREV-ATTR-FILE                           00330000
               ASSIGN TO OUT01.                                         00340000
                                                                        00350000
                                                                        00360000
      ******************************************************************00370000
       DATA DIVISION.                                                   00380000
      ******************************************************************00390000
                                                                        00400000
       FILE SECTION.                                                    00410000
                                                                        00420000
       FD  SKU-CURR-PREV-ATTR-FILE                                      00430000
           LABEL RECORDS ARE STANDARD                                   00440000
           RECORDING MODE IS F                                          00450000
           BLOCK CONTAINS 0 RECORDS.                                    00460000
       01  SKU-CURR-PREV-ATTR-REC      PIC X(175).                      00470002
                                                                        00480000
       FD  UPD-SKU-CURR-PREV-ATTR-FILE                                  00490000
           RECORDING MODE F                                             00500000
           LABEL RECORDS OMITTED                                        00510000
           BLOCK CONTAINS  0 RECORDS.                                   00520000
       01  UPD-SKU-CURR-PREV-ATTR-REC  PIC X(175).                      00530002
                                                                        00540000
                                                                        00550000
      ******************************************************************00560000
       WORKING-STORAGE SECTION.                                         00570000
      ******************************************************************00580000
                                                                        00590000
                                                                        00600000
      *** INPUT AND OUTPUT SKU-CURR-PREV-ATTR-REC                       00610000
           COPY MLRD556.                                                00620000
                                                                        00630000
                                                                        00640000
       EJECT                                                            00650000
       01  PA-PROGRAM-ACCUMULATORS.                                     00660000
           05  PA-SKU-RECS-IN-CNT     PIC 9(09)    VALUE ZERO.          00670000
           05  PA-SKU-RECS-OUT-CNT                                      00680000
                                      PIC 9(09)    VALUE ZERO.          00690000
           05  PA-DEPT-CHG-CNT        PIC 9(09)    VALUE ZERO.          00700000
           05  PA-MAJ-CL-CHG-CNT      PIC 9(09)    VALUE ZERO.          00710000
           05  PA-SUB-CL-CHG-CNT      PIC 9(09)    VALUE ZERO.          00720001
           05  PA-ENT-ID-CHG-CNT      PIC 9(09)    VALUE ZERO.          00730000
           05  PA-LBL-SEQ-CHG-CNT     PIC 9(09)    VALUE ZERO.          00740000
                                                                        00750000
       01  PC-PROGRAM-CONSTANTS.                                        00760000
                                                                        00770000
           05  PC-MLKUT216             PIC X(8)    VALUE 'MLKUT216'.    00780002
                                                                        00790000
           05  PC-0                    PIC 9       VALUE 0.             00800001
           05  PC-1                    PIC 9       VALUE 1.             00801001
                                                                        00810000
                                                                        00840000
       01  PS-PROGRAM-SWITCHES.                                         00850000
           05  PS-SKU-FILE-AT-END-SW      PIC X    VALUE 'N'.           00860000
               88  PS-SKU-FILE-AT-END-YES          VALUE 'Y'.           00870000
               88  PS-SKU-FILE-AT-END-NO           VALUE 'N'.           00880000
                                                                        00890000
       EJECT                                                            00900000
                                                                        00910000
      ******************************************************************00920000
       PROCEDURE DIVISION.                                              00930000
      ******************************************************************00940000
                                                                        00950000
                                                                        00960000
      *************************PROGRAM PROCESS**************************00970000
      *  1. INITIALIZATION                                              00980000
      *     A. OPEN FILES                                               00990000
      *                                                                 01000000
      *  2. READ INPUT FILE.                                            01010000
      *  3. DETERMINE CHANGE TYPES                                      01020000
      *  4. WRITE UPDATED RECORD                                        01030000
      *                                                                 01040000
      *  5. CLOSE FILES AND DISPLAY COUNTS.                             01050000
      *                                                                 01060000
      ******************************************************************01070000
       0000-MAINLINE-MLKUT216.                                          01080002
      ******************************************************************01090000
      *                                                                 01100000
           PERFORM 1000-INITIALIZATION.                                 01110000
                                                                        01120000
           SET PS-SKU-FILE-AT-END-NO TO TRUE.                           01130000
                                                                        01140000
           PERFORM 2000-PROCESS-SKU-FILE                                01150000
               UNTIL PS-SKU-FILE-AT-END-YES.                            01160000
                                                                        01170000
           PERFORM 8000-EOJ.                                            01180000
                                                                        01190000
           STOP RUN.                                                    01200000
                                                                        01210000
       EJECT                                                            01220000
                                                                        01230000
      ******************************************************************01240000
       1000-INITIALIZATION.                                             01250000
      ******************************************************************01260000
      *                                                                 01270000
           OPEN INPUT  SKU-CURR-PREV-ATTR-FILE                          01280000
                OUTPUT UPD-SKU-CURR-PREV-ATTR-FILE.                     01290000
                                                                        01300000
      ******************************************************************01310000
       2000-PROCESS-SKU-FILE.                                           01320000
      *                                                                 01330000
      *     DETERMINE WHICH ATTRIBUTES HAVE CHANGED AND UPDATE          01340000
      *     RECORD ACCORDINGLY.                                         01350000
      *     WRITE OUT CHANGED RECORD.                                   01360000
      ******************************************************************01370000
                                                                        01380000
                                                                        01390000
           PERFORM 2100-READ-INPUT.                                     01400000
                                                                        01410000
           IF PS-SKU-FILE-AT-END-NO                                     01420000
              PERFORM 2200-ID-CHGES                                     01430000
              PERFORM 2300-WRITE-OUTPUT                                 01440000
           END-IF.                                                      01450000
                                                                        01460000
      ******************************************************************01470000
       2100-READ-INPUT.                                                 01480000
      ******************************************************************01490000
                                                                        01500000
           READ SKU-CURR-PREV-ATTR-FILE INTO                            01510000
                                      ML556-CURR-PREV-SKU-ATTR-REC      01520001
               AT END                                                   01530000
                   SET PS-SKU-FILE-AT-END-YES TO TRUE                   01540000
               NOT AT END                                               01550000
                   SET PS-SKU-FILE-AT-END-NO  TO TRUE                   01560000
                   ADD PC-1 TO PA-SKU-RECS-IN-CNT.                      01570001
                                                                        01580000
      ******************************************************************01590000
       2200-ID-CHGES.                                                   01600000
      ******************************************************************01610000
                                                                        01620000
           IF ML556-CURR-DEPT-NBR EQUAL ML556-PREV-DEPT-NBR             01630000
               MOVE PC-0                       TO ML556-DEPT-CHG-CDE    01640001
           ELSE                                                         01650000
               MOVE PC-1                       TO ML556-DEPT-CHG-CDE    01660001
               ADD PC-1                        TO PA-DEPT-CHG-CNT       01670001
           END-IF.                                                      01680000
                                                                        01690000
           IF ML556-CURR-MAJ-CL-NBR EQUAL ML556-PREV-MAJ-CL-NBR         01700000
               MOVE PC-0                       TO ML556-MAJ-CL-CHG-CDE  01710001
           ELSE                                                         01720000
               MOVE PC-1                       TO ML556-MAJ-CL-CHG-CDE  01730001
               ADD PC-1                        TO PA-MAJ-CL-CHG-CNT     01740001
           END-IF.                                                      01750000
                                                                        01760000
           IF ML556-CURR-SUB-CL-NBR EQUAL ML556-PREV-SUB-CL-NBR         01770002
               MOVE PC-0                       TO ML556-SUB-CL-CHG-CDE  01780001
           ELSE                                                         01790000
               MOVE PC-1                       TO ML556-SUB-CL-CHG-CDE  01800001
               ADD PC-1                        TO PA-SUB-CL-CHG-CNT     01810001
           END-IF.                                                      01820000
                                                                        01830000
           IF ML556-CURR-ENT-ID EQUAL ML556-PREV-ENT-ID                 01840000
               MOVE PC-0                       TO ML556-ENT-ID-CHG-CDE  01850001
           ELSE                                                         01860000
               MOVE PC-1                       TO ML556-ENT-ID-CHG-CDE  01870001
               ADD PC-1                        TO PA-ENT-ID-CHG-CNT     01880001
           END-IF.                                                      01890000
                                                                        01900000
           IF ML556-CURR-LBL-SEQ-NBR EQUAL ML556-PREV-LBL-SEQ-NBR       01910000
               MOVE PC-0                       TO ML556-LBL-SEQ-CHG-CDE 01920001
           ELSE                                                         01930000
               MOVE PC-1                       TO ML556-LBL-SEQ-CHG-CDE 01940001
               ADD PC-1                        TO  PA-LBL-SEQ-CHG-CNT   01950001
           END-IF.                                                      01960000
                                                                        01970000
      ******************************************************************01980000
       2300-WRITE-OUTPUT.                                               01990000
      ******************************************************************02000000
                                                                        02010000
           WRITE UPD-SKU-CURR-PREV-ATTR-REC FROM                        02020000
                                      ML556-CURR-PREV-SKU-ATTR-REC.     02030001
                                                                        02040000
           ADD PC-1 TO PA-SKU-RECS-OUT-CNT.                             02050001
                                                                        02060000
                                                                        02070000
      ******************************************************************02080000
       8000-EOJ.                                                        02090000
      ******************************************************************02100000
      *                                                                 02110000
                                                                        02120000
           DISPLAY ' '.                                                 02130000
           DISPLAY '  PROGRAM MLKUT216 PROCESSING SUMMARY'.             02140002
           DISPLAY '  -----------------------------------'.             02150000
           DISPLAY ' '.                                                 02160000
           DISPLAY ' PA-SKU-RECS-IN-CNT  '                              02170000
                         PA-SKU-RECS-IN-CNT.                            02180000
           DISPLAY ' PA-SKU-RECS-OUT-CNT '                              02190000
                         PA-SKU-RECS-OUT-CNT.                           02200000
           DISPLAY ' PA-DEPT-CHG-CNT     '                              02210000
                         PA-DEPT-CHG-CNT.                               02220000
           DISPLAY ' PA-MAJ-CL-CHG-CNT   '                              02230000
                         PA-MAJ-CL-CHG-CNT.                             02240000
           DISPLAY ' PA-SUB-CL-CHG-CNT   '                              02250000
                         PA-SUB-CL-CHG-CNT.                             02260000
           DISPLAY ' PA-ENT-ID-CHG-CNT   '                              02270000
                         PA-ENT-ID-CHG-CNT.                             02280000
           DISPLAY ' PA-LBL-SEQ-CHG-CNT  '                              02290000
                         PA-LBL-SEQ-CHG-CNT.                            02300000
                                                                        02370000
           CLOSE SKU-CURR-PREV-ATTR-FILE                                02380000
                 UPD-SKU-CURR-PREV-ATTR-FILE.                           02390000
                                                                        02890000
