00001 ******************************************************************07/21/92
00002  IDENTIFICATION DIVISION.                                         DPKCS016
00003 ******************************************************************   LV010
00004  PROGRAM-ID.                DPKCS016.                                CL**4
00005  AUTHOR.                    DWYNE WALLACE.                           CL**2
00006  INSTALLATION.              KOHLS DEPARTMENT STORES.                 CL**2
00007  DATE-WRITTEN.              SEPTEMBER 1990.                          CL**2
00008  DATE-COMPILED.                                                      CL**2
00009  SKIP2                                                               CL**2
00010 ******************************************************************   CL**2
00011 *  CICS PROGRAM - DPKCS016                                       *   CL**4
00012 *  TRANSACTION ID. - Z016                                        *   CL**4
00013 *                                                                *   CL**2
00014 *                UPDATE MNEMONIC PROGRAM                         *   CL**2
00015 *                                                                *   CL**2
00016 *  THIS TRANSACTION PROCESSES ALL UPDATE REQUESTS FOR THE TMNEMO-*   CL**2
00017 *  NIC DB2 DATABASE. THIS DATABASE IS USED TO CONTROL NAVIGATION *   CL**2
00018 *  WITHIN CICS.                                                  *   CL**2
00019 *                                                                *   CL**2
00020 *  PF KEY PROCESSING:                                            *   CL**2
00021 *                                                                *   CL**2
00022 *         ENTER - EDIT SCREEN                                    *   CL**2
00023 *         PA2   - TOGGLE FUNCTION KEY LINES                      *   CL**2
00024 *         PF5   - REFRESH LIST FROM DATABASE                     *   CL**2
00025 *         PF15  - UPDATE DATABASE                                *   CL**2
00026 *         CLEAR - RESET SCREEN TO LAST DISPLAY                   *   CL**2
00027 *                                                                *   CL**2
00028 *  NAVIGATION PF KEY PROCESSING:                                 *   CL**2
00029 *                                                                *   CL**2
00030 *         *SEE MNEMONIC FILE FOR NAVIGATION PF KEY DEFINITIONS.  *   CL**2
00031 *                                                                *   CL**2
00032 *  CHANGED 4/92 BY M. FURLICK PER W/R 1937.                      *   CL**2
00033 *         ADDED ENTERABLE PROGRAM ID,                            *   CL**2
00034 *               ENTERABLE ACCESSIBILITY INDICATOR;               *   CL**2
00035 *         MINOR SCREEN CHANGE TO ACCOMODATE THESE FIELDS.        *   CL**2
00036 *                                                                *   CL**2
00037 ******************************************************************   CL**2
00038  SKIP2                                                               CL**2
00039 ******************************************************************   CL**2
00040  ENVIRONMENT DIVISION.                                               CL**2
00041 ******************************************************************   CL**2
00042  EJECT                                                               CL**2
00043 ******************************************************************   CL**2
00044  DATA DIVISION.                                                      CL**2
00045 ******************************************************************   CL**2
00046  SKIP2                                                               CL**2
00047  WORKING-STORAGE SECTION.                                            CL**2
00048  SKIP1                                                               CL**2
00049 *********************                                                CL**2
00050 * PROGRAM CONSTANTS *                                                CL**2
00051 *********************                                                CL**2
00052  SKIP1                                                               CL**2
00053  01  PROGRAM-CONSTANT-AREA.                                          CL**2
00054      05  PC-MAXIMUM-COMMAREA-LENGTH                                  CL**2
00055                                  PIC S9(4)      VALUE +4072          CL**2
00056                                                 COMP SYNC.           CL**2
00057      05  PC-CURRENT-MAP-NAME     PIC X(8)       VALUE 'DP819A  '.    CL**2
00058      05  PC-CURRENT-MAPSET-NAME  PIC X(8)       VALUE 'DPKM819 '.    CL**2
00059      05  PC-CURRENT-PROGRAM-NAME PIC X(8)       VALUE 'DPKCS016'.    CL**4
00060      05  PC-NAVIGATOR-TRAN-ID    PIC X(4)       VALUE 'Z808'.        CL**2
00061      05  PC-MENU-TRAN-ID         PIC X(4)       VALUE 'MENU'.        CL**2
00062      05  PC-LEAVE-SYSTEM-LENGTH  PIC S9(4)      VALUE +80            CL**2
00063                                                 COMP SYNC.           CL**2
00064      05  PC-HEX-VALUE-80         PIC X          VALUE 'ø'.           CL**2
00065      05  PC-FORMAT-CODE          PIC X(4)       VALUE 'CMIA'.        CL**2
00066      05  PC-ACKNWLDGE-CODE       PIC X(4)       VALUE 'CMIA'.        CL**2
00067      05  PC-COMM-LENGTH          PIC 9(4)       VALUE 2866.          CL**2
00068      05  PC-COMM-LENGTH-3        PIC 9(4)       VALUE 0003.          CL**2
00069      05  PC-TRANSACTION-ENABLED  PIC S9(8)      COMP                 CL**2
00070                                                 VALUE 23.            CL**2
00071      05  PC-TRANSACTION-DISABLED PIC S9(8)      COMP                 CL**2
00072                                                 VALUE 24.            CL**2
00073      05  PC-TRANSACTION-DISABLING                                    CL**2
00074                                  PIC S9(8)      COMP                 CL**2
00075                                                 VALUE 25.            CL**2
00076      05  PC-TSYMSG-00005         PIC 9(5)       VALUE 00005.         CL**2
00077      05  PC-TSYMSG-00008         PIC 9(5)       VALUE 00008.         CL**2
00078      05  PC-TSYMSG-00045         PIC 9(5)       VALUE 00045.         CL**2
00079      05  PC-TSYMSG-00059         PIC 9(5)       VALUE 00059.         CL**2
00080      05  PC-TSYMSG-00070         PIC 9(5)       VALUE 00070.         CL**2
00081      05  PC-TSYMSG-00148         PIC 9(5)       VALUE 00148.         CL**2
00082  SKIP2                                                               CL**2
00083 *********************                                                CL**2
00084 * PROGRAM VARIABLES *                                                CL**2
00085 *********************                                                CL**2
00086  SKIP1                                                               CL**2
00087  01  PROGRAM-VARIABLE-AREA.                                          CL**2
00088      05  PV-CICS-RESPONSE        PIC S9(8)      VALUE ZERO           CL**2
00089                                                 COMP SYNC.           CL**2
00090      05  PV-RESP                 PIC S9(8)      VALUE ZERO           CL**2
00091                                                 COMP SYNC.           CL**2
00092      05  PV-TERMINAL             PIC X(4)       VALUE SPACES.        CL**2
00093      05  PV-LEAVE-SYSTEM-MSG     PIC X(80)      VALUE SPACES.        CL**2
00094      05  PV-HOLD-MESSAGE         PIC X(78)      VALUE SPACES.        CL**2
00095      05  PV-HOLD-SEVERITY-IND    PIC X(1)       VALUE SPACES.        CL**2
00096      05  PV-HOLD-AFRMOBJI        PIC X(3).                           CL**2
00097      05  PV-HOLD-AFRMOBJI-NUM    REDEFINES                           CL**2
00098          PV-HOLD-AFRMOBJI        PIC 9(3).                           CL**2
00099      05  PV-MNEMONIC             PIC X(8)       VALUE SPACES.        CL**2
00100      05  PV-COMM-LENGTH-ALPHA    PIC X(4).                           CL**2
00101      05  PV-COMM-LENGTH-NUMERIC  REDEFINES                           CL**2
00102          PV-COMM-LENGTH-ALPHA    PIC 9(4).                           CL**2
00103      05  PV-FORMAT-CODES         PIC X(4)       VALUE SPACES.        CL**2
00104          88  PV-ACCEPTED-FORMAT-CODE            VALUE 'CMIA'         CL**2
00105                                                       'FKEY'         CL**2
00106                                                       'MITM'.        CL**2
00107          88  PV-CMIA-FORMAT                     VALUE 'CMIA'.        CL**2
00108          88  PV-FKEY-FORMAT                     VALUE 'FKEY'.        CL**2
00109          88  PV-MITM-FORMAT                     VALUE 'MITM'.        CL**2
00110  EJECT                                                               CL**2
00111 ********************                                                 CL**2
00112 * PROGRAM SWITCHES *                                                 CL**2
00113 ********************                                                 CL**2
00114  SKIP1                                                               CL**2
00115  01  PROGRAM-SWITCHES.                                               CL**2
00116      05  PS-MAP-SEND-TYPE        PIC X          VALUE '1'.           CL**2
00117          88  PS-SEND-MAP-N-DATA-FRSET           VALUE '1'.           CL**2
00118          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN     VALUE '2'.           CL**2
00119          88  PS-SEND-DATA-ONLY-FRSET            VALUE '3'.           CL**2
00120          88  PS-SEND-DATA-ONLY                  VALUE '4'.           CL**2
00121          88  PS-SEND-DATA-ONLY-ERASEAUP         VALUE '5'.           CL**2
00122          88  PS-SEND-MAP-ONLY-FRSET             VALUE '6'.           CL**2
00123      05  PS-LOCAL-FUNCTION-KEY-IND                                   CL**2
00124                                  PIC X          VALUE 'N'.           CL**2
00125          88  PS-LOCAL-FUNCTION-NO               VALUE 'N'.           CL**2
00126          88  PS-LOCAL-FUNCTION-YES              VALUE 'Y'.           CL**2
00127      05  PS-ROW-FOUND-IND        PIC X          VALUE 'N'.           CL**2
00128          88  PS-ROW-FOUND-NO                    VALUE 'N'.           CL**2
00129          88  PS-ROW-FOUND-YES                   VALUE 'Y'.           CL**2
00130      05  PS-EDIT-ERROR-SW        PIC X          VALUE 'N'.           CL**2
00131          88  PS-EDIT-ERROR-NO                   VALUE 'N'.           CL**2
00132          88  PS-EDIT-ERROR-YES                  VALUE 'Y'.           CL**2
00133      05  PS-NEW-MNEMONIC-ENTERED-IND                                 CL**2
00134                                  PIC X          VALUE 'N'.           CL**2
00135          88  PS-NEW-MNEMONIC-ENTERED-NO         VALUE 'N'.           CL**2
00136          88  PS-NEW-MNEMONIC-ENTERED-YES        VALUE 'Y'.           CL**2
00137  EJECT                                                               CL**2
00138  EJECT                                                               CL**2
00139 **************************                                           CL**2
00140 * DB2 COMMUNICATION AREA *                                           CL**2
00141 **************************                                           CL**2
00142  SKIP1                                                               CL**2
00143      EXEC SQL                                                        CL**2
00144          INCLUDE SQLCA                                               CL**2
00145      END-EXEC.                                                       CL**2
00146  SKIP2                                                               CL**2
00147 ***********************************                                  CL**2
00148 * DB2 SQL RETURN CODE DEFINITIONS *                                  CL**2
00149 *    USING '88' LEVEL             *                                  CL**2
00150 ***********************************                                  CL**2
00151  SKIP1                                                               CL**2
00152  01  SQL-RETURN-CODE             PIC S9(9)      COMP-4.              CL**2
00153      88  SQL-SUCCESSFUL                         VALUE +0.            CL**2
00154      88  SQL-ROW-FOUND                          VALUE +0.            CL**2
00155      88  SQL-ROW-NOT-FOUND                      VALUE +100.          CL**2
00156      88  SQL-WARNING                            VALUE +100           CL**2
00157                                                       +558           CL**2
00158                                                       +560.          CL**2
00159      88  SQL-DUPLICATE-ROW                      VALUE -803.          CL**2
00160      88  SQL-MORE-THAN-1-ROW                    VALUE -811.          CL**2
00161      88  SQL-NOT-AVAILABLE                      VALUE -911.          CL**2
00162      88  SQL-DB2-DOWN                           VALUE -923.          CL**2
00163      88  SQL-NULL-VALUE                         VALUE -305.          CL**2
00164      88  SQL-DEPENDENT-ROW                      VALUE -532.          CL**2
00165  EJECT                                                               CL**2
00166 **************************************                               CL**2
00167 * STANDARD ATTENTION IDENTIFIER LIST *                               CL**2
00168 **************************************                               CL**2
00169  SKIP1                                                               CL**2
00170      COPY DFHAID.                                                    CL**2
00171  EJECT                                                               CL**2
00172 **************************************************************       CL**2
00173 * WORKING-STORAGE LAYOUT USED TO LOAD THE FUNCTION KEY LINES *       CL**2
00174 **************************************************************       CL**2
00175      COPY DPWS009.                                                   CL**2
00176  EJECT                                                               CL**2
00177 ***************************                                          CL**2
00178 * COMMON ABEND DATA AREAS *                                          CL**2
00179 ***************************                                          CL**2
00180  SKIP1                                                               CL**2
00181      COPY DPWS013.                                                   CL**2
00182  EJECT                                                               CL**2
00183 *****************************                                        CL**2
00184 * ARCHITECTURE MESSAGE AREA *                                        CL**2
00185 *****************************                                        CL**2
00186  SKIP1                                                               CL**2
00187      COPY DPRD507I.                                                  CL**2
00188  EJECT                                                               CL**2
00189 *********************************************************            CL**2
00190 * KOHL'S DEFINED:                                       *            CL**2
00191 * STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST *            CL**2
00192 *********************************************************            CL**2
00193  SKIP1                                                               CL**2
00194      COPY DPWS015.                                                   CL**2
00195  EJECT                                                               CL**2
00196 **************************************                               CL**2
00197 * KOHL'S:                            *                               CL**2
00198 * STANDARD ATTENTION IDENTIFIER LIST *                               CL**2
00199 **************************************                               CL**2
00200  SKIP1                                                               CL**2
00201      COPY DPWS016.                                                   CL**2
00202  EJECT                                                               CL**2
00203 ***************************************************************      CL**2
00204 * WORKING-STORAGE LAYOUT USED TO GET THE SYSTEM DATE AND TIME *      CL**2
00205 ***************************************************************      CL**2
00206      COPY DPWS017.                                                   CL**2
00207  EJECT                                                               CL**2
00208 *******************************                                      CL**2
00209 * STANDARD COMMUNICATION AREA *                                      CL**2
00210 *******************************                                      CL**2
00211  SKIP1                                                               CL**2
00212      COPY DPWS020.                                                   CL*10
00213      05  FILLER                  REDEFINES                           CL**2
00214          DP020-VARIABLE-COMMAREA.                                    CL**2
00215 ***************************************                              CL**2
00216 * CICSARC INTER APPLICATION DATA AREA *                              CL**2
00217 ***************************************                              CL**2
00218          10  INTER-APPL-COMM-AREA                                    CL**2
00219                                  PIC X(200).                         CL**2
00220 **********************************                                   CL**2
00221 * APPLICATION SPECIFIC COMM AREA *                                   CL**2
00222 **********************************                                   CL**2
00223          10  APPL-SPECIFIC-COMM-AREA                                 CL**2
00224                                  PIC X(2865).                        CL**2
00225          10  DP019-APPL-SPECIFIC-COMM-AREA                           CL**2
00226                                  REDEFINES                           CL**2
00227              APPL-SPECIFIC-COMM-AREA.                                CL**2
00228              15  FILLER          PIC X(02).                          CL**2
00229              15  DP019-CURRENT-SCREEN-IMAGE.                         CL**2
00230                  20  DP019-SCREEN-TRAN-ID                            CL**2
00231                                  PIC X(4).                           CL**2
00232                  20  DP019-SCREEN-MNEMONIC                           CL**2
00233                                  PIC X(8).                           CL**2
00234                  20  DP019-SCREEN-MNEMONIC-TITLE                     CL**2
00235                                  PIC X(30).                          CL**2
00236                  20  DP019-SCREEN-AVAILABIL-IND                      CL**2
00237                                  PIC X.                              CL**2
00238                  20  DP019-SCREEN-COMMAREA-FORMAT                    CL**2
00239                                  PIC X.                              CL**2
00240                  20  DP019-SCREEN-SAVE-COMM-IND                      CL**2
00241                                  PIC X.                              CL**2
00242                  20  DP019-SCREEN-SAVE-COMM-LENGTH                   CL**2
00243                                  PIC X(4).                           CL**2
00244                  20  DP019-SCREEN-PROGRAM                            CL**2
00245                                  PIC X(8).                           CL**2
00246                  20  DP019-SCREEN-GLOBAL-ACCESS                      CL**2
00247                                  PIC X(1).                           CL**2
00248                  20  DP019-SCREEN-TYPE-CODE                          CL**2
00249                                  PIC X(1).                           CL**2
00250              15  DP019-TRAN-DEFINED-CICS                             CL**2
00251                                  PIC X.                              CL**2
00252              15  DP019-SELECT-MAINT-RESULT                           CL**2
00253                                  PIC X.                              CL**2
00254                  88  DP019-RESULT-IS-CREATE      VALUE '1'.          CL**2
00255                  88  DP019-RESULT-IS-UPDATE      VALUE '2'.          CL**2
00256                  88  DP019-RESULT-IS-DELETE      VALUE '3'.          CL**2
00257                  88  DP019-RESULT-IS-READ        VALUE '4'.          CL**2
00258                  88  DP019-RESULT-IS-ERROR       VALUE '5'.          CL**2
00259              15  DP019-INTER-APPL-COMMAREA.                          CL**2
00260                  20  DP019-INTER-APPL-FORMAT-CODE                    CL**2
00261                                  PIC X(04).                          CL**2
00262                  20  DP019-INTER-APPL-ACKNLG-CODE                    CL**2
00263                                  PIC X(04).                          CL**2
00264                  20  DP019-MITM-AREA.                                CL**2
00265                      25  DP019-MITM-MENU-NAME                        CL**2
00266                                  PIC X(08).                          CL**2
00267                      25  DP019-MITM-ITEM-MNEMONIC                    CL**2
00268                                  PIC X(08).                          CL**2
00269                      25  DP019-MITM-SEQUENCE-NUMBER                  CL**2
00270                                  PIC S9(4)      COMP.                CL**2
00271                      25  DP019-MITM-TRAN-ID                          CL**2
00272                                  PIC X(04).                          CL**2
00273                      25  DP019-MITM-TITLE                            CL**2
00274                                  PIC X(30).                          CL**2
00275                      25  DP019-MITM-ITEM-TITLE                       CL**2
00276                                  PIC X(30).                          CL**2
00277                      25  DP019-MITM-MAINTENANCE-RESULT               CL**2
00278                                  PIC X.                              CL**2
00279                          88  DP019-MITM-RESULT-IS-CREATE             CL**2
00280                                  VALUE '1'.                          CL**2
00281                          88  DP019-MITM-RESULT-IS-UPDATE             CL**2
00282                                  VALUE '2'.                          CL**2
00283                          88  DP019-MITM-RESULT-IS-DELETE             CL**2
00284                                  VALUE '3'.                          CL**2
00285                          88  DP019-MITM-RESULT-IS-READ               CL**2
00286                                  VALUE '4'.                          CL**2
00287                          88  DP019-MITM-RESULT-IS-ERROR              CL**2
00288                                  VALUE '5'.                          CL**2
00289                      25  FILLER  PIC X(109).                         CL**2
00290                  20  DP019-FKEY-AREA                                 CL**2
00291                                  REDEFINES                           CL**2
00292                      DP019-MITM-AREA.                                CL**2
00293                      25  DP019-FKEY-MNEMONIC                         CL**2
00294                                  PIC X(08).                          CL**2
00295                      25  DP019-FKEY-FUNCTION-KEY                     CL**2
00296                                  PIC S9(04)     COMP.                CL**2
00297                      25  DP019-FKEY-FUNCT-KEY-MNEMONIC               CL**2
00298                                  PIC X(08).                          CL**2
00299                      25  DP019-FKEY-MAINTENANCE-RESULT               CL**2
00300                                  PIC X.                              CL**2
00301                          88  DP019-FKEY-RESULT-IS-CREATE             CL**2
00302                                  VALUE '1'.                          CL**2
00303                          88  DP019-FKEY-RESULT-IS-UPDATE             CL**2
00304                                  VALUE '2'.                          CL**2
00305                          88  DP019-FKEY-RESULT-IS-DELETE             CL**2
00306                                  VALUE '3'.                          CL**2
00307                          88  DP019-FKEY-RESULT-IS-READ               CL**2
00308                                  VALUE '4'.                          CL**2
00309                          88  DP019-FKEY-RESULT-IS-ERROR              CL**2
00310                                  VALUE '5'.                          CL**2
00311                      25  FILLER  PIC X(173).                         CL**2
00312                  20  DP019-CMIA-AREA                                 CL**2
00313                                  REDEFINES                           CL**2
00314                      DP019-FKEY-AREA.                                CL**2
00315                      25  DP019-CMIA-MNEMONIC                         CL**2
00316                                  PIC X(08).                          CL**2
00317                      25  DP019-CMIA-TRAN-ID                          CL**2
00318                                  PIC X(04).                          CL**2
00319                      25  DP019-CMIA-TITLE                            CL**2
00320                                  PIC X(30).                          CL**2
00321                      25  DP019-CMIA-MAINTENANCE-RESULT               CL**2
00322                                  PIC X.                              CL**2
00323                          88  DP019-CMIA-RESULT-IS-CREATE             CL**2
00324                                  VALUE '1'.                          CL**2
00325                          88  DP019-CMIA-RESULT-IS-UPDATE             CL**2
00326                                  VALUE '2'.                          CL**2
00327                          88  DP019-CMIA-RESULT-IS-DELETE             CL**2
00328                                  VALUE '3'.                          CL**2
00329                          88  DP019-CMIA-RESULT-IS-READ               CL**2
00330                                  VALUE '4'.                          CL**2
00331                          88  DP019-CMIA-RESULT-IS-ERROR              CL**2
00332                                  VALUE '5'.                          CL**2
00333                      25  FILLER  PIC X(149).                         CL**2
00334              15  DP019-TIMESTAMP     PIC X(26).                      CL**2
00335              15  DP019-LAST-MNEMONIC PIC X(08).                      CL**2
00336              15  DP019-MN-SUB        PIC S9(4) COMP.                 CL**2
00337              15  DP019-MN-ITEM       PIC S9(4) COMP.                 CL**2
00338              15  DP019-TSQB-SW       PIC X(01).                      CL**2
00339                  88  DP019-USE-TSQB            VALUE 'Y'.            CL**2
00340                  88  DP019-NO-TSQB             VALUE 'N'.            CL**2
00341              15  DP019-SAVE-INTER-APPL-COMMAREA                      CL**2
00342                                      PIC X(200).                     CL**2
00343              15  DP019-SAVE-TSQB-RECORD PIC X(1500).                 CL**2
00344  EJECT                                                               CL**2
00345 **************************************************************       CL**2
00346 * PARAMETER LIST USED TO CALL THE 'TRANSLATE AID' SUBROUTINE *       CL**2
00347 **************************************************************       CL**2
00348      COPY DPWS045.                                                   CL**2
00349   EJECT                                                              CL**2
00350 ******************************                                       CL**2
00351 * DCLGEN FOR TABLE TMNEMONIC *                                       CL**2
00352 ******************************                                       CL**2
00353  SKIP1                                                               CL**2
00354      EXEC SQL                                                        CL**2
00355          INCLUDE TMNMNC                                              CL**2
00356      END-EXEC.                                                       CL**2
00357 ******************************************************************   CL**2
00358 *  SELECT FOR TMNEMONIC TABLE                                        CL**2
00359 ******************************************************************   CL**2
00360      EXEC SQL                                                        CL**2
00361          DECLARE    TMNEMONIC_CURSOR CURSOR FOR                      CL**2
00362              SELECT MNEMONIC_CODE,                                   CL**2
00363                     TRANS_ID_CODE,                                   CL**2
00364                     PGM_NAME                                         CL**2
00365              FROM   TMNEMONIC                                        CL**2
00366              FOR UPDATE OF PGM_NAME                                  CL**2
00367      END-EXEC.                                                       CL**2
00368                                                                      CL**2
00369  EJECT                                                               CL**2
00370  LINKAGE SECTION.                                                    CL**2
00371  SKIP2                                                               CL**2
00372  01  DFHCOMMAREA.                                                    CL**2
00373      05  FILLER                         OCCURS  1 TO 4072 TIMES      CL**2
00374                                         DEPENDING ON EIBCALEN.       CL**2
00375          10  FILLER                     PIC X.                       CL**2
00376  EJECT                                                               CL**2
00377  PROCEDURE DIVISION.                                                 CL**2
00378                                                                      CL**2
00379 ******************************************************************   CL**2
00380 * A000-UPDATE-MNEMONIC                                           *   CL**2
00381 * (Z016-00 UPDATE MNEMONIC)                                      *   CL**4
00382 * MAINLINE SECTION.                                              *   CL**2
00383 ******************************************************************   CL**2
00384                                                                      CL**2
00385  A000-UPDATE-MNEMONIC.                                               CL**2
00386                                                                      CL**2
00387 *    PERFORM DP015-0000-CHECK-COMMAREA.                              CL**6
00388                                                                      CL**2
00389 *****************************************************************    CL**2
00390 * THE VARIABLE 'RETURN-WITH-TRAN-ID' WILL BE SET TO 'Y' IN      *    CL**2
00391 * U13-CHECK-COMMAREA IF A BAD COMMAREA OR NO COMMAREA WAS       *    CL**2
00392 * ENCOUNTERED. IF THAT HAPPENS U13-CHECK-COMMAREA STARTS THE    *    CL**2
00393 * NAVIGATION TRANSACTION AND SETS THIS INDICATOR TO 'Y'. CHECK- *    CL**2
00394 * ING FOR A 'Y' HERE WILL PREVENT THIS TRANSACTION FROM CONTINU-*    CL**2
00395 * ING TO EXECUTE IF THE NAVIGATOR HAS BEEN REQUESTED TO START.  *    CL**2
00396 *****************************************************************    CL**2
00397                                                                      CL**2
00398 *    IF  DP020-SRC-RETURN-W-TRAN-ID                                  CL**6
00399          PERFORM A050-CONTROL-PROCESSING                             CL**2
00400 *    END-IF.                                                         CL**6
00401                                                                      CL**2
00402      PERFORM DP003-0000-RETURN-TO-CICS.                              CL**2
00403                                                                      CL**2
00404      GOBACK.                                                         CL**2
00405  EJECT                                                               CL**2
00406 ******************************************************************   CL**2
00407 * A050-CONTROL-PROCESSING                                        *   CL**2
00408 * (Z016-01 CONTROL PROCESSING)                                   *   CL**4
00409 ******************************************************************   CL**2
00410                                                                      CL**2
00411  A050-CONTROL-PROCESSING.                                            CL**2
00412                                                                      CL**2
00413 *    EVALUATE TRUE                                                   CL**6
00414                                                                      CL**2
00415 *        WHEN DP020-NEXT-ACT-INITIAL                                 CL**6
00416              PERFORM A100-INITIALIZATION.                            CL**7
00417              PERFORM A200-UPDATE-MNEMONIC                            CL**2
00418                  UNTIL SQLCODE = +100.                               CL**7
00419              PERFORM A300-TERMINATION.                               CL**7
00420 *        WHEN OTHER                                                  CL**6
00421 *            SET  DP013-OTHER-ABEND                                  CL**6
00422 *                                TO TRUE                             CL**6
00423 *            MOVE 'A050-CONTROL-PROCESSING       '                   CL**6
00424 *                                TO DP013-PARAGRAPH                  CL**6
00425 *            MOVE 'INVALID NEXT-APPL-ACTIVITY'                       CL**6
00426 **                               TO DP013-MESSAGE-TEXT (1)           CL**6
00427 *            MOVE DP020-NEXT-APPL-ACTIVITY                           CL**6
00428 *                                TO DP013-MESSAGE-TEXT (2)           CL**6
00429 *            PERFORM DP013-0000-PROCESS-ABEND                        CL**6
00430 *                                                                    CL**6
00431 *    END-EVALUATE.                                                   CL**6
00432  A100-INITIALIZATION.                                                CL**2
00433      EXEC SQL                                                        CL**2
00434          OPEN TMNEMONIC_CURSOR                                       CL**2
00435      END-EXEC.                                                       CL**2
00436                                                                      CL**2
00437      EVALUATE TRUE                                                   CL**2
00438          WHEN SQLWARN0 NOT = SPACES                                  CL**2
00439          WHEN SQLCODE < 0                                            CL**2
00440          WHEN SQLCODE > 0                                            CL**2
00441              SET  DP013-DB2-ABEND                                    CL**2
00442                                  TO TRUE                             CL**2
00443              MOVE 'A100-INITIALIZATION           '                   CL**2
00444                                  TO DP013-PARAGRAPH                  CL**2
00445              MOVE 'UNABLE TO OPEN CURSOR'                            CL**2
00446                                  TO DP013-MESSAGE-TEXT (1)           CL**2
00447              MOVE SQLCA        TO DP013-SQLCA                        CL**2
00448              MOVE 'TMNEMONIC         '                               CL**2
00449                                  TO DP013-DB2-TABLE-NAME (1)         CL**2
00450              PERFORM DP013-0000-PROCESS-ABEND                        CL**2
00451                                                                      CL**2
00452          WHEN SQLCODE = 0                                            CL**2
00453              CONTINUE                                                CL**2
00454      END-EVALUATE.                                                   CL**2
00455                                                                      CL**2
00456      PERFORM A210-FETCH-TMNEMONIC-ROW.                               CL**2
00457                                                                      CL**2
00458  A200-UPDATE-MNEMONIC.                                               CL**2
00459      EXEC CICS                                                       CL**2
00460           INQUIRE                                                    CL**2
00461           TRANSACTION (TMNEMONIC-TRANS-ID-CODE)                      CL**2
00462           PROGRAM (TMNEMONIC-PGM-NAME)                               CL**2
00463           RESP (PV-CICS-RESPONSE)                                    CL**5
00464      END-EXEC.                                                       CL**2
00465      IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                          CL**5
00466          CONTINUE                                                    CL**5
00467      ELSE                                                            CL**5
00468          MOVE '????????' TO TMNEMONIC-PGM-NAME                       CL**5
00469      END-IF.                                                         CL**5
00470      PERFORM A220-UPDATE-TMNEMONIC-ROW.                              CL**2
00471      PERFORM A210-FETCH-TMNEMONIC-ROW.                               CL**2
00472 **********************************                                   CL**2
00473 * FETCH ROW FROM TABLE TMNEMONIC *                                   CL**2
00474 **********************************                                   CL**2
00475                                                                      CL**2
00476  A210-FETCH-TMNEMONIC-ROW.                                           CL**2
00477                                                                      CL**2
00478                                                                      CL**2
00479      EXEC SQL                                                        CL**2
00480          FETCH TMNEMONIC_CURSOR                                      CL**2
00481              INTO   :TMNEMONIC-MNEMONIC-CODE,                        CL**2
00482                     :TMNEMONIC-TRANS-ID-CODE,                        CL**2
00483                     :TMNEMONIC-PGM-NAME                              CL**2
00484      END-EXEC.                                                       CL**2
00485                                                                      CL**2
00486      EVALUATE TRUE                                                   CL**2
00487          WHEN SQLCODE = 0                                            CL**2
00488          WHEN SQLCODE = +100                                         CL**2
00489              CONTINUE                                                CL**2
00490          WHEN SQLWARN0 NOT = SPACES                                  CL**2
00491          WHEN SQLCODE < 0                                            CL**2
00492          WHEN SQLCODE > 0                                            CL**2
00493              SET  DP013-DB2-ABEND                                    CL**2
00494                                  TO TRUE                             CL**2
00495              MOVE 'A210-FETCH-TMNEMONIC-ROW      '                   CL**2
00496                                  TO DP013-PARAGRAPH                  CL**2
00497              MOVE 'FETCH ROW ON TMNEMONIC TABLE  '                   CL**2
00498                                  TO DP013-MESSAGE-TEXT (1)           CL**2
00499              MOVE SQLCA        TO DP013-SQLCA                        CL**2
00500              MOVE 'TMNEMONIC         '                               CL**2
00501                                  TO DP013-DB2-TABLE-NAME (1)         CL**2
00502              PERFORM DP013-0000-PROCESS-ABEND                        CL**2
00503      END-EVALUATE.                                                   CL**2
00504  A220-UPDATE-TMNEMONIC-ROW.                                          CL**2
00505                                                                      CL**2
00506        EXEC SQL                                                      CL**2
00507            UPDATE TMNEMONIC                                          CL**2
00508              SET  PGM_NAME      =   :TMNEMONIC-PGM-NAME              CL**3
00509             WHERE CURRENT OF TMNEMONIC_CURSOR                        CL**3
00510        END-EXEC.                                                     CL**2
00511                                                                      CL**2
00512 * CHECK SQLCODE OF UPDATE *                                          CL**2
00513                                                                      CL**2
00514        MOVE SQLCODE              TO SQL-RETURN-CODE.                 CL**2
00515        IF  SQL-ROW-NOT-FOUND                                         CL**2
00516            CONTINUE                                                  CL**2
00517        ELSE                                                          CL**2
00518            IF  NOT SQL-SUCCESSFUL                                    CL**2
00519                SET  DP013-DB2-ABEND  TO TRUE                         CL**2
00520                MOVE 'A220-UPDATE-TMNEMONIC-ROW     '                 CL**2
00521                                  TO DP013-PARAGRAPH                  CL**2
00522                MOVE SQLCA        TO DP013-SQLCA                      CL**2
00523                MOVE 'TMNEMONIC         '                             CL**2
00524                                  TO DP013-DB2-TABLE-NAME (1)         CL**2
00525                PERFORM DP013-0000-PROCESS-ABEND                      CL**2
00526            END-IF                                                    CL**2
00527        END-IF.                                                       CL**2
00528  A300-TERMINATION.                                                   CL**2
00529 *      MOVE 'UPDATES TO TMNEMONIC COMPLETE' TO DP020-MSG-MESSAGE.    CL**8
00530 *      MOVE DP016-PF3 TO DP020-SRC-AID.                              CL**8
00531        PERFORM DP003-0000-RETURN-TO-CICS.                            CL**9
00532 *****************************************                            CL**2
00533 * COPYBOOK FOR DP013-0000-PROCESS-ABEND *                            CL**2
00534 *****************************************                            CL**2
00535      COPY DPPD013.                                                   CL**2
00536  EJECT                                                               CL**2
00537 ******************************************                           CL**2
00538 * COPYBOOK FOR DP015-0000-CHECK-COMMAREA *                           CL**2
00539 ******************************************                           CL**2
00540      COPY DPPD015.                                                   CL**2
00541 *                                                                    CL**8
00542 *      THIS PROCEDURE DIVISION COPY BOOK IS USED FOR THE RETURN      CL**8
00543 *  TO CICS LOGIC FOR PROGRAMS UNDER THE NEW CICS ARCHITECTURE.       CL**8
00544 *  A RETURN WILL BE ISSUED WITH OR WITHOUT A TRANSACTION ID,         CL**8
00545 *  DEPENDING ON THE SETTING OF A STANDARD COMMAREA SWITCH.  IF       CL**8
00546 *  ANY TRANSACTION IS STARTED ON THE SAME TERMINAL DURING THE        CL**8
00547 *  EXECUTION OF THE CURRENT TRANSACTION, THE SWITCH WILL BE SET      CL**8
00548 *  TO RETURN WITHOUT TRANSACTION ID TO TERMINATE THE CURRENT         CL**8
00549 *  TRANSACTION.                                                      CL**8
00550 *                                                                    CL**8
00551                                                                      CL**8
00552  DP003-0000-RETURN-TO-CICS.                                          CL**8
00553          EXEC CICS                                                   CL**8
00554              RETURN                                                  CL**8
00555          END-EXEC.                                                   CL**8
00556 *DP003-0000-EXIT.                                                    CL**8
