000100*------------------------------------------------------------     00010043
000200 IDENTIFICATION DIVISION.                                         00020043
000300*------------------------------------------------------------     00030043
000400 PROGRAM-ID.    EPKUT203.                                         00040043
000500 AUTHOR.        MEDHA CHOUDHURY.                                  00050043
000600 DATE-WRITTEN.  NOVEMBER 13, 2007.                                00060043
000700                                                                  00070043
000800*------------------------------------------------------------     00080043
000900*     NEXT/FUTURE DAY AND CORRECTIONS FILE HEADER FORMATTER       00090043
001000*       OFFERS PROCESSING.                                        00100043
001100*------------------------------------------------------------     00110043
001200*  THIS PROGRAM WILL READ DATA FROM THE FOUR FILES CREATED        00120043
001300*  BY EPKUT202.  IT WILL CREATE HEADERS AND TRANSLATE THE DATA    00130043
001400*  APPROPRIATELY FOR THE MID TIER SERVERS.  IT WILL ALSO          00140043
001500*  CREATE AN EXCEPTIONS STORE LIST FILE.                          00150043
001600*------------------------------------------------------------     00160043
001700* HISTORY LOG:                                                    00170043
001800*                                                                 00180043
001900*------------------------------------------------------------     00190043
002000* DATE: MAY 14 2008                                               00200043
002100* WR/IR#:                                                         00210043
002200* PROGRAMMER:   MEDHA CHOUDHURY                                   00220043
002300* DESCRIPTION: INCREASED THE LIMIT OF THE INTERNAL TABLES, FOR    00230043
002400*            PV-BWP-HOLD-TABLE, LIMIT WAS INCREASED FROM 12 TO 50000240043
002410*            FOR TABLE PV-MDSE-HOLD-TABLE THE LIMIT WAS INCREASED 00241043
002420*            FROM 50 TO 5000.                                     00242043
002500*------------------------------------------------------------     00243043
002600 ENVIRONMENT DIVISION.                                            00244043
002700*------------------------------------------------------------     00245043
002800 CONFIGURATION SECTION.                                           00246043
002900 SOURCE-COMPUTER. IBM-3090.                                       00247043
003000 OBJECT-COMPUTER. IBM-3090.                                       00248043
003100                                                                  00249043
003200 INPUT-OUTPUT SECTION.                                            00250043
003300                                                                  00260043
003400 FILE-CONTROL.                                                    00270043
003500                                                                  00280043
003600     SELECT OFFERS-DATA-FILE                                      00290043
003700       ASSIGN TO INP01.                                           00300043
003800                                                                  00310043
003900     SELECT OFFERS-SECTION-FILE                                   00320043
004000       ASSIGN TO INP02.                                           00330043
004100                                                                  00340043
004200     SELECT OFFERS-BWP-FILE                                       00350043
004300       ASSIGN TO INP03.                                           00360043
004400                                                                  00370043
004500     SELECT OFFERS-MDSE-FILE                                      00380043
004600       ASSIGN TO INP04.                                           00390043
004700                                                                  00400043
004800     SELECT CC-FUT-OFFSET-FILE                                    00410043
004900       ASSIGN TO INP05.                                           00420043
005000                                                                  00430043
005100     SELECT STORE-LIST-FILE                                       00440043
005200       ASSIGN TO INP06.                                           00450043
005300                                                                  00460043
005400     SELECT FORMATTED-OFFERS-FILE                                 00470043
005500       ASSIGN TO OUT01.                                           00480043
005600                                                                  00490043
005700     SELECT EXCEPTION-STORE-LIST-FILE                             00500043
005800       ASSIGN TO OUT02.                                           00510043
005900                                                                  00520043
006000*-------------------------------------------------------------    00530043
006100 DATA DIVISION.                                                   00540043
006200*-------------------------------------------------------------    00550043
006300 FILE SECTION.                                                    00560043
006400                                                                  00570043
006500 FD  OFFERS-DATA-FILE                                             00580043
006600     RECORDING MODE IS F                                          00590043
006700     LABEL RECORDS ARE STANDARD                                   00600043
006710     BLOCK CONTAINS 0 RECORDS                                     00610043
006800     DATA RECORD IS OFFERS-DATA-RECORD.                           00620043
006900                                                                  00630043
007000 01  OFFERS-DATA-RECORD                            PIC X(160).    00640043
007100* COPYBOOK IS EPRD201                                             00650043
007200                                                                  00660043
007300 FD  OFFERS-SECTION-FILE                                          00670043
007400     RECORDING MODE IS F                                          00680043
007500     LABEL RECORDS ARE STANDARD                                   00690043
007510     BLOCK CONTAINS 0 RECORDS                                     00700043
007600     DATA RECORD IS OFFERS-SECTION-RECORD.                        00710043
007700                                                                  00720043
007800 01  OFFERS-SECTION-RECORD                          PIC X(120).   00730043
007900* COPYBOOK IS EPRD202                                             00740043
008000                                                                  00750043
008100 FD  OFFERS-BWP-FILE                                              00760043
008200     RECORDING MODE IS F                                          00770043
008300     LABEL RECORDS ARE STANDARD                                   00780043
008310     BLOCK CONTAINS 0 RECORDS                                     00790043
008400     DATA RECORD IS OFFERS-BWP-RECORD.                            00800043
008500                                                                  00810043
008600 01  OFFERS-BWP-RECORD                              PIC X(110).   00820043
008700* COPYBOOK IS EPRD203                                             00830043
008800                                                                  00840043
008900 FD  OFFERS-MDSE-FILE                                             00850043
009000     RECORDING MODE IS F                                          00860043
009100     LABEL RECORDS ARE STANDARD                                   00870043
009110     BLOCK CONTAINS 0 RECORDS                                     00880043
009200     DATA RECORD IS OFFERS-MDSE-RECORD.                           00890043
009300                                                                  00900043
009400 01  OFFERS-MDSE-RECORD                             PIC X(90).    00910043
009500* COPYBOOK IS EPRD204                                             00920043
009600                                                                  00930043
009700 FD  CC-FUT-OFFSET-FILE                                           00940043
009800     RECORDING MODE IS F                                          00950043
009900     LABEL RECORDS ARE STANDARD                                   00960043
009910     BLOCK CONTAINS 0 RECORDS                                     00970043
010000     DATA RECORD IS CONTROL-FILE-RECORD.                          00980043
010100                                                                  00990043
010200 01  CONTROL-FILE-RECORD                           PIC X(80).     01000043
010300* COPYBOOK IS EPRD252                                             01010043
010500                                                                  01020043
010600 FD  STORE-LIST-FILE                                              01030043
010700     RECORDING MODE IS F                                          01040043
010800     LABEL RECORDS ARE STANDARD                                   01050043
010810     BLOCK CONTAINS 0 RECORDS                                     01060043
010900     DATA RECORDS ARE STORE-LIST-RECORD.                          01070043
011000                                                                  01080043
011100 01  STORE-LIST-RECORD                             PIC X(50).     01090043
011200* COPYBOOK IS EPRD206                                             01100043
011300                                                                  01110043
011400 FD  FORMATTED-OFFERS-FILE                                        01120043
011500     RECORDING MODE IS V                                          01130043
011600     RECORD IS VARYING IN SIZE                                    01140043
011700     FROM 1 TO 200 CHARACTERS                                     01150043
011800     DEPENDING ON PV-BYTE-COUNT                                   01160043
011900     LABEL RECORDS ARE STANDARD                                   01170043
012000     DATA RECORD IS FORMATTED-OFFERS-RECORD.                      01180043
012100                                                                  01190043
012200 01  FORMATTED-OFFERS-RECORD.                                     01200043
012300     05  FORM-OFR-FLD                  PIC X(01)                  01210043
012400         OCCURS 200 TIMES                                         01220043
012500              INDEXED BY                                          01230043
012600              FORM-OFR-LEN.                                       01240043
012610* COPYBOOK FOR HEADERS IS EPRD200                                 01250043
012700                                                                  01260043
012800 FD  EXCEPTION-STORE-LIST-FILE                                    01270043
012900     RECORDING MODE IS F                                          01280043
013000     LABEL RECORDS ARE STANDARD                                   01290043
013100     DATA RECORD IS EXCEPTION-STORE-LIST-RECORD.                  01300043
013200                                                                  01310043
013300 01  EXCEPTION-STORE-LIST-RECORD                   PIC X(21).     01320043
013400* COPYBOOK IS EPRD207                                             01330043
013500                                                                  01340043
013600*------------------------------------------------------------     01350043
013700 WORKING-STORAGE SECTION.                                         01360043
013800*------------------------------------------------------------     01370043
013900 01  AC-ABEND-CODE                  PIC S9(04) VALUE ZERO         01380043
014000                                               COMP SYNC.         01390043
014200     88  AC-4013-DB2-ERROR                     VALUE +4013.       01400043
014300     88  AC-4003-INPUT-CONTROL-CARD-ERR        VALUE +4003.       01410043
014301     88  AC-4004-TABLE-OVERFLOW-ERR            VALUE +4004.       01420043
014310     88  AC-4008-INPUT-FILE-EMPTY              VALUE +4008.       01430043
014400     88  AC-4019-CALENDAR-ROUTINE-ERROR        VALUE +4019.       01440043
014500                                                                  01450043
014600*------------------------------------------------------------     01460043
014700* PC- PROGRAM CONSTANTS                                           01470043
014800*------------------------------------------------------------     01480043
014900 01  PC-PROGRAM-CONSTANTS.                                        01490043
015000     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT203'. 01500043
015100     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   01510043
015200     05  PC-CSV-DELIMITER             PIC X(01) VALUE '|'.        01520043
015300     05  PC-TIME-START                PIC X(08) VALUE '00:00:01'. 01530043
015400     05  PC-TIME-END                  PIC X(08) VALUE '23:59:59'. 01540043
015500     05  PC-NULL-VALUE                PIC X(01) VALUE '~'.        01550043
015600     05  PC-ONE-SPACE                 PIC X(01) VALUE ' '.        01560043
015700     05  PC-ONE-ZERO                  PIC X(01) VALUE '0'.        01570043
015710     05  PC-OFR-TBL-MAX               PIC S9(04) VALUE +1 COMP.   01571043
015720     05  PC-SEC-TBL-MAX               PIC S9(04) VALUE +2 COMP.   01572043
015730     05  PC-BWP-TBL-MAX               PIC S9(04) VALUE +500 COMP. 01573043
015740     05  PC-MDSE-TBL-MAX              PIC S9(04) VALUE +5000 COMP.01574043
015800                                                                  01575043
015900*------------------------------------------------------------     01576043
016000* PS- PROGRAM-SWITCHES.                                           01577043
016100*------------------------------------------------------------     01578043
016200 01  PS-PROGRAM-SWITCHES.                                         01579043
016300                                                                  01580043
016400     05  PS-END-OF-OFR-SW             PIC  X(01) VALUE 'N'.       01590043
016500         88  PS-END-OFR-FILE                     VALUE 'Y'.       01600043
016600         88  PS-NOT-END-OFR-FILE                 VALUE 'N'.       01610043
016700     05  PS-END-OF-SEC-SW             PIC  X(01) VALUE 'N'.       01620043
016800         88  PS-END-SEC-FILE                     VALUE 'Y'.       01630043
016900         88  PS-NOT-END-SEC-FILE                 VALUE 'N'.       01640043
017000     05  PS-END-OF-BWP-SW             PIC  X(01) VALUE 'N'.       01650043
017100         88  PS-END-BWP-FILE                     VALUE 'Y'.       01660043
017200         88  PS-NOT-END-BWP-FILE                 VALUE 'N'.       01670043
017300     05  PS-END-OF-MDSE-SW            PIC  X(01) VALUE 'N'.       01680043
017400         88  PS-END-OF-MDSE-FILE                 VALUE 'Y'.       01690043
017500         88  PS-NOT-END-OF-MDSE-FILE             VALUE 'N'.       01700043
017600     05  PS-END-OF-STORE-SW           PIC  X(01) VALUE 'N'.       01710043
017700         88  PS-END-OF-STORE-FILE                VALUE 'Y'.       01720043
017800         88  PS-NOT-END-OF-STORE-FILE            VALUE 'N'.       01730043
017900     05  PS-END-OF-CNTRL-SW           PIC  X(01) VALUE 'N'.       01740043
018000         88  PS-END-OF-CNTRL-FILE                VALUE 'Y'.       01750043
018100         88  PS-NOT-END-OF-CNTRL-FILE            VALUE 'N'.       01760043
018200                                                                  01770043
018300     05  PS-OFFER-HEADER-STATUS-SW     PIC X(01)  VALUE 'Y'.      01780043
018400         88  PS-OFFER-HDR-WRITEN                  VALUE 'Y'.      01790043
018500         88  PS-OFFER-HDR-NOT-WRITEN              VALUE 'N'.      01800043
018600                                                                  01810043
018700     05  PS-SECTN-HEADER-STATUS-SW     PIC X(01)  VALUE 'Y'.      01820043
018800         88  PS-SECTN-HDR-WRITEN                  VALUE 'Y'.      01830043
018900         88  PS-SECTN-HDR-NOT-WRITEN              VALUE 'N'.      01840043
019000                                                                  01850043
019100     05  PS-BWP-HEADER-STATUS-SW       PIC X(01)  VALUE 'Y'.      01860043
019200         88  PS-BWP-HDR-WRITEN                    VALUE 'Y'.      01870043
019300         88  PS-BWP-HDR-NOT-WRITEN                VALUE 'N'.      01880043
019400                                                                  01890043
019500     05  PS-MDSE-HEADER-STATUS-SW      PIC X(01)  VALUE 'Y'.      01900043
019600         88  PS-MDSE-HDR-WRITEN                   VALUE 'Y'.      01910043
019700         88  PS-MDSE-HDR-NOT-WRITEN               VALUE 'N'.      01920043
019800                                                                  01930043
019900     05  PS-END-OF-PROCES-SW           PIC  X(01) VALUE 'N'.      01940043
020000         88  PS-END-OF-PROCESSING                 VALUE 'Y'.      01950043
020100         88  PS-NOT-END-OF-PROCESSING             VALUE 'N'.      01960043
020200                                                                  01970043
020300     05  PS-END-OF-STR-OFR-PROCES-SW   PIC  X(01) VALUE 'N'.      01980043
020400         88  PS-ALL-STR-OFR-PROCESSED             VALUE 'Y'.      01990043
020500         88  PS-NOT-ALL-STR-OFR-PROCESSED         VALUE 'N'.      02000043
020600                                                                  02010043
020700     05  PS-EXCEPTION-STRE-PROCES-SW   PIC  X(01) VALUE 'N'.      02020043
020800         88  PS-EXCEPTN-STR-EXISTS                VALUE 'Y'.      02030043
020900         88  PS-NO-EXCEPTN-STR-EXISTS             VALUE 'N'.      02040043
021000                                                                  02050043
021100     05  PS-DATE-ROUTINE-2-SW      PIC  X(01) VALUE 'N'.          02060043
021200         88  PS-DATE-VALID                    VALUE 'Y'.          02070043
021300         88  PS-DATE-NOT-VALID                VALUE 'N'.          02080043
021400                                                                  02090043
021500*------------------------------------------------------------     02100043
021600* PV- PROGRAM VARIABLES                                           02110043
021700*------------------------------------------------------------     02120043
021800 01  PV-PROGRAM-VARIABLES.                                        02130043
021900     05  PV-FORMATTED-OFFERS-COUNT     PIC 9(03)  VALUE 0.        02140043
022000     05  PV-OUTPUT-TABLE-COUNT         PIC 9(03)  VALUE 0.        02150043
022100     05  PV-SQL-SUB                    PIC S9(04) VALUE 0.        02160043
022200                                                                  02170043
022300     05  PV-SAVE-PREV-TIMESTAMP        PIC X(26) VALUE SPACES.    02180043
022400     05  PV-TIMESTAMP                  PIC X(26) VALUE SPACES.    02190043
022500     05  PV-CURRENT-TMST REDEFINES     PV-TIMESTAMP.              02200043
022600         10  PV-CURR-YYYY              PIC 9(04).                 02210043
022700         10  FILLER                    PIC X(01).                 02220043
022800         10  PV-CURR-MO                PIC 9(02).                 02230043
022900         10  FILLER                    PIC X(01).                 02240043
023000         10  PV-CURR-DD                PIC 9(02).                 02250043
023100         10  FILLER                    PIC X(01).                 02260043
023200         10  PV-CURR-HH                PIC 9(02).                 02270043
023300         10  FILLER                    PIC X(01).                 02280043
023400         10  PV-CURR-MM                PIC 9(02).                 02290043
023500         10  FILLER                    PIC X(01).                 02300043
023600         10  PV-CURR-SS                PIC 9(02).                 02310043
023700         10  FILLER                    PIC X(01).                 02320043
023800         10  PV-CURR-SSSSSS            PIC 9(06).                 02330043
023900                                                                  02340043
024000     05  PV-HEADER-TMST.                                          02350043
024100         10  PV-HEADER-YYYY            PIC 9(04)  VALUE ZERO.     02360043
024200         10  PV-HEADER-MO              PIC 9(02)  VALUE ZERO.     02370043
024300         10  PV-HEADER-DD              PIC 9(02)  VALUE ZERO.     02380043
024400         10  PV-HEADER-HH              PIC 9(02)  VALUE ZERO.     02390043
024500         10  PV-HEADER-MM              PIC 9(02)  VALUE ZERO.     02400043
024600         10  PV-HEADER-SS              PIC 9(02)  VALUE ZERO.     02410043
024700                                                                  02420043
024800     05  PV-FORMAT-HDR-DIST-DTE.                                  02430043
024900         10  PV-FORMAT-YYYY            PIC X(04).                 02440043
025000         10  PV-FORMAT-MM              PIC X(02).                 02450043
025100         10  PV-FORMAT-DD              PIC X(02).                 02460043
025200                                                                  02470043
025300     05  PV-INPUT-FUT-CC-DTE.                                     02480043
025400         10  PV-FUT-CC-YYYY            PIC X(04).                 02490043
025500         10  PV-FUT-CC-DASH-1          PIC X(01)  VALUE '-'.      02500043
025600         10  PV-FUT-CC-MM              PIC X(02).                 02510043
025700         10  PV-FUT-CC-DASH-2          PIC X(01)  VALUE '-'.      02520043
025800         10  PV-FUT-CC-DD              PIC X(02).                 02530043
025900                                                                  02540043
026000     05  PV-FORMAT-EFFECTIVE-DTE.                                 02550043
026100         10  PV-EFFECT-YYYY            PIC X(04).                 02560043
026200         10  PV-EFFECT-DASH-1          PIC X(01)  VALUE '-'.      02570043
026300         10  PV-EFFECT-MM              PIC X(02).                 02580043
026400         10  PV-EFFECT-DASH-2          PIC X(01)  VALUE '-'.      02590043
026500         10  PV-EFFECT-DD              PIC X(02).                 02600043
026600         10  PV-EFFECT-SPCE-1          PIC X(01)  VALUE ' '.      02610043
026700         10  PV-EFFECT-TIME            PIC X(08).                 02620043
026800                                                                  02630043
026900     05  PV-EFF-WORK-DTE.                                         02640043
027000         10  PV-EFF-WORK-YYYY          PIC X(04).                 02650043
027100         10  PV-EFF-WORK-MM            PIC X(02).                 02660043
027200         10  PV-EFF-WORK-DD            PIC X(02).                 02670043
027300                                                                  02680043
027400     05  PV-FORMAT-EVNT-OFFR.                                     02690043
027500         10  PV-FORMAT-EVENT-ID        PIC 9(10).                 02700043
027600         10  PV-FORMAT-OFFER-ID        PIC 9(10).                 02710043
027700                                                                  02720043
027800     05  PV-PARAGRAPH-NAME             PIC X(30)  VALUE SPACES.   02730043
027900     05  PV-DB2-OPERATION              PIC X(10)  VALUE SPACES.   02740043
028000     05  PV-OPERATION-MSG-1            PIC X(40)  VALUE SPACES.   02750043
028100     05  PV-OPERATION-MSG-2            PIC X(40)  VALUE SPACES.   02760043
028200     05  PV-FILE-TYPE                  PIC X(03)  VALUE SPACES.   02770043
028300     05  PV-TRIGGER-TYPE               PIC X(01)  VALUE SPACES.   02780043
028400     05  PV-QUOTIENT                   PIC 9(04)  VALUE ZERO.     02790043
028500     05  PV-RMDR-4                     PIC 9(04)  VALUE ZERO.     02800043
028600     05  PV-RMDR-100                   PIC 9(04)  VALUE ZERO.     02810043
028700     05  PV-FILE-NAME-TYPE             PIC X(03)  VALUE SPACES.   02820043
028800                                                                  02830043
028900     05  PV-SL001-KEY.                                            02840043
029000         10  PV-SL001-ADD-DLT-FLG      PIC X(01)  VALUE SPACES.   02850043
029100         10  PV-SL001-EVENT-ID         PIC 9(10)  VALUE 0.        02860043
029200         10  PV-SL001-OFFER-ID         PIC 9(10)  VALUE 0.        02870043
029300         10  PV-SL001-OFR-SECT-TYP-CDE                            02880043
029400                                       PIC X(01)  VALUE SPACES.   02890043
029500         10  PV-SL001-STR-GRP-TYP-CDE  PIC 9(05)  VALUE 0.        02900043
029600         10  PV-SL001-STR-GRP-ID       PIC 9(05)  VALUE 0.        02910043
029700         10  PV-SL001-IE-IND           PIC X(01)  VALUE SPACES.   02920043
029800                                                                  02930043
029900     05  PV-SL002-KEY.                                            02940043
030000         10  PV-SL002-ADD-DLT-FLG      PIC X(01)  VALUE SPACES.   02950043
030100         10  PV-SL002-EVENT-ID         PIC 9(10)  VALUE 0.        02960043
030200         10  PV-SL002-OFFER-ID         PIC 9(10)  VALUE 0.        02970043
030300         10  PV-SL002-OFR-SECT-TYP-CDE                            02980043
030400                                       PIC X(01)  VALUE SPACES.   02990043
030500         10  PV-SL002-STR-GRP-TYP-CDE  PIC 9(05)  VALUE 0.        03000043
030600         10  PV-SL002-STR-GRP-ID       PIC 9(05)  VALUE 0.        03010043
030700         10  PV-SL002-IE-IND           PIC X(01)  VALUE SPACES.   03020043
030800                                                                  03030043
030900     05  PV-CURR-OFFER-STORE-KEY.                                 03040043
031000         10  PV-CURR-ADD-DLT-FLG       PIC X(01)  VALUE SPACES.   03050043
031100         10  PV-CURR-EVENT-ID          PIC 9(10)  VALUE ZERO.     03060043
031200         10  PV-CURR-OFFER-ID          PIC 9(10)  VALUE ZERO.     03070043
031300         10  PV-CURR-OFR-SECT-TYP-CDE                             03080043
031400                                       PIC X(01)  VALUE SPACES.   03090043
031500         10  PV-CURR-STR-GRP-TYP-CDE   PIC 9(05).                 03100043
031600         10  PV-CURR-STR-GRP-ID        PIC 9(05).                 03110043
031700                                                                  03120043
031800     05  PV-EXCEPTION-COUNTER          PIC 9(05)  VALUE ZERO.     03130043
031900                                                                  03140043
032000     05  PV-SAVE-EXCEPTION-COUNTER     PIC 9(05)  VALUE ZERO.     03150043
032100                                                                  03160043
032200     05  PV-FILE-VAR-LENGTH            PIC 9(04)  VALUE ZERO.     03170043
032300                                                                  03180043
032400     05  PV-SPACE                      PIC X(01)  VALUE SPACE.    03190043
032500                                                                  03200043
032600     05  PV-DECIMAL-DISPLAY-GROUP.                                03210043
032700         10  PV-DDG-9FOR7D             PIC 9(07).99.              03220043
032800         10  PV-DDG-9FOR3ND            PIC 9(03)  VALUE 0.        03230043
032900         10  PV-DDG-9FOR4ND            PIC 9(04)  VALUE 0.        03240043
033000         10  PV-DDG-9FOR5ND            PIC 9(05)  VALUE 0.        03250043
033100         10  PV-DDG-9FOR8ND            PIC 9(08)  VALUE 0.        03260043
033200         10  PV-DDG-9FOR10ND           PIC 9(10)  VALUE 0.        03270043
033300                                                                  03280043
033400     05  PV-BWP-GET-DOL-OFF-AMT        PIC 9(09)  VALUE ZERO.     03290043
033410     05  PV-LOOP-CNT                   PIC 9(05)  VALUE ZERO.     03300043
033500     05  PV-TALLY                      PIC 9(05)  VALUE ZERO.     03310043
033600                                                                  03320043
033700     05  PV-SAVE-VARIABLES.                                       03330043
033800         10  PV-SAVE-OFR-SECT-TYP-CDE  PIC X(01)  VALUE SPACES.   03340043
033900         10  PV-SAVE-OFR-SECT-BWP-ID   PIC 9(10)  VALUE ZEROES.   03350043
034000         10  PV-SAVE-STR-GRP-TYP-CDE   PIC 9(05)  VALUE ZERO.     03360043
034100         10  PV-SAVE-STR-GRP-ID        PIC 9(05)  VALUE ZERO.     03370043
034200                                                                  03380043
034300     05  PV-BYTE-COUNT                 PIC 9(04)  VALUE ZEROES.   03390043
034400                                                                  03400043
034500     05  PV-CONVERT-TO-BINARY-FIELDS.                             03410043
034600         10  PV-REC-LENGTH-BINARY      PIC 9(04)  COMP VALUE 0.   03420043
034700         10  PV-REC-LENGTH-CHAR REDEFINES                         03430043
034800               PV-REC-LENGTH-BINARY    PIC X(02).                 03440043
034900                                                                  03450043
035000     05  PV-VARIABLE-OUTPUT-FIELD.                                03460043
035100         10  PV-BIT-VARIABLE           PIC X(01)                  03470043
035200                                           VALUE SPACES           03480043
035300                                           OCCURS 50 TIMES        03490043
035400                                           INDEXED BY             03500043
035500                                           PV-BIT-IDX             03510043
035600                                           PV-STR-IDX             03520043
035700                                           PV-EOF-IDX.            03530043
035800                                                                  03540043
035900     05  PV-VARIABLE-OUTPUT-CODE.                                 03550043
036000         10  PV-BIT-CODE              PIC X(01)                   03560043
036100                                          VALUE SPACES            03570043
036200                                          OCCURS 3 TIMES          03580043
036300                                          INDEXED BY              03590043
036400                                          PV-CDE-BIT-IDX          03600043
036500                                          PV-CDE-STR-IDX          03610043
036600                                          PV-CDE-EOF-IDX.         03620043
036700                                                                  03630043
036800     05  PV-VARIABLE-ID.                                          03640043
036900         10 PV-EFBM-VAR               PIC X(01)                   03650043
037000                                          VALUE SPACES            03660043
037100                                          OCCURS 10 TIMES         03670043
037200                                          INDEXED BY              03680043
037300                                          PV-EFBM-BIT-IDX         03690043
037400                                          PV-EFBM-IDX.            03700043
037500     05  PV-WORK-DATE.                                            03710043
037600         10  PV-WORK-YYYY              PIC 9(04) VALUE 0.         03720043
037700         10  PV-WORK-MO                PIC 9(02) VALUE 0.         03730043
037800         10  PV-WORK-DD                PIC 9(02) VALUE 0.         03740043
037900                                                                  03750043
038000     05  PV-FORMATTED-DATE.                                       03760043
038100         10  PV-FORMATTED-DATE-YYYY    PIC X(04) VALUE SPACES.    03770043
038200         10  PV-FORMATTED-DATE-DASH-1  PIC X(01) VALUE '-'.       03780043
038300         10  PV-FORMATTED-DATE-MO      PIC X(02) VALUE SPACES.    03790043
038400         10  PV-FORMATTED-DATE-DASH-2  PIC X(01) VALUE '-'.       03800043
038500         10  PV-FORMATTED-DATE-DD      PIC X(02) VALUE SPACES.    03810043
038600         10  PV-FORMATTED-DATE-SPACE-1 PIC X(01) VALUE SPACE.     03820043
038700         10  PV-FORMATTED-DATE-TIME    PIC X(08) VALUE SPACES.    03830043
038800                                                                  03840043
038900 01  PV-PROGRAM-COUNTERS.                                         03850043
039000                                                                  03860043
039100     05  PV-OFFER-REC-IN-CNT           PIC 9(05) VALUE 0.         03870043
039200     05  PV-SECTION-REC-IN-CNT         PIC 9(05) VALUE 0.         03880043
039300     05  PV-BWP-REC-IN-CNT             PIC 9(05) VALUE 0.         03890043
039400     05  PV-MDSE-REC-IN-CNT            PIC 9(05) VALUE 0.         03900043
039500     05  PV-CNTRL-REC-IN-CNT           PIC 9(05) VALUE 0.         03910043
039600     05  PV-OFFER-HDR-OUT-CNT          PIC 9(05) VALUE 0.         03920043
039700     05  PV-SECTION-HDR-OUT-CNT        PIC 9(05) VALUE 0.         03930043
039800     05  PV-BWP-HDR-OUT-CNT            PIC 9(05) VALUE 0.         03940043
039900     05  PV-MDSE-HDR-OUT-CNT           PIC 9(05) VALUE 0.         03950043
040000     05  PV-OFFER-DTA-OUT-CNT          PIC 9(05) VALUE 0.         03960043
040100     05  PV-SECTION-DTA-OUT-CNT        PIC 9(05) VALUE 0.         03970043
040200     05  PV-BWP-DTA-OUT-CNT            PIC 9(05) VALUE 0.         03980043
040300     05  PV-MDSE-DTA-OUT-CNT           PIC 9(05) VALUE 0.         03990043
040400     05  PV-STORE-LIST-REC-IN-CNT      PIC 9(05) VALUE 0.         04000043
040500     05  PV-STORE-EXCP-REC-OUT-CNT     PIC 9(05) VALUE 0.         04010043
040600     05  PV-ENTRY-COUNT                PIC 9(05) VALUE 0.         04020043
040610     05  PV-PIPE-COUNT                 PIC 9(04) VALUE 0.         04030043
040700                                                                  04040043
040800 01  PV-OFFER-HOLD-TABLE.                                         04050043
040900     10  PV-OFFER-RECORD               OCCURS 1 TIMES             04060043
041000                                       INDEXED BY                 04070043
041100                                       PV-OFFER-COUNT.            04080043
041200         15  PV-OFFER-DATA             PIC X(160) VALUE SPACES.   04090043
041300                                                                  04100043
041400 01  PV-SECTION-HOLD-TABLE.                                       04110043
041500     10  PV-SECTION-RECORD             OCCURS 2 TIMES             04120043
041600                                       INDEXED BY                 04130043
041700                                       PV-SECTN-COUNT.            04140043
041800         15  PV-SECTION-DATA           PIC X(120) VALUE SPACES.   04150043
041900                                                                  04160043
042000 01  PV-BWP-HOLD-TABLE.                                           04170043
042100     10  PV-BWP-RECORD                 OCCURS 500 TIMES           04180043
042200                                       INDEXED BY                 04190043
042300                                       PV-BWP-COUNT.              04200043
042400         15  PV-BWP-DATA               PIC X(110) VALUE SPACES.   04210043
042500                                                                  04220043
042600 01  PV-MDSE-HOLD-TABLE.                                          04230043
042700     10  PV-MDSE-RECORD                OCCURS 5000 TIMES          04240043
042800                                       INDEXED BY                 04250043
042900                                       PV-MDSE-COUNT.             04260043
043000         15  PV-MDSE-DATA              PIC X(90) VALUE SPACES.    04270043
043100                                                                  04280043
043200*----------------------------------------------------------       04290043
043300* DATE ROUTINE COPY MEMBERS                                       04300043
043400*----------------------------------------------------------       04310043
043500     COPY DPWS500.                                                04320043
043600                                                                  04330043
043700*------------------------------------------------------------     04340043
043800* COPYBOOK FOR OFFERS-DATA-FILE                                   04350043
043900*------------------------------------------------------------     04360043
044000     COPY EPRD201.                                                04370043
044100                                                                  04380043
044200*------------------------------------------------------------     04390043
044300* COPYBOOK FOR OFFER-SECTION-FILE                                 04400043
044400*------------------------------------------------------------     04410043
044500     COPY EPRD202.                                                04420043
044600                                                                  04430043
044700*------------------------------------------------------------     04440043
044800* COPYBOOK FOR OFFER-BWP-FILE                                     04450043
044900*------------------------------------------------------------     04460043
045000     COPY EPRD203.                                                04470043
045100                                                                  04480043
045200*------------------------------------------------------------     04490043
045300* COPYBOOK FOR OFFER-MDSE-FILE                                    04500043
045400*------------------------------------------------------------     04510043
045500     COPY EPRD204.                                                04520043
045600                                                                  04530043
045700*------------------------------------------------------------     04540043
045800* COPYBOOK FOR OFFERS-DATA-FILE  (THIS DEFINITION WILL BE         04550043
045900* USED AS PROGRAM VARIABLES)                                      04560043
046000*------------------------------------------------------------     04570043
046100     COPY EPRD201 REPLACING EP201 BY PV201.                       04580043
046200                                                                  04590043
046300*------------------------------------------------------------     04600043
046400* COPYBOOK FOR OFFER-SECTION-FILE                                 04610043
046500*------------------------------------------------------------     04620043
046600     COPY EPRD202 REPLACING EP202 BY PV202.                       04630043
046700                                                                  04640043
046800*------------------------------------------------------------     04650043
046900* COPYBOOK FOR OFFER-BWP-FILE                                     04660043
047000*------------------------------------------------------------     04670043
047100     COPY EPRD203 REPLACING EP203 BY PV203.                       04680043
047200                                                                  04690043
047300*------------------------------------------------------------     04700043
047400* COPYBOOK FOR OFFER-MDSE-FILE                                    04710043
047500*------------------------------------------------------------     04720043
047600     COPY EPRD204 REPLACING EP204 BY PV204.                       04730043
047700                                                                  04740043
047800*------------------------------------------------------------     04750043
047900* COPYBOOK FOR NEXT/FUTURE DAY OFFER                              04760043
048000*  AND CORRECTIONS CONTROL CARD                                   04770043
048100*------------------------------------------------------------     04780043
048200     COPY EPRD252.                                                04790043
048300                                                                  04800043
048400*------------------------------------------------------------     04810043
048500* COPYBOOK FOR STORE LIST FILE                                    04820043
048700*------------------------------------------------------------     04830043
048800     COPY EPRD206.                                                04840043
048900                                                                  04850043
049000*------------------------------------------------------------     04860043
049100* COPYBOOK FOR EXCEPTION STORE LIST FILE                          04870043
049200*------------------------------------------------------------     04880043
049300     COPY EPRD207.                                                04890043
049400                                                                  04900043
049500*------------------------------------------------------------     04910043
049600* COPYBOOK FOR HEADER RECORD                                      04920043
049700*------------------------------------------------------------     04930043
049800     COPY EPRD200.                                                04940043
049900                                                                  04950043
050000*------------------------------------------------------------     04960043
050100* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         04970043
050200*------------------------------------------------------------     04980043
050300     COPY DPWS004.                                                04990043
050400                                                                  05000043
050500*------------------------------------------------------------     05010043
050600*  DB2 ABEND COPYBOOK                                             05020043
050700*------------------------------------------------------------     05030043
050800     COPY SQLCA2.                                                 05040043
050900                                                                  05050043
051000*------------------------------------------------------------     05060043
051100*  DB2 COMMUNICATIONS AREA.                                       05070043
051200*------------------------------------------------------------     05080043
051300     EXEC SQL                                                     05090043
051400         INCLUDE SQLCA                                            05100043
051500     END-EXEC.                                                    05110043
051600                                                                  05120043
051700*------------------------------------------------------------     05130043
051800 PROCEDURE DIVISION.                                              05140043
051900*------------------------------------------------------------     05150043
052000 0000-MAINLINE.                                                   05160043
052100                                                                  05170043
052200     PERFORM 1000-INITIALIZE.                                     05180043
052300                                                                  05190043
052400     PERFORM 2000-PROCESS-OFFERS                                  05200043
052500            UNTIL PS-END-OF-PROCESSING.                           05210043
052600                                                                  05220043
052700     PERFORM 9200-WRAPUP.                                         05230043
052800                                                                  05240043
052900     GOBACK.                                                      05250043
053000                                                                  05260043
053100*0000-EXIT.                                                       05270043
053200 EJECT.                                                           05280043
053300                                                                  05290043
053400*-------------------------------------------------------------    05300043
053500* 1000-INITIALIZE.                                                05310043
053600*     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS           05320043
053700*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      05330043
053800*     FILES.                                                      05340043
053900*-------------------------------------------------------------    05350043
054000 1000-INITIALIZE.                                                 05360043
054100     MOVE '1000-INITIALIZE               '                        05370043
054200       TO PV-PARAGRAPH-NAME.                                      05380043
054400                                                                  05390043
054410     DISPLAY '****************************************'.          05400043
054420     DISPLAY '**          EPKUT203 STARTED          **'.          05410043
054450     DISPLAY '****************************************'.          05420043
054460                                                                  05430043
054500     INITIALIZE EP201-OFFER-XST-OFR-RECORD                        05440043
054600                EP202-OFFER-XST-OFR-SECT-RCD                      05450043
054700                EP203-OFFER-XST-BWP-RECORD                        05460043
054800                EP204-OFFER-XST-OFR-MDSE-SET                      05470043
054900                EP206-STORE-LIST-RCD.                             05480043
055000                                                                  05490043
055100     OPEN INPUT                                                   05500043
055200         OFFERS-DATA-FILE                                         05510043
055300         OFFERS-SECTION-FILE                                      05520043
055400         OFFERS-BWP-FILE                                          05530043
055500         OFFERS-MDSE-FILE                                         05540043
055600         CC-FUT-OFFSET-FILE                                       05550043
055700         STORE-LIST-FILE.                                         05560043
055800                                                                  05570043
055900     OPEN OUTPUT                                                  05580043
056000         FORMATTED-OFFERS-FILE                                    05590043
056100         EXCEPTION-STORE-LIST-FILE.                               05600043
056200                                                                  05610043
056300     INITIALIZE PV-OFFER-HOLD-TABLE                               05620043
056400                PV-SECTION-HOLD-TABLE                             05630043
056500                PV-BWP-HOLD-TABLE                                 05640043
056600                PV-MDSE-HOLD-TABLE.                               05650043
056700                                                                  05660043
056800     SET PS-OFFER-HDR-NOT-WRITEN TO TRUE.                         05670043
056900     SET PS-SECTN-HDR-NOT-WRITEN TO TRUE.                         05680043
057000     SET PS-BWP-HDR-NOT-WRITEN TO TRUE.                           05690043
057100     SET PS-MDSE-HDR-NOT-WRITEN TO TRUE.                          05700043
057110     SET PS-NOT-END-OFR-FILE      TO TRUE.                        05710043
057120     SET PS-NOT-END-SEC-FILE      TO TRUE.                        05711043
057130     SET PS-NOT-END-BWP-FILE      TO TRUE.                        05712043
057140     SET PS-NOT-END-OF-MDSE-FILE  TO TRUE.                        05713043
057150     SET PS-NOT-END-OF-STORE-FILE TO TRUE.                        05714043
057200                                                                  05715043
057300     MOVE ZERO TO PV-EXCEPTION-COUNTER.                           05716043
057400                                                                  05717043
057500     INITIALIZE PV-PROGRAM-COUNTERS.                              05718043
057600                                                                  05719043
057700     PERFORM 1100-GET-DB2-TIMESTAMP.                              05720043
057800                                                                  05730043
057900     PERFORM 1200-READ-AND-DETERMINE-FILE.                        05740043
058000                                                                  05750043
058100*1000-EXIT.                                                       05760043
058200 EJECT.                                                           05770043
058300*----------------------------------------------------------       05780043
058400* 1100-GET-DB2-TIMESTAMP.                                         05790043
058500*     THIS PARAGRAPH GETS THE DB2 TIMESTAMP WHICH WILL BE         05800043
058600*     USED TO UPDATE THE FILE-DIST-DATE AND THE CRT-TIMESTAMP     05810043
058700*     ON THE HEADER RECORD.                                       05820043
058800*----------------------------------------------------------       05830043
058900 1100-GET-DB2-TIMESTAMP.                                          05840043
059000                                                                  05850043
059100     EXEC SQL                                                     05860043
059200          SELECT CURRENT TIMESTAMP                                05870043
059300          INTO  :PV-TIMESTAMP                                     05880043
059400          FROM   SYSIBM.SYSDUMMY1                                 05890043
059500     END-EXEC.                                                    05900043
059600                                                                  05910043
059700     IF SQLCODE NOT EQUAL ZERO                                    05920043
059800        MOVE '1100-GET-DB2-TIMESTAMP' TO PV-PARAGRAPH-NAME        05930043
059900        MOVE 'CANNOT GET CURRENT TIMESTAMP'                       05940043
060000                                    TO PV-DB2-OPERATION           05950043
060100        PERFORM 9800-SQL-ABEND                                    05960043
060200     END-IF.                                                      05970043
060300                                                                  05980043
060400*** SET UP TIMESTAMP    INFORMATION FOR HEADER                    05990043
060500                                                                  06000043
060600     MOVE PV-CURR-YYYY         TO PV-HEADER-YYYY.                 06010043
060700                                                                  06020043
060800     MOVE PV-CURR-MO           TO PV-HEADER-MO.                   06030043
060900                                                                  06040043
061000     MOVE PV-CURR-DD           TO PV-HEADER-DD.                   06050043
061100                                                                  06060043
061200     MOVE PV-CURR-HH           TO PV-HEADER-HH.                   06070043
061300                                                                  06080043
061400     MOVE PV-CURR-MM           TO PV-HEADER-MM.                   06090043
061500                                                                  06100043
061600     MOVE PV-CURR-SS           TO PV-HEADER-SS.                   06110043
061700                                                                  06120043
061800*** SET UP FILE DISTRIBUTION DATE FOR HEADER RECORD FOR CHANGE FIL06130043
061900                                                                  06140043
062000     MOVE PV-CURR-YYYY         TO PV-FORMAT-YYYY.                 06150043
062100                                                                  06160043
062200     MOVE PV-CURR-MO           TO PV-FORMAT-MM.                   06170043
062300                                                                  06180043
062400     MOVE PV-CURR-DD           TO PV-FORMAT-DD.                   06190043
062500                                                                  06200043
062600*1100-EXIT.                                                       06210043
062700 EJECT.                                                           06220043
062800                                                                  06230043
062900*----------------------------------------------------------       06240043
063000* 1200-READ-AND-DETERMINE-FILE                                    06250043
063100*     THIS PARAGRAPH READS THE FIRST RECORD FROM EACH OF THE      06260043
063200*     FOUR OFFER DATA FILES, AND SETS THE FILE-TYPE PROCESSING    06270043
063300*     VARIABLE                                                    06280043
063310*     THE FOLLOWING CASES ARE VALID AND PROGRAM SHOULD PROCEED    06290043
063320*     FURTHER:-                                                   06300043
063330*     (1) ALL FILES EMPTY                                         06310043
063340*     (2) ALL FILES HAVE DATA                                     06320043
063350*     (3) ONLY MDSE FILE AND STORE LIST FILE HAVE DATA            06330043
063351*                                                                 06331043
063360* ** PROGRAM ABENDS WHEN OFR HAS DATA BUT OTHERS DO NOT **'       06332043
063370*                                                                 06333043
063400*     THE PV-FILE-TYPE = 'NEW' FOR NEXT/FUTURE DAY                06334043
063500*     THE PV-FILE-TYPE = 'CHG' FOR CORRECTIONS                    06335043
063600*     THIS WILL HELP SET-UP THE FILE-DISTRIBUTION DATE ON HEADER  06336043
063700*     RECORD.                                                     06337043
063800*                                                                 06338043
063900*     THIS PARAGRAPH WILL SET THE PROCESSING INDICATOR IF THE     06339043
064000*     INPUT FILES ARE EMPTY                                       06340043
064100*                                                                 06350043
064200*     NEXT IF THE PV-FILE-TYPE = 'NEW' READ THE CONTROL CARD      06360043
064300*     ELSE CLOSE THE CONTROL CARD FILE.                           06370043
064400*----------------------------------------------------------       06380043
064500 1200-READ-AND-DETERMINE-FILE.                                    06390043
064600                                                                  06400043
064700     PERFORM 6100-READ-OFFER-DATA.                                06410043
064800                                                                  06420043
064900     PERFORM 6200-READ-SECTN-DATA.                                06430043
065000                                                                  06440043
065100     PERFORM 6300-READ-BWP-DATA.                                  06450043
065200                                                                  06460043
065300     PERFORM 6400-READ-MDSE-DATA.                                 06470043
065400                                                                  06480043
066300     PERFORM 6900-READ-STORE-LIST-FILE.                           06490043
066400                                                                  06500043
066410     EVALUATE TRUE                                                06510043
066420         WHEN   PS-END-OFR-FILE                                   06520043
066430          AND   PS-END-SEC-FILE                                   06530043
066440          AND   PS-END-BWP-FILE                                   06540043
066450          AND   PS-END-OF-MDSE-FILE                               06550043
066470                                                                  06570043
066480               SET PS-END-OF-PROCESSING TO TRUE                   06580043
066490                                                                  06590043
066491         WHEN   PS-NOT-END-OFR-FILE                               06600043
066492          AND   PS-NOT-END-SEC-FILE                               06610043
066493          AND   PS-NOT-END-BWP-FILE                               06620043
066494          AND   PS-NOT-END-OF-MDSE-FILE                           06630043
066495          AND   PS-NOT-END-OF-STORE-FILE                          06640043
066496                                                                  06641043
066497               SET PS-NOT-END-OF-PROCESSING TO TRUE               06642043
066498               PERFORM 5100-PROCESS-STORE-LIST                    06643043
066499                                                                  06644043
066500*--- THIS CONDITION WILL HOLD TRUE, FOR CORRECTIONS FILE WHEN     06645043
066501*--  THERE IS SINGLE DELETE TRIGGER FOR MERCHANDISE RECORD        06646043
066502                                                                  06647043
066503         WHEN   PS-END-OFR-FILE                                   06648043
066504          AND   PS-END-SEC-FILE                                   06649043
066505          AND   PS-END-BWP-FILE                                   06650043
066506          AND   PS-NOT-END-OF-MDSE-FILE                           06650143
066507          AND   PS-NOT-END-OF-STORE-FILE                          06650243
066508                                                                  06650343
066509               SET PS-NOT-END-OF-PROCESSING TO TRUE               06650443
066510               PERFORM 5100-PROCESS-STORE-LIST                    06650543
066511                                                                  06650643
066512         WHEN OTHER                                               06650743
066513                                                                  06650843
066514             DISPLAY '  '                                         06650943
066515             DISPLAY ' ERROR IN INPUT FILES SOME HAVE DATA OTHER' 06651043
066516             DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'          06651143
066517             MOVE '1200-READ-AND-DETERMINE-FILE' TO               06651243
066518                                              PV-PARAGRAPH-NAME   06651343
066519             SET AC-4008-INPUT-FILE-EMPTY  TO TRUE                06651443
066520             PERFORM 9910-ABEND                                   06651543
066521                                                                  06651643
066530     END-EVALUATE.                                                06651743
067500                                                                  06651843
067510     IF EP201-FILE-TYPE = 'NEW'                                   06651943
067520        MOVE 'NEW' TO PV-FILE-TYPE                                06652043
067530        PERFORM 1300-READ-FUT-OFFSET-CARD                         06653043
067540        PERFORM 1400-SET-FILE-DIST-DATE                           06654043
067550     ELSE                                                         06655043
067560        MOVE 'CHG' TO PV-FILE-TYPE                                06656043
067570     END-IF.                                                      06657043
067600                                                                  06658043
067700*1200-EXIT.                                                       06659043
067800 EJECT.                                                           06660043
067900                                                                  06670043
068000*----------------------------------------------------------       06680043
068100* 1300-READ-FUT-OFFSET-CARD.                                      06690043
068200*     READS IN THE FUTURE OFFSET(EPCC252) CONTROL CARD            06700043
068300*----------------------------------------------------------       06710043
068400 1300-READ-FUT-OFFSET-CARD.                                       06720043
068500                                                                  06730043
068600     READ CC-FUT-OFFSET-FILE                                      06740043
068700         INTO EP252-CC-CONTROL-CARD                               06750043
068800     AT END                                                       06760043
068900         SET PS-END-OF-CNTRL-FILE TO TRUE                         06770043
069000     NOT AT END                                                   06780043
069100         ADD 1 TO PV-CNTRL-REC-IN-CNT                             06790043
069200     END-READ.                                                    06800043
069300                                                                  06810043
069320     DISPLAY '--------------------------------------- '.          06820043
069330     DISPLAY '    INPUT EPRD252 CONTROL CARD          '.          06830043
069340     DISPLAY EP252-CC-CONTROL-CARD-DISPLY.                        06840043
069341     DISPLAY '--------------------------------------- '.          06850043
069350                                                                  06860043
069400     IF EP252-CC-FUTURE-DATE  = SPACES OR                         06870043
069500        PS-END-OF-CNTRL-FILE                                      06880043
069600          DISPLAY 'EMPTY CONTROL CARD'                            06890043
069700          DISPLAY 'FUTURE DATE: ' EP252-CC-FUTURE-DATE            06900043
069800          MOVE '1300-READ-FUT-OFFSET-CARD' TO PV-PARAGRAPH-NAME   06910043
069900          MOVE 'CONTROL CARD IS EMPTY' TO PV-OPERATION-MSG-1      06920043
070000          SET AC-4003-INPUT-CONTROL-CARD-ERR TO TRUE              06930043
070100          PERFORM 9910-ABEND                                      06940043
070200     END-IF.                                                      06950043
070300                                                                  06960043
070400     PERFORM 7000-VALIDATE-DATE-INPUT.                            06970043
070500                                                                  06980043
071300*1300-EXIT.                                                       06990043
071400 EJECT.                                                           07000043
071500                                                                  07010043
071600*----------------------------------------------------------       07020043
071700* 1400-SET-FILE-DIST-DATE.                                        07030043
071800*     IT WILL SET THE FILE DISTRIBUTION DATE TO THE NEXT          07040043
071900*     FUTURE DATE READ FROM THE CONTROL CARD EPCC252              07050043
072000*----------------------------------------------------------       07060043
072100 1400-SET-FILE-DIST-DATE.                                         07070043
072200                                                                  07080043
072300     MOVE EP252-CC-FUTURE-DATE          TO PV-INPUT-FUT-CC-DTE.   07090043
072400                                                                  07100043
072500     MOVE PV-FUT-CC-YYYY       TO PV-FORMAT-YYYY.                 07110043
072600                                                                  07120043
072700     MOVE PV-FUT-CC-MM         TO PV-FORMAT-MM.                   07130043
072800                                                                  07140043
072900     MOVE PV-FUT-CC-DD         TO PV-FORMAT-DD.                   07150043
073000                                                                  07160043
073100*1400-EXIT.                                                       07170043
073200 EJECT.                                                           07180043
073300                                                                  07190043
073400*----------------------------------------------------------       07200043
073500* 2000-PROCESS-OFFERS                                             07210043
073600*                                                                 07220043
073700*  THIS PARAGRAPH PERFORMS THE FOLLOWING                          07230043
073800*                                                                 07240043
073900* (1) RETRIEVES THE STORE LEVEL INFORMATION, WHICH WILL BE USED   07250043
074000*     TO FORMAT THE HEADER RECORDS                                07260043
074100*                                                                 07270043
074200* (2) LOAD THE CURRENT OFFERS DATA INTO TEMPORARY TABLE, THIS     07280043
074300*     WOULD ALSO IMPLY LOADING OF SECTION, BWP AND MDSE DATA INTO 07290043
074400*     TEMPORARY HOLD VARIABLES.                                   07300043
074500*                                                                 07310043
074600* (3) IT WOULD NEXT FORMAT THE RECORD FOR CURRENT STORE GROUP.    07320043
074700*     AND THE SUBSEQUENT STORES FOR THAT OFFER-ID.                07330043
074800*                                                                 07340043
074900* PLEASE NOTE:- THERE WOULD BE ONE SET OF HEADER FOR THE FOLLOWING07350043
075000*               COMBINATION                                       07360043
075100*                            OFFER ID                             07370043
075200*                            STORE GROUP TYPE CODE                07380043
075300*                            STORE GROUP ID                       07390043
075400*                                                                 07400043
075500*  IF ANY VALUE FROM THE ABOVE CHANGES, IT WILL REQUIRE THE       07410043
075600*  PROGRAM TO BUILD ANOTHER SET OF HEADERS, AND WRITE OUT ALL THE 07420043
075700*  OFFERS DATA BENEATH IT.                                        07430043
075800*                                                                 07440043
075900*----------------------------------------------------------       07450043
076000 2000-PROCESS-OFFERS.                                             07460043
076100                                                                  07470043
076200     SET PV-OFFER-COUNT TO 1.                                     07480043
076300     SET PV-SECTN-COUNT TO 1                                      07490043
076400     SET PV-BWP-COUNT   TO 1.                                     07500043
076500     SET PV-MDSE-COUNT  TO 1.                                     07510043
076600                                                                  07520043
076700     INITIALIZE PV-OFFER-HOLD-TABLE                               07530043
076800                PV-SECTION-HOLD-TABLE                             07540043
076900                PV-BWP-HOLD-TABLE                                 07550043
077000                PV-MDSE-HOLD-TABLE.                               07560043
077100                                                                  07570043
077200     PERFORM 2100-LOAD-OFFER-TABLE UNTIL                          07580043
077300          (EP201-OFFER-ID NOT = PV-CURR-OFFER-ID ) OR             07590043
077400          (EP201-TRIGGER-TYPE NOT = PV-CURR-ADD-DLT-FLG ) OR      07600043
077500          PS-END-OFR-FILE.                                        07610043
077600                                                                  07620043
077700     PERFORM 2200-LOAD-SECTION-TABLE UNTIL                        07630043
077800          (EP202-OFFER-ID NOT = PV-CURR-OFFER-ID ) OR             07640043
077900          (EP202-TRIGGER-TYPE NOT = PV-CURR-ADD-DLT-FLG ) OR      07650043
078000          PS-END-SEC-FILE.                                        07660043
078100                                                                  07670043
078200     PERFORM 2300-LOAD-BWP-TABLE UNTIL                            07680043
078300          (EP203-OFFER-ID NOT = PV-CURR-OFFER-ID ) OR             07690043
078400          (EP203-TRIGGER-TYPE NOT = PV-CURR-ADD-DLT-FLG ) OR      07700043
078500          PS-END-BWP-FILE.                                        07710043
078600                                                                  07720043
078700     PERFORM 2400-LOAD-MDSE-TABLE UNTIL                           07730043
078800          (EP204-OFFER-ID NOT = PV-CURR-OFFER-ID ) OR             07740043
078900          (EP204-TRIGGER-TYPE NOT = PV-CURR-ADD-DLT-FLG ) OR      07750043
079000          PS-END-OF-MDSE-FILE.                                    07760043
079100                                                                  07770043
079200     SET PS-NOT-ALL-STR-OFR-PROCESSED TO TRUE.                    07780043
079300                                                                  07790043
079400     PERFORM 2500-FORMAT-OFFERS UNTIL                             07800043
079500          PS-ALL-STR-OFR-PROCESSED                                07810043
079600                                                                  07820043
079620     EVALUATE TRUE                                                07830043
079630         WHEN   PS-END-OFR-FILE                                   07840043
079640          AND   PS-END-SEC-FILE                                   07850043
079650          AND   PS-END-BWP-FILE                                   07860043
079660          AND   PS-END-OF-MDSE-FILE                               07870043
079680                                                                  07890043
079690               SET PS-END-OF-PROCESSING TO TRUE                   07900043
079691                                                                  07910043
079692         WHEN   PS-NOT-END-OFR-FILE                               07920043
079693          AND   PS-NOT-END-SEC-FILE                               07930043
079694          AND   PS-NOT-END-BWP-FILE                               07940043
079695          AND   PS-NOT-END-OF-MDSE-FILE                           07950043
079696          AND   PS-NOT-END-OF-STORE-FILE                          07960043
079697                                                                  07961043
079698               SET PS-NOT-END-OF-PROCESSING TO TRUE               07962043
079700                                                                  07963043
079701         WHEN   PS-NOT-END-OFR-FILE                               07964043
079702          AND   PS-NOT-END-SEC-FILE                               07965043
079703          AND   PS-NOT-END-BWP-FILE                               07966043
079704          AND   PS-NOT-END-OF-MDSE-FILE                           07967043
079705          AND   PS-END-OF-STORE-FILE                              07968043
079706                                                                  07969043
079707             IF EP201-OFFER-ID NOT = PV-CURR-OFFER-ID             07970043
079708               DISPLAY '  '                                       07970143
079709               DISPLAY 'ERROR IN INPUT FILES - AT LEAST ONE '     07970243
079710               DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'        07970343
079711               DISPLAY ' RECORD FROM STORE FILE BEING PROCESSED :'07970443
079712                      PV-CURR-OFFER-ID                            07970543
079713               DISPLAY ' RECORD FROM OFFER FILE BEING PROCESSED :'07970643
079714                      EP201-OFFER-ID                              07970743
079715               MOVE '2000-PROCESS-OFFERS         ' TO             07970843
079716                                               PV-PARAGRAPH-NAME  07970943
079717               SET AC-4008-INPUT-FILE-EMPTY  TO TRUE              07971043
079718               PERFORM 9910-ABEND                                 07971143
079719             END-IF                                               07971243
079720                                                                  07971343
079721         WHEN   PS-END-OFR-FILE                                   07971443
079722          AND   PS-END-SEC-FILE                                   07971543
079723          AND   PS-END-BWP-FILE                                   07971643
079724          AND   PS-NOT-END-OF-MDSE-FILE                           07971743
079725          AND   PS-END-OF-STORE-FILE                              07971843
079726                                                                  07971943
079727             IF EP204-OFFER-ID NOT = PV-CURR-OFFER-ID             07972043
079728               DISPLAY '  '                                       07972143
079729               DISPLAY 'ERROR IN INPUT FILES - AT LEAST ONE '     07972243
079730               DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'        07972343
079731               DISPLAY ' RECORD FROM STORE FILE BEING PROCESSED :'07972443
079732                      PV-CURR-OFFER-ID                            07972543
079733               DISPLAY ' RECORD FROM MDSE  FILE BEING PROCESSED :'07972643
079734                      EP204-OFFER-ID                              07972743
079735               MOVE '2000-PROCESS-OFFERS         ' TO             07972843
079736                                               PV-PARAGRAPH-NAME  07972943
079737               SET AC-4008-INPUT-FILE-EMPTY  TO TRUE              07973043
079738               PERFORM 9910-ABEND                                 07973143
079739             END-IF                                               07973243
079740                                                                  07973343
079741         WHEN   PS-END-OFR-FILE                                   07973443
079742          AND   PS-END-SEC-FILE                                   07973543
079743          AND   PS-END-BWP-FILE                                   07973643
079744          AND   PS-NOT-END-OF-MDSE-FILE                           07973743
079745          AND   PS-NOT-END-OF-STORE-FILE                          07973843
079746                                                                  07973943
079747             IF EP204-OFFER-ID NOT = PV-CURR-OFFER-ID             07974043
079748               DISPLAY '  '                                       07974143
079749               DISPLAY 'ERROR IN INPUT FILES - AT LEAST ONE '     07974243
079750               DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'        07974343
079751               DISPLAY ' RECORD FROM STORE FILE BEING PROCESSED :'07974443
079752                      PV-CURR-OFFER-ID                            07974543
079753               DISPLAY ' RECORD FROM MDSE  FILE BEING PROCESSED :'07974643
079754                      EP204-OFFER-ID                              07974743
079755               MOVE '2000-PROCESS-OFFERS         ' TO             07974843
079756                                               PV-PARAGRAPH-NAME  07974943
079757               SET AC-4008-INPUT-FILE-EMPTY  TO TRUE              07975043
079758               PERFORM 9910-ABEND                                 07975143
079759             END-IF                                               07975243
079760                                                                  07975343
079767         WHEN OTHER                                               07975443
079768                                                                  07975543
079769             DISPLAY '  '                                         07975643
079770             DISPLAY ' ERROR IN INPUT FILES - AT LEAST ONE '      07975743
079771             DISPLAY ' IS EMPTY ,PROGRAM CANNOT PROCEED'          07975843
079772             DISPLAY ' RECORD FROM STORE FILE BEING PROCESSED :'  07975943
079773                      PV-CURR-OFFER-ID                            07976043
079774             DISPLAY ' RECORD FROM OFFER FILE BEING PROCESSED :'  07977043
079775                      EP201-OFFER-ID                              07977143
079776             MOVE '2000-PROCESS-OFFERS         ' TO               07977243
079777                                              PV-PARAGRAPH-NAME   07977343
079778             SET AC-4008-INPUT-FILE-EMPTY  TO TRUE                07977443
079779             PERFORM 9910-ABEND                                   07977543
079780                                                                  07977643
079781     END-EVALUATE.                                                07977743
079790                                                                  07977843
080900*2000-EXIT.                                                       07977943
081000 EJECT.                                                           07978043
081100*----------------------------------------------------------       07979043
081200* 2100-LOAD-OFFER-TABLE                                           07980043
081300*   THIS PARAGRAPH LOADS THE TEMPORARY TABLE WITH THE OFFER DATA  07990043
081400*   FROM EP201                                                    08000043
081410*                                                                 08010043
081500*----------------------------------------------------------       08020043
081600 2100-LOAD-OFFER-TABLE.                                           08030043
081700                                                                  08040043
081710     IF PV-OFFER-COUNT > PC-OFR-TBL-MAX                           08050043
081720        DISPLAY ' OFFER HOLD TABLE OVERFLOW  '                    08060043
081730        DISPLAY ' LAST OFFER RECORD PROCESSED '                   08070043
081740        DISPLAY EP201-OFFER-ID                                    08080043
081750        SET AC-4004-TABLE-OVERFLOW-ERR  TO TRUE                   08090043
081760        MOVE '2100-LOAD-OFFER-TABLE' TO PV-PARAGRAPH-NAME         08100043
081770        PERFORM 9910-ABEND                                        08110043
081780     END-IF.                                                      08120043
081790                                                                  08130043
081800     MOVE EP201-OFFER-XST-OFR-RECORD  TO                          08140043
081900                                 PV-OFFER-DATA (PV-OFFER-COUNT)   08150043
082000                                                                  08160043
082100     SET PV-OFFER-COUNT UP BY 1.                                  08170043
082200                                                                  08180043
082300     PERFORM 6100-READ-OFFER-DATA.                                08190043
082400                                                                  08200043
082500*2100-EXIT.                                                       08210043
082600 EJECT.                                                           08220043
082700                                                                  08230043
082800*----------------------------------------------------------       08240043
082900* 2200-LOAD-SECTION-TABLE                                         08250043
083000*   THIS PARAGRAPH LOADS THE TEMPORARY TABLE WITH THE SECTION DATA08260043
083100*   FROM EP202                                                    08270043
083200*----------------------------------------------------------       08280043
083300 2200-LOAD-SECTION-TABLE.                                         08290043
083400                                                                  08300043
083410     IF PV-SECTN-COUNT > PC-SEC-TBL-MAX                           08310043
083420        DISPLAY ' SECTION HOLD TABLE OVERFLOW  '                  08320043
083430        DISPLAY ' LAST OFFER RECORD PROCESSED '                   08330043
083440        DISPLAY EP202-OFFER-ID                                    08340043
083450        SET AC-4004-TABLE-OVERFLOW-ERR  TO TRUE                   08341043
083460        MOVE '2200-LOAD-SECTION-TABLE' TO PV-PARAGRAPH-NAME       08342043
083470        PERFORM 9910-ABEND                                        08343043
083480     END-IF.                                                      08344043
083490                                                                  08345043
083500     MOVE EP202-OFFER-XST-OFR-SECT-RCD TO                         08346043
083600                                 PV-SECTION-DATA (PV-SECTN-COUNT).08347043
083700                                                                  08348043
083800     SET PV-SECTN-COUNT UP BY 1.                                  08349043
083900                                                                  08350043
084000     PERFORM 6200-READ-SECTN-DATA.                                08360043
084100                                                                  08370043
084200*2200-EXIT.                                                       08380043
084300 EJECT.                                                           08390043
084400                                                                  08400043
084500*----------------------------------------------------------       08410043
084600* 2300-LOAD-BWP-TABLE                                             08420043
084700*   THIS PARAGRAPH LOADS THE TEMPORARY TABLE WITH THE BWP DATA    08430043
084800*   FROM EP203                                                    08440043
084900*----------------------------------------------------------       08450043
085000 2300-LOAD-BWP-TABLE.                                             08460043
085100                                                                  08470043
085110     IF PV-BWP-COUNT > PC-BWP-TBL-MAX                             08480043
085120        DISPLAY ' BWP    HOLD TABLE OVERFLOW  '                   08490043
085130        DISPLAY ' OFFER RECORD BEING PROCESSED      '             08500043
085140        DISPLAY EP203-OFFER-ID                                    08510043
085150        SET AC-4004-TABLE-OVERFLOW-ERR  TO TRUE                   08511043
085160        MOVE '2300-LOAD-BWP-TABLE' TO PV-PARAGRAPH-NAME           08512043
085170        PERFORM 9910-ABEND                                        08513043
085180     END-IF.                                                      08514043
085190                                                                  08515043
085200     MOVE EP203-OFFER-XST-BWP-RECORD TO                           08516043
085300                                 PV-BWP-DATA (PV-BWP-COUNT).      08517043
085400                                                                  08518043
085500     SET PV-BWP-COUNT UP BY 1.                                    08519043
085600                                                                  08520043
085700     PERFORM 6300-READ-BWP-DATA.                                  08530043
085800                                                                  08540043
085900*2400-EXIT.                                                       08550043
086000 EJECT.                                                           08560043
086100                                                                  08570043
086200*----------------------------------------------------------       08580043
086300* 2400-LOAD-MDSE-TABLE                                            08590043
086400*   THIS PARAGRAPH LOADS THE TEMPORARY TABLE WITH THE SECTION DATA08600043
086500*   FROM EP202                                                    08610043
086600*----------------------------------------------------------       08620043
086700 2400-LOAD-MDSE-TABLE.                                            08630043
086800                                                                  08640043
086810     IF PV-MDSE-COUNT > PC-MDSE-TBL-MAX                           08650043
086820        DISPLAY ' MDSE HOLD TABLE OVERFLOW  '                     08660043
086830        DISPLAY ' OFFER RECORD BEING PROCESSED CURRENTLY      '   08670043
086840        DISPLAY EP204-OFFER-ID                                    08680043
086850        SET AC-4004-TABLE-OVERFLOW-ERR  TO TRUE                   08681043
086860        MOVE '2300-LOAD-BWP-TABLE' TO PV-PARAGRAPH-NAME           08682043
086870        PERFORM 9910-ABEND                                        08683043
086880     END-IF.                                                      08684043
086890                                                                  08685043
086900     MOVE EP204-OFFER-XST-OFR-MDSE-SET TO                         08686043
087000                                 PV-MDSE-DATA (PV-MDSE-COUNT).    08687043
087100                                                                  08688043
087200     SET PV-MDSE-COUNT UP BY 1.                                   08689043
087300                                                                  08690043
087400     PERFORM 6400-READ-MDSE-DATA.                                 08700043
087500                                                                  08710043
087600*2400-EXIT.                                                       08720043
087700 EJECT.                                                           08730043
087800                                                                  08740043
087900*----------------------------------------------------------       08750043
088000* 2500-FORMAT-OFFERS                                              08760043
088100* (2) FORMAT THE OFR_DT_FUL HEADER AND THEN WRITE ALL OFFERS      08770043
088200*     DATA FOLLOWING IT FOR THE CURRENT OFFER (PV-CURR-OFFER-KEY) 08780043
088300*                                                                 08790043
088400* (3) FORMAT THE OFR_RA_FUL HEADER AND THEN WRITE ALL THE OFFERS  08800043
088500*     SECTION DATA FOLLOWING FOR THE CURRENT OFFER                08810043
088600*                                                                 08820043
088700* (4) FORMAT THE OFR_BT_FUL HEADER AND THEN WRITE ALL THE OFFERS  08830043
088800*     BWP DATA FOLLOWING IT FOR THE CURRENT OFFER.                08840043
088900* (5) FORMAT THE OFR_MD_FUL HEADER AND THEN WRITE ALL THE OFFERS  08850043
089000*     MDSE DATA FOLLOWING IT FOR THE OFFER_ID RANGE.              08860043
089100*                                                                 08870043
089200*----------------------------------------------------------       08880043
089300 2500-FORMAT-OFFERS.                                              08890043
089400                                                                  08900043
089500     SET PS-OFFER-HDR-NOT-WRITEN                                  08910043
089600         PS-SECTN-HDR-NOT-WRITEN                                  08920043
089700         PS-BWP-HDR-NOT-WRITEN                                    08930043
089800         PS-MDSE-HDR-NOT-WRITEN TO TRUE.                          08940043
089900                                                                  08950043
090000     PERFORM 3100-FORMAT-WRITE-OFFER-DATA VARYING                 08960043
090100             PV-OFFER-COUNT FROM 1 BY 1                           08970043
090200             UNTIL PV-OFFER-DATA (PV-OFFER-COUNT) = SPACE OR      08980043
090300                   PV-OFFER-COUNT > PC-OFR-TBL-MAX.               08990043
090400                                                                  09000043
090500     PERFORM 3200-FORMAT-WRITE-SECTN-DATA VARYING                 09010043
090600             PV-SECTN-COUNT FROM 1 BY 1                           09020043
090700             UNTIL PV-SECTION-DATA (PV-SECTN-COUNT) = SPACE OR    09030043
090800             PV-SECTN-COUNT > PC-SEC-TBL-MAX.                     09040043
090900                                                                  09050043
091000     PERFORM 3300-FORMAT-WRITE-BWP-DATA VARYING                   09060043
091100             PV-BWP-COUNT FROM 1 BY 1                             09070043
091200             UNTIL PV-BWP-DATA (PV-BWP-COUNT) = SPACE OR          09080043
091300             PV-BWP-COUNT > PC-BWP-TBL-MAX.                       09090043
091400                                                                  09100043
091500     PERFORM 3400-FORMAT-WRITE-MDSE-DATA VARYING                  09110043
091600             PV-MDSE-COUNT FROM 1 BY 1                            09120043
091700             UNTIL PV-MDSE-DATA (PV-MDSE-COUNT) = SPACE OR        09130043
091800             PV-MDSE-COUNT > PC-MDSE-TBL-MAX.                     09140043
091900                                                                  09150043
092000     PERFORM 2600-DETERMINE-NEXT-STORE.                           09160043
092200                                                                  09170043
092300*2500-EXIT.                                                       09180043
092400 EJECT.                                                           09190043
092500                                                                  09200043
092600*-----------------------------------------------------------------09210043
092700* 2600-DETERMINE-NEXT-STORE                                       09220043
092800*  THIS PARAGRAPH WILL DO THE FOLLOWING BASED ON THE VALUE IN     09230043
092900*  PV-SL002-IE-IND                                                09240043
093000*  (1) WHEN THE INDICATOR IS SPACE, IT MEANS THAT THERE ARE NO    09250043
093100*      RECORDS IN STORE LIST FILE TO PROCESS FURTHER              09260043
093200*  (2) WHEN THE INDICATOR IS Y WE NEED TO CHECK THE FOLLOWING     09270043
093300*      FURTHER                                                    09280043
093400*   > CHECK IF THE PV-SL002-OFR-ID = PV-SL001-OFR-ID              09290043
093500*     (I)  IN THIS CASE WE WOULD HAVE TO WRITE ANOTHER SET OF HDRS09300043
093600*          ALONG WITH THE DATA FROM THE HOLD VARIABLES            09310043
093700*     (II) ROLL SL002 RECORDS TO TO SL001, READ ANOTHER RECORD    09320043
093800*          FROM STORE LIST FILE & SET THE EXCEPTION STORE LIST    09330043
093900*          INDICATOR AS REQUIRED.                                 09340043
094000*    (III) MAKE SURE TO CHANGE THE STORE GRP TYP CD AND ID IN     09350043
094100*          THE PV-CURR-STR-GRP-TYP-CDE                            09360043
094200*              PV-CURR-STR-GRP-ID                                 09370043
094300*        SET FLAG PS-NOT-ALL-STR-OFR-PROCESSED TO TRUE, SO THAT   09380043
094400*        IT GOES BACK TO PARAGRAPH 2500                           09390043
094500*                                                                 09400043
094600*   > CHECK IF THE PV-SL002-OFR-ID NOT = PV-SL001-OFR-ID          09410043
094700*         IN THIS CASE WE WOULD HAVE TO LOAD THE HOLD VARIABLES   09420043
094800*         WITH FRESH DATA AND THEN FORMAT THE HEADERS AND DATA REC09430043
094900*                                                                 09440043
095000*        WE STILL NEED TO PERFORM (II) AND (III) FROM ABOVE       09450043
095100*        SET FLAG PS-ALL-STR-OFR-PROCESSED TO TRUE, SO THAT       09460043
095200*        IT COMES OF THE LOOP OF PARA 2500                        09470043
095300*                                                                 09480043
095400*  (3) WHEN THE INDICATOR IS N WE NEED TO DO THE FOLLOWING        09490043
095500*   > WRITE THE EXCEPTION STORES IN EXCEPTION STORE LIST FILE,    09500043
095600*     KEEP WRITING UNTIL IE-IND = Y                               09510043
095700*     THEN PERFORM (II) AND (III) MENTIONED ABOVE.                09520043
095800*     SET FLAG PS-ALL-STR-OFR-PROCESSED TO TRUE, SO THAT          09530043
095900*     IT COMES OF THE LOOP OF PARA 2500                           09540043
096000*                                                                 09550043
096100*----------------------------------------------------------------*09560043
096200 2600-DETERMINE-NEXT-STORE.                                       09570043
096300                                                                  09580043
096400     EVALUATE TRUE                                                09590043
096500                                                                  09600043
096600     WHEN PV-SL002-IE-IND = SPACES                                09610043
096700                                                                  09620043
096800        SET PS-ALL-STR-OFR-PROCESSED TO TRUE                      09630043
096900                                                                  09640043
097000     WHEN PV-SL002-IE-IND = 'Y'                                   09650043
097100                                                                  09660043
097200        IF PV-SL002-OFFER-ID = PV-SL001-OFFER-ID AND              09670043
097300           PV-SL002-ADD-DLT-FLG = PV-SL001-ADD-DLT-FLG            09680043
097400           SET PS-NOT-ALL-STR-OFR-PROCESSED TO TRUE               09690043
097500        ELSE                                                      09700043
097600           SET PS-ALL-STR-OFR-PROCESSED TO TRUE                   09710043
097700        END-IF                                                    09720043
097800                                                                  09730043
097900        PERFORM 5500-ROLL-SL0002-TO-SL0001                        09740043
098000        PERFORM 5700-UPDATE-CURRENT-OFR-STR                       09750043
098100        PERFORM 6900-READ-STORE-LIST-FILE                         09760043
098200        IF PS-NOT-END-OF-STORE-FILE                               09770043
098300           PERFORM 5400-MOVE-VALUES-TO-SL0002                     09780043
098400        ELSE                                                      09790043
098500           MOVE SPACES TO PV-SL002-KEY                            09800043
098600        END-IF                                                    09810043
098700        PERFORM 5600-FIND-IF-EXCEPTN-STR                          09820043
098800                                                                  09830043
098900     WHEN PV-SL002-IE-IND = 'N'                                   09840043
099000                                                                  09850043
099100         PERFORM 5800-POPULATE-EXCEPTION-STRLST                   09860043
099200                                                                  09870043
099300         IF PS-END-OF-STORE-FILE                                  09880043
099400            SET PS-ALL-STR-OFR-PROCESSED TO TRUE                  09890043
099500         ELSE                                                     09900043
099600                                                                  09910043
099700            IF EP206-OFFER-ID = PV-CURR-OFFER-ID AND              09920043
099800               EP206-ADD-DLT-FLG = PV-CURR-ADD-DLT-FLG            09930043
099900               SET PS-NOT-ALL-STR-OFR-PROCESSED TO TRUE           09940043
100000            ELSE                                                  09950043
100100               SET PS-ALL-STR-OFR-PROCESSED TO TRUE               09960043
100200            END-IF                                                09970043
100300                                                                  09980043
100400            PERFORM 5100-PROCESS-STORE-LIST                       09990043
100500                                                                  10000043
100600         END-IF                                                   10010043
100700                                                                  10020043
100800     END-EVALUATE.                                                10030043
100900                                                                  10040043
101000*2600-EXIT.                                                       10050043
101100 EJECT.                                                           10060043
101200                                                                  10070043
101300*-----------------------------------------------------------------10080043
101400* 3100-FORMAT-WRITE-OFFER-DATA                                    10090043
101500*  THIS PARAGRAPH WILL DO THE FOLLOWING                           10100043
101600*  (1) WRITE FORMATTED HEADER RECORDS                             10110043
101700*  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   10120043
101800*----------------------------------------------------------------*10130043
101900 3100-FORMAT-WRITE-OFFER-DATA.                                    10140043
102000                                                                  10150043
102100     MOVE PV-OFFER-DATA (PV-OFFER-COUNT) TO                       10160043
102200                     PV201-OFFER-XST-OFR-RECORD.                  10170043
102300                                                                  10180043
102400     IF PS-OFFER-HDR-NOT-WRITEN                                   10190043
102500        SET EP200-XST-OFFER TO TRUE                               10200043
102600        PERFORM 4100-FORMAT-AND-WRITE-HDR                         10210043
102700        SET PS-OFFER-HDR-WRITEN TO TRUE                           10220043
102800        ADD 1 TO PV-OFFER-HDR-OUT-CNT                             10230043
102900     END-IF.                                                      10240043
103000                                                                  10250043
103100     SET FORM-OFR-LEN                                             10260043
103200       TO 1.                                                      10270043
103300     MOVE 1 TO  PV-BYTE-COUNT.                                    10280043
103400     INITIALIZE FORMATTED-OFFERS-RECORD.                          10290043
103500                                                                  10300043
103600     PERFORM 6850-MOVE-DELIMITER.                                 10310043
103700                                                                  10320043
103800     MOVE PV201-TRIGGER-TYPE TO PV-TRIGGER-TYPE.                  10330043
103900                                                                  10340043
104000     PERFORM 4250-MOVE-TRIGGER-TYPE.                              10350043
104100                                                                  10360043
104200     MOVE PV201-EVENT-ID TO PV-FORMAT-EVENT-ID.                   10370043
104300     MOVE PV201-OFFER-ID TO PV-FORMAT-OFFER-ID.                   10380043
104400                                                                  10390043
104500     PERFORM 4300-MOVE-EVENT-OFR-ID.                              10400043
104600     PERFORM 4350-MOVE-REST-OFFER-DATA.                           10410043
104700     PERFORM 4200-WRITE-DATA-RECORD.                              10420043
104800                                                                  10430043
104900     ADD 1 TO PV-OFFER-DTA-OUT-CNT.                               10440043
105000                                                                  10450043
105100*3100-EXIT.                                                       10460043
105200 EJECT.                                                           10470043
105300                                                                  10480043
105400*-----------------------------------------------------------------10490043
105500* 3200-FORMAT-WRITE-SECTN-DATA                                    10500043
105600*  THIS PARAGRAPH WILL DO THE FOLLOWING                           10510043
105700*  (1) WRITE FORMATTED HEADER RECORD                              10520043
105800*  (2) FORMAT THE DATA RECORDS AND WRITE IT OUT                   10530043
105900*----------------------------------------------------------------*10540043
106000 3200-FORMAT-WRITE-SECTN-DATA.                                    10550043
106100                                                                  10560043
106200     MOVE PV-SECTION-DATA (PV-SECTN-COUNT) TO                     10570043
106300                     PV202-OFFER-XST-OFR-SECT-RCD.                10580043
106400                                                                  10590043
106500     IF PS-SECTN-HDR-NOT-WRITEN                                   10600043
106600        SET EP200-XST-OFR-SECT TO TRUE                            10610043
106700        PERFORM 4100-FORMAT-AND-WRITE-HDR                         10620043
106800        SET PS-SECTN-HDR-WRITEN TO TRUE                           10630043
106900        ADD 1 TO PV-SECTION-HDR-OUT-CNT                           10640043
107000     END-IF.                                                      10650043
107100                                                                  10660043
107200                                                                  10670043
107300     SET FORM-OFR-LEN                                             10680043
107400       TO 1.                                                      10690043
107500     MOVE 1 TO  PV-BYTE-COUNT.                                    10700043
107600     INITIALIZE FORMATTED-OFFERS-RECORD.                          10710043
107700                                                                  10720043
107800     PERFORM 6850-MOVE-DELIMITER.                                 10730043
107900                                                                  10740043
108000     MOVE PV202-TRIGGER-TYPE TO PV-TRIGGER-TYPE.                  10750043
108100                                                                  10760043
108200     PERFORM 4250-MOVE-TRIGGER-TYPE.                              10770043
108300                                                                  10780043
108400     MOVE PV202-EVENT-ID TO PV-FORMAT-EVENT-ID.                   10790043
108500     MOVE PV202-OFFER-ID TO PV-FORMAT-OFFER-ID.                   10800043
108600                                                                  10810043
108700     PERFORM 4300-MOVE-EVENT-OFR-ID.                              10820043
108800     PERFORM 4400-MOVE-REST-SECTION-DATA.                         10830043
108900                                                                  10840043
109000     PERFORM 4200-WRITE-DATA-RECORD.                              10850043
109100                                                                  10860043
109200     ADD 1 TO PV-SECTION-DTA-OUT-CNT.                             10870043
109300                                                                  10880043
109400*3200-EXIT.                                                       10890043
109500 EJECT.                                                           10900043
109600                                                                  10910043
109700*-----------------------------------------------------------------10920043
109800* 3300-FORMAT-WRITE-BWP-DATA                                      10930043
109900*  THIS PARAGRAPH WILL FORMAT THE HEADER RECORD (OFR_BT_CHG) AND  10940043
110000*  THE DATA RECORD BEFORE WRITING IT OUT.                         10950043
110100*----------------------------------------------------------------*10960043
110200 3300-FORMAT-WRITE-BWP-DATA.                                      10970043
110300                                                                  10980043
110400     MOVE PV-BWP-DATA (PV-BWP-COUNT) TO                           10990043
110500                     PV203-OFFER-XST-BWP-RECORD.                  11000043
110600                                                                  11010043
110700     IF PS-BWP-HDR-NOT-WRITEN                                     11020043
110800        SET EP200-XST-OFR-BWP TO TRUE                             11030043
110900        PERFORM 4100-FORMAT-AND-WRITE-HDR                         11040043
111000        SET PS-BWP-HDR-WRITEN TO TRUE                             11050043
111100        ADD 1 TO PV-BWP-HDR-OUT-CNT                               11060043
111200     END-IF.                                                      11070043
111300     SET FORM-OFR-LEN                                             11080043
111400       TO 1.                                                      11090043
111500     MOVE 1 TO  PV-BYTE-COUNT.                                    11100043
111600     INITIALIZE FORMATTED-OFFERS-RECORD.                          11110043
111700                                                                  11120043
111800     PERFORM 6850-MOVE-DELIMITER.                                 11130043
111900                                                                  11140043
112000     MOVE PV203-TRIGGER-TYPE TO PV-TRIGGER-TYPE.                  11150043
112100                                                                  11160043
112200     PERFORM 4250-MOVE-TRIGGER-TYPE.                              11170043
112300                                                                  11180043
112400     MOVE PV203-EVENT-ID TO PV-FORMAT-EVENT-ID.                   11190043
112500     MOVE PV203-OFFER-ID TO PV-FORMAT-OFFER-ID.                   11200043
112600                                                                  11210043
112700     PERFORM 4300-MOVE-EVENT-OFR-ID.                              11220043
112800     PERFORM 4450-MOVE-REST-BWP-DATA.                             11230043
112900                                                                  11240043
113000     PERFORM 4200-WRITE-DATA-RECORD.                              11250043
113100                                                                  11260043
113200     ADD 1 TO PV-BWP-DTA-OUT-CNT.                                 11270043
113300                                                                  11280043
113400*3300-EXIT.                                                       11290043
113500 EJECT.                                                           11300043
113600                                                                  11310043
113700*-----------------------------------------------------------------11320043
113800* 3400-FORMAT-WRITE-MDSE-DATA                                     11330043
113900*  THIS PARAGRAPH WILL FORMAT THE HEADER (OFR_MD_CHG) RECORD AND  11340043
114000*  THE DATA RECORDS BEFORE WRITING IT OUT.                        11350043
114100*----------------------------------------------------------------*11360043
114200 3400-FORMAT-WRITE-MDSE-DATA.                                     11370043
114300                                                                  11380043
114400     MOVE PV-MDSE-DATA (PV-MDSE-COUNT) TO                         11390043
114500                     PV204-OFFER-XST-OFR-MDSE-SET.                11400043
114600                                                                  11410043
114700     IF PS-MDSE-HDR-NOT-WRITEN                                    11420043
114800        SET EP200-XST-OFR-MDSE-SET TO TRUE                        11430043
114900        PERFORM 4100-FORMAT-AND-WRITE-HDR                         11440043
115000        SET PS-MDSE-HDR-WRITEN TO TRUE                            11450043
115100        ADD 1 TO PV-MDSE-HDR-OUT-CNT                              11460043
115200     END-IF.                                                      11470043
115300                                                                  11480043
115400     SET FORM-OFR-LEN                                             11490043
115500       TO 1.                                                      11500043
115600     MOVE 1 TO  PV-BYTE-COUNT.                                    11510043
115700     INITIALIZE FORMATTED-OFFERS-RECORD.                          11520043
115800                                                                  11530043
115900     PERFORM 6850-MOVE-DELIMITER.                                 11540043
116000                                                                  11550043
116100     MOVE PV204-TRIGGER-TYPE TO PV-TRIGGER-TYPE.                  11560043
116200                                                                  11570043
116300     PERFORM 4250-MOVE-TRIGGER-TYPE.                              11580043
116400                                                                  11590043
116500     MOVE PV204-EVENT-ID TO PV-FORMAT-EVENT-ID.                   11600043
116600     MOVE PV204-OFFER-ID TO PV-FORMAT-OFFER-ID.                   11610043
116700                                                                  11620043
116800     PERFORM 4300-MOVE-EVENT-OFR-ID.                              11630043
116900     PERFORM 4500-MOVE-REST-MDSE-DATA.                            11640043
117000                                                                  11650043
117100     PERFORM 4200-WRITE-DATA-RECORD.                              11660043
117200                                                                  11670043
117300     ADD 1 TO PV-MDSE-DTA-OUT-CNT.                                11680043
117400                                                                  11690043
117500*3400-EXIT.                                                       11700043
117600 EJECT.                                                           11710043
117700                                                                  11720043
117800*-----------------------------------------------------------------11730043
117900* 4100-FORMAT-AND-WRITE-HDR                                       11740043
118000*  THIS PARAGRAPH WILL MOVE THE VALUES TO THE HEADER RECORD       11750043
118100*----------------------------------------------------------------*11760043
118200 4100-FORMAT-AND-WRITE-HDR.                                       11770043
118300                                                                  11780043
118400     MOVE 'HDR'                   TO EP200-HDR-INDICATOR.         11790043
118500     MOVE PV-CURR-STR-GRP-TYP-CDE TO EP200-STR-GRP-TYP.           11800043
118600                                                                  11810043
118700     IF PS-NO-EXCEPTN-STR-EXISTS                                  11820043
118800        MOVE '00000'                 TO EP200-STR-GRP-EXCP-IND    11830043
118900     ELSE                                                         11840043
119000        MOVE PV-EXCEPTION-COUNTER    TO EP200-STR-GRP-EXCP-IND    11850043
119100     END-IF.                                                      11860043
119200                                                                  11870043
119300     MOVE PV-CURR-STR-GRP-ID      TO EP200-STR-GRP-ID-STR-LOC.    11880043
119400     MOVE '00000'                 TO EP200-EXCO-STR-NBR.          11890043
119500     MOVE PV-FORMAT-HDR-DIST-DTE  TO EP200-FILE-DIST-DATE.        11900043
119600     MOVE 'OFR'                   TO EP200-FILE-NAME-OFFER.       11910043
119700     MOVE '_'                     TO EP200-UNDERSCORE-1.          11920043
119800     MOVE '_'                     TO EP200-UNDERSCORE-2.          11930043
119900     MOVE '_'                     TO EP200-UNDERSCORE-3.          11940043
120000     MOVE '_'                     TO EP200-UNDERSCORE-4.          11950043
120100     MOVE '_'                     TO EP200-UNDERSCORE-5.          11960043
120200     MOVE 'CHG'                   TO EP200-FILE-NAME-TYPE.        11970043
120300                                                                  11980043
120400     IF PV-CURR-STR-GRP-TYP-CDE = 5000                            11990043
120500        MOVE PV-CURR-STR-GRP-ID   TO EP200-STORE-NBR              12000043
120600     ELSE                                                         12010043
120700        MOVE '00000'              TO EP200-STORE-NBR              12020043
120800     END-IF.                                                      12030043
120900                                                                  12040043
121000     MOVE PV-HEADER-TMST          TO EP200-CRT-TIMESTAMP.         12050043
121100     MOVE 'C'                     TO EP200-FILE-TYPE-APPLY.       12060043
121200                                                                  12070043
121300     PERFORM 4150-WRITE-HDR-RECORD.                               12080043
121400                                                                  12090043
121500*4100-EXIT.                                                       12100043
121600 EJECT.                                                           12110043
121700                                                                  12120043
121800*-----------------------------------------------------------------12130043
121900* 4150-WRITE-HDR-RECORD                                           12140043
122000*  THIS PARAGRAPH WILL INCREMENT THE TIMESTAMP BY 1 SECOND AND    12150043
122100*  WILL WRITE THE HEADER RECORD                                   12160043
122200*-----------------------------------------------------------------12170043
122300 4150-WRITE-HDR-RECORD.                                           12180043
122400                                                                  12190043
122500     PERFORM 5000-INCR-HEADER-TIMESTAMP.                          12200043
122600                                                                  12210043
122700     MOVE 64                                                      12220043
122800       TO PV-BYTE-COUNT.                                          12230043
122900     WRITE FORMATTED-OFFERS-RECORD                                12240043
123000       FROM EP200-OFFER-HEADER-RECORD.                            12250043
123100                                                                  12260043
123200*4150-EXIT.                                                       12270043
123300 EJECT.                                                           12280043
123400                                                                  12290043
123500*-----------------------------------------------------------------12300043
123600* 4200-WRITE-DATA-RECORD                                          12310043
123700*  THIS PARAGRAPH WILL WRITE THE DATA RECORD TO THE O/P FILE      12320043
123800*-----------------------------------------------------------------12330043
123900 4200-WRITE-DATA-RECORD.                                          12340043
124000                                                                  12350043
124100     WRITE FORMATTED-OFFERS-RECORD.                               12360043
124200                                                                  12370043
124300*4200-EXIT.                                                       12380043
124400 EJECT.                                                           12390043
124500                                                                  12400043
124600*-----------------------------------------------------------------12410043
124700* 4250-MOVE-TRIGGER-TYPE                                          12420043
124800*  THIS PARAGRAPH WILL MOVE THE TRIGGER TYPE TO THE OUTPUT VARIABL12430043
124900*----------------------------------------------------------------*12440043
125000 4250-MOVE-TRIGGER-TYPE.                                          12450043
125100                                                                  12460043
125200     MOVE PV-TRIGGER-TYPE                                         12470043
125300       TO FORM-OFR-FLD(FORM-OFR-LEN).                             12480043
125400     SET FORM-OFR-LEN                                             12490043
125500       UP BY 1.                                                   12500043
125600     ADD 1                                                        12510043
125700       TO PV-BYTE-COUNT.                                          12520043
125800     PERFORM 6850-MOVE-DELIMITER.                                 12530043
125900                                                                  12540043
126000*4250-EXIT.                                                       12550043
126100 EJECT.                                                           12560043
126200                                                                  12570043
126300*----------------------------------------------------------       12580043
126400* 4300-MOVE-EVENT-OFR-ID.                                         12590043
126500*     THIS PARAGRAPH MOVES THE EVENT ID AND THE OFR ID TO         12600043
126600*     THE OUTPUT FIELD VARIABLE                                   12610043
126700*----------------------------------------------------------       12620043
126800 4300-MOVE-EVENT-OFR-ID.                                          12630043
126900                                                                  12640043
127000*---------- FORMATTING EVNT_ID ---------------------              12650043
127100     INITIALIZE PV-VARIABLE-ID                                    12660043
127200                PV-TALLY.                                         12670043
127300                                                                  12680043
127400     INSPECT PV-FORMAT-EVENT-ID TALLYING PV-TALLY                 12690043
127500         FOR LEADING ZEROES.                                      12700043
127600     SET PV-EFBM-IDX TO PV-TALLY.                                 12710043
127700     SET PV-EFBM-IDX UP BY 1.                                     12720043
127800     MOVE PV-FORMAT-EVENT-ID TO  PV-VARIABLE-ID.                  12730043
127900                                                                  12740043
128000     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            12750043
128100        FROM PV-EFBM-IDX BY 1                                     12760043
128200       UNTIL PV-EFBM-BIT-IDX > 10.                                12770043
128300                                                                  12780043
128400     PERFORM 6850-MOVE-DELIMITER.                                 12790043
128500                                                                  12800043
128600                                                                  12810043
128700*---------- FORMATTING OFR_ID ----------------------              12820043
128800     INITIALIZE PV-VARIABLE-ID                                    12830043
128900                PV-TALLY.                                         12840043
129000                                                                  12850043
129100     INSPECT PV-FORMAT-OFFER-ID TALLYING PV-TALLY                 12860043
129200         FOR LEADING ZEROES.                                      12870043
129300     SET PV-EFBM-IDX TO PV-TALLY.                                 12880043
129400     SET PV-EFBM-IDX UP BY 1.                                     12890043
129500     MOVE PV-FORMAT-OFFER-ID TO  PV-VARIABLE-ID.                  12900043
129600                                                                  12910043
129700     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            12920043
129800        FROM PV-EFBM-IDX BY 1                                     12930043
129900       UNTIL PV-EFBM-BIT-IDX > 10.                                12940043
130000                                                                  12950043
130100     PERFORM 6850-MOVE-DELIMITER.                                 12960043
130200                                                                  12970043
130300*4300-EXIT.                                                       12980043
130400 EJECT.                                                           12990043
130500                                                                  13000043
130600*----------------------------------------------------------       13010043
130700* 4350-MOVE-REST-OFFER-DATA.                                      13020043
130800*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FROM EPRD201      13030043
130900*     COPYBOOK TO THE THE OUTPUT FIELD VARIABLE                   13040043
131000*----------------------------------------------------------       13050043
131100 4350-MOVE-REST-OFFER-DATA.                                       13060043
131200                                                                  13070043
131300*-------  MOVE PROMO-SCHM-CDE --------(NOT NULL)-----*******      13080043
131400                                                                  13090043
131500     INITIALIZE PV-VARIABLE-ID                                    13100043
131600                PV-TALLY.                                         13110043
131700                                                                  13120043
131800     MOVE PV201-PROMO-SCHM-CDE  TO PV-VARIABLE-ID.                13130043
131900                                                                  13140043
132000     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            13150043
132100        FROM 1 BY 1                                               13160043
132200       UNTIL PV-EFBM-BIT-IDX > 4.                                 13170043
132300                                                                  13180043
132400     PERFORM 6850-MOVE-DELIMITER.                                 13190043
132500*-------  MOVE EVENT-TYP-CDE --------(NOT NULL)-----*******       13200043
132600                                                                  13210043
132700     INITIALIZE PV-VARIABLE-ID                                    13220043
132800                PV-TALLY.                                         13230043
132900                                                                  13240043
133000     MOVE PV201-EVENT-TYP-CODE  TO PV-VARIABLE-ID.                13250043
133100                                                                  13260043
133200     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            13270043
133300        FROM 1 BY 1                                               13280043
133400       UNTIL PV-EFBM-BIT-IDX > 2.                                 13290043
133500                                                                  13300043
133600     PERFORM 6850-MOVE-DELIMITER.                                 13310043
133700*-------  MOVE EVENT-NAME    --------(NOT NULL)-----*******       13320043
133800                                                                  13330043
133900     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          13340043
134000                PV-TALLY.                                         13350043
134100                                                                  13360043
134200     IF PV201-EVENT-NAME = SPACES                                 13370043
134300        PERFORM 6750-MOVE-SPACE                                   13380043
134400     ELSE                                                         13390043
134500        MOVE PV201-EVENT-NAME      TO PV-VARIABLE-OUTPUT-FIELD    13400043
134600        PERFORM 6600-FIND-DATA-END                                13410043
134700          VARYING PV-EOF-IDX                                      13420043
134800             FROM 50 BY -1                                        13430043
134900             UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        13440043
135000        PERFORM 6650-FIELD-MOVER                                  13450043
135100          VARYING PV-BIT-IDX                                      13460043
135200             FROM 1 BY 1                                          13470043
135300             UNTIL PV-BIT-IDX > PV-EOF-IDX                        13480043
135400                                                                  13490043
135500        PERFORM 6850-MOVE-DELIMITER                               13500043
135600     END-IF.                                                      13510043
135610                                                                  13520043
135700*-------  MOVE OFFER-NAME    --------(NOT NULL)-----*******       13530043
135800                                                                  13540043
135900     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          13550043
136000                PV-TALLY.                                         13560043
136100                                                                  13570043
136200     IF PV201-OFFER-NAME = SPACES                                 13580043
136300        PERFORM 6750-MOVE-SPACE                                   13590043
136400     ELSE                                                         13600043
136500        MOVE PV201-OFFER-NAME      TO PV-VARIABLE-OUTPUT-FIELD    13610043
136600        PERFORM 6600-FIND-DATA-END                                13620043
136700          VARYING PV-EOF-IDX                                      13630043
136800             FROM 50 BY -1                                        13640043
136900             UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        13650043
137000        PERFORM 6650-FIELD-MOVER                                  13660043
137100          VARYING PV-BIT-IDX                                      13670043
137200             FROM 1 BY 1                                          13680043
137300             UNTIL PV-BIT-IDX > PV-EOF-IDX                        13690043
137400                                                                  13700043
137500        PERFORM 6850-MOVE-DELIMITER                               13710043
137600     END-IF.                                                      13720043
137700                                                                  13730043
137800*-------  MOVE DISC-LEVEL-CODE-------(NOT NULL)-----*******       13740043
137900                                                                  13750043
138000     INITIALIZE PV-VARIABLE-ID                                    13760043
138100                PV-TALLY.                                         13770043
138200                                                                  13780043
138300     MOVE PV201-DISC-LEVEL-CODE  TO PV-VARIABLE-ID.               13790043
138400                                                                  13800043
138500     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            13810043
138600        FROM 1 BY 1                                               13820043
138700       UNTIL PV-EFBM-BIT-IDX > 3.                                 13830043
138800                                                                  13840043
138900     PERFORM 6850-MOVE-DELIMITER.                                 13850043
139000                                                                  13860043
139100*-------  MOVE OFFER-USAGE-TYPE-CODE -(NOT NULL)-----*******      13870043
139200                                                                  13880043
139300     INITIALIZE PV-VARIABLE-ID                                    13890043
139400                PV-TALLY.                                         13900043
139500                                                                  13910043
139600     MOVE PV201-OFFER-USAGE-TYPE-CODE TO PV-VARIABLE-ID.          13920043
139700                                                                  13930043
139800     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            13940043
139900        FROM 1 BY 1                                               13950043
140000       UNTIL PV-EFBM-BIT-IDX > 3.                                 13960043
140100                                                                  13970043
140200     PERFORM 6850-MOVE-DELIMITER.                                 13980043
140300                                                                  13990043
140400*-------  MOVE BARCODE-TYPE-CODE------(NOT NULL)-----*******      14000043
140500                                                                  14010043
140600     INITIALIZE PV-VARIABLE-ID                                    14020043
140700                PV-TALLY.                                         14030043
140800                                                                  14040043
140900     MOVE PV201-BARCODE-TYPE-CODE     TO PV-VARIABLE-ID.          14050043
141000                                                                  14060043
141100     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            14070043
141200        FROM 1 BY 1                                               14080043
141300       UNTIL PV-EFBM-BIT-IDX > 1.                                 14090043
141400                                                                  14100043
141500     PERFORM 6850-MOVE-DELIMITER.                                 14110043
141600                                                                  14120043
141700*-------  MOVE UNEARN-IND ------------(NOT NULL)-----*******      14130043
141800                                                                  14140043
141900     INITIALIZE PV-VARIABLE-ID                                    14150043
142000                PV-TALLY.                                         14160043
142100                                                                  14170043
142200     MOVE PV201-UNEARN-IND            TO PV-VARIABLE-ID.          14180043
142300                                                                  14190043
142400     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            14200043
142500        FROM 1 BY 1                                               14210043
142600       UNTIL PV-EFBM-BIT-IDX > 1.                                 14220043
142700                                                                  14230043
142800     PERFORM 6850-MOVE-DELIMITER.                                 14240043
142900                                                                  14250043
143000*-------  MOVE OFR-TRGR-TYP-CDE-------(NOT NULL)-----*******      14260043
143100                                                                  14270043
143200     INITIALIZE PV-VARIABLE-ID                                    14280043
143300                PV-TALLY.                                         14290043
143400                                                                  14300043
143500     MOVE PV201-OFR-TRGR-TYP-CDE      TO PV-VARIABLE-ID.          14310043
143600                                                                  14320043
143700     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            14330043
143800        FROM 1 BY 1                                               14340043
143900       UNTIL PV-EFBM-BIT-IDX > 3.                                 14350043
144000                                                                  14360043
144100     PERFORM 6850-MOVE-DELIMITER.                                 14370043
144200                                                                  14380043
144300*-------  MOVE BWP-ITM-APPL-CDE-----------(NULL)-----*******      14390043
144400                                                                  14400043
144500     INITIALIZE PV-VARIABLE-ID                                    14410043
144600                PV-TALLY.                                         14420043
144700                                                                  14430043
144800     EVALUATE TRUE                                                14440043
144900         WHEN PV201-BWP-ITM-APPL-CDE = '~'                        14450043
145000              PERFORM 6800-MOVE-NULL-VALUE                        14460043
145100         WHEN PV201-BWP-ITM-APPL-CDE = SPACES                     14470043
145200              PERFORM 6750-MOVE-SPACE                             14480043
145300         WHEN OTHER                                               14490043
145400              MOVE PV201-BWP-ITM-APPL-CDE      TO PV-VARIABLE-ID  14500043
145500                                                                  14510043
145600              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   14520043
145700                 FROM 1 BY 1                                      14530043
145800                 UNTIL PV-EFBM-BIT-IDX > 2                        14540043
145900                                                                  14550043
146000              PERFORM 6850-MOVE-DELIMITER                         14560043
146100     END-EVALUATE.                                                14570043
146200                                                                  14580043
146300*4350-EXIT.                                                       14590043
146400 EJECT.                                                           14600043
146500                                                                  14610043
146600*----------------------------------------------------------       14620043
146700* 4400-MOVE-REST-SECTION-DATA.                                    14630043
146800*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FILEDS FROM       14640043
146900*     EPRD202 COPYBOOK TO THE VARIABLE OUTPUT RECORD              14650043
147000*----------------------------------------------------------       14660043
147100 4400-MOVE-REST-SECTION-DATA.                                     14670043
147200                                                                  14680043
147300*-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      14690043
147400                                                                  14700043
147500     INITIALIZE PV-VARIABLE-ID                                    14710043
147600                PV-TALLY.                                         14720043
147700                                                                  14730043
147800     MOVE PV202-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          14740043
147900                                                                  14750043
148000     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            14760043
148100        FROM 1 BY 1                                               14770043
148200       UNTIL PV-EFBM-BIT-IDX > 1.                                 14780043
148300                                                                  14790043
148400     PERFORM 6850-MOVE-DELIMITER.                                 14800043
148500                                                                  14810043
148600*-------  MOVE EFF-BEG-DATE-----------(NOT NULL)-----*******      14820043
148700                                                                  14830043
148800     INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           14840043
148900                PV-EFF-WORK-DTE.                                  14850043
149000                                                                  14860043
149100     MOVE PV202-EFF-BEG-DTE           TO PV-EFF-WORK-DTE.         14870043
149200                                                                  14880043
149300     MOVE PV-EFF-WORK-YYYY            TO PV-EFFECT-YYYY.          14890043
149400     MOVE PV-EFF-WORK-MM              TO PV-EFFECT-MM.            14900043
149500     MOVE PV-EFF-WORK-DD              TO PV-EFFECT-DD.            14910043
149600     MOVE PC-TIME-START               TO PV-EFFECT-TIME.          14920043
149700     MOVE '-'                         TO PV-EFFECT-DASH-1.        14930043
149800     MOVE '-'                         TO PV-EFFECT-DASH-2.        14940043
149900                                                                  14950043
150000     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         14960043
150100     MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   14970043
150200                                                                  14980043
150300     PERFORM 6600-FIND-DATA-END                                   14990043
150400       VARYING PV-EOF-IDX                                         15000043
150500         FROM 50 BY -1                                            15010043
150600           UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         15020043
150700     PERFORM 6650-FIELD-MOVER                                     15030043
150800       VARYING PV-BIT-IDX                                         15040043
150900         FROM 1 BY 1                                              15050043
151000           UNTIL PV-BIT-IDX > PV-EOF-IDX.                         15060043
151100                                                                  15070043
151200     PERFORM 6850-MOVE-DELIMITER.                                 15080043
151300                                                                  15090043
151400*-------  MOVE EFF-END-DATE-----------(NOT NULL)-----*******      15100043
151500                                                                  15110043
151600     INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           15120043
151700                PV-EFF-WORK-DTE.                                  15130043
151800                                                                  15140043
151900     MOVE PV202-EFF-END-DTE           TO PV-EFF-WORK-DTE.         15150043
152000                                                                  15160043
152100     MOVE PV-EFF-WORK-YYYY            TO PV-EFFECT-YYYY.          15170043
152200     MOVE PV-EFF-WORK-MM              TO PV-EFFECT-MM.            15180043
152300     MOVE PV-EFF-WORK-DD              TO PV-EFFECT-DD.            15190043
152400     MOVE PC-TIME-END                 TO PV-EFFECT-TIME.          15200043
152500     MOVE '-'                         TO PV-EFFECT-DASH-1.        15210043
152600     MOVE '-'                         TO PV-EFFECT-DASH-2.        15220043
152700                                                                  15230043
152800     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         15240043
152900     MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   15250043
153000                                                                  15260043
153100     PERFORM 6600-FIND-DATA-END                                   15270043
153200       VARYING PV-EOF-IDX                                         15280043
153300         FROM 50 BY -1                                            15290043
153400           UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         15300043
153500     PERFORM 6650-FIELD-MOVER                                     15310043
153600       VARYING PV-BIT-IDX                                         15320043
153700         FROM 1 BY 1                                              15330043
153800           UNTIL PV-BIT-IDX > PV-EOF-IDX.                         15340043
153900                                                                  15350043
154000     PERFORM 6850-MOVE-DELIMITER.                                 15360043
154100                                                                  15370043
154200*-------  MOVE REDMN-SUPVR-OVERRID-DTE (NOT NULL)-----*******     15380043
154300                                                                  15390043
154400     INITIALIZE PV-FORMAT-EFFECTIVE-DTE                           15400043
154500                PV-EFF-WORK-DTE.                                  15410043
154600                                                                  15420043
154700     MOVE PV202-REDMN-SUPVR-OVRRID-DTE TO PV-EFF-WORK-DTE.        15430043
154800                                                                  15440043
154900     MOVE PV-EFF-WORK-YYYY             TO PV-EFFECT-YYYY.         15450043
155000     MOVE PV-EFF-WORK-MM               TO PV-EFFECT-MM.           15460043
155100     MOVE PV-EFF-WORK-DD               TO PV-EFFECT-DD.           15470043
155200     MOVE PC-TIME-END                  TO PV-EFFECT-TIME.         15480043
155300     MOVE '-'                          TO PV-EFFECT-DASH-1.       15490043
155400     MOVE '-'                          TO PV-EFFECT-DASH-2.       15500043
155500                                                                  15510043
155600     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         15520043
155700     MOVE  PV-FORMAT-EFFECTIVE-DTE TO PV-VARIABLE-OUTPUT-FIELD.   15530043
155800                                                                  15540043
155900     PERFORM 6600-FIND-DATA-END                                   15550043
156000       VARYING PV-EOF-IDX                                         15560043
156100         FROM 50 BY -1                                            15570043
156200           UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE.         15580043
156300     PERFORM 6650-FIELD-MOVER                                     15590043
156400       VARYING PV-BIT-IDX                                         15600043
156500         FROM 1 BY 1                                              15610043
156600           UNTIL PV-BIT-IDX > PV-EOF-IDX.                         15620043
156700                                                                  15630043
156800     PERFORM 6850-MOVE-DELIMITER.                                 15640043
156900                                                                  15650043
157000*-------  MOVE BWP-GET-CNCTR-CDE------(NOT NULL)-----*******      15660043
157100                                                                  15670043
157200     INITIALIZE PV-VARIABLE-ID                                    15680043
157300                PV-TALLY.                                         15690043
157400                                                                  15700043
157500     MOVE PV202-BWP-GET-CNCTR-CDE    TO PV-VARIABLE-ID.           15710043
157600                                                                  15720043
157700     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            15730043
157800        FROM 1 BY 1                                               15740043
157900       UNTIL PV-EFBM-BIT-IDX > 3 OR                               15750043
158000           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    15760043
158100                                                                  15770043
158200     PERFORM 6850-MOVE-DELIMITER.                                 15780043
158300                                                                  15790043
158400*-------  MOVE BWP-BUY-CNCTR-CDE------(NOT NULL)-----*******      15800043
158500                                                                  15810043
158600     INITIALIZE PV-VARIABLE-ID                                    15820043
158700                PV-TALLY.                                         15830043
158800                                                                  15840043
158900     MOVE PV202-BWP-BUY-CNCTR-CDE         TO PV-VARIABLE-ID.      15850043
159000                                                                  15860043
159100     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            15870043
159200        FROM 1 BY 1                                               15880043
159300       UNTIL PV-EFBM-BIT-IDX > 3 OR                               15890043
159400           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    15900043
159500                                                                  15910043
159600     PERFORM 6850-MOVE-DELIMITER.                                 15920043
159700                                                                  15930043
159800*-------  MOVE CUSTFACG-SHRT-DESC----(NOT NULL)-----*******       15940043
159900                                                                  15950043
160000     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          15960043
160100                PV-TALLY.                                         15970043
160200                                                                  15980043
160300     IF PV202-CUSTFACG-SHRT-DESC = SPACES                         15990043
160400        PERFORM 6750-MOVE-SPACE                                   16000043
160500     ELSE                                                         16010043
160600        MOVE PV202-CUSTFACG-SHRT-DESC  TO PV-VARIABLE-OUTPUT-FIELD16020043
160700        PERFORM 6600-FIND-DATA-END                                16030043
160800          VARYING PV-EOF-IDX                                      16040043
160900             FROM 50 BY -1                                        16050043
161000             UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE        16060043
161100        PERFORM 6650-FIELD-MOVER                                  16070043
161200          VARYING PV-BIT-IDX                                      16080043
161300             FROM 1 BY 1                                          16090043
161400             UNTIL PV-BIT-IDX > PV-EOF-IDX                        16100043
161500                                                                  16110043
161600        PERFORM 6850-MOVE-DELIMITER                               16120043
161700     END-IF.                                                      16130043
161800                                                                  16140043
161900*-------  MOVE POS-BTN-TXT --------------(NULL)-----*******       16150043
162000                                                                  16160043
162100     INITIALIZE PV-VARIABLE-OUTPUT-FIELD                          16170043
162200                PV-TALLY.                                         16180043
162300     EVALUATE TRUE                                                16190043
162400         WHEN PV202-POS-BTN-TXT = '~'                             16200043
162500            PERFORM 6800-MOVE-NULL-VALUE                          16210043
162600         WHEN PV202-POS-BTN-TXT = SPACES                          16220043
162700            PERFORM 6750-MOVE-SPACE                               16230043
162800         WHEN OTHER                                               16240043
162900            MOVE PV202-POS-BTN-TXT    TO PV-VARIABLE-OUTPUT-FIELD 16250043
163000            PERFORM 6600-FIND-DATA-END                            16260043
163100               VARYING PV-EOF-IDX                                 16270043
163200                 FROM 50 BY -1                                    16280043
163300                 UNTIL PV-BIT-VARIABLE(PV-EOF-IDX) NOT = SPACE    16290043
163400            PERFORM 6650-FIELD-MOVER                              16300043
163500               VARYING PV-BIT-IDX                                 16310043
163600               FROM 1 BY 1                                        16320043
163700               UNTIL PV-BIT-IDX > PV-EOF-IDX                      16330043
163800                                                                  16340043
163900            PERFORM 6850-MOVE-DELIMITER                           16350043
164000     END-EVALUATE.                                                16360043
164100                                                                  16370043
164200*-------  MOVE VLD-POS-TNDR-CMP-TYP-CDE (NOT NULL)-----*******    16380043
164300                                                                  16390043
164400     INITIALIZE PV-VARIABLE-ID                                    16400043
164500                PV-TALLY.                                         16410043
164600                                                                  16420043
164700     MOVE PV202-VLD-POS-TNDR-CMP-TYP-CDE TO PV-VARIABLE-ID.       16430043
164800                                                                  16440043
164900     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            16450043
165000        FROM 1 BY 1                                               16460043
165100       UNTIL PV-EFBM-BIT-IDX > 3 OR                               16470043
165200           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                    16480043
165300                                                                  16490043
165400     PERFORM 6850-MOVE-DELIMITER.                                 16500043
165500                                                                  16510043
165600*-------  MOVE POS-BTN-RLTV-SEQ-NBR --------(NULL)-----*******    16520043
165700                                                                  16530043
165800     INITIALIZE PV-VARIABLE-ID                                    16540043
165900                PV-TALLY.                                         16550043
166000                                                                  16560043
166100     EVALUATE TRUE                                                16570043
166200         WHEN PV202-POS-BTN-RLTV-SEQ-NBR-X = '~'                  16580043
166300              PERFORM 6800-MOVE-NULL-VALUE                        16590043
166400         WHEN PV202-POS-BTN-RLTV-SEQ-NBR = ZEROES                 16600043
166500              PERFORM 6700-MOVE-ZERO                              16610043
166600         WHEN OTHER                                               16620043
166700                                                                  16630043
166800              INSPECT PV202-POS-BTN-RLTV-SEQ-NBR TALLYING PV-TALLY16640043
166900                  FOR LEADING ZEROES                              16650043
167000              SET PV-EFBM-IDX TO PV-TALLY                         16660043
167100              SET PV-EFBM-IDX UP BY 1                             16670043
167200              MOVE PV202-POS-BTN-RLTV-SEQ-NBR TO PV-VARIABLE-ID   16680043
167300                                                                  16690043
167400              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   16700043
167500                 FROM PV-EFBM-IDX BY 1                            16710043
167600                 UNTIL PV-EFBM-BIT-IDX > 10  OR                   16720043
167700                 PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '               16730043
167800                                                                  16740043
167900              PERFORM 6850-MOVE-DELIMITER                         16750043
168000     END-EVALUATE.                                                16760043
168100                                                                  16770043
168200*-------  MOVE LMT-PER-TRN-QTY -------------(NULL)-----*******    16780043
168300                                                                  16790043
168400     INITIALIZE PV-VARIABLE-ID                                    16800043
168500                PV-TALLY.                                         16810043
168600                                                                  16820043
168700     EVALUATE TRUE                                                16830043
168800         WHEN PV202-LMT-PER-TRN-QTY-X = '~'                       16840043
168900              PERFORM 6800-MOVE-NULL-VALUE                        16850043
169000         WHEN PV202-LMT-PER-TRN-QTY = ZEROES                      16860043
169100              PERFORM 6700-MOVE-ZERO                              16870043
169200         WHEN OTHER                                               16880043
169300              INSPECT PV202-LMT-PER-TRN-QTY TALLYING PV-TALLY     16890043
169400                  FOR LEADING ZEROES                              16900043
169500              SET PV-EFBM-IDX TO PV-TALLY                         16910043
169600              SET PV-EFBM-IDX UP BY 1                             16920043
169700                                                                  16930043
169800              MOVE PV202-LMT-PER-TRN-QTY TO PV-VARIABLE-ID        16940043
169900                                                                  16950043
170000              PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX   16960043
170100                 FROM PV-EFBM-IDX BY 1                            16970043
170200                 UNTIL PV-EFBM-BIT-IDX > 10 OR                    16980043
170300                     PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '           16990043
170400                                                                  17000043
170500              PERFORM 6850-MOVE-DELIMITER                         17010043
170600     END-EVALUATE.                                                17020043
170700                                                                  17030043
170800*4400-EXIT.                                                       17040043
170900 EJECT.                                                           17050043
171000                                                                  17060043
171100*----------------------------------------------------------       17070043
171200* 4450-MOVE-REST-BWP-DATA.                                        17080043
171300*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FILEDS FROM       17090043
171400*     EPRD203 COPYBOOK TO THE VARIABLE OUTPUT RECORD              17100043
171500*----------------------------------------------------------       17110043
171600 4450-MOVE-REST-BWP-DATA.                                         17120043
171700                                                                  17130043
171800*-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      17140043
171900                                                                  17150043
172000     INITIALIZE PV-VARIABLE-ID                                    17160043
172100                PV-TALLY.                                         17170043
172200                                                                  17180043
172300     MOVE PV203-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          17190043
172400                                                                  17200043
172500     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            17210043
172600        FROM 1 BY 1                                               17220043
172700       UNTIL PV-EFBM-BIT-IDX > 1.                                 17230043
172800                                                                  17240043
172900     PERFORM 6850-MOVE-DELIMITER.                                 17250043
173000                                                                  17260043
173100*-------  MOVE OFR-SECT-BWP-ID -------(NOT NULL)-----*******      17270043
173200                                                                  17280043
173300     INITIALIZE PV-VARIABLE-ID                                    17290043
173400                PV-TALLY.                                         17300043
173500                                                                  17310043
173600     INSPECT PV203-OFR-SECT-BWP-ID TALLYING PV-TALLY              17320043
173700         FOR LEADING ZEROES.                                      17330043
173800     SET PV-EFBM-IDX TO PV-TALLY.                                 17340043
173900     SET PV-EFBM-IDX UP BY 1.                                     17350043
174000     MOVE PV203-OFR-SECT-BWP-ID TO PV-VARIABLE-ID.                17360043
174100                                                                  17370043
174200     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            17380043
174300        FROM PV-EFBM-IDX BY 1                                     17390043
174400       UNTIL PV-EFBM-BIT-IDX > 10.                                17400043
174500                                                                  17410043
174600     PERFORM 6850-MOVE-DELIMITER.                                 17420043
174700                                                                  17430043
174800*-------  MOVE TIER-LVL-NBR    -------(NOT NULL)-----*******      17440043
174900                                                                  17450043
175000     INITIALIZE PV-VARIABLE-ID                                    17460043
175100                PV-TALLY.                                         17470043
175200     IF PV203-TIER-LVL-NBR = ZEROES                               17480043
175300        PERFORM 6700-MOVE-ZERO                                    17490043
175400     ELSE                                                         17500043
175500        INSPECT PV203-TIER-LVL-NBR TALLYING PV-TALLY              17510043
175600            FOR LEADING ZEROES                                    17520043
175700        SET PV-EFBM-IDX TO PV-TALLY                               17530043
175800        SET PV-EFBM-IDX UP BY 1                                   17540043
175900        MOVE PV203-TIER-LVL-NBR    TO PV-VARIABLE-ID              17550043
176000                                                                  17560043
176100        PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX         17570043
176200           FROM PV-EFBM-IDX BY 1                                  17580043
176300           UNTIL PV-EFBM-BIT-IDX > 10 OR                          17590043
176400           PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '                     17600043
176500                                                                  17610043
176600        PERFORM 6850-MOVE-DELIMITER                               17620043
176700     END-IF.                                                      17630043
176800                                                                  17640043
176900*-------  MOVE BWP-SELN-TYP-CDE-------(NOT NULL)-----*******      17650043
177000                                                                  17660043
177100     INITIALIZE PV-VARIABLE-ID                                    17670043
177200                PV-TALLY.                                         17680043
177300                                                                  17690043
177400     MOVE PV203-BWP-SELN-TYP-CDE      TO PV-VARIABLE-ID.          17700043
177500                                                                  17710043
177600     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            17720043
177700        FROM 1 BY 1                                               17730043
177800       UNTIL PV-EFBM-BIT-IDX > 3 OR                               17740043
177900       PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '.                        17750043
178000                                                                  17760043
178100     PERFORM 6850-MOVE-DELIMITER.                                 17770043
178200                                                                  17780043
178300*-------  MOVE BWP-BUY-QTY ---------------(NULL)-----*******      17790043
178400                                                                  17800043
178500     INITIALIZE PV-VARIABLE-ID                                    17810043
178600                PV-TALLY.                                         17820043
178700     EVALUATE TRUE                                                17830043
178800         WHEN PV203-BWP-BUY-QTY-X = '~'                           17840043
178900             PERFORM 6800-MOVE-NULL-VALUE                         17850043
179000         WHEN PV203-BWP-BUY-QTY = ZEROES                          17860043
179100             PERFORM 6700-MOVE-ZERO                               17870043
179200         WHEN OTHER                                               17880043
179300             INSPECT PV203-BWP-BUY-QTY  TALLYING PV-TALLY         17890043
179400                 FOR LEADING ZEROES                               17900043
179500             SET PV-EFBM-IDX TO PV-TALLY                          17910043
179600             SET PV-EFBM-IDX UP BY 1                              17920043
179700             MOVE PV203-BWP-BUY-QTY     TO PV-VARIABLE-ID         17930043
179800                                                                  17940043
179900             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    17950043
180000                FROM PV-EFBM-IDX BY 1                             17960043
180100                UNTIL PV-EFBM-BIT-IDX > 10 OR                     17970043
180200                PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '                17980043
180300                                                                  17990043
180400             PERFORM 6850-MOVE-DELIMITER                          18000043
180500     END-EVALUATE.                                                18010043
180600                                                                  18020043
180700*-------  MOVE BWP-BUY-AMT ---------------(NULL)-----*******      18030043
180800                                                                  18040043
180900     INITIALIZE PV-VARIABLE-ID                                    18050043
181000                PV-TALLY.                                         18060043
181100     EVALUATE TRUE                                                18070043
181200         WHEN PV203-BWP-BUY-AMT-X = '~'                           18080043
181300             PERFORM 6800-MOVE-NULL-VALUE                         18090043
181400         WHEN PV203-BWP-BUY-AMT = ZEROES                          18100043
181500             MOVE '.00'                 TO PV-VARIABLE-ID         18110043
181600                                                                  18120043
181700             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    18130043
181800                FROM 1 BY 1                                       18140043
181900                UNTIL PV-EFBM-BIT-IDX > 3                         18150043
182000                                                                  18160043
182100             PERFORM 6850-MOVE-DELIMITER                          18170043
182200         WHEN OTHER                                               18180043
182300             INSPECT PV203-BWP-BUY-AMT  TALLYING PV-TALLY         18190043
182400                 FOR LEADING ZEROES                               18200043
182500             SET PV-EFBM-IDX TO PV-TALLY                          18210043
182560                                                                  18220043
182570             EVALUATE TRUE                                        18230043
182580                                                                  18240043
182590                WHEN PV-EFBM-IDX < 7                              18250043
182591                   SET PV-EFBM-IDX UP BY +1                       18251043
182592                WHEN PV-EFBM-IDX = 8                              18252043
182593                   SET PV-EFBM-IDX DOWN BY +1                     18253043
182594                                                                  18254043
182595             END-EVALUATE                                         18255043
182596                                                                  18256043
182700             MOVE PV203-BWP-BUY-AMT     TO PV-VARIABLE-ID         18257043
182800                                                                  18258043
182900             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX18259043
183000                FROM PV-EFBM-IDX BY 1                             18260043
183100                UNTIL PV-EFBM-BIT-IDX > 10 OR                     18270043
183200                  PV-EFBM-VAR(PV-EFBM-BIT-IDX)  = ' '             18280043
183300                                                                  18290043
183400             PERFORM 6850-MOVE-DELIMITER                          18300043
183500     END-EVALUATE.                                                18310043
183600                                                                  18320043
183700*-------  MOVE BWP-BUY-TOL-AMT -----------(NULL)-----*******      18330043
183800                                                                  18340043
183900     INITIALIZE PV-VARIABLE-ID                                    18350043
184000                PV-TALLY.                                         18360043
184100     EVALUATE TRUE                                                18370043
184200         WHEN PV203-BWP-BUY-TOL-AMT-X = '~'                       18380043
184300             PERFORM 6800-MOVE-NULL-VALUE                         18390043
184400         WHEN PV203-BWP-BUY-TOL-AMT = ZEROES                      18400043
184500             MOVE '.00'                 TO PV-VARIABLE-ID         18410043
184600                                                                  18420043
184700             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX18430043
184800                FROM 1 BY 1                                       18440043
184900                UNTIL PV-EFBM-BIT-IDX > 3                         18450043
185000             PERFORM 6850-MOVE-DELIMITER                          18460043
185100                                                                  18470043
185200         WHEN OTHER                                               18480043
185300             INSPECT PV203-BWP-BUY-TOL-AMT  TALLYING PV-TALLY     18490043
185400                 FOR LEADING ZEROES                               18500043
185500             SET PV-EFBM-IDX TO PV-TALLY                          18510043
185560                                                                  18520043
185570             EVALUATE TRUE                                        18530043
185580                                                                  18540043
185590                WHEN PV-EFBM-IDX < 7                              18550043
185591                   SET PV-EFBM-IDX UP BY +1                       18551043
185592                WHEN PV-EFBM-IDX = 8                              18552043
185593                   SET PV-EFBM-IDX DOWN BY +1                     18553043
185594                                                                  18554043
185595             END-EVALUATE                                         18555043
185596                                                                  18556043
185700             MOVE PV203-BWP-BUY-TOL-AMT     TO PV-VARIABLE-ID     18557043
185800                                                                  18558043
185900             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX18559043
186000                FROM PV-EFBM-IDX BY 1                             18560043
186100                UNTIL PV-EFBM-BIT-IDX > 10  OR                    18570043
186200                   PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '             18580043
186300                                                                  18590043
186400             PERFORM 6850-MOVE-DELIMITER                          18600043
186500     END-EVALUATE.                                                18610043
186600                                                                  18620043
186700*-------  MOVE BWP-GET-QTY ---------------(NULL)-----*******      18630043
186800                                                                  18640043
186900     INITIALIZE PV-VARIABLE-ID                                    18650043
187000                PV-TALLY.                                         18660043
187100     EVALUATE TRUE                                                18670043
187200         WHEN PV203-BWP-GET-QTY-X = '~'                           18680043
187300             PERFORM 6800-MOVE-NULL-VALUE                         18690043
187400         WHEN PV203-BWP-GET-QTY = ZEROES                          18700043
187500             PERFORM 6700-MOVE-ZERO                               18710043
187600         WHEN OTHER                                               18720043
187700             INSPECT PV203-BWP-GET-QTY  TALLYING PV-TALLY         18730043
187800                 FOR LEADING ZEROES                               18740043
187900             SET PV-EFBM-IDX TO PV-TALLY                          18750043
188000             SET PV-EFBM-IDX UP BY 1                              18760043
188100             MOVE PV203-BWP-GET-QTY     TO PV-VARIABLE-ID         18770043
188200                                                                  18780043
188300             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    18790043
188400                FROM PV-EFBM-IDX BY 1                             18800043
188500                UNTIL PV-EFBM-BIT-IDX > 10 OR                     18810043
188600                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              18820043
188700                                                                  18830043
188800             PERFORM 6850-MOVE-DELIMITER                          18840043
188900     END-EVALUATE.                                                18850043
189000                                                                  18860043
189100*-------  MOVE GET-PCT-OFF-PCT------------(NULL)-----*******      18870043
189200                                                                  18880043
189300     INITIALIZE PV-VARIABLE-ID                                    18890043
189400                PV-TALLY.                                         18900043
189500     EVALUATE TRUE                                                18910043
189600         WHEN PV203-BWP-GET-PCT-OFF-PCT-X = '~'                   18920043
189700             PERFORM 6800-MOVE-NULL-VALUE                         18930043
189800         WHEN PV203-BWP-GET-PCT-OFF-PCT = ZEROES                  18940043
189900             PERFORM 6700-MOVE-ZERO                               18950043
190000         WHEN OTHER                                               18960043
190100             INSPECT PV203-BWP-GET-PCT-OFF-PCT  TALLYING PV-TALLY 18970043
190200                 FOR LEADING ZEROES                               18980043
190300             SET PV-EFBM-IDX TO PV-TALLY                          18990043
190400             SET PV-EFBM-IDX UP BY 1                              19000043
190500             MOVE PV203-BWP-GET-PCT-OFF-PCT TO PV-VARIABLE-ID     19010043
190600                                                                  19020043
190700             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    19030043
190800                FROM PV-EFBM-IDX BY 1                             19040043
190900                UNTIL PV-EFBM-BIT-IDX > 10 OR                     19050043
191000                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              19060043
191100                                                                  19070043
191200             PERFORM 6850-MOVE-DELIMITER                          19080043
191300     END-EVALUATE.                                                19090043
191400                                                                  19100043
191500*-------  MOVE GET-DOL-OFF-AMT------------(NULL)-----*******      19110043
191600                                                                  19120043
191610     MOVE PV203-BWP-GET-DOL-OFF-AMT TO   PV-DDG-9FOR7D.           19130043
191700     INITIALIZE PV-VARIABLE-ID                                    19140043
191800                PV-TALLY.                                         19150043
191900     EVALUATE TRUE                                                19160043
192000         WHEN PV203-BWP-GET-DOL-OFF-AMT-X = '~'                   19170043
192100             PERFORM 6800-MOVE-NULL-VALUE                         19180043
192200         WHEN PV203-BWP-GET-DOL-OFF-AMT = ZEROES                  19190043
192300             PERFORM 6700-MOVE-ZERO                               19200043
192400         WHEN OTHER                                               19210043
192500             INSPECT PV203-BWP-GET-DOL-OFF-AMT  TALLYING PV-TALLY 19220043
192600                 FOR LEADING ZEROES                               19230043
192700             SET PV-EFBM-IDX TO PV-TALLY                          19240043
192701                                                                  19250043
192702             EVALUATE TRUE                                        19260043
192703                                                                  19270043
192704                WHEN PV-EFBM-IDX < 7                              19270143
192705                   SET PV-EFBM-IDX UP BY +1                       19270243
192706                WHEN PV-EFBM-IDX = 8                              19270343
192707                   SET PV-EFBM-IDX DOWN BY +1                     19270443
192708                                                                  19270543
192709             END-EVALUATE                                         19270643
192710                                                                  19270743
192900             MOVE PV203-BWP-GET-DOL-OFF-AMT TO PV-VARIABLE-ID     19270843
193000                                                                  19270943
193100             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX19271043
193200                FROM PV-EFBM-IDX BY 1                             19272043
193300                UNTIL PV-EFBM-BIT-IDX > 10  OR                    19273043
193400                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              19274043
193500                                                                  19275043
193600             PERFORM 6850-MOVE-DELIMITER                          19276043
193700     END-EVALUATE.                                                19277043
193800                                                                  19278043
193900*-------  MOVE GET-PRPT-AMT --------------(NULL)-----*******      19279043
194000                                                                  19280043
194100     INITIALIZE PV-VARIABLE-ID                                    19290043
194200                PV-TALLY.                                         19300043
194300     EVALUATE TRUE                                                19310043
194400         WHEN PV203-BWP-GET-PRPT-AMT-X = '~'                      19320043
194500             PERFORM 6800-MOVE-NULL-VALUE                         19330043
194600         WHEN PV203-BWP-GET-PRPT-AMT = ZEROES                     19340043
194700             PERFORM 6700-MOVE-ZERO                               19350043
194800         WHEN OTHER                                               19360043
194900             INSPECT PV203-BWP-GET-PRPT-AMT  TALLYING PV-TALLY    19370043
195000                 FOR LEADING ZEROES                               19380043
195100             SET PV-EFBM-IDX TO PV-TALLY                          19390043
195110                                                                  19400043
195111             EVALUATE TRUE                                        19410043
195112                                                                  19420043
195113                WHEN PV-EFBM-IDX < 7                              19430043
195114                   SET PV-EFBM-IDX UP BY +1                       19440043
195115                WHEN PV-EFBM-IDX = 8                              19450043
195116                   SET PV-EFBM-IDX DOWN BY +1                     19460043
195117                                                                  19470043
195118             END-EVALUATE                                         19480043
195119                                                                  19490043
195300             MOVE PV203-BWP-GET-PRPT-AMT TO PV-VARIABLE-ID        19500043
195400                                                                  19510043
195500             PERFORM 6550-MOVE-AMT-ID-DATA VARYING PV-EFBM-BIT-IDX19520043
195600                FROM PV-EFBM-IDX BY 1                             19530043
195700                UNTIL PV-EFBM-BIT-IDX > 10 OR                     19540043
195800                  PV-EFBM-VAR(PV-EFBM-BIT-IDX) = ' '              19550043
195900                                                                  19560043
196000             PERFORM 6850-MOVE-DELIMITER                          19570043
196010                                                                  19580043
196100     END-EVALUATE.                                                19590043
196200                                                                  19600043
196300                                                                  19610043
196400*4450-EXIT.                                                       19620043
196500 EJECT.                                                           19630043
196600                                                                  19640043
196700*----------------------------------------------------------       19650043
196800* 4500-MOVE-REST-MDSE-DATA.                                       19660043
196900*     THIS PARAGRAPH FORMATS AND MOVES THE DATA FIELDS FROM       19670043
197000*     EPRD204 COPYBOOK TO THE VARIABLE OUTPUT RECORD              19680043
197100*----------------------------------------------------------       19690043
197200 4500-MOVE-REST-MDSE-DATA.                                        19700043
197300                                                                  19710043
197400*-------  MOVE OFR-SECT-TYP-CDE-------(NOT NULL)-----*******      19720043
197500                                                                  19730043
197600     INITIALIZE PV-VARIABLE-ID                                    19740043
197700                PV-TALLY.                                         19750043
197800                                                                  19760043
197900     MOVE PV204-OFR-SECT-TYP-CDE      TO PV-VARIABLE-ID.          19770043
198000                                                                  19780043
198100     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            19790043
198200        FROM 1 BY 1                                               19800043
198300       UNTIL PV-EFBM-BIT-IDX > 1.                                 19810043
198400                                                                  19820043
198500     PERFORM 6850-MOVE-DELIMITER.                                 19830043
198600                                                                  19840043
198700*-------  MOVE OFR-SECT-BWP-ID -------(NOT NULL)-----*******      19850043
198800                                                                  19860043
198900     INITIALIZE PV-VARIABLE-ID                                    19870043
199000                PV-TALLY.                                         19880043
199100                                                                  19890043
199200     INSPECT PV204-OFR-SECT-BWP-ID TALLYING PV-TALLY              19900043
199300         FOR LEADING ZEROES.                                      19910043
199400     SET PV-EFBM-IDX TO PV-TALLY.                                 19920043
199500     SET PV-EFBM-IDX UP BY 1.                                     19930043
199600     MOVE PV204-OFR-SECT-BWP-ID TO PV-VARIABLE-ID.                19940043
199700                                                                  19950043
199800     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            19960043
199900        FROM PV-EFBM-IDX BY 1                                     19970043
200000       UNTIL PV-EFBM-BIT-IDX > 10.                                19980043
200100                                                                  19990043
200200     PERFORM 6850-MOVE-DELIMITER.                                 20000043
200300                                                                  20010043
200400*-------  MOVE OFR-SECT-MDSE-SET-ID --(NOT NULL)-----*******      20020043
200500                                                                  20030043
200600     INITIALIZE PV-VARIABLE-ID                                    20040043
200700                PV-TALLY.                                         20050043
200800                                                                  20060043
200900     INSPECT PV204-MDSE-SET-ID TALLYING PV-TALLY                  20070043
201000         FOR LEADING ZEROES.                                      20080043
201100     SET PV-EFBM-IDX TO PV-TALLY.                                 20090043
201200     SET PV-EFBM-IDX UP BY 1.                                     20100043
201300     MOVE PV204-MDSE-SET-ID TO PV-VARIABLE-ID.                    20110043
201400                                                                  20120043
201500     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            20130043
201600        FROM PV-EFBM-IDX BY 1                                     20140043
201700       UNTIL PV-EFBM-BIT-IDX > 10.                                20150043
201800                                                                  20160043
201900     PERFORM 6850-MOVE-DELIMITER.                                 20170043
202000                                                                  20180043
202100*-------  MOVE MDSE-HIER-CDE ---------(NOT NULL)-----*******      20190043
202200                                                                  20200043
202300     INITIALIZE PV-VARIABLE-ID                                    20210043
202400                PV-TALLY.                                         20220043
202500                                                                  20230043
202600     MOVE PV204-MDSE-HIER-CDE TO PV-VARIABLE-ID.                  20240043
202700                                                                  20250043
202800     PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX            20260043
202900        FROM 1 BY 1                                               20270043
203000       UNTIL PV-EFBM-BIT-IDX > 3 OR                               20280043
203100             PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE.                20290043
203110                                                                  20300043
203200     PERFORM 6850-MOVE-DELIMITER.                                 20310043
203300                                                                  20320043
203400*-------  MOVE DEPT-NBR ------------------(NULL)-----*******      20330043
203500                                                                  20340043
203600     INITIALIZE PV-VARIABLE-ID                                    20350043
203700                PV-TALLY.                                         20360043
203800     EVALUATE TRUE                                                20370043
203900         WHEN PV204-DEPT-NBR-X = '~'                              20380043
204000             PERFORM 6800-MOVE-NULL-VALUE                         20390043
204100         WHEN PV204-DEPT-NBR   = ZEROES                           20400043
204200             PERFORM 6700-MOVE-ZERO                               20410043
204300         WHEN OTHER                                               20420043
204400             INSPECT PV204-DEPT-NBR  TALLYING PV-TALLY            20430043
204500                 FOR LEADING ZEROES                               20440043
204600             SET PV-EFBM-IDX TO PV-TALLY                          20450043
204700             SET PV-EFBM-IDX UP BY 1                              20460043
204800             MOVE PV204-DEPT-NBR TO PV-VARIABLE-ID                20470043
204900                                                                  20480043
205000             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    20490043
205100                FROM PV-EFBM-IDX BY 1                             20500043
205200                UNTIL PV-EFBM-BIT-IDX > 4 OR                      20510043
205300                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        20520043
205400                                                                  20530043
205500             PERFORM 6850-MOVE-DELIMITER                          20540043
205600     END-EVALUATE.                                                20550043
205700                                                                  20560043
205800*-------  MOVE MAJ-CL-NBR ----------------(NULL)-----*******      20570043
205900                                                                  20580043
206000     INITIALIZE PV-VARIABLE-ID                                    20590043
206100                PV-TALLY.                                         20600043
206200     EVALUATE TRUE                                                20610043
206300         WHEN PV204-MAJ-CL-NBR-X = '~'                            20620043
206400             PERFORM 6800-MOVE-NULL-VALUE                         20630043
206500         WHEN PV204-MAJ-CL-NBR = ZEROES                           20640043
206600             PERFORM 6700-MOVE-ZERO                               20650043
206700         WHEN OTHER                                               20660043
206800             INSPECT PV204-MAJ-CL-NBR  TALLYING PV-TALLY          20670043
206900                 FOR LEADING ZEROES                               20680043
207000             SET PV-EFBM-IDX TO PV-TALLY                          20690043
207100             SET PV-EFBM-IDX UP BY 1                              20700043
207200             MOVE PV204-MAJ-CL-NBR TO PV-VARIABLE-ID              20710043
207300                                                                  20720043
207400             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    20730043
207500                FROM PV-EFBM-IDX BY 1                             20740043
207600                UNTIL PV-EFBM-BIT-IDX > 4 OR                      20750043
207700                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        20760043
207800                                                                  20770043
207900             PERFORM 6850-MOVE-DELIMITER                          20780043
208000     END-EVALUATE.                                                20790043
208100                                                                  20800043
208200*-------  MOVE SUB-CL-NBR ----------------(NULL)-----*******      20810043
208300                                                                  20820043
208400     INITIALIZE PV-VARIABLE-ID                                    20830043
208500                PV-TALLY.                                         20840043
208600     EVALUATE TRUE                                                20850043
208700         WHEN PV204-SUB-CL-NBR-X = '~'                            20860043
208800             PERFORM 6800-MOVE-NULL-VALUE                         20870043
208900         WHEN PV204-SUB-CL-NBR = ZEROES                           20880043
209000             PERFORM 6700-MOVE-ZERO                               20890043
209100         WHEN OTHER                                               20900043
209200             INSPECT PV204-SUB-CL-NBR  TALLYING PV-TALLY          20910043
209300                 FOR LEADING ZEROES                               20920043
209400             SET PV-EFBM-IDX TO PV-TALLY                          20930043
209500             SET PV-EFBM-IDX UP BY 1                              20940043
209600             MOVE PV204-SUB-CL-NBR TO PV-VARIABLE-ID              20950043
209700                                                                  20960043
209800             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    20970043
209900                FROM PV-EFBM-IDX BY 1                             20980043
210000                UNTIL PV-EFBM-BIT-IDX > 4 OR                      20990043
210100                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        21000043
210200                                                                  21010043
210300             PERFORM 6850-MOVE-DELIMITER                          21020043
210400     END-EVALUATE.                                                21030043
210500                                                                  21040043
210600*-------  MOVE STYL-ID -- ----------------(NULL)-----*******      21050043
210700                                                                  21060043
210800     INITIALIZE PV-VARIABLE-ID                                    21070043
210900                PV-TALLY.                                         21080043
211000     EVALUATE TRUE                                                21090043
211100         WHEN PV204-STYL-ID-X = '~'                               21100043
211200             PERFORM 6800-MOVE-NULL-VALUE                         21110043
211300         WHEN PV204-STYL-ID = ZEROES                              21120043
211400             PERFORM 6700-MOVE-ZERO                               21130043
211500         WHEN OTHER                                               21140043
211600             INSPECT PV204-STYL-ID     TALLYING PV-TALLY          21150043
211700                 FOR LEADING ZEROES                               21160043
211800             SET PV-EFBM-IDX TO PV-TALLY                          21170043
211900             SET PV-EFBM-IDX UP BY 1                              21180043
212000             MOVE PV204-STYL-ID    TO PV-VARIABLE-ID              21190043
212100                                                                  21200043
212200             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    21210043
212300                FROM PV-EFBM-IDX BY 1                             21220043
212400                UNTIL PV-EFBM-BIT-IDX > 8 OR                      21230043
212500                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        21240043
212600                                                                  21250043
212700             PERFORM 6850-MOVE-DELIMITER                          21260043
212800     END-EVALUATE.                                                21270043
212900                                                                  21280043
213000*-------  MOVE SKU-NBR -------------------(NULL)-----*******      21290043
213100                                                                  21300043
213200     INITIALIZE PV-VARIABLE-ID                                    21310043
213300                PV-TALLY.                                         21320043
213400     EVALUATE TRUE                                                21330043
213500         WHEN PV204-SKU-NBR-X = '~'                               21340043
213600             PERFORM 6800-MOVE-NULL-VALUE                         21350043
213700         WHEN PV204-SKU-NBR = ZEROES                              21360043
213800             PERFORM 6700-MOVE-ZERO                               21370043
213900         WHEN OTHER                                               21380043
214000             INSPECT PV204-SKU-NBR     TALLYING PV-TALLY          21390043
214100                 FOR LEADING ZEROES                               21400043
214200             SET PV-EFBM-IDX TO PV-TALLY                          21410043
214300             SET PV-EFBM-IDX UP BY 1                              21420043
214400             MOVE PV204-SKU-NBR    TO PV-VARIABLE-ID              21430043
214500                                                                  21440043
214600             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    21450043
214700                FROM PV-EFBM-IDX BY 1                             21460043
214800                UNTIL PV-EFBM-BIT-IDX > 8 OR                      21470043
214900                      PV-EFBM-VAR(PV-EFBM-BIT-IDX) = SPACE        21480043
215000                                                                  21490043
215100             PERFORM 6850-MOVE-DELIMITER                          21500043
215200     END-EVALUATE.                                                21510043
215300                                                                  21520043
215400*-------  MOVE IE-IND  ---------------(NOT NULL)-----*******      21530043
215500                                                                  21540043
215600     INITIALIZE PV-VARIABLE-ID                                    21550043
215700                PV-TALLY.                                         21560043
215800     EVALUATE TRUE                                                21570043
215900         WHEN PV204-IE-IND = SPACES                               21580043
216000             PERFORM 6750-MOVE-SPACE                              21590043
216100         WHEN OTHER                                               21600043
216200             MOVE PV204-IE-IND     TO PV-VARIABLE-ID              21610043
216300                                                                  21620043
216400             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    21630043
216500                FROM 1 BY 1                                       21640043
216600                UNTIL PV-EFBM-BIT-IDX > 1                         21650043
216700                                                                  21660043
216800             PERFORM 6850-MOVE-DELIMITER                          21670043
216900     END-EVALUATE.                                                21680043
217000                                                                  21690043
217100*-------  MOVE EMP-DISC-CDE --------------(NULL)-----*******      21700043
217200                                                                  21710043
217300     INITIALIZE PV-VARIABLE-ID                                    21720043
217400                PV-TALLY.                                         21730043
217500     EVALUATE TRUE                                                21740043
217600         WHEN PV204-EMP-DISC-CDE = '~'                            21750043
217700             PERFORM 6800-MOVE-NULL-VALUE                         21760043
217800         WHEN PV204-EMP-DISC-CDE = SPACES                         21770043
217900             PERFORM 6750-MOVE-SPACE                              21780043
218000         WHEN OTHER                                               21790043
218100             MOVE PV204-EMP-DISC-CDE     TO PV-VARIABLE-ID        21800043
218200                                                                  21810043
218300             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    21820043
218400                FROM 1 BY 1                                       21830043
218500                UNTIL PV-EFBM-BIT-IDX > 1                         21840043
218600                                                                  21850043
218700             PERFORM 6850-MOVE-DELIMITER                          21860043
218800     END-EVALUATE.                                                21870043
218900                                                                  21880043
219000*-------  MOVE DISC-ELIG-IND--------------(NULL)-----*******      21890043
219100                                                                  21900043
219200     INITIALIZE PV-VARIABLE-ID                                    21910043
219300                PV-TALLY.                                         21920043
219400     EVALUATE TRUE                                                21930043
219500         WHEN PV204-DISC-ELIG-IND = '~'                           21940043
219600             PERFORM 6800-MOVE-NULL-VALUE                         21950043
219700         WHEN PV204-DISC-ELIG-IND = SPACES                        21960043
219800             PERFORM 6750-MOVE-SPACE                              21970043
219900         WHEN OTHER                                               21980043
220000             MOVE PV204-DISC-ELIG-IND    TO PV-VARIABLE-ID        21990043
220100                                                                  22000043
220200             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    22010043
220300                FROM 1 BY 1                                       22020043
220400                UNTIL PV-EFBM-BIT-IDX > 1                         22030043
220500                                                                  22040043
220600             PERFORM 6850-MOVE-DELIMITER                          22050043
220700     END-EVALUATE.                                                22060043
220800                                                                  22070043
220900*-------  MOVE TKT-CLOR-CDE --------------(NULL)-----*******      22080043
221000                                                                  22090043
221100     INITIALIZE PV-VARIABLE-ID                                    22100043
221200                PV-TALLY.                                         22110043
221300     EVALUATE TRUE                                                22120043
221400         WHEN PV204-TKT-CLOR-CDE  = '~'                           22130043
221500             PERFORM 6800-MOVE-NULL-VALUE                         22140043
221600         WHEN PV204-TKT-CLOR-CDE  = SPACES                        22150043
221700             PERFORM 6750-MOVE-SPACE                              22160043
221800         WHEN OTHER                                               22170043
221900             MOVE PV204-TKT-CLOR-CDE     TO PV-VARIABLE-ID        22180043
222000                                                                  22190043
222100             PERFORM 6500-MOVE-ID-DATA VARYING PV-EFBM-BIT-IDX    22200043
222200                FROM 1 BY 1                                       22210043
222300                UNTIL PV-EFBM-BIT-IDX > 1                         22220043
222400                                                                  22230043
222500             PERFORM 6850-MOVE-DELIMITER                          22240043
222600     END-EVALUATE.                                                22250043
222700                                                                  22260043
222800                                                                  22270043
222900*4500-EXIT.                                                       22280043
223000 EJECT.                                                           22290043
223100                                                                  22300043
223200*-------------------------------------------------------------    22310043
223300* 5000-INCR-HEADER-TIMESTAMP.                                     22320043
223400*     THIS PARAGRAPH WILL INCREMENT THE TIMESTAMP BY 1 SECOND     22330043
223500*-------------------------------------------------------------    22340043
223600 5000-INCR-HEADER-TIMESTAMP.                                      22350043
223700                                                                  22360043
223800     ADD 1                                                        22370043
223900       TO PV-HEADER-SS.                                           22380043
224000     IF PV-HEADER-SS GREATER 59                                   22390043
224100         MOVE ZERO                                                22400043
224200           TO PV-HEADER-SS                                        22410043
224300         ADD 1                                                    22420043
224400           TO PV-HEADER-MM                                        22430043
224500     END-IF.                                                      22440043
224600                                                                  22450043
224700     IF PV-HEADER-MM GREATER 59                                   22460043
224800         MOVE ZERO                                                22470043
224900           TO PV-HEADER-MM                                        22480043
225000         ADD 1                                                    22490043
225100           TO PV-HEADER-HH                                        22500043
225200     END-IF.                                                      22510043
225300                                                                  22520043
225400     IF PV-HEADER-HH GREATER 23                                   22530043
225500         MOVE ZERO                                                22540043
225600           TO PV-HEADER-HH                                        22550043
225700         ADD 1                                                    22560043
225800           TO PV-HEADER-DD                                        22570043
225900     END-IF.                                                      22580043
226000                                                                  22590043
226100     IF PV-HEADER-MO = 01                                         22600043
226200       OR PV-HEADER-MO = 03                                       22610043
226300         OR PV-HEADER-MO = 05                                     22620043
226400           OR PV-HEADER-MO = 07                                   22630043
226500             OR PV-HEADER-MO = 08                                 22640043
226600               OR PV-HEADER-MO = 10                               22650043
226700                 OR PV-HEADER-MO = 12                             22660043
226800         IF PV-HEADER-DD GREATER 31                               22670043
226900             MOVE 1                                               22680043
227000               TO PV-HEADER-DD                                    22690043
227100             ADD 1                                                22700043
227200               TO PV-HEADER-MO                                    22710043
227300         END-IF                                                   22720043
227400     ELSE                                                         22730043
227500         IF PV-HEADER-MO = 04                                     22740043
227600           OR PV-HEADER-MO = 06                                   22750043
227700             OR PV-HEADER-MO = 09                                 22760043
227800               OR PV-HEADER-MO = 11                               22770043
227900             IF PV-HEADER-DD GREATER 30                           22780043
228000                 MOVE 1                                           22790043
228100                   TO PV-HEADER-DD                                22800043
228200                 ADD 1                                            22810043
228300                   TO PV-HEADER-MO                                22820043
228400             END-IF                                               22830043
228500         ELSE                                                     22840043
228600             IF PV-HEADER-MO = 02                                 22850043
228700                 DIVIDE PV-HEADER-YYYY BY 100                     22860043
228800                   GIVING PV-QUOTIENT                             22870043
228900                     REMAINDER PV-RMDR-100                        22880043
229000                 DIVIDE PV-HEADER-YYYY BY 4                       22890043
229100                   GIVING PV-QUOTIENT                             22900043
229200                     REMAINDER PV-RMDR-4                          22910043
229300                 IF PV-RMDR-100 = 0                               22920043
229400                     IF PV-HEADER-DD GREATER 28                   22930043
229500                         MOVE 1                                   22940043
229600                           TO PV-HEADER-DD                        22950043
229700                         ADD 1                                    22960043
229800                           TO PV-HEADER-MO                        22970043
229900                     END-IF                                       22980043
230000                 ELSE                                             22990043
230100                     IF PV-RMDR-4 = 0                             23000043
230200                         IF PV-HEADER-DD GREATER 29               23010043
230300                             MOVE 1                               23020043
230400                               TO PV-HEADER-DD                    23030043
230500                             ADD 1                                23040043
230600                               TO PV-HEADER-MO                    23050043
230700                         END-IF                                   23060043
230800                     ELSE                                         23070043
230900                         IF PV-HEADER-DD GREATER 28               23080043
231000                             MOVE 1                               23090043
231100                               TO PV-HEADER-DD                    23100043
231200                             ADD 1                                23110043
231300                               TO PV-HEADER-MO                    23120043
231400                         END-IF                                   23130043
231500                     END-IF                                       23140043
231600                 END-IF                                           23150043
231700             END-IF                                               23160043
231800         END-IF                                                   23170043
231900     END-IF.                                                      23180043
232000                                                                  23190043
232100     IF PV-HEADER-MO GREATER 12                                   23200043
232200         MOVE 1                                                   23210043
232300           TO PV-HEADER-MO                                        23220043
232400         ADD 1                                                    23230043
232500           TO PV-HEADER-YYYY                                      23240043
232600     END-IF.                                                      23250043
232700                                                                  23260043
232800*5000-EXIT.                                                       23270043
232900 EJECT.                                                           23280043
233000                                                                  23290043
233100*----------------------------------------------------------       23300043
233200* 5100-PROCESS-STORE-LIST.                                        23310043
233300*     WHEN THE FLOW REACHES THIS PARAGRAPH, IT ALREADY HAS ONE    23320043
233400*     RECORDS READ FROM THE EPRD206 STORE LIST FILE, IT WILL      23330043
233500*     UPDATE PV-SL001-KEY AND PS-SL002-KEY AS REQUIRED.           23340043
233600*     THE PARAGRAPH ALSO UPDATES THE PV-CURR-OFFER-STORE-KEY      23350043
233700*     VALUES, THIS HELPS IS BUILDING THE HEADER RECORDS.          23360043
233710*                                                                 23370043
233720* PLEASE NOTE: THE PERFORM OF PARA 5600 IS AT THE END, AND IT     23371043
233730*             SHOULD BE PERFORMED EVEN AFTER REACHING END OF STORE23372043
233740*             FILE. 5600- SETS THE EXCLUSION STORE INDICATOR SWTCH23373043
233750*             WHICH IS NECESSARY FOR BUILDING THE HEADER RECORDS. 23374043
233760*                                                                 23375043
233800*----------------------------------------------------------       23376043
233900 5100-PROCESS-STORE-LIST.                                         23377043
234000                                                                  23378043
234100        PERFORM 5300-MOVE-VALUES-TO-SL0001.                       23379043
234200                                                                  23380043
234300        PERFORM 5700-UPDATE-CURRENT-OFR-STR.                      23390043
234400                                                                  23400043
234500        PERFORM 6900-READ-STORE-LIST-FILE.                        23410043
234600                                                                  23420043
234700        IF PS-NOT-END-OF-STORE-FILE                               23430043
234800          PERFORM 5400-MOVE-VALUES-TO-SL0002                      23440043
234900        ELSE                                                      23450043
235000          IF PS-END-OF-STORE-FILE                                 23460043
235100            MOVE SPACES TO PV-SL002-KEY                           23470043
235200          END-IF                                                  23480043
235300        END-IF.                                                   23490043
235400                                                                  23500043
235500        PERFORM 5600-FIND-IF-EXCEPTN-STR.                         23510043
235600                                                                  23520043
235700*5100-EXIT.                                                       23530043
235800 EJECT.                                                           23540043
235900*----------------------------------------------------------       23550043
236000* 5300-MOVE-VALUES-TO-SL0001                                      23560043
236100*     THIS PARAGRAPH LOADS THE VALUES FROM THE INPUT FILE TO      23570043
236200*     PV-SL001-KEY                                                23580043
236300*----------------------------------------------------------       23590043
236400 5300-MOVE-VALUES-TO-SL0001.                                      23600043
236500                                                                  23610043
236600     MOVE EP206-ADD-DLT-FLG TO  PV-SL001-ADD-DLT-FLG.             23620043
236700     MOVE EP206-EVENT-ID TO   PV-SL001-EVENT-ID.                  23630043
236800     MOVE EP206-OFFER-ID TO   PV-SL001-OFFER-ID.                  23640043
236900     MOVE EP206-OFR-SECT-TYP-CDE TO                               23650043
237000                             PV-SL001-OFR-SECT-TYP-CDE.           23660043
237100     MOVE EP206-STR-GRP-TYP-CDE  TO                               23670043
237200                             PV-SL001-STR-GRP-TYP-CDE.            23680043
237300     MOVE EP206-STR-GRP-ID  TO PV-SL001-STR-GRP-ID.               23690043
237400     MOVE EP206-IE-IND      TO PV-SL001-IE-IND.                   23700043
237500                                                                  23710043
237600*5300-EXIT.                                                       23720043
237700 EJECT.                                                           23730043
237800*----------------------------------------------------------       23740043
237900* 5400-MOVE-VALUES-TO-SL0002                                      23750043
238000*     THIS PARAGRAPH LOADS THE VALUES FROM THE INPUT FILE TO      23760043
238100*     PV-SL002-KEY                                                23770043
238200*----------------------------------------------------------       23780043
238300 5400-MOVE-VALUES-TO-SL0002.                                      23790043
238400                                                                  23800043
238500     MOVE EP206-ADD-DLT-FLG TO  PV-SL002-ADD-DLT-FLG.             23810043
238600     MOVE EP206-EVENT-ID TO   PV-SL002-EVENT-ID.                  23820043
238700     MOVE EP206-OFFER-ID TO   PV-SL002-OFFER-ID.                  23830043
238800     MOVE EP206-OFR-SECT-TYP-CDE TO                               23840043
238900                             PV-SL002-OFR-SECT-TYP-CDE.           23850043
239000     MOVE EP206-STR-GRP-TYP-CDE  TO                               23860043
239100                             PV-SL002-STR-GRP-TYP-CDE.            23870043
239200     MOVE EP206-STR-GRP-ID  TO PV-SL002-STR-GRP-ID.               23880043
239300     MOVE EP206-IE-IND      TO PV-SL002-IE-IND.                   23890043
239400                                                                  23900043
239500*5400-EXIT.                                                       23910043
239600 EJECT.                                                           23920043
239700*----------------------------------------------------------       23930043
239800* 5500-ROLL-SL0002-TO-SL0001                                      23940043
239900*     THIS PARAGRAPH ROLLS OVER THE VALUES FROM KEY 2 TO KEY 1    23950043
240000*----------------------------------------------------------       23960043
240100 5500-ROLL-SL0002-TO-SL0001.                                      23970043
240200                                                                  23980043
240300     MOVE PV-SL002-ADD-DLT-FLG TO PV-SL001-ADD-DLT-FLG.           23990043
240400     MOVE PV-SL002-EVENT-ID  TO   PV-SL001-EVENT-ID.              24000043
240500     MOVE PV-SL002-OFFER-ID  TO   PV-SL001-OFFER-ID.              24010043
240600     MOVE PV-SL002-OFR-SECT-TYP-CDE  TO                           24020043
240700                             PV-SL001-OFR-SECT-TYP-CDE.           24030043
240800     MOVE PV-SL002-STR-GRP-TYP-CDE   TO                           24040043
240900                             PV-SL001-STR-GRP-TYP-CDE.            24050043
241000     MOVE PV-SL002-STR-GRP-ID  TO PV-SL001-STR-GRP-ID.            24060043
241100     MOVE PV-SL002-IE-IND      TO PV-SL001-IE-IND.                24070043
241200                                                                  24080043
241300*5500-EXIT.                                                       24090043
241400 EJECT.                                                           24100043
241500*----------------------------------------------------------       24110043
241600* 5600-FIND-IF-EXCEPTN-STR                                        24120043
241700*     THIS PARAGRAPH DETERMINEX OF EXCEPTION STORE EXISTS FOR     24130043
241800*     THE CURRENT OFFER BEING PROCESSED.                          24140043
241900*  UPDATES THE SWTCH APPROPRIATELY                                24150043
242000*----------------------------------------------------------       24160043
242100 5600-FIND-IF-EXCEPTN-STR.                                        24170043
242200                                                                  24180043
242300     IF PV-SL002-IE-IND = 'N' AND                                 24190043
242400        PV-SL002-EVENT-ID = PV-SL001-EVENT-ID AND                 24200043
242500        PV-SL002-OFFER-ID = PV-SL001-OFFER-ID AND                 24210043
242600        PV-SL001-OFFER-ID = PV-CURR-OFFER-ID                      24220043
242700        ADD 1 TO PV-EXCEPTION-COUNTER                             24230043
242800          SET PS-EXCEPTN-STR-EXISTS TO TRUE                       24240043
242900     ELSE                                                         24250043
243000          SET PS-NO-EXCEPTN-STR-EXISTS TO TRUE                    24260043
243100     END-IF.                                                      24270043
243200                                                                  24280043
243300*5600-EXIT.                                                       24290043
243400 EJECT.                                                           24300043
243500                                                                  24310043
243600*------------------------------------------------------------*    24320043
243700* 5700-UPDATE-CURRENT-OFR-STR                                *    24330043
243800*     THIS PARAGRAPH WILL UPDATE THE VALUES IN               *    24340043
243900*     PV-CURR-OFFER-STORE-KEY FROM PV-SL001-KEY              *    24350043
244000*------------------------------------------------------------*    24360043
244100 5700-UPDATE-CURRENT-OFR-STR.                                     24370043
244200                                                                  24380043
244300     MOVE PV-SL001-ADD-DLT-FLG       TO  PV-CURR-ADD-DLT-FLG.     24390043
244400     MOVE PV-SL001-EVENT-ID          TO  PV-CURR-EVENT-ID.        24400043
244500     MOVE PV-SL001-OFFER-ID          TO  PV-CURR-OFFER-ID.        24410043
244600     MOVE PV-SL001-OFR-SECT-TYP-CDE  TO                           24420043
244700                                  PV-CURR-OFR-SECT-TYP-CDE.       24430043
244800     MOVE PV-SL001-STR-GRP-TYP-CDE   TO                           24440043
244900                                  PV-CURR-STR-GRP-TYP-CDE.        24450043
245000     MOVE PV-SL001-STR-GRP-ID        TO  PV-CURR-STR-GRP-ID.      24460043
245100                                                                  24470043
245200*5700-EXIT.                                                       24480043
245300 EJECT.                                                           24490043
245400                                                                  24500043
245500*------------------------------------------------------------*    24510043
245600* 5800-POPULATE-EXCEPTION-STRLST                             *    24520043
245700*     THIS PARAGRAPH WILL UPDATE THE CALL A PARAGRAPH  TO    *    24530043
245800*     WRITE THE EXCLUDED STORES AND WILL ALSO READ THE NEXT  *    24540043
245900*     RECORD FROM THE STORELIST FILE.                             24550043
246000*------------------------------------------------------------*    24560043
246100 5800-POPULATE-EXCEPTION-STRLST.                                  24570043
246200                                                                  24580043
246300     PERFORM VARYING PV-LOOP-CNT                                  24590043
246400          FROM 1 BY 1  UNTIL                                      24600043
246500            EP206-IE-IND = 'Y' OR                                 24610043
246600            PS-END-OF-STORE-FILE                                  24620043
246700                                                                  24630043
064151          PERFORM 5500-ROLL-SL0002-TO-SL0001                      24631046
064151          PERFORM 5700-UPDATE-CURRENT-OFR-STR                     24632046
246800          PERFORM 7200-WRITE-EXCEPTION-STR-FILE                   24640043
246900                                                                  24650043
247000          PERFORM 6900-READ-STORE-LIST-FILE                       24660043
247100                                                                  24670043
247200     END-PERFORM.                                                 24680043
247300                                                                  24690043
247400                                                                  24700043
247500*5800-EXIT.                                                       24710043
247600 EJECT.                                                           24720043
247700*----------------------------------------------------------       24730043
247800* 6100-READ-OFFER-DATA                                            24740043
247900*     THIS PARAGRAPH READS DATA FROM OFFERS-DATA-FILE INTO        24750043
248000*     COPYBOOK EPRD201  (INP01)                                   24760043
248100*----------------------------------------------------------       24770043
248200 6100-READ-OFFER-DATA.                                            24780043
248300                                                                  24790043
248400     READ OFFERS-DATA-FILE INTO                                   24800043
248500         EP201-OFFER-XST-OFR-RECORD                               24810043
248600     AT END                                                       24820043
248700         SET PS-END-OFR-FILE TO TRUE                              24830043
248800     NOT AT END                                                   24840043
248900         ADD 1 TO PV-OFFER-REC-IN-CNT                             24850043
248910         MOVE 0 TO PV-PIPE-COUNT                                  24860043
248920         PERFORM 8100-CHECK-INP01-FOR-PIPES                       24870043
249000     END-READ.                                                    24880043
249100                                                                  24890043
249300*6100-EXIT.                                                       24900043
249400 EJECT.                                                           24910043
249530                                                                  24920043
249600*----------------------------------------------------------       24930043
249700* 6200-READ-SECTN-DATA                                            24940043
249800*     THIS PARAGRAPH READS DATA FROM OFFERS-SECTION-FILE INTO     24950043
249900*     COPYBOOK EPRD202  (INP02)                                   24960043
250000*----------------------------------------------------------       24970043
250100 6200-READ-SECTN-DATA.                                            24980043
250200                                                                  24990043
250300     READ OFFERS-SECTION-FILE INTO                                25000043
250400         EP202-OFFER-XST-OFR-SECT-RCD                             25010043
250500     AT END                                                       25020043
250600         SET PS-END-SEC-FILE TO TRUE                              25030043
250700     NOT AT END                                                   25040043
250800         ADD 1 TO PV-SECTION-REC-IN-CNT                           25050043
250810         MOVE 0 TO PV-PIPE-COUNT                                  25060043
250820         PERFORM 8200-CHECK-INP02-FOR-PIPES                       25070043
250900     END-READ.                                                    25080043
251040                                                                  25090043
251100*6200-EXIT.                                                       25100043
251200 EJECT.                                                           25110043
251300                                                                  25120043
251410*----------------------------------------------------------       25130043
251500* 6300-READ-BWP-DATA                                              25140043
251600*     THIS PARAGRAPH READS DATA FROM OFFERS-BWP-FILE INTO         25150043
251700*     COPYBOOK EPRD203  (INP03)                                   25160043
251800*----------------------------------------------------------       25170043
251900 6300-READ-BWP-DATA.                                              25180043
252000                                                                  25190043
252100     READ OFFERS-BWP-FILE INTO                                    25200043
252200         EP203-OFFER-XST-BWP-RECORD                               25210043
252300     AT END                                                       25220043
252400         SET PS-END-BWP-FILE TO TRUE                              25230043
252500     NOT AT END                                                   25240043
252600         ADD 1 TO PV-BWP-REC-IN-CNT                               25250043
252610         MOVE 0 TO PV-PIPE-COUNT                                  25260043
252620         PERFORM 8300-CHECK-INP03-FOR-PIPES                       25261043
252700     END-READ.                                                    25262043
252840                                                                  25263043
252900*6300-EXIT.                                                       25264043
253000 EJECT.                                                           25265043
253202                                                                  25266043
253210*----------------------------------------------------------       25267043
253300* 6400-READ-MDSE-DATA                                             25268043
253400*     THIS PARAGRAPH READS DATA FROM OFFERS-MDSE-FILE INTO        25269043
253500*     COPYBOOK EPRD204  (INP04)                                   25270043
253600*----------------------------------------------------------       25280043
253700 6400-READ-MDSE-DATA.                                             25290043
253800                                                                  25300043
253900     READ OFFERS-MDSE-FILE INTO                                   25310043
254000         EP204-OFFER-XST-OFR-MDSE-SET                             25320043
254100     AT END                                                       25330043
254200         SET PS-END-OF-MDSE-FILE TO TRUE                          25340043
254300     NOT AT END                                                   25350043
254400         ADD 1 TO PV-MDSE-REC-IN-CNT                              25360043
254410         MOVE 0 TO PV-PIPE-COUNT                                  25370043
254420         PERFORM 8400-CHECK-INP04-FOR-PIPES                       25380043
254500     END-READ.                                                    25390043
254600                                                                  25400043
254700*6400-EXIT.                                                       25410043
254800 EJECT.                                                           25420043
254900                                                                  25430043
255010*----------------------------------------------------------       25440043
255100* 6500-MOVE-ID-DATA                                               25450043
255200*     THIS PARAGRAPH IS USED TO MOVE A BIT VALUE FROM INPUT       25460043
255300*     TO THE OUTPUT RECORD                                        25470043
255400*----------------------------------------------------------       25480043
255500 6500-MOVE-ID-DATA.                                               25490043
255600                                                                  25500043
255700     MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                            25510043
255800       TO FORM-OFR-FLD(FORM-OFR-LEN).                             25520043
255900     SET FORM-OFR-LEN                                             25530043
256000       UP BY 1.                                                   25540043
256100     ADD 1                                                        25550043
256200       TO PV-BYTE-COUNT.                                          25560043
256300                                                                  25570043
256400*6500-EXIT.                                                       25580043
256500 EJECT.                                                           25590043
256600                                                                  25600043
256710*----------------------------------------------------------       25610043
256720* 6550-MOVE-AMT-ID-DATA                                           25620043
256730*     THIS PARAGRAPH IS USED TO MOVE A BIT VALUE FROM INPUT       25630043
256740*     TO THE OUTPUT RECORD                                        25640043
256750*----------------------------------------------------------       25650043
256760 6550-MOVE-AMT-ID-DATA.                                           25660043
256770                                                                  25670043
256774     IF PV-EFBM-BIT-IDX = 7                                       25671043
256775        MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                         25672043
256776          TO FORM-OFR-FLD(FORM-OFR-LEN)                           25673043
256777                                                                  25674043
256778        SET FORM-OFR-LEN UP BY 1                                  25675043
256779        ADD 1 TO PV-BYTE-COUNT                                    25676043
256780                                                                  25677043
256781        MOVE '.' TO FORM-OFR-FLD(FORM-OFR-LEN)                    25678043
256784                                                                  25678143
256785     ELSE                                                         25678243
256786        MOVE PV-EFBM-VAR(PV-EFBM-BIT-IDX)                         25678343
256790          TO FORM-OFR-FLD(FORM-OFR-LEN)                           25678443
256791     END-IF.                                                      25678543
256792                                                                  25678643
256793     SET FORM-OFR-LEN                                             25678743
256794       UP BY 1.                                                   25678843
256795     ADD 1                                                        25678943
256796       TO PV-BYTE-COUNT.                                          25679043
256797                                                                  25679143
256798*6550-EXIT.                                                       25679243
256799 EJECT.                                                           25679343
256800                                                                  25679443
256801                                                                  25679543
256810*-------------------------------------------------------------    25679643
256900* 6600-FIND-DATA-END.                                             25679743
257000* THIS PARAGRAPH IS USED IN A LOOP TO DETERMINE LENGTH OF A       25679843
257100*  STRING                                                         25679943
257200*-------------------------------------------------------------    25680043
257300 6600-FIND-DATA-END.                                              25690043
257400                                                                  25700043
257500     MOVE ' '                                                     25710043
257600       TO PV-SPACE.                                               25720043
257700                                                                  25730043
257800*6600-EXIT.                                                       25740043
257900 EJECT.                                                           25750043
258000                                                                  25760043
258100*----------------------------------------------------------       25770043
258200* 6650-FIELD-MOVER                                                25780043
258300*     THIS PARAGRAPH MOVES ONE BIT TO THE OUTPUT FILE             25790043
258400*----------------------------------------------------------       25800043
258500 6650-FIELD-MOVER.                                                25810043
258600                                                                  25820043
258700     MOVE PV-BIT-VARIABLE(PV-BIT-IDX)                             25830043
258800       TO FORM-OFR-FLD(FORM-OFR-LEN).                             25840043
258900     SET FORM-OFR-LEN                                             25850043
259000       UP BY 1.                                                   25860043
259100     ADD 1                                                        25870043
259200       TO PV-BYTE-COUNT.                                          25880043
259300                                                                  25890043
259400*6650-EXIT.                                                       25900043
259500 EJECT.                                                           25910043
259600                                                                  25920043
259700                                                                  25930043
259800*-----------------------------------------------------------------25940043
259900* 6700-MOVE-ZERO                                                  25950043
260000*  THIS PARAGRAPH WILL MOVE '0' TO THE OUTPUT FILE VARIABLE       25960043
260100*----------------------------------------------------------------*25970043
260200 6700-MOVE-ZERO.                                                  25980043
260300                                                                  25990043
260400     MOVE PC-ONE-ZERO                                             26000043
260500       TO FORM-OFR-FLD(FORM-OFR-LEN).                             26010043
260600     SET FORM-OFR-LEN                                             26020043
260700       UP BY 1.                                                   26030043
260800     ADD 1                                                        26040043
260900       TO PV-BYTE-COUNT.                                          26050043
261000                                                                  26060043
261100     PERFORM 6850-MOVE-DELIMITER.                                 26070043
261200                                                                  26080043
261300*6700-EXIT.                                                       26090043
261400 EJECT.                                                           26100043
261500*-----------------------------------------------------------------26110043
261600* 6750-MOVE-SPACE                                                 26120043
261700*  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE       26130043
261800*----------------------------------------------------------------*26140043
261900 6750-MOVE-SPACE.                                                 26150043
262000                                                                  26160043
262100     MOVE PC-ONE-SPACE                                            26170043
262200       TO FORM-OFR-FLD(FORM-OFR-LEN).                             26180043
262300     SET FORM-OFR-LEN                                             26190043
262400       UP BY 1.                                                   26200043
262500     ADD 1                                                        26210043
262600       TO PV-BYTE-COUNT.                                          26220043
262700                                                                  26230043
262800     PERFORM 6850-MOVE-DELIMITER.                                 26240043
262900                                                                  26250043
263000                                                                  26260043
263100*6750-EXIT.                                                       26270043
263200 EJECT.                                                           26280043
263300                                                                  26290043
263400                                                                  26300043
263500*-----------------------------------------------------------------26310043
263600* 6800-MOVE-NULL-VALUE                                            26320043
263700*  THIS PARAGRAPH WILL MOVE '~' TO THE OUTPUT FILE VARIABLE       26330043
263800*----------------------------------------------------------------*26340043
263900 6800-MOVE-NULL-VALUE.                                            26350043
264000                                                                  26360043
264100     MOVE PC-NULL-VALUE                                           26370043
264200       TO FORM-OFR-FLD(FORM-OFR-LEN).                             26380043
264300     SET FORM-OFR-LEN                                             26390043
264400       UP BY 1.                                                   26400043
264500     ADD 1                                                        26410043
264600       TO PV-BYTE-COUNT.                                          26420043
264700                                                                  26430043
264800     PERFORM 6850-MOVE-DELIMITER.                                 26440043
264900                                                                  26450043
265000*6800-EXIT.                                                       26460043
265100 EJECT.                                                           26470043
265200                                                                  26480043
265300                                                                  26490043
265400*-----------------------------------------------------------------26500043
265500* 6850-MOVE-DELIMITER.                                            26510043
265600*  THIS PARAGRAPH WILL MOVE '|' TO THE OUTPUT FILE VARIABLE       26520043
265700*----------------------------------------------------------------*26530043
265800 6850-MOVE-DELIMITER.                                             26540043
265900                                                                  26550043
266000     MOVE PC-CSV-DELIMITER                                        26560043
266100       TO FORM-OFR-FLD(FORM-OFR-LEN).                             26570043
266200     SET FORM-OFR-LEN                                             26580043
266300       UP BY 1.                                                   26590043
266400     ADD 1                                                        26600043
266500       TO PV-BYTE-COUNT.                                          26610043
266600                                                                  26620043
266700*6850-EXIT.                                                       26630043
266800 EJECT.                                                           26640043
266900                                                                  26650043
267000*-----------------------------------------------------------------26660043
267100* 6900-READ-STORE-LIST-FILE                                       26670043
267200*  THIS PARAGRAPH READS THE STORE LIST FILE                       26680043
267300*----------------------------------------------------------------*26690043
267400 6900-READ-STORE-LIST-FILE.                                       26700043
267500                                                                  26710043
267600     READ STORE-LIST-FILE INTO                                    26720043
267700         EP206-STORE-LIST-RCD                                     26730043
267800     AT END                                                       26740043
267900         SET PS-END-OF-STORE-FILE TO TRUE                         26750043
268000     NOT AT END                                                   26760043
268100         ADD 1 TO PV-STORE-LIST-REC-IN-CNT                        26770043
268200     END-READ.                                                    26780043
268300                                                                  26790043
268400*6900-EXIT.                                                       26800043
268500 EJECT.                                                           26810043
268600                                                                  26820043
268700******************************************************************26830043
268800* 7000-VALIDATE-DATE-INPUT.                                       26840043
268900*     VALIDIATE THE DATE INPUT BY CALLING THE KOHLS CALENDAR      26850043
269000*     ROUTINE AND CHECKING TO SEE WHETHER IT THROWS AN ERROR.     26860043
269100******************************************************************26870043
269200 7000-VALIDATE-DATE-INPUT.                                        26880043
269300     MOVE '7000-VALIDATE-DATE-INPUT   ' TO PV-PARAGRAPH-NAME.     26890043
269500                                                                  26900043
269600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              26910043
269700     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      26920043
269800     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      26930043
269900     SET PS-DATE-NOT-VALID          TO TRUE.                      26940043
270000                                                                  26950043
270100     MOVE EP252-CC-FUTURE-DATE      TO DPG52-LK-DATE-INPUT.       26960043
270200                                                                  26970043
270300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    26980043
270400                                             DPG54 DPG55 DPG56.   26990043
270500                                                                  27000043
270600     EVALUATE TRUE                                                27010043
270700        WHEN DPG54-NO-ERROR                                       27020043
270800           CONTINUE                                               27030043
270900        WHEN OTHER                                                27040043
271100           DISPLAY ' '                                            27050043
271200           DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE'      27060043
271300           DISPLAY '** CALLED BY 7000-VALIDATE-DATE-INPUT'        27070043
271400           DISPLAY '** ERROR MESSAGE = '                          27080043
271500                             DPG54-ERROR-MESSAGE                  27090043
271700           DISPLAY ' DPG52-LK-DATE-INPUT  '  DPG52-LK-DATE-INPUT  27100043
272000           MOVE '7000-VALIDATE-DATE-INPUT ' TO PV-PARAGRAPH-NAME  27110043
272100           MOVE 'INVALID DATE PASSED IN CC' TO PV-OPERATION-MSG-1 27120043
272200           MOVE  DPG54-ERROR-MESSAGE        TO PV-OPERATION-MSG-2 27130043
272300           SET AC-4019-CALENDAR-ROUTINE-ERROR TO TRUE             27140043
272400             PERFORM 9910-ABEND                                   27150043
272700     END-EVALUATE.                                                27160043
272800                                                                  27170043
272900*7000-EXIT.                                                       27180043
272910 EJECT.                                                           27190043
273000*-------------------------------------------------------------    27200043
273100* 7200-WRITE-EXCEPTION-STR-FILE                                   27210043
273200*   THIS PARAGRAPHS WRITES DATA TO EXCEPTION STORE LIST FILE      27220043
273300*-------------------------------------------------------------    27230043
273400 7200-WRITE-EXCEPTION-STR-FILE.                                   27240043
273500                                                                  27250043
273600     MOVE PV-CURR-STR-GRP-TYP-CDE  TO                             27260043
273700                                     EP207-STORE-GROUP-TYPE-CDE.  27270043
273800     MOVE PV-EXCEPTION-COUNTER     TO EP207-EXCP-INDICATOR.       27280043
273900     MOVE PV-CURR-STR-GRP-ID       TO EP207-STORE-GROUP-ID.       27290043
274000     MOVE ' '                      TO EP207-FILLER-1.             27300043
274100     MOVE EP206-STORE-NUMBER       TO EP207-STORE-NUMBER.         27310043
274200                                                                  27320043
274300     WRITE EXCEPTION-STORE-LIST-RECORD FROM                       27330043
274400                                 EP207-EXCEPTION-STORES.          27340043
274500                                                                  27350043
274600     ADD 1 TO PV-STORE-EXCP-REC-OUT-CNT.                          27360043
274700                                                                  27370043
274800*7200-EXIT.                                                       27380043
274810 EJECT.                                                           27390043
274820*----------------------------------------------------------       27400043
274830* 8100-CHECK-INP01-FOR-PIPES                                      27410043
274840*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 27420043
274850*     REPLACES PIPES WITH SPACE.                                  27430043
274860*----------------------------------------------------------       27440043
274870 8100-CHECK-INP01-FOR-PIPES.                                      27450043
274880                                                                  27460043
274890     INSPECT EP201-OFFER-XST-OFR-RECORD                           27470043
274891          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     27480043
274892                                                                  27481043
274893     IF PV-PIPE-COUNT > 0                                         27482043
274894        INSPECT EP201-OFFER-XST-OFR-RECORD                        27483043
274895            REPLACING ALL '|'  BY  ' '                            27484043
274896        DISPLAY ' INPUT OFFER RECORD HAD PIPES IN IT, REPLACING'  27485043
274897                ' | WITH A SPACE '                                27486043
274898        DISPLAY EP201-OFFER-XST-OFR-RECORD                        27487043
274899     END-IF.                                                      27488043
274900                                                                  27489043
274901*8100-EXIT.                                                       27490043
274902 EJECT.                                                           27490143
274903                                                                  27490243
274904*----------------------------------------------------------       27490343
274905* 8200-CHECK-INP02-FOR-PIPES                                      27490443
274906*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 27490543
274907*     REPLACES PIPES WITH SPACE.                                  27490643
274908*----------------------------------------------------------       27490743
274909 8200-CHECK-INP02-FOR-PIPES.                                      27490843
274910                                                                  27490943
274911     INSPECT EP202-OFFER-XST-OFR-SECT-RCD                         27491043
274912          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     27491143
274913                                                                  27491243
274914     IF PV-PIPE-COUNT > 0                                         27491343
274915        INSPECT EP202-OFFER-XST-OFR-SECT-RCD                      27491443
274916            REPLACING ALL '|'  BY  ' '                            27491543
274917        DISPLAY ' INPUT SECTN RECORD HAD PIPES IN IT, REPLACING ' 27491643
274918                ' | WITH A SPACE '                                27491743
274919        DISPLAY EP202-OFFER-XST-OFR-SECT-RCD                      27491843
274920     END-IF.                                                      27491943
274921                                                                  27492043
274922*8200-EXIT.                                                       27492143
274923 EJECT.                                                           27492243
274924                                                                  27492343
274925*----------------------------------------------------------       27492443
274926* 8300-CHECK-INP03-FOR-PIPES                                      27492543
274927*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 27492643
274928*     REPLACES PIPES WITH SPACE.                                  27492743
274929*----------------------------------------------------------       27492843
274930 8300-CHECK-INP03-FOR-PIPES.                                      27492943
274931                                                                  27493043
274932     INSPECT EP203-OFFER-XST-BWP-RECORD                           27493143
274933          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     27493243
274934                                                                  27493343
274935     IF PV-PIPE-COUNT > 0                                         27493443
274936        INSPECT EP203-OFFER-XST-BWP-RECORD                        27493543
274937            REPLACING ALL '|'  BY  ' '                            27493643
274938        DISPLAY ' INPUT  BWP  RECORD HAD PIPES IN IT, REPLACING ' 27493743
274939                ' | WITH A SPACE '                                27493843
274940        DISPLAY EP203-OFFER-XST-BWP-RECORD                        27493943
274941     END-IF.                                                      27494043
274942                                                                  27494143
274943*8300-EXIT.                                                       27494243
274944 EJECT.                                                           27494343
274945                                                                  27494443
274946*----------------------------------------------------------       27494543
274947* 8400-CHECK-INP04-FOR-PIPES                                      27494643
274948*     THIS PARAGRAPH CHECKS THE RECORDS READ FOR ANY PIPE (|) AND 27494743
274949*     REPLACES PIPES WITH SPACE.                                  27494843
274950*----------------------------------------------------------       27494943
274951 8400-CHECK-INP04-FOR-PIPES.                                      27495043
274952                                                                  27495143
274953     INSPECT EP204-OFFER-XST-OFR-MDSE-SET                         27495243
274954          TALLYING PV-PIPE-COUNT FOR ALL '|'.                     27495343
274955                                                                  27495443
274956     IF PV-PIPE-COUNT > 0                                         27495543
274957        INSPECT EP204-OFFER-XST-OFR-MDSE-SET                      27495643
274958            REPLACING ALL '|'  BY  ' '                            27495743
274959        DISPLAY ' INPUT MDSE  RECORD HAD PIPES IN IT, REPLACING ' 27495843
274960                ' | WITH A SPACE '                                27495943
274961        DISPLAY EP204-OFFER-XST-OFR-MDSE-SET                      27496043
274962     END-IF.                                                      27496143
274963                                                                  27496243
274964*8400-EXIT.                                                       27496343
274965 EJECT.                                                           27496443
274966                                                                  27496543
274970*-------------------------------------------------------------    27496643
275000* 9200-WRAPUP.                                                    27496743
275100*-------------------------------------------------------------    27496843
275200 9200-WRAPUP.                                                     27496943
275300                                                                  27497043
275400     MOVE '9200-WRAPUP                     ' TO PV-PARAGRAPH-NAME.27498043
275500                                                                  27499043
275600     PERFORM 9920-DISPLAY-TOTALS.                                 27500043
275700                                                                  27510043
275800     DISPLAY '****************************************'.          27520043
275900     DISPLAY '**          EPKUT203 END              **'.          27530043
276000     DISPLAY '****************************************'.          27540043
276100     CLOSE                                                        27550043
276200         OFFERS-DATA-FILE                                         27560043
276300         OFFERS-SECTION-FILE                                      27570043
276400         OFFERS-BWP-FILE                                          27580043
276500         OFFERS-MDSE-FILE                                         27590043
276600         CC-FUT-OFFSET-FILE                                       27600043
276700         STORE-LIST-FILE                                          27610043
276800         FORMATTED-OFFERS-FILE                                    27620043
276900         EXCEPTION-STORE-LIST-FILE.                               27630043
277000                                                                  27640043
277100                                                                  27650043
277200*9200-EXIT.                                                       27660043
277300 EJECT.                                                           27670043
277400                                                                  27680043
277500*---------------------------------------------------------        27690043
277600* 9800-SQL-ABEND.                                                 27700043
277700*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.27710043
277800*---------------------------------------------------------        27720043
277900 9800-SQL-ABEND.                                                  27730043
278000                                                                  27740043
278100     SET AC-4013-DB2-ERROR TO TRUE.                               27750043
278200                                                                  27760043
278300     DISPLAY '** ABEND     **'.                                   27770043
278400     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                27780043
278500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              27790043
278600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               27800043
278700                                                                  27810043
278800     COPY DPPD004.                                                27820043
278900     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         27830043
279000                                                                  27840043
279100*9800-EXIT.                                                       27850043
279200 EJECT.                                                           27860043
279300                                                                  27870043
279400******************************************************************27880043
279500*     ABEND PROGRAM WHEN A NON-DB2    ERROR OCCURS.              *27890043
279600******************************************************************27900043
279700 9910-ABEND.                                                      27910043
279800                                                                  27920043
279900     PERFORM 9920-DISPLAY-TOTALS.                                 27930043
280000                                                                  27940043
280100     DISPLAY '** ABEND           **'.                             27950043
280200     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          27960043
280300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        27970043
280400     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       27980043
280500     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       27990043
280600                                                                  28000043
280700     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         28010043
280800                                                                  28020043
280900*9910-EXIT.                                                       28030043
280910 EJECT.                                                           28040043
281000******************************************************************28050043
281100*     DISPLAY END OF JOB TOTALS                                  *28060043
281200******************************************************************28070043
281300 9920-DISPLAY-TOTALS.                                             28080043
281400                                                                  28090043
281500     DISPLAY '***********************************************'.   28100043
281600     DISPLAY '**     EOJ STATISTICS FOR EPKUT203           **'    28110043
281700     DISPLAY '***********************************************'.   28120043
281800     DISPLAY '                                               '.   28130043
281900     DISPLAY '                 INPUT COUNTS                  '.   28140043
282000     DISPLAY '    OFFER RECORDS READ       : '                    28150043
282100                  PV-OFFER-REC-IN-CNT.                            28160043
282200     DISPLAY '    SECTION RECORDS READ     : '                    28170043
282300                  PV-SECTION-REC-IN-CNT.                          28180043
282400     DISPLAY '    BWP RECORDS READ         : '                    28190043
282500                  PV-BWP-REC-IN-CNT.                              28200043
282600     DISPLAY '    MDSE RECORDS READ        : '                    28210043
282700                  PV-MDSE-REC-IN-CNT.                             28220043
282800     DISPLAY '    STORE LIST RECS READ     : '                    28230043
282900                  PV-STORE-LIST-REC-IN-CNT.                       28240043
283000     DISPLAY '    CONTROL CARDS READ       : '                    28250043
283100                  PV-CNTRL-REC-IN-CNT.                            28260043
283200     DISPLAY ' '.                                                 28270043
283300     DISPLAY '                 OUTPUT COUNTS                 '.   28280043
283400     DISPLAY '    OFFER HEADERS WRITTEN    : '                    28290043
283500                  PV-OFFER-HDR-OUT-CNT.                           28300043
283600     DISPLAY '    SECTION HEADERS WRITTEN  : '                    28310043
283700                  PV-SECTION-HDR-OUT-CNT.                         28320043
283800     DISPLAY '    BWP HEADERS WRITTEN      : '                    28330043
283900                  PV-BWP-HDR-OUT-CNT.                             28340043
284000     DISPLAY '    MDSE HEADERS WRITTEN     : '                    28350043
284100                  PV-MDSE-HDR-OUT-CNT.                            28360043
284200     DISPLAY '    OFFER DATA RECS WRITTEN  : '                    28370043
284300                  PV-OFFER-DTA-OUT-CNT.                           28380043
284400     DISPLAY '    SECT DATA RECS WRITTEN   : '                    28390043
284500                  PV-SECTION-DTA-OUT-CNT.                         28400043
284600     DISPLAY '    BWP DATA RECS WRITTEN    : '                    28410043
284700                  PV-BWP-DTA-OUT-CNT.                             28420043
284800     DISPLAY '    MDSE DATA RECS WRITTEN   : '                    28430043
284900                  PV-MDSE-DTA-OUT-CNT.                            28440043
285000     DISPLAY '    STORE EXCEPTIONS         : '                    28450043
285100                  PV-STORE-EXCP-REC-OUT-CNT.                      28460043
285200*9920-EXIT.                                                       28470043
285300 EJECT.                                                           28480043
285400                                                                  28490043
