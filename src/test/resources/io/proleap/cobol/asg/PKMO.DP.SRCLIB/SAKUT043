000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.      SAKUT043.                                       00030005
000400 AUTHOR.          JIM HUNTER.                                     00040001
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
000600 DATE-WRITTEN.    10/16/2013.                                     00060001
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*  MODULE TYPE:   COBOL2 BATCH.                                   00100000
001100*                                                                 00110000
001200* THIS PROGRAM PREPARES THE ASSOCIATE DISCOUNT FILE TO BE         00120001
001300* PROCESSED BY SAKUP044 UNDER THE DB2 CHECKPOINT RESTART SYSTEM.  00130005
001400*                                                                 00140000
001500* THE PROGRAM READS THE ASSOCIATE DISCOUNT UPDATE FILE, REFORMATS 00150001
001600* THE RECORDS AND SETS A CHECKPOINT INDICATOR ON THE RECORD BASED 00160001
001700* ON HOW CHECKPOINTS WILL BE TAKEN BY THE MAINTENANCE PROGRAM.    00170000
001800* AFTER A RECORD HAS BEEN REFORMATTED IT IS PASSED TO THE         00180000
001900* TRANSACTION PREPARATION MODULE (DPKUT900) WHICH DOES SOME MORE  00190000
002000* PROCESSING ON THE RECORDS AND WRITES THE REFORMATTED RECORDS    00200000
002100* OUT TO A SEQUENTIAL FILE.                                       00210000
002200*                                                                 00220000
002300* THE PROGRAM COMMUNICATES WITH THE TRANSACTION PREPARATION       00230000
002400* MODULE USING FUNCTION CODES (OPEN, WRITE, & CLOSE) AND CHECKS   00240000
002500* THE RETURN CODE AFTER EACH REQUEST.  IF AN INVALID RETURN CODE  00250000
002600* IS RECEIVED, ANY INFORMATION THAT MAY BE HELPFUL IN RESOLVING   00260000
002700* THE BAD RETURN CODE IS DISPLAYED ON SYSOUT AND THE PROGRAM      00270000
002800* ABENDS.                                                         00280000
002900*                                                                 00290000
003000*========================== CHANGE LOG ===========================00300000
003100* CHANGE       BY           DATE    DESCRIPTION                   00310008
003200*=================================================================00320000
003300* CHG0066778  JIM HUNTER  10-16-13  CREATE PROGRAM                00330008
003400*                                                                 00330108
260107* CHG0260107  JIM HUNTER  08-19-21  ADD COPYBOOK DPWS990 TO MAKE  00331008
260107*                                   THE CALL TO DPKUT900 DYNAMIC. 00332008
003500******************************************************************00350000
003600                                                                  00360000
003700 ENVIRONMENT DIVISION.                                            00370000
003800 CONFIGURATION SECTION.                                           00380000
003900                                                                  00390000
004000 SOURCE-COMPUTER.    IBM-3090.                                    00400000
004100 OBJECT-COMPUTER.    IBM-3090.                                    00410000
004200                                                                  00420000
004300 INPUT-OUTPUT SECTION.                                            00430000
004400 FILE-CONTROL.                                                    00440000
004500                                                                  00450000
004600     SELECT UPDATE-FILE   ASSIGN TO INP01.                        00460000
004700                                                                  00470000
004800 DATA DIVISION.                                                   00480000
004900 FILE SECTION.                                                    00490000
005000                                                                  00500000
005100 FD  UPDATE-FILE                                                  00510000
005200     RECORDING MODE IS F                                          00520000
005300     BLOCK CONTAINS 0 RECORDS                                     00530000
005400     LABEL RECORDS ARE OMITTED.                                   00540000
005500                                                                  00550000
005600 01  UPDATE-REC                       PIC  X(250).                00560001
005700                                                                  00570000
005800***************************************************************** 00580000
005900*                       WORKING STORAGE                           00590000
006000***************************************************************** 00600000
006100 WORKING-STORAGE SECTION.                                         00610000
006200                                                                  00620000
006300 01  WS-START                         PIC  X(40)                  00630001
006400     VALUE 'SAKUT043 - WORKING STORAGE BEGINS HERE'.              00640005
006500                                                                  00650000
006600                                                                  00660000
006700***************************************************************** 00670000
006800*                         SWITCHES                                00680000
006900***************************************************************** 00690000
007000 01  PROGRAM-SWITCHES.                                            00700000
007100     05  PS-INPUT-UPDATE-EOF-SW       PIC  X(01) VALUE 'N'.       00710000
007200         88  PS-INPUT-UPDATE-EOF                 VALUE 'Y'.       00720000
007300     05  PS-FIRST-TRANS-READ-SW       PIC  X(01) VALUE 'Y'.       00730000
007400         88  FIRST-TRANS-READ                    VALUE 'Y'.       00740000
007500                                                                  00750000
007600******************************************************************00760000
007700*                       ACCUMULATORS                              00770000
007800******************************************************************00780000
007900 01  PROGRAM-ACCUMULATORS.                                        00790000
008000     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00800000
008100     05  PA-WRITTEN                   PIC  9(11) VALUE ZEROS.     00810000
008200                                                                  00820000
008300******************************************************************00830000
008400*                           CONSTANTS                             00840000
008500******************************************************************00850000
008600 01  PROGRAM-CONSTANTS.                                           00860000
008700     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'SAKUT043'.00870005
008800                                                                  00880000
008900     05  PC-TRAN-PREP-FUNC-CODES.                                 00890000
009000         10  PC-TRAN-PREP-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00900000
009100         10  PC-TRAN-PREP-FUNC-WRITE  PIC  X(05) VALUE 'WRITE'.   00910000
009200         10  PC-TRAN-PREP-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00920000
009300                                                                  00930000
009400     05  PC-JOB-NAME                  PIC  X(08) VALUE 'SAK079  '.00940006
009500     05  PC-PLAN-NAME                 PIC  X(08) VALUE 'SAKUP044'.00950005
009600     05  PC-TRANS-RECORD-LENGTH       PIC S9(04) VALUE +250 COMP. 00960001
009700                                                                  00970000
009800******************************************************************00980000
009900*                          VARIABLES                              00990000
010000******************************************************************01000000
010100 01  PROGRAM-VARIABLES.                                           01010001
010200     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    01020001
010300     05  PV-OPERATION-MSG             PIC  X(60) VALUE SPACES.    01030001
010400     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     01040001
010500                                                                  01050001
010600     05  PV-CHECKPOINT-TYPE           PIC  X(01) VALUE SPACE.     01060001
010700         88  CONTROL-BREAK                       VALUE 'C'.       01070001
010800         88  LOGICAL-TRANSACTION                 VALUE 'L'.       01080001
010900         88  TIME-INTERVAL                       VALUE 'T'.       01090001
011000         88  REQUESTED-BY-PROGRAM                VALUE 'R'.       01100001
011100                                                                  01110001
011200     05  PV-HOLD-STORE-NBR            PIC  9(04) VALUE ZERO.      01120001
011300                                                                  01130001
011400******************************************************************01140001
011500*               SYSTEM TIME AND DATE VARIABLES                    01150001
011600******************************************************************01160001
011700 01  SYS-DATE-TIME.                                               01170001
011800     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    01180001
011900     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    01190001
012000                                                                  01200001
012100 01  ST-BEG-TIME.                                                 01210001
012200     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     01220001
012300     05  FILLER                       PIC  X(01) VALUE ':'.       01230001
012400     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01240001
012500                                                                  01250001
012600 01  ST-END-TIME.                                                 01260001
012700     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01270001
012800     05  FILLER                       PIC  X(01) VALUE ':'.       01280001
012900     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01290001
013000                                                                  01300001
013100 01  SD-EDIT-DATE.                                                01310001
013200     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01320001
013300     05  FILLER                       PIC  X(01) VALUE '-'.       01330001
013400     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01340001
013500     05  FILLER                       PIC  X(01) VALUE '-'.       01350001
013600     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01360001
013700     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01370001
013800                                                                  01380001
013900******************************************************************01390001
014000*                        ERROR HANDLING                           01400001
014100******************************************************************01410001
014200 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01420001
014300                                                 COMP SYNC.       01430001
014500     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01440001
014600                                                                  01450001
014700                                                                  01460001
      ***************************************************************** 01470004
      *  WS FIELDS FOR TEPITM AND TEPEID ASSOCIATE DISCOUNT UPDATES     01480004
      ***************************************************************** 01490004
           COPY SARD045.                                                01500007
                                                                        01510004
015200                                                                  01520001
015300******************************************************************01530001
015400*  TRANSACTION PREPARATION MODULE LINKAGE SECTION                 01540001
015500******************************************************************01550001
260107     COPY DPWS990.                                                01560008
015700                                                                  01570001
015600     COPY DPLS000.                                                01571008
015700                                                                  01572008
015800******************************************************************01580001
015900*  SQL COMMUNICATIONS WORK AREA                                   01590001
016000******************************************************************01600001
016100     COPY SQLCA2.                                                 01610001
016200                                                                  01620001
016300                                                                  01630001
016500                                                                  01640001
016600 PROCEDURE DIVISION.                                              01650001
016700******************************************************************01660001
016800* MAINLINE-PROCESSING                                             01670001
016900******************************************************************01680001
017000                                                                  01690001
017100     PERFORM A100-INITIALIZE.                                     01700001
017200                                                                  01710001
017300     PERFORM B100-PROCESS-UPDATE-INPUT-FILE                       01720001
017400       UNTIL PS-INPUT-UPDATE-EOF.                                 01730001
017500                                                                  01740001
017600     PERFORM Z990-END-OF-JOB-ROUTINE.                             01750001
017700                                                                  01760001
017800     GOBACK.                                                      01770001
017900                                                                  01780001
018000                                                                  01790001
018100******************************************************************01800001
018200* PREFORMS TASK INITIATION                                        01810001
018300******************************************************************01820001
018400 A100-INITIALIZE.                                                 01830001
018500                                                                  01840001
018600     OPEN INPUT UPDATE-FILE.                                      01850001
018700                                                                  01860001
018800     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01870001
018900                                                                  01880001
019000     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01890001
019100     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01900001
019200                                                                  01910001
019300     MOVE SYS-DATE (1:2) TO SD-CENT.                              01920001
019400     MOVE SYS-DATE (3:2) TO SD-YEAR.                              01930001
019500     MOVE SYS-DATE (5:2) TO SD-MONTH.                             01940001
019600     MOVE SYS-DATE (7:2) TO SD-DAY.                               01950001
019700                                                                  01960001
019800     PERFORM C100-ISSUE-OPEN-REQUEST.                             01970001
019900                                                                  01980001
020000     PERFORM C200-READ-UPDATE-INPUT-FILE.                         01990001
020100                                                                  02000001
020200     IF PS-INPUT-UPDATE-EOF                                       02010001
020200        DISPLAY '**** EMPTY UPDATE FILE ****'                     02020001
020800     END-IF.                                                      02030001
020900                                                                  02040001
021000                                                                  02050001
021100******************************************************************02060001
021200* PROCESS THE UPDATE FILE. IF A RECORD IS READ, GATHER WHATEVER   02070001
021300* OTHER DATA IS NECESSARY TO TAKE CHECKPOINTS BASED ON THE TYPE OF02080001
021400* CHECKPOINTS BEING TAKEN BY SAKUP044 AND ISSUE A WRITE REQUEST   02090005
021500* TO THE TRANSACTION PREPARATION PROGRAM.                         02100001
021600******************************************************************02110001
021700 B100-PROCESS-UPDATE-INPUT-FILE.                                  02120001
021800                                                                  02130001
021900     IF FIRST-TRANS-READ                                          02140001
022000         MOVE SA045-EPITM-STR-NBR TO PV-HOLD-STORE-NBR            02150007
022100         MOVE 'N'                 TO PS-FIRST-TRANS-READ-SW       02160004
022200     END-IF.                                                      02170001
022300                                                                  02180001
022400     IF CONTROL-BREAK                                             02190001
022500         PERFORM C300-CKPT-BY-CNTL-BREAK                          02200001
022600     ELSE                                                         02210001
022700         IF LOGICAL-TRANSACTION                                   02220001
022800             PERFORM C400-CKPT-BY-LOGICAL-TRANS                   02230001
022900         ELSE                                                     02240001
023000             PERFORM C500-CKPT-BY-TIME-OR-REQUEST                 02250001
023100         END-IF                                                   02260001
023200     END-IF.                                                      02270001
023300                                                                  02280001
023400     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02290001
023500                                                                  02300001
023600                                                                  02310001
023700******************************************************************02320001
023800* ISSUE AN 'OPEN' REQUEST TO THE TRANSACTION PREPARATION MODULE   02330001
023900******************************************************************02340001
024000 C100-ISSUE-OPEN-REQUEST.                                         02350001
024100                                                                  02360001
024200     MOVE PC-TRAN-PREP-FUNC-OPEN TO DP000-FUNC-CODE.              02370001
024300     MOVE PC-JOB-NAME            TO DP000-JOB-NAME.               02380001
024400     MOVE PC-PLAN-NAME           TO DP000-PLAN-NAME.              02390001
024500                                                                  02400001
024600     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02410001
024700                                                                  02420001
024800     MOVE DP000-CKPT-TYPE-CODE   TO PV-CHECKPOINT-TYPE.           02430001
024900                                                                  02440001
025000                                                                  02450001
025100******************************************************************02460001
025200* READ THE UPDATE INPUT FILE                                      02470001
025300******************************************************************02480001
025400 C200-READ-UPDATE-INPUT-FILE.                                     02490001
025500                                                                  02500001
025600     READ UPDATE-FILE INTO SA045-TRAN-UPDT-RECORD                 02510007
025700       AT END SET PS-INPUT-UPDATE-EOF TO TRUE.                    02520001
025800                                                                  02530001
025900     IF PS-INPUT-UPDATE-EOF                                       02540001
026000         CONTINUE                                                 02550001
026100     ELSE                                                         02560001
026200         ADD +1 TO PA-READ                                        02570001
026300     END-IF.                                                      02580001
026400                                                                  02590001
026500                                                                  02600001
026600******************************************************************02610001
026700* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACATION  02620001
026800* RECORD "ON" IF THERE IS A CHANGE IN THE STORE NUMBER. AFTER     02630001
026900* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   02640001
027000* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   02650001
027100*                                                                 02660001
027200* NOTE: AT THIS TIME CONTROL/LOGIC BREAK PROCESSING IS IDENTICAL. 02670001
027300******************************************************************02680001
027400 C300-CKPT-BY-CNTL-BREAK.                                         02690001
027500                                                                  02700001
027600     IF  SA045-EPITM-STR-NBR = PV-HOLD-STORE-NBR                  02710007
027700         MOVE 'N' TO DP000-CHECKPOINT-IND                         02720001
027800     ELSE                                                         02730001
027900         MOVE 'Y' TO DP000-CHECKPOINT-IND                         02740001
028000         MOVE SA045-EPITM-STR-NBR TO PV-HOLD-STORE-NBR            02750007
028100     END-IF.                                                      02760001
028200                                                                  02770001
028300     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      02780001
028400     MOVE SA045-TRAN-UPDT-RECORD  TO DP000-TRANS-REC.             02790007
028500     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             02800001
028600     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              02810001
028700     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             02820001
028800                                                                  02830001
028900     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02840001
029000                                                                  02850001
029100     ADD +1 TO PA-WRITTEN.                                        02860001
029200                                                                  02870001
029300                                                                  02880001
029400******************************************************************02890001
029500* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACTION   02900001
029600* RECORD "ON".  THE UPDATE PROGRAM WILL CHECK THE CHECKPOINT      02910001
029700* FREQUENCY TO KNOW WHETHER A CHECKPOINT SHOULD BE TAKEN. AFTER   02920001
029800* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   02930001
029900* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   02940001
030000******************************************************************02950001
030100 C400-CKPT-BY-LOGICAL-TRANS.                                      02960001
030200                                                                  02970001
027600     IF  SA045-EPITM-STR-NBR = PV-HOLD-STORE-NBR                  02980007
027700         MOVE 'N' TO DP000-CHECKPOINT-IND                         02990002
027800     ELSE                                                         03000002
027900         MOVE 'Y' TO DP000-CHECKPOINT-IND                         03010002
028000         MOVE SA045-EPITM-STR-NBR TO PV-HOLD-STORE-NBR            03020007
028100     END-IF.                                                      03030002
030900                                                                  03040001
028300     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03050002
028400     MOVE SA045-TRAN-UPDT-RECORD  TO DP000-TRANS-REC.             03060007
028500     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03070002
028600     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03080002
028700     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03090002
031500                                                                  03100001
031600     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03110001
031700                                                                  03120001
031800     ADD +1 TO PA-WRITTEN.                                        03130001
031900                                                                  03140001
032000                                                                  03150001
032100******************************************************************03160001
032200* THIS ROUTINE BUILDS THE TRANSACTION RECORD AND ISSUES A WRITE   03170001
032300* REQUEST TO THE TRANSACTION PREPARATION MODULE IF CHECKPOINTS ARE03180001
032400* TAKEN BY TIME INTERVAL (SECONDS) OR REQUESTED BY THE MAINTENANCE03190001
032500* PROGRAM.                                                        03200001
032600******************************************************************03210001
032700 C500-CKPT-BY-TIME-OR-REQUEST.                                    03220001
032800                                                                  03230001
032900     MOVE 'N'                     TO DP000-CHECKPOINT-IND.        03240001
033000                                                                  03250001
033100     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03260001
028400     MOVE SA045-TRAN-UPDT-RECORD  TO DP000-TRANS-REC.             03270007
033300     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03280001
033400     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03290001
033500     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03300001
033600                                                                  03310001
033700     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03320001
033800                                                                  03330001
033900     ADD +1 TO PA-WRITTEN.                                        03340001
034000                                                                  03350001
034100                                                                  03360001
034200******************************************************************03370001
034300* ISSUE A 'CLOSE' REQUEST TO THE TRANSACTION PREPARATION MODULE   03380001
034400******************************************************************03390001
034500 C600-ISSUE-CLOSE-REQUEST.                                        03400001
034600                                                                  03410001
034700     MOVE PC-TRAN-PREP-FUNC-CLOSE TO DP000-FUNC-CODE.             03420001
034800     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03430001
034900     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03440001
035000                                                                  03450001
035100     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03460001
035200                                                                  03470001
035300                                                                  03480001
035400******************************************************************03490001
035500* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03500001
035600******************************************************************03510001
035700 Z100-CALL-TRANS-PREP-MODULE.                                     03520001
035800                                                                  03530001
035900     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         03540001
036000                                                                  03550001
036100     IF  DP000-GOOD-RET-CODE                                      03560001
036200         CONTINUE                                                 03570001
036300                                                                  03580001
036400     ELSE                                                         03590001
036500         MOVE 'Z100-CALL-TRANS-PREP-MODULE' TO PV-PARAGRAPH-NAME  03600001
036600         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03610001
036700                                            TO PV-OPERATION-MSG   03620001
036800         MOVE DP000-RET-CODE                TO PV-RET-CODE        03630001
036900                                                                  03640001
037000         SET ABEND-4019-CAL-SUB-ERROR TO TRUE                     03650001
037100                                                                  03660001
037200         PERFORM Z200-ABEND                                       03670001
037300     END-IF.                                                      03680001
037400                                                                  03690001
037500                                                                  03700001
037600******************************************************************03710001
037700* NON-DB2 ABEND                                                   03720001
037800******************************************************************03730001
037900 Z200-ABEND.                                                      03740001
038000                                                                  03750001
038100     PERFORM Z999-CONTROLS.                                       03760001
038200                                                                  03770001
038300     DISPLAY '                     '.                             03780001
038400     DISPLAY '** ABEND           **'.                             03790001
038500     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03800001
038600     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03810001
038700     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03820001
038800     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              03830001
038900                                                                  03840001
039000     CALL 'ILBOABN0' USING ABEND-CODE.                            03850001
039100                                                                  03860001
039200                                                                  03870001
039300******************************************************************03880001
039400* PERFORMS TASK TERMINATION PROCESSING                            03890002
039500******************************************************************03900001
039600 Z990-END-OF-JOB-ROUTINE.                                         03910001
039700                                                                  03920001
039800     CLOSE UPDATE-FILE.                                           03930001
039900                                                                  03940001
040000     PERFORM C600-ISSUE-CLOSE-REQUEST.                            03950001
040100                                                                  03960001
040200     PERFORM Z999-CONTROLS.                                       03970001
040300                                                                  03980001
040400                                                                  03990001
040500******************************************************************04000001
040600* DISPLAY CONTROLS FROM THE PROGRAM                               04010001
040700******************************************************************04020001
040800 Z999-CONTROLS.                                                   04030001
040900                                                                  04040001
041000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04050001
041100                                                                  04060001
041200     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04070001
041300     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04080001
041400                                                                  04090001
041500     DISPLAY '                    '.                              04100001
041600     DISPLAY '**********************'.                            04110001
041700     DISPLAY '   SAKUT043 CONTROLS  '.                            04120005
041800     DISPLAY '**********************'.                            04130001
041900     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04140001
042000     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04150001
042100     DISPLAY 'END TIME  = ' ST-END-TIME.                          04160001
042200     DISPLAY '======================'.                            04170001
042300     DISPLAY 'RECORDS READ    = ' PA-READ.                        04180001
042400     DISPLAY '                  '.                                04190001
042500     DISPLAY 'RECORDS WRITTEN = ' PA-WRITTEN.                     04200001
042600     DISPLAY '                  '.                                04210001
042700                                                                  04220001
042800                                                                  04230001
042900******************************************************************04240001
043000* TRANSACTION PREPARATION MODULE CALL AND ERROR ROUTINES          04250001
043100******************************************************************04260001
043200     COPY DPPD000.                                                04270001
043300                                                                  04280001
043400                                                                  04290001
