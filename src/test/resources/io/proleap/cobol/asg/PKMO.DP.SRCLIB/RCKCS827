000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    RCKCS827.                                         00040099
000500 AUTHOR.        PATRICK BURKE.                                    00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  FEBRUARY 2004.                                    00070099
000800 DATE-COMPILED.                                                   00080099
000900                                                                  00090099
001000*---------------------------------------------------------------* 00100099
001100*    E827 - TRAILER UNLOADING CHECK LIST.                       * 00110099
001200*                                                               * 00120099
001300*    THIS PROGRAM GENERATES A LIST OF MESSAGES THAT THE         * 00130099
001400*    ASSOCIATE MUST ENTER THE LETTER Y BESIDE BEFORE THEY ARE   * 00140099
001500*    ALLOWED TO PERFORM THE UNLOAD TRAILER FUNCTION.            * 00150099
001600*                                                               * 00160099
001700*---------------------------------------------------------------* 00170099
001710* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00171099
001720* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00172099
001730* MAKING THE CALL DYNAMIC VS STATIC.                              00173099
001740*---------------------------------------------------------------* 00174099
001800/                                                                 00180099
001900 ENVIRONMENT DIVISION.                                            00190099
002000                                                                  00200099
002100 DATA DIVISION.                                                   00210099
002200                                                                  00220099
002300 WORKING-STORAGE SECTION.                                         00230099
002400                                                                  00240099
002500 01  DK-DB2-KEYS.                                                 00250099
002600     05  DK-OPER-UNT-ID                 PIC S9(04) COMP VALUE +0. 00260099
002700     05  DK-FCLTY-ID                    PIC S9(04) COMP VALUE +0. 00270099
002800     05  DK-TRIP-ID                     PIC S9(09) COMP VALUE +0. 00280099
002900     05  DK-SCAC-ID                     PIC  X(04)  VALUE SPACE.  00290099
003000     05  DK-VEH-NBR                     PIC  X(10)  VALUE SPACE.  00300099
003100     05  DK-PO-NBR                      PIC S9(09) COMP VALUE +0. 00310099
003200     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP VALUE +0. 00320099
003300     05  DK-STATUS-CDE                  PIC X(02)  VALUE SPACES.  00330099
003400     05  DK-PKGNG-CDE                   PIC X(01)  VALUE SPACES.  00340099
003500     05  DK-SHIPT-ID                    PIC S9(09)  VALUE +0      00350099
003600                                                    COMP.         00360099
003700     05  DK-RCVR-UNLD-MSG-ID            PIC S9(04) COMP VALUE +0. 00370099
003800                                                                  00380099
003900 01  DN-DB2-NULL-INDICATORS.                                      00390099
004000     05  DN-CURR-TRIP-ID                PIC S9(04) COMP VALUE +0. 00400099
004100                                                                  00410099
004200 01  PA-PROGRAM-ACCUMULATORS.                                     00420099
004300     05  PA-INVOICED-COUNT              PIC S9(09) VALUE +0       00430099
004400                                                 COMP-3.          00440099
004500     05  PA-AP-VERIFIED-COUNT           PIC S9(09) VALUE +0       00450099
004600                                                   COMP-3.        00460099
004700                                                                  00470099
004800 01  PC-PROGRAM-CONSTANTS.                                        00480099
004900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00490099
005000                                                    'RC827A  '.   00500099
005100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00510099
005200                                                    'RCKM827 '.   00520099
005300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00530099
005400                                                    'RCKCS827'.   00540099
005500     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00550099
005600     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00560099
005700                                                    COMP SYNC.    00570099
005800     05  PC-UNLOADED-MODULE        PIC X(08)  VALUE 'RCKUT129'.   00580099
005900     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00590099
006000     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00600099
006100     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00610099
006200     05  PC-RCVR-PO-LIST                PIC  X(01)  VALUE '2'.    00620099
006300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     00630099
006400                                                    COMP SYNC.    00640099
006500     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00650099
006600                                                    COMP SYNC.    00660099
006700     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00670099
006800                                                    +1000000      00680099
006900                                                    COMP-3.       00690099
007000     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00700099
007100                                                    COMP SYNC.    00710099
007200     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00720099
007300                                                    COMP-3.       00730099
007400     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00740099
007500     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00750099
007600     05  PC-T                           PIC  X(01)  VALUE 'T'.    00760099
007700     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  00770099
007800     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00780099
007900     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00790099
008000     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00800099
008100     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00810099
008200     05  PC-VERIFIED                    PIC  X(20)  VALUE         00820099
008300                                             'VERIFIED'.          00830099
008400     05  PC-VERIF-ADJ                   PIC  X(20)  VALUE         00840099
008500                                             'VERIFIED(ADJ)'.     00850099
008510     05  PC-E838-RPAMSD                 PIC  X(04) VALUE 'E838'.  00851099
008600                                                                  00860099
008700******************************************************************00870099
008800     05  PC-VERIFY-AT-ZERO.                                       00880099
008900         10  FILLER                       PIC X(11) VALUE         00890099
009000           '-THERE ARE '.                                         00900099
009100         10  PC-VERIFY-ZERO-COUNT         PIC ZZ9.                00910099
009200         10  FILLER                       PIC X(32) VALUE         00920099
009300           ' RECEIVERS WITH LINES/PACKS THAT'.                    00930099
009400         10  FILLER                       PIC X(16) VALUE         00940099
009500           ' VERIFY AT ZERO '.                                    00950099
009600                                                                  00960099
009700     05  PC-PHYSICAL-LABELS.                                      00970099
009800         10  FILLER                       PIC X(37) VALUE         00980099
009900           '-HAVE ALL UNUSED PHYSICAL LABELS BEEN'.               00990099
010000         10  FILLER                       PIC X(32) VALUE         01000099
010100           ' INACTIVATED IN THE RF GUN?     '.                    01010099
010200                                                                  01020099
010300     05  PC-SMOOTHING.                                            01030099
010400         10  FILLER                       PIC X(32) VALUE         01040099
010500           '-HAVE YOU INACTIVATED ALL EXCESS'.                    01050099
010600         10  FILLER                       PIC X(33) VALUE         01060099
010700           ' SMOOOTHED LABELS?               '.                   01070099
010800                                                                  01080099
010900     05  PC-PBS-ERRORS.                                           01090099
011000         10  FILLER                       PIC X(38) VALUE         01100099
011100           '-HAVE YOU SET YOUR UNPROCESSED PACK-BY'.              01110099
011200         10  FILLER                       PIC X(32) VALUE         01120099
011300           '-STORE ERRORS IN TROUBLE?       '.                    01130099
011400                                                                  01140099
011500     05  PC-STOP-VERIFICATION.                                    01150099
011600         10  FILLER                       PIC X(38) VALUE         01160099
011700           '-HAVE YOU CREATED "STOP VERIFICATION" '.              01170099
011800         10  FILLER                       PIC X(35) VALUE         01180099
011900           'TROUBLE FOR ALL UNPROCESSED ORDERS?'.                 01190099
012000                                                                  01200099
012100     05  PC-FREE-ASTRAY.                                          01210099
012200         10  FILLER                       PIC X(38) VALUE         01220099
012300           '-HAVE YOU RESOLVED ALL FREE ASTRAYS ON'.              01230099
012400         10  FILLER                       PIC X(32) VALUE         01240099
012500           ' THIS TRAILER?                  '.                    01250099
012600                                                                  01260099
012700     05  PC-AUTO-VE-NO.                                           01270099
012800         10  FILLER                       PIC X(37) VALUE         01280099
012900           '-HAVE YOU MANUALLY CONFIRMED/VERIFIED'.               01290099
013000         10  FILLER                       PIC X(39) VALUE         01300099
013100           ' "==>MANUAL" RECEIVERS ON THIS TRAILER?'.             01310099
013200                                                                  01320099
013300     05  PC-UPDATE-CARTON-CNT.                                    01330099
013400         10  FILLER                       PIC X(39) VALUE         01340099
013500           '-HAVE YOU UPDATED THE CARTON COUNTS AND'.             01350099
013600         10  FILLER                       PIC X(31) VALUE         01360099
013700           ' RECEIVER INITIALS?            '.                     01370099
013800                                                                  01380099
013900     05  PC-UPDATE-OPER-SET.                                      01390099
014000         10  FILLER                       PIC X(38) VALUE         01400099
014100           '-HAVE YOU UPDATED THE OPER SET FOR ALL'.              01410099
014200         10  FILLER                       PIC X(32) VALUE         01420099
014300           ' RECEIVERS?                     '.                    01430099
014400                                                                  01440099
014500     05  PC-RCVRS-IN-TROUBLE.                                     01450099
014600         10  FILLER                       PIC X(11) VALUE         01460099
014700             '-THERE ARE '.                                       01470099
014800         10  PC-TROUBLE-COUNT             PIC ZZ9.                01480099
014900         10  FILLER                       PIC X(42) VALUE         01490099
015000             ' RECEIVERS IN TROUBLE THAT WILL NOT VERIFY'.        01500099
015100         10  FILLER                       PIC X(05) VALUE         01510099
015200             '     '.                                             01520099
015300                                                                  01530099
015400     05  PC-NO-PRO-NUMBER.                                        01540099
015500         10  FILLER                       PIC X(38) VALUE         01550099
015600           '-THERE ARE SHIPMENTS WITH NO PRO# THAT'.              01560099
015700         10  FILLER                       PIC X(31) VALUE         01570099
015800           ' WILL NOT VERIFY               '.                     01580099
015900                                                                  01590099
016000******************************************************************01600099
016100     05  PC-TSYMSG-NUMBERS.                                       01610099
016200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01620099
016300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01630099
016400         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01640099
016500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01650099
016600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01660099
016700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01670099
016800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01680099
016900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01690099
017000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01700099
017100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01710099
017200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01720099
017300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01730099
017400         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  01740099
017500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01750099
017600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01760099
017700         10  PC-TSYMSG-00417            PIC  9(05)  VALUE 00417.  01770099
017800         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01780099
017900         10  PC-TSYMSG-01089            PIC  9(05)  VALUE 01089.  01790099
018000         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01800099
018100         10  PC-TSYMSG-03246            PIC  9(05)  VALUE 03246.  01810099
018200         10  PC-TSYMSG-03262            PIC  9(05)  VALUE 03262.  01820099
018300         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01830099
018400                                                                  01840099
018500 01  PS-PROGRAM-SWITCHES.                                         01850099
018600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01860099
018700         88  PS-NO-ERROR                            VALUE 'Y'.    01870099
018800         88  PS-ERROR                               VALUE 'N'.    01880099
018900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01890099
019000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01900099
019100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01910099
019200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01920099
019300         88  PS-DONE                                VALUE 'Y'.    01930099
019400         88  PS-NOT-DONE                            VALUE 'N'.    01940099
019500     05  PS-TROUBLE-SW                  PIC  X(01)  VALUE 'N'.    01950099
019600         88  PS-TROUBLE-BUSY                        VALUE 'Y'.    01960099
019700         88  PS-TROUBLE-NOT-BUSY                    VALUE 'N'.    01970099
019800     05  PS-SHIPMENT-CURSOR-SW          PIC  X(01)  VALUE 'N'.    01980099
019900         88  PS-NO-MORE-SHIPMENTS                   VALUE 'Y'.    01990099
020000     05  PS-END-RCVR-CSR-SW             PIC  X(01)  VALUE 'N'.    02000099
020100         88 PS-END-RCVR-CSR                         VALUE 'Y'.    02010099
020200         88 PS-END-RCVR-CSR-NO                      VALUE 'N'.    02020099
020300                                                                  02030099
020400     05  PS-FREE-ASTRAY-SW              PIC  X(01)  VALUE 'N'.    02040099
020500         88  PS-FREE-ASTRAY                         VALUE 'Y'.    02050099
020600         88  PS-FREE-ASTRAY-NO                      VALUE 'N'.    02060099
020700     05  PS-VERIFY-AT-ZERO-SW           PIC  X(01)  VALUE 'N'.    02070099
020800         88  PS-VERIFY-AT-ZERO                      VALUE 'Y'.    02080099
020900         88  PS-VERIFY-AT-ZERO-NO                   VALUE 'N'.    02090099
021000     05  PS-NO-PRO-SW                   PIC  X(01)  VALUE 'N'.    02100099
021100         88  PS-NO-PRO-YES                          VALUE 'Y'.    02110099
021200         88  PS-NO-PRO-NO                           VALUE 'N'.    02120099
021300     05  PS-TROUBLE-SW                  PIC  X(01)  VALUE 'N'.    02130099
021400         88  PS-TROUBLE                             VALUE 'Y'.    02140099
021500         88  PS-TROUBLE-NO                          VALUE 'N'.    02150099
021600     05  PS-SMOOTHING-SW                PIC  X(01)  VALUE 'N'.    02160099
021700         88  PS-SMOOTHING                           VALUE 'Y'.    02170099
021800         88  PS-SMOOTHING-NO                        VALUE 'N'.    02180099
021900     05  PS-PHYSICAL-LABELS-SW          PIC  X(01)  VALUE 'N'.    02190099
022000         88  PS-PHYSICAL-LABELS                     VALUE 'Y'.    02200099
022100         88  PS-PHYSICAL-LABELS-NO                  VALUE 'N'.    02210099
022200     05  PS-PBS-ERROR-SW                PIC  X(01)  VALUE 'N'.    02220099
022300         88  PS-PBS-ERRORS                          VALUE 'Y'.    02230099
022400         88  PS-PBS-ERRORS-NO                       VALUE 'N'.    02240099
022500     05  PS-STOP-VERIFICATION-SW        PIC  X(01)  VALUE 'N'.    02250099
022600         88  PS-STOP-VERIFICATION                   VALUE 'Y'.    02260099
022700         88  PS-STOP-VERIFICATION-NO                VALUE 'N'.    02270099
022800     05 PS-AUTO-VE-SW                   PIC  X(01)  VALUE 'N'.    02280099
022900         88  PS-MANUAL-VE                           VALUE 'Y'.    02290099
023000         88  PS-AUTO-VE                             VALUE 'N'.    02300099
023100     05  PS-UNUSED-LABELS-SW            PIC  X(01)  VALUE 'N'.    02310099
023200         88  PS-UNUSED-LABELS                       VALUE 'Y'.    02320099
023300         88  PS-UNUSED-LABELS-NO                    VALUE 'N'.    02330099
023400     05  PS-UPDATE-CARTON-COUNT-SW       PIC X(01)  VALUE 'N'.    02340099
023500         88  PS-UPDATE-CARTON-COUNT                 VALUE 'Y'.    02350099
023600         88  PS-UPDATE-CARTON-COUNT-NO              VALUE 'N'.    02360099
023700     05  PS-UPDATE-OPER-SET-SW          PIC  X(01)  VALUE 'N'.    02370099
023800         88  PS-UPDATE-OPER-SET                     VALUE 'Y'.    02380099
023900         88  PS-UPDATE-OPER-SET-NO                  VALUE 'N'.    02390099
024000     05  PS-DC-LEVEL-SW                 PIC  X(01)  VALUE 'N'.    02400099
024010         88  PS-DC-LEVEL-YES                        VALUE 'Y'.    02401099
024020         88  PS-DC-LEVEL-NO                         VALUE 'N'.    02402099
024021     05  PS-P2L-DOWNLOAD-SW              PIC X(01)  VALUE 'N'.    02402199
024022         88  PS-P2L-DOWNLOAD-YES                    VALUE 'Y'.    02402299
024023         88  PS-P2L-DOWNLOAD-NO                     VALUE 'N'.    02402399
024030                                                                  02403099
024040 01  PV-PROGRAM-VARIABLES.                                        02404099
024050     05  PV-SUB                         PIC S9(04)  VALUE +0      02405099
024060                                                    COMP SYNC.    02406099
024070     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02407099
024080                                                    COMP SYNC.    02408099
024090     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02409099
024100                                                    COMP-3.       02410099
024200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02420099
024300                                                    COMP-3.       02430099
024400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02440099
024500                                                    COMP-3.       02450099
024600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02460099
024700                                                    COMP-3.       02470099
024800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02480099
024900                                                    COMP-3.       02490099
025000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02500099
025100                                                    COMP-3.       02510099
025200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02520099
025300                                                    COMP-3.       02530099
025400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02540099
025500                                                    COMP SYNC.    02550099
025600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02560099
025700                                                    COMP SYNC.    02570099
025800     05  PV-ITEM                        PIC S9(04)  VALUE +0      02580099
025900                                                    COMP SYNC.    02590099
026000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02600099
026100                                                    COMP SYNC.    02610099
026200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02620099
026300                                                    COMP SYNC.    02630099
026400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02640099
026500                                                    COMP SYNC.    02650099
026600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02660099
026700                                                    COMP SYNC.    02670099
026800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02680099
026900                                                    COMP SYNC.    02690099
027000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02700099
027100                                                    COMP SYNC.    02710099
027200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02720099
027300                                                    COMP SYNC.    02730099
027400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02740099
027500                                                    COMP SYNC.    02750099
027600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02760099
027700                                                    COMP SYNC.    02770099
027800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02780099
027900                                                    COMP SYNC.    02790099
028000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02800099
028100                                                    COMP SYNC.    02810099
028200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02820099
028300                                                    COMP SYNC.    02830099
028400     05  PV-OPER-UNT-ID                 PIC 9(04).                02840099
028500     05  PV-OPER-UNT-ID-X REDEFINES                               02850099
028600         PV-OPER-UNT-ID                 PIC X(04).                02860099
028700     05  PV-REC-DTE                     PIC X(10).                02870099
028800     05  PV-DB2-DATE.                                             02880099
028900         10  PV-DB2-CC                  PIC X(02).                02890099
029000         10  PV-DB2-YY                  PIC X(02).                02900099
029100         10  FILLER                     PIC X(01).                02910099
029200         10  PV-DB2-MM                  PIC X(02).                02920099
029300         10  FILLER                     PIC X(01).                02930099
029400         10  PV-DB2-DD                  PIC X(02).                02940099
029500     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02950099
029600                                                    COMP-3.       02960099
029700     05  PV-DB2-COUNT-TROUBLE           PIC S9(09)  VALUE +0      02970099
029800                                                    COMP-3.       02980099
029900     05  PV-DB2-COUNT-SMOOTHING         PIC S9(09)  VALUE +0      02990099
030000                                                    COMP-3.       03000099
030100     05  PV-DB2-COUNT-UNUSED-LABELS     PIC S9(09)  VALUE +0      03010099
030200                                                    COMP-3.       03020099
030210     05  PV-DB2-COUNT-P2L-CARTONS       PIC S9(09)  VALUE +0      03021099
030220                                                    COMP-3.       03022099
030300     05  PV-DB2-COUNT-PBS-ERRORS        PIC S9(09)  VALUE +0      03030099
030400                                                    COMP-3.       03040099
030500     05  PV-DB2-COUNT-NO-PRO            PIC S9(09)  VALUE +0      03050099
030600                                                    COMP-3.       03060099
030700     05  PV-ERROR-MSG.                                            03070099
030800         10  FILLER                     PIC X(4) VALUE 'PO= '.    03080099
030900         10  PV-ERROR-PO                PIC Z(8)9.                03090099
031000         10  FILLER                     PIC X(6) VALUE ' RCVR='.  03100099
031100         10  PV-ERROR-SEQ               PIC Z(8)9.                03110099
031200         10  FILLER                     PIC X(6) VALUE ' OPER='.  03120099
031300         10  PV-ERROR-OPER-UNT-ID       PIC Z(3)9.                03130099
031400         10  FILLER                     PIC X(7) VALUE ' FCLTY='. 03140099
031500         10  PV-ERROR-FCLTY-ID          PIC Z(3)9.                03150099
031600                                                                  03160099
031700     05  PV-DISPLAY-TRIP                PIC  9(09).               03170099
031800     05  PV-TRIP-ID-X                   PIC  X(09).               03180099
031900                                                                  03190099
032000     05  PV-LOC.                                                  03200099
032100         10  PV-LOC-OPER-UNT            PIC 9(03).                03210099
032200         10  FILLER                     PIC X(01) VALUE '-'.      03220099
032300         10  PV-LOC-FCLTY               PIC 9(01).                03230099
032400     05  PV-CURR-LOC.                                             03240099
032500         10  PV-CURR-LOC-OPER-UNT       PIC 9(03).                03250099
032600         10  FILLER                     PIC X(01) VALUE '-'.      03260099
032700         10  PV-CURR-LOC-FCLTY          PIC 9(01).                03270099
032800                                                                  03280099
032900     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      03290099
033000                                                    COMP SYNC.    03300099
033100     05  PV-COMMAREA-LENGTH             PIC S9(04)  VALUE +0      03310099
033200                                           COMP SYNC.             03320099
033300     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      03330099
033400                                           COMP SYNC.             03340099
033500     05  PV-CICS-MSG-AREA               PIC  X(80)  VALUE SPACES. 03350099
033600                                                                  03360099
033700     05  PV-START-UNLOAD-TMST           PIC X(26).                03370099
033800     05  PV-END-UNLOAD-TMST             PIC X(26).                03380099
033900                                                                  03390099
034000     05  PV-CURRENT-TMST                PIC X(26).                03400099
034100     05  FILLER REDEFINES PV-CURRENT-TMST.                        03410099
034200         10  PV-CURR-TMST-DATE          PIC X(10).                03420099
034300         10  PV-CURR-TMST-TIME          PIC X(16).                03430099
034400                                                                  03440099
034500*---------------------------------------------------------------* 03450099
034600*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03460099
034700*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03470099
034800*   APPLICATION-SPECIFIC COMMAREA.                              * 03480099
034900*---------------------------------------------------------------* 03490099
035000 01  LQW-LIST-QUEUE-WORK-AREA.                                    03500099
035100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03510099
035200     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03520099
035300                                        INDEXED BY LQW-IDX.       03530099
035400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03540099
035500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03550099
035600         10  LQW-SELECTED-SW            PIC  X(01).               03560099
035700             88  LQW-SELECT                         VALUE 'S'.    03570099
035800             88  LQW-DESELECT                       VALUE ' '.    03580099
035900         10  LQW-MESSAGE                PIC  X(75).               03590099
036000                                                                  03600099
036100/                                                                 03610099
036200*---------------------------------------------------------------* 03620099
036300*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03630099
036400*---------------------------------------------------------------* 03640099
036500                                                                  03650099
036600     COPY RCWS013.                                                03660099
036700                                                                  03670099
036710*---------------------------------------------------------------* 03671099
036720*  RECORD LAYOUT RPA MISDIRECT CALLED MODULE RCKCS838           * 03672099
036730*---------------------------------------------------------------* 03673099
036750     COPY RCWS077.                                                03675099
036760                                                                  03676099
036800/                                                                 03680099
036900*---------------------------------------------------------------* 03690099
037000*    MAP LAYOUT                                                 * 03700099
037100*---------------------------------------------------------------* 03710099
037200                                                                  03720099
037300     COPY RCKM827.                                                03730099
037400                                                                  03740099
037500 01  MR-OCCURS-LAYOUT                   REDEFINES  RC827AO.       03750099
037600     05  FILLER                         PIC X(107).               03760099
037700     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          03770099
037800         10  MR-SELECTL                 PIC S9(04) COMP.          03780099
037900         10  MR-SELECTA                 PIC  X(01).               03790099
038000         10  MR-SELECTC                 PIC  X(01).               03800099
038100         10  MR-SELECTH                 PIC  X(01).               03810099
038200         10  MR-SELECT                  PIC  X(01).               03820099
038300                                                                  03830099
038400         10  MR-MESSAGEL                PIC S9(04) COMP.          03840099
038500         10  MR-MESSAGEA                PIC  X(01).               03850099
038600         10  MR-MESSAGEC                PIC  X(01).               03860099
038700         10  MR-MESSAGEH                PIC  X(01).               03870099
038800         10  MR-MESSAGE                 PIC  X(75).               03880099
038900                                                                  03890099
039000/                                                                 03900099
039100*---------------------------------------------------------------* 03910099
039200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03920099
039300*---------------------------------------------------------------* 03930099
039400                                                                  03940099
039500     COPY DPWS015.                                                03950099
039600                                                                  03960099
039700*---------------------------------------------------------------* 03970099
039800*    FUNCTION KEYS COPYBOOK.                                    * 03980099
039900*---------------------------------------------------------------* 03990099
040000                                                                  04000099
040100     COPY DPWS016.                                                04010099
040200                                                                  04020099
040300*---------------------------------------------------------------* 04030099
040400*    NUMERIC EDIT LAYOUT.                                       * 04040099
040500*---------------------------------------------------------------* 04050099
040600                                                                  04060099
040700     COPY DPWS010I.                                               04070099
040800                                                                  04080099
040900/                                                                 04090099
041000******************************************************************04100099
041100** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04110099
041110** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04111099
041200******************************************************************04120099
041300                                                                  04130099
041400     COPY DPWS030.                                                04140099
041410     COPY DPWS930.                                                04141099
041500                                                                  04150099
041600/                                                                 04160099
041700*---------------------------------------------------------------* 04170099
041800*    STANDARD COMMAREA.                                         * 04180099
041900*---------------------------------------------------------------* 04190099
042000                                                                  04200099
042100     COPY DPWS020.                                                04210099
042200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04220099
042300                                                                  04230099
042400*---------------------------------------------------------------* 04240099
042500* INTER-APPLICATION COMMAREA.                                   * 04250099
042600*---------------------------------------------------------------* 04260099
042700                                                                  04270099
042800         10  INTER-APPL-COMM-AREA       PIC X(200).               04280099
042900     COPY RCWS012.                                                04290099
043000     COPY RCWS015.                                                04300099
043100     COPY POWS017.                                                04310099
043200     COPY RCWS815.                                                04320099
043300*---------------------------------------------------------------* 04330099
043400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04340099
043500*---------------------------------------------------------------* 04350099
043600         10  ASC-SPECIFIC-COMMAREA.                               04360099
043700             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             04370099
043800             15  ASC-USE-SELECTION-QUEUE-IND                      04380099
043900                                           PIC X(01).             04390099
044000                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        04400099
044100             15  ASC-IN-SEL-QUEUE-NAME     PIC X(08).             04410099
044200             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     04420099
044300             15  ASC-SEL-SUB               PIC S9(04) COMP.       04430099
044400             15  ASC-SEL-ITEM              PIC S9(04) COMP.       04440099
044500             15  ASC-REC-TROUBLE-COUNT     PIC S9(05) COMP-3.     04450099
044600             15  ASC-VERIFY-ZERO-COUNT     PIC S9(05) COMP-3.     04460099
044700             15  ASC-LIST-KEYS.                                   04470099
044800                 20  ASC-KEY-OPER-UNT-ID PIC S9(04) COMP.         04480099
044900                 20  ASC-KEY-FCLTY-ID    PIC S9(04) COMP.         04490099
045000                 20  ASC-SCAC-ID         PIC  X(04).              04500099
045100                 20  ASC-VEH-NBR         PIC  X(10).              04510099
045200                 20  ASC-TRLR-STATUS     PIC  X(10).              04520099
045300                 20  ASC-TOT-UNITS       PIC S9(07) COMP.         04530099
045400                 20  ASC-TRIP-ID         PIC S9(09) COMP.         04540099
045500                                                                  04550099
045600                                                                  04560099
045700             15  ASC-FUNC06-RETURN-FLAG    PIC  X(1).             04570099
045800                 88  ASC-FUNC06-RETURN-NO   VALUE 'N'.            04580099
045900                 88  ASC-FUNC06-RETURN-YES  VALUE 'Y'.            04590099
046000             15  ASC-VALID-LOCATION-SW     PIC  X(01).            04600099
046100                 88  ASC-VALID-LOCATION     VALUE 'Y'.            04610099
046200                 88  ASC-VALID-LOCATION-NO  VALUE 'N'.            04620099
046300             15  ASC-CHECKLIST-SW          PIC  X(01).            04630099
046400                 88  ASC-CHECKLIST-YES      VALUE 'Y'.            04640099
046500                 88  ASC-CHECKLIST-NO       VALUE 'N'.            04650099
046600             15  ASC-FACILITY-AUTOVE-SW    PIC X(01).             04660099
046700                 88  ASC-FACILITY-AUTOVE-YES   VALUE 'Y'.         04670099
046800                 88  ASC-FACILITY-AUTOVE-NO    VALUE 'N'.         04680099
046810             15  ASC-MESSAGE-DISPLAY-SW     PIC  X(01).           04681099
046820                 88  ASC-MESSAGE-DISPLAY     VALUE 'Y'.           04682099
046830                 88  ASC-MESSAGE-DISPLAY-NO  VALUE 'N'.           04683099
046840                                                                  04684099
046850                                                                  04685099
046860             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04686099
046870                 20  ASC-BLOCK-MODIFIED-SW                        04687099
046880                                        PIC X(01).                04688099
046890                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    04689099
046900                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    04690099
047000                                                                  04700099
047100                 20  ASC-ITEM-ARRAY.                              04710099
047200                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        04720099
047300                         30  ASC-LIST-ITEM-NUMBER                 04730099
047400                                        PIC S9(09)  COMP-3.       04740099
047500                         30  ASC-TEMP-SELECTED-SW                 04750099
047600                                        PIC X(01).                04760099
047700                             88  ASC-VALID-SELECT   VALUE ' '     04770099
047800                                                          'Y'     04780099
047900                                                          'B'     04790099
048000                                                          'E'.    04800099
048100                             88  ASC-TEMP-NO-SELECT VALUE ' '.    04810099
048200                             88  ASC-TEMP-SELECT    VALUE 'Y'.    04820099
048300                             88  ASC-TEMP-BEGIN     VALUE 'B'.    04830099
048400                             88  ASC-TEMP-END       VALUE 'E'.    04840099
048500                         30  ASC-SELECTED-SW                      04850099
048600                                        PIC X(01).                04860099
048700                             88  ASC-NO-SELECT      VALUE ' '.    04870099
048800                             88  ASC-SELECT         VALUE 'Y'.    04880099
048900                             88  ASC-BEGIN          VALUE 'B'.    04890099
049000                             88  ASC-END            VALUE 'E'.    04900099
049100                         30  ASC-MESSAGE       PIC X(75).         04910099
049200                                                                  04920099
049300             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     04930099
049400             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     04940099
049500             15  ASC-NUMBER-OF-ITEMS-READ                         04950099
049600                                        PIC S9(09) COMP-3.        04960099
049700             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04970099
049800                                        PIC S9(09) COMP-3.        04980099
049900             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        04990099
050000             15  ASC-ITEM-AT-TOP-OF-PANEL                         05000099
050100                                        PIC S9(09) COMP-3.        05010099
050200             15  ASC-ITEM-AT-BOT-OF-PANEL                         05020099
050300                                        PIC S9(09) COMP-3.        05030099
050400             15  ASC-HIGHEST-BLOCK-WRITTEN                        05040099
050500                                        PIC S9(04) COMP SYNC.     05050099
050600             15  ASC-START-OF-SELECTED-RANGE                      05060099
050700                                        PIC S9(09) COMP-3.        05070099
050800             15  ASC-END-OF-SELECTED-RANGE                        05080099
050900                                        PIC S9(09) COMP-3.        05090099
051000             15  ASC-ITEMS-LEFT-INDICATOR                         05100099
051100                                        PIC X(01).                05110099
051200                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05120099
051300                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05130099
051400             15  ASC-TEMP-QUEUE-UPDATE-SW                         05140099
051500                                        PIC X(01).                05150099
051600                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05160099
051700                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05170099
051800             15  ASC-LIST-QUEUE-NAME.                             05180099
051900                 20  ASC-LIST-TERM-ID   PIC X(04).                05190099
052000                 20  ASC-LIST-TASK-NUMBER                         05200099
052100                                        PIC S9(05) COMP-3.        05210099
052200                 20  ASC-LIST-SEQ       PIC 9(01).                05220099
052300             15  ASC-SEL-QUEUE-NAME.                              05230099
052400                 20  ASC-SEL-TERM-ID    PIC X(04).                05240099
052500                 20  ASC-SEL-TASK-NUMBER                          05250099
052600                                        PIC S9(05) COMP-3.        05260099
052700                 20  ASC-SEL-SEQ        PIC 9(01).                05270099
052800                                                                  05280099
052900             15  ASC-CURSOR-SW          PIC X(01).                05290099
053000                 88  ASC-NO-CURSOR                 VALUE 'Z'.     05300099
053100                 88  ASC-TYPE-CURSOR               VALUE 'S'.     05310099
053200                 88  ASC-LOC-CURSOR                VALUE 'N'.     05320099
053300                 88  ASC-DESC-CURSOR               VALUE 'T'.     05330099
053400             15  ASC-START-ITEM-REQUEST.                          05340099
053500                 20  ASC-START-ITEM-REQUEST-N                     05350099
053600                                        PIC 9(07).                05360099
053700             15  ASC-ENT-NAME-DESC      PIC X(25).                05370099
053800             15  ASC-PO-NBR             PIC 9(08).                05380099
053900             15  ASC-REC-SEQ-NBR        PIC 9(04).                05390099
054000                                                                  05400099
054100             15  ASC-RPA-MISDRCT-CK-SW  PIC X(01).                05410099
054101                 88  ASC-RPA-MISDRCT-CK            VALUE 'Y'.     05410199
054102                 88  ASC-NO-RPA-MISDRCT-CK         VALUE 'N'.     05410299
054103                                                                  05410399
054110             15  FILLER                 PIC X(653).               05411099
054200/                                                                 05420099
054300*---------------------------------------------------------------* 05430099
054400*    ABEND PROCESSING COPYBOOK.                                 * 05440099
054500*---------------------------------------------------------------* 05450099
054600     COPY DPWS013.                                                05460099
054700/                                                                 05470099
054800***************************************************************** 05480099
054900*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 05490099
055000*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 05500099
055100***************************************************************** 05510099
055200     COPY RCWS040.                                                05520099
055300/                                                                 05530099
055400***************************************************************** 05540099
055500*  RECORD LAYOUT FOR THE COMMAREA BEING USED TO PASS DATA TO    * 05550099
055600*  THE AUTO CONFIRMATION MODULE (RCKUT125).                     * 05560099
055700***************************************************************** 05570099
055800     COPY RCWS041.                                                05580099
055900                                                                  05590099
056000***************************************************************** 05600099
056100*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER           * 05610099
056200*             TO PASS INFO TO MODULE (RCKUT128).                * 05620099
056300***************************************************************** 05630099
056400     COPY RCWS074.                                                05640099
056500/                                                                 05650099
056600*---------------------------------------------------------------* 05660099
056700*    DB2 AREA FOR RECEIVER DISTRIBUTION TABLE                   * 05670099
056800*---------------------------------------------------------------* 05680099
056900     EXEC SQL                                                     05690099
057000          INCLUDE TRECDIS                                         05700099
057100     END-EXEC.                                                    05710099
057200/                                                                 05720099
057300*---------------------------------------------------------------* 05730099
057400*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 05740099
057500*---------------------------------------------------------------* 05750099
057600     EXEC SQL                                                     05760099
057700          INCLUDE TPURCHS                                         05770099
057800     END-EXEC.                                                    05780099
057900/                                                                 05790099
058000*---------------------------------------------------------------* 05800099
058100*    DB2 AREA FOR THE ENTERPRISE TABLE                          * 05810099
058200*---------------------------------------------------------------* 05820099
058300     EXEC SQL                                                     05830099
058400          INCLUDE TEXTENT                                         05840099
058500     END-EXEC.                                                    05850099
058600/                                                                 05860099
058700*---------------------------------------------------------------* 05870099
058800*    DB2 AREA FOR RECEIVER TABLE                                * 05880099
058900*---------------------------------------------------------------* 05890099
059000     EXEC SQL                                                     05900099
059100          INCLUDE TRECEIV                                         05910099
059200     END-EXEC.                                                    05920099
059300/                                                                 05930099
059400*---------------------------------------------------------------* 05940099
059500*    DB2 AREA FOR PO STATUS CODE TABLE                          * 05950099
059600*---------------------------------------------------------------* 05960099
059700     EXEC SQL                                                     05970099
059800          INCLUDE TSTATCD                                         05980099
059900     END-EXEC.                                                    05990099
060000/                                                                 06000099
060100*---------------------------------------------------------------* 06010099
060200*    DB2 AREA FOR PO SHIPMENT TABLE                             * 06020099
060300*---------------------------------------------------------------* 06030099
060400     EXEC SQL                                                     06040099
060500          INCLUDE TSHPTPO                                         06050099
060600     END-EXEC.                                                    06060099
060700/                                                                 06070099
060800*---------------------------------------------------------------* 06080099
060900*    DB2 AREA FOR SHIPMENT TABLE                                * 06090099
061000*---------------------------------------------------------------* 06100099
061100     EXEC SQL                                                     06110099
061200          INCLUDE TSHIPMT                                         06120099
061300     END-EXEC.                                                    06130099
061400/                                                                 06140099
061500*---------------------------------------------------------------* 06150099
061600*    DB2 AREA FOR COMMUNICATIONS                                * 06160099
061700*---------------------------------------------------------------* 06170099
061800     EXEC SQL                                                     06180099
061900          INCLUDE SQLCA                                           06190099
062000     END-EXEC.                                                    06200099
062100/                                                                 06210099
062200*----------------------------------------------------------------*06220099
062300*    DB2 AREA FOR OPERATION SET TABLE                            *06230099
062400*----------------------------------------------------------------*06240099
062500     EXEC SQL                                                     06250099
062600          INCLUDE TOPRSET                                         06260099
062700     END-EXEC.                                                    06270099
062800/                                                                 06280099
062900*----------------------------------------------------------------*06290099
063000*    DB2 AREA FOR WORK ORDER TABLE                               *06300099
063100*----------------------------------------------------------------*06310099
063200     EXEC SQL                                                     06320099
063300          INCLUDE TWRKORD                                         06330099
063400     END-EXEC.                                                    06340099
063500/                                                                 06350099
064300*----------------------------------------------------------------*06430099
064400*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06440099
064500*----------------------------------------------------------------*06450099
064600     EXEC SQL                                                     06460099
064700          INCLUDE TTRBNTF                                         06470099
064800     END-EXEC.                                                    06480099
064900/                                                                 06490099
065000*----------------------------------------------------------------*06500099
065100*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION AUDIT TABLE          06510099
065200*----------------------------------------------------------------*06520099
065300     EXEC SQL                                                     06530099
065400          INCLUDE TAURECD                                         06540099
065500     END-EXEC.                                                    06550099
065600/                                                                 06560099
065700*----------------------------------------------------------------*06570099
065800*    DB2 DCLGEN FOR THE PACKSLIP TABLE                            06580099
065900*----------------------------------------------------------------*06590099
066000     EXEC SQL                                                     06600099
066100          INCLUDE TPKSLIP                                         06610099
066200     END-EXEC.                                                    06620099
066300/                                                                 06630099
066400*----------------------------------------------------------------*06640099
066500*    DB2 DCLGEN FOR THE TVHTRIP TABLE                             06650099
066600*----------------------------------------------------------------*06660099
066700     EXEC SQL                                                     06670099
066800          INCLUDE TVHTRIP                                         06680099
066900     END-EXEC.                                                    06690099
067000/                                                                 06700099
067100*----------------------------------------------------------------*06710099
067200*    DB2 DCLGEN FOR THE TDISTHD TABLE                             06720099
067300*----------------------------------------------------------------*06730099
067400     EXEC SQL                                                     06740099
067500          INCLUDE TDISTHD                                         06750099
067600     END-EXEC.                                                    06760099
067700/                                                                 06770099
067800*----------------------------------------------------------------*06780099
067900*    DB2 DCLGEN FOR THE TINPKSU TABLE                             06790099
068000*----------------------------------------------------------------*06800099
068100     EXEC SQL                                                     06810099
068200          INCLUDE TINPKSU                                         06820099
068300     END-EXEC.                                                    06830099
068400/                                                                 06840099
068500*----------------------------------------------------------------*06850099
068600*    DB2 DCLGEN FOR THE TSHUNLO TABLE                             06860099
068700*----------------------------------------------------------------*06870099
068800     EXEC SQL                                                     06880099
068900          INCLUDE TSHUNLO                                         06890099
069000     END-EXEC.                                                    06900099
069100/                                                                 06910099
069200*----------------------------------------------------------------*06920099
069300*    DB2 DCLGEN FOR THE TTRBRSN TABLE                             06930099
069400*----------------------------------------------------------------*06940099
069500     EXEC SQL                                                     06950099
069600          INCLUDE TTRBRSN                                         06960099
069700     END-EXEC.                                                    06970099
069800/                                                                 06980099
069900*---------------------------------------------------------------* 06990099
070000*    DB2 AREA FOR TRIP STATUS TABLE                             * 07000099
070100*---------------------------------------------------------------* 07010099
070200     EXEC SQL                                                     07020099
070300          INCLUDE TTRIPST                                         07030099
070400     END-EXEC.                                                    07040099
070500*---------------------------------------------------------------* 07050099
070600*    DB2 AREA FOR THE VEHICLE TABLE                             * 07060099
070700*---------------------------------------------------------------* 07070099
070800     EXEC SQL                                                     07080099
070900          INCLUDE TVEHICL                                         07090099
071000     END-EXEC.                                                    07100099
071100                                                                  07110099
071200*---------------------------------------------------------------* 07120099
071300*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 07130099
071400*---------------------------------------------------------------* 07140099
071500     EXEC SQL                                                     07150099
071600          INCLUDE TSHIPST                                         07160099
071700     END-EXEC.                                                    07170099
071800                                                                  07180099
071900*---------------------------------------------------------------* 07190099
072000*    DB2 AREA FOR TRIP STATUS TABLE                             * 07200099
072100*---------------------------------------------------------------* 07210099
072200     EXEC SQL                                                     07220099
072300          INCLUDE TTRSTYP                                         07230099
072400     END-EXEC.                                                    07240099
072500*---------------------------------------------------------------* 07250099
072600*    DB2 AREA FOR VEHICLE AUDIT TABLE                           * 07260099
072700*---------------------------------------------------------------* 07270099
072800     EXEC SQL                                                     07280099
072900          INCLUDE TAUVHCL                                         07290099
073000     END-EXEC.                                                    07300099
073100                                                                  07310099
073200*---------------------------------------------------------------* 07320099
073300*    DB2 AREA FOR SHIPMENT TYPE TABLE                           * 07330099
073400*---------------------------------------------------------------* 07340099
073500     EXEC SQL                                                     07350099
073600          INCLUDE TSHSTYP                                         07360099
073700     END-EXEC.                                                    07370099
073800                                                                  07380099
073900*----------------------------------------------------------------*07390099
074000*    DB2 DCLGEN FOR TKRPRPM TABLE                                 07400099
074100*----------------------------------------------------------------*07410099
074200     EXEC SQL                                                     07420099
074300          INCLUDE TKRPRPM                                         07430099
074400     END-EXEC.                                                    07440099
074500                                                                  07450099
074600*----------------------------------------------------------------*07460099
074700*    DB2 DCLGEN FOR SUT_OTBND_UPC                                 07470099
074800*----------------------------------------------------------------*07480099
074900     EXEC SQL                                                     07490099
075000          INCLUDE SUT00028                                        07500099
075100     END-EXEC.                                                    07510099
075200                                                                  07520099
075300*----------------------------------------------------------------*07530099
075400*    DB2 DCLGEN FOR SUT_OTBND_CART                                07540099
075500*----------------------------------------------------------------*07550099
075600     EXEC SQL                                                     07560099
075700          INCLUDE SUT00024                                        07570099
075800     END-EXEC.                                                    07580099
075900/                                                                 07590099
076000*----------------------------------------------------------------*07600099
076100*    DB2 DCLGEN FOR RCT_TRLR_UNLD                                 07610099
076200*----------------------------------------------------------------*07620099
076300     EXEC SQL                                                     07630099
076400          INCLUDE RCT00014                                        07640099
076500     END-EXEC.                                                    07650099
076600/                                                                 07660099
076700*----------------------------------------------------------------*07670099
076800*    DB2 DCLGEN FOR RCT_TRLR_UNLD_MSG                             07680099
076900*----------------------------------------------------------------*07690099
077000     EXEC SQL                                                     07700099
077100          INCLUDE RCT00015                                        07710099
077200     END-EXEC.                                                    07720099
077300/                                                                 07730099
077400*----------------------------------------------------------------*07740099
077500*    DB2 DCLGEN FOR RCT_RCVR_TRLR_LST                             07750099
077600*----------------------------------------------------------------*07760099
077700     EXEC SQL                                                     07770099
077800          INCLUDE RCT00016                                        07780099
077900     END-EXEC.                                                    07790099
078000/                                                                 07800099
078100*---------------------------------------------------------------* 07810099
078200*  CURSOR TO SELECT RECEIVERS                                   * 07820099
078300*---------------------------------------------------------------* 07830099
078400                                                                  07840099
078500     EXEC SQL                                                     07850099
078600          DECLARE RCVR-CSR CURSOR FOR                             07860099
078700          SELECT C.PO_NBR                                         07870099
078800                ,C.REC_SEQ_NBR                                    07880099
078900                ,E.STATUS_CDE                                     07890099
079000                ,E.PACK_BY_ST_IND                                 07900099
079100                ,E.FRE_ASTRA_IND                                  07910099
079200                ,E.PKGNG_CDE                                      07920099
079300            FROM  TVHTRIP A                                       07930099
079400                , TSHIPMT B                                       07940099
079500                , TSHPTPO C                                       07950099
079600                , TRECEIV E                                       07960099
079700            WHERE A.TRIP_ID           = :DK-TRIP-ID               07970099
079800              AND A.TRIP_ID           = B.TRIP_ID                 07980099
079900              AND C.SHIPT_ID          = B.SHIPT_ID                07990099
080000              AND C.PRIM_SHIPT_IND    = 'Y'                       08000099
080100              AND C.PO_NBR            = E.ORD_NBR                 08010099
080200              AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR             08020099
080300              AND E.VER_STATUS_CDE    = 'A'                       08030099
080400              AND E.STATUS_CDE     IN ('IP' , 'CM')               08040099
080500                                                                  08050099
080600     END-EXEC.                                                    08060099
080700                                                                  08070099
080800*---------------------------------------------------------------* 08080099
080900*  CURSOR TO LIST SHIPMENTS FOR A TRIP                          * 08090099
081000*---------------------------------------------------------------* 08100099
081100                                                                  08110099
081200     EXEC SQL                                                     08120099
081300          DECLARE SHIPMENT-CSR CURSOR FOR                         08130099
081400           SELECT SHIPT_ID                                        08140099
081500            FROM  TSHIPMT                                         08150099
081600           WHERE  TRIP_ID = :DK-TRIP-ID                           08160099
081700             AND  TRIP_ID IS NOT NULL                             08170099
081800         ORDER BY SHIPT_ID                                        08180099
081900     END-EXEC.                                                    08190099
082000                                                                  08200099
082100/                                                                 08210099
082200***************************************************************** 08220099
082300 LINKAGE SECTION.                                                 08230099
082400                                                                  08240099
082500 01  DFHCOMMAREA.                                                 08250099
082600     05  FILLER                         OCCURS  1 TO 4072 TIMES   08260099
082700                                        DEPENDING ON EIBCALEN.    08270099
082800         10  FILLER                     PIC X.                    08280099
082900                                                                  08290099
083000/                                                                 08300099
083100 PROCEDURE DIVISION.                                              08310099
083200*---------------------------------------------------------------* 08320099
083300*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 08330099
083400*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 08340099
083500*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 08350099
083600*---------------------------------------------------------------* 08360099
083700 0000-MAIN-MODULE.                                                08370099
083800                                                                  08380099
083900     INITIALIZE DP030-CICS-API-FIELDS.                            08390099
084000                                                                  08400099
084100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08410099
084200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08420099
084300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08430099
084400                                                                  08440099
084500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08450099
084600                                                                  08460099
084700     MOVE LENGTH OF RC827AI        TO DP030-MAP-LENGTH (1).       08470099
084800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08480099
084900     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       08490099
085000                                                                  08500099
085100     PERFORM 0001-CALL-CICS-ARCH-API.                             08510099
085200     PERFORM 1000-CONTROL-PROCESSING                              08520099
085300                                                                  08530099
085400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08540099
085500     PERFORM 0001-CALL-CICS-ARCH-API.                             08550099
085600                                                                  08560099
085700*---------------------------------------------------------------* 08570099
085800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 08580099
085900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 08590099
086000*---------------------------------------------------------------* 08600099
086100 0001-CALL-CICS-ARCH-API.                                         08610099
086210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08621099
086300                                    DFHCOMMAREA                   08630099
086400                                    DP030-CICS-API-FIELDS         08640099
086500                                    DP020-STANDARD-COMMAREA       08650099
086600                                    RC827AI.                      08660099
086700                                                                  08670099
086800     IF DP030-RC-CALL-SUCCESSFUL OR                               08680099
086900        DP030-RC-APPL-ERROR                                       08690099
087000         CONTINUE                                                 08700099
087100     ELSE                                                         08710099
087200         SET DP013-NO-ROLLBACK                                    08720099
087300             DP013-XCTL-DISPLAY-RESTART                           08730099
087400             DP013-CICS-ABEND      TO TRUE                        08740099
087500         MOVE '0001-CALL-CICS-ARCH-API'                           08750099
087600                                   TO DP013-PARAGRAPH             08760099
087620         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O08762099
087630-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08763099
087900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08790099
088000         PERFORM DP013-0000-PROCESS-ABEND                         08800099
088100     END-IF.                                                      08810099
088200                                                                  08820099
088300*----------------------------------------------------------------*08830099
088400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08840099
088500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08850099
088600*                                                                *08860099
088700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08870099
088800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08880099
088900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08890099
089000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08900099
089100*----------------------------------------------------------------*08910099
089200                                                                  08920099
089300 1000-CONTROL-PROCESSING.                                         08930099
089400                                                                  08940099
089500     EVALUATE TRUE                                                08950099
089600         WHEN DP030-RC-APPL-ERROR                                 08960099
089700             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08970099
089800             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                08980099
089900             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08990099
090000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09000099
090100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09010099
090200                                                                  09020099
090300         WHEN DP020-NEXT-ACT-INITIAL                              09030099
090400             INITIALIZE ASC-SPECIFIC-COMMAREA                     09040099
090500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09050099
090600                                      ASC-SEL-TERM-ID             09060099
090700             MOVE DP020-SRC-TASK-NUMBER                           09070099
090800                                   TO ASC-LIST-TASK-NUMBER        09080099
090900                                      ASC-SEL-TASK-NUMBER         09090099
091000             MOVE PC-LIST-QUEUE-SEQ                               09100099
091100                                   TO ASC-LIST-SEQ                09110099
091200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09120099
091300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09130099
091400             IF  PS-COMMAREA-NOT-VALID                            09140099
091500                 SET DP020-NEXT-ACT-APPL-ERROR                    09150099
091600                                   TO TRUE                        09160099
091700             ELSE                                                 09170099
091800                 MOVE 'I'      TO RCT00014-ACTN-CDE               09180099
091900                 MOVE 'N'      TO RCT00014-PRCG-STAT-CDE          09190099
092000                 PERFORM 2060-AUDIT-PROCESS                       09200099
092100                 PERFORM 4000-BUILD-INITIAL-PANEL                 09210099
092200             END-IF                                               09220099
092300                                                                  09230099
092400         WHEN DP020-NEXT-ACT-READ-MAP                             09240099
092500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09250099
092600                                   TO PV-TOP-ITEM                 09260099
092700             PERFORM 2000-PROCESS-PANEL                           09270099
092800                                                                  09280099
092900         WHEN DP020-NEXT-ACT-RETURN                               09290099
093000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09300099
093100                                   TO PV-TOP-ITEM                 09310099
093200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09320099
093300             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09330099
093400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09340099
093500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09350099
093600                                                                  09360099
093700         WHEN OTHER                                               09370099
093800             SET DP013-LOGIC-ABEND TO TRUE                        09380099
093900             SET DP013-NO-ROLLBACK TO TRUE                        09390099
094000             MOVE '1000-CONTROL-PROCESSING'                       09400099
094100                                   TO DP013-PARAGRAPH             09410099
094200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09420099
094300                                   TO DP013-MESSAGE-TEXT(1)       09430099
094400             PERFORM DP013-0000-PROCESS-ABEND                     09440099
094500     END-EVALUATE.                                                09450099
094600                                                                  09460099
094700/                                                                 09470099
094800*----------------------------------------------------------------*09480099
094900* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *09490099
095000*----------------------------------------------------------------*09500099
095100                                                                  09510099
095200 1100-PROCESS-INTER-APPL-COMM.                                    09520099
095300                                                                  09530099
095400     SET PS-COMMAREA-VALID         TO TRUE.                       09540099
095500     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09550099
095600                                                                  09560099
095700     IF  DP020-INT-APPL-FORMAT-IND = PC-RCVR-PO-LIST              09570099
095800         MOVE RC815-OPER-UNT-ID     TO ASC-KEY-OPER-UNT-ID        09580099
095900                                       DK-OPER-UNT-ID             09590099
096000         MOVE RC815-FCLTY-ID        TO ASC-KEY-FCLTY-ID           09600099
096100                                       DK-FCLTY-ID                09610099
096200         MOVE RC815-SCAC-CDE        TO ASC-SCAC-ID                09620099
096300         MOVE RC815-TRLR-NBR        TO ASC-VEH-NBR                09630099
096400         MOVE RC815-TRAILER-STATUS  TO ASC-TRLR-STATUS            09640099
096500         MOVE RC815-TRIP-ID         TO ASC-TRIP-ID                09650099
096600                                       DK-TRIP-ID                 09660099
096700     ELSE                                                         09670099
096800         SET DP030-OVERRIDE-GO      TO TRUE                       09680099
096900         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           09690099
097000         SET DP020-MSG-WARNING                                    09700099
097100             DP020-NEXT-ACT-APPL-ERROR                            09710099
097200                                    TO TRUE                       09720099
097300     END-IF.                                                      09730099
097400                                                                  09740099
097500*----------------------------------------------------------------*09750099
097600*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *09760099
097700*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *09770099
097800*----------------------------------------------------------------*09780099
097900 1120-PREPARE-LIST-ENTRY.                                         09790099
098000                                                                  09800099
098100     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                09810099
098200     MOVE ZERO                     TO ASC-SEL-ITEM.               09820099
098300     PERFORM 2160-GET-NEXT-RECORD.                                09830099
098400                                                                  09840099
098500/                                                                 09850099
098600*----------------------------------------------------------------*09860099
098700* CHECK PARM TABLE TO SEE IF CURRENT DC LOCATION WILL HAVE THE   *09870099
098800* SELECTION COLUMN APPEAR NEXT TO EACH MESSAGE.                  *09880099
098900*----------------------------------------------------------------*09890099
099000                                                                  09900099
099100 1150-SELECT-TKRPRPM.                                             09910099
099200                                                                  09920099
099300     EXEC SQL                                                     09930099
099400          SELECT FUNC_TXT                                         09940099
099500            INTO :KRPRPM-FUNC-TXT                                 09950099
099600            FROM TKRPRPM                                          09960099
099700           WHERE LOC_ID            = :ASC-KEY-OPER-UNT-ID         09970099
099800             AND INTFC_SYS_CDE     = 'KHL'                        09980099
099900             AND SYS_PRC_FUNC_CDE  = 'RSSSEL'                     09990099
100000             AND FUNC_PRC_STAT_CDE = 'AC'                         10000099
100100             AND FUNC_TXT          = 'Y'                          10010099
100200     END-EXEC.                                                    10020099
100300                                                                  10030099
100400     EVALUATE TRUE                                                10040099
100500         WHEN SQLCODE = ZERO                                      10050099
100600              SET ASC-VALID-LOCATION       TO TRUE                10060099
100700*             SET ASC-CHECKLIST-YES        TO TRUE                10070099
100800         WHEN SQLCODE = +100                                      10080099
100900              SET ASC-VALID-LOCATION-NO    TO TRUE                10090099
101000         WHEN SQLWARN0 NOT = SPACE                                10100099
101100         WHEN SQLCODE < ZERO                                      10110099
101200         WHEN SQLCODE > ZERO                                      10120099
101300             MOVE '1150-SELECT-TKRPRPM'                           10130099
101400                             TO DP013-PARAGRAPH                   10140099
101500             MOVE 'SELECT PARM VALUE'                             10150099
101600                             TO DP013-MESSAGE-TEXT (1)            10160099
101700             MOVE ASC-KEY-OPER-UNT-ID  TO DP013-MESSAGE-TEXT (2)  10170099
101800             MOVE SQLCA      TO DP013-SQLCA                       10180099
101900             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          10190099
102000             SET DP013-DB2-ABEND                                  10200099
102100                             TO TRUE                              10210099
102200             SET DP013-XCTL-DISPLAY-RESTART                       10220099
102300                             TO TRUE                              10230099
102400             PERFORM DP013-0000-PROCESS-ABEND                     10240099
102500     END-EVALUATE.                                                10250099
102600                                                                  10260099
102700*----------------------------------------------------------------*10270099
102800* CHECK PARM TABLE TO SEE IF CURRENT DC LOCATION WILL HAVE THE   *10280099
102900* SELECTION COLUMN APPEAR NEXT TO EACH MESSAGE.                  *10290099
103000*----------------------------------------------------------------*10300099
103100                                                                  10310099
103110 1160-SELECT-TKRPRPM.                                             10311099
103120                                                                  10312099
103130     EXEC SQL                                                     10313099
103140          SELECT FUNC_TXT                                         10314099
103150            INTO :KRPRPM-FUNC-TXT                                 10315099
103160            FROM TKRPRPM                                          10316099
103170           WHERE LOC_ID            = :ASC-KEY-OPER-UNT-ID         10317099
103180             AND INTFC_SYS_CDE     = 'KHL'                        10318099
103190             AND SYS_PRC_FUNC_CDE  = 'RC827D'                     10319099
103191             AND FUNC_PRC_STAT_CDE = 'AC'                         10319199
103192             AND FUNC_TXT          = 'Y'                          10319299
103193     END-EXEC.                                                    10319399
103194                                                                  10319499
103195     EVALUATE TRUE                                                10319599
103196         WHEN SQLCODE = ZERO                                      10319699
103197              SET ASC-MESSAGE-DISPLAY      TO TRUE                10319799
103198         WHEN SQLCODE = +100                                      10319899
103199              SET ASC-MESSAGE-DISPLAY-NO   TO TRUE                10319999
103200         WHEN SQLWARN0 NOT = SPACE                                10320099
103201         WHEN SQLCODE < ZERO                                      10320199
103202         WHEN SQLCODE > ZERO                                      10320299
103203             MOVE '1160-SELECT-TKRPRPM'                           10320399
103204                             TO DP013-PARAGRAPH                   10320499
103205             MOVE 'SELECT PARM VALUE'                             10320599
103206                             TO DP013-MESSAGE-TEXT (1)            10320699
103207             MOVE ASC-KEY-OPER-UNT-ID  TO DP013-MESSAGE-TEXT (2)  10320799
103208             MOVE SQLCA      TO DP013-SQLCA                       10320899
103209             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          10320999
103210             SET DP013-DB2-ABEND                                  10321099
103211                             TO TRUE                              10321199
103212             SET DP013-XCTL-DISPLAY-RESTART                       10321299
103213                             TO TRUE                              10321399
103214             PERFORM DP013-0000-PROCESS-ABEND                     10321499
103215     END-EVALUATE.                                                10321599
103216                                                                  10321699
103217*----------------------------------------------------------------*10321799
103218* CHECK PARM TABLE TO SEE IF CURRENT DC LOCATION TO SEE IF THE   *10321899
103219* DC IS USING RPA MIS-DIRECT PROCESS                             *10321999
103220*----------------------------------------------------------------*10322099
103221                                                                  10322199
103222 1170-SELECT-TKRPRPM.                                             10322299
103223                                                                  10322399
103224     EXEC SQL                                                     10322499
103225          SELECT FUNC_TXT                                         10322599
103226            INTO :KRPRPM-FUNC-TXT                                 10322699
103227            FROM TKRPRPM                                          10322799
103228           WHERE LOC_ID            = :ASC-KEY-OPER-UNT-ID         10322899
103229             AND INTFC_SYS_CDE     = 'KHL'                        10322999
103230             AND SYS_PRC_FUNC_CDE  = 'RPAMSD'                     10323099
103231             AND FUNC_PRC_STAT_CDE = 'AC'                         10323199
103232             AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP            10323299
103233             AND FUNC_END_TMST    >= CURRENT TIMESTAMP            10323399
103234             AND FUNC_TXT          = 'Y'                          10323499
103235     END-EXEC.                                                    10323599
103236                                                                  10323699
103237     EVALUATE TRUE                                                10323799
103238         WHEN SQLCODE = ZERO                                      10323899
103239              SET ASC-RPA-MISDRCT-CK       TO TRUE                10323999
103240         WHEN SQLCODE = +100                                      10324099
103241              SET ASC-NO-RPA-MISDRCT-CK    TO TRUE                10324199
103242         WHEN SQLWARN0 NOT = SPACE                                10324299
103243         WHEN SQLCODE < ZERO                                      10324399
103244         WHEN SQLCODE > ZERO                                      10324499
103245             MOVE '1170-SELECT-TKRPRPM'                           10324599
103246                             TO DP013-PARAGRAPH                   10324699
103247             MOVE 'SELECT PARM VALUE'                             10324799
103248                             TO DP013-MESSAGE-TEXT (1)            10324899
103249             MOVE ASC-KEY-OPER-UNT-ID  TO DP013-MESSAGE-TEXT (2)  10324999
103250             MOVE SQLCA      TO DP013-SQLCA                       10325099
103251             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          10325199
103252             SET DP013-DB2-ABEND                                  10325299
103253                             TO TRUE                              10325399
103254             SET DP013-XCTL-DISPLAY-RESTART                       10325499
103255                             TO TRUE                              10325599
103256             PERFORM DP013-0000-PROCESS-ABEND                     10325699
103257     END-EVALUATE.                                                10325799
103258                                                                  10325899
103259*----------------------------------------------------------------*10325999
103260* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10326099
103261* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10326199
103262* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10326299
103263* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10326399
103264* FUNCTION KEYS CAN GET THIS FAR.                                *10326499
103265*----------------------------------------------------------------*10326599
103266                                                                  10326699
103270 2000-PROCESS-PANEL.                                              10327099
103280     EVALUATE TRUE                                                10328099
103290         WHEN DP020-SRC-AID = DP016-CLEAR                         10329099
103300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10330099
103400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10340099
103500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10350099
103600                                                                  10360099
103700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10370099
103800             MOVE 'I'              TO RCT00014-ACTN-CDE           10380099
103900             MOVE 'N'              TO RCT00014-PRCG-STAT-CDE      10390099
104000             MOVE RC815-OPER-UNT-ID     TO ASC-KEY-OPER-UNT-ID    10400099
104100                                           DK-OPER-UNT-ID         10410099
104200             MOVE RC815-FCLTY-ID        TO ASC-KEY-FCLTY-ID       10420099
104300                                           DK-FCLTY-ID            10430099
104400             MOVE RC815-SCAC-CDE        TO ASC-SCAC-ID            10440099
104500             MOVE RC815-TRLR-NBR        TO ASC-VEH-NBR            10450099
104600             MOVE RC815-TRAILER-STATUS  TO ASC-TRLR-STATUS        10460099
104700             MOVE RC815-TRIP-ID         TO ASC-TRIP-ID            10470099
104800                                           DK-TRIP-ID             10480099
104900             PERFORM 2060-AUDIT-PROCESS                           10490099
105000             PERFORM 2050-DELETE-LIST-QUEUE                       10500099
105100             PERFORM 4000-BUILD-INITIAL-PANEL                     10510099
105200                                                                  10520099
105300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10530099
105400             PERFORM 2140-DESELECT-ALL-ITEMS                      10540099
105500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10550099
105600                                                                  10560099
105700         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 10570099
105800              PERFORM 2150-SELECT-ALL-ITEMS                       10580099
105900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10590099
106000                                                                  10600099
106100         WHEN OTHER                                               10610099
106200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10620099
106300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10630099
106400             IF  PS-NO-ERROR                                      10640099
106500                 SET DP030-CONTINUE-GO TO TRUE                    10650099
106600                 PERFORM 2100-CHECK-FUNCTION-KEY                  10660099
106700             ELSE                                                 10670099
106800                 SET DP030-OVERRIDE-GO TO TRUE                    10680099
106900             END-IF                                               10690099
107000     END-EVALUATE.                                                10700099
107100                                                                  10710099
107200/                                                                 10720099
107300*----------------------------------------------------------------*10730099
107400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10740099
107500*----------------------------------------------------------------*10750099
107600 2050-DELETE-LIST-QUEUE.                                          10760099
107700                                                                  10770099
107800     EXEC CICS                                                    10780099
107900         DELETEQ TS                                               10790099
108000           QUEUE (ASC-LIST-QUEUE-NAME)                            10800099
108100            RESP (PV-CICS-RESP)                                   10810099
108200     END-EXEC.                                                    10820099
108300                                                                  10830099
108400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10840099
108500        (PV-CICS-RESP = DFHRESP(QIDERR))                          10850099
108600         CONTINUE                                                 10860099
108700     ELSE                                                         10870099
108800         SET DP013-CICS-ABEND      TO TRUE                        10880099
108900         SET DP013-NO-ROLLBACK     TO TRUE                        10890099
109000                                                                  10900099
109100         MOVE '2050-DELETE-LIST-QUEUE'                            10910099
109200                                   TO DP013-PARAGRAPH             10920099
109300         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10930099
109400                                   TO DP013-MESSAGE-TEXT (1)      10940099
109500         PERFORM DP013-0000-PROCESS-ABEND                         10950099
109600     END-IF.                                                      10960099
109700                                                                  10970099
109800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10980099
109900                                                                  10990099
110000/                                                                 11000099
110100*----------------------------------------------------------------*11010099
110200*  IF INITIAL BUILD, F5=REFRESH OR F22=UNLOAD                     11020099
110300*  INSERT A HISTORY OF TRAILER ISSUES THAT ARE DISPLAYED ON SCREEN11030099
110400*  INTO TABLE RCT_TRLR_UNLD (RCT00014)                            11040099
110500*----------------------------------------------------------------*11050099
110600 2060-AUDIT-PROCESS.                                              11060099
110700                                                                  11070099
110800     EXEC SQL                                                     11080099
110900         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 11090099
111000     END-EXEC.                                                    11100099
111100                                                                  11110099
111200     EVALUATE TRUE                                                11120099
111300       WHEN SQLCODE EQUAL +0                                      11130099
111400           CONTINUE                                               11140099
111500       WHEN OTHER                                                 11150099
111600            SET PS-ERROR      TO TRUE                             11160099
111700     END-EVALUATE.                                                11170099
111800                                                                  11180099
111900     MOVE PV-CURRENT-TMST          TO RCT00014-CRE-TMST.          11190099
112000     MOVE DP020-USERID             TO RCT00014-CRE-BY-USR-ID.     11200099
112100     MOVE ASC-TRIP-ID              TO RCT00014-TRIP-ID.           11210099
112200                                                                  11220099
112300     PERFORM 2070-INSERT-RCT00014.                                11230099
112400/                                                                 11240099
112500*----------------------------------------------------------------*11250099
112600*  INSERT A HISTORY OF TRAILER ISSUES THAT ARE DISPLAYED ON SCREEN11260099
112700*  INTO TABLE RCT_TRLR_UNLD (RCT00014)                            11270099
112800*----------------------------------------------------------------*11280099
112900 2070-INSERT-RCT00014.                                            11290099
113000                                                                  11300099
113100     PERFORM                                                      11310099
113200         WITH TEST AFTER                                          11320099
113300         VARYING PV-RETRY-COUNTER                                 11330099
113400         FROM 1 BY 1                                              11340099
113500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11350099
113600             OR (SQLCODE = +0)                                    11360099
113700             OR (SQLCODE = -803))                                 11370099
113800                                                                  11380099
113900         EXEC SQL                                                 11390099
114000             INSERT  INTO RCT_TRLR_UNLD                           11400099
114100                    (CRE_TMST                                     11410099
114200                    ,CRE_BY_USR_ID                                11420099
114300                    ,TRIP_ID                                      11430099
114400                    ,ACTN_CDE                                     11440099
114500                    ,PRCG_STAT_CDE)                               11450099
114600            VALUES  (:RCT00014-CRE-TMST                           11460099
114700                    ,:RCT00014-CRE-BY-USR-ID                      11470099
114800                    ,:RCT00014-TRIP-ID                            11480099
114900                    ,:RCT00014-ACTN-CDE                           11490099
115000                    ,:RCT00014-PRCG-STAT-CDE)                     11500099
115100         END-EXEC                                                 11510099
115200                                                                  11520099
115300         EVALUATE TRUE                                            11530099
115400             WHEN SQLCODE = +0                                    11540099
115500                 CONTINUE                                         11550099
115600                                                                  11560099
115700             WHEN SQLCODE = -803                                  11570099
115800                 SET PS-ERROR                                     11580099
115900                     DP020-MSG-INFORMATIONAL                      11590099
116000                                        TO TRUE                   11600099
116100*                MOVE PC-TSYMSG-00417   TO DP020-MSG-NUMBER       11610099
116200                 SET DP030-SET-CURSOR-TRAILER                     11620099
116300                                        TO TRUE                   11630099
116400                                                                  11640099
116500             WHEN SQLCODE = -904                                  11650099
116600             WHEN SQLCODE = -913                                  11660099
116700                 CONTINUE                                         11670099
116800                                                                  11680099
116900             WHEN SQLWARN0 NOT = SPACES                           11690099
117000             WHEN SQLCODE < +0                                    11700099
117100             WHEN SQLCODE > +0                                    11710099
117200                 MOVE '2070-INSERT-RCT00014'                      11720099
117300                                   TO DP013-PARAGRAPH             11730099
117400                 MOVE 'INSERT A ROW ON RCT00014'                  11740099
117500                                   TO DP013-MESSAGE-TEXT(1)       11750099
117600                 MOVE SQLCA        TO DP013-SQLCA                 11760099
117700                 MOVE 'RCT_TRLR_UNLD' TO DP013-DB2-TABLE-NAME (1) 11770099
117800                 SET DP013-DB2-ABEND                              11780099
117900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11790099
118000                 PERFORM DP013-0000-PROCESS-ABEND                 11800099
118100         END-EVALUATE                                             11810099
118200     END-PERFORM.                                                 11820099
118300                                                                  11830099
118400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11840099
118500         SQLCODE NOT = +0                                         11850099
118600         MOVE '2070-INSERT-RCT00014'                              11860099
118700                                   TO DP013-PARAGRAPH             11870099
118800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              11880099
118900                                   TO DP013-MESSAGE-TEXT (1)      11890099
119000         MOVE 'TO INSERT A RCT00014 ROW'                          11900099
119100                                   TO DP013-MESSAGE-TEXT (2)      11910099
119200         MOVE SQLCA                TO DP013-SQLCA                 11920099
119300         MOVE 'RCT_TRLR_UNLD'      TO DP013-DB2-TABLE-NAME (1)    11930099
119400         SET DP013-DB2-ABEND                                      11940099
119500             DP013-XCTL-DISPLAY-RESTART                           11950099
119600                                   TO TRUE                        11960099
119700         PERFORM DP013-0000-PROCESS-ABEND                         11970099
119800     END-IF.                                                      11980099
119900                                                                  11990099
120000*----------------------------------------------------------------*12000099
120100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12010099
120200* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12020099
120300* CICS ARCHITECTURE API.                                         *12030099
120400*----------------------------------------------------------------*12040099
120500 2100-CHECK-FUNCTION-KEY.                                         12050099
120600                                                                  12060099
120700     EVALUATE TRUE                                                12070099
120800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12080099
120900             INITIALIZE RC015-INTER-APPL-COMMAREA                 12090099
121000             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    12100099
121100                            TO RC015-NUMBER-OF-SELECTED-ITEMS     12110099
121200             PERFORM 5000-PREPARE-SEL-QUEUE                       12120099
121300                                                                  12130099
121400         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              12140099
121500             MOVE 'U'             TO RCT00014-ACTN-CDE            12150099
121600             MOVE 'N'             TO RCT00014-PRCG-STAT-CDE       12160099
121700             PERFORM 2060-AUDIT-PROCESS                           12170099
121800             MOVE RC815-TRLR-NBR  TO  DK-VEH-NBR                  12180099
121900             MOVE RC815-SCAC-CDE  TO  DK-SCAC-ID                  12190099
122000             PERFORM 1150-SELECT-TKRPRPM                          12200099
122010             PERFORM 1160-SELECT-TKRPRPM                          12201099
122011             PERFORM 1170-SELECT-TKRPRPM                          12201199
122020             IF (ASC-VALID-LOCATION     AND                       12202099
122030                ASC-CHECKLIST-YES)      OR                        12203099
122040                ASC-VALID-LOCATION-NO                             12204099
122050                IF ASC-MESSAGE-DISPLAY                            12205099
122060                    PERFORM 2280-START-UNLOAD-MSG                 12206099
122070                END-IF                                            12207099
122080                PERFORM 2360-LINK-RCKUT129                        12208099
122090                PERFORM 8000-UPDATE-TRIP-SHIPMENT-STAT            12209099
122091                                                                  12209199
122092                                                                  12209299
122093                IF  ASC-RPA-MISDRCT-CK                            12209399
122094                    PERFORM 2370-RPA-MISDIRECT                    12209499
122095                END-IF                                            12209599
122096                                                                  12209699
122100                MOVE 'UN'            TO ASC-TRLR-STATUS           12210099
122200                MOVE PC-TSYMSG-00417 TO DP020-MSG-NUMBER          12220099
122300                IF ASC-MESSAGE-DISPLAY                            12230099
122400                    PERFORM 2290-END-UNLOAD-MSG                   12240099
122500                END-IF                                            12250099
122600                PERFORM 5000-PREPARE-SEL-QUEUE                    12260099
122700                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              12270099
122800             ELSE                                                 12280099
122900                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              12290099
123000                SET DP030-OVERRIDE-GO  TO TRUE                    12300099
123100                MOVE PC-TSYMSG-03246   TO DP020-MSG-NUMBER        12310099
123200                SET DP020-MSG-WARNING  TO TRUE                    12320099
123300             END-IF                                               12330099
123400                                                                  12340099
123500         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  12350099
123600             INITIALIZE RC015-INTER-APPL-COMMAREA                 12360099
123700             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    12370099
123800                            TO RC015-NUMBER-OF-SELECTED-ITEMS     12380099
123900             MOVE ASC-KEY-OPER-UNT-ID                             12390099
124000                                TO RC015-OPER-UNT-ID              12400099
124100             MOVE ASC-KEY-FCLTY-ID                                12410099
124200                                TO RC015-FCLTY-ID                 12420099
124300             PERFORM 5000-PREPARE-SEL-QUEUE                       12430099
124400                                                                  12440099
124500                                                                  12450099
124600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  12460099
124700             MOVE +1               TO PV-TOP-ITEM                 12470099
124800             PERFORM 3200-RESET-ATTRIBUTES                        12480099
124900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12490099
125000                                                                  12500099
125100         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12510099
125200             PERFORM 2110-BROWSE-BACKWARD                         12520099
125300             PERFORM 3200-RESET-ATTRIBUTES                        12530099
125400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12540099
125500                                                                  12550099
125600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12560099
125700             PERFORM 2120-BROWSE-FORWARD                          12570099
125800             PERFORM 3200-RESET-ATTRIBUTES                        12580099
125900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12590099
126000                                                                  12600099
126100         WHEN DP020-SRC-AID = DP016-ENTER                         12610099
126200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12620099
126300             IF  PS-ERROR                                         12630099
126400                 CONTINUE                                         12640099
126500             ELSE                                                 12650099
126600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12660099
126700             END-IF                                               12670099
126800                                                                  12680099
126900         WHEN OTHER                                               12690099
127000             SET DP013-NO-ROLLBACK                                12700099
127100                 DP013-XCTL-DISPLAY-RESTART                       12710099
127200                 DP013-CICS-ABEND  TO TRUE                        12720099
127300             MOVE '2100-CHECK-FUNCTION-KEY'                       12730099
127400                                   TO DP013-PARAGRAPH             12740099
127500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12750099
127600                                   TO DP013-MESSAGE-TEXT (1)      12760099
127700             PERFORM DP013-0000-PROCESS-ABEND                     12770099
127800     END-EVALUATE.                                                12780099
127900                                                                  12790099
128000/                                                                 12800099
128100*----------------------------------------------------------------*12810099
128200*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12820099
128300*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12830099
128400*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12840099
128500*    MESSAGE.                                                    *12850099
128600*----------------------------------------------------------------*12860099
128700                                                                  12870099
128800 2110-BROWSE-BACKWARD.                                            12880099
128900                                                                  12890099
129000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12900099
129100         GIVING PV-TOP-ITEM.                                      12910099
129200                                                                  12920099
129300     IF  ((PV-TOP-ITEM < +1)                                      12930099
129400       OR (PV-TOP-ITEM = +1))                                     12940099
129500         MOVE +1                   TO PV-TOP-ITEM                 12950099
129600*        -- TOP OF LIST --                                        12960099
129700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12970099
129800         SET DP020-MSG-INFORMATIONAL                              12980099
129900                                   TO TRUE                        12990099
130000     END-IF.                                                      13000099
130100                                                                  13010099
130200/                                                                 13020099
130300*----------------------------------------------------------------*13030099
130400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13040099
130500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13050099
130600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13060099
130700*----------------------------------------------------------------*13070099
130800                                                                  13080099
130900 2120-BROWSE-FORWARD.                                             13090099
131000                                                                  13100099
131100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13110099
131200         GIVING PV-TOP-ITEM.                                      13120099
131300                                                                  13130099
131400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13140099
131500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13150099
131600                                   TO PV-TOP-ITEM                 13160099
131700*        -- BOTTOM OF LIST --                                     13170099
131800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13180099
131900         SET DP020-MSG-INFORMATIONAL                              13190099
132000                                   TO TRUE                        13200099
132100     ELSE                                                         13210099
132200         COMPUTE PV-BOTTOM-ITEM =                                 13220099
132300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13230099
132400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13240099
132500*            -- BOTTOM OF LIST --                                 13250099
132600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13260099
132700             SET DP020-MSG-INFORMATIONAL                          13270099
132800                                   TO TRUE                        13280099
132900         END-IF                                                   13290099
133000     END-IF.                                                      13300099
133100                                                                  13310099
133200/                                                                 13320099
133300*----------------------------------------------------------------*13330099
133400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13340099
133500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13350099
133600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13360099
133700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13370099
133800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13380099
133900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13390099
134000*----------------------------------------------------------------*13400099
134100                                                                  13410099
134200 2130-CHECK-FOR-JUMP-BROWSE.                                      13420099
134300                                                                  13430099
134400     SET PS-NO-ERROR               TO TRUE.                       13440099
134500     IF (ASC-START-ITEM-REQUEST = SPACE)                          13450099
134600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13460099
134700                                   TO PV-TOP-ITEM                 13470099
134800     ELSE                                                         13480099
134900         MOVE ASC-START-ITEM-REQUEST                              13490099
135000                                   TO DP010I-UNEDITED-FIELD       13500099
135100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13510099
135200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13520099
135300         SET DP010I-NEGATIVE-NOT-ALLOWED                          13530099
135400                                   TO TRUE                        13540099
135500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13550099
135510              USING DP010I-NUMERIC-EDIT-AREA                      13551099
135600                                                                  13560099
135700         IF  NOT DP010I-ERROR-DETECTED                            13570099
135800             MOVE DP010I-NUMERIC-FIELD                            13580099
135900                                   TO ASC-START-ITEM-REQUEST-N    13590099
136000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13600099
136100                 IF  ASC-START-ITEM-REQUEST-N >                   13610099
136200                                          ASC-NUMBER-OF-ITEMS-READ13620099
136300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13630099
136400                     COMPUTE PV-TOP-ITEM =                        13640099
136500                             ASC-NUMBER-OF-ITEMS-READ             13650099
136600                             - PC-ITEMS-PER-PANEL + 1             13660099
136700                     IF  PV-TOP-ITEM < +1                         13670099
136800                         MOVE +1   TO PV-TOP-ITEM                 13680099
136900                         MOVE PC-TSYMSG-00070                     13690099
137000                                   TO DP020-MSG-NUMBER            13700099
137100                         SET DP020-MSG-INFORMATIONAL              13710099
137200                                   TO TRUE                        13720099
137300                     END-IF                                       13730099
137400                 ELSE                                             13740099
137500                     MOVE ASC-START-ITEM-REQUEST-N                13750099
137600                                   TO PV-TOP-ITEM                 13760099
137700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13770099
137800                     COMPUTE PV-BOTTOM-ITEM =                     13780099
137900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13790099
138000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13800099
138100*                        -- BOTTOM OF LIST --                     13810099
138200                         MOVE PC-TSYMSG-00070                     13820099
138300                                   TO DP020-MSG-NUMBER            13830099
138400                         SET DP020-MSG-INFORMATIONAL              13840099
138500                                   TO TRUE                        13850099
138600                     END-IF                                       13860099
138700                 END-IF                                           13870099
138800             ELSE                                                 13880099
138900*                --- VALUE OUT OF RANGE ----                      13890099
139000                 MOVE PC-TSYMSG-00101                             13900099
139100                                   TO DP020-MSG-NUMBER            13910099
139200                 MOVE -1           TO ASTRTITL                    13920099
139300                 SET DP030-SET-CURSOR-APPL-1                      13930099
139400                                   TO TRUE                        13940099
139500                 MOVE DP015-REVERSE                               13950099
139600                                   TO ASTRTITH                    13960099
139700                 MOVE DP015-RED    TO ASTRTITC                    13970099
139800                 MOVE DP015-UNP-NUM-BRT-MDT                       13980099
139900                                   TO ASTRTITA                    13990099
140000                 SET DP020-MSG-FATAL                              14000099
140100                                   TO TRUE                        14010099
140200                 SET PS-ERROR      TO TRUE                        14020099
140300             END-IF                                               14030099
140400                                                                  14040099
140500         ELSE                                                     14050099
140600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14060099
140700             MOVE -1               TO ASTRTITL                    14070099
140800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14080099
140900             MOVE DP015-REVERSE    TO ASTRTITH                    14090099
141000             MOVE DP015-RED        TO ASTRTITC                    14100099
141100             MOVE DP015-UNP-NUM-BRT-MDT                           14110099
141200                                   TO ASTRTITA                    14120099
141300             SET DP020-MSG-FATAL   TO TRUE                        14130099
141400             SET PS-ERROR          TO TRUE                        14140099
141500         END-IF                                                   14150099
141600     END-IF.                                                      14160099
141700                                                                  14170099
141800/                                                                 14180099
141900*----------------------------------------------------------------*14190099
142000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14200099
142100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14210099
142200*----------------------------------------------------------------*14220099
142300 2140-DESELECT-ALL-ITEMS.                                         14230099
142400                                                                  14240099
142500     MOVE +1                       TO ASC-BLK-SUB.                14250099
142600                                                                  14260099
142700     PERFORM 2141-CLEAR-SELECTED-INDS                             14270099
142800         VARYING ASC-ITEM-SUB                                     14280099
142900         FROM 1 BY 1                                              14290099
143000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14300099
143100                                                                  14310099
143200     ADD +1                        TO ASC-BLK-SUB.                14320099
143300                                                                  14330099
143400     PERFORM 2141-CLEAR-SELECTED-INDS                             14340099
143500         VARYING ASC-ITEM-SUB                                     14350099
143600         FROM 1 BY 1                                              14360099
143700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14370099
143800                                                                  14380099
143900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14390099
144000                                   TO PV-LIST-ITEM-NUMBER.        14400099
144100                                                                  14410099
144200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14420099
144300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14430099
144400                                                                  14440099
144500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14450099
144600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14460099
144700         MOVE +1                   TO ASC-BLK-SUB                 14470099
144800                                                                  14480099
144900         PERFORM 5100-WRITE-TEMP-STORAGE                          14490099
145000                                                                  14500099
145100         MOVE +1                   TO PV-BLOCK-NUMBER             14510099
145200                                                                  14520099
145300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14530099
145400             PV-FIRST-BLOCK-IN-ARRAY - 1                          14540099
145500                                                                  14550099
145600         PERFORM                                                  14560099
145700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14570099
145800                                                                  14580099
145900             PERFORM 4410-READ-TEMP-STORAGE                       14590099
146000                                                                  14600099
146100             PERFORM 2141-CLEAR-SELECTED-INDS                     14610099
146200                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14620099
146300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14630099
146400                                                                  14640099
146500             PERFORM 5100-WRITE-TEMP-STORAGE                      14650099
146600                                                                  14660099
146700             ADD +1                TO PV-BLOCK-NUMBER             14670099
146800                                                                  14680099
146900         END-PERFORM                                              14690099
147000                                                                  14700099
147100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14710099
147200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14720099
147300                                                                  14730099
147400         PERFORM                                                  14740099
147500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14750099
147600                   ASC-HIGHEST-BLOCK-WRITTEN                      14760099
147700                                                                  14770099
147800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14780099
147900                                   TO PV-BLOCK-NUMBER             14790099
148000                                                                  14800099
148100             PERFORM 4410-READ-TEMP-STORAGE                       14810099
148200                                                                  14820099
148300             PERFORM 2141-CLEAR-SELECTED-INDS                     14830099
148400                 VARYING ASC-ITEM-SUB                             14840099
148500                 FROM 1 BY 1                                      14850099
148600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14860099
148700                                                                  14870099
148800             PERFORM 5100-WRITE-TEMP-STORAGE                      14880099
148900                                                                  14890099
149000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14900099
149100                                                                  14910099
149200         END-PERFORM                                              14920099
149300                                                                  14930099
149400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14940099
149500                                   TO PV-BLOCK-NUMBER             14950099
149600                                                                  14960099
149700         PERFORM 4410-READ-TEMP-STORAGE                           14970099
149800     END-IF.                                                      14980099
149900                                                                  14990099
150000                                                                  15000099
150100     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.15010099
150200     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 15020099
150300     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   15030099
150400                                                                  15040099
150500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15050099
150600                                                                  15060099
150700/                                                                 15070099
150800*----------------------------------------------------------------*15080099
150900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15090099
151000*----------------------------------------------------------------*15100099
151100                                                                  15110099
151200 2141-CLEAR-SELECTED-INDS.                                        15120099
151300                                                                  15130099
151400     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          15140099
151500             NOT EQUAL ZERO                                       15150099
151600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15160099
151700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15170099
151800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15180099
151900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15190099
152000                                   TO TRUE                        15200099
152100         END-IF                                                   15210099
152200     END-IF.                                                      15220099
152300                                                                  15230099
152400/                                                                 15240099
152500*----------------------------------------------------------------*15250099
152600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15260099
152700*  FOR ALL ITEMS.                                                *15270099
152800*----------------------------------------------------------------*15280099
152900                                                                  15290099
153000 2150-SELECT-ALL-ITEMS.                                           15300099
153100                                                                  15310099
153200     MOVE +1                       TO ASC-BLK-SUB.                15320099
153300                                                                  15330099
153400     PERFORM 2151-SET-SELECTED-INDS                               15340099
153500         VARYING ASC-ITEM-SUB                                     15350099
153600         FROM 1 BY 1                                              15360099
153700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15370099
153800                                                                  15380099
153900     ADD +1                        TO ASC-BLK-SUB.                15390099
154000                                                                  15400099
154100     PERFORM 2151-SET-SELECTED-INDS                               15410099
154200         VARYING ASC-ITEM-SUB                                     15420099
154300         FROM 1 BY 1                                              15430099
154400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15440099
154500                                                                  15450099
154600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15460099
154700                                   TO PV-LIST-ITEM-NUMBER.        15470099
154800                                                                  15480099
154900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15490099
155000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15500099
155100                                                                  15510099
155200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15520099
155300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15530099
155400         MOVE +1                   TO ASC-BLK-SUB                 15540099
155500                                                                  15550099
155600         PERFORM 5100-WRITE-TEMP-STORAGE                          15560099
155700                                                                  15570099
155800         MOVE +1                   TO PV-BLOCK-NUMBER             15580099
155900                                                                  15590099
156000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15600099
156100             PV-FIRST-BLOCK-IN-ARRAY - 1                          15610099
156200                                                                  15620099
156300         PERFORM                                                  15630099
156400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15640099
156500                                                                  15650099
156600             PERFORM 4410-READ-TEMP-STORAGE                       15660099
156700                                                                  15670099
156800             PERFORM 2151-SET-SELECTED-INDS                       15680099
156900                 VARYING ASC-ITEM-SUB                             15690099
157000                 FROM 1 BY 1                                      15700099
157100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15710099
157200                                                                  15720099
157300             PERFORM 5100-WRITE-TEMP-STORAGE                      15730099
157400                                                                  15740099
157500             ADD +1                TO PV-BLOCK-NUMBER             15750099
157600         END-PERFORM                                              15760099
157700                                                                  15770099
157800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15780099
157900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15790099
158000                                                                  15800099
158100         PERFORM                                                  15810099
158200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15820099
158300                   ASC-HIGHEST-BLOCK-WRITTEN                      15830099
158400                                                                  15840099
158500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15850099
158600                                   TO PV-BLOCK-NUMBER             15860099
158700                                                                  15870099
158800             PERFORM 4410-READ-TEMP-STORAGE                       15880099
158900                                                                  15890099
159000             PERFORM 2151-SET-SELECTED-INDS                       15900099
159100                 VARYING ASC-ITEM-SUB                             15910099
159200                 FROM 1 BY 1                                      15920099
159300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15930099
159400                                                                  15940099
159500             PERFORM 5100-WRITE-TEMP-STORAGE                      15950099
159600                                                                  15960099
159700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15970099
159800         END-PERFORM                                              15980099
159900                                                                  15990099
160000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16000099
160100                                   TO PV-BLOCK-NUMBER             16010099
160200                                                                  16020099
160300         PERFORM 4410-READ-TEMP-STORAGE                           16030099
160400     END-IF.                                                      16040099
160500                                                                  16050099
160600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16060099
160700          ASC-NUMBER-OF-SELECTED-ITEMS.                           16070099
160800                                                                  16080099
160900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16090099
161000                                                                  16100099
161100/                                                                 16110099
161200*----------------------------------------------------------------*16120099
161300*    MARK EACH ITEM AS BEING SELECTED.                           *16130099
161400*----------------------------------------------------------------*16140099
161500                                                                  16150099
161600 2151-SET-SELECTED-INDS.                                          16160099
161700                                                                  16170099
161800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16180099
161900             NOT EQUAL ZERO                                       16190099
162000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16200099
162100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16210099
162200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16220099
162300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16230099
162400                                   TO TRUE                        16240099
162500         END-IF                                                   16250099
162600     END-IF.                                                      16260099
162700                                                                  16270099
162800/                                                                 16280099
162900*----------------------------------------------------------------*16290099
163000*    GET THE RECEIVER NUMBER (KEY) OF THE NEXT SELECTED OBJECT   *16300099
163100*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *16310099
163200*----------------------------------------------------------------*16320099
163300 2160-GET-NEXT-RECORD.                                            16330099
163400                                                                  16340099
163500     ADD +1                        TO ASC-SEL-SUB.                16350099
163600     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            16360099
163700         ADD +1                    TO ASC-SEL-ITEM                16370099
163800         MOVE +1                   TO ASC-SEL-SUB                 16380099
163900     END-IF.                                                      16390099
164000                                                                  16400099
164100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                16410099
164200         PERFORM 9100-READ-SEL-QUEUE                              16420099
164300         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      16430099
164400             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 16440099
164500                                   TO ASC-KEY-OPER-UNT-ID         16450099
164600             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    16460099
164700                                   TO ASC-KEY-FCLTY-ID            16470099
164800             SET RC013-INQ (ASC-SEL-SUB)                          16480099
164900                                   TO TRUE                        16490099
165000             PERFORM 9200-REWRITE-LIST-QUEUE                      16500099
165100         ELSE                                                     16510099
165200             SUBTRACT +1 FROM ASC-SEL-SUB                         16520099
165300*            --- BOTTOM OF LIST ---                               16530099
165400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16540099
165500             SET DP020-MSG-INFORMATIONAL                          16550099
165600                                   TO TRUE                        16560099
165700         END-IF                                                   16570099
165800     ELSE                                                         16580099
165900         SUBTRACT +1 FROM ASC-SEL-ITEM                            16590099
166000         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16600099
166100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16610099
166200         SET DP020-MSG-INFORMATIONAL                              16620099
166300                                   TO TRUE                        16630099
166400     END-IF.                                                      16640099
166500                                                                  16650099
166600                                                                  16660099
166700/                                                                 16670099
166800*----------------------------------------------------------------*16680099
166900*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *16690099
167000*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *16700099
167100*----------------------------------------------------------------*16710099
167200 2200-MOVE-SCREEN-TO-COMMAREA.                                    16720099
167300                                                                  16730099
167400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16740099
167500     MOVE +1                       TO PV-SUB.                     16750099
167600                                                                  16760099
167700     PERFORM 3100-SET-SUBSCRIPTS.                                 16770099
167800                                                                  16780099
167900     IF  ASTRTITL > ZERO                                          16790099
168000         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      16800099
168100     ELSE                                                         16810099
168200         IF  ASTRTITF = DP015-ERASE-EOF                           16820099
168300             INITIALIZE ASC-START-ITEM-REQUEST                    16830099
168400         END-IF                                                   16840099
168500     END-IF.                                                      16850099
168600                                                                  16860099
168700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16870099
168800         VARYING PV-SUB                                           16880099
168900         FROM 1 BY 1                                              16890099
169000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16900099
169100                                                                  16910099
169200/                                                                 16920099
169300*----------------------------------------------------------------*16930099
169400*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *16940099
169500*----------------------------------------------------------------*16950099
169600 2210-MOVE-LINES-TO-COMMAREA.                                     16960099
169700                                                                  16970099
169800     IF  MR-SELECTL (PV-SUB) > ZERO                               16980099
169900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16990099
170000                                   TO TRUE                        17000099
170100         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        17010099
170200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17020099
170300     ELSE                                                         17030099
170400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17040099
170500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         17050099
170600             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        17060099
170700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17070099
170800         END-IF                                                   17080099
170900     END-IF.                                                      17090099
171000                                                                  17100099
171100     ADD +1                        TO ASC-ITEM-SUB.               17110099
171200                                                                  17120099
171300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17130099
171400         ADD +1                    TO ASC-BLK-SUB                 17140099
171500         MOVE +1                   TO ASC-ITEM-SUB                17150099
171600     END-IF.                                                      17160099
171700                                                                  17170099
171800/                                                                 17180099
171900*----------------------------------------------------------------*17190099
172000*    DISPLAY START UNLOAD MESSAGE IN CSSL.                        17200099
172001*----------------------------------------------------------------*17200199
172002 2280-START-UNLOAD-MSG.                                           17200299
172003                                                                  17200399
172004     MOVE ASC-TRIP-ID     TO PV-TRIP-ID-X.                        17200499
172005                                                                  17200599
172006     EXEC SQL                                                     17200699
172007         SET :PV-START-UNLOAD-TMST = CURRENT TIMESTAMP            17200799
172008     END-EXEC                                                     17200899
172009                                                                  17200999
172010     EVALUATE TRUE                                                17201099
172020       WHEN SQLCODE EQUAL +0                                      17202099
172030           CONTINUE                                               17203099
172031       WHEN OTHER                                                 17203199
172032            SET PS-ERROR      TO TRUE                             17203299
172033     END-EVALUATE.                                                17203399
172034                                                                  17203499
172035                                                                  17203599
172036     INITIALIZE PV-CICS-MSG-AREA                                  17203699
172037     STRING ' RCKCS827 - START UNLOAD-'                           17203799
172038        ' TRIP =' PV-TRIP-ID-X                                    17203899
172039        ' TMST =' PV-START-UNLOAD-TMST                            17203999
172040                                 DELIMITED BY SIZE                17204099
172050                            INTO PV-CICS-MSG-AREA                 17205099
172060     PERFORM 9900-WRITE-CICS-LOG.                                 17206099
172070                                                                  17207099
172080*----------------------------------------------------------------*17208099
172090*    DISPLAY END UNLOAD MESSAGE IN CSSL.                          17209099
172091*----------------------------------------------------------------*17209199
172092 2290-END-UNLOAD-MSG.                                             17209299
172093                                                                  17209399
172094     MOVE ASC-TRIP-ID     TO PV-TRIP-ID-X.                        17209499
172095                                                                  17209599
172096     EXEC SQL                                                     17209699
172097         SET :PV-END-UNLOAD-TMST =  CURRENT TIMESTAMP             17209799
172098     END-EXEC                                                     17209899
172099                                                                  17209999
172100     EVALUATE TRUE                                                17210099
172101       WHEN SQLCODE EQUAL +0                                      17210199
172102           CONTINUE                                               17210299
172103       WHEN OTHER                                                 17210399
172104            SET PS-ERROR      TO TRUE                             17210499
172105     END-EVALUATE.                                                17210599
172106                                                                  17210699
172107     INITIALIZE PV-CICS-MSG-AREA                                  17210799
172108     STRING ' RCKCS827 - END UNLOAD-'                             17210899
172109        ' TRIP =' PV-TRIP-ID-X                                    17210999
172110        ' TMST =' PV-END-UNLOAD-TMST                              17211099
172111                                 DELIMITED BY SIZE                17211199
172112                            INTO PV-CICS-MSG-AREA                 17211299
172113     PERFORM 9900-WRITE-CICS-LOG.                                 17211399
172114/                                                                 17211499
172115*----------------------------------------------------------------*17211599
172116*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          17211699
172117*----------------------------------------------------------------*17211799
172118 2300-CALL-AUTOVE-MODULE.                                         17211899
172119                                                                  17211999
172120     INITIALIZE RC040-FIELDS.                                     17212099
172130     IF PS-DC-LEVEL-YES                                           17213099
172140        SET RC040-DC-LEVEL     TO TRUE                            17214099
172150     END-IF                                                       17215099
172160     MOVE DP020-LOCATION-NBR   TO RC040-SIGNON-LOCATION.          17216099
172170     MOVE DK-PO-NBR            TO RC040-PO-NBR                    17217099
172180     MOVE DK-REC-SEQ-NBR       TO RC040-PO-RCVR                   17218099
172190     MOVE DP020-USERID         TO RC040-USER-ID.                  17219099
172200     MOVE 'RCKCS827'           TO RC040-CALLING-PROGRAM.          17220099
172300                                                                  17230099
172400     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  17240099
172500                                        RC040-COMMAREA            17250099
172600                                        RC040-FIELDS.             17260099
172700                                                                  17270099
172800     EVALUATE TRUE                                                17280099
172900         WHEN RC040-SUCCESSFUL                                    17290099
173000              CONTINUE                                            17300099
173100         WHEN RC040-DATABASE-BUSY OR                              17310099
173200              RC040-INVALID-SQL                                   17320099
173300                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       17330099
173400                  SET DP020-MSG-WARNING TO TRUE                   17340099
173500                  SET DP030-OVERRIDE-GO TO TRUE                   17350099
173600                  SET PS-ERROR          TO TRUE                   17360099
173700         WHEN RC040-NOT-SUCCESSFUL                                17370099
173800                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       17380099
173900                  SET DP020-MSG-WARNING TO TRUE                   17390099
174000                  SET DP030-OVERRIDE-GO TO TRUE                   17400099
174100                  SET PS-ERROR          TO TRUE                   17410099
174200         WHEN OTHER                                               17420099
174300             MOVE '2300-CALL-AUTOVE-MODULE' TO DP013-PARAGRAPH    17430099
174400             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              17440099
174500                                         TO DP013-MESSAGE-TEXT (1)17450099
174600             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)17460099
174700             MOVE RC040-SQLCA            TO DP013-SQLCA           17470099
174800             SET DP013-DB2-ABEND                                  17480099
174900                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              17490099
175000             SET PS-ERROR                    TO TRUE              17500099
175100             PERFORM DP013-0000-PROCESS-ABEND                     17510099
175200                                                                  17520099
175300     END-EVALUATE.                                                17530099
175400/                                                                 17540099
175500*----------------------------------------------------------------*17550099
175600*    CALL TO RCKUT128                                             17560099
175700*----------------------------------------------------------------*17570099
175800 2350-CALL-RCKUT128.                                              17580099
175900     INITIALIZE RC074-FIELDS.                                     17590099
176000     MOVE DP020-LOCATION-NBR  TO RC074-OPER-UNT-ID.               17600099
176100     MOVE ASC-KEY-FCLTY-ID    TO RC074-FCLTY-ID.                  17610099
176200     MOVE DK-PO-NBR           TO RC074-PO-NBR.                    17620099
176300     MOVE DK-REC-SEQ-NBR      TO RC074-RCVR-SEQ-NBR.              17630099
176400     IF DK-PKGNG-CDE    = 'I' OR 'M'                              17640099
176500         SET RC074-PACK-QTY-YES   TO TRUE                         17650099
176600     ELSE                                                         17660099
176700         SET RC074-UNIT-QTY-YES   TO TRUE                         17670099
176800     END-IF.                                                      17680099
176900                                                                  17690099
177000     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 17700099
177100                                         RC074-COMMAREA           17710099
177200                                         RC074-FIELDS.            17720099
177300                                                                  17730099
177400     EVALUATE TRUE                                                17740099
177500         WHEN RC074-SUCCESSFUL                                    17750099
177600             CONTINUE                                             17760099
177700         WHEN OTHER                                               17770099
177800             MOVE '2350-CALL-RCKUT128'                            17780099
177900                                 TO DP013-PARAGRAPH               17790099
178000             STRING                                               17800099
178100                  'UNSUCCESSFUL CALL TO RCKUT128 '                17810099
178200                  'SUCCESS-IND = '                                17820099
178300                  RC074-SUCCESS-IND                               17830099
178400                               DELIMITED BY SIZE                  17840099
178500                               INTO DP013-MESSAGE-TEXT (1)        17850099
178600             MOVE RC074-CRA-RET-MSG                               17860099
178700                                 TO DP013-MESSAGE-TEXT (2)        17870099
178800             MOVE RC074-SQLCA    TO DP013-SQLCA                   17880099
178900             SET DP013-DB2-ABEND                                  17890099
179000                 DP013-XCTL-DISPLAY-RESTART                       17900099
179100                                 TO TRUE                          17910099
179200             PERFORM DP013-0000-PROCESS-ABEND                     17920099
179300     END-EVALUATE.                                                17930099
179400                                                                  17940099
179500/                                                                 17950099
179600*----------------------------------------------------------------*17960099
179700*    LINK TO RCKUT129                                             17970099
179800*----------------------------------------------------------------*17980099
179900 2360-LINK-RCKUT129.                                              17990099
180000                                                                  18000099
180100     INITIALIZE RC041-FIELDS.                                     18010099
180200     MOVE LENGTH OF RC041-FIELDS    TO PV-COMMAREA-LENGTH.        18020099
180300                                                                  18030099
180400     MOVE DP020-LOCATION-NBR  TO RC041-OPER-UNT-ID.               18040099
180500     MOVE ASC-KEY-FCLTY-ID    TO RC041-FCLTY-ID.                  18050099
180600*    MOVE DK-PO-NBR           TO RC041-PO-NBR.                    18060099
180700*    MOVE DK-REC-SEQ-NBR      TO RC041-REC-SEQ-NBR.               18070099
180800     MOVE ASC-TRIP-ID         TO RC041-TRIP-ID.                   18080099
180900     MOVE DP020-USERID        TO RC041-USER-ID.                   18090099
181000     MOVE 'RCKCS827'          TO RC041-PROGRAM-NAME.              18100099
181100                                                                  18110099
181200                                                                  18120099
181300     EXEC CICS                                                    18130099
181400         LINK PROGRAM  (PC-UNLOADED-MODULE)                       18140099
181500              COMMAREA (RC041-FIELDS)                             18150099
181600              LENGTH   (PV-COMMAREA-LENGTH)                       18160099
181700              RESP     (PV-CICS-RESPONSE)                         18170099
181800     END-EXEC.                                                    18180099
181900                                                                  18190099
182000                                                                  18200099
182100     EVALUATE TRUE                                                18210099
182200         WHEN RC041-SUCCESSFUL                                    18220099
182300             CONTINUE                                             18230099
182400         WHEN OTHER                                               18240099
182500             MOVE '2360-LINK-RCKUT129'                            18250099
182600                                 TO DP013-PARAGRAPH               18260099
182700             STRING                                               18270099
182800                  'UNSUCCESSFUL CALL TO RCKUT129 '                18280099
182900                  'SUCCESS-IND = '                                18290099
183000                  RC041-SUCCESS-IND                               18300099
183100                               DELIMITED BY SIZE                  18310099
183200                               INTO DP013-MESSAGE-TEXT (1)        18320099
183300             MOVE RC041-CRA-RET-MSG                               18330099
183400                                 TO DP013-MESSAGE-TEXT (2)        18340099
183500             MOVE RC041-SQLCA    TO DP013-SQLCA                   18350099
183600             SET DP013-DB2-ABEND                                  18360099
183700                 DP013-XCTL-DISPLAY-RESTART                       18370099
183800                                 TO TRUE                          18380099
183900             PERFORM DP013-0000-PROCESS-ABEND                     18390099
184000     END-EVALUATE.                                                18400099
184100                                                                  18410099
184101                                                                  18410199
184110*----------------------------------------------------------------*18411099
184120*  RPA MISDIRECT - START E838 (RCKCS838) TO CAPTURE MISDIRECT     18412099
184121*  RECEIVER INFORMATION                                           18412199
184130*----------------------------------------------------------------*18413099
184140 2370-RPA-MISDIRECT.                                              18414099
184150                                                                  18415099
184160     INITIALIZE RC077-UNLOADED-TRLR-COMMAREA.                     18416099
184180                                                                  18418099
184190     MOVE DP020-LOCATION-NBR  TO RC077-OPER-UNT-ID                18419099
184191     MOVE ASC-SCAC-ID         TO RC077-SCAC                       18419199
184192     MOVE ASC-VEH-NBR         TO RC077-VEH-NBR                    18419299
184193     MOVE ASC-TRIP-ID         TO RC077-TRIP-ID                    18419399
184194     MOVE 'RCKCS827'          TO RC077-FROM-PROGRAM               18419499
184197                                                                  18419799
184198                                                                  18419899
184199     EXEC CICS                                                    18419999
184200         START TRANSID(PC-E838-RPAMSD)                            18420099
184201               FROM   (RC077-UNLOADED-TRLR-COMMAREA)              18420199
184202     END-EXEC.                                                    18420299
184205                                                                  18420599
184230                                                                  18423099
184300*----------------------------------------------------------------*18430099
184400* AT THE END OF CURSOR CHECK SWITCHES AND BUILD MESSAGE LIST.     18440099
184500*----------------------------------------------------------------*18450099
184600 2400-PROCESS-MESSAGE-LIST.                                       18460099
184700                                                                  18470099
184800     MOVE 0               TO RCT00016-MSG-QTY.                    18480099
184900                                                                  18490099
185000     EVALUATE TRUE                                                18500099
185100         WHEN PS-VERIFY-AT-ZERO                                   18510099
185200             MOVE '0001'                TO DK-RCVR-UNLD-MSG-ID    18520099
185300             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   18530099
185400             MOVE ASC-VERIFY-ZERO-COUNT TO PC-VERIFY-ZERO-COUNT   18540099
185500                                           RCT00016-MSG-QTY       18550099
185600             INITIALIZE ASC-VERIFY-ZERO-COUNT                     18560099
185700             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                18570099
185800             MOVE PC-VERIFY-AT-ZERO     TO  ASC-MESSAGE           18580099
185900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18590099
186000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18600099
186100             MOVE ASC-NUMBER-OF-ITEMS-READ                        18610099
186200                                   TO ASC-LIST-ITEM-NUMBER        18620099
186300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18630099
186400             SET PS-VERIFY-AT-ZERO-NO   TO TRUE                   18640099
186500             CONTINUE                                             18650099
186600                                                                  18660099
186700         WHEN PS-UNUSED-LABELS                                    18670099
186800             MOVE '0002'                TO DK-RCVR-UNLD-MSG-ID    18680099
186900             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   18690099
187000             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                18700099
187100             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     18710099
187200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18720099
187300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18730099
187400             MOVE ASC-NUMBER-OF-ITEMS-READ                        18740099
187500                                   TO ASC-LIST-ITEM-NUMBER        18750099
187600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18760099
187700             SET PS-UNUSED-LABELS-NO  TO TRUE                     18770099
187800             CONTINUE                                             18780099
187900                                                                  18790099
188000         WHEN PS-SMOOTHING                                        18800099
188100             MOVE '0003'                TO DK-RCVR-UNLD-MSG-ID    18810099
188200             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   18820099
188300             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                18830099
188400             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     18840099
188500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18850099
188600             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18860099
188700             MOVE ASC-NUMBER-OF-ITEMS-READ                        18870099
188800                                   TO ASC-LIST-ITEM-NUMBER        18880099
188900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18890099
189000             SET PS-SMOOTHING-NO        TO TRUE                   18900099
189100             CONTINUE                                             18910099
189200                                                                  18920099
189300         WHEN PS-PBS-ERRORS                                       18930099
189400             MOVE '0004'                TO DK-RCVR-UNLD-MSG-ID    18940099
189500             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   18950099
189600             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                18960099
189700             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     18970099
189800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18980099
189900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18990099
190000             MOVE ASC-NUMBER-OF-ITEMS-READ                        19000099
190100                                   TO ASC-LIST-ITEM-NUMBER        19010099
190200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19020099
190300             SET PS-PBS-ERRORS-NO       TO TRUE                   19030099
190400             CONTINUE                                             19040099
190500                                                                  19050099
190600         WHEN PS-STOP-VERIFICATION                                19060099
190700             MOVE '0005'                TO DK-RCVR-UNLD-MSG-ID    19070099
190800             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19080099
190900             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19090099
191000             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     19100099
191100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19110099
191200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19120099
191300             MOVE ASC-NUMBER-OF-ITEMS-READ                        19130099
191400                                   TO ASC-LIST-ITEM-NUMBER        19140099
191500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19150099
191600             SET PS-STOP-VERIFICATION-NO   TO TRUE                19160099
191700             CONTINUE                                             19170099
191800                                                                  19180099
191900         WHEN PS-FREE-ASTRAY                                      19190099
192000             MOVE '0006'                TO DK-RCVR-UNLD-MSG-ID    19200099
192100             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19210099
192200             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19220099
192300             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     19230099
192400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19240099
192500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19250099
192600             MOVE ASC-NUMBER-OF-ITEMS-READ                        19260099
192700                                   TO ASC-LIST-ITEM-NUMBER        19270099
192800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19280099
192900             SET PS-FREE-ASTRAY-NO      TO TRUE                   19290099
193000             CONTINUE                                             19300099
193100                                                                  19310099
193200         WHEN PS-MANUAL-VE                                        19320099
193300             MOVE '0007'                TO DK-RCVR-UNLD-MSG-ID    19330099
193400             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19340099
193500             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19350099
193600             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     19360099
193700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19370099
193800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19380099
193900             MOVE ASC-NUMBER-OF-ITEMS-READ                        19390099
194000                                   TO ASC-LIST-ITEM-NUMBER        19400099
194100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19410099
194200             SET PS-AUTO-VE             TO TRUE                   19420099
194300             CONTINUE                                             19430099
194400                                                                  19440099
194500         WHEN PS-UPDATE-CARTON-COUNT                              19450099
194600             MOVE '0008'                TO DK-RCVR-UNLD-MSG-ID    19460099
194700             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19470099
194800             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19480099
194900             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     19490099
195000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19500099
195100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19510099
195200             MOVE ASC-NUMBER-OF-ITEMS-READ                        19520099
195300                                   TO ASC-LIST-ITEM-NUMBER        19530099
195400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19540099
195500             SET PS-UPDATE-CARTON-COUNT-NO TO TRUE                19550099
195600             CONTINUE                                             19560099
195700                                                                  19570099
195800         WHEN PS-UPDATE-OPER-SET                                  19580099
195900             MOVE '0009'                TO DK-RCVR-UNLD-MSG-ID    19590099
196000             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19600099
196100             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19610099
196200             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     19620099
196300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19630099
196400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19640099
196500             MOVE ASC-NUMBER-OF-ITEMS-READ                        19650099
196600                                   TO ASC-LIST-ITEM-NUMBER        19660099
196700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19670099
196800             SET PS-UPDATE-OPER-SET-NO  TO TRUE                   19680099
196900             CONTINUE                                             19690099
197000                                                                  19700099
197100         WHEN PS-TROUBLE                                          19710099
197200*            MOVE '0010'                TO DK-RCVR-UNLD-MSG-ID    19720099
197300*            PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19730099
197400             MOVE ASC-REC-TROUBLE-COUNT TO PC-TROUBLE-COUNT       19740099
197500                                           RCT00016-MSG-QTY       19750099
197600             INITIALIZE ASC-REC-TROUBLE-COUNT                     19760099
197700             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19770099
197800             MOVE PC-RCVRS-IN-TROUBLE   TO  ASC-MESSAGE           19780099
197900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19790099
198000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19800099
198100             MOVE ASC-NUMBER-OF-ITEMS-READ                        19810099
198200                                   TO ASC-LIST-ITEM-NUMBER        19820099
198300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19830099
198400             SET PS-TROUBLE-NO          TO TRUE                   19840099
198500             CONTINUE                                             19850099
198600                                                                  19860099
198700         WHEN PS-NO-PRO-YES                                       19870099
198800             MOVE '0011'                TO DK-RCVR-UNLD-MSG-ID    19880099
198900             PERFORM 2410-GET-RCT-TRLR-UNLD-MSG                   19890099
199000             PERFORM 2420-INSERT-RCT-RCVR-TRLR-LST                19900099
199100             MOVE RCT00015-RCVR-UNLD-MSG-DESC  TO ASC-MESSAGE     19910099
199200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19920099
199300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    19930099
199400             MOVE ASC-NUMBER-OF-ITEMS-READ                        19940099
199500                                   TO ASC-LIST-ITEM-NUMBER        19950099
199600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19960099
199700             SET PS-NO-PRO-NO           TO TRUE                   19970099
199800                                                                  19980099
199900         WHEN OTHER                                               19990099
200000             SET ASC-NO-ITEMS-LEFT-ON-DB   TO TRUE                20000099
200100                                                                  20010099
200200     END-EVALUATE.                                                20020099
200300                                                                  20030099
200400/                                                                 20040099
200500*----------------------------------------------------------------*20050099
200600* SELECT MESSAGE FROM RCT_TRLR_UNLD_MSG (RCT00015).               20060099
200700*----------------------------------------------------------------*20070099
200800 2410-GET-RCT-TRLR-UNLD-MSG.                                      20080099
200900                                                                  20090099
201000     EXEC SQL                                                     20100099
201100          SELECT RCVR_UNLD_MSG_ID                                 20110099
201200                ,RCVR_UNLD_MSG_DESC                               20120099
201300            INTO :RCT00015-RCVR-UNLD-MSG-ID                       20130099
201400                ,:RCT00015-RCVR-UNLD-MSG-DESC                     20140099
201500            FROM RCT_TRLR_UNLD_MSG                                20150099
201600           WHERE RCVR_UNLD_MSG_ID  = :DK-RCVR-UNLD-MSG-ID         20160099
201700     END-EXEC.                                                    20170099
201800                                                                  20180099
201900     EVALUATE TRUE                                                20190099
202000         WHEN SQLCODE = ZERO                                      20200099
202100         WHEN SQLCODE = +100                                      20210099
202200              CONTINUE                                            20220099
202300         WHEN SQLWARN0 NOT = SPACE                                20230099
202400         WHEN SQLCODE < ZERO                                      20240099
202500         WHEN SQLCODE > ZERO                                      20250099
202600             MOVE '2410-GET-RCT00015'                             20260099
202700                             TO DP013-PARAGRAPH                   20270099
202800             MOVE 'SELECT MESSAGE '                               20280099
202900                             TO DP013-MESSAGE-TEXT (1)            20290099
203000             MOVE SQLCA      TO DP013-SQLCA                       20300099
203100             MOVE 'RCT_TRLR_UNLD_MSG' TO DP013-DB2-TABLE-NAME (1) 20310099
203200             SET DP013-DB2-ABEND                                  20320099
203300                             TO TRUE                              20330099
203400             SET DP013-XCTL-DISPLAY-RESTART                       20340099
203500                             TO TRUE                              20350099
203600             PERFORM DP013-0000-PROCESS-ABEND                     20360099
203700     END-EVALUATE.                                                20370099
203800                                                                  20380099
203900/                                                                 20390099
204000*----------------------------------------------------------------*20400099
204100*  INSERT A HISTORY OF TRAILER ISSUES THAT ARE DISPLAYED ON SCREEN20410099
204200*  INTO TABLE RCT RCVR TRLR LST (RCT00016)                        20420099
204300*----------------------------------------------------------------*20430099
204400 2420-INSERT-RCT-RCVR-TRLR-LST.                                   20440099
204500                                                                  20450099
204600     MOVE RCT00014-CRE-TMST         TO RCT00016-CRE-TMST.         20460099
204700     MOVE RCT00014-CRE-BY-USR-ID    TO RCT00016-CRE-BY-USR-ID.    20470099
204800     MOVE RCT00015-RCVR-UNLD-MSG-ID TO RCT00016-RCVR-UNLD-MSG-ID. 20480099
204900                                                                  20490099
205000     PERFORM                                                      20500099
205100         WITH TEST AFTER                                          20510099
205200         VARYING PV-RETRY-COUNTER                                 20520099
205300         FROM 1 BY 1                                              20530099
205400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20540099
205500             OR (SQLCODE = +0)                                    20550099
205600             OR (SQLCODE = -803))                                 20560099
205700                                                                  20570099
205800         EXEC SQL                                                 20580099
205900             INSERT  INTO RCT_RCVR_TRLR_LST                       20590099
206000                    (CRE_TMST                                     20600099
206100                    ,CRE_BY_USR_ID                                20610099
206200                    ,RCVR_UNLD_MSG_ID                             20620099
206300                    ,MSG_QTY)                                     20630099
206400            VALUES  (:RCT00016-CRE-TMST                           20640099
206500                    ,:RCT00016-CRE-BY-USR-ID                      20650099
206600                    ,:RCT00016-RCVR-UNLD-MSG-ID                   20660099
206700                    ,:RCT00016-MSG-QTY)                           20670099
206800         END-EXEC                                                 20680099
206900                                                                  20690099
207000         EVALUATE TRUE                                            20700099
207100             WHEN SQLCODE = +0                                    20710099
207200                 CONTINUE                                         20720099
207300                                                                  20730099
207400             WHEN SQLCODE = -803                                  20740099
207500                 SET PS-ERROR                                     20750099
207600                     DP020-MSG-INFORMATIONAL                      20760099
207700                                        TO TRUE                   20770099
207800*                MOVE PC-TSYMSG-00417   TO DP020-MSG-NUMBER       20780099
207900                 SET DP030-SET-CURSOR-TRAILER                     20790099
208000                                        TO TRUE                   20800099
208100                                                                  20810099
208200             WHEN SQLCODE = -904                                  20820099
208300             WHEN SQLCODE = -913                                  20830099
208400                 CONTINUE                                         20840099
208500                                                                  20850099
208600             WHEN SQLWARN0 NOT = SPACES                           20860099
208700             WHEN SQLCODE < +0                                    20870099
208800             WHEN SQLCODE > +0                                    20880099
208900                 MOVE '2420-INSERT-RCT-RCVR-TRLR-LST'             20890099
209000                                   TO DP013-PARAGRAPH             20900099
209100                 MOVE 'INSERT A ROW ON RCT00016'                  20910099
209200                                   TO DP013-MESSAGE-TEXT(1)       20920099
209300                 MOVE SQLCA        TO DP013-SQLCA                 20930099
209400                 MOVE 'RCT_RCVR_TRLR_LST'                         20940099
209500                                  TO DP013-DB2-TABLE-NAME (1)     20950099
209600                 SET DP013-DB2-ABEND                              20960099
209700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20970099
209800                 PERFORM DP013-0000-PROCESS-ABEND                 20980099
209900         END-EVALUATE                                             20990099
210000     END-PERFORM.                                                 21000099
210100                                                                  21010099
210200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    21020099
210300         SQLCODE NOT = +0                                         21030099
210400         MOVE '2420-INSERT-RCT-RCVR-TRLR-LST'                     21040099
210500                                   TO DP013-PARAGRAPH             21050099
210600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              21060099
210700                                   TO DP013-MESSAGE-TEXT (1)      21070099
210800         MOVE 'TO INSERT A RCT00016 ROW'                          21080099
210900                                   TO DP013-MESSAGE-TEXT (2)      21090099
211000         MOVE SQLCA                TO DP013-SQLCA                 21100099
211100         MOVE 'RCT_RCVR_TRLR_LST'  TO DP013-DB2-TABLE-NAME (1)    21110099
211200         SET DP013-DB2-ABEND                                      21120099
211300             DP013-XCTL-DISPLAY-RESTART                           21130099
211400                                   TO TRUE                        21140099
211500         PERFORM DP013-0000-PROCESS-ABEND                         21150099
211600     END-IF.                                                      21160099
211700                                                                  21170099
211710*----------------------------------------------------------------*21171099
211720* CHECK TDISTHD TO SEE IF PACK TO LIGHT HAS BEEN DOWNLOADED.      21172099
211730*----------------------------------------------------------------*21173099
211740 2450-SELECT-TDISTHD.                                             21174099
211750                                                                  21175099
211752                                                                  21175299
211753     EXEC SQL                                                     21175399
211754        SELECT COUNT(*)                                           21175499
211755          INTO  :PV-DB2-COUNT-P2L-CARTONS                         21175599
211758        FROM   TDISTHD A                                          21175899
211759        WHERE A.ORD_NBR            = :DK-PO-NBR                   21175999
211760          AND A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR              21176099
211762          AND A.P2L_CART_CNT       > 0                            21176299
211763          AND A.RSLTS_RCVD_TMST    = '9999-09-09-09.09.09.999999' 21176399
211770     END-EXEC                                                     21177099
211795                                                                  21179599
211796     EVALUATE TRUE                                                21179699
211797         WHEN SQLCODE = ZERO                                      21179799
211798              IF PV-DB2-COUNT-P2L-CARTONS > 0                     21179899
211800                  SET PS-P2L-DOWNLOAD-YES   TO TRUE               21180099
211801              ELSE                                                21180199
211802                  SET PS-P2L-DOWNLOAD-NO    TO TRUE               21180299
211803              END-IF                                              21180399
211804         WHEN SQLCODE = +100                                      21180499
211805              SET PS-P2L-DOWNLOAD-NO    TO TRUE                   21180599
211806         WHEN SQLWARN0 NOT = SPACE                                21180699
211807         WHEN SQLCODE < ZERO                                      21180799
211808         WHEN SQLCODE > ZERO                                      21180899
211809             MOVE '2450-SELECT-TDISTHD'                           21180999
211810                             TO DP013-PARAGRAPH                   21181099
211811             MOVE 'SELECT P2L INFO'                               21181199
211812                             TO DP013-MESSAGE-TEXT (1)            21181299
211813             MOVE SQLCA      TO DP013-SQLCA                       21181399
211814             MOVE 'TDISTHD'           TO DP013-DB2-TABLE-NAME (1) 21181499
211815             SET DP013-DB2-ABEND                                  21181599
211816                             TO TRUE                              21181699
211817             SET DP013-XCTL-DISPLAY-RESTART                       21181799
211818                             TO TRUE                              21181899
211819             PERFORM DP013-0000-PROCESS-ABEND                     21181999
211820     END-EVALUATE.                                                21182099
211821                                                                  21182199
211822/                                                                 21182299
211830*----------------------------------------------------------------*21183099
211900* AT THE END OF CURSOR CHECK SWITCHES AND BUILD MESSAGE LIST.     21190099
212000*----------------------------------------------------------------*21200099
212100 2500-PROCESS-CURSOR.                                             21210099
212200                                                                  21220099
212300         IF ASC-FACILITY-AUTOVE-YES                               21230099
212400             MOVE ZEROES TO PV-DB2-COUNT-TROUBLE                  21240099
212500             PERFORM 4380-CHECK-IF-IN-TROUBLE                     21250099
212600             IF PV-DB2-COUNT-TROUBLE > ZERO                       21260099
212700                SET PS-TROUBLE    TO TRUE                         21270099
212800                ADD +1            TO ASC-REC-TROUBLE-COUNT        21280099
212900             END-IF                                               21290099
213000         END-IF                                                   21300099
213100                                                                  21310099
213200         IF PS-SMOOTHING-NO                                       21320099
213300             MOVE ZEROES TO PV-DB2-COUNT-SMOOTHING                21330099
213400             PERFORM 4370-COUNT-SMOOTH-CARTONS                    21340099
213500             IF PV-DB2-COUNT-SMOOTHING > ZERO                     21350099
213600                SET PS-SMOOTHING     TO TRUE                      21360099
213700             END-IF                                               21370099
213800         END-IF                                                   21380099
213900                                                                  21390099
214000         IF PS-UNUSED-LABELS-NO                                   21400099
214100             MOVE ZEROES TO PV-DB2-COUNT-UNUSED-LABELS            21410099
214200             PERFORM 4375-COUNT-UNUSED-LABELS                     21420099
214300             IF PV-DB2-COUNT-UNUSED-LABELS > ZERO                 21430099
214400                SET PS-UNUSED-LABELS TO TRUE                      21440099
214500             END-IF                                               21450099
214600         END-IF                                                   21460099
214700                                                                  21470099
214800         IF ASC-FACILITY-AUTOVE-YES                               21480099
214900            IF PS-PBS-ERRORS-NO                                   21490099
215000                MOVE ZEROES TO PV-DB2-COUNT-PBS-ERRORS            21500099
215100                PERFORM 4376-CHECK-FOR-PBS-ERRORS                 21510099
215200                IF PV-DB2-COUNT-PBS-ERRORS    > ZERO              21520099
215300                   SET PS-PBS-ERRORS    TO TRUE                   21530099
215400                END-IF                                            21540099
215500            END-IF                                                21550099
215600         END-IF                                                   21560099
215700                                                                  21570099
215800         IF PS-FREE-ASTRAY-NO    AND                              21580099
215900            RECEIV-FRE-ASTRA-IND = 'Y'                            21590099
216000            SET PS-FREE-ASTRAY   TO TRUE                          21600099
216100         END-IF                                                   21610099
216200                                                                  21620099
216300         IF ASC-FACILITY-AUTOVE-YES                               21630099
216400             IF PS-AUTO-VE                                        21640099
216500                 PERFORM 2300-CALL-AUTOVE-MODULE                  21650099
216600                 IF RC040-AUTO-VE-YES                             21660099
216700                    SET PS-AUTO-VE  TO TRUE                       21670099
216800                    PERFORM 2350-CALL-RCKUT128                    21680099
216900                    IF RC074-TOTAL-ACTL-ITM-QTY = 0               21690099
216910                       PERFORM 2450-SELECT-TDISTHD                21691099
216920                       IF PS-P2L-DOWNLOAD-NO                      21692099
216930                         IF PV-DB2-COUNT-TROUBLE = ZERO           21693099
217000                           SET PS-VERIFY-AT-ZERO      TO TRUE     21700099
217001                           ADD +1        TO ASC-VERIFY-ZERO-COUNT 21700199
217002                         END-IF                                   21700299
217003                       ELSE                                       21700399
217010                         IF PV-DB2-COUNT-TROUBLE = ZERO           21701099
217020                            SET PS-VERIFY-AT-ZERO      TO TRUE    21702099
217100                            ADD +1        TO ASC-VERIFY-ZERO-COUNT21710099
217200                         END-IF                                   21720099
217201                       END-IF                                     21720199
217210                    END-IF                                        21721099
217300                 ELSE                                             21730099
217400                    SET PS-MANUAL-VE   TO TRUE                    21740099
217500                 END-IF                                           21750099
217600             END-IF                                               21760099
217700         END-IF                                                   21770099
217800                                                                  21780099
217900         IF PS-NO-PRO-NO                                          21790099
218000            PERFORM 4395-GET-SHIPMENT-INFO                        21800099
218100            IF PV-DB2-COUNT-NO-PRO  > 0                           21810099
218200               SET PS-NO-PRO-YES  TO TRUE                         21820099
218300            END-IF                                                21830099
218400         END-IF.                                                  21840099
218500                                                                  21850099
218600*----------------------------------------------------------------*21860099
218700*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *21870099
218800*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *21880099
218900*----------------------------------------------------------------*21890099
219000 3000-EDIT-DATA-IN-COMMAREA.                                      21900099
219100                                                                  21910099
219200     SET PS-NO-ERROR               TO TRUE.                       21920099
219300                                                                  21930099
219400     PERFORM 3200-RESET-ATTRIBUTES.                               21940099
219500                                                                  21950099
219600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     21960099
219700**                                                                21970099
219800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              21980099
219900* EDITTING IS DONE FROM THE BOTTOM UP.                            21990099
220000**                                                                22000099
220100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       22010099
220200         ASC-ITEMS-DISPLAYED - 1.                                 22020099
220300                                                                  22030099
220400     PERFORM 3100-SET-SUBSCRIPTS.                                 22040099
220500     SET ASC-CHECKLIST-YES  TO TRUE                               22050099
220600     PERFORM 3300-EDIT-SELECTIONS                                 22060099
220700         VARYING PV-SUB                                           22070099
220800         FROM PV-SUB BY -1                                        22080099
220900         UNTIL PV-SUB < +1                                        22090099
221000                                                                  22100099
221100     IF  PS-NO-ERROR                                              22110099
221200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        22120099
221300     END-IF.                                                      22130099
221400                                                                  22140099
221500     IF  ((PS-NO-ERROR)                                           22150099
221600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   22160099
221700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    22170099
221800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  22180099
221900     END-IF.                                                      22190099
222000                                                                  22200099
222100/                                                                 22210099
222200*----------------------------------------------------------------*22220099
222300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *22230099
222400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*22240099
222500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *22250099
222600*                                                                *22260099
222700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *22270099
222800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *22280099
222900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *22290099
223000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *22300099
223100*----------------------------------------------------------------*22310099
223200                                                                  22320099
223300 3100-SET-SUBSCRIPTS.                                             22330099
223400                                                                  22340099
223500     COMPUTE ASC-ITEM-SUB =                                       22350099
223600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        22360099
223700                                                                  22370099
223800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         22380099
223900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22390099
224000                                                                  22400099
224100         MOVE PC-MAX-BLOCKS-IN-ARRAY                              22410099
224200                                   TO ASC-BLK-SUB                 22420099
224300     ELSE                                                         22430099
224400         MOVE +1                   TO ASC-BLK-SUB                 22440099
224500     END-IF.                                                      22450099
224600                                                                  22460099
224700*----------------------------------------------------------------*22470099
224800*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *22480099
224900*----------------------------------------------------------------*22490099
225000                                                                  22500099
225100 3200-RESET-ATTRIBUTES.                                           22510099
225200                                                                  22520099
225300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   22530099
225400     MOVE DP015-GREEN              TO ASTRTITC.                   22540099
225500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   22550099
225600                                                                  22560099
225700        PERFORM                                                   22570099
225800            VARYING PV-SUB                                        22580099
225900            FROM 1 BY 1                                           22590099
226000            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     22600099
226100            MOVE DP015-UNP-ALP-NOR-OFF                            22610099
226200                                      TO MR-SELECTA (PV-SUB)      22620099
226300            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      22630099
226400            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      22640099
226500        END-PERFORM.                                              22650099
226600/                                                                 22660099
226700*----------------------------------------------------------------*22670099
226800*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *22680099
226900*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *22690099
227000*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *22700099
227100*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *22710099
227200*----------------------------------------------------------------*22720099
227300 3300-EDIT-SELECTIONS.                                            22730099
227400                                                                  22740099
227500     EVALUATE TRUE                                                22750099
227600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22760099
227700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22770099
227800                 CONTINUE                                         22780099
227900                                                                  22790099
228000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22800099
228100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22810099
228200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS22820099
228300                 MOVE ASC-TEMP-SELECTED-SW                        22830099
228400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22840099
228500                                   TO ASC-SELECTED-SW             22850099
228600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22860099
228700             END-IF                                               22870099
228800                                                                  22880099
228900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22890099
229000                 = SPACE                                          22900099
229100             EVALUATE TRUE                                        22910099
229200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22920099
229300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22930099
229400                     MOVE SPACE    TO ASC-SELECTED-SW             22940099
229500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22950099
229600                                                                  22960099
229700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22970099
229800                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 22980099
229900                     MOVE SPACE    TO ASC-SELECTED-SW             22990099
230000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23000099
230100                                                                  23010099
230200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          23020099
230300                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   23030099
230400                     MOVE SPACE    TO ASC-SELECTED-SW             23040099
230500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23050099
230600             END-EVALUATE                                         23060099
230700                                                                  23070099
230800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           23080099
230900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23090099
231000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23100099
231100             END-IF                                               23110099
231200             PERFORM 3310-EDIT-RANGE                              23120099
231300                                                                  23130099
231400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             23140099
231500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23150099
231600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23160099
231700             END-IF                                               23170099
231800             PERFORM 3310-EDIT-RANGE                              23180099
231900                                                                  23190099
232000         WHEN OTHER                                               23200099
232100*            MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            23210099
232200             MOVE PC-TSYMSG-03262  TO DP020-MSG-NUMBER            23220099
232300             SET DP020-MSG-FATAL   TO TRUE                        23230099
232400             MOVE -1               TO MR-SELECTL (PV-SUB)         23240099
232500             SET DP030-SET-CURSOR-APPL-1                          23250099
232600                                   TO TRUE                        23260099
232700             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         23270099
232800             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         23280099
232900             SET PS-ERROR          TO TRUE                        23290099
233000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23300099
233100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23310099
233200                 MOVE SPACE        TO ASC-SELECTED-SW             23320099
233300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23330099
233400             END-IF                                               23340099
233500     END-EVALUATE.                                                23350099
233600                                                                  23360099
233700     IF PS-NO-ERROR                                               23370099
233800        IF DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                 23380099
233900          IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                23390099
234000              SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS        23400099
234100          ELSE                                                    23410099
234200              SET ASC-CHECKLIST-NO   TO TRUE                      23420099
234300          END-IF                                                  23430099
234400     END-IF                                                       23440099
234500                                                                  23450099
234600     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             23460099
234700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               23470099
234800                                                                  23480099
234900     IF  ASC-ITEM-SUB < 1                                         23490099
235000         SUBTRACT +1 FROM ASC-BLK-SUB                             23500099
235100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                23510099
235200     END-IF.                                                      23520099
235300                                                                  23530099
235400*----------------------------------------------------------------*23540099
235500*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *23550099
235600*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *23560099
235700*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *23570099
235800*  THE ENDING.                                                   *23580099
235900*----------------------------------------------------------------*23590099
236000 3310-EDIT-RANGE.                                                 23600099
236100                                                                  23610099
236200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                23620099
236300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   23630099
236400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23640099
236500                                   TO ASC-SELECTED-SW             23650099
236600                                        (ASC-BLK-SUB ASC-ITEM-SUB)23660099
236700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23670099
236800         ELSE                                                     23680099
236900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     23690099
237000                 CONTINUE                                         23700099
237100             ELSE                                                 23710099
237200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23720099
237300                 MOVE PC-TSYMSG-00054                             23730099
237400                                   TO DP020-MSG-NUMBER            23740099
237500                 SET DP020-MSG-FATAL                              23750099
237600                                   TO TRUE                        23760099
237700                 MOVE -1           TO MR-SELECTL (PV-SUB)         23770099
237800                 SET DP030-SET-CURSOR-APPL-1                      23780099
237900                                   TO TRUE                        23790099
238000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         23800099
238100                 MOVE DP015-UNDERLINE                             23810099
238200                                   TO MR-SELECTH (PV-SUB)         23820099
238300                 SET PS-ERROR      TO TRUE                        23830099
238400             END-IF                                               23840099
238500         END-IF                                                   23850099
238600     ELSE                                                         23860099
238700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23870099
238800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23880099
238900                                   TO ASC-SELECTED-SW             23890099
239000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23900099
239100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23910099
239200         ELSE                                                     23920099
239300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23930099
239400                 CONTINUE                                         23940099
239500             ELSE                                                 23950099
239600*                -- ONLY ONE END-OF-RANGE ALLOWED --              23960099
239700                 MOVE PC-TSYMSG-00055                             23970099
239800                                   TO DP020-MSG-NUMBER            23980099
239900                 SET DP020-MSG-FATAL                              23990099
240000                                   TO TRUE                        24000099
240100                 MOVE -1           TO MR-SELECTL (PV-SUB)         24010099
240200                 SET DP030-SET-CURSOR-APPL-1                      24020099
240300                                   TO TRUE                        24030099
240400                 SET PS-ERROR      TO TRUE                        24040099
240500             END-IF                                               24050099
240600         END-IF                                                   24060099
240700     END-IF.                                                      24070099
240800                                                                  24080099
240900*----------------------------------------------------------------*24090099
241000*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *24100099
241100*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *24110099
241200*----------------------------------------------------------------*24120099
241300 3400-CHECK-RANGE-SEQUENCE.                                       24130099
241400                                                                  24140099
241500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24150099
241600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      24160099
241700       AND  ASC-START-OF-SELECTED-RANGE >                         24170099
241800                                         ASC-END-OF-SELECTED-RANGE24180099
241900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                24190099
242000         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            24200099
242100         SET DP020-MSG-FATAL       TO TRUE                        24210099
242200         SET PS-ERROR              TO TRUE                        24220099
242300         PERFORM 3410-POSITION-AT-ERROR                           24230099
242400     END-IF.                                                      24240099
242500                                                                  24250099
242600*----------------------------------------------------------------*24260099
242700*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *24270099
242800*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *24280099
242900*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *24290099
243000*----------------------------------------------------------------*24300099
243100 3410-POSITION-AT-ERROR.                                          24310099
243200                                                                  24320099
243300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       24330099
243400                                                                  24340099
243500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24350099
243600                    - PV-TOP-ITEM + 1.                            24360099
243700                                                                  24370099
243800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24380099
243900         CONTINUE                                                 24390099
244000     ELSE                                                         24400099
244100         MOVE -1                   TO MR-SELECTL (PV-SUB)         24410099
244200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24420099
244300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24430099
244400     END-IF.                                                      24440099
244500                                                                  24450099
244600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24460099
244700                    - PV-TOP-ITEM + 1.                            24470099
244800                                                                  24480099
244900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24490099
245000         CONTINUE                                                 24500099
245100     ELSE                                                         24510099
245200         MOVE -1                   TO MR-SELECTL (PV-SUB)         24520099
245300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24530099
245400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24540099
245500     END-IF.                                                      24550099
245600                                                                  24560099
245700/                                                                 24570099
245800*----------------------------------------------------------------*24580099
245900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *24590099
246000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *24600099
246100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *24610099
246200*----------------------------------------------------------------*24620099
246300                                                                  24630099
246400 3500-MARK-RANGE-AS-SELECTED.                                     24640099
246500                                                                  24650099
246600     MOVE +1                       TO ASC-BLK-SUB.                24660099
246700                                                                  24670099
246800     PERFORM 3510-MARK-SELECTED-INDS                              24680099
246900         VARYING ASC-ITEM-SUB                                     24690099
247000         FROM 1 BY 1                                              24700099
247100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24710099
247200                                                                  24720099
247300     ADD +1                        TO ASC-BLK-SUB.                24730099
247400                                                                  24740099
247500     PERFORM 3510-MARK-SELECTED-INDS                              24750099
247600         VARYING ASC-ITEM-SUB                                     24760099
247700         FROM 1 BY 1                                              24770099
247800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24780099
247900                                                                  24790099
248000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24800099
248100                                   TO PV-LIST-ITEM-NUMBER.        24810099
248200                                                                  24820099
248300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24830099
248400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24840099
248500               PC-ITEMS-PER-PANEL).                               24850099
248600                                                                  24860099
248700     MOVE ASC-START-OF-SELECTED-RANGE                             24870099
248800                                   TO PV-START-OF-SELECTED-RANGE. 24880099
248900                                                                  24890099
249000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24900099
249100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24910099
249200               PC-ITEMS-PER-PANEL).                               24920099
249300                                                                  24930099
249400     MOVE ASC-END-OF-SELECTED-RANGE                               24940099
249500                                   TO PV-END-OF-SELECTED-RANGE.   24950099
249600                                                                  24960099
249700     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24970099
249800         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24980099
249900               PC-ITEMS-PER-PANEL).                               24990099
250000                                                                  25000099
250100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             25010099
250200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             25020099
250300                                                                  25030099
250400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    25040099
250500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        25050099
250600         MOVE +1                   TO ASC-BLK-SUB                 25060099
250700         PERFORM 5100-WRITE-TEMP-STORAGE                          25070099
250800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         25080099
250900             PV-FIRST-BLOCK-IN-ARRAY - 1                          25090099
251000                                                                  25100099
251100         PERFORM                                                  25110099
251200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      25120099
251300                   PV-PREV-BLOCK-IN-ARRAY                         25130099
251400             MOVE PV-FIRST-BLOCK-IN-RANGE                         25140099
251500                                   TO PV-BLOCK-NUMBER             25150099
251600             PERFORM 4410-READ-TEMP-STORAGE                       25160099
251700             PERFORM 3510-MARK-SELECTED-INDS                      25170099
251800                 VARYING ASC-ITEM-SUB                             25180099
251900                 FROM 1 BY 1                                      25190099
252000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25200099
252100             PERFORM 5100-WRITE-TEMP-STORAGE                      25210099
252200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     25220099
252300         END-PERFORM                                              25230099
252400                                                                  25240099
252500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         25250099
252600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     25260099
252700         PERFORM                                                  25270099
252800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       25280099
252900                   PV-LAST-BLOCK-IN-RANGE                         25290099
253000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          25300099
253100                                   TO PV-BLOCK-NUMBER             25310099
253200             PERFORM 4410-READ-TEMP-STORAGE                       25320099
253300             PERFORM 3510-MARK-SELECTED-INDS                      25330099
253400                 VARYING ASC-ITEM-SUB                             25340099
253500                 FROM 1 BY 1                                      25350099
253600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25360099
253700             PERFORM 5100-WRITE-TEMP-STORAGE                      25370099
253800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      25380099
253900         END-PERFORM                                              25390099
254000                                                                  25400099
254100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25410099
254200                                   TO PV-BLOCK-NUMBER             25420099
254300         PERFORM 4410-READ-TEMP-STORAGE                           25430099
254400     END-IF.                                                      25440099
254500                                                                  25450099
254600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 25460099
254700                                      ASC-END-OF-SELECTED-RANGE.  25470099
254800                                                                  25480099
254900/                                                                 25490099
255000*----------------------------------------------------------------*25500099
255100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *25510099
255200*----------------------------------------------------------------*25520099
255300                                                                  25530099
255400 3510-MARK-SELECTED-INDS.                                         25540099
255500                                                                  25550099
255600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         25560099
255700         ASC-START-OF-SELECTED-RANGE)                             25570099
255800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         25580099
255900         ASC-START-OF-SELECTED-RANGE)                             25590099
256000                                                                  25600099
256100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     25610099
256200             ASC-END-OF-SELECTED-RANGE)                           25620099
256300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     25630099
256400             ASC-END-OF-SELECTED-RANGE)                           25640099
256500                                                                  25650099
256600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25660099
256700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25670099
256800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25680099
256900                                   TO TRUE                        25690099
257000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25700099
257100                                   TO TRUE                        25710099
257200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS25720099
257300             END-IF                                               25730099
257400         END-IF                                                   25740099
257500     END-IF.                                                      25750099
257600                                                                  25760099
257700/                                                                 25770099
257800*----------------------------------------------------------------*25780099
257900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25790099
258000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25800099
258100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25810099
258200*    DISPLAY THE PANEL TO USER.                                  *25820099
258300*----------------------------------------------------------------*25830099
258400                                                                  25840099
258500 4000-BUILD-INITIAL-PANEL.                                        25850099
258600                                                                  25860099
258700     INITIALIZE ASC-BLOCK-ENTRIES (1)                             25870099
258800                ASC-BLOCK-ENTRIES (2).                            25880099
258900                                                                  25890099
259000     MOVE +1                       TO ASC-BLK-SUB.                25900099
259100                                                                  25910099
259200     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       25920099
259300                                                                  25930099
259400     MOVE +0                       TO ASC-ITEM-SUB                25940099
259500                                      ASC-NUMBER-OF-ITEMS-READ    25950099
259600                                      ASC-NUMBER-OF-SELECTED-ITEMS25960099
259700                                      ASC-HIGHEST-BLOCK-WRITTEN   25970099
259800                                      ASC-START-OF-SELECTED-RANGE 25980099
259900                                      ASC-END-OF-SELECTED-RANGE   25990099
260000                                      ASC-ITEM-AT-TOP-OF-PANEL.   26000099
260100                                                                  26010099
260200     SET PS-DC-LEVEL-YES            TO  TRUE                      26020099
260300     PERFORM 2300-CALL-AUTOVE-MODULE                              26030099
260310     SET PS-DC-LEVEL-NO             TO  TRUE                      26031099
260320     IF RC040-FACILITY-AUTOVE-YES                                 26032099
260330        SET PS-STOP-VERIFICATION    TO  TRUE                      26033099
260340        SET ASC-FACILITY-AUTOVE-YES TO  TRUE                      26034099
260350     END-IF                                                       26035099
260360                                                                  26036099
260370     PERFORM 1150-SELECT-TKRPRPM.                                 26037099
260380                                                                  26038099
260390     PERFORM 4100-PREPARE-CURSOR.                                 26039099
260400                                                                  26040099
260500     PERFORM 4010-OPEN-CURSOR.                                    26050099
260600                                                                  26060099
260700     PERFORM 4310-FETCH                                           26070099
260800             UNTIL PS-END-RCVR-CSR                                26080099
260900                                                                  26090099
261000     PERFORM 4020-CLOSE-CURSOR.                                   26100099
261100                                                                  26110099
261200     PERFORM 4300-READ-ITEMS-FROM-DB.                             26120099
261300                                                                  26130099
261400     MOVE +1                       TO PV-TOP-ITEM.                26140099
261500                                                                  26150099
261600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          26160099
261700         SET DP020-NEXT-ACT-APPL-ERROR                            26170099
261800                                   TO TRUE                        26180099
261900         SET DP020-MSG-FATAL       TO TRUE                        26190099
262000         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            26200099
262100     ELSE                                                         26210099
262200         MOVE -1                   TO MR-SELECTL (1)              26220099
262300         SET DP030-SET-CURSOR-APPL-1                              26230099
262400                                   TO TRUE                        26240099
262500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     26250099
262600     END-IF.                                                      26260099
262700                                                                  26270099
262800/                                                                 26280099
262900*----------------------------------------------------------------*26290099
263000* OPEN THE RCVR CURSOR.                                          *26300099
263100*----------------------------------------------------------------*26310099
263200                                                                  26320099
263300 4010-OPEN-CURSOR.                                                26330099
263400                                                                  26340099
263500     PERFORM                                                      26350099
263600         WITH TEST AFTER                                          26360099
263700         VARYING PV-RETRY-COUNTER                                 26370099
263800         FROM 1 BY 1                                              26380099
263900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26390099
264000            OR (SQLCODE = +0))                                    26400099
264100                                                                  26410099
264200         EXEC SQL                                                 26420099
264300             OPEN RCVR-CSR                                        26430099
264400         END-EXEC                                                 26440099
264500                                                                  26450099
264600         EVALUATE TRUE                                            26460099
264700             WHEN SQLCODE = +0                                    26470099
264800                  CONTINUE                                        26480099
264900             WHEN SQLCODE = -904                                  26490099
265000             WHEN SQLCODE = -913                                  26500099
265100                  CONTINUE                                        26510099
265200             WHEN SQLWARN0 NOT = SPACE                            26520099
265300             WHEN SQLCODE  NOT = +0                               26530099
265400                  MOVE '4010-OPEN-CURSOR'                         26540099
265500                                   TO DP013-PARAGRAPH             26550099
265600                  MOVE 'OPEN RCVR-CSR CURSOR'                     26560099
265700                                   TO DP013-MESSAGE-TEXT (1)      26570099
265800                  MOVE SQLCA       TO DP013-SQLCA                 26580099
265900                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)    26590099
266000                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (2)    26600099
266100                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (3)    26610099
266200                  SET DP013-DB2-ABEND                             26620099
266300                                   TO TRUE                        26630099
266400                  PERFORM DP013-0000-PROCESS-ABEND                26640099
266500         END-EVALUATE                                             26650099
266600     END-PERFORM.                                                 26660099
266700                                                                  26670099
266800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26680099
266900                 AND SQLCODE NOT = ZERO                           26690099
267000         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             26700099
267100         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              26710099
267200                                   TO DP013-MESSAGE-TEXT (1)      26720099
267300         MOVE SQLCA                TO DP013-SQLCA                 26730099
267400         SET DP013-DB2-ABEND       TO TRUE                        26740099
267500         PERFORM DP013-0000-PROCESS-ABEND                         26750099
267600     END-IF.                                                      26760099
267700                                                                  26770099
267800/                                                                 26780099
267900*----------------------------------------------------------------*26790099
268000* CLOSE THE RCVR CURSOR                                          *26800099
268100*----------------------------------------------------------------*26810099
268200                                                                  26820099
268300 4020-CLOSE-CURSOR.                                               26830099
268400                                                                  26840099
268500     EXEC SQL                                                     26850099
268600         CLOSE RCVR-CSR                                           26860099
268700     END-EXEC.                                                    26870099
268800                                                                  26880099
268900     EVALUATE TRUE                                                26890099
269000         WHEN SQLCODE = +0                                        26900099
269100              CONTINUE                                            26910099
269200         WHEN SQLWARN0 NOT = SPACE                                26920099
269300         WHEN SQLCODE  NOT = +0                                   26930099
269400              MOVE '4020-CLOSE-CURSOR'                            26940099
269500                                   TO DP013-PARAGRAPH             26950099
269600              MOVE 'CLOSE RCVR-CSR CURSOR'                        26960099
269700                                   TO DP013-MESSAGE-TEXT (1)      26970099
269800              MOVE SQLCA           TO DP013-SQLCA                 26980099
269900              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    26990099
270000              MOVE 'TSTATCD'       TO DP013-DB2-TABLE-NAME (2)    27000099
270100              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (3)    27010099
270200              SET DP013-DB2-ABEND  TO TRUE                        27020099
270300              PERFORM DP013-0000-PROCESS-ABEND                    27030099
270400     END-EVALUATE.                                                27040099
270500                                                                  27050099
270600/                                                                 27060099
270700*----------------------------------------------------------------*27070099
270800*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *27080099
270900*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *27090099
271000*----------------------------------------------------------------*27100099
271100                                                                  27110099
271200 4100-PREPARE-CURSOR.                                             27120099
271300                                                                  27130099
271400     MOVE ASC-SCAC-ID             TO DK-SCAC-ID.                  27140099
271500     MOVE ASC-VEH-NBR             TO DK-VEH-NBR.                  27150099
271600     MOVE ASC-TRIP-ID             TO DK-TRIP-ID.                  27160099
271700     SET PS-UPDATE-OPER-SET       TO  TRUE.                       27170099
271800                                                                  27180099
271900/                                                                 27190099
272000*----------------------------------------------------------------*27200099
272100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *27210099
272200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *27220099
272300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *27230099
272400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *27240099
272500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *27250099
272600*                                                                *27260099
272700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *27270099
272800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *27280099
272900*    UPON INITIALIZATION.                                        *27290099
273000*----------------------------------------------------------------*27300099
273100                                                                  27310099
273200 4300-READ-ITEMS-FROM-DB.                                         27320099
273300                                                                  27330099
273400     PERFORM                                                      27340099
273500         VARYING PV-READ-COUNT                                    27350099
273600         FROM 1 BY 1                                              27360099
273700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    27370099
273800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         27380099
273900                                                                  27390099
274000         IF  ASC-ITEMS-LEFT-ON-DB                                 27400099
274100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                27410099
274200                 ADD +1            TO ASC-ITEM-SUB                27420099
274300             ELSE                                                 27430099
274400                 ADD +1            TO ASC-BLK-SUB                 27440099
274500                 MOVE +1           TO ASC-ITEM-SUB                27450099
274600                                                                  27460099
274700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         27470099
274800                     MOVE +1       TO ASC-BLK-SUB                 27480099
274900                     SET ASC-BLOCK-MODIFIED (1)                   27490099
275000                                   TO TRUE                        27500099
275100                     PERFORM 5100-WRITE-TEMP-STORAGE              27510099
275200                     MOVE ASC-BLOCK-ENTRIES                       27520099
275300                               (PC-MAX-BLOCKS-IN-ARRAY)           27530099
275400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 27540099
275500                     ADD +1        TO ASC-BLK-SUB                 27550099
275600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   27560099
275700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      27570099
275800                                   TO TRUE                        27580099
275900                 END-IF                                           27590099
276000             END-IF                                               27600099
276100                                                                  27610099
276200             PERFORM 2400-PROCESS-MESSAGE-LIST                    27620099
276300         END-IF                                                   27630099
276400                                                                  27640099
276500     END-PERFORM.                                                 27650099
276600                                                                  27660099
276700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27670099
276800         MOVE +1                   TO ASC-BLK-SUB                 27680099
276900         PERFORM 5100-WRITE-TEMP-STORAGE                          27690099
277000         ADD +1                    TO ASC-BLK-SUB                 27700099
277100         PERFORM 5100-WRITE-TEMP-STORAGE                          27710099
277200                                                                  27720099
277300         MOVE 1                    TO ASC-BLK-SUB                 27730099
277400                                      PV-BLOCK-NUMBER             27740099
277500         PERFORM 4410-READ-TEMP-STORAGE                           27750099
277600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27760099
277700             MOVE 2                TO ASC-BLK-SUB                 27770099
277800                                      PV-BLOCK-NUMBER             27780099
277900             PERFORM 4410-READ-TEMP-STORAGE                       27790099
278000         END-IF                                                   27800099
278100     END-IF.                                                      27810099
278200                                                                  27820099
278300/                                                                 27830099
278400*----------------------------------------------------------------*27840099
278500*    FETCH A RCVR ROW                                            *27850099
278600*----------------------------------------------------------------*27860099
278700                                                                  27870099
278800 4310-FETCH.                                                      27880099
278900                                                                  27890099
279000     EXEC SQL                                                     27900099
279100         FETCH RCVR-CSR                                           27910099
279200          INTO :SHPTPO-PO-NBR                                     27920099
279300              ,:SHPTPO-REC-SEQ-NBR                                27930099
279400              ,:RECEIV-STATUS-CDE                                 27940099
279500              ,:RECEIV-PACK-BY-ST-IND                             27950099
279600              ,:RECEIV-FRE-ASTRA-IND                              27960099
279700              ,:RECEIV-PKGNG-CDE                                  27970099
279800     END-EXEC.                                                    27980099
279900                                                                  27990099
280000     EVALUATE TRUE                                                28000099
280100         WHEN SQLCODE = +0                                        28010099
280200              MOVE SHPTPO-PO-NBR      TO DK-PO-NBR                28020099
280300              MOVE SHPTPO-REC-SEQ-NBR TO DK-REC-SEQ-NBR           28030099
280400              MOVE RECEIV-PKGNG-CDE   TO DK-PKGNG-CDE             28040099
280500              PERFORM 2500-PROCESS-CURSOR                         28050099
280600         WHEN SQLCODE = +100                                      28060099
280700              SET PS-END-RCVR-CSR                                 28070099
280800                                   TO TRUE                        28080099
280900         WHEN SQLWARN0 NOT = SPACE                                28090099
281000         WHEN SQLCODE < +0                                        28100099
281100         WHEN SQLCODE > +0                                        28110099
281200              MOVE '4310-FETCH-CURSOR'                            28120099
281300                                   TO DP013-PARAGRAPH             28130099
281400              MOVE 'FETCH RCVR CURSOR'                            28140099
281500                                   TO DP013-MESSAGE-TEXT (1)      28150099
281600              MOVE SQLCA           TO DP013-SQLCA                 28160099
281700              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    28170099
281800              MOVE 'TSTATCD'       TO DP013-DB2-TABLE-NAME (2)    28180099
281900              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (3)    28190099
282000              SET DP013-DB2-ABEND  TO TRUE                        28200099
282100              PERFORM DP013-0000-PROCESS-ABEND                    28210099
282200     END-EVALUATE.                                                28220099
282300                                                                  28230099
282400/                                                                 28240099
282500 4340-GET-SHIPMENT-INFO.                                          28250099
282600                                                                  28260099
282700     PERFORM                                                      28270099
282800         WITH TEST AFTER                                          28280099
282900         VARYING PV-RETRY-COUNTER                                 28290099
283000         FROM 1 BY 1                                              28300099
283100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28310099
283200            OR (SQLCODE = +0)                                     28320099
283300            OR (SQLCODE = +100)                                   28330099
283400            OR (SQLCODE = -811))                                  28340099
283500                                                                  28350099
283600         EXEC SQL                                                 28360099
283700            SELECT  B.SHIPT_ID                                    28370099
283800                   ,B.TRIP_ID                                     28380099
283900              INTO :SHIPMT-SHIPT-ID                               28390099
284000                  ,:SHIPMT-TRIP-ID                                28400099
284100              FROM  TSHPTPO A                                     28410099
284200                   ,TSHIPMT B                                     28420099
284300          WHERE A.PO_NBR      = :DK-PO-NBR                        28430099
284400            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   28440099
284500            AND A.PRIM_SHIPT_IND = :PC-Y                          28450099
284600            AND A.SHIPT_ID = B.SHIPT_ID                           28460099
284700         END-EXEC                                                 28470099
284800                                                                  28480099
284900         EVALUATE TRUE                                            28490099
285000             WHEN SQLCODE = +0                                    28500099
285100             WHEN SQLCODE = +100                                  28510099
285200             WHEN SQLCODE = -811                                  28520099
285300             WHEN SQLCODE = -904                                  28530099
285400             WHEN SQLCODE = -913                                  28540099
285500                 CONTINUE                                         28550099
285600                                                                  28560099
285700             WHEN SQLWARN0 NOT = SPACE                            28570099
285800             WHEN SQLCODE < +0                                    28580099
285900             WHEN SQLCODE > +0                                    28590099
286000                 MOVE '4340-GET-SHIPMENT-INFO'                    28600099
286100                                 TO DP013-PARAGRAPH               28610099
286200                 MOVE 'SELECT SHIPMENT TABLE'                     28620099
286300                                 TO DP013-MESSAGE-TEXT (1)        28630099
286400                 MOVE SQLCA      TO DP013-SQLCA                   28640099
286500                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      28650099
286600                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      28660099
286700                 SET DP013-DB2-ABEND                              28670099
286800                                 TO TRUE                          28680099
286900                 SET DP013-XCTL-DISPLAY-RESTART                   28690099
287000                                 TO TRUE                          28700099
287100                 PERFORM DP013-0000-PROCESS-ABEND                 28710099
287200         END-EVALUATE                                             28720099
287300     END-PERFORM.                                                 28730099
287400                                                                  28740099
287500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28750099
287600             AND SQLCODE NOT = ZERO                               28760099
287700             AND SQLCODE NOT = +100                               28770099
287800             AND SQLCODE NOT = -811                               28780099
287900         MOVE '4340-GET-SHIPMENT-INFO'                            28790099
288000                                 TO DP013-PARAGRAPH               28800099
288100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28810099
288200                                 TO DP013-MESSAGE-TEXT (1)        28820099
288300         MOVE 'SHIPMENT INFO'                                     28830099
288400                                 TO DP013-MESSAGE-TEXT (2)        28840099
288500         MOVE SQLCA              TO DP013-SQLCA                   28850099
288600         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      28860099
288700         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (2)      28870099
288800         SET DP013-DB2-ABEND     TO TRUE                          28880099
288900         SET DP013-XCTL-DISPLAY-RESTART                           28890099
289000                                 TO TRUE                          28900099
289100         PERFORM DP013-0000-PROCESS-ABEND                         28910099
289200     END-IF.                                                      28920099
289300                                                                  28930099
289400/                                                                 28940099
289500*----------------------------------------------------------------*28950099
289600*    COUNT SMOOTH CARTONS                                        *28960099
289700*----------------------------------------------------------------*28970099
289800 4370-COUNT-SMOOTH-CARTONS.                                       28980099
289900                                                                  28990099
290000     PERFORM                                                      29000099
290100         WITH TEST AFTER                                          29010099
290200         VARYING PV-RETRY-COUNTER                                 29020099
290300         FROM 1 BY 1                                              29030099
290400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29040099
290500            OR (SQLCODE = +0)                                     29050099
290600            OR (SQLCODE = +100))                                  29060099
290700                                                                  29070099
290800                                                                  29080099
290900         EXEC SQL                                                 29090099
291000             SELECT  COUNT(DISTINCT(A.SHIPT_UNT_ID))              29100099
291100             INTO  :PV-DB2-COUNT-SMOOTHING                        29110099
291200             FROM   SUT_OTBND_UPC A                               29120099
291300                   ,SUT_OTBND_CART B                              29130099
291400             WHERE A.TRN_NBR      = :DK-PO-NBR                    29140099
291500               AND A.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR               29150099
291600               AND A.SHIPT_UNT_ID =  B.SHIPT_UNT_ID               29160099
291700               AND B.CART_SRC_CDE = 'SMO'                         29170099
291800               AND B.ACTV_IND     = 'Y'                           29180099
291900                                                                  29190099
292000         END-EXEC                                                 29200099
292100                                                                  29210099
292200         EVALUATE TRUE                                            29220099
292300             WHEN SQLCODE = ZERO                                  29230099
292400             WHEN SQLCODE = +100                                  29240099
292500             WHEN SQLCODE = -904                                  29250099
292600             WHEN SQLCODE = -913                                  29260099
292700                 CONTINUE                                         29270099
292800             WHEN SQLWARN0 NOT = SPACE                            29280099
292900             WHEN SQLCODE NOT = ZERO                              29290099
293000                  MOVE '4371-COUNT-SMOOTH-CARTONS'                29300099
293100                                   TO DP013-PARAGRAPH             29310099
293200                  MOVE 'COUNT SMOOTH CARTONS'                     29320099
293300                                   TO DP013-MESSAGE-TEXT (1)      29330099
293400                  MOVE SQLCA       TO DP013-SQLCA                 29340099
293500                  SET DP013-DB2-ABEND                             29350099
293600                                   TO TRUE                        29360099
293700                  PERFORM DP013-0000-PROCESS-ABEND                29370099
293800         END-EVALUATE                                             29380099
293900     END-PERFORM                                                  29390099
294000                                                                  29400099
294100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    29410099
294200         SQLCODE NOT = +0                                         29420099
294300         MOVE '4371-COUNT-SMOOTH-CARTONS'                         29430099
294400                                 TO DP013-PARAGRAPH               29440099
294500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29450099
294600                                 TO DP013-MESSAGE-TEXT (1)        29460099
294700         MOVE 'ON SUT_OTBND_UPC' TO DP013-MESSAGE-TEXT (2)        29470099
294800         MOVE SQLCA              TO DP013-SQLCA                   29480099
294900         MOVE 'SUT_OTBND_UPC'    TO DP013-DB2-TABLE-NAME (1)      29490099
295000         MOVE 'SUT_OTBND_CART'   TO DP013-DB2-TABLE-NAME (2)      29500099
295100         SET DP013-DB2-ABEND     TO TRUE                          29510099
295200         SET DP013-XCTL-DISPLAY-RESTART                           29520099
295300                                 TO TRUE                          29530099
295400         PERFORM DP013-0000-PROCESS-ABEND                         29540099
295500     END-IF.                                                      29550099
295600/                                                                 29560099
295700*----------------------------------------------------------------*29570099
295800*    COUNT UNUSED LABELS                                         *29580099
295900*----------------------------------------------------------------*29590099
296000 4375-COUNT-UNUSED-LABELS.                                        29600099
296100                                                                  29610099
296200     PERFORM                                                      29620099
296300         WITH TEST AFTER                                          29630099
296400         VARYING PV-RETRY-COUNTER                                 29640099
296500         FROM 1 BY 1                                              29650099
296600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29660099
296700            OR (SQLCODE = +0)                                     29670099
296800            OR (SQLCODE = +100))                                  29680099
296900                                                                  29690099
297000         EXEC SQL                                                 29700099
297100             SELECT COUNT(*)                                      29710099
297200             INTO  :PV-DB2-COUNT-UNUSED-LABELS                    29720099
297300             FROM   TDISTHD A                                     29730099
297400             WHERE A.ORD_NBR            = :DK-PO-NBR              29740099
297500               AND A.RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR         29750099
297600               AND A.UCC128_DAT_USG_CDE IN ('I','N')              29760099
297700                                                                  29770099
297800         END-EXEC                                                 29780099
297900                                                                  29790099
298000         EVALUATE TRUE                                            29800099
298100             WHEN SQLCODE = ZERO                                  29810099
298200             WHEN SQLCODE = +100                                  29820099
298300             WHEN SQLCODE = -904                                  29830099
298400             WHEN SQLCODE = -913                                  29840099
298500                 CONTINUE                                         29850099
298600             WHEN SQLWARN0 NOT = SPACE                            29860099
298700             WHEN SQLCODE NOT = ZERO                              29870099
298800                  MOVE '4372-COUNT-PHYSICAL-LABELS'               29880099
298900                                   TO DP013-PARAGRAPH             29890099
299000                  MOVE 'COUNT PHYSICAL LABELS'                    29900099
299100                                   TO DP013-MESSAGE-TEXT (1)      29910099
299200                  MOVE SQLCA       TO DP013-SQLCA                 29920099
299300                  SET DP013-DB2-ABEND                             29930099
299400                                   TO TRUE                        29940099
299500                  PERFORM DP013-0000-PROCESS-ABEND                29950099
299600         END-EVALUATE                                             29960099
299700     END-PERFORM                                                  29970099
299800                                                                  29980099
299900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    29990099
300000         SQLCODE NOT = +0                                         30000099
300100         MOVE '4375-COUNT-UNUSED-LABELS'                          30010099
300200                                 TO DP013-PARAGRAPH               30020099
300300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30030099
300400                                 TO DP013-MESSAGE-TEXT (1)        30040099
300500         MOVE 'ON TDISTHD'       TO DP013-MESSAGE-TEXT (2)        30050099
300600         MOVE SQLCA              TO DP013-SQLCA                   30060099
300700         MOVE 'TDISTHD'          TO DP013-DB2-TABLE-NAME (1)      30070099
300800         SET DP013-DB2-ABEND     TO TRUE                          30080099
300900         SET DP013-XCTL-DISPLAY-RESTART                           30090099
301000                                 TO TRUE                          30100099
301100         PERFORM DP013-0000-PROCESS-ABEND                         30110099
301200     END-IF.                                                      30120099
301300/                                                                 30130099
301400*----------------------------------------------------------------*30140099
301500*    CHECK FOR PBS ERRORS                                        *30150099
301600*----------------------------------------------------------------*30160099
301700 4376-CHECK-FOR-PBS-ERRORS.                                       30170099
301800                                                                  30180099
301900     PERFORM                                                      30190099
302000         WITH TEST AFTER                                          30200099
302100         VARYING PV-RETRY-COUNTER                                 30210099
302200         FROM 1 BY 1                                              30220099
302300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30230099
302400            OR (SQLCODE = +0)                                     30240099
302500            OR (SQLCODE = +100))                                  30250099
302600                                                                  30260099
302700     EXEC SQL                                                     30270099
302800         SELECT  COUNT(*)                                         30280099
302900         INTO  :PV-DB2-COUNT-PBS-ERRORS                           30290099
303000         FROM   TPKSLIP A                                         30300099
303100               ,TINPKSU B                                         30310099
303200               ,TSHUNLO C                                         30320099
303300         WHERE A.PO_NBR       = :DK-PO-NBR                        30330099
303400           AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   30340099
303500           AND A.VER_STAT_CDE = 'A'                               30350099
303600           AND A.PO_NBR       = B.PO_NBR                          30360099
303700           AND A.SEQ_NBR      = B.SEQ_NBR                         30370099
303800           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    30380099
303900           AND C.SCN_LOC_ID IN                                    30390099
304000                 ('PBSA', 'PBSB', 'PBSC','PBSD','PBSE')           30400099
304100     END-EXEC                                                     30410099
304200                                                                  30420099
304300                                                                  30430099
304400     EVALUATE TRUE                                                30440099
304500         WHEN SQLCODE = ZERO                                      30450099
304600         WHEN SQLCODE = +100                                      30460099
304700              CONTINUE                                            30470099
304800         WHEN SQLWARN0 NOT = SPACE                                30480099
304900         WHEN SQLCODE NOT = ZERO                                  30490099
305000              MOVE '4376-CHECK-FOR-PBS-ERRORS'                    30500099
305100                               TO DP013-PARAGRAPH                 30510099
305200              MOVE 'CHECK FOR PBS ERRORS'                         30520099
305300                               TO DP013-MESSAGE-TEXT (1)          30530099
305400              MOVE SQLCA       TO DP013-SQLCA                     30540099
305500              SET DP013-DB2-ABEND                                 30550099
305600                               TO TRUE                            30560099
305700              PERFORM DP013-0000-PROCESS-ABEND                    30570099
305800      END-EVALUATE                                                30580099
305900     END-PERFORM.                                                 30590099
306000                                                                  30600099
306100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    30610099
306200         SQLCODE NOT = +0                                         30620099
306300         MOVE '4376-CHECK-FOR-PBS-ERRORS'                         30630099
306400                                 TO DP013-PARAGRAPH               30640099
306500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30650099
306600                                 TO DP013-MESSAGE-TEXT (1)        30660099
306700         MOVE 'ON TPKSLIP'       TO DP013-MESSAGE-TEXT (2)        30670099
306800         MOVE SQLCA              TO DP013-SQLCA                   30680099
306900         MOVE 'TPKSLIP'          TO DP013-DB2-TABLE-NAME (1)      30690099
307000         MOVE 'TINPKSU'          TO DP013-DB2-TABLE-NAME (2)      30700099
307100         MOVE 'TSHUNLO'          TO DP013-DB2-TABLE-NAME (3)      30710099
307200         SET DP013-DB2-ABEND     TO TRUE                          30720099
307300         SET DP013-XCTL-DISPLAY-RESTART                           30730099
307400                                 TO TRUE                          30740099
307500         PERFORM DP013-0000-PROCESS-ABEND                         30750099
307600     END-IF.                                                      30760099
307700/                                                                 30770099
307800*----------------------------------------------------------------*30780099
307900* CHECK IF TROUBLE NOTIFICATION EXISTS FOR THE PO #/RECV SEQ #.  *30790099
308000*----------------------------------------------------------------*30800099
308100 4380-CHECK-IF-IN-TROUBLE.                                        30810099
308200                                                                  30820099
308300     PERFORM                                                      30830099
308400         WITH TEST AFTER                                          30840099
308500         VARYING PV-RETRY-COUNTER                                 30850099
308600         FROM 1 BY 1                                              30860099
308700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30870099
308800            OR (SQLCODE = +0)                                     30880099
308900            OR (SQLCODE = +100))                                  30890099
309000                                                                  30900099
309100                                                                  30910099
309200         EXEC SQL                                                 30920099
309300              SELECT COUNT(*)                                     30930099
309400                INTO :PV-DB2-COUNT-TROUBLE                        30940099
309500                FROM TTRBNTF A                                    30950099
309600                    ,TTRBRSN B                                    30960099
309700               WHERE A.PO_NBR        = :DK-PO-NBR                 30970099
309800                 AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR            30980099
309900*                AND A.OPER_UNT_ID   =  :DK-OPER-UNT-ID           30990099
310000*                AND A.FCLTY_ID      =  :DK-FCLTY-ID              31000099
310100                 AND B.TRBL_RSN_CDE  =  A.TRBL_RSN_CDE            31010099
310200                 AND ((A.RESOLVED_IND    IN  ('N','I','R')        31020099
310300                 AND   B.NOTIF_IND        =  'T')                 31030099
310400                  OR   B.TRBL_RSN_CDE     =  803)                 31040099
310500         END-EXEC                                                 31050099
310600                                                                  31060099
310700         EVALUATE TRUE                                            31070099
310800             WHEN SQLCODE = +0                                    31080099
310900             WHEN SQLCODE = +100                                  31090099
311000             WHEN SQLCODE = -904                                  31100099
311100                 CONTINUE                                         31110099
311200             WHEN SQLCODE = -913                                  31120099
311300                 SET PS-TROUBLE-BUSY TO TRUE                      31130099
311400                                                                  31140099
311500             WHEN SQLWARN0 NOT = SPACES                           31150099
311600             WHEN SQLCODE < +0                                    31160099
311700             WHEN SQLCODE > +0                                    31170099
311800                  MOVE '4380-CHECK-IF-IN-TROUBLE'                 31180099
311900                                  TO DP013-PARAGRAPH              31190099
312000                  MOVE 'UNSUCCESSFUL SELECT TROUBLE COUNT'        31200099
312100                                  TO DP013-MESSAGE-TEXT (1)       31210099
312200                  MOVE SQLCA      TO DP013-SQLCA                  31220099
312300                  MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)     31230099
312400                  MOVE 'TTRBRSN ' TO DP013-DB2-TABLE-NAME (2)     31240099
312500                  SET DP013-DB2-ABEND                             31250099
312600                      DP013-XCTL-DISPLAY-RESTART                  31260099
312700                                  TO TRUE                         31270099
312800                  PERFORM DP013-0000-PROCESS-ABEND                31280099
312900         END-EVALUATE                                             31290099
313000     END-PERFORM.                                                 31300099
313100                                                                  31310099
313200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    31320099
313300         SQLCODE NOT = +0                                         31330099
313400         MOVE '4380-CHECK-IF-IN-TROUBLE'                          31340099
313500                                 TO DP013-PARAGRAPH               31350099
313600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     31360099
313700                                 TO DP013-MESSAGE-TEXT (1)        31370099
313800         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        31380099
313900         MOVE SQLCA              TO DP013-SQLCA                   31390099
314000         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      31400099
314100         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      31410099
314200         SET DP013-DB2-ABEND     TO TRUE                          31420099
314300         SET DP013-XCTL-DISPLAY-RESTART                           31430099
314400                                 TO TRUE                          31440099
314500         PERFORM DP013-0000-PROCESS-ABEND                         31450099
314600     END-IF.                                                      31460099
314700/                                                                 31470099
314800*----------------------------------------------------------------*31480099
314900*    GET SHIPMENT INFO                                           *31490099
315000*----------------------------------------------------------------*31500099
315100 4395-GET-SHIPMENT-INFO.                                          31510099
315200                                                                  31520099
315300     PERFORM                                                      31530099
315400         WITH TEST AFTER                                          31540099
315500         VARYING PV-RETRY-COUNTER                                 31550099
315600         FROM 1 BY 1                                              31560099
315700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31570099
315800            OR (SQLCODE = +0)                                     31580099
315900            OR (SQLCODE = +100)                                   31590099
316000            OR (SQLCODE = -811))                                  31600099
316100                                                                  31610099
316200         EXEC SQL                                                 31620099
316300            SELECT  COUNT(*)                                      31630099
316400              INTO :PV-DB2-COUNT-NO-PRO                           31640099
316500              FROM  TSHIPMT A                                     31650099
316600                   ,TSHPTPO B                                     31660099
316700          WHERE B.PO_NBR      = :DK-PO-NBR                        31670099
316800            AND B.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   31680099
316900            AND A.SHIPT_ID    = B.SHIPT_ID                        31690099
317000            AND A.PRO_NBR = ' '                                   31700099
317100         END-EXEC                                                 31710099
317200                                                                  31720099
317300         EVALUATE TRUE                                            31730099
317400             WHEN SQLCODE = +0                                    31740099
317500             WHEN SQLCODE = +100                                  31750099
317600             WHEN SQLCODE = -811                                  31760099
317700             WHEN SQLCODE = -904                                  31770099
317800             WHEN SQLCODE = -913                                  31780099
317900                 CONTINUE                                         31790099
318000                                                                  31800099
318100             WHEN SQLWARN0 NOT = SPACE                            31810099
318200             WHEN SQLCODE < +0                                    31820099
318300             WHEN SQLCODE > +0                                    31830099
318400                 MOVE '4395-GET-SHIPMENT-INFO'                    31840099
318500                                 TO DP013-PARAGRAPH               31850099
318600                 MOVE 'SELECT SHIPMENT INFO'                      31860099
318700                                 TO DP013-MESSAGE-TEXT (1)        31870099
318800                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   31880099
318900                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              31890099
319000                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      31900099
319100                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         31910099
319200                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    31920099
319300                 MOVE SQLCA      TO DP013-SQLCA                   31930099
319400                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      31940099
319500                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      31950099
319600                 SET DP013-DB2-ABEND                              31960099
319700                                 TO TRUE                          31970099
319800                 SET DP013-XCTL-DISPLAY-RESTART                   31980099
319900                                 TO TRUE                          31990099
320000                 PERFORM DP013-0000-PROCESS-ABEND                 32000099
320100         END-EVALUATE                                             32010099
320200     END-PERFORM.                                                 32020099
320300                                                                  32030099
320400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32040099
320500             AND (SQLCODE = -904 OR -913)                         32050099
320600         MOVE '4395-GET-SHIPMTNE-INFO'                            32060099
320700                                 TO DP013-PARAGRAPH               32070099
320800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     32080099
320900                                 TO DP013-MESSAGE-TEXT (1)        32090099
321000         MOVE 'SHIPMENT INFO'                                     32100099
321100                                 TO DP013-MESSAGE-TEXT (2)        32110099
321200         MOVE SQLCA              TO DP013-SQLCA                   32120099
321300         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      32130099
321400         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (2)      32140099
321500         SET DP013-DB2-ABEND     TO TRUE                          32150099
321600         SET DP013-XCTL-DISPLAY-RESTART                           32160099
321700                                 TO TRUE                          32170099
321800         PERFORM DP013-0000-PROCESS-ABEND                         32180099
321900     END-IF.                                                      32190099
322000                                                                  32200099
322100                                                                  32210099
322200*----------------------------------------------------------------*32220099
322300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *32230099
322400*----------------------------------------------------------------*32240099
322500                                                                  32250099
322600 4400-MOVE-COMMAREA-TO-SCREEN.                                    32260099
322700                                                                  32270099
322800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             32280099
322900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          32290099
323000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          32300099
323100             MOVE +1               TO ASC-BLK-SUB                 32310099
323200             PERFORM 5100-WRITE-TEMP-STORAGE                      32320099
323300             ADD +1                TO ASC-BLK-SUB                 32330099
323400             PERFORM 5100-WRITE-TEMP-STORAGE                      32340099
323500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             32350099
323600                 GIVING PV-BLOCK-NUMBER                           32360099
323700                 REMAINDER PV-REMAINDER                           32370099
323800             IF  PV-REMAINDER > ZERO                              32380099
323900                 ADD +1            TO PV-BLOCK-NUMBER             32390099
324000             END-IF                                               32400099
324100             MOVE +1               TO ASC-BLK-SUB                 32410099
324200             PERFORM 4410-READ-TEMP-STORAGE                       32420099
324300             ADD +1                TO ASC-BLK-SUB                 32430099
324400                                      PV-BLOCK-NUMBER             32440099
324500             PERFORM 4410-READ-TEMP-STORAGE                       32450099
324600     END-IF.                                                      32460099
324700                                                                  32470099
324800     MOVE +1                       TO ASC-BLK-SUB.                32480099
324900                                                                  32490099
325000     COMPUTE ASC-ITEM-SUB =                                       32500099
325100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32510099
325200         + PC-ITEMS-PER-PANEL).                                   32520099
325300                                                                  32530099
325400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32540099
325500         ADD +1                    TO ASC-BLK-SUB                 32550099
325600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32560099
325700     END-IF.                                                      32570099
325800                                                                  32580099
325900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32590099
326000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32600099
326100                                                                  32610099
326200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        32620099
326300     PERFORM 4420-FORMAT-LIST-LINES                               32630099
326400         VARYING PV-SUB                                           32640099
326500         FROM PC-ITEMS-PER-PANEL BY -1                            32650099
326600         UNTIL PV-SUB < +1.                                       32660099
326700                                                                  32670099
326800     COMPUTE ASC-ITEMS-DISPLAYED =                                32680099
326900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32690099
327000                                                                  32700099
327100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    32710099
327200                                      ASTRTITO.                   32720099
327300                                                                  32730099
327400     MOVE ASC-SCAC-ID              TO ASCACO.                     32740099
327500     MOVE ASC-VEH-NBR              TO ATRLRO.                     32750099
327600     MOVE ASC-TRIP-ID              TO ATRIPO.                     32760099
327700     MOVE ASC-TRLR-STATUS          TO ATRLSTO.                    32770099
327800     MOVE ASC-TOT-UNITS            TO ATLUNSO.                    32780099
327900                                                                  32790099
328000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    32800099
328100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    32810099
328200*    MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32820099
328300*                                  TO ASELITO.                    32830099
328400                                                                  32840099
328500     IF  DP020-MSG-NUMBER-X = SPACE                               32850099
328600         IF  PS-TROUBLE-BUSY                                      32860099
328700*            --- MORE ITEMS TO DISPLAY ----                       32870099
328800             MOVE PC-TSYMSG-01089  TO DP020-MSG-NUMBER            32880099
328900             SET DP020-MSG-INFORMATIONAL                          32890099
329000                                   TO TRUE                        32900099
329100         END-IF                                                   32910099
329200     IF  DP020-MSG-NUMBER-X = SPACE                               32920099
329300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32930099
329400*            --- MORE ITEMS TO DISPLAY ----                       32940099
329500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32950099
329600             SET DP020-MSG-INFORMATIONAL                          32960099
329700                                   TO TRUE                        32970099
329800         END-IF                                                   32980099
329900     END-IF.                                                      32990099
330000                                                                  33000099
330100*----------------------------------------------------------------*33010099
330200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *33020099
330300*----------------------------------------------------------------*33030099
330400                                                                  33040099
330500 4410-READ-TEMP-STORAGE.                                          33050099
330600                                                                  33060099
330700     EXEC CICS                                                    33070099
330800         READQ TS                                                 33080099
330900             QUEUE (ASC-LIST-QUEUE-NAME)                          33090099
331000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33100099
331100             ITEM  (PV-BLOCK-NUMBER)                              33110099
331200             RESP  (PV-CICS-RESP)                                 33120099
331300     END-EXEC.                                                    33130099
331400                                                                  33140099
331500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33150099
331600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33160099
331700         CONTINUE                                                 33170099
331800     ELSE                                                         33180099
331900         SET DP013-CICS-ABEND      TO TRUE                        33190099
332000         SET DP013-NO-ROLLBACK     TO TRUE                        33200099
332100         MOVE '4410-READ-TEMP-STORAGE'                            33210099
332200                                   TO DP013-PARAGRAPH             33220099
332300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33230099
332400                                   TO DP013-MESSAGE-TEXT(1)       33240099
332500         PERFORM DP013-0000-PROCESS-ABEND                         33250099
332600     END-IF.                                                      33260099
332700                                                                  33270099
332800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      33280099
332900                                   TO TRUE.                       33290099
333000                                                                  33300099
333100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33310099
333200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33320099
333300     END-IF.                                                      33330099
333400                                                                  33340099
333500/                                                                 33350099
333600*----------------------------------------------------------------*33360099
333700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33370099
333800*----------------------------------------------------------------*33380099
333900                                                                  33390099
334000 4420-FORMAT-LIST-LINES.                                          33400099
334100                                                                  33410099
334200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33420099
334300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33430099
334400         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         33440099
334500         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           33450099
334600         MOVE SPACE              TO MR-SELECT (PV-SUB)            33460099
334700                                    MR-MESSAGE (PV-SUB)           33470099
334800     ELSE                                                         33480099
334900         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33490099
335000                                                   > SPACE        33500099
335100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33510099
335200                                   TO MR-SELECT (PV-SUB)          33520099
335300         ELSE                                                     33530099
335400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33540099
335500                                   TO MR-SELECT (PV-SUB)          33550099
335600         END-IF                                                   33560099
335700                                                                  33570099
335800         IF  DP030-SET-CURSOR-TRAILER                             33580099
335900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33590099
336000                 > SPACE)                                         33600099
336100               OR (PV-SUB = 1))                                   33610099
336200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33620099
336300                MOVE -1            TO MR-SELECTL (PV-SUB)         33630099
336400             END-IF                                               33640099
336500         END-IF                                                   33650099
336600                                                                  33660099
336700         IF  ASC-VALID-LOCATION-NO                                33670099
336800             MOVE -1               TO ASTRTITL                    33680099
336900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  33690099
337000             MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)       33700099
337100             MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)       33710099
337200             MOVE SPACE              TO MR-SELECT (PV-SUB)        33720099
337300         END-IF                                                   33730099
337400                                                                  33740099
337500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           33750099
337600             MOVE ASC-MESSAGE     (ASC-BLK-SUB ASC-ITEM-SUB)      33760099
337700                                   TO MR-MESSAGE     (PV-SUB)     33770099
337800         END-IF                                                   33780099
337900     END-IF.                                                      33790099
338000                                                                  33800099
338100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               33810099
338200                                                                  33820099
338300     IF  ASC-ITEM-SUB < + 1                                       33830099
338400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                33840099
338500         MOVE +1                   TO ASC-BLK-SUB                 33850099
338600     END-IF.                                                      33860099
338700                                                                  33870099
338800*----------------------------------------------------------------*33880099
338900*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *33890099
339000*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *33900099
339100*  ISSUE A WARNING.                                              *33910099
339200*----------------------------------------------------------------*33920099
339300 4430-CHECK-FOR-BEGIN-AND-END.                                    33930099
339400                                                                  33940099
339500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       33950099
339600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     33960099
339700*            -- NO END-OF-RANGE SPECFIED ---                      33970099
339800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            33980099
339900             SET DP020-MSG-WARNING TO TRUE                        33990099
340000             PERFORM 4431-POSITION-AT-WARNING                     34000099
340100         END-IF                                                   34010099
340200     ELSE                                                         34020099
340300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34030099
340400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34040099
340500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34050099
340600             SET DP020-MSG-WARNING TO TRUE                        34060099
340700             PERFORM 4431-POSITION-AT-WARNING                     34070099
340800         END-IF                                                   34080099
340900     END-IF.                                                      34090099
341000                                                                  34100099
341100*----------------------------------------------------------------*34110099
341200*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *34120099
341300*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *34130099
341400*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *34140099
341500*  POSITION THE CURSOR THERE.                                    *34150099
341600*----------------------------------------------------------------*34160099
341700 4431-POSITION-AT-WARNING.                                        34170099
341800                                                                  34180099
341900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34190099
342000                    - PV-TOP-ITEM + 1.                            34200099
342100                                                                  34210099
342200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34220099
342300         CONTINUE                                                 34230099
342400     ELSE                                                         34240099
342500         SET DP030-SET-CURSOR-APPL-1                              34250099
342600                                   TO TRUE                        34260099
342700         MOVE -1                   TO MR-SELECTL (PV-SUB)         34270099
342800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34280099
342900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34290099
343000     END-IF.                                                      34300099
343100                                                                  34310099
343200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34320099
343300                    - PV-TOP-ITEM + 1.                            34330099
343400                                                                  34340099
343500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34350099
343600         CONTINUE                                                 34360099
343700     ELSE                                                         34370099
343800         SET DP030-SET-CURSOR-APPL-1                              34380099
343900                                   TO TRUE                        34390099
344000         MOVE -1                   TO MR-SELECTL (PV-SUB)         34400099
344100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34410099
344200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34420099
344300     END-IF.                                                      34430099
344400                                                                  34440099
344500/                                                                 34450099
344600*----------------------------------------------------------------*34460099
344700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34470099
344800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34480099
344900* FOR THE SELECTED ITEMS QUEUE.                                  *34490099
345000*                                                                *34500099
345100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34510099
345200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *34520099
345300* THE ARRAY IS FULL.                                             *34530099
345400*----------------------------------------------------------------*34540099
345500                                                                  34550099
345600 5000-PREPARE-SEL-QUEUE.                                          34560099
345700                                                                  34570099
345800     MOVE +1                       TO ASC-BLK-SUB.                34580099
345900     PERFORM 5100-WRITE-TEMP-STORAGE.                             34590099
346000     ADD +1                        TO ASC-BLK-SUB.                34600099
346100     PERFORM 5100-WRITE-TEMP-STORAGE.                             34610099
346200                                                                  34620099
346300     MOVE ASC-SEL-QUEUE-NAME       TO RC015-SEL-QUEUE-NAME.       34630099
346400     PERFORM 6010-DELETE-SEL-QUEUE.                               34640099
346500                                                                  34650099
346600     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      34660099
346700         SET ASC-UPDATE-TSQ        TO TRUE                        34670099
346800     END-IF.                                                      34680099
346900                                                                  34690099
347000     SET RC013-IDX                 TO 1.                          34700099
347100     MOVE ZERO                     TO RC015-NUMBER-OF-TS-ITEMS.   34710099
347200     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        34720099
347300                                                                  34730099
347400     EVALUATE TRUE                                                34740099
347500       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                34750099
347600               MOVE ASC-SEL-QUEUE-NAME TO RC815-SEL-QUEUE-NAME    34760099
347700                                                                  34770099
347800     END-EVALUATE.                                                34780099
347900                                                                  34790099
348000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           34800099
348100             VARYING PV-ITEM                                      34810099
348200             FROM 1 BY 1                                          34820099
348300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     34830099
348400                                                                  34840099
348500     IF  RC013-IDX > 1                                            34850099
348600         PERFORM 5205-WRITE-SEL-QUEUE                             34860099
348700         ADD +1                    TO RC015-NUMBER-OF-TS-ITEMS    34870099
348800     END-IF.                                                      34880099
348900                                                                  34890099
349000/                                                                 34900099
349100*----------------------------------------------------------------*34910099
349200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *34920099
349300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *34930099
349400*----------------------------------------------------------------*34940099
349500                                                                  34950099
349600 5100-WRITE-TEMP-STORAGE.                                         34960099
349700                                                                  34970099
349800     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     34980099
349900                                   TO PV-LIST-ITEM-NUMBER.        34990099
350000     COMPUTE PV-BLOCK-NUMBER =                                    35000099
350100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35010099
350200                                                                  35020099
350300     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35030099
350400     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35040099
350500         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35050099
350600             PERFORM 5105-REWRITE-ASC-LISTQ                       35060099
350700         END-IF                                                   35070099
350800     ELSE                                                         35080099
350900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35090099
351000         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35100099
351100         PERFORM 5110-WRITE-ASC-LISTQ                             35110099
351200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35120099
351300     END-IF.                                                      35130099
351400                                                                  35140099
351500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      35150099
351600                                   TO TRUE.                       35160099
351700                                                                  35170099
351800/                                                                 35180099
351900*----------------------------------------------------------------*35190099
352000*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *35200099
352100*  SPECIFIC COMMAREA.                                            *35210099
352200*----------------------------------------------------------------*35220099
352300 5105-REWRITE-ASC-LISTQ.                                          35230099
352400                                                                  35240099
352500     EXEC CICS                                                    35250099
352600         WRITEQ TS                                                35260099
352700             QUEUE (ASC-LIST-QUEUE-NAME)                          35270099
352800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35280099
352900             ITEM  (PV-BLOCK-NUMBER)                              35290099
353000             REWRITE                                              35300099
353100             RESP  (PV-CICS-RESP)                                 35310099
353200     END-EXEC.                                                    35320099
353300                                                                  35330099
353400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35340099
353500         CONTINUE                                                 35350099
353600     ELSE                                                         35360099
353700         SET DP013-CICS-ABEND      TO TRUE                        35370099
353800         SET DP013-NO-ROLLBACK     TO TRUE                        35380099
353900         MOVE '5105-REWRITE-ASC-LISTQ'                            35390099
354000                                   TO DP013-PARAGRAPH             35400099
354100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35410099
354200                                   TO DP013-MESSAGE-TEXT(1)       35420099
354300         PERFORM DP013-0000-PROCESS-ABEND                         35430099
354400     END-IF.                                                      35440099
354500                                                                  35450099
354600/                                                                 35460099
354700*----------------------------------------------------------------*35470099
354800*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *35480099
354900*  SPECIFIC COMMAREA.                                            *35490099
355000*----------------------------------------------------------------*35500099
355100 5110-WRITE-ASC-LISTQ.                                            35510099
355200                                                                  35520099
355300     EXEC CICS                                                    35530099
355400         WRITEQ TS                                                35540099
355500             QUEUE (ASC-LIST-QUEUE-NAME)                          35550099
355600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35560099
355700             ITEM  (PV-BLOCK-NUMBER)                              35570099
355800             RESP  (PV-CICS-RESP)                                 35580099
355900     END-EXEC.                                                    35590099
356000                                                                  35600099
356100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      35610099
356200         SET DP013-CICS-ABEND      TO TRUE                        35620099
356300         SET DP013-NO-ROLLBACK     TO TRUE                        35630099
356400         MOVE '5110-WRITE-ASC-LISTQ'                              35640099
356500                                   TO DP013-PARAGRAPH             35650099
356600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           35660099
356700                                   TO DP013-MESSAGE-TEXT(1)       35670099
356800         PERFORM DP013-0000-PROCESS-ABEND                         35680099
356900     END-IF.                                                      35690099
357000                                                                  35700099
357100/                                                                 35710099
357200*----------------------------------------------------------------*35720099
357300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *35730099
357400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *35740099
357500*----------------------------------------------------------------*35750099
357600                                                                  35760099
357700 5200-FILL-SEL-QUEUE-RECORD.                                      35770099
357800                                                                  35780099
357900     PERFORM 6112-READ-LIST-QUEUE.                                35790099
358000                                                                  35800099
358100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       35810099
358200         PERFORM                                                  35820099
358300         VARYING LQW-IDX                                          35830099
358400         FROM 1 BY 1                                              35840099
358500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            35850099
358600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          35860099
358700                                                                  35870099
358800             IF  LQW-SELECT (LQW-IDX)                             35880099
358900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              35890099
359000                                   TO RC013-ITEM (RC013-IDX)      35900099
359100                 SET RC013-IDX UP BY 1                            35910099
359200                 IF  RC013-IDX > RC013-MAX-ITEMS                  35920099
359300                     PERFORM 5205-WRITE-SEL-QUEUE                 35930099
359400                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    35940099
359500                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         35950099
359600                     SET RC013-IDX TO 1                           35960099
359700                 END-IF                                           35970099
359800             END-IF                                               35980099
359900         END-PERFORM                                              35990099
360000     END-IF.                                                      36000099
360100                                                                  36010099
360200/                                                                 36020099
360300*----------------------------------------------------------------*36030099
360400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *36040099
360500*----------------------------------------------------------------*36050099
360600                                                                  36060099
360700 5205-WRITE-SEL-QUEUE.                                            36070099
360800                                                                  36080099
360900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36090099
361000                                   TO RC013-SELECTED-ITEMS.       36100099
361100                                                                  36110099
361200     EXEC CICS                                                    36120099
361300          WRITEQ TS                                               36130099
361400              QUEUE (ASC-SEL-QUEUE-NAME)                          36140099
361500              FROM  (RC013-DC-SELECT-RECORD)                      36150099
361600              ITEM  (PV-SEL-QUEUE-ITEM)                           36160099
361700              RESP  (PV-CICS-RESP)                                36170099
361800     END-EXEC.                                                    36180099
361900                                                                  36190099
362000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36200099
362100         CONTINUE                                                 36210099
362200     ELSE                                                         36220099
362300         SET DP013-CICS-ABEND      TO TRUE                        36230099
362400         SET DP013-NO-ROLLBACK     TO TRUE                        36240099
362500         MOVE '5205-WRITE-SEL-QUEUE'                              36250099
362600                                   TO DP013-PARAGRAPH             36260099
362700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36270099
362800                                   TO DP013-MESSAGE-TEXT(1)       36280099
362900         PERFORM DP013-0000-PROCESS-ABEND                         36290099
363000     END-IF.                                                      36300099
363100                                                                  36310099
363200/                                                                 36320099
363300*----------------------------------------------------------------*36330099
363400*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *36340099
363500*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *36350099
363600*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *36360099
363700*  THE USER.                                                     *36370099
363800*----------------------------------------------------------------*36380099
363900 6000-REFRESH-PANEL-FROM-TEMP.                                    36390099
364000                                                                  36400099
364100     IF  ASC-UPDATE-TSQ                                           36410099
364200         SET ASC-NO-TSQ-UPDATE     TO TRUE                        36420099
364300         MOVE ZERO                 TO PV-SAVE-ITEM                36430099
364400                                      PV-SEL-QUEUE-ITEM           36440099
364500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36450099
364600                                   TO PV-HOLD-SELECTED-ITEMS      36460099
364700         PERFORM 6100-UPDATE-TSQ                                  36470099
364800             UNTIL PV-ITEMS-PROCESSED >                           36480099
364900                                     ASC-NUMBER-OF-SELECTED-ITEMS 36490099
365000         PERFORM 6010-DELETE-SEL-QUEUE                            36500099
365100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         36510099
365200                    ASC-BLOCK-ENTRIES (2)                         36520099
365300     END-IF.                                                      36530099
365400                                                                  36540099
365500/                                                                 36550099
365600*----------------------------------------------------------------*36560099
365700*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *36570099
365800*----------------------------------------------------------------*36580099
365900 6010-DELETE-SEL-QUEUE.                                           36590099
366000                                                                  36600099
366100     EXEC CICS                                                    36610099
366200         DELETEQ TS                                               36620099
366300             QUEUE (ASC-SEL-QUEUE-NAME)                           36630099
366400             RESP  (PV-CICS-RESP)                                 36640099
366500     END-EXEC.                                                    36650099
366600                                                                  36660099
366700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      36670099
366800         (PV-CICS-RESP = DFHRESP(QIDERR)))                        36680099
366900         CONTINUE                                                 36690099
367000     ELSE                                                         36700099
367100         SET DP013-CICS-ABEND      TO TRUE                        36710099
367200         SET DP013-NO-ROLLBACK     TO TRUE                        36720099
367300         MOVE '6010-DELETE-SEL-QUEUE'                             36730099
367400                                   TO DP013-PARAGRAPH             36740099
367500         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         36750099
367600                                   TO DP013-MESSAGE-TEXT (1)      36760099
367700         PERFORM DP013-0000-PROCESS-ABEND                         36770099
367800     END-IF.                                                      36780099
367900                                                                  36790099
368000/                                                                 36800099
368100*----------------------------------------------------------------*36810099
368200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *36820099
368300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *36830099
368400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *36840099
368500*    THE TEMP QUEUE.                                             *36850099
368600*----------------------------------------------------------------*36860099
368700                                                                  36870099
368800 6100-UPDATE-TSQ.                                                 36880099
368900                                                                  36890099
369000     ADD 1                         TO PV-SEL-QUEUE-ITEM.          36900099
369100     PERFORM 6105-READ-SEL-QUEUE.                                 36910099
369200                                                                  36920099
369300     PERFORM                                                      36930099
369400         VARYING RC013-IDX                                        36940099
369500         FROM 1 BY 1                                              36950099
369600         UNTIL ((PV-ITEMS-PROCESSED >                             36960099
369700                              PV-HOLD-SELECTED-ITEMS)             36970099
369800         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             36980099
369900         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  36990099
370000             PERFORM 6110-PROCESS-ITEMS                           37000099
370100         END-IF                                                   37010099
370200         ADD +1                    TO PV-ITEMS-PROCESSED          37020099
370300     END-PERFORM.                                                 37030099
370400                                                                  37040099
370500     PERFORM 6111-WRITE-LIST-QUEUE.                               37050099
370600                                                                  37060099
370700/                                                                 37070099
370800*----------------------------------------------------------------*37080099
370900*    READ THE LIST QUEUE RECORD.                                 *37090099
371000*----------------------------------------------------------------*37100099
371100                                                                  37110099
371200 6105-READ-SEL-QUEUE.                                             37120099
371300                                                                  37130099
371400     EXEC CICS                                                    37140099
371500          READQ TS                                                37150099
371600              QUEUE (ASC-SEL-QUEUE-NAME)                          37160099
371700              INTO  (RC013-DC-SELECT-RECORD)                      37170099
371800              ITEM  (PV-SEL-QUEUE-ITEM)                           37180099
371900              RESP  (PV-CICS-RESP)                                37190099
372000     END-EXEC.                                                    37200099
372100                                                                  37210099
372200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37220099
372300         CONTINUE                                                 37230099
372400     ELSE                                                         37240099
372500         SET DP013-CICS-ABEND      TO TRUE                        37250099
372600         SET DP013-NO-ROLLBACK     TO TRUE                        37260099
372700         MOVE '6105-READ-SEL-QUEUE'                               37270099
372800                                   TO DP013-PARAGRAPH             37280099
372900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37290099
373000                                   TO DP013-MESSAGE-TEXT(1)       37300099
373100         PERFORM DP013-0000-PROCESS-ABEND                         37310099
373200     END-IF.                                                      37320099
373300                                                                  37330099
373400/                                                                 37340099
373500*----------------------------------------------------------------*37350099
373600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*37360099
373700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*37370099
373800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *37380099
373900*----------------------------------------------------------------*37390099
374000                                                                  37400099
374100 6110-PROCESS-ITEMS.                                              37410099
374200                                                                  37420099
374300     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          37430099
374400                     / PC-ITEMS-PER-PANEL).                       37440099
374500                                                                  37450099
374600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           37460099
374700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          37470099
374800             PERFORM 6111-WRITE-LIST-QUEUE                        37480099
374900         END-IF                                                   37490099
375000         MOVE PV-ITEM              TO PV-SAVE-ITEM                37500099
375100                                                                  37510099
375200         PERFORM 6112-READ-LIST-QUEUE                             37520099
375300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               37530099
375400             CONTINUE                                             37540099
375500         END-IF                                                   37550099
375600     END-IF.                                                      37560099
375700                                                                  37570099
375800     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     37580099
375900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              37590099
376000                                                                  37600099
376100     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       37610099
376200     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        37620099
376300                                     (PV-SUB).                    37630099
376400                                                                  37640099
376500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                37650099
376600                                                                  37660099
376700/                                                                 37670099
376800*----------------------------------------------------------------*37680099
376900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *37690099
377000*----------------------------------------------------------------*37700099
377100                                                                  37710099
377200 6111-WRITE-LIST-QUEUE.                                           37720099
377300                                                                  37730099
377400     EXEC CICS                                                    37740099
377500         WRITEQ TS                                                37750099
377600             QUEUE (ASC-LIST-QUEUE-NAME)                          37760099
377700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     37770099
377800             ITEM  (PV-SAVE-ITEM)                                 37780099
377900             REWRITE                                              37790099
378000             RESP  (PV-CICS-RESP)                                 37800099
378100     END-EXEC.                                                    37810099
378200                                                                  37820099
378300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37830099
378400     OR  PV-CICS-RESP = DFHRESP (ITEMERR)                         37840099
378500         CONTINUE                                                 37850099
378600     ELSE                                                         37860099
378700         SET DP013-CICS-ABEND      TO TRUE                        37870099
378800         SET DP013-NO-ROLLBACK     TO TRUE                        37880099
378900         MOVE '6111-WRITE-LIST-QUEUE'                             37890099
379000                                   TO DP013-PARAGRAPH             37900099
379100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  37910099
379200                                   TO DP013-MESSAGE-TEXT(1)       37920099
379300         PERFORM DP013-0000-PROCESS-ABEND                         37930099
379400     END-IF.                                                      37940099
379500                                                                  37950099
379600/                                                                 37960099
379700*----------------------------------------------------------------*37970099
379800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*37980099
379900*----------------------------------------------------------------*37990099
380000                                                                  38000099
380100 6112-READ-LIST-QUEUE.                                            38010099
380200                                                                  38020099
380300     EXEC CICS                                                    38030099
380400         READQ TS                                                 38040099
380500             QUEUE (ASC-LIST-QUEUE-NAME)                          38050099
380600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     38060099
380700             ITEM  (PV-ITEM)                                      38070099
380800             RESP  (PV-CICS-RESP)                                 38080099
380900     END-EXEC.                                                    38090099
381000                                                                  38100099
381100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38110099
381200         CONTINUE                                                 38120099
381300     ELSE                                                         38130099
381400         SET DP013-CICS-ABEND      TO TRUE                        38140099
381500         SET DP013-NO-ROLLBACK     TO TRUE                        38150099
381600         MOVE '6112-READ-LIST-QUEUE'                              38160099
381700                                   TO DP013-PARAGRAPH             38170099
381800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    38180099
381900                                   TO DP013-MESSAGE-TEXT(1)       38190099
382000         PERFORM DP013-0000-PROCESS-ABEND                         38200099
382100     END-IF.                                                      38210099
382200                                                                  38220099
382300/                                                                 38230099
382400******************************************************************38240099
382500* UNLOAD PROCESSING                                               38250099
382600******************************************************************38260099
382700 8000-UPDATE-TRIP-SHIPMENT-STAT.                                  38270099
382800                                                                  38280099
382900     PERFORM 8005-UPDATE-TVEHICL.                                 38290099
383000     PERFORM 8030-AUDIT-TVEHICL.                                  38300099
383100     MOVE ASC-TRIP-ID    TO DK-TRIP-ID.                           38310099
383200     PERFORM 8010-SELECT-TTRIPST.                                 38320099
383300     MOVE 'UN'               TO TRIPST-TRIP-STATUS-CDE.           38330099
383400     PERFORM 8020-INSERT-TTRIPST.                                 38340099
383500                                                                  38350099
383600     IF  PS-NO-ERROR                                              38360099
383700         MOVE 'N'            TO PS-SHIPMENT-CURSOR-SW             38370099
383800         PERFORM 8100-OPEN-SHIPMENT-CSR                           38380099
383900         PERFORM 8102-FETCH-SHIPMENT-CSR                          38390099
384000         PERFORM UNTIL PS-NO-MORE-SHIPMENTS                       38400099
384100             MOVE SHIPMT-SHIPT-ID                                 38410099
384200                             TO DK-SHIPT-ID                       38420099
384300             PERFORM 8110-SELECT-TSHIPST                          38430099
384400             MOVE 'UN'       TO SHIPST-SHIPT-STATUS-CDE           38440099
384500             PERFORM 8120-INSERT-TSHIPST                          38450099
384600             PERFORM 8102-FETCH-SHIPMENT-CSR                      38460099
384700         END-PERFORM                                              38470099
384800         PERFORM 8104-CLOSE-SHIPMENT-CSR                          38480099
384900     END-IF.                                                      38490099
385000                                                                  38500099
385100                                                                  38510099
385200*----------------------------------------------------------------*38520099
385300*  UPDATE THE LOCATION AND STATUS OF THE VEHICLE                 *38530099
385400*----------------------------------------------------------------*38540099
385500 8005-UPDATE-TVEHICL.                                             38550099
385600                                                                  38560099
385700     MOVE 'UN'          TO VEHICL-CURR-STATUS-CDE                 38570099
385800     MOVE ASC-VEH-NBR   TO  DK-VEH-NBR                            38580099
385900     MOVE ASC-SCAC-ID   TO  DK-SCAC-ID                            38590099
386000                                                                  38600099
386100                                                                  38610099
386200     PERFORM                                                      38620099
386300         WITH TEST AFTER                                          38630099
386400         VARYING PV-RETRY-COUNTER                                 38640099
386500         FROM 1 BY 1                                              38650099
386600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38660099
386700             OR (SQLCODE = +0))                                   38670099
386800                                                                  38680099
386900         EXEC SQL                                                 38690099
387000           UPDATE TVEHICL                                         38700099
387100              SET LAST_UPD_DTE     = CURRENT DATE                 38710099
387200                 ,LAST_UPD_TME     = CURRENT TIME                 38720099
387300                 ,LAST_UPD_UID     = :DP020-USERID                38730099
387400                 ,CURR_STATUS_DTE  = CURRENT DATE                 38740099
387500                 ,CURR_STATUS_TME  = CURRENT TIME                 38750099
387600                 ,CURR_STATUS_CDE  = :VEHICL-CURR-STATUS-CDE      38760099
387700           WHERE  VEH_NBR       = :DK-VEH-NBR                     38770099
387800             AND  OWNER_SCAC_ID = :DK-SCAC-ID                     38780099
387900         END-EXEC                                                 38790099
388000                                                                  38800099
388100         EVALUATE TRUE                                            38810099
388200             WHEN SQLCODE = +0                                    38820099
388300             WHEN SQLCODE = -904                                  38830099
388400             WHEN SQLCODE = -913                                  38840099
388500                 CONTINUE                                         38850099
388600                                                                  38860099
388700             WHEN SQLWARN0 NOT = SPACES                           38870099
388800             WHEN SQLCODE < +0                                    38880099
388900             WHEN SQLCODE > +0                                    38890099
389000                 MOVE '8005-UPDATE-TVEHICL'                       38900099
389100                                   TO DP013-PARAGRAPH             38910099
389200                 MOVE 'UPDATE CURR INFO ON TVEHICL'               38920099
389300                                   TO DP013-MESSAGE-TEXT(1)       38930099
389400                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   38940099
389500                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              38950099
389600                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      38960099
389700                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         38970099
389800                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    38980099
389900                 MOVE SQLCA        TO DP013-SQLCA                 38990099
390000                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    39000099
390100                 SET DP013-DB2-ABEND                              39010099
390200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39020099
390300                 PERFORM DP013-0000-PROCESS-ABEND                 39030099
390400         END-EVALUATE                                             39040099
390500     END-PERFORM.                                                 39050099
390600                                                                  39060099
390700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39070099
390800         SQLCODE NOT = +0                                         39080099
390900         MOVE '8005-UPDATE-TVEHICL'                               39090099
391000                                   TO DP013-PARAGRAPH             39100099
391100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39110099
391200                                   TO DP013-MESSAGE-TEXT (1)      39120099
391300         MOVE 'TO UPDATE A TVEHICL ROW'                           39130099
391400                                   TO DP013-MESSAGE-TEXT (2)      39140099
391500         MOVE SQLCA                TO DP013-SQLCA                 39150099
391600         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    39160099
391700         SET DP013-DB2-ABEND                                      39170099
391800             DP013-XCTL-DISPLAY-RESTART                           39180099
391900                                   TO TRUE                        39190099
392000         PERFORM DP013-0000-PROCESS-ABEND                         39200099
392100     END-IF.                                                      39210099
392200                                                                  39220099
392300*----------------------------------------------------------------*39230099
392400*  SELECT CURRENT TRIP STATUS ROW                                *39240099
392500*----------------------------------------------------------------*39250099
392600 8010-SELECT-TTRIPST.                                             39260099
392700                                                                  39270099
392800     PERFORM                                                      39280099
392900         WITH TEST AFTER                                          39290099
393000         VARYING PV-RETRY-COUNTER                                 39300099
393100         FROM 1 BY 1                                              39310099
393200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39320099
393300             OR (SQLCODE = +0))                                   39330099
393400                                                                  39340099
393500         EXEC SQL                                                 39350099
393600             SELECT  A.TRIP_ID                                    39360099
393700                    ,A.TRIP_STATUS_CDE                            39370099
393800                    ,A.STATUS_DTE                                 39380099
393900                    ,A.STATUS_TME                                 39390099
394000                    ,A.STATUS_UID                                 39400099
394100                    ,A.OPER_UNT_ID                                39410099
394200                    ,A.FCLTY_ID                                   39420099
394300                    ,A.FCLTY_AREA_ID                              39430099
394400              INTO   :TRIPST-TRIP-ID                              39440099
394500                    ,:TRIPST-TRIP-STATUS-CDE                      39450099
394600                    ,:TRIPST-STATUS-DTE                           39460099
394700                    ,:TRIPST-STATUS-TME                           39470099
394800                    ,:TRIPST-STATUS-UID                           39480099
394900                    ,:TRIPST-OPER-UNT-ID                          39490099
395000                    ,:TRIPST-FCLTY-ID                             39500099
395100                    ,:TRIPST-FCLTY-AREA-ID                        39510099
395200              FROM  TTRIPST A                                     39520099
395300                   ,TTRSTYP B                                     39530099
395400             WHERE  A.TRIP_ID          = :DK-TRIP-ID              39540099
395500               AND  A.TRIP_STATUS_CDE ^= 'DE'                     39550099
395600               AND  B.PRTY_CDE =                                  39560099
395700                  (SELECT MAX(D.PRTY_CDE)                         39570099
395800                     FROM TTRIPST C                               39580099
395900                         ,TTRSTYP D                               39590099
396000                    WHERE C.TRIP_ID         = A.TRIP_ID           39600099
396100                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  39610099
396200               AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE         39620099
396300         END-EXEC                                                 39630099
396400                                                                  39640099
396500         EVALUATE TRUE                                            39650099
396600             WHEN SQLCODE = +0                                    39660099
396700             WHEN SQLCODE = -904                                  39670099
396800             WHEN SQLCODE = -913                                  39680099
396900                 CONTINUE                                         39690099
397000                                                                  39700099
397100             WHEN SQLWARN0 NOT = SPACES                           39710099
397200             WHEN SQLCODE < +0                                    39720099
397300             WHEN SQLCODE > +0                                    39730099
397400                 MOVE '8010-SELECT-TTRIPST'                       39740099
397500                                   TO DP013-PARAGRAPH             39750099
397600                 MOVE 'SELECT A ROW ON TTRIPST'                   39760099
397700                                   TO DP013-MESSAGE-TEXT(1)       39770099
397800                 MOVE SQLCA        TO DP013-SQLCA                 39780099
397900                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    39790099
398000                 MOVE DK-TRIP-ID   TO PV-DISPLAY-TRIP             39800099
398100                 STRING               DK-SCAC-ID '/'              39810099
398200                                      DK-VEH-NBR '/'              39820099
398300                                      PV-DISPLAY-TRIP '/'         39830099
398400                 DELIMITED BY SIZE                                39840099
398500                                 INTO DP013-MESSAGE-TEXT(2)       39850099
398600                 STRING                                           39860099
398700                                      DP020-STACK-TRAN-ID(1) '/'  39870099
398800                                      DP020-STACK-TRAN-ID(2) '/'  39880099
398900                                      DP020-STACK-TRAN-ID(3) '/'  39890099
399000                                      DP020-STACK-TRAN-ID(4) '/'  39900099
399100                                      DP020-STACK-TRAN-ID(5) '/'  39910099
399200                                      DP020-STACK-TRAN-ID(6) '/'  39920099
399300                                      DP020-STACK-TRAN-ID(7) '/'  39930099
399400                                      DP020-STACK-TRAN-ID(8) '/'  39940099
399500                                      DP020-STACK-TRAN-ID(9) '/'  39950099
399600                                      DP020-STACK-TRAN-ID(10)     39960099
399700                 DELIMITED BY SIZE                                39970099
399800                                 INTO DP013-MESSAGE-TEXT(3)       39980099
399900                 SET DP013-DB2-ABEND                              39990099
400000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40000099
400100                 PERFORM DP013-0000-PROCESS-ABEND                 40010099
400200         END-EVALUATE                                             40020099
400300     END-PERFORM.                                                 40030099
400400                                                                  40040099
400500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    40050099
400600         SQLCODE NOT = +0                                         40060099
400700         MOVE '8010-SELECT-TTRIPST'                               40070099
400800                                   TO DP013-PARAGRAPH             40080099
400900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              40090099
401000                                   TO DP013-MESSAGE-TEXT (1)      40100099
401100         MOVE 'TO SELECT A TTRIPST ROW'                           40110099
401200                                   TO DP013-MESSAGE-TEXT (2)      40120099
401300         MOVE SQLCA                TO DP013-SQLCA                 40130099
401400         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    40140099
401500         SET DP013-DB2-ABEND                                      40150099
401600             DP013-XCTL-DISPLAY-RESTART                           40160099
401700                                   TO TRUE                        40170099
401800         PERFORM DP013-0000-PROCESS-ABEND                         40180099
401900     END-IF.                                                      40190099
402000                                                                  40200099
402100                                                                  40210099
402200*----------------------------------------------------------------*40220099
402300*  INSERT A ROW ON THE VEHICLE TRIP STATUS TABLE                 *40230099
402400*----------------------------------------------------------------*40240099
402500 8020-INSERT-TTRIPST.                                             40250099
402600                                                                  40260099
402700     PERFORM                                                      40270099
402800         WITH TEST AFTER                                          40280099
402900         VARYING PV-RETRY-COUNTER                                 40290099
403000         FROM 1 BY 1                                              40300099
403100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40310099
403200             OR (SQLCODE = +0)                                    40320099
403300             OR (SQLCODE = -803))                                 40330099
403400                                                                  40340099
403500         EXEC SQL                                                 40350099
403600             INSERT  INTO TTRIPST                                 40360099
403700                    (TRIP_ID                                      40370099
403800                    ,TRIP_STATUS_CDE                              40380099
403900                    ,STATUS_DTE                                   40390099
404000                    ,STATUS_TME                                   40400099
404100                    ,STATUS_UID                                   40410099
404200                    ,OPER_UNT_ID                                  40420099
404300                    ,FCLTY_ID                                     40430099
404400                    ,FCLTY_AREA_ID)                               40440099
404500            VALUES  (:TRIPST-TRIP-ID                              40450099
404600                    ,:TRIPST-TRIP-STATUS-CDE                      40460099
404700                    ,CURRENT DATE                                 40470099
404800                    ,CURRENT TIME                                 40480099
404900                    ,:DP020-USERID                                40490099
405000                    ,:TRIPST-OPER-UNT-ID                          40500099
405100                    ,:TRIPST-FCLTY-ID                             40510099
405200                    ,:TRIPST-FCLTY-AREA-ID)                       40520099
405300         END-EXEC                                                 40530099
405400                                                                  40540099
405500         EVALUATE TRUE                                            40550099
405600             WHEN SQLCODE = +0                                    40560099
405700                 CONTINUE                                         40570099
405800                                                                  40580099
405900             WHEN SQLCODE = -803                                  40590099
406000                 SET PS-ERROR                                     40600099
406100                     DP020-MSG-INFORMATIONAL                      40610099
406200                                        TO TRUE                   40620099
406300                 MOVE PC-TSYMSG-00417   TO DP020-MSG-NUMBER       40630099
406400                 SET DP030-SET-CURSOR-TRAILER                     40640099
406500                                        TO TRUE                   40650099
406600                                                                  40660099
406700             WHEN SQLCODE = -904                                  40670099
406800             WHEN SQLCODE = -913                                  40680099
406900                 CONTINUE                                         40690099
407000                                                                  40700099
407100             WHEN SQLWARN0 NOT = SPACES                           40710099
407200             WHEN SQLCODE < +0                                    40720099
407300             WHEN SQLCODE > +0                                    40730099
407400                 MOVE '8020-INSERT-TTRIPST'                       40740099
407500                                   TO DP013-PARAGRAPH             40750099
407600                 MOVE 'INSERT A ROW ON TTRIPST'                   40760099
407700                                   TO DP013-MESSAGE-TEXT(1)       40770099
407800                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   40780099
407900                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              40790099
408000                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      40800099
408100                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         40810099
408200                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    40820099
408300                 MOVE SQLCA        TO DP013-SQLCA                 40830099
408400                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    40840099
408500                 SET DP013-DB2-ABEND                              40850099
408600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40860099
408700                 PERFORM DP013-0000-PROCESS-ABEND                 40870099
408800         END-EVALUATE                                             40880099
408900     END-PERFORM.                                                 40890099
409000                                                                  40900099
409100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    40910099
409200         SQLCODE NOT = +0                                         40920099
409300         MOVE '8020-INSERT-TTRIPST'                               40930099
409400                                   TO DP013-PARAGRAPH             40940099
409500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              40950099
409600                                   TO DP013-MESSAGE-TEXT (1)      40960099
409700         MOVE 'TO INSERT A TTRIPST ROW'                           40970099
409800                                   TO DP013-MESSAGE-TEXT (2)      40980099
409900         MOVE SQLCA                TO DP013-SQLCA                 40990099
410000         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    41000099
410100         SET DP013-DB2-ABEND                                      41010099
410200             DP013-XCTL-DISPLAY-RESTART                           41020099
410300                                   TO TRUE                        41030099
410400         PERFORM DP013-0000-PROCESS-ABEND                         41040099
410500     END-IF.                                                      41050099
410600                                                                  41060099
410700                                                                  41070099
410800*----------------------------------------------------------------*41080099
410900*  TAKE A SNAPSHOT OF THE BEFORE IMAGE OF TVEHICL AND WRITE      *41090099
411000*  TO THE AUDIT TABLE.                                           *41100099
411100*----------------------------------------------------------------*41110099
411200 8030-AUDIT-TVEHICL.                                              41120099
411300                                                                  41130099
411400     INITIALIZE DCLTAUVHCL.                                       41140099
411500                                                                  41150099
411600     PERFORM                                                      41160099
411700         WITH TEST AFTER                                          41170099
411800         VARYING PV-RETRY-COUNTER                                 41180099
411900         FROM 1 BY 1                                              41190099
412000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41200099
412100             OR (SQLCODE = +0))                                   41210099
412200                                                                  41220099
412300         EXEC SQL                                                 41230099
412400             SELECT  OWNER_SCAC_ID                                41240099
412500                    ,VEH_NBR                                      41250099
412600                    ,CRT_SRC_CDE                                  41260099
412700                    ,LAST_UPD_DTE                                 41270099
412800                    ,LAST_UPD_TME                                 41280099
412900                    ,LAST_UPD_UID                                 41290099
413000                    ,USAGE_CDE                                    41300099
413100                    ,VEH_TYP_CDE                                  41310099
413200                    ,CURR_STATUS_CDE                              41320099
413300                    ,CURR_STATUS_DTE                              41330099
413400                    ,CURR_STATUS_TME                              41340099
413500                    ,CURR_OPER_UNT_ID                             41350099
413600                    ,CURR_FCLTY_ID                                41360099
413700                    ,CURR_FAC_AREA_ID                             41370099
413800                    ,CURR_LOC_DTE                                 41380099
413900                    ,CURR_LOC_TME                                 41390099
414000                    ,CURR_TRIP_ID                                 41400099
414100                    ,VEH_SIZE_CDE                                 41410099
414200            INTO     :VEHICL-OWNER-SCAC-ID                        41420099
414300                    ,:VEHICL-VEH-NBR                              41430099
414400                    ,:VEHICL-CRT-SRC-CDE                          41440099
414500                    ,:VEHICL-LAST-UPD-DTE                         41450099
414600                    ,:VEHICL-LAST-UPD-TME                         41460099
414700                    ,:VEHICL-LAST-UPD-UID                         41470099
414800                    ,:VEHICL-USAGE-CDE                            41480099
414900                    ,:VEHICL-VEH-TYP-CDE                          41490099
415000                    ,:VEHICL-CURR-STATUS-CDE                      41500099
415100                    ,:VEHICL-CURR-STATUS-DTE                      41510099
415200                    ,:VEHICL-CURR-STATUS-TME                      41520099
415300                    ,:VEHICL-CURR-OPER-UNT-ID                     41530099
415400                    ,:VEHICL-CURR-FCLTY-ID                        41540099
415500                    ,:VEHICL-CURR-FAC-AREA-ID                     41550099
415600                    ,:VEHICL-CURR-LOC-DTE                         41560099
415700                    ,:VEHICL-CURR-LOC-TME                         41570099
415800                    ,:VEHICL-CURR-TRIP-ID                         41580099
415900                       :DN-CURR-TRIP-ID                           41590099
416000                    ,:VEHICL-VEH-SIZE-CDE                         41600099
416100           FROM   TVEHICL                                         41610099
416200           WHERE  VEH_NBR       = :DK-VEH-NBR                     41620099
416300             AND  OWNER_SCAC_ID = :DK-SCAC-ID                     41630099
416400         END-EXEC                                                 41640099
416500                                                                  41650099
416600         EVALUATE TRUE                                            41660099
416700             WHEN SQLCODE = +0                                    41670099
416800             WHEN SQLCODE = -904                                  41680099
416900             WHEN SQLCODE = -913                                  41690099
417000                 CONTINUE                                         41700099
417100                                                                  41710099
417200             WHEN SQLWARN0 NOT = SPACES                           41720099
417300             WHEN SQLCODE < +0                                    41730099
417400             WHEN SQLCODE > +0                                    41740099
417500                 MOVE '8030-AUDIT-TVEHICL'                        41750099
417600                                   TO DP013-PARAGRAPH             41760099
417700                 MOVE 'SELECT A TVEHICL ROW   '                   41770099
417800                                   TO DP013-MESSAGE-TEXT(1)       41780099
417900                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   41790099
418000                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              41800099
418100                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      41810099
418200                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         41820099
418300                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    41830099
418400                 MOVE SQLCA        TO DP013-SQLCA                 41840099
418500                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    41850099
418600                 SET DP013-DB2-ABEND                              41860099
418700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41870099
418800                 PERFORM DP013-0000-PROCESS-ABEND                 41880099
418900         END-EVALUATE                                             41890099
419000     END-PERFORM.                                                 41900099
419100                                                                  41910099
419200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    41920099
419300         SQLCODE NOT = +0                                         41930099
419400         MOVE '8030-AUDIT-TVEHICL '                               41940099
419500                                   TO DP013-PARAGRAPH             41950099
419600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              41960099
419700                                   TO DP013-MESSAGE-TEXT (1)      41970099
419800         MOVE 'TO SELECT A TVEHICL ROW'                           41980099
419900                                   TO DP013-MESSAGE-TEXT (2)      41990099
420000         MOVE SQLCA                TO DP013-SQLCA                 42000099
420100         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    42010099
420200         SET DP013-DB2-ABEND                                      42020099
420300             DP013-XCTL-DISPLAY-RESTART                           42030099
420400                                   TO TRUE                        42040099
420500         PERFORM DP013-0000-PROCESS-ABEND                         42050099
420600     END-IF.                                                      42060099
420700                                                                  42070099
420800     PERFORM                                                      42080099
420900         WITH TEST AFTER                                          42090099
421000         VARYING PV-RETRY-COUNTER                                 42100099
421100         FROM 1 BY 1                                              42110099
421200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42120099
421300             OR (SQLCODE = +0))                                   42130099
421400                                                                  42140099
421500         EXEC SQL                                                 42150099
421600             INSERT  INTO TAUVHCL                                 42160099
421700                    (OWNER_SCAC_ID                                42170099
421800                    ,VEH_NBR                                      42180099
421900                    ,CRT_SRC_CDE                                  42190099
422000                    ,LAST_UPD_DTE                                 42200099
422100                    ,LAST_UPD_TME                                 42210099
422200                    ,LAST_UPD_UID                                 42220099
422300                    ,USAGE_CDE                                    42230099
422400                    ,VEH_TYP_CDE                                  42240099
422500                    ,CURR_STATUS_CDE                              42250099
422600                    ,CURR_STATUS_DTE                              42260099
422700                    ,CURR_STATUS_TME                              42270099
422800                    ,CURR_OPER_UNT_ID                             42280099
422900                    ,CURR_FCLTY_ID                                42290099
423000                    ,CURR_FAC_AREA_ID                             42300099
423100                    ,CURR_LOC_DTE                                 42310099
423200                    ,CURR_LOC_TME                                 42320099
423300                    ,CURR_TRIP_ID                                 42330099
423400                    ,VEH_SIZE_CDE)                                42340099
423500            VALUES  (:VEHICL-OWNER-SCAC-ID                        42350099
423600                    ,:VEHICL-VEH-NBR                              42360099
423700                    ,:VEHICL-CRT-SRC-CDE                          42370099
423800                    ,:VEHICL-LAST-UPD-DTE                         42380099
423900                    ,:VEHICL-LAST-UPD-TME                         42390099
424000                    ,:VEHICL-LAST-UPD-UID                         42400099
424100                    ,:VEHICL-USAGE-CDE                            42410099
424200                    ,:VEHICL-VEH-TYP-CDE                          42420099
424300                    ,:VEHICL-CURR-STATUS-CDE                      42430099
424400                    ,:VEHICL-CURR-STATUS-DTE                      42440099
424500                    ,:VEHICL-CURR-STATUS-TME                      42450099
424600                    ,:VEHICL-CURR-OPER-UNT-ID                     42460099
424700                    ,:VEHICL-CURR-FCLTY-ID                        42470099
424800                    ,:VEHICL-CURR-FAC-AREA-ID                     42480099
424900                    ,:VEHICL-CURR-LOC-DTE                         42490099
425000                    ,:VEHICL-CURR-LOC-TME                         42500099
425100                    ,:VEHICL-CURR-TRIP-ID                         42510099
425200                       :DN-CURR-TRIP-ID                           42520099
425300                    ,:VEHICL-VEH-SIZE-CDE)                        42530099
425400         END-EXEC                                                 42540099
425500                                                                  42550099
425600         EVALUATE TRUE                                            42560099
425700             WHEN SQLCODE = +0                                    42570099
425800             WHEN SQLCODE = -904                                  42580099
425900             WHEN SQLCODE = -913                                  42590099
426000                 CONTINUE                                         42600099
426100                                                                  42610099
426200             WHEN SQLWARN0 NOT = SPACES                           42620099
426300             WHEN SQLCODE < +0                                    42630099
426400             WHEN SQLCODE > +0                                    42640099
426500                 MOVE '8030-AUDIT-TVEHICL '                       42650099
426600                                   TO DP013-PARAGRAPH             42660099
426700                 MOVE 'INSERT A ROW ON TAUVHCL'                   42670099
426800                                   TO DP013-MESSAGE-TEXT(1)       42680099
426900                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   42690099
427000                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              42700099
427100                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      42710099
427200                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         42720099
427300                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    42730099
427400                 MOVE SQLCA        TO DP013-SQLCA                 42740099
427500                 MOVE 'TAUVHCL'    TO DP013-DB2-TABLE-NAME (1)    42750099
427600                 SET DP013-DB2-ABEND                              42760099
427700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42770099
427800                 PERFORM DP013-0000-PROCESS-ABEND                 42780099
427900         END-EVALUATE                                             42790099
428000     END-PERFORM.                                                 42800099
428100                                                                  42810099
428200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42820099
428300         SQLCODE NOT = +0                                         42830099
428400         MOVE '8030-AUDIT-TAUVHCL'                                42840099
428500                                   TO DP013-PARAGRAPH             42850099
428600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42860099
428700                                   TO DP013-MESSAGE-TEXT (1)      42870099
428800         MOVE 'TO INSERT A TAUVHCL ROW'                           42880099
428900                                   TO DP013-MESSAGE-TEXT (2)      42890099
429000         MOVE SQLCA                TO DP013-SQLCA                 42900099
429100         MOVE 'TAUVHCL'            TO DP013-DB2-TABLE-NAME (1)    42910099
429200         SET DP013-DB2-ABEND                                      42920099
429300             DP013-XCTL-DISPLAY-RESTART                           42930099
429400                                   TO TRUE                        42940099
429500         PERFORM DP013-0000-PROCESS-ABEND                         42950099
429600     END-IF.                                                      42960099
429700                                                                  42970099
429800                                                                  42980099
429900*----------------------------------------------------------------*42990099
430000* OPEN THE SHIPMENT CURSROR                                      *43000099
430100*----------------------------------------------------------------*43010099
430200                                                                  43020099
430300 8100-OPEN-SHIPMENT-CSR.                                          43030099
430400                                                                  43040099
430500     PERFORM                                                      43050099
430600         WITH TEST AFTER                                          43060099
430700         VARYING PV-RETRY-COUNTER                                 43070099
430800         FROM 1 BY 1                                              43080099
430900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43090099
431000            OR (SQLCODE = +0))                                    43100099
431100                                                                  43110099
431200         EXEC SQL                                                 43120099
431300              OPEN SHIPMENT-CSR                                   43130099
431400         END-EXEC                                                 43140099
431500                                                                  43150099
431600         EVALUATE TRUE                                            43160099
431700             WHEN SQLCODE = +0                                    43170099
431800                  CONTINUE                                        43180099
431900             WHEN SQLCODE = -904                                  43190099
432000             WHEN SQLCODE = -913                                  43200099
432100                  CONTINUE                                        43210099
432200             WHEN SQLWARN0 NOT = SPACE                            43220099
432300             WHEN SQLCODE  NOT = +0                               43230099
432400                  MOVE '8100-OPEN-SHIPMENT-CSR'                   43240099
432500                                   TO DP013-PARAGRAPH             43250099
432600                  MOVE 'OPEN SHIPMENT CURSOR'                     43260099
432700                                   TO DP013-MESSAGE-TEXT (1)      43270099
432800                  MOVE DK-PO-NBR  TO PV-ERROR-PO                  43280099
432900                  MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ             43290099
433000                  MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID     43300099
433100                  MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID        43310099
433200                  MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)   43320099
433300                  MOVE SQLCA       TO DP013-SQLCA                 43330099
433400                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    43340099
433500                  SET DP013-DB2-ABEND                             43350099
433600                                   TO TRUE                        43360099
433700                  PERFORM DP013-0000-PROCESS-ABEND                43370099
433800         END-EVALUATE                                             43380099
433900     END-PERFORM.                                                 43390099
434000                                                                  43400099
434100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43410099
434200         SQLCODE NOT = +0                                         43420099
434300         MOVE '8100-OPEN-SHIPMENT-CSR'                            43430099
434400                                   TO DP013-PARAGRAPH             43440099
434500         MOVE 'MAX RETRIES EXCEEDED FOR OPEN SHIPMENT CURSOR'     43450099
434600                                   TO DP013-MESSAGE-TEXT (1)      43460099
434700         MOVE SQLCA                TO DP013-SQLCA                 43470099
434800         SET DP013-DB2-ABEND       TO TRUE                        43480099
434900         PERFORM DP013-0000-PROCESS-ABEND                         43490099
435000     END-IF.                                                      43500099
435100                                                                  43510099
435200                                                                  43520099
435300*----------------------------------------------------------------*43530099
435400*    FETCH A SHIPMENT ROW                                        *43540099
435500*----------------------------------------------------------------*43550099
435600                                                                  43560099
435700 8102-FETCH-SHIPMENT-CSR.                                         43570099
435800                                                                  43580099
435900     EXEC SQL                                                     43590099
436000          FETCH SHIPMENT-CSR                                      43600099
436100          INTO :SHIPMT-SHIPT-ID                                   43610099
436200     END-EXEC                                                     43620099
436300                                                                  43630099
436400     EVALUATE TRUE                                                43640099
436500         WHEN SQLCODE = +0                                        43650099
436600              CONTINUE                                            43660099
436700                                                                  43670099
436800         WHEN SQLCODE = +100                                      43680099
436900              SET PS-NO-MORE-SHIPMENTS TO TRUE                    43690099
437000                                                                  43700099
437100         WHEN SQLWARN0 NOT = SPACE                                43710099
437200         WHEN SQLCODE < +0                                        43720099
437300         WHEN SQLCODE > +0                                        43730099
437400              MOVE '8102-FETCH-SHIPMENT-CSR'                      43740099
437500                                   TO DP013-PARAGRAPH             43750099
437600              MOVE 'FETCH SHIPMENT CURSOR'                        43760099
437700                                   TO DP013-MESSAGE-TEXT (1)      43770099
437800              MOVE DK-PO-NBR  TO PV-ERROR-PO                      43780099
437900              MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ                 43790099
438000              MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID         43800099
438100              MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID            43810099
438200              MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)       43820099
438300              MOVE SQLCA           TO DP013-SQLCA                 43830099
438400              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (1)    43840099
438500              SET DP013-DB2-ABEND  TO TRUE                        43850099
438600              PERFORM DP013-0000-PROCESS-ABEND                    43860099
438700     END-EVALUATE.                                                43870099
438800                                                                  43880099
438900                                                                  43890099
439000*----------------------------------------------------------------*43900099
439100* CLOSE THE SHIPMENT CURSOR                                      *43910099
439200*----------------------------------------------------------------*43920099
439300                                                                  43930099
439400 8104-CLOSE-SHIPMENT-CSR.                                         43940099
439500                                                                  43950099
439600     EXEC SQL                                                     43960099
439700          CLOSE SHIPMENT-CSR                                      43970099
439800     END-EXEC                                                     43980099
439900                                                                  43990099
440000     EVALUATE TRUE                                                44000099
440100         WHEN SQLCODE = +0                                        44010099
440200              CONTINUE                                            44020099
440300         WHEN SQLWARN0 NOT = SPACE                                44030099
440400         WHEN SQLCODE  NOT = +0                                   44040099
440500              MOVE '8104-CLOSE-SHIPMENT-CSR'                      44050099
440600                                   TO DP013-PARAGRAPH             44060099
440700              MOVE 'CLOSE SHIPMENT CURSOR'                        44070099
440800                                   TO DP013-MESSAGE-TEXT (1)      44080099
440900              MOVE SQLCA           TO DP013-SQLCA                 44090099
441000              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (1)    44100099
441100              SET DP013-DB2-ABEND  TO TRUE                        44110099
441200              PERFORM DP013-0000-PROCESS-ABEND                    44120099
441300     END-EVALUATE.                                                44130099
441400                                                                  44140099
441500                                                                  44150099
441600*----------------------------------------------------------------*44160099
441700*  SELECT LATEST SHIPMENT STATUS ROW                             *44170099
441800*----------------------------------------------------------------*44180099
441900 8110-SELECT-TSHIPST.                                             44190099
442000                                                                  44200099
442100     PERFORM                                                      44210099
442200         WITH TEST AFTER                                          44220099
442300         VARYING PV-RETRY-COUNTER                                 44230099
442400         FROM 1 BY 1                                              44240099
442500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44250099
442600             OR (SQLCODE = +0))                                   44260099
442700                                                                  44270099
442800         EXEC SQL                                                 44280099
442900             SELECT  A.SHIPT_ID                                   44290099
443000                    ,A.SHIPT_STATUS_CDE                           44300099
443100                    ,A.STATUS_DTE                                 44310099
443200                    ,A.STATUS_TME                                 44320099
443300                    ,A.STATUS_UID                                 44330099
443400                    ,A.DELAY_RSN_CDE                              44340099
443500                    ,A.CARR_STATUS_CDE                            44350099
443600                    ,A.TIME_ZONE_CDE                              44360099
443700                    ,A.CITY_NAME                                  44370099
443800                    ,A.STATE_CDE                                  44380099
443900             INTO    :SHIPST-SHIPT-ID                             44390099
444000                    ,:SHIPST-SHIPT-STATUS-CDE                     44400099
444100                    ,:SHIPST-STATUS-DTE                           44410099
444200                    ,:SHIPST-STATUS-TME                           44420099
444300                    ,:SHIPST-STATUS-UID                           44430099
444400                    ,:SHIPST-DELAY-RSN-CDE                        44440099
444500                    ,:SHIPST-CARR-STATUS-CDE                      44450099
444600                    ,:SHIPST-TIME-ZONE-CDE                        44460099
444700                    ,:SHIPST-CITY-NAME                            44470099
444800                    ,:SHIPST-STATE-CDE                            44480099
444900           FROM   TSHIPST A                                       44490099
445000                 ,TSHSTYP B                                       44500099
445100           WHERE  A.SHIPT_ID = :DK-SHIPT-ID                       44510099
445200             AND  B.PRTY_CDE =                                    44520099
445300                  (SELECT MAX(D.PRTY_CDE)                         44530099
445400                     FROM TSHIPST C                               44540099
445500                         ,TSHSTYP D                               44550099
445600                    WHERE C.SHIPT_ID         = A.SHIPT_ID         44560099
445700                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)44570099
445800             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         44580099
445900         END-EXEC                                                 44590099
446000                                                                  44600099
446100         EVALUATE TRUE                                            44610099
446200             WHEN SQLCODE = +0                                    44620099
446300             WHEN SQLCODE = -904                                  44630099
446400             WHEN SQLCODE = -913                                  44640099
446500                 CONTINUE                                         44650099
446600                                                                  44660099
446700             WHEN SQLWARN0 NOT = SPACES                           44670099
446800             WHEN SQLCODE < +0                                    44680099
446900             WHEN SQLCODE > +0                                    44690099
447000                 MOVE '8110-SELECT-TSHIPST'                       44700099
447100                                   TO DP013-PARAGRAPH             44710099
447200                 MOVE 'SELECT A TSHIPST ROW   '                   44720099
447300                                   TO DP013-MESSAGE-TEXT(1)       44730099
447400                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   44740099
447500                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              44750099
447600                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      44760099
447700                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         44770099
447800                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    44780099
447900                 MOVE SQLCA        TO DP013-SQLCA                 44790099
448000                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    44800099
448100                 SET DP013-DB2-ABEND                              44810099
448200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44820099
448300                 PERFORM DP013-0000-PROCESS-ABEND                 44830099
448400         END-EVALUATE                                             44840099
448500     END-PERFORM.                                                 44850099
448600                                                                  44860099
448700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44870099
448800         SQLCODE NOT = +0                                         44880099
448900         MOVE '8110-SELECT-TSHIPST'                               44890099
449000                                   TO DP013-PARAGRAPH             44900099
449100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              44910099
449200                                   TO DP013-MESSAGE-TEXT (1)      44920099
449300         MOVE 'TO SELECT A TSHIPST ROW'                           44930099
449400                                   TO DP013-MESSAGE-TEXT (2)      44940099
449500         MOVE SQLCA                TO DP013-SQLCA                 44950099
449600         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    44960099
449700         SET DP013-DB2-ABEND                                      44970099
449800             DP013-XCTL-DISPLAY-RESTART                           44980099
449900                                   TO TRUE                        44990099
450000         PERFORM DP013-0000-PROCESS-ABEND                         45000099
450100     END-IF.                                                      45010099
450200                                                                  45020099
450300                                                                  45030099
450400*----------------------------------------------------------------*45040099
450500*  INSERT A SHIPMENT STATUS ROW                                  *45050099
450600*----------------------------------------------------------------*45060099
450700 8120-INSERT-TSHIPST.                                             45070099
450800                                                                  45080099
450900     PERFORM                                                      45090099
451000         WITH TEST AFTER                                          45100099
451100         VARYING PV-RETRY-COUNTER                                 45110099
451200         FROM 1 BY 1                                              45120099
451300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45130099
451400             OR (SQLCODE = +0))                                   45140099
451500                                                                  45150099
451600         EXEC SQL                                                 45160099
451700             INSERT  INTO TSHIPST                                 45170099
451800                    (SHIPT_ID                                     45180099
451900                    ,SHIPT_STATUS_CDE                             45190099
452000                    ,STATUS_DTE                                   45200099
452100                    ,STATUS_TME                                   45210099
452200                    ,STATUS_UID                                   45220099
452300                    ,DELAY_RSN_CDE                                45230099
452400                    ,CARR_STATUS_CDE                              45240099
452500                    ,TIME_ZONE_CDE                                45250099
452600                    ,CITY_NAME                                    45260099
452700                    ,STATE_CDE )                                  45270099
452800            VALUES  (:SHIPST-SHIPT-ID                             45280099
452900                    ,:SHIPST-SHIPT-STATUS-CDE                     45290099
453000                    ,CURRENT DATE                                 45300099
453100                    ,CURRENT TIME                                 45310099
453200                    ,:DP020-USERID                                45320099
453300                    ,:SHIPST-DELAY-RSN-CDE                        45330099
453400                    ,:SHIPST-CARR-STATUS-CDE                      45340099
453500                    ,:SHIPST-TIME-ZONE-CDE                        45350099
453600                    ,:SHIPST-CITY-NAME                            45360099
453700                    ,:SHIPST-STATE-CDE )                          45370099
453800         END-EXEC                                                 45380099
453900                                                                  45390099
454000         EVALUATE TRUE                                            45400099
454100             WHEN SQLCODE = +0                                    45410099
454200             WHEN SQLCODE = -904                                  45420099
454300             WHEN SQLCODE = -913                                  45430099
454400                 CONTINUE                                         45440099
454500                                                                  45450099
454600             WHEN SQLWARN0 NOT = SPACES                           45460099
454700             WHEN SQLCODE < +0                                    45470099
454800             WHEN SQLCODE > +0                                    45480099
454900                 MOVE '8120-INSERT-TSHIPST'                       45490099
455000                                   TO DP013-PARAGRAPH             45500099
455100                 MOVE 'INSERT A ROW ON TSHIPST'                   45510099
455200                                   TO DP013-MESSAGE-TEXT(1)       45520099
455300                 MOVE DK-PO-NBR  TO PV-ERROR-PO                   45530099
455400                 MOVE DK-REC-SEQ-NBR TO PV-ERROR-SEQ              45540099
455500                 MOVE DK-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID      45550099
455600                 MOVE DK-FCLTY-ID    TO PV-ERROR-FCLTY-ID         45560099
455700                 MOVE PV-ERROR-MSG   TO DP013-MESSAGE-TEXT (2)    45570099
455800                 MOVE SQLCA        TO DP013-SQLCA                 45580099
455900                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    45590099
456000                 SET DP013-DB2-ABEND                              45600099
456100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           45610099
456200                 PERFORM DP013-0000-PROCESS-ABEND                 45620099
456300         END-EVALUATE                                             45630099
456400     END-PERFORM.                                                 45640099
456500                                                                  45650099
456600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45660099
456700         SQLCODE NOT = +0                                         45670099
456800         MOVE '8120-INSERT-TSHIPST'                               45680099
456900                                   TO DP013-PARAGRAPH             45690099
457000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              45700099
457100                                   TO DP013-MESSAGE-TEXT (1)      45710099
457200         MOVE 'TO INSERT A TSHIPST ROW'                           45720099
457300                                   TO DP013-MESSAGE-TEXT (2)      45730099
457400         MOVE SQLCA                TO DP013-SQLCA                 45740099
457500         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    45750099
457600         SET DP013-DB2-ABEND                                      45760099
457700             DP013-XCTL-DISPLAY-RESTART                           45770099
457800                                   TO TRUE                        45780099
457900         PERFORM DP013-0000-PROCESS-ABEND                         45790099
458000     END-IF.                                                      45800099
458100                                                                  45810099
458200                                                                  45820099
458300*----------------------------------------------------------------*45830099
458400*    READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE     *45840099
458500*----------------------------------------------------------------*45850099
458600                                                                  45860099
458700 9100-READ-SEL-QUEUE.                                             45870099
458800     EXEC CICS                                                    45880099
458900         READQ TS                                                 45890099
459000             QUEUE (ASC-IN-SEL-QUEUE-NAME)                        45900099
459100             INTO  (RC013-DC-SELECT-RECORD)                       45910099
459200             ITEM  (ASC-SEL-ITEM)                                 45920099
459300             RESP  (PV-CICS-RESP)                                 45930099
459400     END-EXEC.                                                    45940099
459500                                                                  45950099
459600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       45960099
459700         CONTINUE                                                 45970099
459800     ELSE                                                         45980099
459900         SET DP013-LOGIC-ABEND                                    45990099
460000             DP013-NO-ROLLBACK     TO TRUE                        46000099
460100         MOVE '9100-READ-SEL-QUEUE'                               46010099
460200                                   TO DP013-PARAGRAPH             46020099
460300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46030099
460400                                   TO DP013-MESSAGE-TEXT (1)      46040099
460500         PERFORM DP013-0000-PROCESS-ABEND                         46050099
460600     END-IF.                                                      46060099
460700                                                                  46070099
460800/                                                                 46080099
460900*----------------------------------------------------------------*46090099
461000*    UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE     *46100099
461100*----------------------------------------------------------------*46110099
461200 9200-REWRITE-LIST-QUEUE.                                         46120099
461300     EXEC CICS                                                    46130099
461400          WRITEQ TS                                               46140099
461500              QUEUE  (ASC-IN-SEL-QUEUE-NAME)                      46150099
461600              FROM   (RC013-DC-SELECT-RECORD)                     46160099
461700              ITEM   (ASC-SEL-ITEM)                               46170099
461800              RESP   (PV-CICS-RESP)                               46180099
461900              REWRITE                                             46190099
462000     END-EXEC.                                                    46200099
462100                                                                  46210099
462200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   46220099
462300         SET DP013-CICS-ABEND                                     46230099
462400             DP013-NO-ROLLBACK     TO TRUE                        46240099
462500         MOVE '9200-REWRITE-LIST-QUEUE'                           46250099
462600                                   TO DP013-PARAGRAPH             46260099
462700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   46270099
462800                                   TO DP013-MESSAGE-TEXT (1)      46280099
462900         PERFORM DP013-0000-PROCESS-ABEND                         46290099
463000     END-IF.                                                      46300099
463100                                                                  46310099
463200******************************************************************46320099
463300 9900-WRITE-CICS-LOG.                                             46330099
463400                                                                  46340099
463500     MOVE LENGTH OF PV-CICS-MSG-AREA                              46350099
463600          TO PV-COMMAREA-LENGTH                                   46360099
463700                                                                  46370099
463800     EXEC CICS                                                    46380099
463900         WRITEQ TD                                                46390099
464000             QUEUE  ('CSSL')                                      46400099
464010             FROM   (PV-CICS-MSG-AREA)                            46401099
464020             LENGTH (PV-COMMAREA-LENGTH)                          46402099
464030             RESP   (PV-CICS-RESPONSE)                            46403099
464040     END-EXEC.                                                    46404099
464050                                                                  46405099
464060     MOVE SPACES TO PV-CICS-MSG-AREA.                             46406099
464070/                                                                 46407099
464080*----------------------------------------------------------------*46408099
464090*    ABEND PROCESSOR MODULE                                      *46409099
464100*----------------------------------------------------------------*46410099
464200                                                                  46420099
464300     COPY DPPD013.                                                46430099
