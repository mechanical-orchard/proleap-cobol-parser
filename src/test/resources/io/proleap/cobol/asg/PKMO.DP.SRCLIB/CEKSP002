000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.      CEKSP002.                                       00020001
000300 AUTHOR.          CHRISTINE TWIEHAUS.                             00030001
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040001
000500 DATE-WRITTEN.    JULY  2010.                                     00050001
000600 DATE-COMPILED.                                                   00060001
000700******************************************************************00070001
000800* GET QUANTITY FOR ENTERED SKUS                                   00080001
000900******************************************************************00090001
001000* SPECIAL COMPILE/STAGING NOTE!                                   00100001
001100* -----------------------------                                   00110001
001200* USE 5.P - MUST HAVE AUTHORITY TO BIND TO DB2TDBA                00120001
001300******************************************************************00130001
001400* 07/12/10 - CHRISTINE TWIEHAUS                       WR#        *00140001
001500*            INITIAL IMPLEMENTATION                              *00150001
001510* THIS PROGRAM FIRST TRIES TO DETERMINE HOW MANY RECORDS WILL     00151054
001520* BE WITHIN THE CURSOR BEFORE IT TRIES TO OPEN THE CURSOR AND     00152055
001530* FETCH DATA.  IF MULTIPLE RECORDS ARE FOUND, THE CURSOR IS       00153055
001540* OPENED, FETCHED, CLOSED.  IF NO OR ONE RECORD IS FOUND, THE     00154055
001550* PROGRAM CONTINUES.                                              00155055
001400* 09/28/22 - JEAN KURK                          CHG0274738       *00156056
001500*            RECOMPILE FOR UPCOMING COBOL UPGRADE                *00157056
001500*            ADD DCLGEN FOR XLT_SKU                              *00158056
001600******************************************************************00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800 CONFIGURATION SECTION.                                           00180001
001900 SOURCE-COMPUTER. IBM-3090.                                       00190001
002000 OBJECT-COMPUTER. IBM-3090.                                       00200001
002100                                                                  00210001
002200 INPUT-OUTPUT SECTION.                                            00220001
002300******************************************************************00230001
002400 DATA DIVISION.                                                   00240001
002500******************************************************************00250001
002600                                                                  00260001
002700 FILE SECTION.                                                    00270001
002800                                                                  00280001
002900 WORKING-STORAGE SECTION.                                         00290001
003000******************************************************************00300001
003100* PROGRAM CONSTANTS                                               00310001
003200******************************************************************00320001
003300 01  PC-PROGRAM-CONSTANTS.                                        00330001
003400     05  PC-PROGRAM-NAME             PIC  X(08)  VALUE 'CEKSP002'.00340001
003500                                                                  00350001
003600******************************************************************00360001
003700* PROGRAM VARIBLES                                                00370001
003800******************************************************************00380001
003900 01  PV-PROGRAM-VARIBLES.                                         00390001
004000     05  PV-PARAGRAPH-NAME           PIC  X(30)  VALUE SPACES.    00400001
004010     05  PV-INFO-LINE                PIC  X(40)  VALUE SPACES.    00401055
004020     05  PV-INFO-LINE-2              PIC  X(40)  VALUE SPACES.    00402039
004100     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)  VALUE SPACES.    00410001
004200     05  PV-OPERATION-MSG-1          PIC  X(40)  VALUE SPACES.    00420001
004300     05  PV-COUNT                    PIC S9(05)  VALUE ZEROES     00430001
004400                                                 COMP.            00440001
004500     05  PV-CURRENT-TIMESTAMP        PIC  X(26).                  00450001
004510     05  PV-DB2-TIMESTAMP            PIC X(26) VALUE SPACES.      00451014
004600                                                                  00460001
004700     05  PV-HOLD-SQLCODE             PIC S9(09)  VALUE ZEROES     00470001
004800                                                 COMP.            00480001
004900     05  PV-SKU                      PIC S9(8)V COMP-3.           00490001
005000     05  PV-LOC                      PIC S9(4) COMP.              00500001
005100     05  PV-ONHAND                   PIC  S9(7)V COMP-3.          00510001
005110     05  PV-SUB-O                    PIC 9(4) VALUE ZEROES.       00511035
005120     05  PV-SKU-O                    PIC 9(8) VALUE ZEROES.       00512039
005200                                                                  00520001
005300     05  PV-RETRY-COUNTER            PIC S9(04)  VALUE +0         00530001
005400                                                 COMP SYNC.       00540001
005401     05  PV-SQLCODE-OUT              PIC 9(04).                   00540128
005402     05  PV-LOC-OUT                  PIC 9(04).                   00540228
005403                                                                  00540327
005410 01  PA-INPUT-TABLE.                                              00541001
005420     05  PA-INPUT            OCCURS 10 TIMES INDEXED BY IN-SUB.   00542001
005430         10  PA-IN-SKU              PIC  S9(09) COMP.             00543001
005440                                                                  00544001
005450 01  PA-OUTPUT-TABLE.                                             00545001
005460     05  PA-OUTPUT           OCCURS 50 TIMES INDEXED BY OUT-SUB.  00546001
005470         10  PA-OUT-SKU             PIC  S9(09) COMP.             00547001
005480         10  PA-OUT-LOC             PIC  S9(04) COMP.             00548001
005490         10  PA-OUT-ONHAND          PIC  S9(09) COMP.             00549001
005491         10  PA-MESSAGE-CODE        PIC  S9(04) COMP.             00549101
005492                                                                  00549201
005493 01  PV-HOLD-ADHC-ID                 PIC S9(10)V VALUE ZEROES     00549301
005494                                                 COMP-3.          00549401
005495 01  PA-PROGRAM-ACCUMULATORS.                                     00549501
005496     05  PA-CLUSTER-ROWS-FETCH       PIC S9(06)  COMP-3           00549601
005497                                                 VALUE ZEROES.    00549701
005498                                                                  00549801
005499******************************************************************00549901
005500* PROGRAM SWITCHES                                                00550001
005600******************************************************************00560001
005700 01  PS-PROGRAM-SWITCHES.                                         00570001
005800     05  PS-LOC-COMPLETE-SW           PIC  X(01) VALUE 'N'.       00580001
005900         88  PS-LOC-COMPLETE                     VALUE 'Y'.       00590001
006000         88  PS-LOC-NOT-COMPLETE                 VALUE 'N'.       00600001
006010     05  PS-DISPLAY-SW               PIC  X(01)  VALUE 'Y'.       00601010
006020         88  PS-DISPLAY-YES                      VALUE 'Y'.       00602010
006030         88  PS-DISPLAY-NO                       VALUE 'N'.       00603010
006040     05  PS-QUANTITY-SW              PIC  X(01)  VALUE 'N'.       00604041
006050         88  PS-SINGLE-YES                       VALUE 'Y'.       00605041
006060         88  PS-MULTIPLE-YES                     VALUE 'M'.       00606041
006070         88  PS-RECORD-NOTFND                    VALUE 'N'.       00607041
006100                                                                  00610001
006200 01  ABEND-CODE                      PIC S9(04)  COMP VALUE +0.   00620001
006300     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     00630001
006400                                                                  00640001
006500******************************************************************00650001
006600* MSG   ERROR MESSAGE TO BE DISPLAYED IN THE STORED PROCEDURE     00660001
006700*       ADDRESS SPACE                                             00670001
006800******************************************************************00680001
006900 01  MSG-ERROR-DISPLAY.                                           00690001
007000     05  FILLER                      PIC  X(05)  VALUE 'ERROR'.   00700001
007100     05  FILLER                      PIC  X(01)  VALUE SPACES.    00710001
007200     05  FILLER                      PIC  X(01)  VALUE '-'.       00720001
007300     05  FILLER                      PIC  X(01)  VALUE SPACES.    00730001
007400     05  MSG-STORED-PROCEDURE-NAME   PIC  X(08)  VALUE SPACES.    00740001
007500     05  FILLER                      PIC  X(01)  VALUE SPACES.    00750001
007600     05  MSG-SKU                     PIC  X(08)  VALUE SPACES.    00760001
007700     05  FILLER                      PIC  X(01)  VALUE ':'.       00770001
007800     05  FILLER                      PIC  X(02)  VALUE SPACES.    00780001
007900                                                                  00790001
008000******************************************************************00800001
008100* COPYBOOKS                                                       00810001
008200***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00820001
008300     COPY DPWS004.                                                00830001
008400                                                                  00840001
008500***DB2 MESSAGE AREA                                               00850001
008600     COPY SQLCA2.                                                 00860001
008700                                                                  00870001
008800******************************************************************00880001
008900* TABLE INCLUSIONS                                                00890001
009000******************************************************************00900001
009100     EXEC SQL INCLUDE SQLCA    END-EXEC.                          00910001
009200                                                                  00920001
009300* CE - CENTRAL STOCK PULL REQUEST LOCATION ITEMS                  00930001
009400     EXEC SQL INCLUDE TCEPLIT  END-EXEC.                          00940001
009500                                                                  00950001
009600* CE - CE - CENTRAL STOCK PULL REQUESTS                           00960001
009700     EXEC SQL INCLUDE TCEPLRQ  END-EXEC.                          00970001
009800                                                                  00980001
009900* CE - CENTRAL,STOCK PULL ITEM STORE                              00990001
010000     EXEC SQL INCLUDE TCEPLDS  END-EXEC.                          01000001
010100                                                                  01010001
010200* CE - CE - CENTRAL STOCK MANUAL ADDJUSTMENT                      01020001
010300     EXEC SQL INCLUDE TCEPLMF  END-EXEC.                          01030001
010400                                                                  01040001
010500* CE - CENTRAL STOCK PULL REQUEST STATUS                          01050001
010600     EXEC SQL INCLUDE TCEPLST  END-EXEC.                          01060001
010700                                                                  01070001
010500* XL - XLT_SKU                                                    01071056
010600     EXEC SQL INCLUDE XLT00003 END-EXEC.                          01072056
010700                                                                  01073056
010800* SKU CROSS REFERENCE TABLE                                       01080001
010900     EXEC SQL INCLUDE TSKXREF  END-EXEC.                          01090001
010910*                                                                 01091014
010920     EXEC SQL INCLUDE TKRPRPM  END-EXEC.                          01092014
011000                                                                  01100001
011100* SKU STORE TABLE                                                 01110001
011200     EXEC SQL INCLUDE TSKST    END-EXEC.                          01120001
011201                                                                  01120152
011400* GET QUANTITY AT EACH LOCATION FOR EACH SKU ENTERED              01140001
011500     EXEC SQL                                                     01150001
011600        DECLARE GET-SKU-LOC-QTY CURSOR FOR                        01160001
011700         SELECT  DISTINCT J.LOC_ID  ,                             01170018
011800            (   (B.ONHAND_QTY)                                    01180001
011900                             -                                    01190001
012000               (SELECT IFNULL(SUM(E.REQ_ORD_QTY),0)               01200001
012100                  FROM TCEPLIT C,                                 01210001
012200                       TCEPLRQ D,                                 01220001
012300                       TCEPLDS E                                  01230001
012400                 WHERE A.ITM_NBR          =  C.ITM_NBR            01240001
012500                   AND C.STAT_CDE         IN ('NW','IP')          01250001
012600                   AND D.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR   01260001
012700                   AND B.LOC_NBR          =  D.CNSTK_LOC_ID       01270001
012800                   AND E.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR   01280001
012900                   AND E.PL_LNE_NBR       =  C.PL_LNE_NBR)        01290001
013000                             -                                    01300001
013100               (SELECT IFNULL(SUM(I.MFST_UNT_QTY),0)              01310001
013200                  FROM TCEPLIT F,                                 01320001
013300                       TCEPLRQ G,                                 01330001
013400                       TCEPLDS H,                                 01340001
013500                       TCEPLMF I                                  01350001
013600                 WHERE A.ITM_NBR          =  F.ITM_NBR            01360001
013700                   AND F.STAT_CDE         IN ('NW','IP')          01370001
013800                   AND G.CNSTK_REQ_PL_NBR =  F.CNSTK_REQ_PL_NBR   01380001
013900                   AND B.LOC_NBR          =  G.CNSTK_LOC_ID       01390001
014000                   AND H.CNSTK_REQ_PL_NBR =  F.CNSTK_REQ_PL_NBR   01400001
014100                   AND H.PL_LNE_NBR       =  F.PL_LNE_NBR         01410001
014200                   AND H.CNSTK_REQ_PL_NBR =  I.CNSTK_REQ_PL_NBR   01420001
014300                   AND H.PL_LNE_NBR       =  I.PL_LNE_NBR         01430001
014400                   AND H.STR_NBR          =  I.STR_NBR            01440001
014500                   AND I.EXPRT_PRC_BTCH_ID <> '' )) AS QUANTITY   01450001
014600           FROM XLT_SKU A,                                        01460042
014700                TSKST   B,                                        01470001
014800                TKRPRPM J                                         01480008
014900          WHERE A.SKU_NBR = :PV-SKU                               01490042
015100            AND A.ITM_NBR = B.ITEM_NMBR                           01510001
015210            AND J.LOC_ID       = B.LOC_NBR                        01521008
015230            AND J.INTFC_SYS_CDE = 'KHL'                           01523008
015240            AND J.FUNC_PRC_STAT_CDE = 'AC'                        01524008
015250            AND J.FUNC_TXT = 'Y'                                  01525008
015260            AND J.SYS_PRC_FUNC_CDE = 'PTFAC'                      01526008
015300          WITH UR                                                 01530001
015310     END-EXEC.                                                    01531001
015320                                                                  01532001
015330******************************************************************01533001
015340 LINKAGE SECTION.                                                 01534001
015350******************************************************************01535001
015360                                                                  01536001
015370 01  LS-IN-SKU1                     PIC  S9(09) COMP.             01537001
015380 01  LS-IN-SKU2                     PIC  S9(09) COMP.             01538001
015390 01  LS-IN-SKU3                     PIC  S9(09) COMP.             01539001
015400 01  LS-IN-SKU4                     PIC  S9(09) COMP.             01540001
015500 01  LS-IN-SKU5                     PIC  S9(09) COMP.             01550001
015600 01  LS-IN-SKU6                     PIC  S9(09) COMP.             01560001
015700 01  LS-IN-SKU7                     PIC  S9(09) COMP.             01570001
015800 01  LS-IN-SKU8                     PIC  S9(09) COMP.             01580001
015900 01  LS-IN-SKU9                     PIC  S9(09) COMP.             01590001
016000 01  LS-IN-SKU10                    PIC  S9(09) COMP.             01600001
016100                                                                  01610001
016200 01  LS-OUT-SKU1            PIC  S9(09) COMP.                     01620001
016300 01  LS-OUT-LOC1            PIC  S9(04) COMP.                     01630001
016400 01  LS-OUT-ONHAND1         PIC  S9(09) COMP.                     01640001
016500 01  LS-MESSAGE-CODE1       PIC  S9(04) COMP.                     01650001
016600 01  LS-OUT-SKU2            PIC  S9(09) COMP.                     01660001
016700 01  LS-OUT-LOC2            PIC  S9(04) COMP.                     01670001
016800 01  LS-OUT-ONHAND2         PIC  S9(09) COMP.                     01680001
016900 01  LS-MESSAGE-CODE2       PIC  S9(04) COMP.                     01690001
017000 01  LS-OUT-SKU3            PIC  S9(09) COMP.                     01700001
017100 01  LS-OUT-LOC3            PIC  S9(04) COMP.                     01710001
017200 01  LS-OUT-ONHAND3         PIC  S9(09) COMP.                     01720001
017300 01  LS-MESSAGE-CODE3       PIC  S9(04) COMP.                     01730001
017310 01  LS-OUT-SKU4            PIC  S9(09) COMP.                     01731001
017320 01  LS-OUT-LOC4            PIC  S9(04) COMP.                     01732001
017330 01  LS-OUT-ONHAND4         PIC  S9(09) COMP.                     01733001
017340 01  LS-MESSAGE-CODE4       PIC  S9(04) COMP.                     01734001
017350 01  LS-OUT-SKU5            PIC  S9(09) COMP.                     01735001
017360 01  LS-OUT-LOC5            PIC  S9(04) COMP.                     01736001
017370 01  LS-OUT-ONHAND5         PIC  S9(09) COMP.                     01737001
017380 01  LS-MESSAGE-CODE5       PIC  S9(04) COMP.                     01738001
017390 01  LS-OUT-SKU6            PIC  S9(09) COMP.                     01739001
017391 01  LS-OUT-LOC6            PIC  S9(04) COMP.                     01739101
017392 01  LS-OUT-ONHAND6         PIC  S9(09) COMP.                     01739201
017393 01  LS-MESSAGE-CODE6       PIC  S9(04) COMP.                     01739301
017394 01  LS-OUT-SKU7            PIC  S9(09) COMP.                     01739401
017395 01  LS-OUT-LOC7            PIC  S9(04) COMP.                     01739501
017396 01  LS-OUT-ONHAND7         PIC  S9(09) COMP.                     01739601
017397 01  LS-MESSAGE-CODE7       PIC  S9(04) COMP.                     01739701
017398 01  LS-OUT-SKU8            PIC  S9(09) COMP.                     01739801
017399 01  LS-OUT-LOC8            PIC  S9(04) COMP.                     01739901
017400 01  LS-OUT-ONHAND8         PIC  S9(09) COMP.                     01740001
017401 01  LS-MESSAGE-CODE8       PIC  S9(04) COMP.                     01740101
017402 01  LS-OUT-SKU9            PIC  S9(09) COMP.                     01740201
017403 01  LS-OUT-LOC9            PIC  S9(04) COMP.                     01740301
017404 01  LS-OUT-ONHAND9         PIC  S9(09) COMP.                     01740401
017405 01  LS-MESSAGE-CODE9       PIC  S9(04) COMP.                     01740501
017406 01  LS-OUT-SKU10           PIC  S9(09) COMP.                     01740601
017407 01  LS-OUT-LOC10           PIC  S9(04) COMP.                     01740701
017408 01  LS-OUT-ONHAND10        PIC  S9(09) COMP.                     01740801
017409 01  LS-MESSAGE-CODE10      PIC  S9(04) COMP.                     01740901
017410 01  LS-OUT-SKU11           PIC  S9(09) COMP.                     01741001
017411 01  LS-OUT-LOC11           PIC  S9(04) COMP.                     01741101
017412 01  LS-OUT-ONHAND11        PIC  S9(09) COMP.                     01741201
017413 01  LS-MESSAGE-CODE11      PIC  S9(04) COMP.                     01741301
017414 01  LS-OUT-SKU12           PIC  S9(09) COMP.                     01741401
017415 01  LS-OUT-LOC12           PIC  S9(04) COMP.                     01741501
017416 01  LS-OUT-ONHAND12        PIC  S9(09) COMP.                     01741601
017417 01  LS-MESSAGE-CODE12      PIC  S9(04) COMP.                     01741701
017418 01  LS-OUT-SKU13           PIC  S9(09) COMP.                     01741801
017419 01  LS-OUT-LOC13           PIC  S9(04) COMP.                     01741901
017420 01  LS-OUT-ONHAND13        PIC  S9(09) COMP.                     01742001
017421 01  LS-MESSAGE-CODE13      PIC  S9(04) COMP.                     01742101
017422 01  LS-OUT-SKU14           PIC  S9(09) COMP.                     01742201
017423 01  LS-OUT-LOC14           PIC  S9(04) COMP.                     01742301
017424 01  LS-OUT-ONHAND14        PIC  S9(09) COMP.                     01742401
017425 01  LS-MESSAGE-CODE14      PIC  S9(04) COMP.                     01742501
017426 01  LS-OUT-SKU15           PIC  S9(09) COMP.                     01742601
017427 01  LS-OUT-LOC15           PIC  S9(04) COMP.                     01742701
017428 01  LS-OUT-ONHAND15        PIC  S9(09) COMP.                     01742801
017429 01  LS-MESSAGE-CODE15      PIC  S9(04) COMP.                     01742901
017430 01  LS-OUT-SKU16           PIC  S9(09) COMP.                     01743001
017431 01  LS-OUT-LOC16           PIC  S9(04) COMP.                     01743101
017432 01  LS-OUT-ONHAND16        PIC  S9(09) COMP.                     01743201
017433 01  LS-MESSAGE-CODE16      PIC  S9(04) COMP.                     01743301
017434 01  LS-OUT-SKU17           PIC  S9(09) COMP.                     01743401
017435 01  LS-OUT-LOC17           PIC  S9(04) COMP.                     01743501
017436 01  LS-OUT-ONHAND17        PIC  S9(09) COMP.                     01743601
017437 01  LS-MESSAGE-CODE17      PIC  S9(04) COMP.                     01743701
017438 01  LS-OUT-SKU18           PIC  S9(09) COMP.                     01743801
017439 01  LS-OUT-LOC18           PIC  S9(04) COMP.                     01743901
017440 01  LS-OUT-ONHAND18        PIC  S9(09) COMP.                     01744001
017441 01  LS-MESSAGE-CODE18      PIC  S9(04) COMP.                     01744101
017442 01  LS-OUT-SKU19           PIC  S9(09) COMP.                     01744201
017443 01  LS-OUT-LOC19           PIC  S9(04) COMP.                     01744301
017444 01  LS-OUT-ONHAND19        PIC  S9(09) COMP.                     01744401
017445 01  LS-MESSAGE-CODE19      PIC  S9(04) COMP.                     01744501
017446 01  LS-OUT-SKU20           PIC  S9(09) COMP.                     01744601
017447 01  LS-OUT-LOC20           PIC  S9(04) COMP.                     01744701
017448 01  LS-OUT-ONHAND20        PIC  S9(09) COMP.                     01744801
017449 01  LS-MESSAGE-CODE20      PIC  S9(04) COMP.                     01744901
017450 01  LS-OUT-SKU21           PIC  S9(09) COMP.                     01745001
017451 01  LS-OUT-LOC21           PIC  S9(04) COMP.                     01745101
017452 01  LS-OUT-ONHAND21        PIC  S9(09) COMP.                     01745201
017453 01  LS-MESSAGE-CODE21      PIC  S9(04) COMP.                     01745301
017454 01  LS-OUT-SKU22           PIC  S9(09) COMP.                     01745401
017455 01  LS-OUT-LOC22           PIC  S9(04) COMP.                     01745501
017456 01  LS-OUT-ONHAND22        PIC  S9(09) COMP.                     01745601
017457 01  LS-MESSAGE-CODE22      PIC  S9(04) COMP.                     01745701
017458 01  LS-OUT-SKU23           PIC  S9(09) COMP.                     01745801
017459 01  LS-OUT-LOC23           PIC  S9(04) COMP.                     01745901
017460 01  LS-OUT-ONHAND23        PIC  S9(09) COMP.                     01746001
017461 01  LS-MESSAGE-CODE23      PIC  S9(04) COMP.                     01746101
017462 01  LS-OUT-SKU24           PIC  S9(09) COMP.                     01746201
017463 01  LS-OUT-LOC24           PIC  S9(04) COMP.                     01746301
017464 01  LS-OUT-ONHAND24        PIC  S9(09) COMP.                     01746401
017465 01  LS-MESSAGE-CODE24      PIC  S9(04) COMP.                     01746501
017466 01  LS-OUT-SKU25           PIC  S9(09) COMP.                     01746601
017467 01  LS-OUT-LOC25           PIC  S9(04) COMP.                     01746701
017468 01  LS-OUT-ONHAND25        PIC  S9(09) COMP.                     01746801
017469 01  LS-MESSAGE-CODE25      PIC  S9(04) COMP.                     01746901
017470 01  LS-OUT-SKU26           PIC  S9(09) COMP.                     01747001
017471 01  LS-OUT-LOC26           PIC  S9(04) COMP.                     01747101
017472 01  LS-OUT-ONHAND26        PIC  S9(09) COMP.                     01747201
017473 01  LS-MESSAGE-CODE26      PIC  S9(04) COMP.                     01747301
017474 01  LS-OUT-SKU27           PIC  S9(09) COMP.                     01747401
017475 01  LS-OUT-LOC27           PIC  S9(04) COMP.                     01747501
017476 01  LS-OUT-ONHAND27        PIC  S9(09) COMP.                     01747601
017477 01  LS-MESSAGE-CODE27      PIC  S9(04) COMP.                     01747701
017478 01  LS-OUT-SKU28           PIC  S9(09) COMP.                     01747801
017479 01  LS-OUT-LOC28           PIC  S9(04) COMP.                     01747901
017480 01  LS-OUT-ONHAND28        PIC  S9(09) COMP.                     01748001
017481 01  LS-MESSAGE-CODE28      PIC  S9(04) COMP.                     01748101
017482 01  LS-OUT-SKU29           PIC  S9(09) COMP.                     01748201
017483 01  LS-OUT-LOC29           PIC  S9(04) COMP.                     01748301
017484 01  LS-OUT-ONHAND29        PIC  S9(09) COMP.                     01748401
017485 01  LS-MESSAGE-CODE29      PIC  S9(04) COMP.                     01748501
017486 01  LS-OUT-SKU30           PIC  S9(09) COMP.                     01748601
017487 01  LS-OUT-LOC30           PIC  S9(04) COMP.                     01748701
017488 01  LS-OUT-ONHAND30        PIC  S9(09) COMP.                     01748801
017489 01  LS-MESSAGE-CODE30      PIC  S9(04) COMP.                     01748901
017490 01  LS-OUT-SKU31           PIC  S9(09) COMP.                     01749001
017491 01  LS-OUT-LOC31           PIC  S9(04) COMP.                     01749101
017492 01  LS-OUT-ONHAND31        PIC  S9(09) COMP.                     01749201
017493 01  LS-MESSAGE-CODE31      PIC  S9(04) COMP.                     01749301
017494 01  LS-OUT-SKU32           PIC  S9(09) COMP.                     01749401
017495 01  LS-OUT-LOC32           PIC  S9(04) COMP.                     01749501
017496 01  LS-OUT-ONHAND32        PIC  S9(09) COMP.                     01749601
017497 01  LS-MESSAGE-CODE32      PIC  S9(04) COMP.                     01749701
017498 01  LS-OUT-SKU33           PIC  S9(09) COMP.                     01749801
017499 01  LS-OUT-LOC33           PIC  S9(04) COMP.                     01749901
017500 01  LS-OUT-ONHAND33        PIC  S9(09) COMP.                     01750001
017501 01  LS-MESSAGE-CODE33      PIC  S9(04) COMP.                     01750101
017502 01  LS-OUT-SKU34           PIC  S9(09) COMP.                     01750201
017503 01  LS-OUT-LOC34           PIC  S9(04) COMP.                     01750301
017504 01  LS-OUT-ONHAND34        PIC  S9(09) COMP.                     01750401
017505 01  LS-MESSAGE-CODE34      PIC  S9(04) COMP.                     01750501
017506 01  LS-OUT-SKU35           PIC  S9(09) COMP.                     01750601
017507 01  LS-OUT-LOC35           PIC  S9(04) COMP.                     01750701
017508 01  LS-OUT-ONHAND35        PIC  S9(09) COMP.                     01750801
017509 01  LS-MESSAGE-CODE35      PIC  S9(04) COMP.                     01750901
017510 01  LS-OUT-SKU36           PIC  S9(09) COMP.                     01751001
017511 01  LS-OUT-LOC36           PIC  S9(04) COMP.                     01751101
017512 01  LS-OUT-ONHAND36        PIC  S9(09) COMP.                     01751201
017513 01  LS-MESSAGE-CODE36      PIC  S9(04) COMP.                     01751301
017514 01  LS-OUT-SKU37           PIC  S9(09) COMP.                     01751401
017515 01  LS-OUT-LOC37           PIC  S9(04) COMP.                     01751501
017516 01  LS-OUT-ONHAND37        PIC  S9(09) COMP.                     01751601
017517 01  LS-MESSAGE-CODE37      PIC  S9(04) COMP.                     01751701
017518 01  LS-OUT-SKU38           PIC  S9(09) COMP.                     01751801
017519 01  LS-OUT-LOC38           PIC  S9(04) COMP.                     01751901
017520 01  LS-OUT-ONHAND38        PIC  S9(09) COMP.                     01752001
017521 01  LS-MESSAGE-CODE38      PIC  S9(04) COMP.                     01752101
017522 01  LS-OUT-SKU39           PIC  S9(09) COMP.                     01752201
017523 01  LS-OUT-LOC39           PIC  S9(04) COMP.                     01752301
017524 01  LS-OUT-ONHAND39        PIC  S9(09) COMP.                     01752401
017525 01  LS-MESSAGE-CODE39      PIC  S9(04) COMP.                     01752501
017526 01  LS-OUT-SKU40           PIC  S9(09) COMP.                     01752601
017527 01  LS-OUT-LOC40           PIC  S9(04) COMP.                     01752701
017528 01  LS-OUT-ONHAND40        PIC  S9(09) COMP.                     01752801
017529 01  LS-MESSAGE-CODE40      PIC  S9(04) COMP.                     01752901
017530 01  LS-OUT-SKU41           PIC  S9(09) COMP.                     01753001
017531 01  LS-OUT-LOC41           PIC  S9(04) COMP.                     01753101
017532 01  LS-OUT-ONHAND41        PIC  S9(09) COMP.                     01753201
017533 01  LS-MESSAGE-CODE41      PIC  S9(04) COMP.                     01753301
017534 01  LS-OUT-SKU42           PIC  S9(09) COMP.                     01753401
017535 01  LS-OUT-LOC42           PIC  S9(04) COMP.                     01753501
017536 01  LS-OUT-ONHAND42        PIC  S9(09) COMP.                     01753601
017537 01  LS-MESSAGE-CODE42      PIC  S9(04) COMP.                     01753701
017538 01  LS-OUT-SKU43           PIC  S9(09) COMP.                     01753801
017539 01  LS-OUT-LOC43           PIC  S9(04) COMP.                     01753901
017540 01  LS-OUT-ONHAND43        PIC  S9(09) COMP.                     01754001
017541 01  LS-MESSAGE-CODE43      PIC  S9(04) COMP.                     01754101
017542 01  LS-OUT-SKU44           PIC  S9(09) COMP.                     01754201
017543 01  LS-OUT-LOC44           PIC  S9(04) COMP.                     01754301
017544 01  LS-OUT-ONHAND44        PIC  S9(09) COMP.                     01754401
017545 01  LS-MESSAGE-CODE44      PIC  S9(04) COMP.                     01754501
017546 01  LS-OUT-SKU45           PIC  S9(09) COMP.                     01754601
017547 01  LS-OUT-LOC45           PIC  S9(04) COMP.                     01754701
017548 01  LS-OUT-ONHAND45        PIC  S9(09) COMP.                     01754801
017549 01  LS-MESSAGE-CODE45      PIC  S9(04) COMP.                     01754901
017550 01  LS-OUT-SKU46           PIC  S9(09) COMP.                     01755001
017551 01  LS-OUT-LOC46           PIC  S9(04) COMP.                     01755101
017552 01  LS-OUT-ONHAND46        PIC  S9(09) COMP.                     01755201
017553 01  LS-MESSAGE-CODE46      PIC  S9(04) COMP.                     01755301
017554 01  LS-OUT-SKU47           PIC  S9(09) COMP.                     01755401
017555 01  LS-OUT-LOC47           PIC  S9(04) COMP.                     01755501
017556 01  LS-OUT-ONHAND47        PIC  S9(09) COMP.                     01755601
017557 01  LS-MESSAGE-CODE47      PIC  S9(04) COMP.                     01755701
017558 01  LS-OUT-SKU48           PIC  S9(09) COMP.                     01755801
017559 01  LS-OUT-LOC48           PIC  S9(04) COMP.                     01755901
017560 01  LS-OUT-ONHAND48        PIC  S9(09) COMP.                     01756001
017561 01  LS-MESSAGE-CODE48      PIC  S9(04) COMP.                     01756101
017562 01  LS-OUT-SKU49           PIC  S9(09) COMP.                     01756201
017563 01  LS-OUT-LOC49           PIC  S9(04) COMP.                     01756301
017564 01  LS-OUT-ONHAND49        PIC  S9(09) COMP.                     01756401
017565 01  LS-MESSAGE-CODE49      PIC  S9(04) COMP.                     01756501
017566 01  LS-OUT-SKU50           PIC  S9(09) COMP.                     01756601
017567 01  LS-OUT-LOC50           PIC  S9(04) COMP.                     01756701
017568 01  LS-OUT-ONHAND50        PIC  S9(09) COMP.                     01756801
017569 01  LS-MESSAGE-CODE50      PIC  S9(04) COMP.                     01756901
017570                                                                  01757001
017571 PROCEDURE DIVISION USING   LS-IN-SKU1                            01757101
017572                            LS-IN-SKU2                            01757201
017573                            LS-IN-SKU3                            01757301
017574                            LS-IN-SKU4                            01757401
017575                            LS-IN-SKU5                            01757501
017576                            LS-IN-SKU6                            01757601
017577                            LS-IN-SKU7                            01757701
017578                            LS-IN-SKU8                            01757801
017579                            LS-IN-SKU9                            01757901
017580                            LS-IN-SKU10                           01758001
017590     LS-OUT-SKU1                                                  01759001
017600     LS-OUT-LOC1                                                  01760001
017610     LS-OUT-ONHAND1                                               01761001
017620     LS-MESSAGE-CODE1                                             01762001
017630     LS-OUT-SKU2                                                  01763001
017640     LS-OUT-LOC2                                                  01764001
017650     LS-OUT-ONHAND2                                               01765001
017660     LS-MESSAGE-CODE2                                             01766001
017670     LS-OUT-SKU3                                                  01767001
017680     LS-OUT-LOC3                                                  01768001
017681     LS-OUT-ONHAND3                                               01768101
017682     LS-MESSAGE-CODE3                                             01768201
017683     LS-OUT-SKU4                                                  01768301
017684     LS-OUT-LOC4                                                  01768401
017685     LS-OUT-ONHAND4                                               01768501
017686     LS-MESSAGE-CODE4                                             01768601
017687     LS-OUT-SKU5                                                  01768701
017688     LS-OUT-LOC5                                                  01768801
017689     LS-OUT-ONHAND5                                               01768901
017690     LS-MESSAGE-CODE5                                             01769001
017691     LS-OUT-SKU6                                                  01769101
017692     LS-OUT-LOC6                                                  01769201
017693     LS-OUT-ONHAND6                                               01769301
017694     LS-MESSAGE-CODE6                                             01769401
017695     LS-OUT-SKU7                                                  01769501
017696     LS-OUT-LOC7                                                  01769601
017697     LS-OUT-ONHAND7                                               01769701
017698     LS-MESSAGE-CODE7                                             01769801
017699     LS-OUT-SKU8                                                  01769901
017700     LS-OUT-LOC8                                                  01770001
017701     LS-OUT-ONHAND8                                               01770101
017702     LS-MESSAGE-CODE8                                             01770201
017703     LS-OUT-SKU9                                                  01770301
017704     LS-OUT-LOC9                                                  01770401
017705     LS-OUT-ONHAND9                                               01770501
017706     LS-MESSAGE-CODE9                                             01770601
017707     LS-OUT-SKU10                                                 01770701
017708     LS-OUT-LOC10                                                 01770801
017709     LS-OUT-ONHAND10                                              01770901
017710     LS-MESSAGE-CODE10                                            01771001
017711     LS-OUT-SKU11                                                 01771101
017712     LS-OUT-LOC11                                                 01771201
017713     LS-OUT-ONHAND11                                              01771301
017714     LS-MESSAGE-CODE11                                            01771401
017715     LS-OUT-SKU12                                                 01771501
017716     LS-OUT-LOC12                                                 01771601
017717     LS-OUT-ONHAND12                                              01771701
017718     LS-MESSAGE-CODE12                                            01771801
017719     LS-OUT-SKU13                                                 01771901
017720     LS-OUT-LOC13                                                 01772001
017721     LS-OUT-ONHAND13                                              01772101
017722     LS-MESSAGE-CODE13                                            01772201
017723     LS-OUT-SKU14                                                 01772301
017724     LS-OUT-LOC14                                                 01772401
017725     LS-OUT-ONHAND14                                              01772501
017726     LS-MESSAGE-CODE14                                            01772601
017727     LS-OUT-SKU15                                                 01772701
017728     LS-OUT-LOC15                                                 01772801
017729     LS-OUT-ONHAND15                                              01772901
017730     LS-MESSAGE-CODE15                                            01773001
017731     LS-OUT-SKU16                                                 01773101
017732     LS-OUT-LOC16                                                 01773201
017733     LS-OUT-ONHAND16                                              01773301
017734     LS-MESSAGE-CODE16                                            01773401
017735     LS-OUT-SKU17                                                 01773501
017736     LS-OUT-LOC17                                                 01773601
017737     LS-OUT-ONHAND17                                              01773701
017738     LS-MESSAGE-CODE17                                            01773801
017739     LS-OUT-SKU18                                                 01773901
017740     LS-OUT-LOC18                                                 01774001
017741     LS-OUT-ONHAND18                                              01774101
017742     LS-MESSAGE-CODE18                                            01774201
017743     LS-OUT-SKU19                                                 01774301
017744     LS-OUT-LOC19                                                 01774401
017745     LS-OUT-ONHAND19                                              01774501
017746     LS-MESSAGE-CODE19                                            01774601
017747     LS-OUT-SKU20                                                 01774701
017748     LS-OUT-LOC20                                                 01774801
017749     LS-OUT-ONHAND20                                              01774901
017750     LS-MESSAGE-CODE20                                            01775001
017751     LS-OUT-SKU21                                                 01775101
017752     LS-OUT-LOC21                                                 01775201
017753     LS-OUT-ONHAND21                                              01775301
017754     LS-MESSAGE-CODE21                                            01775401
017755     LS-OUT-SKU22                                                 01775501
017756     LS-OUT-LOC22                                                 01775601
017757     LS-OUT-ONHAND22                                              01775701
017758     LS-MESSAGE-CODE22                                            01775801
017759     LS-OUT-SKU23                                                 01775901
017760     LS-OUT-LOC23                                                 01776001
017761     LS-OUT-ONHAND23                                              01776101
017762     LS-MESSAGE-CODE23                                            01776201
017763     LS-OUT-SKU24                                                 01776301
017764     LS-OUT-LOC24                                                 01776401
017765     LS-OUT-ONHAND24                                              01776501
017766     LS-MESSAGE-CODE24                                            01776601
017767     LS-OUT-SKU25                                                 01776701
017768     LS-OUT-LOC25                                                 01776801
017769     LS-OUT-ONHAND25                                              01776901
017770     LS-MESSAGE-CODE25                                            01777001
017771     LS-OUT-SKU26                                                 01777101
017772     LS-OUT-LOC26                                                 01777201
017773     LS-OUT-ONHAND26                                              01777301
017774     LS-MESSAGE-CODE26                                            01777401
017775     LS-OUT-SKU27                                                 01777501
017776     LS-OUT-LOC27                                                 01777601
017777     LS-OUT-ONHAND27                                              01777701
017778     LS-MESSAGE-CODE27                                            01777801
017779     LS-OUT-SKU28                                                 01777901
017780     LS-OUT-LOC28                                                 01778001
017781     LS-OUT-ONHAND28                                              01778101
017782     LS-MESSAGE-CODE28                                            01778201
017783     LS-OUT-SKU29                                                 01778301
017784     LS-OUT-LOC29                                                 01778401
017785     LS-OUT-ONHAND29                                              01778501
017786     LS-MESSAGE-CODE29                                            01778601
017787     LS-OUT-SKU30                                                 01778701
017788     LS-OUT-LOC30                                                 01778801
017789     LS-OUT-ONHAND30                                              01778901
017790     LS-MESSAGE-CODE30                                            01779001
017791     LS-OUT-SKU31                                                 01779101
017792     LS-OUT-LOC31                                                 01779201
017793     LS-OUT-ONHAND31                                              01779301
017794     LS-MESSAGE-CODE31                                            01779401
017795     LS-OUT-SKU32                                                 01779501
017796     LS-OUT-LOC32                                                 01779601
017797     LS-OUT-ONHAND32                                              01779701
017798     LS-MESSAGE-CODE32                                            01779801
017799     LS-OUT-SKU33                                                 01779901
017800     LS-OUT-LOC33                                                 01780001
017801     LS-OUT-ONHAND33                                              01780101
017802     LS-MESSAGE-CODE33                                            01780201
017803     LS-OUT-SKU34                                                 01780301
017804     LS-OUT-LOC34                                                 01780401
017805     LS-OUT-ONHAND34                                              01780501
017806     LS-MESSAGE-CODE34                                            01780601
017807     LS-OUT-SKU35                                                 01780701
017808     LS-OUT-LOC35                                                 01780801
017809     LS-OUT-ONHAND35                                              01780901
017810     LS-MESSAGE-CODE35                                            01781001
017811     LS-OUT-SKU36                                                 01781101
017812     LS-OUT-LOC36                                                 01781201
017813     LS-OUT-ONHAND36                                              01781301
017814     LS-MESSAGE-CODE36                                            01781401
017815     LS-OUT-SKU37                                                 01781501
017816     LS-OUT-LOC37                                                 01781601
017817     LS-OUT-ONHAND37                                              01781701
017818     LS-MESSAGE-CODE37                                            01781801
017819     LS-OUT-SKU38                                                 01781901
017820     LS-OUT-LOC38                                                 01782001
017821     LS-OUT-ONHAND38                                              01782101
017822     LS-MESSAGE-CODE38                                            01782201
017823     LS-OUT-SKU39                                                 01782301
017824     LS-OUT-LOC39                                                 01782401
017825     LS-OUT-ONHAND39                                              01782501
017826     LS-MESSAGE-CODE39                                            01782601
017827     LS-OUT-SKU40                                                 01782701
017828     LS-OUT-LOC40                                                 01782801
017829     LS-OUT-ONHAND40                                              01782901
017830     LS-MESSAGE-CODE40                                            01783001
017831     LS-OUT-SKU41                                                 01783101
017832     LS-OUT-LOC41                                                 01783201
017833     LS-OUT-ONHAND41                                              01783301
017834     LS-MESSAGE-CODE41                                            01783401
017835     LS-OUT-SKU42                                                 01783501
017836     LS-OUT-LOC42                                                 01783601
017837     LS-OUT-ONHAND42                                              01783701
017838     LS-MESSAGE-CODE42                                            01783801
017839     LS-OUT-SKU43                                                 01783901
017840     LS-OUT-LOC43                                                 01784001
017841     LS-OUT-ONHAND43                                              01784101
017842     LS-MESSAGE-CODE43                                            01784201
017843     LS-OUT-SKU44                                                 01784301
017844     LS-OUT-LOC44                                                 01784401
017845     LS-OUT-ONHAND44                                              01784501
017846     LS-MESSAGE-CODE44                                            01784601
017847     LS-OUT-SKU45                                                 01784701
017848     LS-OUT-LOC45                                                 01784801
017849     LS-OUT-ONHAND45                                              01784901
017850     LS-MESSAGE-CODE45                                            01785001
017851     LS-OUT-SKU46                                                 01785101
017852     LS-OUT-LOC46                                                 01785201
017853     LS-OUT-ONHAND46                                              01785301
017854     LS-MESSAGE-CODE46                                            01785401
017855     LS-OUT-SKU47                                                 01785501
017856     LS-OUT-LOC47                                                 01785601
017857     LS-OUT-ONHAND47                                              01785701
017858     LS-MESSAGE-CODE47                                            01785801
017859     LS-OUT-SKU48                                                 01785901
017860     LS-OUT-LOC48                                                 01786001
017861     LS-OUT-ONHAND48                                              01786101
017862     LS-MESSAGE-CODE48                                            01786201
017863     LS-OUT-SKU49                                                 01786301
017864     LS-OUT-LOC49                                                 01786401
017865     LS-OUT-ONHAND49                                              01786501
017866     LS-MESSAGE-CODE49                                            01786601
017867     LS-OUT-SKU50                                                 01786701
017868     LS-OUT-LOC50                                                 01786801
017869     LS-OUT-ONHAND50                                              01786901
017870     LS-MESSAGE-CODE50.                                           01787001
017871                                                                  01787101
017872******************************************************************01787201
017874 0000-MAINLINE.                                                   01787411
017893                                                                  01789348
017896     EXEC SQL                                                     01789653
017897         SELECT FUNC_TXT                                          01789753
017898           INTO :PS-DISPLAY-SW                                    01789853
017899          FROM TKRPRPM                                            01789953
017900         WHERE SYS_PRC_FUNC_CDE = 'CECSSL'                        01790053
017901     END-EXEC.                                                    01790153
017904                                                                  01790448
017905     IF PS-DISPLAY-YES                                            01790548
017906         MOVE '0000-MAINLINE START' TO PV-PARAGRAPH-NAME          01790648
017907         MOVE '***STARTING PROGRAM***' TO PV-INFO-LINE            01790748
017908         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           01790848
017910     END-IF.                                                      01791048
018000                                                                  01800048
018211     PERFORM 0100-INITIALIZATION.                                 01821101
018212                                                                  01821201
018214     PERFORM 1000-PROCESS-INPUT VARYING IN-SUB FROM 1 BY 1        01821401
018215                                UNTIL IN-SUB  > 10 OR             01821501
018216                                      OUT-SUB > 50 OR             01821601
018217                                PA-IN-SKU(IN-SUB) = ZEROS.        01821701
018220                                                                  01822001
018230     PERFORM 9000-END.                                            01823001
018231     IF PS-DISPLAY-YES                                            01823111
018232         MOVE '0000-MAINLINE GOBACK' TO PV-PARAGRAPH-NAME         01823211
018233         MOVE '***ENDING PROGRAM***' TO PV-INFO-LINE              01823344
018234         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           01823411
018235     END-IF.                                                      01823511
018240     GOBACK.                                                      01824001
018250                                                                  01825001
018260******************************************************************01826001
018270* INITIALIZATION AREA - SETUP QUEUES FOR PROCESSING               01827001
018280******************************************************************01828001
018290 0100-INITIALIZATION.                                             01829001
018300                                                                  01830001
018400     MOVE PC-PROGRAM-NAME TO MSG-STORED-PROCEDURE-NAME.           01840001
018410     SET  OUT-SUB         TO 1.                                   01841033
018500     PERFORM 0150-ZERO-TABLE.                                     01850032
018501*    PERFORM 0150-ZERO-TABLE VARYING OUT-SUB FROM 1 BY 1          01850132
018510*                              UNTIL OUT-SUB  > 50.               01851031
018600     SET  OUT-SUB         TO 1.                                   01860001
018700                                                                  01870001
018800     MOVE LS-IN-SKU1      TO PA-IN-SKU (01).                      01880001
018900     MOVE LS-IN-SKU2      TO PA-IN-SKU (02).                      01890001
019000     MOVE LS-IN-SKU3      TO PA-IN-SKU (03).                      01900001
019100     MOVE LS-IN-SKU4      TO PA-IN-SKU (04).                      01910001
019200     MOVE LS-IN-SKU5      TO PA-IN-SKU (05).                      01920001
019300     MOVE LS-IN-SKU6      TO PA-IN-SKU (06).                      01930001
019400     MOVE LS-IN-SKU7      TO PA-IN-SKU (07).                      01940001
019500     MOVE LS-IN-SKU8      TO PA-IN-SKU (08).                      01950001
019600     MOVE LS-IN-SKU9      TO PA-IN-SKU (09).                      01960001
019700     MOVE LS-IN-SKU10     TO PA-IN-SKU (10).                      01970001
019710     IF PS-DISPLAY-YES                                            01971011
019721         MOVE '0100-INITIALIZATION ' TO PV-PARAGRAPH-NAME         01972112
019730         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           01973011
019740     END-IF.                                                      01974011
019800                                                                  01980001
019810******************************************************************01981004
019820* LOOP THRU EACH OCCURANCE SET EVERTHING TO ZERO                  01982004
019830******************************************************************01983004
019840 0150-ZERO-TABLE.                                                 01984004
019850                                                                  01985004
019851     PERFORM VARYING OUT-SUB FROM 1 BY 1                          01985131
019852                               UNTIL OUT-SUB  > 50                01985231
019860         MOVE ZEROS TO PA-OUT-SKU     (OUT-SUB)                   01986031
019870                       PA-OUT-LOC     (OUT-SUB)                   01987031
019880                       PA-OUT-ONHAND  (OUT-SUB)                   01988031
019890                       PA-MESSAGE-CODE(OUT-SUB)                   01989031
019891     END-PERFORM.                                                 01989131
019892                                                                  01989231
019893     IF PS-DISPLAY-YES                                            01989312
019894         MOVE '0150-ZERO-TABLE     ' TO PV-PARAGRAPH-NAME         01989412
019895         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           01989512
019896     END-IF.                                                      01989612
019897                                                                  01989704
019900******************************************************************01990001
020000* EDIT INPUT - IF GOOD, SELECT QUANTITY AND FORMAT OUTPUT         02000001
020100******************************************************************02010001
020200 1000-PROCESS-INPUT.                                              02020001
020210     IF PS-DISPLAY-YES                                            02021034
020220         MOVE '1000-PROCESS-INPUT START ' TO PV-PARAGRAPH-NAME    02022034
020230         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           02023034
020240     END-IF.                                                      02024034
020300                                                                  02030001
020311     IF PA-IN-SKU (IN-SUB) NOT = ZERO                             02031101
020312         MOVE PA-IN-SKU (IN-SUB) TO PV-SKU                        02031201
020313         SET PS-LOC-NOT-COMPLETE TO TRUE                          02031301
020314         MOVE +1                 TO PV-SUB-O                      02031437
020315         PERFORM 7500-CHECK-FOR-SINGLE THRU 7500-EXIT             02031543
020317         IF  PS-SINGLE-YES                                        02031741
020318             MOVE PV-SKU      TO PA-OUT-SKU     (OUT-SUB)         02031841
020319             MOVE PV-LOC      TO PA-OUT-LOC     (OUT-SUB)         02031941
020320             MOVE PV-ONHAND   TO PA-OUT-ONHAND  (OUT-SUB)         02032041
020321             SET OUT-SUB UP BY 1                                  02032147
020322         END-IF                                                   02032241
020325         IF  PS-MULTIPLE-YES                                      02032541
020326             PERFORM 7000-QUANTITY-OPEN                           02032641
020327             PERFORM 1300-GET-QUANTITY   UNTIL PS-LOC-COMPLETE    02032741
020328                                         OR OUT-SUB > 50          02032841
020329             PERFORM 7002-QUANTITY-CLOSE                          02032941
020330         END-IF                                                   02033041
020331     ELSE                                                         02033101
020332         MOVE ZEROS       TO PA-IN-SKU (IN-SUB).                  02033201
020333     IF PS-DISPLAY-YES                                            02033312
020334         MOVE '1000-PROCESS-INPUT END' TO PV-PARAGRAPH-NAME       02033434
020336         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           02033612
020337     END-IF.                                                      02033712
020338                                                                  02033801
020339******************************************************************02033901
020340* LOOK UP QUANTITY ON-HAND BY SKU AND LOCATION                    02034001
020350******************************************************************02035001
020360 1300-GET-QUANTITY.                                               02036001
020370                                                                  02037001
020380     PERFORM 7001-FETCH-QUANTITY.                                 02038001
020390     IF PS-LOC-NOT-COMPLETE                                       02039001
020400         MOVE PV-SKU      TO PA-OUT-SKU     (OUT-SUB)             02040001
020500         MOVE PV-LOC      TO PA-OUT-LOC     (OUT-SUB)             02050001
020600         MOVE PV-ONHAND   TO PA-OUT-ONHAND  (OUT-SUB)             02060001
021400         SET OUT-SUB UP BY 1.                                     02140004
021410     IF PS-DISPLAY-YES                                            02141012
021420         MOVE '1300-GET-QUANTITY   ' TO PV-PARAGRAPH-NAME         02142012
021430         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           02143012
021440     END-IF.                                                      02144012
021500                                                                  02150001
021600******************************************************************02160001
021700* OPEN CURSOR GET-SKU-LOC-QTY                                     02170001
021800******************************************************************02180001
021900 7000-QUANTITY-OPEN.                                              02190001
022000                                                                  02200001
022500     EXEC SQL                                                     02250001
022600          OPEN GET-SKU-LOC-QTY                                    02260001
022700     END-EXEC.                                                    02270001
022800                                                                  02280001
023100     EVALUATE TRUE                                                02310001
023200         WHEN SQLCODE = ZERO                                      02320001
023300              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02330001
023400         WHEN SQLCODE = +100                                      02340001
023500              SET PS-LOC-COMPLETE TO TRUE                         02350001
023600              MOVE ZEROS       TO PV-LOC                          02360001
023700                                  PV-ONHAND                       02370001
023800              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02380001
023900         WHEN SQLCODE = -911                                      02390001
024000              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02400001
024100         WHEN OTHER                                               02410001
024200              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02420001
024300              PERFORM 9999-SQL-ABEND                              02430001
024400                                                                  02440001
024500     END-EVALUATE.                                                02450001
024510     IF PS-DISPLAY-YES                                            02451012
024511         MOVE SQLCODE         TO PV-SQLCODE-OUT                   02451125
024513         MOVE PV-SKU          TO PV-SKU-O                         02451335
024514         STRING 'SQL CODE : '                  DELIMITED BY SIZE, 02451424
024515                PV-SQLCODE-OUT                 DELIMITED BY SIZE, 02451534
024518                'SUB : '                       DELIMITED BY SIZE, 02451834
024519                PV-SUB-O                       DELIMITED BY SIZE  02451936
024530                                     INTO PV-INFO-LINE            02453022
024531         STRING 'SKU NUMBER : '                DELIMITED BY SIZE, 02453139
024534                PV-SKU-O                       DELIMITED BY SIZE  02453439
024537                                     INTO PV-INFO-LINE-2          02453739
024538         MOVE '7000-QUANTITY-OPEN  ' TO PV-PARAGRAPH-NAME         02453812
024539         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           02453912
024542         ADD +1               TO PV-SUB-O                         02454246
024550     END-IF.                                                      02455012
024600                                                                  02460001
024700******************************************************************02470001
024800* FETCH CURSOR GET-SKU-LOC-QTY                                    02480001
024900******************************************************************02490001
025000 7001-FETCH-QUANTITY.                                             02500001
025100                                                                  02510001
025300                                                                  02530001
025400     EXEC SQL                                                     02540001
025500          FETCH  GET-SKU-LOC-QTY                                  02550001
025600           INTO :PV-LOC                                           02560001
025700               ,:PV-ONHAND                                        02570001
025800     END-EXEC.                                                    02580001
025900                                                                  02590001
026200     EVALUATE TRUE                                                02620001
026300         WHEN SQLCODE = ZERO                                      02630001
026400              MOVE SQLCODE        TO PA-MESSAGE-CODE (OUT-SUB)    02640001
026500         WHEN SQLCODE = +100                                      02650001
026600              SET PS-LOC-COMPLETE TO TRUE                         02660001
026700              MOVE SQLCODE        TO PA-MESSAGE-CODE (OUT-SUB)    02670001
026800         WHEN SQLCODE = -911                                      02680001
026900              SET PS-LOC-COMPLETE TO TRUE                         02690001
027000              MOVE SQLCODE        TO PA-MESSAGE-CODE (OUT-SUB)    02700001
027100         WHEN OTHER                                               02710001
027200              SET PS-LOC-COMPLETE TO TRUE                         02720001
027300              MOVE SQLCODE        TO PA-MESSAGE-CODE (OUT-SUB)    02730001
027400              PERFORM 9999-SQL-ABEND                              02740001
027500                                                                  02750001
027600     END-EVALUATE.                                                02760001
027610     IF PS-DISPLAY-YES                                            02761012
027611         MOVE SQLCODE         TO PV-SQLCODE-OUT                   02761125
027612         MOVE PV-LOC          TO PV-LOC-OUT                       02761225
027613         STRING 'SQL CODE : '                  DELIMITED BY SIZE, 02761324
027614                PV-SQLCODE-OUT                 DELIMITED BY SIZE, 02761425
027615                'PV-LOC : '                    DELIMITED BY SIZE, 02761524
027616                PV-LOC-OUT                     DELIMITED BY SIZE  02761625
027617                                     INTO PV-INFO-LINE            02761724
027620         MOVE '7001-FETCH-QUANTITY ' TO PV-PARAGRAPH-NAME         02762012
027630         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           02763012
027640     END-IF.                                                      02764012
027700                                                                  02770001
027800******************************************************************02780001
027900* OPEN CURSOR GET-SKU-LOC-QTY                                     02790001
028000******************************************************************02800001
028100 7002-QUANTITY-CLOSE.                                             02810001
028200                                                                  02820001
028300     EXEC SQL                                                     02830001
028400          CLOSE GET-SKU-LOC-QTY                                   02840001
028500     END-EXEC.                                                    02850001
028600                                                                  02860001
028800     EVALUATE TRUE                                                02880001
028900         WHEN SQLCODE = ZERO                                      02890001
029000              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02900001
029100         WHEN SQLCODE = +100                                      02910001
029200              MOVE ZEROS       TO PV-LOC                          02920001
029300                                  PV-ONHAND                       02930001
029400              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02940001
029500         WHEN SQLCODE = -911                                      02950001
029600              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02960001
029700         WHEN OTHER                                               02970001
029800              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       02980001
029900              PERFORM 9999-SQL-ABEND                              02990001
030000                                                                  03000001
030100     END-EVALUATE.                                                03010001
030110     IF PS-DISPLAY-YES                                            03011012
030111         MOVE SQLCODE         TO PV-SQLCODE-OUT                   03011125
030112         STRING 'SQL CODE : '                  DELIMITED BY SIZE, 03011224
030113                PV-SQLCODE-OUT                 DELIMITED BY SIZE  03011325
030116                                      INTO PV-INFO-LINE           03011624
030120         MOVE '7002-QUANTITY-CLOSE ' TO PV-PARAGRAPH-NAME         03012012
030130         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           03013012
030140     END-IF.                                                      03014012
030141                                                                  03014141
030142  7500-CHECK-FOR-SINGLE.                                          03014241
030150* GET QUANTITY AT EACH LOCATION FOR EACH SKU ENTERED              03015041
030160     EXEC SQL                                                     03016041
030180         SELECT  DISTINCT J.LOC_ID  ,                             03018041
030190            (   (B.ONHAND_QTY)                                    03019041
030191                             -                                    03019141
030192               (SELECT IFNULL(SUM(E.REQ_ORD_QTY),0)               03019241
030193                  FROM TCEPLIT C,                                 03019341
030194                       TCEPLRQ D,                                 03019441
030195                       TCEPLDS E                                  03019541
030196                 WHERE A.ITM_NBR          =  C.ITM_NBR            03019641
030197                   AND C.STAT_CDE         IN ('NW','IP')          03019741
030198                   AND D.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR   03019841
030199                   AND B.LOC_NBR          =  D.CNSTK_LOC_ID       03019941
030200                   AND E.CNSTK_REQ_PL_NBR =  C.CNSTK_REQ_PL_NBR   03020041
030201                   AND E.PL_LNE_NBR       =  C.PL_LNE_NBR)        03020141
030202                             -                                    03020241
030203               (SELECT IFNULL(SUM(I.MFST_UNT_QTY),0)              03020341
030204                  FROM TCEPLIT F,                                 03020441
030205                       TCEPLRQ G,                                 03020541
030206                       TCEPLDS H,                                 03020641
030207                       TCEPLMF I                                  03020741
030208                 WHERE A.ITM_NBR          =  F.ITM_NBR            03020841
030209                   AND F.STAT_CDE         IN ('NW','IP')          03020941
030210                   AND G.CNSTK_REQ_PL_NBR =  F.CNSTK_REQ_PL_NBR   03021041
030211                   AND B.LOC_NBR          =  G.CNSTK_LOC_ID       03021141
030212                   AND H.CNSTK_REQ_PL_NBR =  F.CNSTK_REQ_PL_NBR   03021241
030213                   AND H.PL_LNE_NBR       =  F.PL_LNE_NBR         03021341
030214                   AND H.CNSTK_REQ_PL_NBR =  I.CNSTK_REQ_PL_NBR   03021441
030215                   AND H.PL_LNE_NBR       =  I.PL_LNE_NBR         03021541
030216                   AND H.STR_NBR          =  I.STR_NBR            03021641
030217                   AND I.EXPRT_PRC_BTCH_ID <> '' )) AS QUANTITY   03021741
030219           INTO :PV-LOC                                           03021941
030220               ,:PV-ONHAND                                        03022041
030221           FROM XLT_SKU A,                                        03022141
030222                TSKST   B,                                        03022241
030223                TKRPRPM J                                         03022341
030224          WHERE A.SKU_NBR = :PV-SKU                               03022441
030225            AND A.ITM_NBR = B.ITEM_NMBR                           03022541
030226            AND J.LOC_ID       = B.LOC_NBR                        03022641
030227            AND J.INTFC_SYS_CDE = 'KHL'                           03022741
030228            AND J.FUNC_PRC_STAT_CDE = 'AC'                        03022841
030229            AND J.FUNC_TXT = 'Y'                                  03022941
030230            AND J.SYS_PRC_FUNC_CDE = 'PTFAC'                      03023041
030231          WITH UR                                                 03023141
030232     END-EXEC.                                                    03023241
030233                                                                  03023341
030239     EVALUATE TRUE                                                03023941
030240         WHEN SQLCODE = ZERO                                      03024041
030241              SET PS-SINGLE-YES TO TRUE                           03024141
030242              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       03024241
030243         WHEN SQLCODE = +100                                      03024341
030244              SET PS-RECORD-NOTFND TO TRUE                        03024441
030245              MOVE ZEROS       TO PV-LOC                          03024541
030246                                  PV-ONHAND                       03024641
030247              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       03024741
030248         WHEN SQLCODE = -811                                      03024841
030249              SET PS-MULTIPLE-YES  TO TRUE                        03024941
030250              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       03025041
030251         WHEN SQLCODE = -911                                      03025141
030252              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       03025241
030253         WHEN OTHER                                               03025341
030254              MOVE SQLCODE     TO PA-MESSAGE-CODE (OUT-SUB)       03025441
030255              PERFORM 9999-SQL-ABEND                              03025541
030256                                                                  03025641
030257     END-EVALUATE.                                                03025741
030258     IF PS-DISPLAY-YES                                            03025841
030259         MOVE PV-SKU          TO PV-SKU-O                         03025945
030260         MOVE SQLCODE         TO PV-SQLCODE-OUT                   03026041
030261         STRING 'SQL CODE : '                  DELIMITED BY SIZE, 03026141
030262                PV-SQLCODE-OUT                 DELIMITED BY SIZE  03026241
030263                                      INTO PV-INFO-LINE           03026341
030264         MOVE '7500-CHECK-FOR-SINGLE' TO PV-PARAGRAPH-NAME        03026441
030265         STRING 'SKU NUMBER : '                DELIMITED BY SIZE, 03026543
030266                PV-SKU-O                       DELIMITED BY SIZE  03026643
030267                                     INTO PV-INFO-LINE-2          03026743
030268         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           03026841
030271     END-IF.                                                      03027141
030272 7500-EXIT.                                                       03027241
030273     EXIT.                                                        03027341
030280                                                                  03028001
030300******************************************************************03030001
030400 9000-END.                                                        03040001
030500******************************************************************03050001
030600                                                                  03060001
030700     MOVE PA-OUT-SKU      (01)         TO LS-OUT-SKU1             03070001
030800     MOVE PA-OUT-LOC      (01)         TO LS-OUT-LOC1             03080001
030900     MOVE PA-OUT-ONHAND   (01)         TO LS-OUT-ONHAND1          03090001
031000     MOVE PA-MESSAGE-CODE (01)         TO LS-MESSAGE-CODE1        03100001
031001     MOVE PA-OUT-SKU      (02)         TO LS-OUT-SKU2             03100101
031002     MOVE PA-OUT-LOC      (02)         TO LS-OUT-LOC2             03100201
031003     MOVE PA-OUT-ONHAND   (02)         TO LS-OUT-ONHAND2          03100301
031004     MOVE PA-MESSAGE-CODE (02)         TO LS-MESSAGE-CODE2        03100401
031005     MOVE PA-OUT-SKU      (03)         TO LS-OUT-SKU3             03100501
031006     MOVE PA-OUT-LOC      (03)         TO LS-OUT-LOC3             03100601
031007     MOVE PA-OUT-ONHAND   (03)         TO LS-OUT-ONHAND3          03100701
031008     MOVE PA-MESSAGE-CODE (03)         TO LS-MESSAGE-CODE3        03100801
031009     MOVE PA-OUT-SKU      (04)         TO LS-OUT-SKU4             03100901
031010     MOVE PA-OUT-LOC      (04)         TO LS-OUT-LOC4             03101001
031011     MOVE PA-OUT-ONHAND   (04)         TO LS-OUT-ONHAND4          03101101
031012     MOVE PA-MESSAGE-CODE (04)         TO LS-MESSAGE-CODE4        03101201
031013     MOVE PA-OUT-SKU      (05)         TO LS-OUT-SKU5             03101301
031014     MOVE PA-OUT-LOC      (05)         TO LS-OUT-LOC5             03101401
031015     MOVE PA-OUT-ONHAND   (05)         TO LS-OUT-ONHAND5          03101501
031016     MOVE PA-MESSAGE-CODE (05)         TO LS-MESSAGE-CODE5        03101601
031017     MOVE PA-OUT-SKU      (06)         TO LS-OUT-SKU6             03101701
031018     MOVE PA-OUT-LOC      (06)         TO LS-OUT-LOC6             03101801
031019     MOVE PA-OUT-ONHAND   (06)         TO LS-OUT-ONHAND6          03101901
031020     MOVE PA-MESSAGE-CODE (06)         TO LS-MESSAGE-CODE6        03102001
031021     MOVE PA-OUT-SKU      (07)         TO LS-OUT-SKU7             03102101
031022     MOVE PA-OUT-LOC      (07)         TO LS-OUT-LOC7             03102201
031023     MOVE PA-OUT-ONHAND   (07)         TO LS-OUT-ONHAND7          03102301
031024     MOVE PA-MESSAGE-CODE (07)         TO LS-MESSAGE-CODE7        03102401
031025     MOVE PA-OUT-SKU      (08)         TO LS-OUT-SKU8             03102501
031026     MOVE PA-OUT-LOC      (08)         TO LS-OUT-LOC8             03102601
031027     MOVE PA-OUT-ONHAND   (08)         TO LS-OUT-ONHAND8          03102701
031028     MOVE PA-MESSAGE-CODE (08)         TO LS-MESSAGE-CODE8        03102801
031029     MOVE PA-OUT-SKU      (09)         TO LS-OUT-SKU9             03102901
031030     MOVE PA-OUT-LOC      (09)         TO LS-OUT-LOC9             03103001
031031     MOVE PA-OUT-ONHAND   (09)         TO LS-OUT-ONHAND9          03103101
031032     MOVE PA-MESSAGE-CODE (09)         TO LS-MESSAGE-CODE9        03103201
031033     MOVE PA-OUT-SKU      (10)         TO LS-OUT-SKU10            03103301
031034     MOVE PA-OUT-LOC      (10)         TO LS-OUT-LOC10            03103401
031035     MOVE PA-OUT-ONHAND   (10)         TO LS-OUT-ONHAND10         03103501
031036     MOVE PA-MESSAGE-CODE (10)         TO LS-MESSAGE-CODE10       03103601
031037     MOVE PA-OUT-SKU      (11)         TO LS-OUT-SKU11            03103701
031038     MOVE PA-OUT-LOC      (11)         TO LS-OUT-LOC11            03103801
031039     MOVE PA-OUT-ONHAND   (11)         TO LS-OUT-ONHAND11         03103901
031040     MOVE PA-MESSAGE-CODE (11)         TO LS-MESSAGE-CODE11       03104001
031041     MOVE PA-OUT-SKU      (12)         TO LS-OUT-SKU12            03104101
031042     MOVE PA-OUT-LOC      (12)         TO LS-OUT-LOC12            03104201
031043     MOVE PA-OUT-ONHAND   (12)         TO LS-OUT-ONHAND12         03104301
031044     MOVE PA-MESSAGE-CODE (12)         TO LS-MESSAGE-CODE12       03104401
031045     MOVE PA-OUT-SKU      (13)         TO LS-OUT-SKU13            03104501
031046     MOVE PA-OUT-LOC      (13)         TO LS-OUT-LOC13            03104601
031047     MOVE PA-OUT-ONHAND   (13)         TO LS-OUT-ONHAND13         03104701
031048     MOVE PA-MESSAGE-CODE (13)         TO LS-MESSAGE-CODE13       03104801
031049     MOVE PA-OUT-SKU      (14)         TO LS-OUT-SKU14            03104901
031050     MOVE PA-OUT-LOC      (14)         TO LS-OUT-LOC14            03105001
031051     MOVE PA-OUT-ONHAND   (14)         TO LS-OUT-ONHAND14         03105101
031052     MOVE PA-MESSAGE-CODE (14)         TO LS-MESSAGE-CODE14       03105201
031053     MOVE PA-OUT-SKU      (15)         TO LS-OUT-SKU15            03105301
031054     MOVE PA-OUT-LOC      (15)         TO LS-OUT-LOC15            03105401
031055     MOVE PA-OUT-ONHAND   (15)         TO LS-OUT-ONHAND15         03105501
031056     MOVE PA-MESSAGE-CODE (15)         TO LS-MESSAGE-CODE15       03105601
031057     MOVE PA-OUT-SKU      (16)         TO LS-OUT-SKU16            03105701
031058     MOVE PA-OUT-LOC      (16)         TO LS-OUT-LOC16            03105801
031059     MOVE PA-OUT-ONHAND   (16)         TO LS-OUT-ONHAND16         03105901
031060     MOVE PA-MESSAGE-CODE (16)         TO LS-MESSAGE-CODE16       03106001
031061     MOVE PA-OUT-SKU      (17)         TO LS-OUT-SKU17            03106101
031062     MOVE PA-OUT-LOC      (17)         TO LS-OUT-LOC17            03106201
031063     MOVE PA-OUT-ONHAND   (17)         TO LS-OUT-ONHAND17         03106301
031064     MOVE PA-MESSAGE-CODE (17)         TO LS-MESSAGE-CODE17       03106401
031065     MOVE PA-OUT-SKU      (18)         TO LS-OUT-SKU18            03106501
031066     MOVE PA-OUT-LOC      (18)         TO LS-OUT-LOC18            03106601
031067     MOVE PA-OUT-ONHAND   (18)         TO LS-OUT-ONHAND18         03106701
031068     MOVE PA-MESSAGE-CODE (18)         TO LS-MESSAGE-CODE18       03106801
031069     MOVE PA-OUT-SKU      (19)         TO LS-OUT-SKU19            03106901
031070     MOVE PA-OUT-LOC      (19)         TO LS-OUT-LOC19            03107001
031071     MOVE PA-OUT-ONHAND   (19)         TO LS-OUT-ONHAND19         03107101
031072     MOVE PA-MESSAGE-CODE (19)         TO LS-MESSAGE-CODE19       03107201
031073     MOVE PA-OUT-SKU      (20)         TO LS-OUT-SKU20            03107301
031074     MOVE PA-OUT-LOC      (20)         TO LS-OUT-LOC20            03107401
031075     MOVE PA-OUT-ONHAND   (20)         TO LS-OUT-ONHAND20         03107501
031076     MOVE PA-MESSAGE-CODE (20)         TO LS-MESSAGE-CODE20       03107601
031077     MOVE PA-OUT-SKU      (21)         TO LS-OUT-SKU21            03107701
031078     MOVE PA-OUT-LOC      (21)         TO LS-OUT-LOC21            03107801
031079     MOVE PA-OUT-ONHAND   (21)         TO LS-OUT-ONHAND21         03107901
031080     MOVE PA-MESSAGE-CODE (21)         TO LS-MESSAGE-CODE21       03108001
031081     MOVE PA-OUT-SKU      (22)         TO LS-OUT-SKU22            03108101
031082     MOVE PA-OUT-LOC      (22)         TO LS-OUT-LOC22            03108201
031083     MOVE PA-OUT-ONHAND   (22)         TO LS-OUT-ONHAND22         03108301
031084     MOVE PA-MESSAGE-CODE (22)         TO LS-MESSAGE-CODE22       03108401
031085     MOVE PA-OUT-SKU      (23)         TO LS-OUT-SKU23            03108501
031086     MOVE PA-OUT-LOC      (23)         TO LS-OUT-LOC23            03108601
031087     MOVE PA-OUT-ONHAND   (23)         TO LS-OUT-ONHAND23         03108701
031088     MOVE PA-MESSAGE-CODE (23)         TO LS-MESSAGE-CODE23       03108801
031089     MOVE PA-OUT-SKU      (24)         TO LS-OUT-SKU24            03108901
031090     MOVE PA-OUT-LOC      (24)         TO LS-OUT-LOC24            03109001
031091     MOVE PA-OUT-ONHAND   (24)         TO LS-OUT-ONHAND24         03109101
031092     MOVE PA-MESSAGE-CODE (24)         TO LS-MESSAGE-CODE24       03109201
031093     MOVE PA-OUT-SKU      (25)         TO LS-OUT-SKU25            03109301
031094     MOVE PA-OUT-LOC      (25)         TO LS-OUT-LOC25            03109401
031095     MOVE PA-OUT-ONHAND   (25)         TO LS-OUT-ONHAND25         03109501
031096     MOVE PA-MESSAGE-CODE (25)         TO LS-MESSAGE-CODE25       03109601
031097     MOVE PA-OUT-SKU      (26)         TO LS-OUT-SKU26            03109701
031098     MOVE PA-OUT-LOC      (26)         TO LS-OUT-LOC26            03109801
031099     MOVE PA-OUT-ONHAND   (26)         TO LS-OUT-ONHAND26         03109901
031100     MOVE PA-MESSAGE-CODE (26)         TO LS-MESSAGE-CODE26       03110001
031101     MOVE PA-OUT-SKU      (27)         TO LS-OUT-SKU27            03110101
031102     MOVE PA-OUT-LOC      (27)         TO LS-OUT-LOC27            03110201
031103     MOVE PA-OUT-ONHAND   (27)         TO LS-OUT-ONHAND27         03110301
031104     MOVE PA-MESSAGE-CODE (27)         TO LS-MESSAGE-CODE27       03110401
031105     MOVE PA-OUT-SKU      (28)         TO LS-OUT-SKU28            03110501
031106     MOVE PA-OUT-LOC      (28)         TO LS-OUT-LOC28            03110601
031107     MOVE PA-OUT-ONHAND   (28)         TO LS-OUT-ONHAND28         03110701
031108     MOVE PA-MESSAGE-CODE (28)         TO LS-MESSAGE-CODE28       03110801
031109     MOVE PA-OUT-SKU      (29)         TO LS-OUT-SKU29            03110901
031110     MOVE PA-OUT-LOC      (29)         TO LS-OUT-LOC29            03111001
031111     MOVE PA-OUT-ONHAND   (29)         TO LS-OUT-ONHAND29         03111101
031112     MOVE PA-MESSAGE-CODE (29)         TO LS-MESSAGE-CODE29       03111201
031113     MOVE PA-OUT-SKU      (30)         TO LS-OUT-SKU30            03111301
031114     MOVE PA-OUT-LOC      (30)         TO LS-OUT-LOC30            03111401
031115     MOVE PA-OUT-ONHAND   (30)         TO LS-OUT-ONHAND30         03111501
031116     MOVE PA-MESSAGE-CODE (30)         TO LS-MESSAGE-CODE30       03111601
031117     MOVE PA-OUT-SKU      (31)         TO LS-OUT-SKU31            03111701
031118     MOVE PA-OUT-LOC      (31)         TO LS-OUT-LOC31            03111801
031119     MOVE PA-OUT-ONHAND   (31)         TO LS-OUT-ONHAND31         03111901
031120     MOVE PA-MESSAGE-CODE (31)         TO LS-MESSAGE-CODE31       03112001
031121     MOVE PA-OUT-SKU      (32)         TO LS-OUT-SKU32            03112101
031122     MOVE PA-OUT-LOC      (32)         TO LS-OUT-LOC32            03112201
031123     MOVE PA-OUT-ONHAND   (32)         TO LS-OUT-ONHAND32         03112301
031124     MOVE PA-MESSAGE-CODE (32)         TO LS-MESSAGE-CODE32       03112401
031125     MOVE PA-OUT-SKU      (33)         TO LS-OUT-SKU33            03112501
031126     MOVE PA-OUT-LOC      (33)         TO LS-OUT-LOC33            03112601
031127     MOVE PA-OUT-ONHAND   (33)         TO LS-OUT-ONHAND33         03112701
031128     MOVE PA-MESSAGE-CODE (33)         TO LS-MESSAGE-CODE33       03112801
031129     MOVE PA-OUT-SKU      (34)         TO LS-OUT-SKU34            03112901
031130     MOVE PA-OUT-LOC      (34)         TO LS-OUT-LOC34            03113001
031131     MOVE PA-OUT-ONHAND   (34)         TO LS-OUT-ONHAND34         03113101
031132     MOVE PA-MESSAGE-CODE (34)         TO LS-MESSAGE-CODE34       03113201
031133     MOVE PA-OUT-SKU      (35)         TO LS-OUT-SKU35            03113301
031134     MOVE PA-OUT-LOC      (35)         TO LS-OUT-LOC35            03113401
031135     MOVE PA-OUT-ONHAND   (35)         TO LS-OUT-ONHAND35         03113501
031136     MOVE PA-MESSAGE-CODE (35)         TO LS-MESSAGE-CODE35       03113601
031137     MOVE PA-OUT-SKU      (36)         TO LS-OUT-SKU36            03113701
031138     MOVE PA-OUT-LOC      (36)         TO LS-OUT-LOC36            03113801
031139     MOVE PA-OUT-ONHAND   (36)         TO LS-OUT-ONHAND36         03113901
031140     MOVE PA-MESSAGE-CODE (36)         TO LS-MESSAGE-CODE36       03114001
031141     MOVE PA-OUT-SKU      (37)         TO LS-OUT-SKU37            03114101
031142     MOVE PA-OUT-LOC      (37)         TO LS-OUT-LOC37            03114201
031143     MOVE PA-OUT-ONHAND   (37)         TO LS-OUT-ONHAND37         03114301
031144     MOVE PA-MESSAGE-CODE (37)         TO LS-MESSAGE-CODE37       03114401
031145     MOVE PA-OUT-SKU      (38)         TO LS-OUT-SKU38            03114501
031146     MOVE PA-OUT-LOC      (38)         TO LS-OUT-LOC38            03114601
031147     MOVE PA-OUT-ONHAND   (38)         TO LS-OUT-ONHAND38         03114701
031148     MOVE PA-MESSAGE-CODE (38)         TO LS-MESSAGE-CODE38       03114801
031149     MOVE PA-OUT-SKU      (39)         TO LS-OUT-SKU39            03114901
031150     MOVE PA-OUT-LOC      (39)         TO LS-OUT-LOC39            03115001
031151     MOVE PA-OUT-ONHAND   (39)         TO LS-OUT-ONHAND39         03115101
031152     MOVE PA-MESSAGE-CODE (39)         TO LS-MESSAGE-CODE39       03115201
031153     MOVE PA-OUT-SKU      (40)         TO LS-OUT-SKU40            03115301
031154     MOVE PA-OUT-LOC      (40)         TO LS-OUT-LOC40            03115401
031155     MOVE PA-OUT-ONHAND   (40)         TO LS-OUT-ONHAND40         03115501
031156     MOVE PA-MESSAGE-CODE (40)         TO LS-MESSAGE-CODE40       03115601
031157     MOVE PA-OUT-SKU      (41)         TO LS-OUT-SKU41            03115701
031158     MOVE PA-OUT-LOC      (41)         TO LS-OUT-LOC41            03115801
031159     MOVE PA-OUT-ONHAND   (41)         TO LS-OUT-ONHAND41         03115901
031160     MOVE PA-MESSAGE-CODE (41)         TO LS-MESSAGE-CODE41       03116001
031161     MOVE PA-OUT-SKU      (42)         TO LS-OUT-SKU42            03116101
031162     MOVE PA-OUT-LOC      (42)         TO LS-OUT-LOC42            03116201
031163     MOVE PA-OUT-ONHAND   (42)         TO LS-OUT-ONHAND42         03116301
031164     MOVE PA-MESSAGE-CODE (42)         TO LS-MESSAGE-CODE42       03116401
031165     MOVE PA-OUT-SKU      (43)         TO LS-OUT-SKU43            03116501
031166     MOVE PA-OUT-LOC      (43)         TO LS-OUT-LOC43            03116601
031167     MOVE PA-OUT-ONHAND   (43)         TO LS-OUT-ONHAND43         03116701
031168     MOVE PA-MESSAGE-CODE (43)         TO LS-MESSAGE-CODE43       03116801
031169     MOVE PA-OUT-SKU      (44)         TO LS-OUT-SKU44            03116901
031170     MOVE PA-OUT-LOC      (44)         TO LS-OUT-LOC44            03117001
031171     MOVE PA-OUT-ONHAND   (44)         TO LS-OUT-ONHAND44         03117101
031172     MOVE PA-MESSAGE-CODE (44)         TO LS-MESSAGE-CODE44       03117201
031173     MOVE PA-OUT-SKU      (45)         TO LS-OUT-SKU45            03117301
031174     MOVE PA-OUT-LOC      (45)         TO LS-OUT-LOC45            03117401
031175     MOVE PA-OUT-ONHAND   (45)         TO LS-OUT-ONHAND45         03117501
031176     MOVE PA-MESSAGE-CODE (45)         TO LS-MESSAGE-CODE45       03117601
031177     MOVE PA-OUT-SKU      (46)         TO LS-OUT-SKU46            03117701
031178     MOVE PA-OUT-LOC      (46)         TO LS-OUT-LOC46            03117801
031179     MOVE PA-OUT-ONHAND   (46)         TO LS-OUT-ONHAND46         03117901
031180     MOVE PA-MESSAGE-CODE (46)         TO LS-MESSAGE-CODE46       03118001
031181     MOVE PA-OUT-SKU      (47)         TO LS-OUT-SKU47            03118101
031182     MOVE PA-OUT-LOC      (47)         TO LS-OUT-LOC47            03118201
031183     MOVE PA-OUT-ONHAND   (47)         TO LS-OUT-ONHAND47         03118301
031184     MOVE PA-MESSAGE-CODE (47)         TO LS-MESSAGE-CODE47       03118401
031185     MOVE PA-OUT-SKU      (48)         TO LS-OUT-SKU48            03118501
031186     MOVE PA-OUT-LOC      (48)         TO LS-OUT-LOC48            03118601
031187     MOVE PA-OUT-ONHAND   (48)         TO LS-OUT-ONHAND48         03118701
031188     MOVE PA-MESSAGE-CODE (48)         TO LS-MESSAGE-CODE48       03118801
031189     MOVE PA-OUT-SKU      (49)         TO LS-OUT-SKU49            03118901
031190     MOVE PA-OUT-LOC      (49)         TO LS-OUT-LOC49            03119001
031191     MOVE PA-OUT-ONHAND   (49)         TO LS-OUT-ONHAND49         03119101
031192     MOVE PA-MESSAGE-CODE (49)         TO LS-MESSAGE-CODE49       03119201
031193     MOVE PA-OUT-SKU      (50)         TO LS-OUT-SKU50            03119301
031194     MOVE PA-OUT-LOC      (50)         TO LS-OUT-LOC50            03119401
031195     MOVE PA-OUT-ONHAND   (50)         TO LS-OUT-ONHAND50         03119501
031196     MOVE PA-MESSAGE-CODE (50)         TO LS-MESSAGE-CODE50.      03119601
031197                                                                  03119701
031203     MOVE ZEROS TO PA-INPUT-TABLE.                                03120301
031204     IF PS-DISPLAY-YES                                            03120412
031206         MOVE '9000-END            ' TO PV-PARAGRAPH-NAME         03120612
031207         PERFORM 9900-DISPLAY-PARAMETERS THRU 9900-EXIT           03120712
031208     END-IF.                                                      03120812
031209                                                                  03120909
031210 9900-DISPLAY-PARAMETERS.                                         03121009
031211                                                                  03121109
031212     EXEC SQL                                                     03121209
031213         SET :PV-DB2-TIMESTAMP      = CURRENT TIMESTAMP           03121309
031214     END-EXEC.                                                    03121409
031219                                                                  03121929
031220     DISPLAY ' '.                                                 03122009
031221     DISPLAY '** ' PC-PROGRAM-NAME ' INPUT PARAMETERS **'.        03122109
031223     DISPLAY '  PARAGRAPH      :  ' PV-PARAGRAPH-NAME.            03122323
031224     DISPLAY '  INFO LINE      :  ' PV-INFO-LINE.                 03122423
031225     DISPLAY '  TIMESTAMP      :  ' PV-DB2-TIMESTAMP.             03122529
031226     DISPLAY '  INFO LINE (EX) :  ' PV-INFO-LINE-2.               03122639
031227     DISPLAY ' '.                                                 03122723
031228     DISPLAY '  LS-IN-SKU1     :  ' LS-IN-SKU1.                   03122809
031229     DISPLAY '  LS-IN-SKU2     :  ' LS-IN-SKU2.                   03122909
031230     DISPLAY '  LS-IN-SKU3     :  ' LS-IN-SKU3.                   03123009
031239     DISPLAY ' '.                                                 03123909
031240     MOVE SPACES                 TO PV-INFO-LINE                  03124046
031241     MOVE SPACES                 TO PV-INFO-LINE-2.               03124146
031242                                                                  03124209
031243 9900-EXIT.                                                       03124309
031244     EXIT.                                                        03124409
031245                                                                  03124509
031246                                                                  03124609
031247                                                                  03124709
031248******************************************************************03124809
031249 9999-SQL-ABEND.                                                  03124909
031250******************************************************************03125009
031251                                                                  03125109
031252     DISPLAY ' '.                                                 03125209
031253     DISPLAY '** ' PC-PROGRAM-NAME ' INPUT PARAMETERS **'.        03125309
031254     DISPLAY '   SKU-NBR:  ' PA-IN-SKU(IN-SUB).                   03125409
031255     DISPLAY '  SQLCODE:   ' SQLCODE.                             03125509
031256     DISPLAY '  ABEND PARA: 7002-QUANTITY-CLOSE'.                 03125609
031257     DISPLAY ' '.                                                 03125709
031260                                                                  03126001
031270* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    03127001
031280* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         03128001
031290* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     03129001
031300* FORMAT.                                                         03130001
031400******************************************************************03140001
031500*    COPY DPPD004.                                                03150001
031600*                                                                 03160001
