000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKCS030.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  08-26-93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    W030 - PO SELECTION LIST                                   * 00090000
001000*                                                               * 00100000
001100*    THIS PROGRAM GENERATES A LIST OF PO'S BASED ON CRITERIA    * 00110000
001200*    PASSED FROM THE CRITERIA SPEC SCREEN.                      * 00120000
001300*                                                               * 00130000
001400*---------------------------------------------------------------* 00140000
W24803* 04/29/03 - LAXMAN BOLINENI, IGSI       WR 24803               * 00150000
W24803*          - THE LOGIC TO CONVERT SINGLE DIGIT OF CLASS INTO    * 00160000
W24803*            A CLASS RANGE IS REMOVED. AND REPLACED CLASS RANGE * 00170000
W24803*            VALIDATION IN THE PO-CSR CURSOR WITH MAJOR CLASS   * 00180000
W24803*            VALIDATION. ADDED NEW LOGIC TO VALIDATE THE VALUES * 00190000
W24803*            FOR DEPARTMENT, MAJOR CLASS, SUB CLASS AND SKU     * 00200000
W24803*            NUMBER GOT FROM POKCS028.                          * 00210000
W24803*          - RECOMPILED TO BRING THE NEW VERSION OF COPYBOOK    * 00220000
W24803*            POWS017.                                           * 00230000
W24803*---------------------------------------------------------------* 00240000
C98147* 10/20/14 - JOHN SELWITSCHKA                     CHG0098147      00250083
C98147*          - EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND            00260083
C98147*            COMMAREA. ADJUSTED MR-DOLLAR-LINE & MR-UNITS-LINE.   00270083
C98147*---------------------------------------------------------------* 00280080
263126*    CHANGED 10/27/2021    BY JIM HUNTER      WR: CHG0263126      00281084
263126*    CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE  00282084
263126*    MAKING THE CALL DYNAMIC VS STATIC.                           00283084
263126*----------------------------------------------------------------*00284084
CICS  *  CHANGED 11/10/2022    BY BARB SCHULTZ    WR: CHG0278485        00285086
CICS  *                                                                 00286085
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     00287085
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      00287185
CICS  *----------------------------------------------------------------*00288085
002100/                                                                 00290000
002200 ENVIRONMENT DIVISION.                                            00300000
002300                                                                  00310000
002400 DATA DIVISION.                                                   00320000
002500                                                                  00330000
002600 WORKING-STORAGE SECTION.                                         00340000
002700                                                                  00350000
002800 01  DK-DB2-KEYS.                                                 00360000
002900     05  DK-PO-NBR                 PIC S9(9) COMP VALUE +0.       00370000
003200     05  DK-STR-NBR                PIC S9(04) COMP VALUE +0.      00380000
003300     05  DK-AGRMT-TYP-ID           PIC X(01)  VALUE SPACES.       00390000
003400     05  DK-TYP-CDE                PIC S9(04) VALUE +0            00400000
003500                                              COMP.               00410000
003600                                                                  00420000
003700 01  PC-PROGRAM-CONSTANTS.                                        00430000
003800     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00440000
003900                                                    'PO030A  '.   00450000
004000     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00460000
004100                                                    'POKM030 '.   00470000
004200     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00480000
004300                                                    'POKCS030'.   00490000
004400     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00500000
004500                                                    COMP.         00510000
004600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00520000
004700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00530000
004800     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00540000
004900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00550000
005000                                                    COMP SYNC.    00560000
005100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00570000
005200                                                    COMP SYNC.    00580000
005300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00590000
005400                                                    +1000000      00600000
005500                                                    COMP-3.       00610000
005600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00620000
005700                                                    COMP SYNC.    00630000
005800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00640000
005900                                                    COMP-3.       00650000
006000     05  PC-CNT-MINUS-2                 PIC S9(04)  VALUE -2      00660000
006100                                                    COMP SYNC.    00670000
006200     05  PC-CNT-6                       PIC S9(04)  VALUE +6      00680000
006300                                                    COMP SYNC.    00690000
006400     05  PC-CNT-7                       PIC S9(04)  VALUE +7      00700000
006500                                                    COMP SYNC.    00710000
006600     05  PC-ACT                         PIC  X(03)  VALUE 'ACT'.  00720000
006700     05  PC-CMP                         PIC  X(03)  VALUE 'CMP'.  00730000
006800     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00740000
006900     05  PC-QUOTE                       PIC  X(01)  VALUE X'7D'.  00750000
                                                                        00760081
C98147     05  PC-DOLLAR-HEAD                 PIC  X(27)  VALUE         00770081
C98147         '    DOLLARS     DOLLARS PCT'.                           00780081
C98147     05  PC-DOLLAR-HEAD2                PIC  X(27)  VALUE         00790081
C98147         '    ORDERED    RECEIVED RCV'.                           00800081
C98147                                                                  00810081
C98147     05  PC-UNITS-HEAD                  PIC  X(27)  VALUE         00820081
C98147         ' UNITS   UNITS   PCT   AD  '.                           00830081
C98147     05  PC-UNITS-HEAD2                 PIC  X(27)  VALUE         00840081
C98147         'ORDERED RECEIVED RCV  DATE '.                           00850081
007800                                                                  00860000
007900                                                                  00870000
008000     05  PC-TSYMSG-NUMBERS.                                       00880000
008100         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00890000
008200         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00900000
008300         10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  00910000
008400         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00920000
008500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00930000
008600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00940000
008700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00950000
008800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00960000
008900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00970000
009000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00980000
009100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00990000
009200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01000000
009300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01010000
009400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01020000
009500         10  PC-TSYMSG-00168            PIC  9(05)  VALUE 00168.  01030000
009600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01040000
009700         10  PC-TSYMSG-00310            PIC  9(05)  VALUE 00310.  01050000
009710         10  PC-TSYMSG-00317            PIC  9(05)  VALUE 00317.  01060000
009800         10  PC-TSYMSG-00330            PIC  9(05)  VALUE 00330.  01070000
009900         10  PC-TSYMSG-00486            PIC  9(05)  VALUE 00486.  01080000
010000         10  PC-TSYMSG-00587            PIC  9(05)  VALUE 00587.  01090000
010100         10  PC-TSYMSG-00588            PIC  9(05)  VALUE 00588.  01100000
010200         10  PC-TSYMSG-00620            PIC  9(05)  VALUE 00620.  01110000
010300         10  PC-TSYMSG-00621            PIC  9(05)  VALUE 00621.  01120000
W24803         10  PC-TSYMSG-03068            PIC  9(05)  VALUE 03068.  01130000
W24803         10  PC-TSYMSG-03069            PIC  9(05)  VALUE 03069.  01140000
W24803         10  PC-TSYMSG-03070            PIC  9(05)  VALUE 03070.  01150000
W24803         10  PC-TSYMSG-03071            PIC  9(05)  VALUE 03071.  01160000
W24803         10  PC-TSYMSG-03072            PIC  9(05)  VALUE 03072.  01170000
W24803         10  PC-TSYMSG-03073            PIC  9(05)  VALUE 03073.  01180000
010400                                                                  01190000
010500 01  PS-PROGRAM-SWITCHES.                                         01200000
010510     05  PS-PURITM-SW                   PIC  X(01)  VALUE 'Y'.    01210000
010520         88  PS-206-PURITM                          VALUE 'Y'.    01220000
010530         88  PS-000-PURITM                          VALUE 'N'.    01230000
010600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01240000
010700         88  PS-NO-ERROR                            VALUE 'Y'.    01250000
010800         88  PS-ERROR                               VALUE 'N'.    01260000
010900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01270000
011000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01280000
011100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01290000
011200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01300000
011300         88  PS-DONE                                VALUE 'Y'.    01310000
011400         88  PS-NOT-DONE                            VALUE 'N'.    01320000
011500     05  PS-SKIP-SW                     PIC  X(01)  VALUE 'N'.    01330000
011600         88  PS-DONT-SKIP                           VALUE 'N'.    01340000
011700         88  PS-SKIP                                VALUE 'Y'.    01350000
011800     05  PS-TPURITM-SW                  PIC  X(01)  VALUE 'N'.    01360000
011900         88  PS-DONT-USE-TPURITM                    VALUE 'N'.    01370000
012000         88  PS-USE-TPURITM                         VALUE 'Y'.    01380000
012100     05  PS-TENTNME-SW                  PIC  X(01)  VALUE 'N'.    01390000
012200         88  PS-DONT-USE-TENTNME                    VALUE 'N'.    01400000
012300         88  PS-USE-TENTNME                         VALUE 'Y'.    01410000
012400                                                                  01420000
012500 01  PV-PROGRAM-VARIABLES.                                        01430000
012600     05  PV-HOLD-CC                     PIC X(02).                01440000
012610     05  PV-SUB                         PIC S9(04)  VALUE +0      01450000
012700                                                    COMP SYNC.    01460000
012800     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01470000
012900                                                    COMP SYNC.    01480000
013000     05  PV-SELECT-BYTES                PIC S9(04)  VALUE +78     01490000
013100                                                    COMP SYNC.    01500000
013200     05  PV-STRING-POINTER-FROM         PIC S9(04)  VALUE +0      01510000
013300                                                    COMP   SYNC.  01520000
013400     05  PV-STRING-POINTER-WHERE        PIC S9(04)  VALUE +0      01530000
013500                                                    COMP   SYNC.  01540000
013600     05  PV-TALLY-1                     PIC S9(04)  VALUE +0      01550000
013700                                                    COMP   SYNC.  01560000
013800     05  PV-TALLY-2                     PIC S9(04)  VALUE +0      01570000
013900                                                    COMP   SYNC.  01580000
014000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01590000
014100                                                    COMP-3.       01600000
014200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01610000
014300                                                    COMP-3.       01620000
014400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01630000
014500                                                    COMP-3.       01640000
014600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01650000
014700                                                    COMP-3.       01660000
014800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01670000
014900                                                    COMP-3.       01680000
015000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01690000
015100                                                    COMP-3.       01700000
015200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01710000
015300                                                    COMP-3.       01720000
015400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01730000
015500                                                    COMP SYNC.    01740000
015600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01750000
015700                                                    COMP SYNC.    01760000
015800     05  PV-ITEM                        PIC S9(04)  VALUE +0      01770000
015900                                                    COMP SYNC.    01780000
016000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01790000
016100                                                    COMP SYNC.    01800000
016200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01810000
016300                                                    COMP SYNC.    01820000
016400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01830000
016500                                                    COMP SYNC.    01840000
016600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01850000
016700                                                    COMP SYNC.    01860000
016800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01870000
016900                                                    COMP SYNC.    01880000
017000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01890000
017100                                                    COMP SYNC.    01900000
017200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01910000
017300                                                    COMP SYNC.    01920000
017400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01930000
017500                                                    COMP SYNC.    01940000
017600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01950000
017700                                                    COMP SYNC.    01960000
017800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01970000
017900                                                    COMP SYNC.    01980000
018000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01990000
018100                                                    COMP SYNC.    02000000
018200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02010000
018300                                                    COMP SYNC.    02020000
018400                                                                  02030000
018500     05  PV-NULL-IND                    PIC S9(04)  VALUE +0 COMP.02040000
018600                                                                  02050000
018700     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02060000
018800                                                    COMP-3.       02070000
018900     05  PV-DB2-COUNT2                  PIC S9(09)  VALUE +0      02080000
019000                                                    COMP-3.       02090000
019100     05  PV-DB2-DATE                    PIC  X(10).               02100000
019200     05  FILLER  REDEFINES PV-DB2-DATE.                           02110000
019300         10  PV-DB2-DATE-CC             PIC  X(02).               02120000
019400         10  PV-DB2-DATE-YY             PIC  X(02).               02130000
019500         10  FILLER                     PIC  X(01).               02140000
019600         10  PV-DB2-DATE-MM             PIC  X(02).               02150000
019700         10  FILLER                     PIC  X(01).               02160000
019800         10  PV-DB2-DATE-DD             PIC  X(02).               02170000
019900     05  PV-DISPLAY-DATE.                                         02180000
020000         10  PV-DISPLAY-DATE-MM         PIC  X(02).               02190000
020100         10  PV-DISPLAY-DATE-DD         PIC  X(02).               02200000
020200         10  PV-DISPLAY-DATE-YY         PIC  X(02).               02210000
020300     05  PV-DONT-SHIP-BEF-DTE           PIC  X(06).               02220000
020400     05  PV-CAN-IFNOT-SHIP-DTE          PIC  X(06).               02230000
020500     05  PV-AD-EVNT-DTE                 PIC  X(06).               02240000
020600                                                                  02250000
020700     05  PV-GP-DOLLARS-RECEIVED         PIC S9(15)V99 COMP-3.     02260000
020710     05  PV-DOLLARS-RECEIVED            PIC S9(15)V99 COMP-3.     02270000
020720     05  PV-UNITS-RECEIVED              PIC S9(15)    COMP-3.     02280000
020730     05  PV-PCT-AREA                    PIC S9(04)V999            02290000
020740                                                      COMP-3.     02300000
020750                                                                  02310000
020760     05  PV-TABLE-QUALIFIER.                                      02320000
020770         10 FILLER                      PIC X(03) VALUE 'DB2'.    02330000
W24803         10 PV-QUALIFIER                PIC X(01) VALUE ' '.      02340074
020790         10 FILLER                      PIC X(03) VALUE 'DBA'.    02350000
020800         10 FILLER                      PIC X(01) VALUE '.'.      02360000
020900                                                                  02370000
021000     05  PV-TABLE-QUALIFIER-COMMA.                                02380000
021100         10 FILLER                      PIC X(04) VALUE ',DB2'.   02390000
W24803         10 PV-QUALIFIER-COMMA          PIC X(01) VALUE ' '.      02400074
021300         10 FILLER                      PIC X(03) VALUE 'DBA'.    02410000
021400         10 FILLER                      PIC X(01) VALUE '.'.      02420000
021500                                                                  02430000
021600     05  PV-IMPRT-AGNT-PO-NBR           PIC 9(09) VALUE ZEROS.    02440000
021700     05  PV-ENT-NAME-DESC               PIC X(32) VALUE SPACES.   02450000
021800     05  PV-VEND-STYL-NME               PIC X(22) VALUE SPACES.   02460000
021900                                                                  02470000
022000     05  PV-SYSTEM-ID.                                            02480000
022100         10  FILLER                     PIC  X(04)  VALUE SPACE.  02490000
022200         10  PV-REGION-IND              PIC  X(01).               02500000
022300             88  PV-TEST-CICS                 VALUE 'T'.          02510000
022400             88  PV-QA-CICS                   VALUE 'Q'.          02520000
022500             88  PV-PROD-CICS                 VALUE 'P'.          02530000
022600             88  PV-LEARN-CICS                VALUE 'L'.          02540000
022700         10  FILLER                     PIC X(01)    VALUE SPACES.02550000
022800     05  FILLER                         PIC X(02)    VALUE SPACES.02560000
037000     05  MR-DOLLARS-PCT-SPACE           PIC X(02).                02570000
W24803     05  PV-SUB-CL.                                               02580000
W24803         10 FILLER                      PIC 9(02)    VALUE ZERO.  02590000
W24803         10 PV-SUB-CL-3-4               PIC 9(02).                02600000
W24803     05  PV-SUB-CLASS REDEFINES PV-SUB-CL                         02610000
W24803                                        PIC 9(04).                02620000
W24803     05  PV-MAJ-CL.                                               02630000
W24803         10 FILLER                      PIC 9(02)    VALUE ZERO.  02640000
W24803         10 PV-MAJ-CL-3                 PIC 9.                    02650071
W24803         10 FILLER                      PIC 9        VALUE ZERO.  02660071
W24803     05  PV-MAJ-CLASS  REDEFINES PV-MAJ-CL                        02670000
W24803                                        PIC 9(04).                02680000
W24803     05  PV-SKU-NBR                     PIC 9(08).                02690000
022900                                                                  02700000
023000*---------------------------------------------------------------* 02710000
023100*  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            * 02720000
023200*---------------------------------------------------------------* 02730000
023300                                                                  02740000
023400 01  PV-SQL-STMT.                                                 02750000
023500     49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.02760000
023600*        SELECT 078 LENGTH PLUS                                   02770000
023700*        FROM   100 LENGTH PLUS  (MAX)                            02780000
023800*        WHERE 1100 LENGTH       (MAX)                            02790000
W24803     49  PV-SQL-STMT-TEXT               PIC X(1600)  VALUE SPACES.02800000
024000                                                                  02810000
024100 01  PV-BUILD-SELECT-REC.                                         02820000
024200     05  PV-BUILD-SELECT-LEN            PIC S9(04)  COMP  VALUE 0 02830000
024300                                                          SYNC.   02840000
024400     05  PV-BUILD-SELECT-STMT.                                    02850000
024500         10  FILLER                     PIC  X(07)                02860000
024600                         VALUE 'SELECT '.                         02870000
024700         10  FILLER                     PIC  X(09)                02880000
024800                         VALUE 'DISTINCT '.                       02890000
024900         10  FILLER                     PIC  X(08)                02900000
025000                         VALUE 'A.PO_NBR'.                        02910000
025100         10  FILLER                     PIC  X(14)                02920000
025200                         VALUE ',A.OTB_PER_NBR'.                  02930000
025300         10  FILLER                     PIC  X(11)                02940000
025400                         VALUE ',A.DEPT_NBR'.                     02950000
025500         10  FILLER                     PIC  X(09)                02960000
025600                         VALUE ',A.ENT_ID'.                       02970000
025700         10  FILLER                     PIC  X(20)                02980000
025800                         VALUE ',C.DONT_SHIP_BEF_DTE'.            02990000
025900     05  PV-FROM-CLAUSE.                                          03000000
W24803         10  FILLER                     PIC  X(250).              03010073
026100                                                                  03020000
026200     05  PV-WHERE-CLAUSE.                                         03030000
W24803         10  FILLER                     PIC  X(1200).             03040073
026400                                                                  03050000
026500*---------------------------------------------------------------* 03060000
026600*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03070000
026700*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03080000
026800*   APPLICATION-SPECIFIC COMMAREA.                              * 03090000
026900*---------------------------------------------------------------* 03100000
027000 01  LQW-LIST-QUEUE-WORK-AREA.                                    03110000
027100     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  03120000
027200     05  LQW-ITEM-ENTRIES               OCCURS 13 TIMES           03130000
027300                                        INDEXED BY LQW-IDX.       03140000
027400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03150000
027500         10  LQW-TEMP-SELECTED-SW       PIC X(01).                03160000
027600         10  LQW-SELECTED-SW            PIC X(01).                03170000
027700             88  LQW-SELECT                         VALUE 'S'.    03180000
027800             88  LQW-DESELECT                       VALUE ' '.    03190000
C98147         10  LQW-PO-NBR                 PIC 9(08).                03200080
028000         10  LQW-DEPT-NBR               PIC X(03).                03210000
028100         10  LQW-VENDOR-NAME            PIC X(08).                03220000
028200         10  LQW-STATUS                 PIC X(02).                03230000
028300         10  LQW-OTB                    PIC X(04).                03240000
028400         10  LQW-SHIP-DATE              PIC X(06).                03250000
028500         10  LQW-CANCEL-DATE            PIC X(06).                03260000
028600         10  LQW-EDI-IND                PIC X(01).                03270000
028700         10  LQW-DOLLARS-ORDERED        PIC 9(08)V99.             03280000
028800         10  LQW-DOLLARS-RECEIVED       PIC 9(08)V99.             03290000
028900         10  LQW-DOLLARS-RCVD-PCT       PIC 9(04).                03300000
029000         10  LQW-TOT-UNIT-ORDERED       PIC 9(07).                03310000
029100         10  LQW-TOT-UNIT-RCVD          PIC 9(07).                03320000
029200         10  LQW-TOT-UNIT-RCVD-PCT      PIC 9(04).                03330000
029300         10  LQW-AD-EVNT-DATE           PIC X(06).                03340000
029400         10  LQW-IP-IND                 PIC X(01).                03350000
029500                                                                  03360000
029600/                                                                 03370000
029700*---------------------------------------------------------------* 03380000
029800*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03390000
029900*---------------------------------------------------------------* 03400000
030000                                                                  03410000
030100     COPY POWS012.                                                03420000
030200                                                                  03430000
030300/                                                                 03440000
030400*---------------------------------------------------------------* 03450000
030500*    MAP LAYOUT                                                 * 03460000
030600*---------------------------------------------------------------* 03470000
030700                                                                  03480000
030800     COPY POKM030.                                                03490000
030900                                                                  03500000
031000 01  MR-OCCURS-LAYOUT                   REDEFINES  PO030AO.       03510000
C98147     05  FILLER                         PIC X(112).               03520082
031200                                                                  03530000
031300     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          03540000
031400         10  MR-SELECTL                 PIC S9(04) COMP.          03550000
031500         10  MR-SELECTA                 PIC X(01).                03560000
031600         10  MR-SELECTC                 PIC X(01).                03570000
031700         10  MR-SELECTH                 PIC X(01).                03580000
031800         10  MR-SELECT                  PIC X(01).                03590000
031900                                                                  03600000
032000*        10  FILLER                     PIC X(05).                03610000
032100         10  MR-PO-NBRL                 PIC S9(04) COMP.          03620000
032200         10  MR-PO-NBRA                 PIC X(01).                03630000
032300         10  MR-PO-NBRC                 PIC X(01).                03640000
032400         10  MR-PO-NBRH                 PIC X(01).                03650000
032500         10  MR-PO-NBR-X.                                         03660000
C98147             15  MR-PO-NBR              PIC ZZZZZZZZ.             03670080
032700                                                                  03680000
032800         10  FILLER                     PIC X(05).                03690081
032900         10  MR-DEPT-NBR                PIC X(03).                03700000
033000                                                                  03710000
033100         10  FILLER                     PIC X(05).                03720000
033200         10  MR-VENDOR-NAME             PIC X(10).                03730000
033300                                                                  03740000
033400         10  FILLER                     PIC X(05).                03750000
033500         10  MR-STATUS                  PIC X(02).                03760000
033600                                                                  03770000
033700         10  FILLER                     PIC X(05).                03780000
033800         10  MR-OTB                     PIC X(04).                03790000
033900                                                                  03800000
034000         10  FILLER                     PIC X(05).                03810000
034100         10  MR-SHIP-DATE               PIC X(06).                03820000
034200                                                                  03830000
034300         10  FILLER                     PIC X(05).                03840000
034400         10  MR-CANCEL-DATE             PIC X(06).                03850000
034500                                                                  03860000
034600         10  FILLER                     PIC X(05).                03870000
034700         10  MR-EDI-IND                 PIC X(01).                03880000
034800                                                                  03890000
034900         10  FILLER                     PIC X(05).                03900000
C98147         10  MR-LINE-AREA               PIC X(28).                03910081
035100                                                                  03920000
035200*    05  FILLER                     PIC X(05).                    03930000
035300*    05  MR-TOTAL-DOLLAR-ORD        PIC ZZZZZZZZ.99.              03940000
035400*    05  MR-TOTAL-DOLLAR-REC        PIC ZZZZZZZZ.99.              03950000
035500*    05  MR-TOTAL-UNITS-ORD         PIC ZZZZZZ9.                  03960000
035600                                                                  03970000
035700 01  MR-TOTAL-LINE.                                               03980000
035800     05  FILLER                         PIC X(18).                03990000
035900                                                                  04000000
036000 01  MR-DOLLAR-LINE.                                              04010000
036100     05  FILLER                         PIC X(01)   VALUE SPACE.  04020000
036200     05  MR-DOLLARS-ORDERED-X.                                    04030000
036300         10  MR-DOLLARS-ORDERED         PIC ZZZZZZZZ.99.          04040000
036400     05  FILLER                         PIC X(01).                04050000
036500     05  MR-DOLLARS-RECEIVED-X.                                   04060000
036600         10  MR-DOLLARS-RECEIVED        PIC ZZZZZZZZ.99.          04070000
036800     05  MR-DOLLARS-RCVD-PCT-X.                                   04080000
036900         10  MR-DOLLARS-RCVD-PCT        PIC ZZZZ.                 04090000
037000*    05  MR-DOLLARS-PCT-SPACE           PIC X(02).                04100000
037100                                                                  04110000
037200 01  MR-UNITS-LINE.                                               04120000
037300     05  MR-UNITS-ORDERED-X.                                      04130000
037400         10  MR-UNITS-ORDERED           PIC ZZZZZZ9.              04140000
037500     05  FILLER                         PIC X(01).                04150000
037600     05  MR-UNITS-RECEIVED-X.                                     04160000
037700         10  MR-UNITS-RECEIVED          PIC ZZZZZZ9.              04170000
C98147     05  FILLER                         PIC X(01).                04180081
037900     05  MR-UNITS-RCVD-PCT-X.                                     04190000
038000         10  MR-UNITS-RCVD-PCT          PIC ZZZZ.                 04200000
038100     05  MR-UNITS-PCT-SPACE             PIC X(02).                04210000
038200     05  MR-AD-EVNT-DTE                 PIC X(06).                04220000
038300                                                                  04230000
038400 01  MR-DOLLARS-TOTAL.                                            04240000
038500     05  MR-DOLLARS-ORDERED-TOT         PIC ZZZZZZZZZZ9.          04250000
038600     05  FILLER                         PIC X(01).                04260000
038700     05  MR-DOLLARS-RECEIVED-TOT        PIC ZZZZZZZZZ9.           04270000
038800     05  FILLER                         PIC X(01).                04280000
038900     05  MR-DOLLARS-RCVD-PCT-TOT-X.                               04290000
039000         10  MR-DOLLARS-RCVD-PCT-TOT    PIC ZZZ9.                 04300000
039100     05  FILLER                         PIC X(02) VALUE '% '.     04310000
039200                                                                  04320000
039300 01  MR-UNITS-TOTAL.                                              04330000
039400     05  MR-UNITS-ORDERED-TOT           PIC ZZZZZZ9.              04340000
039500     05  FILLER                         PIC X(01).                04350000
039600     05  MR-UNITS-RECEIVED-TOT          PIC ZZZZZZ9.              04360000
039700     05  FILLER                         PIC X(02).                04370000
039800     05  MR-UNITS-RCVD-PCT-TOT-X.                                 04380000
039900         10  MR-UNITS-RCVD-PCT-TOT      PIC ZZZ9.                 04390000
040000     05  FILLER                         PIC X(02) VALUE '% '.     04400000
040100     05  FILLER                         PIC X(06) VALUE SPACES.   04410000
040200                                                                  04420000
040300/                                                                 04430000
040400*---------------------------------------------------------------* 04440000
040500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04450000
040600*---------------------------------------------------------------* 04460000
040700                                                                  04470000
040800     COPY DPWS015.                                                04480000
040900                                                                  04490000
041000*---------------------------------------------------------------* 04500000
041100*    FUNCTION KEYS COPYBOOK.                                    * 04510000
041200*---------------------------------------------------------------* 04520000
041300                                                                  04530000
041400     COPY DPWS016.                                                04540000
041500                                                                  04550000
041600*---------------------------------------------------------------* 04560000
041700*    NUMERIC EDIT LAYOUT.                                       * 04570000
041800*---------------------------------------------------------------* 04580000
041900                                                                  04590000
042000     COPY DPWS010I.                                               04600000
042100                                                                  04610000
042200/                                                                 04620000
042300*---------------------------------------------------------------* 04630000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04640085
042500*---------------------------------------------------------------* 04650000
042600                                                                  04660000
042700     COPY DPWS030.                                                04670000
CICS       COPY DPWS930.                                                04671085
042800                                                                  04680000
042900/                                                                 04690000
043000*---------------------------------------------------------------* 04700000
043100*    STANDARD COMMAREA.                                         * 04710000
043200*---------------------------------------------------------------* 04720000
043300                                                                  04730000
043400     COPY DPWS020.                                                04740000
043500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04750000
043600                                                                  04760000
043700*---------------------------------------------------------------* 04770000
043800* INTER-APPLICATION COMMAREA.                                   * 04780000
043900*---------------------------------------------------------------* 04790000
044000                                                                  04800000
044100         10  INTER-APPL-COMM-AREA       PIC X(200).               04810000
044200     COPY POWS013.                                                04820000
044300     COPY POWS017.                                                04830000
044800*---------------------------------------------------------------* 04840000
044900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04850000
045000*---------------------------------------------------------------* 04860000
045100         10  ASC-SPECIFIC-COMMAREA.                               04870000
045400             15  ASC-LIST-KEYS.                                   04880000
045500                 20  ASC-KEY-PO-NBR       PIC S9(9) COMP.         04890000
045600                 20  ASC-KEY-IMPRT-AGNT-PO-NBR                    04900000
045700                                          PIC S9(9) COMP.         04910000
045800                 20  ASC-KEY-DEPT-NBR     PIC X(3).               04920000
W24803                 20  ASC-KEY-MAJ-CL-NBR   PIC 9(4).               04930000
W24803                 20  ASC-KEY-SUB-CL-NBR   PIC 9(4).               04940000
W24803                 20  ASC-KEY-SKU-NBR      PIC 9(8).               04950000
046100                 20  ASC-KEY-STATUS-CDE   PIC X(2).               04960000
046200                 20  ASC-KEY-STATUS-CLS   PIC X(3).               04970000
046300                 20  ASC-KEY-PO-TYP-CDE   PIC X(2).               04980000
046400                 20  ASC-KEY-STR-NBR      PIC S9(04) COMP.        04990000
046500                 20  ASC-KEY-EDI-IND      PIC X(1).               05000000
046600                 20  ASC-KEY-PRE-TICKET-IND    PIC X(1).          05010000
046700                 20  ASC-KEY-PIC-AD-IND        PIC X(1).          05020000
046800                 20  ASC-KEY-DIR-STORE-IND     PIC X(1).          05030000
046900                 20  ASC-KEY-NEW-STR-IND       PIC X(1).          05040000
047000                 20  ASC-KEY-PACK-BY-STORE-IND PIC X(1).          05050000
047100                 20  ASC-KEY-AD-EVNT-DTE  PIC X(10).              05060000
047210                 20  ASC-KEY-OTB-PER-NBR-BEG PIC X(06).           05070000
047310                 20  ASC-KEY-OTB-PER-NBR-END PIC X(06).           05080000
047400                 20  ASC-KEY-DONT-SHIP-BEF-DTE-B                  05090000
047500                                             PIC X(10).           05100000
047600                 20  ASC-KEY-DONT-SHIP-BEF-DTE-E                  05110000
047700                                             PIC X(10).           05120000
047800                 20  ASC-KEY-ENT-NAME-DESC   PIC X(30).           05130000
047900                 20  ASC-KEY-VEND-STYL-NME   PIC X(20).           05140000
048000             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           05150000
048100                 20  ASC-BLOCK-MODIFIED-SW                        05160000
048200                                        PIC X(01).                05170000
048300                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     05180000
048400                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     05190000
048500                                                                  05200000
048600                 20  ASC-ITEM-ARRAY.                              05210000
048700                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        05220000
048800                         30  ASC-LIST-ITEM-NUMBER                 05230000
048900                                        PIC S9(09) COMP-3.        05240000
049000                         30  ASC-TEMP-SELECTED-SW                 05250000
049100                                        PIC X(01).                05260000
049200                             88  ASC-VALID-SELECT  VALUE ' '      05270000
049300                                                         'S'      05280000
049400                                                         'B'      05290000
049500                                                         'E'.     05300000
049600                             88  ASC-TEMP-NO-SELECT               05310000
049700                                                   VALUE ' '.     05320000
049800                             88  ASC-TEMP-SELECT   VALUE 'S'.     05330000
049900                             88  ASC-TEMP-BEGIN    VALUE 'B'.     05340000
050000                             88  ASC-TEMP-END      VALUE 'E'.     05350000
050100                         30  ASC-SELECTED-SW                      05360000
050200                                        PIC X(01).                05370000
050300                             88  ASC-NO-SELECT     VALUE ' '.     05380000
050400                             88  ASC-SELECT        VALUE 'S'.     05390000
050500                             88  ASC-BEGIN         VALUE 'B'.     05400000
050600                             88  ASC-END           VALUE 'E'.     05410000
C98147                         30  ASC-PO-NBR            PIC 9(08).     05420080
050800                         30  ASC-DEPT-NBR          PIC X(03).     05430000
050900                         30  ASC-VENDOR-NAME       PIC X(08).     05440000
051000                         30  ASC-STATUS            PIC X(02).     05450000
051100                         30  ASC-OTB               PIC X(04).     05460000
051200                         30  ASC-SHIP-DATE         PIC X(06).     05470000
051300                         30  ASC-CANCEL-DATE       PIC X(06).     05480000
051400                         30  ASC-EDI-IND           PIC X(01).     05490000
051500                         30  ASC-DOLLARS-ORDERED   PIC 9(08)V99.  05500000
051600                         30  ASC-DOLLARS-RECEIVED  PIC 9(08)V99.  05510000
051700                         30  ASC-DOLLARS-RCVD-PCT  PIC 9(04).     05520000
051800                         30  ASC-TOT-UNIT-ORDERED  PIC 9(07).     05530000
051900                         30  ASC-TOT-UNIT-RCVD     PIC 9(07).     05540000
052000                         30  ASC-TOT-UNIT-RCVD-PCT PIC 9(04).     05550000
052100                         30  ASC-AD-EVNT-DTE       PIC X(06).     05560000
052200                         30  ASC-IP-IND            PIC X(01).     05570000
052300                                                                  05580000
052400             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     05590000
052500             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     05600000
052600             15  ASC-NUMBER-OF-ITEMS-READ                         05610000
052700                                        PIC S9(09) COMP-3.        05620000
052800             15  ASC-NUMBER-OF-SELECTED-ITEMS                     05630000
052900                                        PIC S9(09) COMP-3.        05640000
053000             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        05650000
053100             15  ASC-ITEM-AT-TOP-OF-PANEL                         05660000
053200                                        PIC S9(09) COMP-3.        05670000
053300             15  ASC-ITEM-AT-BOT-OF-PANEL                         05680000
053400                                        PIC S9(09) COMP-3.        05690000
053500             15  ASC-HIGHEST-BLOCK-WRITTEN                        05700000
053600                                        PIC S9(04) COMP SYNC.     05710000
053700             15  ASC-START-OF-SELECTED-RANGE                      05720000
053800                                        PIC S9(09) COMP-3.        05730000
053900             15  ASC-END-OF-SELECTED-RANGE                        05740000
054000                                        PIC S9(09) COMP-3.        05750000
054100             15  ASC-ITEMS-LEFT-INDICATOR                         05760000
054200                                        PIC X(01).                05770000
054300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05780000
054400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05790000
054500             15  ASC-TEMP-QUEUE-UPDATE-SW                         05800000
054600                                        PIC X(01).                05810000
054700                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05820000
054800                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05830000
054900             15  ASC-LIST-QUEUE-NAME.                             05840000
055000                 20  ASC-LIST-TERM-ID   PIC X(04).                05850000
055100                 20  ASC-LIST-TASK-NUMBER                         05860000
055200                                        PIC S9(05) COMP-3.        05870000
055300                 20  ASC-LIST-SEQ       PIC 9(01).                05880000
055400             15  ASC-SEL-QUEUE-NAME.                              05890000
055500                 20  ASC-SEL-TERM-ID    PIC X(04).                05900000
055600                 20  ASC-SEL-TASK-NUMBER                          05910000
055700                                        PIC S9(05) COMP-3.        05920000
055800                 20  ASC-SEL-SEQ        PIC 9(01).                05930000
055900                                                                  05940000
056000             15  ASC-CURSOR-SW          PIC X(01).                05950000
056100                 88  ASC-NO-CURSOR                 VALUE 'Z'.     05960000
056200                 88  ASC-TYPE-CURSOR               VALUE 'S'.     05970000
056300                 88  ASC-LOC-CURSOR                VALUE 'N'.     05980000
056400                 88  ASC-DESC-CURSOR               VALUE 'T'.     05990000
056500             15  ASC-START-ITEM-REQUEST.                          06000000
056600                 20  ASC-START-ITEM-REQUEST-N                     06010000
056700                                        PIC 9(07).                06020000
056800             15  ASC-DISPLAY-SW         PIC X(01).                06030000
056900                 88  ASC-DISPLAY-DOLLAR            VALUE 'D'.     06040000
057000                 88  ASC-DISPLAY-UNITS             VALUE 'U'.     06050000
057002             15  ASC-DOLLAR-ORD-TOT     PIC S9(10)V99.            06060000
057003             15  ASC-DOLLAR-REC-TOT     PIC S9(10)V99.            06070000
057010             15  ASC-UNIT-ORD-TOT       PIC S9(08).               06080000
057020             15  ASC-UNIT-REC-TOT       PIC S9(08).               06090000
W24803         10 FILLER                      PIC X(205).               06100000
057100/                                                                 06110000
057200*---------------------------------------------------------------* 06120000
057300*    ABEND PROCESSING COPYBOOK.                                 * 06130000
057400*---------------------------------------------------------------* 06140000
057500                                                                  06150000
057600     COPY DPWS013.                                                06160000
057700                                                                  06170000
057800/                                                                 06180000
057900*---------------------------------------------------------------* 06190000
058000*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 06200000
058100*---------------------------------------------------------------* 06210000
058200     EXEC SQL                                                     06220000
058300          INCLUDE TPURCHS                                         06230000
058400     END-EXEC.                                                    06240000
058500                                                                  06250000
058600/                                                                 06260000
058700*---------------------------------------------------------------* 06270000
058800*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 06280000
058900*---------------------------------------------------------------* 06290000
059000     EXEC SQL                                                     06300000
059100          INCLUDE TPURITM                                         06310000
059200     END-EXEC.                                                    06320000
059300                                                                  06330000
059400/                                                                 06340000
059500*---------------------------------------------------------------* 06350000
059600*    DB2 AREA FOR THE PLANNED SHIPMENTS TABLE                   * 06360000
059700*---------------------------------------------------------------* 06370000
059800     EXEC SQL                                                     06380000
059900          INCLUDE TPLNSHP                                         06390000
060000     END-EXEC.                                                    06400000
060100                                                                  06410000
060200/                                                                 06420000
060300*---------------------------------------------------------------* 06430000
060400*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 06440000
060500*---------------------------------------------------------------* 06450000
060600     EXEC SQL                                                     06460000
060700          INCLUDE TENTNME                                         06470000
060800     END-EXEC.                                                    06480000
060900                                                                  06490000
061000/                                                                 06500000
061100*---------------------------------------------------------------* 06510000
061200*    DB2 AREA FOR THE MERCHANDISE STORE DISTRIBUTION            * 06520000
061300*---------------------------------------------------------------* 06530000
061400     EXEC SQL                                                     06540000
061500          INCLUDE TMESTDS                                         06550000
061600     END-EXEC.                                                    06560000
061700                                                                  06570000
061800/                                                                 06580000
061900*---------------------------------------------------------------* 06590000
062000*    DB2 AREA FOR THE PURCHASE ORDER AGREEMENT TABLE            * 06600000
062100*---------------------------------------------------------------* 06610000
062200     EXEC SQL                                                     06620000
062300          INCLUDE TPOAGMT                                         06630000
062400     END-EXEC.                                                    06640000
062500                                                                  06650000
062600/                                                                 06660000
062700*---------------------------------------------------------------* 06670000
062800*    DB2 AREA FOR THE STATUS CODE TABLE                         * 06680000
062900*---------------------------------------------------------------* 06690000
063000     EXEC SQL                                                     06700000
063100          INCLUDE TSTATCD                                         06710000
063200     END-EXEC.                                                    06720000
063300                                                                  06730000
063400/                                                                 06740000
063500*---------------------------------------------------------------* 06750000
063600*    DB2 AREA FOR THE TYPE CODE TABLE                           * 06760000
063700*---------------------------------------------------------------* 06770000
063800     EXEC SQL                                                     06780000
063900          INCLUDE TPOTYCD                                         06790000
064000     END-EXEC.                                                    06800000
064100                                                                  06810000
064200/                                                                 06820000
064300*---------------------------------------------------------------* 06830000
064400*    DB2 AREA FOR THE STORE TABLE                               * 06840000
064500*---------------------------------------------------------------* 06850000
064600     EXEC SQL                                                     06860076
064700          INCLUDE XMT00001                                        06870076
064800     END-EXEC.                                                    06880076
064900                                                                  06890000
065000/                                                                 06900000
065100*---------------------------------------------------------------* 06910000
065200*    DB2 AREA FOR THE MERCHANDISE AREA TABLE                     *06920000
065300*---------------------------------------------------------------* 06930000
065400                                                                  06940000
065500     EXEC SQL                                                     06950000
065600         INCLUDE TMDSEAR                                          06960000
065700     END-EXEC.                                                    06970000
065800                                                                  06980000
065900/                                                                 06990000
066000*---------------------------------------------------------------* 07000000
066100*    DB2 AREA FOR THE RECEIVING ITEM TABLE                     *  07010000
066200*---------------------------------------------------------------* 07020000
066300                                                                  07030000
066400     EXEC SQL                                                     07040000
066500         INCLUDE TRECITM                                          07050000
066600     END-EXEC.                                                    07060000
066700                                                                  07070000
066800                                                                  07080000
066900/                                                                 07090000
067000*---------------------------------------------------------------* 07100000
067100*    DB2 AREA FOR THE RECEIVING DISTRIBUTION TABLE             *  07110000
067200*---------------------------------------------------------------* 07120000
067300                                                                  07130000
067400     EXEC SQL                                                     07140000
067500         INCLUDE TRECDIS                                          07150000
067600     END-EXEC.                                                    07160000
067700                                                                  07170000
067800/                                                                 07180000
067900*---------------------------------------------------------------* 07190000
068000*    DB2 AREA FOR THE RECEIVING TABLE                          *  07200000
068100*---------------------------------------------------------------* 07210000
068200                                                                  07220000
068300     EXEC SQL                                                     07230000
068400         INCLUDE TRECEIV                                          07240000
068500     END-EXEC.                                                    07250000
068600                                                                  07260000
W24803*---------------------------------------------------------------* 07270000
W24803*    DB2 AREA FOR XLT_SKU TABLE                                 * 07280000
W24803*---------------------------------------------------------------* 07290000
W24803*                                                                 07300000
W24803     EXEC SQL                                                     07310000
W24803          INCLUDE XLT00003                                        07320000
W24803     END-EXEC.                                                    07330000
W24803*                                                                 07340000
W24803*---------------------------------------------------------------* 07350000
W24803*    DB2 AREA FOR XLT_VND_STYL TABLE                            * 07360000
W24803*---------------------------------------------------------------* 07370000
W24803*                                                                 07380000
W24803     EXEC SQL                                                     07390000
W24803          INCLUDE XLT00004                                        07400000
W24803     END-EXEC.                                                    07410000
W24803*                                                                 07420000
068700*---------------------------------------------------------------* 07430000
068800*    DB2 AREA FOR COMMUNICATIONS                                * 07440000
068900*---------------------------------------------------------------* 07450000
069000     EXEC SQL                                                     07460000
069100          INCLUDE SQLCA                                           07470000
069200     END-EXEC.                                                    07480000
069300                                                                  07490000
069400/                                                                 07500000
069500/                                                                 07510000
069600 LINKAGE SECTION.                                                 07520000
069700                                                                  07530000
069800 01  DFHCOMMAREA.                                                 07540000
069900     05  FILLER                         OCCURS  1 TO 4072 TIMES   07550000
070000                                        DEPENDING ON EIBCALEN.    07560000
070100         10  FILLER                     PIC X.                    07570000
070200                                                                  07580000
070300/                                                                 07590000
070400 PROCEDURE DIVISION.                                              07600000
070500*---------------------------------------------------------------* 07610000
070600*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 07620000
070700*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 07630000
070800*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 07640000
070900*---------------------------------------------------------------* 07650000
071000 0000-MAIN-MODULE.                                                07660000
071100                                                                  07670000
071200     INITIALIZE DP030-CICS-API-FIELDS.                            07680000
071300                                                                  07690000
071400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07700000
071500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07710000
071600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07720000
071700                                                                  07730000
071800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07740000
071900                                                                  07750000
072000     MOVE LENGTH OF PO030AI        TO DP030-MAP-LENGTH (1).       07760000
072100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07770000
072200                                                                  07780000
072300     PERFORM 0001-CALL-CICS-ARCH-API.                             07790000
072400     PERFORM 1000-CONTROL-PROCESSING                              07800000
072500                                                                  07810000
072600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07820000
072700     PERFORM 0001-CALL-CICS-ARCH-API.                             07830000
072800                                                                  07840000
072900*---------------------------------------------------------------* 07850000
073000*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 07860000
073100*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 07870000
073200*---------------------------------------------------------------* 07880000
073300 0001-CALL-CICS-ARCH-API.                                         07890000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07900085
073500                                    DFHCOMMAREA                   07910085
073600                                    DP030-CICS-API-FIELDS         07920085
073700                                    DP020-STANDARD-COMMAREA       07930085
073800                                    PO030AI.                      07940085
073900                                                                  07950000
074000     IF  DP030-RC-CALL-SUCCESSFUL                                 07960000
074100         CONTINUE                                                 07970000
074200     ELSE                                                         07980000
074300         SET DP013-NO-ROLLBACK                                    07990000
074400             DP013-XCTL-DISPLAY-RESTART                           08000000
074500             DP013-CICS-ABEND      TO TRUE                        08010000
074600         MOVE '0001-CALL-CICS-ARCH-API'                           08020000
074700                                   TO DP013-PARAGRAPH             08030000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08040085
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08050085
075000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08060000
075100         PERFORM DP013-0000-PROCESS-ABEND                         08070000
075200     END-IF.                                                      08080000
075300                                                                  08090000
075400*----------------------------------------------------------------*08100000
075500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08110000
075600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08120000
075700*                                                                *08130000
075800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08140000
075900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08150000
076000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08160000
076100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08170000
076200*----------------------------------------------------------------*08180000
076300                                                                  08190000
076400 1000-CONTROL-PROCESSING.                                         08200000
076500                                                                  08210000
076600     EVALUATE TRUE                                                08220000
076700         WHEN DP020-NEXT-ACT-INITIAL                              08230000
076800             INITIALIZE ASC-SPECIFIC-COMMAREA                     08240000
076900                                                                  08250000
077500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08260000
077600                                      ASC-SEL-TERM-ID             08270000
077700             MOVE DP020-SRC-TASK-NUMBER                           08280000
077800                                   TO ASC-LIST-TASK-NUMBER        08290000
077900                                      ASC-SEL-TASK-NUMBER         08300000
078000             MOVE PC-LIST-QUEUE-SEQ                               08310000
078100                                   TO ASC-LIST-SEQ                08320000
078200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 08330000
078300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08340000
078400             IF  PS-COMMAREA-NOT-VALID                            08350000
078500                 SET DP020-NEXT-ACT-APPL-ERROR                    08360000
078600                                   TO TRUE                        08370000
078700             ELSE                                                 08380000
078800                 PERFORM 4000-BUILD-INITIAL-PANEL                 08390000
078900             END-IF                                               08400000
079000                                                                  08410000
079100         WHEN DP020-NEXT-ACT-READ-MAP                             08420000
079200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08430000
079300                                   TO PV-TOP-ITEM                 08440000
079400             PERFORM 2000-PROCESS-PANEL                           08450000
079500                                                                  08460000
079600         WHEN DP020-NEXT-ACT-RETURN                               08470000
079700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08480000
079800                                   TO PV-TOP-ITEM                 08490000
079900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08500000
080000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08510000
080100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08520000
080200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08530000
080300                                                                  08540000
080400         WHEN OTHER                                               08550000
080500             SET DP013-LOGIC-ABEND TO TRUE                        08560000
080600             SET DP013-NO-ROLLBACK TO TRUE                        08570000
080700             MOVE '1000-CONTROL-PROCESSING'                       08580000
080800                                   TO DP013-PARAGRAPH             08590000
080900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08600000
081000                                   TO DP013-MESSAGE-TEXT(1)       08610000
081100             PERFORM DP013-0000-PROCESS-ABEND                     08620000
081200     END-EVALUATE.                                                08630000
081300                                                                  08640000
081400/                                                                 08650000
081500*----------------------------------------------------------------*08660000
081600* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *08670000
081700*----------------------------------------------------------------*08680000
081800                                                                  08690000
081900 1100-PROCESS-INTER-APPL-COMM.                                    08700000
082000                                                                  08710000
082100     SET PS-COMMAREA-VALID         TO TRUE.                       08720000
082200     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08730000
082300                                                                  08740000
082400     IF  PO017-PO-NBR > ZEROES                                    08750000
082500         MOVE PC-TSYMSG-00621                                     08760000
082600                                   TO DP020-MSG-NUMBER            08770000
082700         SET PS-ERROR                                             08780000
082800             PS-COMMAREA-NOT-VALID                                08790000
082900             DP020-MSG-FATAL                                      08800000
083000                                 TO TRUE                          08810000
083100     ELSE                                                         08820000
083200         IF  PO017-DEPT-NBR > SPACES                              08830000
               AND PO017-OTB-PER-NBR-BEG > SPACES                       08840000
               AND PO017-OTB-PER-NBR-END > SPACES                       08850000
083300             INITIALIZE PV-DB2-COUNT                              08860000
083400             PERFORM 1110-VALIDATE-DEPT                           08870000
083500             IF  PV-DB2-COUNT = +0                                08880000
083600                 MOVE PC-TSYMSG-00588                             08890000
083700                                 TO DP020-MSG-NUMBER              08900000
083800                  SET PS-ERROR                                    08910000
083900                      PS-COMMAREA-NOT-VALID                       08920000
084000                      DP020-MSG-FATAL                             08930000
084100                                 TO TRUE                          08940000
084200             END-IF                                               08950000
084300         ELSE                                                     08960000
084400             MOVE PC-TSYMSG-00620                                 08970000
084500                                 TO DP020-MSG-NUMBER              08980000
084600             SET PS-ERROR                                         08990000
084700                 PS-COMMAREA-NOT-VALID                            09000000
084800                 DP020-MSG-FATAL                                  09010000
084900                                 TO TRUE                          09020000
085000         END-IF                                                   09030000
085100                                                                  09040000
W24803         IF  PS-NO-ERROR                                          09050070
W24803           AND PO017-MAJ-CL-NBR > 0                               09060070
W24803           IF (PO017-DEPT-NBR IS NOT NUMERIC)                     09070070
W24803             MOVE PC-TSYMSG-00588                                 09080070
W24803                                 TO DP020-MSG-NUMBER              09090070
W24803             SET PS-ERROR                                         09100070
W24803                 PS-COMMAREA-NOT-VALID                            09110070
W24803                 DP020-MSG-FATAL TO TRUE                          09120070
W24803           END-IF                                                 09130070
W24803           PERFORM 1170-VALIDATE-MAJOR-CLASS                      09140070
W24803           IF PV-DB2-COUNT = 0                                    09150070
W24803              MOVE PC-TSYMSG-03070 TO DP020-MSG-NUMBER            09160070
W24803              SET PS-ERROR                                        09170070
W24803                  PS-COMMAREA-NOT-VALID                           09180070
W24803                  DP020-MSG-FATAL TO TRUE                         09190070
W24803           END-IF                                                 09200070
W24803         END-IF                                                   09210070
W24803*                                                                 09220070
W24803         IF  PS-NO-ERROR                                          09230070
W24803          AND PO017-CL-NBR > ZEROS                                09240070
W24803           IF PO017-CL-NBR (1:1) IS NUMERIC AND                   09250070
W24803              PO017-CL-NBR (2:1) IS NUMERIC                       09260070
W24803             IF PO017-DEPT-NBR = SPACES                           09270070
W24803               IF  PO017-MAJ-CL-NBR = ZEROS                       09280070
W24803                 MOVE PC-TSYMSG-03072                             09290070
W24803                                     TO DP020-MSG-NUMBER          09300070
W24803                 SET PS-ERROR                                     09310070
W24803                     PS-COMMAREA-NOT-VALID                        09320070
W24803                     DP020-MSG-FATAL TO TRUE                      09330070
W24803               ELSE                                               09340070
W24803                 MOVE PC-TSYMSG-00588                             09350070
W24803                                     TO DP020-MSG-NUMBER          09360070
W24803                 SET PS-ERROR                                     09370070
W24803                     PS-COMMAREA-NOT-VALID                        09380070
W24803                     DP020-MSG-FATAL TO TRUE                      09390070
W24803               END-IF                                             09400070
W24803             ELSE                                                 09410070
W24803               IF  PO017-MAJ-CL-NBR = ZEROS                       09420070
W24803                 MOVE PC-TSYMSG-03070                             09430070
W24803                                    TO DP020-MSG-NUMBER           09440070
W24803                 SET PS-ERROR                                     09450070
W24803                     PS-COMMAREA-NOT-VALID                        09460070
W24803                     DP020-MSG-FATAL TO TRUE                      09470070
W24803               ELSE                                               09480070
W24803                 IF PO017-MAJ-CL-NBR (3:1) > ZEROS                09490070
W24803                   MOVE PO017-MAJ-CL-NBR                          09500070
W24803                                 TO PV-MAJ-CLASS                  09510070
W24803                 ELSE                                             09520070
W24803                  IF PO017-MAJ-CL-NBR (4:1) > ZEROS               09530070
W24803                     MOVE PO017-MAJ-CL-NBR(4:1)                   09540070
W24803                                 TO PV-MAJ-CL-3                   09550070
W24803                  END-IF                                          09560070
W24803                 END-IF                                           09570070
W24803                 PERFORM 1160-VALIDATE-MAJCL-SUBCL                09580070
W24803                 IF PV-DB2-COUNT = 0                              09590070
W24803                   MOVE PC-TSYMSG-03073 TO DP020-MSG-NUMBER       09600070
W24803                   SET PS-ERROR                                   09610070
W24803                       PS-COMMAREA-NOT-VALID                      09620070
W24803                       DP020-MSG-FATAL TO TRUE                    09630070
W24803                 END-IF                                           09640070
W24803               END-IF                                             09650070
W24803             END-IF                                               09660070
W24803           ELSE                                                   09670070
W24803             MOVE PC-TSYMSG-03069 TO DP020-MSG-NUMBER             09680070
W24803                                                                  09690070
W24803             SET PS-ERROR                                         09700070
W24803                 PS-COMMAREA-NOT-VALID                            09710070
W24803                 DP020-MSG-FATAL  TO TRUE                         09720070
W24803           END-IF                                                 09730070
W24803         END-IF                                                   09740070
W24803*                                                                 09750070
W24803         IF  PO017-SKU-NBR > SPACES                               09760070
085300           IF  PO017-DEPT-NBR = SPACES                            09770000
085400              MOVE PC-TSYMSG-00486                                09780000
085500                                 TO DP020-MSG-NUMBER              09790000
085600              SET PS-ERROR                                        09800000
085700                  PS-COMMAREA-NOT-VALID                           09810000
085800                  DP020-MSG-FATAL                                 09820000
085900                                 TO TRUE                          09830000
086000           ELSE                                                   09840000
W24803             IF PO017-MAJ-CL-NBR = '0000'                         09850070
W24803               IF  PO017-CL-NBR = SPACES                          09860070
W24803                 MOVE PC-TSYMSG-03068 TO DP020-MSG-NUMBER         09870000
W24803                 SET PS-ERROR                                     09880000
W24803                     PS-COMMAREA-NOT-VALID                        09890000
W24803                     DP020-MSG-FATAL  TO TRUE                     09900000
W24803               ELSE                                               09910000
W24803                 IF (PO017-CL-NBR (1:1) IS NOT NUMERIC            09920070
W24803                    OR PO017-CL-NBR (1:2) IS NOT NUMERIC)         09930070
W24803                    AND PO017-CL-NBR (1:1) > ZERO                 09940070
W24803                   MOVE PC-TSYMSG-03069 TO DP020-MSG-NUMBER       09950070
W24803                   SET PS-ERROR                                   09960000
W24803                       PS-COMMAREA-NOT-VALID                      09970000
W24803                       DP020-MSG-FATAL  TO TRUE                   09980000
W24803                 ELSE                                             09990000
W24803                   MOVE PC-TSYMSG-03070 TO DP020-MSG-NUMBER       10000000
W24803                   SET PS-ERROR                                   10010000
W24803                       PS-COMMAREA-NOT-VALID                      10020000
W24803                       DP020-MSG-FATAL  TO TRUE                   10030000
W24803                 END-IF                                           10040000
W24803               END-IF                                             10050000
W24803             ELSE                                                 10060000
W24803               IF PO017-CL-NBR = ZEROS                            10070000
W24803                  OR PO017-CL-NBR (1:1) IS NOT NUMERIC            10080000
W24803                  OR PO017-CL-NBR (1:2) IS NOT NUMERIC            10090000
W24803                 MOVE PC-TSYMSG-03069 TO DP020-MSG-NUMBER         10100000
W24803                                                                  10110000
W24803                 SET PS-ERROR                                     10120000
W24803                     PS-COMMAREA-NOT-VALID                        10130000
W24803                     DP020-MSG-FATAL  TO TRUE                     10140000
W24803               ELSE                                               10150000
W24803                 IF PO017-MAJ-CL-NBR (3:1) > ZEROS                10160000
W24803                   MOVE PO017-MAJ-CL-NBR    TO PV-MAJ-CLASS       10170070
W24803                 ELSE                                             10180000
W24803                   IF PO017-MAJ-CL-NBR (4:1) > ZEROS              10190000
W24803                     MOVE PO017-MAJ-CL-NBR(4:1)                   10200000
W24803                                            TO PV-MAJ-CL-3        10210000
W24803                   END-IF                                         10220000
W24803                 END-IF                                           10230000
W24803                 PERFORM 1150-VALIDATE-MAJCL-SUBCL-SKU            10240000
W24803                 IF PV-DB2-COUNT = 0                              10250000
W24803                   MOVE PC-TSYMSG-03071 TO DP020-MSG-NUMBER       10260000
W24803                                                                  10270000
W24803                   SET PS-ERROR                                   10280000
W24803                       PS-COMMAREA-NOT-VALID                      10290000
W24803                       DP020-MSG-FATAL TO TRUE                    10300000
W24803                 END-IF                                           10310000
W24803               END-IF                                             10320000
W24803             END-IF                                               10330000
W24803           END-IF                                                 10340000
W24803         END-IF                                                   10350000
087200                                                                  10360000
088400                                                                  10370000
088500         IF  PS-NO-ERROR                                          10380000
088600         AND PO017-STR-NBR > ZERO                                 10390000
088700             INITIALIZE PV-DB2-COUNT                              10400000
088800             PERFORM 1120-VALIDATE-STORE                          10410000
088900             IF  PV-DB2-COUNT = +0                                10420000
089000                 MOVE PC-TSYMSG-00017                             10430000
089100                                 TO DP020-MSG-NUMBER              10440000
089200                  SET PS-ERROR                                    10450000
089300                      PS-COMMAREA-NOT-VALID                       10460000
089400                      DP020-MSG-FATAL                             10470000
089500                                 TO TRUE                          10480000
089600             END-IF                                               10490000
089700         END-IF                                                   10500000
089800                                                                  10510000
089900         IF  PS-NO-ERROR                                          10520000
090000         AND PO017-STATUS-CDE   > SPACES                          10530000
090100             INITIALIZE PV-DB2-COUNT                              10540000
090200             MOVE PO017-STATUS-CDE                                10550000
090300                                 TO STATCD-STATUS-CDE             10560000
090400             PERFORM 1130-VALIDATE-STATUS-CODE                    10570000
090500             IF  PV-DB2-COUNT = +0                                10580000
090600                 MOVE PC-TSYMSG-00168                             10590000
090700                                 TO DP020-MSG-NUMBER              10600000
090800                  SET PS-ERROR                                    10610000
090900                      PS-COMMAREA-NOT-VALID                       10620000
091000                      DP020-MSG-FATAL                             10630000
091100                                 TO TRUE                          10640000
091200             END-IF                                               10650000
091300         END-IF                                                   10660000
091400                                                                  10670000
091500         IF  PS-NO-ERROR                                          10680000
091600         AND PO017-PO-TYP-CDE > SPACES                            10690000
091700             INITIALIZE PV-DB2-COUNT                              10700000
091800             PERFORM 1140-VALIDATE-PO-TYPE-CODE                   10710000
091900             IF  PV-DB2-COUNT = +0                                10720000
092000                 MOVE PC-TSYMSG-00587                             10730000
092100                                 TO DP020-MSG-NUMBER              10740000
092200                  SET PS-ERROR                                    10750000
092300                      PS-COMMAREA-NOT-VALID                       10760000
092400                      DP020-MSG-FATAL                             10770000
092500                                 TO TRUE                          10780000
092600             END-IF                                               10790000
092700        END-IF                                                    10800000
092800     END-IF.                                                      10810000
092900                                                                  10820000
093000     IF  PS-NO-ERROR                                              10830000
093100         MOVE PO017-PO-NBR       TO ASC-KEY-PO-NBR                10840000
093200         MOVE PO017-IMPRT-AGNT-PO-NBR                             10850000
093300                                 TO ASC-KEY-IMPRT-AGNT-PO-NBR     10860000
093400         MOVE PO017-DEPT-NBR     TO ASC-KEY-DEPT-NBR              10870000
093500         MOVE PO017-PO-TYP-CDE   TO ASC-KEY-PO-TYP-CDE            10880000
093600         MOVE PO017-STATUS-CDE   TO ASC-KEY-STATUS-CDE            10890000
093700         MOVE PO017-STATUS-GRP   TO ASC-KEY-STATUS-CLS            10900000
093800         MOVE PO017-EDI-IND      TO ASC-KEY-EDI-IND               10910000
093900         MOVE PO017-PIC-AD-IND   TO ASC-KEY-PIC-AD-IND            10920000
094000         MOVE PO017-DIR-STORE-IND TO ASC-KEY-DIR-STORE-IND        10930000
094100         MOVE PO017-NEW-STR-IND  TO ASC-KEY-NEW-STR-IND           10940000
W24803         IF PO017-MAJ-CL-NBR > ZEROES                             10950000
W24803            IF PO017-MAJ-CL-NBR (3:1) > 0                         10960000
W24803               MOVE PO017-MAJ-CL-NBR (3:2)                        10970069
W24803                                 TO PV-MAJ-CLASS                  10980070
W24803            ELSE                                                  10990000
W24803               IF PO017-MAJ-CL-NBR (4:1) > 0                      11000000
W24803                  MOVE PO017-MAJ-CL-NBR(4:1)                      11010000
W24803                                 TO PV-MAJ-CL-3                   11020000
W24803               END-IF                                             11030000
W24803            END-IF                                                11040000
W24803               MOVE PV-MAJ-CLASS TO ASC-KEY-MAJ-CL-NBR            11050000
W24803         ELSE                                                     11060000
W24803               MOVE ZEROS        TO ASC-KEY-MAJ-CL-NBR            11070000
W24803         END-IF                                                   11080000
W24803         IF PO017-CL-NBR > SPACES                                 11090000
W24803               MOVE PO017-CL-NBR TO PV-SUB-CL-3-4                 11100000
W24803               MOVE PV-SUB-CLASS TO ASC-KEY-SUB-CL-NBR            11110000
W24803         ELSE                                                     11120000
W24803               MOVE ZEROS        TO ASC-KEY-SUB-CL-NBR            11130000
W24803         END-IF                                                   11140000
W24803         IF PO017-SKU-NBR > SPACES                                11150000
W24803               MOVE PO017-SKU-NBR                                 11160000
W24803                                 TO ASC-KEY-SKU-NBR               11170000
W24803         ELSE                                                     11180000
W24803               MOVE ZEROS        TO ASC-KEY-SKU-NBR               11190000
W24803         END-IF                                                   11200000
094400         MOVE PO017-STR-NBR      TO ASC-KEY-STR-NBR               11210000
094500         MOVE PO017-AD-EVNT-DTE-ISO                               11220000
094600                                 TO ASC-KEY-AD-EVNT-DTE           11230000
094700         MOVE PO017-VEND-STYL-NME TO ASC-KEY-VEND-STYL-NME        11240000
094800         MOVE PO017-ENT-NAME-DESC TO ASC-KEY-ENT-NAME-DESC        11250000
094900         MOVE PO017-PRE-TICKET-IND TO ASC-KEY-PRE-TICKET-IND      11260000
095000         MOVE PO017-PACK-BY-STORE-IND                             11270000
095100                                   TO ASC-KEY-PACK-BY-STORE-IND   11280000
095200         IF  PO017-OTB-PER-NBR-BEG > SPACES                       11290000
095300         AND PO017-OTB-PER-NBR-END = SPACES                       11300000
095400             MOVE PO017-OTB-PER-NBR-BEG                           11310000
095500                                 TO PO017-OTB-PER-NBR-END         11320000
095600         END-IF                                                   11330000
095700         IF  PO017-OTB-PER-NBR-END > SPACES                       11340000
095800         AND PO017-OTB-PER-NBR-BEG = SPACES                       11350000
095900             MOVE PO017-OTB-PER-NBR-END                           11360000
096000                                 TO PO017-OTB-PER-NBR-BEG         11370000
096100         END-IF                                                   11380000
096110         IF PO017-OTB-PER-NBR-BEG(1:2) > SPACES                   11390000
096111            IF PO017-OTB-PER-NBR-BEG(1:2) > 80                    11400000
096120               MOVE '19' TO PV-HOLD-CC                            11410000
096130            ELSE                                                  11420000
096140               MOVE '20' TO PV-HOLD-CC                            11430000
096150            END-IF                                                11440000
096151         END-IF                                                   11450000
096160              STRING PV-HOLD-CC DELIMITED BY SIZE                 11460000
096170                     PO017-OTB-PER-NBR-BEG DELIMITED BY SIZE      11470000
096180                     INTO ASC-KEY-OTB-PER-NBR-BEG                 11480000
096310         IF PO017-OTB-PER-NBR-END(1:2) > SPACES                   11490000
096311            IF PO017-OTB-PER-NBR-END(1:2) > 80                    11500000
096320               MOVE '19' TO PV-HOLD-CC                            11510000
096330            ELSE                                                  11520000
096340               MOVE '20' TO PV-HOLD-CC                            11530000
096350            END-IF                                                11540000
096351         END-IF                                                   11550000
096360              STRING PV-HOLD-CC DELIMITED BY SIZE                 11560000
096370                     PO017-OTB-PER-NBR-END DELIMITED BY SIZE      11570000
096380                     INTO ASC-KEY-OTB-PER-NBR-END                 11580000
096600         IF  PO017-DONT-SHIP-BEF-DTE-B-ISO > SPACES               11590000
096700         AND PO017-DONT-SHIP-BEF-DTE-E-ISO = SPACES               11600000
096800             MOVE PO017-DONT-SHIP-BEF-DTE-B-ISO                   11610000
096900                                 TO PO017-DONT-SHIP-BEF-DTE-E-ISO 11620000
097000         END-IF                                                   11630000
097100         IF  PO017-DONT-SHIP-BEF-DTE-E-ISO > SPACES               11640000
097200         AND PO017-DONT-SHIP-BEF-DTE-B-ISO = SPACES               11650000
097300             MOVE PO017-DONT-SHIP-BEF-DTE-E-ISO                   11660000
097400                                 TO PO017-DONT-SHIP-BEF-DTE-B-ISO 11670000
097500         END-IF                                                   11680000
097600         MOVE PO017-DONT-SHIP-BEF-DTE-B-ISO                       11690000
097700                                 TO ASC-KEY-DONT-SHIP-BEF-DTE-B   11700000
097800         MOVE PO017-DONT-SHIP-BEF-DTE-E-ISO                       11710000
097900                                 TO ASC-KEY-DONT-SHIP-BEF-DTE-E   11720000
098000     END-IF.                                                      11730000
098100                                                                  11740000
098200/                                                                 11750000
098300 1110-VALIDATE-DEPT.                                              11760000
098400                                                                  11770000
098500     PERFORM                                                      11780000
098600         WITH TEST AFTER                                          11790000
098700         VARYING PV-RETRY-COUNTER                                 11800000
098800         FROM 1 BY 1                                              11810000
098900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11820000
099000             OR (SQLCODE = +0)                                    11830000
099100             OR (SQLCODE = +100))                                 11840000
099200                                                                  11850000
099300         EXEC SQL                                                 11860000
099400              SELECT COUNT(*)                                     11870000
099500                INTO :PV-DB2-COUNT                                11880000
099600                FROM TMDSEAR                                      11890000
099700               WHERE DEPT_NBR   = :PO017-DEPT-NBR                 11900000
099800                 AND OPERCO_NBR = '03'                            11910000
099900                 AND MDSELV_CDE = 'DPT'                           11920000
100000                 AND STRT_DTE  <= CURRENT DATE                    11930000
100100                 AND END_DTE   >= CURRENT DATE                    11940000
100200         END-EXEC                                                 11950000
100300                                                                  11960000
100400         EVALUATE TRUE                                            11970000
100500             WHEN SQLCODE = +0                                    11980000
100600             WHEN SQLCODE = +100                                  11990000
100700             WHEN SQLCODE = -904                                  12000000
100800             WHEN SQLCODE = -913                                  12010000
100900                  CONTINUE                                        12020000
101000                                                                  12030000
101100             WHEN SQLWARN0 NOT = SPACES                           12040000
101200             WHEN SQLCODE < +0                                    12050000
101300             WHEN SQLCODE > +0                                    12060000
101400                  MOVE '1110-VALIDATE-DEPT'                       12070000
101500                                  TO DP013-PARAGRAPH              12080000
101600                  MOVE 'UNSUCCESSFUL COUNT ON DEPARTMENT'         12090000
101700                                  TO DP013-MESSAGE-TEXT (1)       12100000
101800                  MOVE SQLCA      TO DP013-SQLCA                  12110000
101900                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)     12120000
102000                  SET DP013-DB2-ABEND                             12130000
102100                      DP013-XCTL-DISPLAY-RESTART                  12140000
102200                                  TO TRUE                         12150000
102300                  PERFORM DP013-0000-PROCESS-ABEND                12160000
102400         END-EVALUATE                                             12170000
102500     END-PERFORM.                                                 12180000
102600                                                                  12190000
102700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12200000
102800         MOVE '1110-VALIDATE-DEPT'                                12210000
102900                                  TO DP013-PARAGRAPH              12220000
103000         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TMDSEAR'          12230000
103100                                  TO DP013-MESSAGE-TEXT (1)       12240000
103200         MOVE SQLCA               TO DP013-SQLCA                  12250000
103300         MOVE 'TMDSEAR '          TO DP013-DB2-TABLE-NAME (1)     12260000
103400         SET DP013-DB2-ABEND                                      12270000
103500             DP013-XCTL-DISPLAY-RESTART                           12280000
103600                                  TO TRUE                         12290000
103700         PERFORM DP013-0000-PROCESS-ABEND                         12300000
103800     END-IF.                                                      12310000
103900                                                                  12320000
104000/                                                                 12330000
104100 1120-VALIDATE-STORE.                                             12340000
104200                                                                  12350000
104300     PERFORM                                                      12360000
104400         WITH TEST AFTER                                          12370000
104500         VARYING PV-RETRY-COUNTER                                 12380000
104600         FROM 1 BY 1                                              12390000
104700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12400000
104800             OR (SQLCODE = +0)                                    12410000
104900             OR (SQLCODE = +100))                                 12420000
105000                                                                  12430000
105100         EXEC SQL                                                 12440076
105200              SELECT COUNT(*)                                     12450076
105300                INTO :PV-DB2-COUNT                                12460076
105400                FROM XMT_LOC                                      12470076
105600               WHERE LOC_NBR = :PO017-STR-NBR                     12480076
105800         END-EXEC                                                 12490076
105900                                                                  12500076
106000         EVALUATE TRUE                                            12510000
106100             WHEN SQLCODE = +0                                    12520000
106200             WHEN SQLCODE = +100                                  12530000
106300             WHEN SQLCODE = -904                                  12540000
106400             WHEN SQLCODE = -913                                  12550000
106500                  CONTINUE                                        12560000
106600                                                                  12570000
106700             WHEN SQLWARN0 NOT = SPACES                           12580000
106800             WHEN SQLCODE < +0                                    12590000
106900             WHEN SQLCODE > +0                                    12600000
107000                  MOVE '1120-VALIDATE-STORE'                      12610000
107100                                  TO DP013-PARAGRAPH              12620000
107200                  MOVE 'UNSUCCESSFUL COUNT ON STORE'              12630000
107300                                  TO DP013-MESSAGE-TEXT (1)       12640000
107400                  MOVE SQLCA      TO DP013-SQLCA                  12650000
107500                  MOVE 'XMT_LOC ' TO DP013-DB2-TABLE-NAME (1)     12660076
107600                  SET DP013-DB2-ABEND                             12670000
107700                      DP013-XCTL-DISPLAY-RESTART                  12680000
107800                                  TO TRUE                         12690000
107900                  PERFORM DP013-0000-PROCESS-ABEND                12700000
108000         END-EVALUATE                                             12710000
108100     END-PERFORM.                                                 12720000
108200                                                                  12730000
108300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12740000
108400         MOVE '1120-VALIDATE-STORE'                               12750000
108500                                  TO DP013-PARAGRAPH              12760000
108600         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON XMT_LOC'          12770076
108700                                  TO DP013-MESSAGE-TEXT (1)       12780000
108800         MOVE SQLCA               TO DP013-SQLCA                  12790000
108900         MOVE 'XMT_LOC '          TO DP013-DB2-TABLE-NAME (1)     12800076
109000         SET DP013-DB2-ABEND                                      12810000
109100             DP013-XCTL-DISPLAY-RESTART                           12820000
109200                                  TO TRUE                         12830000
109300         PERFORM DP013-0000-PROCESS-ABEND                         12840000
109400     END-IF.                                                      12850000
109500                                                                  12860000
109600/                                                                 12870000
109700 1130-VALIDATE-STATUS-CODE.                                       12880000
109800                                                                  12890000
109900     PERFORM                                                      12900000
110000         WITH TEST AFTER                                          12910000
110100         VARYING PV-RETRY-COUNTER                                 12920000
110200         FROM 1 BY 1                                              12930000
110300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12940000
110400             OR (SQLCODE = +0)                                    12950000
110500             OR (SQLCODE = +100))                                 12960000
110600                                                                  12970000
110700         EXEC SQL                                                 12980000
110800              SELECT COUNT(*)                                     12990000
110900                INTO :PV-DB2-COUNT                                13000000
111000                FROM TSTATCD                                      13010000
111100               WHERE STATUS_TYP_CDE = 'P'                         13020000
111200                 AND STATUS_CDE     = :STATCD-STATUS-CDE          13030000
111300         END-EXEC                                                 13040000
111400                                                                  13050000
111500         EVALUATE TRUE                                            13060000
111600             WHEN SQLCODE = +0                                    13070000
111700             WHEN SQLCODE = +100                                  13080000
111800             WHEN SQLCODE = -904                                  13090000
111900             WHEN SQLCODE = -913                                  13100000
112000                  CONTINUE                                        13110000
112100                                                                  13120000
112200             WHEN SQLWARN0 NOT = SPACES                           13130000
112300             WHEN SQLCODE < +0                                    13140000
112400             WHEN SQLCODE > +0                                    13150000
112500                  MOVE '1130-VALIDATE-STATUS-CODE'                13160000
112600                                  TO DP013-PARAGRAPH              13170000
112700                  MOVE 'UNSUCCESSFUL COUNT ON STATUS CODE'        13180000
112800                                  TO DP013-MESSAGE-TEXT (1)       13190000
112900                  MOVE SQLCA      TO DP013-SQLCA                  13200000
113000                  MOVE 'TSTATCD ' TO DP013-DB2-TABLE-NAME (1)     13210000
113100                  SET DP013-DB2-ABEND                             13220000
113200                      DP013-XCTL-DISPLAY-RESTART                  13230000
113300                                  TO TRUE                         13240000
113400                  PERFORM DP013-0000-PROCESS-ABEND                13250000
113500         END-EVALUATE                                             13260000
113600     END-PERFORM.                                                 13270000
113700                                                                  13280000
113800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13290000
113900         MOVE '1130-VALIDATE-STATUS-CODE'                         13300000
114000                                  TO DP013-PARAGRAPH              13310000
114100         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TSTATCD'          13320000
114200                                  TO DP013-MESSAGE-TEXT (1)       13330000
114300         MOVE SQLCA               TO DP013-SQLCA                  13340000
114400         MOVE 'TSTATCD '          TO DP013-DB2-TABLE-NAME (1)     13350000
114500         SET DP013-DB2-ABEND                                      13360000
114600             DP013-XCTL-DISPLAY-RESTART                           13370000
114700                                  TO TRUE                         13380000
114800         PERFORM DP013-0000-PROCESS-ABEND                         13390000
114900     END-IF.                                                      13400000
115000                                                                  13410000
115100/                                                                 13420000
115200 1140-VALIDATE-PO-TYPE-CODE.                                      13430000
115300                                                                  13440000
115400     PERFORM                                                      13450000
115500         WITH TEST AFTER                                          13460000
115600         VARYING PV-RETRY-COUNTER                                 13470000
115700         FROM 1 BY 1                                              13480000
115800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13490000
115900             OR (SQLCODE = +0)                                    13500000
116000             OR (SQLCODE = +100))                                 13510000
116100                                                                  13520000
116200         EXEC SQL                                                 13530000
116300              SELECT COUNT(*)                                     13540000
116400                INTO :PV-DB2-COUNT                                13550000
116500                FROM TPOTYCD                                      13560000
116600               WHERE PO_VARIETY_CDE = 'T'                         13570000
116700                 AND PO_TYP_CDE     = :PO017-PO-TYP-CDE           13580000
116800         END-EXEC                                                 13590000
116900                                                                  13600000
117000         EVALUATE TRUE                                            13610000
117100             WHEN SQLCODE = +0                                    13620000
117200             WHEN SQLCODE = +100                                  13630000
117300             WHEN SQLCODE = -904                                  13640000
117400             WHEN SQLCODE = -913                                  13650000
117500                  CONTINUE                                        13660000
117600                                                                  13670000
117700             WHEN SQLWARN0 NOT = SPACES                           13680000
117800             WHEN SQLCODE < +0                                    13690000
117900             WHEN SQLCODE > +0                                    13700000
118000                  MOVE '1140-VALIDATE-PO-TYPE-CODE'               13710000
118100                                  TO DP013-PARAGRAPH              13720000
118200                  MOVE 'UNSUCCESSFUL COUNT ON TYPE CODE'          13730000
118300                                  TO DP013-MESSAGE-TEXT (1)       13740000
118400                  MOVE SQLCA      TO DP013-SQLCA                  13750000
118500                  MOVE 'TPOTYCD ' TO DP013-DB2-TABLE-NAME (1)     13760000
118600                  SET DP013-DB2-ABEND                             13770000
118700                      DP013-XCTL-DISPLAY-RESTART                  13780000
118800                                  TO TRUE                         13790000
118900                  PERFORM DP013-0000-PROCESS-ABEND                13800000
119000         END-EVALUATE                                             13810000
119100     END-PERFORM.                                                 13820000
119200                                                                  13830000
119300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13840000
119400         MOVE '1140-VALIDATE-PO-TYPE-CODE'                        13850000
119500                                  TO DP013-PARAGRAPH              13860000
119600         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON TPOTYCD'          13870000
119700                                  TO DP013-MESSAGE-TEXT (1)       13880000
119800         MOVE SQLCA               TO DP013-SQLCA                  13890000
119900         MOVE 'TPOTYCD '          TO DP013-DB2-TABLE-NAME (1)     13900000
120000         SET DP013-DB2-ABEND                                      13910000
120100             DP013-XCTL-DISPLAY-RESTART                           13920000
120200                                  TO TRUE                         13930000
120300         PERFORM DP013-0000-PROCESS-ABEND                         13940000
120400     END-IF.                                                      13950000
W24803*                                                                 13960000
W24803 1150-VALIDATE-MAJCL-SUBCL-SKU.                                   13970000
W24803*                                                                 13980000
W24803     MOVE 0              TO PV-DB2-COUNT                          13990000
W24803     MOVE PV-MAJ-CLASS   TO XLT00004-MAJ-CL-NBR                   14000000
W24803     MOVE PO017-CL-NBR   TO PV-SUB-CL-3-4                         14010000
W24803     MOVE PV-SUB-CLASS   TO XLT00004-SUB-CL-NBR                   14020000
W24803     MOVE PO017-SKU-NBR  TO PV-SKU-NBR                            14030000
W24803     MOVE PV-SKU-NBR     TO XLT00003-SKU-NBR                      14040000
W24803     PERFORM                                                      14050000
W24803      WITH TEST AFTER                                             14060000
W24803      VARYING PV-RETRY-COUNTER                                    14070000
W24803      FROM 1 BY 1                                                 14080000
W24803      UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                  14090000
W24803         OR (SQLCODE = +0)                                        14100000
W24803         OR (SQLCODE = +100))                                     14110000
W24803      EXEC SQL                                                    14120000
W24803        SELECT COUNT(*)                                           14130000
W24803        INTO :PV-DB2-COUNT                                        14140000
W24803        FROM  XLT_SKU S,                                          14150000
W24803              XLT_VND_STYL V                                      14160000
W24803        WHERE MAJ_CL_NBR = :XLT00004-MAJ-CL-NBR                   14170000
W24803          AND SUB_CL_NBR = :XLT00004-SUB-CL-NBR                   14180000
W24803          AND SKU_NBR    = :XLT00003-SKU-NBR                      14190000
W24803          AND S.STYL_ID  = V.STYL_ID                              14200000
W24803      END-EXEC                                                    14210000
W24803      EVALUATE TRUE                                               14220000
W24803         WHEN SQLCODE = +0                                        14230000
W24803         WHEN SQLCODE = +100                                      14240000
W24803         WHEN SQLCODE = -904                                      14250000
W24803         WHEN SQLCODE = -913                                      14260000
W24803              CONTINUE                                            14270000
W24803         WHEN SQLWARN0 NOT = SPACES                               14280000
W24803         WHEN SQLCODE < +0                                        14290000
W24803         WHEN SQLCODE > +0                                        14300000
W24803              MOVE '1150-VALIDATE-MAJCL-SUBCL-SKU'                14310000
W24803                                       TO DP013-PARAGRAPH         14320000
W24803            MOVE 'UNSUCCESSFUL COUNT ON MAJ CL , SUB CL AND SKU'  14330000
W24803                                       TO DP013-MESSAGE-TEXT (1)  14340000
W24803              MOVE SQLCA          TO DP013-SQLCA                  14350000
W24803              MOVE 'XLV_SKU '     TO DP013-DB2-TABLE-NAME(1)      14360000
W24803              MOVE 'XLV_VND_STYL '                                14370000
W24803                                       TO DP013-DB2-TABLE-NAME(2) 14380000
W24803              SET DP013-DB2-ABEND                                 14390000
W24803                  DP013-XCTL-DISPLAY-RESTART                      14400000
W24803                                       TO TRUE                    14410000
W24803              PERFORM DP013-0000-PROCESS-ABEND                    14420000
W24803         END-EVALUATE                                             14430000
W24803     END-PERFORM.                                                 14440000
W24803*                                                                 14450000
W24803     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14460000
W24803         MOVE '1150-VALIDATE-MAJCL-SUBCL-SKU'                     14470000
W24803                                TO DP013-PARAGRAPH                14480000
W24803         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON XLT_SKU'          14490000
W24803                                TO DP013-MESSAGE-TEXT (1)         14500000
W24803         MOVE SQLCA             TO DP013-SQLCA                    14510000
W24803         MOVE 'XLV_SKU '        TO DP013-DB2-TABLE-NAME (1)       14520000
W24803         MOVE 'XLV_VND_STYL '   TO DP013-DB2-TABLE-NAME (2)       14530000
W24803         SET DP013-DB2-ABEND                                      14540000
W24803             DP013-XCTL-DISPLAY-RESTART                           14550000
W24803                                TO TRUE                           14560000
W24803         PERFORM DP013-0000-PROCESS-ABEND                         14570000
W24803     END-IF.                                                      14580000
W24803*                                                                 14590000
W24803 1160-VALIDATE-MAJCL-SUBCL.                                       14600000
W24803*                                                                 14610000
W24803     MOVE 0             TO PV-DB2-COUNT                           14620000
W24803     MOVE PV-MAJ-CLASS  TO XLT00004-MAJ-CL-NBR                    14630000
W24803     MOVE PO017-CL-NBR  TO PV-SUB-CL-3-4                          14640000
W24803     MOVE PV-SUB-CLASS  TO XLT00004-SUB-CL-NBR                    14650000
W24803     PERFORM                                                      14660000
W24803      WITH TEST AFTER                                             14670000
W24803      VARYING PV-RETRY-COUNTER                                    14680000
W24803      FROM 1 BY 1                                                 14690000
W24803      UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                  14700000
W24803       OR (SQLCODE = +0)                                          14710000
W24803       OR (SQLCODE = +100))                                       14720000
W24803      EXEC SQL                                                    14730000
W24803        SELECT COUNT(*)                                           14740000
W24803        INTO :PV-DB2-COUNT                                        14750000
W24803        FROM  XLT_VND_STYL V                                      14760000
W24803        WHERE MAJ_CL_NBR = :XLT00004-MAJ-CL-NBR                   14770000
W24803          AND SUB_CL_NBR = :XLT00004-SUB-CL-NBR                   14780000
W24803      END-EXEC                                                    14790000
W24803*                                                                 14800000
W24803      EVALUATE TRUE                                               14810000
W24803       WHEN SQLCODE = +0                                          14820000
W24803       WHEN SQLCODE = +100                                        14830000
W24803       WHEN SQLCODE = -904                                        14840000
W24803       WHEN SQLCODE = -913                                        14850000
W24803         CONTINUE                                                 14860000
W24803       WHEN SQLWARN0 NOT = SPACES                                 14870000
W24803       WHEN SQLCODE < +0                                          14880000
W24803       WHEN SQLCODE > +0                                          14890000
W24803         MOVE '1160-VALIDATE-MAJCL-SUBCL'                         14900000
W24803                          TO DP013-PARAGRAPH                      14910000
W24803         MOVE 'UNSUCCESSFUL COUNT ON MAJ CL  AND SUB CL'          14920000
W24803                          TO DP013-MESSAGE-TEXT (1)               14930000
W24803         MOVE SQLCA       TO DP013-SQLCA                          14940000
W24803         MOVE 'XLV_VND_STYL '                                     14950000
W24803                          TO DP013-DB2-TABLE-NAME (1)             14960000
W24803         SET DP013-DB2-ABEND                                      14970000
W24803             DP013-XCTL-DISPLAY-RESTART                           14980000
W24803                          TO TRUE                                 14990000
W24803        PERFORM DP013-0000-PROCESS-ABEND                          15000000
W24803       END-EVALUATE                                               15010000
W24803     END-PERFORM.                                                 15020000
W24803*                                                                 15030000
W24803     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15040000
W24803       MOVE '1160-VALIDATE-MAJCL-SUBCL'                           15050000
W24803                           TO DP013-PARAGRAPH                     15060000
W24803       MOVE 'MAX RETRIES EXCEEDED ON COUNT ON XLT_VND_STYL'       15070000
W24803                           TO DP013-MESSAGE-TEXT (1)              15080000
W24803       MOVE SQLCA          TO DP013-SQLCA                         15090000
W24803       MOVE 'XLV_VND_STYL '                                       15100000
W24803                           TO DP013-DB2-TABLE-NAME (1)            15110000
W24803       SET DP013-DB2-ABEND                                        15120000
W24803           DP013-XCTL-DISPLAY-RESTART                             15130000
W24803                           TO TRUE                                15140000
W24803       PERFORM DP013-0000-PROCESS-ABEND                           15150000
W24803     END-IF.                                                      15160000
W24803*                                                                 15170070
W24803 1170-VALIDATE-MAJOR-CLASS.                                       15180070
W24803*                                                                 15190070
W24803     MOVE 0             TO PV-DB2-COUNT                           15200070
W24803     IF PO017-MAJ-CL-NBR (3:1) > '0'                              15210070
W24803       MOVE PO017-MAJ-CL-NBR TO PV-MAJ-CLASS                      15220070
W24803     ELSE                                                         15230070
W24803       MOVE PO017-MAJ-CL-NBR (4:1)                                15240070
W24803                             TO PV-MAJ-CL-3                       15250070
W24803     END-IF                                                       15260070
W24803     MOVE PV-MAJ-CLASS  TO XLT00004-MAJ-CL-NBR                    15270070
W24803*                                                                 15280070
W24803     PERFORM                                                      15290070
W24803      WITH TEST AFTER                                             15300070
W24803      VARYING PV-RETRY-COUNTER                                    15310070
W24803      FROM 1 BY 1                                                 15320070
W24803      UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                  15330070
W24803       OR (SQLCODE = +0)                                          15340070
W24803       OR (SQLCODE = +100))                                       15350070
W24803      EXEC SQL                                                    15360070
W24803        SELECT COUNT(*)                                           15370070
W24803        INTO :PV-DB2-COUNT                                        15380070
W24803        FROM  XLT_VND_STYL V                                      15390070
W24803        WHERE MAJ_CL_NBR = :XLT00004-MAJ-CL-NBR                   15400070
W24803      END-EXEC                                                    15410070
W24803*                                                                 15420070
W24803      EVALUATE TRUE                                               15430070
W24803       WHEN SQLCODE = +0                                          15440070
W24803       WHEN SQLCODE = +100                                        15450070
W24803       WHEN SQLCODE = -904                                        15460070
W24803       WHEN SQLCODE = -913                                        15470070
W24803         CONTINUE                                                 15480070
W24803       WHEN SQLWARN0 NOT = SPACES                                 15490070
W24803       WHEN SQLCODE < +0                                          15500070
W24803       WHEN SQLCODE > +0                                          15510070
W24803         MOVE '1170-VALIDATE-MAJOR-CLASS'                         15520070
W24803                          TO DP013-PARAGRAPH                      15530070
W24803         MOVE 'UNSUCCESSFUL COUNT ON MAJOR CLASS'                 15540070
W24803                          TO DP013-MESSAGE-TEXT (1)               15550070
W24803         MOVE SQLCA       TO DP013-SQLCA                          15560070
W24803         MOVE 'XLV_VND_STYL '                                     15570070
W24803                          TO DP013-DB2-TABLE-NAME (1)             15580070
W24803         SET DP013-DB2-ABEND                                      15590070
W24803             DP013-XCTL-DISPLAY-RESTART                           15600070
W24803                          TO TRUE                                 15610070
W24803        PERFORM DP013-0000-PROCESS-ABEND                          15620070
W24803       END-EVALUATE                                               15630070
W24803     END-PERFORM.                                                 15640070
W24803*                                                                 15650070
W24803     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15660070
W24803       MOVE '1170-VALIDATE-MAJOR-CLASS'                           15670070
W24803                           TO DP013-PARAGRAPH                     15680070
W24803       MOVE 'MAX RETRIES EXCEEDED ON COUNT ON XLT_VND_STYL'       15690070
W24803                           TO DP013-MESSAGE-TEXT (1)              15700070
W24803       MOVE SQLCA          TO DP013-SQLCA                         15710070
W24803       MOVE 'XLV_VND_STYL '                                       15720070
W24803                           TO DP013-DB2-TABLE-NAME (1)            15730070
W24803       SET DP013-DB2-ABEND                                        15740070
W24803           DP013-XCTL-DISPLAY-RESTART                             15750070
W24803                           TO TRUE                                15760070
W24803       PERFORM DP013-0000-PROCESS-ABEND                           15770070
W24803     END-IF.                                                      15780070
120500                                                                  15790070
120600/                                                                 15800070
120700*----------------------------------------------------------------*15810000
120800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *15820000
120900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *15830000
121000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *15840000
121100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *15850000
121200* FUNCTION KEYS CAN GET THIS FAR.                                *15860000
121300*----------------------------------------------------------------*15870000
121400                                                                  15880000
121500 2000-PROCESS-PANEL.                                              15890000
121600     EVALUATE TRUE                                                15900000
121700         WHEN DP020-SRC-AID = DP016-CLEAR                         15910000
121800             SET ASC-DISPLAY-DOLLAR TO TRUE                       15920000
121900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    15930000
122000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15940000
122100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15950000
122200                                                                  15960000
122300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    15970000
122400             SET ASC-DISPLAY-DOLLAR TO TRUE                       15980000
122500             PERFORM 2050-DELETE-LIST-QUEUE                       15990000
122600             PERFORM 4000-BUILD-INITIAL-PANEL                     16000000
122700                                                                  16010000
122800         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   16020000
122900             PERFORM 2140-DESELECT-ALL-ITEMS                      16030000
123000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16040000
123100                                                                  16050000
123200         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 16060000
123300              PERFORM 2150-SELECT-ALL-ITEMS                       16070000
123400              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                16080000
123500                                                                  16090000
123600         WHEN OTHER                                               16100000
123700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 16110000
123800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   16120000
123900             IF  PS-NO-ERROR                                      16130000
124000                 SET DP030-CONTINUE-GO TO TRUE                    16140000
124100                 PERFORM 2100-CHECK-FUNCTION-KEY                  16150000
124200             ELSE                                                 16160000
124300                 SET DP030-OVERRIDE-GO TO TRUE                    16170000
124400             END-IF                                               16180000
124500     END-EVALUATE.                                                16190000
124600                                                                  16200000
124700/                                                                 16210000
124800*----------------------------------------------------------------*16220000
124900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *16230000
125000*----------------------------------------------------------------*16240000
125100 2050-DELETE-LIST-QUEUE.                                          16250000
125200                                                                  16260000
125300     EXEC CICS                                                    16270000
125400         DELETEQ TS                                               16280000
125500           QUEUE (ASC-LIST-QUEUE-NAME)                            16290000
125600            RESP (PV-CICS-RESP)                                   16300000
125700     END-EXEC.                                                    16310000
125800                                                                  16320000
126400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       16330000
126500        (PV-CICS-RESP = DFHRESP(QIDERR))                          16340000
126600         CONTINUE                                                 16350000
126700     ELSE                                                         16360000
126800         SET DP013-CICS-ABEND      TO TRUE                        16370000
126900         SET DP013-NO-ROLLBACK     TO TRUE                        16380000
127000                                                                  16390000
127100         MOVE '2050-DELETE-LIST-QUEUE'                            16400000
127200                                   TO DP013-PARAGRAPH             16410000
127300         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    16420000
127400                                   TO DP013-MESSAGE-TEXT (1)      16430000
127500         PERFORM DP013-0000-PROCESS-ABEND                         16440000
127600     END-IF.                                                      16450000
127700                                                                  16460000
127800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  16470000
127900                                                                  16480000
128000/                                                                 16490000
128100*----------------------------------------------------------------*16500000
128200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*16510000
128300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *16520000
128400* CICS ARCHITECTURE API.                                         *16530000
128500*----------------------------------------------------------------*16540000
128600 2100-CHECK-FUNCTION-KEY.                                         16550000
128700                                                                  16560000
128800     EVALUATE TRUE                                                16570000
128900         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 16580000
129000*             SET ASC-DISPLAY-DOLLAR TO TRUE                      16590000
129100              IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO             16600000
129200                  INITIALIZE PO013-INTER-APPL-COMMAREA            16610000
129300                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               16620000
129400                                TO PO013-NUMBER-OF-SELECTED-ITEMS 16630000
129500                                                                  16640000
129600                  PERFORM 5000-PREPARE-SEL-QUEUE                  16650000
129700              ELSE                                                16660000
129800                  SET DP030-OVERRIDE-GO                           16670000
129900                      DP020-MSG-WARNING                           16680000
130000                                TO TRUE                           16690000
130100                  MOVE PC-TSYMSG-00057                            16700000
130200                                TO DP020-MSG-NUMBER               16710000
130300              END-IF                                              16720000
130400                                                                  16730000
130500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  16740000
130600             MOVE +1               TO PV-TOP-ITEM                 16750000
130700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16760000
130800             PERFORM 3200-RESET-ATTRIBUTES                        16770000
130900                                                                  16780000
131000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   16790000
131100             PERFORM 2110-BROWSE-BACKWARD                         16800000
131200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16810000
131300             PERFORM 3200-RESET-ATTRIBUTES                        16820000
131400                                                                  16830000
131500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   16840000
131600             PERFORM 2120-BROWSE-FORWARD                          16850000
131700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16860000
131800             PERFORM 3200-RESET-ATTRIBUTES                        16870000
131900                                                                  16880000
132000         WHEN DP020-SRC-AID = DP016-ENTER                         16890000
132100*            SET ASC-DISPLAY-DOLLAR TO TRUE                       16900000
132200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   16910000
132300             IF  PS-ERROR                                         16920000
132400                 CONTINUE                                         16930000
132500             ELSE                                                 16940000
132600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16950000
132700             END-IF                                               16960000
132800                                                                  16970000
132900         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               16980000
133000             SET ASC-DISPLAY-DOLLAR TO TRUE                       16990000
133100             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         17000000
133200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17010000
133300                                                                  17020000
133400         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               17030000
133500             SET ASC-DISPLAY-UNITS  TO TRUE                       17040000
133600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         17050000
133700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17060000
133800                                                                  17070000
133900         WHEN OTHER                                               17080000
134000*            SET ASC-DISPLAY-DOLLAR TO TRUE                       17090000
134100             SET DP013-NO-ROLLBACK                                17100000
134200                 DP013-XCTL-DISPLAY-RESTART                       17110000
134300                 DP013-CICS-ABEND  TO TRUE                        17120000
134400             MOVE '2100-CHECK-FUNCTION-KEY'                       17130000
134500                                   TO DP013-PARAGRAPH             17140000
134600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      17150000
134700                                   TO DP013-MESSAGE-TEXT (1)      17160000
134800             PERFORM DP013-0000-PROCESS-ABEND                     17170000
134900     END-EVALUATE.                                                17180000
135000                                                                  17190000
135100/                                                                 17200000
135200*----------------------------------------------------------------*17210000
135300*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *17220000
135400*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *17230000
135500*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *17240000
135600*    MESSAGE.                                                    *17250000
135700*----------------------------------------------------------------*17260000
135800                                                                  17270000
135900 2110-BROWSE-BACKWARD.                                            17280000
136000                                                                  17290000
136100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    17300000
136200         GIVING PV-TOP-ITEM.                                      17310000
136300                                                                  17320000
136400     IF  ((PV-TOP-ITEM < +1)                                      17330000
136500       OR (PV-TOP-ITEM = +1))                                     17340000
136600         MOVE +1                   TO PV-TOP-ITEM                 17350000
136700*        -- TOP OF LIST --                                        17360000
136800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            17370000
136900         SET DP020-MSG-INFORMATIONAL                              17380000
137000                                   TO TRUE                        17390000
137100     END-IF.                                                      17400000
137200                                                                  17410000
137300/                                                                 17420000
137400*----------------------------------------------------------------*17430000
137500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *17440000
137600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *17450000
137700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *17460000
137800*----------------------------------------------------------------*17470000
137900                                                                  17480000
138000 2120-BROWSE-FORWARD.                                             17490000
138100                                                                  17500000
138200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              17510000
138300         GIVING PV-TOP-ITEM.                                      17520000
138400                                                                  17530000
138500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   17540000
138600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17550000
138700                                   TO PV-TOP-ITEM                 17560000
138800*        -- BOTTOM OF LIST --                                     17570000
138900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            17580000
139000         SET DP020-MSG-INFORMATIONAL                              17590000
139100                                   TO TRUE                        17600000
139200     ELSE                                                         17610000
139300         COMPUTE PV-BOTTOM-ITEM =                                 17620000
139400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 17630000
139500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            17640000
139600*            -- BOTTOM OF LIST --                                 17650000
139700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17660000
139800             SET DP020-MSG-INFORMATIONAL                          17670000
139900                                   TO TRUE                        17680000
140000         END-IF                                                   17690000
140100     END-IF.                                                      17700000
140200                                                                  17710000
140300/                                                                 17720000
140400*----------------------------------------------------------------*17730000
140500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *17740000
140600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *17750000
140700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *17760000
140800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *17770000
140900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *17780000
141000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *17790000
141100*----------------------------------------------------------------*17800000
141200                                                                  17810000
141300 2130-CHECK-FOR-JUMP-BROWSE.                                      17820000
141400                                                                  17830000
141500     SET PS-NO-ERROR               TO TRUE.                       17840000
141600     IF (ASC-START-ITEM-REQUEST = SPACE)                          17850000
141700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17860000
141800                                   TO PV-TOP-ITEM                 17870000
141900     ELSE                                                         17880000
142000         MOVE ASC-START-ITEM-REQUEST                              17890000
142100                                   TO DP010I-UNEDITED-FIELD       17900000
142200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17910000
142300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     17920000
142400         SET DP010I-NEGATIVE-NOT-ALLOWED                          17930000
142500                                   TO TRUE                        17940000
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17951084
263126              USING DP010I-NUMERIC-EDIT-AREA                      17952084
142700                                                                  17960000
142800         IF  NOT DP010I-ERROR-DETECTED                            17970000
142900             MOVE DP010I-NUMERIC-FIELD                            17980000
143000                                   TO ASC-START-ITEM-REQUEST-N    17990000
143100             IF  ASC-START-ITEM-REQUEST-N > ZERO                  18000000
143200                 IF  ASC-START-ITEM-REQUEST-N >                   18010000
143300                                          ASC-NUMBER-OF-ITEMS-READ18020000
143400                     MOVE SPACE TO ASC-START-ITEM-REQUEST         18030000
143500                     COMPUTE PV-TOP-ITEM =                        18040000
143600                             ASC-NUMBER-OF-ITEMS-READ             18050000
143700                             - PC-ITEMS-PER-PANEL + 1             18060000
143800                     IF  PV-TOP-ITEM < +1                         18070000
143900                         MOVE +1   TO PV-TOP-ITEM                 18080000
144000                         MOVE PC-TSYMSG-00070                     18090000
144100                                   TO DP020-MSG-NUMBER            18100000
144200                         SET DP020-MSG-INFORMATIONAL              18110000
144300                                   TO TRUE                        18120000
144400                     END-IF                                       18130000
144500                 ELSE                                             18140000
144600                     MOVE ASC-START-ITEM-REQUEST-N                18150000
144700                                   TO PV-TOP-ITEM                 18160000
144800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      18170000
144900                     COMPUTE PV-BOTTOM-ITEM =                     18180000
145000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     18190000
145100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ18200000
145200*                        -- BOTTOM OF LIST --                     18210000
145300                         MOVE PC-TSYMSG-00070                     18220000
145400                                   TO DP020-MSG-NUMBER            18230000
145500                         SET DP020-MSG-INFORMATIONAL              18240000
145600                                   TO TRUE                        18250000
145700                     END-IF                                       18260000
145800                 END-IF                                           18270000
145900             ELSE                                                 18280000
146000*                --- VALUE OUT OF RANGE ----                      18290000
146100                 MOVE PC-TSYMSG-00101                             18300000
146200                                   TO DP020-MSG-NUMBER            18310000
146300                 MOVE -1           TO ASTRTITL                    18320000
146400                 SET DP030-SET-CURSOR-APPL-1                      18330000
146500                                   TO TRUE                        18340000
146600                 MOVE DP015-REVERSE                               18350000
146700                                   TO ASTRTITH                    18360000
146800                 MOVE DP015-RED    TO ASTRTITC                    18370000
146900                 MOVE DP015-UNP-NUM-BRT-MDT                       18380000
147000                                   TO ASTRTITA                    18390000
147100                 SET DP020-MSG-FATAL                              18400000
147200                                   TO TRUE                        18410000
147300                 SET PS-ERROR      TO TRUE                        18420000
147400             END-IF                                               18430000
147500                                                                  18440000
147600         ELSE                                                     18450000
147700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18460000
147800             MOVE -1               TO ASTRTITL                    18470000
147900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18480000
148000             MOVE DP015-REVERSE    TO ASTRTITH                    18490000
148100             MOVE DP015-RED        TO ASTRTITC                    18500000
148200             MOVE DP015-UNP-NUM-BRT-MDT                           18510000
148300                                   TO ASTRTITA                    18520000
148400             SET DP020-MSG-FATAL   TO TRUE                        18530000
148500             SET PS-ERROR          TO TRUE                        18540000
148600         END-IF                                                   18550000
148700     END-IF.                                                      18560000
148800                                                                  18570000
148900/                                                                 18580000
149000*----------------------------------------------------------------*18590000
149100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *18600000
149200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *18610000
149300*----------------------------------------------------------------*18620000
149400 2140-DESELECT-ALL-ITEMS.                                         18630000
149500                                                                  18640000
149600     MOVE +1                       TO ASC-BLK-SUB.                18650000
149700                                                                  18660000
149800     PERFORM 2141-CLEAR-SELECTED-INDS                             18670000
149900         VARYING ASC-ITEM-SUB                                     18680000
150000         FROM 1 BY 1                                              18690000
150100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18700000
150200                                                                  18710000
150300     ADD +1                        TO ASC-BLK-SUB.                18720000
150400                                                                  18730000
150500     PERFORM 2141-CLEAR-SELECTED-INDS                             18740000
150600         VARYING ASC-ITEM-SUB                                     18750000
150700         FROM 1 BY 1                                              18760000
150800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18770000
150900                                                                  18780000
151000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18790000
151100                                   TO PV-LIST-ITEM-NUMBER.        18800000
151200                                                                  18810000
151300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18820000
151400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18830000
151500                                                                  18840000
151600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18850000
151700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      18860000
151800         MOVE +1                   TO ASC-BLK-SUB                 18870000
151900                                                                  18880000
152000         PERFORM 5100-WRITE-TEMP-STORAGE                          18890000
152100                                                                  18900000
152200         MOVE +1                   TO PV-BLOCK-NUMBER             18910000
152300                                                                  18920000
152400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18930000
152500             PV-FIRST-BLOCK-IN-ARRAY - 1                          18940000
152600                                                                  18950000
152700         PERFORM                                                  18960000
152800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18970000
152900                                                                  18980000
153000             PERFORM 4410-READ-TEMP-STORAGE                       18990000
153100                                                                  19000000
153200             PERFORM 2141-CLEAR-SELECTED-INDS                     19010000
153300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 19020000
153400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19030000
153500                                                                  19040000
153600             PERFORM 5100-WRITE-TEMP-STORAGE                      19050000
153700                                                                  19060000
153800             ADD +1                TO PV-BLOCK-NUMBER             19070000
153900                                                                  19080000
154000         END-PERFORM                                              19090000
154100                                                                  19100000
154200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19110000
154300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19120000
154400                                                                  19130000
154500         PERFORM                                                  19140000
154600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19150000
154700                   ASC-HIGHEST-BLOCK-WRITTEN                      19160000
154800                                                                  19170000
154900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19180000
155000                                   TO PV-BLOCK-NUMBER             19190000
155100                                                                  19200000
155200             PERFORM 4410-READ-TEMP-STORAGE                       19210000
155300                                                                  19220000
155400             PERFORM 2141-CLEAR-SELECTED-INDS                     19230000
155500                 VARYING ASC-ITEM-SUB                             19240000
155600                 FROM 1 BY 1                                      19250000
155700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19260000
155800                                                                  19270000
155900             PERFORM 5100-WRITE-TEMP-STORAGE                      19280000
156000                                                                  19290000
156100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19300000
156200                                                                  19310000
156300         END-PERFORM                                              19320000
156400                                                                  19330000
156500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19340000
156600                                   TO PV-BLOCK-NUMBER             19350000
156700                                                                  19360000
156800         PERFORM 4410-READ-TEMP-STORAGE                           19370000
156900     END-IF.                                                      19380000
157000                                                                  19390000
157100                                                                  19400000
157200     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS19410000
157300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.19420000
157400     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  19430000
157500                                                                  19440000
157600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19450000
157700                                                                  19460000
157800/                                                                 19470000
157900*----------------------------------------------------------------*19480000
158000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *19490000
158100*----------------------------------------------------------------*19500000
158200                                                                  19510000
158300 2141-CLEAR-SELECTED-INDS.                                        19520000
158400                                                                  19530000
158500     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          19540000
158600             NOT EQUAL ZERO                                       19550000
158700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19560000
158800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19570000
158900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    19580000
159000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19590000
159100                                   TO TRUE                        19600000
159200         END-IF                                                   19610000
159300     END-IF.                                                      19620000
159400                                                                  19630000
159500/                                                                 19640000
159600*----------------------------------------------------------------*19650000
159700*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *19660000
159800*  FOR ALL ITEMS.                                                *19670000
159900*----------------------------------------------------------------*19680000
160000                                                                  19690000
160100 2150-SELECT-ALL-ITEMS.                                           19700000
160200                                                                  19710000
160300     MOVE +1                       TO ASC-BLK-SUB.                19720000
160400                                                                  19730000
160500     PERFORM 2151-SET-SELECTED-INDS                               19740000
160600         VARYING ASC-ITEM-SUB                                     19750000
160700         FROM 1 BY 1                                              19760000
160800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19770000
160900                                                                  19780000
161000     ADD +1                        TO ASC-BLK-SUB.                19790000
161100                                                                  19800000
161200     PERFORM 2151-SET-SELECTED-INDS                               19810000
161300         VARYING ASC-ITEM-SUB                                     19820000
161400         FROM 1 BY 1                                              19830000
161500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19840000
161600                                                                  19850000
161700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19860000
161800                                   TO PV-LIST-ITEM-NUMBER.        19870000
161900                                                                  19880000
162000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19890000
162100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19900000
162200                                                                  19910000
162300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19920000
162400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    19930000
162500         MOVE +1                   TO ASC-BLK-SUB                 19940000
162600                                                                  19950000
162700         PERFORM 5100-WRITE-TEMP-STORAGE                          19960000
162800                                                                  19970000
162900         MOVE +1                   TO PV-BLOCK-NUMBER             19980000
163000                                                                  19990000
163100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20000000
163200             PV-FIRST-BLOCK-IN-ARRAY - 1                          20010000
163300                                                                  20020000
163400         PERFORM                                                  20030000
163500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20040000
163600                                                                  20050000
163700             PERFORM 4410-READ-TEMP-STORAGE                       20060000
163800                                                                  20070000
163900             PERFORM 2151-SET-SELECTED-INDS                       20080000
164000                 VARYING ASC-ITEM-SUB                             20090000
164100                 FROM 1 BY 1                                      20100000
164200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20110000
164300                                                                  20120000
164400             PERFORM 5100-WRITE-TEMP-STORAGE                      20130000
164500                                                                  20140000
164600             ADD +1                TO PV-BLOCK-NUMBER             20150000
164700         END-PERFORM                                              20160000
164800                                                                  20170000
164900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20180000
165000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20190000
165100                                                                  20200000
165200         PERFORM                                                  20210000
165300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20220000
165400                   ASC-HIGHEST-BLOCK-WRITTEN                      20230000
165500                                                                  20240000
165600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20250000
165700                                   TO PV-BLOCK-NUMBER             20260000
165800                                                                  20270000
165900             PERFORM 4410-READ-TEMP-STORAGE                       20280000
166000                                                                  20290000
166100             PERFORM 2151-SET-SELECTED-INDS                       20300000
166200                 VARYING ASC-ITEM-SUB                             20310000
166300                 FROM 1 BY 1                                      20320000
166400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20330000
166500                                                                  20340000
166600             PERFORM 5100-WRITE-TEMP-STORAGE                      20350000
166700                                                                  20360000
166800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20370000
166900         END-PERFORM                                              20380000
167000                                                                  20390000
167100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20400000
167200                                   TO PV-BLOCK-NUMBER             20410000
167300                                                                  20420000
167400         PERFORM 4410-READ-TEMP-STORAGE                           20430000
167500     END-IF.                                                      20440000
167600                                                                  20450000
167700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             20460000
167800          ASC-NUMBER-OF-SELECTED-ITEMS.                           20470000
167900                                                                  20480000
168000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20490000
168100                                                                  20500000
168200/                                                                 20510000
168300*----------------------------------------------------------------*20520000
168400*    MARK EACH ITEM AS BEING SELECTED.                           *20530000
168500*----------------------------------------------------------------*20540000
168600                                                                  20550000
168700 2151-SET-SELECTED-INDS.                                          20560000
168800                                                                  20570000
168900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20580000
169000             NOT EQUAL ZERO                                       20590000
169100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20600000
169200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20610000
169300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        20620000
169400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20630000
169500                                   TO TRUE                        20640000
169600         END-IF                                                   20650000
169700     END-IF.                                                      20660000
169800                                                                  20670000
169900/                                                                 20680000
170000*----------------------------------------------------------------*20690000
170100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *20700000
170200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *20710000
170300*----------------------------------------------------------------*20720000
170400 2200-MOVE-SCREEN-TO-COMMAREA.                                    20730000
170500                                                                  20740000
170600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             20750000
170700     MOVE +1                       TO PV-SUB.                     20760000
170800                                                                  20770000
170900     PERFORM 3100-SET-SUBSCRIPTS.                                 20780000
171000                                                                  20790000
171100     IF  ASTRTITL > ZERO                                          20800000
171200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      20810000
171300     ELSE                                                         20820000
171400         IF  ASTRTITF = DP015-ERASE-EOF                           20830000
171500             INITIALIZE ASC-START-ITEM-REQUEST                    20840000
171600         END-IF                                                   20850000
171700     END-IF.                                                      20860000
171800                                                                  20870000
171900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          20880000
172000         VARYING PV-SUB                                           20890000
172100         FROM 1 BY 1                                              20900000
172200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      20910000
172300                                                                  20920000
172400/                                                                 20930000
172500*----------------------------------------------------------------*20940000
172600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *20950000
172700*----------------------------------------------------------------*20960000
172800 2210-MOVE-LINES-TO-COMMAREA.                                     20970000
172900                                                                  20980000
173000     IF  MR-SELECTL (PV-SUB) > ZERO                               20990000
173100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     21000000
173200                                   TO TRUE                        21010000
173300         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        21020000
173400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21030000
173500     ELSE                                                         21040000
173600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                21050000
173700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         21060000
173800             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        21070000
173900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21080000
174000         END-IF                                                   21090000
174100     END-IF.                                                      21100000
174200                                                                  21110000
174300     ADD +1                        TO ASC-ITEM-SUB.               21120000
174400                                                                  21130000
174500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        21140000
174600         ADD +1                    TO ASC-BLK-SUB                 21150000
174700         MOVE +1                   TO ASC-ITEM-SUB                21160000
174800     END-IF.                                                      21170000
174900                                                                  21180000
175000/                                                                 21190000
175100*----------------------------------------------------------------*21200000
175200*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *21210000
175300*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *21220000
175400*----------------------------------------------------------------*21230000
175500 3000-EDIT-DATA-IN-COMMAREA.                                      21240000
175600                                                                  21250000
175700     SET PS-NO-ERROR               TO TRUE.                       21260000
175800                                                                  21270000
175900     PERFORM 3200-RESET-ATTRIBUTES.                               21280000
176000                                                                  21290000
176100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     21300000
176200**                                                                21310000
176300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              21320000
176400* EDITTING IS DONE FROM THE BOTTOM UP.                            21330000
176500**                                                                21340000
176600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       21350000
176700         ASC-ITEMS-DISPLAYED - 1.                                 21360000
176800                                                                  21370000
176900     PERFORM 3100-SET-SUBSCRIPTS.                                 21380000
177000     PERFORM 3300-EDIT-SELECTIONS                                 21390000
177100         VARYING PV-SUB                                           21400000
177200         FROM PV-SUB BY -1                                        21410000
177300         UNTIL PV-SUB < +1                                        21420000
177400                                                                  21430000
177500     IF  PS-NO-ERROR                                              21440000
177600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        21450000
177700     END-IF.                                                      21460000
177800                                                                  21470000
177900     IF  ((PS-NO-ERROR)                                           21480000
178000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   21490000
178100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    21500000
178200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  21510000
178300     END-IF.                                                      21520000
178400                                                                  21530000
178500/                                                                 21540000
178600*----------------------------------------------------------------*21550000
178700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21560000
178800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21570000
178900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21580000
179000*                                                                *21590000
179100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21600000
179200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21610000
179300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21620000
179400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21630000
179500*----------------------------------------------------------------*21640000
179600                                                                  21650000
179700 3100-SET-SUBSCRIPTS.                                             21660000
179800                                                                  21670000
179900     COMPUTE ASC-ITEM-SUB =                                       21680000
180000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21690000
180100                                                                  21700000
180200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21710000
180300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21720000
180400                                                                  21730000
180500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              21740000
180600                                   TO ASC-BLK-SUB                 21750000
180700     ELSE                                                         21760000
180800         MOVE +1                   TO ASC-BLK-SUB                 21770000
180900     END-IF.                                                      21780000
181000                                                                  21790000
181100*----------------------------------------------------------------*21800000
181200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *21810000
181300*----------------------------------------------------------------*21820000
181400                                                                  21830000
181500 3200-RESET-ATTRIBUTES.                                           21840000
181600                                                                  21850000
181700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   21860000
181800     MOVE DP015-GREEN              TO ASTRTITC.                   21870000
181900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   21880000
182000                                                                  21890000
182100     IF DP020-NEXT-ACT-RETURN                                     21900000
182200     OR DP020-NEXT-ACT-READ-MAP                                   21910000
182300        PERFORM                                                   21920000
182400            VARYING PV-SUB                                        21930000
182500            FROM 1 BY 1                                           21940000
182600            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    21950000
182700            MOVE DP015-UNP-ALP-NOR-OFF                            21960000
182800                                      TO MR-SELECTA (PV-SUB)      21970000
182900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      21980000
183000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      21990000
183100        END-PERFORM                                               22000000
183200     ELSE                                                         22010000
183300        PERFORM                                                   22020000
183400            VARYING PV-SUB                                        22030000
183500            FROM 1 BY 1                                           22040000
183600            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     22050000
183700            MOVE DP015-UNP-ALP-NOR-OFF                            22060000
183800                                      TO MR-SELECTA (PV-SUB)      22070000
183900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      22080000
184000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      22090000
184100        END-PERFORM                                               22100000
184200     END-IF.                                                      22110000
184300                                                                  22120000
184400/                                                                 22130000
184500*----------------------------------------------------------------*22140000
184600*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *22150000
184700*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *22160000
184800*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *22170000
184900*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *22180000
185000*----------------------------------------------------------------*22190000
185100 3300-EDIT-SELECTIONS.                                            22200000
185200                                                                  22210000
185300     EVALUATE TRUE                                                22220000
185400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22230000
185500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22240000
185600                 CONTINUE                                         22250000
185700                                                                  22260000
185800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22270000
185900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22280000
186000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS22290000
186100                 MOVE ASC-TEMP-SELECTED-SW                        22300000
186200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22310000
186300                                   TO ASC-SELECTED-SW             22320000
186400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22330000
186500             END-IF                                               22340000
186600                                                                  22350000
186700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22360000
186800                 = SPACE                                          22370000
186900             EVALUATE TRUE                                        22380000
187000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22390000
187100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22400000
187200                     MOVE SPACE    TO ASC-SELECTED-SW             22410000
187300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22420000
187400                                                                  22430000
187500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22440000
187600                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 22450000
187700                     MOVE SPACE    TO ASC-SELECTED-SW             22460000
187800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22470000
187900                                                                  22480000
188000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22490000
188100                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   22500000
188200                     MOVE SPACE    TO ASC-SELECTED-SW             22510000
188300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22520000
188400             END-EVALUATE                                         22530000
188500                                                                  22540000
188600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22550000
188700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22560000
188800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22570000
188900             END-IF                                               22580000
189000             PERFORM 3310-EDIT-RANGE                              22590000
189100                                                                  22600000
189200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22610000
189300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22620000
189400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22630000
189500             END-IF                                               22640000
189600             PERFORM 3310-EDIT-RANGE                              22650000
189700                                                                  22660000
189800         WHEN OTHER                                               22670000
189900             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            22680000
190000             SET DP020-MSG-FATAL   TO TRUE                        22690000
190100             MOVE -1               TO MR-SELECTL (PV-SUB)         22700000
190200             SET DP030-SET-CURSOR-APPL-1                          22710000
190300                                   TO TRUE                        22720000
190400             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         22730000
190500             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         22740000
190600             SET PS-ERROR          TO TRUE                        22750000
190700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22760000
190800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22770000
190900                 MOVE SPACE        TO ASC-SELECTED-SW             22780000
191000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22790000
191100             END-IF                                               22800000
191200     END-EVALUATE.                                                22810000
191300                                                                  22820000
191400     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             22830000
191500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               22840000
191600                                                                  22850000
191700     IF  ASC-ITEM-SUB < 1                                         22860000
191800         SUBTRACT +1 FROM ASC-BLK-SUB                             22870000
191900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                22880000
192000     END-IF.                                                      22890000
192100                                                                  22900000
192200*----------------------------------------------------------------*22910000
192300*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *22920000
192400*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *22930000
192500*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *22940000
192600*  THE ENDING.                                                   *22950000
192700*----------------------------------------------------------------*22960000
192800 3310-EDIT-RANGE.                                                 22970000
192900                                                                  22980000
193000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                22990000
193100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   23000000
193200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23010000
193300                                   TO ASC-SELECTED-SW             23020000
193400                                        (ASC-BLK-SUB ASC-ITEM-SUB)23030000
193500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23040000
193600         ELSE                                                     23050000
193700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     23060000
193800                 CONTINUE                                         23070000
193900             ELSE                                                 23080000
194000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23090000
194100                 MOVE PC-TSYMSG-00054                             23100000
194200                                   TO DP020-MSG-NUMBER            23110000
194300                 SET DP020-MSG-FATAL                              23120000
194400                                   TO TRUE                        23130000
194500                 MOVE -1           TO MR-SELECTL (PV-SUB)         23140000
194600                 SET DP030-SET-CURSOR-APPL-1                      23150000
194700                                   TO TRUE                        23160000
194800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         23170000
194900                 MOVE DP015-UNDERLINE                             23180000
195000                                   TO MR-SELECTH (PV-SUB)         23190000
195100                 SET PS-ERROR      TO TRUE                        23200000
195200             END-IF                                               23210000
195300         END-IF                                                   23220000
195400     ELSE                                                         23230000
195500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23240000
195600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23250000
195700                                   TO ASC-SELECTED-SW             23260000
195800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23270000
195900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23280000
196000         ELSE                                                     23290000
196100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23300000
196200                 CONTINUE                                         23310000
196300             ELSE                                                 23320000
196400*                -- ONLY ONE END-OF-RANGE ALLOWED --              23330000
196500                 MOVE PC-TSYMSG-00055                             23340000
196600                                   TO DP020-MSG-NUMBER            23350000
196700                 SET DP020-MSG-FATAL                              23360000
196800                                   TO TRUE                        23370000
196900                 MOVE -1           TO MR-SELECTL (PV-SUB)         23380000
197000                 SET DP030-SET-CURSOR-APPL-1                      23390000
197100                                   TO TRUE                        23400000
197200                 SET PS-ERROR      TO TRUE                        23410000
197300             END-IF                                               23420000
197400         END-IF                                                   23430000
197500     END-IF.                                                      23440000
197600                                                                  23450000
197700*----------------------------------------------------------------*23460000
197800*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *23470000
197900*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *23480000
198000*----------------------------------------------------------------*23490000
198100 3400-CHECK-RANGE-SEQUENCE.                                       23500000
198200                                                                  23510000
198300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23520000
198400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23530000
198500       AND  ASC-START-OF-SELECTED-RANGE >                         23540000
198600                                         ASC-END-OF-SELECTED-RANGE23550000
198700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23560000
198800         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            23570000
198900         SET DP020-MSG-FATAL       TO TRUE                        23580000
199000         SET PS-ERROR              TO TRUE                        23590000
199100         PERFORM 3410-POSITION-AT-ERROR                           23600000
199200     END-IF.                                                      23610000
199300                                                                  23620000
199400*----------------------------------------------------------------*23630000
199500*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *23640000
199600*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *23650000
199700*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *23660000
199800*----------------------------------------------------------------*23670000
199900 3410-POSITION-AT-ERROR.                                          23680000
200000                                                                  23690000
200100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       23700000
200200                                                                  23710000
200300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 23720000
200400                    - PV-TOP-ITEM + 1.                            23730000
200500                                                                  23740000
200600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23750000
200700         CONTINUE                                                 23760000
200800     ELSE                                                         23770000
200900         MOVE -1                   TO MR-SELECTL (PV-SUB)         23780000
201000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23790000
201100         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23800000
201200     END-IF.                                                      23810000
201300                                                                  23820000
201400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   23830000
201500                    - PV-TOP-ITEM + 1.                            23840000
201600                                                                  23850000
201700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      23860000
201800         CONTINUE                                                 23870000
201900     ELSE                                                         23880000
202000         MOVE -1                   TO MR-SELECTL (PV-SUB)         23890000
202100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         23900000
202200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         23910000
202300     END-IF.                                                      23920000
202400                                                                  23930000
202500/                                                                 23940000
202600*----------------------------------------------------------------*23950000
202700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *23960000
202800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *23970000
202900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *23980000
203000*----------------------------------------------------------------*23990000
203100                                                                  24000000
203200 3500-MARK-RANGE-AS-SELECTED.                                     24010000
203300                                                                  24020000
203400     MOVE +1                       TO ASC-BLK-SUB.                24030000
203500                                                                  24040000
203600     PERFORM 3510-MARK-SELECTED-INDS                              24050000
203700         VARYING ASC-ITEM-SUB                                     24060000
203800         FROM 1 BY 1                                              24070000
203900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24080000
204000                                                                  24090000
204100     ADD +1                        TO ASC-BLK-SUB.                24100000
204200                                                                  24110000
204300     PERFORM 3510-MARK-SELECTED-INDS                              24120000
204400         VARYING ASC-ITEM-SUB                                     24130000
204500         FROM 1 BY 1                                              24140000
204600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24150000
204700                                                                  24160000
204800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24170000
204900                                   TO PV-LIST-ITEM-NUMBER.        24180000
205000                                                                  24190000
205100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24200000
205200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24210000
205300               PC-ITEMS-PER-PANEL).                               24220000
205400                                                                  24230000
205500     MOVE ASC-START-OF-SELECTED-RANGE                             24240000
205600                                   TO PV-START-OF-SELECTED-RANGE. 24250000
205700                                                                  24260000
205800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24270000
205900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24280000
206000               PC-ITEMS-PER-PANEL).                               24290000
206100                                                                  24300000
206200     MOVE ASC-END-OF-SELECTED-RANGE                               24310000
206300                                   TO PV-END-OF-SELECTED-RANGE.   24320000
206400                                                                  24330000
206500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24340000
206600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24350000
206700               PC-ITEMS-PER-PANEL).                               24360000
206800                                                                  24370000
206900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24380000
207000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24390000
207100                                                                  24400000
207200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24410000
207300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24420000
207400         MOVE +1                   TO ASC-BLK-SUB                 24430000
207500         PERFORM 5100-WRITE-TEMP-STORAGE                          24440000
207600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24450000
207700             PV-FIRST-BLOCK-IN-ARRAY - 1                          24460000
207800                                                                  24470000
207900         PERFORM                                                  24480000
208000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24490000
208100                   PV-PREV-BLOCK-IN-ARRAY                         24500000
208200             MOVE PV-FIRST-BLOCK-IN-RANGE                         24510000
208300                                   TO PV-BLOCK-NUMBER             24520000
208400             PERFORM 4410-READ-TEMP-STORAGE                       24530000
208500             PERFORM 3510-MARK-SELECTED-INDS                      24540000
208600                 VARYING ASC-ITEM-SUB                             24550000
208700                 FROM 1 BY 1                                      24560000
208800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24570000
208900             PERFORM 5100-WRITE-TEMP-STORAGE                      24580000
209000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24590000
209100         END-PERFORM                                              24600000
209200                                                                  24610000
209300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24620000
209400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24630000
209500         PERFORM                                                  24640000
209600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24650000
209700                   PV-LAST-BLOCK-IN-RANGE                         24660000
209800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24670000
209900                                   TO PV-BLOCK-NUMBER             24680000
210000             PERFORM 4410-READ-TEMP-STORAGE                       24690000
210100             PERFORM 3510-MARK-SELECTED-INDS                      24700000
210200                 VARYING ASC-ITEM-SUB                             24710000
210300                 FROM 1 BY 1                                      24720000
210400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24730000
210500             PERFORM 5100-WRITE-TEMP-STORAGE                      24740000
210600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24750000
210700         END-PERFORM                                              24760000
210800                                                                  24770000
210900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24780000
211000                                   TO PV-BLOCK-NUMBER             24790000
211100         PERFORM 4410-READ-TEMP-STORAGE                           24800000
211200     END-IF.                                                      24810000
211300                                                                  24820000
211400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 24830000
211500                                      ASC-END-OF-SELECTED-RANGE.  24840000
211600                                                                  24850000
211700/                                                                 24860000
211800*----------------------------------------------------------------*24870000
211900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *24880000
212000*----------------------------------------------------------------*24890000
212100                                                                  24900000
212200 3510-MARK-SELECTED-INDS.                                         24910000
212300                                                                  24920000
212400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         24930000
212500         ASC-START-OF-SELECTED-RANGE)                             24940000
212600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         24950000
212700         ASC-START-OF-SELECTED-RANGE)                             24960000
212800                                                                  24970000
212900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     24980000
213000             ASC-END-OF-SELECTED-RANGE)                           24990000
213100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     25000000
213200             ASC-END-OF-SELECTED-RANGE)                           25010000
213300                                                                  25020000
213400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25030000
213500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25040000
213600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25050000
213700                                   TO TRUE                        25060000
213800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25070000
213900                                   TO TRUE                        25080000
214000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS25090000
214100             END-IF                                               25100000
214200         END-IF                                                   25110000
214300     END-IF.                                                      25120000
214400                                                                  25130000
214500/                                                                 25140000
214600*----------------------------------------------------------------*25150000
214700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25160000
214800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25170000
214900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25180000
215000*    DISPLAY THE PANEL TO USER.                                  *25190000
215100*----------------------------------------------------------------*25200000
215200                                                                  25210000
215300 4000-BUILD-INITIAL-PANEL.                                        25220000
215400                                                                  25230000
215500     INITIALIZE ASC-BLOCK-ENTRIES (1)                             25240000
215600                ASC-BLOCK-ENTRIES (2).                            25250000
215700*    SET ASC-DISPLAY-DOLLAR TO TRUE.                              25260000
215800                                                                  25270000
215900     MOVE +1                       TO ASC-BLK-SUB                 25280000
216000                                      PV-STRING-POINTER-FROM      25290000
216100                                      PV-STRING-POINTER-WHERE.    25300000
216200                                                                  25310000
216300     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       25320000
216400                                                                  25330000
216500     MOVE +0                       TO ASC-ITEM-SUB                25340000
216600                                      ASC-NUMBER-OF-ITEMS-READ    25350000
216700                                      ASC-NUMBER-OF-SELECTED-ITEMS25360000
216800                                      ASC-HIGHEST-BLOCK-WRITTEN   25370000
216900                                      ASC-START-OF-SELECTED-RANGE 25380000
217000                                      ASC-END-OF-SELECTED-RANGE   25390000
217100                                      ASC-ITEM-AT-TOP-OF-PANEL.   25400000
217200                                                                  25410000
217300     EXEC CICS ASSIGN                                             25420000
217400               APPLID(PV-SYSTEM-ID)                               25430000
217500     END-EXEC.                                                    25440000
217600                                                                  25450000
W24803*    IF PV-REGION-IND = 'T'                                       25460074
W24803*       MOVE '04'          TO PV-QUALIFIER                        25470074
W24803*                             PV-QUALIFIER-COMMA                  25480074
W24803*    ELSE                                                         25490074
W24803        MOVE PV-REGION-IND TO PV-QUALIFIER                        25500000
W24803                              PV-QUALIFIER-COMMA                  25510000
W24803*    END-IF.                                                      25520074
217900     MOVE SPACES        TO PV-FROM-CLAUSE                         25530000
218000                           PV-WHERE-CLAUSE.                       25540000
218100                                                                  25550000
218200     PERFORM 4100-BUILD-CURSOR.                                   25560000
218300     PERFORM 4150-COMBINE-SQL.                                    25570000
218400                                                                  25580000
218500     PERFORM 4010-DECLARE-CURSOR.                                 25590000
218600     PERFORM 4020-PREPARE-CURSOR.                                 25600000
218700     PERFORM 4030-OPEN-CURSOR.                                    25610000
218800                                                                  25620000
218900     PERFORM 4300-READ-ITEMS-FROM-DB.                             25630000
219000                                                                  25640000
219100     PERFORM 4040-CLOSE-CURSOR.                                   25650000
219200                                                                  25660000
219300     MOVE +1                       TO PV-TOP-ITEM.                25670000
219400                                                                  25680000
219500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          25690000
219600         SET DP020-NEXT-ACT-APPL-ERROR                            25700000
219700                                   TO TRUE                        25710000
219800         SET DP020-MSG-FATAL       TO TRUE                        25720000
219900         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            25730000
220000     ELSE                                                         25740000
220100         MOVE -1                   TO MR-SELECTL (1)              25750000
220200         SET DP030-SET-CURSOR-APPL-1                              25760000
220300                                   TO TRUE                        25770000
220400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     25780000
220500     END-IF.                                                      25790000
220600                                                                  25800000
220700/                                                                 25810000
220800*----------------------------------------------------------------*25820000
220900* DECLARE THE CURSOR FOR DYNAMIC SQL CALL                        *25830000
221000*----------------------------------------------------------------*25840000
221100 4010-DECLARE-CURSOR.                                             25850000
221200                                                                  25860000
221300     EXEC SQL                                                     25870000
221400         DECLARE PO-CSR CURSOR FOR                                25880000
221500                 PO-SELECT                                        25890000
221600     END-EXEC.                                                    25900000
221700                                                                  25910000
221800/                                                                 25920000
221900*----------------------------------------------------------------*25930000
222000* OPEN THE PO CURSOR                                             *25940000
222100*----------------------------------------------------------------*25950000
222200 4020-PREPARE-CURSOR.                                             25960000
222300                                                                  25970000
222400     EXEC SQL                                                     25980000
222500         PREPARE PO-SELECT FROM :PV-SQL-STMT                      25990000
222600     END-EXEC.                                                    26000000
222700                                                                  26010000
222800     EVALUATE TRUE                                                26020000
222900         WHEN SQLCODE = +0                                        26030000
223000              CONTINUE                                            26040000
223010         WHEN SQLCODE = -206                                      26050000
223011           SET PS-206-PURITM         TO TRUE                      26060000
223012*          SET PS-ERROR              TO TRUE                      26070000
223013*          MOVE PC-TSYMSG-00317      TO DP020-MSG-NUMBER          26080000
223014*          SET DP020-MSG-FATAL       TO TRUE                      26090000
223100         WHEN SQLWARN0 NOT = SPACE                                26100000
223200         WHEN SQLCODE  NOT = 0                                    26110000
223300              MOVE '4020-PREPARE-CURSOR'                          26120000
223400                               TO DP013-PARAGRAPH                 26130000
223500              MOVE 'PREPARE PO-CSR    '                           26140000
223600                               TO DP013-MESSAGE-TEXT (1)          26150000
223700              MOVE SQLCA       TO DP013-SQLCA                     26160000
223800              MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)        26170000
223900              MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (2)        26180000
224000              MOVE 'TPLNSHP'   TO DP013-DB2-TABLE-NAME (3)        26190000
224100              MOVE 'TSTATCD'   TO DP013-DB2-TABLE-NAME (4)        26200000
W24803              MOVE 'XLT_SKU'   TO DP013-DB2-TABLE-NAME (5)        26210000
224200              SET DP013-DB2-ABEND                                 26220000
224300                               TO TRUE                            26230000
224400              PERFORM DP013-0000-PROCESS-ABEND                    26240000
224500     END-EVALUATE.                                                26250000
224600/                                                                 26260000
224700*----------------------------------------------------------------*26270000
224800* OPEN THE PO CURSOR                                             *26280000
224900*----------------------------------------------------------------*26290000
225000                                                                  26300000
225100 4030-OPEN-CURSOR.                                                26310000
225200                                                                  26320000
225300     PERFORM                                                      26330000
225400         WITH TEST AFTER                                          26340000
225500         VARYING PV-RETRY-COUNTER                                 26350000
225600         FROM 1 BY 1                                              26360000
225700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26370000
225800            OR (SQLCODE = +0))                                    26380000
225900                                                                  26390000
226000         EXEC SQL                                                 26400000
226100             OPEN PO-CSR                                          26410000
226200         END-EXEC                                                 26420000
226300                                                                  26430000
226400         EVALUATE TRUE                                            26440000
226500             WHEN SQLCODE = +0                                    26450000
226600                  CONTINUE                                        26460000
226700             WHEN SQLCODE = -904                                  26470000
226800             WHEN SQLCODE = -913                                  26480000
226900                  CONTINUE                                        26490000
227000             WHEN SQLWARN0 NOT = SPACE                            26500000
227100             WHEN SQLCODE  NOT = +0                               26510000
227200                  MOVE '4010-OPEN-CURSOR'                         26520000
227300                                   TO DP013-PARAGRAPH             26530000
227400                  MOVE 'OPEN PO-CSR CURSOR'                       26540000
227500                                   TO DP013-MESSAGE-TEXT (1)      26550000
227600                  MOVE SQLCA       TO DP013-SQLCA                 26560000
227700                  MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)    26570000
227800                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (2)    26580000
227900                  MOVE 'TPLNSHP'   TO DP013-DB2-TABLE-NAME (3)    26590000
228000                  MOVE 'TENTNME'   TO DP013-DB2-TABLE-NAME (4)    26600000
W24803                  MOVE 'XLT_SKU'   TO DP013-DB2-TABLE-NAME (5)    26610000
228100                  SET DP013-DB2-ABEND                             26620000
228200                                   TO TRUE                        26630000
228300                  PERFORM DP013-0000-PROCESS-ABEND                26640000
228400         END-EVALUATE                                             26650000
228500     END-PERFORM.                                                 26660000
228600                                                                  26670000
228700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26680000
228800         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             26690000
228900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              26700000
229000                                   TO DP013-MESSAGE-TEXT (1)      26710000
229100         MOVE SQLCA                TO DP013-SQLCA                 26720000
229200         SET DP013-DB2-ABEND       TO TRUE                        26730000
229300         PERFORM DP013-0000-PROCESS-ABEND                         26740000
229400     END-IF.                                                      26750000
229500                                                                  26760000
229600/                                                                 26770000
229700*----------------------------------------------------------------*26780000
229800* CLOSE THE PO CURSOR                                            *26790000
229900*----------------------------------------------------------------*26800000
230000                                                                  26810000
230100 4040-CLOSE-CURSOR.                                               26820000
230200                                                                  26830000
230300     EXEC SQL                                                     26840000
230400         CLOSE PO-CSR                                             26850000
230500     END-EXEC.                                                    26860000
230600                                                                  26870000
230700     EVALUATE TRUE                                                26880000
230800         WHEN SQLCODE = +0                                        26890000
230900              CONTINUE                                            26900000
231000         WHEN SQLWARN0 NOT = SPACE                                26910000
231100         WHEN SQLCODE  NOT = +0                                   26920000
231200              MOVE '4020-CLOSE-CURSOR'                            26930000
231300                                   TO DP013-PARAGRAPH             26940000
231400              MOVE 'CLOSE PO-CSR CURSOR'                          26950000
231500                                   TO DP013-MESSAGE-TEXT (1)      26960000
231600              MOVE SQLCA           TO DP013-SQLCA                 26970000
231700              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    26980000
231800              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    26990000
231900              MOVE 'TPLNSHP'       TO DP013-DB2-TABLE-NAME (3)    27000000
232000              MOVE 'TENTNME'       TO DP013-DB2-TABLE-NAME (4)    27010000
W24803              MOVE 'XLT_SKU'       TO DP013-DB2-TABLE-NAME (5)    27020000
232100              SET DP013-DB2-ABEND  TO TRUE                        27030000
232200              PERFORM DP013-0000-PROCESS-ABEND                    27040000
232300     END-EVALUATE.                                                27050000
232400                                                                  27060000
232500/                                                                 27070000
232600*----------------------------------------------------------------*27080000
232700*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *27090000
232800*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *27100000
232900*----------------------------------------------------------------*27110000
233000                                                                  27120000
233100 4100-BUILD-CURSOR.                                               27130000
233200                                                                  27140000
233300     IF  ASC-KEY-IMPRT-AGNT-PO-NBR > ZEROES                       27150000
233400         PERFORM 4101-IMPRT-AGNT-PO-NBR.                          27160000
233500                                                                  27170000
233600     PERFORM 4102-DEPT-NBR.                                       27180000
233700                                                                  27190000
233800     IF  ASC-KEY-PO-TYP-CDE > SPACES                              27200000
233900         PERFORM 4103-PO-TYP-CDE.                                 27210000
234000                                                                  27220000
234100     IF  ASC-KEY-STATUS-CDE > SPACES                              27230000
234200         PERFORM 4104-STATUS-CDE.                                 27240000
234300                                                                  27250000
234400     IF  ASC-KEY-STATUS-CLS > SPACES                              27260000
234500         PERFORM 4105-STATUS-CLS.                                 27270000
234600                                                                  27280000
234700     IF  ASC-KEY-EDI-IND > SPACES                                 27290000
234800         PERFORM 4106-EDI-IND.                                    27300000
234900                                                                  27310000
235000     IF  ASC-KEY-DIR-STORE-IND > SPACES                           27320000
235100         PERFORM 4107-DIR-STORE-IND.                              27330000
235200                                                                  27340000
235300     IF  ASC-KEY-PIC-AD-IND > SPACES                              27350000
235400         PERFORM 4107-PIC-AD-IND.                                 27360000
235500                                                                  27370000
235600     IF  ASC-KEY-NEW-STR-IND > SPACES                             27380000
235700         PERFORM 4108-NEW-STR-IND.                                27390000
235800                                                                  27400000
W24803     IF  ASC-KEY-SKU-NBR > ZEROS                                  27410000
W24803         SET PS-USE-TPURITM TO TRUE                               27420000
W24803         PERFORM 4111-SKU-NBR                                     27430000
W24803     ELSE                                                         27440000
W24803         IF ASC-KEY-SUB-CL-NBR > ZEROS                            27450000
W24803            SET PS-USE-TPURITM TO TRUE                            27460000
W24803            PERFORM 4109-SUB-CL-NBR                               27470000
W24803         ELSE                                                     27480000
W24803            IF  ASC-KEY-MAJ-CL-NBR > ZEROS                        27490000
W24803                 SET PS-USE-TPURITM TO TRUE                       27500000
W24803                 PERFORM 4110-MAJ-CL-NBR                          27510000
W24803            END-IF                                                27520000
W24803         END-IF                                                   27530000
W24803     END-IF.                                                      27540000
244600                                                                  27550000
244700     IF  ASC-KEY-AD-EVNT-DTE > SPACES                             27560000
244800         SET PS-USE-TPURITM TO TRUE                               27570000
244900         PERFORM 4112-AD-EVNT-DTE.                                27580000
245000                                                                  27590000
245100     IF  ASC-KEY-OTB-PER-NBR-BEG > SPACES AND                     27600000
245200         ASC-KEY-OTB-PER-NBR-END > SPACES                         27610000
245300         IF ASC-KEY-OTB-PER-NBR-BEG = ASC-KEY-OTB-PER-NBR-END     27620000
245400            PERFORM 4113-OTB-PER-ONE                              27630000
245500         ELSE                                                     27640000
245600            PERFORM 4114-OTB-PER-NBR-BEG-END                      27650000
245700         END-IF                                                   27660000
245800     ELSE                                                         27670000
245900        IF  ASC-KEY-OTB-PER-NBR-BEG > SPACES                      27680000
246000            MOVE HIGH-VALUES TO ASC-KEY-OTB-PER-NBR-END           27690000
246100            PERFORM 4115-OTB-PER-BEG                              27700000
246200        ELSE                                                      27710000
246300           IF  ASC-KEY-OTB-PER-NBR-END > SPACES                   27720000
246400               MOVE LOW-VALUES  TO ASC-KEY-OTB-PER-NBR-BEG        27730000
246500               PERFORM 4116-OTB-PER-END                           27740000
246600           END-IF                                                 27750000
246700        END-IF                                                    27760000
246800     END-IF.                                                      27770000
246900                                                                  27780000
247000     IF  ASC-KEY-DONT-SHIP-BEF-DTE-B > SPACES AND                 27790000
247100         ASC-KEY-DONT-SHIP-BEF-DTE-E > SPACES                     27800000
247200         IF ASC-KEY-DONT-SHIP-BEF-DTE-B =                         27810000
247300            ASC-KEY-DONT-SHIP-BEF-DTE-E                           27820000
247400            PERFORM 4117-DONT-SHIP-BEF-DTE-ONE                    27830000
247500         ELSE                                                     27840000
247600            PERFORM 4118-DONT-SHIP-BEF-DTE-B-E                    27850000
247700         END-IF                                                   27860000
247800     ELSE                                                         27870000
247900        IF  ASC-KEY-DONT-SHIP-BEF-DTE-B > SPACES                  27880000
248000            MOVE HIGH-VALUES TO ASC-KEY-DONT-SHIP-BEF-DTE-E       27890000
248100            PERFORM 4119-DONT-SHIP-BEF-DTE-B                      27900000
248200        ELSE                                                      27910000
248300           IF  ASC-KEY-DONT-SHIP-BEF-DTE-E > SPACES               27920000
248400               MOVE LOW-VALUES TO ASC-KEY-DONT-SHIP-BEF-DTE-E     27930000
248500               PERFORM 4120-DONT-SHIP-BEF-DTE-E                   27940000
248600           END-IF                                                 27950000
248700        END-IF                                                    27960000
248800     END-IF.                                                      27970000
248900                                                                  27980000
249000     IF  ASC-KEY-ENT-NAME-DESC > SPACES                           27990000
249100         SET PS-USE-TENTNME TO TRUE                               28000000
249200         PERFORM 4121-ENT-NAME-DESC.                              28010000
249300                                                                  28020000
249400     IF  ASC-KEY-VEND-STYL-NME > SPACES                           28030000
249500         SET PS-USE-TPURITM TO TRUE                               28040000
249600         PERFORM 4122-VEND-STYL-NME.                              28050000
249700                                                                  28060000
249800     STRING                                                       28070000
249900         ' AND A.VER_STATUS_CDE = '           DELIMITED BY SIZE,  28080000
250000         PC-QUOTE                             DELIMITED BY SIZE,  28090000
250100         'A'                                  DELIMITED BY SIZE,  28100000
250200         PC-QUOTE                             DELIMITED BY SIZE,  28110000
250300                                                                  28120000
250400         ' AND C.VER_STATUS_CDE = '           DELIMITED BY SIZE,  28130000
250500         PC-QUOTE                             DELIMITED BY SIZE,  28140000
250600         'A'                                  DELIMITED BY SIZE,  28150000
250700         PC-QUOTE                             DELIMITED BY SIZE,  28160000
250800                                                                  28170000
250900         ' AND A.PO_CATEG_CDE = '             DELIMITED BY SIZE,  28180000
251000         PC-QUOTE                             DELIMITED BY SIZE,  28190000
251100         'MR'                                 DELIMITED BY SIZE,  28200000
251200         PC-QUOTE                             DELIMITED BY SIZE,  28210000
251300                                                                  28220000
251400         ' AND A.PO_NBR = C.PO_NBR'           DELIMITED BY SIZE,  28230000
251500                                                                  28240000
251600         ' AND E.STATUS_TYP_CDE = '           DELIMITED BY SIZE,  28250000
251700         PC-QUOTE                             DELIMITED BY SIZE,  28260000
251800         'P'                                  DELIMITED BY SIZE,  28270000
251900         PC-QUOTE                             DELIMITED BY SIZE,  28280000
252000                                                                  28290000
252100         ' AND A.STATUS_CDE = E.STATUS_CDE'   DELIMITED BY SIZE   28300000
252200     INTO                                                         28310000
252300         PV-WHERE-CLAUSE                                          28320000
252400     WITH                                                         28330000
252500         POINTER PV-STRING-POINTER-WHERE.                         28340000
252600                                                                  28350000
252700     IF PS-USE-TPURITM OR PS-206-PURITM                           28360000
252800        STRING                                                    28370000
252900            ' AND B.VER_STATUS_CDE = '        DELIMITED BY SIZE,  28380000
253000            PC-QUOTE                          DELIMITED BY SIZE,  28390000
253100            'A'                               DELIMITED BY SIZE,  28400000
253200            PC-QUOTE                          DELIMITED BY SIZE,  28410000
253300                                                                  28420000
253400            ' AND A.PO_NBR = B.PO_NBR'        DELIMITED BY SIZE   28430000
253500        INTO                                                      28440000
253600            PV-WHERE-CLAUSE                                       28450000
253700        WITH                                                      28460000
253800            POINTER PV-STRING-POINTER-WHERE.                      28470000
253900                                                                  28480000
254000     IF PS-USE-TENTNME                                            28490000
254100        STRING                                                    28500000
254200            ' AND A.ENT_ID = D.ENT_ID'        DELIMITED BY SIZE   28510000
254300        INTO                                                      28520000
254400            PV-WHERE-CLAUSE                                       28530000
254500        WITH                                                      28540000
254600            POINTER PV-STRING-POINTER-WHERE.                      28550000
254700                                                                  28560000
254800     STRING                                                       28570000
254900         ' ORDER BY'                          DELIMITED BY SIZE,  28580000
255000         ' A.OTB_PER_NBR DESC'                DELIMITED BY SIZE,  28590000
255100         ',A.ENT_ID'                          DELIMITED BY SIZE,  28600000
255200         ',A.DEPT_NBR'                        DELIMITED BY SIZE,  28610000
255300         ',C.DONT_SHIP_BEF_DTE DESC'          DELIMITED BY SIZE,  28620000
255400         ',A.PO_NBR'                          DELIMITED BY SIZE   28630000
255500     INTO                                                         28640000
255600         PV-WHERE-CLAUSE                                          28650000
255700     WITH                                                         28660000
255800         POINTER PV-STRING-POINTER-WHERE.                         28670000
255900                                                                  28680000
256000* THE FOLLOWING CODE WILL SETUP THE FROM CLAUSE                   28690000
256100                                                                  28700000
256200     STRING                                                       28710000
256300         PV-TABLE-QUALIFIER                   DELIMITED BY SIZE,  28720000
256400         'TPURCHS A'                          DELIMITED BY SIZE,  28730000
256500         PV-TABLE-QUALIFIER-COMMA             DELIMITED BY SIZE,  28740000
256600         'TPLNSHP C'                          DELIMITED BY SIZE,  28750000
256700         PV-TABLE-QUALIFIER-COMMA             DELIMITED BY SIZE,  28760000
256800         'TSTATCD E'                          DELIMITED BY SIZE   28770000
256900        INTO                                                      28780000
257000            PV-FROM-CLAUSE                                        28790000
257100        WITH                                                      28800000
257200            POINTER PV-STRING-POINTER-FROM.                       28810000
257300                                                                  28820000
257400     IF PS-USE-TPURITM OR PS-206-PURITM                           28830000
257500        STRING                                                    28840000
257600            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  28850000
257700            'TPURITM B'                       DELIMITED BY SIZE,  28860000
W24803            ' LEFT OUTER JOIN '               DELIMITED BY SIZE,  28870073
W24803            PV-TABLE-QUALIFIER                DELIMITED BY SIZE,  28880073
W24803            'XLT_SKU S'                       DELIMITED BY SIZE,  28890000
W24803            ' ON B.ITM_NBR = S.ITM_NBR'       DELIMITED BY SIZE,  28900073
W24803            ' LEFT OUTER JOIN '               DELIMITED BY SIZE,  28910073
W24803            PV-TABLE-QUALIFIER                DELIMITED BY SIZE,  28920073
W24803            'XLT_VND_STYL V'                  DELIMITED BY SIZE,  28930073
W24803            ' ON S.STYL_ID = V.STYL_ID'       DELIMITED BY SIZE   28940073
257800        INTO                                                      28950000
257900            PV-FROM-CLAUSE                                        28960000
258000        WITH                                                      28970000
258100            POINTER PV-STRING-POINTER-FROM.                       28980000
258200                                                                  28990000
258300     IF PS-USE-TENTNME                                            29000000
258400        STRING                                                    29010000
258500            PV-TABLE-QUALIFIER-COMMA          DELIMITED BY SIZE,  29020000
258600            'TENTNME D'                       DELIMITED BY SIZE   29030000
258700        INTO                                                      29040000
258800            PV-FROM-CLAUSE                                        29050000
258900        WITH                                                      29060000
259000            POINTER PV-STRING-POINTER-FROM.                       29070000
259100                                                                  29080000
259200 4101-IMPRT-AGNT-PO-NBR.                                          29090000
259300                                                                  29100000
259400     MOVE ASC-KEY-IMPRT-AGNT-PO-NBR TO PV-IMPRT-AGNT-PO-NBR.      29110000
259500                                                                  29120000
259600     IF PV-STRING-POINTER-WHERE > 1                               29130000
259700        STRING                                                    29140000
259800            ' AND '                           DELIMITED BY SIZE   29150000
259900        INTO                                                      29160000
260000            PV-WHERE-CLAUSE                                       29170000
260100        WITH                                                      29180000
260200            POINTER PV-STRING-POINTER-WHERE.                      29190000
260300                                                                  29200000
260400     STRING                                                       29210000
260500         'A.IMPRT_AGNT_PO_NBR = '             DELIMITED BY SIZE,  29220000
260600          PV-IMPRT-AGNT-PO-NBR                DELIMITED BY SIZE   29230000
260700     INTO                                                         29240000
260800         PV-WHERE-CLAUSE                                          29250000
260900     WITH                                                         29260000
261000         POINTER PV-STRING-POINTER-WHERE.                         29270000
261100                                                                  29280000
261200 4102-DEPT-NBR.                                                   29290000
261300                                                                  29300000
261400     IF PV-STRING-POINTER-WHERE > 1                               29310000
261500        STRING                                                    29320000
261600            ' AND '                           DELIMITED BY SIZE   29330000
261700        INTO                                                      29340000
261800            PV-WHERE-CLAUSE                                       29350000
261900        WITH                                                      29360000
262000            POINTER PV-STRING-POINTER-WHERE.                      29370000
262100                                                                  29380000
262200     STRING                                                       29390000
262300         'A.DEPT_NBR = '                      DELIMITED BY SIZE,  29400000
262400         PC-QUOTE                             DELIMITED BY SIZE,  29410000
262500         ASC-KEY-DEPT-NBR                     DELIMITED BY SIZE,  29420000
262600         PC-QUOTE                             DELIMITED BY SIZE   29430000
262700     INTO                                                         29440000
262800         PV-WHERE-CLAUSE                                          29450000
262900     WITH                                                         29460000
263000         POINTER PV-STRING-POINTER-WHERE.                         29470000
263100                                                                  29480000
263200 4103-PO-TYP-CDE.                                                 29490000
263300                                                                  29500000
263400     IF PV-STRING-POINTER-WHERE > 1                               29510000
263500        STRING                                                    29520000
263600            ' AND '                           DELIMITED BY SIZE   29530000
263700        INTO                                                      29540000
263800            PV-WHERE-CLAUSE                                       29550000
263900        WITH                                                      29560000
264000            POINTER PV-STRING-POINTER-WHERE.                      29570000
264100                                                                  29580000
264200     STRING                                                       29590000
264300         'A.PO_TYP_CDE = '                    DELIMITED BY SIZE,  29600000
264400         PC-QUOTE                             DELIMITED BY SIZE,  29610000
264500         ASC-KEY-PO-TYP-CDE                   DELIMITED BY SIZE,  29620000
264600         PC-QUOTE                             DELIMITED BY SIZE   29630000
264700     INTO                                                         29640000
264800         PV-WHERE-CLAUSE                                          29650000
264900     WITH                                                         29660000
265000         POINTER PV-STRING-POINTER-WHERE.                         29670000
265100                                                                  29680000
265200 4104-STATUS-CDE.                                                 29690000
265300                                                                  29700000
265400     IF PV-STRING-POINTER-WHERE > 1                               29710000
265500        STRING                                                    29720000
265600            ' AND '                           DELIMITED BY SIZE   29730000
265700        INTO                                                      29740000
265800            PV-WHERE-CLAUSE                                       29750000
265900        WITH                                                      29760000
266000            POINTER PV-STRING-POINTER-WHERE.                      29770000
266100                                                                  29780000
266200     STRING                                                       29790000
266300         'A.STATUS_CDE = '                    DELIMITED BY SIZE,  29800000
266400         PC-QUOTE                             DELIMITED BY SIZE,  29810000
266500         ASC-KEY-STATUS-CDE                   DELIMITED BY SIZE,  29820000
266600         PC-QUOTE                             DELIMITED BY SIZE   29830000
266700     INTO                                                         29840000
266800         PV-WHERE-CLAUSE                                          29850000
266900     WITH                                                         29860000
267000         POINTER PV-STRING-POINTER-WHERE.                         29870000
267100                                                                  29880000
267200 4105-STATUS-CLS.                                                 29890000
267300                                                                  29900000
267400     IF PV-STRING-POINTER-WHERE > 1                               29910000
267500        STRING                                                    29920000
267600            ' AND '                           DELIMITED BY SIZE   29930000
267700        INTO                                                      29940000
267800            PV-WHERE-CLAUSE                                       29950000
267900        WITH                                                      29960000
268000            POINTER PV-STRING-POINTER-WHERE.                      29970000
268100                                                                  29980000
268200     IF ASC-KEY-STATUS-CLS = 'BTH'                                29990000
268300         STRING                                                   30000000
268400             'E.STATUS_CLS IN ('              DELIMITED BY SIZE,  30010000
268500             PC-QUOTE                         DELIMITED BY SIZE,  30020000
268600             PC-ACT                           DELIMITED BY SIZE,  30030000
268700             PC-QUOTE                         DELIMITED BY SIZE,  30040000
268800             ','                              DELIMITED BY SIZE,  30050000
268900             PC-QUOTE                         DELIMITED BY SIZE,  30060000
269000             PC-CMP                           DELIMITED BY SIZE,  30070000
269100             PC-QUOTE                         DELIMITED BY SIZE,  30080000
269200             ')'                              DELIMITED BY SIZE   30090000
269300         INTO                                                     30100000
269400             PV-WHERE-CLAUSE                                      30110000
269500         WITH                                                     30120000
269600             POINTER PV-STRING-POINTER-WHERE                      30130000
269700     ELSE                                                         30140000
269800         STRING                                                   30150000
269900             'E.STATUS_CLS = '                DELIMITED BY SIZE,  30160000
270000             PC-QUOTE                         DELIMITED BY SIZE,  30170000
270100             ASC-KEY-STATUS-CLS               DELIMITED BY SIZE,  30180000
270200             PC-QUOTE                         DELIMITED BY SIZE   30190000
270300         INTO                                                     30200000
270400             PV-WHERE-CLAUSE                                      30210000
270500         WITH                                                     30220000
270600             POINTER PV-STRING-POINTER-WHERE                      30230000
270700     END-IF.                                                      30240000
270800                                                                  30250000
270900 4106-EDI-IND.                                                    30260000
271000                                                                  30270000
271100     IF PV-STRING-POINTER-WHERE > 1                               30280000
271200        STRING                                                    30290000
271300            ' AND '                           DELIMITED BY SIZE   30300000
271400        INTO                                                      30310000
271500            PV-WHERE-CLAUSE                                       30320000
271600        WITH                                                      30330000
271700            POINTER PV-STRING-POINTER-WHERE.                      30340000
271800                                                                  30350000
271900     STRING                                                       30360000
272000         'A.EDI_IND = '                       DELIMITED BY SIZE,  30370000
272100         PC-QUOTE                             DELIMITED BY SIZE,  30380000
272200         ASC-KEY-EDI-IND                      DELIMITED BY SIZE,  30390000
272300         PC-QUOTE                             DELIMITED BY SIZE   30400000
272400     INTO                                                         30410000
272500         PV-WHERE-CLAUSE                                          30420000
272600     WITH                                                         30430000
272700         POINTER PV-STRING-POINTER-WHERE.                         30440000
272800                                                                  30450000
272900 4107-DIR-STORE-IND.                                              30460000
273000                                                                  30470000
273100     IF PV-STRING-POINTER-WHERE > 1                               30480000
273200        STRING                                                    30490000
273300            ' AND '                           DELIMITED BY SIZE   30500000
273400        INTO                                                      30510000
273500            PV-WHERE-CLAUSE                                       30520000
273600        WITH                                                      30530000
273700            POINTER PV-STRING-POINTER-WHERE.                      30540000
273800                                                                  30550000
273900     STRING                                                       30560000
274000         'A.DIR_STR_IND = '                   DELIMITED BY SIZE,  30570000
274100         PC-QUOTE                             DELIMITED BY SIZE,  30580000
274200         ASC-KEY-DIR-STORE-IND                DELIMITED BY SIZE,  30590000
274300         PC-QUOTE                             DELIMITED BY SIZE   30600000
274400     INTO                                                         30610000
274500         PV-WHERE-CLAUSE                                          30620000
274600     WITH                                                         30630000
274700         POINTER PV-STRING-POINTER-WHERE.                         30640000
274800                                                                  30650000
274900 4107-PIC-AD-IND.                                                 30660000
275000                                                                  30670000
275100     IF PV-STRING-POINTER-WHERE > 1                               30680000
275200        STRING                                                    30690000
275300            ' AND '                           DELIMITED BY SIZE   30700000
275400        INTO                                                      30710000
275500            PV-WHERE-CLAUSE                                       30720000
275600        WITH                                                      30730000
275700            POINTER PV-STRING-POINTER-WHERE.                      30740000
275800                                                                  30750000
275900     STRING                                                       30760000
276000         'B.PIC_ITM_IND = '                   DELIMITED BY SIZE,  30770000
276100         PC-QUOTE                             DELIMITED BY SIZE,  30780000
276200         ASC-KEY-PIC-AD-IND                   DELIMITED BY SIZE,  30790000
276300         PC-QUOTE                             DELIMITED BY SIZE   30800000
276400     INTO                                                         30810000
276500         PV-WHERE-CLAUSE                                          30820000
276600     WITH                                                         30830000
276700         POINTER PV-STRING-POINTER-WHERE.                         30840000
276800                                                                  30850000
276900 4108-NEW-STR-IND.                                                30860000
277000                                                                  30870000
277100     IF PV-STRING-POINTER-WHERE > 1                               30880000
277200        STRING                                                    30890000
277300            ' AND '                           DELIMITED BY SIZE   30900000
277400        INTO                                                      30910000
277500            PV-WHERE-CLAUSE                                       30920000
277600        WITH                                                      30930000
277700            POINTER PV-STRING-POINTER-WHERE.                      30940000
277800                                                                  30950000
277900     STRING                                                       30960000
278000         'A.NEW_STR_PO_IND = '                DELIMITED BY SIZE,  30970000
278100         PC-QUOTE                             DELIMITED BY SIZE,  30980000
278200         ASC-KEY-NEW-STR-IND                  DELIMITED BY SIZE,  30990000
278300         PC-QUOTE                             DELIMITED BY SIZE   31000000
278400     INTO                                                         31010000
278500         PV-WHERE-CLAUSE                                          31020000
278600     WITH                                                         31030000
278700         POINTER PV-STRING-POINTER-WHERE.                         31040000
278800                                                                  31050000
W24803 4109-SUB-CL-NBR.                                                 31060000
W24803                                                                  31070068
W24803     IF PV-STRING-POINTER-WHERE > 1                               31080000
W24803        STRING                                                    31090000
W24803            ' AND '                           DELIMITED BY SIZE   31100000
W24803        INTO                                                      31110000
W24803            PV-WHERE-CLAUSE                                       31120000
W24803        WITH                                                      31130000
W24803            POINTER PV-STRING-POINTER-WHERE                       31140000
W24803     END-IF.                                                      31150000
W24803*                                                                 31160000
W24803     IF ASC-KEY-MAJ-CL-NBR > ZEROS                                31170000
W24803        STRING                                                    31180000
W24803            'V.MAJ_CL_NBR = '                 DELIMITED BY SIZE,  31190000
W24803            ASC-KEY-MAJ-CL-NBR                DELIMITED BY SIZE,  31200000
W24803            ' AND '                           DELIMITED BY SIZE,  31210000
W24803            'V.SUB_CL_NBR = '                 DELIMITED BY SIZE,  31220000
W24803            ASC-KEY-SUB-CL-NBR                DELIMITED BY SIZE   31230000
W24803        INTO                                                      31240000
W24803            PV-WHERE-CLAUSE                                       31250000
W24803        WITH                                                      31260000
W24803            POINTER PV-STRING-POINTER-WHERE                       31270000
W24803     ELSE                                                         31280000
W24803        STRING                                                    31290000
W24803            'V.SUB_CL_NBR = '                 DELIMITED BY SIZE,  31300000
W24803            ASC-KEY-SUB-CL-NBR                DELIMITED BY SIZE   31310000
W24803        INTO                                                      31320000
W24803            PV-WHERE-CLAUSE                                       31330000
W24803        WITH                                                      31340000
W24803            POINTER PV-STRING-POINTER-WHERE                       31350000
W24803     END-IF.                                                      31360000
280800                                                                  31370000
W24803 4110-MAJ-CL-NBR.                                                 31380000
W24803                                                                  31390068
W24803     IF PV-STRING-POINTER-WHERE > 1                               31400000
W24803        STRING                                                    31410000
W24803            ' AND '                           DELIMITED BY SIZE   31420000
W24803        INTO                                                      31430000
W24803            PV-WHERE-CLAUSE                                       31440000
W24803        WITH                                                      31450000
W24803            POINTER PV-STRING-POINTER-WHERE                       31460000
W24803     END-IF.                                                      31470000
W24803*                                                                 31480000
W24803     STRING                                                       31490000
W24803         'V.MAJ_CL_NBR = '                    DELIMITED BY SIZE,  31500000
W24803         ASC-KEY-MAJ-CL-NBR                   DELIMITED BY SIZE   31510000
W24803     INTO                                                         31520000
W24803         PV-WHERE-CLAUSE                                          31530000
W24803     WITH                                                         31540000
W24803         POINTER PV-STRING-POINTER-WHERE.                         31550000
283300                                                                  31560000
W24803 4111-SKU-NBR.                                                    31570000
W24803*                                                                 31580068
W24803     IF PV-STRING-POINTER-WHERE > 1                               31590000
W24803        STRING                                                    31600000
W24803            ' AND '                           DELIMITED BY SIZE   31610000
W24803        INTO                                                      31620000
W24803            PV-WHERE-CLAUSE                                       31630000
W24803        WITH                                                      31640000
W24803            POINTER PV-STRING-POINTER-WHERE.                      31650000
W24803     STRING                                                       31660000
W24803         'S.SKU_NBR = '                       DELIMITED BY SIZE,  31670000
W24803         ASC-KEY-SKU-NBR                      DELIMITED BY SIZE,  31680000
W24803     INTO                                                         31690000
W24803         PV-WHERE-CLAUSE                                          31700000
W24803     WITH                                                         31710000
W24803         POINTER PV-STRING-POINTER-WHERE.                         31720000
285300                                                                  31730000
285200 4112-AD-EVNT-DTE.                                                31740000
285500                                                                  31750000
285600     IF PV-STRING-POINTER-WHERE > 1                               31760000
285700        STRING                                                    31770000
285800            ' AND '                           DELIMITED BY SIZE   31780000
285900        INTO                                                      31790000
286000            PV-WHERE-CLAUSE                                       31800000
286100        WITH                                                      31810000
286200            POINTER PV-STRING-POINTER-WHERE.                      31820000
286300                                                                  31830000
286400     STRING                                                       31840000
286500         'B.AD_EVNT_DTE = '                   DELIMITED BY SIZE,  31850000
286600         PC-QUOTE                             DELIMITED BY SIZE,  31860000
286700         ASC-KEY-AD-EVNT-DTE                  DELIMITED BY SIZE,  31870000
286800         PC-QUOTE                             DELIMITED BY SIZE   31880000
286900     INTO                                                         31890000
287000         PV-WHERE-CLAUSE                                          31900000
287100     WITH                                                         31910000
287200         POINTER PV-STRING-POINTER-WHERE.                         31920000
287300                                                                  31930000
287400 4113-OTB-PER-ONE.                                                31940000
287500                                                                  31950000
287600     IF PV-STRING-POINTER-WHERE > 1                               31960000
287700        STRING                                                    31970000
287800            ' AND '                           DELIMITED BY SIZE   31980000
287900        INTO                                                      31990000
288000            PV-WHERE-CLAUSE                                       32000000
288100        WITH                                                      32010000
288200            POINTER PV-STRING-POINTER-WHERE.                      32020000
288300                                                                  32030000
288400     STRING                                                       32040000
288500         'A.OTB_PER_NBR = '                   DELIMITED BY SIZE,  32050000
288600         PC-QUOTE                             DELIMITED BY SIZE,  32060000
288700         ASC-KEY-OTB-PER-NBR-BEG              DELIMITED BY SIZE,  32070000
288800         PC-QUOTE                             DELIMITED BY SIZE   32080000
288900     INTO                                                         32090000
289000         PV-WHERE-CLAUSE                                          32100000
289100     WITH                                                         32110000
289200         POINTER PV-STRING-POINTER-WHERE.                         32120000
289300                                                                  32130000
289400 4114-OTB-PER-NBR-BEG-END.                                        32140000
289500                                                                  32150000
289600     IF PV-STRING-POINTER-WHERE > 1                               32160000
289700        STRING                                                    32170000
289800            ' AND '                           DELIMITED BY SIZE   32180000
289900        INTO                                                      32190000
290000            PV-WHERE-CLAUSE                                       32200000
290100        WITH                                                      32210000
290200            POINTER PV-STRING-POINTER-WHERE.                      32220000
290300                                                                  32230000
290400     STRING                                                       32240000
290500         '(A.OTB_PER_NBR BETWEEN '            DELIMITED BY SIZE,  32250000
290600         PC-QUOTE                             DELIMITED BY SIZE,  32260000
290700         ASC-KEY-OTB-PER-NBR-BEG              DELIMITED BY SIZE,  32270000
290800         PC-QUOTE                             DELIMITED BY SIZE,  32280000
290900         ' AND '                              DELIMITED BY SIZE,  32290000
291000         PC-QUOTE                             DELIMITED BY SIZE,  32300000
291100         ASC-KEY-OTB-PER-NBR-END              DELIMITED BY SIZE,  32310000
291200         PC-QUOTE                             DELIMITED BY SIZE,  32320000
291300         ')'                                  DELIMITED BY SIZE   32330000
291400     INTO                                                         32340000
291500         PV-WHERE-CLAUSE                                          32350000
291600     WITH                                                         32360000
291700         POINTER PV-STRING-POINTER-WHERE.                         32370000
291800                                                                  32380000
291900 4115-OTB-PER-BEG.                                                32390000
292000                                                                  32400000
292100     IF PV-STRING-POINTER-WHERE > 1                               32410000
292200        STRING                                                    32420000
292300            ' AND '                           DELIMITED BY SIZE   32430000
292400        INTO                                                      32440000
292500            PV-WHERE-CLAUSE                                       32450000
292600        WITH                                                      32460000
292700            POINTER PV-STRING-POINTER-WHERE.                      32470000
292800                                                                  32480000
292900     STRING                                                       32490000
293000         '(A.OTB_PER_NBR BETWEEN '            DELIMITED BY SIZE,  32500000
293100         PC-QUOTE                             DELIMITED BY SIZE,  32510000
293200         ASC-KEY-OTB-PER-NBR-BEG              DELIMITED BY SIZE,  32520000
293300         PC-QUOTE                             DELIMITED BY SIZE,  32530000
293400         ' AND '                              DELIMITED BY SIZE,  32540000
293500         PC-QUOTE                             DELIMITED BY SIZE,  32550000
293600         ASC-KEY-OTB-PER-NBR-END              DELIMITED BY SIZE,  32560000
293700         PC-QUOTE                             DELIMITED BY SIZE,  32570000
293800         ')'                                  DELIMITED BY SIZE   32580000
293900     INTO                                                         32590000
294000         PV-WHERE-CLAUSE                                          32600000
294100     WITH                                                         32610000
294200         POINTER PV-STRING-POINTER-WHERE.                         32620000
294300                                                                  32630000
294400 4116-OTB-PER-END.                                                32640000
294500                                                                  32650000
294600     IF PV-STRING-POINTER-WHERE > 1                               32660000
294700        STRING                                                    32670000
294800            ' AND '                           DELIMITED BY SIZE   32680000
294900        INTO                                                      32690000
295000            PV-WHERE-CLAUSE                                       32700000
295100        WITH                                                      32710000
295200            POINTER PV-STRING-POINTER-WHERE.                      32720000
295300                                                                  32730000
295400     STRING                                                       32740000
295500         '(A.OTB_PER_NBR BETWEEN '            DELIMITED BY SIZE,  32750000
295600         PC-QUOTE                             DELIMITED BY SIZE,  32760000
295700         ASC-KEY-OTB-PER-NBR-BEG              DELIMITED BY SIZE,  32770000
295800         PC-QUOTE                             DELIMITED BY SIZE,  32780000
295900         ' AND '                              DELIMITED BY SIZE,  32790000
296000         PC-QUOTE                             DELIMITED BY SIZE,  32800000
296100         ASC-KEY-OTB-PER-NBR-END              DELIMITED BY SIZE,  32810000
296200         PC-QUOTE                             DELIMITED BY SIZE,  32820000
296300         ')'                                  DELIMITED BY SIZE   32830000
296400     INTO                                                         32840000
296500         PV-WHERE-CLAUSE                                          32850000
296600     WITH                                                         32860000
296700         POINTER PV-STRING-POINTER-WHERE.                         32870000
296800                                                                  32880000
296900 4117-DONT-SHIP-BEF-DTE-ONE.                                      32890000
297000                                                                  32900000
297100     IF PV-STRING-POINTER-WHERE > 1                               32910000
297200        STRING                                                    32920000
297300            ' AND '                           DELIMITED BY SIZE   32930000
297400        INTO                                                      32940000
297500            PV-WHERE-CLAUSE                                       32950000
297600        WITH                                                      32960000
297700            POINTER PV-STRING-POINTER-WHERE.                      32970000
297800                                                                  32980000
297900     STRING                                                       32990000
298000         'C.DONT_SHIP_BEF_DTE = '             DELIMITED BY SIZE,  33000000
298100         PC-QUOTE                             DELIMITED BY SIZE,  33010000
298200         ASC-KEY-DONT-SHIP-BEF-DTE-B          DELIMITED BY SIZE,  33020000
298300         PC-QUOTE                             DELIMITED BY SIZE   33030000
298400     INTO                                                         33040000
298500         PV-WHERE-CLAUSE                                          33050000
298600     WITH                                                         33060000
298700         POINTER PV-STRING-POINTER-WHERE.                         33070000
298800                                                                  33080000
298900 4118-DONT-SHIP-BEF-DTE-B-E.                                      33090000
299000                                                                  33100000
299100     IF PV-STRING-POINTER-WHERE > 1                               33110000
299200        STRING                                                    33120000
299300            ' AND '                           DELIMITED BY SIZE   33130000
299400        INTO                                                      33140000
299500            PV-WHERE-CLAUSE                                       33150000
299600        WITH                                                      33160000
299700            POINTER PV-STRING-POINTER-WHERE.                      33170000
299800                                                                  33180000
299900     STRING                                                       33190000
300000         '(C.DONT_SHIP_BEF_DTE BETWEEN '      DELIMITED BY SIZE,  33200000
300100         PC-QUOTE                             DELIMITED BY SIZE,  33210000
300200         ASC-KEY-DONT-SHIP-BEF-DTE-B          DELIMITED BY SIZE,  33220000
300300         PC-QUOTE                             DELIMITED BY SIZE,  33230000
300400         ' AND '                              DELIMITED BY SIZE,  33240000
300500         PC-QUOTE                             DELIMITED BY SIZE,  33250000
300600         ASC-KEY-DONT-SHIP-BEF-DTE-E          DELIMITED BY SIZE,  33260000
300700         PC-QUOTE                             DELIMITED BY SIZE,  33270000
300800         ')'                                  DELIMITED BY SIZE   33280000
300900     INTO                                                         33290000
301000         PV-WHERE-CLAUSE                                          33300000
301100     WITH                                                         33310000
301200         POINTER PV-STRING-POINTER-WHERE.                         33320000
301300                                                                  33330000
301400 4119-DONT-SHIP-BEF-DTE-B.                                        33340000
301500                                                                  33350000
301600     IF PV-STRING-POINTER-WHERE > 1                               33360000
301700        STRING                                                    33370000
301800            ' AND '                           DELIMITED BY SIZE   33380000
301900        INTO                                                      33390000
302000            PV-WHERE-CLAUSE                                       33400000
302100        WITH                                                      33410000
302200            POINTER PV-STRING-POINTER-WHERE.                      33420000
302300                                                                  33430000
302400     STRING                                                       33440000
302500         '(C.DONT_SHIP_BEF_DTE BETWEEN '      DELIMITED BY SIZE,  33450000
302600         PC-QUOTE                             DELIMITED BY SIZE,  33460000
302700         ASC-KEY-DONT-SHIP-BEF-DTE-B          DELIMITED BY SIZE,  33470000
302800         PC-QUOTE                             DELIMITED BY SIZE,  33480000
302900         ' AND '                              DELIMITED BY SIZE,  33490000
303000         PC-QUOTE                             DELIMITED BY SIZE,  33500000
303100         ASC-KEY-DONT-SHIP-BEF-DTE-E          DELIMITED BY SIZE,  33510000
303200         PC-QUOTE                             DELIMITED BY SIZE,  33520000
303300         ')'                                  DELIMITED BY SIZE   33530000
303400     INTO                                                         33540000
303500         PV-WHERE-CLAUSE                                          33550000
303600     WITH                                                         33560000
303700         POINTER PV-STRING-POINTER-WHERE.                         33570000
303800                                                                  33580000
303900 4120-DONT-SHIP-BEF-DTE-E.                                        33590000
304000                                                                  33600000
304100     IF PV-STRING-POINTER-WHERE > 1                               33610000
304200        STRING                                                    33620000
304300            ' AND '                           DELIMITED BY SIZE   33630000
304400        INTO                                                      33640000
304500            PV-WHERE-CLAUSE                                       33650000
304600        WITH                                                      33660000
304700            POINTER PV-STRING-POINTER-WHERE.                      33670000
304800                                                                  33680000
304900     STRING                                                       33690000
305000         '(C.DONT_SHIP_BEF_DTE BETWEEN '      DELIMITED BY SIZE,  33700000
305100         PC-QUOTE                             DELIMITED BY SIZE,  33710000
305200         ASC-KEY-DONT-SHIP-BEF-DTE-B          DELIMITED BY SIZE,  33720000
305300         PC-QUOTE                             DELIMITED BY SIZE,  33730000
305400         ' AND '                              DELIMITED BY SIZE,  33740000
305500         PC-QUOTE                             DELIMITED BY SIZE,  33750000
305600         ASC-KEY-DONT-SHIP-BEF-DTE-E          DELIMITED BY SIZE,  33760000
305700         PC-QUOTE                             DELIMITED BY SIZE,  33770000
305800         ')'                                  DELIMITED BY SIZE   33780000
305900     INTO                                                         33790000
306000         PV-WHERE-CLAUSE                                          33800000
306100     WITH                                                         33810000
306200         POINTER PV-STRING-POINTER-WHERE.                         33820000
306300                                                                  33830000
306400 4121-ENT-NAME-DESC.                                              33840000
306500                                                                  33850000
306600*TALLYING CODE                                                    33860000
306700     IF PV-STRING-POINTER-WHERE > 1                               33870000
306800        STRING                                                    33880000
306900            ' AND '                           DELIMITED BY SIZE   33890000
307000        INTO                                                      33900000
307100            PV-WHERE-CLAUSE                                       33910000
307200        WITH                                                      33920000
307300            POINTER PV-STRING-POINTER-WHERE.                      33930000
307400                                                                  33940000
307500     MOVE ZERO TO PV-TALLY-1                                      33950000
307600                  PV-TALLY-2.                                     33960000
307700                                                                  33970000
307800     MOVE ASC-KEY-ENT-NAME-DESC TO PV-ENT-NAME-DESC.              33980000
307900     INSPECT PV-ENT-NAME-DESC                                     33990000
308000        TALLYING PV-TALLY-1 FOR ALL '*'                           34000000
308100                 PV-TALLY-2 FOR ALL '?'                           34010000
308200        REPLACING ALL '*' BY '%'                                  34020000
308300                  ALL '?' BY '_'                                  34030000
308400                  ALL '''' BY '_'.                                34040000
308500                                                                  34050000
308600     IF PV-TALLY-1 + PV-TALLY-2 = ZERO                            34060000
308700        STRING                                                    34070000
308800            'D.ENT_NAME_DESC LIKE '            DELIMITED BY SIZE, 34080000
308900            PC-QUOTE                           DELIMITED BY SIZE, 34090000
309000            PV-ENT-NAME-DESC                   DELIMITED BY '  ', 34100000
309100            PC-PERCENT                         DELIMITED BY SIZE, 34110000
309200            PC-QUOTE                           DELIMITED BY SIZE  34120000
309300        INTO                                                      34130000
309400            PV-WHERE-CLAUSE                                       34140000
309500        WITH                                                      34150000
309600            POINTER PV-STRING-POINTER-WHERE                       34160000
309700     ELSE                                                         34170000
309800        STRING                                                    34180000
309900            'D.ENT_NAME_DESC LIKE '            DELIMITED BY SIZE, 34190000
310000            PC-QUOTE                           DELIMITED BY SIZE, 34200000
310100            PV-ENT-NAME-DESC                   DELIMITED BY '  ', 34210000
310200            PC-QUOTE                           DELIMITED BY SIZE  34220000
310300        INTO                                                      34230000
310400            PV-WHERE-CLAUSE                                       34240000
310500        WITH                                                      34250000
310600            POINTER PV-STRING-POINTER-WHERE                       34260000
310700     END-IF.                                                      34270000
310800                                                                  34280000
310900 4122-VEND-STYL-NME.                                              34290000
311000                                                                  34300000
311100     IF PV-STRING-POINTER-WHERE > 1                               34310000
311200        STRING                                                    34320000
311300            ' AND '                           DELIMITED BY SIZE   34330000
311400        INTO                                                      34340000
311500            PV-WHERE-CLAUSE                                       34350000
311600        WITH                                                      34360000
311700            POINTER PV-STRING-POINTER-WHERE.                      34370000
311800                                                                  34380000
311900     MOVE ZERO TO PV-TALLY-1                                      34390000
312000                  PV-TALLY-2.                                     34400000
312100                                                                  34410000
312200     MOVE ASC-KEY-VEND-STYL-NME TO PV-VEND-STYL-NME.              34420000
312300     INSPECT PV-VEND-STYL-NME                                     34430000
312400        TALLYING PV-TALLY-1 FOR ALL '*'                           34440000
312500                 PV-TALLY-2 FOR ALL '?'                           34450000
312600        REPLACING ALL '*' BY '%'                                  34460000
312700                  ALL '?' BY '_'                                  34470000
312800                  ALL '''' BY '_'.                                34480000
312900                                                                  34490000
313000     IF PV-TALLY-1 + PV-TALLY-2 = ZERO                            34500000
313100        STRING                                                    34510000
W24803            'V.VS_NBR LIKE '                   DELIMITED BY SIZE, 34520000
313300            PC-QUOTE                           DELIMITED BY SIZE, 34530000
313400            PV-VEND-STYL-NME                   DELIMITED BY '  ', 34540000
313500            PC-PERCENT                         DELIMITED BY SIZE, 34550000
313600            PC-QUOTE                           DELIMITED BY SIZE  34560000
313700        INTO                                                      34570000
313800            PV-WHERE-CLAUSE                                       34580000
313900        WITH                                                      34590000
314000            POINTER PV-STRING-POINTER-WHERE                       34600000
314100     ELSE                                                         34610000
314200        STRING                                                    34620000
W24803            'V.VS_NBR LIKE '                   DELIMITED BY SIZE, 34630000
314400            PC-QUOTE                           DELIMITED BY SIZE, 34640000
314500            PV-VEND-STYL-NME                   DELIMITED BY '  ', 34650000
314600            PC-QUOTE                           DELIMITED BY SIZE  34660000
314700        INTO                                                      34670000
314800            PV-WHERE-CLAUSE                                       34680000
314900        WITH                                                      34690000
315000            POINTER PV-STRING-POINTER-WHERE                       34700000
315100     END-IF.                                                      34710000
315200                                                                  34720000
315300/                                                                 34730000
315400*----------------------------------------------------------------*34740000
315500*    STRING TOGETHER THE CODE TO BUILD SYNAMIC SQL CURSOR        *34750000
315600*----------------------------------------------------------------*34760000
315700                                                                  34770000
315800 4150-COMBINE-SQL.                                                34780000
315900                                                                  34790000
316000     MOVE SPACES TO PV-SQL-STMT-TEXT.                             34800000
316100                                                                  34810000
316200     STRING PV-BUILD-SELECT-STMT              DELIMITED BY SIZE,  34820000
316300            ' FROM '                          DELIMITED BY SIZE,  34830000
316400            PV-FROM-CLAUSE                    DELIMITED BY '  ',  34840000
316500            ' WHERE '                         DELIMITED BY SIZE,  34850000
316600            PV-WHERE-CLAUSE                   DELIMITED BY '  '   34860000
316700     INTO                                                         34870000
316800         PV-SQL-STMT-TEXT.                                        34880000
316900                                                                  34890000
317000     ADD PV-SELECT-BYTES                                          34900000
317100         PC-CNT-6                                                 34910000
317200         PV-STRING-POINTER-FROM                                   34920000
317300         PC-CNT-7                                                 34930000
317400         PV-STRING-POINTER-WHERE                                  34940000
317500         PC-CNT-MINUS-2                                           34950000
317600     GIVING                                                       34960000
317700         PV-SQL-STMT-LEN.                                         34970000
317800/                                                                 34980000
317900*----------------------------------------------------------------*34990000
318000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *35000000
318100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *35010000
318200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *35020000
318300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *35030000
318400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *35040000
318500*                                                                *35050000
318600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *35060000
318700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *35070000
318800*    UPON INITIALIZATION.                                        *35080000
318900*----------------------------------------------------------------*35090000
319000                                                                  35100000
319100 4300-READ-ITEMS-FROM-DB.                                         35110000
319200                                                                  35120000
319300     PERFORM                                                      35130000
319400         VARYING PV-READ-COUNT                                    35140000
319500         FROM 1 BY 1                                              35150000
319600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    35160000
319700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         35170000
319800                                                                  35180000
319900         PERFORM 4310-FETCH                                       35190000
320000                                                                  35200000
320100         MOVE 'N'                  TO PS-SKIP-SW                  35210000
320200                                                                  35220000
320300         IF  ASC-KEY-STR-NBR > ZERO                               35230000
320400             INITIALIZE PV-DB2-COUNT                              35240000
320500             MOVE PURCHS-PO-NBR    TO DK-PO-NBR                   35250000
320600             MOVE ASC-KEY-STR-NBR  TO DK-STR-NBR                  35260000
320700             PERFORM 4350-CHECK-STORE-ALLOC                       35270000
320800             IF  PV-DB2-COUNT = +0                                35280000
320900                 SET PS-SKIP       TO TRUE                        35290000
321000             END-IF                                               35300000
321100         END-IF                                                   35310000
321200                                                                  35320000
321300         IF  ASC-KEY-PRE-TICKET-IND > SPACES                      35330000
321400             INITIALIZE PV-DB2-COUNT                              35340000
321500             MOVE PURCHS-PO-NBR    TO DK-PO-NBR                   35350000
321600             MOVE '4'              TO DK-AGRMT-TYP-ID             35360000
321700             MOVE 1                TO DK-TYP-CDE                  35370000
321800             PERFORM 4360-CHECK-SERVICE                           35380000
321900             IF  ASC-KEY-PRE-TICKET-IND = 'Y'                     35390000
322000                 IF  PV-DB2-COUNT = +0                            35400000
322100                     SET PS-SKIP   TO TRUE                        35410000
322200                 END-IF                                           35420000
322300             ELSE                                                 35430000
322400                 IF  PV-DB2-COUNT > +0                            35440000
322500                     SET PS-SKIP   TO TRUE                        35450000
322600                 END-IF                                           35460000
322700             END-IF                                               35470000
322800         END-IF                                                   35480000
322900                                                                  35490000
323000         IF  ASC-KEY-PACK-BY-STORE-IND > SPACES                   35500000
323100             INITIALIZE PV-DB2-COUNT                              35510000
323200             MOVE PURCHS-PO-NBR    TO DK-PO-NBR                   35520000
323500             PERFORM 4365-CHECK-SERVICE                           35530000
323600             IF  ASC-KEY-PACK-BY-STORE-IND = 'Y'                  35540000
323700                 IF  PV-DB2-COUNT = +0                            35550000
323800                     SET PS-SKIP   TO TRUE                        35560000
323900                 END-IF                                           35570000
324000             ELSE                                                 35580000
324100                 IF  PV-DB2-COUNT > +0                            35590000
324200                     SET PS-SKIP   TO TRUE                        35600000
324300                 END-IF                                           35610000
324400             END-IF                                               35620000
324500         END-IF                                                   35630000
324600         IF  ASC-ITEMS-LEFT-ON-DB                                 35640000
324700         AND PS-DONT-SKIP                                         35650000
324800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                35660000
324900                 ADD +1            TO ASC-ITEM-SUB                35670000
325000             ELSE                                                 35680000
325100                 ADD +1            TO ASC-BLK-SUB                 35690000
325200                 MOVE +1           TO ASC-ITEM-SUB                35700000
325300                                                                  35710000
325400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         35720000
325500                     MOVE +1       TO ASC-BLK-SUB                 35730000
325600                     SET ASC-BLOCK-MODIFIED (1)                   35740000
325700                                   TO TRUE                        35750000
325800                     PERFORM 5100-WRITE-TEMP-STORAGE              35760000
325900                     MOVE ASC-BLOCK-ENTRIES                       35770000
326000                               (PC-MAX-BLOCKS-IN-ARRAY)           35780000
326100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 35790000
326200                     ADD +1        TO ASC-BLK-SUB                 35800000
326300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   35810000
326400                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      35820000
326500                                   TO TRUE                        35830000
326600                 END-IF                                           35840000
326700             END-IF                                               35850000
326800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    35860000
326900             MOVE ASC-NUMBER-OF-ITEMS-READ                        35870000
327000                                   TO ASC-LIST-ITEM-NUMBER        35880000
327100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35890000
327200             MOVE PURCHS-PO-NBR    TO ASC-PO-NBR                  35900000
327300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35910000
327400             PERFORM 4320-GET-PO-INFO                             35920000
327500             IF ENTNME-ENT-ID NOT = PURCHS-ENT-ID                 35930000
327600                PERFORM 4330-GET-VENDOR-SHORT-NAME                35940000
327700                IF  SQLCODE = +100                                35950000
327800                    PERFORM 4335-GET-VENDOR-PRIMARY-NAME          35960000
327900                END-IF                                            35970000
328000             END-IF                                               35980000
328100             PERFORM 4340-GET-SHIPMENT-INFO                       35990000
328200             PERFORM 4370-GET-DOLLARS-RECEIVED                    36000000
328300             PERFORM 4390-GET-UNITS-RECEIVED                      36010000
328400             PERFORM 4395-GET-MIN-AD-DATE                         36020000
328500                                                                  36030000
328600             MOVE +0               TO PV-DB2-COUNT2               36040000
328700             PERFORM 4380-CHECK-IN-PROCESS                        36050000
328800                                                                  36060000
328900             IF PV-DB2-COUNT2 > 0                                 36070000
329000               MOVE 'Y'            TO ASC-IP-IND                  36080000
329100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36090000
329200             ELSE                                                 36100000
329300               MOVE 'N'            TO ASC-IP-IND                  36110000
329400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36120000
329500             END-IF                                               36130000
329600                                                                  36140000
329700             MOVE PV-DOLLARS-RECEIVED                             36150000
329800                                   TO ASC-DOLLARS-RECEIVED        36160000
329900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36170000
330000             MOVE PURCHS-DEPT-NBR  TO ASC-DEPT-NBR                36180000
330100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36190000
330200             MOVE ENTNME-ENT-NAME-DESC                            36200000
330300                                   TO ASC-VENDOR-NAME             36210000
330400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36220000
330500             MOVE PURCHS-STATUS-CDE                               36230000
330600                                   TO ASC-STATUS                  36240000
330700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36250000
330810             STRING PURCHS-OTB-PER-NBR(5:2) DELIMITED BY SIZE     36260000
330910                    PURCHS-OTB-PER-NBR(3:2) DELIMITED BY SIZE     36270000
331000                                 INTO ASC-OTB                     36280000
331100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36290000
331200             MOVE PV-DONT-SHIP-BEF-DTE                            36300000
331300                                   TO ASC-SHIP-DATE               36310000
331400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36320000
331500             MOVE PV-CAN-IFNOT-SHIP-DTE                           36330000
331600                                   TO ASC-CANCEL-DATE             36340000
331700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36350000
331800             MOVE PURCHS-EDI-IND   TO ASC-EDI-IND                 36360000
331900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36370000
332000             MOVE PURCHS-TOT-VAL-RTL-AMT                          36380000
332100                                   TO ASC-DOLLARS-ORDERED         36390000
332200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36400000
332300             MOVE PV-DOLLARS-RECEIVED                             36410000
332400                                   TO ASC-DOLLARS-RECEIVED        36420000
332500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36430000
332700             IF PURCHS-TOT-VAL-RTL-AMT = 0                        36440000
332800                MOVE 0             TO ASC-DOLLARS-RCVD-PCT        36450000
332900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36460000
333000             ELSE                                                 36470000
333100                COMPUTE PV-PCT-AREA                               36480000
333200                  =    (PV-DOLLARS-RECEIVED                       36490000
333300                  /     PURCHS-TOT-VAL-RTL-AMT)                   36500000
333400                  *     100                                       36510000
333500                MOVE PV-PCT-AREA   TO ASC-DOLLARS-RCVD-PCT        36520000
333600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36530000
333700             END-IF                                               36540000
333800             MOVE PURCHS-TOT-UNT-QTY                              36550000
333900                                   TO ASC-TOT-UNIT-ORDERED        36560000
334000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36570000
334100             MOVE PV-UNITS-RECEIVED                               36580000
334200                                   TO ASC-TOT-UNIT-RCVD           36590000
334300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36600000
334500             IF PURCHS-TOT-UNT-QTY = 0                            36610000
334600                MOVE 0             TO ASC-TOT-UNIT-RCVD-PCT       36620000
334700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36630000
334800             ELSE                                                 36640000
334900                COMPUTE PV-PCT-AREA                               36650000
335000                  =    (PV-UNITS-RECEIVED / PURCHS-TOT-UNT-QTY)   36660000
335100                  *     100                                       36670000
335200                MOVE PV-PCT-AREA   TO ASC-TOT-UNIT-RCVD-PCT       36680000
335300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36690000
335400             END-IF                                               36700000
335500                                                                  36710000
335610             COMPUTE ASC-DOLLAR-ORD-TOT = ASC-DOLLAR-ORD-TOT +    36720000
335700                   ASC-DOLLARS-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB) 36730000
335800                                                                  36740000
335910             COMPUTE ASC-DOLLAR-REC-TOT = ASC-DOLLAR-REC-TOT +    36750000
336000                   ASC-DOLLARS-RECEIVED (ASC-BLK-SUB ASC-ITEM-SUB)36760000
336100                                                                  36770000
336210             COMPUTE ASC-UNIT-ORD-TOT = ASC-UNIT-ORD-TOT +        36780000
336300                   ASC-TOT-UNIT-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB)36790000
336400                                                                  36800000
336510             COMPUTE ASC-UNIT-REC-TOT   = ASC-UNIT-REC-TOT +      36810000
336600                   ASC-TOT-UNIT-RCVD    (ASC-BLK-SUB ASC-ITEM-SUB)36820000
336700                                                                  36830000
336800             MOVE PV-AD-EVNT-DTE   TO ASC-AD-EVNT-DTE             36840000
336900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36850000
337000                                                                  36860000
337100         END-IF                                                   36870000
337200     END-PERFORM.                                                 36880000
337300                                                                  36890000
337400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          36900000
337500         MOVE +1                   TO ASC-BLK-SUB                 36910000
337600         PERFORM 5100-WRITE-TEMP-STORAGE                          36920000
337700         ADD +1                    TO ASC-BLK-SUB                 36930000
337800         PERFORM 5100-WRITE-TEMP-STORAGE                          36940000
337900                                                                  36950000
338000         MOVE 1                    TO ASC-BLK-SUB                 36960000
338100                                      PV-BLOCK-NUMBER             36970000
338200         PERFORM 4410-READ-TEMP-STORAGE                           36980000
338300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             36990000
338400             MOVE 2                TO ASC-BLK-SUB                 37000000
338500                                      PV-BLOCK-NUMBER             37010000
338600             PERFORM 4410-READ-TEMP-STORAGE                       37020000
338700         END-IF                                                   37030000
338800     END-IF.                                                      37040000
338900                                                                  37050000
339000/                                                                 37060000
339100*----------------------------------------------------------------*37070000
339200*    FETCH A VENDOR ROW                                          *37080000
339300*----------------------------------------------------------------*37090000
339400                                                                  37100000
339500 4310-FETCH.                                                      37110000
339600                                                                  37120000
339700     EXEC SQL                                                     37130000
339800         FETCH PO-CSR                                             37140000
339900          INTO :PURCHS-PO-NBR,                                    37150000
340000               :PURCHS-OTB-PER-NBR,                               37160000
340100               :PURCHS-DEPT-NBR,                                  37170000
340200               :PURCHS-ENT-ID,                                    37180000
340300               :PLNSHP-DONT-SHIP-BEF-DTE                          37190067
340400     END-EXEC.                                                    37200000
340500                                                                  37210000
340600     EVALUATE TRUE                                                37220000
340700         WHEN SQLCODE = +0                                        37230000
340800              CONTINUE                                            37240000
340900         WHEN SQLCODE = +100                                      37250000
341000              SET ASC-NO-ITEMS-LEFT-ON-DB                         37260000
341100                                   TO TRUE                        37270000
341200         WHEN SQLWARN0 NOT = SPACE                                37280000
341300         WHEN SQLCODE < +0                                        37290000
341400         WHEN SQLCODE > +0                                        37300000
341500              MOVE '4310-FETCH-CURSOR'                            37310000
341600                                   TO DP013-PARAGRAPH             37320000
341700              MOVE 'FETCH PO CURSOR'                              37330000
341800                                   TO DP013-MESSAGE-TEXT (1)      37340000
341900              MOVE SQLCA           TO DP013-SQLCA                 37350000
342000              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    37360000
342100              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    37370000
342200              MOVE 'TPLNSHP'       TO DP013-DB2-TABLE-NAME (3)    37380000
342300              MOVE 'TENTNME'       TO DP013-DB2-TABLE-NAME (4)    37390000
W24803              MOVE 'XLT_SKU'       TO DP013-DB2-TABLE-NAME (5)    37400000
342400              SET DP013-DB2-ABEND  TO TRUE                        37410000
342500              PERFORM DP013-0000-PROCESS-ABEND                    37420000
342600     END-EVALUATE.                                                37430000
342700                                                                  37440000
342800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37450000
342900         MOVE '4310-FETCH-CURSOR'  TO DP013-PARAGRAPH             37460000
343000         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             37470000
343100                                   TO DP013-MESSAGE-TEXT (1)      37480000
343200         MOVE SQLCA                TO DP013-SQLCA                 37490000
343300         SET DP013-DB2-ABEND                                      37500000
343400             DP013-XCTL-DISPLAY-RESTART                           37510000
343500                                   TO TRUE                        37520000
343600         PERFORM DP013-0000-PROCESS-ABEND                         37530000
343700     END-IF.                                                      37540000
343800                                                                  37550000
343900/                                                                 37560000
344000*----------------------------------------------------------------*37570000
344100* GET PO INFORMATION                                             *37580000
344200*----------------------------------------------------------------*37590000
344300                                                                  37600000
344400 4320-GET-PO-INFO.                                                37610000
344500                                                                  37620000
344600     EXEC SQL                                                     37630000
344700         SELECT DEPT_NBR                                          37640000
344800               ,OTB_PER_NBR                                       37650000
344900               ,STATUS_CDE                                        37660000
345000               ,TOT_VAL_RTL_AMT                                   37670000
345100               ,TOT_UNT_QTY                                       37680000
345200               ,ENT_ID                                            37690000
345300               ,EDI_IND                                           37700000
345400          INTO  :PURCHS-DEPT-NBR                                  37710000
345500               ,:PURCHS-OTB-PER-NBR                               37720000
345600               ,:PURCHS-STATUS-CDE                                37730000
345700               ,:PURCHS-TOT-VAL-RTL-AMT                           37740000
345800               ,:PURCHS-TOT-UNT-QTY                               37750000
345900               ,:PURCHS-ENT-ID                                    37760000
346000               ,:PURCHS-EDI-IND                                   37770000
346100          FROM  TPURCHS                                           37780000
346200          WHERE PO_NBR         = :PURCHS-PO-NBR                   37790000
346300            AND VER_STATUS_CDE = 'A'                              37800000
346400            AND PO_CATEG_CDE   = 'MR'                             37810000
346500     END-EXEC.                                                    37820000
346600                                                                  37830000
346700     EVALUATE TRUE                                                37840000
346800         WHEN SQLCODE = +0                                        37850000
346900         WHEN SQLCODE = -904                                      37860000
347000         WHEN SQLCODE = -913                                      37870000
347100             CONTINUE                                             37880000
347200         WHEN SQLWARN0 NOT = SPACE                                37890000
347300         WHEN SQLCODE < +0                                        37900000
347400         WHEN SQLCODE > +0                                        37910000
347500             MOVE '4320-GET-PO-INFO'                              37920000
347600                                 TO DP013-PARAGRAPH               37930000
347700             MOVE 'SELECT ON PURCHASE HEADER TABLE'               37940000
347800                                 TO DP013-MESSAGE-TEXT (1)        37950000
347900             MOVE SQLCA          TO DP013-SQLCA                   37960000
348000             MOVE 'TPURCHS'      TO DP013-DB2-TABLE-NAME (1)      37970000
348100                 SET DP013-DB2-ABEND                              37980000
348200                     DP013-XCTL-DISPLAY-RESTART                   37990000
348300                                 TO TRUE                          38000000
348400             PERFORM DP013-0000-PROCESS-ABEND                     38010000
348500     END-EVALUATE.                                                38020000
348600                                                                  38030000
348700/                                                                 38040000
348800*----------------------------------------------------------------*38050000
348900* GET THE VENDOR SHORT NAME                                      *38060000
349000*----------------------------------------------------------------*38070000
349100                                                                  38080000
349200 4330-GET-VENDOR-SHORT-NAME.                                      38090000
349300                                                                  38100000
349400     EXEC SQL                                                     38110000
349500         SELECT ENT_NAME_DESC                                     38120000
349600              , ENT_ID                                            38130000
349700          INTO  :ENTNME-ENT-NAME-DESC                             38140000
349800              , :ENTNME-ENT-ID                                    38150000
349900          FROM  TENTNME                                           38160000
350000          WHERE ENT_ID   = :PURCHS-ENT-ID                         38170000
350100            AND TYPE_CDE = '04'                                   38180000
350200     END-EXEC.                                                    38190000
350300                                                                  38200000
350400     EVALUATE TRUE                                                38210000
350500         WHEN SQLCODE = +0                                        38220000
350600         WHEN SQLCODE = +100                                      38230000
350700         WHEN SQLCODE = -904                                      38240000
350800         WHEN SQLCODE = -913                                      38250000
350900             CONTINUE                                             38260000
351000         WHEN SQLWARN0 NOT = SPACE                                38270000
351100         WHEN SQLCODE < +0                                        38280000
351200         WHEN SQLCODE > +0                                        38290000
351300             MOVE '4330-GET-VENDOR-SHORT-NAME'                    38300000
351400                                 TO DP013-PARAGRAPH               38310000
351500             MOVE 'SELECT ON ENTERPRISE NAME TABLE'               38320000
351600                                 TO DP013-MESSAGE-TEXT (1)        38330000
351700             MOVE SQLCA          TO DP013-SQLCA                   38340000
351800             MOVE 'TENTNME'      TO DP013-DB2-TABLE-NAME (1)      38350000
351900                 SET DP013-DB2-ABEND                              38360000
352000                     DP013-XCTL-DISPLAY-RESTART                   38370000
352100                                 TO TRUE                          38380000
352200             PERFORM DP013-0000-PROCESS-ABEND                     38390000
352300     END-EVALUATE.                                                38400000
352400                                                                  38410000
352500/                                                                 38420000
352600*----------------------------------------------------------------*38430000
352700* GET THE VENDOR PRIMARY NAME                                    *38440000
352800*----------------------------------------------------------------*38450000
352900                                                                  38460000
353000 4335-GET-VENDOR-PRIMARY-NAME.                                    38470000
353100                                                                  38480000
353200     EXEC SQL                                                     38490000
353300         SELECT ENT_NAME_DESC                                     38500000
353400              , ENT_ID                                            38510000
353500          INTO  :ENTNME-ENT-NAME-DESC                             38520000
353600              , :ENTNME-ENT-ID                                    38530000
353700          FROM  TENTNME                                           38540000
353800          WHERE ENT_ID   = :PURCHS-ENT-ID                         38550000
353900            AND TYPE_CDE = '01'                                   38560000
354000     END-EXEC.                                                    38570000
354100                                                                  38580000
354200     EVALUATE TRUE                                                38590000
354300         WHEN SQLCODE = +0                                        38600000
354400         WHEN SQLCODE = -904                                      38610000
354500         WHEN SQLCODE = -913                                      38620000
354600             CONTINUE                                             38630000
354700         WHEN SQLWARN0 NOT = SPACE                                38640000
354800         WHEN SQLCODE < +0                                        38650000
354900         WHEN SQLCODE > +0                                        38660000
355000             MOVE '4335-GET-VENDOR-PRIMARY-NAME'                  38670000
355100                                 TO DP013-PARAGRAPH               38680000
355200             MOVE 'SELECT ON ENTERPRISE NAME TABLE'               38690000
355300                                 TO DP013-MESSAGE-TEXT (1)        38700000
355400             MOVE SQLCA          TO DP013-SQLCA                   38710000
355500             MOVE 'TENTNME'      TO DP013-DB2-TABLE-NAME (1)      38720000
355600                 SET DP013-DB2-ABEND                              38730000
355700                     DP013-XCTL-DISPLAY-RESTART                   38740000
355800                                 TO TRUE                          38750000
355900             PERFORM DP013-0000-PROCESS-ABEND                     38760000
356000     END-EVALUATE.                                                38770000
356100                                                                  38780000
356200/                                                                 38790000
356300*----------------------------------------------------------------*38800000
356400* GET PLANNED SHIPMENT INFO                                      *38810000
356500*----------------------------------------------------------------*38820000
356600                                                                  38830000
356700 4340-GET-SHIPMENT-INFO.                                          38840000
356800                                                                  38850000
356900     EXEC SQL                                                     38860000
357000         SELECT DONT_SHIP_BEF_DTE                                 38870000
357100               ,CAN_IFNOT_SHIP_DTE                                38880000
357200          INTO  :PLNSHP-DONT-SHIP-BEF-DTE                         38890000
357300               ,:PLNSHP-CAN-IFNOT-SHIP-DTE                        38900000
357400          FROM  TPLNSHP                                           38910000
357500          WHERE PO_NBR          = :PURCHS-PO-NBR                  38920000
357600            AND VER_STATUS_CDE  = 'A'                             38930000
357700     END-EXEC.                                                    38940000
357800                                                                  38950000
357900     EVALUATE TRUE                                                38960000
358000         WHEN SQLCODE = +0                                        38970000
358100              IF  PLNSHP-DONT-SHIP-BEF-DTE > SPACES               38980000
358200              AND PLNSHP-DONT-SHIP-BEF-DTE NOT = '0001-01-01'     38990000
358300                  MOVE PLNSHP-DONT-SHIP-BEF-DTE                   39000000
358400                                       TO PV-DB2-DATE             39010000
358500                  MOVE PV-DB2-DATE-MM  TO PV-DISPLAY-DATE-MM      39020000
358600                  MOVE PV-DB2-DATE-DD  TO PV-DISPLAY-DATE-DD      39030000
358700                  MOVE PV-DB2-DATE-YY  TO PV-DISPLAY-DATE-YY      39040000
358800                  MOVE PV-DISPLAY-DATE TO PV-DONT-SHIP-BEF-DTE    39050000
358900              ELSE                                                39060000
359000                  MOVE SPACES          TO PV-DONT-SHIP-BEF-DTE    39070000
359100              END-IF                                              39080000
359200              IF  PLNSHP-CAN-IFNOT-SHIP-DTE > SPACES              39090000
359300              AND PLNSHP-CAN-IFNOT-SHIP-DTE NOT = '0001-01-01'    39100000
359400                  MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                  39110000
359500                                       TO PV-DB2-DATE             39120000
359600                  MOVE PV-DB2-DATE-MM  TO PV-DISPLAY-DATE-MM      39130000
359700                  MOVE PV-DB2-DATE-DD  TO PV-DISPLAY-DATE-DD      39140000
359800                  MOVE PV-DB2-DATE-YY  TO PV-DISPLAY-DATE-YY      39150000
359900                  MOVE PV-DISPLAY-DATE TO PV-CAN-IFNOT-SHIP-DTE   39160000
360000              ELSE                                                39170000
360100                  MOVE SPACES          TO PV-CAN-IFNOT-SHIP-DTE   39180000
360200              END-IF                                              39190000
360300                                                                  39200000
360400         WHEN SQLCODE = -904                                      39210000
360500         WHEN SQLCODE = -913                                      39220000
360600             CONTINUE                                             39230000
360700         WHEN SQLWARN0 NOT = SPACE                                39240000
360800         WHEN SQLCODE < +0                                        39250000
360900         WHEN SQLCODE > +0                                        39260000
361000             MOVE '4340-GET-SHIPMENT-INFO'                        39270000
361100                                 TO DP013-PARAGRAPH               39280000
361200             MOVE 'SELECT ON PLANNED SHIPMENTS'                   39290000
361300                                 TO DP013-MESSAGE-TEXT (1)        39300000
361400             MOVE SQLCA          TO DP013-SQLCA                   39310000
361500             MOVE 'TPLNSHP'      TO DP013-DB2-TABLE-NAME (1)      39320000
361600                 SET DP013-DB2-ABEND                              39330000
361700                     DP013-XCTL-DISPLAY-RESTART                   39340000
361800                                 TO TRUE                          39350000
361900             PERFORM DP013-0000-PROCESS-ABEND                     39360000
362000     END-EVALUATE.                                                39370000
362100                                                                  39380000
362200/                                                                 39390000
362300*----------------------------------------------------------------*39400000
362400* CHECK IF PO HAS ANY STORE ALLOCATIONS                          *39410000
362500*----------------------------------------------------------------*39420000
362600                                                                  39430000
362700 4350-CHECK-STORE-ALLOC.                                          39440000
362800                                                                  39450000
362900     EXEC SQL                                                     39460000
363000          SELECT COUNT(*)                                         39470000
363100            INTO :PV-DB2-COUNT                                    39480000
363200            FROM TMESTDS                                          39490000
363300           WHERE PO_NBR  = :DK-PO-NBR                             39500000
363400             AND STR_NBR = :DK-STR-NBR                            39510000
363500     END-EXEC.                                                    39520000
363600                                                                  39530000
363700     EVALUATE TRUE                                                39540000
363800         WHEN SQLCODE = +0                                        39550000
363900         WHEN SQLCODE = +100                                      39560000
364000         WHEN SQLCODE = -904                                      39570000
364100         WHEN SQLCODE = -913                                      39580000
364200              CONTINUE                                            39590000
364300                                                                  39600000
364400         WHEN SQLWARN0 NOT = SPACES                               39610000
364500         WHEN SQLCODE < +0                                        39620000
364600         WHEN SQLCODE > +0                                        39630000
364700              MOVE '4350-CHECK-STORE-ALLOC'                       39640000
364800                              TO DP013-PARAGRAPH                  39650000
364900              MOVE 'UNSUCCESSFUL SELECT STORE ALLOCATIONS '       39660000
365000                              TO DP013-MESSAGE-TEXT (1)           39670000
365100              MOVE SQLCA      TO DP013-SQLCA                      39680000
365200              MOVE 'TMESTDS ' TO DP013-DB2-TABLE-NAME (1)         39690000
365300              SET DP013-DB2-ABEND                                 39700000
365400                  DP013-XCTL-DISPLAY-RESTART                      39710000
365500                              TO TRUE                             39720000
365600              PERFORM DP013-0000-PROCESS-ABEND                    39730000
365700     END-EVALUATE.                                                39740000
365800                                                                  39750000
365900/                                                                 39760000
366000*----------------------------------------------------------------*39770000
366100* CHECK IF PO OFFERS A PARTICULAR TYPE OF SERVICE                *39780000
366200*----------------------------------------------------------------*39790000
366300                                                                  39800000
366400 4360-CHECK-SERVICE.                                              39810000
366500                                                                  39820000
366600     EXEC SQL                                                     39830000
366700          SELECT COUNT(*)                                         39840000
366800            INTO :PV-DB2-COUNT                                    39850000
366900            FROM TPOAGMT                                          39860000
367000           WHERE PO_NBR         = :DK-PO-NBR                      39870000
367100             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                39880000
367200             AND VER_STATUS_CDE = 'A'                             39890000
367300             AND TYP_CDE        = :DK-TYP-CDE                     39900000
367400     END-EXEC.                                                    39910000
367500                                                                  39920000
367600     EVALUATE TRUE                                                39930000
367700         WHEN SQLCODE = +0                                        39940000
367800         WHEN SQLCODE = +100                                      39950000
367900         WHEN SQLCODE = -904                                      39960000
368000         WHEN SQLCODE = -913                                      39970000
368100              CONTINUE                                            39980000
368200                                                                  39990000
368300         WHEN SQLWARN0 NOT = SPACES                               40000000
368400         WHEN SQLCODE < +0                                        40010000
368500         WHEN SQLCODE > +0                                        40020000
368600              MOVE '4360-CHECK-SERVICE'                           40030000
368700                              TO DP013-PARAGRAPH                  40040000
368800              MOVE 'UNSUCCESSFUL SELECT PURCHASE AGREEMENT'       40050000
368900                              TO DP013-MESSAGE-TEXT (1)           40060000
369000              MOVE SQLCA      TO DP013-SQLCA                      40070000
369100              MOVE 'TPOAGMT ' TO DP013-DB2-TABLE-NAME (1)         40080000
369200              SET DP013-DB2-ABEND                                 40090000
369300                  DP013-XCTL-DISPLAY-RESTART                      40100000
369400                              TO TRUE                             40110000
369500              PERFORM DP013-0000-PROCESS-ABEND                    40120000
369600     END-EVALUATE.                                                40130000
369700                                                                  40140000
369800/                                                                 40150000
366000*----------------------------------------------------------------*40160000
366100* CHECK IF PO OFFERS A PARTICULAR TYPE OF SERVICE                *40170000
366200*----------------------------------------------------------------*40180000
366300                                                                  40190000
366400 4365-CHECK-SERVICE.                                              40200000
366500                                                                  40210000
366600     EXEC SQL                                                     40220000
366700          SELECT COUNT(*)                                         40230000
366800            INTO :PV-DB2-COUNT                                    40240000
366900            FROM TPURCHS                                          40250000
367000           WHERE PO_NBR         = :DK-PO-NBR                      40260000
                   AND PKGNG_CDE      = ''                              40270000
367200             AND VER_STATUS_CDE = 'A'                             40280000
367400     END-EXEC.                                                    40290000
367500                                                                  40300000
367600     EVALUATE TRUE                                                40310000
367700         WHEN SQLCODE = +0                                        40320000
367800         WHEN SQLCODE = +100                                      40330000
367900         WHEN SQLCODE = -904                                      40340000
368000         WHEN SQLCODE = -913                                      40350000
368100              CONTINUE                                            40360000
368200                                                                  40370000
368300         WHEN SQLWARN0 NOT = SPACES                               40380000
368400         WHEN SQLCODE < +0                                        40390000
368500         WHEN SQLCODE > +0                                        40400000
368600              MOVE '4365-CHECK-SERVICE'                           40410000
368700                              TO DP013-PARAGRAPH                  40420000
368800              MOVE 'UNSUCCESSFUL SELECT PURCHASE AGREEMENT'       40430000
368900                              TO DP013-MESSAGE-TEXT (1)           40440000
369000              MOVE SQLCA      TO DP013-SQLCA                      40450000
369100              MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)         40460000
369200              SET DP013-DB2-ABEND                                 40470000
369300                  DP013-XCTL-DISPLAY-RESTART                      40480000
369400                              TO TRUE                             40490000
369500              PERFORM DP013-0000-PROCESS-ABEND                    40500000
369600     END-EVALUATE.                                                40510000
369900*----------------------------------------------------------------*40520000
370000* GET DOLLARS RECEIVED                                           *40530000
370100*----------------------------------------------------------------*40540000
370200                                                                  40550000
370300 4370-GET-DOLLARS-RECEIVED.                                       40560000
370400                                                                  40570000
370500     INITIALIZE PV-GP-DOLLARS-RECEIVED                            40580000
370600                PV-NULL-IND.                                      40590000
370700     EXEC SQL                                                     40600000
370800      SELECT SUM(DECIMAL                                          40610000
370900           (C.AP_VERIFY_ITM_QTY * (A.GP_RTL_AMT / A.GP_QTY),9,2)) 40620075
371000         INTO :PV-GP-DOLLARS-RECEIVED:PV-NULL-IND                 40630000
371100         FROM TPURITM A,                                          40640000
371200              TRECITM B,                                          40650000
371300              TRECDIS C                                           40660000
371400         WHERE A.PO_NBR         = :PURCHS-PO-NBR                  40670000
371500           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                   40680000
371600           AND A.VER_NBR        = B.PO_VER_NBR                    40690000
371700           AND B.ORD_NBR        = A.PO_NBR                        40700000
371800           AND B.STATUS_CDE     = 'VE'                            40710000
371900           AND B.VER_STATUS_CDE = 'A'                             40720000
372000           AND C.ORD_NBR        = A.PO_NBR                        40730000
372100           AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                   40740000
372200           AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                   40750000
372300           AND C.VER_STATUS_CDE = 'A'                             40760000
372400           AND A.GP_QTY         > 1                               40770000
372500     END-EXEC.                                                    40780000
372600                                                                  40790000
372700     EVALUATE TRUE                                                40800000
372800         WHEN SQLCODE = +0                                        40810000
372900           IF PV-NULL-IND NOT = -1                                40820000
373000             CONTINUE                                             40830000
373100              ELSE                                                40840000
373200             MOVE ZEROES TO PV-GP-DOLLARS-RECEIVED                40850000
373300           END-IF                                                 40860000
373400           CONTINUE                                               40870000
373500         WHEN SQLCODE = -904                                      40880000
373600         WHEN SQLCODE = -913                                      40890000
373700              CONTINUE                                            40900000
373800                                                                  40910000
373900         WHEN SQLWARN0 NOT = SPACES                               40920000
374000         WHEN SQLCODE < +0                                        40930000
374100         WHEN SQLCODE > +0                                        40940000
374200              MOVE '4370-GET-DOLLARS-RECEIVED'                    40950000
374300                              TO DP013-PARAGRAPH                  40960000
374400              MOVE 'UNSUCCESSFUL SELECT GP DOLLARS RECEIVED'      40970000
374500                              TO DP013-MESSAGE-TEXT (1)           40980000
374600              MOVE SQLCA      TO DP013-SQLCA                      40990000
374700              MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)         41000000
374800              SET DP013-DB2-ABEND                                 41010000
374900                  DP013-XCTL-DISPLAY-RESTART                      41020000
375000                              TO TRUE                             41030000
375100              PERFORM DP013-0000-PROCESS-ABEND                    41040000
375200     END-EVALUATE.                                                41050000
375201                                                                  41060000
375202     INITIALIZE PV-DOLLARS-RECEIVED                               41070000
375203                PV-NULL-IND.                                      41080000
375204     EXEC SQL                                                     41090000
375205      SELECT SUM(C.AP_VERIFY_ITM_QTY * A.UNT_RTL_PR_AMT)          41100000
375206         INTO :PV-DOLLARS-RECEIVED:PV-NULL-IND                    41110000
375207         FROM TPURITM A,                                          41120000
375208              TRECITM B,                                          41130000
375209              TRECDIS C                                           41140000
375210         WHERE A.PO_NBR         = :PURCHS-PO-NBR                  41150000
375220           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                   41160000
375230           AND A.VER_NBR        = B.PO_VER_NBR                    41170000
375240           AND B.ORD_NBR        = A.PO_NBR                        41180000
375250           AND B.STATUS_CDE     = 'VE'                            41190000
375260           AND B.VER_STATUS_CDE = 'A'                             41200000
375270           AND C.ORD_NBR        = A.PO_NBR                        41210000
375280           AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                   41220000
375290           AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                   41230000
375291           AND C.VER_STATUS_CDE = 'A'                             41240000
375292           AND A.GP_QTY        <= 1                               41250000
375293     END-EXEC.                                                    41260000
375294                                                                  41270000
375295     EVALUATE TRUE                                                41280000
375296         WHEN SQLCODE = +0                                        41290000
375297           IF PV-NULL-IND NOT = -1                                41300000
375298             CONTINUE                                             41310000
375299              ELSE                                                41320000
375300             MOVE ZEROES TO PV-DOLLARS-RECEIVED                   41330000
375301           END-IF                                                 41340000
375302           CONTINUE                                               41350000
375303         WHEN SQLCODE = -904                                      41360000
375304         WHEN SQLCODE = -913                                      41370000
375305              CONTINUE                                            41380000
375306                                                                  41390000
375307         WHEN SQLWARN0 NOT = SPACES                               41400000
375308         WHEN SQLCODE < +0                                        41410000
375309         WHEN SQLCODE > +0                                        41420000
375310              MOVE '4370-GET-DOLLARS-RECEIVED'                    41430000
375311                              TO DP013-PARAGRAPH                  41440000
375312              MOVE 'UNSUCCESSFUL SELECT DOLLARS RECEIVED'         41450000
375313                              TO DP013-MESSAGE-TEXT (1)           41460000
375314              MOVE SQLCA      TO DP013-SQLCA                      41470000
375315              MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)         41480000
375316              SET DP013-DB2-ABEND                                 41490000
375317                  DP013-XCTL-DISPLAY-RESTART                      41500000
375318                              TO TRUE                             41510000
375319              PERFORM DP013-0000-PROCESS-ABEND                    41520000
375320     END-EVALUATE.                                                41530000
375321       ADD PV-DOLLARS-RECEIVED TO PV-GP-DOLLARS-RECEIVED GIVING   41540000
375322          PV-DOLLARS-RECEIVED.                                    41550000
375323*----------------------------------------------------------------*41560000
375324*  DETERMINE IF ANY OF THE ORDERS ARE HAVE IN-PROCESS RECEIVERS, *41570000
375325*  IF THE ORDER DOES, HIGHLIGHT THE PO IN YELLOW ON THE SCREEN.  *41580000
375326*----------------------------------------------------------------*41590000
375327 4380-CHECK-IN-PROCESS.                                           41600000
375328                                                                  41610000
375329     EXEC SQL                                                     41620000
375330          SELECT COUNT(*)                                         41630000
375340            INTO :PV-DB2-COUNT2                                   41640000
375350            FROM TRECEIV                                          41650000
375360           WHERE ORD_NBR        = :PURCHS-PO-NBR                  41660000
375370             AND VER_STATUS_CDE = 'A'                             41670000
375380             AND STATUS_CDE     = 'IP'                            41680000
375390     END-EXEC.                                                    41690000
375400                                                                  41700000
375500     EVALUATE TRUE                                                41710000
375600         WHEN SQLCODE = +0                                        41720000
375700         WHEN SQLCODE = +100                                      41730000
375800         WHEN SQLCODE = -904                                      41740000
375900         WHEN SQLCODE = -913                                      41750000
376000              CONTINUE                                            41760000
376100                                                                  41770000
376200         WHEN SQLWARN0 NOT = SPACES                               41780000
376300         WHEN SQLCODE < +0                                        41790000
376400         WHEN SQLCODE > +0                                        41800000
376500              MOVE '4380-CHECK-IN-PROCESS'                        41810000
376600                              TO DP013-PARAGRAPH                  41820000
376700              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'               41830000
376800                              TO DP013-MESSAGE-TEXT (1)           41840000
376900              MOVE SQLCA      TO DP013-SQLCA                      41850000
377000              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         41860000
377100              SET DP013-DB2-ABEND                                 41870000
377200                  DP013-XCTL-DISPLAY-RESTART                      41880000
377300                              TO TRUE                             41890000
377400              PERFORM DP013-0000-PROCESS-ABEND                    41900000
377500     END-EVALUATE.                                                41910000
377600                                                                  41920000
377700 4390-GET-UNITS-RECEIVED.                                         41930000
377800                                                                  41940000
377900     INITIALIZE PV-UNITS-RECEIVED                                 41950000
378000                PV-NULL-IND.                                      41960000
378100     PERFORM                                                      41970000
378200         WITH TEST AFTER                                          41980000
378300         VARYING PV-RETRY-COUNTER                                 41990000
378400         FROM 1 BY 1                                              42000000
378500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42010000
378600             OR (SQLCODE = +0)                                    42020000
378700             OR (SQLCODE = +100))                                 42030000
378800                                                                  42040000
378900         EXEC SQL                                                 42050000
379000             SELECT SUM(B.AP_VERIFY_ITM_QTY)                      42060000
379100             INTO :PV-UNITS-RECEIVED:PV-NULL-IND                  42070000
379200             FROM TRECITM A,                                      42080000
379300                  TRECDIS B                                       42090000
379400             WHERE A.ORD_NBR        = :PURCHS-PO-NBR              42100000
379500               AND A.ORD_NBR        = B.ORD_NBR                   42110000
379600               AND A.STATUS_CDE     = 'VE'                        42120000
379700               AND A.VER_STATUS_CDE = 'A'                         42130000
379800               AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR               42140000
379900               AND B.REC_SEQ_NBR    = A.REC_SEQ_NBR               42150000
380000               AND B.VER_STATUS_CDE = 'A'                         42160000
380100         END-EXEC                                                 42170000
380200                                                                  42180000
380300         EVALUATE TRUE                                            42190000
380400             WHEN SQLCODE = +0                                    42200000
380500             WHEN SQLCODE = +100                                  42210000
380600             WHEN SQLCODE = -904                                  42220000
380700             WHEN SQLCODE = -913                                  42230000
380800                  CONTINUE                                        42240000
380900                                                                  42250000
381000             WHEN SQLWARN0 NOT = SPACES                           42260000
381100             WHEN SQLCODE < +0                                    42270000
381200             WHEN SQLCODE > +0                                    42280000
381300                  MOVE '4390-GET-UNITS-RCVD'                      42290000
381400                                  TO DP013-PARAGRAPH              42300000
381500                  MOVE 'UNSUCCESSFUL SELECT UNITS RCVD  '         42310000
381600                                  TO DP013-MESSAGE-TEXT (1)       42320000
381700                  MOVE SQLCA      TO DP013-SQLCA                  42330000
381800                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     42340000
381900                  MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (2)     42350000
382000                  SET DP013-DB2-ABEND                             42360000
382100                      DP013-XCTL-DISPLAY-RESTART                  42370000
382200                                  TO TRUE                         42380000
382300                  PERFORM DP013-0000-PROCESS-ABEND                42390000
382400         END-EVALUATE                                             42400000
382500     END-PERFORM.                                                 42410000
382600                                                                  42420000
382700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42430000
382800         MOVE '4390-GET-UNITS-RCVD '                              42440000
382900                                  TO DP013-PARAGRAPH              42450000
383000         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TRECITM'          42460000
383100                                  TO DP013-MESSAGE-TEXT (1)       42470000
383200         MOVE SQLCA               TO DP013-SQLCA                  42480000
383300         MOVE 'TRECITM '          TO DP013-DB2-TABLE-NAME (1)     42490000
383400         MOVE 'TRECDIS '          TO DP013-DB2-TABLE-NAME (2)     42500000
383500         SET DP013-DB2-ABEND                                      42510000
383600             DP013-XCTL-DISPLAY-RESTART                           42520000
383700                                  TO TRUE                         42530000
383800         PERFORM DP013-0000-PROCESS-ABEND                         42540000
383900     END-IF.                                                      42550000
384000                                                                  42560000
384100 4395-GET-MIN-AD-DATE.                                            42570000
384200                                                                  42580000
384300     MOVE SPACES TO PV-AD-EVNT-DTE.                               42590000
384400     MOVE +0     TO PV-NULL-IND.                                  42600000
384500                                                                  42610000
384600     PERFORM                                                      42620000
384700         WITH TEST AFTER                                          42630000
384800         VARYING PV-RETRY-COUNTER                                 42640000
384900         FROM 1 BY 1                                              42650000
385000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42660000
385100             OR (SQLCODE = +0)                                    42670000
385200             OR (SQLCODE = +100))                                 42680000
385300                                                                  42690000
385400         EXEC SQL                                                 42700000
385500             SELECT MIN(AD_EVNT_DTE)                              42710000
385600              INTO  :PURITM-AD-EVNT-DTE:PV-NULL-IND               42720000
385700              FROM  TPURITM                                       42730000
385800              WHERE PO_NBR          = :PURCHS-PO-NBR              42740000
385900                AND VER_STATUS_CDE  = 'A'                         42750000
386000                AND AD_EVNT_DTE     > '0001-01-01'                42760000
386100                AND STATUS_CDE NOT IN ('CA')                      42770000
386200         END-EXEC                                                 42780000
386300                                                                  42790000
386400         EVALUATE TRUE                                            42800000
386500             WHEN SQLCODE = +0                                    42810000
386600                  IF  PV-NULL-IND < +0                            42820000
386700                      MOVE SPACES          TO PV-AD-EVNT-DTE      42830000
386800                  ELSE                                            42840000
386900                      MOVE PURITM-AD-EVNT-DTE                     42850000
387000                                           TO PV-DB2-DATE         42860000
387100                      MOVE PV-DB2-DATE-MM  TO PV-DISPLAY-DATE-MM  42870000
387200                      MOVE PV-DB2-DATE-DD  TO PV-DISPLAY-DATE-DD  42880000
387300                      MOVE PV-DB2-DATE-YY  TO PV-DISPLAY-DATE-YY  42890000
387400                      MOVE PV-DISPLAY-DATE TO PV-AD-EVNT-DTE      42900000
387500                  END-IF                                          42910000
387600             WHEN SQLCODE = +100                                  42920000
387700                  MOVE SPACES              TO PV-AD-EVNT-DTE      42930000
387800             WHEN SQLCODE = -904                                  42940000
387900             WHEN SQLCODE = -913                                  42950000
388000                  CONTINUE                                        42960000
388100                                                                  42970000
388200             WHEN SQLWARN0 NOT = SPACES                           42980000
388300             WHEN SQLCODE < +0                                    42990000
388400             WHEN SQLCODE > +0                                    43000000
388500                  MOVE '4395-GET-MIN-AD-DTE'                      43010000
388600                                  TO DP013-PARAGRAPH              43020000
388700                  MOVE 'UNSUCCESSFUL SELECT MIN AD DATE '         43030000
388800                                  TO DP013-MESSAGE-TEXT (1)       43040000
388900                  MOVE SQLCA      TO DP013-SQLCA                  43050000
389000                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     43060000
389100                  SET DP013-DB2-ABEND                             43070000
389200                      DP013-XCTL-DISPLAY-RESTART                  43080000
389300                                  TO TRUE                         43090000
389400                  PERFORM DP013-0000-PROCESS-ABEND                43100000
389500         END-EVALUATE                                             43110000
389600     END-PERFORM.                                                 43120000
389700                                                                  43130000
389800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43140000
389900         MOVE '4395-GET-MIN-AD-DATE'                              43150000
390000                                  TO DP013-PARAGRAPH              43160000
390100         MOVE 'MAX RETRIES EXCEEDED ON SELECT   TPURITM'          43170000
390200                                  TO DP013-MESSAGE-TEXT (1)       43180000
390300         MOVE SQLCA               TO DP013-SQLCA                  43190000
390400         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     43200000
390500         SET DP013-DB2-ABEND                                      43210000
390600             DP013-XCTL-DISPLAY-RESTART                           43220000
390700                                  TO TRUE                         43230000
390800         PERFORM DP013-0000-PROCESS-ABEND                         43240000
390900     END-IF.                                                      43250000
391000                                                                  43260000
391100/                                                                 43270000
391200*----------------------------------------------------------------*43280000
391300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *43290000
391400*----------------------------------------------------------------*43300000
391500                                                                  43310000
391600 4400-MOVE-COMMAREA-TO-SCREEN.                                    43320000
391700                                                                  43330000
391800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             43340000
391900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          43350000
392000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          43360000
392100             MOVE +1               TO ASC-BLK-SUB                 43370000
392200             PERFORM 5100-WRITE-TEMP-STORAGE                      43380000
392300             ADD +1                TO ASC-BLK-SUB                 43390000
392400             PERFORM 5100-WRITE-TEMP-STORAGE                      43400000
392500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             43410000
392600                 GIVING PV-BLOCK-NUMBER                           43420000
392700                 REMAINDER PV-REMAINDER                           43430000
392800             IF  PV-REMAINDER > ZERO                              43440000
392900                 ADD +1            TO PV-BLOCK-NUMBER             43450000
393000             END-IF                                               43460000
393100             MOVE +1               TO ASC-BLK-SUB                 43470000
393200             PERFORM 4410-READ-TEMP-STORAGE                       43480000
393300             ADD +1                TO ASC-BLK-SUB                 43490000
393400                                      PV-BLOCK-NUMBER             43500000
393500             PERFORM 4410-READ-TEMP-STORAGE                       43510000
393600     END-IF.                                                      43520000
393700                                                                  43530000
393800     MOVE +1                       TO ASC-BLK-SUB.                43540000
393900                                                                  43550000
394000     COMPUTE ASC-ITEM-SUB =                                       43560000
394100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              43570000
394200         + PC-ITEMS-PER-PANEL).                                   43580000
394300                                                                  43590000
394400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        43600000
394500         ADD +1                    TO ASC-BLK-SUB                 43610000
394600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            43620000
394700     END-IF.                                                      43630000
394800                                                                  43640000
394900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           43650000
395000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                43660000
395100                                                                  43670000
395200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        43680000
395300     PERFORM 4420-FORMAT-LIST-LINES                               43690000
395400         VARYING PV-SUB                                           43700000
395500         FROM PC-ITEMS-PER-PANEL BY -1                            43710000
395600         UNTIL PV-SUB < +1.                                       43720000
395700                                                                  43730000
395800     COMPUTE ASC-ITEMS-DISPLAYED =                                43740000
395900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          43750000
396000                                                                  43760000
396100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    43770000
396200                                      ASTRTITO.                   43780000
396300                                                                  43790000
396400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    43800000
396500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    43810000
396600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43820000
396700                                   TO ASELITO.                    43830000
396800                                                                  43840000
396900     IF ASC-DISPLAY-UNITS                                         43850000
397000        MOVE PC-UNITS-HEAD     TO AHEADO                          43860000
397100        MOVE PC-UNITS-HEAD2    TO AHEAD2O                         43870000
397310        MOVE ASC-UNIT-ORD-TOT  TO MR-UNITS-ORDERED-TOT            43880000
397320        MOVE ASC-UNIT-REC-TOT  TO MR-UNITS-RECEIVED-TOT           43890000
397510        IF ASC-UNIT-ORD-TOT = 0                                   43900000
397600           MOVE 0 TO MR-UNITS-RCVD-PCT-TOT                        43910000
397700        ELSE                                                      43920000
397800           COMPUTE PV-PCT-AREA                                    43930000
397910              =   (ASC-UNIT-REC-TOT / ASC-UNIT-ORD-TOT)           43940000
398000              *    100                                            43950000
398400           MOVE PV-PCT-AREA    TO MR-UNITS-RCVD-PCT-TOT           43960000
398500        END-IF                                                    43970000
398600        MOVE MR-UNITS-TOTAL    TO ATLINEO                         43980000
398700     ELSE                                                         43990000
398800        MOVE PC-DOLLAR-HEAD    TO AHEADO                          44000000
398900        MOVE PC-DOLLAR-HEAD2   TO AHEAD2O                         44010000
399110        MOVE ASC-DOLLAR-ORD-TOT TO MR-DOLLARS-ORDERED-TOT         44020000
399120        MOVE ASC-DOLLAR-REC-TOT TO MR-DOLLARS-RECEIVED-TOT        44030000
399310        IF ASC-DOLLAR-ORD-TOT = 0                                 44040000
399400           MOVE 0 TO MR-DOLLARS-RCVD-PCT-TOT                      44050000
399500        ELSE                                                      44060000
399600           COMPUTE PV-PCT-AREA                                    44070000
399710              =   (ASC-DOLLAR-REC-TOT / ASC-DOLLAR-ORD-TOT)       44080000
399800              *    100                                            44090000
400200           MOVE PV-PCT-AREA    TO MR-DOLLARS-RCVD-PCT-TOT         44100000
400300        END-IF                                                    44110000
400400        MOVE MR-DOLLARS-TOTAL  TO ATLINEO.                        44120000
400500                                                                  44130000
400600     IF  DP020-MSG-NUMBER-X = SPACE                               44140000
400700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  44150000
400800*            --- MORE ITEMS TO DISPLAY ----                       44160000
400900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            44170000
401000             SET DP020-MSG-INFORMATIONAL                          44180000
401100                                   TO TRUE                        44190000
401200         END-IF                                                   44200000
401300     END-IF.                                                      44210000
401400                                                                  44220000
401500*----------------------------------------------------------------*44230000
401600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *44240000
401700*----------------------------------------------------------------*44250000
401800                                                                  44260000
401900 4410-READ-TEMP-STORAGE.                                          44270000
402000                                                                  44280000
402100     EXEC CICS                                                    44290000
402200         READQ TS                                                 44300000
402300             QUEUE (ASC-LIST-QUEUE-NAME)                          44310000
402400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               44320000
402500             ITEM  (PV-BLOCK-NUMBER)                              44330000
402600             RESP  (PV-CICS-RESP)                                 44340000
402700     END-EXEC.                                                    44350000
402800                                                                  44360000
402900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       44370000
403000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     44380000
403100         CONTINUE                                                 44390000
403200     ELSE                                                         44400000
403300         SET DP013-CICS-ABEND      TO TRUE                        44410000
403400         SET DP013-NO-ROLLBACK     TO TRUE                        44420000
403500         MOVE '4410-READ-TEMP-STORAGE'                            44430000
403600                                   TO DP013-PARAGRAPH             44440000
403700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      44450000
403800                                   TO DP013-MESSAGE-TEXT(1)       44460000
403900         PERFORM DP013-0000-PROCESS-ABEND                         44470000
404000     END-IF.                                                      44480000
404100                                                                  44490000
404200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      44500000
404300                                   TO TRUE.                       44510000
404400                                                                  44520000
404500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         44530000
404600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               44540000
404700     END-IF.                                                      44550000
404800/                                                                 44560000
404900*----------------------------------------------------------------*44570000
405000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *44580000
405100*----------------------------------------------------------------*44590000
405200                                                                  44600000
405300 4420-FORMAT-LIST-LINES.                                          44610000
405400                                                                  44620000
405500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      44630000
405600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                44640000
405700         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         44650000
405800         MOVE SPACES               TO MR-SELECT  (PV-SUB)         44660000
405900                                      MR-PO-NBR-X (PV-SUB)        44670000
406000                                      MR-DEPT-NBR (PV-SUB)        44680000
406100                                      MR-VENDOR-NAME (PV-SUB)     44690000
406200                                      MR-STATUS (PV-SUB)          44700000
406300                                      MR-OTB (PV-SUB)             44710000
406400                                      MR-SHIP-DATE (PV-SUB)       44720000
406500                                      MR-CANCEL-DATE (PV-SUB)     44730000
406600                                      MR-EDI-IND (PV-SUB)         44740000
406700                                      MR-LINE-AREA (PV-SUB)       44750000
406800     ELSE                                                         44760000
406900         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      44770000
407000                                                   > SPACE        44780000
407100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 44790000
407200                                   TO MR-SELECT (PV-SUB)          44800000
407300         ELSE                                                     44810000
407400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      44820000
407500                                   TO MR-SELECT (PV-SUB)          44830000
407600         END-IF                                                   44840000
407700                                                                  44850000
407800         IF  DP030-SET-CURSOR-TRAILER                             44860000
407900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)44870000
408000                 > SPACE)                                         44880000
408100               OR (PV-SUB = 1))                                   44890000
408200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               44900000
408300                MOVE -1            TO MR-SELECTL (PV-SUB)         44910000
408400             END-IF                                               44920000
408500         END-IF                                                   44930000
408600                                                                  44940000
408700         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           44950000
408800             MOVE ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)           44960000
408900                                   TO MR-PO-NBR (PV-SUB)          44970000
409000             MOVE ASC-DEPT-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         44980000
409100                                   TO MR-DEPT-NBR (PV-SUB)        44990000
409200             MOVE ASC-VENDOR-NAME (ASC-BLK-SUB ASC-ITEM-SUB)      45000000
409300                                   TO MR-VENDOR-NAME (PV-SUB)     45010000
409400             MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           45020000
409500                                   TO MR-STATUS (PV-SUB)          45030000
409600             MOVE ASC-OTB (ASC-BLK-SUB ASC-ITEM-SUB)              45040000
409700                                   TO MR-OTB (PV-SUB)             45050000
409800             MOVE ASC-SHIP-DATE (ASC-BLK-SUB ASC-ITEM-SUB)        45060000
409900                                   TO MR-SHIP-DATE (PV-SUB)       45070000
410000             MOVE ASC-CANCEL-DATE (ASC-BLK-SUB ASC-ITEM-SUB)      45080000
410100                                   TO MR-CANCEL-DATE (PV-SUB)     45090000
410200             MOVE ASC-EDI-IND     (ASC-BLK-SUB ASC-ITEM-SUB)      45100000
410300                                   TO MR-EDI-IND (PV-SUB)         45110000
410400                                                                  45120000
410500             IF ASC-IP-IND (ASC-BLK-SUB ASC-ITEM-SUB) = 'Y'       45130000
410600                 MOVE DP015-YELLOW          TO MR-PO-NBRC(PV-SUB) 45140000
410700             ELSE                                                 45150000
410800                 MOVE DP015-BLUE            TO MR-PO-NBRC(PV-SUB) 45160000
410900             END-IF                                               45170000
411000                                                                  45180000
411100         END-IF                                                   45190000
411200         IF ASC-DISPLAY-UNITS                                     45200000
411300            PERFORM 4425-MOVE-UNITS                               45210000
411400         ELSE                                                     45220000
411500            PERFORM 4428-MOVE-DOLLARS                             45230000
411600         END-IF                                                   45240000
411700     END-IF.                                                      45250000
411800                                                                  45260000
411900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               45270000
412000                                                                  45280000
412100     IF  ASC-ITEM-SUB < + 1                                       45290000
412200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                45300000
412300         MOVE +1                   TO ASC-BLK-SUB                 45310000
412400     END-IF.                                                      45320000
412500                                                                  45330000
412600 4425-MOVE-UNITS.                                                 45340000
412700                                                                  45350000
412800     MOVE ASC-TOT-UNIT-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB)         45360000
412900                                   TO MR-UNITS-ORDERED.           45370000
413000     MOVE ASC-TOT-UNIT-RCVD (ASC-BLK-SUB ASC-ITEM-SUB)            45380000
413100                                   TO MR-UNITS-RECEIVED.          45390000
413200                                                                  45400000
413400     IF ASC-TOT-UNIT-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB) = 0       45410000
413500        MOVE 0             TO MR-UNITS-RCVD-PCT                   45420000
413600        MOVE SPACES        TO MR-UNITS-PCT-SPACE                  45430000
413700     ELSE                                                         45440000
413800        COMPUTE PV-PCT-AREA                                       45450000
413900           =   (ASC-TOT-UNIT-RCVD (ASC-BLK-SUB ASC-ITEM-SUB)      45460000
414000           /    ASC-TOT-UNIT-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB))  45470000
414100           *    100                                               45480000
414500        MOVE PV-PCT-AREA TO MR-UNITS-RCVD-PCT                     45490000
414600        IF PV-PCT-AREA = 0                                        45500000
414700           MOVE SPACES TO MR-UNITS-PCT-SPACE                      45510000
414800        ELSE                                                      45520000
414900           MOVE '% '   TO MR-UNITS-PCT-SPACE                      45530000
415000        END-IF                                                    45540000
415100     END-IF.                                                      45550000
415200                                                                  45560000
415300     MOVE ASC-AD-EVNT-DTE (ASC-BLK-SUB ASC-ITEM-SUB)              45570000
415400                            TO MR-AD-EVNT-DTE.                    45580000
415500     MOVE MR-UNITS-LINE     TO MR-LINE-AREA(PV-SUB).              45590000
415600                                                                  45600000
415700 4428-MOVE-DOLLARS.                                               45610000
415800                                                                  45620000
415900     MOVE ASC-DOLLARS-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB)          45630000
416000                           TO MR-DOLLARS-ORDERED                  45640000
416100     MOVE ASC-DOLLARS-RECEIVED (ASC-BLK-SUB ASC-ITEM-SUB)         45650000
416200                           TO MR-DOLLARS-RECEIVED                 45660000
416300                                                                  45670000
416500     IF ASC-DOLLARS-ORDERED  (ASC-BLK-SUB ASC-ITEM-SUB) = 0       45680000
416600        MOVE 0             TO MR-DOLLARS-RCVD-PCT                 45690000
416700        MOVE SPACES        TO MR-DOLLARS-PCT-SPACE                45700000
416800     ELSE                                                         45710000
416900        COMPUTE PV-PCT-AREA                                       45720000
417000           =   (ASC-DOLLARS-RECEIVED (ASC-BLK-SUB ASC-ITEM-SUB)   45730000
417100           /    ASC-DOLLARS-ORDERED (ASC-BLK-SUB ASC-ITEM-SUB))   45740000
417200           *    100                                               45750000
417600        MOVE PV-PCT-AREA TO MR-DOLLARS-RCVD-PCT                   45760000
417700        IF PV-PCT-AREA = 0                                        45770000
417800           MOVE SPACES   TO MR-DOLLARS-PCT-SPACE                  45780000
417900        ELSE                                                      45790000
418000           MOVE '% '     TO MR-DOLLARS-PCT-SPACE                  45800000
418100        END-IF                                                    45810000
418200     END-IF.                                                      45820000
418300                                                                  45830000
418400     MOVE MR-DOLLAR-LINE TO MR-LINE-AREA(PV-SUB).                 45840000
418500                                                                  45850000
418600*----------------------------------------------------------------*45860000
418700*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *45870000
418800*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *45880000
418900*  ISSUE A WARNING.                                              *45890000
419000*----------------------------------------------------------------*45900000
419100 4430-CHECK-FOR-BEGIN-AND-END.                                    45910000
419200                                                                  45920000
419300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       45930000
419400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     45940000
419500*            -- NO END-OF-RANGE SPECFIED ---                      45950000
419600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            45960000
419700             SET DP020-MSG-WARNING TO TRUE                        45970000
419800             PERFORM 4431-POSITION-AT-WARNING                     45980000
419900         END-IF                                                   45990000
420000     ELSE                                                         46000000
420100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     46010000
420200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                46020000
420300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            46030000
420400             SET DP020-MSG-WARNING TO TRUE                        46040000
420500             PERFORM 4431-POSITION-AT-WARNING                     46050000
420600         END-IF                                                   46060000
420700     END-IF.                                                      46070000
420800                                                                  46080000
420900*----------------------------------------------------------------*46090000
421000*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *46100000
421100*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *46110000
421200*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *46120000
421300*  POSITION THE CURSOR THERE.                                    *46130000
421400*----------------------------------------------------------------*46140000
421500 4431-POSITION-AT-WARNING.                                        46150000
421600                                                                  46160000
421700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 46170000
421800                    - PV-TOP-ITEM + 1.                            46180000
421900                                                                  46190000
422000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      46200000
422100         CONTINUE                                                 46210000
422200     ELSE                                                         46220000
422300         SET DP030-SET-CURSOR-APPL-1                              46230000
422400                                   TO TRUE                        46240000
422500         MOVE -1                   TO MR-SELECTL (PV-SUB)         46250000
422600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46260000
422700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         46270000
422800     END-IF.                                                      46280000
422900                                                                  46290000
423000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   46300000
423100                    - PV-TOP-ITEM + 1.                            46310000
423200                                                                  46320000
423300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      46330000
423400         CONTINUE                                                 46340000
423500     ELSE                                                         46350000
423600         SET DP030-SET-CURSOR-APPL-1                              46360000
423700                                   TO TRUE                        46370000
423800         MOVE -1                   TO MR-SELECTL (PV-SUB)         46380000
423900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46390000
424000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         46400000
424100     END-IF.                                                      46410000
424200                                                                  46420000
424300/                                                                 46430000
424400*----------------------------------------------------------------*46440000
424500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *46450000
424600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *46460000
424700* FOR THE SELECTED ITEMS QUEUE.                                  *46470000
424800*                                                                *46480000
424900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *46490000
425000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *46500000
425100* THE ARRAY IS FULL.                                             *46510000
425200*----------------------------------------------------------------*46520000
425300                                                                  46530000
425400 5000-PREPARE-SEL-QUEUE.                                          46540000
425500                                                                  46550000
425600     MOVE +1                       TO ASC-BLK-SUB.                46560000
425700     PERFORM 5100-WRITE-TEMP-STORAGE.                             46570000
425800     ADD +1                        TO ASC-BLK-SUB.                46580000
425900     PERFORM 5100-WRITE-TEMP-STORAGE.                             46590000
426000                                                                  46600000
426100     MOVE ASC-SEL-QUEUE-NAME       TO PO013-SEL-QUEUE-NAME.       46610000
426200     PERFORM 6010-DELETE-SEL-QUEUE.                               46620000
426300                                                                  46630000
426400     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      46640000
426500         SET ASC-UPDATE-TSQ        TO TRUE                        46650000
426600     END-IF.                                                      46660000
426700                                                                  46670000
426800     SET PO012-IDX                 TO 1.                          46680000
426900     MOVE ZERO                     TO PO013-NUMBER-OF-TS-ITEMS.   46690000
427000     INITIALIZE PO012-SELECTED-ITEM-ARRAY.                        46700000
427100                                                                  46710000
427200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           46720000
427300             VARYING PV-ITEM                                      46730000
427400             FROM 1 BY 1                                          46740000
427500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     46750000
427600                                                                  46760000
427700     IF  PO012-IDX > 1                                            46770000
427800         PERFORM 5205-WRITE-SEL-QUEUE                             46780000
427900         ADD +1                    TO PO013-NUMBER-OF-TS-ITEMS    46790000
428000     END-IF.                                                      46800000
428100                                                                  46810000
428200/                                                                 46820000
428300*----------------------------------------------------------------*46830000
428400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *46840000
428500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *46850000
428600*----------------------------------------------------------------*46860000
428700                                                                  46870000
428800 5100-WRITE-TEMP-STORAGE.                                         46880000
428900                                                                  46890000
429000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     46900000
429100                                   TO PV-LIST-ITEM-NUMBER.        46910000
429200     COMPUTE PV-BLOCK-NUMBER =                                    46920000
429300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    46930000
429400                                                                  46940000
429500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             46950000
429600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             46960000
429700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      46970000
429800             PERFORM 5105-REWRITE-ASC-LISTQ                       46980000
429900         END-IF                                                   46990000
430000     ELSE                                                         47000000
430100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       47010000
430200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            47020000
430300         PERFORM 5110-WRITE-ASC-LISTQ                             47030000
430400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   47040000
430500     END-IF.                                                      47050000
430600                                                                  47060000
430700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      47070000
430800                                   TO TRUE.                       47080000
430900                                                                  47090000
431000/                                                                 47100000
431100*----------------------------------------------------------------*47110000
431200*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *47120000
431300*  SPECIFIC COMMAREA.                                            *47130000
431400*----------------------------------------------------------------*47140000
431500 5105-REWRITE-ASC-LISTQ.                                          47150000
431600                                                                  47160000
431700     EXEC CICS                                                    47170000
431800         WRITEQ TS                                                47180000
431900             QUEUE (ASC-LIST-QUEUE-NAME)                          47190000
432000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               47200000
432100             ITEM  (PV-BLOCK-NUMBER)                              47210000
432200             REWRITE                                              47220000
432300             RESP  (PV-CICS-RESP)                                 47230000
432400     END-EXEC.                                                    47240000
432500                                                                  47250000
432600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           47260000
432700         CONTINUE                                                 47270000
432800     ELSE                                                         47280000
432900         SET DP013-CICS-ABEND      TO TRUE                        47290000
433000         SET DP013-NO-ROLLBACK     TO TRUE                        47300000
433100         MOVE '5105-REWRITE-ASC-LISTQ'                            47310000
433200                                   TO DP013-PARAGRAPH             47320000
433300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     47330000
433400                                   TO DP013-MESSAGE-TEXT(1)       47340000
433500         PERFORM DP013-0000-PROCESS-ABEND                         47350000
433600     END-IF.                                                      47360000
433700                                                                  47370000
433800/                                                                 47380000
433900*----------------------------------------------------------------*47390000
434000*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *47400000
434100*  SPECIFIC COMMAREA.                                            *47410000
434200*----------------------------------------------------------------*47420000
434300 5110-WRITE-ASC-LISTQ.                                            47430000
434400                                                                  47440000
434500     EXEC CICS                                                    47450000
434600         WRITEQ TS                                                47460000
434700             QUEUE (ASC-LIST-QUEUE-NAME)                          47470000
434800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               47480000
434900             ITEM  (PV-BLOCK-NUMBER)                              47490000
435000             RESP  (PV-CICS-RESP)                                 47500000
435100     END-EXEC.                                                    47510000
435200                                                                  47520000
435300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      47530000
435400         SET DP013-CICS-ABEND      TO TRUE                        47540000
435500         SET DP013-NO-ROLLBACK     TO TRUE                        47550000
435600         MOVE '5110-WRITE-ASC-LISTQ'                              47560000
435700                                   TO DP013-PARAGRAPH             47570000
435800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           47580000
435900                                   TO DP013-MESSAGE-TEXT(1)       47590000
436000         PERFORM DP013-0000-PROCESS-ABEND                         47600000
436100     END-IF.                                                      47610000
436200                                                                  47620000
436300/                                                                 47630000
436400*----------------------------------------------------------------*47640000
436500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *47650000
436600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *47660000
436700*----------------------------------------------------------------*47670000
436800                                                                  47680000
436900 5200-FILL-SEL-QUEUE-RECORD.                                      47690000
437000                                                                  47700000
437100     PERFORM 6112-READ-LIST-QUEUE.                                47710000
437200                                                                  47720000
437300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       47730000
437400         PERFORM                                                  47740000
437500         VARYING LQW-IDX                                          47750000
437600         FROM 1 BY 1                                              47760000
437700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            47770000
437800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          47780000
437900                                                                  47790000
438000             IF  LQW-SELECT (LQW-IDX)                             47800000
438100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              47810000
438200                                   TO PO012-ITEM (PO012-IDX)      47820000
438300                 MOVE LQW-PO-NBR (LQW-IDX)                        47830000
438400                           TO PO012-PO-NBR (PO012-IDX)            47840000
438500                 MOVE SPACE        TO PO012-ACTION-SW (PO012-IDX) 47850000
438600                 SET PO012-IDX UP BY 1                            47860000
438700                 IF  PO012-IDX > PO012-MAX-ITEMS                  47870000
438800                     PERFORM 5205-WRITE-SEL-QUEUE                 47880000
438900                     ADD +1        TO PO013-NUMBER-OF-TS-ITEMS    47890000
439000                     INITIALIZE PO012-SELECTED-ITEM-ARRAY         47900000
439100                     SET PO012-IDX TO 1                           47910000
439200                 END-IF                                           47920000
439300             END-IF                                               47930000
439400         END-PERFORM                                              47940000
439500     END-IF.                                                      47950000
439600                                                                  47960000
439700/                                                                 47970000
439800*----------------------------------------------------------------*47980000
439900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *47990000
440000*----------------------------------------------------------------*48000000
440100                                                                  48010000
440200 5205-WRITE-SEL-QUEUE.                                            48020000
440300                                                                  48030000
440400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            48040000
440500                                   TO PO012-SELECTED-ITEMS.       48050000
440600                                                                  48060000
440700     EXEC CICS                                                    48070000
440800          WRITEQ TS                                               48080000
440900              QUEUE (ASC-SEL-QUEUE-NAME)                          48090000
441000              FROM  (PO012-PO-SELECT-RECORD)                      48100000
441100              ITEM  (PV-SEL-QUEUE-ITEM)                           48110000
441200              RESP  (PV-CICS-RESP)                                48120000
441300     END-EXEC.                                                    48130000
441400                                                                  48140000
441500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48150000
441600         CONTINUE                                                 48160000
441700     ELSE                                                         48170000
441800         SET DP013-CICS-ABEND      TO TRUE                        48180000
441900         SET DP013-NO-ROLLBACK     TO TRUE                        48190000
442000         MOVE '5205-WRITE-SEL-QUEUE'                              48200000
442100                                   TO DP013-PARAGRAPH             48210000
442200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          48220000
442300                                   TO DP013-MESSAGE-TEXT(1)       48230000
442400         PERFORM DP013-0000-PROCESS-ABEND                         48240000
442500     END-IF.                                                      48250000
442600                                                                  48260000
442700/                                                                 48270000
442800*----------------------------------------------------------------*48280000
442900*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *48290000
443000*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *48300000
443100*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *48310000
443200*  THE USER.                                                     *48320000
443300*----------------------------------------------------------------*48330000
443400 6000-REFRESH-PANEL-FROM-TEMP.                                    48340000
443500                                                                  48350000
443600     IF  ASC-UPDATE-TSQ                                           48360000
443700         SET ASC-NO-TSQ-UPDATE     TO TRUE                        48370000
443800         MOVE ZERO                 TO PV-SAVE-ITEM                48380000
443900                                      PV-SEL-QUEUE-ITEM           48390000
444000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        48400000
444100                                   TO PV-HOLD-SELECTED-ITEMS      48410000
444200                                                                  48420000
444300         PERFORM 6100-UPDATE-TSQ                                  48430000
444400             UNTIL PV-ITEMS-PROCESSED >                           48440000
444500                                     ASC-NUMBER-OF-SELECTED-ITEMS 48450000
444600         PERFORM 6010-DELETE-SEL-QUEUE                            48460000
444700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         48470000
444800                    ASC-BLOCK-ENTRIES (2)                         48480000
444900     END-IF.                                                      48490000
445000                                                                  48500000
445100/                                                                 48510000
445200*----------------------------------------------------------------*48520000
445300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *48530000
445400*----------------------------------------------------------------*48540000
445500 6010-DELETE-SEL-QUEUE.                                           48550000
445600                                                                  48560000
445700     EXEC CICS                                                    48570000
445800         DELETEQ TS                                               48580000
445900             QUEUE (ASC-SEL-QUEUE-NAME)                           48590000
446000             RESP  (PV-CICS-RESP)                                 48600000
446100     END-EXEC.                                                    48610000
446200                                                                  48620000
446300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      48630000
446400         (PV-CICS-RESP = DFHRESP(QIDERR)))                        48640000
446500         CONTINUE                                                 48650000
446600     ELSE                                                         48660000
446700         SET DP013-CICS-ABEND      TO TRUE                        48670000
446800         SET DP013-NO-ROLLBACK     TO TRUE                        48680000
446900         MOVE '6010-DELETE-SEL-QUEUE'                             48690000
447000                                   TO DP013-PARAGRAPH             48700000
447100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         48710000
447200                                   TO DP013-MESSAGE-TEXT (1)      48720000
447300         PERFORM DP013-0000-PROCESS-ABEND                         48730000
447400     END-IF.                                                      48740000
447500                                                                  48750000
447600/                                                                 48760000
447700*----------------------------------------------------------------*48770000
447800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *48780000
447900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *48790000
448000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *48800000
448100*    THE TEMP QUEUE.                                             *48810000
448200*----------------------------------------------------------------*48820000
448300                                                                  48830000
448400 6100-UPDATE-TSQ.                                                 48840000
448500                                                                  48850000
448600     ADD 1                         TO PV-SEL-QUEUE-ITEM.          48860000
448700     PERFORM 6105-READ-SEL-QUEUE.                                 48870000
448800                                                                  48880000
448900     PERFORM                                                      48890000
449000         VARYING PO012-IDX                                        48900000
449100         FROM 1 BY 1                                              48910000
449200         UNTIL ((PV-ITEMS-PROCESSED >                             48920000
449300                              PV-HOLD-SELECTED-ITEMS)             48930000
449400         OR (PO012-IDX GREATER THAN PO012-MAX-ITEMS))             48940000
449500         IF  PO012-ACTION-SW (PO012-IDX) > SPACE                  48950000
449600             PERFORM 6110-PROCESS-ITEMS                           48960000
449700         END-IF                                                   48970000
449800         ADD +1                    TO PV-ITEMS-PROCESSED          48980000
449900     END-PERFORM.                                                 48990000
450000                                                                  49000000
450100     PERFORM 6111-WRITE-LIST-QUEUE.                               49010000
450200                                                                  49020000
450300/                                                                 49030000
450400*----------------------------------------------------------------*49040000
450500*    READ THE LIST QUEUE RECORD.                                 *49050000
450600*----------------------------------------------------------------*49060000
450700                                                                  49070000
450800 6105-READ-SEL-QUEUE.                                             49080000
450900                                                                  49090000
451000     EXEC CICS                                                    49100000
451100          READQ TS                                                49110000
451200              QUEUE (ASC-SEL-QUEUE-NAME)                          49120000
451300              INTO  (PO012-PO-SELECT-RECORD)                      49130000
451400              ITEM  (PV-SEL-QUEUE-ITEM)                           49140000
451500              RESP  (PV-CICS-RESP)                                49150000
451600     END-EXEC.                                                    49160000
451700                                                                  49170000
451800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49180000
451900         CONTINUE                                                 49190000
452000     ELSE                                                         49200000
452100         SET DP013-CICS-ABEND      TO TRUE                        49210000
452200         SET DP013-NO-ROLLBACK     TO TRUE                        49220000
452300         MOVE '6105-READ-SEL-QUEUE'                               49230000
452400                                   TO DP013-PARAGRAPH             49240000
452500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           49250000
452600                                   TO DP013-MESSAGE-TEXT(1)       49260000
452700         PERFORM DP013-0000-PROCESS-ABEND                         49270000
452800     END-IF.                                                      49280000
452900                                                                  49290000
453000/                                                                 49300000
453100*----------------------------------------------------------------*49310000
453200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*49320000
453300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*49330000
453400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *49340000
453500*----------------------------------------------------------------*49350000
453600                                                                  49360000
453700 6110-PROCESS-ITEMS.                                              49370000
453800                                                                  49380000
453900     COMPUTE PV-ITEM = 1 + ((PO012-ITEM (PO012-IDX) - 1)          49390000
454000                     / PC-ITEMS-PER-PANEL).                       49400000
454100                                                                  49410000
454200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           49420000
454300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          49430000
454400             PERFORM 6111-WRITE-LIST-QUEUE                        49440000
454500         END-IF                                                   49450000
454600         MOVE PV-ITEM              TO PV-SAVE-ITEM                49460000
454700                                                                  49470000
454800         PERFORM 6112-READ-LIST-QUEUE                             49480000
454900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               49490000
455000             CONTINUE                                             49500000
455100         END-IF                                                   49510000
455200     END-IF.                                                      49520000
455300                                                                  49530000
455400     COMPUTE PV-SUB = (PO012-ITEM (PO012-IDX)                     49540000
455500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              49550000
455600                                                                  49560000
455700     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       49570000
455800     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        49580000
455900                                     (PV-SUB).                    49590000
456000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                49600000
456100                                                                  49610000
456200/                                                                 49620000
456300*----------------------------------------------------------------*49630000
456400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *49640000
456500*----------------------------------------------------------------*49650000
456600                                                                  49660000
456700 6111-WRITE-LIST-QUEUE.                                           49670000
456800                                                                  49680000
456900     EXEC CICS                                                    49690000
457000         WRITEQ TS                                                49700000
457100             QUEUE (ASC-LIST-QUEUE-NAME)                          49710000
457200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     49720000
457300             ITEM  (PV-SAVE-ITEM)                                 49730000
457400             REWRITE                                              49740000
457500             RESP  (PV-CICS-RESP)                                 49750000
457600     END-EXEC.                                                    49760000
457700                                                                  49770000
457800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49780000
457900         CONTINUE                                                 49790000
458000     ELSE                                                         49800000
458100         SET DP013-CICS-ABEND      TO TRUE                        49810000
458200         SET DP013-NO-ROLLBACK     TO TRUE                        49820000
458300         MOVE '6111-WRITE-LIST-QUEUE'                             49830000
458400                                   TO DP013-PARAGRAPH             49840000
458500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  49850000
458600                                   TO DP013-MESSAGE-TEXT(1)       49860000
458700         PERFORM DP013-0000-PROCESS-ABEND                         49870000
458800     END-IF.                                                      49880000
458900                                                                  49890000
459000/                                                                 49900000
459100*----------------------------------------------------------------*49910000
459200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*49920000
459300*----------------------------------------------------------------*49930000
459400                                                                  49940000
459500 6112-READ-LIST-QUEUE.                                            49950000
459600                                                                  49960000
459700     EXEC CICS                                                    49970000
459800         READQ TS                                                 49980000
459900             QUEUE (ASC-LIST-QUEUE-NAME)                          49990000
460000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     50000000
460100             ITEM  (PV-ITEM)                                      50010000
460200             RESP  (PV-CICS-RESP)                                 50020000
460300     END-EXEC.                                                    50030000
460400                                                                  50040000
460500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          50050000
460600         CONTINUE                                                 50060000
460700     ELSE                                                         50070000
460800         SET DP013-CICS-ABEND      TO TRUE                        50080000
460900         SET DP013-NO-ROLLBACK     TO TRUE                        50090000
461000         MOVE '6112-READ-LIST-QUEUE'                              50100000
461100                                   TO DP013-PARAGRAPH             50110000
461200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    50120000
461300                                   TO DP013-MESSAGE-TEXT(1)       50130000
461400         PERFORM DP013-0000-PROCESS-ABEND                         50140000
461500     END-IF.                                                      50150000
461600                                                                  50160000
461700/                                                                 50170000
461800*----------------------------------------------------------------*50180000
461900*    ABEND PROCESSOR MODULE                                      *50190000
462000*----------------------------------------------------------------*50200000
462100                                                                  50210000
462200     COPY DPPD013.                                                50220000
