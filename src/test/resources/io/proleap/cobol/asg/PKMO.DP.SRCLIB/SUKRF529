000100 IDENTIFICATION DIVISION.                                         00010002
000200                                                                  00020002
000300 PROGRAM-ID.             SUKRF529.                                00030002
000400 AUTHOR.                 LYNN MCADAMS.                            00040002
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050002
000600 DATE-WRITTEN.           MAY, 2000.                               00060002
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900*----------------------------------------------------------------*00090002
001000* THIS PROGRAM DISPLAYS THE TRIP START SCREEN ON THE LRT (LASER   00100002
001100* RADIO TERMINAL).  IT WILL ACCEPT THE ENTRY OF THE TRIP ID AND   00110002
001200* WILL EDIT THE TRIP ID.  IF THE TRIP ID IS VALID, THE USER CAN   00120002
001300* PRESS ENTER WHICH WILL TAKE THEM TO THE NEXT SCREEN WHICH IS    00130002
001400* THE TRAILER START SCREEN (SUKRF501).                            00140002
001500*----------------------------------------------------------------*00150002
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00152075
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00153075
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00154075
263968*---------------------------------------------------------------* 00155075
001600                                                                  00160002
001700 ENVIRONMENT DIVISION.                                            00170002
001800 DATA DIVISION.                                                   00180002
001900 WORKING-STORAGE SECTION.                                         00190002
002000*                                                                 00200002
002100 01  CA-COMMAREA.                                                 00210002
002200*----------------------------------------------------------------*00220002
002300*  COMMAREA LAYOUT FOR THE CARTON CHECK-IN RF SCREEN              00230002
002400*----------------------------------------------------------------*00240002
002500     COPY SUWS001.                                                00250002
002600                                                                  00260002
002700 01  CA-ERROR-COMMAREA.                                           00270002
002800     COPY SUWS006.                                                00280002
002900/                                                                 00290002
003000*    DL SYSTEM COMMAREA                                           00300002
003100     COPY DLWS010.                                                00310002
003200/                                                                 00320002
003300*    COMMAREAS FOR CALLED PROGRAMS                                00330002
003400*                                                                 00340002
003500*    DLKUP001 COMMAREA                                            00350002
003600     COPY DLWS001.                                                00360002
003700                                                                  00370002
003800*    DLKCS410 COMMAREA                                            00380002
003900     COPY DLWS016.                                                00390002
004000                                                                  00400002
004100*    XLKUP033 COMMAREA                                            00410002
004200     COPY XLWS072.                                                00420002
004300                                                                  00430002
004400*    TEMPLATE                                                     00440002
004500     COPY DLWS011.                                                00450002
004600                                                                  00460002
004700*    XLKUP033 DATA                                                00470002
004800     COPY SUWS050.                                                00480002
004900/                                                                 00490002
005000*----------------------------------------------------------------*00500002
005100*  DB2 KEYS                                                      *00510002
005200*----------------------------------------------------------------*00520002
005300 01  DK-DB2-KEYS.                                                 00530002
005400     05  DK-OPER-UNT-ID                  PIC  S9(4) COMP.         00540002
005500     05  DK-FCLTY-ID                     PIC  S9(4) VALUE +1      00550002
005600                                                    COMP.         00560002
005700                                                                  00570002
005800*----------------------------------------------------------------*00580002
005900*  PROGRAM CONSTANTS                                             *00590002
006000*----------------------------------------------------------------*00600002
006100 01  PC-PROGRAM-CONSTANTS.                                        00610002
006200     05  PC-TRANID                       PIC  X(04)  VALUE 'S529'.00620002
006300     05  PC-REPORT-SENT-MSG.                                      00630002
006400         10  FILLER                      PIC  X(10)  VALUE        00640002
006500             'RPTS SENT '.                                        00650002
006600         10  PC-MSG-PRTR-ID              PIC  X(08)  VALUE SPACES.00660002
006700                                                                  00670002
006800     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF529'.   00680002
006900     05  PC-SU-MENU-PGM             PIC X(08) VALUE 'SUKRF500'.   00690002
007000     05  PC-TRAILER-START-PGM       PIC X(08) VALUE 'SUKRF501'.   00700002
007100     05  PC-TRIP-ENTRY-PGM          PIC X(08) VALUE 'SUKRF529'.   00710002
007200     05  PC-TRAILER-STOP-PGM        PIC X(08) VALUE 'SUKRF503'.   00720002
007300     05  PC-ERROR-SCREEN            PIC X(08) VALUE 'SUKRF530'.   00730002
007400                                                                  00740002
007500*----------------------------------------------------------------*00750002
007600*   ERROR MESSAGES                                                00760002
007700*----------------------------------------------------------------*00770002
007800     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19)                     00780002
007900                                    VALUE  'DB2 ACCESS ERROR   '. 00790002
008000     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     00800002
008100                                    VALUE  'UNRECOGNIZED PF KEY'. 00810002
008200     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     00820002
008300                                    VALUE  'ENTER THROUGH MENU '. 00830002
008400     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     00840002
008500                                    VALUE  'TRANS NOT AVAILABLE'. 00850002
008600     05  PC-PLS-ENT-FLD-MSG         PIC X(19)                     00860002
008700                                    VALUE  'PLEASE ENTER FIELD '. 00870002
008800     05  PC-MUST-BE-NUM-MSG         PIC X(19)                     00880002
008900                                    VALUE  'MUST BE NUMERIC    '. 00890002
009000     05  PC-MUST-BE-GT-0-MSG        PIC X(19)                     00900002
009100                                    VALUE  'MUST BE > ZERO     '. 00910002
009200     05  PC-MUST-BE-PBS-MSG         PIC X(19)                     00920002
009300                                    VALUE  'RCVR NOT PK-BY-STR '. 00930002
009400     05  PC-STR-NOT-XCRIBED-MSG     PIC X(19)                     00940002
009500                                    VALUE  'STR NOT TRANSCRIBED'. 00950002
009600     05  PC-CICS-ERR-MSG            PIC X(19)                     00960002
009700                                    VALUE  'CICS ACCESS ERROR  '. 00970002
009800     05  PC-INVALID-TRIP            PIC X(19)                     00980002
009900                                    VALUE  'INVALID TRIP ID    '. 00990002
010000     05  PC-DUMMY-TRIP              PIC X(19)                     01000002
010100                                    VALUE  ' DUMMY TRIP ID     '. 01010002
010200     05  PC-TRIP-NOT-ARRIVED        PIC X(19)                     01020002
010300                                    VALUE  'TRAILER NOT AR     '. 01030002
010400     05  PC-NOT-AVAILABLE           PIC X(19)                     01040002
010500                                    VALUE 'T - NOT AVAILABLE  '.  01050002
010600     05  PC-PROMPT-OF-Y-OR-N        PIC X(19)                     01060002
010700                                    VALUE 'PROMPT MUST= Y OR N'.  01070002
010800                                                                  01080002
010900*----------------------------------------------------------------*01090002
011000* PROGRAM SWITCHES                                               *01100002
011100*----------------------------------------------------------------*01110002
011200 01  PS-PROGRAM-SWITCHES.                                         01120002
011300     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01130002
011400         88  PS-VALID-INPUT                          VALUE 'Y'.   01140002
011500         88  PS-INVALID-INPUT                        VALUE 'N'.   01150002
011600         88  PS-DUMMY-INPUT                          VALUE 'D'.   01160002
011700     05  PS-TRIP-SW                      PIC  X(01)  VALUE ' '.   01170002
011800         88  PS-VALID-TRIP-ID                        VALUE 'Y'.   01180002
011900         88  PS-INVALID-TRIP-ID                      VALUE 'N'.   01190002
012000         88  PS-DUMMY-TRIP-ID                        VALUE 'D'.   01200002
012100     05  PS-TRIP-STATUS-SW               PIC  X(01)  VALUE SPACE. 01210002
012200         88  PS-TRIP-DEPARTED-ENDED                  VALUE 'Y'.   01220002
012300         88  PS-TRIP-NOT-DEPARTED-ENDED              VALUE 'N'.   01230002
012400     05  PS-OPER-IS-ECOMM-DC-SW          PIC  X(01)  VALUE 'N'.   01240002
012500         88  PS-OPER-NOT-ECOMM-DC                    VALUE 'N'.   01250002
012600         88  PS-OPER-IS-ECOMM-DC                     VALUE 'Y'.   01260002
012700                                                                  01270002
012800     05  PS-VALID-P4-FACILITY-SW         PIC  X(01)  VALUE 'N'.   01280002
012900         88  PS-VALID-P4-FACILITY-NO                 VALUE 'N'.   01290002
013000         88  PS-VALID-P4-FACILITY-YES                VALUE 'Y'.   01300002
013100     05  PS-VALID-DOOR-SW             PIC X(01) VALUE 'Y'.        01310002
013200         88  PS-VALID-DOOR-NO                   VALUE 'N'.        01320002
013300         88  PS-VALID-DOOR-YES                  VALUE 'Y'.        01330002
013400     05  PS-DIFF-DOOR-SW              PIC X(01) VALUE 'N'.        01340002
013500         88  PS-DIFF-DOOR-YES                   VALUE 'Y'.        01350002
013600         88  PS-DIFF-DOOR-NO                    VALUE 'N'.        01360002
013610     05  PS-CREATE-MANUAL-ADD-SW      PIC X(01) VALUE 'N'.        01361061
013620         88  PS-CREATE-MAN-ADD-YES              VALUE 'Y'.        01362061
013630         88  PS-CREATE-MAN-ADD-NO               VALUE 'N'.        01363061
013700                                                                  01370002
013800*----------------------------------------------------------------*01380002
013900* PROGRAM VARIABLES                                              *01390002
014000*----------------------------------------------------------------*01400002
014100 01  PV-PROGRAM-VARIABLES.                                        01410002
014200     05  PV-CICS-MSG-AREA.                                        01420002
014300         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 01430002
014400         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 01440002
014500         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 01450002
014600         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 01460002
014700         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 01470002
014800         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 01480002
014900     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01490002
015000     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01500002
015100                                                     COMP SYNC.   01510002
015110     05  PV-CICS-RESP                    PIC S9(09)  VALUE ZEROS  01511025
015120                                                     COMP SYNC.   01512025
015200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01520002
015300                                                     COMP SYNC.   01530002
015400     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01540002
015500     05  PV-DISPLAY-OPER-UNT-ID          PIC  9(04)  VALUE ZERO.  01550002
015510     05  PV-DISPLAY-ARRIVED              PIC  9(04)  VALUE ZERO.  01551022
015600     05  PV-DISPLAY-SQLCODE              PIC -9(04)  VALUE ZERO.  01560013
015610     05  PV-DISPLAY-TRIP                 PIC  9(09)  VALUE ZERO.  01561014
015620     05  PV-DISPLAY-DEPART               PIC  Z(04) VALUE ZEROES. 01562017
015630     05  PV-DISPLAY-ASGMT-NBR-SEQ        PIC  9(09)  VALUE ZERO.  01563048
015700*                                                                 01570002
015800     05  PV-PROGRAM-DATA.                                         01580002
015900         10  PV-MANIFEST.                                         01590002
016000             15  PV-MANIFEST-N           PIC  9(11).              01600002
016100         10  PV-OPER-UNIT                PIC S9(09)  VALUE ZEROS. 01610002
016200         10  PV-PROMPT-IND               PIC X(01).               01620002
016300     05  PV-TIMESTAMP                    PIC X(26) VALUE SPACES.  01630002
016400                                                                  01640002
016500     05  PV-DOOR                     PIC X(04) VALUE SPACES.      01650002
016600     05  PV-P4-FLAG                  PIC X(01) VALUE SPACES.      01660002
016700     05  PV-NULL                     PIC S9(01) VALUE -1.         01670002
016800     05  PV-NULL-IND                 PIC S9(04) COMP VALUE ZEROES.01680002
016810     05  PV-ARRIVED-DC               PIC S9(04) COMP VALUE ZEROS. 01681016
016820     05  PV-TRIP-STATUS-TIMESTAMP    PIC  X(26).                  01682016
016830     05  PV-DEPART-DAYS              PIC S9(09) COMP VALUE ZEROS. 01683017
016840     05  PV-DEPART-TMST              PIC  X(26).                  01684014
016850     05  PV-CSSL-MSG-AREA            PIC  X(150) VALUE SPACES.    01685030
016900                                                                  01690002
017000     05  PV-START-TMST.                                           01700041
017001         10 PV-START-TMST-DATE.                                   01700141
017002             15 PV-START-TMST-YR      PIC 9(04).                  01700241
017003             15 PV-DASH-1             PIC X.                      01700341
017004             15 PV-START-TMST-MO      PIC 9(02).                  01700441
017005             15 PV-DASH-2             PIC X.                      01700541
017006             15 PV-START-TMST-DA      PIC 9(02).                  01700641
017007             15 PV-DASH-3             PIC X.                      01700741
017008         10 PV-START-TMST-TIME.                                   01700841
017009             15 PV-START-TMST-HR      PIC 9(02) VALUE ZEROES.     01700941
017010             15 PV-DEC-1              PIC X     VALUE '.'.        01701041
017011             15 PV-START-TMST-MN      PIC 9(02) VALUE ZEROES.     01701141
017012             15 PV-DEC-2              PIC X     VALUE '.'.        01701241
017013             15 PV-START-TMST-SS      PIC 9(02) VALUE ZEROES.     01701341
017014             15 PV-DEC-3              PIC X     VALUE '.'.        01701441
017015         10 PV-MILL-SEC               PIC 9(06) VALUE ZEROES.     01701541
017020 01  PV-LOG-MSG.                                                  01702024
017100     05  FILLER                       PIC X(12) VALUE             01710002
017200         ' S529 ERROR '.                                          01720002
017300           05  FILLER                 PIC X(06) VALUE             01730002
017400               'USER= '.                                          01740002
017500           05  PV-LOG-USER-ID         PIC X(08) VALUE SPACES.     01750002
017600           05  FILLER                 PIC X(10) VALUE             01760002
017700               ' SQLCODE= '.                                      01770002
017800           05  PV-SQLCODE             PIC -9(03).                 01780002
017900           05  FILLER                 PIC X(06) VALUE             01790002
018000               ' ERR= '.                                          01800002
018100           05  PV-ERROR-NBR           PIC 9(03) VALUE ZERO.       01810002
018200/                                                                 01820002
018300*                                                                 01830002
018400*----------------------------------------------------------------*01840002
018500*  GENERATED DSECT FOR THE SUKM529 MAPSET                         01850002
018600*----------------------------------------------------------------*01860002
018700     COPY SUKM529.                                                01870002
018800                                                                  01880002
018900*----------------------------------------------------------------*01890002
019000*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01900002
019100*----------------------------------------------------------------*01910002
019200     COPY DPWS010I.                                               01920002
019300                                                                  01930002
019400*----------------------------------------------------------------*01940002
019500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01950002
019600*----------------------------------------------------------------*01960002
019700     COPY DPWS013.                                                01970002
019800                                                                  01980002
019900*----------------------------------------------------------------*01990002
020000*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02000002
020100*----------------------------------------------------------------*02010002
020200     COPY DPWS015.                                                02020002
020300                                                                  02030002
020400*----------------------------------------------------------------*02040002
020500* HELP SCREEN COMMAREA                                            02050002
020600     COPY PCWS192.                                                02060002
020700*----------------------------------------------------------------*02070002
020800* HELP SCREEN WORK AREA                                           02080002
020900     COPY PCWS188.                                                02090002
021000                                                                  02100002
021100*----------------------------------------------------------------*02110002
021200*  WORKING STORAGE AREA FOR NON-ARCHITECTURE PROGRAMS             02120002
021300*----------------------------------------------------------------*02130002
021400     COPY DPWS026.                                                02140002
021500                                                                  02150002
021600*----------------------------------------------------------------*02160002
021700*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02170002
021800*----------------------------------------------------------------*02180002
021900     COPY DFHAID.                                                 02190002
022000                                                                  02200002
022100*---------------------------------------------------------------* 02210002
022200*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 02220002
022300*---------------------------------------------------------------* 02230002
022400     EXEC SQL                                                     02240002
022500          INCLUDE TTRIPST                                         02250002
022600     END-EXEC.                                                    02260002
022700                                                                  02270002
022800*---------------------------------------------------------------* 02280002
022900*    DB2 AREA FOR THE TRIP STATUS CODE TABLE                    * 02290002
023000*---------------------------------------------------------------* 02300002
023100     EXEC SQL                                                     02310002
023200          INCLUDE TTRSTYP                                         02320002
023300     END-EXEC.                                                    02330002
023400                                                                  02340002
023500*---------------------------------------------------------------* 02350002
023600*    DB2 AREA FOR THE RECEIVING SYSTEM PARM TABLE               * 02360002
023700*---------------------------------------------------------------* 02370002
023800     EXEC SQL                                                     02380002
023900         INCLUDE TKRPRPM                                          02390002
024000     END-EXEC.                                                    02400002
024100                                                                  02410002
024200*    XLT_LOC LOCATION MASTER                                      02420002
024300     EXEC SQL                                                     02430002
024400         INCLUDE XLT00010                                         02440002
024500     END-EXEC.                                                    02450002
024600/                                                                 02460002
024700*    SUT_INBD_TRIP_DOOR                                           02470002
024800     EXEC SQL                                                     02480002
024900         INCLUDE SUT00040                                         02490002
025000     END-EXEC.                                                    02500002
025100/                                                                 02510002
025200*    DC DOOR MASTER                                               02520002
025300     EXEC SQL                                                     02530002
025400         INCLUDE TCNDCDR                                          02540002
025500     END-EXEC.                                                    02550002
025600                                                                  02560002
025700*                                                                 02570002
025800     EXEC SQL                                                     02580002
025900         INCLUDE TVHTRIP                                          02590002
026000     END-EXEC.                                                    02600002
026100                                                                  02610044
026110*                                                                 02611043
026120     EXEC SQL                                                     02612043
026130         INCLUDE DLT00003                                         02613043
026140     END-EXEC.                                                    02614043
026150                                                                  02615043
026160*                                                                 02616050
026170     EXEC SQL                                                     02617050
026180         INCLUDE DLT00004                                         02618050
026190     END-EXEC.                                                    02619050
026191                                                                  02619150
026200*---------------------------------------------------------------* 02620002
026300*  COMMUNICATIONS AREA FOR DB2                                    02630002
026400*---------------------------------------------------------------* 02640002
026500     EXEC SQL                                                     02650002
026600         INCLUDE SQLCA                                            02660002
026700     END-EXEC.                                                    02670002
026800                                                                  02680002
026900 LINKAGE SECTION.                                                 02690002
027000 01  DFHCOMMAREA.                                                 02700002
027100     05  FILLER                       OCCURS 1 TO 4072 TIMES      02710002
027200                                      DEPENDING ON EIBCALEN.      02720002
027300         10  FILLER                   PIC X.                      02730002
027400                                                                  02740002
027500 PROCEDURE DIVISION.                                              02750002
027600                                                                  02760002
027700 0000-MAINLINE.                                                   02770002
027800     IF EIBTRNID = 'D456'                                         02780002
027900         MOVE DFHCOMMAREA             TO DL010-COMMAREA           02790002
028000         MOVE DL010-HOST-SAVE-AREA    TO CA-COMMAREA              02800002
028100     ELSE                                                         02810002
028200         INITIALIZE DL010-COMMAREA                                02820002
028300         MOVE 'MPKCS027'              TO DL010-MENU-PROGRAM       02830002
028400         MOVE 'SUKRF529'              TO DL010-ROOT-PROGRAM       02840002
028500         MOVE 'S529'                  TO DL010-TRAN-ID            02850002
028600         MOVE DFHCOMMAREA             TO CA-COMMAREA              02860002
028700                                         CA-ERROR-COMMAREA        02870002
028800         MOVE SU001-DOOR-ID           TO DL010-DOOR-ID            02880002
028900                                         ADOORO                   02890002
029000         MOVE SU001-P4-PROMPT-FLAG    TO AP4O                     02900002
029100         MOVE SU001-MANIFEST          TO DL010-TRIP-ID            02910002
029200     END-IF                                                       02920002
029300                                                                  02930002
029400                                                                  02940002
029500     IF SU001-CURR-OPER-UNT-ID = ZERO                             02950002
029600         PERFORM DP026-0000-GET-LOGON-INFO                        02960002
029700         MOVE DP026-LOCATION-NBR  TO SU001-CURR-OPER-UNT-ID       02970002
029800                                     DK-OPER-UNT-ID               02980002
029900         MOVE DP026-USERID     TO SU001-USER-ID                   02990002
030000         PERFORM 7050-SELECT-TKRPRPM-FLOWBACK                     03000007
030100     ELSE                                                         03010002
030200         MOVE SU001-CURR-OPER-UNT-ID                              03020002
030300                               TO DK-OPER-UNT-ID                  03030002
030400     END-IF                                                       03040002
030500                                                                  03050002
030600     IF SU001-ECOMM-DC-SW NOT = 'N' AND NOT = 'Y'                 03060002
030700         PERFORM 7005-CHECK-IF-DC                                 03070002
030800     END-IF                                                       03080002
030900                                                                  03090002
031000     EVALUATE TRUE                                                03100002
031100         WHEN EIBCALEN = ZERO                                     03110002
031200             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    03120002
031300             PERFORM 8300-RETURN                                  03130002
031400                                                                  03140002
031500****************************************************************  03150002
031600* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        03160002
031700****************************************************************  03170002
031800         WHEN EIBTRNID = 'Z278'                                   03180002
031900             MOVE DFHCOMMAREA          TO PC192-COMMAREA          03190002
032000             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             03200002
032100             MOVE PC192-HOST-SAVE-MAP  TO SU529AO                 03210002
032200             SET SU001-PROCESS-SCREEN  TO TRUE                    03220002
032300             PERFORM 1100-GET-PROMT-IND                           03230002
032400             IF SU001-ECOMM-DC-YES                                03240002
032500                 MOVE SPACES        TO  APROMPTO                  03250002
032600                                        PV-PROMPT-IND             03260002
032700                 MOVE SPACES        TO APRTMSGO                   03270002
032800                 MOVE DP015-ASK-DRK-OFF                           03280002
032900                                    TO APROMPTA                   03290002
033000                 MOVE DP015-HL-OFF                                03300002
033100                                    TO APROMPTH                   03310002
033200             ELSE                                                 03320002
033300                 MOVE SU001-PROMPT-IND                            03330002
033400                                    TO  APROMPTO                  03340002
033500                                        PV-PROMPT-IND             03350002
033600                 MOVE 'AUDIT PROMPTNG?'                           03360002
033700                                    TO APRTMSGO                   03370002
033800             END-IF                                               03380002
033900             PERFORM 1000-INITIALIZE                              03390002
034000             IF SU001-RPT-REQUESTED                               03400002
034100                 MOVE SU001-PRINTER-ID       TO PC-MSG-PRTR-ID    03410002
034200                 MOVE PC-REPORT-SENT-MSG     TO AMSGLNO           03420002
034300                 MOVE SPACES  TO  SU001-REPORT-REQUEST-SW         03430002
034400             END-IF                                               03440002
034500             PERFORM 8000-SEND-MAP                                03450002
034600             PERFORM 8020-RETURN-TRANID                           03460002
034700                                                                  03470002
034800         WHEN EIBAID = DFHPF3                                     03480002
034900*                                                                 03490002
035000              IF SU001-LAST-PROGRAM = PC-TRAILER-START-PGM OR     03500002
035100                                      PC-TRAILER-STOP-PGM OR      03510002
035200                 (SU001-LAST-PROGRAM =  PC-ERROR-SCREEN AND       03520002
035300                             SU001-FREE-ASTRY-TRIP-MESS)          03530002
035400                 IF SU001-P4-YES                                  03540002
035500                     SET SU001-WAIT-FOR-KEY-ENTRY TO TRUE         03550002
035600                 ELSE                                             03560002
035700                     SET SU001-PROCESS-SCREEN TO TRUE             03570002
035800                 END-IF                                           03580002
035900                 PERFORM 1000-INITIALIZE                          03590002
036000                 PERFORM 1100-GET-PROMT-IND                       03600002
036100                 IF SU001-ECOMM-DC-YES                            03610002
036200                     MOVE SPACES        TO  APROMPTO              03620002
036300                                            PV-PROMPT-IND         03630002
036400                     MOVE SPACES        TO APRTMSGO               03640002
036500                     MOVE DP015-ASK-DRK-OFF                       03650002
036600                                        TO APROMPTA               03660002
036700                     MOVE DP015-HL-OFF                            03670002
036800                                        TO APROMPTH               03680002
036900                 ELSE                                             03690002
037000                     MOVE SU001-PROMPT-IND                        03700002
037100                                        TO  APROMPTO              03710002
037200                                            PV-PROMPT-IND         03720002
037300                     MOVE 'AUDIT PROMPTNG?'                       03730002
037400                                        TO APRTMSGO               03740002
037500                 END-IF                                           03750002
037600                 MOVE SU001-P4-PROMPT-FLAG TO AP4O                03760002
037700                 PERFORM 8000-SEND-MAP                            03770002
037800                 PERFORM 8020-RETURN-TRANID                       03780002
037900                                                                  03790002
038000              ELSE                                                03800002
038100*                STAY HERE IF RETURNING FROM DL ERROR SCREEN      03810002
038200                 IF EIBTRNID = 'D456'                             03820002
038300                     PERFORM 0002-REBUILD-MAP-FROM-DL             03830002
038400                     PERFORM 8000-SEND-MAP                        03840002
038500                     PERFORM 8020-RETURN-TRANID                   03850002
038600                 ELSE                                             03860002
038700                     MOVE PC-SU-MENU-PGM                          03870002
038800                                   TO PV-TRANSFER-PROGRAM         03880002
038900                     PERFORM 8120-XCTL-LRT-MENU                   03890002
039000                 END-IF                                           03900002
039100              END-IF                                              03910002
039200                                                                  03920002
039300         WHEN SU001-INITIALIZE-SCREEN                             03930002
039400         WHEN EIBAID = DFHCLEAR                                   03940002
039500*IF RETURNING FROM THE MESSAGE SCREEN, SAVE THE PREV ENTERED      03950002
039600*PROMPT INDICATOR                                                 03960002
039700                                                                  03970002
039800             IF EIBTRNID = 'S530'                                 03980002
039900                 CONTINUE                                         03990002
040000             ELSE                                                 04000002
040100                PERFORM 1100-GET-PROMT-IND                        04010002
040200                PERFORM 1105-VALIDATE-P4-FACILITY                 04020002
040300             END-IF                                               04030002
040400                                                                  04040002
040500             IF SU001-ECOMM-DC-YES                                04050002
040600                 MOVE SPACES        TO  APROMPTO                  04060002
040700                                        PV-PROMPT-IND             04070002
040800                 MOVE SPACES        TO APRTMSGO                   04080002
040900                 MOVE DP015-ASK-DRK-OFF                           04090002
041000                                    TO APROMPTA                   04100002
041100                 MOVE DP015-HL-OFF                                04110002
041200                                    TO APROMPTH                   04120002
041300             ELSE                                                 04130002
041400                 MOVE SU001-PROMPT-IND                            04140002
041500                                    TO  APROMPTO                  04150002
041600                                        PV-PROMPT-IND             04160002
041700                 MOVE 'AUDIT PROMPTNG?'                           04170002
041800                                    TO APRTMSGO                   04180002
041900             END-IF                                               04190002
042000             IF EIBTRNID = 'S530' AND                             04200002
042100                (SU001-STAT-WARNG-MESSGE-DEP OR                   04210002
042200                  SU001-STAT-WARNG-MESSGE-DEP)                    04220002
042300                 INITIALIZE PV-PROGRAM-DATA                       04230002
042400                 MOVE SU001-MANIFEST    TO  AMANIFSTO             04240002
042500                                            PV-MANIFEST-N         04250002
042600                                            DL010-TRIP-ID         04260002
042700                 IF SU001-P4-YES                                  04270002
042800                     PERFORM 7020-SELECT-INBD-TRIP-DOOR           04280002
042900                 ELSE                                             04290002
043000                     MOVE DP015-ASK-DRK-OFF       TO ADOORA       04300002
043100                                                     AP4A         04310002
043200                     MOVE DP015-HL-OFF            TO ADOORH       04320002
043300                                                     AP4H         04330002
043400                 END-IF                                           04340002
043500                 MOVE -1                TO  AMANIFSTL             04350002
043600                 MOVE 'F2-CNFM USE DP TRIP' TO  AKEYLNO           04360002
043700                 MOVE PC-CURRENT-PROGRAM-NAME                     04370002
043800                                        TO SU001-LAST-PROGRAM     04380002
043900                 SET SU001-WAIT-FOR-CONFIRMATION                  04390002
044000                                        TO TRUE                   04400002
044001                 PERFORM 8000-SEND-MAP                            04400134
044002                 PERFORM 8020-RETURN-TRANID                       04400234
044003                                                                  04400334
044004*** DMH - 11-21-2008 - BEGIN                                      04400438
044300             ELSE                                                 04430002
044301             IF EIBTRNID = 'S530' AND                             04430138
044310                (SU001-DEPARTED-DIFF-DC    OR                     04431038
044320                 SU001-DEPARTED-AFTER-DAYS)                       04432038
044330                 INITIALIZE PV-PROGRAM-DATA                       04433038
044340                 MOVE SU001-MANIFEST        TO  AMANIFSTO         04434040
044350                                                PV-MANIFEST-N     04435040
044360                                                DL010-TRIP-ID     04436040
044370                 MOVE -1                    TO  AMANIFSTL         04437040
044380                 MOVE 'DEPARTED-CANT USE  ' TO  AKEYLNO           04438038
044390                 MOVE PC-CURRENT-PROGRAM-NAME                     04439038
044391                                        TO SU001-LAST-PROGRAM     04439138
044392                 SET SU001-PROCESS-SCREEN   TO  TRUE              04439240
044394                 PERFORM 8000-SEND-MAP                            04439438
044395                 PERFORM 8020-RETURN-TRANID                       04439538
044396*** DMH - 11-21-2008 - END                                        04439638
044397                                                                  04439738
044398             ELSE                                                 04439838
044400                 IF SU001-P4-YES                                  04440002
044500                     SET SU001-WAIT-FOR-KEY-ENTRY TO TRUE         04450002
044600                 ELSE                                             04460002
044700                     SET SU001-PROCESS-SCREEN TO TRUE             04470002
044800                END-IF                                            04480002
044900                 PERFORM 1000-INITIALIZE                          04490002
045000             END-IF                                               04500002
045010             END-IF                                               04501038
045100                                                                  04510002
045200**GB                                                              04520002
045300              IF SU001-RPT-REQUESTED                              04530002
045400                  MOVE SU001-PRINTER-ID       TO PC-MSG-PRTR-ID   04540002
045500                  MOVE PC-REPORT-SENT-MSG     TO AMSGLNO          04550002
045600                  MOVE SPACES  TO  SU001-REPORT-REQUEST-SW        04560002
045700              END-IF                                              04570002
045800**GB                                                              04580002
045900              PERFORM 8000-SEND-MAP                               04590002
046000              PERFORM 8020-RETURN-TRANID                          04600002
046100                                                                  04610002
046200         WHEN EIBAID = DFHENTER                                   04620002
046300             EVALUATE TRUE                                        04630002
046400             WHEN SU001-WAIT-FOR-CONFIRMATION                     04640002
046500                 INITIALIZE PV-PROGRAM-DATA                       04650002
046600                 MOVE SU001-MANIFEST    TO  AMANIFSTO             04660002
046700                                            PV-MANIFEST-N         04670002
046800                                            DL010-TRIP-ID         04680002
046900                 IF SU001-ECOMM-DC-YES                            04690002
047000                     MOVE SPACES        TO  APROMPTO              04700002
047100                                            PV-PROMPT-IND         04710002
047200                     MOVE DP015-ASK-DRK-OFF                       04720002
047300                                        TO APROMPTA               04730002
047400                     MOVE DP015-HL-OFF                            04740002
047500                                        TO APROMPTH               04750002
047600                 ELSE                                             04760002
047700                     MOVE SU001-PROMPT-IND                        04770002
047800                                        TO  APROMPTO              04780002
047900                                            PV-PROMPT-IND         04790002
048000                 END-IF                                           04800002
048100                 MOVE -1                TO  AMANIFSTL             04810002
048200                 MOVE 'F2-CNFM USE DP TRIP' TO  AKEYLNO           04820002
048300                 MOVE 'PRESS F2 TO CONT.  ' TO  AMSGLNO           04830002
048400                 MOVE PC-CURRENT-PROGRAM-NAME                     04840002
048500                                        TO SU001-LAST-PROGRAM     04850002
048600                 SET SU001-WAIT-FOR-CONFIRMATION                  04860002
048700                                        TO TRUE                   04870002
048800                 PERFORM 8000-SEND-MAP                            04880002
048900                 PERFORM 8020-RETURN-TRANID                       04890002
049000                                                                  04900002
049100             WHEN SU001-WAIT-FOR-KEY-ENTRY                        04910002
049200                 PERFORM 2000-PROCESS-SCREEN-FIELDS               04920002
049300                 PERFORM 7020-SELECT-INBD-TRIP-DOOR               04930002
049400                 IF SU001-DOOR-ID = SPACES                        04940002
049500                     MOVE DL010-OLD-DOOR-ID                       04950002
049600                                      TO SU001-DOOR-ID            04960002
049700                                         ADOORO                   04970002
049800                                         PV-DOOR                  04980002
049900                 END-IF                                           04990002
050000                 SET SU001-PROCESS-SCREEN                         05000002
050100                                      TO TRUE                     05010002
050200*                IF AMANIFSTL = ZERO                              05020002
050300                     MOVE -1          TO AMANIFSTL                05030002
050400*                END-IF                                           05040002
050500                 PERFORM 8000-SEND-MAP                            05050002
050600                 PERFORM 8020-RETURN-TRANID                       05060002
050700                                                                  05070002
050740                                                                  05074035
050800             WHEN OTHER                                           05080002
050900                 IF EIBTRNID = 'D456'                             05090002
051000                     PERFORM 0002-REBUILD-MAP-FROM-DL             05100002
051100                     PERFORM 8000-SEND-MAP                        05110002
051200                     PERFORM 8020-RETURN-TRANID                   05120002
051300                 END-IF                                           05130002
051400                                                                  05140002
051500                 SET PS-VALID-INPUT TO TRUE                       05150002
051600                 PERFORM 2000-PROCESS-SCREEN-FIELDS               05160002
051700                                                                  05170002
051800                 IF PS-VALID-INPUT                                05180002
051900                     IF PS-TRIP-DEPARTED-ENDED                    05190002
052000                         MOVE PC-ERROR-SCREEN                     05200002
052100                                        TO PV-TRANSFER-PROGRAM    05210002
052200                         MOVE TRIPST-TRIP-ID                      05220002
052300                                        TO SU001-MANIFEST         05230002
052400                                           DL010-TRIP-ID          05240002
052500                         PERFORM 8120-XCTL-LRT-MENU               05250002
052600                     ELSE                                         05260002
052700                                                                  05270002
052800                         IF SU001-WAIT-FOR-KEY-ENTRY              05280002
052900                             SET SU001-PROCESS-SCREEN TO TRUE     05290002
053000                         ELSE                                     05300002
053100*                        PROCESS LABOR B/4 LEAVING                05310002
053200                         IF SU001-P4-YES                          05320002
053300                             PERFORM 5000-DL-WORK                 05330002
053400                         END-IF                                   05340002
053500                                                                  05350002
053600                         PERFORM 8200-SYNCPOINT                   05360002
053700                                                                  05370002
053800                         MOVE ZEROS     TO SU001-BATCH-NUMBER     05380002
053900                                                                  05390002
054000                         IF SU001-P4-PROMPT-FLAG = 'Y'            05400002
054100                             PERFORM 8130-XCTL-P4-SYSTEM          05410002
054200                         ELSE                                     05420002
054300                             MOVE PC-TRAILER-START-PGM            05430002
054400                                        TO PV-TRANSFER-PROGRAM    05440002
054500*                           (SUKRF501)                            05450002
054600                             PERFORM 8120-XCTL-LRT-MENU           05460002
054700                         END-IF                                   05470002
054800                     END-IF                                       05480002
054900                                                                  05490002
055000                 ELSE                                             05500002
055100                     PERFORM 8010-SEND-DATA-ONLY                  05510002
055200                     PERFORM 8020-RETURN-TRANID                   05520002
055300                 END-IF                                           05530002
055400             END-EVALUATE                                         05540002
055500                                                                  05550002
055600         WHEN EIBAID = DFHPF2                                     05560002
055700                                                                  05570002
055800             IF SU001-WAIT-FOR-CONFIRMATION                       05580002
055900                 SET SU001-TRIP-CONFIRMED TO TRUE                 05590002
056000                 IF SU001-P4-YES                                  05600002
056100                     PERFORM 7020-SELECT-INBD-TRIP-DOOR           05610002
056200                     PERFORM 5000-DL-WORK                         05620002
056300                 END-IF                                           05630002
056400                                                                  05640002
056500                 IF SU001-P4-PROMPT-FLAG = 'Y'                    05650002
056600                     PERFORM 8130-XCTL-P4-SYSTEM                  05660002
056700                 ELSE                                             05670002
056800                     PERFORM 1000-INITIALIZE                      05680002
056900                     IF PS-VALID-INPUT                            05690002
057000                         MOVE ZEROS     TO SU001-BATCH-NUMBER     05700002
057100                         MOVE PC-TRAILER-START-PGM                05710002
057200                                        TO PV-TRANSFER-PROGRAM    05720002
057300                         PERFORM 8120-XCTL-LRT-MENU               05730002
057400                     ELSE                                         05740002
057500                         PERFORM 8010-SEND-DATA-ONLY              05750002
057600                         PERFORM 8020-RETURN-TRANID               05760002
057700                     END-IF                                       05770002
057800                 END-IF                                           05780002
057900                                                                  05790002
058000             ELSE                                                 05800002
058100                                                                  05810002
058200*                THE DOOR CHANGE WAS CONFIRMED                    05820002
058300*                DO THE ASSIGNMENT WORK THEN PROCEED NORMALLY     05830002
058400                                                                  05840002
058500*                BUT FIRST CONFIRM USE OF DEPARTED/ENDED TRAILER  05850002
058600                 IF SU001-TRIP-NOT-CONFIRMED                      05860002
058700                     MOVE PC-ERROR-SCREEN                         05870002
058800                                        TO PV-TRANSFER-PROGRAM    05880002
058900                     PERFORM 8120-XCTL-LRT-MENU                   05890002
059000                 END-IF                                           05900002
059100                                                                  05910002
059200                 IF DL010-UPDATE-CONFIRMED                        05920002
059300                     IF SU001-P4-YES                              05930002
059400                         PERFORM 0001-DOOR-CONFIRM                05940002
059500                         IF SU001-P4-PROMPT-FLAG = 'Y'            05950002
059600                             PERFORM 8130-XCTL-P4-SYSTEM          05960002
059700                         END-IF                                   05970002
059800                     END-IF                                       05980002
059900                     PERFORM 1000-INITIALIZE                      05990002
060000                     IF PS-VALID-INPUT                            06000002
060100                         MOVE ZEROS   TO SU001-BATCH-NUMBER       06010002
060200                         MOVE PC-TRAILER-START-PGM                06020002
060300                                      TO PV-TRANSFER-PROGRAM      06030002
060400                         PERFORM 8120-XCTL-LRT-MENU               06040002
060500                     ELSE                                         06050002
060600                         MOVE -1          TO  AMANIFSTL           06060002
060700                         PERFORM 8010-SEND-DATA-ONLY              06070002
060800                         PERFORM 8020-RETURN-TRANID               06080002
060900                     END-IF                                       06090002
061000                 END-IF                                           06100002
061100             END-IF                                               06110002
061200                                                                  06120002
061300         WHEN EIBAID = DFHPF1                                     06130002
061400              PERFORM 1400-HELP-SCREEN                            06140002
061500                                                                  06150002
061600         WHEN OTHER                                               06160002
061700              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          06170002
061800              PERFORM 8010-SEND-DATA-ONLY                         06180002
061900              PERFORM 8020-RETURN-TRANID                          06190002
062000     END-EVALUATE.                                                06200002
062100                                                                  06210002
062200     GOBACK.                                                      06220002
062300 0001-DOOR-CONFIRM.                                               06230002
062400                                                                  06240002
062500     PERFORM 5000-DL-WORK.                                        06250002
062600                                                                  06260002
062700 0002-REBUILD-MAP-FROM-DL.                                        06270002
062800     MOVE SU001-MANIFEST              TO AMANIFSTO                06280002
062900                                         PV-MANIFEST-N            06290002
063000                                         DL010-TRIP-ID            06300002
063100     MOVE -1                          TO  AMANIFSTL               06310002
063200     IF DL010-OLD-DOOR-ID = SPACES                                06320002
063300         MOVE SU001-DOOR-ID           TO ADOORO                   06330002
063400     ELSE                                                         06340002
063500         MOVE DL010-OLD-DOOR-ID       TO ADOORO                   06350002
063600     END-IF                                                       06360002
063700     IF SU001-ECOMM-DC-YES                                        06370002
063800         MOVE SPACES                  TO  APROMPTO                06380002
063900                                          PV-PROMPT-IND           06390002
064000         MOVE SPACES                  TO APRTMSGO                 06400002
064100         MOVE DP015-ASK-DRK-OFF       TO APROMPTA                 06410002
064200         MOVE DP015-HL-OFF            TO APROMPTH                 06420002
064300     ELSE                                                         06430002
064400         MOVE SU001-PROMPT-IND        TO  APROMPTO                06440002
064500                                            PV-PROMPT-IND         06450002
064600         MOVE 'AUDIT PROMPTNG?'       TO APRTMSGO                 06460002
064700     END-IF.                                                      06470002
064800     IF SU001-P4-NO                                               06480002
064900         MOVE DP015-ASK-DRK-OFF       TO ADOORA                   06490002
065000                                         AP4A                     06500002
065100         MOVE DP015-HL-OFF            TO ADOORH                   06510002
065200                                         AP4H                     06520002
065300     ELSE                                                         06530002
065400         MOVE 'N'                     TO AP4O                     06540008
065500                                         SU001-P4-PROMPT-FLAG     06550002
065600     END-IF.                                                      06560002
065700*                                                                 06570002
065800 1000-INITIALIZE.                                                 06580002
065900                                                                  06590002
066000     IF SU001-WAIT-FOR-CONFIRMATION                               06600002
066100         SET SU001-PROCESS-SCREEN                                 06610002
066200             SU001-TRIP-CONFIRMED TO TRUE                         06620002
066300         MOVE DP015-PRO-NOR-OFF  TO  AMANIFSTA                    06630002
066400         MOVE -1                 TO  AMANIFSTL                    06640002
066500         COMPUTE PV-MANIFEST-N = SU001-MANIFEST * 1               06650002
066600                                                                  06660002
066700         MOVE PV-MANIFEST-N      TO  AMANIFSTO                    06670002
066800         IF SU001-ECOMM-DC-YES                                    06680002
066900             MOVE SPACES             TO  APROMPTO                 06690002
067000             MOVE DP015-ASK-DRK-OFF  TO  APROMPTA                 06700002
067100             MOVE DP015-HL-OFF       TO APROMPTH                  06710002
067200         ELSE                                                     06720002
067300             MOVE SU001-PROMPT-IND   TO  APROMPTO                 06730002
067400         END-IF                                                   06740002
067500     ELSE                                                         06750002
067600         IF SU001-LAST-PROGRAM = PC-SU-MENU-PGM OR                06760002
067700            SU001-LAST-PROGRAM = PC-TRIP-ENTRY-PGM OR             06770002
067800            SU001-LAST-PROGRAM = PC-TRAILER-START-PGM OR          06780002
067900            SU001-LAST-PROGRAM = PC-TRAILER-STOP-PGM OR           06790002
068000            (SU001-LAST-PROGRAM =  PC-ERROR-SCREEN AND            06800002
068100             SU001-FREE-ASTRY-TRIP-MESS) OR                       06810002
068200            (SU001-LAST-PROGRAM =  PC-ERROR-SCREEN AND            06820002
068300             SU001-ASGMT-CLOSED-RETURN)                           06830002
068400             INITIALIZE PV-PROGRAM-DATA                           06840002
068500             MOVE ZEROES            TO  AMANIFSTO                 06850002
068600                                        DL010-TRIP-ID             06860002
068700             MOVE SPACES            TO  ADOORO                    06870002
068800                                        DL010-DOOR-ID             06880002
068900                                        DL010-OLD-DOOR-ID         06890002
069000                                        SU001-DOOR-ID             06900002
069100             MOVE -1                TO  AMANIFSTL                 06910002
069200             IF SU001-ECOMM-DC-YES                                06920002
069300                 MOVE SPACES            TO  APROMPTO              06930002
069400                 MOVE DP015-ASK-DRK-OFF TO  APROMPTA              06940002
069500                 MOVE DP015-HL-OFF      TO  APROMPTH              06950002
069600             ELSE                                                 06960002
069700                 MOVE SU001-PROMPT-IND  TO  APROMPTO              06970002
069800             END-IF                                               06980002
069900         ELSE                                                     06990002
070000             MOVE DP015-PRO-NOR-OFF     TO  AMANIFSTA             07000002
070100             MOVE -1                    TO  AMANIFSTL             07010002
070200             COMPUTE PV-MANIFEST-N = SU001-MANIFEST * 1           07020002
070300                                                                  07030002
070400             MOVE PV-MANIFEST-N         TO  AMANIFSTO             07040002
070500             IF SU001-ECOMM-DC-YES                                07050002
070600                 MOVE SPACES            TO  APROMPTO              07060002
070700                 MOVE DP015-ASK-DRK-OFF TO  APROMPTA              07070002
070800                 MOVE DP015-HL-OFF      TO  APROMPTH              07080002
070900             ELSE                                                 07090002
071000                 MOVE SU001-PROMPT-IND  TO  APROMPTO              07100002
071100             END-IF                                               07110002
071200         END-IF                                                   07120002
071300     END-IF.                                                      07130002
071400*                                                                 07140002
071500     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          07150002
071600     PERFORM 1105-VALIDATE-P4-FACILITY.                           07160002
071700                                                                  07170002
071800 1100-GET-PROMT-IND.                                              07180002
071900     MOVE SU001-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID.              07190002
072000     PERFORM 7000-SELECT-TKRPRPM.                                 07200002
072100     IF SU001-ECOMM-DC-YES                                        07210002
072200         MOVE SPACES            TO  APROMPTO                      07220002
072300         MOVE DP015-ASK-DRK-OFF TO  APROMPTA                      07230002
072400         MOVE DP015-HL-OFF      TO  APROMPTH                      07240002
072500         MOVE 'N'               TO  SU001-PROMPT-IND              07250002
072600     ELSE                                                         07260002
072700         MOVE PV-PROMPT-IND     TO  APROMPTO                      07270002
072800                                    SU001-PROMPT-IND              07280002
072900     END-IF.                                                      07290002
073000                                                                  07300002
073100 1105-VALIDATE-P4-FACILITY.                                       07310002
073200     MOVE SU001-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID.              07320002
073300     PERFORM 7010-SELECT-TKRPRPM.                                 07330002
073400     IF SU001-P4-NO                                               07340002
073500         MOVE DP015-ASK-DRK-OFF       TO ADOORA                   07350002
073600                                         AP4A                     07360002
073700         MOVE DP015-HL-OFF            TO ADOORH                   07370002
073800                                         AP4H                     07380002
073900     ELSE                                                         07390002
074000         MOVE 'N'                     TO AP4O                     07400008
074100                                         SU001-P4-PROMPT-FLAG     07410002
074200     END-IF.                                                      07420002
074300*                                                                 07430002
074400 1400-HELP-SCREEN.                                                07440002
074500     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      07450002
074600     MOVE 'SUKRF529'                  TO PC192-PROGRAM-NAME       07460002
074700     COPY PCPD188.                                                07470002
074800     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      07480002
074900     PERFORM 8030-RECEIVE-MAP                                     07490002
075000     MOVE SU529AO                     TO PC192-HOST-SAVE-MAP      07500002
075100     PERFORM 8100-XCTL-TO-HELP.                                   07510002
075200*                                                                 07520002
075300 2000-PROCESS-SCREEN-FIELDS.                                      07530002
075400                                                                  07540002
075500     PERFORM 8030-RECEIVE-MAP.                                    07550002
075600     PERFORM 2110-RECEIVE-SCREEN-FIELDS                           07560002
075700     PERFORM 2200-EDIT-INPUT.                                     07570002
075800*                                                                 07580002
075900 2110-RECEIVE-SCREEN-FIELDS.                                      07590002
076000                                                                  07600002
076100     IF  AMANIFSTL > ZERO                                         07610002
076200         MOVE AMANIFSTI TO PV-MANIFEST                            07620002
076300     ELSE                                                         07630002
076400         IF AMANIFSTA = DP015-ERASE-EOF                           07640002
076500             MOVE SPACES TO PV-MANIFEST                           07650002
076600         END-IF                                                   07660002
076700     END-IF.                                                      07670002
076800*                                                                 07680002
076900     IF  APROMPTL > ZERO                                          07690002
077000         MOVE APROMPTI  TO PV-PROMPT-IND                          07700002
077100     ELSE                                                         07710002
077200         IF APROMPTA = DP015-ERASE-EOF                            07720002
077300             MOVE SPACES TO PV-PROMPT-IND                         07730002
077400         ELSE                                                     07740002
077500             MOVE SU001-PROMPT-IND  TO  PV-PROMPT-IND             07750002
077600         END-IF                                                   07760002
077700     END-IF.                                                      07770002
077800*                                                                 07780002
077900     IF  ADOORL > ZERO                                            07790002
078000         MOVE ADOORI                  TO PV-DOOR                  07800002
078100                                         SU001-DOOR-ID            07810002
078200                                         DL010-DOOR-ID            07820002
078300     ELSE                                                         07830002
078400         IF ADOORA = DP015-ERASE-EOF                              07840002
078500             MOVE SPACES              TO PV-DOOR                  07850002
078600                                         SU001-DOOR-ID            07860002
078700                                         DL010-DOOR-ID            07870002
078800         END-IF                                                   07880002
078900     END-IF.                                                      07890002
079000*                                                                 07900002
079100     IF  AP4L > ZERO                                              07910002
079200         MOVE AP4I  TO PV-P4-FLAG                                 07920002
079300     ELSE                                                         07930002
079400         IF AP4A = DP015-ERASE-EOF                                07940002
079500             MOVE SPACES TO PV-P4-FLAG                            07950002
079600         END-IF                                                   07960002
079700     END-IF.                                                      07970002
079800*                                                                 07980002
079900*                                                                 07990002
080000 2200-EDIT-INPUT.                                                 08000002
080100                                                                  08010002
080200     PERFORM 2250-EDIT-MANIFEST.                                  08020002
080300     IF SU001-P4-YES                                              08030002
080400         PERFORM 2500-DL-EDITS                                    08040002
080500     END-IF.                                                      08050002
080600     PERFORM 2270-EDIT-PROMPT.                                    08060002
080700*                                                                 08070002
080800*                                                                 08080002
080900 2250-EDIT-MANIFEST.                                              08090002
081000                                                                  08100002
081100     EVALUATE TRUE                                                08110002
081200         WHEN PV-MANIFEST = SPACES                                08120002
081300              SET PS-INVALID-INPUT        TO TRUE                 08130002
081400              MOVE DP015-UNP-ALP-BRT-MDT  TO AMANIFSTA            08140002
081500              MOVE -1                     TO AMANIFSTL            08150002
081600              MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO              08160002
081700                                                                  08170002
081800         WHEN OTHER                                               08180002
081900              SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE             08190002
082000              MOVE PV-MANIFEST TO DP010I-UNEDITED-FIELD           08200002
082100              MOVE 11     TO DP010I-MAXIMUM-DIGITS                08210002
082200              MOVE 0      TO DP010I-MAXIMUM-DECIMALS              08220002
082300                                                                  08230002
263968              CALL DP010I-NUMERIC-EDIT-ROUTINE                    08241075
263968                   USING DP010I-NUMERIC-EDIT-AREA                 08242075
082500                                                                  08250002
082600              IF  DP010I-ERROR-DETECTED                           08260002
082700                  SET PS-INVALID-INPUT        TO TRUE             08270002
082800                  MOVE DP015-UNP-ALP-BRT-MDT  TO AMANIFSTA        08280002
082900                  MOVE -1                     TO AMANIFSTL        08290002
083000                  MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO          08300002
083100              ELSE                                                08310002
083200                  IF DP010I-NUMERIC-FIELD = ZEROS                 08320002
083300                      SET PS-INVALID-INPUT       TO TRUE          08330002
083400                      MOVE DP015-UNP-ALP-BRT-MDT TO AMANIFSTA     08340002
083500                      MOVE -1                    TO AMANIFSTL     08350002
083600                      MOVE PC-MUST-BE-GT-0-MSG   TO AMSGLNO       08360002
083700                  ELSE                                            08370002
083800                      COMPUTE SU001-MANIFEST ROUNDED =            08380002
083900                           DP010I-NUMERIC-FIELD * 1               08390002
084000                      COMPUTE PV-MANIFEST-N ROUNDED =             08400002
084100                           DP010I-NUMERIC-FIELD * 1               08410002
084200                      MOVE PV-MANIFEST-N         TO AMANIFSTO     08420002
084300                      MOVE SU001-MANIFEST        TO TRIPST-TRIP-ID08430002
084400                                                    DL010-TRIP-ID 08440002
084500                      PERFORM 7500-VALIDATE-TRIP-ID               08450002
084600                      IF  PS-VALID-TRIP-ID                        08460002
084700                          IF SU001-TRIP-NOT-CONFIRMED             08470002
084800                              PERFORM 7510-TRIP-STATUS            08480002
084900* GB                          IF PS-TRIP-DEPARTED-ENDED           08490002
085000* GB                              CONTINUE                        08500002
085100* GB                          ELSE                                08510002
085200                                  MOVE TRIPST-OPER-UNT-ID         08520002
085300                                       TO SU001-OPER-UNT-ID       08530002
085400                                  MOVE TRIPST-FCLTY-ID            08540002
085500                                       TO SU001-FCLTY-ID          08550002
085600**GB                          END-IF                              08560002
085700                          END-IF                                  08570002
085800                      END-IF                                      08580002
085900                      IF  PS-INVALID-TRIP-ID                      08590002
086000                          SET PS-INVALID-INPUT TO TRUE            08600002
086100                          MOVE DP015-UNP-ALP-BRT-MDT              08610002
086200                                               TO AMANIFSTA       08620002
086300                          MOVE -1              TO AMANIFSTL       08630002
086400                          MOVE PC-INVALID-TRIP TO AMSGLNO         08640002
086500                      END-IF                                      08650002
086600                      IF  PS-DUMMY-TRIP-ID                        08660002
086700                          SET PS-DUMMY-INPUT TO TRUE              08670002
086800                          MOVE DP015-UNP-ALP-BRT-MDT              08680002
086900                                               TO AMANIFSTA       08690002
087000                          MOVE -1              TO AMANIFSTL       08700002
087100                          MOVE PC-DUMMY-TRIP   TO AMSGLNO         08710002
087200                      END-IF                                      08720002
087300                  END-IF                                          08730002
087400              END-IF                                              08740002
087500     END-EVALUATE.                                                08750002
087600*                                                                 08760002
087700 2270-EDIT-PROMPT.                                                08770002
087800     EVALUATE TRUE                                                08780002
087900         WHEN PV-PROMPT-IND = SPACES                              08790002
088000             IF SU001-ECOMM-DC-YES                                08800002
088100                 CONTINUE                                         08810002
088200             ELSE                                                 08820002
088300                 SET PS-INVALID-INPUT        TO TRUE              08830002
088400                 MOVE DP015-UNP-ALP-BRT-MDT  TO APROMPTA          08840002
088500                 MOVE -1                     TO APROMPTL          08850002
088600                 MOVE PC-PROMPT-OF-Y-OR-N    TO AMSGLNO           08860002
088700             END-IF                                               08870002
088800                                                                  08880002
088900         WHEN OTHER                                               08890002
089000             IF PV-PROMPT-IND = 'Y' OR                            08900002
089100                PV-PROMPT-IND = 'N'                               08910002
089200                 MOVE PV-PROMPT-IND      TO SU001-PROMPT-IND      08920002
089300             ELSE                                                 08930002
089400                 SET PS-INVALID-INPUT        TO TRUE              08940002
089500                 MOVE DP015-UNP-ALP-BRT-MDT  TO APROMPTA          08950002
089600                 MOVE -1                     TO APROMPTL          08960002
089700                 MOVE PC-PROMPT-OF-Y-OR-N    TO AMSGLNO           08970002
089800             END-IF                                               08980002
089900     END-EVALUATE.                                                08990002
090000*                                                                 09000002
090100 2500-DL-EDITS.                                                   09010002
090200                                                                  09020002
090300     IF PS-VALID-INPUT                                            09030002
090400         PERFORM 7020-SELECT-INBD-TRIP-DOOR                       09040002
090500         IF DL010-DOOR-ID = SPACES                                09050002
090600             IF SU001-WAIT-FOR-KEY-ENTRY                          09060002
090700                 MOVE DL010-OLD-DOOR-ID TO SU001-DOOR-ID          09070002
090800                                         ADOORO                   09080002
090900                                         PV-DOOR                  09090002
091000             END-IF                                               09100002
091100         END-IF                                                   09110002
091200     END-IF.                                                      09120002
091300                                                                  09130002
091400     IF PV-P4-FLAG = 'Y' OR 'N'                                   09140002
091500         MOVE PV-P4-FLAG              TO SU001-P4-PROMPT-FLAG     09150002
091600     ELSE                                                         09160002
091700         SET PS-INVALID-INPUT        TO TRUE                      09170002
091800         MOVE DP015-UNP-ALP-BRT-MDT  TO AP4A                      09180002
091900         MOVE -1                     TO AP4L                      09190002
092000         MOVE 'VALID VALUES = Y/N'   TO AMSGLNO                   09200002
092100     END-IF.                                                      09210002
092200                                                                  09220002
092300     IF SU001-DOOR-ID = SPACES                                    09230002
092400         SET PS-INVALID-INPUT        TO TRUE                      09240002
092500         MOVE DP015-UNP-ALP-BRT-MDT  TO ADOORA                    09250002
092600         MOVE -1                     TO ADOORL                    09260002
092700         MOVE ' DOOR IS REQUIRED '   TO AMSGLNO                   09270002
092800     ELSE                                                         09280002
092900         PERFORM 7030-SELECT-TCNDCDR                              09290002
093000         IF PS-VALID-DOOR-YES                                     09300002
093100             CONTINUE                                             09310002
093200         ELSE                                                     09320002
093300             SET PS-INVALID-INPUT        TO TRUE                  09330002
093400             MOVE DP015-UNP-ALP-BRT-MDT  TO ADOORA                09340002
093500             MOVE -1                     TO ADOORL                09350002
093600             MOVE '   INVALID DOOR   '   TO AMSGLNO               09360002
093700         END-IF                                                   09370002
093800     END-IF.                                                      09380002
093900                                                                  09390002
094000                                                                  09400002
094100     IF PS-VALID-INPUT                                            09410002
094200         IF DL010-FIRST-TRIP-SCAN-NO                              09420002
094300             PERFORM 2510-CHECK-DOOR-CHANGE                       09430002
094400         END-IF                                                   09440002
094500     END-IF.                                                      09450002
094600                                                                  09460002
094700 2510-CHECK-DOOR-CHANGE.                                          09470002
094800                                                                  09480002
094900     IF PV-DOOR = SUT00040-DOOR-ID                                09490002
095000         SET PS-DIFF-DOOR-NO          TO TRUE                     09500002
095100         MOVE PV-DOOR                 TO SU001-DOOR-ID            09510002
095200                                         DL010-DOOR-ID            09520002
095300     ELSE                                                         09530002
095400         SET PS-DIFF-DOOR-YES         TO TRUE                     09540002
095500         MOVE PV-DOOR                 TO SU001-DOOR-ID            09550002
095600                                         DL010-DOOR-ID            09560002
095700                                                                  09570002
095800         MOVE SUT00040-DOOR-ID        TO DL010-OLD-DOOR-ID        09580002
095900         MOVE 1                       TO PV-ERROR-NBR             09590002
096000                                         DL010-ERROR-NBR          09600002
096100*            MOVE DL010-USERID        TO PV-LOG-USER-ID           09610002
096200**           MOVE DL003-ASGMT-SQLCODE TO PV-SQLCODE               09620002
096300*            PERFORM 9903-WRITE-CICS-LOG                          09630002
096400         MOVE 'SUKRF529'              TO DL010-LAST-PROGRAM       09640002
096500         MOVE 7                       TO DL010-PGM-MSG-NBR        09650002
096600         MOVE CA-COMMAREA             TO DL010-HOST-SAVE-AREA     09660002
096700         SET DL010-WAIT-FOR-CONFIRM   TO TRUE                     09670002
096800         PERFORM 8110-XCTL-ERROR-SCREEN                           09680002
096900     END-IF.                                                      09690002
097000                                                                  09700002
097100/                                                                 09710002
097200 5000-DL-WORK.                                                    09720002
097300                                                                  09730002
097400     IF DL010-FIRST-TRIP-SCAN-NO                                  09740002
097500         PERFORM 5200-OLD-TRIP-DOOR                               09750002
097600     ELSE                                                         09760002
097700         PERFORM 5100-NEW-TRIP-DOOR                               09770002
097800     END-IF.                                                      09780002
097900                                                                  09790002
098000 5100-NEW-TRIP-DOOR.                                              09800002
098100                                                                  09810002
098200     PERFORM 8450-LINK-DLKCS410.                                  09820002
098300                                                                  09830002
098400     IF DL016-SUCCESSFUL                                          09840002
098500         PERFORM 7040-INSERT-TRIP-DOOR                            09850002
098600     END-IF.                                                      09860002
098700                                                                  09870002
098800*    GET THE NEXT ASSIGNMENT SEQUENCE NUMBER                      09880002
098900     PERFORM 8400-CALL-DLKUP001                                   09890002
099000                                                                  09900002
099100*    UPDATE EAI TABLES                                            09910002
099200     PERFORM 8410-CALL-XLKUP033.                                  09920002
099300/                                                                 09930002
099400 5200-OLD-TRIP-DOOR.                                              09940002
099500                                                                  09950002
099600     IF DL010-OLD-DOOR-ID NOT = DL010-DOOR-ID                     09960002
099700         PERFORM 7040-INSERT-TRIP-DOOR                            09970002
099800     END-IF.                                                      09980002
099900                                                                  09990002
100000     PERFORM 8450-LINK-DLKCS410.                                  10000002
100100                                                                  10010002
100200*    GET THE NEXT ASSIGNMENT SEQUENCE NUMBER                      10020002
100300     PERFORM 8400-CALL-DLKUP001.                                  10030041
100301*GB                                                               10030141
100310*    UPDATE EAI TABLES                                            10031041
100320     PERFORM 8410-CALL-XLKUP033.                                  10032041
100321** GB 9/21/2015 CREATE 2ND MANUAL ADD                             10032161
100322     PERFORM 5400-SEL-TEAM-ASGMT-USERS.                           10032261
100323     IF PS-CREATE-MAN-ADD-YES                                     10032361
100324        PERFORM 8410-CALL-XLKUP033                                10032461
100400     END-IF.                                                      10040061
100410 5300-SEL-ASGMT-STRT-TMST.                                        10041043
100420                                                                  10042043
100430     EXEC SQL                                                     10043043
100440         SELECT                                                   10044043
100450                MAX(B.JN_TMST)                                    10045053
100460          INTO                                                    10046043
100470                :DLT00003-JN-TMST                                 10047043
100480          FROM  DLT_ASGMT A                                       10048049
100481              , DLT_TEM_ASGMT B                                   10048151
100490         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            10049049
100491           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         10049149
100492           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             10049249
100493           AND  A.ASGMT_STRT_DTE    = :SU001-ASGMT-STRT-DTE       10049352
100494           AND  A.ASGMT_NBR_SEQ_NBR = :SU001-ASGMT-NBR-SEQ-NBR    10049449
100495           AND  A.ASGMT_NBR_TXT     = :SU001-ASGMT-NBR-TXT        10049549
100496           AND  B.KOHLS_USR_ID      = :DLT00003-KOHLS-USR-ID      10049661
100498     END-EXEC                                                     10049849
100499                                                                  10049949
100500     EVALUATE TRUE                                                10050049
100501         WHEN SQLCODE = ZERO                                      10050149
100502             CONTINUE                                             10050249
100503         WHEN SQLCODE = +100                                      10050349
100504         WHEN SQLCODE = -305                                      10050449
100505             MOVE ZEROES TO DLT00003-JN-TMST                      10050556
100506         WHEN SQLCODE = -904                                      10050649
100507         WHEN SQLCODE = -913                                      10050749
100508         WHEN SQLCODE = -911                                      10050849
100509             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           10050949
100510             MOVE SQLCODE             TO PV-SQLCODE               10051049
100511             MOVE 16                  TO PV-ERROR-NBR             10051149
100512             PERFORM 9903-WRITE-CICS-LOG                          10051249
100513             PERFORM 9000-SOFT-ABORT                              10051349
100514         WHEN SQLWARN0 NOT = SPACES                               10051449
100515         WHEN SQLCODE NOT EQUAL ZERO                              10051549
100516             MOVE SU001-ASGMT-NBR-SEQ-NBR                         10051649
100517                              TO PV-DISPLAY-ASGMT-NBR-SEQ         10051749
100518             STRING  ' SUKRF529-5300-SEL-ASGMT'                   10051849
100519                     ' ASGMT_STRT_DTE: ' SU001-ASGMT-STRT-DTE     10051949
100520                     ' ASGMT-NBR-SEQ-NB' PV-DISPLAY-ASGMT-NBR-SEQ 10052049
100521                     ' ASGMT-NBR-TXT:  ' SU001-ASGMT-NBR-TXT      10052149
100522                                        DELIMITED BY SIZE         10052249
100523                                  INTO  PV-CSSL-MSG-AREA          10052349
100524             MOVE LENGTH OF PV-CSSL-MSG-AREA                      10052449
100525                                    TO PV-COMMAREA-LENGTH         10052549
100526             EXEC CICS                                            10052649
100527                  WRITEQ TD                                       10052749
100528                   QUEUE  ('CSSL')                                10052849
100529                    FROM  (PV-CSSL-MSG-AREA)                      10052949
100530                  LENGTH  (PV-COMMAREA-LENGTH)                    10053049
100531                    RESP  (PV-CICS-RESP)                          10053149
100532             END-EXEC                                             10053249
100533             MOVE SU001-OPER-UNT-ID      TO PV-DISPLAY-OPER-UNT-ID10053349
100534             MOVE '5300-SEL-ASGMT-STRT-TMST'                      10053449
100535                             TO DP013-PARAGRAPH                   10053549
100536             STRING 'OPER UNIT: '      DELIMITED BY SIZE          10053649
100537                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          10053749
100538                           INTO DP013-MESSAGE-TEXT(1)             10053849
100539             MOVE SQLCA      TO DP013-SQLCA                       10053949
100540             MOVE 'DLT_TEM_ASGMT'  TO DP013-DB2-TABLE-NAME(1)     10054049
100541             SET DP013-DB2-ABEND                                  10054149
100542                             TO TRUE                              10054249
100543             SET DP013-NO-ROLLBACK                                10054349
100544                             TO TRUE                              10054449
100545             SET DP013-XCTL-DISPLAY-RESTART                       10054549
100546                             TO TRUE                              10054649
100550             PERFORM DP014-0000-PROCESS-ABEND                     10055045
100555     END-EVALUATE.                                                10055543
100560/                                                                 10056002
100561*GB 9/28/15                                                       10056166
100562******************************************************************10056266
100563* CHECK THAT ADDING OF ASSOCIATE IS CHANGING ASSIGNMENT FROM AN   10056366
100564* INDIVIDUAL ASSIGNMENT TO A TEAM ASSIGNMENT. IF YES, SET SWITCH  10056466
100565* TO CREATE A SECOND ASSIGNMENT ADD EVENT FOR THE INDIVIDUAL      10056569
100566* THAT CREATED THE ASSIGNMENT.                                    10056669
100567******************************************************************10056766
100570 5400-SEL-TEAM-ASGMT-USERS.                                       10057060
100571                                                                  10057161
100580     SET  PS-CREATE-MAN-ADD-NO  TO TRUE                           10058061
100581                                                                  10058161
100590     EXEC SQL                                                     10059060
100591         SELECT                                                   10059160
100592                B.KOHLS_USR_ID                                    10059261
100593          INTO                                                    10059360
100594                :DLT00003-KOHLS-USR-ID                            10059461
100595          FROM  DLT_ASGMT A                                       10059560
100596              , DLT_TEM_ASGMT B                                   10059660
100597         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            10059760
100598           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         10059860
100599           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             10059960
100600           AND  A.ASGMT_STRT_DTE    = :SU001-ASGMT-STRT-DTE       10060060
100601           AND  A.ASGMT_NBR_SEQ_NBR = :SU001-ASGMT-NBR-SEQ-NBR    10060160
100602           AND  A.ASGMT_NBR_TXT     = :SU001-ASGMT-NBR-TXT        10060260
100603           AND (B.KOHLS_USR_ID     <> :SU001-USER-ID OR           10060365
100604                B.TMP_USR_ID       <> :SU001-USER-ID)             10060465
100606           AND  B.LVE_TMST         IS NULL                        10060661
100607           AND  B.LVE_RSN_CDE       = 'N'                         10060761
100608     END-EXEC                                                     10060860
100609                                                                  10060960
100610     EVALUATE TRUE                                                10061060
100611         WHEN SQLCODE = ZERO                                      10061160
100612             SET PS-CREATE-MAN-ADD-YES TO TRUE                    10061261
100613         WHEN SQLCODE = +100                                      10061363
100614         WHEN SQLCODE = -811                                      10061463
100615             CONTINUE                                             10061563
100616         WHEN SQLCODE = -305                                      10061667
100617             PERFORM 5410-SEL-TEAM-ASGMT-TEMP                     10061767
100618         WHEN SQLCODE = -904                                      10061860
100619         WHEN SQLCODE = -913                                      10061960
100620         WHEN SQLCODE = -911                                      10062060
100621             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           10062160
100622             MOVE SQLCODE             TO PV-SQLCODE               10062260
100623             MOVE 16                  TO PV-ERROR-NBR             10062360
100624             PERFORM 9903-WRITE-CICS-LOG                          10062460
100625             PERFORM 9000-SOFT-ABORT                              10062560
100626         WHEN SQLWARN0 NOT = SPACES                               10062660
100627         WHEN SQLCODE NOT EQUAL ZERO                              10062760
100628             MOVE SU001-ASGMT-NBR-SEQ-NBR                         10062860
100629                              TO PV-DISPLAY-ASGMT-NBR-SEQ         10062960
100630             STRING  ' SUKRF529-5400-SEL-TEAM '                   10063061
100631                     ' ASGMT_STRT_DTE: ' SU001-ASGMT-STRT-DTE     10063160
100632                     ' ASGMT-NBR-SEQ-NB' PV-DISPLAY-ASGMT-NBR-SEQ 10063260
100633                     ' ASGMT-NBR-TXT:  ' SU001-ASGMT-NBR-TXT      10063360
100634                                        DELIMITED BY SIZE         10063460
100635                                  INTO  PV-CSSL-MSG-AREA          10063560
100636             MOVE LENGTH OF PV-CSSL-MSG-AREA                      10063660
100637                                    TO PV-COMMAREA-LENGTH         10063760
100638             EXEC CICS                                            10063860
100639                  WRITEQ TD                                       10063960
100640                   QUEUE  ('CSSL')                                10064060
100641                    FROM  (PV-CSSL-MSG-AREA)                      10064160
100642                  LENGTH  (PV-COMMAREA-LENGTH)                    10064260
100643                    RESP  (PV-CICS-RESP)                          10064360
100644             END-EXEC                                             10064460
100645             MOVE SU001-OPER-UNT-ID      TO PV-DISPLAY-OPER-UNT-ID10064560
100646             MOVE '5400-SEL-TEAM-ASGMT-USERS'                     10064661
100647                             TO DP013-PARAGRAPH                   10064760
100648             STRING 'OPER UNIT: '      DELIMITED BY SIZE          10064860
100649                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          10064960
100650                           INTO DP013-MESSAGE-TEXT(1)             10065060
100651             MOVE SQLCA      TO DP013-SQLCA                       10065160
100652             MOVE 'DLT_TEM_ASGMT'  TO DP013-DB2-TABLE-NAME(1)     10065260
100653             SET DP013-DB2-ABEND                                  10065360
100654                             TO TRUE                              10065460
100655             SET DP013-NO-ROLLBACK                                10065560
100656                             TO TRUE                              10065660
100657             SET DP013-XCTL-DISPLAY-RESTART                       10065760
100658                             TO TRUE                              10065860
100659             PERFORM DP014-0000-PROCESS-ABEND                     10065960
100660     END-EVALUATE.                                                10066060
100661/                                                                 10066160
100662 5410-SEL-TEAM-ASGMT-TEMP.                                        10066267
100663                                                                  10066367
100664     SET  PS-CREATE-MAN-ADD-NO  TO TRUE                           10066467
100665                                                                  10066567
100666     EXEC SQL                                                     10066667
100667         SELECT                                                   10066767
100668                B.TMP_USR_ID                                      10066867
100669          INTO                                                    10066967
100670                :DLT00003-KOHLS-USR-ID                            10067067
100671          FROM  DLT_ASGMT A                                       10067167
100672              , DLT_TEM_ASGMT B                                   10067267
100673         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            10067367
100674           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         10067467
100675           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             10067567
100676           AND  A.ASGMT_STRT_DTE    = :SU001-ASGMT-STRT-DTE       10067667
100677           AND  A.ASGMT_NBR_SEQ_NBR = :SU001-ASGMT-NBR-SEQ-NBR    10067767
100678           AND  A.ASGMT_NBR_TXT     = :SU001-ASGMT-NBR-TXT        10067867
100679           AND (B.KOHLS_USR_ID     <> :SU001-USER-ID OR           10067967
100680                B.TMP_USR_ID       <> :SU001-USER-ID)             10068067
100681           AND  B.LVE_TMST         IS NULL                        10068167
100682           AND  B.LVE_RSN_CDE       = 'N'                         10068267
100683     END-EXEC                                                     10068367
100684                                                                  10068467
100685     EVALUATE TRUE                                                10068567
100686         WHEN SQLCODE = ZERO                                      10068667
100687             SET PS-CREATE-MAN-ADD-YES TO TRUE                    10068767
100688         WHEN SQLCODE = +100                                      10068867
100689         WHEN SQLCODE = -811                                      10068967
100690         WHEN SQLCODE = -305                                      10069068
100691             CONTINUE                                             10069168
100692         WHEN SQLCODE = -904                                      10069268
100693         WHEN SQLCODE = -913                                      10069368
100694         WHEN SQLCODE = -911                                      10069468
100695             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           10069568
100696             MOVE SQLCODE             TO PV-SQLCODE               10069668
100697             MOVE 16                  TO PV-ERROR-NBR             10069768
100698             PERFORM 9903-WRITE-CICS-LOG                          10069868
100699             PERFORM 9000-SOFT-ABORT                              10069968
100700         WHEN SQLWARN0 NOT = SPACES                               10070068
100701         WHEN SQLCODE NOT EQUAL ZERO                              10070168
100702             MOVE SU001-ASGMT-NBR-SEQ-NBR                         10070268
100703                              TO PV-DISPLAY-ASGMT-NBR-SEQ         10070368
100704             STRING  ' SUKRF529-5410-SEL-TEAM '                   10070468
100705                     ' ASGMT_STRT_DTE: ' SU001-ASGMT-STRT-DTE     10070568
100706                     ' ASGMT-NBR-SEQ-NB' PV-DISPLAY-ASGMT-NBR-SEQ 10070668
100707                     ' ASGMT-NBR-TXT:  ' SU001-ASGMT-NBR-TXT      10070768
100708                                        DELIMITED BY SIZE         10070868
100709                                  INTO  PV-CSSL-MSG-AREA          10070968
100710             MOVE LENGTH OF PV-CSSL-MSG-AREA                      10071068
100711                                    TO PV-COMMAREA-LENGTH         10071168
100712             EXEC CICS                                            10071268
100713                  WRITEQ TD                                       10071368
100714                   QUEUE  ('CSSL')                                10071468
100715                    FROM  (PV-CSSL-MSG-AREA)                      10071568
100716                  LENGTH  (PV-COMMAREA-LENGTH)                    10071668
100717                    RESP  (PV-CICS-RESP)                          10071768
100718             END-EXEC                                             10071868
100719             MOVE SU001-OPER-UNT-ID      TO PV-DISPLAY-OPER-UNT-ID10071968
100720             MOVE '5400-SEL-TEAM-ASGMT-USERS'                     10072068
100721                             TO DP013-PARAGRAPH                   10072168
100722             STRING 'OPER UNIT: '      DELIMITED BY SIZE          10072268
100723                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          10072368
100724                           INTO DP013-MESSAGE-TEXT(1)             10072468
100725             MOVE SQLCA      TO DP013-SQLCA                       10072568
100726             MOVE 'DLT_TEM_ASGMT'  TO DP013-DB2-TABLE-NAME(1)     10072668
100727             SET DP013-DB2-ABEND                                  10072768
100728                             TO TRUE                              10072868
100729             SET DP013-NO-ROLLBACK                                10072968
100730                             TO TRUE                              10073068
100731             SET DP013-XCTL-DISPLAY-RESTART                       10073168
100732                             TO TRUE                              10073268
100733             PERFORM DP014-0000-PROCESS-ABEND                     10073368
100734     END-EVALUATE.                                                10073468
100735/                                                                 10073568
100736 7000-SELECT-TKRPRPM.                                             10073668
100740                                                                  10074067
100800     EXEC SQL                                                     10080002
100900          SELECT FUNC_TXT                                         10090002
101000            INTO :KRPRPM-FUNC-TXT                                 10100002
101100            FROM TKRPRPM                                          10110002
101200           WHERE LOC_ID            = :DK-OPER-UNT-ID              10120002
101300             AND INTFC_SYS_CDE    = 'AUD'                         10130002
101400             AND SYS_PRC_FUNC_CDE = 'PROMPT'                      10140002
101500             AND FUNC_PRC_STAT_CDE = 'AC'                         10150002
101600     END-EXEC.                                                    10160002
101700                                                                  10170002
101800     EVALUATE TRUE                                                10180002
101900         WHEN SQLCODE = ZERO                                      10190002
102000             MOVE KRPRPM-FUNC-TXT  TO PV-PROMPT-IND               10200002
102100         WHEN SQLWARN0 NOT = SPACES                               10210002
102200         WHEN SQLCODE NOT EQUAL ZERO                              10220002
102300             MOVE '7000-SELECT-TKRPRPM'                           10230002
102400                             TO DP013-PARAGRAPH                   10240002
102500             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        10250002
102600             STRING 'OPER UNIT: '      DELIMITED BY SIZE          10260002
102700                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          10270002
102800                           INTO DP013-MESSAGE-TEXT(1)             10280002
102900             MOVE SQLCA      TO DP013-SQLCA                       10290002
103000             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           10300002
103100             SET DP013-DB2-ABEND                                  10310002
103200                             TO TRUE                              10320002
103300             SET DP013-NO-ROLLBACK                                10330002
103400                             TO TRUE                              10340002
103500             SET DP013-XCTL-DISPLAY-RESTART                       10350002
103600                             TO TRUE                              10360002
103700             PERFORM DP014-0000-PROCESS-ABEND                     10370002
103800     END-EVALUATE.                                                10380002
103900                                                                  10390002
104000 7005-CHECK-IF-DC.                                                10400002
104100                                                                  10410002
104200     SET SU001-ECOMM-DC-NO            TO TRUE                     10420002
104300     EXEC SQL                                                     10430002
104400          SELECT 'Y'                                              10440002
104500          INTO  :SU001-ECOMM-DC-SW                                10450002
104600          FROM   XLT_LOC                                          10460002
104700          WHERE  LOC_NBR      = :DK-OPER-UNT-ID                   10470002
104800            AND  LOC_TYP_CDE  = 'DC'                              10480002
104900            AND  E_BUS_IND    = 'Y'                               10490002
105000     END-EXEC.                                                    10500002
105100                                                                  10510002
105200     EVALUATE TRUE                                                10520002
105300         WHEN SQLCODE = ZERO                                      10530002
105400         WHEN SQLCODE = -305                                      10540002
105500         WHEN SQLCODE = +100                                      10550002
105600             CONTINUE                                             10560002
105700         WHEN SQLCODE = -904                                      10570002
105800         WHEN SQLCODE = -913                                      10580002
105900         WHEN SQLCODE = -911                                      10590002
106000             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           10600002
106100             MOVE SQLCODE             TO PV-SQLCODE               10610002
106200             MOVE 1                   TO PV-ERROR-NBR             10620002
106300                                         DL010-ERROR-NBR          10630002
106400             PERFORM 9903-WRITE-CICS-LOG                          10640002
106500             PERFORM 9000-SOFT-ABORT                              10650002
106600*            PERFORM 8110-XCTL-ERROR-SCREEN                       10660002
106700         WHEN SQLWARN0 NOT = SPACES                               10670002
106800         WHEN SQLCODE NOT = ZERO                                  10680002
106900             MOVE 2                   TO PV-ERROR-NBR             10690002
107000                                         DL010-ERROR-NBR          10700002
107100             MOVE SU001-USER-ID       TO DL010-USERID             10710002
107200             MOVE DL010-USERID        TO PV-LOG-USER-ID           10720002
107300             PERFORM 9903-WRITE-CICS-LOG                          10730002
107400             MOVE '7005-CHECK-IF-DC'                              10740002
107500                                      TO DL010-PARAGRAPH          10750002
107600             MOVE 'SUKRF529 - CHECK XLT_LOC'                      10760002
107700                                      TO DL010-MESSAGE-TEXT(1)    10770002
107800             MOVE SQLCA               TO DL010-SQLCA              10780002
107900             SET DL010-ABEND          TO TRUE                     10790002
108000             MOVE 3                   TO DL010-PGM-MSG-NBR        10800002
108100             PERFORM 8110-XCTL-ERROR-SCREEN                       10810002
108200     END-EVALUATE.                                                10820002
108300                                                                  10830002
108400 7010-SELECT-TKRPRPM.                                             10840002
108500     EXEC SQL                                                     10850002
108600          SELECT LOC_ID                                           10860002
108700          INTO :KRPRPM-LOC-ID                                     10870002
108800          FROM TKRPRPM                                            10880002
108900          WHERE LOC_ID            = :DK-OPER-UNT-ID               10890002
109000            AND INTFC_SYS_CDE     = 'DLX'                         10900002
109100            AND SYS_PRC_FUNC_CDE  = 'DLLBIN'                      10910002
109200            AND FUNC_PRC_STAT_CDE = 'AC'                          10920002
109300            AND FUNC_TXT          = 'Y'                           10930002
109400            AND (CURRENT DATE                                     10940002
109500        BETWEEN DATE(FUNC_BEG_TMST) AND                           10950002
109600                DATE(FUNC_END_TMST) )                             10960002
109700     END-EXEC.                                                    10970002
109800                                                                  10980002
109900     EVALUATE TRUE                                                10990002
110000         WHEN SQLCODE = ZERO                                      11000002
110100              SET SU001-P4-YES        TO TRUE                     11010002
110200         WHEN SQLCODE = +100                                      11020002
110300              SET SU001-P4-NO         TO TRUE                     11030002
110400         WHEN SQLCODE = -904                                      11040002
110500         WHEN SQLCODE = -913                                      11050002
110600         WHEN SQLCODE = -911                                      11060002
110700             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           11070002
110800             MOVE SQLCODE             TO PV-SQLCODE               11080002
110900             MOVE 1                   TO PV-ERROR-NBR             11090002
111000                                         DL010-ERROR-NBR          11100002
111100             PERFORM 9903-WRITE-CICS-LOG                          11110002
111200             PERFORM 9000-SOFT-ABORT                              11120002
111300*            PERFORM 8110-XCTL-ERROR-SCREEN                       11130002
111400         WHEN OTHER                                               11140002
111500             MOVE 2                   TO PV-ERROR-NBR             11150002
111600                                         DL010-ERROR-NBR          11160002
111700             MOVE SU001-USER-ID       TO DL010-USERID             11170002
111800             MOVE DL010-USERID        TO PV-LOG-USER-ID           11180002
111900             PERFORM 9903-WRITE-CICS-LOG                          11190002
112000             MOVE '7010-SELECT-TKRPRPM'                           11200002
112100                                      TO DL010-PARAGRAPH          11210002
112200             MOVE 'SUKRF529 - LABOR MGMT FLAG'                    11220002
112300                                      TO DL010-MESSAGE-TEXT(1)    11230002
112400             MOVE SQLCA               TO DL010-SQLCA              11240002
112500             SET DL010-ABEND          TO TRUE                     11250002
112600             MOVE 3                   TO DL010-PGM-MSG-NBR        11260002
112700             PERFORM 8110-XCTL-ERROR-SCREEN                       11270002
112800     END-EVALUATE.                                                11280002
112900/                                                                 11290002
113000 7020-SELECT-INBD-TRIP-DOOR.                                      11300002
113100     EXEC SQL                                                     11310002
113200         SELECT                                                   11320002
113300             DOOR1.DOOR_ID                                        11330002
113400         INTO                                                     11340002
113500             :SUT00040-DOOR-ID                                    11350002
113600         FROM                                                     11360002
113700             SUT_INBD_TRIP_DOOR DOOR1                             11370002
113800         WHERE DOOR1.TRIP_ID          = :DL010-TRIP-ID            11380002
113900             AND                                                  11390002
114000             DOOR1.CRE_TMST =                                     11400002
114100           (                                                      11410002
114200             SELECT MAX (DOOR2.CRE_TMST)                          11420002
114300             FROM                                                 11430002
114400             SUT_INBD_TRIP_DOOR DOOR2                             11440002
114500             WHERE                                                11450002
114600               DOOR1.TRIP_ID          = DOOR2.TRIP_ID             11460002
114700            )                                                     11470002
114800     END-EXEC.                                                    11480002
114900                                                                  11490002
115000     EVALUATE TRUE                                                11500002
115100         WHEN SQLCODE = ZERO                                      11510002
115200             SET DL010-FIRST-TRIP-SCAN-NO                         11520002
115300                                      TO TRUE                     11530002
115400             MOVE SUT00040-DOOR-ID    TO DL010-OLD-DOOR-ID        11540002
115500         WHEN SQLCODE = +100                                      11550002
115600         WHEN SQLCODE = -305                                      11560002
115700             SET DL010-FIRST-TRIP-SCAN-YES                        11570002
115800                                      TO TRUE                     11580002
115900             MOVE SPACES              TO DL010-OLD-DOOR-ID        11590002
116000         WHEN SQLCODE = -904                                      11600002
116100         WHEN SQLCODE = -913                                      11610002
116200         WHEN SQLCODE = -911                                      11620002
116300             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           11630002
116400             MOVE SQLCODE             TO PV-SQLCODE               11640002
116500             MOVE 3                   TO PV-ERROR-NBR             11650002
116600                                         DL010-ERROR-NBR          11660002
116700             PERFORM 9903-WRITE-CICS-LOG                          11670002
116800             PERFORM 9000-SOFT-ABORT                              11680002
116900         WHEN OTHER                                               11690002
117000             MOVE 4                   TO PV-ERROR-NBR             11700002
117100                                         DL010-ERROR-NBR          11710002
117200             MOVE SU001-USER-ID       TO DL010-USERID             11720002
117300             MOVE DL010-USERID        TO PV-LOG-USER-ID           11730002
117400             PERFORM 9903-WRITE-CICS-LOG                          11740002
117500             MOVE '7020-SELECT-INBD-TRIP-DOOR'                    11750002
117600                                      TO DL010-PARAGRAPH          11760002
117700             MOVE 'SUKRF529 - LABOR MGMT FLAG'                    11770002
117800                                      TO DL010-MESSAGE-TEXT(1)    11780002
117900             MOVE SQLCA               TO DL010-SQLCA              11790002
118000             SET DL010-ABEND          TO TRUE                     11800002
118100             MOVE 3                   TO DL010-PGM-MSG-NBR        11810002
118200             PERFORM 8110-XCTL-ERROR-SCREEN                       11820002
118300     END-EVALUATE.                                                11830002
118400/                                                                 11840002
118500 7030-SELECT-TCNDCDR.                                             11850002
118600     SET PS-VALID-DOOR-NO             TO TRUE                     11860002
118700     EXEC SQL                                                     11870002
118800         SELECT 'Y'                                               11880002
118900         INTO                                                     11890002
119000             :PS-VALID-DOOR-SW                                    11900002
119100         FROM                                                     11910002
119200             TCNDCDR                                              11920002
119300         WHERE OPER_UNT_ID            = :DK-OPER-UNT-ID           11930002
119400             AND                                                  11940002
119500             DOOR_ID                  = :PV-DOOR                  11950002
119600             AND                                                  11960002
119700             DOOR_TYP_CDE             = 'RC'                      11970002
119800     END-EXEC.                                                    11980002
119900                                                                  11990002
120000     EVALUATE TRUE                                                12000002
120100         WHEN SQLCODE = ZERO                                      12010002
120200         WHEN SQLCODE = +100                                      12020002
120300             CONTINUE                                             12030002
120400         WHEN SQLCODE = -904                                      12040002
120500         WHEN SQLCODE = -913                                      12050002
120600         WHEN SQLCODE = -911                                      12060002
120700             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           12070002
120800             MOVE SQLCODE             TO PV-SQLCODE               12080002
120900             MOVE 5                   TO PV-ERROR-NBR             12090002
121000                                         DL010-ERROR-NBR          12100002
121100             PERFORM 9903-WRITE-CICS-LOG                          12110002
121200             PERFORM 9000-SOFT-ABORT                              12120002
121300         WHEN OTHER                                               12130002
121400             MOVE 6                   TO PV-ERROR-NBR             12140002
121500                                         DL010-ERROR-NBR          12150002
121600             MOVE SU001-USER-ID       TO DL010-USERID             12160002
121700             MOVE DL010-USERID        TO PV-LOG-USER-ID           12170002
121800             PERFORM 9903-WRITE-CICS-LOG                          12180002
121900             MOVE '7020-SELECT-INBD-TRIP-DOOR'                    12190002
122000                                      TO DL010-PARAGRAPH          12200002
122100             MOVE 'SUKRF529 - LABOR MGMT FLAG'                    12210002
122200                                      TO DL010-MESSAGE-TEXT(1)    12220002
122300             MOVE SQLCA               TO DL010-SQLCA              12230002
122400             SET DL010-ABEND          TO TRUE                     12240002
122500             MOVE 3                   TO DL010-PGM-MSG-NBR        12250002
122600             PERFORM 8110-XCTL-ERROR-SCREEN                       12260002
122700     END-EVALUATE.                                                12270002
122800/                                                                 12280002
122900 7040-INSERT-TRIP-DOOR.                                           12290002
123000                                                                  12300002
123100     EXEC SQL                                                     12310002
123200         INSERT INTO SUT_INBD_TRIP_DOOR                           12320002
123300     (                                                            12330002
123400         TRIP_ID                                                  12340002
123500     ,   CRE_TMST                                                 12350002
123600     ,   DOOR_ID                                                  12360002
123700     ,   CRE_BY_USR_ID                                            12370002
123800     )                                                            12380002
123900     VALUES                                                       12390002
124000     (                                                            12400002
124100         :DL010-TRIP-ID                                           12410002
124200     ,   CURRENT TIMESTAMP                                        12420002
124300     ,   :DL010-DOOR-ID                                           12430002
124400     ,   :SU001-USER-ID                                           12440002
124500     )                                                            12450002
124600     END-EXEC.                                                    12460002
124700                                                                  12470002
124800     EVALUATE TRUE                                                12480002
124900         WHEN SQLCODE = ZERO                                      12490002
125000             CONTINUE                                             12500002
125100         WHEN SQLCODE = -904                                      12510002
125200         WHEN SQLCODE = -913                                      12520002
125300         WHEN SQLCODE = -911                                      12530002
125400             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           12540002
125500             MOVE SQLCODE             TO PV-SQLCODE               12550002
125600             MOVE 7                   TO PV-ERROR-NBR             12560002
125700                                         DL010-ERROR-NBR          12570002
125800             PERFORM 9903-WRITE-CICS-LOG                          12580002
125900             PERFORM 9000-SOFT-ABORT                              12590002
126000         WHEN OTHER                                               12600002
126100             MOVE 8                   TO PV-ERROR-NBR             12610002
126200                                         DL010-ERROR-NBR          12620002
126300             MOVE SU001-USER-ID       TO DL010-USERID             12630002
126400             MOVE DL010-USERID        TO PV-LOG-USER-ID           12640002
126500             PERFORM 9903-WRITE-CICS-LOG                          12650002
126600             MOVE '7040-INSERT-TRIP-DOOR'                         12660002
126700                                      TO DL010-PARAGRAPH          12670002
126800             MOVE 'SUKRF529 - INSERT NEW TRIP/DOOR'               12680002
126900                                      TO DL010-MESSAGE-TEXT(1)    12690002
127000             MOVE SQLCA               TO DL010-SQLCA              12700002
127100             SET DL010-ABEND          TO TRUE                     12710002
127200             MOVE 3                   TO DL010-PGM-MSG-NBR        12720002
127300             PERFORM 8110-XCTL-ERROR-SCREEN                       12730002
127400     END-EVALUATE.                                                12740002
127500/                                                                 12750002
127600 7050-SELECT-TKRPRPM-FLOWBACK.                                    12760004
127700     EXEC SQL                                                     12770003
127800          SELECT LOC_ID                                           12780003
127900          INTO :KRPRPM-LOC-ID                                     12790003
128000          FROM TKRPRPM                                            12800003
128100          WHERE LOC_ID            = :DK-OPER-UNT-ID               12810003
128200            AND INTFC_SYS_CDE     = 'KHL'                         12820003
128300            AND SYS_PRC_FUNC_CDE  = 'FLWBCK'                      12830003
128400            AND FUNC_PRC_STAT_CDE = 'AC'                          12840003
128500            AND (CURRENT DATE                                     12850003
128600        BETWEEN DATE(FUNC_BEG_TMST) AND                           12860003
128700                DATE(FUNC_END_TMST) )                             12870003
128800     END-EXEC.                                                    12880003
128900                                                                  12890003
129000     EVALUATE TRUE                                                12900003
129100         WHEN SQLCODE = ZERO                                      12910003
129200              SET SU001-FLOWBACK-YES  TO TRUE                     12920003
129300         WHEN SQLCODE = +100                                      12930003
129400              SET SU001-FLOWBACK-NO   TO TRUE                     12940003
129500         WHEN SQLCODE = -904                                      12950003
129600         WHEN SQLCODE = -913                                      12960003
129700         WHEN SQLCODE = -911                                      12970003
129800             MOVE SU001-USER-ID       TO PV-LOG-USER-ID           12980003
129900             MOVE SQLCODE             TO PV-SQLCODE               12990003
130000             MOVE 1                   TO PV-ERROR-NBR             13000003
130100                                         DL010-ERROR-NBR          13010003
130200             PERFORM 9903-WRITE-CICS-LOG                          13020003
130300             PERFORM 9000-SOFT-ABORT                              13030003
130400*            PERFORM 8110-XCTL-ERROR-SCREEN                       13040003
130500         WHEN OTHER                                               13050003
130600             MOVE 2                   TO PV-ERROR-NBR             13060003
130700                                         DL010-ERROR-NBR          13070003
130800             MOVE SU001-USER-ID       TO DL010-USERID             13080003
130900             MOVE DL010-USERID        TO PV-LOG-USER-ID           13090003
131000             PERFORM 9903-WRITE-CICS-LOG                          13100003
131100             MOVE '7050-SELECT-TKRPRPM-FLOWBACK'                  13110004
131200                                      TO DL010-PARAGRAPH          13120003
131300             MOVE 'SUKRF529 - FLOWBACK FLAG'                      13130004
131400                                      TO DL010-MESSAGE-TEXT(1)    13140003
131500             MOVE SQLCA               TO DL010-SQLCA              13150003
131600             SET DL010-ABEND          TO TRUE                     13160003
131700             MOVE 3                   TO DL010-PGM-MSG-NBR        13170003
131800             PERFORM 8110-XCTL-ERROR-SCREEN                       13180003
131900     END-EVALUATE.                                                13190003
132000/                                                                 13200003
132100******************************************************************13210002
132200* USER ENTERS TRIP ID.  2110-RECEIVE-SCREEN-FIELDS SENDS TRIP ID *13220002
132300* TO THE SCREEN. THIS PARAGRAPH VALIDATES THE TRIP ID.           *13230002
132400******************************************************************13240002
132500 7500-VALIDATE-TRIP-ID.                                           13250002
132600                                                                  13260002
132700     EXEC SQL                                                     13270002
132800       SELECT DISTINCT                                            13280002
132900              A.TRIP_STATUS_CDE                                   13290002
133000             ,A.OPER_UNT_ID                                       13300002
133100             ,A.FCLTY_ID                                          13310002
133200             ,A.FCLTY_AREA_ID                                     13320002
133300             ,B.PRTY_CDE                                          13330002
133400             ,C.VEH_NBR                                           13340002
133500       INTO   :TRIPST-TRIP-STATUS-CDE                             13350002
133600             ,:TRIPST-OPER-UNT-ID                                 13360002
133700             ,:TRIPST-FCLTY-ID                                    13370002
133800             ,:TRIPST-FCLTY-AREA-ID                               13380002
133900             ,:TRSTYP-PRTY-CDE                                    13390002
134000             ,:VHTRIP-VEH-NBR  :PV-NULL-IND                       13400002
134100       FROM   TTRIPST A                                           13410002
134200             ,TTRSTYP B                                           13420002
134300             ,TVHTRIP C                                           13430002
134400       WHERE  A.TRIP_ID     = :TRIPST-TRIP-ID                     13440002
134500         AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE               13450002
134600         AND  A.TRIP_ID     = C.TRIP_ID                           13460002
134700         AND  B.PRTY_CDE =                                        13470002
134800             (SELECT DISTINCT                                     13480002
134900                  MAX(D.PRTY_CDE)                                 13490002
135000               FROM   TTRIPST C                                   13500002
135100                     ,TTRSTYP D                                   13510002
135200               WHERE  C.TRIP_ID     = :TRIPST-TRIP-ID             13520002
135300                 AND  C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)      13530002
135400     END-EXEC.                                                    13540002
135500                                                                  13550002
135600     EVALUATE TRUE                                                13560002
135700         WHEN SQLCODE = ZERO                                      13570002
135800             IF PV-NULL-IND    = PV-NULL                          13580002
135900                 SET PS-DUMMY-TRIP-ID TO TRUE                     13590002
136000             ELSE                                                 13600002
136100                 SET PS-VALID-TRIP-ID TO TRUE                     13610002
136200             END-IF                                               13620002
136300         WHEN SQLCODE = +100                                      13630002
136400             SET PS-INVALID-TRIP-ID TO TRUE                       13640002
136500         WHEN SQLWARN0 NOT = SPACES                               13650002
136600         WHEN SQLCODE NOT EQUAL ZERO                              13660002
136700             MOVE '7500-VALIDATE-TRIP-ID'                         13670002
136800                             TO DP013-PARAGRAPH                   13680002
136900             MOVE 'CHECK TRIP STATUS'                             13690002
137000                             TO DP013-MESSAGE-TEXT(1)             13700002
137100             MOVE PV-MANIFEST                                     13710002
137200                             TO DP013-MESSAGE-TEXT(2)             13720002
137300             MOVE SQLCA      TO DP013-SQLCA                       13730002
137400             MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME(1)           13740002
137500             SET DP013-DB2-ABEND                                  13750002
137600                             TO TRUE                              13760002
137700             SET DP013-NO-ROLLBACK                                13770002
137800                             TO TRUE                              13780002
137900             SET DP013-XCTL-DISPLAY-RESTART                       13790002
138000                             TO TRUE                              13800002
138100             PERFORM DP014-0000-PROCESS-ABEND                     13810002
138200     END-EVALUATE.                                                13820002
138300*                                                                 13830002
138400 7510-TRIP-STATUS.                                                13840002
138500                                                                  13850002
138600     EXEC SQL                                                     13860002
138700        SELECT TRIP_STATUS_CDE                                    13870002
138800          INTO :TRIPST-TRIP-STATUS-CDE                            13880014
138900          FROM  TTRIPST B                                         13890014
139000         WHERE  B.TRIP_ID     = :TRIPST-TRIP-ID                   13900014
139300           AND  TIMESTAMP(B.STATUS_DTE, B.STATUS_TME)             13930014
139400                IN                                                13940015
139500                (SELECT                                           13950002
139600                       MAX(TIMESTAMP(A.STATUS_DTE, A.STATUS_TME)) 13960002
139700                 FROM   TTRIPST A                                 13970002
139800                 WHERE  A.TRIP_ID     = B.TRIP_ID                 13980002
139900                  )                                               13990002
140000     END-EXEC.                                                    14000002
140100                                                                  14010002
140200     EVALUATE TRUE                                                14020002
140300         WHEN SQLCODE = ZERO                                      14030002
140400         WHEN SQLCODE = -811                                      14040002
140500             IF TRIPST-TRIP-STATUS-CDE = 'DP' OR 'ET'             14050002
140510*** DMH - 11/21/08 BEGIN                                          14051012
140520                 PERFORM 7520-DEPARTED-CHECKS                     14052012
140600***              SET PS-TRIP-DEPARTED-ENDED                       14060032
140700***                  SU001-STAT-WARNG-MESSGE-DEP                  14070032
140800***                                               TO TRUE         14080032
140900***              SET SU001-TRIP-NOT-CONFIRMED TO TRUE             14090032
140910*** DMH - 11/21/08 END                                            14091032
141000             ELSE                                                 14100002
141100                 IF TRIPST-TRIP-STATUS-CDE  = 'DE'                14110002
141200                     SET SU001-STAT-WARNG-MESSGE-DEL              14120002
141300                         PS-TRIP-DEPARTED-ENDED                   14130002
141400                                                  TO TRUE         14140002
141500                     SET SU001-TRIP-NOT-CONFIRMED TO TRUE         14150002
141600                 ELSE                                             14160002
141700                     SET PS-TRIP-NOT-DEPARTED-ENDED               14170002
141800                         SU001-TRIP-CONFIRMED     TO TRUE         14180002
141900                 END-IF                                           14190002
142000             END-IF                                               14200002
142100         WHEN SQLCODE = +100                                      14210002
142200         WHEN SQLWARN0 NOT = SPACES                               14220002
142300         WHEN SQLCODE NOT EQUAL ZERO                              14230002
142400             MOVE '7510-TRIP-STATUS'                              14240002
142500                             TO DP013-PARAGRAPH                   14250002
142600             MOVE 'CHECK IF TRIP DEPARTED OR ENDED'               14260002
142700                             TO DP013-MESSAGE-TEXT(1)             14270002
142800             MOVE PV-MANIFEST                                     14280002
142900                             TO DP013-MESSAGE-TEXT(2)             14290002
143000             MOVE SQLCA      TO DP013-SQLCA                       14300002
143100             MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME(1)           14310002
143200             SET DP013-DB2-ABEND                                  14320002
143300                             TO TRUE                              14330002
143400             SET DP013-NO-ROLLBACK                                14340002
143500                             TO TRUE                              14350002
143600             SET DP013-XCTL-DISPLAY-RESTART                       14360002
143700                             TO TRUE                              14370002
143800             PERFORM DP014-0000-PROCESS-ABEND                     14380002
143900     END-EVALUATE.                                                14390002
143910                                                                  14391012
143920*  DMH - 11/21/08 - BEGIN                                         14392013
144000******************************************************************14400012
144001*  DEPARTED TRIP RULES                                           *14400112
144002*    -  IF DEPARTED TRIP AND ARRIVED DC IS DIFFERENT THEN THE DC *14400214
144003*       TRYING TO CHECK USE THE TRIP -  HARD STOP                *14400314
144004*    -  IF DEPARTED TRIP AND ARRIVED DC IS THE SAME DC THAT IS   *14400414
144005*       TRYING TO CHECK USING THE TRIP  -- IF THE TRIP DEPARTED  *14400514
144006*       BEFORE THE DEPART CUT OFF DAYS (PARM RFDPRT) HARD STOP   *14400614
144010******************************************************************14401014
144013 7520-DEPARTED-CHECKS.                                            14401316
144014     PERFORM 7530-GET-ARRIVED-DC.                                 14401420
144015     IF  SU001-CURR-OPER-UNT-ID  =  PV-ARRIVED-DC                 14401524
144016         PERFORM 7540-GET-DEPARTED-DAYS                           14401613
144017         PERFORM 7550-GET-DEPARTED-TMST                           14401714
144018                                                                  14401832
144019         IF  PV-TRIP-STATUS-TIMESTAMP  >=  PV-DEPART-TMST         14401914
144020             SET PS-TRIP-DEPARTED-ENDED                           14402032
144021                 SU001-STAT-WARNG-MESSGE-DEP                      14402132
144023                 SU001-TRIP-NOT-CONFIRMED TO TRUE                 14402332
144024         ELSE                                                     14402429
144025             SET PS-TRIP-DEPARTED-ENDED                           14402532
144026                 SU001-DEPARTED-AFTER-DAYS                        14402633
144027                 SU001-HARD-STOP-CANT-USE TO TRUE                 14402735
144028                                                                  14402832
144029             MOVE  SPACES           TO  PV-CSSL-MSG-AREA          14402925
144030             MOVE  SU001-CURR-OPER-UNT-ID                         14403024
144031                                    TO  PV-DISPLAY-OPER-UNT-ID    14403124
144032             MOVE  TRIPST-TRIP-ID   TO  PV-DISPLAY-TRIP           14403214
144033             MOVE  PV-DEPART-DAYS   TO  PV-DISPLAY-DEPART         14403317
144034             STRING  ' SUKRF529- '                                14403429
144035                     ' TRIP:'        PV-DISPLAY-TRIP              14403530
144036                     ' DEPART-TMST:' PV-DEPART-TMST               14403617
144037                     ' TRIP-TMST:'   PV-TRIP-STATUS-TIMESTAMP     14403717
144038                     ' HARD STOP - CANT USE'                      14403817
144039                                        DELIMITED BY SIZE         14403924
144040                                  INTO  PV-CSSL-MSG-AREA          14404026
144041             MOVE LENGTH OF PV-CSSL-MSG-AREA                      14404129
144042                                    TO PV-COMMAREA-LENGTH         14404229
144043             EXEC CICS                                            14404329
144044                  WRITEQ TD                                       14404429
144045                   QUEUE  ('CSSL')                                14404529
144046                    FROM  (PV-CSSL-MSG-AREA)                      14404629
144047                  LENGTH  (PV-COMMAREA-LENGTH)                    14404729
144048                    RESP  (PV-CICS-RESP)                          14404829
144049             END-EXEC                                             14404929
144052         END-IF                                                   14405229
144053     ELSE                                                         14405329
144054         SET PS-TRIP-DEPARTED-ENDED                               14405432
144055             SU001-DEPARTED-DIFF-DC                               14405533
144056             SU001-HARD-STOP-CANT-USE TO TRUE                     14405635
144057                                                                  14405732
144058         MOVE  SPACES           TO  PV-CSSL-MSG-AREA              14405829
144059         MOVE  SU001-CURR-OPER-UNT-ID                             14405929
144060                                    TO  PV-DISPLAY-OPER-UNT-ID    14406029
144061         MOVE  PV-ARRIVED-DC    TO  PV-DISPLAY-ARRIVED            14406129
144062         MOVE  TRIPST-TRIP-ID   TO  PV-DISPLAY-TRIP               14406229
144063         STRING  ' SUKRF529-DEPARTED TRIP:' PV-DISPLAY-TRIP       14406330
144064                 '  ARRIVED DC:' PV-DISPLAY-ARRIVED               14406429
144065                 '  WRONG DC:'   PV-DISPLAY-OPER-UNT-ID           14406529
144066                 ' HARD STOP - CANT USE'                          14406629
144067                                        DELIMITED BY SIZE         14406729
144068                                  INTO  PV-CSSL-MSG-AREA          14406829
144069             MOVE LENGTH OF PV-CSSL-MSG-AREA                      14406929
144070                                    TO PV-COMMAREA-LENGTH         14407029
144071         EXEC CICS                                                14407129
144072              WRITEQ TD                                           14407229
144073               QUEUE  ('CSSL')                                    14407329
144074                FROM  (PV-CSSL-MSG-AREA)                          14407429
144075              LENGTH  (PV-COMMAREA-LENGTH)                        14407529
144076                RESP  (PV-CICS-RESP)                              14407629
144077         END-EXEC                                                 14407729
144078     END-IF.                                                      14407829
144079                                                                  14407929
144080                                                                  14408029
144081 7530-GET-ARRIVED-DC.                                             14408129
144082                                                                  14408229
144083     EXEC SQL                                                     14408329
144084        SELECT   OPER_UNT_ID                                      14408429
144085          INTO  :PV-ARRIVED-DC                                    14408529
144086          FROM   TTRIPST                                          14408629
144087         WHERE   TRIP_ID          = :TRIPST-TRIP-ID               14408729
144088           AND   TRIP_STATUS_CDE  = 'AR'                          14408829
144089     END-EXEC.                                                    14408929
144090                                                                  14409029
144091     EVALUATE TRUE                                                14409129
144092         WHEN SQLCODE = ZERO                                      14409229
144093              CONTINUE                                            14409329
144094         WHEN SQLWARN0 NOT = SPACES                               14409429
144095         WHEN SQLCODE NOT EQUAL ZERO                              14409529
144096             MOVE '7530-GET-ARRIVED-DC'                           14409629
144097                             TO DP013-PARAGRAPH                   14409729
144098             MOVE 'GET ARRIVED DC '                               14409829
144099                             TO DP013-MESSAGE-TEXT(1)             14409929
144100             MOVE  TRIPST-TRIP-ID  TO  PV-DISPLAY-TRIP            14410029
144101             MOVE  SQLCODE         TO  PV-DISPLAY-SQLCODE         14410129
144102             STRING 'TRIP:'  PV-DISPLAY-TRIP '  '                 14410229
144103                    'SQL:'   PV-DISPLAY-SQLCODE                   14410329
144104                                       DELIMITED BY SIZE          14410429
144105                                 INTO DP013-MESSAGE-TEXT(2)       14410529
144106             MOVE SQLCA            TO DP013-SQLCA                 14410629
144107             MOVE 'TTRIPST'        TO DP013-DB2-TABLE-NAME(1)     14410729
144108             SET DP013-DB2-ABEND                                  14410829
144109                 DP013-NO-ROLLBACK                                14410929
144110                 DP013-XCTL-DISPLAY-RESTART                       14411029
144111                                   TO TRUE                        14411129
144112             PERFORM DP014-0000-PROCESS-ABEND                     14411229
144113     END-EVALUATE.                                                14411329
144114                                                                  14411429
144115                                                                  14411529
144116 7540-GET-DEPARTED-DAYS.                                          14411629
144117                                                                  14411729
144118     EXEC SQL                                                     14411829
144119          SELECT FUNC_QTY                                         14411929
144120               , CURRENT TIMESTAMP - (FUNC_QTY) DAYS              14412029
144121            INTO :PV-DEPART-DAYS                                  14412129
144122               , :PV-DEPART-TMST                                  14412229
144123            FROM TKRPRPM                                          14412329
144124           WHERE LOC_ID            = :DK-OPER-UNT-ID              14412429
144125             AND INTFC_SYS_CDE    = 'KHL'                         14412529
144126             AND SYS_PRC_FUNC_CDE = 'RFDPRT'                      14412629
144127             AND FUNC_PRC_STAT_CDE = 'AC'                         14412729
144128     END-EXEC.                                                    14412829
144129                                                                  14412929
144130     EVALUATE TRUE                                                14413029
144131         WHEN SQLCODE = ZERO                                      14413129
144132             CONTINUE                                             14413229
144133         WHEN SQLWARN0 NOT = SPACES                               14413329
144134         WHEN SQLCODE NOT EQUAL ZERO                              14413429
144135             MOVE '7540-GET-DEPARTED-DAYS'                        14413529
144136                             TO DP013-PARAGRAPH                   14413629
144137             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        14413729
144138             STRING 'OPER UNIT: '      DELIMITED BY SIZE          14413829
144139                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          14413929
144140                           INTO DP013-MESSAGE-TEXT(1)             14414029
144141             MOVE SQLCA          TO DP013-SQLCA                   14414129
144142             MOVE 'TKRPRPM '     TO DP013-DB2-TABLE-NAME(1)       14414229
144143             SET DP013-DB2-ABEND                                  14414329
144144                 DP013-NO-ROLLBACK                                14414429
144145                 DP013-XCTL-DISPLAY-RESTART  TO  TRUE             14414529
144146             PERFORM DP014-0000-PROCESS-ABEND                     14414629
144147     END-EVALUATE.                                                14414729
144148                                                                  14414829
144149                                                                  14414929
144150 7550-GET-DEPARTED-TMST.                                          14415029
144151                                                                  14415129
144152     EXEC SQL                                                     14415229
144153        SELECT TIMESTAMP(STATUS_DTE, STATUS_TME)                  14415329
144154          INTO :PV-TRIP-STATUS-TIMESTAMP                          14415429
144155          FROM  TTRIPST                                           14415529
144156         WHERE  TRIP_ID     = :TRIPST-TRIP-ID                     14415629
144157           AND  TRIP_STATUS_CDE  = 'DP'                           14415729
144158     END-EXEC.                                                    14415829
144159                                                                  14415929
144160     EVALUATE TRUE                                                14416029
144161         WHEN SQLCODE = ZERO                                      14416129
144162             CONTINUE                                             14416229
144163         WHEN SQLCODE = +100                                      14416329
144164              PERFORM 7560-MAX-TRIP-TMST                          14416429
144165                                                                  14416529
144166         WHEN SQLWARN0 NOT = SPACES                               14416614
144167         WHEN SQLCODE NOT EQUAL ZERO                              14416714
144168             MOVE '7550-GET-DEPARTED-TMST'                        14416814
144169                             TO DP013-PARAGRAPH                   14416914
144170             MOVE 'GET TRIP DEPARTED TIMESTAMP'                   14417014
144171                             TO DP013-MESSAGE-TEXT(1)             14417114
144172             MOVE PV-MANIFEST                                     14417214
144173                             TO DP013-MESSAGE-TEXT(2)             14417314
144174             MOVE SQLCA      TO DP013-SQLCA                       14417414
144175             MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME(1)           14417514
144176             SET DP013-DB2-ABEND                                  14417614
144177                 DP013-NO-ROLLBACK                                14417714
144179                 DP013-XCTL-DISPLAY-RESTART  TO  TRUE             14417914
144181             PERFORM DP014-0000-PROCESS-ABEND                     14418114
144182     END-EVALUATE.                                                14418214
144183                                                                  14418314
144184                                                                  14418414
144185 7560-MAX-TRIP-TMST.                                              14418514
144186     EXEC SQL                                                     14418614
144188        SELECT TIMESTAMP(B.STATUS_DTE, B.STATUS_TME)              14418814
144190          INTO :PV-TRIP-STATUS-TIMESTAMP                          14419014
144191          FROM  TTRIPST B                                         14419114
144192         WHERE  B.TRIP_ID     = :TRIPST-TRIP-ID                   14419214
144193           AND  TIMESTAMP(B.STATUS_DTE, B.STATUS_TME)             14419314
144194                IN                                                14419414
144195                (SELECT                                           14419514
144196                       MAX(TIMESTAMP(A.STATUS_DTE, A.STATUS_TME)) 14419614
144197                 FROM   TTRIPST A                                 14419714
144198                 WHERE  A.TRIP_ID     = B.TRIP_ID                 14419814
144199                  )                                               14419914
144200     END-EXEC.                                                    14420014
144201                                                                  14420114
144202     EVALUATE TRUE                                                14420214
144203         WHEN SQLCODE = ZERO                                      14420314
144204         WHEN SQLCODE = -811                                      14420414
144205              CONTINUE                                            14420514
144225         WHEN SQLWARN0 NOT = SPACES                               14422514
144226         WHEN SQLCODE NOT EQUAL ZERO                              14422614
144227             MOVE '7560-MAX-TRIP-TMST'                            14422714
144228                             TO DP013-PARAGRAPH                   14422814
144229             MOVE 'GET MAX TRIP TIMESTAMP'                        14422914
144230                             TO DP013-MESSAGE-TEXT(1)             14423014
144231             MOVE PV-MANIFEST                                     14423114
144232                             TO DP013-MESSAGE-TEXT(2)             14423214
144233             MOVE SQLCA      TO DP013-SQLCA                       14423314
144234             MOVE 'TTRIPST'  TO DP013-DB2-TABLE-NAME(1)           14423414
144235             SET DP013-DB2-ABEND                                  14423514
144237                 DP013-NO-ROLLBACK                                14423714
144239                 DP013-XCTL-DISPLAY-RESTART  TO  TRUE             14423914
144241             PERFORM DP014-0000-PROCESS-ABEND                     14424114
144242     END-EVALUATE.                                                14424214
144243                                                                  14424314
144244                                                                  14424414
144245*  DMH - 11/21/08 - END                                           14424514
144246                                                                  14424614
144247                                                                  14424714
144248 8000-SEND-MAP.                                                   14424802
144250                                                                  14425002
144300     EXEC CICS                                                    14430002
144400         SEND MAP       ('SU529A')                                14440002
144500              MAPSET    ('SUKM529')                               14450002
144600              ERASE                                               14460002
144700              CURSOR                                              14470002
144800              RESP      (PV-CICS-RESPONSE)                        14480002
144900     END-EXEC.                                                    14490002
145000                                                                  14500002
145100     EVALUATE TRUE                                                14510002
145200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14520002
145300             CONTINUE                                             14530002
145400         WHEN OTHER                                               14540002
145500             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         14550002
145600             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  14560002
145700             SET DP013-CICS-ABEND      TO TRUE                    14570002
145800             SET DP013-NO-ROLLBACK     TO TRUE                    14580002
145900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14590002
146000     END-EVALUATE.                                                14600002
146100                                                                  14610002
146200 8010-SEND-DATA-ONLY.                                             14620002
146300                                                                  14630002
146400     EXEC CICS                                                    14640002
146500         SEND MAP       ('SU529A')                                14650002
146600              MAPSET    ('SUKM529')                               14660002
146700              CURSOR                                              14670002
146800              DATAONLY                                            14680002
146900              RESP      (PV-CICS-RESPONSE)                        14690002
147000     END-EXEC.                                                    14700002
147100                                                                  14710002
147200     EVALUATE TRUE                                                14720002
147300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14730002
147400             CONTINUE                                             14740002
147500         WHEN OTHER                                               14750002
147600             MOVE '8010-SEND-DATA-ONLY' TO DP013-PARAGRAPH        14760002
147700             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 14770002
147800             SET DP013-CICS-ABEND       TO TRUE                   14780002
147900             SET DP013-NO-ROLLBACK      TO TRUE                   14790002
148000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14800002
148100     END-EVALUATE.                                                14810002
148200*                                                                 14820002
148300*                                                                 14830002
148400 8020-RETURN-TRANID.                                              14840002
148500                                                                  14850002
148600     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           14860002
148700     EXEC CICS                                                    14870002
148800         RETURN TRANSID  (PC-TRANID)                              14880002
148900                COMMAREA (CA-COMMAREA)                            14890002
149000                LENGTH   (PV-COMMAREA-LENGTH)                     14900002
149100                RESP     (PV-CICS-RESPONSE)                       14910002
149200     END-EXEC.                                                    14920002
149300                                                                  14930002
149400     EVALUATE TRUE                                                14940002
149500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14950002
149600             CONTINUE                                             14960002
149700         WHEN OTHER                                               14970002
149800             MOVE '8020-RETURN-TRANIND' TO DP013-PARAGRAPH        14980002
149900             MOVE 'UNABLE TO RETURN TO TRANID'                    14990002
150000                 TO DP013-MESSAGE-TEXT (1)                        15000002
150100             SET DP013-CICS-ABEND       TO TRUE                   15010002
150200             SET DP013-NO-ROLLBACK      TO TRUE                   15020002
150300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15030002
150400     END-EVALUATE.                                                15040002
150500                                                                  15050002
150600 8030-RECEIVE-MAP.                                                15060002
150700                                                                  15070002
150800     EXEC CICS                                                    15080002
150900         RECEIVE MAP    ('SU529A')                                15090002
151000                 MAPSET ('SUKM529')                               15100002
151100                 RESP   (PV-CICS-RESPONSE)                        15110002
151200     END-EXEC.                                                    15120002
151300                                                                  15130002
151400     EVALUATE TRUE                                                15140002
151500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15150002
151600* 1/29/04    PERFORM 2110-RECEIVE-SCREEN-FIELDS                   15160002
151700         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                15170002
151800             CONTINUE                                             15180002
151900         WHEN OTHER                                               15190002
152000            MOVE '8030-RECEIVE-MAP'      TO DP013-PARAGRAPH       15200002
152100            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)15210002
152200            SET DP013-LOGIC-ABEND        TO TRUE                  15220002
152300            SET DP013-NO-ROLLBACK        TO TRUE                  15230002
152400            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                15240002
152500     END-EVALUATE.                                                15250002
152600*                                                                 15260002
152700/                                                                 15270002
152800 8100-XCTL-TO-HELP.                                               15280002
152900                                                                  15290002
153000     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      15300002
153100     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    15310002
153200     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    15320002
153300                                                                  15330002
153400     EXEC CICS                                                    15340002
153500         XCTL                                                     15350002
153600             PROGRAM   (PV-TRANSFER-PROGRAM)                      15360002
153700             COMMAREA  (PC192-COMMAREA)                           15370002
153800             LENGTH    (PV-COMMAREA-LENGTH)                       15380002
153900             RESP      (PV-CICS-RESPONSE)                         15390002
154000     END-EXEC.                                                    15400002
154100                                                                  15410002
154200     EVALUATE TRUE                                                15420002
154300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15430002
154400              CONTINUE                                            15440002
154500         WHEN OTHER                                               15450002
154600             MOVE '8100-XCTL-TO-HELP '                            15460002
154700                 TO DP013-PARAGRAPH                               15470002
154800             MOVE 'SUKRF529 - UNABLE TO XCTL TO PROGRAM: '        15480002
154900                 TO DP013-MESSAGE-TEXT (1)                        15490002
155000             MOVE PV-TRANSFER-PROGRAM                             15500002
155100                 TO DP013-MESSAGE-TEXT (2)                        15510002
155200             SET DP013-CICS-ABEND  TO TRUE                        15520002
155300             SET DP013-ROLLBACK TO TRUE                           15530002
155400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15540002
155500             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             15550002
155600             SET SU001-PROCESS-SCREEN TO TRUE                     15560002
155700             PERFORM 8000-SEND-MAP                                15570002
155800             PERFORM 8020-RETURN-TRANID                           15580002
155900     END-EVALUATE.                                                15590002
156000                                                                  15600002
156100 8110-XCTL-ERROR-SCREEN.                                          15610002
156200                                                                  15620002
156300     MOVE CA-COMMAREA                 TO DL010-HOST-SAVE-AREA     15630002
156400     IF NOT DL010-ABEND                                           15640002
156500         SET DL010-INITIALIZE-SCREEN  TO TRUE                     15650002
156600     END-IF                                                       15660002
156700     MOVE DFHEIBLK                    TO DL010-DFHEIBLK.          15670002
156800     MOVE PC-CURRENT-PROGRAM-NAME     TO DL010-LAST-PROGRAM.      15680002
156900     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH       15690002
157000     MOVE 'DLKRF456'                  TO PV-TRANSFER-PROGRAM      15700002
157100                                                                  15710002
157200     IF DL010-PGM-MSG-NBR = ZERO                                  15720002
157300*        UNDEFINED ERROR                                          15730002
157400         MOVE 1                       TO DL010-PGM-MSG-NBR        15740002
157500     END-IF                                                       15750002
157600*                                                                 15760002
157700     EXEC CICS                                                    15770002
157800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    15780002
157900               COMMAREA  (DL010-COMMAREA)                         15790002
158000               LENGTH    (PV-COMMAREA-LENGTH)                     15800002
158100               RESP      (PV-CICS-RESPONSE)                       15810002
158200     END-EXEC.                                                    15820002
158300                                                                  15830002
158400     EVALUATE TRUE                                                15840002
158500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15850002
158600             CONTINUE                                             15860002
158700         WHEN OTHER                                               15870002
158800             MOVE '8110-XCTL-ERROR-SCREEN'                        15880002
158900                                      TO DP013-PARAGRAPH          15890002
159000             MOVE 'SUKRF529 - UNABLE TO XCTL TO PROGRAM: '        15900002
159100                                      TO DP013-MESSAGE-TEXT (1)   15910002
159200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   15920002
159300             SET DP013-CICS-ABEND                                 15930002
159400                 DP013-ROLLBACK       TO TRUE                     15940002
159500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15950002
159600             MOVE PC-TRANS-UNAVAILABLE-MSG                        15960002
159700                                      TO AMSGLNO                  15970002
159800             SET DL010-PROCESS-SCREEN TO TRUE                     15980002
159900             PERFORM 8000-SEND-MAP                                15990002
160000             PERFORM 8020-RETURN-TRANID                           16000002
160100     END-EVALUATE.                                                16010002
160200                                                                  16020002
160300 8120-XCTL-LRT-MENU.                                              16030002
160400     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     16040002
160500     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          16050002
160600                                                                  16060002
160700     MOVE LENGTH OF CA-COMMAREA    TO PV-COMMAREA-LENGTH          16070002
160800     EXEC CICS                                                    16080002
160900         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16090002
161000               COMMAREA  (CA-COMMAREA)                            16100002
161100               LENGTH    (PV-COMMAREA-LENGTH)                     16110002
161200               RESP      (PV-CICS-RESPONSE)                       16120002
161300     END-EXEC.                                                    16130002
161400                                                                  16140002
161500     EVALUATE TRUE                                                16150002
161600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16160002
161700             CONTINUE                                             16170002
161800         WHEN OTHER                                               16180002
161900             MOVE '8120-XCTL-TO-LRT-MENU'                         16190002
162000                 TO DP013-PARAGRAPH                               16200002
162100             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   16210002
162200                 TO DP013-MESSAGE-TEXT (1)                        16220002
162300             MOVE PV-TRANSFER-PROGRAM                             16230002
162400                 TO DP013-MESSAGE-TEXT (2)                        16240002
162500             SET DP013-CICS-ABEND  TO TRUE                        16250002
162600             SET DP013-NO-ROLLBACK TO TRUE                        16260002
162700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16270002
162800             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             16280002
162900             SET SU001-PROCESS-SCREEN TO TRUE                     16290002
163000             PERFORM 8000-SEND-MAP                                16300002
163100             PERFORM 8020-RETURN-TRANID                           16310002
163200     END-EVALUATE.                                                16320002
163300/                                                                 16330002
163400 8130-XCTL-P4-SYSTEM.                                             16340002
163500     SET DL010-INITIALIZE-SCREEN                                  16350002
163600         DL010-ENABLE-FKEYS-YES       TO TRUE                     16360002
163700     MOVE 3                           TO DL010-SELECTION          16370002
163800     MOVE SU001-CURR-OPER-UNT-ID      TO DL010-OPER-UNT-ID        16380002
163900     MOVE SU001-USER-ID               TO DL010-KEYED-USERID       16390002
164000     PERFORM DP026-0000-GET-LOGON-INFO                            16400002
164100     MOVE DP026-USERID                TO DL010-USERID             16410002
164200                                                                  16420002
164300     INITIALIZE DL010-HOST-SAVE-AREA                              16430002
164400     MOVE SU001-COMMON-DATA           TO DL010-HOST-SAVE-AREA     16440002
164500                                                                  16450002
164600     MOVE PC-CURRENT-PROGRAM-NAME     TO DL010-LAST-PROGRAM       16460002
164700     MOVE 'SUKRF501'                  TO DL010-MENU-PROGRAM       16470002
164800     MOVE 'DLKRF452'                  TO PV-TRANSFER-PROGRAM      16480002
164900                                                                  16490002
165000     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH       16500002
165100                                                                  16510002
165200     EXEC CICS                                                    16520002
165300         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    16530002
165400               COMMAREA  (DL010-COMMAREA)                         16540002
165500               LENGTH    (PV-COMMAREA-LENGTH)                     16550002
165600               RESP      (PV-CICS-RESPONSE)                       16560002
165700     END-EXEC.                                                    16570002
165800                                                                  16580002
165900     EVALUATE TRUE                                                16590002
166000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16600002
166100             CONTINUE                                             16610002
166200         WHEN OTHER                                               16620002
166300             MOVE '8130-XCTL-P4-SYSTEM'                           16630002
166400                 TO DP013-PARAGRAPH                               16640002
166500             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   16650002
166600                 TO DP013-MESSAGE-TEXT (1)                        16660002
166700             MOVE PV-TRANSFER-PROGRAM                             16670002
166800                 TO DP013-MESSAGE-TEXT (2)                        16680002
166900             SET DP013-CICS-ABEND  TO TRUE                        16690002
167000             SET DP013-NO-ROLLBACK TO TRUE                        16700002
167100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16710002
167200             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             16720002
167300             SET SU001-PROCESS-SCREEN TO TRUE                     16730002
167400             PERFORM 8000-SEND-MAP                                16740002
167500             PERFORM 8020-RETURN-TRANID                           16750002
167600     END-EVALUATE.                                                16760002
167700/                                                                 16770002
167800 8200-SYNCPOINT.                                                  16780002
167900     EXEC CICS                                                    16790002
168000         SYNCPOINT                                                16800002
168100     END-EXEC.                                                    16810002
168200/                                                                 16820002
168300 8300-RETURN.                                                     16830002
168400                                                                  16840002
168500     EXEC CICS                                                    16850002
168600         SEND FROM (PV-MESSAGE-AREA)                              16860002
168700              LENGTH (19)                                         16870002
168800              ERASE                                               16880002
168900     END-EXEC.                                                    16890002
169000                                                                  16900002
169100     EXEC CICS                                                    16910002
169200         RETURN                                                   16920002
169300     END-EXEC.                                                    16930002
169400                                                                  16940002
169500 8400-CALL-DLKUP001.                                              16950002
169600                                                                  16960002
169700     INITIALIZE DL001-ASGMT-COMMAREA.                             16970002
169800                                                                  16980002
169900     SET DL001-BY-ASGMT-KEY                                       16990002
170000         DL001-COMMIT-UPDATE                                      17000002
170100         DL001-FIND-NEXT-ASGMT        TO TRUE                     17010002
170200                                                                  17020002
170300     MOVE SU001-ASGMT-STRT-DTE        TO DL001-KEY-START-DTE      17030002
170400     MOVE SU001-ASGMT-NBR-TXT         TO DL001-KEY-NBR-TXT        17040002
170500     MOVE SU001-ASGMT-NBR-SEQ-NBR     TO DL001-KEY-NBR-SEQ-NBR    17050002
170600                                                                  17060002
170700     MOVE 1                          TO DL001-NBR-OF-NBRS-NEED-QTY17070002
170800     MOVE PC-CURRENT-PROGRAM-NAME     TO DL001-ORIG-CALLING-PGM-NM17080002
170900                                                                  17090002
171000     CALL DL001-USER-PGM USING DFHEIBLK                           17100002
171100                               DL001-COMMAREA                     17110002
171200                               DL001-ASGMT-COMMAREA               17120002
171300                                                                  17130002
171400     IF DL001-SUCCESSFUL                                          17140002
171500*       *  ASSIGNMENT SENT IN HAS BEEN CLOSED, DLKUP001 HAS SENT *17150002
171600*       *  BACK CURRENT OPEN ASSIGNMENT.                         *17160002
171700        IF DL001-ASGMT-NEXT-USED                                  17170002
171800           MOVE DL001-NXT-START-DTE   TO SU001-ASGMT-STRT-DTE     17180002
171900           MOVE DL001-NXT-NBR-TXT     TO SU001-ASGMT-NBR-TXT      17190002
172000           MOVE DL001-NXT-NBR-SEQ-NBR TO SU001-ASGMT-NBR-SEQ-NBR  17200002
172100        END-IF                                                    17210002
172200*    ELSE                                                         17220002
172300*        XCTL TO ERROR SCREEN                                     17230002
172400*        CONTINUE                                                 17240002
172500     END-IF.                                                      17250002
172600/                                                                 17260002
172610******************************************************************17261057
172620*GB 7/01/14 ADDED LOGIC TO CREATE NEW EVENT ASSIGNMENT USER ADD   17262057
172621*   FOR LM LABOR THIS WILL CREATE VISIBILITY FOR THE 'HELPER'     17262157
172622*   ROLE WHERE THE ASSOCIATE IS ON A TEAM, BUT NOT CREATING       17262257
172623*   ACTUAL EVENTS TO THE DATABASE.                                17262357
172630******************************************************************17263057
172700 8410-CALL-XLKUP033.                                              17270002
172800                                                                  17280002
172900     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         17290002
173000                SU050-DTL-TXT-AREA                                17300002
173100     IF DL010-FIRST-TRIP-SCAN-NO                                  17310041
173101       SET XL072-PC-APP-ID         TO TRUE                        17310141
173102       MOVE 'DC LABOR'             TO XL072-EVNT-OBJ-TXT          17310241
173103       MOVE 'ASSIGNMENT USER ADD'  TO XL072-EVNT-OBJ-ACTN-TXT     17310341
173104                                                                  17310441
173105       MOVE SU001-USER-ID           TO XL072-CRE-BY-USR-ID        17310541
173106       MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM           17310641
173107       MOVE 'N/A'                   TO XL072-DTL-COPYBOOK-NM      17310741
173108                                                                  17310841
173109       MOVE SU001-ASGMT-NBR-SEQ-NBR TO XL072-EVNT-KY-1-NBR        17310941
173110       MOVE SU001-CURR-OPER-UNT-ID  TO XL072-EVNT-KY-2-NBR        17311041
173111                                                                  17311141
173112       MOVE SU001-ASGMT-NBR-TXT TO XL072-EVNT-KY-1-TXT            17311241
173114       MOVE DL016-EAI-WK-AREA-DESC  TO    XL072-EVNT-KY-3-TXT     17311441
173115       MOVE DL016-EAI-WK-TYP-DESC   TO XL072-EVNT-KY-4-TXT        17311541
173116                                                                  17311641
173125       MOVE SU001-ASGMT-STRT-DTE    TO PV-START-TMST-DATE         17312554
173127       MOVE '-'                     TO PV-DASH-1                  17312750
173128                                       PV-DASH-2                  17312850
173129                                       PV-DASH-3                  17312950
173130       MOVE PV-START-TMST           TO XL072-EVNT-KY-1-TMST       17313050
173131**GB 09/21/15                                                     17313161
173132       IF PS-CREATE-MAN-ADD-YES                                   17313261
173133          MOVE DLT00003-KOHLS-USR-ID TO XL072-EVNT-KY-2-TXT       17313361
173135       ELSE                                                       17313561
173136          MOVE SU001-USER-ID         TO XL072-EVNT-KY-2-TXT       17313672
173139       END-IF                                                     17313970
173140**GB 09/21/15                                                     17314070
173141**GB 10/16/15 ADD CHECK TO USE THE SU001-USER-ID TO SELECT        17314174
173142**GB THE JOIN TMST FOR BOTH THE ASSOCIATE CREATING THE TEAM AS    17314274
173143**GB WELL AS FOR THE PRIOR INDIVIDUAL                             17314374
173144                                                                  17314474
173145       MOVE SU001-USER-ID         TO DLT00003-KOHLS-USR-ID        17314574
173146       PERFORM 5300-SEL-ASGMT-STRT-TMST                           17314674
173147       MOVE DLT00003-JN-TMST        TO   XL072-EVNT-KY-2-TMST     17314774
173148                                                                  17314874
173149       SET XL072-COMMIT-UPDATE  TO TRUE                           17314974
173150       MOVE PC-CURRENT-PROGRAM-NAME TO XL072-ORIG-CALLING-PGM-NM  17315074
173151                                                                  17315174
173160     ELSE                                                         17316041
173200       SET XL072-SU-APP-ID          TO TRUE                       17320042
173300       MOVE 'RECEIVING'                 TO XL072-EVNT-OBJ-TXT     17330041
173400       MOVE 'TRAILER OPEN'          TO XL072-EVNT-OBJ-ACTN-TXT    17340041
173500       MOVE SU001-USER-ID           TO XL072-CRE-BY-USR-ID        17350041
173600       MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM           17360041
173700       MOVE SU001-MANIFEST          TO XL072-EVNT-KY-1-NBR        17370041
173800                                                                  17380041
173900       MOVE SU001-BATCH-NUMBER      TO XL072-EVNT-KY-2-NBR        17390041
174000       MOVE SU001-USER-ID           TO XL072-EVNT-KY-1-TXT        17400041
174100       SET XL072-DO-NOT-COMMIT-UPDATE TO TRUE                     17410041
174200       MOVE PC-CURRENT-PROGRAM-NAME TO XL072-ORIG-CALLING-PGM-NM  17420041
174300                                                                  17430041
174400       SET XL072-SUWS050-COPYBOOK TO TRUE                         17440041
174500                                                                  17450002
174600       SET SU050-OPEN-INBND-TRLR     TO TRUE                      17460041
174700       MOVE SU001-ASGMT-STRT-DTE     TO SU050-AB-ASGMT-STRT-DTE   17470041
174800       MOVE SU001-ASGMT-NBR-TXT      TO SU050-AB-ASGMT-NBR-TXT    17480041
174900       MOVE SU001-ASGMT-NBR-SEQ-NBR  TO SU050-AB-ASGMT-NBR-SEQ-NBR17490041
175000       MOVE DL001-SEQ-START-NBR      TO SU050-AB-ASGMT-SEQ-DTL-NBR17500041
175100       MOVE SU001-DOOR-ID            TO SU050-AB-DOOR-NBR         17510041
175200       MOVE SU050-DTL-TXT-AREA       TO XL072-DTL-TXT             17520041
175300     END-IF.                                                      17530042
175310                                                                  17531042
175400     CALL XL072-USER-PGM USING DFHEIBLK                           17540002
175500                               XL072-COMMAREA                     17550002
175600                               XL072-EAI-EXPORT-COMMAREA          17560002
175700                                                                  17570002
175800     IF XL072-SUCCESSFUL                                          17580002
175900        CONTINUE                                                  17590002
176000     ELSE                                                         17600002
176100        CONTINUE                                                  17610002
176200     END-IF.                                                      17620002
176300                                                                  17630002
176400*    XCTL TO ERROR SCREEN HERE                                    17640002
176500                                                                  17650002
176600*       STRING PC-CURRENT-PROGRAM-NAME                            17660002
176700*              ' - ERROR FROM XLKUP033 - '                        17670002
176800*              XL072-RETURN-CODE                                  17680002
176900*              ' - OBJECT TXT - '                                 17690002
177000*              XL072-EVNT-OBJ-TXT                                 17700002
177100*              ' - CRE USR - '                                    17710002
177200*              XL072-CRE-BY-USR-ID                                17720002
177300*              DELIMITED BY SIZE                                  17730002
177400*              INTO PV-CICS-MSG-AREA                              17740002
177500*       PERFORM 9990-WRITE-CICS                                   17750002
177600*                                                                 17760002
177700*       STRING 'OBJECT ACTN TXT ---> '                            17770002
177800*              XL072-EVNT-OBJ-ACTN-TXT                            17780002
177900*              ' CRE PGM - '                                      17790002
178000*              XL072-CRE-PGM-NM                                   17800002
178100*              PV-BLANKS                                          17810002
178200*              DELIMITED BY SIZE                                  17820002
178300*              INTO PV-CICS-MSG-AREA                              17830002
178400*       PERFORM 9990-WRITE-CICS                                   17840002
178500*                                                                 17850002
178600*       SET  DP013-OTHER-ABEND TO TRUE                            17860002
178700*       SET  DP013-NO-ROLLBACK TO TRUE                            17870002
178800*       MOVE '4200-CALL-XLKUP033' TO DP013-PARAGRAPH              17880002
178900*    END-IF.                                                      17890002
179000/                                                                 17900002
179100                                                                  17910002
179200*8440-CALL-DLKUP003.                                              17920002
179300*    CONTINUE.                                                    17930002
179400 8450-LINK-DLKCS410.                                              17940002
179500     INITIALIZE DL016-PGM-COMMAREA                                17950002
179600     SET DL016-ESTABLISH-ASGMT        TO TRUE                     17960002
179700     SET DL016-DO-NOT-COMMIT-UPDATE   TO TRUE                     17970002
179800     MOVE 'SUKRF529'                  TO DL016-CALLING-PGM-NM     17980002
179900     MOVE SU001-USER-ID               TO DL016-SIGN-ON-USR-ID     17990002
180000                                                                  18000002
180100     SET DL011-RECV-WRK-TYP           TO TRUE                     18010002
180200     MOVE DL011-KEY-WK-TYP            TO DL016-ASGMT-NBR-WRK-TYP  18020002
180300                                                                  18030002
180400     IF SU001-DOOR-ID = 'FLAT' OR 'TRBL' OR 'CAGE'                18040002
180410                     OR 'PLT'  OR 'MISC' OR '2LFT'                18041011
180420                     OR 'SETS' OR 'SPEC' OR 'FLOW'                18042010
180430                     OR 'SHTL' OR 'CONS' OR 'STRP'                18043010
180440                     OR 'JEWL' OR 'CPBS'                          18044011
180500         MOVE SU001-DOOR-ID          TO DL011-RF-WRK-AREA-DOOR-NBR18050002
180600         MOVE SU001-USER-ID          TO DL011-RF-WRK-AREA-USER-ID 18060002
180700         MOVE DL011-RECV-FLAT-WRK-AREA TO DL016-EAI-WK-AREA-DESC  18070002
180800     ELSE                                                         18080002
180900         MOVE SU001-DOOR-ID          TO DL011-RD-WRK-AREA-DOOR-NBR18090002
181000         MOVE DL011-RECV-DOOR-WRK-AREA TO DL016-EAI-WK-AREA-DESC  18100002
181100     END-IF                                                       18110002
181200                                                                  18120002
181300     SET DL011-RECV-WRK-TYP           TO TRUE                     18130002
181400     MOVE DL011-KEY-WK-TYP            TO DL016-EAI-WK-TYP-DESC    18140002
181500                                                                  18150002
181600     MOVE SU001-CURR-OPER-UNT-ID      TO DL016-EAI-DC-NBR         18160002
181700     MOVE SU001-USER-ID               TO DL016-EAI-CRE-BY-USR-ID  18170002
181800     SET DL016-EAI-USR-IS-UNKNOWN     TO TRUE                     18180002
181900                                                                  18190002
182000     MOVE LENGTH OF DL016-PGM-COMMAREA                            18200002
182100                                      TO PV-COMMAREA-LENGTH       18210002
182200                                                                  18220002
182300     EXEC CICS LINK                                               18230002
182400         PROGRAM  (DL016-USER-PGM)                                18240002
182500         COMMAREA (DL016-PGM-COMMAREA)                            18250002
182600         LENGTH   (PV-COMMAREA-LENGTH)                            18260002
182700     END-EXEC.                                                    18270002
182800                                                                  18280002
182900     IF PV-CICS-RESPONSE = DFHRESP (NORMAL)                       18290002
183000                                                                  18300002
183100         EVALUATE TRUE                                            18310002
183200         WHEN DL016-SUCCESSFUL                                    18320002
183300             MOVE DL016-ESO-ASGMT-NBR-TXT                         18330002
183400                                      TO SU001-ASGMT-NBR-TXT      18340002
183500             MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR                     18350002
183600                                       TO SU001-ASGMT-NBR-SEQ-NBR 18360002
183700             MOVE DL016-ESO-ASGMT-START-DTE                       18370002
183800                                       TO SU001-ASGMT-STRT-DTE    18380002
183900             MOVE '  ASSOCIATE ADDED ' TO AMSGLNO                 18390002
184000         WHEN DL016-SQL-ERROR                                     18400002
184100             MOVE 9                   TO PV-ERROR-NBR             18410002
184200                                         DL010-ERROR-NBR          18420002
184300             MOVE SU001-USER-ID       TO DL010-USERID             18430002
184400             MOVE DL010-USERID        TO PV-LOG-USER-ID           18440002
184500             PERFORM 9903-WRITE-CICS-LOG                          18450002
184600             MOVE '8450-LINK-DLKCS410'                            18460002
184700                                      TO DL010-PARAGRAPH          18470002
184800             MOVE 'SUKRF529 - BAD RETURN FROM DLCS410'            18480002
184900                                      TO DL010-MESSAGE-TEXT(1)    18490002
185000             MOVE DL016-SQLCA         TO DL010-SQLCA              18500002
185100             SET DL010-ABEND          TO TRUE                     18510002
185200             MOVE 3                   TO DL010-PGM-MSG-NBR        18520002
185300             PERFORM 8110-XCTL-ERROR-SCREEN                       18530002
185400                                                                  18540002
185500         WHEN DL016-INVALID-ACCESS                                18550002
185600             MOVE '8650-CALL-DLKCS410' TO DP013-PARAGRAPH         18560002
185700             MOVE 'SUKRF529 - DB2 ERROR IN PROGRAM: '             18570002
185800                                      TO DP013-MESSAGE-TEXT (1)   18580002
185900             MOVE 'DLKCS410'          TO DP013-MESSAGE-TEXT (2)   18590002
186000             SET DP013-CICS-ABEND                                 18600002
186100                 DP013-ROLLBACK       TO TRUE                     18610002
186200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18620002
186300             MOVE PC-TRANS-UNAVAILABLE-MSG                        18630002
186400                                      TO AMSGLNO                  18640002
186500             SET DL010-PROCESS-SCREEN TO TRUE                     18650002
186600             MOVE -1                  TO AMANIFSTL                18660002
186700             PERFORM 8000-SEND-MAP                                18670002
186800             PERFORM 8020-RETURN-TRANID                           18680002
186900         WHEN OTHER                                               18690002
187000             MOVE '8650-CALL-DLKCS410' TO DP013-PARAGRAPH         18700002
187100             MOVE 'SUKRF529 - UNDETERMINED ERROR IN PGM: '        18710002
187200                                      TO DP013-MESSAGE-TEXT (1)   18720002
187300             MOVE DL016-ASGMT-SQLCODE TO PV-DISPLAY-SQLCODE       18730002
187400             STRING 'DLKCS410 ' DELIMITED BY SIZE                 18740002
187500                    '* RETURN CODE = ' DELIMITED BY SIZE          18750002
187600                DL016-RETURN-CODE      DELIMITED BY SIZE          18760002
187700                    ' * SQL CODE = ' DELIMITED BY SIZE            18770002
187800                PV-DISPLAY-SQLCODE  DELIMITED BY SIZE             18780002
187900                           INTO DP013-MESSAGE-TEXT(2)             18790002
188000             SET DP013-CICS-ABEND                                 18800002
188100                 DP013-ROLLBACK       TO TRUE                     18810002
188200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18820002
188300             MOVE PC-TRANS-UNAVAILABLE-MSG                        18830002
188400                                      TO AMSGLNO                  18840002
188500             SET DL010-PROCESS-SCREEN TO TRUE                     18850002
188600             MOVE -1                  TO AMANIFSTL                18860002
188700             PERFORM 8000-SEND-MAP                                18870002
188800             PERFORM 8020-RETURN-TRANID                           18880002
188900         END-EVALUATE                                             18890002
189000     ELSE                                                         18900002
189100             MOVE '8650-CALL-DLKCS410' TO DP013-PARAGRAPH         18910002
189200             MOVE 'SUKRF529 - UNDETERMINED ERROR IN PGM: '        18920002
189300                                      TO DP013-MESSAGE-TEXT (1)   18930002
189400             MOVE 'DLKCS410'          TO DP013-MESSAGE-TEXT (2)   18940002
189500             SET DP013-CICS-ABEND                                 18950002
189600                 DP013-ROLLBACK       TO TRUE                     18960002
189700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18970002
189800             MOVE PC-TRANS-UNAVAILABLE-MSG                        18980002
189900                                      TO AMSGLNO                  18990002
190000             SET DL010-PROCESS-SCREEN TO TRUE                     19000002
190100             MOVE -1                  TO AMANIFSTL                19010002
190200             PERFORM 8000-SEND-MAP                                19020002
190300             PERFORM 8020-RETURN-TRANID                           19030002
190400     END-IF.                                                      19040002
190500/                                                                 19050002
190600 9000-SOFT-ABORT.                                                 19060002
190700                                                                  19070002
190800     EXEC CICS                                                    19080002
190900         SYNCPOINT ROLLBACK                                       19090002
191000     END-EXEC.                                                    19100002
191100                                                                  19110002
191200     MOVE 2                           TO DL010-PGM-MSG-NBR        19120002
191300     MOVE SQLCODE                     TO DL010-SQLCODE            19130002
191400     MOVE SQLCA                       TO DL010-SQLCA              19140002
191500     MOVE 'S529'                      TO DL010-TRAN-ID            19150002
191600     PERFORM 8110-XCTL-ERROR-SCREEN.                              19160002
191700                                                                  19170002
191800                                                                  19180002
191900 9903-WRITE-CICS-LOG.                                             19190002
192000                                                                  19200002
192100     MOVE SQLCODE                     TO PV-SQLCODE               19210002
192200                                                                  19220002
192300     EXEC CICS                                                    19230002
192400         WRITEQ TD                                                19240002
192500             QUEUE  ('CSSL')                                      19250002
192600             FROM   (PV-LOG-MSG)                                  19260002
192700             RESP   (PV-CICS-RESPONSE)                            19270002
192800     END-EXEC.                                                    19280002
192900                                                                  19290002
193000*                                                                 19300002
193100*                                                                 19310002
193200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  19320002
193300                                                                  19330002
193400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              19340002
193500     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             19350002
193600     INITIALIZE DP013-SRC-TASK-NUMBER                             19360002
193700                DP013-STACK.                                      19370002
193800     SET DP013-LINK-RETURN TO TRUE.                               19380002
193900                                                                  19390002
194000     EXEC CICS                                                    19400002
194100         LINK                                                     19410002
194200             PROGRAM   (DP013-NAME)                               19420002
194300             COMMAREA  (DP013-PARAMETERS)                         19430002
194400             LENGTH    (DP013-LENGTH)                             19440002
194500     END-EXEC.                                                    19450002
194600/                                                                 19460002
194700     COPY DPPD026.                                                19470002
194800     COPY DPPD014.                                                19480002
194900*                                                                 19490002
