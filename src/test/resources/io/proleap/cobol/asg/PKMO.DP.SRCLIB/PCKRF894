000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300*  TRAILER MANIFESTING PROJECT - AUDIT FUNCTION SUB MENU          00030000
000400******************************************************************00040000
000500                                                                  00050000
000600 PROGRAM-ID.             PCKRF894.                                00060000
000700 AUTHOR.                 GERMAN BANDA.                            00070000
000800 INSTALLATION.           KOHLS.                                   00080000
000900 DATE-WRITTEN            JULY,2001.                               00090000
001000 DATE-COMPILED.                                                   00100000
001100                                                                  00110000
001200******************************************************************00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400******************************************************************00140000
001500                                                                  00150000
001600******************************************************************00160000
001700 DATA DIVISION.                                                   00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 WORKING-STORAGE SECTION.                                         00210000
002200******************************************************************00220000
002300 01  CA-COMMAREA.                                                 00230000
002400     COPY PCWS233.                                                00240000
002500                                                                  00250000
002600 01  DK-DB2-KEYS.                                                 00260000
002700     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00270000
002800     05  DK-SHIPT-UNT-ID                 PIC S9(18)V COMP-3.      00280000
002900     05  DK-OPER-UNT-ID                  PIC  S9(4) COMP.         00290000
003000     05  DK-CARTON-TMST                  PIC  X(26).              00300000
003100     05  DK-OTBND-TRIP-ID                PIC  S9(9) COMP.         00310000
003200                                                                  00320000
003300                                                                  00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-DEFAULT-DATE          PIC X(26)   VALUE               00350000
003600                                  '9999-09-09-09.09.09.999999'.   00360000
003700     05  PC-TRANSFER-DOWN-LENGTH         PIC S9(04)  VALUE +9     00370000
003800                                                     COMP.        00380000
003900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00390000
004000         'PCKRF894'.                                              00400000
004100     05  PC-PREV-MENU-PROGRAM            PIC  X(08)               00410000
004200                                              VALUE  'PCKRF893'.  00420000
004300     05  PC-OPEN-TRAILER-SCREEN          PIC  X(08)               00430000
004400                                              VALUE 'PCKRF870'.   00440000
004500     05  PC-STARTED-TRLR-AUDIT           PIC  X(08)               00450000
004600                                              VALUE 'PCKRF894'.   00460000
004700     05  PC-CLOSE-TRAILER-PROGRAM        PIC  X(08)               00470000
004800                                              VALUE 'PCKRF876'.   00480000
004900     05  PC-ERROR-MESSAGE-PROGRAM        PIC  X(08)               00490000
005000                                              VALUE 'PCKRF871'.   00500000
005100     05  PC-MENU-TRANID                  PIC  X(04)  VALUE 'E892'.00510000
005200     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'E894'.00520000
005300     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        00530000
005400         'END OF SESSION     '.                                   00540000
005500     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        00550000
005600         'INVALID SELECTION  '.                                   00560000
005700     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        00570000
005800         'UNRECOGNIZED PF KEY'.                                   00580000
005900     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        00590000
006000         'USER NOT AUTHORIZED'.                                   00600000
006100     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        00610000
006200         'NUMERIC VALUE REQ. '.                                   00620000
006300     05  PC-PROGRAM-FUNCTION-KEYS        PIC  X(19)  VALUE        00630000
006400         'F0 =END            '.                                   00640000
006500     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        00650000
006600         'TRANS NOT AVAILABLE'.                                   00660000
006700     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        00670000
006800         'CICS ABEND -CALL DP'.                                   00680000
006900     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        00690000
007000         'CICSAUTH BAD RETURN'.                                   00700000
007100     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        00710000
007200         'SELECTION NOT AVAIL'.                                   00720000
007300     05  PC-STARTED-TRLR-MESS            PIC X(19)   VALUE        00730000
007400         'STARTED TRLR AUDIT '.                                   00740000
007500     05  PC-CLOSED-TRLR-MESS             PIC X(19)   VALUE        00750000
007600         'CLOSED TRLR AUDIT  '.                                   00760000
007700     05  PC-CLOSED-AUDIT-MESS            PIC X(19)   VALUE        00770000
007800         'INVLD SEL-AUD CLOSD'.                                   00780000
007900     05  PC-PLS-ENT-FLD-MSG              PIC X(19) VALUE          00790000
008000                                           'PLEASE ENTER FIELD '. 00800000
008100     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               00810000
008200                                           'FIRST DIGIT NOT 0  '. 00820000
008300     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               00830000
008400                                           'MORE DIGITS REQUIRD'. 00840000
008500     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00850000
008600                                           'MUST BE NUMERIC    '. 00860000
008700     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               00870000
008800                                           'MUST BE > ZERO     '. 00880000
008900     05  PC-MUST-BE-KOHLS-SML       PIC X(19) VALUE               00890000
009000                                           'MUST BE KOHLS SML  '. 00900000
009100     05  PC-AUDIT-RLSE                   PIC X(02)   VALUE 'AR'.  00910000
009200     05  PC-AUDIT-KEEP                   PIC X(02)   VALUE 'AK'.  00920000
009300     05  PC-A                            PIC X(01)   VALUE 'A'.   00930000
009400     05  PC-I                            PIC X(01)   VALUE 'I'.   00940000
009500     05  PC-0                            PIC  X(01)  VALUE '0'.   00950000
009600     05  PC-4                            PIC  X(01)  VALUE '4'.   00960000
009700     05  PC-18                           PIC S9(04)  VALUE 18     00970000
009800                                                     COMP SYNC.   00980000
009900                                                                  00990000
010000                                                                  01000000
010100                                                                  01010000
010200                                                                  01020000
010300 01  PS-PROGRAM-SWITCHES.                                         01030000
010400     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01040000
010500         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01050000
010600         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01060000
010700     05  PS-CARTON-STATUS-ERROR-SW       PIC  X(01)  VALUE 'N'.   01070000
010800         88  PS-CRTN-STATUS-ERROR                    VALUE 'Y'.   01080000
010900         88  PS-NO-CRTN-STATUS-ERROR                 VALUE 'N'.   01090000
011000     05  PS-INVALID-INPUT-SW             PIC  X(01)  VALUE 'N'.   01100000
011100         88  PS-INVALID-INPUT                        VALUE 'Y'.   01110000
011200         88  PS-VALID-INPUT                          VALUE 'N'.   01120000
011300     05  PS-DUPLICATE-SCAN-FND-SW        PIC  X(01)  VALUE 'N'.   01130000
011400         88  PS-DUPLICATE-SCAN-FND                   VALUE 'Y'.   01140000
011500         88  PS-NO-DUP-SCAN-FND                      VALUE 'N'.   01150000
011600     05  PS-TRLR-CRTN-DEST-MISMATCH-SW   PIC  X(01)  VALUE ' '.   01160000
011700         88  PS-TRLR-CRTN-DEST-MISMATCH              VALUE 'Y'.   01170000
011800         88  PS-NO-TRLR-CRTN-DEST-MISMATCH           VALUE 'N'.   01180000
011900     05  PS-MANIFEST-DC-FOUND-SW         PIC  X(01)  VALUE ' '.   01190000
012000         88  PS-MANIFEST-DC-FOUND                    VALUE 'Y'.   01200000
012100         88  PS-NON-MANIFEST-DC-FND                  VALUE 'N'.   01210000
012200     05  PS-OTBND-CART-ROW-FOUND-SW      PIC  X(01)  VALUE 'N'.   01220000
012300         88  PS-OTBND-CART-ROW-FND                   VALUE 'Y'.   01230000
012400         88  PS-NO-OTBND-CART-ROW-FND                VALUE 'N'.   01240000
012500*                                                                 01250000
012600                                                                  01260000
012700 01  PV-PROGRAM-VARIABLES.                                        01270000
012800     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01280000
012900     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01290000
013000                                                     COMP SYNC.   01300000
013100     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01310000
013200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01320000
013300                                                     COMP SYNC.   01330000
013400*                                                                 01340000
013500     05  PV-SCAN-TIMESTAMP               PIC  X(26)  VALUE SPACE. 01350000
013600*                                                                 01360000
013700     05  PV-CTN-X                        PIC  X(18).              01370000
013800     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              01380000
013900     05  PV-18-DIGIT-BCDE REDEFINES PV-CTN-X.                     01390000
014000         10  PV-18-SML-PACKAGING-TYP         PIC 9(01).           01400000
014100         10  PV-18-SML-SOFTWARE-SRC          PIC 9(01).           01410000
014200         10  PV-18-SML-BC-DIVERT.                                 01420000
014300             15  PV-18-SML-BC-DIVERT-PFX     PIC 9(02).           01430000
014400             15  PV-18-SML-BC-DIVERT-CDE     PIC 9(03).           01440000
014500         10  PV-18-SML-BC-DC-ORIGIN          PIC 9(03).           01450000
014600         10  PV-18-SML-BC-MNFST-NBR          PIC 9(08).           01460000
014700*                                                                 01470000
014800     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  01480000
014900                                                     COMP SYNC.   01490000
015000     05  PV-PREV-SCN-CTN                 PIC  9(18)  VALUE ZEROES.01500000
015100     05  PV-128-CARTON.                                           01510000
015200         10  PV-128-CARTON-13            PIC  9(13).              01520000
015300         10  PV-128-CARTON-5             PIC  9(05).              01530000
015400                                                                  01540000
015500         10  PV-CTN.                                              01550000
015600             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              01560000
015700             15  PV-CTN-LAST-17          PIC  X(17).              01570000
015800             15  PV-CTN-FILLER           PIC  X(02).              01580000
015900         10  FILLER REDEFINES PV-CTN.                             01590000
016000             15  PV-CTN-SCAN-00          PIC  X(02).              01600000
016100             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              01610000
016200             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              01620000
016300         10  FILLER REDEFINES PV-CTN.                             01630000
016400             15  PV-CTN-SCAN-00          PIC  X(02).              01640000
016500             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              01650000
016600*                                                                 01660000
016700     05  PV-OTBD-TRIP-ID-TRLR            PIC S9(09)               01670000
016800                                              VALUE ZEROES.       01680000
016900     05  PV-DISP-AUD                   PIC  9(09)  VALUE ZEROS.   01690004
016901     05  PV-DISP-SML                   PIC  9(20)  VALUE ZEROS.   01690104
016902     05  PV-DISP-USERID                PIC  X(08)  VALUE SPACE.   01690204
016903     05  PV-DISP-ERR-CDE               PIC  X(01)  VALUE SPACE.   01690304
016904                                                                  01690404
016910     05  PV-DEST-OPER-TRLR               PIC S9(04)  VALUE  0     01691004
017000                                                     COMP.        01700000
017100     05  PV-OTBD-TRIP-ID-CRTN            PIC S9(09)               01710000
017200                                              VALUE ZEROES.       01720000
017300     05  PV-DEST-OPER-CRTN               PIC S9(04)  VALUE  0     01730000
017400                                                     COMP.        01740000
017500     05  PV-CRTN-STAT-TMST.                                       01750000
017600         10  PV-CRTN-STAT-CCYY         PIC  X(04)  VALUE SPACE.   01760000
017700         10  FILLER                    PIC  X(01)  VALUE '-'.     01770000
017800         10  PV-CRTN-STAT-MM           PIC  X(02)  VALUE SPACE.   01780000
017900         10  FILLER                    PIC  X(01)  VALUE '-'.     01790000
018000         10  PV-CRTN-STAT-DD           PIC  X(02)  VALUE SPACE.   01800000
018100         10  FILLER                    PIC  X(01)  VALUE '-'.     01810000
018200         10  PV-CRTN-STAT-HR           PIC  X(02)  VALUE SPACE.   01820000
018300         10  FILLER                    PIC  X(01)  VALUE '.'.     01830000
018400         10  PV-CRTN-STAT-MN           PIC  X(02)  VALUE SPACE.   01840000
018500         10  FILLER                    PIC  X(01)  VALUE '.'.     01850000
018600         10  PV-CRTN-STAT-SC           PIC  X(02)  VALUE SPACE.   01860000
018700         10  FILLER                    PIC  X(01)  VALUE '.'.     01870000
018800         10  PV-CRTN-STAT-MS           PIC  X(06)  VALUE SPACE.   01880000
018900                                                                  01890000
019000     05  PV-CARTON-MSG.                                           01900000
019100         10  FILLER                   PIC X(01) VALUE SPACE.      01910000
019200         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 01920000
019300         10  FILLER                   PIC X(01) VALUE '-'.        01930000
019400         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     01940000
019500         10  FILLER                   PIC X(05) VALUE ' REC='.    01950000
019600         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     01960000
019700         10  FILLER                   PIC X(10)                   01970000
019800                             VALUE ' CTN STAT='.                  01980000
019900         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     01990000
020000         10  FILLER                   PIC X(01) VALUE '/'.        02000000
020100         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     02010000
020200         10  FILLER                   PIC X(05) VALUE ' SER='.    02020000
020300         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     02030000
020400         10  FILLER                   PIC X(06) VALUE ' TRIP='.   02040000
020500         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     02050000
020600         10  FILLER                   PIC X(06) VALUE ' STAT='.   02060000
020700         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     02070000
020800         10  FILLER                   PIC X(06) VALUE ' USER='.   02080000
020900         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     02090000
020901                                                                  02090100
020902******************************************************************02090200
020903*  LAYOUT FOR THE TRAILER AUDIT MANIFESTING MESSAGES              02090300
020904******************************************************************02090400
020905     COPY PCWS044.                                                02090500
020906                                                                  02090600
020907******************************************************************02090700
020908*  LAYOUT FOR THE AUDIT PROCESS SCREENS                           02090800
020909******************************************************************02090900
020910     COPY PCWS045.                                                02091000
020911                                                                  02091100
020912******************************************************************02091200
020913******************************************************************02091300
020914*  LAYOUT FOR THE CARTON STATUS MODULE (PCKUT713)                 02091408
020915******************************************************************02091500
020916     COPY PCWS046.                                                02091600
020917                                                                  02091700
020918******************************************************************02091800
020919*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02091900
020920******************************************************************02092000
020930     COPY DPWS013.                                                02093000
020940                                                                  02094000
020950******************************************************************02095000
020960*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        02096000
020970******************************************************************02097000
020980     COPY DPWS008.                                                02098000
020990                                                                  02099000
021000******************************************************************02100000
021100*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02110000
021200******************************************************************02120000
021300     COPY DPWS010I.                                               02130000
021400                                                                  02140000
021500******************************************************************02150000
021600* HELP SCREEN COMMAREA                                            02160000
021700     COPY PCWS192.                                                02170000
021800******************************************************************02180000
021900* HELP SCREEN WORK AREA                                           02190000
022000******************************************************************02200000
022100     COPY PCWS188.                                                02210000
022200******************************************************************02220000
022300*  GENERATED DSECT FOR THE PCKM894 MAPSET                         02230000
022400******************************************************************02240000
022500     COPY PCKM894.                                                02250000
022600                                                                  02260000
022700******************************************************************02270000
022800*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02280000
022900******************************************************************02290000
023000     COPY DPWS015.                                                02300000
023100                                                                  02310000
023200******************************************************************02320000
023300*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02330000
023400******************************************************************02340000
023500     COPY DFHAID.                                                 02350000
023600                                                                  02360000
023700******************************************************************02370000
023800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02380000
023900*  AUDIT TABLE (TSUNAUD)                                          02390000
024000******************************************************************02400000
024100     EXEC SQL                                                     02410000
024200         INCLUDE TSUNAUD                                          02420000
024300     END-EXEC.                                                    02430000
024400                                                                  02440000
024500******************************************************************02450000
024600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE OUTBND TRIP STATUS 02460000
024700*  TABLE (TSUOBTS)                                                02470000
024800******************************************************************02480000
024900     EXEC SQL                                                     02490000
025000         INCLUDE TSUOBTS                                          02500000
025100     END-EXEC.                                                    02510000
025200                                                                  02520000
025300******************************************************************02530000
025400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT CARTON TRLR  02540000
025500*  TABLE (SUT_AUD_TRLR_CART)                                      02550000
025600******************************************************************02560000
025700     EXEC SQL                                                     02570000
025800         INCLUDE SUT00000                                         02580000
025900     END-EXEC.                                                    02590000
026000                                                                  02600000
026100******************************************************************02610000
026200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT CARTON TRLR  02620000
026300*  EXCEPTIONS  (SUT_AUD_TRLR_EXC)                                 02630000
026400******************************************************************02640000
026500     EXEC SQL                                                     02650000
026600         INCLUDE SUT00002                                         02660000
026700     END-EXEC.                                                    02670000
026800                                                                  02680000
026900******************************************************************02690000
027000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CONTAINER DIVERT   02700000
027100*  TABLE                                                          02710000
027200******************************************************************02720000
027300     EXEC SQL                                                     02730000
027400         INCLUDE TSUCRDV                                          02740000
027500     END-EXEC.                                                    02750000
027600                                                                  02760000
027700******************************************************************02770000
027800******************************************************************02780000
027900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP UNIT LOCATION 02790000
028000*  TABLE                                                          02800000
028100******************************************************************02810000
028200     EXEC SQL                                                     02820000
028300         INCLUDE SUT00027                                         02830000
028400     END-EXEC.                                                    02840000
028500                                                                  02850000
028600******************************************************************02860000
028700******************************************************************02870000
028800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARM TABLE TO      02880000
028900*  CHECK IF DC IS MANIFESTING                                     02890000
029000******************************************************************02900000
029100     EXEC SQL                                                     02910000
029200         INCLUDE TKRPRPM                                          02920000
029300     END-EXEC.                                                    02930000
029400                                                                  02940000
029500******************************************************************02950000
029600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP UNIT          02960000
029700*  TABLE                                                          02970000
029800******************************************************************02980000
029900     EXEC SQL                                                     02990000
030000         INCLUDE SUT00024                                         03000000
030100     END-EXEC.                                                    03010000
030200                                                                  03020000
030300******************************************************************03030000
030400     EXEC SQL                                                     03040000
030500         INCLUDE TSUCDOT                                          03050000
030600     END-EXEC.                                                    03060000
030700                                                                  03070000
030800******************************************************************03080000
030900*  COMMUNICATIONS AREA FOR DB2                                    03090000
031000******************************************************************03100000
031100     EXEC SQL                                                     03110000
031200         INCLUDE SQLCA                                            03120000
031300     END-EXEC.                                                    03130000
031400                                                                  03140000
031500******************************************************************03150000
031600 LINKAGE SECTION.                                                 03160000
031700******************************************************************03170000
031800 01  DFHCOMMAREA.                                                 03180000
031900     05  FILLER                         OCCURS  1 TO 4072 TIMES   03190000
032000                                      DEPENDING ON EIBCALEN.      03200000
032100         10  FILLER                   PIC X.                      03210000
032200                                                                  03220000
032300******************************************************************03230000
032400 PROCEDURE DIVISION.                                              03240000
032500******************************************************************03250000
032600 0000-PROGRAM-MAINLINE.                                           03260000
032700     MOVE DFHCOMMAREA                TO CA-COMMAREA.              03270000
032800     MOVE PC233-HOST-SAVE-AREA       TO PC045-COMMAREA-REC.       03280000
032900     MOVE LOW-VALUES                 TO PC894AI.                  03290000
033000                                                                  03300000
033100     EVALUATE TRUE                                                03310000
033200         WHEN EIBCALEN = ZERO                                     03320000
033300         WHEN EIBAID = DFHCLEAR                                   03330000
033400         WHEN PC233-INITIALIZE-SCREEN                             03340000
033500              SET PC233-PROCESS-SCREEN TO TRUE                    03350000
033600              IF PC045-DUPLICATE-ADD                              03360000
033700                 MOVE PC045-SHIP-UNIT-NBR TO                      03370000
033800                                    PC046-CARTON-ID               03380000
033900                 PERFORM 3310-INSERT-AUD-TRLR-CART                03390000
034000                 MOVE 'F'  TO    SUT00002-ERR-CDE                 03400000
034100                 PERFORM 3320-INSERT-AUD-TRLR-EXC                 03410000
034200                 INITIALIZE PC045-DUPLICATE-IND                   03420000
034300                 MOVE PC045-SHIP-UNIT-NBR TO                      03430000
034400                                         PV-PREV-SCN-CTN          03440000
034500                 MOVE SPACES TO ACARTNO                           03450000
034600                 MOVE PV-PREV-SCN-CTN TO APRVCTNO                 03460000
034700              ELSE                                                03470000
034800                 IF PC045-SHIP-UNIT-NBR > SPACES                  03480000
034900                    INITIALIZE PC045-DUPLICATE-IND                03490000
035000                    MOVE PC045-SHIP-UNIT-NBR TO                   03500000
035100                                            PV-PREV-SCN-CTN       03510000
035200                    MOVE SPACES TO ACARTNO                        03520000
035300                    MOVE PV-PREV-SCN-CTN TO APRVCTNO              03530000
035400                 END-IF                                           03540000
035500              END-IF                                              03550000
035600              PERFORM 8000-SEND-MAP                               03560000
035700              PERFORM 8200-RETURN-TRANID                          03570000
035800                                                                  03580000
035900         WHEN EIBTRNID = 'Z278'                                   03590000
036000*            RETURNING FROM F1 HELP INFO SCREEN                   03600000
036100             MOVE DFHCOMMAREA         TO PC192-COMMAREA           03610000
036200             MOVE PC192-HOST-SAVE-AREA                            03620000
036300                                      TO CA-COMMAREA              03630000
036400             SET PC233-PROCESS-SCREEN TO TRUE                     03640000
036500             MOVE PC192-HOST-SAVE-MAP TO PC894AO                  03650000
036600             MOVE -1                  TO ACARTNL                  03660000
036700             PERFORM 8000-SEND-MAP                                03670000
036800             PERFORM 8200-RETURN-TRANID                           03680000
036900                                                                  03690000
037000         WHEN EIBAID = DFHENTER                                   03700000
037100              PERFORM 0500-PROCESS-SCREEN-FIELDS                  03710000
037200              PERFORM 2000-PROCESS-CARTON                         03720000
037300              IF PS-NO-CRTN-STATUS-ERROR                          03730000
037400                 IF PC045-DEST-TYP-CDE = 'S'                      03740000
037500                    CONTINUE                                      03750000
037600                 ELSE                                             03760000
037700                    PERFORM 4000-PROCESS-VALID-CARTONS            03770000
037800                 END-IF                                           03780000
037900                 MOVE PV-CTN-N  TO  PV-PREV-SCN-CTN               03790000
038000                 MOVE SPACES TO ACARTNO                           03800000
038100                                AMSGLNO                           03810000
038200                 MOVE PV-PREV-SCN-CTN TO APRVCTNO                 03820000
038300              ELSE                                                03830000
038400                 PERFORM 4050-PROCESS-INVALID-CARTONS             03840000
038500              END-IF                                              03850000
038600                                                                  03860000
038700         WHEN EIBAID = DFHPF1                                     03870000
038800             PERFORM 1000-RECEIVE-MAP                             03880000
038900             MOVE PC894AO             TO PC192-HOST-SAVE-MAP      03890000
039000             PERFORM 1200-HELP-SCREEN                             03900000
039100                                                                  03910000
039200         WHEN EIBAID = DFHPF3                                     03920000
039300              MOVE PC-PREV-MENU-PROGRAM                           03930000
039400                                     TO PV-TRANSFER-PROGRAM       03940000
039500              PERFORM 2100-XCTL-TO-SELECTED-PROGRAM               03950000
039600                                                                  03960000
039700         WHEN OTHER                                               03970000
039800              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     03980000
039900                                     TO AMSGLNO                   03990000
040000              PERFORM 8100-SEND-DATA-ONLY                         04000000
040100              PERFORM 8200-RETURN-TRANID                          04010000
040200     END-EVALUATE.                                                04020000
040300                                                                  04030000
040400     PERFORM 8100-SEND-DATA-ONLY                                  04040000
040500     PERFORM 8200-RETURN-TRANID                                   04050000
040600     GOBACK.                                                      04060000
040700*                                                                 04070000
040800*                                                                 04080000
040900 0500-PROCESS-SCREEN-FIELDS.                                      04090000
041000                                                                  04100000
041100      PERFORM 1000-RECEIVE-MAP.                                   04110000
041200      PERFORM 1100-EDIT-SELECTION.                                04120000
041300                                                                  04130000
041400                                                                  04140000
041500 1000-RECEIVE-MAP.                                                04150000
041600     EXEC CICS                                                    04160000
041700         RECEIVE MAP    ('PC894A')                                04170000
041800                 MAPSET ('PCKM894')                               04180000
041900                 RESP   (PV-CICS-RESPONSE)                        04190000
042000     END-EXEC.                                                    04200000
042100                                                                  04210000
042200     EVALUATE TRUE                                                04220000
042300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04230000
042400              PERFORM 1010-RECEIVE-SCREEN-FIELDS                  04240000
042500         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                04250000
042600              CONTINUE                                            04260000
042700         WHEN OTHER                                               04270000
042800              MOVE '1000-RECEIVE-MAP'                             04280000
042900                                     TO DP013-PARAGRAPH           04290000
043000              MOVE 'UNABLE TO RECEIVE MAP'                        04300000
043100                                     TO DP013-MESSAGE-TEXT (1)    04310000
043200              SET DP013-LOGIC-ABEND  TO TRUE                      04320000
043300              SET DP013-ROLLBACK  TO TRUE                         04330000
043400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              04340000
043500     END-EVALUATE.                                                04350000
043600*                                                                 04360000
043700*                                                                 04370000
043800 1010-RECEIVE-SCREEN-FIELDS.                                      04380000
043900     IF  ACARTNL > ZERO                                           04390000
044000         MOVE ACARTNI      TO PV-CTN                              04400000
044100     END-IF.                                                      04410000
044200*                                                                 04420000
044300*                                                                 04430000
044400 1100-EDIT-SELECTION.                                             04440000
044500     MOVE PV-CTN                     TO DP010I-UNEDITED-FIELD.    04450000
044600     MOVE 1                          TO DP010I-MAXIMUM-DIGITS.    04460000
044700     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  04470000
044800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     04480000
044900                                                                  04490000
045000     MOVE 0 TO PV-CHAR-COUNT.                                     04500000
045100     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         04510000
045200                 BEFORE INITIAL SPACE.                            04520000
045300     EVALUATE TRUE                                                04530000
045400         WHEN PV-CTN = SPACES                                     04540000
045500             SET PS-INVALID-INPUT        TO TRUE                  04550000
045600*            MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               04560000
045700             MOVE -1                     TO ACARTNL               04570000
045800             MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO               04580000
045900         WHEN PV-CHAR-COUNT = PC-18 AND                           04590000
046000            ((PV-CTN-FIRST-DIGIT NOT =  PC-0) AND                 04600000
046100             (PV-CTN-FIRST-DIGIT NOT =  PC-4))                    04610000
046200             SET PS-INVALID-INPUT        TO TRUE                  04620000
046300             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               04630000
046400             MOVE -1                     TO ACARTNL               04640000
046500             MOVE PC-FIRST-1-NOT-0-MSG   TO AMSGLNO               04650000
046600         WHEN PV-CHAR-COUNT < PC-18                               04660000
046700             SET PS-INVALID-INPUT        TO TRUE                  04670000
046800             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               04680000
046900             MOVE -1                     TO ACARTNL               04690000
047000             MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO               04700000
047100         WHEN OTHER                                               04710000
047200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              04720000
047300             MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD    04730000
047400             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 04740000
047500             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               04750000
047600                                                                  04760000
047710             CALL DP010I-NUMERIC-EDIT-ROUTINE                     04771009
047720                         USING DP010I-NUMERIC-EDIT-AREA           04772009
047800                                                                  04780000
047900             IF  DP010I-ERROR-DETECTED                            04790000
048000                 SET PS-INVALID-INPUT        TO TRUE              04800000
048100                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           04810000
048200                 MOVE -1                     TO ACARTNL           04820000
048300                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           04830000
048400             ELSE                                                 04840000
048500                 IF DP010I-NUMERIC-FIELD = ZEROES                 04850000
048600                     SET PS-INVALID-INPUT        TO TRUE          04860000
048700*                    MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       04870000
048800                     MOVE -1                     TO ACARTNL       04880000
048900                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       04890000
049000                 ELSE                                             04900000
049100                     MOVE DP015-UNP-ALP-NOR-OFF  TO ACARTNA       04910000
049200                 END-IF                                           04920000
049300             END-IF                                               04930000
049400     END-EVALUATE.                                                04940000
049500                                                                  04950000
049600     IF  PS-INVALID-INPUT                                         04960000
049700         PERFORM 8100-SEND-DATA-ONLY                              04970000
049800         PERFORM 8200-RETURN-TRANID                               04980000
049900     ELSE                                                         04990000
050000         IF PV-CHAR-COUNT = PC-18                                 05000000
050100            MOVE PV-CTN              TO PV-CTN-N                  05010000
050200                                        PC045-SHIP-UNIT-NBR       05020000
050300         ELSE                                                     05030000
050400            MOVE PV-CTN-SCAN-LAST-18 TO PV-CTN-N                  05040000
050500                                        PC045-SHIP-UNIT-NBR       05050000
050600         END-IF                                                   05060000
050700     END-IF.                                                      05070000
050800                                                                  05080000
050900     IF (PV-18-SML-PACKAGING-TYP = 4) AND                         05090000
051000        (PV-18-SML-SOFTWARE-SRC  = 1   OR                         05100000
051100         PV-18-SML-SOFTWARE-SRC  = 2)                             05110000
051200          CONTINUE                                                05120000
051300     ELSE                                                         05130000
051400          MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                  05140000
051401          MOVE -1                     TO ACARTNL                  05140100
051402          MOVE PC-MUST-BE-KOHLS-SML   TO AMSGLNO                  05140200
051403          PERFORM 8100-SEND-DATA-ONLY                             05140300
051404          PERFORM 8200-RETURN-TRANID                              05140400
051405     END-IF.                                                      05140500
051406                                                                  05140600
051407*                                                                 05140700
051408 1200-HELP-SCREEN.                                                05140800
051409     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      05140900
051410     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       05141000
051420     COPY PCPD188.                                                05142000
051430     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      05143000
051440     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     05144000
051450     PERFORM 2150-XCTL-TO-HELP.                                   05145000
051460                                                                  05146000
051470*                                                                 05147000
051480 2000-PROCESS-CARTON.                                             05148000
051490      PERFORM 3000-LINK-TO-CRTN-STATUS.                           05149000
051500      PERFORM 3200-EVALUATE-CRTN-STATUS.                          05150000
051600*                                                                 05160000
051700*                                                                 05170000
051800 2100-XCTL-TO-SELECTED-PROGRAM.                                   05180000
051900     SET PC233-INITIALIZE-SCREEN       TO  TRUE.                  05190000
052000     MOVE PC-CURRENT-PROGRAM-NAME      TO  PC233-LAST-PROGRAM.    05200000
052100     MOVE PC045-COMMAREA-REC           TO  PC233-HOST-SAVE-AREA.  05210000
052200     MOVE LENGTH OF CA-COMMAREA        TO  PV-COMMAREA-LENGTH.    05220000
052300                                                                  05230000
052400     EXEC CICS                                                    05240000
052500         XCTL                                                     05250000
052600             PROGRAM   (PV-TRANSFER-PROGRAM)                      05260000
052700             COMMAREA  (CA-COMMAREA)                              05270000
052800             LENGTH    (PV-COMMAREA-LENGTH)                       05280000
052900             RESP      (PV-CICS-RESPONSE)                         05290000
053000     END-EXEC.                                                    05300000
053100                                                                  05310000
053200     EVALUATE TRUE                                                05320000
053300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05330000
053400              CONTINUE                                            05340000
053500         WHEN OTHER                                               05350000
053600              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                05360000
053700                                     TO DP013-PARAGRAPH           05370000
053800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       05380000
053900                                     TO DP013-MESSAGE-TEXT (1)    05390000
054000              MOVE PV-TRANSFER-PROGRAM                            05400000
054100                                     TO DP013-MESSAGE-TEXT (2)    05410000
054200              SET DP013-CICS-ABEND   TO TRUE                      05420000
054300              SET DP013-ROLLBACK  TO TRUE                         05430000
054400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              05440000
054500              MOVE PC-TRANS-UNAVAILABLE-MSG                       05450000
054600                                     TO AMSGLNO                   05460000
054700              SET PC233-PROCESS-SCREEN  TO TRUE                   05470000
054800              PERFORM 8100-SEND-DATA-ONLY                         05480000
054900              PERFORM 8200-RETURN-TRANID                          05490000
055000     END-EVALUATE.                                                05500000
055100*                                                                 05510000
055200 2150-XCTL-TO-HELP.                                               05520000
055300                                                                  05530000
055400     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       05540000
055500                                                                  05550000
055600     EXEC CICS                                                    05560000
055700         XCTL                                                     05570000
055800             PROGRAM   (PV-TRANSFER-PROGRAM)                      05580000
055900             COMMAREA  (PC192-COMMAREA)                           05590000
056000             LENGTH    (PV-COMMAREA-LENGTH)                       05600000
056100             RESP      (PV-CICS-RESPONSE)                         05610000
056200     END-EXEC.                                                    05620000
056300                                                                  05630000
056400     EVALUATE TRUE                                                05640000
056500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05650000
056600              CONTINUE                                            05660000
056700         WHEN OTHER                                               05670000
056800             MOVE '2150-XCTL-TO-HELP' TO DP013-PARAGRAPH          05680000
056900             MOVE 'PCKRF894 - UNABLE TO XCTL TO PROGRAM: '        05690000
057000                                      TO DP013-MESSAGE-TEXT (1)   05700000
057100             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   05710000
057200             SET DP013-CICS-ABEND                                 05720000
057300                 DP013-ROLLBACK       TO TRUE                     05730000
057400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               05740000
057500             MOVE PC-TRANS-UNAVAILABLE-MSG                        05750000
057600                                      TO AMSGLNO                  05760000
057700             SET PC233-PROCESS-SCREEN TO TRUE                     05770000
057800             MOVE -1                  TO ACARTNL                  05780000
057900             PERFORM 8000-SEND-MAP                                05790000
058000             PERFORM 8200-RETURN-TRANID                           05800000
058100     END-EVALUATE.                                                05810000
058200/                                                                 05820000
058300****************************************************************  05830000
058400 3000-LINK-TO-CRTN-STATUS.                                        05840000
058500****************************************************************  05850000
058600                                                                  05860000
058700     INITIALIZE  PC046-COMMAREA-REC.                              05870000
058800     SET   PC046-FROM-MFST-TRLR-AUDIT TO TRUE.                    05880000
058900     MOVE  PV-CTN-N    TO PC046-CARTON-ID.                        05890000
059000     SET PC046-CALC-UNITS TO TRUE.                                05900000
059100                                                                  05910000
059200     CALL PC046-CARTON-STATUS-MODULE                              05920000
059300             USING DFHEIBLK                                       05930000
059400             PC046-COMMAREA                                       05940000
059500             PC046-COMMAREA-REC                                   05950000
059600     END-CALL                                                     05960000
059700                                                                  05970000
059800     PERFORM 3100-VALIDATE-STATUS-CALL.                           05980000
059900                                                                  05990000
060000*----------------------------------------------------------------*06000000
060100* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*06010000
060200*----------------------------------------------------------------*06020000
060300 3100-VALIDATE-STATUS-CALL.                                       06030000
060400                                                                  06040000
060500     IF  PC046-SUCCESSFUL OR                                      06050000
060600         PC046-CRTN-STAT-ERROR                                    06060000
060700              CONTINUE                                            06070000
060800     ELSE                                                         06080000
060900     IF  PC046-ERROR                                              06090000
061000         MOVE PC044-CICS-FATAL-ERROR-MSG TO  AMSGLNO              06100000
061100         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06110000
061200     ELSE                                                         06120000
061300     IF  PC046-INVALID-SQL                                        06130000
061400         MOVE PC044-DB2-FATAL-ERROR-MSG  TO  AMSGLNO              06140000
061500         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06150000
061600     ELSE                                                         06160000
061700     IF  PC046-DATABASE-BUSY                                      06170000
061800         MOVE PC044-TRANS-NOT-AVAILABLE-MSG  TO  AMSGLNO          06180000
061900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06190000
062000     ELSE                                                         06200000
062100         MOVE PC044-CICS-FATAL-ERROR-MSG TO  AMSGLNO              06210000
062200         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06220000
062300                                                                  06230000
062400     END-IF                                                       06240000
062500     END-IF                                                       06250000
062600     END-IF                                                       06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900*                                                                 06290000
063000 3200-EVALUATE-CRTN-STATUS.                                       06300000
063100******************************************************************06310000
063200*ALL CARTONS SCANNED FOR AUDIT WILL INSERT A ROW TO THE AUDIT TRLR06320000
063300*CARTON TABLE(SUT_AUD_TRLR_CART). ANY CARTON THAT HAS AN ERROR    06330000
063400*WILL ALSO HAVE A ROW INSERTED TO THE EXCEPTION TABLE             06340000
063500*(SUT_AUD_TRLR_EXC).  INITIAL CHECKS NEED TO BE DONE FOR DUPLICATE06350000
063600*SCANS, UNKNOWN CARTON CONTENT, AND MISLOADED CARTONS.            06360000
063700******************************************************************06370000
063800**PCWS045 CONTAINS DATA ASSOCIATED TO THE TRAILER                 06380000
063900**PCWS046 CONTIANS DATA ASSOCIATED TO EACH CARTON SCANNED         06390000
064000**WHEN THE DATA DOES NOT MATCH, AN ERROR EXISTS                   06400000
064100                                                                  06410000
064200                                                                  06420000
064300      PERFORM 3500-CHECK-FOR-DUPLICATE                            06430000
064400      IF PS-DUPLICATE-SCAN-FND                                    06440000
064500         MOVE PV-CTN-N          TO PC233-CARTON                   06450000
064600         MOVE SUT00000-SCN-TMST TO PC045-SCN-TMST                 06460000
064700         MOVE '30' TO  PC233-PGM-MSG-NBR                          06470000
064800         MOVE PC-ERROR-MESSAGE-PROGRAM                            06480000
064900                                TO PV-TRANSFER-PROGRAM            06490000
065000         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    06500000
065100      ELSE                                                        06510000
065200         SET PS-NO-CRTN-STATUS-ERROR TO TRUE                      06520000
065300**DO NOT LOG MASTER CONTAINER BARCODES                            06530000
065400         IF PC046-SRC-MSTR-CNTR                                   06540000
065500            SET PS-CRTN-STATUS-ERROR TO TRUE                      06550000
065600            MOVE '39' TO  PC233-PGM-MSG-NBR                       06560000
065700         ELSE                                                     06570000
065800            PERFORM 3310-INSERT-AUD-TRLR-CART                     06580000
065900         END-IF                                                   06590000
066000**CARTON CONTENT UNKNOWN                                          06600000
066100        IF PS-NO-CRTN-STATUS-ERROR                                06610000
066200           IF PC046-NBR-UNITS = 0                                 06620000
066300              SET PS-CRTN-STATUS-ERROR  TO TRUE                   06630000
066400              PERFORM 3350-CHECK-FOR-MANIFESTING                  06640000
066500              IF PS-MANIFEST-DC-FOUND                             06650000
066600**IF UNITS = 0, CHECK TO SEE IF THERE IS A ROW ON SUT_OTBND_CART  06660000
066700**A ROW ON SHPUNT WITH NO UNITS(TSHUUPC) MEANS CARTON BUILD       06670000
066800**WAS STARTED BUT NO UPC'S ADDED                                  06680000
066900                PERFORM 3600-CHECK-FOR-OTBND-CART                 06690000
067000                IF PS-OTBND-CART-ROW-FND                          06700000
067100**CARTON CONTENT UNKNOWN                                          06710000
067200                   MOVE 'C'  TO  SUT00002-ERR-CDE                 06720000
067300                   MOVE '29' TO  PC233-PGM-MSG-NBR                06730000
067400                ELSE                                              06740000
067500**CARTON NOT FOUND                                                06750000
067600                   MOVE 'B'  TO  SUT00002-ERR-CDE                 06760000
067700                   MOVE '26' TO  PC233-PGM-MSG-NBR                06770000
067800                END-IF                                            06780000
067900              ELSE                                                06790000
068000**IF NON MANIFESTING DC INITALLY SET INFORMATIONAL MESSAGE        06800000
068100**10/1/01GB--- REVIEW WHEN MANIFESTING CONTINUES, SHOULD ERROR    06810000
068200**CHECKING CONTINUE FOR MISLOAD?NOT MANIFESTED CRTN? ETC          06820000
068300**AT THIS POINT STOP WHEN NON-MANIFEST DC FOUND                   06830000
068400*********************************************************         06840000
068500*******CARTON CREATED FROM A NON MANIFESTING DC                   06850000
068600                   MOVE 'G'  TO  SUT00002-ERR-CDE                 06860000
068700                   MOVE '38'  TO  PC233-PGM-MSG-NBR               06870000
068800              END-IF                                              06880000
068900           END-IF                                                 06890000
069000        END-IF                                                    06900000
069100                                                                  06910000
069200******************************************************************06920000
069300* IF DOOR TYPE IS SHIPPING 'SH' THE CARTON AND TRLR DESTINATIONS  06930000
069400* SHOULD MATCH, NOT AN ISSUE FOR STORAGE 'ST' AND SHUTTLE'SH' DOOR06940000
069500******************************************************************06950000
069600         IF PS-NO-CRTN-STATUS-ERROR                               06960000
069700            IF PC046-DOOR-TYP-CDE = 'SH'                          06970000
069800               IF PC046-DEST-OPER-UNT-ID = PC045-DEST-OPER-UNT-ID 06980000
069900                          CONTINUE                                06990000
070000               ELSE                                               07000000
070100***               *MISLOADED CARTON ERROR                         07010000
070200                  SET PS-CRTN-STATUS-ERROR  TO TRUE               07020000
070300                  MOVE PC045-DEST-OPER-UNT-ID TO                  07030000
070400                                  PC233-ERROR-TRLR-STR-NBR        07040000
070500                  MOVE PC046-DEST-OPER-UNT-ID TO                  07050000
070600                                  PC233-ERROR-CTN-STR-NBR         07060000
070700                  MOVE 'E'  TO  SUT00002-ERR-CDE                  07070000
070800                  MOVE '27' TO  PC233-PGM-MSG-NBR                 07080000
070900               END-IF                                             07090000
071000            END-IF                                                07100000
071100         END-IF                                                   07110000
071200                                                                  07120000
071300                                                                  07130000
071400                                                                  07140000
071500* IF FOR THE RIGHT STORE, BUT ON WRONG TRIP ID,                   07150000
071600* --AND TRIP THAT CARTON SHOULD BE HAS BEEN SHIPPED               07160000
071700*  1- LOG ERROR                                                   07170000
071800*  2- INSERT TO ERROR TABLE                                       07180000
071900* --IF TRIP THAT CARTON SHOULD BE ON HAS NOT BEEN SHIPPED         07190000
072000*  1- LOG ERROR                                                   07200000
072100*  2- INSERT TO ERROR TABLE                                       07210000
072200*  3- SCAN OFF OR INACTV DIVERT                                   07220000
072300*  4- SCAN ON TO AUDIT TO TRAILER                                 07230000
072400                                                                  07240000
072500******************************************************************07250000
072600*AFTER THE INITIAL ERROR CHECKS, IF THE CARTON WAS NOT LOADED OR  07260000
072700*SCANNED ONTO A TRAILER, PERFORM THE FOLLOWING ERROR CHECKS:      07270000
072800***ASSUMED CARTONS- CARTONS DIVERTED TO TRAILER  WHERE THERE      07280000
072900***                 IS A BEG CUTOFF BUT NO END CUTOFF             07290000
073000***INVALID CARTON: THE CARTON HAS AN ACTIVE 'SHON' AND HAS A      07300000
073100**                 DIVERT TMST GREATER THAN THE 'SHON' ON         07310000
073200**                 SUT_OTBND_LOC                                  07320000
073300**INACTIVE CARTON: THE CARTON HAS BEEN INACTIVATED ON             07330000
073400**                 SUT_OTBND_CART                                 07340000
073500*IF NONE OF THE CONDITIONS WERE MET PREVIOUSLY, THE CARTON WAS    07350000
073600*NOT MANIFESTED TO THE TRAILER                                    07360000
073700******************************************************************07370000
073800                                                                  07380000
073900                                                                  07390000
074000     IF PS-NO-CRTN-STATUS-ERROR                                   07400000
074100      IF PC046-DIVERTED-TO-TRLR AND PC045-SPOT-AUDIT-CHECK        07410000
074200          PERFORM 4500-CHECK-FOR-ASSUMED-CRTNS                    07420000
074300      END-IF                                                      07430000
074400      IF PC045-OTBND-TRIP-ID  = PC046-OTBD-TRIP-ID                07440000
074500         IF PC046-LOADED-ONTO-TRLR OR                             07450000
074600            PC046-SCANNED-ONTO-TRLR OR                            07460000
074700            PC046-DIVERTED-TO-TRLR                                07470000
074800              IF PC046-DEST-OPER-UNT-ID = PC045-DEST-OPER-UNT-ID  07480000
074900                         CONTINUE                                 07490000
075000              ELSE                                                07500000
075100**               *MISLOADED CARTON ERROR                          07510000
075200                 SET PS-CRTN-STATUS-ERROR  TO TRUE                07520000
075300                 MOVE PC045-DEST-OPER-UNT-ID TO                   07530000
075400                                 PC233-ERROR-TRLR-STR-NBR         07540000
075500                 MOVE PC046-DEST-OPER-UNT-ID TO                   07550000
075600                                 PC233-ERROR-CTN-STR-NBR          07560000
075700                 MOVE 'E'  TO  SUT00002-ERR-CDE                   07570000
075800                 MOVE '27' TO  PC233-PGM-MSG-NBR                  07580000
075900              END-IF                                              07590000
076000         ELSE                                                     07600000
076100            SET PS-CRTN-STATUS-ERROR  TO TRUE                     07610000
076200            EVALUATE TRUE                                         07620000
076300               WHEN PC046-INVALID-CRTN                            07630000
076400******   'B'   -  *CRTN NOT FOUND ERROR                           07640000
076500                   IF PC045-OPER-UNT-ID = PV-18-SML-BC-DC-ORIGIN  07650000
076600                      MOVE 'B'  TO  SUT00002-ERR-CDE              07660000
076700                      MOVE '26' TO  PC233-PGM-MSG-NBR             07670000
076800                   ELSE                                           07680000
076900                        PERFORM 3350-CHECK-FOR-MANIFESTING        07690000
077000                        IF PS-MANIFEST-DC-FOUND                   07700000
077100                           MOVE 'B'  TO  SUT00002-ERR-CDE         07710000
077200                           MOVE '26' TO  PC233-PGM-MSG-NBR        07720000
077300                        ELSE                                      07730000
077400******            *CARTON CREATED FROM A NON MANIFESTING DC       07740000
077500                           MOVE 'G'  TO  SUT00002-ERR-CDE         07750000
077600                           MOVE '38'  TO  PC233-PGM-MSG-NBR       07760000
077700                        END-IF                                    07770000
077800                   END-IF                                         07780000
077900               WHEN PC046-INACTIVATED                             07790000
078000******            *CRTN INACTIVATED ERROR                         07800000
078100                  MOVE 'D'  TO  SUT00002-ERR-CDE                  07810000
078200                  MOVE '31' TO  PC233-PGM-MSG-NBR                 07820000
078300               WHEN OTHER                                         07830000
078400******            *CRTN NOT MANIFESTED TO TRLR                    07840000
078500                  MOVE 'A'  TO  SUT00002-ERR-CDE                  07850000
078600                  MOVE '28' TO  PC233-PGM-MSG-NBR                 07860000
078700            END-EVALUATE                                          07870000
078800         END-IF                                                   07880000
078900      ELSE                                                        07890000
079000******  *CHECK CRTN IS NOT MANIFESTED TO TRLR BUT IS IT DESTINED  07900000
079100******  *FOR CORRECT STORE ??                                     07910000
079120** 4/1/22 - ADDED CHECK TO SEE IF STORE MISLOAD CARTON            07912012
079200          SET PS-CRTN-STATUS-ERROR TO TRUE                        07920000
079300          IF PC045-DEST-TYP-CDE = 'S' OR                          07930000
079400             PC045-SPOT-AUDIT-CHECK                               07940000
079410             IF PC046-DEST-OPER-UNT-ID =                          07941011
079420                PC045-DEST-OPER-UNT-ID                            07942011
079500                MOVE 'A'  TO  SUT00002-ERR-CDE                    07950000
079600                MOVE '28' TO  PC233-PGM-MSG-NBR                   07960000
079610             ELSE                                                 07961011
079611                MOVE PC045-DEST-OPER-UNT-ID TO                    07961111
079612                                PC233-ERROR-TRLR-STR-NBR          07961211
079613                MOVE PC046-DEST-OPER-UNT-ID TO                    07961311
079614                                PC233-ERROR-CTN-STR-NBR           07961411
079615                MOVE 'E'  TO  SUT00002-ERR-CDE                    07961511
079616                MOVE '27' TO  PC233-PGM-MSG-NBR                   07961611
079617                SET PS-TRLR-CRTN-DEST-MISMATCH TO TRUE            07961711
079620             END-IF                                               07962011
079700          ELSE                                                    07970000
079800**IF TRIP ID IS ZEROES, CRTN HAS NOT BEEN MANIFESTED              07980000
079900             IF PC046-OTBD-TRIP-ID  > ZEROES                      07990000
080000                IF PC046-DEST-OPER-UNT-ID =                       08000000
080100                                       PC045-DEST-OPER-UNT-ID     08010000
080200                   MOVE 'A'  TO  SUT00002-ERR-CDE                 08020000
080300                   MOVE '28' TO  PC233-PGM-MSG-NBR                08030000
080400                   SET PS-NO-TRLR-CRTN-DEST-MISMATCH TO TRUE      08040000
080500                ELSE                                              08050000
080600*MISLOADED CARTON                                                 08060000
080700                   MOVE PC045-DEST-OPER-UNT-ID TO                 08070000
080800                                   PC233-ERROR-TRLR-STR-NBR       08080000
080900                   MOVE PC046-DEST-OPER-UNT-ID TO                 08090000
081000                                   PC233-ERROR-CTN-STR-NBR        08100000
081100                   MOVE 'E'  TO  SUT00002-ERR-CDE                 08110000
081200                   MOVE '27' TO  PC233-PGM-MSG-NBR                08120000
081300                   SET PS-TRLR-CRTN-DEST-MISMATCH TO TRUE         08130000
081400                END-IF                                            08140000
081500             ELSE                                                 08150000
081501** 4/1/22 - ADDED CHECK TO SEE IF STORE MISLOAD CARTON            08150110
081510                IF PC046-DEST-OPER-UNT-ID =                       08151010
081520                                       PC045-DEST-OPER-UNT-ID     08152010
081600                   MOVE 'A'  TO  SUT00002-ERR-CDE                 08160010
081700                   MOVE '28' TO  PC233-PGM-MSG-NBR                08170010
081710                ELSE                                              08171010
081711                   MOVE PC045-DEST-OPER-UNT-ID TO                 08171110
081712                                   PC233-ERROR-TRLR-STR-NBR       08171210
081713                   MOVE PC046-DEST-OPER-UNT-ID TO                 08171310
081714                                   PC233-ERROR-CTN-STR-NBR        08171410
081715                   MOVE 'E'  TO  SUT00002-ERR-CDE                 08171510
081716                   MOVE '27' TO  PC233-PGM-MSG-NBR                08171610
081717                   SET PS-TRLR-CRTN-DEST-MISMATCH TO TRUE         08171710
081720                END-IF                                            08172010
081800             END-IF                                               08180000
081900     END-IF.                                                      08190000
082000                                                                  08200000
082100     IF PS-CRTN-STATUS-ERROR                                      08210000
082200        IF PC046-SRC-MSTR-CNTR                                    08220000
082300           CONTINUE                                               08230000
082400        ELSE                                                      08240000
082500           PERFORM 3320-INSERT-AUD-TRLR-EXC                       08250000
082600        END-IF                                                    08260000
082700     END-IF.                                                      08270000
082800                                                                  08280000
082900 3310-INSERT-AUD-TRLR-CART.                                       08290000
083000                                                                  08300000
083100     EXEC SQL                                                     08310000
083200        SET :PV-SCAN-TIMESTAMP = CURRENT TIMESTAMP                08320000
083300     END-EXEC                                                     08330000
083400                                                                  08340000
083500                                                                  08350000
083600*                                                                 08360000
083700     MOVE PC045-AUDIT-CNTL-NBR  TO SUT00000-AUD-CNTL-NBR          08370000
083800                                   SUT00002-AUD-CNTL-NBR          08380000
083900     MOVE PC046-CARTON-ID       TO SUT00000-SHIPT-UNT-ID          08390000
084000                                   SUT00002-SHIPT-UNT-ID          08400000
084100     MOVE PC045-USERID          TO SUT00000-AUD-USR-ID            08410000
084200                                                                  08420000
084300     EXEC SQL                                                     08430000
084400         INSERT INTO SUT_AUD_TRLR_CART                            08440000
084500           ( AUD_CNTL_NBR                                         08450000
084600            ,SHIPT_UNT_ID                                         08460000
084700            ,SCN_TMST                                             08470000
084800            ,AUD_USR_ID                                           08480000
084900           )                                                      08490000
085000         VALUES                                                   08500000
085100           ( :SUT00000-AUD-CNTL-NBR                               08510000
085200            ,:SUT00000-SHIPT-UNT-ID                               08520000
085300            ,:PV-SCAN-TIMESTAMP                                   08530000
085400            ,:SUT00000-AUD-USR-ID                                 08540000
085500           )                                                      08550000
085600     END-EXEC                                                     08560000
085700                                                                  08570000
085800                                                                  08580000
085900     EVALUATE TRUE                                                08590000
086000       WHEN SQLCODE = ZERO                                        08600000
086100           CONTINUE                                               08610000
086200       WHEN SQLWARN0 NOT = SPACES                                 08620000
086300       WHEN SQLCODE < ZERO                                        08630000
086400       WHEN SQLCODE > ZERO                                        08640000
086500             MOVE '3310-INSERT-AUD-TRLR-CART'                     08650000
086600                 TO DP013-PARAGRAPH                               08660000
086700             STRING 'INSERT-AUD-TRLR-CART - '                     08670003
086701                    PV-SCAN-TIMESTAMP DELIMITED BY SIZE           08670102
086800                              INTO DP013-MESSAGE-TEXT (1)         08680002
086810             MOVE SUT00000-AUD-CNTL-NBR TO PV-DISP-AUD            08681002
086820             MOVE SUT00000-SHIPT-UNT-ID TO PV-DISP-SML            08682002
086821             MOVE SUT00000-AUD-USR-ID   TO PV-DISP-USERID         08682102
086822             STRING PV-DISP-AUD '-'                               08682202
086823                    PV-DISP-SML '-'                               08682302
086824                    PV-DISP-USERID DELIMITED BY SIZE              08682402
087000                              INTO DP013-MESSAGE-TEXT (2)         08700005
087100             MOVE SQLCA            TO DP013-SQLCA                 08710000
087200             MOVE 'SUT_AUD_TRLR_CART'                             08720000
087300                                    TO DP013-DB2-TABLE-NAME (1)   08730000
087400             SET DP013-DB2-ABEND   TO TRUE                        08740000
087500             SET DP013-ROLLBACK TO TRUE                           08750000
087600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08760000
087700             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            08770000
087800             MOVE -1                     TO  ACARTNL              08780000
087900             PERFORM 8100-SEND-DATA-ONLY                          08790000
088000             PERFORM 8200-RETURN-TRANID                           08800000
088100     END-EVALUATE.                                                08810000
088200                                                                  08820000
088300 3320-INSERT-AUD-TRLR-EXC.                                        08830000
088400                                                                  08840000
088500     EXEC SQL                                                     08850000
088600         INSERT INTO SUT_AUD_TRLR_EXC                             08860000
088700           ( AUD_CNTL_NBR                                         08870000
088800            ,SHIPT_UNT_ID                                         08880000
088900            ,SCN_TMST                                             08890000
089000            ,ERR_CDE                                              08900000
089100           )                                                      08910000
089200         VALUES                                                   08920000
089300           ( :SUT00002-AUD-CNTL-NBR                               08930000
089400            ,:SUT00002-SHIPT-UNT-ID                               08940000
089500            ,:PV-SCAN-TIMESTAMP                                   08950000
089600            ,:SUT00002-ERR-CDE                                    08960000
089700           )                                                      08970000
089800     END-EXEC                                                     08980000
089900                                                                  08990000
090000                                                                  09000000
090100     EVALUATE TRUE                                                09010000
090200         WHEN SQLCODE = ZERO                                      09020000
090300              CONTINUE                                            09030000
090400         WHEN SQLWARN0 NOT = SPACES                               09040000
090500         WHEN SQLCODE NOT EQUAL ZERO                              09050000
090510             STRING 'INSERT-AUD-TRLR-EXC - '                      09051003
090520                    PV-SCAN-TIMESTAMP DELIMITED BY SIZE           09052002
090530                              INTO DP013-MESSAGE-TEXT (1)         09053002
090540             MOVE SUT00002-AUD-CNTL-NBR TO PV-DISP-AUD            09054002
090550             MOVE SUT00002-SHIPT-UNT-ID TO PV-DISP-SML            09055002
090560             MOVE SUT00002-ERR-CDE      TO PV-DISP-ERR-CDE        09056002
090570             STRING PV-DISP-AUD '-'                               09057002
090580                    PV-DISP-SML '-'                               09058002
090590                    PV-DISP-ERR-CDE DELIMITED BY SIZE             09059002
090591                              INTO DP013-MESSAGE-TEXT (2)         09059107
091200             MOVE SQLCA            TO DP013-SQLCA                 09120000
091300             MOVE 'SUT_AUD_TRLR_EXC '                             09130000
091400                                    TO DP013-DB2-TABLE-NAME (1)   09140000
091500             SET DP013-DB2-ABEND   TO TRUE                        09150000
091600             SET DP013-ROLLBACK TO TRUE                           09160000
091700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09170000
091800             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            09180000
091900             MOVE -1                     TO  ACARTNL              09190000
092000             PERFORM 8100-SEND-DATA-ONLY                          09200000
092100             PERFORM 8200-RETURN-TRANID                           09210000
092200     END-EVALUATE.                                                09220000
092300                                                                  09230000
092400******************************************************************09240000
092500*CHECK IF DC IS USING MANIFESTING                                 09250000
092600******************************************************************09260000
092700 3350-CHECK-FOR-MANIFESTING.                                      09270000
092800                                                                  09280000
092900     MOVE PV-18-SML-BC-DC-ORIGIN                                  09290000
093000                              TO DK-OPER-UNT-ID.                  09300000
093100                                                                  09310000
093200                                                                  09320000
093300     EXEC SQL                                                     09330000
093400          SELECT FUNC_END_TMST                                    09340000
093500          INTO  :KRPRPM-FUNC-END-TMST                             09350000
093600          FROM   TKRPRPM                                          09360000
093700          WHERE  SYS_PRC_FUNC_CDE  = 'DCMFST'                     09370000
093800            AND  LOC_ID            = :DK-OPER-UNT-ID              09380000
093900            AND  INTFC_SYS_CDE     = 'KHL'                        09390000
094000            AND  FUNC_PRC_STAT_CDE = 'AC'                         09400000
094100            AND  FUNC_TXT          = 'Y'                          09410000
094200     END-EXEC.                                                    09420000
094300                                                                  09430000
094400                                                                  09440000
094500     EVALUATE TRUE                                                09450000
094600         WHEN SQLCODE = ZERO                                      09460000
094700             SET PS-MANIFEST-DC-FOUND  TO TRUE                    09470000
094800         WHEN SQLCODE = +100                                      09480000
094900             SET PS-NON-MANIFEST-DC-FND TO TRUE                   09490000
095000         WHEN SQLWARN0 NOT = SPACES                               09500000
095100         WHEN SQLCODE < ZERO                                      09510000
095200         WHEN SQLCODE > ZERO                                      09520000
095300             MOVE '3350-CHECK-FOR-MANIFESTING'                    09530000
095400                 TO DP013-PARAGRAPH                               09540000
095500             MOVE 'SELECT OF TKRPRPM TABLE'                       09550000
095600                 TO DP013-MESSAGE-TEXT (1)                        09560000
095700             MOVE DK-SHIPT-UNT-ID                                 09570000
095800                 TO DP013-MESSAGE-TEXT (2)                        09580000
095900             MOVE SQLCA            TO DP013-SQLCA                 09590000
096000             MOVE 'TKRPRPM '                                      09600000
096100                                    TO DP013-DB2-TABLE-NAME (1)   09610000
096200             SET DP013-DB2-ABEND   TO TRUE                        09620000
096300             SET DP013-ROLLBACK TO TRUE                           09630000
096400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09640000
096500             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            09650000
096600             MOVE -1                     TO  ACARTNL              09660000
096700             PERFORM 8100-SEND-DATA-ONLY                          09670000
096800             PERFORM 8200-RETURN-TRANID                           09680000
096900     END-EVALUATE.                                                09690000
097000/                                                                 09700000
097100 3500-CHECK-FOR-DUPLICATE.                                        09710000
097200                                                                  09720000
097300     MOVE  PC045-AUDIT-CNTL-NBR   TO DK-AUDIT-CNTL-NBR            09730000
097400     MOVE  PC045-SHIP-UNIT-NBR    TO DK-SHIPT-UNT-ID              09740000
097500                                                                  09750000
097600     EXEC SQL                                                     09760000
097700         SELECT  SCN_TMST                                         09770000
097800           INTO  :SUT00000-SCN-TMST                               09780000
097900           FROM  SUT_AUD_TRLR_CART                                09790000
098000          WHERE  AUD_CNTL_NBR      =  :DK-AUDIT-CNTL-NBR          09800000
098100           AND   SHIPT_UNT_ID      =  :DK-SHIPT-UNT-ID            09810000
098200     END-EXEC.                                                    09820000
098300                                                                  09830000
098400     EVALUATE TRUE                                                09840000
098500         WHEN SQLCODE = ZERO                                      09850000
098600         WHEN SQLCODE = -811                                      09860000
098700              SET PS-DUPLICATE-SCAN-FND  TO TRUE                  09870000
098800         WHEN SQLCODE = +100                                      09880000
098900               CONTINUE                                           09890000
099000         WHEN SQLWARN0 NOT = SPACES                               09900000
099100         WHEN SQLCODE NOT EQUAL ZERO                              09910000
099200             MOVE '3500-CHECK-FOR-DUPLICATE'                      09920000
099300                 TO DP013-PARAGRAPH                               09930000
099400             MOVE 'SUT_AUD_TRLR_CART  '                           09940002
099500                 TO DP013-MESSAGE-TEXT (1)                        09950000
099710             MOVE DK-SHIPT-UNT-ID       TO PV-DISP-SML            09971002
099720             MOVE SUT00002-AUD-CNTL-NBR TO PV-DISP-AUD            09972002
099730             STRING  PV-DISP-SML ' - '                            09973002
099731                     PV-DISP-AUD    DELIMITED BY SIZE             09973102
099740                               INTO DP013-MESSAGE-TEXT (2)        09974002
099800             MOVE SQLCA            TO DP013-SQLCA                 09980000
099900             MOVE 'SUT_AUD_TRLR_CART'                             09990000
100000                                    TO DP013-DB2-TABLE-NAME (1)   10000000
100100             SET DP013-DB2-ABEND   TO TRUE                        10010000
100200             SET DP013-ROLLBACK TO TRUE                           10020000
100300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10030000
100400             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            10040000
100500             MOVE -1                     TO  ACARTNL              10050000
100600             PERFORM 8100-SEND-DATA-ONLY                          10060000
100700             PERFORM 8200-RETURN-TRANID                           10070000
100800     END-EVALUATE.                                                10080000
100900                                                                  10090000
101000******************************************************************10100000
101100*CHECK IF DC IS USING MANIFESTING                                 10110000
101200******************************************************************10120000
101300 3600-CHECK-FOR-OTBND-CART.                                       10130000
101400                                                                  10140000
101500     MOVE PC046-CARTON-ID  TO SUT00024-SHIPT-UNT-ID.              10150000
101600                                                                  10160000
101700     EXEC SQL                                                     10170000
101800          SELECT CRE_PGM_NM                                       10180000
101900          INTO  :SUT00024-CRE-PGM-NM                              10190000
102000          FROM   SUT_OTBND_CART                                   10200000
102100          WHERE  SHIPT_UNT_ID  = :SUT00024-SHIPT-UNT-ID           10210000
102200     END-EXEC.                                                    10220000
102300                                                                  10230000
102400                                                                  10240000
102500     EVALUATE TRUE                                                10250000
102600         WHEN SQLCODE = ZERO                                      10260000
102700             SET PS-OTBND-CART-ROW-FND TO TRUE                    10270000
102800         WHEN SQLCODE = +100                                      10280000
102900             SET PS-NO-OTBND-CART-ROW-FND TO TRUE                 10290000
103000         WHEN SQLWARN0 NOT = SPACES                               10300000
103100         WHEN SQLCODE < ZERO                                      10310000
103200         WHEN SQLCODE > ZERO                                      10320000
103300             MOVE '3600-CHECK-FOR-OTBND-CART'                     10330000
103400                 TO DP013-PARAGRAPH                               10340000
103500             MOVE 'SELECT OF TKRPRPM TABLE'                       10350000
103600                 TO DP013-MESSAGE-TEXT (1)                        10360000
103700             MOVE SUT00024-SHIPT-UNT-ID                           10370000
103800                 TO DP013-MESSAGE-TEXT (2)                        10380000
103900             MOVE SQLCA            TO DP013-SQLCA                 10390000
104000             MOVE 'SUT00024'                                      10400000
104100                                    TO DP013-DB2-TABLE-NAME (1)   10410000
104200             SET DP013-DB2-ABEND   TO TRUE                        10420000
104300             SET DP013-ROLLBACK TO TRUE                           10430000
104400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10440000
104500             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            10450000
104600             MOVE -1                     TO  ACARTNL              10460000
104700             PERFORM 8100-SEND-DATA-ONLY                          10470000
104800             PERFORM 8200-RETURN-TRANID                           10480000
104900     END-EVALUATE.                                                10490000
105000/                                                                 10500000
105100 4000-PROCESS-VALID-CARTONS.                                      10510000
105200**'S'  AUDIT TO SAME TRAILER                                      10520000
105300**'D'  AUDIT TO DIFFERENT TRAILER                                 10530000
105400**'C'  AUDIT TO CONVEYOR                                          10540000
105500                                                                  10550000
105600     EVALUATE TRUE                                                10560000
105700       WHEN PC046-DIVERTED-TO-TRLR                                10570000
105800          PERFORM 4100-INACTV-DIVERT-TABLE                        10580000
105900          PERFORM 4200-INSERT-SCNOFF-CART-LOC                     10590000
106000       WHEN PC046-SCANNED-ONTO-TRLR                               10600000
106100          PERFORM  4300-INACTIVATE-SHON                           10610000
106200          PERFORM  4200-INSERT-SCNOFF-CART-LOC                    10620000
106300       WHEN PC046-LOADED-ONTO-TRLR                                10630000
106400          PERFORM 4100-INACTV-DIVERT-TABLE                        10640000
106500          PERFORM 4200-INSERT-SCNOFF-CART-LOC                     10650000
106600     END-EVALUATE.                                                10660000
106700                                                                  10670000
106800**IF AUDIT IS TO A DIFFERENT TRAILER, SCAN THE CARTON TO THE      10680000
106900**AUDIT-TO TRAILER                                                10690000
107000     IF PC045-DEST-TYP-CDE = 'D'                                  10700000
107100        PERFORM  4250-INSERT-SHON-CART-LOC                        10710000
107200     END-IF.                                                      10720000
107300                                                                  10730000
107400******************************************************************10740000
107500 4050-PROCESS-INVALID-CARTONS.                                    10750000
107600******************************************************************10760000
107700                                                                  10770000
107800                                                                  10780000
107900          EVALUATE TRUE                                           10790000
108000            WHEN SUT00002-ERR-CDE = 'A'                           10800000
108100**IF THE CARTON IS NOT MANIFESTED TO TRAILER CHECK THE STATUS OF  10810000
108200**THE PC046-TRIP-STATUS OF CRTN TRAILER                           10820000
108300**CHECK STATUS OF TRAILER THE CARTON ORIGINALLY MANIFESTED TO     10830000
108400              IF PS-NO-TRLR-CRTN-DEST-MISMATCH                    10840000
108500                 IF PC046-TRIP-STATUS = 'DO' OR 'DC'              10850000
108600                     PERFORM 4000-PROCESS-VALID-CARTONS           10860000
108700                 ELSE                                             10870000
108800                     MOVE PC-ERROR-MESSAGE-PROGRAM                10880000
108900                                  TO PV-TRANSFER-PROGRAM          10890000
109000                     PERFORM 2100-XCTL-TO-SELECTED-PROGRAM        10900000
109100                 END-IF                                           10910000
109200              ELSE                                                10920000
109300                  MOVE PC-ERROR-MESSAGE-PROGRAM                   10930000
109400                                TO PV-TRANSFER-PROGRAM            10940000
109500                  PERFORM 2100-XCTL-TO-SELECTED-PROGRAM           10950000
109600              END-IF                                              10960000
109700            WHEN OTHER                                            10970000
109800               MOVE PC-ERROR-MESSAGE-PROGRAM                      10980000
109900                             TO PV-TRANSFER-PROGRAM               10990000
110000               PERFORM 2100-XCTL-TO-SELECTED-PROGRAM              11000000
110100          END-EVALUATE.                                           11010000
110200                                                                  11020000
110300                                                                  11030000
110400*-----------------------------------------------------------------11040000
110500*IF THE CARTON WAS DIVERTED, THE ACTIVE ENTRY CODE WILL = 'A'.    11050000
110600*-----------------------------------------------------------------11060000
110700 4100-INACTV-DIVERT-TABLE.                                        11070000
110800     EXEC SQL                                                     11080000
110900         UPDATE TSUCRDV                                           11090000
111000         SET                                                      11100000
111100             ACTV_CDE        =  :PC-I                             11110000
111110           , NACTV_USR_ID    =  'TRLRAUD'                         11111001
111200         WHERE  SHIPT_UNT_ID =  :DK-SHIPT-UNT-ID                  11120000
111700     END-EXEC.                                                    11170000
111800                                                                  11180000
111900     EVALUATE TRUE                                                11190000
112000         WHEN SQLCODE = ZERO                                      11200000
112100              CONTINUE                                            11210000
112200         WHEN SQLWARN0 NOT = SPACES                               11220000
112300         WHEN SQLCODE NOT EQUAL ZERO                              11230000
112400             MOVE '4100-INACTV-DIVERT-TABLE'                      11240000
112500                 TO DP013-PARAGRAPH                               11250000
112600             MOVE 'SELECT OF TSUCRDV TABLE'                       11260000
112700                 TO DP013-MESSAGE-TEXT (1)                        11270000
112800             MOVE DK-SHIPT-UNT-ID                                 11280000
112900                 TO DP013-MESSAGE-TEXT (2)                        11290000
113000             MOVE SQLCA            TO DP013-SQLCA                 11300000
113100             MOVE 'SUT_AUD_TRLR_CART'                             11310000
113200                                    TO DP013-DB2-TABLE-NAME (1)   11320000
113300             SET DP013-DB2-ABEND   TO TRUE                        11330000
113400             SET DP013-ROLLBACK TO TRUE                           11340000
113500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11350000
113600             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            11360000
113700             MOVE -1                     TO  ACARTNL              11370000
113800             PERFORM 8100-SEND-DATA-ONLY                          11380000
113900             PERFORM 8200-RETURN-TRANID                           11390000
114000     END-EVALUATE.                                                11400000
114100                                                                  11410000
114200*-----------------------------------------------------------------11420000
114300*INSERT ROW TO SUT_OTBND_LOC TO SCAN CARTON OFF OF TRAILER        11430000
114400*WHEN AUDITING TO CONVEYOR OR ANOTHER TRAILER                     11440000
114500*-----------------------------------------------------------------11450000
114600 4200-INSERT-SCNOFF-CART-LOC.                                     11460000
114700     IF PC046-SRC-CHECKED-IN                                      11470000
114800       MOVE PC046-VENDOR-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID   11480000
114900     ELSE                                                         11490000
115000       MOVE PC046-CARTON-ID            TO SUT00027-SHIPT-UNT-ID   11500000
115100     END-IF                                                       11510000
115200                                                                  11520000
115300     MOVE PC045-OPER-UNT-ID             TO SUT00027-LOC-NBR.      11530000
115400     MOVE 'SHOF'                        TO SUT00027-SCN-CDE.      11540000
115500     MOVE  PC045-USERID                 TO SUT00027-CRE-USR-ID.   11550000
115600     MOVE PC046-OTBD-TRIP-ID            TO SUT00027-OTBND-TRIP-ID.11560000
115700     MOVE 0                             TO SUT00027-INBD-TRIP-ID. 11570000
115800                                                                  11580000
115900     EXEC SQL                                                     11590000
116000         INSERT INTO SUT_OTBND_LOC                                11600000
116100               (SHIPT_UNT_ID                                      11610000
116200              , CRE_TMST                                          11620000
116300              , OTBND_TRIP_ID                                     11630000
116400              , LOC_NBR                                           11640000
116500              , SCN_CDE                                           11650000
116600              , CRE_USR_ID                                        11660000
116700              , ACTV_CDE                                          11670000
116800              , INBD_TRIP_ID)                                     11680000
116900         VALUES (:SUT00027-SHIPT-UNT-ID                           11690000
117000               ,  CURRENT TIMESTAMP                               11700000
117100               , :SUT00027-OTBND-TRIP-ID                          11710000
117200               , :SUT00027-LOC-NBR                                11720000
117300               , :SUT00027-SCN-CDE                                11730000
117400               , :SUT00027-CRE-USR-ID                             11740000
117500               , 'I'                                              11750000
117600               , :SUT00027-INBD-TRIP-ID)                          11760000
117700     END-EXEC.                                                    11770000
117800                                                                  11780000
117900                                                                  11790000
118000     EVALUATE TRUE                                                11800000
118100         WHEN SQLCODE = ZERO                                      11810000
118200              CONTINUE                                            11820000
118300         WHEN SQLWARN0 NOT = SPACES                               11830000
118400         WHEN SQLCODE NOT EQUAL ZERO                              11840000
118500             MOVE '4200-INSERT-SCNOFF-CART-LOC'                   11850000
118600                 TO DP013-PARAGRAPH                               11860000
118700             MOVE 'INSERT TO SUT_OTBND_LOC TABLE'                 11870000
118800                 TO DP013-MESSAGE-TEXT (1)                        11880000
118900             MOVE SUT00027-SHIPT-UNT-ID                           11890000
119000                 TO DP013-MESSAGE-TEXT (2)                        11900000
119100             MOVE PC045-AUDIT-CNTL-NBR                            11910000
119200                 TO DP013-MESSAGE-TEXT (3)                        11920000
119300             MOVE SQLCA            TO DP013-SQLCA                 11930000
119400             MOVE 'SUT00027'                                      11940000
119500                                    TO DP013-DB2-TABLE-NAME (1)   11950000
119600             SET DP013-DB2-ABEND   TO TRUE                        11960000
119700             SET DP013-ROLLBACK TO TRUE                           11970000
119800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11980000
119900             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            11990000
120000             MOVE -1                     TO  ACARTNL              12000000
120100             PERFORM 8100-SEND-DATA-ONLY                          12010000
120200             PERFORM 8200-RETURN-TRANID                           12020000
120300     END-EVALUATE.                                                12030000
120400                                                                  12040000
120500                                                                  12050000
120600*-----------------------------------------------------------------12060000
120700*INSERT ROW TO SUT_OTBND_LOC TO SCAN CARTON OFF OF TRAILER        12070000
120800*WHEN AUDITING TO CONVEYOR OR ANOTHER TRAILER                     12080000
120900*-----------------------------------------------------------------12090000
121000 4250-INSERT-SHON-CART-LOC.                                       12100000
121100                                                                  12110000
121200     IF PC046-CHECKED-IN                                          12120000
121300       MOVE PC046-VENDOR-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID   12130000
121400     ELSE                                                         12140000
121500       MOVE PC046-CARTON-ID            TO SUT00027-SHIPT-UNT-ID   12150000
121600     END-IF                                                       12160000
121700                                                                  12170000
121800     MOVE PC045-OPER-UNT-ID             TO SUT00027-LOC-NBR.      12180000
121900     MOVE 'SHON'                        TO SUT00027-SCN-CDE.      12190000
122000     MOVE  PC045-USERID                 TO SUT00027-CRE-USR-ID.   12200000
122100     MOVE PC045-AUD-TO-TRIP-ID          TO SUT00027-OTBND-TRIP-ID.12210000
122200     MOVE PC046-OTBD-TRIP-ID            TO SUT00027-INBD-TRIP-ID. 12220000
122300                                                                  12230000
122400     EXEC SQL                                                     12240000
122500         INSERT INTO SUT_OTBND_LOC                                12250000
122600               (SHIPT_UNT_ID                                      12260000
122700              , LOC_NBR                                           12270000
122800              , SCN_CDE                                           12280000
122900              , CRE_USR_ID                                        12290000
123000              , CRE_TMST                                          12300000
123100              , OTBND_TRIP_ID                                     12310000
123200              , INBD_TRIP_ID                                      12320000
123300              , ACTV_CDE)                                         12330000
123400         VALUES (:SUT00027-SHIPT-UNT-ID                           12340000
123500               , :SUT00027-LOC-NBR                                12350000
123600               , :SUT00027-SCN-CDE                                12360000
123700               , :SUT00027-CRE-USR-ID                             12370000
123800               ,  CURRENT TIMESTAMP                               12380000
123900               , :SUT00027-OTBND-TRIP-ID                          12390000
124000               , :SUT00027-INBD-TRIP-ID                           12400000
124100               , 'A')                                             12410000
124200     END-EXEC.                                                    12420000
124300                                                                  12430000
124400     EVALUATE TRUE                                                12440000
124500         WHEN SQLCODE = ZERO                                      12450000
124600              CONTINUE                                            12460000
124700         WHEN SQLWARN0 NOT = SPACES                               12470000
124800         WHEN SQLCODE NOT EQUAL ZERO                              12480000
124900             MOVE '4250-INSERT-SHON-CART-LOC'                     12490000
125000                 TO DP013-PARAGRAPH                               12500000
125100             MOVE 'SELECT OF TSUCRDV TABLE'                       12510000
125200                 TO DP013-MESSAGE-TEXT (1)                        12520000
125300             MOVE SUT00027-SHIPT-UNT-ID                           12530000
125400                 TO DP013-MESSAGE-TEXT (2)                        12540000
125500             MOVE SQLCA            TO DP013-SQLCA                 12550000
125600             MOVE 'SUT00027'                                      12560000
125700                                    TO DP013-DB2-TABLE-NAME (1)   12570000
125800             SET DP013-DB2-ABEND   TO TRUE                        12580000
125900             SET DP013-ROLLBACK TO TRUE                           12590000
126000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12600000
126100             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            12610000
126200             MOVE -1                     TO  ACARTNL              12620000
126300             PERFORM 8100-SEND-DATA-ONLY                          12630000
126400             PERFORM 8200-RETURN-TRANID                           12640000
126500     END-EVALUATE.                                                12650000
126600                                                                  12660000
126700*-----------------------------------------------------------------12670000
126800* RI-EXISTS BETWEEN SUT_OTBND_LOC AND SUT_OTBND_CART, SO          12680000
126900* CARTON IDS ON SUT_OTBND_LOC MUST EXIST ON SUT_OTBND_CART        12690000
127000* VENDOR CARTONS THAT ARE PROCESSED THROUGH THE CHECK-IN APPL     12700000
127100* WILL HAVE A ROW ON TSULBXF AND REFER BACK TO THE VENDOR BARCODE 12710000
127200* ON SUT_OTBND_LOC.CARTONS CREATED FROM OTHER                     12720000
127300* SOURCES(CASEPACK,SMOOTHING                                      12730000
127400* ETC) WILL USE THE NEWLY CREATED KOHLS BARCODE.                  12740000
127500*-----------------------------------------------------------------12750000
127600 4300-INACTIVATE-SHON.                                            12760000
127700     IF PC046-SRC-CHECKED-IN                                      12770000
127800       MOVE PC046-VENDOR-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID   12780000
127900     ELSE                                                         12790000
128000       MOVE PC046-CARTON-ID            TO SUT00027-SHIPT-UNT-ID   12800000
128100     END-IF                                                       12810000
128200                                                                  12820000
128300     EXEC SQL                                                     12830000
128400         UPDATE SUT_OTBND_LOC                                     12840000
128500         SET                                                      12850000
128600             ACTV_CDE        =  'I'                               12860000
128700         WHERE  SHIPT_UNT_ID =  :SUT00027-SHIPT-UNT-ID            12870000
128800           AND  CRE_TMST IN                                       12880000
128900                 (SELECT MAX(B.CRE_TMST)                          12890000
129000                    FROM SUT_OTBND_LOC B                          12900000
129100                   WHERE B.SHIPT_UNT_ID = :SUT00027-SHIPT-UNT-ID  12910006
129110                     AND B.SCN_CDE      = 'SHON')                 12911006
129200     END-EXEC.                                                    12920000
129300                                                                  12930000
129400     EVALUATE TRUE                                                12940000
129500         WHEN SQLCODE = ZERO                                      12950000
129600              CONTINUE                                            12960000
129700         WHEN SQLWARN0 NOT = SPACES                               12970000
129800         WHEN SQLCODE NOT EQUAL ZERO                              12980000
129900             MOVE '4300-INACTIVATE-SHON'                          12990000
130000                 TO DP013-PARAGRAPH                               13000000
130100             MOVE 'UPDATE OF SUT_OTBND_LOC TABLE'                 13010000
130200                 TO DP013-MESSAGE-TEXT (1)                        13020000
130300             MOVE SUT00027-SHIPT-UNT-ID                           13030000
130400                 TO DP013-MESSAGE-TEXT (2)                        13040000
130500             MOVE SQLCA            TO DP013-SQLCA                 13050000
130600             MOVE 'SUT00027'                                      13060000
130700                                    TO DP013-DB2-TABLE-NAME (1)   13070000
130800             SET DP013-DB2-ABEND   TO TRUE                        13080000
130900             SET DP013-ROLLBACK TO TRUE                           13090000
131000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13100000
131100             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            13110000
131200             MOVE -1                     TO  ACARTNL              13120000
131300             PERFORM 8100-SEND-DATA-ONLY                          13130000
131400             PERFORM 8200-RETURN-TRANID                           13140000
131500     END-EVALUATE.                                                13150000
131600                                                                  13160000
131700*-----------------------------------------------------------------13170000
131800*IF THE CARTON WAS DIVERTED, CHECK FOR ASSUMED CARTONS            13180000
131900* CARTONS THAT FALL BETWEEN A BEGIN CUTOFF WITH NO END CUTOFF     13190000
132000*-----------------------------------------------------------------13200000
132100 4500-CHECK-FOR-ASSUMED-CRTNS.                                    13210000
132200     MOVE PC045-OTBND-TRIP-ID     TO DK-OTBND-TRIP-ID.            13220000
132300     MOVE PC046-CRTN-STAT-TMST    TO PV-CRTN-STAT-TMST.           13230000
132400     MOVE PV-CRTN-STAT-TMST       TO DK-CARTON-TMST.              13240000
132500                                                                  13250000
132600                                                                  13260000
132700     EXEC SQL                                                     13270000
132800          SELECT  OTBND_TRIP_ID                                   13280000
132900            INTO  :SUCDOT-OTBND-TRIP-ID                           13290000
133000            FROM  TSUCDOT                                         13300000
133100           WHERE  OTBND_TRIP_ID     = :DK-OTBND-TRIP-ID           13310000
133200             AND  DOOR_ID           = :PC046-DOOR-ID              13320000
133300             AND  STRT_DIVERT_TMST <= :DK-CARTON-TMST             13330000
133400             AND  END_DIVERT_TMST  >= :PC-DEFAULT-DATE            13340000
133500     END-EXEC.                                                    13350000
133600                                                                  13360000
133700     EVALUATE TRUE                                                13370000
133800         WHEN SQLCODE = ZERO                                      13380000
133900              MOVE SUCDOT-OTBND-TRIP-ID TO PC046-OTBD-TRIP-ID     13390000
134000         WHEN SQLCODE = +100                                      13400000
134100              CONTINUE                                            13410000
134200         WHEN SQLWARN0 NOT = SPACES                               13420000
134300         WHEN SQLCODE NOT EQUAL ZERO                              13430000
134400             MOVE  PC045-SHIP-UNIT-NBR    TO DK-SHIPT-UNT-ID      13440000
134500             MOVE '4500-CHECK-FOR-ASSUMED-CRTNS'                  13450000
134600                 TO DP013-PARAGRAPH                               13460000
134700             MOVE 'SELECT OF TSUCDOT TABLE'                       13470000
134800                 TO DP013-MESSAGE-TEXT (1)                        13480000
134900             MOVE DK-SHIPT-UNT-ID                                 13490000
135000                 TO DP013-MESSAGE-TEXT (2)                        13500000
135100             MOVE SQLCA            TO DP013-SQLCA                 13510000
135200             MOVE 'TSUCDOT'                                       13520000
135300                                    TO DP013-DB2-TABLE-NAME (1)   13530000
135400             SET DP013-DB2-ABEND   TO TRUE                        13540000
135500             SET DP013-ROLLBACK TO TRUE                           13550000
135600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13560000
135700             MOVE PC044-DB2-FATAL-ERROR-MSG TO AMSGLNO            13570000
135800             MOVE -1                     TO  ACARTNL              13580000
135900             PERFORM 8100-SEND-DATA-ONLY                          13590000
136000             PERFORM 8200-RETURN-TRANID                           13600000
136100     END-EVALUATE.                                                13610000
136200                                                                  13620000
136300                                                                  13630000
136400                                                                  13640000
136500 8000-SEND-MAP.                                                   13650000
136600     EXEC CICS                                                    13660000
136700         SEND MAP       ('PC894A')                                13670000
136800              MAPSET    ('PCKM894')                               13680000
136900              ERASE                                               13690000
137000              RESP      (PV-CICS-RESPONSE)                        13700000
137100     END-EXEC.                                                    13710000
137200                                                                  13720000
137300     EVALUATE TRUE                                                13730000
137400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13740000
137500              CONTINUE                                            13750000
137600         WHEN OTHER                                               13760000
137700              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           13770000
137800              MOVE 'UNABLE TO SEND MAP'                           13780000
137900                                     TO DP013-MESSAGE-TEXT (1)    13790000
138000              SET DP013-CICS-ABEND   TO TRUE                      13800000
138100              SET DP013-ROLLBACK  TO TRUE                         13810000
138200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13820000
138300     END-EVALUATE.                                                13830000
138400*                                                                 13840000
138500 8100-SEND-DATA-ONLY.                                             13850000
138600     MOVE -1 TO ACARTNL.                                          13860000
138700                                                                  13870000
138800     EXEC CICS                                                    13880000
138900         SEND MAP       ('PC894A')                                13890000
139000              MAPSET    ('PCKM894')                               13900000
139100              CURSOR                                              13910000
139200              DATAONLY                                            13920000
139300              RESP      (PV-CICS-RESPONSE)                        13930000
139400     END-EXEC.                                                    13940000
139500                                                                  13950000
139600     EVALUATE TRUE                                                13960000
139700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13970000
139800              CONTINUE                                            13980000
139900         WHEN OTHER                                               13990000
140000              MOVE '8100-SEND-DATA-ONLY'                          14000000
140100                                     TO DP013-PARAGRAPH           14010000
140200              MOVE 'UNABLE TO SEND DATA'                          14020000
140300                                     TO DP013-MESSAGE-TEXT (1)    14030000
140400              SET DP013-CICS-ABEND   TO TRUE                      14040000
140500              SET DP013-ROLLBACK  TO TRUE                         14050000
140600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              14060000
140700     END-EVALUATE.                                                14070000
140800*                                                                 14080000
140900*                                                                 14090000
141000 8200-RETURN-TRANID.                                              14100000
141100     MOVE PC045-COMMAREA-REC          TO PC233-HOST-SAVE-AREA.    14110000
141200     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       14120000
141300     EXEC CICS                                                    14130000
141400         RETURN TRANSID   (PC-CURRENT-TRANID)                     14140000
141500                COMMAREA  (CA-COMMAREA)                           14150000
141600                LENGTH    (PV-COMMAREA-LENGTH)                    14160000
141700                RESP      (PV-CICS-RESPONSE)                      14170000
141800     END-EXEC.                                                    14180000
141900                                                                  14190000
142000     EVALUATE TRUE                                                14200000
142100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14210000
142200              CONTINUE                                            14220000
142300         WHEN OTHER                                               14230000
142400              MOVE '8200-RETURN-TRANID'                           14240000
142500                                     TO DP013-PARAGRAPH           14250000
142600              MOVE 'UNABLE TO RETURN TO TRANID'                   14260000
142700                                     TO DP013-MESSAGE-TEXT (1)    14270000
142800              SET DP013-CICS-ABEND   TO TRUE                      14280000
142900              SET DP013-ROLLBACK  TO TRUE                         14290000
143000              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              14300000
143100     END-EVALUATE.                                                14310000
143200*                                                                 14320000
143300                                                                  14330000
143400 9904-WRITE-CRTN-MODULE-MSG.                                      14340000
143401                                                                  14340100
143402     MOVE '3000'                      TO  PV-CTN-PARA             14340200
143403     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          14340300
143404     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           14340400
143405     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        14340500
143406     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      14340600
143407     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             14340700
143408     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        14340800
143409     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      14340900
143410                                                                  14341000
143411     EXEC CICS                                                    14341100
143412         WRITEQ TD                                                14341200
143413             QUEUE  ('CSSL')                                      14341300
143414             FROM   (PV-CARTON-MSG)                               14341400
143415             RESP   (PV-CICS-RESPONSE)                            14341500
143416     END-EXEC.                                                    14341600
143417                                                                  14341700
143418     EXEC CICS                                                    14341800
143419         WRITEQ TD                                                14341900
143420             QUEUE  ('CSSL')                                      14342000
143430             FROM   (PC046-CRA-RET-MSG)                           14343000
143440             RESP   (PV-CICS-RESPONSE)                            14344000
143450     END-EXEC.                                                    14345000
143460                                                                  14346000
143470*                                                                 14347000
143480 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  14348000
143490     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            14349000
143500     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           14350000
143600     INITIALIZE DP013-SRC-TASK-NUMBER                             14360000
143700                DP013-STACK.                                      14370000
143800     SET DP013-LINK-RETURN           TO TRUE.                     14380000
143900                                                                  14390000
144000     EXEC CICS                                                    14400000
144100         LINK                                                     14410000
144200             PROGRAM   (DP013-NAME)                               14420000
144300             COMMAREA  (DP013-PARAMETERS)                         14430000
144400             LENGTH    (DP013-LENGTH)                             14440000
144500     END-EXEC.                                                    14450000
