000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.      SSKRP027.                                       00030000
000400 AUTHOR.          BARB SCHULTZ.                                   00040000
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
000600 DATE-WRITTEN.    02/27/2007.                                     00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*  MODULE TYPE:   COBOL2 BATCH                                    00100099
001100*                                                                 00110000
001200*  DESCRIPTION: CREATES THE DAILY STORE MANAGEMENT SALES SUMMARY  00120000
001300*               FROM AN EXTRACT FILE CREATED BY SSKUT027,         00130000
001400*               WHICH IS SORTED IN THE FOLLOWING SEQUENCE:        00140000
001500*               (SALES REFLECT THIS YEAR'S TOTAL SALES)           00150000
001600*               1) TERRITORY                                      00160000
001700*               2) REGION                                         00170000
001800*               3) DISTRICT                                       00180000
001900*               4) DESCENDING STORE YTD SALES                     00190000
002000*                                                                 00200000
002100******************************************************************00210000
002800                                                                  00269300
002900 ENVIRONMENT DIVISION.                                            00269400
003000 CONFIGURATION SECTION.                                           00269500
003100                                                                  00269600
003200 SOURCE-COMPUTER.        IBM-3090.                                00269700
003300 OBJECT-COMPUTER.        IBM-3090.                                00269800
003400                                                                  00269900
003500 INPUT-OUTPUT SECTION.                                            00270000
003600 FILE-CONTROL.                                                    00280000
003700                                                                  00290000
003800     SELECT CTLCD-DATE-FILE       ASSIGN TO INP01                 00300000
003900         FILE STATUS IS WS-DATE-FILE-STATUS.                      00310000
004000     SELECT INPUT-EXTRACT-FILE    ASSIGN TO INP02                 00320000
004100         FILE STATUS IS WS-INPUT-EXTRACT-STATUS.                  00330000
004200     SELECT REPORT-FILE           ASSIGN TO RPT01                 00340000
004300         FILE STATUS IS WS-REPORT-FILE-STATUS.                    00350000
004400                                                                  00360000
004500 DATA DIVISION.                                                   00370000
004600 FILE SECTION.                                                    00380000
004700                                                                  00390000
004800 FD  CTLCD-DATE-FILE                                              00400000
004900     RECORDING MODE IS F                                          00410000
005000     LABEL RECORDS ARE STANDARD                                   00420000
005100     BLOCK CONTAINS 0 RECORDS                                     00430000
005200     RECORD CONTAINS 80 CHARACTERS.                               00440000
005300                                                                  00450000
005400 01  CTLCD-DATE-RECORD                 PIC  X(80).                00460000
005500                                                                  00470000
005600                                                                  00480000
005700 FD  INPUT-EXTRACT-FILE                                           00490000
005800     RECORDING MODE IS F                                          00500000
005900     LABEL RECORDS ARE STANDARD                                   00510000
006000     BLOCK CONTAINS 0 RECORDS                                     00520000
006100     RECORD CONTAINS 263 CHARACTERS.                              00530026
006200                                                                  00540000
006300 01  INPUT-EXTRACT-RECORD              PIC  X(263).               00550026
006400                                                                  00560000
006500                                                                  00570000
006600 FD  REPORT-FILE                                                  00580000
006700     RECORDING MODE IS F                                          00590000
006800     LABEL RECORDS ARE STANDARD                                   00600000
006900     BLOCK CONTAINS 0 RECORDS                                     00610000
007000     RECORD CONTAINS 212 CHARACTERS.                              00620000
007100                                                                  00630000
007200 01  REPORT-RECORD                     PIC  X(212).               00640000
007300                                                                  00650000
007400******************************************************************00660000
007500*                       WORKING STORAGE                           00670000
007600******************************************************************00680000
007700 WORKING-STORAGE SECTION.                                         00690000
007800                                                                  00700000
007900 01  WS-START                          PIC  X(40)                 00710000
008000     VALUE 'SSKRP027 - WORKING STORAGE BEGINS HERE'.              00720000
008100                                                                  00730000
008200                                                                  00740000
008300******************************************************************00750000
008400*                         SWITCHES                                00760000
008500******************************************************************00770000
008600 01  PS-PROGRAM-SWITCHES.                                         00780000
008700     05  PS-END-OF-CTLCD-FILE-SW      PIC  X(01)    VALUE 'N'.    00790000
008800         88  PS-END-OF-CTLCD-FILE                   VALUE 'Y'.    00800000
008900                                                                  00810000
009000     05  PS-END-OF-INPUT-FILE-SW       PIC  X(01)    VALUE 'N'.   00820000
009100         88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00830000
009200                                                                  00840000
009000     05  PS-EMPTY-SW                   PIC  X(01)    VALUE 'N'.   00841054
009100         88  PS-EMPTY-LINE                           VALUE 'Y'.   00842054
009100         88  PS-DONT-EMPTY-LINE                      VALUE 'N'.   00842159
009200                                                                  00843054
009000     05  PS-COLUMN-SW                  PIC  X(01)    VALUE '1'.   00844059
009100         88  PS-COLUMN1                              VALUE '1'.   00845059
009100         88  PS-COLUMN2                              VALUE '2'.   00846059
009100         88  PS-COLUMN3                              VALUE '3'.   00846159
009200                                                                  00847059
009300******************************************************************00850000
009400*                        CONSTANTS                                00860000
009500******************************************************************00870000
009600 01  PC-PROGRAM-CONSTANTS.                                        00880000
009700     05  PC-PROGRAM-NAME               PIC X(8)  VALUE 'SSKRP027'.00890000
009800     05  PC-LINE-LIMIT                 PIC S9(3) VALUE +100.      00900000
009900                                                                  00910000
010000******************************************************************00920000
010100*                        VARIABLES                                00930000
010200******************************************************************00940000
010300 01  PV-PROGRAM-VARIABLES.                                        00950000
010400                                                                  00960000
010410     05  PV-FORMATTED-REGN-NAME        PIC X(22) VALUE SPACES.    00970026
010420**       PV-CONT-REGN-NAME AND PV-REGN-ALL-COMP-DESC TOGETHER     00980003
010500     05  PV-CONT-REGN-NAME             PIC X(22) VALUE SPACES.    00990026
010600**       PV-CONT-REGN-NAME IS SET WHEN A REGN RECORD IS READ      01000003
010700**       AND USED WHEN A CONTINUATION LINE IS NEEDED AT THE TOP   01010000
010800**       OF A COLUMN - ONLY 12 CHARS ARE SAVED SINCE THAT IS ALL  01020000
010900**       THERE IS ROOM FOR ON A NORMAL PRINT LINE.                01030000
010910     05  PV-REGN-ALL-COMP-DESC         PIC X(7)  VALUE SPACES.    01040003
010410     05  PV-FORMATTED-DIST-NAME        PIC X(22) VALUE SPACES.    01041026
010420**       PV-CONT-DIST-NAME AND PV-DIST-ALL-COMP-DESC TOGETHER     01042004
010500     05  PV-CONT-DIST-NAME             PIC X(22) VALUE SPACES.    01043026
010600**       PV-CONT-DIST-NAME IS SET WHEN A DIST RECORD IS READ      01044004
010700**       AND USED WHEN A CONTINUATION LINE IS NEEDED AT THE TOP   01045004
010800**       OF A COLUMN - ONLY 12 CHARS ARE SAVED SINCE THAT IS ALL  01046004
010900**       THERE IS ROOM FOR ON A NORMAL PRINT LINE.                01047004
010910     05  PV-DIST-ALL-COMP-DESC         PIC X(7)  VALUE SPACES.    01048004
010930**       EITHER ' - ALL '  OR  ' - COMP'                          01050000
010931     05  PV-SUB                        PIC S9(4) VALUE ZEROES.    01060000
010940                                                                  01070000
011000     05  PV-DATA-COUNT                 PIC S9(3) VALUE +0.        01080000
011100**       PV-DATA-COUNT IS THE NUMBER OF INPUT RECORDS BEING       01090000
011200**       PROCESSED ON THE CURRENT PAGE.  IT ALLOWS FOR            01100000
011300**       CONTINUATION LINES AT THE TOP OF EACH COLUMN.  IT        01110000
011400**       SHOULD NEVER EXCEED 285 (3 COLUMNS OF 95).               01120000
011500     05  PV-DIV-BY-1000                PIC S9(7) VALUE +0.        01130000
011510     05  PV-DIV-BY-1000000             PIC S9(5)V9 VALUE +0.      01140000
011600     05  PV-PAGE-COUNT                 PIC S9(3) VALUE +1.        01150000
011700     05  PV-PAGE-LINE                  PIC S9(3) VALUE +0.        01160000
011800**       PV-LINE-COUNT IS THE DETAIL LINE NUMBER BEING FILLED     01170000
011900**       IN ON THE CURRENT PAGE.  IT SHOULD NEVER EXCEED 95.      01180000
012000**       WHEN MOVING DATA TO THE 50TH LINE OF THE 3RD COLUMN,     01190000
012100**       PV-DATA-COUNT WILL = 240 AND PV-PAGE-LINE WILL = 50.     01200000
012200     05  PV-PCT-CHANGE                 PIC S9(4)V9(4) VALUE +0.   01210000
012300     05  PV-RUN-DATE-CCYY-MM-DD        PIC X(10) VALUE SPACES.    01220000
032200     05  PV-SAVE-TERR-NM               PIC X(17) VALUE SPACES.    01221093
032200     05  PV-SAVE-REGN-NM               PIC X(17) VALUE SPACES.    01222093
032200     05  PV-SAVE-DIST-NM               PIC X(17) VALUE SPACES.    01223093
012400                                                                  01230000
012500******************************************************************01240000
012600*                        WORK AREA                                01250000
012700******************************************************************01260000
012800 01  WS-WORK-AREA.                                                01270000
012900                                                                  01280000
013000     05  WS-DATE-FILE-STATUS           PIC X(02) VALUE ZEROS.     01290000
013100     05  WS-INPUT-EXTRACT-STATUS       PIC X(02) VALUE ZEROS.     01300000
013200     05  WS-REPORT-FILE-STATUS         PIC X(02) VALUE ZEROS.     01310000
013200     05  WS-SAVE-TERR                  PIC 9(04) VALUE 1.         01311041
013300                                                                  01320000
013400******************************************************************01330000
013500*                        ACCUMULATORS                             01340000
013600******************************************************************01350000
013700 01  PA-PROGRAM-ACCUMS.                                           01360000
013800                                                                  01370000
013900     05  PA-INPUT-READ                 PIC  9(5) VALUE ZEROS.     01380000
014000                                                                  01390000
014100     05  PA-SUB                        PIC S9(4) VALUE ZEROS.     01400000
014200                                                                  01410000
014300                                                                  01420000
014400******************************************************************01430000
014500*                      CONTROL CARD                               01440000
014600******************************************************************01450000
014700 01  CC-CONTROL-CARD.                                             01460000
014800     05  CC-DB2-CTLCD-DATE-ISO.                                   01470000
014900         10  CC-DB2-REPORT-CC          PIC X(02).                 01480000
015000         10  CC-DB2-REPORT-YY          PIC X(02).                 01490000
015100         10  FILLER                    PIC X(01).                 01500000
015200         10  CC-DB2-REPORT-MM          PIC X(02).                 01510000
015300         10  FILLER                    PIC X(01).                 01520000
015400         10  CC-DB2-REPORT-DD          PIC X(02).                 01530000
030400     05  FILLER                        PIC X.                     01540000
WEEK53     05  CC-53-WEEK-IND                PIC XX.                    01541000
030400     05  FILLER                        PIC X(67).                 01542000
015600                                                                  01543000
015700                                                                  01544000
015800******************************************************************01545000
015900*                INPUT EXTRACT RECORD                             01546000
016000******************************************************************01547000
016100 01  WS-INPUT-RECORD.                                             01548000
018420     05  WS-IN-REC-CODE             PIC X(2)      VALUE SPACES.   01549000
018430**       00 = TERR RECORD                                         01550003
018440**       02 = REGN RECORD                                         01560003
018440**       03 = DIST RECORD                                         01561003
018450**       04 = STORE RECORD                                        01570000
018450**       05 = ECOM RECORD                                         01580000
018460**       06 = COMPANY RECORD                                      01590000
018480     05  WS-IN-TERR                 PIC 9(4)      VALUE ZEROES.   01591003
018480     05  WS-IN-TERR-MGR-NM          PIC X(32)     VALUE SPACES.   01592026
018470     05  WS-IN-REGN                 PIC 9(4)      VALUE ZEROES.   01600004
018470     05  WS-IN-REGN-MGR-NM          PIC X(32)     VALUE SPACES.   01610026
018480     05  WS-IN-DIST                 PIC 9(4)      VALUE ZEROES.   01611003
018480     05  WS-IN-DIST-MGR-NM          PIC X(32)     VALUE SPACES.   01612026
018490     05  WS-IN-STORE                PIC 9(4)      VALUE ZEROES.   01620000
018491     05  WS-IN-SORT-KEY.                                          01630000
018502**       THE SORT FIELDS WILL REFLECT THIS YEAR'S TOTAL SALES.    01640000
018503         10  WS-IN-SORT-TERR-SALES        PIC S9(13)V99 COMP-3    01650003
018504                                                  VALUE 0.        01660000
018505         10  WS-IN-SORT-REGN-SALES        PIC S9(13)V99 COMP-3    01670003
018506                                                  VALUE 0.        01680000
018505         10  WS-IN-SORT-DIST-SALES        PIC S9(13)V99 COMP-3    01681003
018506                                                  VALUE 0.        01682003
018507         10  WS-IN-SORT-STORE-SALES       PIC S9(13)V99 COMP-3    01690000
018508                                                  VALUE 0.        01700000
018509     05  WS-IN-TY-DAILY-SALES       PIC S9(11)V99 COMP-3 VALUE 0. 01710000
018510     05  WS-IN-TY-MTD-SALES         PIC S9(11)V99 COMP-3 VALUE 0. 01720000
018511     05  WS-IN-TY-YTD-SALES         PIC S9(13)V99 COMP-3 VALUE 0. 01730000
018512     05  WS-IN-TY-COMP-DLY-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01740000
018513     05  WS-IN-TY-COMP-MTD-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01750000
018514     05  WS-IN-TY-COMP-YTD-SALES    PIC S9(13)V99 COMP-3 VALUE 0. 01760000
018515     05  WS-IN-LY-DAILY-SALES       PIC S9(11)V99 COMP-3 VALUE 0. 01770000
018516     05  WS-IN-LY-MTD-SALES         PIC S9(11)V99 COMP-3 VALUE 0. 01780000
018517     05  WS-IN-LY-YTD-SALES         PIC S9(13)V99 COMP-3 VALUE 0. 01790000
018518     05  WS-IN-LY-COMP-DLY-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01800000
018519     05  WS-IN-LY-COMP-MTD-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 01810000
018520     05  WS-IN-LY-COMP-YTD-SALES    PIC S9(13)V99 COMP-3 VALUE 0. 01820000
018521     05  WS-IN-LY-TOTAL-SALES       PIC S9(13)V99 COMP-3 VALUE 0. 01830000
018523     05  WS-IN-STORE-NAME           PIC X(10)     VALUE SPACES.   01850000
WEEK53     05  WS-IN-DURING-WEEK-53       PIC X         VALUE SPACES.   01852200
WEEK53**       Y = RUN DATE IS DURING WEEK 53                           01852300
WEEK53     05  WS-IN-LY-SAME-FISCAL-DATE  PIC X(10)     VALUE SPACES.   01852400
018550                                                                  01852600
018600                                                                  01852700
018700******************************************************************01852800
018800*               SYSTEM TIME AND DATE VARIABLES                    01852903
018900******************************************************************01853000
019000 01  SYS-DATE-TIME.                                               01854000
019100     05  SYS-DATE                      PIC X(08)  VALUE SPACES.   01855000
019200     05  SYS-TIME                      PIC X(08)  VALUE SPACES.   01856000
019300                                                                  01857000
019400 01  ST-BEG-TIME.                                                 01858000
019500     05  ST-BEG-HR                     PIC 9(02)  VALUE ZEROS.    01859000
019600     05  FILLER                        PIC X(01)  VALUE ':'.      01860000
019700     05  ST-BEG-MN                     PIC 9(02)  VALUE ZEROS.    01870000
019800     05  FILLER                        PIC X(01)  VALUE ':'.      01880000
019900     05  ST-BEG-SS                     PIC 9(02)  VALUE ZEROS.    01890000
020000                                                                  01900000
020100 01  ST-END-TIME.                                                 01910000
020200     05  ST-END-HR                     PIC 9(02)  VALUE ZEROS.    01920000
020300     05  FILLER                        PIC X(01)  VALUE ':'.      01930000
020400     05  ST-END-MN                     PIC 9(02)  VALUE ZEROS.    01940000
020500     05  FILLER                        PIC X(01)  VALUE ':'.      01950000
020600     05  ST-END-SS                     PIC 9(02)  VALUE ZEROS.    01960000
020700                                                                  01970000
020800 01  SD-EDIT-DATE.                                                01980000
020900     05  SD-MONTH                      PIC 9(02)  VALUE ZEROS.    01990000
021000     05  FILLER                        PIC X(01)  VALUE '-'.      02000000
021100     05  SD-DAY                        PIC 9(02)  VALUE ZEROS.    02010000
021200     05  FILLER                        PIC X(01)  VALUE '-'.      02020000
021300     05  SD-CENT                       PIC 9(02)  VALUE ZEROS.    02030000
021400     05  SD-YEAR                       PIC 9(02)  VALUE ZEROS.    02040000
021500                                                                  02050000
021600******************************************************************02060000
021700*                        ERROR HANDLING                           02070000
021800******************************************************************02080000
021900 01  ABEND-CODE                        PIC S9(04) VALUE ZEROS     02090000
022000                                                  COMP SYNC.      02100000
022100     88  ABEND-3333-INVALID-CTLCD-DATE            VALUE +3333.    02110000
022200     88  ABEND-4444-FORCED-ABEND                  VALUE +4444.    02120000
022300                                                                  02130000
022301                                                                  02140000
022310******************************************************************02150000
022320* PARAMETER LIST FOR THE CALENDAR ROUTINE                         02160000
022330******************************************************************02170000
022340     COPY DPWS500.                                                02180000
022350                                                                  02190000
022400                                                                  02200000
022500* THIS REPORT WILL BE 212 CHARACTERS WIDE, BUT THE STANDARD       02210000
022600* 200 COLUMN COPYBOOK WILL BE USED.                               02220000
022700******************************************************************02230000
022800* KOHLS STANDARD HEADING ROUTINE FOR A 200 COLUMN REPORT          02240000
022900******************************************************************02250000
023000     COPY DPWS200O.                                               02260000
023100*                                                                 02270000
026600                                                                  02280000
026700                                                                  02290000
026800******************************************************************02300000
026900* REPORT HEADINGS                                                 02310000
027000******************************************************************02320000
027100 01  HL-HDR1.                                                     02330000
027200     05  FILLER                  PIC  X(72) VALUE SPACES.         02340000
027300     05                          PIC  X(50) VALUE                 02350003
027400        'STORE MANAGEMENT SALES SUMMARY REPORT FOR DATE  '.       02360001
027500     05  HL-REPORT-MONTH         PIC  X(02) VALUE SPACES.         02370000
027600     05  FILLER                  PIC  X(01) VALUE '/'.            02380000
027700     05  HL-REPORT-DAY           PIC  X(02) VALUE SPACES.         02390000
027800     05  FILLER                  PIC  X(01) VALUE '/'.            02400000
027900     05  HL-REPORT-CENTURY       PIC  X(02) VALUE SPACES.         02410000
028000     05  HL-REPORT-YEAR          PIC  X(02) VALUE SPACES.         02420000
028100     05  FILLER                  PIC  X     VALUE SPACES.         02430000
028000     05  HL-CALENDAR-LITERAL     PIC  X(40) VALUE SPACES.         02440000
028000**       (COMPARE BY CALENDAR WEEK)                               02450000
028100     05  FILLER                  PIC  X(43) VALUE SPACES.         02460044
028200                                                                  02470000
028300 01  HL-HDR2.                                                     02480000
028400     05  FILLER                  PIC  X(40) VALUE                 02490042
028500         'TERR REGN DIST           TY $          '.               02500001
028510     05  FILLER                  PIC  X(33) VALUE                 02510051
028520         '   MTD $               YTD $     '.                     02520051
028600     05  FILLER                  PIC  X(39) VALUE                 02530047
028700         'TERR REGN DIST            TY $         '.               02540047
028701     05  FILLER                  PIC  X(31) VALUE                 02550052
028702         '  MTD $               YTD $    '.                       02560052
028800     05  FILLER                  PIC  X(40) VALUE                 02570044
028900         'TERR REGN DIST           TY $          '.               02580001
028910     05  FILLER                  PIC  X(28) VALUE                 02590045
028920         '  MTD $                YTD $'.                          02600053
029000                                                                  02610000
029100                                                                  02620000
029200 01  HL-HDR3.                                                     02630000
029300     05  FILLER                  PIC  X(40) VALUE                 02640042
030200         '     LY $  STORE NAME    (000)   TY %   '.              02650042
029500     05  FILLER                  PIC  X(33) VALUE                 02660050
029600         '  (000)  MTD %  YTD % (MIL)      '.                     02670046
029700     05  FILLER                  PIC  X(39) VALUE                 02680048
030200         '     LY $  STORE NAME   (000)   TY %   '.               02690000
029900     05  FILLER                  PIC  X(33) VALUE                 02700050
030000         '  (000)  MTD %  YTD % (MIL)     '.                      02710046
030100     05  FILLER                  PIC  X(39) VALUE                 02720048
030200         '   LY $  STORE NAME   (000)   TY %     '.               02730052
030300     05  FILLER                  PIC  X(27) VALUE                 02740053
030400         ' (000)  MTD %  YTD % (MIL) '.                           02750053
030500                                                                  02760000
030600                                                                  02770000
030700******************************************************************02780000
030800* DETAIL LINES                                                    02790000
030900******************************************************************02800000
031000 01  DL-DETAIL-LINE-TABLE.                                        02810000
031100***    THERE IS ROOM FOR 100 PRINT LINES ON A PAGE INCLUDING      02820000
031200***    4 HEADER LINES AND THE CONFIDENTIALITY LINE.               02830000
031300   03  DL-DETAIL-LINE OCCURS 95 TIMES.                            02840000
031400     05  DL-DETAIL-LINE-COLUMN-1.                                 02850000
031500***      REPORT COLUMN 1                                          02860000
031600       07  DL1-DESCRIPTION         PIC  X(22)    VALUE SPACES.    02870026
031700       07  DL1-TERR-DESC REDEFINES DL1-DESCRIPTION.               02880001
031800           10  DL1-TERR-NM         PIC  X(17).                    02891082
031800           10  FILLER              PIC  X.                        02892082
031800           10  F-COMP              PIC  X(4).                     02893082
032000       07  DL1-REGN-DESC REDEFINES DL1-DESCRIPTION.               02920001
032200           10  DL1-REGN-NM         PIC  X(17).                    02951082
031800           10  FILLER              PIC  X.                        02952082
031800           10  F-COMP1             PIC  X(4).                     02953084
032300       07  DL1-DIST-DESC REDEFINES DL1-DESCRIPTION.               02970001
032200           10  DL1-DIST-NM         PIC  X(17).                    02982082
031800           10  FILLER              PIC  X.                        02983082
031800           10  F-COMP2             PIC  X(4).                     02984084
032300       07  DL1-STORE-DESC REDEFINES DL1-DESCRIPTION.              03041001
032400           10  FILLER                PIC  X(4).                   03042001
032500           10  DL1-LY-TOTAL-SALES-X  PIC  X(5).                   03043001
032600           10  DL1-LY-TOTAL-SALES REDEFINES DL1-LY-TOTAL-SALES-X  03044001
032700                                   PIC  ZZ9.9.                    03045001
032710           10  FILLER              PIC  XX.                       03046001
032720           10  DL1-STORE-NAME      PIC  X(10).                    03047001
032730           10  FILLER              PIC  X.                        03048028
032800       07  DL1-TY-DAILY-SALES-X    PIC  X(8)     VALUE SPACES.    03050000
032900       07  DL1-TY-DAILY-SALES REDEFINES DL1-TY-DAILY-SALES-X      03060000
033000                                   PIC  ----,--9.                 03070000
033600       07  DL1-TY-LY-PCT-NA        PIC  X(7)     VALUE SPACES.    03080000
033700       07  DL1-TY-LY-PCT-CHANGE REDEFINES DL1-TY-LY-PCT-NA        03090000
033800                                   PIC  ----9.9.                  03100000
034000       07  DL1-MTD-SALES-X         PIC  X(10)    VALUE SPACES.    03120000
034100       07  DL1-MTD-SALES REDEFINES DL1-MTD-SALES-X                03130000
034200                                   PIC  --,---,--9.               03140000
034400       07  DL1-MTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03150000
034500       07  DL1-MTD-PCT-CHANGE   REDEFINES DL1-MTD-PCT-NA          03160000
034600                                   PIC  ----9.9.                  03170000
034800       07  DL1-YTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03180000
034900       07  DL1-YTD-PCT-CHANGE   REDEFINES DL1-YTD-PCT-NA          03190000
035000                                   PIC  ----9.9.                  03200000
035010       07  FILLER                  PIC  X        VALUE SPACES.    03210000
035020       07  DL1-TY-TOTAL-SALES-X    PIC  X(5)     VALUE SPACES.    03220000
035030       07  DL1-TY-TOTAL-SALES REDEFINES DL1-TY-TOTAL-SALES-X      03230000
035040                                   PIC  ZZ9.9.                    03240000
035100       07  FILLER                  PIC  X(5)     VALUE SPACES.    03250043
035200                                                                  03260000
035300     05  DL-DETAIL-LINE-COLUMN-2.                                 03270000
035400***      REPORT COLUMN 2                                          03280000
031600       07  DL2-DESCRIPTION         PIC  X(22)    VALUE SPACES.    03281026
031700       07  DL2-TERR-DESC REDEFINES DL2-DESCRIPTION.               03282029
031800           10  DL2-TERR-NM         PIC  X(17).                    03284085
031800           10  FILLER              PIC  X.                        03284185
031800           10  F2-COMP             PIC  X(4).                     03284285
032000       07  DL2-REGN-DESC REDEFINES DL2-DESCRIPTION.               03285029
032200           10  DL2-REGN-NM         PIC  X(17).                    03287085
031800           10  FILLER              PIC  X.                        03287185
031800           10  F2-COMP1            PIC  X(4).                     03287285
032300       07  DL2-DIST-DESC REDEFINES DL2-DESCRIPTION.               03288029
032200           10  DL2-DIST            PIC  X(2).                     03289026
032200           10  DL2-DIST-NM         PIC  X(15).                    03289185
031800           10  FILLER              PIC  X.                        03289285
031800           10  F2-COMP2            PIC  X(4).                     03289385
036130       07  DL2-STORE-DESC REDEFINES DL2-DESCRIPTION.              03380000
036140           10  FILLER                PIC  X(4).                   03390000
036150           10  DL2-LY-TOTAL-SALES-X  PIC  X(5).                   03400000
036160           10  DL2-LY-TOTAL-SALES REDEFINES DL2-LY-TOTAL-SALES-X  03410000
036170                                   PIC  ZZ9.9.                    03420000
036180           10  FILLER              PIC  XX.                       03430000
036190           10  DL2-STORE-NAME      PIC  X(10).                    03440000
036180           10  FILLER              PIC  X(1).                     03441028
036700       07  DL2-TY-DAILY-SALES-X    PIC  X(8)     VALUE SPACES.    03450000
036800       07  DL2-TY-DAILY-SALES REDEFINES DL2-TY-DAILY-SALES-X      03460000
036900                                   PIC  ----,--9.                 03470000
037500       07  DL2-TY-LY-PCT-NA        PIC  X(7)     VALUE SPACES.    03480000
037600       07  DL2-TY-LY-PCT-CHANGE REDEFINES DL2-TY-LY-PCT-NA        03490000
037700                                   PIC  ----9.9.                  03500000
037900       07  DL2-MTD-SALES-X         PIC  X(10)    VALUE SPACES.    03510000
038000       07  DL2-MTD-SALES REDEFINES DL2-MTD-SALES-X                03520000
038100                                   PIC  --,---,--9.               03530000
038300       07  DL2-MTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03540000
038400       07  DL2-MTD-PCT-CHANGE   REDEFINES DL2-MTD-PCT-NA          03550000
038500                                   PIC  ----9.9.                  03560000
038700       07  DL2-YTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03570000
038800       07  DL2-YTD-PCT-CHANGE   REDEFINES DL2-YTD-PCT-NA          03580000
038900                                   PIC  ----9.9.                  03590000
038910       07  FILLER                  PIC  X        VALUE SPACES.    03600000
038920       07  DL2-TY-TOTAL-SALES-X    PIC  X(5)     VALUE SPACES.    03610000
038930       07  DL2-TY-TOTAL-SALES REDEFINES DL2-TY-TOTAL-SALES-X      03620000
038940                                   PIC  ZZ9.9.                    03630000
039000       07  FILLER                  PIC  X(4)     VALUE SPACES.    03640042
039100     05  DL-DETAIL-LINE-COLUMN-3.                                 03650000
039200***      REPORT COLUMN 3                                          03660000
031600       07  DL3-DESCRIPTION         PIC  X(22)    VALUE SPACES.    03661026
031700       07  DL3-TERR-DESC REDEFINES DL3-DESCRIPTION.               03662029
031800           10  DL3-TERR-NM         PIC  X(17).                    03664085
031800           10  FILLER              PIC  X.                        03664185
031800           10  F3-COMP             PIC  X(4).                     03664285
032000       07  DL3-REGN-DESC REDEFINES DL3-DESCRIPTION.               03665029
032200           10  DL3-REGN-NM         PIC  X(17).                    03667085
031800           10  FILLER              PIC  X.                        03667185
031800           10  F3-COMP1            PIC  X(4).                     03667285
032300       07  DL3-DIST-DESC REDEFINES DL3-DESCRIPTION.               03668029
032200           10  DL3-DIST            PIC  X(2).                     03669026
032200           10  DL3-DIST-NM         PIC  X(15).                    03669185
031800           10  FILLER              PIC  X.                        03669285
031800           10  F3-COMP2            PIC  X(4).                     03669385
039930       07  DL3-STORE-DESC REDEFINES DL3-DESCRIPTION.              03760000
039940           10  FILLER                PIC  X(4).                   03770000
039950           10  DL3-LY-TOTAL-SALES-X  PIC  X(5).                   03780000
039960           10  DL3-LY-TOTAL-SALES REDEFINES DL3-LY-TOTAL-SALES-X  03790000
039970                                   PIC  ZZ9.9.                    03800000
039980           10  FILLER              PIC  XX.                       03810000
039990           10  DL3-STORE-NAME      PIC  X(10).                    03820000
036180           10  FILLER              PIC  X(1).                     03821028
040500       07  DL3-TY-DAILY-SALES-X    PIC  X(8)     VALUE SPACES.    03830000
040600       07  DL3-TY-DAILY-SALES REDEFINES DL3-TY-DAILY-SALES-X      03840000
040700                                   PIC  ----,--9.                 03850000
041610       07  DL3-TY-LY-PCT-NA        PIC  X(7)     VALUE SPACES.    03860000
041620       07  DL3-TY-LY-PCT-CHANGE REDEFINES DL3-TY-LY-PCT-NA        03870000
041630                                   PIC  ----9.9.                  03880000
041700       07  DL3-MTD-SALES-X         PIC  X(10)    VALUE SPACES.    03890000
041800       07  DL3-MTD-SALES REDEFINES DL3-MTD-SALES-X                03900000
041900                                   PIC  --,---,--9.               03910000
042100       07  DL3-MTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03920000
042200       07  DL3-MTD-PCT-CHANGE   REDEFINES DL3-MTD-PCT-NA          03930000
042300                                   PIC  ----9.9.                  03940000
042500       07  DL3-YTD-PCT-NA          PIC  X(7)     VALUE SPACES.    03950000
042600       07  DL3-YTD-PCT-CHANGE   REDEFINES DL3-YTD-PCT-NA          03960000
042700                                   PIC  ----9.9.                  03970000
042710       07  FILLER                  PIC  X        VALUE SPACES.    03980000
042720       07  DL3-TY-TOTAL-SALES-X    PIC  X(5)     VALUE SPACES.    03990000
042730       07  DL3-TY-TOTAL-SALES REDEFINES DL3-TY-TOTAL-SALES-X      04000000
042740                                   PIC  ZZ9.9.                    04010000
042900                                                                  04030000
043000 PROCEDURE DIVISION.                                              04040000
043100******************************************************************04050000
043200* MAIN DRIVER                                                     04060000
043300******************************************************************04070000
043400                                                                  04080000
043500     PERFORM 1000-INITIALIZE.                                     04090000
043600                                                                  04100000
043700     PERFORM 2000-LOAD-INPUT-TO-PRINT-PAGE                        04110000
043800         UNTIL PS-END-OF-INPUT-FILE.                              04120000
043900                                                                  04130000
044000     PERFORM 9000-END-OF-JOB.                                     04140000
044100                                                                  04150000
044200     STOP RUN.                                                    04160000
044300                                                                  04170000
044400                                                                  04180000
044500******************************************************************04190000
044600* PERFORMS TASK INITIATION PROCESSING                             04200000
044700******************************************************************04210000
044800 1000-INITIALIZE.                                                 04220000
044900                                                                  04230000
045000     OPEN INPUT  CTLCD-DATE-FILE                                  04240000
045100                 INPUT-EXTRACT-FILE                               04250000
045200          OUTPUT REPORT-FILE.                                     04260000
045300                                                                  04270000
045400     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04280000
045500                                                                  04290000
045600     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            04300000
045700     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            04310000
045800                                                                  04320000
045900     MOVE SYS-DATE (1:2) TO SD-CENT.                              04330000
046000     MOVE SYS-DATE (3:2) TO SD-YEAR.                              04340000
046100     MOVE SYS-DATE (5:2) TO SD-MONTH.                             04350000
046200     MOVE SYS-DATE (7:2) TO SD-DAY.                               04360000
046300                                                                  04370000
046400     PERFORM 1100-READ-CTLCD.                                     04380000
046410     PERFORM 1200-EDIT-DATE.                                      04390000
046500     PERFORM 1300-FORMAT-HEADINGS.                                04400000
046600                                                                  04410000
046700                                                                  04420000
046800******************************************************************04430000
046900* READ THE DATE FILE INTO THE CONTROL CARD                        04440000
047000******************************************************************04450000
047100 1100-READ-CTLCD.                                                 04460000
047200                                                                  04470000
047300     READ CTLCD-DATE-FILE INTO CC-CONTROL-CARD                    04480000
047400         AT END SET PS-END-OF-CTLCD-FILE TO TRUE.                 04490000
047500                                                                  04500000
047600     IF  PS-END-OF-CTLCD-FILE                                     04510000
047700         SET ABEND-3333-INVALID-CTLCD-DATE     TO TRUE            04520000
047800         DISPLAY 'PARA NAME = 1100-READ-CTLCD'                    04530000
047900         DISPLAY 'INPUT CTLCD DATE FILE IS EMPTY'                 04540000
048000         PERFORM 8000-ABEND                                       04550000
048100     END-IF.                                                      04560000
048200                                                                  04570000
048210                                                                  04580000
048220******************************************************************04590000
048230* EDIT THE DB2 DATE TO MAKE SURE THAT IT IS VALID.                04600000
048240******************************************************************04610000
048250 1200-EDIT-DATE.                                                  04620000
048260                                                                  04630000
048270     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04640000
048280                                                                  04650000
048291     SET DPG51-FISCAL-454-CALENDAR     TO TRUE.                   04660000
048292     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   04670000
048293     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   04680000
048294                                                                  04690000
048295     MOVE CC-DB2-CTLCD-DATE-ISO        TO DPG52-LK-DATE-INPUT.    04700000
048296                                                                  04710000
048297     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    04720000
048298                                             DPG54 DPG55 DPG56.   04730000
048299                                                                  04740000
048300     EVALUATE TRUE                                                04750000
048301        WHEN DPG54-NO-ERROR                                       04760000
048303           MOVE CC-DB2-CTLCD-DATE-ISO TO PV-RUN-DATE-CCYY-MM-DD   04770000
048308           DISPLAY 'DPG56-FISCAL-YEAR-CCYY = '                    04780000
048309                    DPG56-FISCAL-YEAR-CCYY                        04790000
048313                                                                  04800000
048314        WHEN DPG54-SEVERE-ERROR                                   04810000
048315        WHEN DPG54-DATE-INVALID                                   04820000
048316           SET ABEND-3333-INVALID-CTLCD-DATE     TO TRUE          04830000
048317           DISPLAY 'PARA NAME = 1200-EDIT-DATE - CALL DPKUT500'   04831000
048318           DISPLAY 'INPUT CTLCD DATE  ' CC-DB2-CTLCD-DATE-ISO     04831100
048319                   '  IS INVALID'                                 04831200
048320           DISPLAY 'CALENDAR MODULE ERROR IND = ' DPG54-ERROR-IND 04831300
048321           PERFORM 8000-ABEND                                     04831400
048322     END-EVALUATE.                                                04831500
048323                                                                  04831600
048324                                                                  04831700
048330                                                                  04831800
048400******************************************************************04831900
048500* FORMAT THE HEADINGS FOR THE REPORT                              04832000
048600******************************************************************04833000
048700 1300-FORMAT-HEADINGS.                                            04834000
048800                                                                  04835000
048900     MOVE PC-PROGRAM-NAME TO DP200O-PROGRAM-NAME.                 04836000
049000     MOVE '1'             TO DP200O-REPORT-NUMBER.                04837000
049100                                                                  04838000
049200     MOVE SD-YEAR   TO DP200O-RUN-YEAR.                           04839000
049300     MOVE SD-MONTH  TO DP200O-RUN-MONTH.                          04840000
049400     MOVE SD-DAY    TO DP200O-RUN-DAY.                            04850000
049500                                                                  04860000
049600     MOVE ST-BEG-HR TO DP200O-RUN-HOUR.                           04870000
049700     MOVE ST-BEG-MN TO DP200O-RUN-MINUTE.                         04880000
049800                                                                  04890000
049900     MOVE CC-DB2-REPORT-MM TO HL-REPORT-MONTH.                    04900000
050000     MOVE CC-DB2-REPORT-DD TO HL-REPORT-DAY.                      04910000
050100     MOVE CC-DB2-REPORT-CC TO HL-REPORT-CENTURY.                  04920000
050200     MOVE CC-DB2-REPORT-YY TO HL-REPORT-YEAR.                     04930000
050300                                                                  04940000
050310     SUBTRACT 1 FROM  DPG56-FISCAL-YEAR-CCYY.                     04950000
050400                                                                  04960000
050500******************************************************************04970000
050600* THIS PARAGRAPH WILL CONTROL THE LOADING OF THE HEADERS AND INPUT04980000
050700* DATA INTO THE PAGE LAYOUT (212 CHARACTERS X 100 LINES).         04990000
050800* SINCE THE DATA WILL BE FILLED 1 COLUMN AT A TIME, ALL DATA MUST 05000000
050900* BE LOADED ONTO THE PAGE BEFORE IT CAN BE WRITTEN (COLUMNS 2 AND 05010000
051000* 3 MAY OR MAY NOT CONTAIN DATA ON ANY GIVEN LINE).               05020000
051100* THERE WILL BE 4 HEADERS AT THE TOP OF THE PAGE, INCLUDING THE   05030000
051200* STANDARD KOHLS HEADER AT THE TOP.                               05040000
051300* 95 DETAIL LINES WILL FOLLOW, EACH WITH UP TO 3 SETS OF DATA.    05050000
051400* THE LAST LINE WILL BE THE KOHLS CONFIDENTIALITY LINE.           05060000
051500******************************************************************05070000
051600 2000-LOAD-INPUT-TO-PRINT-PAGE.                                   05080000
051700                                                                  05090000
051800     PERFORM 2100-READ-INPUT-FILE.                                05100000
051900                                                                  05110000
052000     IF NOT PS-END-OF-INPUT-FILE                                  05120000
052001**       IF THERE IS ONLY 1 PRINT LINE LEFT AT THE BOTTOM OF A    05130000
052002**       COLUMN AND THERE IS A TERR OR REGN RECORD TO BE          05140003
052003**       PRINTED, ADD 1 TO PV-DATA-COUNT TO FORCE THE TERR AND    05150003
052004**       REGN LINES TO THE TOP OF THE NEXT COLUMN SO THAT THEIR   05160003
052005**       'ALL' AND 'COMP' VALUES ARE PRINTED TOGETHER.            05170000
052100         IF PV-DATA-COUNT > 285                                   05187058
052200**           WRITE FULL PAGE (285 = 3 COLUMNS OF 95)              05190000
052300             PERFORM 3000-WRITE-PAGE                              05200000
052400         END-IF                                                   05210000
052510         IF PV-DATA-COUNT < 96                                    05220000
052600             MOVE PV-DATA-COUNT   TO PV-PAGE-LINE                 05230000
052700             PERFORM 2500-LOAD-COLUMN-1                           05240000
052800         ELSE                                                     05250000
052900             IF PV-DATA-COUNT < 191                               05260000
053000                 COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 95        05270000
053100                 PERFORM 2600-LOAD-COLUMN-2                       05280000
053200             ELSE                                                 05290000
                       COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 190       05300002
053400                 PERFORM 2700-LOAD-COLUMN-3                       05310000
053500             END-IF                                               05321037
053600         END-IF                                                   05330000
053700     ELSE                                                         05340000
053800         IF PV-DATA-COUNT > 0                                     05350000
053900**           WRITE PARTIAL LAST PAGE                              05360000
054000             PERFORM 3000-WRITE-PAGE                              05370000
054100         END-IF                                                   05380000
054200     END-IF.                                                      05390000
054300                                                                  05400000
052000     IF NOT PS-END-OF-INPUT-FILE                                  05401068
064884       IF PS-EMPTY-LINE AND PS-COLUMN-SW = '1'                    05410068
075900         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05413169
076000         ADD +1        TO PV-PAGE-LINE                            05414072
076100         ADD +1        TO PV-DATA-COUNT                           05415072
052100         IF PV-DATA-COUNT > 285                                   05416068
052200**           WRITE FULL PAGE (285 = 3 COLUMNS OF 95)              05417068
052300             PERFORM 3000-WRITE-PAGE                              05418068
052400         END-IF                                                   05419068
052510         IF PV-DATA-COUNT < 96                                    05419168
052600             MOVE PV-DATA-COUNT   TO PV-PAGE-LINE                 05419268
052700             PERFORM 2500-LOAD-COLUMN-1                           05419368
052800         ELSE                                                     05419468
052900             IF PV-DATA-COUNT < 191                               05419568
053000                 COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 95        05419668
053100                 PERFORM 2600-LOAD-COLUMN-2                       05419768
053200             ELSE                                                 05419868
                       COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 190       05419968
053400                 PERFORM 2700-LOAD-COLUMN-3                       05420068
053500             END-IF                                               05420168
053600         END-IF                                                   05420268
               SET PS-DONT-EMPTY-LINE TO TRUE                           05420368
053600       ELSE                                                       05420468
064884       IF PS-EMPTY-LINE AND PS-COLUMN-SW = '2'                    05420568
075900         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-2 (PV-PAGE-LINE)  05420970
076000         ADD +1        TO PV-PAGE-LINE                            05421068
076100         ADD +1        TO PV-DATA-COUNT                           05421168
052100         IF PV-DATA-COUNT > 285                                   05421268
052200**           WRITE FULL PAGE (285 = 3 COLUMNS OF 95)              05421368
052300             PERFORM 3000-WRITE-PAGE                              05421468
052400         END-IF                                                   05421568
052510         IF PV-DATA-COUNT < 96                                    05421668
052600             MOVE PV-DATA-COUNT   TO PV-PAGE-LINE                 05421768
052700             PERFORM 2500-LOAD-COLUMN-1                           05421868
052800         ELSE                                                     05421968
052900             IF PV-DATA-COUNT < 191                               05422068
053000                 COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 95        05422168
053100                 PERFORM 2600-LOAD-COLUMN-2                       05422268
053200             ELSE                                                 05422368
                       COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 190       05422468
053400                 PERFORM 2700-LOAD-COLUMN-3                       05422568
053500             END-IF                                               05422668
053600         END-IF                                                   05422768
               SET PS-DONT-EMPTY-LINE TO TRUE                           05422868
             ELSE                                                       05422968
064884       IF PS-EMPTY-LINE AND PS-COLUMN-SW = '3'                    05423068
075900         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  05423170
076000         ADD +1        TO PV-PAGE-LINE                            05423568
076100         ADD +1        TO PV-DATA-COUNT                           05423668
052100         IF PV-DATA-COUNT > 285                                   05423768
052200**           WRITE FULL PAGE (285 = 3 COLUMNS OF 95)              05423868
052300             PERFORM 3000-WRITE-PAGE                              05423968
052400         END-IF                                                   05424068
052510         IF PV-DATA-COUNT < 96                                    05424168
052600             MOVE PV-DATA-COUNT   TO PV-PAGE-LINE                 05424268
052700             PERFORM 2500-LOAD-COLUMN-1                           05424368
052800         ELSE                                                     05424468
052900             IF PV-DATA-COUNT < 191                               05424568
053000                 COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 95        05424668
053100                 PERFORM 2600-LOAD-COLUMN-2                       05424768
053200             ELSE                                                 05424868
                       COMPUTE PV-PAGE-LINE = PV-DATA-COUNT - 190       05424968
053400                 PERFORM 2700-LOAD-COLUMN-3                       05425068
053500             END-IF                                               05425168
053600         END-IF                                                   05425268
               SET PS-DONT-EMPTY-LINE TO TRUE                           05425368
053600       END-IF                                                     05425468
053600     END-IF                                                       05425568
053600     END-IF                                                       05425668
053600     END-IF.                                                      05425768
053600                                                                  05425868
054500******************************************************************05426000
054600* READ THE INPUT FILE                                             05430000
054700******************************************************************05440000
054800 2100-READ-INPUT-FILE.                                            05450000
054900                                                                  05460000
055000     READ INPUT-EXTRACT-FILE   INTO WS-INPUT-RECORD               05470000
055100         AT END SET PS-END-OF-INPUT-FILE TO TRUE.                 05480000
055200                                                                  05490000
055300     IF  NOT PS-END-OF-INPUT-FILE                                 05500000
055400         ADD +1          TO PA-INPUT-READ                         05510000
055500                            PV-DATA-COUNT                         05520000
056600         IF WS-IN-REC-CODE = '00' AND                             05521037
051700            WS-IN-TERR NOT EQUAL WS-SAVE-TERR                     05522040
052300                PERFORM 3000-WRITE-PAGE                           05523037
051900                MOVE WS-IN-TERR TO WS-SAVE-TERR                   05523137
051900                MOVE WS-IN-TERR-MGR-NM TO PV-SAVE-TERR-NM         05523295
051900         END-IF                                                   05524037
055600     END-IF.                                                      05530000
055700                                                                  05540000
055800                                                                  05550000
055900******************************************************************05560000
056000* LOAD DATA TO THE FIRST COLUMN ON THE PAGE.                      05570000
056100* CHECK IF A CONTINUATION LINE FROM THE PREVIOUS PAGE IS REQUIRED.05580000
056200******************************************************************05590000
056300 2500-LOAD-COLUMN-1.                                              05600000
056400                                                                  05610000
056500     IF PV-PAGE-COUNT > 1 AND PV-PAGE-LINE = 1 AND                05620098
056600        WS-IN-REC-CODE NOT = '00'                                 05621098
             IF PV-DATA-COUNT = 1                                       05630089
075600          STRING  PV-SAVE-TERR-NM                                 05631093
075800                   DELIMITED BY SIZE                              05632083
075900                     INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05633096
058860          MOVE 'CONT'             TO F-COMP (PV-PAGE-LINE)        05633197
076000          MOVE 3        TO PV-PAGE-LINE                           05633492
076100          ADD +2        TO PV-DATA-COUNT                          05633599
075600          STRING  PV-SAVE-REGN-NM                                 05633694
075800                   DELIMITED BY SIZE                              05633792
075900                     INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05633896
058860          MOVE 'CONT'   TO F-COMP (PV-PAGE-LINE)                  05633997
076000          MOVE 5        TO PV-PAGE-LINE                           05638192
076100          ADD +2        TO PV-DATA-COUNT                          05638299
075600          STRING  PV-SAVE-DIST-NM                                 05639094
075800                 DELIMITED BY SIZE                                05639192
075900                     INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05639296
058860          MOVE 'CONT'   TO F-COMP (PV-PAGE-LINE)                  05639397
076100          ADD +1        TO PV-DATA-COUNT                          05639499
076000          MOVE 6        TO PV-PAGE-LINE                           05639599
             ELSE                                                       05670092
075400           IF WS-IN-REC-CODE = '03'                               05691022
075500**           REGN CONTINUATION LINE IS REQUIRED                   05692025
075600                 STRING  WS-IN-REGN-MGR-NM ' CONT'                05693054
075800                   DELIMITED BY SIZE                              05694022
075900                     INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05695096
076000                 MOVE 2        TO PV-PAGE-LINE                    05696022
076100                 ADD +1        TO PV-DATA-COUNT                   05697022
075300           ELSE                                                   05698022
057400             IF WS-IN-REC-CODE = '04'                             05710000
057500**               DIST CONTINUATION LINE IS REQUIRED               05720022
075600                 STRING  WS-IN-DIST-MGR-NM ' CONT'                05721054
057800                   DELIMITED BY SIZE                              05750000
057900                     INTO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05760000
058000                 MOVE 2        TO PV-PAGE-LINE                    05770000
058100                 ADD +1        TO PV-DATA-COUNT                   05780000
058200             END-IF                                               05790000
058400           END-IF                                                 05810092
058400        END-IF                                                    05810192
058400     END-IF.                                                      05811092
058500                                                                  05820000
058600     IF WS-IN-REC-CODE = '00'                                     05830000
058820**       00 = TERR  - WRITE TERR  COMP LINE                       05840002
058850         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-1 (PV-PAGE-LINE)  05850000
058860         MOVE WS-IN-TERR-MGR-NM  TO DL1-TERR-NM (PV-PAGE-LINE)    05860026
058860                                    PV-SAVE-TERR-NM               05861093
058860         MOVE 'COMP'             TO F-COMP (PV-PAGE-LINE)         05870085
058880         PERFORM 2510-FORMAT-COL1-COMP-LINE                       05880000
058900     ELSE                                                         05890000
059000         IF WS-IN-REC-CODE = '02'                                 05900000
059010**           02 = REGN  - WRITE REGN COMP LINE                    05901002
                   SET PS-EMPTY-LINE TO TRUE                            05901255
                   MOVE '1' TO PS-COLUMN-SW                             05901360
059040             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-1(PV-PAGE-LINE) 05902000
032200             MOVE WS-IN-REGN-MGR-NM TO DL1-REGN-NM(PV-PAGE-LINE)  05908226
032200                                       PV-SAVE-REGN-NM            05908393
032200             MOVE 'COMP'            TO F-COMP1(PV-PAGE-LINE)      05908493
059092             PERFORM 2510-FORMAT-COL1-COMP-LINE                   05909000
059500         ELSE                                                     05910000
059000         IF WS-IN-REC-CODE = '03'                                 05911002
059010**           03 = DIST  - WRITE DIST COMP LINE                    05912002
                   SET PS-EMPTY-LINE TO TRUE                            05912255
                   MOVE '1' TO PS-COLUMN-SW                             05912360
059040             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-1(PV-PAGE-LINE) 05913002
032200             MOVE WS-IN-DIST-MGR-NM TO DL1-DIST-NM(PV-PAGE-LINE)  05917226
032200                                       PV-SAVE-DIST-NM            05917393
032200             MOVE 'COMP'            TO F-COMP2(PV-PAGE-LINE)      05917493
059092             PERFORM 2520-FORMAT-COL1-COMP-LINE                   05918002
059500         ELSE                                                     05919002
059510             IF WS-IN-REC-CODE = '04'                             05920000
059600**               04 = STORE - WRITE STORE ALL LINE                05930000
059800                 MOVE WS-IN-STORE-NAME                            05940000
059900                                  TO DL1-STORE-NAME(PV-PAGE-LINE) 05950000
059901                 PERFORM 2505-FORMAT-COL1-ALL-LINE                05960000
059910             ELSE                                                 05970000
059510                 IF WS-IN-REC-CODE = '05'                         05980000
059600**               05 = ECOM STORE - WRITE STORE ALL LINE           05991021
059800                     MOVE WS-IN-STORE-NAME                        05991121
059900                         TO DL1-STORE-NAME(PV-PAGE-LINE)          05991221
059901                     PERFORM 2505-FORMAT-COL1-ALL-LINE            05991321
059910                 ELSE                                             05993419
059920**                   06 = COMPANY - WRITE ALL AND COMP LINES      05993519
059980                     MOVE SPACES                                  05993679
059990                         TO DL-DETAIL-LINE-COLUMN-1(PV-PAGE-LINE) 05993779
059960                     ADD +1          TO PV-DATA-COUNT             05993879
059970                                        PV-PAGE-LINE              05993979
059921                     MOVE 'COMPANY TOTAL- ALL '                   05994279
059940                                 TO DL1-DESCRIPTION(PV-PAGE-LINE) 05994379
059941                     PERFORM 2505-FORMAT-COL1-ALL-LINE            05994479
059960                     ADD +1          TO PV-DATA-COUNT             05994579
059970                                        PV-PAGE-LINE              05994679
059980                     MOVE SPACES                                  05994779
059990                         TO DL-DETAIL-LINE-COLUMN-1(PV-PAGE-LINE) 05994879
059991                     MOVE 'COMPANY TOTAL- COMP'                   05994979
059992                                 TO DL1-DESCRIPTION(PV-PAGE-LINE) 05995000
059993                     PERFORM 2510-FORMAT-COL1-COMP-LINE           05996000
060000                 END-IF                                           05997000
060000             END-IF                                               05998000
060010         END-IF                                                   05999000
060100     END-IF.                                                      06000000
064801                                                                  06010000
064802                                                                  06020000
064803******************************************************************06030000
064804* FORMAT THE COLUMN 1 LINE FOR ALL STORES (STORE AND COMPANY).    06040000
064805******************************************************************06050000
064806                                                                  06060000
064810 2505-FORMAT-COL1-ALL-LINE.                                       06070000
064811                                                                  06080000
064812     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06090000
064813             WS-IN-TY-DAILY-SALES / 1000.                         06100000
064814     MOVE PV-DIV-BY-1000     TO DL1-TY-DAILY-SALES(PV-PAGE-LINE). 06110000
064815     IF WS-IN-LY-DAILY-SALES = 0                                  06120000
064816       OR WS-IN-TY-DAILY-SALES = 0                                06130000
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              06140000
064817         MOVE '    N/A'      TO DL1-TY-LY-PCT-NA (PV-PAGE-LINE)   06150000
064818     ELSE                                                         06160000
064819         COMPUTE PV-PCT-CHANGE =                                  06170000
064820               ((WS-IN-TY-DAILY-SALES -                           06180000
064821                 WS-IN-LY-DAILY-SALES)                            06190000
064822               / WS-IN-LY-DAILY-SALES)     *  100                 06200000
064823           ON SIZE ERROR                                          06210000
064824               MOVE 9999.9  TO  PV-PCT-CHANGE                     06220000
064825         END-COMPUTE                                              06230000
064826         COMPUTE DL1-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     06240000
064827             PV-PCT-CHANGE * 1                                    06250000
064828     END-IF.                                                      06260000
064829     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06270000
064830             WS-IN-TY-MTD-SALES / 1000.                           06280000
064831     MOVE PV-DIV-BY-1000     TO DL1-MTD-SALES (PV-PAGE-LINE).     06290000
064832     IF WS-IN-LY-MTD-SALES = 0                                    06300000
064833       OR WS-IN-TY-MTD-SALES = 00                                 06310000
064834         MOVE '    N/A'      TO DL1-MTD-PCT-NA (PV-PAGE-LINE)     06320000
064835     ELSE                                                         06330000
064836         COMPUTE PV-PCT-CHANGE =                                  06340000
064837               ((WS-IN-TY-MTD-SALES -                             06350000
064838                 WS-IN-LY-MTD-SALES)                              06360000
064839               / WS-IN-LY-MTD-SALES)     *  100                   06370000
064840           ON SIZE ERROR                                          06380000
064841               MOVE 9999.9  TO PV-PCT-CHANGE                      06390000
064842         END-COMPUTE                                              06400000
064843         COMPUTE DL1-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       06410000
064844             PV-PCT-CHANGE * 1                                    06420000
064845     END-IF.                                                      06430000
064846     IF WS-IN-LY-YTD-SALES = 0                                    06440000
064847       OR WS-IN-TY-YTD-SALES = 0                                  06450000
064848         MOVE '    N/A'    TO DL1-YTD-PCT-NA(PV-PAGE-LINE)        06460000
064849     ELSE                                                         06470000
064850         COMPUTE PV-PCT-CHANGE =                                  06480000
064851               ((WS-IN-TY-YTD-SALES -                             06481000
064852                 WS-IN-LY-YTD-SALES)                              06482000
064853               / WS-IN-LY-YTD-SALES)     *  100                   06483000
064854           ON SIZE ERROR                                          06484000
064855               MOVE 9999.9  TO PV-PCT-CHANGE                      06485000
064856         END-COMPUTE                                              06485100
064857         COMPUTE DL1-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       06485200
064858             PV-PCT-CHANGE * 1                                    06485300
064859     END-IF.                                                      06485400
064860                                                                  06485500
064861     IF WS-IN-REC-CODE = '04' OR '05'                             06485600
064862**       REPORT ON LAST YEAR'S STORE SALES IN MILLIONS            06485700
064863         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      06485800
064864                 WS-IN-LY-TOTAL-SALES / 1000000                   06485900
064865         MOVE PV-DIV-BY-1000000                                   06486000
064866                           TO DL1-LY-TOTAL-SALES(PV-PAGE-LINE)    06486100
064867**       REPORT ON THIS YEAR'S STORE SALES IN MILLIONS            06486200
064868         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      06486300
064869                 WS-IN-SORT-STORE-SALES / 1000000                 06486400
064870         MOVE PV-DIV-BY-1000000                                   06486500
064871                           TO DL1-TY-TOTAL-SALES(PV-PAGE-LINE)    06486600
064872     ELSE                                                         06486700
064873         MOVE SPACES       TO DL1-TY-TOTAL-SALES-X(PV-PAGE-LINE)  06486800
064874     END-IF.                                                      06486900
064875                                                                  06487000
064878******************************************************************06487300
064879* FORMAT THE COLUMN 1 LINE FOR COMP STORES ONLY                   06487400
064880* (TERR, REGN AND COMPANY).                                       06487503
064881******************************************************************06487600
064882                                                                  06487700
064883 2510-FORMAT-COL1-COMP-LINE.                                      06487800
064884                                                                  06487900
064885     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06490372
064886             WS-IN-TY-COMP-DLY-SALES / 1000.                      06490466
064887     MOVE PV-DIV-BY-1000 TO DL1-TY-DAILY-SALES(PV-PAGE-LINE).     06490572
064888     IF WS-IN-LY-COMP-DLY-SALES = 0                               06490672
064889     OR WS-IN-TY-COMP-DLY-SALES = 0                               06490772
WEEK53     OR WS-IN-DURING-WEEK-53 = 'Y'                                06490872
064890        MOVE '    N/A'   TO DL1-TY-LY-PCT-NA (PV-PAGE-LINE)       06490972
064891     ELSE                                                         06491072
064892        COMPUTE PV-PCT-CHANGE =                                   06491172
064893            ((WS-IN-TY-COMP-DLY-SALES -                           06491272
064894              WS-IN-LY-COMP-DLY-SALES)                            06491372
064895            / WS-IN-LY-COMP-DLY-SALES)     *  100                 06491472
064896           ON SIZE ERROR                                          06491554
064897               MOVE 9999.9  TO PV-PCT-CHANGE                      06491654
064898        END-COMPUTE                                               06491772
064899        COMPUTE DL1-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =      06491872
064900                PV-PCT-CHANGE * 1                                 06491954
064901     END-IF.                                                      06492072
064902     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06492172
064903             WS-IN-TY-COMP-MTD-SALES / 1000.                      06492266
064904     MOVE PV-DIV-BY-1000 TO DL1-MTD-SALES (PV-PAGE-LINE).         06492372
064905     IF WS-IN-LY-COMP-MTD-SALES = 0                               06492472
064906     OR WS-IN-TY-COMP-MTD-SALES = 0                               06492572
064907        MOVE '    N/A'  TO DL1-MTD-PCT-NA (PV-PAGE-LINE)          06492672
064908     ELSE                                                         06492772
064909        COMPUTE PV-PCT-CHANGE =                                   06492872
064910           ((WS-IN-TY-COMP-MTD-SALES -                            06492972
064911             WS-IN-LY-COMP-MTD-SALES)                             06493072
064912           / WS-IN-LY-COMP-MTD-SALES)     *  100                  06493172
064913           ON SIZE ERROR                                          06493254
064914           MOVE 9999.9  TO PV-PCT-CHANGE                          06493354
064915        END-COMPUTE                                               06493472
064916        COMPUTE DL1-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        06493572
064917                PV-PCT-CHANGE * 1                                 06493672
064918     END-IF.                                                      06493772
064919     IF WS-IN-LY-COMP-YTD-SALES = 0                               06493872
064920     OR WS-IN-TY-COMP-YTD-SALES = 0                               06493972
064921        MOVE '    N/A'    TO DL1-YTD-PCT-NA(PV-PAGE-LINE)         06494072
064922     ELSE                                                         06494172
064923        COMPUTE PV-PCT-CHANGE =                                   06494272
064924           ((WS-IN-TY-COMP-YTD-SALES -                            06494372
064925             WS-IN-LY-COMP-YTD-SALES)                             06494472
064926           / WS-IN-LY-COMP-YTD-SALES)     *  100                  06494572
064927           ON SIZE ERROR                                          06494654
064928               MOVE 9999.9  TO PV-PCT-CHANGE                      06494754
064929        END-COMPUTE                                               06494872
064930        COMPUTE DL1-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        06494972
064931               PV-PCT-CHANGE * 1                                  06495054
064932     END-IF.                                                      06495172
064933     MOVE SPACES   TO DL1-TY-TOTAL-SALES-X(PV-PAGE-LINE).         06495272
064884                                                                  06495457
064883 2520-FORMAT-COL1-COMP-LINE.                                      06495554
064884                                                                  06495654
064885     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06496672
064886             WS-IN-TY-COMP-DLY-SALES / 1000.                      06496766
064887     MOVE PV-DIV-BY-1000 TO DL1-TY-DAILY-SALES(PV-PAGE-LINE).     06496872
064888     IF WS-IN-LY-COMP-DLY-SALES = 0                               06496972
064889     OR WS-IN-TY-COMP-DLY-SALES = 0                               06497072
WEEK53     OR WS-IN-DURING-WEEK-53 = 'Y'                                06497172
064890        MOVE '    N/A'      TO DL1-TY-LY-PCT-NA (PV-PAGE-LINE)    06497272
064891     ELSE                                                         06497372
064892        COMPUTE PV-PCT-CHANGE =                                   06497472
064893           ((WS-IN-TY-COMP-DLY-SALES -                            06497572
064894             WS-IN-LY-COMP-DLY-SALES)                             06497672
064895           / WS-IN-LY-COMP-DLY-SALES)     *  100                  06497772
064896           ON SIZE ERROR                                          06497854
064897               MOVE 9999.9  TO PV-PCT-CHANGE                      06497954
064898        END-COMPUTE                                               06498072
064899        COMPUTE DL1-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =      06498172
064900                PV-PCT-CHANGE * 1                                 06498254
064901     END-IF.                                                      06498372
064902     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06498472
064903              WS-IN-TY-COMP-MTD-SALES / 1000.                     06498566
064904     MOVE PV-DIV-BY-1000 TO DL1-MTD-SALES (PV-PAGE-LINE).         06498672
064905     IF WS-IN-LY-COMP-MTD-SALES = 0                               06498772
064906     OR WS-IN-TY-COMP-MTD-SALES = 0                               06498872
064907        MOVE '    N/A'    TO DL1-MTD-PCT-NA (PV-PAGE-LINE)        06498972
064908     ELSE                                                         06499072
064909        COMPUTE PV-PCT-CHANGE =                                   06499172
064910            ((WS-IN-TY-COMP-MTD-SALES -                           06499272
064911              WS-IN-LY-COMP-MTD-SALES)                            06499372
064912            / WS-IN-LY-COMP-MTD-SALES)     *  100                 06499472
064913           ON SIZE ERROR                                          06499554
064914               MOVE 9999.9  TO PV-PCT-CHANGE                      06499654
064915        END-COMPUTE                                               06499772
064916        COMPUTE DL1-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        06499872
064917                PV-PCT-CHANGE * 1                                 06499954
064918     END-IF.                                                      06500072
064919     IF WS-IN-LY-COMP-YTD-SALES = 0                               06500172
064920     OR WS-IN-TY-COMP-YTD-SALES = 0                               06500272
064921        MOVE '    N/A'    TO DL1-YTD-PCT-NA(PV-PAGE-LINE)         06500372
064922     ELSE                                                         06500472
064923        COMPUTE PV-PCT-CHANGE =                                   06500572
064924            ((WS-IN-TY-COMP-YTD-SALES -                           06500672
064925              WS-IN-LY-COMP-YTD-SALES)                            06500772
064926            / WS-IN-LY-COMP-YTD-SALES)     *  100                 06500872
064927           ON SIZE ERROR                                          06500954
064928               MOVE 9999.9  TO PV-PCT-CHANGE                      06501054
064929        END-COMPUTE                                               06501172
064930        COMPUTE DL1-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        06501272
064931               PV-PCT-CHANGE * 1                                  06501354
064932     END-IF.                                                      06501472
064933     MOVE SPACES    TO DL1-TY-TOTAL-SALES-X(PV-PAGE-LINE).        06501572
064948                                                                  06501754
064950******************************************************************06501854
065000* LOAD DATA TO THE SECOND COLUMN ON THE PAGE.                     06501954
065100* CHECK IF A CONTINUATION LINE FROM THE FIRST COLUMN IS REQUIRED. 06502054
065200******************************************************************06502154
065300 2600-LOAD-COLUMN-2.                                              06502254
065400                                                                  06503000
065500     IF PV-PAGE-LINE = 1                                          06510000
075400           IF WS-IN-REC-CODE = '03'                               06582022
075500**           REGN CONTINUATION LINE IS REQUIRED                   06583022
075600                 STRING  WS-IN-REGN-MGR-NM ' CONT'                06584054
075800                   DELIMITED BY SIZE                              06585022
075900                     INTO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  06586022
076000                 MOVE 2        TO PV-PAGE-LINE                    06587022
076100                 ADD +1        TO PV-DATA-COUNT                   06588022
066300           ELSE                                                   06590022
066400             IF WS-IN-REC-CODE = '04'                             06600000
066500**               DIST CONTINUATION LINE IS REQUIRED               06610022
075600                 STRING  WS-IN-DIST-MGR-NM ' CONT'                06620054
066800                   DELIMITED BY SIZE                              06640000
066900                     INTO DL-DETAIL-LINE-COLUMN-2 (PV-PAGE-LINE)  06650000
067000                 MOVE 2        TO PV-PAGE-LINE                    06660000
067100                 ADD +1        TO PV-DATA-COUNT                   06670000
067200             END-IF                                               06680000
067400     END-IF.                                                      06700031
067500                                                                  06710000
067510     IF WS-IN-REC-CODE = '00'                                     06720000
067520**       00 = TERR - WRITE TERR COMP LINE                         06730003
067530         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-2 (PV-PAGE-LINE)  06740000
058860         MOVE WS-IN-TERR-MGR-NM  TO DL2-TERR-NM (PV-PAGE-LINE)    06740326
032200                                    PV-SAVE-TERR-NM               06740497
058860         MOVE 'COMP'             TO F2-COMP (PV-PAGE-LINE)        06740586
067560         PERFORM 2610-FORMAT-COL2-COMP-LINE                       06752000
067570     ELSE                                                         06753000
067580         IF WS-IN-REC-CODE = '02'                                 06754000
067590**           02 = REGN - WRITE REGN COMP LINE                     06755003
                   SET PS-EMPTY-LINE TO TRUE                            06755255
                   MOVE '2' TO PS-COLUMN-SW                             06755360
067591             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-2(PV-PAGE-LINE) 06756000
032200             MOVE WS-IN-REGN-MGR-NM TO DL2-REGN-NM(PV-PAGE-LINE)  06759626
032200                                       PV-SAVE-REGN-NM            06759797
032200             MOVE 'COMP'            TO F2-COMP1(PV-PAGE-LINE)     06759888
067598             PERFORM 2610-FORMAT-COL2-COMP-LINE                   06759985
067599         ELSE                                                     06760100
067600             IF WS-IN-REC-CODE = '03'                             06760202
067601**               03 = DIST - WRITE DIST ALL LINE                  06760302
                       SET PS-EMPTY-LINE TO TRUE                        06760655
                       MOVE '2' TO PS-COLUMN-SW                         06760760
032200                 MOVE WS-IN-DIST-MGR-NM                           06760955
032200                                TO DL2-DIST-NM(PV-PAGE-LINE)      06761055
032200                                   PV-SAVE-DIST-NM                06761197
032200                 MOVE 'COMP'    TO F2-COMP2(PV-PAGE-LINE)         06761287
067604                 PERFORM 2615-FORMAT-COL2-ALL-LINE                06761355
067605             ELSE                                                 06761455
067600             IF WS-IN-REC-CODE = '04'                             06761555
067601**               04 = STORE - WRITE STORE ALL LINE                06761655
067602                 MOVE WS-IN-STORE-NAME                            06761755
067603                                  TO DL2-STORE-NAME(PV-PAGE-LINE) 06761855
067604                 PERFORM 2605-FORMAT-COL2-ALL-LINE                06761955
067605             ELSE                                                 06762055
059510                 IF WS-IN-REC-CODE = '05'                         06762155
059510                     IF WS-IN-STORE > 0                           06762255
059600**                       05 = ECOM STORE - WRITE STORE ALL LINE   06762355
059800                         MOVE WS-IN-STORE-NAME                    06762455
059900                                  TO DL2-STORE-NAME(PV-PAGE-LINE) 06762555
059901                         PERFORM 2605-FORMAT-COL2-ALL-LINE        06762655
059910                     ELSE                                         06762755
059600**                       05 = ECOM REGN - WRITE REGN COMP LINE    06762855
059600**                            BUT ALIGN REGN UNDER TERR NAMES     06762955
059090                         MOVE PV-FORMATTED-REGN-NAME              06763055
059091                             TO DL2-TERR-DESC(PV-PAGE-LINE)       06763155
059092                         PERFORM 2610-FORMAT-COL2-COMP-LINE       06763255
059910                 ELSE                                             06763355
059920**                   06 = COMPANY - WRITE ALL AND COMP LINES      06763455
059980                     MOVE SPACES                                  06763580
059990                         TO DL-DETAIL-LINE-COLUMN-2(PV-PAGE-LINE) 06763680
059960                     ADD +1          TO PV-DATA-COUNT             06763780
059970                                        PV-PAGE-LINE              06763880
059921                     MOVE 'COMPANY TOTAL- ALL '                   06763955
059940                                 TO DL2-DESCRIPTION(PV-PAGE-LINE) 06764055
059941                     PERFORM 2605-FORMAT-COL2-ALL-LINE            06764155
059960                     ADD +1          TO PV-DATA-COUNT             06764255
059970                                        PV-PAGE-LINE              06764355
059980                     MOVE SPACES                                  06764455
059990                         TO DL-DETAIL-LINE-COLUMN-2(PV-PAGE-LINE) 06764555
059991                     MOVE 'COMPANY TOTAL- COMP'                   06764655
059992                                 TO DL2-DESCRIPTION(PV-PAGE-LINE) 06764755
059993                     PERFORM 2610-FORMAT-COL2-COMP-LINE           06764855
060000                 END-IF                                           06764955
060000             END-IF                                               06765055
067618         END-IF                                                   06765155
067619     END-IF.                                                      06765255
067620                                                                  06765300
073820******************************************************************06767000
073821* FORMAT THE COLUMN 2 LINE FOR ALL STORES (STORE AND COMPANY).    06768000
073822******************************************************************06769000
073823                                                                  06770000
073824 2605-FORMAT-COL2-ALL-LINE.                                       06780000
073825                                                                  06790000
073826     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06800000
073827             WS-IN-TY-DAILY-SALES / 1000.                         06810000
073828     MOVE PV-DIV-BY-1000     TO DL2-TY-DAILY-SALES(PV-PAGE-LINE). 06820000
073829     IF WS-IN-LY-DAILY-SALES = 0                                  06830000
073830       OR WS-IN-TY-DAILY-SALES = 0                                06840000
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              06850000
073831         MOVE '    N/A'      TO DL2-TY-LY-PCT-NA (PV-PAGE-LINE)   06860000
073832     ELSE                                                         06870000
073833         COMPUTE PV-PCT-CHANGE =                                  06880000
073834               ((WS-IN-TY-DAILY-SALES -                           06890000
073835                 WS-IN-LY-DAILY-SALES)                            06900000
073836               / WS-IN-LY-DAILY-SALES)     *  100                 06910000
073837           ON SIZE ERROR                                          06920000
073838               MOVE 9999.9  TO  PV-PCT-CHANGE                     06930000
073839         END-COMPUTE                                              06940000
073840         COMPUTE DL2-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     06950000
073841             PV-PCT-CHANGE * 1                                    06960000
073842     END-IF.                                                      06970000
073843     COMPUTE PV-DIV-BY-1000 ROUNDED =                             06980000
073844             WS-IN-TY-MTD-SALES / 1000.                           06990000
073845     MOVE PV-DIV-BY-1000     TO DL2-MTD-SALES (PV-PAGE-LINE).     07000000
073846     IF WS-IN-LY-MTD-SALES = 0                                    07010000
073847       OR WS-IN-TY-MTD-SALES = 0                                  07020000
073848         MOVE '    N/A'      TO DL2-MTD-PCT-NA (PV-PAGE-LINE)     07030000
073849     ELSE                                                         07040000
073850         COMPUTE PV-PCT-CHANGE =                                  07050000
073851               ((WS-IN-TY-MTD-SALES -                             07060000
073852                 WS-IN-LY-MTD-SALES)                              07070000
073853               / WS-IN-LY-MTD-SALES)     *  100                   07080000
073854           ON SIZE ERROR                                          07090000
073855               MOVE 9999.9  TO PV-PCT-CHANGE                      07100000
073856         END-COMPUTE                                              07110000
073857         COMPUTE DL2-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       07120000
073858             PV-PCT-CHANGE * 1                                    07130000
073859     END-IF.                                                      07140000
073860     IF WS-IN-LY-YTD-SALES = 0                                    07150000
073861       OR WS-IN-TY-YTD-SALES = 0                                  07160000
073862         MOVE '    N/A'    TO DL2-YTD-PCT-NA(PV-PAGE-LINE)        07170000
073863     ELSE                                                         07180000
073864         COMPUTE PV-PCT-CHANGE =                                  07190000
073865               ((WS-IN-TY-YTD-SALES -                             07200000
073866                 WS-IN-LY-YTD-SALES)                              07210000
073867               / WS-IN-LY-YTD-SALES)     *  100                   07220000
073868           ON SIZE ERROR                                          07230000
073869               MOVE 9999.9  TO PV-PCT-CHANGE                      07240000
073870         END-COMPUTE                                              07250000
073871         COMPUTE DL2-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       07260000
073872             PV-PCT-CHANGE * 1                                    07270000
073873     END-IF.                                                      07280000
073874                                                                  07290000
064861     IF WS-IN-REC-CODE = '04' OR '05'                             07300000
073876**       REPORT ON LAST YEAR'S STORE SALES IN MILLIONS            07310000
073877         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      07320000
073878                 WS-IN-LY-TOTAL-SALES / 1000000                   07330000
073879         MOVE PV-DIV-BY-1000000                                   07340000
073880                           TO DL2-LY-TOTAL-SALES(PV-PAGE-LINE)    07350000
073881**       REPORT ON THIS YEAR'S STORE SALES IN MILLIONS            07360000
073882         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      07370000
073883                 WS-IN-SORT-STORE-SALES / 1000000                 07380000
073884         MOVE PV-DIV-BY-1000000                                   07381000
073885                           TO DL2-TY-TOTAL-SALES(PV-PAGE-LINE)    07382000
073886     ELSE                                                         07383000
073887         MOVE SPACES       TO DL2-TY-TOTAL-SALES-X(PV-PAGE-LINE)  07384000
073888     END-IF.                                                      07385000
073889                                                                  07386000
073890                                                                  07387000
073891******************************************************************07388000
073892* FORMAT THE COLUMN 2 LINE FOR COMP STORES ONLY                   07389000
073893* (TERR, REGN AND COMPANY).                                       07389103
073894******************************************************************07389200
073895                                                                  07389300
073896 2610-FORMAT-COL2-COMP-LINE.                                      07389400
073897                                                                  07389500
073898     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07390572
073899             WS-IN-TY-COMP-DLY-SALES / 1000.                      07390666
073900     MOVE PV-DIV-BY-1000 TO DL2-TY-DAILY-SALES(PV-PAGE-LINE).     07390772
073901     IF WS-IN-LY-COMP-DLY-SALES = 0                               07390872
073902     OR WS-IN-TY-COMP-DLY-SALES = 0                               07390972
WEEK53     OR WS-IN-DURING-WEEK-53 = 'Y'                                07391072
073903        MOVE '    N/A'   TO DL2-TY-LY-PCT-NA (PV-PAGE-LINE)       07391172
073904     ELSE                                                         07391272
073905        COMPUTE PV-PCT-CHANGE =                                   07391372
073906            ((WS-IN-TY-COMP-DLY-SALES -                           07391472
073907              WS-IN-LY-COMP-DLY-SALES)                            07391572
073908            / WS-IN-LY-COMP-DLY-SALES)     *  100                 07391672
073909           ON SIZE ERROR                                          07391700
073910               MOVE 9999.9  TO PV-PCT-CHANGE                      07391800
073911        END-COMPUTE                                               07391972
073912        COMPUTE DL2-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =      07392072
073913             PV-PCT-CHANGE * 1                                    07392100
073914     END-IF.                                                      07392272
073915     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07392372
073916             WS-IN-TY-COMP-MTD-SALES / 1000.                      07392466
073917     MOVE PV-DIV-BY-1000  TO DL2-MTD-SALES (PV-PAGE-LINE).        07392572
073918     IF WS-IN-LY-COMP-MTD-SALES = 0                               07392672
073919     OR WS-IN-TY-COMP-MTD-SALES = 0                               07392772
073920        MOVE '    N/A'   TO DL2-MTD-PCT-NA (PV-PAGE-LINE)         07392872
073921     ELSE                                                         07392972
073922        COMPUTE PV-PCT-CHANGE =                                   07393072
073923            ((WS-IN-TY-COMP-MTD-SALES -                           07393172
073924              WS-IN-LY-COMP-MTD-SALES)                            07393272
073925            / WS-IN-LY-COMP-MTD-SALES)     *  100                 07393372
073926           ON SIZE ERROR                                          07393400
073927               MOVE 9999.9  TO PV-PCT-CHANGE                      07393500
073928        END-COMPUTE                                               07393672
073929        COMPUTE DL2-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        07393772
073930             PV-PCT-CHANGE * 1                                    07393800
073931     END-IF.                                                      07393972
073932     IF WS-IN-LY-COMP-YTD-SALES = 0                               07394072
073933     OR WS-IN-TY-COMP-YTD-SALES = 0                               07394172
073934        MOVE '    N/A'    TO DL2-YTD-PCT-NA(PV-PAGE-LINE)         07394272
073935     ELSE                                                         07394372
073936        COMPUTE PV-PCT-CHANGE =                                   07394472
073937            ((WS-IN-TY-COMP-YTD-SALES -                           07394572
073938              WS-IN-LY-COMP-YTD-SALES)                            07394672
073939            / WS-IN-LY-COMP-YTD-SALES)     *  100                 07394772
073940         ON SIZE ERROR                                            07394872
073941             MOVE 9999.9  TO PV-PCT-CHANGE                        07394972
073942        END-COMPUTE                                               07395072
073943        COMPUTE DL2-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        07395172
073944               PV-PCT-CHANGE * 1                                  07395254
073945     END-IF.                                                      07395372
073946     MOVE SPACES  TO DL2-TY-TOTAL-SALES-X(PV-PAGE-LINE).          07395472
073897                                                                  07395566
073896 2615-FORMAT-COL2-ALL-LINE.                                       07395606
073897                                                                  07395704
073898     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07396772
073899             WS-IN-TY-COMP-DLY-SALES / 1000.                      07396866
073900     MOVE PV-DIV-BY-1000  TO DL2-TY-DAILY-SALES(PV-PAGE-LINE).    07396972
073901     IF WS-IN-LY-COMP-DLY-SALES = 0                               07397072
073902     OR WS-IN-TY-COMP-DLY-SALES = 0                               07397172
WEEK53     OR WS-IN-DURING-WEEK-53 = 'Y'                                07397272
073903        MOVE '    N/A'      TO DL2-TY-LY-PCT-NA (PV-PAGE-LINE)    07397372
073904     ELSE                                                         07397472
073905        COMPUTE PV-PCT-CHANGE =                                   07397572
073906            ((WS-IN-TY-COMP-DLY-SALES -                           07397672
073907              WS-IN-LY-COMP-DLY-SALES)                            07397772
073908            / WS-IN-LY-COMP-DLY-SALES)     *  100                 07397872
073909         ON SIZE ERROR                                            07397972
073910            MOVE 9999.9  TO PV-PCT-CHANGE                         07398072
073911        END-COMPUTE                                               07398172
073912        COMPUTE DL2-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =      07398272
073913            PV-PCT-CHANGE * 1                                     07398372
073914     END-IF.                                                      07398472
073915     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07398572
073916             WS-IN-TY-COMP-MTD-SALES / 1000.                      07398666
073917     MOVE PV-DIV-BY-1000     TO DL2-MTD-SALES (PV-PAGE-LINE).     07398772
073918     IF WS-IN-LY-COMP-MTD-SALES = 0                               07398872
073919     OR WS-IN-TY-COMP-MTD-SALES = 0                               07398972
073920        MOVE '    N/A'      TO DL2-MTD-PCT-NA (PV-PAGE-LINE)      07399072
073921     ELSE                                                         07399172
073922        COMPUTE PV-PCT-CHANGE =                                   07399272
073923            ((WS-IN-TY-COMP-MTD-SALES -                           07399372
073924              WS-IN-LY-COMP-MTD-SALES)                            07399472
073925            / WS-IN-LY-COMP-MTD-SALES)     *  100                 07399572
073926          ON SIZE ERROR                                           07399672
073927            MOVE 9999.9  TO PV-PCT-CHANGE                         07399772
073928        END-COMPUTE                                               07399872
073929        COMPUTE DL2-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        07399972
073930               PV-PCT-CHANGE * 1                                  07400057
073931     END-IF.                                                      07400172
073932     IF WS-IN-LY-COMP-YTD-SALES = 0                               07400272
073933     OR WS-IN-TY-COMP-YTD-SALES = 0                               07400372
073934        MOVE '    N/A'    TO DL2-YTD-PCT-NA(PV-PAGE-LINE)         07400472
073935     ELSE                                                         07400572
073936        COMPUTE PV-PCT-CHANGE =                                   07400672
073937            ((WS-IN-TY-COMP-YTD-SALES -                           07400772
073938              WS-IN-LY-COMP-YTD-SALES)                            07400872
073939            / WS-IN-LY-COMP-YTD-SALES)     *  100                 07400972
073940           ON SIZE ERROR                                          07401004
073941            MOVE 9999.9  TO PV-PCT-CHANGE                         07401172
073942        END-COMPUTE                                               07401272
073943        COMPUTE DL2-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        07401372
073944               PV-PCT-CHANGE * 1                                  07401457
073945     END-IF.                                                      07401572
073946     MOVE SPACES     TO DL2-TY-TOTAL-SALES-X(PV-PAGE-LINE).       07401672
073948                                                                  07401804
073950******************************************************************07401904
074000* LOAD DATA TO THE THIRD COLUMN ON THE PAGE.                      07402004
074100* CHECK IF A CONTINUATION LINE FROM THE SECOND COLUMN IS REQUIRED.07402104
074200******************************************************************07402204
074300 2700-LOAD-COLUMN-3.                                              07402304
074400                                                                  07402404
074500     IF PV-PAGE-LINE = 1                                          07402504
075400           IF WS-IN-REC-CODE = '03'                               07480006
075500**           REGN CONTINUATION LINE IS REQUIRED                   07490013
075600                 STRING  WS-IN-REGN-MGR-NM ' CONT'                07500055
075800                   DELIMITED BY SIZE                              07520000
075900                     INTO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  07530007
076000                 MOVE 2        TO PV-PAGE-LINE                    07540000
076100                 ADD +1        TO PV-DATA-COUNT                   07550000
075300           ELSE                                                   07560106
075400             IF WS-IN-REC-CODE = '04'                             07561002
075500**              DIST CONTINUATION LINE IS REQUIRED                07562013
075600                 STRING  WS-IN-DIST-MGR-NM ' CONT'                07563055
075800                   DELIMITED BY SIZE                              07565007
075900                     INTO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  07566002
076000                 MOVE 2        TO PV-PAGE-LINE                    07567002
076100                 ADD +1        TO PV-DATA-COUNT                   07568002
076300             END-IF                                               07570007
076300           END-IF                                                 07570107
076400     END-IF.                                                      07580072
076410                                                                  07590000
076420     IF WS-IN-REC-CODE = '00'                                     07600000
076430**       00 = TERR - WRITE TERR COMP LINE                         07610003
076440         MOVE SPACES   TO DL-DETAIL-LINE-COLUMN-3 (PV-PAGE-LINE)  07620000
058860         MOVE WS-IN-TERR-MGR-NM  TO DL3-TERR-NM (PV-PAGE-LINE)    07622026
032200                                    PV-SAVE-TERR-NM               07623097
076470         PERFORM 2710-FORMAT-COL3-COMP-LINE                       07641000
076480     ELSE                                                         07642000
076490         IF WS-IN-REC-CODE = '02'                                 07643000
  6491**           02 = REGN - WRITE REGN COMP LINE                     07644056
                   SET PS-EMPTY-LINE TO TRUE                            07644255
                   MOVE '3' TO PS-COLUMN-SW                             07644361
076492             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-3(PV-PAGE-LINE) 07645000
032200             MOVE WS-IN-REGN-MGR-NM TO DL3-REGN-NM(PV-PAGE-LINE)  07649226
032200                                       PV-SAVE-REGN-NM            07649397
032200             MOVE 'COMP'            TO F3-COMP1(PV-PAGE-LINE)     07649485
076499             PERFORM 2710-FORMAT-COL3-COMP-LINE                   07649500
076500         ELSE                                                     07649900
076490           IF WS-IN-REC-CODE = '03'                               07650007
076491**           03 = DIST  - WRITE DIST COMP LINE                    07650102
                   SET PS-EMPTY-LINE TO TRUE                            07650355
                   MOVE '3' TO PS-COLUMN-SW                             07650461
076492             MOVE SPACES TO DL-DETAIL-LINE-COLUMN-3(PV-PAGE-LINE) 07650502
032200             MOVE WS-IN-DIST-MGR-NM TO DL3-DIST-NM(PV-PAGE-LINE)  07650826
032200                                       PV-SAVE-DIST-NM            07650997
032200             MOVE 'COMP'            TO F3-COMP2(PV-PAGE-LINE)     07651085
076499             PERFORM 2710-FORMAT-COL3-COMP-LINE                   07651102
076500           ELSE                                                   07651207
076501             IF WS-IN-REC-CODE = '04'                             07651302
076502**               04 = STORE - WRITE STORE ALL LINE                07651402
076503                 MOVE WS-IN-STORE-NAME                            07651507
076504                                  TO DL3-STORE-NAME(PV-PAGE-LINE) 07651602
076505                 PERFORM 2705-FORMAT-COL3-ALL-LINE                07651702
076506             ELSE                                                 07651802
059510                 IF WS-IN-REC-CODE = '05'                         07651902
059510                     IF WS-IN-STORE > 0                           07652002
059600**                       05 = ECOM STORE - WRITE STORE ALL LINE   07652102
059800                         MOVE WS-IN-STORE-NAME                    07652202
059900                                  TO DL3-STORE-NAME(PV-PAGE-LINE) 07652302
059901                         PERFORM 2705-FORMAT-COL3-ALL-LINE        07652402
059910                     ELSE                                         07652578
059600**                       05 = ECOM REGN - WRITE WEB COMP LINE     07652614
059600**                            BUT ALIGN WEB UNDER TERR NAMES      07652714
032200                         MOVE 'WEB '                              07652814
059091                             TO DL3-TERR-DESC(PV-PAGE-LINE)       07652903
059092                         PERFORM 2710-FORMAT-COL3-COMP-LINE       07653002
059910                 ELSE                                             07653278
059920**                   06 = COMPANY - WRITE ALL AND COMP LINES      07653302
059980                     MOVE SPACES                                  07653480
059990                         TO DL-DETAIL-LINE-COLUMN-3(PV-PAGE-LINE) 07653580
059960                     ADD +1          TO PV-DATA-COUNT             07653680
059970                                        PV-PAGE-LINE              07653780
059921                     MOVE 'COMPANY TOTAL- ALL '                   07653802
059940                                 TO DL3-DESCRIPTION(PV-PAGE-LINE) 07653902
059941                     PERFORM 2705-FORMAT-COL3-ALL-LINE            07654002
059960                     ADD +1          TO PV-DATA-COUNT             07654102
059970                                        PV-PAGE-LINE              07654202
059980                     MOVE SPACES                                  07654302
059990                         TO DL-DETAIL-LINE-COLUMN-3(PV-PAGE-LINE) 07654402
059991                     MOVE 'COMPANY TOTAL- COMP'                   07654502
059992                                 TO DL3-DESCRIPTION(PV-PAGE-LINE) 07654602
059993                     PERFORM 2710-FORMAT-COL3-COMP-LINE           07654702
060000                 END-IF                                           07654807
076518             END-IF                                               07654902
076519           END-IF                                                 07655007
076519         END-IF                                                   07655131
076520     END-IF.                                                      07655207
076530                                                                  07655307
082821******************************************************************07656000
082822* FORMAT THE COLUMN 3 LINE FOR ALL STORES (STORE AND COMPANY).    07657000
082823******************************************************************07658000
082824                                                                  07659000
082825 2705-FORMAT-COL3-ALL-LINE.                                       07660000
082826                                                                  07670000
082827     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07680000
082828             WS-IN-TY-DAILY-SALES / 1000.                         07690000
082829     MOVE PV-DIV-BY-1000     TO DL3-TY-DAILY-SALES(PV-PAGE-LINE). 07700000
082830     IF WS-IN-LY-DAILY-SALES = 0                                  07710000
082831       OR WS-IN-TY-DAILY-SALES = 0                                07720000
WEEK53       OR WS-IN-DURING-WEEK-53 = 'Y'                              07730000
082832         MOVE '    N/A'      TO DL3-TY-LY-PCT-NA (PV-PAGE-LINE)   07740000
082833     ELSE                                                         07750000
082834         COMPUTE PV-PCT-CHANGE =                                  07760000
082835               ((WS-IN-TY-DAILY-SALES -                           07770000
082836                 WS-IN-LY-DAILY-SALES)                            07780000
082837               / WS-IN-LY-DAILY-SALES)     *  100                 07790000
082838           ON SIZE ERROR                                          07800000
082839               MOVE 9999.9  TO  PV-PCT-CHANGE                     07810000
082840         END-COMPUTE                                              07820000
082841         COMPUTE DL3-TY-LY-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =     07830000
082842             PV-PCT-CHANGE * 1                                    07840000
082843     END-IF.                                                      07850000
082844     COMPUTE PV-DIV-BY-1000 ROUNDED =                             07860000
082845             WS-IN-TY-MTD-SALES / 1000.                           07870000
082846     MOVE PV-DIV-BY-1000     TO DL3-MTD-SALES (PV-PAGE-LINE).     07880000
082847     IF WS-IN-LY-MTD-SALES = 0                                    07890000
082848       OR WS-IN-TY-MTD-SALES = 0                                  07900000
082849         MOVE '    N/A'      TO DL3-MTD-PCT-NA (PV-PAGE-LINE)     07910000
082850     ELSE                                                         07920000
082851         COMPUTE PV-PCT-CHANGE =                                  07930000
082852               ((WS-IN-TY-MTD-SALES -                             07940000
082853                 WS-IN-LY-MTD-SALES)                              07950000
082854               / WS-IN-LY-MTD-SALES)     *  100                   07960000
082855           ON SIZE ERROR                                          07970000
082856               MOVE 9999.9  TO PV-PCT-CHANGE                      07980000
082857         END-COMPUTE                                              07990000
082858         COMPUTE DL3-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       08000000
082859             PV-PCT-CHANGE * 1                                    08010000
082860     END-IF.                                                      08020000
082861     IF WS-IN-LY-YTD-SALES = 0                                    08030000
082862       OR WS-IN-TY-YTD-SALES = 0                                  08040000
082863         MOVE '    N/A'    TO DL3-YTD-PCT-NA(PV-PAGE-LINE)        08050000
082864     ELSE                                                         08060000
082865         COMPUTE PV-PCT-CHANGE =                                  08070000
082866               ((WS-IN-TY-YTD-SALES -                             08080000
082867                 WS-IN-LY-YTD-SALES)                              08090000
082868               / WS-IN-LY-YTD-SALES)     *  100                   08100000
082869           ON SIZE ERROR                                          08110000
082870               MOVE 9999.9  TO PV-PCT-CHANGE                      08120000
082871         END-COMPUTE                                              08130000
082872         COMPUTE DL3-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =       08140000
082873             PV-PCT-CHANGE * 1                                    08150000
082874     END-IF.                                                      08160000
082875                                                                  08170000
064861     IF WS-IN-REC-CODE = '04' OR '05'                             08180000
082877**       REPORT ON LAST YEAR'S STORE SALES IN MILLIONS            08190000
082878         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      08200000
082879                 WS-IN-LY-TOTAL-SALES / 1000000                   08210000
082880         MOVE PV-DIV-BY-1000000                                   08220000
082881                           TO DL3-LY-TOTAL-SALES(PV-PAGE-LINE)    08230000
082882**       REPORT ON THIS YEAR'S STORE SALES IN MILLIONS            08240000
082883         COMPUTE PV-DIV-BY-1000000 ROUNDED =                      08250000
082884                 WS-IN-SORT-STORE-SALES / 1000000                 08260000
082885         MOVE PV-DIV-BY-1000000                                   08270000
082886                           TO DL3-TY-TOTAL-SALES(PV-PAGE-LINE)    08280000
082887     ELSE                                                         08281000
082888         MOVE SPACES       TO DL3-TY-TOTAL-SALES-X(PV-PAGE-LINE)  08282000
082889     END-IF.                                                      08283000
082891                                                                  08285000
082892******************************************************************08286000
082893* FORMAT THE COLUMN 3 LINE FOR COMP STORES ONLY                   08287000
082894* (TERR, REGN, DIST AND COMPANY).                                 08288002
082895******************************************************************08289000
082896                                                                  08289100
082897 2710-FORMAT-COL3-COMP-LINE.                                      08289200
082898                                                                  08289300
082899     COMPUTE PV-DIV-BY-1000 ROUNDED =                             08290472
082900             WS-IN-TY-COMP-DLY-SALES / 1000.                      08290566
082901     MOVE PV-DIV-BY-1000 TO DL3-TY-DAILY-SALES(PV-PAGE-LINE).     08290672
082902     IF WS-IN-LY-COMP-DLY-SALES = 0                               08290772
082903     OR WS-IN-TY-COMP-DLY-SALES = 0                               08290872
WEEK53     OR WS-IN-DURING-WEEK-53 = 'Y'                                08290972
082904        MOVE '    N/A'      TO DL3-TY-LY-PCT-NA (PV-PAGE-LINE)    08291072
082905     ELSE                                                         08291172
082906        COMPUTE PV-PCT-CHANGE =                                   08291272
082907           ((WS-IN-TY-COMP-DLY-SALES -                            08291372
082908             WS-IN-LY-COMP-DLY-SALES)                             08291472
082909           / WS-IN-LY-COMP-DLY-SALES)     *  100                  08291572
082910           ON SIZE ERROR                                          08291600
082911            MOVE 9999.9  TO PV-PCT-CHANGE                         08291772
082912        END-COMPUTE                                               08291872
082913        COMPUTE DL3-TY-LY-PCT-CHANGE (PV-PAGE-LINE) ROUNDED =     08291972
082914             PV-PCT-CHANGE * 1                                    08292000
082915     END-IF.                                                      08292172
082916     COMPUTE PV-DIV-BY-1000 ROUNDED =                             08292272
082917             WS-IN-TY-COMP-MTD-SALES / 1000.                      08292366
082918     MOVE PV-DIV-BY-1000     TO DL3-MTD-SALES (PV-PAGE-LINE).     08292472
082919     IF WS-IN-LY-COMP-MTD-SALES = 0                               08292572
082920     OR WS-IN-TY-COMP-MTD-SALES = 0                               08292672
082921        MOVE '    N/A'      TO DL3-MTD-PCT-NA (PV-PAGE-LINE)      08292772
082922     ELSE                                                         08292872
082923        COMPUTE PV-PCT-CHANGE =                                   08292972
082924            ((WS-IN-TY-COMP-MTD-SALES -                           08293072
082925              WS-IN-LY-COMP-MTD-SALES)                            08293172
082926               / WS-IN-LY-COMP-MTD-SALES)     *  100              08293200
082927           ON SIZE ERROR                                          08293300
082928               MOVE 9999.9  TO PV-PCT-CHANGE                      08293400
082929        END-COMPUTE                                               08293572
082930        COMPUTE DL3-MTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        08293672
082931               PV-PCT-CHANGE * 1                                  08293755
082932     END-IF.                                                      08293872
082933     IF WS-IN-LY-COMP-YTD-SALES = 0                               08293972
082934     OR WS-IN-TY-COMP-YTD-SALES = 0                               08294072
082935        MOVE '    N/A'    TO DL3-YTD-PCT-NA(PV-PAGE-LINE)         08294172
082936     ELSE                                                         08294272
082937        COMPUTE PV-PCT-CHANGE =                                   08294372
082938           ((WS-IN-TY-COMP-YTD-SALES -                            08294472
082939             WS-IN-LY-COMP-YTD-SALES)                             08294572
082940           / WS-IN-LY-COMP-YTD-SALES)     *  100                  08294672
082941           ON SIZE ERROR                                          08294700
082942              MOVE 9999.9  TO PV-PCT-CHANGE                       08294872
082943        END-COMPUTE                                               08294972
082944        COMPUTE DL3-YTD-PCT-CHANGE(PV-PAGE-LINE) ROUNDED =        08295072
082945               PV-PCT-CHANGE * 1                                  08295155
082946     END-IF.                                                      08295272
082947     MOVE SPACES       TO DL3-TY-TOTAL-SALES-X(PV-PAGE-LINE).     08295372
082949                                                                  08295500
082950******************************************************************08295600
082951* FORMAT THE REGN NAME AND ALL / COMP LITERAL                     08295702
082952******************************************************************08295800
082953                                                                  08296000
082974                                                                  08299104
082980******************************************************************08299204
083000* WRITE THE PAGE WHEN IT IS FULL (AT END OF JOB, A PARTIAL PAGE   08299304
083100* WILL BE WRITTEN.                                                08300000
083200******************************************************************08310000
083300 3000-WRITE-PAGE.                                                 08320000
083400                                                                  08330000
083500     MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    08340000
083600                                                                  08350000
083700     WRITE REPORT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS      08360000
083800          AFTER ADVANCING PAGE.                                   08370000
083900                                                                  08380000
084000     ADD 1 TO PV-PAGE-COUNT.                                      08390000
084100                                                                  08400000
WEEK53     IF CC-53-WEEK-IND = '53'                                     08410000
WEEK53**       FISCAL (NORMAL) VERSION OF REPORT WILL BE BLANK          08411000
WEEK53         STRING '(COMPARE TO CALENDAR DAY '                       08412000
WEEK53                 WS-IN-LY-SAME-FISCAL-DATE (6:2)                  08412100
WEEK53                 '/'                                              08412200
WEEK53                 WS-IN-LY-SAME-FISCAL-DATE (9:2)                  08412300
WEEK53                 '/'                                              08412400
WEEK53                 WS-IN-LY-SAME-FISCAL-DATE (1:4)                  08412500
WEEK53                 ')'                                              08412600
WEEK53             DELIMITED BY SIZE INTO HL-CALENDAR-LITERAL           08412700
WEEK53         END-STRING                                               08412800
WEEK53     END-IF.                                                      08412900
084100                                                                  08413000
084200     WRITE REPORT-RECORD FROM HL-HDR1 AFTER 1.                    08414000
084300     WRITE REPORT-RECORD FROM HL-HDR2 AFTER 1.                    08415000
084400     WRITE REPORT-RECORD FROM HL-HDR3 AFTER 1.                    08416000
084500                                                                  08417000
084600     PERFORM                                                      08418000
084700       VARYING PV-DATA-COUNT FROM 1 BY 1                          08419000
084800         UNTIL PV-DATA-COUNT > 95                                 08420000
084900           WRITE REPORT-RECORD FROM DL-DETAIL-LINE(PV-DATA-COUNT) 08430000
085000           AFTER 1                                                08440000
085100     END-PERFORM.                                                 08450000
085200                                                                  08460000
085302     MOVE SPACES           TO REPORT-RECORD (1:68).               08500017
085302     MOVE '**** CONFIDENTIAL - NOT TO BE COPIED OR DISCLOSED ****'08500117
085304                           TO REPORT-RECORD (71:57).              08500217
085302     MOVE SPACES           TO REPORT-RECORD (129:39).             08500317
085302     MOVE 'LY $ (MIL) APPEAR TO THE LEFT OF STORE NAME'           08501017
085304                           TO REPORT-RECORD (168:45).             08510017
085310     WRITE REPORT-RECORD  AFTER 1.                                08520000
085400                                                                  08530000
085500     MOVE SPACES    TO  DL-DETAIL-LINE-TABLE.                     08540000
085600                                                                  08550000
085700     MOVE 1 TO PV-DATA-COUNT.                                     08560000
085800                                                                  08570000
085900                                                                  08580000
086000******************************************************************08590000
086100* ABEND ROUTINE                                                   08600000
086200******************************************************************08610000
086300 8000-ABEND.                                                      08620000
086400                                                                  08630000
086500     PERFORM 9000-END-OF-JOB.                                     08640000
086600                                                                  08650000
086700     CALL 'ILBOABN0' USING ABEND-CODE.                            08660000
086800                                                                  08670000
086900                                                                  08680000
087000******************************************************************08690000
087100* PERFORMS TASK TERMINATION PROCESSING                            08700000
087200******************************************************************08710000
087300 9000-END-OF-JOB.                                                 08720000
087400                                                                  08730000
087500     CLOSE CTLCD-DATE-FILE                                        08740000
087600           INPUT-EXTRACT-FILE                                     08750000
087700           REPORT-FILE.                                           08760000
087800                                                                  08770000
087900     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 08780000
088000                                                                  08790000
088100     MOVE SYS-TIME (1:2) TO ST-END-HR.                            08800000
088200     MOVE SYS-TIME (3:2) TO ST-END-MN.                            08810000
088300                                                                  08820000
088400     DISPLAY '                    '.                              08830000
088500     DISPLAY '**********************'.                            08840000
088600     DISPLAY '   SSKRP027 CONTROLS  '.                            08850000
088700     DISPLAY '**********************'.                            08860000
088800     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         08870000
088900     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          08880000
089000     DISPLAY 'END TIME  = ' ST-END-TIME.                          08890000
089100     DISPLAY '======================'.                            08900000
089200     DISPLAY 'CNTL CARD: ' CC-CONTROL-CARD.                       08910000
WEEK53     DISPLAY 'CONTROL CARD 53 WEEK IND: ' CC-53-WEEK-IND.         08920000
089300     DISPLAY '            '.                                      08930000
089400     DISPLAY 'INPUT RECORDS READ = ' PA-INPUT-READ.               08940000
089500     DISPLAY '                    '.                              08950000
089600                                                                  08960000
089700                                                                  08970000
