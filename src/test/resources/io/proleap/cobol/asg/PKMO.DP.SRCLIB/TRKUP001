000100**********************************************************        00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300**********************************************************        00030000
000400 PROGRAM-ID.      TRKUP001.                                       00040000
000500 AUTHOR.          ZAR MATIC. STRATAGEM.                           00050000
000600 DATE-WRITTEN.    01/12/93.                                       00060000
000700*                                                                 00070000
000800******************************************************************00080000
000900* PURPOSE. TO CREATE A FILE OF PURCAHSE ORDERS FROM AN EXTRACT   *00090000
001000*          OF THE PURCHASE ORDER MANAGEMENT DATABASE FOR EDI     *00100000
001100*          TRANSMISSION TO CARRIERS.                             *00110000
001200*                                                                *00120000
001300*                                                                *00130000
001400* MAINTENANCE:                                                   *00140000
001500*          STOPPED THE PROGRAM FROM SENDING 'D' RECORDS FOR POS  *00150000
001600*          PURGED OFF KOHLS SYSTEM TO CARRIER BASED ON TWO       *00160000
001700*          ASSUMPTIONS: A) THESE POS WILL HAVE STATUS CHANGED    *00170000
001800*          FROM ACTIVE BEFORE BEING PURGED. ANY INACTIVE POS WILL*00180000
001900*          HAVE A 'D' RECORD SENT TO CARRIER. B) EVEN IF THE PO'S*00190000
002000*          STATUS REMAINS ACTIVE, THE PO'S CANCELATION DATE MUST *00200000
002100*          HAVE LONG PASSED. CARRIERS WILL PURGE PO'S OUT OF     *00210000
002200*          THEIR SYSTEM AFTER 30 TO 60 DAYS PASS CACELATION DATE.*00220000
002300*          THIS CHANGE WAS NECESSITATED BY MISSING POS FROM THE  *00230000
002400*          CARRIERS DATABASE. WE MISTAKENLY SENT  'D' RECORDS    *00240000
002500*          FOR ACTIVE POS.  6/16/93 SHENG TSANG                  *00250000
002600*                                                               .*00260000
002700* 07/26/93 TKMA114 - JEAN SEKULA                                  00270000
002800*          CHECK WHEN A PO IS CANCELLED AND SEND A STATUS "08"    00280000
002900*          WITH TODAY'S DATE.                                    *00290000
003000*                                                               .*00300000
003100*          CORRECT THE LAST SHIPPING DATE TO USE EITHER THE       00310000
003200*          CANCEL DATE OR THE EXTENDED CANCEL DATE FROM THE PO   *00320000
003300*          DATABASE.                                              00330000
003400* 08/09/93 TKMA114 - JEAN SEKULA                                  00340000
003500*          REMOVE THE LOGIC TO SEND A PURCHASE ORDER 30 DAYS IN   00350000
003600*          ADVANCE OF ITS SHIPPING DATE.  INSTEAD, SEND A PO     *00360000
003700*          WHEN IT HAS BEEN ADDED TO THE FILE.  SEND A CHANGE    *00370000
003800*          WHEN THE PURCHASE ORDERS RECORD IS DIFFERENT THAN THE  00380000
003900*          PREVIOUS RUN.  AND SEND A DELETE WHEN A PURCHASE ORDER*00390000
004000*          IS ON THE PREVIOUS RUN'S FILE  BUT NOT THE CURRENT'S.  00400000
004100* 12/03/93 TKMA089 - DAN HINTZ                                   *00410000
004200*          CORRECTED EOF FILE PROCESSING IN THE PROGRAM.  WHEN   *00420000
004300*          EITHER THE CURRENT PO EXTRACT FILE OR THE PREVIOUS    *00430000
004400*          PO EXTRACT FILE REACHES EOF, I MOVE HIGH VALUES TO THE*00440000
004500*          PO NUMBER KEY FOR THAT FILE.  THIS WAY WE CAN HANDLE  *00450000
004600*          THE SITUATION WHERE ONE FILE MAY CONTAIN MORE PO'S    *00460000
004700*          THAN THE OTHER FILE.                                  *00470000
004800* 05/25/97 TKMA216 - MARY SARDINA                                *00480000
004900*          CHANGED TO MOVE THE AD DATE (TR009-DT-EDI-AD-DATE) *   00490001
005000*          TO THE OUPUT FILE WHENEVER IT IS AN ADV RECORD. *      00500001
005100*          CREATED COPY BOOKS TRRD009, TRRD010, AND TRRD011. *    00510001
001300* 11/21/14 TKMAJC7 - PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)         *00520006
001300*          CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF PO#  *00530001
001300*          FROM 7 DIGITS TO 8 DIGITS.  TAGGED WITH *PS 11/21/2014*00540005
005200******************************************************************00550000
005300*                                                                 00560000
005400**********************************************************        00570000
005500 ENVIRONMENT DIVISION.                                            00580000
005600**********************************************************        00590000
005700 CONFIGURATION SECTION.                                           00600000
005800 SOURCE-COMPUTER. IBM-3090.                                       00610000
005900 OBJECT-COMPUTER. IBM-3090.                                       00620000
006000                                                                  00630000
006100 INPUT-OUTPUT SECTION.                                            00640000
006200 FILE-CONTROL.                                                    00650000
006300                                                                  00660000
006400     SELECT SHIP-INFO-CURR-FILE                                   00670000
006500         ASSIGN                       TO INP01.                   00680000
006600                                                                  00690000
006700     SELECT SHIP-INFO-PREV-FILE                                   00700000
006800         ASSIGN                       TO INP02.                   00710000
006900                                                                  00720000
007000     SELECT CONTROL-FILE                                          00730000
007100         ASSIGN                       TO UPD01.                   00740000
007200                                                                  00750000
007300     SELECT EDI-TRANS-FILE                                        00760000
007400         ASSIGN                       TO OUT01.                   00770000
007500                                                                  00780000
007600     SELECT PRINT-FILE                                            00790000
007700         ASSIGN                       TO RPT01.                   00800000
007800                                                                  00810000
007900**********************************************************        00820000
008000 DATA DIVISION.                                                   00830000
008100**********************************************************        00840000
008200 FILE SECTION.                                                    00850000
008300                                                                  00860000
008400 FD  SHIP-INFO-CURR-FILE                                          00870000
008500     RECORDING MODE F                                             00880000
008600     BLOCK CONTAINS 0 RECORDS                                     00890000
008600*PS 11/21/2014 CHANGE STARTS                                      00900005
008700     RECORD CONTAINS  50 CHARACTERS                               00910004
008800     LABEL RECORDS ARE STANDARD                                   00920000
008900     DATA RECORD IS SHIP-INFO-CURR-REC.                           00930000
009000 01  SHIP-INFO-CURR-REC                  PIC X(050).              00940004
008600*PS 11/21/2014 CHANGE ENDS                                        00950005
009100                                                                  00960000
009200                                                                  00970000
009300 FD  SHIP-INFO-PREV-FILE                                          00980000
009400     RECORDING MODE F                                             00990000
009500     BLOCK CONTAINS 0 RECORDS                                     01000000
008600*PS 11/21/2014 CHANGE STARTS                                      01010005
009600     RECORD CONTAINS  50 CHARACTERS                               01020004
009700     LABEL RECORDS ARE STANDARD                                   01030000
009800     DATA RECORD IS SHIP-INFO-PREV-REC.                           01040000
009900 01  SHIP-INFO-PREV-REC                  PIC X(050).              01050004
008600*PS 11/21/2014 CHANGE ENDS                                        01060005
010000                                                                  01070000
010100                                                                  01080000
010200 FD  CONTROL-FILE                                                 01090000
010300     RECORDING MODE F                                             01100000
010400     BLOCK CONTAINS 0 RECORDS                                     01110000
010500     RECORD CONTAINS 80 CHARACTERS                                01120000
010600     LABEL RECORDS ARE STANDARD                                   01130000
010700     DATA RECORD IS CONTROL-RECORD.                               01140000
010800 01  CONTROL-REC                         PIC X(080).              01150000
010900                                                                  01160000
011000                                                                  01170000
011100 FD  EDI-TRANS-FILE                                               01180000
011200     RECORDING MODE F                                             01190000
011300     RECORD CONTAINS 132 CHARACTERS                               01200000
011400     DATA RECORD IS MERCH-PLAN-REC.                               01210000
011500 01  EDI-TRANS-REC                       PIC X(132).              01220000
011600                                                                  01230000
011700                                                                  01240000
011800 FD  PRINT-FILE                                                   01250000
011900     RECORDING MODE F                                             01260000
012000     BLOCK CONTAINS 0 RECORDS                                     01270000
012100     RECORD CONTAINS 132 CHARACTERS                               01280000
012200     LABEL RECORDS ARE OMITTED                                    01290000
012300     DATA RECORD IS PRINT-RECORD.                                 01300000
012400 01  PRINT-RECORD                        PIC X(132).              01310000
012500                                                                  01320000
012600/                                                                 01330000
012700 WORKING-STORAGE SECTION.                                         01340000
012800                                                                  01350000
012900                                                                  01360000
013000*                                                                 01370000
013100*  STANDARD HEADER LINE - KOHLS 132 COL                           01380000
013200*                                                                 01390000
013300     COPY DPWS132O.                                               01400000
013400                                                                  01410000
013500 01  CD-CPU-DATE.                                                 01420000
013600     05  CD-CPU-DATE-YY               PIC 9(2)       VALUE ZEROS. 01430000
013700     05  CD-CPU-DATE-MM               PIC 9(2)       VALUE ZEROS. 01440000
013800     05  CD-CPU-DATE-DD               PIC 9(2)       VALUE ZEROS. 01450000
013900                                                                  01460000
014000 01  CT-CPU-TIME.                                                 01470000
014100     05  CD-CPU-TIME-HH               PIC 9(2)       VALUE ZEROS. 01480000
014200     05  CD-CPU-TIME-MM               PIC 9(2)       VALUE ZEROS. 01490000
014300     05  CD-CPU-TIME-SS               PIC 9(2)       VALUE ZEROS. 01500000
014400     05  CD-CPU-TIME-HS               PIC 9(2)       VALUE ZEROS. 01510000
014500                                                                  01520000
014600 01  PA-PROGRAM-ACCUMULATORS.                                     01530000
014700     05  PA-LINE-CNT                  PIC S9(3)      VALUE +99    01540000
014800                                                     COMP-3.      01550000
014900     05  PA-PAGE-CNT                  PIC 9(3)       VALUE ZEROS  01560000
015000                                                     COMP-3.      01570000
015100     05  PA-EDI-SENT-CNT              PIC 9(6)       VALUE ZEROS  01580000
015200                                                     COMP-3.      01590000
015300     05  PA-PREV-READ-CNT             PIC 9(7)       VALUE ZEROS  01600000
015400                                                     COMP-3.      01610000
015500     05  PA-CURR-READ-CNT             PIC 9(7)       VALUE ZEROS  01620000
015600                                                     COMP-3.      01630000
015700                                                                  01640000
015800                                                                  01650000
015900 01  PC-PROGRAM-CONTROLS.                                         01660000
016000     05  PC-LINE-MAX                  PIC S9(3)      VALUE +48    01670000
016100                                                     COMP-3.      01680000
016200     05  PC-H                         PIC X          VALUE 'H'.   01690000
016300     05  PC-3-STATUS-ACTIVE           PIC X          VALUE '3'.   01700000
016400     05  PC-4-STATUS-CANCEL           PIC X          VALUE '4'.   01710000
016500     05  PC-A                         PIC X          VALUE 'A'.   01720000
016600     05  PC-D                         PIC X          VALUE 'D'.   01730000
016700     05  PC-ADV                       PIC XXX        VALUE 'ADV'. 01740000
016800     05  PC-04                        PIC XX         VALUE '04'.  01750000
016900     05  PC-05                        PIC XX         VALUE '05'.  01760000
017000     05  PC-08                        PIC XX         VALUE '08'.  01770000
017100     05  PC-T                         PIC X          VALUE 'T'.   01780000
017200     05  PC-HEX-15                    PIC X          VALUE X'15'. 01790000
017300                                                                  01800000
017400 01  PS-PROGRAM-SWITCHES.                                         01810000
017500     05  PS-SHIP-INFO-CURR-EOF-SW     PIC X(01)      VALUE 'N'.   01820000
017600         88  PS-SHIP-INFO-CURR-EOF                   VALUE 'Y'.   01830000
017700                                                                  01840000
017800     05  PS-SHIP-INFO-PREV-EOF-SW     PIC X(01)      VALUE 'N'.   01850000
017900         88  PS-SHIP-INFO-PREV-EOF                   VALUE 'Y'.   01860000
018000                                                                  01870000
018100     05  PS-READ-CURR-FILE-SW         PIC X(01)      VALUE 'N'.   01880000
018200         88 PS-NOT-READ-CURR-FILE                    VALUE 'N'.   01890000
018300         88 PS-READ-CURR-FILE                        VALUE 'Y'.   01900000
018400                                                                  01910000
018500     05  PS-READ-PREV-FILE-SW         PIC X(01)      VALUE 'N'.   01920000
018600         88 PS-NOT-READ-PREV-FILE                    VALUE 'N'.   01930000
018700         88 PS-READ-PREV-FILE                        VALUE 'Y'.   01940000
018800                                                                  01950000
018900     05  PS-PO-SEND-EDI-TYPE-SW       PIC X(01)      VALUE ' '.   01960000
019000         88  PS-PO-NOT-SEND-EDI                      VALUE ' '.   01970000
019100         88  PS-PO-SEND-EDI-ADD                      VALUE 'A'.   01980000
019200         88  PS-PO-SEND-EDI-CHG                      VALUE 'C'.   01990000
019300         88  PS-PO-SEND-EDI-DEL                      VALUE 'D'.   02000000
019400                                                                  02010000
019500     05  PS-PO-SENT-PREVIOUS-SW       PIC X(01)      VALUE ' '.   02020000
019600         88  PS-PO-NOT-SENT-PREVIOUS                 VALUE ' '.   02030000
019700         88  PS-PO-SENT-PREVIOUS                     VALUE 'Y'.   02040000
019800/                                                                 02050000
019900 01  PW-PROGRAM-WORKAREA.                                         02060000
020000     05  PW-SLS-COMP-BY-DEPT-LINE     PIC X(132)     VALUE SPACE. 02070000
020100                                                                  02080000
020200     05  PW-CONTROL-CARD.                                         02090000
020300         10  PW-CC-PGM-NAME           PIC X(8)       VALUE SPACE. 02100000
020400         10  FILLER                   PIC X          VALUE SPACE. 02110000
020500         10  PW-CC-DAYS-B4-EARLY-SHIP-X PIC X(3)     VALUE SPACE. 02120000
020600         10  PW-CC-DAYS-B4-EARLY-SHIP REDEFINES                   02130000
020700                                       PW-CC-DAYS-B4-EARLY-SHIP-X 02140000
020800                                      PIC 9(3).                   02150000
020900         10  FILLER                   PIC X          VALUE SPACE. 02160000
021000         10  PW-CNTL-CALENDAR-TYPE    PIC X(2)       VALUE ZEROS. 02170000
021100         10  FILLER                   PIC X          VALUE SPACE. 02180000
021200         10  PW-CC-PREV-RUN-DATE-X    PIC X(8)       VALUE ZEROS. 02190000
021300         10  PW-CC-PREV-RUN-DATE REDEFINES PW-CC-PREV-RUN-DATE-X  02200000
021400                                      PIC 9(8).                   02210000
021500         10  FILLER                   PIC X          VALUE SPACE. 02220000
021600         10  PW-CC-PREV-B4-EARLY-SHIP-X PIC X(3)     VALUE SPACE. 02230000
021700         10  PW-CC-PREV-B4-EARLY-SHIP REDEFINES                   02240000
021800                                       PW-CC-PREV-B4-EARLY-SHIP-X 02250000
021900                                      PIC 9(3).                   02260000
022000         10  FILLER                   PIC X          VALUE SPACE. 02270000
022100         10  PW-CC-FIRST-RUN-DATE-X   PIC X(8)       VALUE SPACE. 02280000
022200         10  PW-CC-FIRST-RUN-DATE     REDEFINES                   02290000
022300                                       PW-CC-FIRST-RUN-DATE-X     02300000
022400                                      PIC 9(8).                   02310000
022500         10  FILLER                   PIC X(43)      VALUE SPACE. 02320000
022600                                                                  02330000
022700     05  PW-CURR-RUN-DATE.                                        02340000
022800         10  PW-CURR-DATE-CC          PIC 9(2)       VALUE ZEROS. 02350000
022900         10  PW-CURR-DATE-YY          PIC 9(2)       VALUE ZEROS. 02360000
023000         10  PW-CURR-DATE-MM          PIC 9(2)       VALUE ZEROS. 02370000
023100         10  PW-CURR-DATE-DD          PIC 9(2)       VALUE ZEROS. 02380000
023200                                                                  02390000
023300     05  PW-CURR-RUN-DATE-FUT.                                    02400000
023400         10  PW-CURR-FUT-DATE-CC      PIC 9(2)       VALUE ZEROS. 02410000
023500         10  PW-CURR-FUT-DATE-YY      PIC 9(2)       VALUE ZEROS. 02420000
023600         10  PW-CURR-FUT-DATE-MM      PIC 9(2)       VALUE ZEROS. 02430000
023700         10  PW-CURR-FUT-DATE-DD      PIC 9(2)       VALUE ZEROS. 02440000
023800                                                                  02450000
023900     05  PW-PREV-RUN-DATE-FUT.                                    02460000
024000         10  PW-PREV-FUT-ATE-CC       PIC 9(2)       VALUE ZEROS. 02470000
024100         10  PW-PREV-FUT-ATE-YY       PIC 9(2)       VALUE ZEROS. 02480000
024200         10  PW-PREV-FUT-ATE-MM       PIC 9(2)       VALUE ZEROS. 02490000
024300         10  PW-PREV-FUT-ATE-DD       PIC 9(2)       VALUE ZEROS. 02500000
024400                                                                  02510000
024500     05  PW-EARLY-SHIP-CCYYMMDD.                                  02520000
024600         10  PW-EARLY-SHIP-CC         PIC 9(2)       VALUE ZEROS. 02530000
024700         10  PW-EARLY-SHIP-YYMMDD.                                02540000
024800             15  PW-EARLY-SHIP-YY     PIC 9(2)       VALUE ZEROS. 02550000
024900             15  PW-EARLY-SHIP-MM     PIC 9(2)       VALUE ZEROS. 02560000
025000             15  PW-EARLY-SHIP-DD     PIC 9(2)       VALUE ZEROS. 02570000
025100                                                                  02580000
025200     05  PW-ADV-DATE-CCYYMMDD.                                    02590000
025300         10  PW-ADV-DATE-CC           PIC 9(2)       VALUE ZEROS. 02600000
025400         10  PW-ADV-DATE-YYMMDD.                                  02610000
025500             15  PW-ADV-DATE-YY       PIC 9(2)       VALUE ZEROS. 02620000
025600             15  PW-ADV-DATE-MM       PIC 9(2)       VALUE ZEROS. 02630000
025700             15  PW-ADV-DATE-DD       PIC 9(2)       VALUE ZEROS. 02640000
025800                                                                  02650000
025900     05  PW-PROCESS-DATE.                                         02660000
026000         10  PW-PROCESS-DATE-CC      PIC  X(02).                  02670000
026100         10  PW-PROCESS-DATE-YY      PIC  X(02).                  02680000
026200         10  FILLER                  PIC  X(01) VALUE '-'.        02690000
026300         10  PW-PROCESS-DATE-MM      PIC  X(02).                  02700000
026400         10  FILLER                  PIC  X(01) VALUE '-'.        02710000
026500         10  PW-PROCESS-DATE-DD      PIC  X(02).                  02720000
026600     05  PW-PROCESS-DATE-R REDEFINES PW-PROCESS-DATE              02730000
026700                                      PIC X(10).                  02740000
026800                                                                  02750000
026900                                                                  02760000
027000     COPY TRRD009.                                                02770000
027100     COPY TRRD010.                                                02780000
027200     COPY TRRD011.                                                02790000
027300/                                                                 02800000
027400 01  PRINT-DATA.                                                  02810000
027500     05  PR-PRINT-H1.                                             02820000
027600         10 FILLER           PIC X(29) VALUE ALL '*'.             02830000
027700                                                                  02840000
027800         10 FILLER           PIC X(6) VALUE ' PREV '.             02850000
027900                                                                  02860000
028000         10 FILLER           PIC X(18) VALUE ALL '*'.             02870000
028100         10 FILLER           PIC X(3) VALUE SPACES.               02880000
028200         10 FILLER           PIC X(29) VALUE ALL '*'.             02890000
028300                                                                  02900000
028400         10 FILLER           PIC X(6) VALUE ' CURR '.             02910000
028500                                                                  02920000
028600         10 FILLER           PIC X(18) VALUE ALL '*'.             02930000
028700         10 FILLER           PIC X(23) VALUE SPACES.              02940000
028800                                                                  02950000
028900     05  PR-PRINT-H2.                                             02960000
029000*PS 11/21/2014 CHANGE STARTS                                      02970005
029000         10 FILLER           PIC X(9) VALUE ' PO NUMB '.          02980002
029100         10 FILLER           PIC X(1) VALUE SPACES.               02990002
029000*PS 11/21/2014 CHANGE ENDS                                        03000005
029200         10 FILLER           PIC X    VALUE 'S'.                  03010000
029300         10 FILLER           PIC X(2) VALUE SPACES.               03020000
029400         10 FILLER           PIC X(4) VALUE 'DEPT'.               03030000
029500         10 FILLER           PIC X(3) VALUE SPACES.               03040000
029600         10 FILLER           PIC X(6) VALUE 'E SHIP'.             03050000
029700         10 FILLER           PIC X(3) VALUE SPACES.               03060000
029800         10 FILLER           PIC X(6) VALUE 'CANCEL'.             03070000
029900         10 FILLER           PIC X(3) VALUE SPACES.               03080000
030000         10 FILLER           PIC X(6) VALUE 'ADVERT'.             03090000
030100         10 FILLER           PIC X(3) VALUE SPACES.               03100000
030200         10 FILLER           PIC X(6) VALUE 'CANEX '.             03110000
030300         10 FILLER           PIC X(3) VALUE '   '.                03120000
029000*PS 11/21/2014 CHANGE STARTS                                      03130005
030400         10 FILLER           PIC X(9) VALUE 'PO NUMB'.            03140002
030500         10 FILLER           PIC X(1) VALUE SPACES.               03150002
029000*PS 11/21/2014 CHANGE ENDS                                        03160005
030600         10 FILLER           PIC X    VALUE 'S'.                  03170000
030700         10 FILLER           PIC X(2) VALUE SPACES.               03180000
030800         10 FILLER           PIC X(4) VALUE 'DEPT'.               03190000
030900         10 FILLER           PIC X(3) VALUE SPACES.               03200000
031000         10 FILLER           PIC X(6) VALUE 'E SHIP'.             03210000
031100         10 FILLER           PIC X(3) VALUE SPACES.               03220000
031200         10 FILLER           PIC X(6) VALUE 'CANCEL'.             03230000
031300         10 FILLER           PIC X(3) VALUE SPACES.               03240000
031400         10 FILLER           PIC X(6) VALUE 'ADVERT'.             03250000
031500         10 FILLER           PIC X(3) VALUE SPACES.               03260000
031600         10 FILLER           PIC X(6) VALUE 'CANEX '.             03270000
031700         10 FILLER           PIC X(4) VALUE SPACES.               03280000
031800         10 FILLER           PIC X(5) VALUE 'SENT '.              03290000
031900         10 FILLER           PIC X(18) VALUE SPACES.              03300000
032000                                                                  03310000
032100     05  PR-PRINT-H3.                                             03320000
032200*PS 11/21/2014 CHANGE STARTS                                      03330005
032200         10 FILLER           PIC X(9) VALUE '---------'.          03340002
032300         10 FILLER           PIC X(1) VALUE SPACES.               03350002
032200*PS 11/21/2014 CHANGE ENDS                                        03360005
032400         10 FILLER           PIC X    VALUE '-'.                  03370000
032500         10 FILLER           PIC X(2) VALUE SPACES.               03380000
032600         10 FILLER           PIC X(4) VALUE '----'.               03390000
032700         10 FILLER           PIC X(3) VALUE SPACES.               03400000
032800         10 FILLER           PIC X(6) VALUE '------'.             03410000
032900         10 FILLER           PIC X(3) VALUE SPACES.               03420000
033000         10 FILLER           PIC X(6) VALUE '------'.             03430000
033100         10 FILLER           PIC X(3) VALUE SPACES.               03440000
033200         10 FILLER           PIC X(6) VALUE '------'.             03450000
033300         10 FILLER           PIC X(3) VALUE SPACES.               03460000
033400         10 FILLER           PIC X(6) VALUE '------'.             03470000
033500         10 FILLER           PIC X(3) VALUE '   '.                03480000
032200*PS 11/21/2014 CHANGE STARTS                                      03490005
033600         10 FILLER           PIC X(9) VALUE '-------'.            03500002
033700         10 FILLER           PIC X(1) VALUE SPACES.               03510002
032200*PS 11/21/2014 CHANGE ENDS                                        03520005
033800         10 FILLER           PIC X    VALUE '-'.                  03530000
033900         10 FILLER           PIC X(2) VALUE SPACES.               03540000
034000         10 FILLER           PIC X(4) VALUE '----'.               03550000
034100         10 FILLER           PIC X(3) VALUE SPACES.               03560000
034200         10 FILLER           PIC X(6) VALUE '------'.             03570000
034300         10 FILLER           PIC X(3) VALUE SPACES.               03580000
034400         10 FILLER           PIC X(6) VALUE '------'.             03590000
034500         10 FILLER           PIC X(3) VALUE SPACES.               03600000
034600         10 FILLER           PIC X(6) VALUE '------'.             03610000
034700         10 FILLER           PIC X(3) VALUE SPACES.               03620000
034800         10 FILLER           PIC X(6) VALUE '------'.             03630000
034900         10 FILLER           PIC X(4) VALUE SPACES.               03640000
035000         10 FILLER           PIC X(5) VALUE '-----'.              03650000
035100         10 FILLER           PIC X(14) VALUE SPACES.              03660000
035200                                                                  03670000
035300/                                                                 03680000
035400 01  PR-SHIP-INFO-PRINT-REC.                                      03690000
035500     05  PR-SHIP-INFO-PREV-REC.                                   03700000
035600*PS 11/21/2014 CHANGE STARTS                                      03710005
035600         10 PR-PREV-POANUMBR PIC Z(9).                            03720001
035700         10 FILLER           PIC X(1) VALUE SPACES.               03730003
035600*PS 11/21/2014 CHANGE ENDS                                        03740005
035800         10 PR-PREV-POAPRSIN PIC X    VALUE SPACES.               03750000
035900         10 FILLER           PIC X(2) VALUE SPACES.               03760000
036000         10 PR-PREV-POADPTNO PIC X(4) VALUE SPACES.               03770000
036001         10 PR-PREV-POADPTNO-N REDEFINES                          03780000
036002            PR-PREV-POADPTNO PIC ZZZ9.                            03790000
036100         10 FILLER           PIC X(3) VALUE SPACES.               03800000
036200         10 PR-PREV-POASHPDT PIC X(6) VALUE SPACES.               03810000
036300         10 FILLER           PIC X(3) VALUE SPACES.               03820000
036400         10 PR-PREV-POACANDT PIC X(6) VALUE SPACES.               03830000
036500         10 FILLER           PIC X(3) VALUE SPACES.               03840000
036600         10 PR-PREV-POAADVDT PIC X(6) VALUE SPACES.               03850000
036700         10 FILLER           PIC X(3) VALUE SPACES.               03860000
036800         10 PR-PREV-POACANEX PIC X(6) VALUE SPACES.               03870000
036900         10 FILLER           PIC X(3) VALUE SPACES.               03880000
037000     05  PR-SHIP-INFO-CURR-REC.                                   03890000
035600*PS 11/21/2014 CHANGE STARTS                                      03900005
037100         10 PR-CURR-POANUMBR PIC Z(9).                            03910001
037200         10 FILLER           PIC X(1) VALUE SPACES.               03920003
035600*PS 11/21/2014 CHANGE ENDS                                        03930005
037300         10 PR-CURR-POAPRSIN PIC X    VALUE SPACES.               03940000
037400         10 FILLER           PIC X(2) VALUE SPACES.               03950000
037500         10 PR-CURR-POADPTNO PIC X(4) VALUE SPACES.               03960000
037501         10 PR-CURR-POADPTNO-N REDEFINES                          03970000
037502            PR-CURR-POADPTNO PIC ZZZ9.                            03980000
037600         10 FILLER           PIC X(3) VALUE SPACES.               03990000
037700         10 PR-CURR-POASHPDT PIC X(6) VALUE SPACES.               04000000
037800         10 FILLER           PIC X(3) VALUE SPACES.               04010000
037900         10 PR-CURR-POACANDT PIC X(6) VALUE SPACES.               04020000
038000         10 FILLER           PIC X(3) VALUE SPACES.               04030000
038100         10 PR-CURR-POAADVDT PIC X(6) VALUE SPACES.               04040000
038200         10 FILLER           PIC X(3) VALUE SPACES.               04050000
038300         10 PR-CURR-POACANEX PIC X(6) VALUE SPACES.               04060000
038400         10 FILLER           PIC X(4) VALUE SPACES.               04070000
038500         10 PR-SENT          PIC X(5) VALUE SPACES.               04080000
038600         10 FILLER           PIC X(14) VALUE SPACES.              04090000
038700                                                                  04100000
038800                                                                  04110000
038900 01  ABEND-CODE                       PIC S9(04)     VALUE +0     04120000
039000                                                     COMP SYNC.   04130000
039100     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 04140000
039200     88  ABEND-4002-READ-ERROR                       VALUE +4002. 04150000
039300     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 04160000
039400     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 04170000
039500     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 04180000
039600     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 04190000
039700     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 04200000
039800     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 04210000
039900     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 04220000
040200     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 04230000
040300     88  ABEND-4019-DATE-ROUTINE                     VALUE +4019. 04240000
040400/                                                                 04250000
040500*                                                                 04260000
040600*  WORK AREA PASSED IN CALL TO DPKUT500                           04270000
040700*                                                                 04280000
040800     COPY DPWS500.                                                04290000
040900/                                                                 04300000
041000****************************************************************  04310000
041100 PROCEDURE DIVISION.                                              04320000
041200****************************************************************  04330000
041300                                                                  04340000
041400 0000-MAINLINE.                                                   04350000
041500     PERFORM 1000-INITIALIZE.                                     04360000
041600     PERFORM 2000-PROCESS-EDI-TRANMISSIONS.                       04370000
041700     PERFORM 3000-UPDATE-EDI-CTL-FILE.                            04380000
041800     PERFORM 4000-END-PROCESSING.                                 04390000
041900     STOP RUN.                                                    04400000
042000*0000-EXIT.  EXIT.                                                04410000
042100                                                                  04420000
042200                                                                  04430000
042300 1000-INITIALIZE.                                                 04440000
042400     PERFORM 1110-ACCEPT-CURR-DATE-TIME.                          04450000
042500                                                                  04460000
042600     OPEN INPUT  SHIP-INFO-CURR-FILE                              04470000
042700                 SHIP-INFO-PREV-FILE                              04480000
042800          I-O    CONTROL-FILE                                     04490000
042900          OUTPUT EDI-TRANS-FILE                                   04500000
043000                 PRINT-FILE.                                      04510000
043100                                                                  04520000
043200     PERFORM 1120-READ-EDI-CTL-RECORD.                            04530000
043300     PERFORM 1130-DATE-CALCULATIONS.                              04540000
043400                                                                  04550000
043500     MOVE 1                      TO DP132O-REPORT-NUMBER.         04560000
043600     MOVE 'TRKUP001'             TO DP132O-PROGRAM-NAME.          04570000
043700*1000-EXIT.  EXIT.                                                04580000
043800                                                                  04590000
043900                                                                  04600000
044000 1110-ACCEPT-CURR-DATE-TIME.                                      04610000
044100     ACCEPT CT-CPU-TIME FROM TIME.                                04620000
044200     MOVE CD-CPU-TIME-HH         TO DP132O-RUN-HOUR.              04630000
044300     MOVE CD-CPU-TIME-MM         TO DP132O-RUN-MINUTE.            04640000
044400                                                                  04650000
044500     ACCEPT CD-CPU-DATE FROM DATE.                                04660000
044600*    ACCEPT CD-CPU-DATE FROM SYSIN.                               04670000
044700     MOVE CD-CPU-DATE-MM         TO DP132O-RUN-MONTH              04680000
044800                                    PW-PROCESS-DATE-MM            04690000
044900                                    PW-CURR-DATE-MM.              04700000
045000     MOVE CD-CPU-DATE-DD         TO DP132O-RUN-DAY                04710000
045100                                    PW-PROCESS-DATE-DD            04720000
045200                                    PW-CURR-DATE-DD.              04730000
045300     MOVE CD-CPU-DATE-YY         TO DP132O-RUN-YEAR               04740000
045400                                    PW-PROCESS-DATE-YY            04750000
045500                                    PW-CURR-DATE-YY.              04760000
045600                                                                  04770000
045700     IF CD-CPU-DATE-YY > 85                                       04780000
045800         MOVE 19                 TO PW-PROCESS-DATE-CC            04790000
045900                                    PW-CURR-DATE-CC               04800000
046000     ELSE                                                         04810000
046100         MOVE 20                 TO PW-PROCESS-DATE-CC            04820000
046200                                    PW-CURR-DATE-CC               04830000
046300     END-IF.                                                      04840000
046400*1110-EXIT.  EXIT.                                                04850000
046500                                                                  04860000
046600                                                                  04870000
046700 1120-READ-EDI-CTL-RECORD.                                        04880000
046800     READ CONTROL-FILE                                            04890000
046900       INTO PW-CONTROL-CARD                                       04900000
047000          AT END                                                  04910000
047100             DISPLAY '*********** ABEND *****************'        04920000
047200             DISPLAY '**** PROGRAM TRKUP001 *************'        04930000
047300             DISPLAY '**** CONTROL CARD RECORD MISSING **'        04940000
047400             DISPLAY '**** PARA= 1120-READ-EDI-CTL-RECORD'        04950000
047500             MOVE +4003     TO ABEND-CODE                         04960000
047600             PERFORM 9000-ABEND                                   04970000
047700     END-READ.                                                    04980000
047800                                                                  04990000
047900     DISPLAY 'CONTROL CARD ====>' PW-CONTROL-CARD.                05000000
048000     DISPLAY ' '.                                                 05010000
048100*1120-EXIT.  EXIT.                                                05020000
048200                                                                  05030000
048300                                                                  05040000
048400 1130-DATE-CALCULATIONS.                                          05050000
048500     IF PW-CC-PREV-RUN-DATE-X = SPACES                            05060000
048600        MOVE PW-CURR-RUN-DATE   TO PW-CC-PREV-RUN-DATE            05070000
048700                                   PW-CC-FIRST-RUN-DATE           05080000
048800        MOVE ZERO               TO PW-CC-PREV-B4-EARLY-SHIP       05090000
048900     END-IF.                                                      05100000
049000                                                                  05110000
049100     INITIALIZE DPG51 DPG52 DPG53                                 05120000
049200                DPG54 DPG55 DPG56.                                05130000
049300     MOVE CD-CPU-DATE           TO DPG51-SYSTEM-DATE.             05140000
049400     MOVE PW-CNTL-CALENDAR-TYPE TO DPG51-CALENDAR-TYPE.           05150000
049500     SET  DPG51-INCREMENT-DATE  TO TRUE.                          05160000
049600     MOVE PW-CC-PREV-B4-EARLY-SHIP                                05170000
049700                                TO DPG51-INCR-DECR-DAYS-9.        05180000
049800*****     'CCYYMMDD  '                                            05190000
049900     SET  DPG52-LK-DTE-ISO      TO TRUE.                          05200000
050000     MOVE PW-CC-PREV-RUN-DATE   TO DPG52-DB2-ISO-DATE.            05210000
050100                                                                  05220000
050200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            05230000
050300         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               05240000
050400                                                                  05250000
050500     IF (DPG54-DATE-INVALID                                       05260000
050600     OR  DPG54-SEVERE-ERROR)                                      05270000
050700         DISPLAY '*** ABEND *** IN TRKUP001'                      05280000
050800         DISPLAY 'ERROR IN CALL TO DPKUT500'                      05290000
050900         DISPLAY DPG54-ERROR-MESSAGE                              05300000
051000         DISPLAY '**** PARA= 1130-DATE-CALCULATIONS-1'            05310000
051100         DISPLAY ' '                                              05320000
051200         DISPLAY 'DPG51=>'  DPG51                                 05330000
051300         DISPLAY 'DPG52=>'  DPG52                                 05340000
051400         DISPLAY 'DPG53=>'  DPG53                                 05350000
051500         DISPLAY 'DPG54=>'  DPG54                                 05360000
051600         DISPLAY 'DPG55=>'  DPG55                                 05370000
051700         DISPLAY 'DPG56=>'  DPG56                                 05380000
051800         MOVE +4019 TO ABEND-CODE                                 05390000
051900         PERFORM 9000-ABEND                                       05400000
052000     ELSE                                                         05410000
052100         MOVE DPG55-DB2-ISO-DATE TO PW-PREV-RUN-DATE-FUT          05420000
052200     END-IF.                                                      05430000
052300                                                                  05440000
052400                                                                  05450000
052500     INITIALIZE DPG51 DPG52 DPG53                                 05460000
052600                DPG54 DPG55 DPG56.                                05470000
052700     MOVE CD-CPU-DATE           TO DPG51-SYSTEM-DATE.             05480000
052800     MOVE PW-CNTL-CALENDAR-TYPE TO DPG51-CALENDAR-TYPE.           05490000
052900     SET  DPG51-INCREMENT-DATE  TO TRUE.                          05500000
053000     MOVE PW-CC-DAYS-B4-EARLY-SHIP                                05510000
053100                                TO DPG51-INCR-DECR-DAYS-9.        05520000
053200*****     'CCYYMMDD  '                                            05530000
053300     SET  DPG52-LK-DTE-ISO      TO TRUE.                          05540000
053400     MOVE PW-CURR-RUN-DATE      TO DPG52-DB2-ISO-DATE.            05550000
053500                                                                  05560000
053600     CALL DP500-KOHLS-CALENDAR-ROUTINE                            05570000
053700         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               05580000
053800                                                                  05590000
053900     IF (DPG54-DATE-INVALID                                       05600000
054000     OR  DPG54-SEVERE-ERROR)                                      05610000
054100         DISPLAY '*** ABEND *** IN TRKUP001'                      05620000
054200         DISPLAY 'ERROR IN CALL TO DPKUT500'                      05630000
054300         DISPLAY DPG54-ERROR-MESSAGE                              05640000
054400         DISPLAY '**** PARA= 1130-DATE-CALCULATIONS-2'            05650000
054500         DISPLAY ' '                                              05660000
054600         DISPLAY 'DPG51=>'  DPG51                                 05670000
054700         DISPLAY 'DPG52=>'  DPG52                                 05680000
054800         DISPLAY 'DPG53=>'  DPG53                                 05690000
054900         DISPLAY 'DPG54=>'  DPG54                                 05700000
055000         DISPLAY 'DPG55=>'  DPG55                                 05710000
055100         DISPLAY 'DPG56=>'  DPG56                                 05720000
055200         MOVE +4019 TO ABEND-CODE                                 05730000
055300         PERFORM 9000-ABEND                                       05740000
055400     ELSE                                                         05750000
055500         MOVE DPG55-DB2-ISO-DATE TO PW-CURR-RUN-DATE-FUT          05760000
055600     END-IF.                                                      05770000
055700                                                                  05780000
055800     DISPLAY 'PREV RUN DATE ====>' PW-CC-PREV-RUN-DATE.           05790000
055900     DISPLAY 'PREV RUN DATE FUT=>' PW-PREV-RUN-DATE-FUT.          05800000
056000     DISPLAY '                   '.                               05810000
056100     DISPLAY 'CURR RUN DATE ====>' PW-CURR-RUN-DATE               05820000
056200     DISPLAY 'CURR RUN DATE FUT=>' PW-CURR-RUN-DATE-FUT.          05830000
056300                                                                  05840000
056400****                                                              05850000
056500**** VERIFY THAT 'FIRST RUN DATE' IS A VALID DATE.                05860000
056600**** ALL OTHER CONTROL CARD PARAMETERS HAVE BEEN VALIDATED        05870000
056700**** ALREADY, IN THE NORMAL STREAM OF THIS PROGRAM.               05880000
056800****                                                              05890000
056900     INITIALIZE DPG51 DPG52 DPG53                                 05900000
057000                DPG54 DPG55 DPG56.                                05910000
057100     MOVE CD-CPU-DATE           TO DPG51-SYSTEM-DATE.             05920000
057200     MOVE PW-CNTL-CALENDAR-TYPE TO DPG51-CALENDAR-TYPE.           05930000
057300     SET  DPG51-DO-NOT-INCR-DECR-DATE                             05940000
057400                                TO TRUE.                          05950000
057500*****     'CCYYMMDD  '                                            05960000
057600     SET  DPG52-LK-DTE-ISO      TO TRUE.                          05970000
057700     MOVE PW-CC-FIRST-RUN-DATE  TO DPG52-DB2-ISO-DATE.            05980000
057800                                                                  05990000
057900     CALL DP500-KOHLS-CALENDAR-ROUTINE                            06000000
058000         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               06010000
058100                                                                  06020000
058200     IF (DPG54-DATE-INVALID                                       06030000
058300     OR  DPG54-SEVERE-ERROR)                                      06040000
058400         DISPLAY '*** ABEND *** IN TRKUP001'                      06050000
058500         DISPLAY 'ERROR IN CALL TO DPKUT500'                      06060000
058600         DISPLAY DPG54-ERROR-MESSAGE                              06070000
058700         DISPLAY '**** PARA= 1130-DATE-CALCULATIONS-3'            06080000
058800         DISPLAY ' '                                              06090000
058900         DISPLAY 'DPG51=>'  DPG51                                 06100000
059000         DISPLAY 'DPG52=>'  DPG52                                 06110000
059100         DISPLAY 'DPG53=>'  DPG53                                 06120000
059200         DISPLAY 'DPG54=>'  DPG54                                 06130000
059300         DISPLAY 'DPG55=>'  DPG55                                 06140000
059400         DISPLAY 'DPG56=>'  DPG56                                 06150000
059500         MOVE +4019 TO ABEND-CODE                                 06160000
059600         PERFORM 9000-ABEND                                       06170000
059700     END-IF.                                                      06180000
059800*1130-EXIT.  EXIT.                                                06190000
059900                                                                  06200000
060000                                                                  06210000
060100 2000-PROCESS-EDI-TRANMISSIONS.                                   06220000
060200     PERFORM 2010-READ-CURR-SHIP-INFO.                            06230000
060300     PERFORM 2020-READ-PREV-SHIP-INFO.                            06240000
060400                                                                  06250000
060500     PERFORM 2025-BUILD-HEADER.                                   06260000
060600                                                                  06270000
060700     PERFORM 2030-PROCESS-MATCH                                   06280000
060800       UNTIL PS-SHIP-INFO-CURR-EOF                                06290000
060900         AND PS-SHIP-INFO-PREV-EOF.                               06300000
061000                                                                  06310000
061100     PERFORM 2110-BUILD-TRAILER.                                  06320000
061200*2000-EXIT.  EXIT.                                                06330000
061300                                                                  06340000
061400                                                                  06350000
061500 2010-READ-CURR-SHIP-INFO.                                        06360000
061600     READ SHIP-INFO-CURR-FILE                                     06370000
061700        INTO TR011-SHIP-INFO-CURR-REC                             06380000
061800           AT END                                                 06390000
061900              SET PS-SHIP-INFO-CURR-EOF TO TRUE.                  06400000
062000                                                                  06410000
062100     IF PS-SHIP-INFO-CURR-EOF                                     06420000
062200        MOVE '<<<<< EOD >>>>' TO  PR-SHIP-INFO-CURR-REC           06430000
062300        MOVE HIGH-VALUES      TO  TR011-CURR-POANUMBR-X           06440000
062400     ELSE                                                         06450000
062500        ADD 1                 TO  PA-CURR-READ-CNT                06460000
062600     END-IF.                                                      06470000
062700*2010-EXIT.  EXIT.                                                06480000
062800                                                                  06490000
062900                                                                  06500000
063000 2020-READ-PREV-SHIP-INFO.                                        06510000
063100     READ SHIP-INFO-PREV-FILE                                     06520000
063200        INTO TR010-SHIP-INFO-PREV-REC                             06530000
063300           AT END                                                 06540000
063400              SET PS-SHIP-INFO-PREV-EOF TO TRUE.                  06550000
063500                                                                  06560000
063600     IF PS-SHIP-INFO-PREV-EOF                                     06570000
063700        MOVE '<<<<< EOD >>>>' TO  PR-SHIP-INFO-PREV-REC           06580000
063800        MOVE HIGH-VALUES      TO  TR010-PREV-POANUMBR-X           06590000
063900     ELSE                                                         06600000
064000        ADD 1                 TO  PA-PREV-READ-CNT                06610000
064100     END-IF.                                                      06620000
064200*2020-EXIT.  EXIT.                                                06630000
064300                                                                  06640000
064400                                                                  06650000
064500 2025-BUILD-HEADER.                                               06660000
064600     INITIALIZE TR009-PO-EDI-HEADER-REC.                          06670000
064700     MOVE PC-H                  TO TR009-HD-EDI-REC-TYPE.         06680000
064800     MOVE SPACES                TO TR009-HD-EDI-CUST-ID.          06690000
064900     MOVE PW-CURR-RUN-DATE      TO TR009-HD-EDI-CURR-DATE.        06700000
065000     MOVE CT-CPU-TIME           TO TR009-HD-EDI-CURR-TIME.        06710000
065100     MOVE SPACES                TO TR009-HD-EDI-FILLER            06720000
065200                                   TR009-HD-EDI-KOHLS-FILLER.     06730000
065300     MOVE PC-HEX-15             TO TR009-HD-EDI-KOHLS-HEX-51.     06740000
065400     PERFORM 2070-WRITE-EDI-RECORD.                               06750000
065500*2025-EXIT.  EXIT.                                                06760000
065600                                                                  06770000
065700                                                                  06780000
065800***********************************************************       06790000
065900* DETERMINE IF A PURCHASE ORDER WILL BE SENT AS AN ADD,           06800000
066000* CHANGE OR DELETE. THE INPUT TO THIS PROGRAM ONLY EXTRACTS       06810000
066100* PO'S WITH STATUS CODES OF 3,4 AND 5. ACTIVE, CANCELLED, AND     06820000
066200* COMPLETE RESPECTIVELY.                                          06830000
066300*                                                                 06840000
066400* ADD -     NEW PO - EXISTS ON CURRENT BUT NOT ON PREV            06850000
066500*           AND PO SHIP DATE IS GREATER THAN FIRST RUN DATE       06860000
066600*           TO AVOID SENDING REALLY OLD PURCHASE ORDERS.          06870000
066700*                                                                 06880000
066800* CHG -     CURR AND PREV PO NUMBERS MATCH                        06890000
066900*           AND CURR AND PREV RECORDS ARE DIFFERENT               06900000
067000*                                                                 06910000
067100* DEL -     PREV PO BUT NO CURR PO                                06920000
067200***********************************************************       06930000
067300 2030-PROCESS-MATCH.                                              06940000
067400     SET PS-PO-NOT-SEND-EDI     TO TRUE.                          06950000
067500     SET PS-NOT-READ-CURR-FILE  TO TRUE.                          06960000
067600     SET PS-NOT-READ-PREV-FILE  TO TRUE.                          06970000
067700                                                                  06980000
067800     IF  NOT PS-SHIP-INFO-PREV-EOF                                06990000
067900     AND NOT PS-SHIP-INFO-CURR-EOF                                07000000
068000     AND TR010-PREV-POANUMBR = TR011-CURR-POANUMBR                07010000
068100         SET PS-READ-CURR-FILE  TO TRUE                           07020000
068200         SET PS-READ-PREV-FILE  TO TRUE                           07030000
068300         IF TR010-SHIP-INFO-PREV-REC = TR011-SHIP-INFO-CURR-REC   07040000
068400             NEXT SENTENCE                                        07050000
068500         ELSE                                                     07060000
068600             SET PS-PO-SEND-EDI-CHG TO TRUE                       07070000
068700         END-IF                                                   07080000
068800     ELSE                                                         07090000
068900         IF PS-SHIP-INFO-PREV-EOF                                 07100000
069000         OR TR011-CURR-POANUMBR < TR010-PREV-POANUMBR             07110000
069100            PERFORM 2040-CHECK-FIRST-RUN                          07120000
069200            SET PS-READ-CURR-FILE  TO TRUE                        07130000
069300         ELSE                                                     07140000
069400             IF PS-SHIP-INFO-CURR-EOF                             07150000
069500             OR TR011-CURR-POANUMBR > TR010-PREV-POANUMBR         07160000
069600                SET PS-PO-SEND-EDI-DEL TO TRUE                    07170000
069700                SET PS-READ-PREV-FILE  TO TRUE                    07180000
069800             END-IF                                               07190000
069900         END-IF                                                   07200000
070000     END-IF.                                                      07210000
070100                                                                  07220000
070200                                                                  07230000
070300     IF PS-PO-SEND-EDI-ADD                                        07240009
070400     OR PS-PO-SEND-EDI-CHG                                        07250009
070500        PERFORM 2060-BUILD-EDI-DETAIL                             07260000
070600        PERFORM 2070-WRITE-EDI-RECORD                             07270000
070700     END-IF.                                                      07280009
070800                                                                  07290000
070900     IF PS-PO-SEND-EDI-DEL                                        07300000
071000        PERFORM 2065-BUILD-EDI-DEL                                07310000
071100        PERFORM 2070-WRITE-EDI-RECORD                             07320000
071200     END-IF.                                                      07330000
071300                                                                  07340000
071400     PERFORM 2080-WRITE-EDI-REPORT.                               07350000
071500                                                                  07360000
071600     IF PS-READ-CURR-FILE                                         07370000
071700        PERFORM 2010-READ-CURR-SHIP-INFO                          07380000
071800     END-IF.                                                      07390000
071900                                                                  07400000
072000     IF PS-READ-PREV-FILE                                         07410000
072100        PERFORM 2020-READ-PREV-SHIP-INFO                          07420000
072200     END-IF.                                                      07430000
072300*2030-EXIT.  EXIT.                                                07440000
072400                                                                  07450000
072500 2040-CHECK-FIRST-RUN.                                            07460000
072600***********************************************************       07470000
072700*    CHECK IF THE SHIPPING DATE IS LATER THAN THE FIRST RUN DATE  07480000
072800***********************************************************       07490000
072900                                                                  07500000
073000     MOVE TR011-CURR-POASHPDT-YY TO PW-EARLY-SHIP-YY              07510000
073100     MOVE TR011-CURR-POASHPDT-MM TO PW-EARLY-SHIP-MM              07520000
073200     MOVE TR011-CURR-POASHPDT-DD TO PW-EARLY-SHIP-DD              07530000
073300                                                                  07540000
073400     IF PW-EARLY-SHIP-YY > 85                                     07550000
073500        MOVE 19             TO PW-EARLY-SHIP-CC                   07560000
073600     ELSE                                                         07570000
073700        MOVE 20             TO PW-EARLY-SHIP-CC                   07580000
073800     END-IF.                                                      07590000
073900                                                                  07600000
074000     IF (PW-EARLY-SHIP-CCYYMMDD > PW-CC-FIRST-RUN-DATE            07610000
074100     OR  PW-EARLY-SHIP-CCYYMMDD = PW-CC-FIRST-RUN-DATE )          07620000
074200         SET PS-PO-SEND-EDI-ADD TO TRUE                           07630000
074300     END-IF.                                                      07640000
074400                                                                  07650000
074500*2040-EXIT.  EXIT.                                                07660000
074600                                                                  07670000
074700                                                                  07680000
074800 2060-BUILD-EDI-DETAIL.                                           07690000
074900     INITIALIZE TR009-PO-EDI-DETAIL-REC.                          07700000
075000                                                                  07710000
075100     MOVE PC-A        TO TR009-DT-EDI-REC-TYPE.                   07720000
075200                                                                  07730000
075300     MOVE TR011-CURR-POANUMBR   TO TR009-DT-EDI-POANUMBR.         07740000
075400     MOVE TR011-CURR-POADPTNO-N TO TR009-DT-EDI-POADPTNO-N.       07750000
075500                                                                  07760000
075600     IF TR011-CURR-POAADVDT NOT = ZEROES                          07770010
075700        MOVE PC-ADV          TO  TR009-DT-EDI-PO-TYPE             07780000
075800        MOVE TR011-CURR-POAADVDT-YY TO PW-ADV-DATE-YY             07790000
075900        MOVE TR011-CURR-POAADVDT-MM TO PW-ADV-DATE-MM             07800000
076000        MOVE TR011-CURR-POAADVDT-DD TO PW-ADV-DATE-DD             07810000
076100        IF PW-ADV-DATE-YY > 85                                    07820000
076200             MOVE 19 TO PW-ADV-DATE-CC                            07830000
076300        ELSE                                                      07840000
076400             MOVE 20 TO PW-ADV-DATE-CC                            07850000
076500        END-IF                                                    07860000
076600        MOVE PW-ADV-DATE-CCYYMMDD TO TR009-DT-EDI-AD-DATE         07870000
076700     END-IF.                                                      07880000
076800                                                                  07890000
076900     IF TR011-CURR-POAPRSIN = PC-4-STATUS-CANCEL                  07900000
077000         MOVE PC-08               TO  TR009-DT-EDI-DATE-QUAL-1    07910000
077100         MOVE PW-CURR-RUN-DATE    TO  TR009-DT-EDI-DATE1          07920000
077200     ELSE                                                         07930000
077300         MOVE PC-04              TO  TR009-DT-EDI-DATE-QUAL-1     07940000
077400                                                                  07950000
077500         IF TR011-CURR-POASHPDT-YY > 85                           07960000
077600            MOVE 19             TO TR009-DT-EDI-DATE1-CC          07970000
077700         ELSE                                                     07980000
077800            MOVE 20             TO TR009-DT-EDI-DATE1-CC          07990000
077900         END-IF                                                   08000000
078000                                                                  08010000
078100         MOVE TR011-CURR-POASHPDT-YY TO TR009-DT-EDI-DATE1-YY     08020000
078200         MOVE TR011-CURR-POASHPDT-MM TO TR009-DT-EDI-DATE1-MM     08030000
078300         MOVE TR011-CURR-POASHPDT-DD TO TR009-DT-EDI-DATE1-DD     08040000
078400         MOVE PC-05               TO  TR009-DT-EDI-DATE-QUAL-2    08050000
078500                                                                  08060000
078600         IF TR011-CURR-POACANEX = ZEROES                          08070010
078700            MOVE TR011-CURR-POACANDT-YY TO TR009-DT-EDI-DATE2-YY  08080000
078800            MOVE TR011-CURR-POACANDT-MM TO TR009-DT-EDI-DATE2-MM  08090000
078900            MOVE TR011-CURR-POACANDT-DD TO TR009-DT-EDI-DATE2-DD  08100000
079000                                                                  08110000
079100            IF TR011-CURR-POACANDT-YY > 85                        08120000
079200               MOVE 19               TO TR009-DT-EDI-DATE2-CC     08130000
079300            ELSE                                                  08140000
079400               MOVE 20               TO TR009-DT-EDI-DATE2-CC     08150000
079500            END-IF                                                08160000
079600         ELSE                                                     08170000
079700            MOVE TR011-CURR-POACANEX-YY TO TR009-DT-EDI-DATE2-YY  08180000
079800            MOVE TR011-CURR-POACANEX-MM TO TR009-DT-EDI-DATE2-MM  08190000
079900            MOVE TR011-CURR-POACANEX-DD TO TR009-DT-EDI-DATE2-DD  08200000
080000                                                                  08210000
080100            IF TR011-CURR-POACANEX-YY > 85                        08220000
080200               MOVE 19               TO TR009-DT-EDI-DATE2-CC     08230000
080300            ELSE                                                  08240000
080400               MOVE 20               TO TR009-DT-EDI-DATE2-CC     08250000
080500            END-IF                                                08260000
080600        END-IF                                                    08270000
080700     END-IF.                                                      08280000
080800                                                                  08290000
080900     MOVE SPACES                 TO TR009-DT-EDI-KOHLS-FILLER.    08300000
081000     MOVE PC-HEX-15              TO TR009-DT-EDI-KOHLS-HEX-51.    08310000
081100*2060-EXIT.  EXIT.                                                08320000
081200                                                                  08330000
081300                                                                  08340000
081400 2065-BUILD-EDI-DEL.                                              08350000
081500     INITIALIZE TR009-PO-EDI-DETAIL-REC.                          08360000
081600                                                                  08370000
081700     MOVE PC-D        TO TR009-DT-EDI-REC-TYPE                    08380000
081800                                                                  08390000
081900     MOVE TR010-PREV-POANUMBR   TO  TR009-DT-EDI-POANUMBR.        08400000
082000     MOVE TR010-PREV-POADPTNO-N TO  TR009-DT-EDI-POADPTNO-N.      08410000
082200***  IF TR010-PREV-POAADVDT NOT = SPACES                          08420007
082200     IF TR010-PREV-POAADVDT NOT = ZEROES                          08430007
082300        MOVE PC-ADV          TO  TR009-DT-EDI-PO-TYPE             08440000
082400        MOVE TR010-PREV-POAADVDT-YY TO PW-ADV-DATE-YY             08450000
082500        MOVE TR010-PREV-POAADVDT-MM TO PW-ADV-DATE-MM             08460000
082600        MOVE TR010-PREV-POAADVDT-DD TO PW-ADV-DATE-DD             08470000
082700        IF PW-ADV-DATE-YY > 85                                    08480000
082800             MOVE 19 TO PW-ADV-DATE-CC                            08490000
082900        ELSE                                                      08500000
083000             MOVE 20 TO PW-ADV-DATE-CC                            08510000
083100        END-IF                                                    08520000
083200        MOVE PW-ADV-DATE-CCYYMMDD TO TR009-DT-EDI-AD-DATE         08530000
083300     END-IF.                                                      08540000
083400                                                                  08550000
083500     IF TR010-PREV-POAPRSIN = PC-4-STATUS-CANCEL                  08560000
083600         MOVE PC-08               TO  TR009-DT-EDI-DATE-QUAL-1    08570000
083700         MOVE PW-CURR-RUN-DATE    TO  TR009-DT-EDI-DATE1          08580000
083800     ELSE                                                         08590000
083900         MOVE PC-04              TO  TR009-DT-EDI-DATE-QUAL-1     08600000
084000                                                                  08610000
084100         IF TR010-PREV-POASHPDT-YY > 85                           08620000
084200            MOVE 19             TO TR009-DT-EDI-DATE1-CC          08630000
084300         ELSE                                                     08640000
084400            MOVE 20             TO TR009-DT-EDI-DATE1-CC          08650000
084500         END-IF                                                   08660000
084600                                                                  08670000
084700         MOVE TR010-PREV-POASHPDT-YY TO  TR009-DT-EDI-DATE1-YY    08680000
084800         MOVE TR010-PREV-POASHPDT-MM TO  TR009-DT-EDI-DATE1-MM    08690000
084900         MOVE TR010-PREV-POASHPDT-DD TO  TR009-DT-EDI-DATE1-DD    08700000
085000         MOVE PC-05               TO  TR009-DT-EDI-DATE-QUAL-2    08710000
085200****     IF TR010-PREV-POACANEX = SPACES                          08720007
085200         IF TR010-PREV-POACANEX = ZEROES                          08730007
085300           MOVE TR010-PREV-POACANDT-YY TO  TR009-DT-EDI-DATE2-YY  08740000
085400           MOVE TR010-PREV-POACANDT-MM TO  TR009-DT-EDI-DATE2-MM  08750000
085500           MOVE TR010-PREV-POACANDT-DD TO  TR009-DT-EDI-DATE2-DD  08760000
085600                                                                  08770000
085700            IF TR010-PREV-POACANDT-YY > 85                        08780000
085800               MOVE 19               TO TR009-DT-EDI-DATE2-CC     08790000
085900            ELSE                                                  08800000
086000               MOVE 20               TO TR009-DT-EDI-DATE2-CC     08810000
086100            END-IF                                                08820000
086200         ELSE                                                     08830000
086300            MOVE TR010-PREV-POACANEX-YY                           08840000
086400                                     TO  TR009-DT-EDI-DATE2-YY    08850000
086500            MOVE TR010-PREV-POACANEX-MM                           08860000
086600                                     TO  TR009-DT-EDI-DATE2-MM    08870000
086700            MOVE TR010-PREV-POACANEX-DD                           08880000
086800                                     TO  TR009-DT-EDI-DATE2-DD    08890000
086900                                                                  08900000
087000            IF TR010-PREV-POACANEX-YY > 85                        08910000
087100               MOVE 19               TO TR009-DT-EDI-DATE2-CC     08920000
087200            ELSE                                                  08930000
087300               MOVE 20               TO TR009-DT-EDI-DATE2-CC     08940000
087400            END-IF                                                08950000
087500        END-IF                                                    08960000
087600     END-IF.                                                      08970000
087700                                                                  08980000
087800     MOVE SPACES                 TO TR009-DT-EDI-KOHLS-FILLER.    08990000
087900     MOVE PC-HEX-15              TO TR009-DT-EDI-KOHLS-HEX-51.    09000000
088000*2065-EXIT.  EXIT.                                                09010000
088100                                                                  09020000
088200                                                                  09030000
088300 2070-WRITE-EDI-RECORD.                                           09040000
088400     IF TR009-PO-EDI-REC-TYPE-DETAIL                              09050000
088500        ADD 1 TO PA-EDI-SENT-CNT                                  09060000
088600     END-IF.                                                      09070000
088700                                                                  09080000
088800     WRITE EDI-TRANS-REC FROM TR009-PO-EDI-RECORD.                09090000
088900*2070-EXIT.  EXIT.                                                09100000
089000                                                                  09110000
089100                                                                  09120000
089200 2080-WRITE-EDI-REPORT.                                           09130000
089300     IF PA-LINE-CNT > PC-LINE-MAX                                 09140000
089400        ADD 1            TO PA-PAGE-CNT                           09150000
089500        MOVE PA-PAGE-CNT TO DP132O-PAGE-NUMBER                    09160000
089600        WRITE PRINT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS    09170000
089700           AFTER ADVANCING PAGE                                   09180000
089800        WRITE PRINT-RECORD FROM PR-PRINT-H1                       09190000
089900           AFTER 3         LINES                                  09200000
090000        WRITE PRINT-RECORD FROM PR-PRINT-H2                       09210000
090100           AFTER 1         LINES                                  09220000
090200        WRITE PRINT-RECORD FROM PR-PRINT-H3                       09230000
090300           AFTER 1         LINES                                  09240000
090400        MOVE +1       TO PA-LINE-CNT                              09250000
090500     END-IF.                                                      09260000
090600                                                                  09270000
090700     IF  NOT PS-SHIP-INFO-PREV-EOF                                09280000
090800     AND NOT PS-SHIP-INFO-CURR-EOF                                09290000
090900     AND TR010-PREV-POANUMBR = TR011-CURR-POANUMBR                09300000
091000         PERFORM 2090-BUILD-PREV-DETAIL                           09310000
091100         PERFORM 2100-BUILD-CURR-DETAIL                           09320000
091200     ELSE                                                         09330000
091300         IF PS-SHIP-INFO-PREV-EOF                                 09340000
091400         OR TR011-CURR-POANUMBR < TR010-PREV-POANUMBR             09350000
091500            PERFORM 2100-BUILD-CURR-DETAIL                        09360000
091600         ELSE                                                     09370000
091700            IF PS-SHIP-INFO-CURR-EOF                              09380000
091800            OR TR011-CURR-POANUMBR > TR010-PREV-POANUMBR          09390000
091900               PERFORM 2090-BUILD-PREV-DETAIL                     09400000
092000            END-IF                                                09410000
092100         END-IF                                                   09420000
092200     END-IF.                                                      09430000
092300                                                                  09440000
092400     EVALUATE TRUE                                                09450000
092500        WHEN PS-PO-SEND-EDI-ADD                                   09460000
092600           MOVE 'ADD'       TO PR-SENT                            09470000
092700        WHEN PS-PO-SEND-EDI-CHG                                   09480000
092800           MOVE 'CHG'       TO PR-SENT                            09490000
092900     END-EVALUATE.                                                09500000
093000                                                                  09510000
093100     WRITE PRINT-RECORD   FROM PR-SHIP-INFO-PRINT-REC.            09520000
093200     ADD  +1       TO PA-LINE-CNT.                                09530000
093300     INITIALIZE PR-SHIP-INFO-PRINT-REC.                           09540000
093400*2080-EXIT.  EXIT.                                                09550000
093500                                                                  09560000
093600                                                                  09570000
093700 2090-BUILD-PREV-DETAIL.                                          09580000
093800     MOVE TR010-PREV-POANUMBR   TO  PR-PREV-POANUMBR.             09590000
093900     MOVE TR010-PREV-POAPRSIN   TO  PR-PREV-POAPRSIN.             09600000
094000     MOVE TR010-PREV-POADPTNO-N TO  PR-PREV-POADPTNO-N.           09610000
094100     MOVE TR010-PREV-POASHPDT   TO  PR-PREV-POASHPDT.             09620000
094200     MOVE TR010-PREV-POACANDT   TO  PR-PREV-POACANDT.             09630000
094300     MOVE TR010-PREV-POAADVDT   TO  PR-PREV-POAADVDT.             09640000
094400     MOVE TR010-PREV-POACANEX   TO  PR-PREV-POACANEX.             09650000
094500*2090-EXIT.  EXIT.                                                09660000
094600                                                                  09670000
094700                                                                  09680000
094800 2100-BUILD-CURR-DETAIL.                                          09690000
094900     MOVE TR011-CURR-POANUMBR   TO PR-CURR-POANUMBR.              09700000
095000     MOVE TR011-CURR-POAPRSIN   TO PR-CURR-POAPRSIN.              09710000
095100     MOVE TR011-CURR-POADPTNO-N TO PR-CURR-POADPTNO-N.            09720000
095200     MOVE TR011-CURR-POASHPDT   TO PR-CURR-POASHPDT.              09730000
095300     MOVE TR011-CURR-POACANDT   TO PR-CURR-POACANDT.              09740000
095400     MOVE TR011-CURR-POAADVDT   TO PR-CURR-POAADVDT.              09750000
095500     MOVE TR011-CURR-POACANEX   TO PR-CURR-POACANEX.              09760000
095600*2100-EXIT.  EXIT.                                                09770000
095700                                                                  09780000
095800                                                                  09790000
095900 2110-BUILD-TRAILER.                                              09800000
096000     INITIALIZE TR009-PO-EDI-TRAILER-REC.                         09810000
096100     MOVE PC-T                TO TR009-TR-EDI-REC-TYPE.           09820000
096200     MOVE PA-EDI-SENT-CNT     TO TR009-TR-EDI-TOTAL-REC.          09830000
096300     MOVE SPACES              TO TR009-TR-EDI-FILLER              09840000
096400                                 TR009-TR-EDI-KOHLS-FILLER.       09850000
096500     MOVE PC-HEX-15           TO TR009-TR-EDI-KOHLS-HEX-51.       09860000
096600                                                                  09870000
096700     PERFORM 2070-WRITE-EDI-RECORD.                               09880000
096800*2110-EXIT.  EXIT.                                                09890000
096900                                                                  09900000
097000                                                                  09910000
097100 3000-UPDATE-EDI-CTL-FILE.                                        09920000
097200     MOVE PW-CC-DAYS-B4-EARLY-SHIP                                09930000
097300                           TO  PW-CC-PREV-B4-EARLY-SHIP.          09940000
097400     MOVE PW-CURR-RUN-DATE TO  PW-CC-PREV-RUN-DATE.               09950000
097500                                                                  09960000
097600     REWRITE CONTROL-REC FROM  PW-CONTROL-CARD.                   09970000
097700                                                                  09980000
097800     DISPLAY 'CONTROL CARD NEW=>' PW-CONTROL-CARD.                09990000
097900     DISPLAY ' '.                                                 10000000
098000*3000-EXIT.  EXIT.                                                10010000
098100                                                                  10020000
098200                                                                  10030000
098300 4000-END-PROCESSING.                                             10040000
098400     CLOSE SHIP-INFO-CURR-FILE                                    10050000
098500           SHIP-INFO-PREV-FILE                                    10060000
098600           CONTROL-FILE                                           10070000
098700           EDI-TRANS-FILE                                         10080000
098800           PRINT-FILE.                                            10090000
098900*4000-EXIT.  EXIT.                                                10100000
099000                                                                  10110000
099100                                                                  10120000
099200 9000-ABEND.                                                      10130000
099300     CALL 'ILBOABN0' USING ABEND-CODE.                            10140000
099400*9000-EXIT.  EXIT.                                                10150000
099500                                                                  10160000
099600                                                                  10170000
