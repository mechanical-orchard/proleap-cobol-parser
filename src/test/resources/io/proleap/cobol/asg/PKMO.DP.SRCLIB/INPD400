W31475********************* !!! ATTENTION !!! **************************00001007
W31475* A COPY OF INPD400 IS CREATED AS INPD402. ANY CHANGE HERE NEEDES 00002007
W31475* TO REFLECT IN INPD402 ALSO AND VICE VERSA.                      00003007
      ******************************************************************00010001
28545 *  INPD400 - COMMON PRICE LOOKUP MODULE.                          00020001
28545 *                                                                 00030001
28545 *-----------------------------------------------------------------00040001
28545 *CHANGE HISTORY:                                                  00050001
28545 * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00060001
28545 * ------- ---------- ----------- -------------------------------- 00070001
28545 * W28545  03-08-2006 ROD JANSSEN CYCLE INVENTORY SKU/STYLE DELETE 00080001
BV    * W28545  04-11-2006 ROD JANSSEN TEMP REMOVE BV COPY CODE CALLS.  00090001
D28545* W28545  04-11-2006 ROD JANSSEN DUMMY SKU/UPC & RETURN CODE LOGIC00100001
D28545*                                RENUMBER SKUS & ATTRIBUTES.      00110001
A28545* W28545  04-21-2006 ROD JANSSEN VSM ATTRIBUTE LOOKUP ISSUE, -811.00120001
B28545* W28545  04-25-2006 ROD JANSSEN VSM LOOKUP BY ITEM ISSUE         00130001
E28545* W28545  04-26-2006 ROD JANSSEN PASS BACK RENUMBER STATUS TO HOST00131001
F28545* W28545  05-22-2006 ROD JANSSEN MBS LOOKUP EFFICIENCIES....      00132001
H28545* W28545  07-04-2006 ROD JANSSEN RENUMBER SKU ISSUE & UPC_ID LOOK.00133001
I28545* W28545  07-07-2006 ROD JANSSEN BUILD IN PERFORMANCE EFFICIENCIES00134001
J28545* W28545  07-24-2006 ROD JANSSEN INVENTORY RECLASS                00134101
Z28545* W28545  08-07-2006 ROD JANSSEN  IN400-***-SKU-OUT LOGIC NEEDS TO00134201
Z28545*                                USE THE RESULTANT SKU RATHER THAN00134301
Z28545*                                CREATE A SKU BASED ON UPC_NBR.   00134401
Z28545*                                 IN400-***-UPC-OUT LOGIC NEEDS TO00134501
Z28545*                                RETAIN THE PASSED IN UPC_NBR IF  00134601
Z28545*                                PRESENT; OTHERWISE, PASS BACK THE00134701
Z28545*                                KOHLS UPC_NBR.                   00134801
RONNA * W28545  10-22-2006 RONNA M.    USE THE BV UTILITY TO GET DEPT   00134901
RONNA *                                BRAND VENDOR ATTRIBUTES.         00135001
RONNA *                                MODIFY EDITING TO ALLOW 0000     00135101
RONNA *                                VALUE IN THE STORE NUMBER WHEN   00135201
RONNA *                                DOING AN ATTRIBUTE LOOKUP.       00135301
RONNA *                                ADDED RETURN CODES TO DETERMINE  00135401
RONNA *                                THE STATUS OF GETTING THE DEPT,  00135501
RONNA *                                BRAND, VENDOR ATTRIBUTES.        00135601
RONNA *                                IF DEPT BRAND VENDOR ATTRIBUTES  00135701
RONNA *                                ARE NEEDED, THE PRICING MODULE   00135801
RONNA *                                IS THE UTILITY TO USE            00135901
RONNA5* W28545  11-30-2006 RONNA M     DEFAULT BRAND VENDOR DATALESS KEY00136001
RONNA5*                                TO UNKOWNS WHEN THE SKY/ITEM/UPC 00136101
RONNA5*                                /UPC ID IS NOT FOUND ANY WHERE   00136201
JAS   * W28582  02-13-2007 JOHN S.     DEFAULT ENT-ID TO UNKNOWN WHEN   00136301
JAS   *                                VSM ATTRIBUTES ARE NOT FOUND.    00136401
X28542* W28542  02-22-2007 ROD JANSSEN INTR UPCID SKU/STYL DELETE       00136501
X28542*                                LOOKUP WAS USING THE SKU         00136601
X28542*                                SKU/STYL DELETE LOOKUP ON THE    00136701
X28542*                                INITIAL CURSOR FETCH.            00136801
S28582* W28582  03-05-2007 JOHN S.     USE ENT-ID IF PASSED INSTEAD OF  00136901
S28582*                                ASSIGNING UNKNOWN VENDOR.        00137001
RONNAQ* W28582  03-25-2007 RONNA M.    FIXED PROGRAM LOOPING.           00137101
RONNAQ*                                INVALID KEY LOOKUP WAS NOT       00137201
RONNAQ*                                GETTING SET WHEN SQLCODE DROPPED 00137301
RONNAQ*                                IN THE 'OTHER' LOGIC.            00137401
W34517* W34517  09-15-2008 JOHN S.     IF DKEY IS NOT ASSIGNED DUE TO   00137502
W34517*                                MBS ATTRIBUTE LOOKUP ERROR,      00137602
W34517*                                ASSIGN KNOWN VENDOR/UNKNOWN BRAND00137702
W34517*                                OR UNKNOWN VENDOR/UNKNOWN BRAND. 00137802
W34517*                                IF DEPT-NBR IS DIFFERENT THAN    00137905
W34517*                                SKU (1:3), USE DEPT-NBR TO LOOKUP00138005
W34517*                                BV RELATIONSHIP.                 00138105
28545 *                                                                 00138205
28545 *-----------------------------------------------------------------00138305
28545 *PURPOSE: COMMON PRICE LOOKUP MODULE COPY CODE.                   00138405
28545 *                                                                 00138505
28545 *NOTE:    REFER TO MODULE INWS400 FOR PROCESSING OPTIONS.         00138605
28545 *           THE INPUT FIELDS WILL BE INITIALIZED AFTER EACH       00138705
28545 *           CALL TO THE ROUTINE.                                  00138805
28545 *                                                                 00138905
28545 *-----------------------------------------------------------------00139005
28545 *  HOW TO USE THIS COPYBOOK WITH INPD400:                         00139105
28545 *-----------------------------------------------------------------00139205
28545 *  1.  DETERMINE IF WE CAN USE VSM PRICING TABLES OR HISTORICAL   00139305
28545 *      PHYSICAL INVENTORY STYLE DELETION TABLES.                  00139405
28545 *                                                                 00139505
28545 *  2.  PRICE LOOKUP.                                              00139605
28545 *      A.  INPUT(S) BUILD.                                        00139705
      *      - THE MINIMUM INPUT REQUIRED TO RETRIEVE CURRENT RETAIL ARE00139805
      *        KEY DATES, LOCATION, AND VALID IDENTIFIER PV-LOOKUP-TYPE 00139905
      *      - SET THE APPROPRIATE PV-LOOKUP-TYPE INDICATOR, BY SETTING 00140005
      *        THE 88 LEVEL TO TRUE: SKU, UPC, UPCID, ITM.              00140105
      *        IF NOTHING IS SET HERE, IT WILL SEARCH UNTIL IT FINDS    00140205
      *        SKU, UPC-NBR, UPC-ID, ITM-NBR THE PROCESS CAN UTILIZE    00140305
      *      - PRIOR TO ENTERING PROCEDURE DIVISION, MOVE DATA TO THE   00140405
      *        APPROPRIATE FIELD CORRESPNDING TO THE SWITCH THAT WAS SET00140505
      *      - IF ADDITIONAL DATA IS AVAILABLE (ITM_NBR FOR SKU LOOKUP) 00140605
      *        INCLUDE THIS AS WELL IN CASE THE FIRST CALL FAILED       00141002
      *      - IF THE LOOKUP AT THE SPECIFIED LEVEL OR THE FIRST        00150001
      *        ASSUMPTION LEVEL FAIL, THIS PROCESS WILL TRY AGAIN USING 00160001
      *        THE ADDITIONAL DATA FIELD UNTIL ATTEMPTS ARE EXHAUSTED.  00170001
      *                                                                 00180001
      *      - ENTRY PROCEDURE: IN400-LOOKUP-RETAIL                     00190001
      *                                                                 00200001
28545 *      B.  RESULTS.                                               00210001
28545 *      - PRICE LOOKUP RETURN CODE VARIABLES ARE DEFINED HERE.     00220001
28545 *        (IN400-PV-COMMON-AREA)                                   00230001
28545 *         - RETURN STATUS CODE                                    00240001
28545 *         - RETURN STATUS CODE REASON TEXT                        00250001
28545 *                                                                 00260001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00270001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      00280001
28545 *        FOLLOWING WORKING STORAGE FIELD                          00290001
28545 *        (IN400-PRICE-RESULT-AREA)                                00300001
28545 *         - EFF BEGIN DATE                                        00310001
28545 *         - EFF END DATE                                          00320001
28545 *         - SKU                        (TSKXREF)                  00330001
28545 *         - INTERNAL UPC ID            (TSKXREF)                  00340001
28545 *         - UPC NUMBER                 (TUPC)                     00350001
28545 *         - ITEM NUMBER                (TSKXREF)                  00360001
28545 *         - STATUS CODE                (TSKXREF)                  00370001
28545 *         - UPC CHANGE DATE            (TUPCPLS)                  00380001
28545 *         - STATUS CHANGE DATE         (TUPCPLS)                  00390001
28545 *         - GROUP PRICE NUMBER         (TMEITGP)                  00400001
28545 *         - GROUP PRICE QUANTITY       (TMITGPL)                  00410001
28545 *         - GROUP PRICE RETAIL AMOUNT  (TMITGPL)                  00420001
28545 *         - UNIT RETAIL AMOUNT         (TUPCPLS)                  00430001
28545 *         - EXTENDED UNIT RETAIL AMOUNT                           00440001
28545 *                                                                 00450001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00460001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      00470001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         00480001
28545 *        (IN400-ATTRIB-RESULT-AREA)                               00490001
28545 *         -  SKU                                                  00500001
28545 *         -  INTERNAL UPC ID                                      00510001
28545 *         -  UPC                                                  00520001
28545 *         -  ITEM NUMBER                                          00530001
28545 *         -  DEPARTMENT                                           00540001
28545 *         -  MAJOR CLASS                                          00550001
28545 *         -  SUB CLASS                                            00560001
28545 *         -  SKU STATUS CODE                                      00570001
28545 *         -  MDSEAR ID                                            00580001
28545 *         -  RMS STYLE ID                                         00590001
28545 *         -  VENDOR STYLE ID                                      00600001
28545 *         -  VENDOR STYLE NUMBER                                  00610001
28545 *                                                                 00620001
      *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00630001
      *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      00640001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         00650001
28545 *        (IN400-VENDOR-RESULT-AREA)                               00660001
28545 *         -  SKU                                                  00670001
28545 *         -  INTERNAL UPC ID                                      00680001
28545 *         -  UPC                                                  00690001
28545 *         -  ITEM NUMBER                                          00700001
28545 *         -  DEPARTMENT                                           00710001
28545 *         -  VENDOR ENT_ID                                        00720001
28545 *         -  VENDOR DUNS NUMBER                                   00730001
28545 *         -  VENDOR INHOUSE NUMBER                                00740001
28545 *         -  BRAND                                                00750001
28545 *                                                                 00760001
28545 *-----------------------------------------------------------------00770001
28545 *  3.  ATTRIBUTES LOOKUP.                                         00780001
28545 *      A.  ATTRIBUTES INPUT(S) BUILD.                             00790001
28545 *      - BOTH THE ITEM ATTRIBUTES AND BRAND/VENDOR ATTRIBUTES ARE 00800001
28545 *        BUILT DURING THIS PROCESS.                               00810001
28545 *      - THE MINIMUM INPUT REQUIRED TO RETRIEVE CURRENT RETAIL ARE00820001
28545 *        KEY DATES AND VALID IDENTIFIER PV-LOOKUP-TYPE            00830001
28545 *      - SET THE APPROPRIATE PV-LOOKUP-TYPE INDICATOR, BY SETTING 00840001
28545 *        THE 88 LEVEL TO TRUE: ASKU, AUPC, AUPCID, AITM.          00850001
28545 *        IF NOTHING IS SET HERE, IT WILL SEARCH UNTIL IT FINDS    00860001
28545 *        SKU, UPC-NBR, UPC-ID, ITM-NBR THE PROCESS CAN UTILIZE    00870001
28545 *      - PRIOR TO ENTERING PROCEDURE DIVISION, MOVE DATA TO THE   00880001
28545 *        APPROPRIATE FIELD CORRESPNDING TO THE SWITCH THAT WAS SET00890001
28545 *      - IF ADDITIONAL DATA IS AVAILABLE (ITM_NBR FOR SKU LOOKUP) 00900001
28545 *        INCLUDE THIS AS WELL IN CASE THE FIRST CALL FAILED       00910001
28545 *      - IF THE LOOKUP AT THE SPECIFIED LEVEL OR THE FIRST        00920001
28545 *        ASSUMPTION LEVEL FAIL, THIS PROCESS WILL TRY AGAIN USING 00930001
28545 *        THE ADDITIONAL DATA FIELD UNTIL ATTEMPTS ARE EXHAUSTED.  00940001
28545 *                                                                 00950001
28545 *      - ENTRY PROCEDURE: IN400-LOOKUP-ATTRIBUTES                 00960001
28545 *                                                                 00970001
28545 *      B.  ATTRIBUTES RESULTS.                                    00980001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      00990001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      01000001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         01010001
28545 *        (IN400-ATTRIB-RESULT-AREA)                               01020001
28545 *         -  SKU                                                  01030001
28545 *         -  INTERNAL UPC ID                                      01040001
28545 *         -  UPC                                                  01050001
28545 *         -  ITEM NUMBER                                          01060001
28545 *         -  DEPARTMENT                                           01070001
28545 *         -  MAJOR CLASS                                          01080001
28545 *         -  SUB CLASS                                            01090001
28545 *         -  SKU STATUS CODE                                      01100001
28545 *         -  MDSEAR ID                                            01110001
28545 *         -  RMS STYLE ID                                         01120001
28545 *     -  VENDOR STYLE ID                                          01130001
28545 *         -  VENDOR STYLE NUMBER                                  01140001
28545 *         -  INHOUSE NUMBER                                       01150001
28545 *         -  DUNS NUMBER                                          01160001
28545 *         -  VENDOR ENT_ID (TVNDSTL)                              01170001
28545 *                                                                 01180001
28545 *      C.  VENDOR ATTRIBUTES INPUT(S) BUILD.                      01190001
28545 *      - AT AN INTERNAL UPC ID LEVEL, CAPTURE THE BRAND/VENDOR    01200001
28545 *        LEVEL ATTRIBUTES. USE OF THE ITEM ATTRIBUTES INTR_UPC_ID 01210001
28545 *        TO BUILD BRAND/VENDOR INFORMATION.                       01220001
28545 *      - INPUT DATA REQUIREMENTS. (EFFECTIVE DATE/DEPARTMENT/VEND/01230001
28545 *        INTR_UPC_ID)                                             01240001
28545 *      - VENDOR ATTRIBUTES ARE BASED ON THE COPYCODE BVWS001 &    01250001
28545 *        BVPD001.                                                 01260001
28545 *                                                                 01270001
28545 *      - ENTRY PROCEDURE: BV001-LOOKUP-MAIN                       01280001
28545 *                                                                 01290001
28545 *      D.  VENDOR ATTRIBUTES RESULTS.                             01300001
28545 *      - ON A SUCCESSFUL EXECUTION AND RETURN TO THE CALLING      01310001
28545 *        PROGRAM, THE FOLLOWING DATA WILL BE RETURNED TO THE      01320001
28545 *        FOLLOWING WORKING STORAGE FIELD.                         01330001
28545 *        (IN400-VENDOR-RESULT-AREA)                               01340001
28545 *         -  SKU                                                  01350001
28545 *         -  INTERNAL UPC ID                                      01360001
28545 *         -  UPC                                                  01370001
28545 *         -  ITEM NUMBER                                          01380001
28545 *         -  DEPARTMENT                                           01390001
28545 *         -  VENDOR ENT_ID                                        01400001
28545 *         -  MDSE_LO_LVL_ID                                       01410001
28545 *         -  LBL_SEQ_NBR                                          01420001
28545 *                                                                 01430001
28545 *IN ALL PRICE SCENARIOS, THE FOLLOWING HOLDS TRUE.                01440001
28545 *                                                                 01450001
28545 *I.  PRICE LOOKUP RULES (PRICE LEVEL DETERMINATION)               01460001
28545 *  1.  VARIABLES TO PASS TO THE PRICE MODULE FOR PRICE LOOKUP.    01470001
28545 *      A.  AT THE SOURCE MODULE LEVEL PASS EITHER THE SKU, UPC_NBR01480001
28545 *          INTR_UPC_ID, OR ITM_NBR.                               01490001
28545 *      B.  THE LOCATION NUMBER.                                   01500001
28545 *      C.  EFFECTIVE DATE. INVENTORY - USE THE SOURCE MODULE DATE 01510001
28545 *          REQUIREMENTS OR THE TINVPAR PLANNED INVENTORY DATE.    01520001
28545 *          THE DEFAULT IS SYSTEM DATE)                            01530001
28545 *      D.  THE TYPE OF LOOKUP TO BE PERFORMED. IN INWS400, SEE THE01540001
28545 *          INPUT VARIABLE IN400-PV-LOOKUP-TYPE-IN FOR MORE DETAILS01550001
28545 *          VALID PRICE LEVEL LOOKUPS INCLUDE:                     01560001
28545 *          I.   SKU     - IN400-PV-SKU-LOOKUP                     01570001
28545 *          II.  UPC_NBR - IN400-PV-UPC-NBR-LOOKUP                 01580001
28545 *          III. UPC_ID  - IN400-PV-INTR-UPC-ID-LOOKUP             01590001
28545 *          IV.  ITM_NBR - IN400-PV-ITM-NBR-LOOKUP                 01600001
28545 *          V.   IF NOT DEFINED THE PRICE MODULE WILL ATTEMPT TO   01610001
28545 *               LOCATE RICE BASED ON ITEM I.1.A. IF NOT FOUND,    01620001
28545 *               ABEND....                                         01630001
28545 *                                                                 01640001
28545 *  2.  USE VSM TABLES OR INVENTORY SKU/STYLE DELETE TABLE?        01650001
28545 *                                                                 01660001
28545 *  **** VSM -                                                     01670001
28545 *  3.  VSM TABLE LOOKUP, STORE SPECIFIC - VALID SKU/UPC/UPC_ID/   01680001
28545 *      ITM_NBR, STORE, EFF BEG/END DATE RANGE.                    01690001
28545 *  4.  VSM TABLE LOOKUP, CORPORATE - VALID SKU/UPC/UPC_ID/ITEM,   01700001
28545 *      STORE, EFF BEG/END DATE RANGE.                             01710001
28545 *  5.  NO MATCH VSM TABLE LOOKUP, PERM HISTORY, STORE SPECIFIC -  01720001
28545 *      VALID ITEM, LOCATION.                                      01730001
28545 *  6.  NO MATCH VSM TABLE LOOKUP, PERM HISTORY, CORPORATE - VALID 01740001
28545 *      ITEM, LOCATION.                                            01750001
28545 *  7.  ATTRIBUTE LOOKUP INCLUDES:                                 01760001
28545 *      A.  VSM ATTRIBUTES.                                        01770001
28545 *      B.  MBS ATTRIBUTES.                                        01780001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               01790001
28545 *                                                                 01800001
28545 *  **** INVENTORY SKU/STYLE DELETE -                              01810001
28545 *  8.  INVENTORY SKU/STYLE DELETE TABLE, STORE SPECIFIC - VALID   01820001
28545 *      SKU/UPC_ID/UPC_NBR/ITEM, STORE, EFF BEG/END DATE RANGE.    01830001
28545 *  9.  INVENTORY SKU/STYLE DELETE TABLE, CORPORATE - VALID SKU/   01840001
28545 *      UPC_NBR/UPC_ID/ITEM, STORE, EFF BEG/END DATE RANGE.        01850001
28545 *  10. BOTH PRICE AND ATTRIBUTE LOOKUP IS CAPTURED WHEN USING THE 01860001
28545 *      INVENTORY SKU/STYLE DELETE.                                01870001
28545 *      A.  VSM ATTRIBUTES.                                        01880001
28545 *      B.  MBS ATTRIBUTES.                                        01890001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               01900001
28545 *                                                                 01910001
28545 *  11. ERROR HANDLING PASSED TO THE SOURCE MODULE.                01920001
28545 *                                                                 01930001
28545 *II. ATTRIBUTE LOOKUP RULES (PRICE LEVEL DETERMINATION)           01940001
28545 *  1.  VARIABLES TO PASS TO THE PRICE MODULE FOR ATTRIBUTE LOOKUP.01950001
28545 *      A.  AT THE SOURCE MODULE LEVEL PASS EITHER THE SKU, UPC_NBR01960001
28545 *          INTR_UPC_ID, OR ITM_NBR.                               01970001
28545 *      B.  THE LOCATION NUMBER.                                   01980001
28545 *      C.  EFFECTIVE DATE. INVENTORY - USE THE SOURCE MODULE DATE 01990001
28545 *          REQUIREMENTS OR THE TINVPAR PLANNED INVENTORY DATE.    02000001
28545 *          THE DEFAULT IS SYSTEM DATE)                            02010001
28545 *      D.  THE TYPE OF LOOKUP TO BE PERFORMED. IN INWS400, SEE THE02020001
28545 *          INPUT VARIABLE IN400-PV-LOOKUP-TYPE-IN FOR MORE DETAILS02030001
28545 *          VALID ATTRIBUTE LEVEL LOOKUPS INCLUDE:                 02040001
28545 *          I.   SKU     - IN400-PV-SKU-ATTRIB-LOOK                02050001
28545 *          II.  UPC_NBR - IN400-PV-UPC-NBR-ATTRIB-LOOK            02060001
28545 *          III. UPC_ID  - IN400-PV-INTUPCID-ATTRIB-LOOK           02070001
28545 *          IV.  ITM_NBR - IN400-PV-ITEM-ATTRIB-LOOK               02080001
28545 *          V.   IF NOT DEFINED THE PRICE MODULE WILL ATTEMPT TO   02090001
28545 *               LOCATE, ATTRIBUTES BASED ON ITEM II.1.A. IF NOT   02100001
28545 *               FOUND, ABEND.....                                 02110001
28545 *                                                                 02120001
28545 *  2.  USE VSM TABLES OR INVENTORY SKU/STYLE DELETE TABLE?        02130001
28545 *                                                                 02140001
28545 *  **** VSM -                                                     02150001
28545 *  3.  VSM TABLE LOOKUP - VALID SKU/UPC/UPC_ID/ITEM,              02160001
28545 *      STORE, DATE RANGES.                                        02170001
28545 *  4.  NO MATCH VSM TABLE LOOKUP - ZERO OUT ATTRIBUTES AND PERFORM02180001
28545 *      ERROR HANDLING.                                            02190001
28545 *  5.  ATTRIBUTE LOOKUP INCLUDES:                                 02200001
28545 *      A.  VSM ATTRIBUTES.                                        02210001
28545 *      B.  MBS ATTRIBUTES.                                        02220001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               02230001
28545 *                                                                 02240001
28545 *  **** INVENTORY SKU/STYLE DELETE -                              02250001
28545 *  6.  INVENTORY SKU/STYLE DELETE TABLE, STORE SPECIFIC - VALID   02260001
28545 *      SKU/UPC_NBR/UPC_ID/ITEM, STORE, EFF BEG/END DATE RANGE.    02270001
28545 *  7.  INVENTORY SKU/STYLE DELETE TABLE, CORPORATE - VALID SKU/   02280001
28545 *      IPC_NBR/UPC_ID/ITEM, STORE, EFF BEG/END DATE RANGE.        02290001
28545 *  8.  BOTH PRICE AND ATTRIBUTE LOOKUP IS CAPTURED WHEN USING THE 02300001
28545 *      INVENTORY SKU/STYLE DELETE.                                02310001
28545 *      A.  VSM ATTRIBUTES.                                        02320001
28545 *      B.  MBS ATTRIBUTES.                                        02330001
28545 *      C.  BRAND/VENDOR ATTRIBUTES.                               02340001
28545 *                                                                 02350001
28545 *  9.  ERROR HANDLING PASSED TO THE SOURCE MODULE.                02360001
28545 *                                                                 02370001
28545 ******************************************************************02380001
                                                                        02390001
28545 ******************************************************************02400001
28545 ******************************************************************02410001
      ******************************************************************02420001
      * IN400-LOOKUP-RETAIL. START LOOKING UP UNIT RETAIL.              02430001
      *  - INITIALIZE ALL OUTPUT VALUES BEFORE EXECUTING ANY CALLS      02440001
      *  - INITIALIZE ALL INPUT VALUES BEFORE RETURNING TO CALL MODULE  02450001
      ******************************************************************02460001
       IN400-LOOKUP-RETAIL.                                             02470001
                                                                        02480001
28545      INITIALIZE IN400-PV-COMMON-AREA.                             02490001
RONNA      SET IN400-PV-DBV-NOT-FOUND TO TRUE.                          02500001
28545      INITIALIZE IN400-PRICE-RESULT-AREA.                          02510001
28545      INITIALIZE IN400-ATTRIB-RESULT-AREA.                         02520001
28545      INITIALIZE IN400-VENDOR-RESULT-AREA.                         02530001
RONNA      INITIALIZE IN400-PV-WORK-AREA.                               02540001
28545                                                                   02550001
           MOVE ZEROES         TO SQLCODE.                              02560001
                                                                        02570001
RONNA      IF IN400-PV-ENT-ID-IN = SPACES                               02580001
RONNA         NEXT SENTENCE                                             02590001
RONNA      ELSE                                                         02600001
RONNA         ADD +2               TO IN400-PS-DBV-ASSUMP-SW            02610001
RONNA      END-IF.                                                      02620001
RONNA      IF IN400-PV-DEPT-IN = SPACES                                 02630001
RONNA         NEXT SENTENCE                                             02640001
RONNA      ELSE                                                         02650001
RONNA         ADD +1               TO IN400-PS-DBV-ASSUMP-SW            02660001
RONNA      END-IF.                                                      02670001
RONNA                                                                   02680001
28545      PERFORM IN400-SET-DATE.                                      02690001
28545      IF IN400-PV-INVALID-EFF-BEG-DTE                              02700001
28545          NEXT SENTENCE                                            02710001
28545      ELSE                                                         02720001
           IF (IN400-PV-LOC-IN = SPACES OR                              02730001
RONNA         (IN400-PV-LOC-IN-NUM = 0  AND                             02740001
RONNA         IN400-PV-PRICE-LOOKUP)    OR                              02750001
RONNA         IN400-PV-LOC-IN-NUM < 0)                                  02760001
RONNA *       IN400-PV-LOC-IN-NUM <= 0                                  02770001
               SET IN400-PV-INVALID-LOCATION TO TRUE                    02780001
28545          SET IN400-PV-SQL-ERROR        TO TRUE                    02790001
28545          SET IN400-PV-ATT-SQL-ERROR    TO TRUE                    02800001
D28545         STRING '  PARA: IN400-LOOKUP-RETAIL - '                  02801001
D28545                                       DELIMITED BY SIZE          02802001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             02803001
D28545                    '  ' DELIMITED BY SIZE                        02804001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         02805001
D28545                    '  ' DELIMITED BY SIZE                        02806001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        02807001
D28545                    '  ' DELIMITED BY SIZE                        02808001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         02809001
D28545                    '  ' DELIMITED BY SIZE                        02810001
D28545                              INTO IN400-PV-PARAGRAPH             02820001
           ELSE                                                         02830001
               PERFORM IN400-PROCESS-INPUT                              02840001
           END-IF.                                                      02850001
                                                                        02860001
W34517     IF IN400-PV-SKU-ATTRIB-LOOK OR                               02860102
W34517        IN400-PV-ITEM-ATTRIB-LOOK                                 02860202
W34517         IF IN400-VND-ML-LO-MDSE-LVL-ID = ZEROS                   02860302
W34517             PERFORM IN400-INV-UNKN-VEND-ATT-LOOKUP               02860402
W34517             PERFORM IN400-INV-UNKN-VEND-OUTPUT                   02860502
W34517         END-IF                                                   02860602
W34517     END-IF.                                                      02860702
W34517                                                                  02860802
28545 ******************************************************************02861001
28545 * CHECK THAT THE DATE FIELD MEETS INITIAL REQUIREMENTS            02862001
28545 * IF NO DATE IS PROVIDED, SET TO CURRENT DATE.                    02863001
28545 ******************************************************************02864001
28545  IN400-SET-DATE.                                                  02865001
28545                                                                   02866001
28545       IF IN400-PV-EFF-DTE-IN = SPACES OR                          02867001
28545          IN400-PV-EFF-DTE-IN = ZEROES                             02868001
28545           EXEC SQL                                                02869001
28545              SELECT CURRENT DATE                                  02870001
28545              INTO :IN400-PV-EFF-DTE-IN                            02880001
28545              FROM SYSIBM.SYSDUMMY1                                02890001
28545              WITH UR                                              02900001
28545           END-EXEC                                                02910001
28545                                                                   02920001
28545           EVALUATE TRUE                                           02930001
28545             WHEN SQLCODE = 0                                      02940001
28545                 MOVE IN400-PV-EFF-DTE-IN                          02950001
28545                               TO IN400-PV-EFF-BEG-DTE-IN          02960001
28545                                  IN400-PV-EFF-BEG-DTE             02970001
D28545                SET IN400-PV-FOUND-AS-REQUESTED TO TRUE           02980001
D28545                SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE           02990001
D28545                MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE           03000001
D28545                MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE           03010001
D28545                MOVE SPACES      TO IN400-PV-PARAGRAPH            03020001
28545             WHEN OTHER                                            03030001
28545                 SET IN400-PV-INVALID-EFF-BEG-DTE TO TRUE          03040001
28545                 SET IN400-PV-SQL-ERROR           TO TRUE          03050001
28545                 SET IN400-PV-ATT-SQL-ERROR       TO TRUE          03060001
RONNA                 SET IN400-PV-DBV-SQL-ERROR       TO TRUE          03070001
D28545                MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE           03080001
D28545                MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE           03090001
D28545                STRING '  PARA: IN400-SET-DATE - '                03100001
D28545                                       DELIMITED BY SIZE          03110001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             03120001
D28545                    '  ' DELIMITED BY SIZE                        03130001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         03140001
D28545                    '  ' DELIMITED BY SIZE                        03150001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        03160001
D28545                    '  ' DELIMITED BY SIZE                        03170001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         03180001
D28545                    '  ' DELIMITED BY SIZE                        03190001
D28545                              INTO IN400-PV-PARAGRAPH             03200001
28545           END-EVALUATE                                            03210001
28545      ELSE                                                         03220001
28545          MOVE IN400-PV-EFF-DTE-IN TO IN400-PV-EFF-BEG-DTE-IN      03230001
28545                                      IN400-PV-EFF-BEG-DTE         03240001
28545          IF IN400-PV-EFF-DTE-IN  = SPACES                         03250001
28545             OR IN400-PV-EFF-BEG-DTE-CCYY > '2100'                 03260001
28545             OR IN400-PV-EFF-BEG-DTE-CCYY < '1980'                 03270001
28545             OR IN400-PV-EFF-BEG-DTE-MM   <   '01'                 03280001
28545             OR IN400-PV-EFF-BEG-DTE-MM   >   '12'                 03290001
28545             OR IN400-PV-EFF-BEG-DTE-DD   <   '01'                 03300001
28545             OR IN400-PV-EFF-BEG-DTE-DD   >   '31'                 03310001
28545              SET IN400-PV-INVALID-EFF-BEG-DTE TO TRUE             03320001
D28545             SET IN400-PV-SQL-ERROR           TO TRUE             03330001
D28545             SET IN400-PV-ATT-SQL-ERROR       TO TRUE             03340001
RONNA              SET IN400-PV-DBV-SQL-ERROR       TO TRUE             03350001
D28545             STRING '  PARA: IN400-SET-DATE - '                   03360001
D28545                                       DELIMITED BY SIZE          03370001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             03380001
D28545                    '  ' DELIMITED BY SIZE                        03390001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         03400001
D28545                    '  ' DELIMITED BY SIZE                        03410001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        03420001
D28545                    '  ' DELIMITED BY SIZE                        03430001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         03440001
D28545                    '  ' DELIMITED BY SIZE                        03450001
D28545                              INTO IN400-PV-PARAGRAPH             03460001
28545          ELSE                                                     03470001
28545          IF IN400-PV-EFF-BEG-DTE-CCYY NOT NUMERIC OR              03480001
28545             IN400-PV-EFF-BEG-DTE-MM   NOT NUMERIC OR              03490001
28545             IN400-PV-EFF-BEG-DTE-DD   NOT NUMERIC                 03500001
28545              SET IN400-PV-INVALID-EFF-BEG-DTE TO TRUE             03510001
D28545             SET IN400-PV-SQL-ERROR           TO TRUE             03520001
D28545             SET IN400-PV-ATT-SQL-ERROR       TO TRUE             03530001
RONNA              SET IN400-PV-DBV-SQL-ERROR       TO TRUE             03540001
D28545             STRING '  PARA: IN400-SET-DATE - '                   03550001
D28545                                       DELIMITED BY SIZE          03560001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             03570001
D28545                    '  ' DELIMITED BY SIZE                        03580001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         03590001
D28545                    '  ' DELIMITED BY SIZE                        03600001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        03610001
D28545                    '  ' DELIMITED BY SIZE                        03620001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         03630001
D28545                    '  ' DELIMITED BY SIZE                        03640001
D28545                              INTO IN400-PV-PARAGRAPH             03650001
28545      ELSE                                                         03660001
28545          MOVE IN400-PV-EFF-DTE-IN TO IN400-PV-EFF-BEG-DTE-IN      03670001
28545                                      IN400-PV-EFF-BEG-DTE         03680001
D28545         SET IN400-PV-FOUND-AS-REQUESTED TO TRUE                  03690001
D28545         SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE                  03700001
D28545         MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                  03710001
D28545         MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                  03720001
D28545         MOVE SPACES      TO IN400-PV-PARAGRAPH                   03730001
28545      END-IF.                                                      03740001
28545                                                                   03750001
      ******************************************************************03760001
      * IN400-PROCESS-INPUT                                             03770001
      *   BEGIN THE VALIDATION PROCESS.                                 03780001
      *   - STEP 1) VALIDATE THE KEY INPUT IS VALID                     03790001
      *   - STEP 2) RESOLVE INPUT TO VARIOUS CORRESPONDING OUTPUTS      03800001
      *   - STEP 3) RETRIEVE RETAIL                                     03810001
      ******************************************************************03820001
       IN400-PROCESS-INPUT.                                             03830001
                                                                        03840001
           EVALUATE TRUE                                                03850001
D28545*** PRICE LOOKUP.....                                             03860001
RONNA *** PRICE AND ATTRIBUTE LOOKUP (CURRENT                           03870001
RONNA *        WHEN IN400-PV-SKU-LOOKUP                                 03880001
RONNA          WHEN IN400-PV-SKU-ASKU-LOOK                              03890001
                   IF IN400-PV-SKU-IN = SPACES    OR                    03900001
                      IN400-PV-SKU-IN NOT NUMERIC OR                    03910001
                      IN400-PV-SKU-IN = ZEROES                          03920001
D28545                 PERFORM IN400-LOOKUP-DEFAULT                     03930001
D28545             ELSE                                                 03940001
D28545             IF IN400-PV-DUMMY-SKU                                03950001
D28545                 MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU    03960001
D28545                 MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU    03970001
D28545                 PERFORM IN400-DUMMY-SKU-LOOKUP                   03980001
D28545             ELSE                                                 03990001
                       MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU    04000001
                       PERFORM IN400-LOOKUP-BY-SKU                      04010001
                   END-IF                                               04020001
                   END-IF                                               04030001
RONNA *        WHEN IN400-PV-UPC-NBR-LOOKUP                             04040001
RONNA          WHEN IN400-PV-UPC-AUPC-LOOK                              04050001
                   IF IN400-PV-UPC-NBR-IN = SPACES    OR                04060001
                      IN400-PV-UPC-NBR-IN NOT NUMERIC OR                04070001
                      IN400-PV-UPC-NBR-IN = ZEROES                      04080001
D28545                 PERFORM IN400-LOOKUP-DEFAULT                     04090001
D28545             ELSE                                                 04100001
I28545             IF (IN400-PV-KOHLS-UPC AND IN400-PV-DUMMY-UPC)       04110001
D28545                 MOVE IN400-PV-UPC-SKU-9 TO IN400-PV-WORK-SKU     04120001
D28545                 MOVE IN400-PV-UPC-SKU-9 TO IN400-PV-DUMB-SKU     04130001
D28545                 PERFORM IN400-DUMMY-SKU-LOOKUP                   04140001
                   ELSE                                                 04150001
                       MOVE IN400-PV-UPC-NBR-IN-NUM                     04160001
                                              TO IN400-PV-WORK-UPC-NBR  04170001
                       PERFORM IN400-LOOKUP-BY-UPC                      04180001
                   END-IF                                               04190001
                   END-IF                                               04200001
RONNA *        WHEN IN400-PV-INTR-UPC-ID-LOOKUP                         04210001
RONNA          WHEN IN400-PV-UPCID-AUPCID-LOOK                          04220001
                   IF IN400-PV-UPC-ID-SPC <= ZEROES                     04230001
D28545                 PERFORM IN400-LOOKUP-DEFAULT                     04240001
                   ELSE                                                 04250001
                       MOVE IN400-PV-UPC-ID-SPC    TO                   04260001
                            IN400-PV-WORK-UPC-ID                        04270001
                       PERFORM IN400-LOOKUP-BY-UPC-ID                   04280001
                   END-IF                                               04290001
RONNA *        WHEN IN400-PV-ITM-NBR-LOOKUP                             04300001
RONNA          WHEN IN400-PV-ITM-AITM-LOOK                              04310001
                   IF IN400-PV-ITM-NBR-IN = SPACES                      04320001
                       OR IN400-PV-ITM-NBR-IN NOT NUMERIC               04330001
                       OR IN400-PV-ITM-NBR-IN = ZEROES                  04340001
                       PERFORM IN400-LOOKUP-DEFAULT                     04350001
                   ELSE                                                 04360001
                       MOVE IN400-PV-ITM-NBR-IN-NUM                     04370001
                           TO IN400-PV-WORK-ITM-NBR                     04380001
                       PERFORM IN400-LOOKUP-BY-ITM-NBR                  04390001
                   END-IF                                               04400001
D28545*** ATTRIBUTE LOOKUP.....                                         04410001
RONNA * THE FOLLOWING HAS BEEN COMMENTED OUT BECAUSE THE LOGIC IS       04420001
RONNA * EXECUTED ABOVE                                                  04430001
28545 *        WHEN IN400-PV-SKU-ATTRIB-LOOK                            04440001
28545 *            IF IN400-PV-SKU-IN = SPACES                          04450001
28545 *              OR IN400-PV-SKU-IN NOT NUMERIC                     04460001
28545 *              OR IN400-PV-SKU-IN = ZEROES                        04470001
D28545*                PERFORM IN400-LOOKUP-DEFAULT                     04480001
D28545*            ELSE                                                 04490001
D28545*            IF IN400-PV-DUMMY-SKU                                04500001
D28545*                MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU    04510001
D28545*                MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU    04520001
D28545*                PERFORM IN400-DUMMY-SKU-LOOKUP                   04530001
D28545*            ELSE                                                 04540001
28545 *                MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU    04550001
28545 *                PERFORM IN400-LOOKUP-BY-SKU                      04560001
28545 *            END-IF                                               04570001
28545 *            END-IF                                               04580001
28545 *        WHEN IN400-PV-UPC-NBR-ATTRIB-LOOK                        04590001
28545 *            IF IN400-PV-UPC-NBR-IN = SPACES                      04600001
28545 *              OR IN400-PV-UPC-NBR-IN NOT NUMERIC                 04601001
28545 *              OR IN400-PV-UPC-NBR-IN = ZEROES                    04602001
D28545*                PERFORM IN400-LOOKUP-DEFAULT                     04603001
D28545*            ELSE                                                 04604001
I28545*            IF (IN400-PV-KOHLS-UPC AND IN400-PV-DUMMY-UPC)       04605001
D28545*                MOVE IN400-PV-UPC-SKU-9 TO IN400-PV-WORK-SKU     04606001
D28545*                MOVE IN400-PV-UPC-SKU-9 TO IN400-PV-DUMB-SKU     04607001
D28545*                PERFORM IN400-DUMMY-SKU-LOOKUP                   04608001
28545 *            ELSE                                                 04609001
28545 *                MOVE IN400-PV-UPC-NBR-IN-NUM                     04610001
28545 *                                        TO IN400-PV-WORK-UPC-NBR 04620001
28545 *                PERFORM IN400-LOOKUP-BY-UPC                      04630001
28545 *            END-IF                                               04640001
28545 *            END-IF                                               04650001
28545 *        WHEN IN400-PV-INTUPCID-ATTRIB-LOOK                       04660001
28545 *            IF IN400-PV-UPC-ID-SPC <= ZEROES                     04670001
D28545*                PERFORM IN400-LOOKUP-DEFAULT                     04680001
28545 *            ELSE                                                 04690001
28545 *                MOVE IN400-PV-UPC-ID-SPC                         04700001
28545 *                                     TO IN400-PV-WORK-UPC-ID     04710001
28545 *                PERFORM IN400-LOOKUP-BY-UPC-ID                   04720001
28545 *            END-IF                                               04730001
28545 *        WHEN IN400-PV-ITEM-ATTRIB-LOOK                           04740001
28545 *            IF IN400-PV-ITM-NBR-IN = SPACES                      04750001
28545 *                OR IN400-PV-ITM-NBR-IN NOT NUMERIC               04760001
28545 *                OR IN400-PV-ITM-NBR-IN = ZEROES                  04770001
D28545*                PERFORM IN400-LOOKUP-DEFAULT                     04780001
28545 *            ELSE                                                 04790001
28545 *                MOVE IN400-PV-ITM-NBR-IN-NUM                     04800001
28545 *                                     TO IN400-PV-WORK-ITM-NBR    04810001
28545 *                PERFORM IN400-LOOKUP-BY-ITM-NBR                  04820001
28545 *            END-IF                                               04830001
RONNA *  THE ABOVE WAS COMMENTED OUT WITH CHANGES MADE TO THE           04840001
RONNA *  PREVIOUS SET OF WHEN'S                                         04850001
D28545*** LOOKUP BASED ON THE PASSED PARAMETERS......                   04860001
               WHEN OTHER                                               04870001
                   PERFORM IN400-LOOKUP-DEFAULT                         04880001
           END-EVALUATE.                                                04890001
                                                                        04900001
28545 ******************************************************************04910001
28545 ** VSM LOOKUP.                                                    04920001
28545 ** RETRIEVE SKU/UPC/UPC_ID/ITEM INFORMATION USING VSM TABLES      04930001
28545 ** TABLES SEARCH ORDER - VSM/PERM/INVENTORY STYLE DELETION.       04940001
28545 ******************************************************************04950001
D28545     IF (NOT IN400-PV-INVALID-KEY-INPUT)                          04960001
             IF IN400-PV-FOUND                                          04970001
D28545**** VSM - DUMMY SKU....                                          04980001
D28545         IF IN400-PS-DUMMY-SKU                                    04990001
D28545           PERFORM IN400-DUMMY-SKU-ATT-LOOKUP                     05000001
D28545           PERFORM IN400-DUMMY-SKU-LOOKUP-ATT-OUT                 05010001
BV               PERFORM IN400-DUMMY-SKU-VEND-ATT-LOOK                  05020001
BV               PERFORM IN400-DUMMY-SKU-VEND-OUTPUT                    05030001
D28545         ELSE                                                     05040001
28545 **** VSM - PRICE LOOKUP....                                       05050001
28545          IF IN400-PV-PRICE-LOOKUP                                 05060001
                 MOVE 'N'                TO IN400-PS-STR-ROW-FOUND-SW   05070001
                 MOVE 'N'                TO IN400-PS-RETAIL-FOUND-SW    05080001
                 MOVE IN400-PV-LOC-IN-NUM   TO UPCPLS-STR-NBR           05090001
28545            PERFORM IN400-VSM-PROCEED-WITH-LOOKUP                  05100001
                     UNTIL IN400-PS-STR-FOUND                           05110001
                        OR IN400-PV-INVALID-KEY-INPUT                   05120001
28545            IF IN400-PS-STR-FOUND                                  05130001
28545                PERFORM IN400-VSM-PRICE-OUTPUT                     05140001
28545                PERFORM IN400-VSM-ATTRIBUTES-LOOKUP                05150001
J28545               PERFORM IN400-INVENTORY-RECLASS                    05160001
D28545               PERFORM IN400-VSM-PLU-DWNLD-LOOKUP                 05170001
28545                PERFORM IN400-VSM-MBS-LOOKUP                       05180001
28545                PERFORM IN400-VSM-ATTRIB-OUTPUT                    05190001
28545                PERFORM IN400-VSM-VENDOR-ATTRIB-LOOKUP             05200001
28545                PERFORM IN400-VSM-VENDOR-OUTPUT                    05210001
28545            ELSE                                                   05220001
28545 ****     STR PRICE NOT FOUND @ VSM AND TPPCPRC LEVEL(S) - TRY     05230001
28545 **** INVENTORY STYLE DELETION LOOKUP...                           05240001
28545              MOVE 'N'           TO IN400-PS-STR-ROW-FOUND-SW      05250001
28545              MOVE 'N'           TO IN400-PS-RETAIL-FOUND-SW       05260001
28545              PERFORM IN400-INV-PROCEED-WITH-LOOKUP                05270001
28545                  UNTIL IN400-PS-STR-FOUND                         05280001
28545                     OR IN400-PV-INVALID-KEY-INPUT                 05290001
28545              IF IN400-PS-STR-FOUND                                05300001
28545                  PERFORM IN400-INV-PRICE-OUTPUT                   05310001
28545                  PERFORM IN400-INV-ATTRIBUTES-LOOKUP              05320001
RONNA                  PERFORM IN400-INVENTORY-RECLASS                  05330001
28545                  PERFORM IN400-INV-MBS-LOOKUP                     05340001
28545                  PERFORM IN400-INV-ATTRIB-OUTPUT                  05350001
28545                  PERFORM IN400-INV-VENDOR-ATTRIB-LOOKUP           05360001
28545                  PERFORM IN400-INV-VENDOR-OUTPUT                  05370001
RONNA5             ELSE                                                 05380001
RONNA5                 PERFORM IN400-INV-UNKN-VEND-ATT-LOOKUP           05390001
RONNA5                 PERFORM IN400-INV-UNKN-VEND-OUTPUT               05400001
28545              END-IF                                               05410001
28545            END-IF                                                 05420001
28545          ELSE                                                     05421001
28545 **** VSM - SKU/UPC/UPC_ID/ITEM ATTRIBUTE LOOKUP....               05422001
28545 **** VSM - VENDOR ATTRIBUTE LOOKUP....                            05423001
28545          IF IN400-PV-ATTRIBUTE-LOOKUP                             05424001
28545            PERFORM IN400-VSM-ATTRIBUTES-LOOKUP                    05425001
J28545           PERFORM IN400-INVENTORY-RECLASS                        05426001
D28545           PERFORM IN400-VSM-PLU-DWNLD-LOOKUP                     05427001
28545            PERFORM IN400-VSM-MBS-LOOKUP                           05427101
28545            PERFORM IN400-VSM-ATTRIB-OUTPUT                        05427201
28545            PERFORM IN400-VSM-VENDOR-ATTRIB-LOOKUP                 05427301
28545            PERFORM IN400-VSM-VENDOR-OUTPUT                        05427401
28545          ELSE                                                     05427501
28545 **** VSM - DEFAULT - PRICE LOOKUP IF NOT DEFINED...               05427601
28545            MOVE 'N'                TO IN400-PS-STR-ROW-FOUND-SW   05427701
28545            MOVE 'N'                TO IN400-PS-RETAIL-FOUND-SW    05427801
28545            MOVE IN400-PV-LOC-IN-NUM   TO UPCPLS-STR-NBR           05427901
28545            PERFORM IN400-VSM-PROCEED-WITH-LOOKUP                  05428001
28545                UNTIL IN400-PS-STR-FOUND                           05429001
28545                   OR IN400-PV-INVALID-KEY-INPUT                   05429101
28545            IF IN400-PS-STR-FOUND                                  05429201
28545                PERFORM IN400-VSM-PRICE-OUTPUT                     05429301
28545                PERFORM IN400-VSM-ATTRIBUTES-LOOKUP                05429401
J28545               PERFORM IN400-INVENTORY-RECLASS                    05429501
D28545               PERFORM IN400-VSM-PLU-DWNLD-LOOKUP                 05429601
28545                PERFORM IN400-VSM-MBS-LOOKUP                       05429701
28545                PERFORM IN400-VSM-ATTRIB-OUTPUT                    05429801
28545                PERFORM IN400-VSM-VENDOR-ATTRIB-LOOKUP             05429901
28545                PERFORM IN400-VSM-VENDOR-OUTPUT                    05430001
28545            ELSE                                                   05440001
28545 ****     ATTRIBUTES NOT FOUND @ VSM AND TPPCPRC LEVEL(S) - TRY    05450001
28545 **** INVENTORY STYLE DELETION LOOKUP...                           05460001
28545              MOVE 'N'           TO IN400-PS-STR-ROW-FOUND-SW      05470001
28545              MOVE 'N'           TO IN400-PS-RETAIL-FOUND-SW       05480001
28545              PERFORM IN400-INV-PROCEED-WITH-LOOKUP                05490001
28545                  UNTIL IN400-PS-STR-FOUND                         05500001
28545                     OR IN400-PV-INVALID-KEY-INPUT                 05510001
28545              IF IN400-PS-STR-FOUND                                05520001
28545                  PERFORM IN400-INV-PRICE-OUTPUT                   05530001
28545                  PERFORM IN400-INV-ATTRIBUTES-LOOKUP              05540001
J28545                 PERFORM IN400-INVENTORY-RECLASS                  05550001
28545                  PERFORM IN400-INV-MBS-LOOKUP                     05560001
28545                  PERFORM IN400-INV-ATTRIB-OUTPUT                  05570001
28545                  PERFORM IN400-INV-VENDOR-ATTRIB-LOOKUP           05580001
28545                  PERFORM IN400-INV-VENDOR-OUTPUT                  05590001
RONNA5             ELSE                                                 05600001
RONNA5                 PERFORM IN400-INV-UNKN-VEND-ATT-LOOKUP           05610001
RONNA5                 PERFORM IN400-INV-UNKN-VEND-OUTPUT               05620001
28545              END-IF                                               05630001
28545            END-IF                                                 05640001
28545          END-IF                                                   05650001
28545 ******************************************************************05660001
28545 ** INVENTORY STYLE DELETION LOOKUP.                               05670001
28545 ** RETRIEVE SKU/UPC/UPC_ID/ITEM INFORMATION USING INVENTORY       05680001
28545 ** STYLE DELETION TABLES.                                         05690001
28545 ******************************************************************05691001
28545        ELSE                                                       05691101
28545 **** INVENTORY STYLE DELETION - DUMMY SKU....                     05691201
28545 **** INVENTORY STYLE DELETION - PRICE LOOKUP....                  05691301
28545 **** INVENTORY STYLE DELETION - SKU/UPC/UPC_ID/ITEM ATTRIB LOOKUP 05691401
28545 **** INVENTORY STYLE DELETION - VENDOR ATTRIBUTE LOOKUP....       05691501
28545          MOVE 'N'                 TO IN400-PS-STR-ROW-FOUND-SW    05691601
28545          MOVE 'N'                 TO IN400-PS-RETAIL-FOUND-SW     05691701
28545          PERFORM IN400-INV-PROCEED-WITH-LOOKUP                    05691801
28545              UNTIL IN400-PS-STR-FOUND                             05691901
28545                 OR IN400-PV-INVALID-KEY-INPUT                     05692001
28545          IF IN400-PS-STR-FOUND                                    05693001
28545              PERFORM IN400-INV-PRICE-OUTPUT                       05694001
J28545             PERFORM IN400-INVENTORY-RECLASS                      05695001
28545              PERFORM IN400-INV-ATTRIBUTES-LOOKUP                  05696001
28545              PERFORM IN400-INV-MBS-LOOKUP                         05697001
28545              PERFORM IN400-INV-ATTRIB-OUTPUT                      05698001
28545              PERFORM IN400-INV-VENDOR-ATTRIB-LOOKUP               05699001
28545              PERFORM IN400-INV-VENDOR-OUTPUT                      05700001
RONNA5         ELSE                                                     05710001
RONNA5             PERFORM IN400-INV-UNKN-VEND-ATT-LOOKUP               05720001
RONNA5             PERFORM IN400-INV-UNKN-VEND-OUTPUT                   05730001
28545          END-IF                                                   05740001
D28545       END-IF                                                     05750001
           END-IF.                                                      05760001
                                                                        05770001
      ******************************************************************05780001
      *                    LOOKUP BY SKU INPUT                          05790001
      ******************************************************************05800001
      * 1) BEGIN BY CONVERTING SKU TO INTR_UPC_ID. THIS ENSURES THE     05810001
      *    MOST-CURRENT ATTRIBUTES ARE RETRIEVED (IE. RENUMS CONVERTED) 05820001
      * 2) JOIN TUPC.UPC_ID WITH TSKXREF.INTR_UPC_ID. THIS ENSURES THE  05830001
      *    CURRENT ACTIVE UPC_NBR WILL BE RETRIEVED.                    05840001
      * 3) THE KOHLS UPC-NBR (IE. 400...) WILL CONTAIN THE CURRENT SKU  05850001
      *    EMBEDDED WITHIN THE UPC.                                     05860001
      *                                                                 05870001
      * SAMPLE SKU INPUT - 74411184  >>>  TUPC.UPC_NBR 400044871848     05880001
      *                   (RENUMBER)     CURRENT SKU = ---04487184-     05890001
      ******************************************************************05900001
       IN400-LOOKUP-BY-SKU.                                             05910001
                                                                        05920001
           EXEC SQL                                                     05930001
               SELECT INTR_UPC_ID,                                      05940001
                      ITM_NBR,                                          05950001
E28545                SKU_STAT_CDE                                      05960001
                 INTO :SKXREF-INTR-UPC-ID                               05970001
                     ,:SKXREF-ITM-NBR                                   05980001
E28545               ,:SKXREF-SKU-STAT-CDE                              05990001
                 FROM TSKXREF                                           06000001
               WHERE SKU = :IN400-PV-WORK-SKU                           06010001
               WITH UR                                                  06020001
           END-EXEC.                                                    06030001
                                                                        06040001
           EVALUATE TRUE                                                06050001
               WHEN SQLCODE = 0                                         06060001
D28545             SET IN400-PV-NOT-FOUND     TO TRUE                   06070001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   06080001
E28545             PERFORM IN400-RENUMBER-SKU                           06090001
               WHEN SQLCODE = +100                                      06100001
28545              MOVE ZEROS  TO SKXREF-INTR-UPC-ID                    06110001
28545              MOVE ZEROS  TO SKXREF-ITM-NBR                        06120001
E28545             PERFORM IN400-RENUMBER-SKU                           06130001
D28545             SET IN400-PV-NOT-FOUND     TO TRUE                   06140001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   06150001
               WHEN OTHER                                               06160001
28545              MOVE ZEROS  TO SKXREF-INTR-UPC-ID                    06170001
28545              MOVE ZEROS  TO SKXREF-ITM-NBR                        06180001
E28545             PERFORM IN400-RENUMBER-SKU                           06190001
D28545             SET IN400-PV-SQL-ERROR          TO TRUE              06200001
D28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   06210001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   06220001
D28545             SET IN400-PV-TRY-SKU-LOOKUP     TO TRUE              06230001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              06240001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              06250001
D28545             STRING '  PARA: IN400-LOOKUP-BY-SKU - '              06260001
D28545                                       DELIMITED BY SIZE          06270001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             06280001
D28545                    '  ' DELIMITED BY SIZE                        06290001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         06291001
D28545                    '  ' DELIMITED BY SIZE                        06292001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        06293001
D28545                    '  ' DELIMITED BY SIZE                        06294001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         06295001
D28545                    '  ' DELIMITED BY SIZE                        06296001
D28545                              INTO IN400-PV-PARAGRAPH             06297001
           END-EVALUATE                                                 06298001
                                                                        06299001
           IF IN400-PV-NOT-FOUND                                        06300001
               EXEC SQL                                                 06310001
                   SELECT SKU                                           06320001
                         ,UPC_NBR                                       06330001
                         ,ITM_NBR                                       06340001
                         ,A.INTR_UPC_ID                                 06350001
                         ,DEPT                                          06360001
                         ,CLASS                                         06370001
                         ,SUBCLASS                                      06380001
                     INTO :SKXREF-SKU                                   06390001
                         ,:UPC-UPC-NBR                                  06400001
                         ,:SKXREF-ITM-NBR                               06410001
                         ,:SKXREF-INTR-UPC-ID                           06420001
                         ,:SKXREF-DEPT                                  06430001
                         ,:SKXREF-CLASS                                 06440001
                         ,:SKXREF-SUBCLASS                              06450001
                     FROM                                               06460001
                          TSKXREF A                                     06470001
                         ,TUPC    B                                     06480001
                    WHERE A.INTR_UPC_ID = :SKXREF-INTR-UPC-ID           06490001
                      AND A.INTR_UPC_ID = UPC_ID                        06500001
                      AND SKU_STAT_CDE NOT IN ('00','98')               06510001
                    WITH UR                                             06520001
               END-EXEC                                                 06530001
                                                                        06540001
               EVALUATE TRUE                                            06550001
                   WHEN SQLCODE = 0                                     06560001
D28545                 SET IN400-PV-FOUND-AS-REQUESTED TO TRUE          06570001
D28545                 SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE          06580001
D28545                 MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE          06590001
D28545                 MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE          06600001
D28545                 MOVE SPACES      TO IN400-PV-PARAGRAPH           06610001
                   WHEN SQLCODE = +100                                  06620001
                       SET IN400-PV-NOT-FOUND TO TRUE                   06630001
                       SET IN400-PV-ATT-NOT-FOUND TO TRUE               06640001
D28545                 SET IN400-PV-TRY-SKU-LOOKUP     TO TRUE          06650001
D28545                 MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE          06660001
D28545                 MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE          06670001
D28545                 STRING '  PARA: IN400-LOOKUP-BY-SKU - '          06680001
D28545                                       DELIMITED BY SIZE          06690001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             06700001
D28545                    '  ' DELIMITED BY SIZE                        06710001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         06720001
D28545                    '  ' DELIMITED BY SIZE                        06730001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        06740001
D28545                    '  ' DELIMITED BY SIZE                        06750001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         06760001
D28545                    '  ' DELIMITED BY SIZE                        06770001
D28545                              INTO IN400-PV-PARAGRAPH             06780001
                   WHEN OTHER                                           06790001
D28545                 SET IN400-PV-SQL-ERROR          TO TRUE          06800001
D28545                 SET IN400-PV-ATT-SQL-ERROR TO TRUE               06810001
RONNA                  SET IN400-PV-DBV-SQL-ERROR TO TRUE               06820001
D28545                 SET IN400-PV-TRY-SKU-LOOKUP     TO TRUE          06830001
D28545                 MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE          06840001
D28545                 MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE          06850001
D28545                 STRING '  PARA: IN400-LOOKUP-BY-SKU - '          06860001
D28545                                       DELIMITED BY SIZE          06870001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             06880001
D28545                    '  ' DELIMITED BY SIZE                        06890001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         06900001
D28545                    '  ' DELIMITED BY SIZE                        06910001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        06920001
D28545                    '  ' DELIMITED BY SIZE                        06930001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         06940001
D28545                    '  ' DELIMITED BY SIZE                        06950001
D28545                              INTO IN400-PV-PARAGRAPH             06960001
               END-EVALUATE                                             06970001
           ELSE                                                         06980001
D28545         SET IN400-PV-FOUND-AS-REQUESTED TO TRUE                  06990001
D28545         SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE                  07000001
D28545         MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                  07010001
D28545         MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                  07020001
D28545         MOVE SPACES      TO IN400-PV-PARAGRAPH                   07030001
           END-IF.                                                      07040001
                                                                        07050001
E28545******************************************************************07060001
E28545* IN400-RENUMBER-SKU.                                             07070001
E28545******************************************************************07080001
E28545 IN400-RENUMBER-SKU.                                              07090001
E28545                                                                  07100001
E28545      IF SKXREF-SKU-STAT-CDE EQUAL '98'                           07110001
E28545          MOVE SKXREF-SKU-STAT-CDE                                07120001
E28545                            TO IN400-PV-ATT-RENUM-STAT-CDE        07130001
E28545          MOVE SKXREF-SKU-STAT-CDE                                07140001
E28545                            TO IN400-PV-PRC-RENUM-STAT-CDE        07150001
E28545          SET IN400-PS-RENUMBER-SKU TO TRUE                       07160001
E28545          SET IN400-PV-RENUMBER-SKU TO TRUE                       07170001
E28545      ELSE                                                        07180001
E28545          MOVE SPACES TO IN400-PV-PRC-RENUM-STAT-CDE              07190001
E28545          MOVE SPACES TO IN400-PV-ATT-RENUM-STAT-CDE              07200001
E28545      END-IF.                                                     07210001
E28545                                                                  07220001
D28545******************************************************************07230001
D28545* IN400-DUMMY-SKU-LOOKUP.                                         07240001
D28545******************************************************************07250001
D28545 IN400-DUMMY-SKU-LOOKUP.                                          07260001
D28545                                                                  07270001
W34517*    MOVE IN400-PV-DUMB-SKU-X (1:3) TO MDSEAR-DEPT-NBR.           07280005
W34517     IF IN400-PV-DEPT-IN = SPACES                                 07280105
W34517         MOVE IN400-PV-DUMB-SKU-X (1:3) TO MDSEAR-DEPT-NBR        07280305
W34517     ELSE                                                         07280405
W34517         MOVE IN400-PV-DEPT-IN-3X       TO MDSEAR-DEPT-NBR        07280606
W34517     END-IF.                                                      07280705
D28545                                                                  07290001
D28545     STRING IN400-PV-DUMB-SKU-X (4:1) DELIMITED BY SIZE           07300001
D28545            '0' DELIMITED BY SIZE                                 07310001
D28545                                    INTO MDSEAR-MAJ-CL-NBR.       07320001
D28545                                                                  07320101
D28545     STRING '0' DELIMITED BY SIZE                                 07320201
D28545            IN400-PV-DUMB-SKU-X (4:2) DELIMITED BY SIZE           07320301
D28545                                    INTO MDSEAR-SUB-CL-NBR.       07320401
D28545                                                                  07320501
D28545     EXEC SQL                                                     07320601
D28545         SELECT A.DEPT_NBR                                        07320701
D28545               ,A.MAJ_CL_NBR                                      07320801
D28545               ,A.SUB_CL_NBR                                      07320901
D28545               ,A.MDSEAR_DKEY                                     07321001
D28545         INTO :MDSEAR-DEPT-NBR                                    07322001
D28545             ,:MDSEAR-MAJ-CL-NBR                                  07323001
D28545             ,:MDSEAR-SUB-CL-NBR                                  07324001
D28545             ,:MDSEAR-DKEY                                        07325001
D28545         FROM TMDSEAR A                                           07326001
D28545             ,TAPLAVL B                                           07327001
D28545         WHERE (A.DEPT_NBR    = :MDSEAR-DEPT-NBR)                 07328001
D28545           AND (A.MAJ_CL_NBR  = :MDSEAR-MAJ-CL-NBR)               07329001
D28545           AND (A.SUB_CL_NBR  = :MDSEAR-SUB-CL-NBR)               07330001
D28545           AND (A.MDSELV_CDE  = 'SCL')                            07340001
D28545           AND (A.OPERCO_NBR  = '03')                             07350001
D28545           AND (B.APLSYS_CDE  = 'IN')                             07360001
D28545           AND (A.MDSEAR_DKEY =  B.MDSEAR_DKEY)                   07370001
D28545           AND (CURRENT DATE     BETWEEN                          07380001
D28545                CHAR(B.MDSEAR_STRT_DTE,ISO)  AND                  07390001
D28545                CHAR(B.MDSEAR_END_DTE,ISO))                       07400001
D28545           AND (CURRENT DATE     BETWEEN                          07410001
D28545                CHAR(A.STRT_DTE,ISO)         AND                  07420001
D28545                CHAR(A.END_DTE,ISO))                              07430001
D28545          WITH UR                                                 07440001
D28545     END-EXEC.                                                    07450001
D28545                                                                  07460001
D28545     EVALUATE TRUE                                                07470001
D28545         WHEN SQLCODE = 0                                         07480001
D28545           SET IN400-PS-DUMMY-SKU          TO TRUE                07490001
D28545           SET IN400-PV-FOUND-AS-REQUESTED TO TRUE                07500001
D28545           SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE                07510001
D28545           MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                07520001
D28545           MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                07530001
D28545           IF IN400-PV-DUMMY-SKU                                  07540001
D28545             SET IN400-PV-DUMMY-SKU-VALID  TO TRUE                07550001
D28545           ELSE                                                   07560001
D28545             SET IN400-PV-DUMMY-UPC-VALID  TO TRUE                07570001
D28545           END-IF                                                 07580001
D28545           MOVE SPACES      TO IN400-PV-PARAGRAPH                 07590001
A28545                                                                  07600001
A28545           MOVE MDSEAR-MAJ-CL-NBR       TO IN400-PV-WORK-MCL-2X   07610001
A28545           MOVE IN400-PV-WORK-MCL-2X-9  TO SKXREF-CLASS           07620001
A28545                                                                  07630001
A28545           MOVE MDSEAR-DEPT-NBR         TO IN400-PV-WORK-DEPT-3X  07640001
A28545           MOVE IN400-PV-WORK-DEPT-3X-9 TO SKXREF-DEPT            07650001
A28545                                                                  07660001
A28545           MOVE MDSEAR-SUB-CL-NBR       TO IN400-PV-WORK-SCL-3X   07670001
A28545           MOVE IN400-PV-WORK-SCL-3X-9  TO SKXREF-SUBCLASS        07680001
A28545                                                                  07690001
A28545           PERFORM IN400-VSM-MBS-LOOKUP                           07700001
A28545                                                                  07710001
D28545         WHEN SQLCODE = +100                                      07720001
D28545           SET IN400-PV-NOT-FOUND       TO TRUE                   07730001
D28545           SET IN400-PV-ATT-NOT-FOUND   TO TRUE                   07740001
D28545           MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                07750001
D28545           MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                07760001
D28545           IF IN400-PV-DUMMY-SKU                                  07770001
D28545             SET IN400-PV-DUMMY-SKU-ERR    TO TRUE                07780001
D28545           ELSE                                                   07790001
D28545             SET IN400-PV-DUMMY-UPC-ERR    TO TRUE                07800001
D28545           END-IF                                                 07810001
D28545           STRING '  PARA: IN400-DUMMY-SKU-LOOKUP - '             07820001
D28545                                   DELIMITED BY SIZE              07830001
D28545                IN400-PV-SKU-IN DELIMITED BY SIZE                 07840001
D28545                '  ' DELIMITED BY SIZE                            07850001
D28545                IN400-PV-UPC-NBR-IN DELIMITED BY SIZE             07860001
D28545                '  ' DELIMITED BY SIZE                            07870001
D28545                IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE            07880001
D28545                '  ' DELIMITED BY SIZE                            07890001
D28545                IN400-PV-ITM-NBR-IN DELIMITED BY SIZE             07900001
D28545                '  ' DELIMITED BY SIZE                            07910001
D28545                          INTO IN400-PV-PARAGRAPH                 07920001
D28545         WHEN SQLCODE = -904                                      07930001
D28545         WHEN SQLCODE = -913                                      07940001
D28545           SET IN400-PV-DEADLOCK-PRICE  TO TRUE                   07950001
D28545           SET IN400-PV-DEADLOCK-ATTRIB TO TRUE                   07960001
D28545           MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                07970001
D28545           MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                07980001
D28545           STRING '  PARA: IN400-DUMMY-SKU-LOOKUP - '             07990001
D28545                                   DELIMITED BY SIZE              08000001
D28545                IN400-PV-SKU-IN DELIMITED BY SIZE                 08010001
D28545                '  ' DELIMITED BY SIZE                            08020001
D28545                IN400-PV-UPC-NBR-IN DELIMITED BY SIZE             08030001
D28545                '  ' DELIMITED BY SIZE                            08040001
D28545                IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE            08050001
D28545                '  ' DELIMITED BY SIZE                            08060001
D28545                IN400-PV-ITM-NBR-IN DELIMITED BY SIZE             08070001
D28545                '  ' DELIMITED BY SIZE                            08080001
D28545                          INTO IN400-PV-PARAGRAPH                 08090001
D28545         WHEN SQLWARN NOT = SPACE                                 08100001
D28545         WHEN SQLCODE NOT = ZERO                                  08110001
D28545           SET IN400-PV-SQL-ERROR TO TRUE                         08120001
D28545           SET IN400-PV-ATT-SQL-ERROR TO TRUE                     08130001
RONNA            SET IN400-PV-DBV-SQL-ERROR TO TRUE                     08140001
D28545           MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                08150001
D28545           MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                08160001
D28545           IF IN400-PV-DUMMY-SKU                                  08170001
D28545             SET IN400-PV-DUMMY-SKU-ERR    TO TRUE                08180001
D28545           ELSE                                                   08190001
D28545             SET IN400-PV-DUMMY-UPC-ERR    TO TRUE                08200001
D28545           END-IF                                                 08210001
D28545           STRING '  PARA: IN400-DUMMY-SKU-LOOKUP - '             08220001
D28545                                   DELIMITED BY SIZE              08230001
D28545                IN400-PV-SKU-IN DELIMITED BY SIZE                 08240001
D28545                '  ' DELIMITED BY SIZE                            08250001
D28545                IN400-PV-UPC-NBR-IN DELIMITED BY SIZE             08260001
D28545                '  ' DELIMITED BY SIZE                            08270001
D28545                IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE            08280001
D28545                '  ' DELIMITED BY SIZE                            08290001
D28545                IN400-PV-ITM-NBR-IN DELIMITED BY SIZE             08300001
D28545                '  ' DELIMITED BY SIZE                            08310001
D28545                          INTO IN400-PV-PARAGRAPH                 08320001
D28545     END-EVALUATE.                                                08330001
D28545                                                                  08340001
D28545******************************************************************08350001
D28545* IN400-DUMMY-SKU-ATT-LOOKUP.                                     08360001
D28545******************************************************************08370001
D28545 IN400-DUMMY-SKU-ATT-LOOKUP.                                      08380001
D28545                                                                  08390001
D28545     MOVE MDSEAR-DEPT-NBR         TO VNDDPT-DEPT-NBR.             08400001
RONNA      IF IN400-PV-ENT-ID-IN = SPACES                               08410001
D28545        MOVE 5161                 TO VNDDPT-ENT-ID                08420001
RONNA      ELSE                                                         08430001
RONNA         MOVE IN400-PV-ENT-ID-IN-9 TO VNDDPT-ENT-ID                08440001
RONNA      END-IF.                                                      08450001
D28545                                                                  08460001
D28545     EXEC SQL                                                     08470001
D28545         SELECT F.DEPT_NBR                                        08480001
D28545               ,F.INHOUSE_NBR                                     08490001
D28545               ,E.DUN_NBR                                         08500001
D28545         INTO :VNDDPT-DEPT-NBR                                    08510001
D28545             ,:VNDDPT-INHOUSE-NBR                                 08520001
D28545             ,:EXTENT-DUN-NBR                                     08530001
D28545         FROM TVNDDPT F                                           08540001
D28545             ,TEXTENT E                                           08550001
D28545         WHERE F.ENT_ID = E.ENT_ID                                08560001
D28545           AND F.ENT_ID = :VNDDPT-ENT-ID                          08570001
D28545           AND F.DEPT_NBR = :VNDDPT-DEPT-NBR                      08580001
D28545         WITH UR                                                  08590001
D28545     END-EXEC.                                                    08600001
D28545                                                                  08610001
D28545     EVALUATE TRUE                                                08620001
D28545         WHEN SQLCODE = 0                                         08630001
D28545             SET IN400-PV-FOUND-AS-REQUESTED TO TRUE              08640001
D28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              08650001
RONNA              SET IN400-PV-DBV-FOUND-WITH-ASSMPT TO TRUE           08660001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              08670001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              08680001
RONNA              MOVE SQLCODE     TO IN400-PV-DBV-SQLCDE              08690001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               08700001
D28545         WHEN SQLCODE = +100                                      08710001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  08720001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               08730001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   08740001
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           08750001
I28545             SET IN400-PV-FOUND-WITH-ASSUMPTION TO TRUE           08760001
RONNA              SET IN400-PV-DBV-FOUND-WITH-ASSMPT TO TRUE           08770001
D28545             STRING '  PARA: IN400-DUMMY-SKU-ATT-LOOKUP - '       08780001
D28545                                       DELIMITED BY SIZE          08790001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             08800001
D28545                    '  ' DELIMITED BY SIZE                        08810001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         08820001
D28545                    '  ' DELIMITED BY SIZE                        08830001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        08840001
D28545                    '  ' DELIMITED BY SIZE                        08850001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         08851001
D28545                    '  ' DELIMITED BY SIZE                        08852001
D28545                              INTO IN400-PV-PARAGRAPH             08853001
D28545         WHEN OTHER                                               08854001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  08855001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               08856001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   08857001
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           08858001
I28545             SET IN400-PV-FOUND-WITH-ASSUMPTION TO TRUE           08859001
D28545             STRING '  PARA: IN400-DUMMY-SKU-ATT-LOOKUP - '       08860001
D28545                                       DELIMITED BY SIZE          08870001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             08880001
D28545                    '  ' DELIMITED BY SIZE                        08890001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         08900001
D28545                    '  ' DELIMITED BY SIZE                        08910001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        08920001
D28545                    '  ' DELIMITED BY SIZE                        08930001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         08940001
D28545                    '  ' DELIMITED BY SIZE                        08950001
D28545                              INTO IN400-PV-PARAGRAPH             08960001
D28545     END-EVALUATE.                                                08970001
D28545                                                                  08980001
D28545******************************************************************08990001
D28545* IN400-DUMMY-SKU-LOOKUP-ATT-OUT.                                 09000001
D28545******************************************************************09010001
D28545 IN400-DUMMY-SKU-LOOKUP-ATT-OUT.                                  09020001
D28545                                                                  09030001
D28545     MOVE IN400-PV-WORK-SKU       TO IN400-ATT-SKU-OUT.           09040001
D28545     MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-ATT-UPC-OUT.           09050001
D28545     MOVE IN400-PV-UPC-ID-IN      TO IN400-ATT-UPCID-OUT.         09060001
D28545     MOVE IN400-PV-ITM-NBR-IN-NUM TO IN400-ATT-ITM-NBR-OUT.       09070001
D28545                                                                  09080001
D28545     MOVE MDSEAR-DEPT-NBR         TO IN400-ATT-DEPT-OUT.          09090001
D28545     MOVE MDSEAR-MAJ-CL-NBR       TO IN400-ATT-MCL-OUT.           09100001
D28545     MOVE MDSEAR-SUB-CL-NBR       TO IN400-ATT-SCL-OUT.           09110001
D28545     MOVE '20'                    TO IN400-ATT-STATUS-OUT.        09120001
D28545                                                                  09130001
D28545     MOVE MDSEAR-DKEY             TO IN400-ATT-MDEAR-ID-OUT.      09140001
D28545     MOVE ZEROS                   TO IN400-ATT-STYL-ID-OUT.       09150001
D28545     MOVE ZEROS                   TO IN400-ATT-VS-ID-OUT.         09160001
D28545     MOVE ZEROS                   TO IN400-ATT-VS-NBR-OUT.        09170001
D28545                                                                  09180001
D28545     MOVE VNDDPT-ENT-ID           TO IN400-ATT-ENT-ID-OUT.        09190001
RONNA      MOVE 2230                    TO IN400-ATT-LBL-SEQ-NBR-OUT.   09200001
D28545     MOVE EXTENT-DUN-NBR          TO IN400-ATT-DUNS-NBR-OUT.      09210001
D28545     MOVE VNDDPT-INHOUSE-NBR      TO IN400-ATT-INHSE-NBR-OUT.     09220001
D28545     MOVE 'Y'                     TO IN400-ATT-PLU-DWNLD-IND.     09230001
D28545                                                                  09240001
BV    ******************************************************************09250001
BV    * IN400-DUMMY-SKU-VEND-ATT-LOOK.                                  09260001
BV    ******************************************************************09270001
BV     IN400-DUMMY-SKU-VEND-ATT-LOOK.                                   09280001
BV                                                                      09290001
RONNA *    SET BV001-PV-SKU-DEPT-LOOKUP TO TRUE.                        09300001
RONNA *    DUMMY SKU IS ALWAYS AN UNKNOWN BRAND.                        09310001
RONNA      SET BV001-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    09320001
BV                                                                      09330001
BV         MOVE IN400-PV-EFF-DTE-IN   TO BV001-PV-EFF-DTE-IN.           09340001
RONNA *    MOVE IN400-PV-WORK-SKU     TO BV001-PV-SKU-IN-9.             09350001
RONNA      IF IN400-PV-ENT-ID-IN = SPACES                               09360001
BV            MOVE 5161               TO BV001-PV-ENT-ID-IN-9           09370001
RONNA      ELSE                                                         09380001
RONNA         MOVE IN400-PV-ENT-ID-IN-9                                 09390001
RONNA                                 TO BV001-PV-ENT-ID-IN-9           09400001
RONNA      END-IF.                                                      09410001
RONNA                                                                   09420001
BV         MOVE MDSEAR-DEPT-NBR       TO BV001-PV-DEPT-IN-9.            09430001
RONNA      MOVE 2230                  TO BV001-PV-BRAND-IN-9.           09440001
BV                                                                      09450001
BV         PERFORM BV001-LOOKUP-MAIN.                                   09460001
BV         IF BV001-PV-FOUND-REL-OR-UNK    OR                           09470001
RONNA         BV001-PAST-OR-FUT-DBV-REL-FND                             09480001
BV             SET IN400-PS-ATTR-FOUND   TO TRUE                        09490001
RONNA          SET IN400-PV-DBV-FOUND    TO TRUE                        09491001
RONNA          SET IN400-PS-BVUTIL-FOUND TO TRUE                        09492001
RONNA         IF IN400-PS-DBV-NO-ASSUMP                                 09493001
RONNA            SET IN400-PV-DBV-FOUND-AS-RQSTD TO TRUE                09494001
RONNA         ELSE                                                      09495001
RONNA            SET IN400-PV-DBV-FOUND-WITH-ASSMPT TO TRUE             09496001
RONNA         END-IF                                                    09497001
BV         ELSE                                                         09498001
BV             MOVE ZEROS       TO BV001-PV-DEPT-OUT                    09499001
BV             MOVE ZEROS       TO BV001-PV-ENT-ID-OUT                  09500001
BV             MOVE ZEROS       TO BV001-PV-RLTNSHP-ID-OUT              09500101
BV             MOVE ZEROS       TO BV001-PV-BRAND-OUT                   09500201
BV             SET IN400-PV-ATT-NOT-FOUND TO TRUE                       09500301
BV             SET IN400-PV-BRAND-LOOKUP  TO TRUE                       09500401
BV             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                      09500501
RONNA          SET IN400-PV-DBV-NOT-FOUND TO TRUE                       09500601
BV             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                  09500701
RONNA                              IN400-PV-DBV-SQLCDE                  09500801
BV             STRING '  PARA: IN400-DUMMY-SKU-VEND-ATT-LOOK - '        09500901
BV                                       DELIMITED BY SIZE              09501001
BV                    IN400-PV-SKU-IN DELIMITED BY SIZE                 09501101
BV                    '  ' DELIMITED BY SIZE                            09501201
BV                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE             09501301
BV                    '  ' DELIMITED BY SIZE                            09501401
BV                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE            09501501
BV                    '  ' DELIMITED BY SIZE                            09501601
BV                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE             09501701
BV                    '  ' DELIMITED BY SIZE                            09501801
BV                              INTO IN400-PV-PARAGRAPH                 09501901
BV         END-IF.                                                      09502001
BV                                                                      09502101
BV    ******************************************************************09502201
BV    * IN400-DUMMY-SKU-VEND-OUTPUT.                                    09502301
BV    ******************************************************************09502401
BV     IN400-DUMMY-SKU-VEND-OUTPUT.                                     09502501
BV                                                                      09502601
BV         MOVE IN400-PV-WORK-SKU       TO IN400-VND-SKU-OUT.           09502701
BV         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-VND-UPC-OUT.           09502801
BV         MOVE IN400-PV-UPC-ID-IN      TO IN400-VND-UPCID-OUT.         09502901
BV         MOVE IN400-PV-ITM-NBR-IN-NUM TO IN400-VND-ITM-NBR-OUT.       09503001
BV                                                                      09503101
BV         MOVE BV001-PV-DEPT-OUT       TO IN400-VND-DEPT-OUT.          09503201
BV         MOVE BV001-PV-ENT-ID-OUT     TO IN400-VND-ENT-ID-OUT.        09503301
BV         MOVE BV001-PV-RLTNSHP-ID-OUT TO IN400-VND-ML-LO-MDSE-LVL-ID. 09503401
BV         MOVE BV001-PV-BRAND-OUT      TO IN400-VND-LBL-SEQ-NBR.       09503501
BV                                                                      09503601
      ******************************************************************09503701
      * LOOKUP BY UPC-NBR INPUT                                         09503801
      * 1) GET CURRENT INTR_UPC_ID AND UPC NUMBER                       09503901
      * 2) IF SUCCESSFUL, GET SKU ATTR AND CURRENT ITEM-NBR             09504001
      ******************************************************************09504101
       IN400-LOOKUP-BY-UPC.                                             09504201
                                                                        09504301
           PERFORM IN400-LOOKUP-UPC-NBR.                                09504401
                                                                        09504501
           EVALUATE TRUE                                                09504601
           WHEN SQLCODE = 0                                             09504701
               MOVE UPC-INTR-UPC-ID TO IN400-PV-WORK-UPC-ID             09504801
               PERFORM IN400-LOOKUP-BY-UPC-ID                           09504901
D28545     WHEN SQLCODE = +100                                          09505001
D28545         SET IN400-PV-NOT-FOUND          TO TRUE                  09505101
D28545         SET IN400-PV-ATT-NOT-FOUND      TO TRUE                  09505201
D28545         SET IN400-PV-TRY-UPC-NBR-LOOKUP TO TRUE                  09505301
D28545         MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                  09505401
D28545         MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                  09505501
D28545         STRING '  PARA: IN400-LOOKUP-BY-UPC - '                  09505601
D28545                                   DELIMITED BY SIZE              09505701
D28545                IN400-PV-SKU-IN DELIMITED BY SIZE                 09505801
D28545                '  ' DELIMITED BY SIZE                            09505901
D28545                IN400-PV-UPC-NBR-IN DELIMITED BY SIZE             09506001
D28545                '  ' DELIMITED BY SIZE                            09507001
D28545                IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE            09508001
D28545                '  ' DELIMITED BY SIZE                            09509001
D28545                IN400-PV-ITM-NBR-IN DELIMITED BY SIZE             09510001
D28545                '  ' DELIMITED BY SIZE                            09520001
D28545                          INTO IN400-PV-PARAGRAPH                 09530001
D28545     WHEN OTHER                                                   09540001
D28545         SET IN400-PV-SQL-ERROR          TO TRUE                  09550001
D28545         SET IN400-PV-ATT-SQL-ERROR      TO TRUE                  09560001
RONNA          SET IN400-PV-DBV-SQL-ERROR TO TRUE                       09570001
D28545         SET IN400-PV-TRY-UPC-NBR-LOOKUP TO TRUE                  09580001
D28545         MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE                  09590001
D28545         MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                  09600001
D28545         STRING '  PARA: IN400-LOOKUP-BY-UPC - '                  09610001
D28545                                   DELIMITED BY SIZE              09620001
D28545                IN400-PV-SKU-IN DELIMITED BY SIZE                 09630001
D28545                '  ' DELIMITED BY SIZE                            09640001
D28545                IN400-PV-UPC-NBR-IN DELIMITED BY SIZE             09650001
D28545                '  ' DELIMITED BY SIZE                            09660001
D28545                IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE            09670001
D28545                '  ' DELIMITED BY SIZE                            09680001
D28545                IN400-PV-ITM-NBR-IN DELIMITED BY SIZE             09690001
D28545                '  ' DELIMITED BY SIZE                            09700001
D28545                          INTO IN400-PV-PARAGRAPH                 09710001
           END-EVALUATE.                                                09720001
                                                                        09730001
      ******************************************************************09740001
      * LOOKUP CURRENT UPC NUMBER & INTERNAL UPC-ID                     09750001
      * - FIRST CALL CHANGES ANY RENUMBERED UPCS TO CURRENT KOHLS UPC   09760001
      *   AND RETRIEVES TO CURRENT INTR_UPC_ID TO USE AGAINST TSKXREF   09770001
      ******************************************************************09780001
       IN400-LOOKUP-UPC-NBR.                                            09790001
                                                                        09800001
           EXEC SQL                                                     09810001
I28545          SELECT B.UPC_NBR ,                                      09820001
I28545                 A.INTR_UPC_ID                                    09830001
I28545           INTO :UPC-UPC-NBR                                      09840001
I28545               ,:UPC-INTR-UPC-ID                                  09850001
I28545           FROM TSKXREF A,                                        09860001
I28545                TUPCSKU B                                         09870001
I28545           WHERE B.UPC_NBR = :IN400-PV-WORK-UPC-NBR               09880001
I28545             AND B.ITEM_NBR = A.ITM_NBR                           09890001
I28545         WITH UR                                                  09900001
           END-EXEC.                                                    09910001
                                                                        09920001
D28545     EVALUATE TRUE                                                09930001
D28545         WHEN SQLCODE = 0                                         09940001
D28545             SET IN400-PV-FOUND-AS-REQUESTED TO TRUE              09950001
D28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              09960001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              09970001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              09980001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               09990001
D28545         WHEN SQLCODE = +100                                      10000001
D28545             SET IN400-PV-NOT-FOUND          TO TRUE              10010001
D28545             SET IN400-PV-ATT-NOT-FOUND      TO TRUE              10020001
D28545             SET IN400-PV-TRY-UPC-NBR-LOOKUP TO TRUE              10030001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              10040001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              10050001
D28545             STRING '  PARA: IN400-LOOKUP-UPC-NBR - '             10060001
D28545                                       DELIMITED BY SIZE          10070001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             10080001
D28545                    '  ' DELIMITED BY SIZE                        10090001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         10100001
D28545                    '  ' DELIMITED BY SIZE                        10110001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        10120001
D28545                    '  ' DELIMITED BY SIZE                        10130001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         10140001
D28545                    '  ' DELIMITED BY SIZE                        10150001
D28545                              INTO IN400-PV-PARAGRAPH             10160001
D28545         WHEN OTHER                                               10170001
D28545             SET IN400-PV-SQL-ERROR          TO TRUE              10180001
D28545             SET IN400-PV-ATT-SQL-ERROR      TO TRUE              10190001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   10200001
D28545             SET IN400-PV-TRY-UPC-NBR-LOOKUP TO TRUE              10210001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              10220001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              10230001
D28545             STRING '  PARA: IN400-LOOKUP-UPC-NBR - '             10240001
D28545                                       DELIMITED BY SIZE          10250001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             10260001
D28545                    '  ' DELIMITED BY SIZE                        10270001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         10280001
D28545                    '  ' DELIMITED BY SIZE                        10290001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        10300001
D28545                    '  ' DELIMITED BY SIZE                        10310001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         10320001
D28545                    '  ' DELIMITED BY SIZE                        10330001
D28545                              INTO IN400-PV-PARAGRAPH             10340001
D28545     END-EVALUATE.                                                10350001
D28545                                                                  10360001
      ******************************************************************10370001
      * LOOKUP BY INTERNAL UPC-ID INPUT                                 10380001
      ******************************************************************10390001
       IN400-LOOKUP-BY-UPC-ID.                                          10400001
                                                                        10410001
E28545*** CHECK THE UPC-ID STATUS. (IS THE ITEM RENUMBERD?)             10420001
E28545     EXEC SQL                                                     10430001
H28545         SELECT DISTINCT INTR_UPC_ID,                             10440001
E28545                SKU_STAT_CDE                                      10450001
E28545           INTO :SKXREF-INTR-UPC-ID                               10460001
E28545               ,:SKXREF-SKU-STAT-CDE                              10470001
E28545           FROM TSKXREF                                           10480001
E28545         WHERE INTR_UPC_ID = :IN400-PV-WORK-UPC-ID                10490001
E28545           AND SKU_STAT_CDE = '98'                                10500001
E28545         WITH UR                                                  10510001
E28545     END-EXEC.                                                    10520001
E28545                                                                  10530001
E28545     EVALUATE TRUE                                                10540001
E28545         WHEN SQLCODE = 0                                         10550001
E28545             SET IN400-PV-NOT-FOUND     TO TRUE                   10560001
E28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   10570001
E28545             PERFORM IN400-RENUMBER-SKU                           10580001
E28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              10590001
E28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              10600001
E28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               10610001
E28545         WHEN SQLCODE = +100                                      10620001
E28545             SET IN400-PV-NOT-FOUND     TO TRUE                   10630001
E28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   10640001
E28545             PERFORM IN400-RENUMBER-SKU                           10650001
E28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              10660001
E28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              10661001
E28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               10662001
E28545         WHEN OTHER                                               10663001
E28545             SET IN400-PV-SQL-ERROR          TO TRUE              10664001
E28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   10665001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   10666001
E28545             SET IN400-PV-TRY-SKU-LOOKUP     TO TRUE              10667001
E28545             PERFORM IN400-RENUMBER-SKU                           10668001
E28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              10669001
E28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              10670001
E28545             STRING '  PARA: IN400-LOOKUP-BY-UPC-ID (1) - '       10671001
E28545                                       DELIMITED BY SIZE          10671101
E28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             10671201
E28545                    '  ' DELIMITED BY SIZE                        10671301
E28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         10671401
E28545                    '  ' DELIMITED BY SIZE                        10671501
E28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        10671601
E28545                    '  ' DELIMITED BY SIZE                        10671701
E28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         10671801
E28545                    '  ' DELIMITED BY SIZE                        10671901
E28545                              INTO IN400-PV-PARAGRAPH             10672001
E28545     END-EVALUATE                                                 10673001
E28545                                                                  10674001
E28545*** VALIDATE UPC-ID.....                                          10674101
E28545     IF IN400-PV-NOT-FOUND                                        10674201
             EXEC SQL                                                   10674301
                 SELECT SKU                                             10674401
                       ,UPC_NBR                                         10674501
                       ,ITM_NBR                                         10674601
                       ,A.INTR_UPC_ID                                   10674701
                       ,DEPT                                            10674801
                       ,CLASS                                           10674901
                       ,SUBCLASS                                        10675001
                   INTO :SKXREF-SKU                                     10675101
                       ,:UPC-UPC-NBR                                    10675201
                       ,:SKXREF-ITM-NBR                                 10675301
                       ,:SKXREF-INTR-UPC-ID                             10675401
                       ,:SKXREF-DEPT                                    10675501
                       ,:SKXREF-CLASS                                   10675601
                       ,:SKXREF-SUBCLASS                                10675701
                   FROM                                                 10675801
                        TSKXREF A                                       10675901
                       ,TUPC    B                                       10676001
                  WHERE                                                 10677001
                        A.INTR_UPC_ID = :IN400-PV-WORK-UPC-ID           10678001
                    AND B.UPC_ID = A.INTR_UPC_ID                        10679001
                    AND SKU_STAT_CDE NOT IN ('00','98')                 10680001
                  WITH UR                                               10690001
             END-EXEC                                                   10700001
                                                                        10710001
             EVALUATE TRUE                                              10720001
                 WHEN SQLCODE = 0                                       10730001
D28545               SET IN400-PV-FOUND-AS-REQUESTED TO TRUE            10740001
D28545               SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE            10750001
D28545               MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE            10760001
D28545               MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE            10770001
D28545               MOVE SPACES      TO IN400-PV-PARAGRAPH             10780001
                 WHEN SQLCODE = +100                                    10790001
                     SET IN400-PV-NOT-FOUND          TO TRUE            10800001
D28545               SET IN400-PV-ATT-NOT-FOUND      TO TRUE            10810001
D28545               SET IN400-PV-TRY-UPC-ID-LOOKUP  TO TRUE            10820001
D28545               MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE            10830001
D28545               MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE            10840001
D28545               STRING '  PARA: IN400-LOOKUP-BY-UPC-ID (2) - '     10850001
D28545                                         DELIMITED BY SIZE        10860001
D28545                      IN400-PV-SKU-IN DELIMITED BY SIZE           10870001
D28545                      '  ' DELIMITED BY SIZE                      10880001
D28545                      IN400-PV-UPC-NBR-IN DELIMITED BY SIZE       10890001
D28545                      '  ' DELIMITED BY SIZE                      10900001
D28545                      IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE      10910001
D28545                      '  ' DELIMITED BY SIZE                      10920001
D28545                      IN400-PV-ITM-NBR-IN DELIMITED BY SIZE       10930001
D28545                      '  ' DELIMITED BY SIZE                      10940001
D28545                                INTO IN400-PV-PARAGRAPH           10950001
                 WHEN OTHER                                             10960001
                     SET IN400-PV-SQL-ERROR          TO TRUE            10970001
D28545               SET IN400-PV-ATT-SQL-ERROR      TO TRUE            10980001
RONNA                SET IN400-PV-DBV-SQL-ERROR TO TRUE                 10990001
D28545               SET IN400-PV-TRY-UPC-ID-LOOKUP  TO TRUE            11000001
D28545               MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE            11010001
D28545               MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE            11020001
D28545               STRING '  PARA: IN400-LOOKUP-BY-UPC-ID (2) - '     11030001
D28545                                         DELIMITED BY SIZE        11040001
D28545                      IN400-PV-SKU-IN DELIMITED BY SIZE           11050001
D28545                      '  ' DELIMITED BY SIZE                      11060001
D28545                      IN400-PV-UPC-NBR-IN DELIMITED BY SIZE       11070001
D28545                      '  ' DELIMITED BY SIZE                      11080001
D28545                      IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE      11090001
D28545                      '  ' DELIMITED BY SIZE                      11100001
D28545                      IN400-PV-ITM-NBR-IN DELIMITED BY SIZE       11110001
D28545                      '  ' DELIMITED BY SIZE                      11120001
D28545                                INTO IN400-PV-PARAGRAPH           11130001
             END-EVALUATE                                               11140001
E28545     END-IF.                                                      11150001
                                                                        11160001
      ******************************************************************11170001
      * LOOKUP BY ITEM NUMBER INPUT                                     11180001
      ******************************************************************11190001
       IN400-LOOKUP-BY-ITM-NBR.                                         11200001
                                                                        11210001
           EXEC SQL                                                     11220001
               SELECT SKU                                               11230001
                     ,ITM_NBR                                           11240001
                     ,INTR_UPC_ID                                       11250001
                     ,DEPT                                              11260001
                     ,CLASS                                             11270001
                     ,SUBCLASS                                          11280001
                 INTO :SKXREF-SKU                                       11290001
                     ,:SKXREF-ITM-NBR                                   11300001
                     ,:SKXREF-INTR-UPC-ID                               11310001
                     ,:SKXREF-DEPT                                      11320001
                     ,:SKXREF-CLASS                                     11330001
                     ,:SKXREF-SUBCLASS                                  11340001
                 FROM                                                   11350001
                      TSKXREF                                           11360001
                WHERE                                                   11370001
                      ITM_NBR = :IN400-PV-WORK-ITM-NBR                  11380001
                WITH UR                                                 11390001
           END-EXEC.                                                    11400001
                                                                        11410001
           EVALUATE TRUE                                                11420001
               WHEN SQLCODE = 0                                         11430001
B28545             MOVE SKXREF-INTR-UPC-ID TO IN400-PV-WORK-UPC-ID      11440001
B28545             PERFORM IN400-LOOKUP-BY-UPC-ID                       11450001
               WHEN SQLCODE = +100                                      11460001
                   SET IN400-PV-NOT-FOUND          TO TRUE              11470001
D28545             SET IN400-PV-ATT-NOT-FOUND      TO TRUE              11480001
D28545             SET IN400-PV-TRY-ITM-NBR-LOOKUP TO TRUE              11490001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              11500001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              11510001
D28545             STRING '  PARA: IN400-LOOKUP-BY-ITM-NBR - '          11520001
D28545                                       DELIMITED BY SIZE          11530001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             11540001
D28545                    '  ' DELIMITED BY SIZE                        11550001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         11560001
D28545                    '  ' DELIMITED BY SIZE                        11570001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        11580001
D28545                    '  ' DELIMITED BY SIZE                        11590001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         11600001
D28545                    '  ' DELIMITED BY SIZE                        11610001
D28545                              INTO IN400-PV-PARAGRAPH             11620001
               WHEN OTHER                                               11630001
                   SET IN400-PV-SQL-ERROR          TO TRUE              11640001
D28545             SET IN400-PV-ATT-SQL-ERROR      TO TRUE              11650001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   11660001
D28545             SET IN400-PV-TRY-ITM-NBR-LOOKUP TO TRUE              11670001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              11680001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              11690001
D28545             STRING '  PARA: IN400-LOOKUP-BY-ITM-NBR - '          11700001
D28545                                       DELIMITED BY SIZE          11710001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             11720001
D28545                    '  ' DELIMITED BY SIZE                        11730001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         11740001
D28545                    '  ' DELIMITED BY SIZE                        11750001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        11760001
D28545                    '  ' DELIMITED BY SIZE                        11770001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         11780001
D28545                    '  ' DELIMITED BY SIZE                        11790001
D28545                              INTO IN400-PV-PARAGRAPH             11800001
           END-EVALUATE.                                                11810001
                                                                        11820001
      ******************************************************************11830001
      * IN400-LOOKUP-DEFAULT. DEFAULT INFORMATION LOOKUP                11840001
      * - THIS ROUTINE IS EXECUTED IF EITHER A VALID SWITCH WAS NOT SET 11850001
      *   OR THE SWITCH THAT WAS SET FAILED TO FIND ENOUGH TO PROCEED   11860001
      * - THIS ROUTINE WILL CHECK FOR A NON-ZERO / NON-SPACE CONDITION  11870001
      *   IN EACH OF THE PRIMARY SEARCH PARAMETERS (ITEM,UPC,SKU,UPCID).11880001
      * - IF ONE OF THE PARAMETERS WAS DETERMINED TO HAVE A VALUE OTHER 11890001
      *   THAN THE DEFAULT, PROCESSING WILL MAKE A FINAL ATTEMPT TO     11900001
      *   DETERMINE THE RETAIL BASED ON THESE VALUES.                   11910001
      * - FAILURE FROM THESE ATTEMPTS WILL RESULT IN A NOT FOUND        11920001
      *   CONDITION BEING RETURNED.                                     11930001
      ******************************************************************11940001
       IN400-LOOKUP-DEFAULT.                                            11950001
                                                                        11960001
           SET IN400-PV-FOUND-WITH-ASSUMPTION TO TRUE.                  11970001
                                                                        11980001
      *       IS SKU INPUT PROVIDED ???                                 11990001
           IF IN400-PV-SKU-IN = SPACES                                  12000001
               OR IN400-PV-SKU-IN NOT NUMERIC                           12010001
               OR IN400-PV-SKU-IN = ZEROES                              12020001
D28545*****    OR IN400-PV-DUMMY-SKU                                    12030001
      *           IS UPC INPUT PROVIDED ???                             12040001
               IF IN400-PV-UPC-NBR-IN = SPACES                          12050001
                   OR IN400-PV-UPC-NBR-IN NOT NUMERIC                   12060001
                   OR IN400-PV-UPC-NBR-IN = ZEROES                      12070001
      *               IS INTR-UPC-ID INPUT PROVIDED ???                 12080001
                   IF IN400-PV-UPC-ID-SPC = ZEROES                      12090001
      *                   IS ITEM NUMBER INPUT PROVIDED ???             12100001
                       IF IN400-PV-ITM-NBR-IN = SPACES                  12110001
                           OR IN400-PV-ITM-NBR-IN NOT NUMERIC           12120001
                           OR IN400-PV-ITM-NBR-IN = ZEROES              12130001
                               SET IN400-PV-NO-LOOKUP-TYPE    TO TRUE   12140001
                       ELSE                                             12150001
                           SET IN400-PV-TRY-ITM-NBR-LOOKUP TO TRUE      12160001
                           SET IN400-PV-ITM-NBR-LOOKUP    TO TRUE       12170001
                       END-IF                                           12180001
                   ELSE                                                 12190001
                       SET IN400-PV-TRY-UPC-ID-LOOKUP  TO TRUE          12200001
                       SET IN400-PV-INTR-UPC-ID-LOOKUP TO TRUE          12210001
                   END-IF                                               12220001
               ELSE                                                     12230001
                   SET IN400-PV-TRY-UPC-NBR-LOOKUP TO TRUE              12240001
                   SET IN400-PV-UPC-NBR-LOOKUP    TO TRUE               12250001
               END-IF                                                   12260001
           ELSE                                                         12270001
               SET IN400-PV-TRY-SKU-LOOKUP    TO TRUE                   12280001
               SET IN400-PV-SKU-LOOKUP        TO TRUE                   12290001
           END-IF.                                                      12300001
                                                                        12310001
           EVALUATE TRUE                                                12320001
               WHEN IN400-PV-SKU-LOOKUP                                 12330001
D28545           IF IN400-PV-DUMMY-SKU                                  12340001
D28545             MOVE IN400-PV-SKU-IN-NUM     TO IN400-PV-WORK-SKU    12350001
D28545             MOVE IN400-PV-SKU-IN-NUM     TO IN400-PV-DUMB-SKU    12360001
D28545             PERFORM IN400-DUMMY-SKU-LOOKUP                       12370001
D28545           ELSE                                                   12380001
                   MOVE IN400-PV-SKU-IN-NUM     TO IN400-PV-WORK-SKU    12390001
                   PERFORM IN400-LOOKUP-BY-SKU                          12400001
D28545           END-IF                                                 12410001
               WHEN IN400-PV-UPC-NBR-LOOKUP                             12420001
I28545           IF (IN400-PV-KOHLS-UPC AND IN400-PV-DUMMY-UPC)         12430001
D28545             MOVE IN400-PV-SKU-IN-NUM     TO IN400-PV-WORK-SKU    12440001
D28545             MOVE IN400-PV-SKU-IN-NUM     TO IN400-PV-DUMB-SKU    12450001
D28545             PERFORM IN400-DUMMY-SKU-LOOKUP                       12460001
D28545           ELSE                                                   12470001
                   MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-PV-WORK-UPC-NBR12480001
                   PERFORM IN400-LOOKUP-UPC-NBR                         12490001
D28545           END-IF                                                 12500001
               WHEN IN400-PV-INTR-UPC-ID-LOOKUP                         12510001
                   MOVE IN400-PV-UPC-ID-SPC     TO IN400-PV-WORK-UPC-ID 12520001
                   PERFORM IN400-LOOKUP-BY-UPC-ID                       12530001
               WHEN IN400-PV-ITM-NBR-LOOKUP                             12540001
                   MOVE IN400-PV-ITM-NBR-IN-NUM TO IN400-PV-WORK-ITM-NBR12550001
                   PERFORM IN400-LOOKUP-BY-ITM-NBR                      12560001
               WHEN OTHER                                               12570001
                   SET IN400-PV-NOT-FOUND        TO TRUE                12580001
D28545             SET IN400-PV-ATT-NOT-FOUND    TO TRUE                12590001
D28545             SET IN400-PV-MISSING-KEY-DATA TO TRUE                12600001
D28545             STRING '  PARA: IN400-LOOKUP-DEFAULT - '             12610001
D28545                                       DELIMITED BY SIZE          12620001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             12630001
D28545                    '  ' DELIMITED BY SIZE                        12640001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         12650001
D28545                    '  ' DELIMITED BY SIZE                        12660001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        12670001
D28545                    '  ' DELIMITED BY SIZE                        12680001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         12690001
D28545                    '  ' DELIMITED BY SIZE                        12700001
D28545                              INTO IN400-PV-PARAGRAPH             12710001
           END-EVALUATE.                                                12720001
                                                                        12730001
28545 ******************************************************************12740001
28545 ******************************************************************12750001
      ******************************************************************12760001
      * IN400-VSM-PROCEED-WITH-LOOKUP.                                  12770001
      *     INITIAL CALL WAS SUCCESSFUL - NOW FIND THE RETAIL           12780001
      ******************************************************************12790001
       IN400-VSM-PROCEED-WITH-LOOKUP.                                   12800001
                                                                        12810001
           MOVE SKXREF-INTR-UPC-ID     TO UPCPLS-UPC-ID.                12820001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST                               12830001
                                       TO UPCPLS-EFF-BEG-TMST           12840001
                                          UPCPLS-EFF-END-TMST.          12850001
                                                                        12860001
           MOVE ZEROES                TO UPCPLS-UNT-RTL-AMT             12870001
                                         UPCPLS-MEITGP-NBR.             12880001
           MOVE SPACES                TO UPCPLS-UPC-STAT-CDE            12890001
                                         UPCPLS-UPC-STAT-CHG-DTE        12900001
                                         UPCPLS-UNT-RTL-CHG-DTE.        12910001
           MOVE ZEROS               TO IN400-PV-SQL-SUB.                12920001
                                                                        12930001
           PERFORM                                                      12940001
               WITH TEST AFTER                                          12950001
               VARYING IN400-PV-SQL-SUB FROM 1 BY 1                     12960001
               UNTIL (IN400-PV-SQL-SUB > IN400-PV-MAX-RETRIES)          12970001
                   OR (SQLCODE = 0)                                     12980001
                   OR (SQLCODE = +100)                                  12990001
                                                                        13000001
               EXEC SQL                                                 13010001
28545            SELECT EFF_BEG_TMST                                    13020001
28545                  ,EFF_END_TMST                                    13030001
28545                  ,UNT_RTL_AMT                                     13040001
                       ,MEITGP_NBR                                      13050001
                       ,UPC_STAT_CDE                                    13060001
                       ,UPC_STAT_CHG_DTE                                13070001
                       ,UNT_RTL_CHG_DTE                                 13080001
28545                  ,ORIG_CLR_DTE                                    13090001
28545                  ,MKDN_CDE                                        13100001
28545            INTO :UPCPLS-EFF-BEG-TMST                              13110001
28545                ,:UPCPLS-EFF-END-TMST :IN400-PV-NULL-EFF-END-TMST  13120001
28545                ,:UPCPLS-UNT-RTL-AMT  :IN400-PV-NULL-UNT-RTL-AMT   13130001
                     ,:UPCPLS-MEITGP-NBR   :IN400-PV-NULL-MEITGP-NBR    13140001
                     ,:UPCPLS-UPC-STAT-CDE :IN400-PV-NULL-UPC-STAT-CDE  13150001
                     ,:UPCPLS-UPC-STAT-CHG-DTE                          13160001
                     ,:UPCPLS-UNT-RTL-CHG-DTE                           13170001
28545                ,:UPCPLS-ORIG-CLR-DTE :IN400-PV-NULL-ORIG-CLR-DTE  13180001
28545                ,:UPCPLS-MKDN-CDE     :IN400-PV-NULL-MKDN-CDE      13190001
                 FROM  TUPCPLS                                          13200001
                 WHERE UPC_ID        = :UPCPLS-UPC-ID                   13210001
                   AND STR_NBR       = :UPCPLS-STR-NBR                  13220001
                   AND EFF_BEG_TMST <= :UPCPLS-EFF-BEG-TMST             13230001
                   AND (EFF_END_TMST >= :UPCPLS-EFF-END-TMST            13240001
                    OR  EFF_END_TMST IS NULL)                           13250001
28545            WITH UR                                                13260001
               END-EXEC                                                 13270001
                                                                        13280001
               EVALUATE TRUE                                            13290001
                   WHEN SQLCODE = 0                                     13300001
                       SET IN400-PS-STR-FOUND  TO TRUE                  13310001
28545                  MOVE UPCPLS-UNT-RTL-AMT TO IN400-PV-WORK-RETAIL  13320001
28545                                                                   13330001
28545                  IF IN400-PV-NULL-MEITGP-NBR IS LESS THAN ZERO    13340001
28545                      MOVE ZEROS          TO UPCPLS-MEITGP-NBR     13350001
28545                  END-IF                                           13360001
28545                                                                   13370001
28545                  MOVE UPCPLS-MEITGP-NBR  TO MEITGP-MEITGP-NBR     13380001
28545                  PERFORM IN400-VSM-GROUP-PRICING                  13390001
28545                                                                   13400001
D28545                 SET IN400-PV-FOUND      TO TRUE                  13410001
D28545                 MOVE SQLCODE            TO IN400-PV-PRC-SQLCDE   13420001
                   WHEN SQLCODE = +100                                  13430001
                       IF UPCPLS-STR-NBR NOT EQUAL 0                    13440001
                           MOVE 0 TO UPCPLS-STR-NBR                     13450001
                       ELSE                                             13460001
                           PERFORM IN400-TPPCPRC-LOOKUP                 13470001
                       END-IF                                           13480001
                   WHEN SQLCODE = -904                                  13490001
                   WHEN SQLCODE = -911                                  13500001
D28545                 MOVE SQLCODE            TO IN400-PV-PRC-SQLCDE   13510001
                   WHEN OTHER                                           13520001
D28545                 SET IN400-PV-SQL-ERROR  TO TRUE                  13530001
RONNAQ                 SET IN400-PV-INVALID-KEY-INPUT TO TRUE           13540001
RONNAQ                 SET IN400-PV-NOT-FOUND    TO TRUE                13550001
D28545                 MOVE SQLCODE            TO IN400-PV-PRC-SQLCDE   13560001
RONNAQ                 STRING                                           13570001
RONNAQ             '  PARA: MAX RETRY IN400-VSM-PROCEED-WITH-LOOKUP - ' 13580001
RONNAQ                                   DELIMITED BY SIZE              13590001
RONNAQ                 IN400-PV-SKU-IN DELIMITED BY SIZE                13591001
RONNAQ                 '  ' DELIMITED BY SIZE                           13592001
RONNAQ                 IN400-PV-UPC-NBR-IN DELIMITED BY SIZE            13593001
RONNAQ                 '  ' DELIMITED BY SIZE                           13594001
RONNAQ                 IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE           13595001
RONNAQ                 '  ' DELIMITED BY SIZE                           13596001
RONNAQ                 IN400-PV-ITM-NBR-IN DELIMITED BY SIZE            13597001
RONNAQ                 '  ' DELIMITED BY SIZE                           13598001
RONNAQ                              INTO IN400-PV-PARAGRAPH             13599001
               END-EVALUATE                                             13600001
           END-PERFORM.                                                 13610001
                                                                        13620001
           IF IN400-PV-SQL-SUB > IN400-PV-MAX-RETRIES                   13630001
D28545         SET IN400-PV-SQL-ERROR    TO TRUE                        13640001
D28545         SET IN400-PV-NOT-FOUND    TO TRUE                        13650001
D28545         MOVE SQLCODE              TO IN400-PV-PRC-SQLCDE         13660001
D28545         STRING                                                   13670001
D28545             '  PARA: MAX RETRY IN400-VSM-PROCEED-WITH-LOOKUP - ' 13680001
D28545                                   DELIMITED BY SIZE              13690001
D28545             IN400-PV-SKU-IN DELIMITED BY SIZE                    13700001
D28545             '  ' DELIMITED BY SIZE                               13710001
D28545             IN400-PV-UPC-NBR-IN DELIMITED BY SIZE                13720001
D28545             '  ' DELIMITED BY SIZE                               13730001
D28545             IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE               13740001
D28545             '  ' DELIMITED BY SIZE                               13750001
D28545             IN400-PV-ITM-NBR-IN DELIMITED BY SIZE                13760001
D28545             '  ' DELIMITED BY SIZE                               13770001
D28545                              INTO IN400-PV-PARAGRAPH             13780001
D28545     END-IF.                                                      13790001
D28545                                                                  13800001
      ******************************************************************13810001
      * IN400-VSM-GROUP-PRICING.                                        13820001
      *     IF THE ITEM IS PART OF A GROUP-PRICING RETAIL, RESOLVE TO   13830001
      *     AN INDIVIDUAL PRICE BEFORE RETURNING RETAIL TO OUTPUT FIELD 13840001
      ******************************************************************13850001
       IN400-VSM-GROUP-PRICING.                                         13860001
                                                                        13870001
            IF UPCPLS-MEITGP-NBR EQUAL 0                                13880001
28545           MOVE ZEROS     TO IN400-PV-MITGPL-QTY                   13890001
28545           MOVE ZEROS     TO IN400-PV-MITGPL-GP-AMT                13900001
                SET IN400-PS-RTL-FOUND TO TRUE                          13910001
            ELSE                                                        13920001
                EXEC SQL                                                13930001
                    SELECT MITGPL_QTY                                   13940001
                          ,GP_AMT                                       13950001
                    INTO :MITGPL-MITGPL-QTY                             13960001
                        ,:MITGPL-GP-AMT                                 13970001
                    FROM TMITGPL                                        13980001
                    WHERE OPERCO_NBR = '03'                             13990001
28545                 AND MEITGP_NBR = :MEITGP-MEITGP-NBR               14000001
                      AND ADLOC_ID = '   '                              14010001
28545                 AND (:IN400-PV-EFF-BEG-DTE-X                      14020001
28545                              BETWEEN BEG_DTE AND END_DTE)         14030001
28545               WITH UR                                             14040001
                END-EXEC                                                14050001
                                                                        14060001
                EVALUATE TRUE                                           14070001
                  WHEN SQLCODE = ZERO                                   14080001
                    COMPUTE IN400-PV-WORK-RETAIL ROUNDED =              14090001
                              (MITGPL-GP-AMT / MITGPL-MITGPL-QTY )      14100001
28545               MOVE MITGPL-MITGPL-QTY TO IN400-PV-MITGPL-QTY       14110001
28545               MOVE MITGPL-GP-AMT     TO IN400-PV-MITGPL-GP-AMT    14120001
                    SET IN400-PS-RTL-FOUND TO TRUE                      14130001
D28545            WHEN OTHER                                            14140001
D28545              MOVE ZEROS             TO IN400-PV-MITGPL-QTY       14150001
D28545              MOVE ZEROS             TO IN400-PV-MITGPL-GP-AMT    14160001
D28545              SET IN400-PS-RTL-FOUND TO TRUE                      14170001
                END-EVALUATE                                            14180001
            END-IF.                                                     14190001
                                                                        14200001
      ******************************************************************14210001
      * IN400-VSM-PRICE-OUTPUT. MOVE BASE DATA TO OUTPUT LAYOUT         14220001
      * THE OUTPUT SKU MAY NOT NECESSARILY BE THE SAME AS THE INPUT SKU.14230001
      * IF THE INPUT SKU WAS RENUMBERED, THE RENUMBER SKU IS SPEWED OUT 14240001
      * AND IS DERIVED FROM THE TUPC.UPC_NBR (KOHLS INTERNAL UPC NUMBER)14250001
      ******************************************************************14260001
       IN400-VSM-PRICE-OUTPUT.                                          14270001
                                                                        14280001
Z28545     MOVE SKXREF-SKU              TO IN400-PRC-SKU-OUT.           14290001
Z28545                                                                  14300001
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   14310001
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-PRC-UPC-OUT        14320001
Z28545     ELSE                                                         14330001
Z28545         MOVE UPC-UPC-NBR             TO IN400-PRC-UPC-OUT        14340001
Z28545     END-IF.                                                      14350001
28545                                                                   14360001
28545      MOVE SKXREF-INTR-UPC-ID      TO IN400-PRC-UPCID-OUT.         14370001
28545      MOVE SKXREF-ITM-NBR          TO IN400-PRC-ITM-NBR-OUT.       14380001
28545                                                                   14390001
28545      MOVE UPCPLS-EFF-BEG-TMST (1:10)                              14400001
28545                                   TO IN400-PRC-EFF-BEG-DTE-OUT.   14410001
28545                                                                   14420001
28545      IF IN400-PV-NULL-EFF-END-TMST IS LESS THAN ZEROS             14430001
28545          MOVE SPACES              TO IN400-PRC-EFF-END-DTE-OUT    14440001
28545      ELSE                                                         14450001
28545          MOVE UPCPLS-EFF-END-TMST (1:10)                          14460001
28545                                   TO IN400-PRC-EFF-END-DTE-OUT    14470001
28545      END-IF.                                                      14480001
28545                                                                   14490001
28545      IF IN400-PV-NULL-UPC-STAT-CDE IS LESS THAN ZEROS             14500001
28545          MOVE SPACES              TO IN400-PRC-STATUS-OUT         14510001
28545      ELSE                                                         14520001
28545          MOVE UPCPLS-UPC-STAT-CDE TO IN400-PRC-STATUS-OUT         14530001
28545      END-IF.                                                      14540001
28545                                                                   14550001
28545      MOVE UPCPLS-UPC-STAT-CHG-DTE TO IN400-PRC-STAT-CHG-DTE-OUT.  14560001
28545      MOVE UPCPLS-UNT-RTL-CHG-DTE  TO IN400-PRC-UPC-CHG-DTE-OUT.   14570001
28545                                                                   14580001
28545      IF IN400-PV-NULL-ORIG-CLR-DTE IS LESS THAN ZEROS             14590001
28545          MOVE SPACES                TO IN400-PRC-ORIG-CLR-DTE     14600001
28545      ELSE                                                         14610001
28545          MOVE UPCPLS-ORIG-CLR-DTE TO IN400-PRC-ORIG-CLR-DTE       14620001
28545      END-IF.                                                      14630001
28545                                                                   14640001
28545      IF IN400-PV-NULL-MKDN-CDE IS LESS THAN ZEROS                 14650001
28545          MOVE SPACES              TO IN400-PRC-MKDN-CDE           14660001
28545      ELSE                                                         14670001
28545          MOVE UPCPLS-MKDN-CDE     TO IN400-PRC-MKDN-CDE           14680001
28545      END-IF.                                                      14690001
28545                                                                   14700001
28545      IF IN400-PV-NULL-MEITGP-NBR IS LESS THAN ZEROS               14710001
28545          MOVE ZEROS               TO IN400-PRC-MEITGP-NBR         14720001
28545      ELSE                                                         14730001
28545          MOVE UPCPLS-MEITGP-NBR   TO IN400-PRC-MEITGP-NBR         14740001
28545      END-IF.                                                      14750001
28545                                                                   14760001
28545      MOVE IN400-PV-MITGPL-QTY     TO IN400-PRC-MITGPL-QTY.        14770001
28545      MOVE IN400-PV-MITGPL-GP-AMT  TO IN400-PRC-GP-AMT.            14780001
28545                                                                   14790001
28545      MOVE IN400-PV-WORK-RETAIL    TO IN400-PRC-UNIT-RTL-OUT.      14800001
28545      MOVE ZEROS                   TO IN400-PRC-EXTD-RTL-OUT.      14810001
28545                                                                   14820001
28545 ******************************************************************14830001
28545 * IN400-TPPCPRC-LOOKUP                                            14840001
28545 ******************************************************************14850001
28545  IN400-TPPCPRC-LOOKUP.                                            14860001
28545                                                                   14870001
28545 *** STORE SPECIFIC - PERM PRICE TABLE PRICE LOOKUP....            14880001
D28545     MOVE ZEROS            TO IN400-PV-PRC-SQLCDE.                14890001
D28545     MOVE ZEROS            TO IN400-PV-RETURN-CDE.                14900001
D28545     MOVE ZEROS            TO IN400-PV-ATT-SQLCDE.                14910001
D28545     MOVE ZEROS            TO IN400-PV-ATT-RTNCDE.                14920001
D28545     MOVE SPACES           TO IN400-PV-RETURN-RSN.                14930001
28545      MOVE 'N'              TO IN400-PS-PRIOR-FOUND-SW.            14940001
28545      MOVE 'N'              TO IN400-PS-END-TPPCPRC-CSR-SW.        14950001
28545      MOVE IN400-PV-LOC-IN-NUM       TO PPCPRC-STR-NBR.            14960001
28545      MOVE SKXREF-ITM-NBR            TO PPCPRC-TSK-ITM-NBR         14970001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST TO PPCPRC-STRT-TMST.          14980001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST TO PPCPRC-END-TMST.           14990001
28545                                                                   15000001
28545      PERFORM IN400-OPEN-TPPCPRC-CSR.                              15010001
28545      PERFORM IN400-FETCH-TPPCPRC-CSR                              15020001
28545        UNTIL IN400-PRIOR-FOUND                                    15030001
28545           OR IN400-PS-END-TPPCPRC-CSR.                            15040001
28545      PERFORM IN400-CLOSE-TPPCPRC-CSR.                             15050001
28545                                                                   15060001
28545 *** CORPORATE - PERM PRICE TABLE PRICE LOOKUP....                 15070001
28545      IF IN400-PRIOR-NOT-FOUND                                     15080001
D28545         MOVE ZEROS            TO IN400-PV-PRC-SQLCDE             15090001
D28545         MOVE ZEROS            TO IN400-PV-RETURN-CDE             15100001
D28545         MOVE ZEROS            TO IN400-PV-ATT-SQLCDE             15110001
D28545         MOVE ZEROS            TO IN400-PV-ATT-RTNCDE             15120001
D28545         MOVE SPACES           TO IN400-PV-RETURN-RSN             15130001
28545          MOVE 'N'              TO IN400-PS-PRIOR-FOUND-SW         15140001
28545          MOVE 'N'              TO IN400-PS-END-TPPCPRC-CSR-SW     15150001
28545          MOVE ZEROS            TO PPCPRC-STR-NBR                  15160001
28545          MOVE SKXREF-ITM-NBR   TO PPCPRC-TSK-ITM-NBR              15170001
28545          MOVE IN400-PV-EFF-BEG-DTE-TMST TO PPCPRC-STRT-TMST       15180001
28545          MOVE IN400-PV-EFF-BEG-DTE-TMST TO PPCPRC-END-TMST        15190001
28545          PERFORM IN400-OPEN-TPPCPRC-CSR                           15200001
28545          PERFORM IN400-FETCH-TPPCPRC-CSR                          15210001
28545            UNTIL IN400-PRIOR-FOUND                                15220001
28545               OR IN400-PS-END-TPPCPRC-CSR                         15230001
28545          PERFORM IN400-CLOSE-TPPCPRC-CSR                          15240001
28545      END-IF.                                                      15250001
28545                                                                   15260001
28545 *** PRICE NOT FOUND....                                           15270001
28545      IF IN400-PRIOR-NOT-FOUND                                     15280001
28545          SET IN400-PS-STR-NOT-FOUND TO TRUE                       15290001
I28545     ELSE                                                         15300001
I28545         SET IN400-PS-STR-FOUND     TO TRUE                       15310001
28545      END-IF.                                                      15320001
28545                                                                   15330001
28545 ******************************************************************15340001
28545 * IN400-OPEN-TPPCPRC-CSR.                                         15350001
28545 ******************************************************************15360001
28545  IN400-OPEN-TPPCPRC-CSR.                                          15370001
28545                                                                   15380001
28545      EXEC SQL                                                     15390001
28545           OPEN TPPCPRC-CSR                                        15400001
28545      END-EXEC.                                                    15410001
28545                                                                   15411001
28545      EVALUATE TRUE                                                15412001
28545          WHEN SQLCODE = +0                                        15413001
D28545             CONTINUE                                             15414001
D28545         WHEN OTHER                                               15415001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   15416001
D28545             SET IN400-PV-CURSOR-OPEN   TO TRUE                   15417001
D28545             MOVE SQLCODE      TO IN400-PV-PRC-SQLCDE             15418001
D28545             STRING '  PARA: IN400-OPEN-TPPCPRC-CSR - '           15419001
D28545                                       DELIMITED BY SIZE          15420001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             15430001
D28545                    '  ' DELIMITED BY SIZE                        15440001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         15450001
D28545                    '  ' DELIMITED BY SIZE                        15460001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        15470001
D28545                    '  ' DELIMITED BY SIZE                        15480001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         15490001
D28545                    '  ' DELIMITED BY SIZE                        15500001
D28545                              INTO IN400-PV-PARAGRAPH             15510001
D28545     END-EVALUATE.                                                15520001
D28545                                                                  15530001
28545 ******************************************************************15540001
28545 * IN400-FETCH-TPPCPRC-CSR.                                        15550001
28545 ******************************************************************15560001
28545  IN400-FETCH-TPPCPRC-CSR.                                         15570001
28545                                                                   15580001
28545      EXEC SQL                                                     15590001
28545          FETCH TPPCPRC-CSR                                        15600001
28545          INTO :PPCPRC-RTL-AMT                                     15610001
28545              ,:PPCPRC-MEITGP-NBR                                  15620001
28545              ,:PPCPRC-STATUS-CDE                                  15630001
28545      END-EXEC.                                                    15640001
28545                                                                   15650001
28545      EVALUATE TRUE                                                15660001
28545          WHEN SQLCODE = +0                                        15670001
28545              MOVE PPCPRC-RTL-AMT    TO IN400-PV-WORK-RETAIL       15680001
28545              MOVE PPCPRC-MEITGP-NBR TO MEITGP-MEITGP-NBR          15690001
28545              PERFORM IN400-VSM-GROUP-PRICING                      15700001
28545              SET IN400-PRIOR-FOUND  TO TRUE                       15710001
D28545             SET IN400-PV-FOUND     TO TRUE                       15720001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        15730001
D28545             MOVE SPACES            TO IN400-PV-PARAGRAPH         15740001
28545          WHEN SQLCODE = +100                                      15750001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       15760001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 15770001
28545              SET IN400-PS-END-TPPCPRC-CSR TO TRUE                 15780001
D28545             SET IN400-PV-NOT-FOUND       TO TRUE                 15790001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        15800001
D28545             STRING '  PARA: IN400-FETCH-TPPCPRC-CSR - '          15810001
D28545                                       DELIMITED BY SIZE          15820001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             15830001
D28545                    '  ' DELIMITED BY SIZE                        15840001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         15850001
D28545                    '  ' DELIMITED BY SIZE                        15860001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        15870001
D28545                    '  ' DELIMITED BY SIZE                        15880001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         15890001
D28545                    '  ' DELIMITED BY SIZE                        15900001
D28545                              INTO IN400-PV-PARAGRAPH             15910001
28545          WHEN OTHER                                               15920001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       15930001
28545              SET IN400-PV-SQL-ERROR       TO TRUE                 15940001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 15950001
28545              SET IN400-PS-END-TPPCPRC-CSR TO TRUE                 15960001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              15970001
D28545             STRING '  PARA: IN400-FETCH-TPPCPRC-CSR - '          15980001
D28545                                       DELIMITED BY SIZE          15990001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             16000001
D28545                    '  ' DELIMITED BY SIZE                        16010001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         16020001
D28545                    '  ' DELIMITED BY SIZE                        16030001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        16040001
D28545                    '  ' DELIMITED BY SIZE                        16050001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         16060001
D28545                    '  ' DELIMITED BY SIZE                        16070001
D28545                              INTO IN400-PV-PARAGRAPH             16080001
28545      END-EVALUATE.                                                16090001
28545                                                                   16100001
28545 ******************************************************************16110001
28545 * IN400-CLOSE-TPPCPRC-CSR.                                        16120001
28545 ******************************************************************16130001
28545  IN400-CLOSE-TPPCPRC-CSR.                                         16140001
28545                                                                   16150001
28545      EXEC SQL                                                     16160001
28545          CLOSE TPPCPRC-CSR                                        16170001
28545      END-EXEC.                                                    16180001
28545                                                                   16190001
28545      EVALUATE TRUE                                                16200001
28545          WHEN SQLCODE = +0                                        16210001
D28545             CONTINUE                                             16220001
28545          WHEN OTHER                                               16230001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   16240001
D28545             SET IN400-PV-CURSOR-CLOSE  TO TRUE                   16250001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              16260001
D28545             STRING '  PARA: IN400-CLOSE-TPPCPRC-CSR - '          16270001
D28545                                       DELIMITED BY SIZE          16280001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             16290001
D28545                    '  ' DELIMITED BY SIZE                        16300001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         16310001
D28545                    '  ' DELIMITED BY SIZE                        16320001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        16330001
D28545                    '  ' DELIMITED BY SIZE                        16340001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         16350001
D28545                    '  ' DELIMITED BY SIZE                        16360001
D28545                              INTO IN400-PV-PARAGRAPH             16370001
28545      END-EVALUATE.                                                16380001
28545                                                                   16390001
28545 ******************************************************************16400001
28545 ******************************************************************16410001
28545 ******************************************************************16420001
28545 * IN400-VSM-ATTRIBUTES-LOOKUP.                                    16430001
28545 ******************************************************************16440001
28545  IN400-VSM-ATTRIBUTES-LOOKUP.                                     16450001
28545                                                                   16460001
28545      EXEC SQL                                                     16470001
28545          SELECT A.SKU                                             16480001
28545                ,A.ITM_NBR                                         16490001
28545                ,A.DEPT                                            16500001
28545                ,CLASS                                             16510001
28545                ,SUBCLASS                                          16520001
D28545               ,A.SKU_STAT_CDE                                    16530001
D28545               ,B.UPC_NBR                                         16540001
28545                ,B.SUB_CL_MDSEAR_ID                                16550001
28545                ,B.VS_ID                                           16560001
28545                ,B.INTR_UPC_ID                                     16570001
28545                ,C.ENT_ID                                          16580001
28545                ,C.VS_NBR                                          16590001
28545                ,D.RMS_STYL_ID                                     16600001
RONNA                ,D.LBL_SEQ_NBR                                     16610001
28545                ,E.DUN_NBR                                         16620001
28545                ,F.INHOUSE_NBR                                     16630001
28545          INTO :SKXREF-SKU                                         16640001
28545                ,:SKXREF-ITM-NBR                                   16650001
28545                ,:SKXREF-DEPT                                      16660001
28545                ,:SKXREF-CLASS                                     16670001
28545                ,:SKXREF-SUBCLASS                                  16680001
D28545               ,:SKXREF-SKU-STAT-CDE                              16690001
D28545               ,:UPC-UPC-NBR                                      16700001
28545                ,:UPC-SUB-CL-MDSEAR-ID                             16710001
28545                ,:UPC-VS-ID                                        16720001
28545                ,:UPC-INTR-UPC-ID                                  16730001
28545                ,:VNDSTL-ENT-ID                                    16740001
28545                ,:VNDSTL-VS-NBR                                    16750001
28545                ,:MDARVS-RMS-STYL-ID                               16760001
RONNA                ,:MDARVS-LBL-SEQ-NBR                               16770001
28545                ,:EXTENT-DUN-NBR                                   16780001
28545                ,:VNDDPT-INHOUSE-NBR                               16790001
28545         FROM TSKXREF A                                            16800001
28545             ,TUPC B                                               16810001
28545             ,TVNDSTL C                                            16820001
28545             ,TMDARVS D                                            16830001
28545             ,TEXTENT E                                            16840001
28545             ,TVNDDPT F                                            16850001
28545         WHERE A.INTR_UPC_ID = :SKXREF-INTR-UPC-ID                 16860001
28545             AND A.SKU_STAT_CDE NOT IN ('98', '00')                16870001
28545             AND A.INTR_UPC_ID = B.INTR_UPC_ID                     16880001
28545             AND B.INTR_UPC_ID = B.UPC_ID                          16890001
28545             AND B.VS_ID = C.VS_ID                                 16900001
28545             AND :IN400-PV-EFF-BEG-DTE BETWEEN B.EFF_BEG_DTE       16910001
28545                     AND COALESCE(B.EFF_END_DTE, '9999-12-31')     16920001
A28545            AND B.SUB_CL_MDSEAR_ID = D.SUB_CL_MDSEAR_ID           16930001
28545             AND C.VS_ID = D.VS_ID                                 16940001
28545             AND C.ENT_ID = E.ENT_ID                               16950001
28545             AND C.ENT_ID = F.ENT_ID                               16960001
28545             AND A.DEPT = INTEGER(F.DEPT_NBR)                      16970001
28545         WITH UR                                                   16980001
28545      END-EXEC.                                                    16990001
28545                                                                   17000001
28545      EVALUATE TRUE                                                17010001
28545          WHEN SQLCODE = 0                                         17020001
D28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              17030001
D28545             SET IN400-PS-ATTR-FOUND TO TRUE                      17040001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              17050001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               17060001
RONNA              IF MDARVS-LBL-SEQ-NBR = ZERO                         17070001
RONNA                 MOVE 2230     TO MDARVS-LBL-SEQ-NBR               17080001
RONNA              END-IF                                               17090001
28545          WHEN SQLCODE = +100                                      17100001
28545              MOVE ZEROS       TO SKXREF-SKU                       17110001
28545              MOVE ZEROS       TO SKXREF-ITM-NBR                   17120001
28545              MOVE ZEROS       TO SKXREF-DEPT                      17130001
28545              MOVE ZEROS       TO SKXREF-CLASS                     17140001
28545              MOVE ZEROS       TO SKXREF-SUBCLASS                  17150001
28545              MOVE ZEROS       TO UPC-SUB-CL-MDSEAR-ID             17160001
28545              MOVE ZEROS       TO UPC-VS-ID                        17170001
28545              MOVE ZEROS       TO UPC-INTR-UPC-ID                  17180001
JAS                MOVE 5161        TO VNDSTL-ENT-ID                    17190001
28545              MOVE ZEROS       TO VNDSTL-VS-NBR                    17191001
28545              MOVE ZEROS       TO MDARVS-RMS-STYL-ID               17192001
RONNA              MOVE 2230        TO MDARVS-LBL-SEQ-NBR               17193001
28545              MOVE ZEROS       TO EXTENT-DUN-NBR                   17194001
28545              MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               17195001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   17196001
D28545             SET IN400-PV-VSM-LOOKUP    TO TRUE                   17197001
D28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  17198001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              17199001
D28545             STRING '  PARA: IN400-VSM-ATTRIBUTES-LOOKUP - '      17200001
D28545                                       DELIMITED BY SIZE          17210001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             17220001
D28545                    '  ' DELIMITED BY SIZE                        17230001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         17240001
D28545                    '  ' DELIMITED BY SIZE                        17250001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        17260001
D28545                    '  ' DELIMITED BY SIZE                        17270001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         17280001
D28545                    '  ' DELIMITED BY SIZE                        17290001
D28545                              INTO IN400-PV-PARAGRAPH             17300001
28545          WHEN OTHER                                               17310001
D28545             MOVE ZEROS       TO SKXREF-SKU                       17320001
D28545             MOVE ZEROS       TO SKXREF-ITM-NBR                   17330001
D28545             MOVE ZEROS       TO SKXREF-DEPT                      17340001
D28545             MOVE ZEROS       TO SKXREF-CLASS                     17350001
D28545             MOVE ZEROS       TO SKXREF-SUBCLASS                  17360001
D28545             MOVE ZEROS       TO UPC-SUB-CL-MDSEAR-ID             17370001
D28545             MOVE ZEROS       TO UPC-VS-ID                        17380001
D28545             MOVE ZEROS       TO UPC-INTR-UPC-ID                  17390001
D28545             MOVE ZEROS       TO VNDSTL-ENT-ID                    17400001
D28545             MOVE ZEROS       TO VNDSTL-VS-NBR                    17410001
D28545             MOVE ZEROS       TO MDARVS-RMS-STYL-ID               17420001
RONNA              MOVE 2230        TO MDARVS-LBL-SEQ-NBR               17430001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   17440001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               17450001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   17460001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   17470001
D28545             SET IN400-PV-VSM-LOOKUP    TO TRUE                   17480001
D28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  17490001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              17500001
D28545             STRING '  PARA: IN400-VSM-ATTRIBUTES-LOOKUP - '      17510001
D28545                                       DELIMITED BY SIZE          17520001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             17530001
D28545                    '  ' DELIMITED BY SIZE                        17540001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         17550001
D28545                    '  ' DELIMITED BY SIZE                        17560001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        17570001
D28545                    '  ' DELIMITED BY SIZE                        17580001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         17590001
D28545                    '  ' DELIMITED BY SIZE                        17600001
D28545                              INTO IN400-PV-PARAGRAPH             17610001
28545      END-EVALUATE.                                                17620001
RONNA      MOVE SKXREF-SKU        TO IN400-PV-WORK-SKU.                 17630001
28545                                                                   17640001
J28545******************************************************************17650001
J28545* IN400-INVENTORY-RECLASS.                                        17660001
J28545******************************************************************17670001
J28545 IN400-INVENTORY-RECLASS.                                         17680001
J28545                                                                  17690001
J28545     INITIALIZE DCLIMT00015.                                      17700001
J28545     MOVE ZEROS             TO IN400-PV-NULL-ID.                  17710001
J28545     MOVE ZEROS             TO IN400-PV-PRC-SQLCDE.               17720001
J28545     MOVE ZEROS             TO IN400-PV-RETURN-CDE.               17730001
J28545     MOVE ZEROS             TO IN400-PV-ATT-SQLCDE.               17740001
J28545     MOVE ZEROS             TO IN400-PV-ATT-RTNCDE.               17750001
J28545     MOVE SPACES            TO IN400-PV-RETURN-RSN.               17760001
J28545     MOVE SPACES            TO IN400-PV-MIN-RECLS-TMST.           17770001
J28545     MOVE 'N'               TO IN400-PS-RECLASS-FOUND-SW.         17780001
J28545     MOVE IN400-PV-WORK-SKU TO IMT00015-SKU-NBR.                  17790001
J28545     MOVE IN400-PV-EFF-BEG-DTE-TMST TO IMT00015-RECLS-TMST.       17800001
J28545                                                                  17801001
J28545     EXEC SQL                                                     17802001
J28545         SELECT MIN(RECLS_TMST)                                   17803001
J28545         INTO :IN400-PV-MIN-RECLS-TMST :IN400-PV-NULL-ID          17804001
J28545         FROM IMT_RECLS                                           17805001
J28545         WHERE (RECLS_TMST >= :IMT00015-RECLS-TMST                17806001
J28545           AND RECLS_TMST <= CURRENT_TIMESTAMP)                   17806101
J28545           AND SKU_NBR = :IMT00015-SKU-NBR                        17806201
J28545         WITH UR                                                  17806301
J28545     END-EXEC.                                                    17806401
J28545                                                                  17806501
J28545     EVALUATE TRUE                                                17806601
J28545         WHEN SQLCODE = 0                                         17806701
J28545           IF IN400-PV-NULL-ID IS LESS THAN ZEROS                 17806801
J28545             MOVE 'N'         TO IN400-PS-RECLASS-FOUND-SW        17806901
J28545           ELSE                                                   17807001
J28545           IF IN400-PV-MIN-RECLS-TMST NOT EQUAL SPACES            17807101
J28545             MOVE 'Y'         TO IN400-PS-RECLASS-FOUND-SW        17807201
J28545           ELSE                                                   17807301
J28545             MOVE 'N'         TO IN400-PS-RECLASS-FOUND-SW        17807401
J28545           END-IF                                                 17807501
J28545           END-IF                                                 17807601
J28545         WHEN SQLCODE = +100                                      17807701
J28545             MOVE 'N'         TO IN400-PS-RECLASS-FOUND-SW        17807801
J28545         WHEN OTHER                                               17807901
J28545             MOVE 'N'         TO IN400-PS-RECLASS-FOUND-SW        17808001
J28545     END-EVALUATE.                                                17808101
J28545                                                                  17808201
J28545     IF IN400-PS-RECLASS-FOUND                                    17808301
J28545       INITIALIZE DCLIMT00015                                     17808401
J28545       MOVE IN400-PV-WORK-SKU TO IMT00015-SKU-NBR                 17808501
J28545       MOVE IN400-PV-MIN-RECLS-TMST TO IMT00015-RECLS-TMST        17808601
J28545                                                                  17808701
J28545       EXEC SQL                                                   17808801
J28545         SELECT RECLS_TMST                                        17808901
J28545               ,OLD_DEPT_NBR                                      17809001
J28545               ,OLD_MAJ_CL_NBR                                    17809101
J28545               ,OLD_SUB_CL_NBR                                    17809201
J28545               ,SKU_NBR                                           17809301
J28545               ,NW_DEPT_NBR                                       17809401
J28545               ,NW_MAJ_CL_NBR                                     17809501
J28545               ,NW_SUB_CL_NBR                                     17809601
J28545         INTO :IMT00015-RECLS-TMST                                17809701
J28545             ,:IMT00015-OLD-DEPT-NBR                              17809801
J28545             ,:IMT00015-OLD-MAJ-CL-NBR                            17809901
J28545             ,:IMT00015-OLD-SUB-CL-NBR                            17810001
J28545             ,:IMT00015-SKU-NBR                                   17811001
J28545             ,:IMT00015-NW-DEPT-NBR                               17812001
J28545             ,:IMT00015-NW-MAJ-CL-NBR                             17812101
J28545             ,:IMT00015-NW-SUB-CL-NBR                             17812201
J28545         FROM IMT_RECLS                                           17812301
J28545         WHERE RECLS_TMST = :IMT00015-RECLS-TMST                  17812401
J28545           AND SKU_NBR = :IMT00015-SKU-NBR                        17812501
J28545         WITH UR                                                  17812601
J28545       END-EXEC                                                   17812701
J28545                                                                  17812801
J28545       EVALUATE TRUE                                              17812901
J28545         WHEN SQLCODE = 0                                         17813001
J28545             MOVE IMT00015-OLD-DEPT-NBR   TO SKXREF-DEPT          17813101
J28545             MOVE IMT00015-OLD-MAJ-CL-NBR TO SKXREF-CLASS         17813201
J28545             MOVE IMT00015-OLD-SUB-CL-NBR TO SKXREF-SUBCLASS      17813301
J28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              17813401
J28545             SET IN400-PS-ATTR-FOUND      TO TRUE                 17813501
J28545             MOVE SQLCODE                 TO IN400-PV-ATT-SQLCDE  17813601
J28545             MOVE SPACES                  TO IN400-PV-PARAGRAPH   17813701
J28545         WHEN SQLCODE = +100                                      17813801
J28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           17813901
J28545             SET IN400-PS-ATTR-FOUND TO TRUE                      17814001
J28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              17814101
J28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               17814201
J28545         WHEN OTHER                                               17814301
J28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   17814401
J28545             SET IN400-PV-SQL-ERROR     TO TRUE                   17814501
J28545             SET IN400-PV-INV-RCLSS-LOOKUP TO TRUE                17814601
J28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  17814701
J28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              17814801
J28545             STRING '  PARA: IN400-INVENTORY-RECLASS - '          17814901
J28545                                       DELIMITED BY SIZE          17815001
J28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             17815101
J28545                    '  ' DELIMITED BY SIZE                        17815201
J28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         17815301
J28545                    '  ' DELIMITED BY SIZE                        17815401
J28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        17815501
J28545                    '  ' DELIMITED BY SIZE                        17815601
J28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         17815701
J28545                    '  ' DELIMITED BY SIZE                        17815801
J28545                              INTO IN400-PV-PARAGRAPH             17815901
J28545       END-EVALUATE                                               17816001
J28545     END-IF.                                                      17816101
J28545                                                                  17816201
D28545******************************************************************17816301
D28545* IN400-VSM-PLU-DWNLD-LOOKUP.                                     17816401
D28545******************************************************************17816501
D28545 IN400-VSM-PLU-DWNLD-LOOKUP.                                      17816601
D28545                                                                  17816701
D28545     INITIALIZE DCLTUPCSKU.                                       17816801
D28545                                                                  17816901
D28545     MOVE SKXREF-ITM-NBR    TO TUPCSKU-ITEM-NBR.                  17817001
D28545                                                                  17817101
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   17817201
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO TUPCSKU-UPC-NBR          17817301
Z28545     ELSE                                                         17817401
Z28545         MOVE UPC-UPC-NBR             TO TUPCSKU-UPC-NBR          17817501
Z28545     END-IF.                                                      17817601
28545                                                                   17817701
D28545     EXEC SQL                                                     17817801
D28545         SELECT PLU_DWNLD_IND                                     17817901
D28545         INTO :TUPCSKU-PLU-DWNLD-IND                              17818001
D28545         FROM TUPCSKU                                             17819001
D28545         WHERE ITEM_NBR = :TUPCSKU-ITEM-NBR                       17820001
D28545           AND UPC_NBR = :TUPCSKU-UPC-NBR                         17830001
D28545         WITH UR                                                  17840001
D28545     END-EXEC.                                                    17850001
D28545                                                                  17860001
D28545     EVALUATE TRUE                                                17870001
D28545         WHEN SQLCODE = 0                                         17880001
D28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              17890001
D28545             SET IN400-PS-ATTR-FOUND TO TRUE                      17900001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              17910001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               17920001
D28545         WHEN SQLCODE = +100                                      17930001
D28545             MOVE SPACE       TO TUPCSKU-PLU-DWNLD-IND            17940001
D28545             SET IN400-PV-FOUND-WITH-ASSUMPTION TO TRUE           17950001
D28545             SET IN400-PS-ATTR-FOUND TO TRUE                      17960001
D28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              17970001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               17980001
D28545         WHEN OTHER                                               17990001
D28545             MOVE SPACE       TO TUPCSKU-PLU-DWNLD-IND            18000001
D28545             SET IN400-PV-FOUND-WITH-ASSUMPTION TO TRUE           18010001
D28545             SET IN400-PS-ATTR-FOUND TO TRUE                      18020001
D28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              18030001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               18040001
D28545     END-EVALUATE.                                                18050001
D28545                                                                  18060001
28545 ******************************************************************18070001
28545 * IN400-VSM-MBS-LOOKUP.                                           18071001
28545 ******************************************************************18072001
28545  IN400-VSM-MBS-LOOKUP.                                            18073001
28545                                                                   18074001
28545      MOVE SKXREF-DEPT             TO IN400-CONVERT-DEPT.          18075001
28545      MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          18076001
28545                                                                   18077001
28545      EXEC SQL                                                     18078001
I28545       SELECT A.BYR_NBR                                           18079001
I28545             ,A.GMA_NBR                                           18080001
I28545             ,A.DMA_NBR                                           18090001
I28545       INTO :IN400-ATT-BYR-NBR                                    18100001
I28545           ,:IN400-ATT-GMA-NBR                                    18110001
I28545           ,:IN400-ATT-DMA-NBR                                    18120001
I28545       FROM TMDSEAR A                                             18130001
I28545       WHERE A.DEPT_NBR = :IN400-PV-WORK-DEPT-3X                  18140001
I28545         AND A.MDSELV_CDE = 'DPT'                                 18150001
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= A.STRT_DTE AND           18160001
I28545              :IN400-PV-EFF-BEG-DTE-X <= A.END_DTE)               18170001
I28545       WITH UR                                                    18180001
28545      END-EXEC.                                                    18190001
28545                                                                   18200001
28545      EVALUATE TRUE                                                18210001
28545          WHEN SQLCODE = 0                                         18220001
I28545             PERFORM IN400-VSM-MBS-BYR-LOOKUP                     18230001
I28545             PERFORM IN400-VSM-MBS-DMM-LOOKUP                     18240001
I28545             PERFORM IN400-VSM-MBS-GMM-LOOKUP                     18250001
I28545             PERFORM IN400-VSM-MBS-DESC-LOOKUP                    18260001
28545          WHEN SQLCODE = +100                                      18270001
I28545             MOVE SPACES      TO IN400-ATT-GMA-NBR                18280001
I28545             MOVE SPACES      TO IN400-ATT-DMA-NBR                18290001
I28545             MOVE SPACES      TO IN400-ATT-BYR-NBR                18300001
I28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          18310001
I28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           18320001
I28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          18330001
I28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           18340001
I28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          18350001
I28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           18360001
I28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            18370001
28545              SET IN400-PV-ATT-NOT-FOUND TO TRUE                   18380001
28545              SET IN400-PV-MBS-LOOKUP    TO TRUE                   18390001
28545              SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  18400001
28545              MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              18410001
28545              STRING '  PARA: IN400-VSM-MBS-LOOKUP - '             18420001
28545                                        DELIMITED BY SIZE          18430001
28545                     IN400-PV-SKU-IN DELIMITED BY SIZE             18440001
28545                     '  ' DELIMITED BY SIZE                        18450001
28545                     IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         18460001
28545                     '  ' DELIMITED BY SIZE                        18461001
28545                     IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        18462001
28545                     '  ' DELIMITED BY SIZE                        18463001
28545                     IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         18464001
28545                     '  ' DELIMITED BY SIZE                        18465001
28545                               INTO IN400-PV-PARAGRAPH             18465101
28545          WHEN OTHER                                               18465201
I28545             MOVE SPACES      TO IN400-ATT-GMA-NBR                18465301
I28545             MOVE SPACES      TO IN400-ATT-DMA-NBR                18465401
I28545             MOVE SPACES      TO IN400-ATT-BYR-NBR                18465501
I28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          18465601
I28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           18465701
I28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          18465801
I28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           18465901
I28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          18466001
I28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           18466101
I28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            18466201
28545              SET IN400-PV-ATT-NOT-FOUND TO TRUE                   18466301
28545              SET IN400-PV-ATT-SQL-ERROR TO TRUE                   18466401
28545              SET IN400-PV-MBS-LOOKUP    TO TRUE                   18466501
28545              SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  18466601
28545              MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              18466701
28545              STRING '  PARA: IN400-VSM-MBS-LOOKUP - '             18466801
28545                                        DELIMITED BY SIZE          18466901
28545                     IN400-PV-SKU-IN DELIMITED BY SIZE             18467001
28545                     '  ' DELIMITED BY SIZE                        18467101
28545                     IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         18467201
28545                     '  ' DELIMITED BY SIZE                        18467301
28545                     IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        18467401
28545                     '  ' DELIMITED BY SIZE                        18467501
28545                     IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         18467601
28545                     '  ' DELIMITED BY SIZE                        18467701
28545                               INTO IN400-PV-PARAGRAPH             18467801
28545      END-EVALUATE.                                                18467901
28545                                                                   18468001
I28545******************************************************************18468101
I28545* IN400-VSM-MBS-BYR-LOOKUP.                                       18468201
I28545******************************************************************18468301
I28545 IN400-VSM-MBS-BYR-LOOKUP.                                        18468401
I28545                                                                  18468501
I28545     MOVE SKXREF-DEPT             TO IN400-CONVERT-DEPT.          18468601
I28545     MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          18468701
I28545                                                                  18468801
I28545     EXEC SQL                                                     18468901
I28545       SELECT B.WORKER_LAST_NAME                                  18469001
I28545             ,B.WORKER_FIR_NAME                                   18469101
I28545       INTO :IN400-ATT-BYR-LAST-NAME                              18469201
I28545           ,:IN400-ATT-BYR-FIR-NAME                               18469301
I28545       FROM TMDSEAR A,                                            18469401
I28545            TRSPBAR B                                             18469501
I28545       WHERE A.OPERCO_NBR = '03'                                  18469601
I28545         AND GMA_NBR = :IN400-ATT-GMA-NBR                         18469701
I28545         AND DMA_NBR = :IN400-ATT-DMA-NBR                         18469801
I28545         AND DEPT_NBR = :IN400-PV-WORK-DEPT-3X                    18469901
I28545         AND MAJ_CL_NBR = '00'                                    18470001
I28545         AND SUB_CL_NBR = '000'                                   18480001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        18490001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            18500001
I28545         AND B.RSPLVL_CDE  = 'BYR'                                18510001
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    18520001
I28545              :IN400-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        18530001
I28545       WITH UR                                                    18540001
I28545     END-EXEC.                                                    18550001
I28545                                                                  18560001
I28545     EVALUATE TRUE                                                18570001
I28545         WHEN SQLCODE = 0                                         18580001
I28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              18590001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      18600001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              18610001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               18620001
I28545         WHEN SQLCODE = +100                                      18630001
I28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          18640001
I28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           18650001
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           18660001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      18670001
I28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              18680001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               18690001
I28545         WHEN OTHER                                               18700001
I28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          18710001
I28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           18720001
I28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   18730001
I28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   18740001
I28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   18750001
I28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  18760001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              18770001
I28545             STRING '  PARA: IN400-VSM-MBS-BYR-LOOKUP - '         18780001
I28545                                       DELIMITED BY SIZE          18790001
I28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             18800001
I28545                    '  ' DELIMITED BY SIZE                        18810001
I28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         18820001
I28545                    '  ' DELIMITED BY SIZE                        18830001
I28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        18840001
I28545                    '  ' DELIMITED BY SIZE                        18850001
I28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         18860001
I28545                    '  ' DELIMITED BY SIZE                        18870001
I28545                              INTO IN400-PV-PARAGRAPH             18880001
I28545     END-EVALUATE.                                                18890001
I28545                                                                  18900001
I28545******************************************************************18910001
I28545* IN400-VSM-MBS-DMM-LOOKUP.                                       18920001
I28545******************************************************************18930001
I28545 IN400-VSM-MBS-DMM-LOOKUP.                                        18940001
I28545                                                                  18950001
I28545     EXEC SQL                                                     18960001
I28545       SELECT B.WORKER_LAST_NAME                                  18970001
I28545             ,B.WORKER_FIR_NAME                                   18980001
I28545       INTO :IN400-ATT-DMM-LAST-NAME                              18990001
I28545           ,:IN400-ATT-DMM-FIR-NAME                               19000001
I28545       FROM TMDSEAR A,                                            19010001
I28545            TRSPBAR B                                             19020001
I28545       WHERE A.OPERCO_NBR = '03'                                  19030001
I28545         AND GMA_NBR = :IN400-ATT-GMA-NBR                         19040001
I28545         AND DMA_NBR = :IN400-ATT-DMA-NBR                         19050001
I28545         AND DEPT_NBR = '000'                                     19060001
I28545         AND MAJ_CL_NBR = '00'                                    19070001
I28545         AND SUB_CL_NBR = '000'                                   19080001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        19090001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            19100001
I28545         AND B.RSPLVL_CDE  = 'DMM'                                19110001
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    19120001
I28545              :IN400-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        19130001
I28545       WITH UR                                                    19140001
I28545     END-EXEC.                                                    19150001
I28545                                                                  19160001
I28545     EVALUATE TRUE                                                19170001
I28545         WHEN SQLCODE = 0                                         19180001
I28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              19190001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      19200001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              19210001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               19220001
I28545         WHEN SQLCODE = +100                                      19230001
I28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          19240001
I28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           19250001
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           19260001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      19270001
I28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              19280001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               19290001
I28545         WHEN OTHER                                               19300001
I28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          19310001
I28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           19320001
I28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   19330001
I28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   19340001
I28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   19350001
I28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  19360001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              19370001
I28545             STRING '  PARA: IN400-VSM-MBS-DMM-LOOKUP - '         19380001
I28545                                       DELIMITED BY SIZE          19390001
I28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             19400001
I28545                    '  ' DELIMITED BY SIZE                        19410001
I28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         19420001
I28545                    '  ' DELIMITED BY SIZE                        19430001
I28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        19440001
I28545                    '  ' DELIMITED BY SIZE                        19450001
I28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         19460001
I28545                    '  ' DELIMITED BY SIZE                        19470001
I28545                              INTO IN400-PV-PARAGRAPH             19480001
I28545     END-EVALUATE.                                                19490001
I28545                                                                  19500001
I28545******************************************************************19510001
I28545* IN400-VSM-MBS-GMM-LOOKUP.                                       19520001
I28545******************************************************************19530001
I28545 IN400-VSM-MBS-GMM-LOOKUP.                                        19540001
I28545                                                                  19550001
I28545     EXEC SQL                                                     19560001
I28545       SELECT B.WORKER_LAST_NAME                                  19570001
I28545             ,B.WORKER_FIR_NAME                                   19580001
I28545       INTO :IN400-ATT-GMM-LAST-NAME                              19590001
I28545           ,:IN400-ATT-GMM-FIR-NAME                               19600001
I28545       FROM TMDSEAR A,                                            19610001
I28545            TRSPBAR B                                             19620001
I28545       WHERE A.OPERCO_NBR = '03'                                  19630001
I28545         AND GMA_NBR = :IN400-ATT-GMA-NBR                         19640001
I28545         AND DMA_NBR = '00'                                       19650001
I28545         AND DEPT_NBR = '000'                                     19660001
I28545         AND MAJ_CL_NBR = '00'                                    19670001
I28545         AND SUB_CL_NBR = '000'                                   19680001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        19690001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            19700001
I28545         AND B.RSPLVL_CDE  = 'GMM'                                19710001
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    19720001
I28545              :IN400-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        19730001
I28545       WITH UR                                                    19740001
I28545     END-EXEC.                                                    19750001
I28545                                                                  19760001
I28545     EVALUATE TRUE                                                19770001
I28545         WHEN SQLCODE = 0                                         19780001
I28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              19790001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      19800001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              19810001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               19820001
I28545         WHEN SQLCODE = +100                                      19830001
I28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          19840001
I28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           19850001
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           19851001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      19852001
I28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              19853001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               19854001
I28545         WHEN OTHER                                               19855001
I28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          19855101
I28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           19855201
I28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   19855301
I28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   19855401
I28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   19855501
I28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  19855601
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              19855701
I28545             STRING '  PARA: IN400-VSM-MBS-GMM-LOOKUP - '         19855801
I28545                                       DELIMITED BY SIZE          19855901
I28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             19856001
I28545                    '  ' DELIMITED BY SIZE                        19857001
I28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         19857101
I28545                    '  ' DELIMITED BY SIZE                        19857201
I28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        19857301
I28545                    '  ' DELIMITED BY SIZE                        19857401
I28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         19857501
I28545                    '  ' DELIMITED BY SIZE                        19857601
I28545                              INTO IN400-PV-PARAGRAPH             19857701
I28545     END-EVALUATE.                                                19857801
I28545                                                                  19857901
F28545******************************************************************19858001
F28545* IN400-VSM-MBS-DESC-LOOKUP.                                      19858101
F28545******************************************************************19858201
F28545 IN400-VSM-MBS-DESC-LOOKUP.                                       19858301
F28545                                                                  19858401
F28545     MOVE SKXREF-DEPT             TO IN400-CONVERT-DEPT.          19858501
F28545     MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          19858601
F28545                                                                  19858701
F28545     MOVE SKXREF-CLASS            TO IN400-CONVERT-MCL.           19858801
F28545     MOVE IN400-CONVERT-MCL       TO IN400-PV-WORK-MCL.           19858901
F28545                                                                  19859001
F28545     MOVE SKXREF-SUBCLASS         TO IN400-CONVERT-SCL.           19859101
F28545     MOVE IN400-CONVERT-SCL       TO IN400-PV-WORK-SCL.           19859201
F28545                                                                  19859301
F28545     EXEC SQL                                                     19859401
F28545          SELECT MDSEAR_DESC                                      19859501
F28545          INTO :IN400-ATT-MDSEAR-DESC                             19859601
F28545          FROM TMDSEAR A,                                         19859701
F28545               TAPLAVL B                                          19859801
F28545          WHERE A.OPERCO_NBR = '03'                               19859901
I28545            AND A.GMA_NBR = :IN400-ATT-GMA-NBR                    19860001
I28545            AND A.DMA_NBR = :IN400-ATT-DMA-NBR                    19860101
F28545            AND A.DEPT_NBR = :IN400-PV-WORK-DEPT-3X               19860201
F28545            AND A.MAJ_CL_NBR = :IN400-PV-WORK-MCL-2X              19860301
F28545            AND A.SUB_CL_NBR = :IN400-PV-WORK-SCL-3X              19860401
F28545            AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                     19860501
F28545            AND APLSYS_CDE = 'IN'                                 19860601
F28545        WITH UR                                                   19860701
F28545     END-EXEC.                                                    19860801
F28545                                                                  19860901
F28545     EVALUATE TRUE                                                19861001
F28545         WHEN SQLCODE = 0                                         19861101
F28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              19861201
F28545             SET IN400-PS-ATTR-FOUND TO TRUE                      19861301
F28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              19861401
F28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               19861501
F28545         WHEN SQLCODE = +100                                      19861601
F28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            19861701
F28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           19861801
F28545             SET IN400-PS-ATTR-FOUND TO TRUE                      19861901
F28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              19862001
F28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               19863001
F28545         WHEN OTHER                                               19863101
F28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            19863201
F28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   19863301
F28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   19863401
F28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   19863501
F28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  19863601
F28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              19863701
F28545             STRING '  PARA: IN400-VSM-MBS-DESC-LOOKUP - '        19863801
F28545                                       DELIMITED BY SIZE          19863901
F28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             19864001
F28545                    '  ' DELIMITED BY SIZE                        19864101
F28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         19864201
F28545                    '  ' DELIMITED BY SIZE                        19864301
F28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        19864401
F28545                    '  ' DELIMITED BY SIZE                        19864501
F28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         19864601
F28545                    '  ' DELIMITED BY SIZE                        19864701
F28545                              INTO IN400-PV-PARAGRAPH             19864801
F28545     END-EVALUATE.                                                19864901
F28545                                                                  19865001
28545 ******************************************************************19866001
28545 * IN400-VSM-ATTRIB-OUTPUT.                                        19867001
28545 ******************************************************************19867101
28545  IN400-VSM-ATTRIB-OUTPUT.                                         19867201
28545                                                                   19867301
Z28545     MOVE SKXREF-SKU              TO IN400-ATT-SKU-OUT.           19867401
Z28545                                                                  19867501
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   19867601
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-ATT-UPC-OUT        19867701
Z28545     ELSE                                                         19867801
Z28545         MOVE UPC-UPC-NBR             TO IN400-ATT-UPC-OUT        19867901
Z28545     END-IF.                                                      19868001
28545                                                                   19868101
28545      MOVE SKXREF-INTR-UPC-ID      TO IN400-ATT-UPCID-OUT.         19868201
28545      MOVE SKXREF-ITM-NBR          TO IN400-ATT-ITM-NBR-OUT.       19868301
28545                                                                   19868401
28545      MOVE SKXREF-DEPT             TO IN400-ATT-DEPT-OUT.          19868501
28545      MOVE SKXREF-CLASS            TO IN400-ATT-MCL-OUT.           19868601
28545      MOVE SKXREF-SUBCLASS         TO IN400-ATT-SCL-OUT.           19868701
28545      MOVE SKXREF-SKU-STAT-CDE     TO IN400-ATT-STATUS-OUT.        19868801
28545                                                                   19868901
28545      MOVE UPC-SUB-CL-MDSEAR-ID    TO IN400-ATT-MDEAR-ID-OUT.      19869001
28545      MOVE MDARVS-RMS-STYL-ID      TO IN400-ATT-STYL-ID-OUT.       19870001
RONNA      MOVE MDARVS-LBL-SEQ-NBR      TO IN400-ATT-LBL-SEQ-NBR-OUT.   19880001
28545      MOVE UPC-VS-ID               TO IN400-ATT-VS-ID-OUT.         19890001
28545      MOVE VNDSTL-VS-NBR           TO IN400-ATT-VS-NBR-OUT.        19900001
28545                                                                   19910001
28545      MOVE VNDSTL-ENT-ID           TO IN400-ATT-ENT-ID-OUT.        19920001
28545      MOVE EXTENT-DUN-NBR          TO IN400-ATT-DUNS-NBR-OUT.      19930001
28545      MOVE VNDDPT-INHOUSE-NBR      TO IN400-ATT-INHSE-NBR-OUT.     19940001
D28545     MOVE TUPCSKU-PLU-DWNLD-IND   TO IN400-ATT-PLU-DWNLD-IND.     19950001
28545                                                                   19960001
28545 ******************************************************************19970001
28545 ******************************************************************19980001
28545 ******************************************************************19990001
28545 * IN400-VSM-VENDOR-ATTRIB-LOOKUP.                                 20000001
28545 ******************************************************************20010001
28545  IN400-VSM-VENDOR-ATTRIB-LOOKUP.                                  20020001
BV                                                                      20030001
RONNA *    SET BV001-PV-UPC-ID-LOOKUP TO TRUE.                          20040001
RONNA      SET BV001-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    20050001
BV                                                                      20060001
BV    **** MOVE UPCPLS-EFF-BEG-TMST (1:10) TO BV001-PV-EFF-DTE-IN.      20070001
BV         MOVE IN400-PV-EFF-DTE-IN   TO BV001-PV-EFF-DTE-IN.           20080001
RONNA *    MOVE SKXREF-INTR-UPC-ID    TO BV001-PV-UPC-ID-IN-9.          20090001
RONNA      IF IN400-PV-ENT-ID-IN = SPACES                               20100001
BV            MOVE VNDSTL-ENT-ID      TO BV001-PV-ENT-ID-IN-9           20110001
RONNA      ELSE                                                         20120001
RONNA         MOVE IN400-PV-ENT-ID-IN-9                                 20130001
RONNA                                 TO BV001-PV-ENT-ID-IN-9           20140001
RONNA      END-IF.                                                      20150001
RONNA                                                                   20160001
RONNA      IF IN400-PV-DEPT-IN = SPACES                                 20170001
BV            MOVE SKXREF-DEPT        TO BV001-PV-DEPT-IN-9             20180001
RONNA      ELSE                                                         20190001
RONNA         MOVE IN400-PV-DEPT-IN-9 TO BV001-PV-DEPT-IN-9             20200001
RONNA      END-IF.                                                      20210001
RONNA                                                                   20220001
RONNA      MOVE MDARVS-LBL-SEQ-NBR    TO BV001-PV-BRAND-IN-9.           20230001
RONNA                                                                   20240001
RONNA *    DISPLAY ' IN IN400-INV-VENDOR-ATTRIB-LOOKUP ****'.           20241001
RONNA *    DISPLAY ' BV001-PV-ENT-ID-IN-9: ' BV001-PV-ENT-ID-IN-9.      20242001
RONNA *    DISPLAY ' BV001-PV-BRAND-IN-9 : ' BV001-PV-BRAND-IN-9.       20243001
RONNA *    DISPLAY ' BV001-PV-EFF-DTE-IN : ' BV001-PV-EFF-DTE-IN.       20243101
RONNA *    DISPLAY ' BV001-PV-DEPT-IN-9  : ' BV001-PV-DEPT-IN-9.        20243201
BV                                                                      20243301
BV         PERFORM BV001-LOOKUP-MAIN.                                   20243401
BV         IF BV001-PV-FOUND-REL-OR-UNK  OR                             20243501
RONNA         BV001-PAST-OR-FUT-DBV-REL-FND                             20243601
BV            SET IN400-PS-ATTR-FOUND TO TRUE                           20243701
RONNA         SET IN400-PS-BVUTIL-FOUND TO TRUE                         20243801
RONNA         IF IN400-PS-DBV-NO-ASSUMP                                 20243901
RONNA            SET IN400-PV-DBV-FOUND             TO TRUE             20244001
RONNA         ELSE                                                      20245001
RONNA            SET IN400-PV-DBV-FOUND-WITH-ASSMPT TO TRUE             20246001
RONNA         END-IF                                                    20247001
BV         ELSE                                                         20248001
BV                 MOVE ZEROS       TO BV001-PV-DEPT-OUT                20249001
BV                 MOVE ZEROS       TO BV001-PV-ENT-ID-OUT              20250001
BV                 MOVE ZEROS       TO BV001-PV-RLTNSHP-ID-OUT          20260001
BV                 MOVE ZEROS       TO BV001-PV-BRAND-OUT               20270001
BV                 SET IN400-PV-ATT-NOT-FOUND TO TRUE                   20280001
BV                 SET IN400-PV-BRAND-LOOKUP  TO TRUE                   20290001
BV                 SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  20291001
RONNA              SET IN400-PV-DBV-NOT-FOUND  TO TRUE                  20292001
BV                 MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              20293001
BV                 STRING '  PARA: IN400-VSM-VENDOR-ATTRIB-LOOKUP - '   20294001
BV                                           DELIMITED BY SIZE          20295001
BV                        IN400-PV-SKU-IN DELIMITED BY SIZE             20296001
BV                        '  ' DELIMITED BY SIZE                        20297001
BV                        IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         20298001
BV                        '  ' DELIMITED BY SIZE                        20299001
BV                        IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        20300001
BV                        '  ' DELIMITED BY SIZE                        20310001
BV                        IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         20320001
BV                        '  ' DELIMITED BY SIZE                        20330001
BV                                  INTO IN400-PV-PARAGRAPH             20340001
BV         END-IF.                                                      20350001
BV                                                                      20360001
28545 ******************************************************************20370001
28545 * IN400-VSM-VENDOR-OUTPUT.                                        20380001
28545 ******************************************************************20390001
28545  IN400-VSM-VENDOR-OUTPUT.                                         20400001
28545                                                                   20410001
Z28545     MOVE SKXREF-SKU              TO IN400-VND-SKU-OUT.           20420001
Z28545                                                                  20430001
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   20440001
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-VND-UPC-OUT        20450001
Z28545     ELSE                                                         20460001
Z28545         MOVE UPC-UPC-NBR             TO IN400-VND-UPC-OUT        20470001
Z28545     END-IF.                                                      20480001
28545                                                                   20490001
28545      MOVE SKXREF-INTR-UPC-ID      TO IN400-VND-UPCID-OUT.         20500001
28545      MOVE SKXREF-ITM-NBR          TO IN400-VND-ITM-NBR-OUT.       20510001
28545                                                                   20520001
BV         MOVE BV001-PV-DEPT-OUT       TO IN400-VND-DEPT-OUT.          20530001
BV         MOVE BV001-PV-ENT-ID-OUT     TO IN400-VND-ENT-ID-OUT.        20540001
BV         MOVE BV001-PV-RLTNSHP-ID-OUT TO IN400-VND-ML-LO-MDSE-LVL-ID. 20550001
BV         MOVE BV001-PV-BRAND-OUT      TO IN400-VND-LBL-SEQ-NBR.       20560001
BV                                                                      20570001
28545 ******************************************************************20580001
28545 ******************************************************************20590001
28545 ******************************************************************20600001
28545 * IN400-INV-PROCEED-WITH-LOOKUP.                                  20610001
28545 ******************************************************************20620001
28545  IN400-INV-PROCEED-WITH-LOOKUP.                                   20630001
28545                                                                   20640001
28545      EVALUATE TRUE                                                20650001
D28545*** PRICE LOOKUP.....                                             20660001
RONNA *      WHEN IN400-PV-SKU-LOOKUP                                   20670001
RONNA        WHEN IN400-PV-SKU-ASKU-LOOK                                20680001
28545          IF IN400-PV-SKU-IN = SPACES                              20690001
28545             OR IN400-PV-SKU-IN NOT NUMERIC                        20700001
28545             OR IN400-PV-SKU-IN = ZEROES                           20710001
D28545             PERFORM IN400-INV-LOOKUP-DEFAULT                     20720001
D28545         ELSE                                                     20730001
D28545         IF IN400-PV-DUMMY-SKU                                    20740001
D28545             MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU        20750001
D28545             MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU        20760001
D28545             PERFORM IN400-DUMMY-SKU-LOOKUP                       20770001
D28545         ELSE                                                     20780001
28545              MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU        20790001
28545              PERFORM IN400-INV-LOOKUP-BY-SKU                      20800001
28545          END-IF                                                   20810001
D28545         END-IF                                                   20820001
RONNA *      WHEN IN400-PV-UPC-NBR-LOOKUP                               20830001
RONNA        WHEN IN400-PV-UPC-AUPC-LOOK                                20840001
28545          IF IN400-PV-UPC-NBR-IN = SPACES                          20850001
28545             OR IN400-PV-UPC-NBR-IN NOT NUMERIC                    20860001
28545             OR IN400-PV-UPC-NBR-IN = ZEROES                       20870001
D28545             PERFORM IN400-INV-LOOKUP-DEFAULT                     20880001
D28545         ELSE                                                     20890001
I28545           IF (IN400-PV-KOHLS-UPC AND IN400-PV-DUMMY-UPC)         20900001
RONNA *            MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU        20910001
RONNA *            MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU        20920001
RONNA              MOVE IN400-PV-UPC-SKU-9  TO IN400-PV-WORK-SKU        20930001
RONNA                                          IN400-PV-DUMB-SKU        20940001
D28545             PERFORM IN400-DUMMY-SKU-LOOKUP                       20950001
28545          ELSE                                                     20960001
28545              MOVE IN400-PV-UPC-NBR-IN-NUM                         20970001
28545                                    TO IN400-PV-WORK-UPC-NBR       20980001
28545              PERFORM IN400-INV-LOOKUP-BY-UPC                      20990001
28545          END-IF                                                   21000001
D28545         END-IF                                                   21010001
RONNA *      WHEN IN400-PV-INTR-UPC-ID-LOOKUP                           21020001
RONNA        WHEN IN400-PV-UPCID-AUPCID-LOOK                            21030001
28545          IF IN400-PV-UPC-ID-SPC <= ZEROES                         21040001
28545              PERFORM IN400-INV-LOOKUP-DEFAULT                     21050001
28545          ELSE                                                     21060001
28545              MOVE IN400-PV-UPC-ID-SPC TO IN400-PV-WORK-UPC-ID     21070001
28545              PERFORM IN400-INV-LOOKUP-BY-UPC-ID                   21080001
28545          END-IF                                                   21090001
RONNA *      WHEN IN400-PV-ITM-NBR-LOOKUP                               21100001
RONNA        WHEN IN400-PV-ITM-AITM-LOOK                                21110001
28545          IF IN400-PV-ITM-NBR-IN = SPACES                          21120001
28545             OR IN400-PV-ITM-NBR-IN NOT NUMERIC                    21130001
28545             OR IN400-PV-ITM-NBR-IN = ZEROES                       21140001
28545              PERFORM IN400-INV-LOOKUP-DEFAULT                     21150001
28545          ELSE                                                     21160001
28545              MOVE IN400-PV-ITM-NBR-IN-NUM                         21170001
28545                                      TO IN400-PV-WORK-ITM-NBR     21180001
28545              PERFORM IN400-INV-LOOKUP-BY-ITM-NBR                  21190001
28545          END-IF                                                   21200001
D28545*** ATTRIBUTE LOOKUP.....                                         21210001
RONNA ****** THE FOLLOWING IS COMMENTED OUT BECAUSE THE WHEN'S HERE     21220001
RONNA ****** HAVE BEEN ADDED ABOVE                                      21221001
28545 *      WHEN IN400-PV-SKU-ATTRIB-LOOK                              21222001
28545 *          IF IN400-PV-SKU-IN = SPACES                            21223001
28545 *            OR IN400-PV-SKU-IN NOT NUMERIC                       21224001
28545 *            OR IN400-PV-SKU-IN = ZEROES                          21225001
D28545*              PERFORM IN400-INV-LOOKUP-DEFAULT                   21226001
D28545*          ELSE                                                   21227001
D28545*          IF IN400-PV-DUMMY-SKU                                  21228001
D28545*              MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU      21229001
D28545*              MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU      21230001
D28545*              PERFORM IN400-DUMMY-SKU-LOOKUP                     21240001
D28545*          ELSE                                                   21250001
28545 *              MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU      21260001
28545 *              PERFORM IN400-INV-LOOKUP-BY-SKU                    21270001
28545 *          END-IF                                                 21280001
28545 *          END-IF                                                 21290001
28545 *      WHEN IN400-PV-UPC-NBR-ATTRIB-LOOK                          21300001
28545 *          IF IN400-PV-UPC-NBR-IN = SPACES                        21310001
28545 *            OR IN400-PV-UPC-NBR-IN NOT NUMERIC                   21320001
28545 *            OR IN400-PV-UPC-NBR-IN = ZEROES                      21330001
D28545*               PERFORM IN400-INV-LOOKUP-DEFAULT                  21340001
D28545*          ELSE                                                   21350001
I28545*          IF (IN400-PV-KOHLS-UPC AND IN400-PV-DUMMY-UPC)         21360001
D28545*              MOVE IN400-PV-UPC-SKU-9 TO IN400-PV-WORK-SKU       21370001
D28545*              MOVE IN400-PV-UPC-SKU-9 TO IN400-PV-DUMB-SKU       21380001
D28545*              PERFORM IN400-DUMMY-SKU-LOOKUP                     21390001
28545 *          ELSE                                                   21400001
28545 *              MOVE IN400-PV-UPC-NBR-IN-NUM                       21410001
28545 *                                        TO IN400-PV-WORK-UPC-NBR 21420001
28545 *              PERFORM IN400-INV-LOOKUP-BY-UPC                    21430001
28545 *          END-IF                                                 21440001
28545 *          END-IF                                                 21450001
28545 *      WHEN IN400-PV-INTUPCID-ATTRIB-LOOK                         21460001
28545 *          IF IN400-PV-UPC-ID-SPC <= ZEROES                       21470001
D28545*              PERFORM IN400-INV-LOOKUP-DEFAULT                   21480001
28545 *          ELSE                                                   21490001
28545 *              MOVE IN400-PV-UPC-ID-SPC                           21500001
28545 *                                     TO IN400-PV-WORK-UPC-ID     21510001
28545 *                PERFORM IN400-INV-LOOKUP-BY-UPC-ID               21520001
28545 *          END-IF                                                 21530001
28545 *      WHEN IN400-PV-ITEM-ATTRIB-LOOK                             21540001
28545 *          IF IN400-PV-ITM-NBR-IN = SPACES                        21550001
28545 *              OR IN400-PV-ITM-NBR-IN NOT NUMERIC                 21560001
28545 *              OR IN400-PV-ITM-NBR-IN = ZEROES                    21570001
D28545*              PERFORM IN400-INV-LOOKUP-DEFAULT                   21580001
28545 *          ELSE                                                   21590001
28545 *              MOVE IN400-PV-ITM-NBR-IN-NUM                       21600001
28545 *                                     TO IN400-PV-WORK-ITM-NBR    21610001
28545 *              PERFORM IN400-INV-LOOKUP-BY-ITM-NBR                21620001
28545 *          END-IF                                                 21630001
D28545*** LOOKUP BASED ON THE PASSED PARAMETERS......                   21640001
             WHEN OTHER                                                 21650001
                 PERFORM IN400-INV-LOOKUP-DEFAULT                       21660001
28545      END-EVALUATE.                                                21670001
28545                                                                   21680001
28545 ******************************************************************21690001
28545 * IN400-INV-LOOKUP-BY-SKU.                                        21700001
28545 ******************************************************************21710001
28545  IN400-INV-LOOKUP-BY-SKU.                                         21720001
28545                                                                   21730001
28545      INITIALIZE DCLINT00003.                                      21740001
28545      MOVE ZEROS          TO IN400-PV-WORK-RETAIL.                 21750001
28545                                                                   21760001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      21770001
D28545     MOVE ZEROS            TO IN400-PV-PRC-SQLCDE.                21780001
D28545     MOVE ZEROS            TO IN400-PV-RETURN-CDE.                21790001
D28545     MOVE ZEROS            TO IN400-PV-ATT-SQLCDE.                21800001
D28545     MOVE ZEROS            TO IN400-PV-ATT-RTNCDE.                21810001
D28545     MOVE SPACES           TO IN400-PV-RETURN-RSN.                21820001
28545      MOVE 'N'            TO IN400-PS-PRIOR-FOUND-SW.              21830001
28545      MOVE 'N'            TO IN400-PS-END-SKUSTYL-CSR-SW.          21840001
28545      MOVE IN400-PV-WORK-SKU         TO INT00003-SKU-NBR.          21850001
28545      MOVE IN400-PV-LOC-IN-NUM       TO INT00003-LOC-NBR           21860001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      21870001
28545                                        INT00003-EFF-END-TMST.     21880001
28545                                                                   21890001
28545      PERFORM IN400-OPEN-SKUSTYL-SKU-CSR.                          21900001
28545      PERFORM IN400-FETCH-SKUSTYL-SKU-CSR                          21910001
28545        UNTIL IN400-PRIOR-FOUND                                    21920001
28545           OR IN400-PS-END-SKUSTYL-CSR.                            21930001
28545      PERFORM IN400-CLOSE-SKUSTYL-SKU-CSR.                         21940001
28545                                                                   21950001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           21960001
28545      IF IN400-PRIOR-NOT-FOUND                                     21970001
D28545         MOVE ZEROS             TO IN400-PV-PRC-SQLCDE            21980001
D28545         MOVE ZEROS             TO IN400-PV-RETURN-CDE            21990001
D28545         MOVE ZEROS             TO IN400-PV-ATT-SQLCDE            22000001
D28545         MOVE ZEROS             TO IN400-PV-ATT-RTNCDE            22010001
D28545         MOVE SPACES            TO IN400-PV-RETURN-RSN            22020001
28545          MOVE 'N'               TO IN400-PS-PRIOR-FOUND-SW        22030001
28545          MOVE 'N'               TO IN400-PS-END-SKUSTYL-CSR-SW    22040001
28545          MOVE IN400-PV-WORK-SKU TO INT00003-SKU-NBR               22050001
28545          MOVE ZEROS             TO INT00003-LOC-NBR               22060001
28545          MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  22070001
28545                                            INT00003-EFF-END-TMST  22080001
28545          PERFORM IN400-OPEN-SKUSTYL-SKU-CSR                       22090001
28545          PERFORM IN400-FETCH-SKUSTYL-SKU-CSR                      22100001
28545            UNTIL IN400-PRIOR-FOUND                                22110001
28545               OR IN400-PS-END-SKUSTYL-CSR                         22120001
28545          PERFORM IN400-CLOSE-SKUSTYL-SKU-CSR                      22130001
28545      END-IF.                                                      22140001
28545                                                                   22150001
28545 *** PRICE FOUND....                                               22160001
28545      IF IN400-PRIOR-FOUND                                         22170001
28545          SET IN400-PS-STR-FOUND TO TRUE                           22180001
28545      END-IF.                                                      22190001
28545                                                                   22200001
28545 ******************************************************************22210001
28545 * IN400-OPEN-SKUSTYL-SKU-CSR.                                     22220001
28545 ******************************************************************22230001
28545  IN400-OPEN-SKUSTYL-SKU-CSR.                                      22240001
28545                                                                   22250001
28545      EXEC SQL                                                     22260001
28545           OPEN SKUSTYL-SKU-CSR                                    22270001
28545      END-EXEC.                                                    22280001
28545                                                                   22290001
28545      EVALUATE TRUE                                                22300001
28545          WHEN SQLCODE = +0                                        22310001
D28545             CONTINUE                                             22320001
D28545         WHEN OTHER                                               22330001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   22340001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 22350001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   22360001
D28545             SET IN400-PV-CURSOR-OPEN   TO TRUE                   22370001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              22380001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              22390001
D28545             STRING '  PARA: IN400-OPEN-SKUSTYL-SKU-CSR - '       22400001
D28545                                       DELIMITED BY SIZE          22410001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             22420001
D28545                    '  ' DELIMITED BY SIZE                        22430001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         22440001
D28545                    '  ' DELIMITED BY SIZE                        22450001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        22460001
D28545                    '  ' DELIMITED BY SIZE                        22470001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         22480001
D28545                    '  ' DELIMITED BY SIZE                        22490001
D28545                              INTO IN400-PV-PARAGRAPH             22500001
D28545     END-EVALUATE.                                                22510001
28545                                                                   22520001
28545 ******************************************************************22530001
28545 * IN400-FETCH-SKUSTYL-SKU-CSR                                     22540001
28545 ******************************************************************22550001
28545  IN400-FETCH-SKUSTYL-SKU-CSR.                                     22560001
28545                                                                   22570001
28545      EXEC SQL                                                     22580001
28545          FETCH SKUSTYL-SKU-CSR                                    22590001
28545          INTO  :INT00003-UPC-ID                                   22600001
28545               ,:INT00003-LOC-NBR                                  22610001
28545               ,:INT00003-EFF-BEG-TMST                             22620001
28545               ,:INT00003-UPC-NBR                                  22630001
28545               ,:INT00003-EFF-END-TMST :IN400-PV-NULL-EFF-END-TMST 22640001
28545               ,:INT00003-UPC-STAT-CDE :IN400-PV-NULL-UPC-STAT-CDE 22650001
28545               ,:INT00003-UNT-COST-AMT :IN400-PV-NULL-UNT-COST-AMT 22660001
28545               ,:INT00003-UNT-RTL-AMT  :IN400-PV-NULL-UNT-RTL-AMT  22670001
28545               ,:INT00003-MEITGP-NBR   :IN400-PV-NULL-MEITGP-NBR   22680001
28545               ,:INT00003-ITM-NBR                                  22690001
28545               ,:INT00003-INTR-UPC-ID                              22700001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         22710001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          22720001
28545               ,:INT00003-ORIG-CLR-DTE :IN400-PV-NULL-ORIG-CLR-DTE 22730001
28545               ,:INT00003-MKDN-CDE     :IN400-PV-NULL-MKDN-CDE     22740001
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         22750001
28545               ,:INT00003-VS-ID :IN400-PV-NULL-VS-ID               22760001
28545               ,:INT00003-DEPT-NBR                                 22770001
28545               ,:INT00003-MAJ-CL-NBR                               22780001
28545               ,:INT00003-SUB-CL-NBR                               22790001
28545               ,:INT00003-SKU-NBR                                  22800001
28545               ,:INT00003-ENT-ID                                   22810001
28545               ,:INT00003-PLU-DWNLD-IND                            22820001
28545      END-EXEC.                                                    22830001
28545                                                                   22840001
28545      EVALUATE TRUE                                                22850001
28545          WHEN SQLCODE = +0                                        22860001
28545              MOVE INT00003-UNT-RTL-AMT TO IN400-PV-WORK-RETAIL    22870001
28545              PERFORM IN400-INV-GROUP-PRICING                      22880001
28545              SET IN400-PRIOR-FOUND  TO TRUE                       22890001
D28545             SET IN400-PV-FOUND     TO TRUE                       22900001
D28545             SET IN400-PV-ATT-FOUND TO TRUE                       22910001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        22920001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        22930001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               22940001
28545          WHEN SQLCODE = +100                                      22950001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       22960001
D28545             SET IN400-PV-NOT-FOUND       TO TRUE                 22970001
D28545             SET IN400-PV-ATT-NOT-FOUND   TO TRUE                 22980001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 22990001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 23000001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        23010001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        23020001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-SKU-CSR - '      23030001
D28545                                       DELIMITED BY SIZE          23040001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             23050001
D28545                    '  ' DELIMITED BY SIZE                        23060001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         23070001
D28545                    '  ' DELIMITED BY SIZE                        23080001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        23090001
D28545                    '  ' DELIMITED BY SIZE                        23100001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         23110001
D28545                    '  ' DELIMITED BY SIZE                        23120001
D28545                              INTO IN400-PV-PARAGRAPH             23130001
28545          WHEN OTHER                                               23140001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       23150001
28545              SET IN400-PV-SQL-ERROR TO TRUE                       23160001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 23170001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   23180001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 23190001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 23200001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        23210001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        23220001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-SKU-CSR - '      23230001
D28545                                       DELIMITED BY SIZE          23240001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             23250001
D28545                    '  ' DELIMITED BY SIZE                        23260001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         23270001
D28545                    '  ' DELIMITED BY SIZE                        23280001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        23281001
D28545                    '  ' DELIMITED BY SIZE                        23282001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         23283001
D28545                    '  ' DELIMITED BY SIZE                        23284001
D28545                              INTO IN400-PV-PARAGRAPH             23285001
28545      END-EVALUATE.                                                23286001
28545                                                                   23287001
28545 ******************************************************************23288001
28545 * IN400-CLOSE-SKUSTYL-SKU-CSR                                     23289001
28545 ******************************************************************23290001
28545  IN400-CLOSE-SKUSTYL-SKU-CSR.                                     23300001
28545                                                                   23310001
28545      EXEC SQL                                                     23320001
28545          CLOSE SKUSTYL-SKU-CSR                                    23330001
28545      END-EXEC.                                                    23340001
28545                                                                   23350001
28545      EVALUATE TRUE                                                23360001
28545          WHEN SQLCODE = +0                                        23370001
D28545             CONTINUE                                             23380001
28545          WHEN OTHER                                               23390001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   23400001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 23410001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   23420001
D28545             SET IN400-PV-CURSOR-CLOSE  TO TRUE                   23430001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        23440001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        23450001
D28545             STRING '  PARA: IN400-CLOSE-SKUSTYL-SKU-CSR - '      23460001
D28545                                       DELIMITED BY SIZE          23470001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             23480001
D28545                    '  ' DELIMITED BY SIZE                        23490001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         23500001
D28545                    '  ' DELIMITED BY SIZE                        23510001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        23520001
D28545                    '  ' DELIMITED BY SIZE                        23530001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         23540001
D28545                    '  ' DELIMITED BY SIZE                        23550001
D28545                              INTO IN400-PV-PARAGRAPH             23560001
28545      END-EVALUATE.                                                23570001
28545                                                                   23580001
28545 ******************************************************************23590001
28545 * IN400-INV-LOOKUP-BY-UPC.                                        23600001
28545 ******************************************************************23610001
28545  IN400-INV-LOOKUP-BY-UPC.                                         23620001
28545                                                                   23630001
28545      INITIALIZE DCLINT00003.                                      23640001
28545      MOVE ZEROS          TO IN400-PV-WORK-RETAIL.                 23650001
28545                                                                   23660001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      23670001
D28545     MOVE ZEROS            TO IN400-PV-PRC-SQLCDE.                23680001
D28545     MOVE ZEROS            TO IN400-PV-RETURN-CDE.                23690001
D28545     MOVE ZEROS            TO IN400-PV-ATT-SQLCDE.                23700001
D28545     MOVE ZEROS            TO IN400-PV-ATT-RTNCDE.                23710001
D28545     MOVE SPACES           TO IN400-PV-RETURN-RSN.                23720001
28545      MOVE 'N'            TO IN400-PS-PRIOR-FOUND-SW.              23730001
28545      MOVE 'N'            TO IN400-PS-END-SKUSTYL-CSR-SW.          23740001
28545      MOVE IN400-PV-WORK-UPC-NBR     TO INT00003-UPC-NBR.          23750001
28545      MOVE IN400-PV-LOC-IN-NUM       TO INT00003-LOC-NBR           23760001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      23770001
28545                                        INT00003-EFF-END-TMST.     23780001
28545                                                                   23790001
28545      PERFORM IN400-OPEN-SKUSTYL-UPC-CSR.                          23800001
28545      PERFORM IN400-FETCH-SKUSTYL-UPC-CSR                          23810001
28545        UNTIL IN400-PRIOR-FOUND                                    23820001
28545           OR IN400-PS-END-SKUSTYL-CSR.                            23830001
28545      PERFORM IN400-CLOSE-SKUSTYL-UPC-CSR.                         23840001
28545                                                                   23850001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           23860001
28545      IF IN400-PRIOR-NOT-FOUND                                     23870001
D28545         MOVE ZEROS             TO IN400-PV-PRC-SQLCDE            23880001
D28545         MOVE ZEROS             TO IN400-PV-RETURN-CDE            23890001
D28545         MOVE ZEROS             TO IN400-PV-ATT-SQLCDE            23900001
D28545         MOVE ZEROS             TO IN400-PV-ATT-RTNCDE            23910001
D28545         MOVE SPACES            TO IN400-PV-RETURN-RSN            23920001
28545          MOVE 'N'               TO IN400-PS-PRIOR-FOUND-SW        23930001
28545          MOVE 'N'               TO IN400-PS-END-SKUSTYL-CSR-SW    23940001
28545          MOVE IN400-PV-WORK-UPC-NBR TO INT00003-UPC-NBR           23950001
28545          MOVE ZEROS                 TO INT00003-LOC-NBR           23960001
28545          MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  23970001
28545                                            INT00003-EFF-END-TMST  23980001
28545          PERFORM IN400-OPEN-SKUSTYL-UPC-CSR                       23990001
28545          PERFORM IN400-FETCH-SKUSTYL-UPC-CSR                      24000001
28545            UNTIL IN400-PRIOR-FOUND                                24010001
28545               OR IN400-PS-END-SKUSTYL-CSR                         24020001
28545          PERFORM IN400-CLOSE-SKUSTYL-UPC-CSR                      24030001
28545      END-IF.                                                      24040001
28545                                                                   24050001
28545 *** PRICE FOUND....                                               24060001
28545      IF IN400-PRIOR-FOUND                                         24070001
28545          SET IN400-PS-STR-FOUND TO TRUE                           24080001
28545      END-IF.                                                      24090001
28545                                                                   24100001
28545 ******************************************************************24110001
28545 * IN400-OPEN-SKUSTYL-UPC-CSR.                                     24120001
28545 ******************************************************************24130001
28545  IN400-OPEN-SKUSTYL-UPC-CSR.                                      24140001
28545                                                                   24150001
28545      EXEC SQL                                                     24160001
28545           OPEN SKUSTYL-UPC-CSR                                    24170001
28545      END-EXEC.                                                    24180001
28545                                                                   24190001
28545      EVALUATE TRUE                                                24200001
28545          WHEN SQLCODE = +0                                        24210001
D28545             CONTINUE                                             24220001
D28545         WHEN OTHER                                               24230001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   24240001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 24250001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   24260001
D28545             SET IN400-PV-CURSOR-OPEN   TO TRUE                   24270001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              24280001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              24290001
D28545             STRING '  PARA: IN400-OPEN-SKUSTYL-UPC-CSR - '       24300001
D28545                                       DELIMITED BY SIZE          24310001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             24320001
D28545                    '  ' DELIMITED BY SIZE                        24330001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         24340001
D28545                    '  ' DELIMITED BY SIZE                        24350001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        24360001
D28545                    '  ' DELIMITED BY SIZE                        24370001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         24380001
D28545                    '  ' DELIMITED BY SIZE                        24390001
D28545                              INTO IN400-PV-PARAGRAPH             24400001
D28545     END-EVALUATE.                                                24410001
28545                                                                   24420001
28545 ******************************************************************24430001
28545 * IN400-FETCH-SKUSTYL-UPC-CSR                                     24440001
28545 ******************************************************************24450001
28545  IN400-FETCH-SKUSTYL-UPC-CSR.                                     24460001
28545                                                                   24470001
28545      EXEC SQL                                                     24480001
28545          FETCH SKUSTYL-UPC-CSR                                    24490001
28545          INTO  :INT00003-UPC-ID                                   24500001
28545               ,:INT00003-LOC-NBR                                  24510001
28545               ,:INT00003-EFF-BEG-TMST                             24520001
28545               ,:INT00003-UPC-NBR                                  24530001
28545               ,:INT00003-EFF-END-TMST :IN400-PV-NULL-EFF-END-TMST 24540001
28545               ,:INT00003-UPC-STAT-CDE :IN400-PV-NULL-UPC-STAT-CDE 24550001
28545               ,:INT00003-UNT-COST-AMT :IN400-PV-NULL-UNT-COST-AMT 24560001
28545               ,:INT00003-UNT-RTL-AMT  :IN400-PV-NULL-UNT-RTL-AMT  24570001
28545               ,:INT00003-MEITGP-NBR   :IN400-PV-NULL-MEITGP-NBR   24580001
28545               ,:INT00003-ITM-NBR                                  24590001
28545               ,:INT00003-INTR-UPC-ID                              24600001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         24610001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          24620001
28545               ,:INT00003-ORIG-CLR-DTE :IN400-PV-NULL-ORIG-CLR-DTE 24630001
28545               ,:INT00003-MKDN-CDE     :IN400-PV-NULL-MKDN-CDE     24640001
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         24650001
28545               ,:INT00003-VS-ID :IN400-PV-NULL-VS-ID               24660001
28545               ,:INT00003-DEPT-NBR                                 24670001
28545               ,:INT00003-MAJ-CL-NBR                               24680001
28545               ,:INT00003-SUB-CL-NBR                               24690001
28545               ,:INT00003-SKU-NBR                                  24700001
28545               ,:INT00003-ENT-ID                                   24710001
28545               ,:INT00003-PLU-DWNLD-IND                            24720001
28545      END-EXEC.                                                    24730001
28545                                                                   24740001
28545      EVALUATE TRUE                                                24750001
28545          WHEN SQLCODE = +0                                        24760001
28545              MOVE INT00003-UNT-RTL-AMT TO IN400-PV-WORK-RETAIL    24770001
28545              PERFORM IN400-INV-GROUP-PRICING                      24780001
28545              SET IN400-PRIOR-FOUND  TO TRUE                       24790001
D28545             SET IN400-PV-FOUND     TO TRUE                       24800001
D28545             SET IN400-PV-ATT-FOUND TO TRUE                       24810001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        24820001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        24830001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               24840001
28545          WHEN SQLCODE = +100                                      24850001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       24860001
D28545             SET IN400-PV-NOT-FOUND       TO TRUE                 24870001
D28545             SET IN400-PV-ATT-NOT-FOUND   TO TRUE                 24880001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 24890001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 24900001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        24910001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        24920001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-UPC-CSR - '      24930001
D28545                                       DELIMITED BY SIZE          24940001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             24950001
D28545                    '  ' DELIMITED BY SIZE                        24960001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         24970001
D28545                    '  ' DELIMITED BY SIZE                        24980001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        24990001
D28545                    '  ' DELIMITED BY SIZE                        24991001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         24992001
D28545                    '  ' DELIMITED BY SIZE                        24993001
D28545                              INTO IN400-PV-PARAGRAPH             24994001
28545          WHEN OTHER                                               24995001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       24996001
28545              SET IN400-PV-SQL-ERROR TO TRUE                       24997001
28545              SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 24998001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   24999001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 25000001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 25010001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        25020001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        25030001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-UPC-CSR - '      25040001
D28545                                       DELIMITED BY SIZE          25050001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             25060001
D28545                    '  ' DELIMITED BY SIZE                        25070001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         25080001
D28545                    '  ' DELIMITED BY SIZE                        25090001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        25100001
D28545                    '  ' DELIMITED BY SIZE                        25110001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         25120001
D28545                    '  ' DELIMITED BY SIZE                        25130001
D28545                              INTO IN400-PV-PARAGRAPH             25140001
28545      END-EVALUATE.                                                25150001
28545                                                                   25160001
28545 ******************************************************************25170001
28545 * IN400-CLOSE-SKUSTYL-UPC-CSR                                     25180001
28545 ******************************************************************25190001
28545  IN400-CLOSE-SKUSTYL-UPC-CSR.                                     25200001
28545                                                                   25210001
28545      EXEC SQL                                                     25220001
28545          CLOSE SKUSTYL-UPC-CSR                                    25230001
28545      END-EXEC.                                                    25240001
28545                                                                   25250001
28545      EVALUATE TRUE                                                25260001
28545          WHEN SQLCODE = +0                                        25270001
D28545             CONTINUE                                             25280001
28545          WHEN OTHER                                               25290001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   25300001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 25310001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   25320001
D28545             SET IN400-PV-CURSOR-CLOSE  TO TRUE                   25330001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        25340001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        25350001
D28545             STRING '  PARA: IN400-CLOSE-SKUSTYL-UPC-CSR - '      25360001
D28545                                       DELIMITED BY SIZE          25370001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             25380001
D28545                    '  ' DELIMITED BY SIZE                        25390001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         25400001
D28545                    '  ' DELIMITED BY SIZE                        25410001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        25420001
D28545                    '  ' DELIMITED BY SIZE                        25430001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         25440001
D28545                    '  ' DELIMITED BY SIZE                        25450001
D28545                              INTO IN400-PV-PARAGRAPH             25460001
28545      END-EVALUATE.                                                25470001
28545                                                                   25480001
28545 ******************************************************************25490001
28545 * IN400-INV-LOOKUP-BY-UPC-ID.                                     25500001
28545 ******************************************************************25510001
28545  IN400-INV-LOOKUP-BY-UPC-ID.                                      25520001
28545                                                                   25530001
28545      INITIALIZE DCLINT00003.                                      25540001
28545      MOVE ZEROS          TO IN400-PV-WORK-RETAIL.                 25550001
28545                                                                   25560001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      25570001
D28545     MOVE ZEROS            TO IN400-PV-PRC-SQLCDE.                25580001
D28545     MOVE ZEROS            TO IN400-PV-RETURN-CDE.                25590001
D28545     MOVE ZEROS            TO IN400-PV-ATT-SQLCDE.                25600001
D28545     MOVE ZEROS            TO IN400-PV-ATT-RTNCDE.                25610001
D28545     MOVE SPACES           TO IN400-PV-RETURN-RSN.                25620001
28545      MOVE 'N'            TO IN400-PS-PRIOR-FOUND-SW.              25630001
28545      MOVE 'N'            TO IN400-PS-END-SKUSTYL-CSR-SW.          25640001
28545      MOVE IN400-PV-WORK-UPC-ID      TO INT00003-INTR-UPC-ID.      25650001
28545      MOVE IN400-PV-LOC-IN-NUM       TO INT00003-LOC-NBR.          25660001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      25670001
28545                                        INT00003-EFF-END-TMST.     25680001
28545                                                                   25690001
X28542     PERFORM IN400-OPEN-SKUSTYL-IUPC-CSR                          25700001
X28542     PERFORM IN400-FETCH-SKUSTYL-IUPC-CSR                         25710001
X28542       UNTIL IN400-PRIOR-FOUND                                    25720001
X28542          OR IN400-PS-END-SKUSTYL-CSR                             25730001
X28542     PERFORM IN400-CLOSE-SKUSTYL-IUPC-CSR                         25740001
X28542                                                                  25750001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           25760001
28545      IF IN400-PRIOR-NOT-FOUND                                     25770001
D28545         MOVE ZEROS             TO IN400-PV-PRC-SQLCDE            25780001
D28545         MOVE ZEROS             TO IN400-PV-RETURN-CDE            25790001
D28545         MOVE ZEROS             TO IN400-PV-ATT-SQLCDE            25800001
D28545         MOVE ZEROS             TO IN400-PV-ATT-RTNCDE            25810001
D28545         MOVE SPACES            TO IN400-PV-RETURN-RSN            25820001
28545          MOVE 'N'               TO IN400-PS-PRIOR-FOUND-SW        25830001
28545          MOVE 'N'               TO IN400-PS-END-SKUSTYL-CSR-SW    25840001
28545          MOVE IN400-PV-WORK-UPC-ID      TO INT00003-INTR-UPC-ID   25850001
28545          MOVE ZEROS                     TO INT00003-LOC-NBR       25860001
28545          MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  25870001
28545                                            INT00003-EFF-END-TMST  25880001
28545          PERFORM IN400-OPEN-SKUSTYL-IUPC-CSR                      25890001
28545          PERFORM IN400-FETCH-SKUSTYL-IUPC-CSR                     25900001
28545            UNTIL IN400-PRIOR-FOUND                                25910001
28545               OR IN400-PS-END-SKUSTYL-CSR                         25920001
28545          PERFORM IN400-CLOSE-SKUSTYL-IUPC-CSR                     25930001
28545      END-IF.                                                      25940001
28545                                                                   25950001
28545 *** PRICE FOUND....                                               25960001
28545      IF IN400-PRIOR-FOUND                                         25970001
28545          SET IN400-PS-STR-FOUND TO TRUE                           25980001
28545      END-IF.                                                      25990001
28545                                                                   26000001
28545 ******************************************************************26010001
28545 * IN400-OPEN-SKUSTYL-IUPC-CSR                                     26020001
28545 ******************************************************************26030001
28545  IN400-OPEN-SKUSTYL-IUPC-CSR.                                     26040001
28545                                                                   26050001
28545      EXEC SQL                                                     26060001
28545           OPEN SKUSTYL-IUPC-CSR                                   26070001
28545      END-EXEC.                                                    26080001
28545                                                                   26090001
28545      EVALUATE TRUE                                                26100001
28545          WHEN SQLCODE = +0                                        26110001
D28545             CONTINUE                                             26120001
D28545         WHEN OTHER                                               26130001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   26140001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 26150001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   26160001
D28545             SET IN400-PV-CURSOR-OPEN   TO TRUE                   26170001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              26180001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              26190001
D28545             STRING '  PARA: IN400-OPEN-SKUSTYL-IUPC-CSR - '      26200001
D28545                                       DELIMITED BY SIZE          26210001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             26220001
D28545                    '  ' DELIMITED BY SIZE                        26230001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         26240001
D28545                    '  ' DELIMITED BY SIZE                        26250001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        26260001
D28545                    '  ' DELIMITED BY SIZE                        26270001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         26280001
D28545                    '  ' DELIMITED BY SIZE                        26290001
D28545                              INTO IN400-PV-PARAGRAPH             26300001
D28545     END-EVALUATE.                                                26310001
28545                                                                   26320001
28545 ******************************************************************26330001
28545 * IN400-FETCH-SKUSTYL-IUPC-CSR                                    26340001
28545 ******************************************************************26350001
28545  IN400-FETCH-SKUSTYL-IUPC-CSR.                                    26360001
28545                                                                   26370001
28545      EXEC SQL                                                     26380001
28545          FETCH SKUSTYL-IUPC-CSR                                   26390001
28545          INTO  :INT00003-UPC-ID                                   26400001
28545               ,:INT00003-LOC-NBR                                  26410001
28545               ,:INT00003-EFF-BEG-TMST                             26420001
28545               ,:INT00003-UPC-NBR                                  26430001
28545               ,:INT00003-EFF-END-TMST :IN400-PV-NULL-EFF-END-TMST 26440001
28545               ,:INT00003-UPC-STAT-CDE :IN400-PV-NULL-UPC-STAT-CDE 26450001
28545               ,:INT00003-UNT-COST-AMT :IN400-PV-NULL-UNT-COST-AMT 26460001
28545               ,:INT00003-UNT-RTL-AMT  :IN400-PV-NULL-UNT-RTL-AMT  26470001
28545               ,:INT00003-MEITGP-NBR   :IN400-PV-NULL-MEITGP-NBR   26480001
28545               ,:INT00003-ITM-NBR                                  26490001
28545               ,:INT00003-INTR-UPC-ID                              26500001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         26510001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          26520001
28545               ,:INT00003-ORIG-CLR-DTE :IN400-PV-NULL-ORIG-CLR-DTE 26530001
28545               ,:INT00003-MKDN-CDE     :IN400-PV-NULL-MKDN-CDE     26540001
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         26550001
28545               ,:INT00003-VS-ID :IN400-PV-NULL-VS-ID               26560001
28545               ,:INT00003-DEPT-NBR                                 26570001
28545               ,:INT00003-MAJ-CL-NBR                               26580001
28545               ,:INT00003-SUB-CL-NBR                               26590001
28545               ,:INT00003-SKU-NBR                                  26600001
28545               ,:INT00003-ENT-ID                                   26610001
28545               ,:INT00003-PLU-DWNLD-IND                            26620001
28545      END-EXEC.                                                    26630001
28545                                                                   26640001
28545      EVALUATE TRUE                                                26650001
28545          WHEN SQLCODE = +0                                        26660001
28545              MOVE INT00003-UNT-RTL-AMT TO IN400-PV-WORK-RETAIL    26670001
28545              PERFORM IN400-INV-GROUP-PRICING                      26680001
28545              SET IN400-PRIOR-FOUND  TO TRUE                       26690001
D28545             SET IN400-PV-FOUND     TO TRUE                       26700001
D28545             SET IN400-PV-ATT-FOUND TO TRUE                       26710001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        26720001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        26730001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               26740001
28545          WHEN SQLCODE = +100                                      26750001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       26760001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 26770001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 26780001
D28545             SET IN400-PV-NOT-FOUND       TO TRUE                 26790001
D28545             SET IN400-PV-ATT-NOT-FOUND   TO TRUE                 26800001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        26810001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        26820001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-IUPC-CSR - '     26830001
D28545                                       DELIMITED BY SIZE          26840001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             26850001
D28545                    '  ' DELIMITED BY SIZE                        26860001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         26870001
D28545                    '  ' DELIMITED BY SIZE                        26880001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        26890001
D28545                    '  ' DELIMITED BY SIZE                        26900001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         26901001
D28545                    '  ' DELIMITED BY SIZE                        26902001
D28545                              INTO IN400-PV-PARAGRAPH             26903001
28545          WHEN OTHER                                               26904001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       26905001
28545              SET IN400-PV-SQL-ERROR TO TRUE                       26906001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 26907001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   26908001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 26909001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 26910001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        26920001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        26930001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-IUPC-CSR - '     26940001
D28545                                       DELIMITED BY SIZE          26950001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             26960001
D28545                    '  ' DELIMITED BY SIZE                        26970001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         26980001
D28545                    '  ' DELIMITED BY SIZE                        26990001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        27000001
D28545                    '  ' DELIMITED BY SIZE                        27010001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         27020001
D28545                    '  ' DELIMITED BY SIZE                        27030001
D28545                              INTO IN400-PV-PARAGRAPH             27040001
28545      END-EVALUATE.                                                27050001
28545                                                                   27060001
28545 ******************************************************************27070001
28545 * IN400-CLOSE-SKUSTYL-IUPC-CSR                                    27080001
28545 ******************************************************************27090001
28545  IN400-CLOSE-SKUSTYL-IUPC-CSR.                                    27100001
28545                                                                   27110001
28545      EXEC SQL                                                     27120001
28545          CLOSE SKUSTYL-IUPC-CSR                                   27130001
28545      END-EXEC.                                                    27140001
28545                                                                   27150001
28545      EVALUATE TRUE                                                27160001
28545          WHEN SQLCODE = +0                                        27170001
D28545             CONTINUE                                             27180001
28545          WHEN OTHER                                               27190001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   27200001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 27210001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   27220001
D28545             SET IN400-PV-CURSOR-CLOSE  TO TRUE                   27230001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        27240001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        27250001
D28545             STRING '  PARA: IN400-CLOSE-SKUSTYL-IUPC-CSR - '     27260001
D28545                                       DELIMITED BY SIZE          27270001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             27280001
D28545                    '  ' DELIMITED BY SIZE                        27290001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         27300001
D28545                    '  ' DELIMITED BY SIZE                        27310001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        27320001
D28545                    '  ' DELIMITED BY SIZE                        27330001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         27340001
D28545                    '  ' DELIMITED BY SIZE                        27350001
D28545                              INTO IN400-PV-PARAGRAPH             27360001
28545      END-EVALUATE.                                                27370001
28545                                                                   27380001
28545 ******************************************************************27390001
28545 * IN400-INV-LOOKUP-BY-ITM-NBR.                                    27400001
28545 ******************************************************************27410001
28545  IN400-INV-LOOKUP-BY-ITM-NBR.                                     27420001
28545                                                                   27430001
28545      INITIALIZE DCLINT00003.                                      27440001
28545      MOVE ZEROS          TO IN400-PV-WORK-RETAIL.                 27450001
28545                                                                   27460001
28545 *** STORE SPECIFIC - SKU_STYLE DELETE TABLE PRICE LOOKUP....      27470001
D28545     MOVE ZEROS            TO IN400-PV-PRC-SQLCDE.                27480001
D28545     MOVE ZEROS            TO IN400-PV-RETURN-CDE.                27490001
D28545     MOVE ZEROS            TO IN400-PV-ATT-SQLCDE.                27500001
D28545     MOVE ZEROS            TO IN400-PV-ATT-RTNCDE.                27510001
D28545     MOVE SPACES           TO IN400-PV-RETURN-RSN.                27520001
28545      MOVE 'N'            TO IN400-PS-PRIOR-FOUND-SW.              27530001
28545      MOVE 'N'            TO IN400-PS-END-SKUSTYL-CSR-SW.          27540001
28545      MOVE IN400-PV-WORK-ITM-NBR     TO INT00003-ITM-NBR.          27550001
28545      MOVE IN400-PV-LOC-IN-NUM       TO INT00003-LOC-NBR           27560001
28545      MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST      27570001
28545                                        INT00003-EFF-END-TMST.     27580001
28545                                                                   27590001
28545      PERFORM IN400-OPEN-SKUSTYL-ITM-CSR.                          27600001
28545      PERFORM IN400-FETCH-SKUSTYL-ITM-CSR                          27610001
28545        UNTIL IN400-PRIOR-FOUND                                    27620001
28545           OR IN400-PS-END-SKUSTYL-CSR.                            27630001
28545      PERFORM IN400-CLOSE-SKUSTYL-ITM-CSR.                         27640001
28545                                                                   27650001
28545 *** CORPORATE - SKU_STYLE DELETE TABLE PRICE LOOKUP....           27660001
28545      IF IN400-PRIOR-NOT-FOUND                                     27670001
D28545         MOVE ZEROS             TO IN400-PV-PRC-SQLCDE            27680001
D28545         MOVE ZEROS             TO IN400-PV-RETURN-CDE            27690001
D28545         MOVE ZEROS             TO IN400-PV-ATT-SQLCDE            27700001
D28545         MOVE ZEROS             TO IN400-PV-ATT-RTNCDE            27710001
D28545         MOVE SPACES            TO IN400-PV-RETURN-RSN            27720001
28545          MOVE 'N'               TO IN400-PS-PRIOR-FOUND-SW        27730001
28545          MOVE 'N'               TO IN400-PS-END-SKUSTYL-CSR-SW    27740001
28545          MOVE IN400-PV-WORK-ITM-NBR TO INT00003-ITM-NBR           27750001
28545          MOVE ZEROS                 TO INT00003-LOC-NBR           27760001
28545          MOVE IN400-PV-EFF-BEG-DTE-TMST TO INT00003-EFF-BEG-TMST  27770001
28545                                            INT00003-EFF-END-TMST  27780001
28545          PERFORM IN400-OPEN-SKUSTYL-ITM-CSR                       27790001
28545          PERFORM IN400-FETCH-SKUSTYL-ITM-CSR                      27800001
28545            UNTIL IN400-PRIOR-FOUND                                27810001
28545               OR IN400-PS-END-SKUSTYL-CSR                         27820001
28545          PERFORM IN400-CLOSE-SKUSTYL-ITM-CSR                      27830001
28545      END-IF.                                                      27840001
28545                                                                   27850001
28545 *** PRICE FOUND....                                               27860001
28545      IF IN400-PRIOR-FOUND                                         27870001
28545          SET IN400-PS-STR-FOUND TO TRUE                           27880001
28545      END-IF.                                                      27890001
28545                                                                   27900001
28545 ******************************************************************27910001
28545 * IN400-OPEN-SKUSTYL-ITM-CSR.                                     27920001
28545 ******************************************************************27930001
28545  IN400-OPEN-SKUSTYL-ITM-CSR.                                      27940001
28545                                                                   27950001
28545      EXEC SQL                                                     27960001
28545           OPEN SKUSTYL-ITM-CSR                                    27970001
28545      END-EXEC.                                                    27980001
28545                                                                   27990001
28545      EVALUATE TRUE                                                28000001
28545          WHEN SQLCODE = +0                                        28010001
D28545             CONTINUE                                             28020001
D28545         WHEN OTHER                                               28030001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   28040001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 28050001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   28060001
D28545             SET IN400-PV-CURSOR-OPEN   TO TRUE                   28070001
D28545             MOVE SQLCODE     TO IN400-PV-PRC-SQLCDE              28080001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              28090001
D28545             STRING '  PARA: IN400-OPEN-SKUSTYL-ITM-CSR - '       28100001
D28545                                       DELIMITED BY SIZE          28110001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             28120001
D28545                    '  ' DELIMITED BY SIZE                        28130001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         28140001
D28545                    '  ' DELIMITED BY SIZE                        28150001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        28160001
D28545                    '  ' DELIMITED BY SIZE                        28170001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         28180001
D28545                    '  ' DELIMITED BY SIZE                        28190001
D28545                              INTO IN400-PV-PARAGRAPH             28200001
D28545     END-EVALUATE.                                                28210001
28545                                                                   28220001
28545 ******************************************************************28230001
28545 * IN400-FETCH-SKUSTYL-ITM-CSR                                     28240001
28545 ******************************************************************28250001
28545  IN400-FETCH-SKUSTYL-ITM-CSR.                                     28260001
28545                                                                   28270001
28545      EXEC SQL                                                     28280001
28545          FETCH SKUSTYL-ITM-CSR                                    28290001
28545          INTO  :INT00003-UPC-ID                                   28300001
28545               ,:INT00003-LOC-NBR                                  28310001
28545               ,:INT00003-EFF-BEG-TMST                             28320001
28545               ,:INT00003-UPC-NBR                                  28330001
28545               ,:INT00003-EFF-END-TMST :IN400-PV-NULL-EFF-END-TMST 28340001
28545               ,:INT00003-UPC-STAT-CDE :IN400-PV-NULL-UPC-STAT-CDE 28350001
28545               ,:INT00003-UNT-COST-AMT :IN400-PV-NULL-UNT-COST-AMT 28360001
28545               ,:INT00003-UNT-RTL-AMT  :IN400-PV-NULL-UNT-RTL-AMT  28370001
28545               ,:INT00003-MEITGP-NBR   :IN400-PV-NULL-MEITGP-NBR   28380001
28545               ,:INT00003-ITM-NBR                                  28390001
28545               ,:INT00003-INTR-UPC-ID                              28400001
28545               ,:INT00003-UPC-STAT-CHG-DTE                         28410001
28545               ,:INT00003-UNT-RTL-CHG-DTE                          28420001
28545               ,:INT00003-ORIG-CLR-DTE :IN400-PV-NULL-ORIG-CLR-DTE 28430001
28545               ,:INT00003-MKDN-CDE     :IN400-PV-NULL-MKDN-CDE     28440001
28545               ,:INT00003-SUB-CL-MDSEAR-ID                         28450001
28545               ,:INT00003-VS-ID :IN400-PV-NULL-VS-ID               28460001
28545               ,:INT00003-DEPT-NBR                                 28470001
28545               ,:INT00003-MAJ-CL-NBR                               28480001
28545               ,:INT00003-SUB-CL-NBR                               28490001
28545               ,:INT00003-SKU-NBR                                  28500001
28545               ,:INT00003-ENT-ID                                   28510001
28545               ,:INT00003-PLU-DWNLD-IND                            28520001
28545      END-EXEC.                                                    28530001
28545                                                                   28540001
28545      EVALUATE TRUE                                                28550001
28545          WHEN SQLCODE = +0                                        28560001
28545              MOVE INT00003-UNT-RTL-AMT TO IN400-PV-WORK-RETAIL    28570001
28545              PERFORM IN400-INV-GROUP-PRICING                      28580001
28545              SET IN400-PRIOR-FOUND  TO TRUE                       28590001
D28545             SET IN400-PV-FOUND     TO TRUE                       28600001
D28545             SET IN400-PV-ATT-FOUND TO TRUE                       28610001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        28620001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        28630001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               28640001
28545          WHEN SQLCODE = +100                                      28650001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       28660001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 28670001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 28680001
D28545             SET IN400-PV-NOT-FOUND       TO TRUE                 28690001
D28545             SET IN400-PV-ATT-NOT-FOUND   TO TRUE                 28700001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        28710001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        28720001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-ITM-CSR - '      28721001
D28545                                       DELIMITED BY SIZE          28722001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             28723001
D28545                    '  ' DELIMITED BY SIZE                        28724001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         28725001
D28545                    '  ' DELIMITED BY SIZE                        28726001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        28727001
D28545                    '  ' DELIMITED BY SIZE                        28728001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         28729001
D28545                    '  ' DELIMITED BY SIZE                        28730001
D28545                              INTO IN400-PV-PARAGRAPH             28740001
28545          WHEN OTHER                                               28750001
28545              MOVE ZEROS             TO IN400-PV-WORK-RETAIL       28760001
28545              SET IN400-PV-SQL-ERROR TO TRUE                       28770001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 28780001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   28790001
D28545             SET IN400-PV-CURSOR-FETCH    TO TRUE                 28800001
28545              SET IN400-PS-END-SKUSTYL-CSR TO TRUE                 28810001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        28820001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        28830001
D28545             STRING '  PARA: IN400-FETCH-SKUSTYL-ITM-CSR - '      28840001
D28545                                       DELIMITED BY SIZE          28850001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             28860001
D28545                    '  ' DELIMITED BY SIZE                        28870001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         28880001
D28545                    '  ' DELIMITED BY SIZE                        28890001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        28900001
D28545                    '  ' DELIMITED BY SIZE                        28910001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         28920001
D28545                    '  ' DELIMITED BY SIZE                        28930001
D28545                              INTO IN400-PV-PARAGRAPH             28940001
28545      END-EVALUATE.                                                28950001
28545                                                                   28960001
28545 ******************************************************************28970001
28545 * IN400-CLOSE-SKUSTYL-ITM-CSR                                     28980001
28545 ******************************************************************28990001
28545  IN400-CLOSE-SKUSTYL-ITM-CSR.                                     29000001
28545                                                                   29010001
28545      EXEC SQL                                                     29020001
28545          CLOSE SKUSTYL-ITM-CSR                                    29030001
28545      END-EXEC.                                                    29040001
28545                                                                   29050001
28545      EVALUATE TRUE                                                29060001
28545          WHEN SQLCODE = +0                                        29070001
D28545             CONTINUE                                             29080001
28545          WHEN OTHER                                               29090001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   29100001
D28545             SET IN400-PV-ATT-SQL-ERROR   TO TRUE                 29110001
RONNA              SET IN400-PV-DBV-SQL-ERROR TO TRUE                   29120001
D28545             SET IN400-PV-CURSOR-CLOSE  TO TRUE                   29130001
D28545             MOVE SQLCODE           TO IN400-PV-PRC-SQLCDE        29140001
D28545             MOVE SQLCODE           TO IN400-PV-ATT-SQLCDE        29150001
D28545             STRING '  PARA: IN400-CLOSE-SKUSTYL-ITM-CSR - '      29160001
D28545                                       DELIMITED BY SIZE          29170001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             29180001
D28545                    '  ' DELIMITED BY SIZE                        29190001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         29200001
D28545                    '  ' DELIMITED BY SIZE                        29210001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        29220001
D28545                    '  ' DELIMITED BY SIZE                        29230001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         29240001
D28545                    '  ' DELIMITED BY SIZE                        29250001
D28545                              INTO IN400-PV-PARAGRAPH             29260001
28545      END-EVALUATE.                                                29270001
28545                                                                   29280001
28545 ******************************************************************29290001
28545 * IN400-INV-LOOKUP-DEFAULT. DEFAULT INFORMATION LOOKUP            29300001
28545 * - THIS ROUTINE IS EXECUTED IF EITHER A VALID SWITCH WAS NOT SET 29310001
28545 *   OR THE SWITCH THAT WAS SET FAILED TO FIND ENOUGH TO PROCEED   29320001
28545 * - THIS ROUTINE WILL CHECK FOR A NON-ZERO / NON-SPACE CONDITION  29330001
28545 *   IN EACH OF THE PRIMARY SEARCH PARAMETERS (ITEM,UPC,SKU,UPCID).29340001
28545 * - IF ONE OF THE PARAMETERS WAS DETERMINED TO HAVE A VALUE OTHER 29350001
28545 *   THAN THE DEFAULT, PROCESSING WILL MAKE A FINAL ATTEMPT TO     29360001
28545 *   DETERMINE THE RETAIL BASED ON THESE VALUES.                   29370001
28545 * - FAILURE FROM THESE ATTEMPTS WILL RESULT IN A NOT FOUND        29380001
28545 *   CONDITION BEING RETURNED.                                     29390001
28545 ******************************************************************29400001
28545  IN400-INV-LOOKUP-DEFAULT.                                        29410001
28545                                                                   29420001
28545      SET IN400-PV-FOUND-WITH-ASSUMPTION TO TRUE.                  29430001
28545                                                                   29440001
28545 *       IS SKU INPUT PROVIDED ???                                 29450001
28545      IF IN400-PV-SKU-IN = SPACES                                  29460001
28545          OR IN400-PV-SKU-IN NOT NUMERIC                           29470001
28545          OR IN400-PV-SKU-IN = ZEROES                              29480001
D28545*****    OR IN400-PV-DUMMY-SKU                                    29490001
28545 *           IS UPC INPUT PROVIDED ???                             29500001
28545          IF IN400-PV-UPC-NBR-IN = SPACES                          29510001
28545              OR IN400-PV-UPC-NBR-IN NOT NUMERIC                   29520001
28545              OR IN400-PV-UPC-NBR-IN = ZEROES                      29530001
28545 *               IS INTR-UPC-ID INPUT PROVIDED ???                 29540001
28545              IF IN400-PV-UPC-ID-SPC = ZEROES                      29550001
28545 *                   IS ITEM NUMBER INPUT PROVIDED ???             29560001
28545                  IF IN400-PV-ITM-NBR-IN = SPACES                  29570001
28545                      OR IN400-PV-ITM-NBR-IN NOT NUMERIC           29580001
28545                      OR IN400-PV-ITM-NBR-IN = ZEROES              29590001
28545                          SET IN400-PV-NO-LOOKUP-TYPE    TO TRUE   29600001
28545                  ELSE                                             29610001
28545                      SET IN400-PV-TRY-ITM-NBR-LOOKUP TO TRUE      29620001
28545                      SET IN400-PV-ITM-NBR-LOOKUP    TO TRUE       29630001
28545                  END-IF                                           29640001
28545              ELSE                                                 29650001
28545                  SET IN400-PV-TRY-UPC-ID-LOOKUP  TO TRUE          29660001
28545                  SET IN400-PV-INTR-UPC-ID-LOOKUP TO TRUE          29670001
28545              END-IF                                               29680001
28545          ELSE                                                     29690001
28545              SET IN400-PV-TRY-UPC-NBR-LOOKUP TO TRUE              29700001
28545              SET IN400-PV-UPC-NBR-LOOKUP    TO TRUE               29710001
28545          END-IF                                                   29720001
28545      ELSE                                                         29730001
28545          SET IN400-PV-TRY-SKU-LOOKUP    TO TRUE                   29740001
28545          SET IN400-PV-SKU-LOOKUP        TO TRUE                   29750001
28545      END-IF.                                                      29760001
28545                                                                   29770001
28545      EVALUATE TRUE                                                29780001
28545          WHEN IN400-PV-SKU-LOOKUP                                 29790001
D28545           IF IN400-PV-DUMMY-SKU                                  29800001
D28545             MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU        29810001
D28545             MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU        29820001
D28545             PERFORM IN400-DUMMY-SKU-LOOKUP                       29830001
D28545           ELSE                                                   29840001
28545              MOVE IN400-PV-SKU-IN-NUM     TO IN400-PV-WORK-SKU    29850001
28545              PERFORM IN400-INV-LOOKUP-BY-SKU                      29860001
D28545           END-IF                                                 29870001
28545          WHEN IN400-PV-UPC-NBR-LOOKUP                             29880001
I28545           IF (IN400-PV-KOHLS-UPC AND IN400-PV-DUMMY-UPC)         29890001
D28545             MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-WORK-SKU        29900001
D28545             MOVE IN400-PV-SKU-IN-NUM TO IN400-PV-DUMB-SKU        29910001
D28545             PERFORM IN400-DUMMY-SKU-LOOKUP                       29920001
D28545           ELSE                                                   29930001
28545              MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-PV-WORK-UPC-NBR29940001
28545              PERFORM IN400-INV-LOOKUP-BY-UPC                      29950001
D28545           END-IF                                                 29960001
28545          WHEN IN400-PV-INTR-UPC-ID-LOOKUP                         29970001
28545              MOVE IN400-PV-UPC-ID-SPC     TO IN400-PV-WORK-UPC-ID 29980001
28545              PERFORM IN400-INV-LOOKUP-BY-UPC-ID                   29990001
28545          WHEN IN400-PV-ITM-NBR-LOOKUP                             30000001
28545              MOVE IN400-PV-ITM-NBR-IN-NUM TO IN400-PV-WORK-ITM-NBR30010001
28545              PERFORM IN400-INV-LOOKUP-BY-ITM-NBR                  30020001
28545          WHEN OTHER                                               30030001
28545              SET IN400-PV-NOT-FOUND        TO TRUE                30040001
D28545             SET IN400-PV-ATT-NOT-FOUND    TO TRUE                30050001
D28545             SET IN400-PV-MISSING-KEY-DATA TO TRUE                30060001
D28545             STRING '  PARA: IN400-INV-LOOKUP-DEFAULT - '         30070001
D28545                                       DELIMITED BY SIZE          30080001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             30090001
D28545                    '  ' DELIMITED BY SIZE                        30100001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         30110001
D28545                    '  ' DELIMITED BY SIZE                        30120001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        30130001
D28545                    '  ' DELIMITED BY SIZE                        30140001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         30150001
D28545                    '  ' DELIMITED BY SIZE                        30160001
D28545                              INTO IN400-PV-PARAGRAPH             30170001
28545      END-EVALUATE.                                                30180001
28545                                                                   30190001
28545 ******************************************************************30200001
28545 * IN400-INV-GROUP-PRICING.                                        30210001
28545 ******************************************************************30220001
28545  IN400-INV-GROUP-PRICING.                                         30230001
28545                                                                   30240001
28545       IF IN400-PV-NULL-MEITGP-NBR IS LESS THAN ZEROS              30250001
28545           MOVE ZEROS     TO INT00003-MEITGP-NBR                   30260001
28545       END-IF.                                                     30270001
28545                                                                   30280001
28545       IF INT00003-MEITGP-NBR IS EQUAL TO ZEROS                    30290001
28545           MOVE ZEROS     TO IN400-PV-MITGPL-QTY                   30300001
28545           MOVE ZEROS     TO IN400-PV-MITGPL-GP-AMT                30310001
28545           SET IN400-PS-RTL-FOUND TO TRUE                          30320001
28545       ELSE                                                        30330001
28545           EXEC SQL                                                30340001
28545               SELECT MITGPL_QTY                                   30350001
28545                     ,GP_AMT                                       30360001
28545               INTO :MITGPL-MITGPL-QTY                             30370001
28545                   ,:MITGPL-GP-AMT                                 30380001
28545               FROM TMITGPL                                        30390001
28545               WHERE OPERCO_NBR = '03'                             30400001
28545                 AND MEITGP_NBR = :INT00003-MEITGP-NBR             30410001
28545                 AND ADLOC_ID = '   '                              30420001
28545                 AND (:IN400-PV-EFF-BEG-DTE-X                      30430001
28545                              BETWEEN BEG_DTE AND END_DTE)         30440001
28545               WITH UR                                             30450001
28545           END-EXEC                                                30460001
28545                                                                   30470001
28545           EVALUATE TRUE                                           30480001
28545             WHEN SQLCODE = ZERO                                   30490001
28545               COMPUTE IN400-PV-WORK-RETAIL ROUNDED =              30500001
28545                         (MITGPL-GP-AMT / MITGPL-MITGPL-QTY )      30510001
28545               MOVE MITGPL-MITGPL-QTY TO IN400-PV-MITGPL-QTY       30520001
28545               MOVE MITGPL-GP-AMT     TO IN400-PV-MITGPL-GP-AMT    30530001
28545               SET IN400-PS-RTL-FOUND TO TRUE                      30540001
D28545            WHEN OTHER                                            30550001
D28545              MOVE ZEROS             TO IN400-PV-MITGPL-QTY       30560001
D28545              MOVE ZEROS             TO IN400-PV-MITGPL-GP-AMT    30570001
D28545              SET IN400-PS-RTL-FOUND TO TRUE                      30580001
28545           END-EVALUATE                                            30590001
28545       END-IF.                                                     30600001
28545                                                                   30610001
28545 ******************************************************************30620001
28545 * IN400-INV-ATTRIBUTES-LOOKUP.                                    30630001
28545 ******************************************************************30640001
28545  IN400-INV-ATTRIBUTES-LOOKUP.                                     30650001
28545                                                                   30660001
28545      MOVE INT00003-DEPT-NBR       TO IN400-CONVERT-DEPT.          30670001
28545      MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          30680001
28545                                                                   30690001
28545      EXEC SQL                                                     30700001
28545          SELECT F.DEPT_NBR                                        30710001
28545                ,F.INHOUSE_NBR                                     30720001
28545                ,E.DUN_NBR                                         30730001
28545          INTO :VNDDPT-DEPT-NBR                                    30740001
28545              ,:VNDDPT-INHOUSE-NBR                                 30750001
28545              ,:EXTENT-DUN-NBR                                     30760001
28545          FROM TVNDDPT F                                           30770001
28545              ,TEXTENT E                                           30780001
28545          WHERE F.ENT_ID = E.ENT_ID                                30790001
28545            AND F.ENT_ID = :INT00003-ENT-ID                        30800001
28545            AND F.DEPT_NBR = :IN400-PV-WORK-DEPT-3X                30810001
28545          WITH UR                                                  30820001
28545      END-EXEC.                                                    30830001
28545                                                                   30840001
28545      EVALUATE TRUE                                                30850001
28545          WHEN SQLCODE = 0                                         30860001
D28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              30870001
D28545             SET IN400-PS-ATTR-FOUND TO TRUE                      30880001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              30890001
D28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               30900001
28545          WHEN SQLCODE = +100                                      30910001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  30920001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               30930001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   30940001
D28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  30950001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   30960001
D28545             SET IN400-PV-VSM-LOOKUP    TO TRUE                   30970001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              30980001
D28545             STRING '  PARA: IN400-INV-ATTRIBUTES-LOOKUP - '      30990001
D28545                                       DELIMITED BY SIZE          31000001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             31010001
D28545                    '  ' DELIMITED BY SIZE                        31020001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         31030001
D28545                    '  ' DELIMITED BY SIZE                        31040001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        31050001
D28545                    '  ' DELIMITED BY SIZE                        31060001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         31070001
D28545                    '  ' DELIMITED BY SIZE                        31080001
D28545                              INTO IN400-PV-PARAGRAPH             31090001
28545          WHEN OTHER                                               31100001
D28545             MOVE ZEROS       TO VNDDPT-DEPT-NBR                  31110001
D28545             MOVE ZEROS       TO VNDDPT-INHOUSE-NBR               31120001
D28545             MOVE ZEROS       TO EXTENT-DUN-NBR                   31130001
D28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  31140001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   31150001
D28545             SET IN400-PV-SQL-ERROR     TO TRUE                   31160001
D28545             SET IN400-PV-VSM-LOOKUP    TO TRUE                   31170001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              31180001
D28545             STRING '  PARA: IN400-INV-ATTRIBUTES-LOOKUP - '      31190001
D28545                                       DELIMITED BY SIZE          31200001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             31210001
D28545                    '  ' DELIMITED BY SIZE                        31220001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         31230001
D28545                    '  ' DELIMITED BY SIZE                        31240001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        31250001
D28545                    '  ' DELIMITED BY SIZE                        31260001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         31270001
D28545                    '  ' DELIMITED BY SIZE                        31280001
D28545                              INTO IN400-PV-PARAGRAPH             31290001
28545      END-EVALUATE.                                                31300001
28545                                                                   31310001
28545 ******************************************************************31320001
28545 * IN400-INV-MBS-LOOKUP.                                           31330001
28545 ******************************************************************31340001
28545  IN400-INV-MBS-LOOKUP.                                            31350001
28545                                                                   31360001
28545      MOVE INT00003-DEPT-NBR       TO IN400-CONVERT-DEPT.          31370001
28545      MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          31380001
28545                                                                   31390001
28545      EXEC SQL                                                     31400001
I28545       SELECT A.BYR_NBR                                           31410001
I28545             ,A.GMA_NBR                                           31420001
I28545             ,A.DMA_NBR                                           31430001
I28545       INTO :IN400-ATT-BYR-NBR                                    31440001
I28545           ,:IN400-ATT-GMA-NBR                                    31450001
I28545           ,:IN400-ATT-DMA-NBR                                    31460001
I28545       FROM TMDSEAR A                                             31470001
I28545       WHERE A.DEPT_NBR = :IN400-PV-WORK-DEPT-3X                  31480001
I28545         AND A.MDSELV_CDE = 'DPT'                                 31490001
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= A.STRT_DTE AND           31500001
I28545              :IN400-PV-EFF-BEG-DTE-X <= A.END_DTE)               31510001
I28545       WITH UR                                                    31520001
28545      END-EXEC.                                                    31530001
28545                                                                   31540001
28545      EVALUATE TRUE                                                31550001
28545          WHEN SQLCODE = 0                                         31560001
I28545             PERFORM IN400-INV-MBS-BYR-LOOKUP                     31570001
I28545             PERFORM IN400-INV-MBS-DMM-LOOKUP                     31580001
I28545             PERFORM IN400-INV-MBS-GMM-LOOKUP                     31590001
I28545             PERFORM IN400-INV-MBS-DESC-LOOKUP                    31600001
28545          WHEN SQLCODE = +100                                      31610001
28545              MOVE SPACES      TO IN400-ATT-GMA-NBR                31620001
28545              MOVE SPACES      TO IN400-ATT-DMA-NBR                31630001
28545              MOVE SPACES      TO IN400-ATT-BYR-NBR                31640001
28545              MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          31650001
28545              MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           31660001
28545              MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          31670001
28545              MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           31680001
28545              MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          31690001
28545              MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           31700001
F28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            31710001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   31720001
D28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   31730001
D28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  31740001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              31750001
D28545             STRING '  PARA: IN400-INV-MBS-LOOKUP - '             31760001
D28545                                       DELIMITED BY SIZE          31770001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             31780001
D28545                    '  ' DELIMITED BY SIZE                        31790001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         31800001
D28545                    '  ' DELIMITED BY SIZE                        31810001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        31820001
D28545                    '  ' DELIMITED BY SIZE                        31830001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         31840001
D28545                    '  ' DELIMITED BY SIZE                        31850001
D28545                              INTO IN400-PV-PARAGRAPH             31860001
28545          WHEN OTHER                                               31870001
D28545             MOVE SPACES      TO IN400-ATT-GMA-NBR                31880001
D28545             MOVE SPACES      TO IN400-ATT-DMA-NBR                31890001
D28545             MOVE SPACES      TO IN400-ATT-BYR-NBR                31900001
D28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          31910001
D28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           31920001
D28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          31930001
D28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           31940001
D28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          31950001
D28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           31960001
F28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            31970001
D28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   31980001
28545              SET IN400-PV-SQL-ERROR     TO TRUE                   31990001
D28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   32000001
D28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  32010001
D28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32020001
D28545             STRING '  PARA: IN400-INV-MBS-LOOKUP - '             32030001
D28545                                       DELIMITED BY SIZE          32040001
D28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             32050001
D28545                    '  ' DELIMITED BY SIZE                        32060001
D28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         32070001
D28545                    '  ' DELIMITED BY SIZE                        32080001
D28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        32090001
D28545                    '  ' DELIMITED BY SIZE                        32100001
D28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         32110001
D28545                    '  ' DELIMITED BY SIZE                        32120001
D28545                              INTO IN400-PV-PARAGRAPH             32130001
28545      END-EVALUATE.                                                32140001
28545                                                                   32150001
I28545******************************************************************32160001
I28545* IN400-INV-MBS-BYR-LOOKUP.                                       32170001
I28545******************************************************************32180001
I28545 IN400-INV-MBS-BYR-LOOKUP.                                        32190001
I28545                                                                  32200001
I28545     MOVE INT00003-DEPT-NBR       TO IN400-CONVERT-DEPT.          32210001
I28545     MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          32220001
I28545                                                                  32230001
I28545     EXEC SQL                                                     32240001
I28545       SELECT B.WORKER_LAST_NAME                                  32250001
I28545             ,B.WORKER_FIR_NAME                                   32260001
I28545       INTO :IN400-ATT-BYR-LAST-NAME                              32270001
I28545           ,:IN400-ATT-BYR-FIR-NAME                               32280001
I28545       FROM TMDSEAR A,                                            32290001
I28545            TRSPBAR B                                             32300001
I28545       WHERE A.OPERCO_NBR = '03'                                  32310001
I28545         AND GMA_NBR = :IN400-ATT-GMA-NBR                         32320001
I28545         AND DMA_NBR = :IN400-ATT-DMA-NBR                         32330001
I28545         AND DEPT_NBR = :IN400-PV-WORK-DEPT-3X                    32340001
I28545         AND MAJ_CL_NBR = '00'                                    32350001
I28545         AND SUB_CL_NBR = '000'                                   32360001
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        32370001
I28545         AND B.WORKER_NBR > DECIMAL(0)                            32380001
I28545         AND B.RSPLVL_CDE  = 'BYR'                                32390001
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    32400001
I28545              :IN400-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        32410001
I28545       WITH UR                                                    32420001
I28545     END-EXEC.                                                    32430001
I28545                                                                  32440001
I28545     EVALUATE TRUE                                                32450001
I28545         WHEN SQLCODE = 0                                         32460001
I28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              32470001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32480001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32490001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32500001
I28545         WHEN SQLCODE = +100                                      32510001
I28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          32520001
I28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           32530001
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32540001
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32550001
I28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              32560001
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32570001
I28545         WHEN OTHER                                               32580001
I28545             MOVE SPACES      TO IN400-ATT-BYR-LAST-NAME          32590001
I28545             MOVE SPACES      TO IN400-ATT-BYR-FIR-NAME           32600001
I28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   32610001
I28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   32620001
I28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   32630001
I28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  32640001
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32650001
I28545             STRING '  PARA: IN400-INV-MBS-BYR-LOOKUP - '         32660001
I28545                                       DELIMITED BY SIZE          32670001
I28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             32680001
I28545                    '  ' DELIMITED BY SIZE                        32690001
I28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         32700001
I28545                    '  ' DELIMITED BY SIZE                        32710001
I28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        32720001
I28545                    '  ' DELIMITED BY SIZE                        32730001
I28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         32740001
I28545                    '  ' DELIMITED BY SIZE                        32750001
I28545                              INTO IN400-PV-PARAGRAPH             32760001
I28545     END-EVALUATE.                                                32770001
I28545                                                                  32780001
I28545******************************************************************32790001
I28545* IN400-INV-MBS-DMM-LOOKUP.                                       32800001
I28545******************************************************************32810001
I28545 IN400-INV-MBS-DMM-LOOKUP.                                        32820001
I28545                                                                  32830001
I28545     EXEC SQL                                                     32840001
I28545       SELECT B.WORKER_LAST_NAME                                  32850001
I28545             ,B.WORKER_FIR_NAME                                   32860001
I28545       INTO :IN400-ATT-DMM-LAST-NAME                              32861001
I28545           ,:IN400-ATT-DMM-FIR-NAME                               32862001
I28545       FROM TMDSEAR A,                                            32863001
I28545            TRSPBAR B                                             32864001
I28545       WHERE A.OPERCO_NBR = '03'                                  32865001
I28545         AND GMA_NBR = :IN400-ATT-GMA-NBR                         32866001
I28545         AND DMA_NBR = :IN400-ATT-DMA-NBR                         32866101
I28545         AND DEPT_NBR = '000'                                     32866201
I28545         AND MAJ_CL_NBR = '00'                                    32866301
I28545         AND SUB_CL_NBR = '000'                                   32866401
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        32866501
I28545         AND B.WORKER_NBR > DECIMAL(0)                            32866601
I28545         AND B.RSPLVL_CDE  = 'DMM'                                32866701
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    32866801
I28545              :IN400-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        32866901
I28545       WITH UR                                                    32867001
I28545     END-EXEC.                                                    32867101
I28545                                                                  32867201
I28545     EVALUATE TRUE                                                32867301
I28545         WHEN SQLCODE = 0                                         32867401
I28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              32867501
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32867601
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32867701
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32867801
I28545         WHEN SQLCODE = +100                                      32867901
I28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          32868001
I28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           32868101
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32868201
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32868301
I28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              32868401
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32868501
I28545         WHEN OTHER                                               32868601
I28545             MOVE SPACES      TO IN400-ATT-DMM-LAST-NAME          32868701
I28545             MOVE SPACES      TO IN400-ATT-DMM-FIR-NAME           32868801
I28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   32868901
I28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   32869001
I28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   32869101
I28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  32869201
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32869301
I28545             STRING '  PARA: IN400-INV-MBS-DMM-LOOKUP - '         32869401
I28545                                       DELIMITED BY SIZE          32869501
I28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             32869601
I28545                    '  ' DELIMITED BY SIZE                        32869701
I28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         32869801
I28545                    '  ' DELIMITED BY SIZE                        32869901
I28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        32870001
I28545                    '  ' DELIMITED BY SIZE                        32870101
I28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         32870201
I28545                    '  ' DELIMITED BY SIZE                        32870301
I28545                              INTO IN400-PV-PARAGRAPH             32870401
I28545     END-EVALUATE.                                                32870501
I28545                                                                  32870601
I28545******************************************************************32870701
I28545* IN400-INV-MBS-GMM-LOOKUP.                                       32870801
I28545******************************************************************32870901
I28545 IN400-INV-MBS-GMM-LOOKUP.                                        32871001
I28545                                                                  32871101
I28545     EXEC SQL                                                     32871201
I28545       SELECT B.WORKER_LAST_NAME                                  32871301
I28545             ,B.WORKER_FIR_NAME                                   32871401
I28545       INTO :IN400-ATT-GMM-LAST-NAME                              32871501
I28545           ,:IN400-ATT-GMM-FIR-NAME                               32871601
I28545       FROM TMDSEAR A,                                            32871701
I28545            TRSPBAR B                                             32871801
I28545       WHERE A.OPERCO_NBR = '03'                                  32871901
I28545         AND GMA_NBR = :IN400-ATT-GMA-NBR                         32872001
I28545         AND DMA_NBR = '00'                                       32872101
I28545         AND DEPT_NBR = '000'                                     32872201
I28545         AND MAJ_CL_NBR = '00'                                    32872301
I28545         AND SUB_CL_NBR = '000'                                   32872401
I28545         AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                        32872501
I28545         AND B.WORKER_NBR > DECIMAL(0)                            32872601
I28545         AND B.RSPLVL_CDE  = 'GMM'                                32872701
I28545         AND (:IN400-PV-EFF-BEG-DTE-X >= B.WORKER_STRT_DTE AND    32872801
I28545              :IN400-PV-EFF-BEG-DTE-X <= B.WORKER_END_DTE)        32872901
I28545       WITH UR                                                    32873001
I28545     END-EXEC.                                                    32873101
I28545                                                                  32873201
I28545     EVALUATE TRUE                                                32873301
I28545         WHEN SQLCODE = 0                                         32873401
I28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              32873501
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32873601
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32873701
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32873801
I28545         WHEN SQLCODE = +100                                      32873901
I28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          32874001
I28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           32874101
I28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32874201
I28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32874301
I28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              32874401
I28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32874501
I28545         WHEN OTHER                                               32874601
I28545             MOVE SPACES      TO IN400-ATT-GMM-LAST-NAME          32874701
I28545             MOVE SPACES      TO IN400-ATT-GMM-FIR-NAME           32874801
I28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   32874901
I28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   32875001
I28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   32875101
I28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  32875201
I28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32875301
I28545             STRING '  PARA: IN400-INV-MBS-GMM-LOOKUP - '         32875401
I28545                                       DELIMITED BY SIZE          32875501
I28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             32875601
I28545                    '  ' DELIMITED BY SIZE                        32875701
I28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         32875801
I28545                    '  ' DELIMITED BY SIZE                        32875901
I28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        32876001
I28545                    '  ' DELIMITED BY SIZE                        32876101
I28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         32876201
I28545                    '  ' DELIMITED BY SIZE                        32876301
I28545                              INTO IN400-PV-PARAGRAPH             32876401
I28545     END-EVALUATE.                                                32876501
I28545                                                                  32876601
F28545******************************************************************32876701
F28545* IN400-INV-MBS-DESC-LOOKUP.                                      32876801
F28545******************************************************************32876901
F28545 IN400-INV-MBS-DESC-LOOKUP.                                       32877001
F28545                                                                  32877101
F28545     MOVE INT00003-DEPT-NBR       TO IN400-CONVERT-DEPT.          32877201
F28545     MOVE IN400-CONVERT-DEPT      TO IN400-PV-WORK-DEPT.          32877301
F28545                                                                  32877401
F28545     MOVE INT00003-MAJ-CL-NBR     TO IN400-CONVERT-MCL.           32877501
F28545     MOVE IN400-CONVERT-MCL       TO IN400-PV-WORK-MCL.           32877601
F28545                                                                  32877701
F28545     MOVE INT00003-SUB-CL-NBR     TO IN400-CONVERT-SCL.           32877801
F28545     MOVE IN400-CONVERT-SCL       TO IN400-PV-WORK-SCL.           32877901
F28545                                                                  32878001
F28545     EXEC SQL                                                     32878101
F28545          SELECT MDSEAR_DESC                                      32878201
F28545          INTO :IN400-ATT-MDSEAR-DESC                             32878301
F28545          FROM TMDSEAR A,                                         32878401
F28545               TAPLAVL B                                          32878501
F28545          WHERE A.OPERCO_NBR = '03'                               32878601
F28545            AND A.DEPT_NBR = :IN400-PV-WORK-DEPT-3X               32878701
F28545            AND A.MAJ_CL_NBR = :IN400-PV-WORK-MCL-2X              32878801
F28545            AND A.SUB_CL_NBR = :IN400-PV-WORK-SCL-3X              32878901
F28545            AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                     32879001
F28545            AND MDSELV_CDE = 'SCL'                                32879101
F28545            AND APLSYS_CDE = 'IN'                                 32879201
F28545            AND DATE(CURRENT TIMESTAMP) BETWEEN                   32879301
F28545                                  STRT_DTE AND END_DTE            32879401
F28545            AND DATE(CURRENT TIMESTAMP) BETWEEN                   32879501
F28545                   MDSEAR_STRT_DTE AND MDSEAR_END_DTE             32879601
F28545        WITH UR                                                   32879701
F28545     END-EXEC.                                                    32879801
F28545                                                                  32879901
F28545     EVALUATE TRUE                                                32880001
F28545         WHEN SQLCODE = 0                                         32880101
F28545             SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE              32880201
F28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32880301
F28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32880401
F28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32880501
F28545         WHEN SQLCODE = +100                                      32880601
F28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            32880701
F28545             SET IN400-PV-ATT-FOUND-WITH-ASSMPT TO TRUE           32880801
F28545             SET IN400-PS-ATTR-FOUND TO TRUE                      32880901
F28545             MOVE ZEROS       TO IN400-PV-ATT-SQLCDE              32881001
F28545             MOVE SPACES      TO IN400-PV-PARAGRAPH               32881101
F28545         WHEN OTHER                                               32881201
F28545             MOVE SPACES      TO IN400-ATT-MDSEAR-DESC            32881301
F28545             SET IN400-PV-ATT-NOT-FOUND TO TRUE                   32881401
F28545             SET IN400-PV-ATT-SQL-ERROR TO TRUE                   32881501
F28545             SET IN400-PV-MBS-LOOKUP    TO TRUE                   32881601
F28545             SET IN400-PS-ATTR-NOT-FOUND TO TRUE                  32881701
F28545             MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE              32881801
F28545             STRING '  PARA: IN400-INV-MBS-DESC-LOOKUP - '        32881901
F28545                                       DELIMITED BY SIZE          32882001
F28545                    IN400-PV-SKU-IN DELIMITED BY SIZE             32882101
F28545                    '  ' DELIMITED BY SIZE                        32882201
F28545                    IN400-PV-UPC-NBR-IN DELIMITED BY SIZE         32882301
F28545                    '  ' DELIMITED BY SIZE                        32882401
F28545                    IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE        32882501
F28545                    '  ' DELIMITED BY SIZE                        32882601
F28545                    IN400-PV-ITM-NBR-IN DELIMITED BY SIZE         32882701
F28545                    '  ' DELIMITED BY SIZE                        32882801
F28545                              INTO IN400-PV-PARAGRAPH             32882901
F28545     END-EVALUATE.                                                32883001
F28545                                                                  32883101
28545 ******************************************************************32883201
28545 * IN400-INV-VENDOR-ATTRIB-LOOKUP.                                 32883301
28545 ******************************************************************32883401
28545  IN400-INV-VENDOR-ATTRIB-LOOKUP.                                  32883501
BV                                                                      32883601
RONNA *    SET BV001-PV-UPC-ID-LOOKUP TO TRUE.                          32883701
RONNA *    THERE IS NO BRAND IN THE SKU DELETE TABLE AT THIS TIME.      32883801
RONNA *    SO DEFAULT THE BRAND TO UNKNOWN BRAND VALUE 2230             32883901
RONNA      SET BV001-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    32884001
BV                                                                      32884101
RONNA      MOVE 2230                     TO BV001-PV-BRAND-IN-9.        32884201
RONNA                                                                   32884301
BV    **** MOVE INT00003-EFF-BEG-TMST (1:10) TO BV001-PV-EFF-DTE-IN.    32884401
BV         MOVE IN400-PV-EFF-DTE-IN   TO BV001-PV-EFF-DTE-IN.           32884501
RONNA *    MOVE INT00003-INTR-UPC-ID  TO BV001-PV-UPC-ID-IN-9.          32884601
RONNA      IF IN400-PV-ENT-ID-IN = SPACES                               32884701
BV            MOVE INT00003-ENT-ID       TO BV001-PV-ENT-ID-IN-9        32884801
RONNA      ELSE                                                         32884901
RONNA         MOVE IN400-PV-ENT-ID-IN-9  TO BV001-PV-ENT-ID-IN-9        32885001
RONNA      END-IF.                                                      32886001
RONNA                                                                   32887001
RONNA      IF IN400-PV-DEPT-IN = SPACES                                 32888001
BV            MOVE INT00003-DEPT-NBR     TO BV001-PV-DEPT-IN-9          32889001
RONNA      ELSE                                                         32890001
RONNA         MOVE IN400-PV-DEPT-IN-9    TO BV001-PV-DEPT-IN-9          32900001
RONNA      END-IF.                                                      32910001
BV                                                                      32920001
RONNA *    DISPLAY ' IN IN400-INV-VENDOR-ATTRIB-LOOKUP ****'.           32930001
RONNA *    DISPLAY ' BV001-PV-ENT-ID-IN-9: ' BV001-PV-ENT-ID-IN-9.      32940001
RONNA *    DISPLAY ' BV001-PV-BRAND-IN-9 : ' BV001-PV-BRAND-IN-9.       32950001
RONNA *    DISPLAY ' BV001-PV-EFF-DTE-IN : ' BV001-PV-EFF-DTE-IN.       32960001
RONNA *    DISPLAY ' BV001-PV-DEPT-IN-9  : ' BV001-PV-DEPT-IN-9.        32961001
RONNA                                                                   32962001
BV         PERFORM BV001-LOOKUP-MAIN.                                   32963001
BV         IF BV001-PV-FOUND-REL-OR-UNK OR                              32964001
RONNA         BV001-PAST-OR-FUT-DBV-REL-FND                             32965001
BV            SET IN400-PV-ATT-FOUND-AS-RQSTD TO TRUE                   32966001
BV            SET IN400-PS-ATTR-FOUND TO TRUE                           32967001
RONNA         SET IN400-PS-BVUTIL-FOUND TO TRUE                         32968001
RONNA         IF IN400-PS-DBV-NO-ASSUMP                                 32969001
RONNA            SET IN400-PV-DBV-FOUND-AS-RQSTD TO TRUE                32970001
RONNA         ELSE                                                      32980001
RONNA            SET IN400-PV-DBV-FOUND-WITH-ASSMPT TO TRUE             32981001
RONNA         END-IF                                                    32982001
BV         ELSE                                                         32983001
BV            MOVE ZEROS       TO BV001-PV-DEPT-OUT                     32984001
BV            MOVE ZEROS       TO BV001-PV-ENT-ID-OUT                   32985001
BV            MOVE ZEROS       TO BV001-PV-RLTNSHP-ID-OUT               32986001
BV            MOVE ZEROS       TO BV001-PV-BRAND-OUT                    32987001
BV            SET IN400-PV-ATT-NOT-FOUND TO TRUE                        32988001
BV            SET IN400-PV-BRAND-LOOKUP  TO TRUE                        32989001
BV            SET IN400-PS-ATTR-NOT-FOUND TO TRUE                       32990001
RONNA         SET IN400-PV-DBV-NOT-FOUND TO TRUE                        33000001
BV            MOVE SQLCODE     TO IN400-PV-ATT-SQLCDE                   33010001
BV            STRING '  PARA: IN400-INV-VENDOR-ATTRIB-LOOKUP - '        33020001
BV                                      DELIMITED BY SIZE               33021001
BV                   IN400-PV-SKU-IN DELIMITED BY SIZE                  33022001
BV                   '  ' DELIMITED BY SIZE                             33023001
BV                   IN400-PV-UPC-NBR-IN DELIMITED BY SIZE              33024001
BV                   '  ' DELIMITED BY SIZE                             33025001
BV                   IN400-PV-UPC-ID-IN-X DELIMITED BY SIZE             33026001
BV                   '  ' DELIMITED BY SIZE                             33027001
BV                   IN400-PV-ITM-NBR-IN DELIMITED BY SIZE              33028001
BV                   '  ' DELIMITED BY SIZE                             33029001
BV                             INTO IN400-PV-PARAGRAPH                  33030001
BV         END-IF.                                                      33040001
BV                                                                      33050001
RONNA5******************************************************************33060001
RONNA5* IN400-INV-UNKN-VEND-ATT-LOOKUP.                                 33070001
RONNA5******************************************************************33080001
RONNA5 IN400-INV-UNKN-VEND-ATT-LOOKUP.                                  33090001
RONNA5                                                                  33100001
RONNA5*    THIS IS FOR WHEN AN ITEM IS NOT FOUND IN EITHER VSM OR       33101001
RONNA5*    THE SKU DELETE TABLE.   THE VENDOR AND BRAND TO THIS ITEM    33102001
RONNA5*    THE PRICING MODULE WILL DEFAUL THE VENDOR AND BRAND TO       33103001
RONNA5*    UNKNOWN/UNKNOWN 5161/2230, BUT A SWITCH WILL INDICATE THAT   33104001
RONNA5*    THE BRAND VENDOR RELATIONSHIP WAS NOT FOUND.                 33105001
RONNA5*                                                                 33106001
RONNA5*    THE DEPARTMENT NUMBER MUST BE PASSED INTO THE PRICING        33107001
RONNA5*    UTILITY TO BE ABLE TO ASSIGN A DATALESS KEY.                 33108001
RONNA5     IF IN400-PV-DEPT-IN = SPACES                                 33108101
RONNA5        CONTINUE                                                  33108201
RONNA5     ELSE                                                         33108301
RONNA5        SET BV001-PV-BRND-VND-DPT-LOOKUP TO TRUE                  33108401
RONNA5                                                                  33108501
RONNA5        MOVE 2230                     TO BV001-PV-BRAND-IN-9      33108601
S28582        IF IN400-PV-ENT-ID-IN = SPACES                            33108701
S28582            MOVE 5161                 TO BV001-PV-ENT-ID-IN-9     33108801
S28582        ELSE                                                      33108901
S28582            MOVE IN400-PV-ENT-ID-IN-9 TO BV001-PV-ENT-ID-IN-9     33109001
S28582        END-IF                                                    33109101
RONNA5        MOVE IN400-PV-EFF-DTE-IN   TO BV001-PV-EFF-DTE-IN         33109201
RONNA5        MOVE IN400-PV-DEPT-IN-9    TO BV001-PV-DEPT-IN-9          33109301
RONNA5        PERFORM BV001-LOOKUP-MAIN                                 33109401
RONNA5        SET IN400-PV-DBV-NOT-FOUND TO TRUE                        33109501
RONNA5     END-IF.                                                      33109601
RONNA5                                                                  33109701
RONNA5                                                                  33109801
RONNA5******************************************************************33109901
RONNA5* IN400-INV-UNKN-VEND-OUTPUT                                      33110001
RONNA5******************************************************************33111001
RONNA5 IN400-INV-UNKN-VEND-OUTPUT.                                      33112001
RONNA5                                                                  33113001
RONNA5     IF IN400-PV-SKU-IN-NUM     NOT EQUAL ZEROS                   33114001
RONNA5         MOVE IN400-PV-SKU-IN-NUM     TO IN400-VND-SKU-OUT        33115001
RONNA5     ELSE                                                         33115101
RONNA5         MOVE ZEROS                   TO IN400-VND-SKU-OUT        33115201
RONNA5     END-IF.                                                      33115301
RONNA5                                                                  33115401
RONNA5     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33115501
RONNA5         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-VND-UPC-OUT        33115601
RONNA5     ELSE                                                         33115701
RONNA5         MOVE ZEROS                   TO IN400-VND-UPC-OUT        33115801
RONNA5     END-IF.                                                      33115901
RONNA5                                                                  33116001
RONNA5     IF IN400-PV-ITM-NBR-IN     NOT EQUAL ZEROS                   33117001
RONNA5         MOVE IN400-PV-ITM-NBR-IN     TO IN400-VND-ITM-NBR-OUT    33117101
RONNA5     ELSE                                                         33117201
RONNA5         MOVE ZEROS                   TO IN400-VND-ITM-NBR-OUT    33117301
RONNA5     END-IF.                                                      33117401
RONNA5                                                                  33117501
RONNA5     MOVE BV001-PV-DEPT-OUT       TO IN400-VND-DEPT-OUT.          33117601
RONNA5     MOVE BV001-PV-ENT-ID-OUT     TO IN400-VND-ENT-ID-OUT.        33117701
RONNA5     MOVE BV001-PV-RLTNSHP-ID-OUT TO IN400-VND-ML-LO-MDSE-LVL-ID. 33117801
RONNA5     MOVE BV001-PV-BRAND-OUT      TO IN400-VND-LBL-SEQ-NBR.       33117901
RONNA5                                                                  33118001
28545 ******************************************************************33118101
28545 ******************************************************************33118201
28545 * IN400-INV-PRICE-OUTPUT.                                         33118301
28545 ******************************************************************33118401
28545  IN400-INV-PRICE-OUTPUT.                                          33118501
28545                                                                   33118601
28545      MOVE INT00003-SKU-NBR        TO IN400-PRC-SKU-OUT.           33118701
RONNA      MOVE INT00003-SKU-NBR        TO IN400-PV-WORK-SKU.           33118801
Z28545                                                                  33118901
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33119001
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-PRC-UPC-OUT        33120001
Z28545     ELSE                                                         33130001
Z28545         MOVE INT00003-UPC-NBR        TO IN400-PRC-UPC-OUT        33140001
Z28545     END-IF.                                                      33150001
Z28545                                                                  33160001
28545      MOVE INT00003-INTR-UPC-ID    TO IN400-PRC-UPCID-OUT.         33170001
28545      MOVE INT00003-ITM-NBR        TO IN400-PRC-ITM-NBR-OUT.       33180001
28545                                                                   33190001
28545      MOVE INT00003-EFF-BEG-TMST (1:10)                            33200001
28545                                   TO IN400-PRC-EFF-BEG-DTE-OUT.   33210001
28545                                                                   33220001
28545      IF IN400-PV-NULL-EFF-END-TMST IS LESS THAN ZEROS             33230001
28545          MOVE SPACES              TO IN400-PRC-EFF-END-DTE-OUT    33240001
28545      ELSE                                                         33250001
28545          MOVE INT00003-EFF-END-TMST (1:10)                        33260001
28545                                   TO IN400-PRC-EFF-END-DTE-OUT    33270001
28545      END-IF.                                                      33280001
28545                                                                   33290001
28545      IF IN400-PV-NULL-UPC-STAT-CDE IS LESS THAN ZEROS             33300001
28545          MOVE SPACES                TO IN400-PRC-STATUS-OUT       33310001
28545      ELSE                                                         33320001
28545          MOVE INT00003-UPC-STAT-CDE TO IN400-PRC-STATUS-OUT       33330001
28545      END-IF.                                                      33340001
28545                                                                   33350001
28545      MOVE INT00003-UNT-RTL-CHG-DTE  TO IN400-PRC-UPC-CHG-DTE-OUT. 33360001
28545      MOVE INT00003-UPC-STAT-CHG-DTE TO IN400-PRC-STAT-CHG-DTE-OUT.33370001
28545                                                                   33380001
28545      IF IN400-PV-NULL-ORIG-CLR-DTE IS LESS THAN ZEROS             33390001
28545          MOVE SPACES                TO IN400-PRC-ORIG-CLR-DTE     33400001
28545      ELSE                                                         33410001
28545          MOVE INT00003-ORIG-CLR-DTE TO IN400-PRC-ORIG-CLR-DTE     33420001
28545      END-IF.                                                      33430001
28545                                                                   33440001
28545      IF IN400-PV-NULL-MKDN-CDE IS LESS THAN ZEROS                 33450001
28545          MOVE SPACES              TO IN400-PRC-MKDN-CDE           33460001
28545      ELSE                                                         33470001
28545          MOVE INT00003-MKDN-CDE   TO IN400-PRC-MKDN-CDE           33480001
28545      END-IF.                                                      33490001
28545                                                                   33500001
28545      IF IN400-PV-NULL-MEITGP-NBR IS LESS THAN ZEROS               33510001
28545          MOVE ZEROS               TO IN400-PRC-MEITGP-NBR         33520001
28545      ELSE                                                         33530001
28545          MOVE INT00003-MEITGP-NBR TO IN400-PRC-MEITGP-NBR         33540001
28545      END-IF.                                                      33550001
28545                                                                   33560001
28545      MOVE IN400-PV-MITGPL-QTY     TO IN400-PRC-MITGPL-QTY.        33570001
28545      MOVE IN400-PV-MITGPL-GP-AMT  TO IN400-PRC-GP-AMT.            33580001
28545                                                                   33590001
28545      MOVE IN400-PV-WORK-RETAIL    TO IN400-PRC-UNIT-RTL-OUT.      33600001
28545      MOVE ZEROS                   TO IN400-PRC-EXTD-RTL-OUT.      33610001
28545                                                                   33620001
28545 ******************************************************************33630001
28545 * IN400-INV-ATTRIB-OUTPUT.                                        33640001
28545 ******************************************************************33650001
28545  IN400-INV-ATTRIB-OUTPUT.                                         33660001
28545                                                                   33670001
28545      MOVE INT00003-SKU-NBR        TO IN400-ATT-SKU-OUT.           33680001
Z28545                                                                  33690001
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33700001
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-ATT-UPC-OUT        33710001
Z28545     ELSE                                                         33720001
Z28545         MOVE INT00003-UPC-NBR        TO IN400-ATT-UPC-OUT        33730001
Z28545     END-IF.                                                      33740001
Z28545                                                                  33750001
28545      MOVE INT00003-INTR-UPC-ID    TO IN400-ATT-UPCID-OUT.         33760001
28545      MOVE INT00003-ITM-NBR        TO IN400-ATT-ITM-NBR-OUT.       33770001
28545                                                                   33780001
28545      MOVE INT00003-DEPT-NBR       TO IN400-ATT-DEPT-OUT.          33790001
28545      MOVE INT00003-MAJ-CL-NBR     TO IN400-ATT-MCL-OUT.           33800001
28545      MOVE INT00003-SUB-CL-NBR     TO IN400-ATT-SCL-OUT.           33810001
28545      MOVE INT00003-UPC-STAT-CDE   TO IN400-ATT-STATUS-OUT.        33820001
28545                                                                   33830001
28545      MOVE INT00003-SUB-CL-MDSEAR-ID TO IN400-ATT-MDEAR-ID-OUT.    33831001
28545      MOVE ZEROS                   TO IN400-ATT-STYL-ID-OUT.       33832001
28545                                                                   33833001
28545      IF IN400-PV-NULL-VS-ID IS LESS THAN ZEROS                    33834001
28545          MOVE ZEROS               TO IN400-ATT-VS-ID-OUT          33835001
28545      ELSE                                                         33836001
28545          MOVE INT00003-VS-ID      TO IN400-ATT-VS-ID-OUT          33837001
28545      END-IF.                                                      33838001
28545                                                                   33839001
28545      MOVE ZEROS                   TO IN400-ATT-VS-NBR-OUT.        33840001
28545                                                                   33850001
28545      MOVE INT00003-ENT-ID         TO IN400-ATT-ENT-ID-OUT.        33860001
28545      MOVE EXTENT-DUN-NBR          TO IN400-ATT-DUNS-NBR-OUT.      33870001
28545      MOVE VNDDPT-INHOUSE-NBR      TO IN400-ATT-INHSE-NBR-OUT.     33880001
D28545     MOVE INT00003-PLU-DWNLD-IND  TO IN400-ATT-PLU-DWNLD-IND.     33890001
28545                                                                   33900001
28545 ******************************************************************33910001
28545 * IN400-INV-VENDOR-OUTPUT.                                        33920001
28545 ******************************************************************33930001
28545  IN400-INV-VENDOR-OUTPUT.                                         33940001
28545                                                                   33950001
28545      MOVE INT00003-SKU-NBR        TO IN400-VND-SKU-OUT.           33960001
Z28545                                                                  33970001
Z28545     IF IN400-PV-UPC-NBR-IN-NUM NOT EQUAL ZEROS                   33980001
Z28545         MOVE IN400-PV-UPC-NBR-IN-NUM TO IN400-VND-UPC-OUT        33990001
Z28545     ELSE                                                         34000001
Z28545         MOVE INT00003-UPC-NBR        TO IN400-VND-UPC-OUT        34010001
Z28545     END-IF.                                                      34020001
Z28545                                                                  34030001
28545      MOVE INT00003-INTR-UPC-ID    TO IN400-VND-UPCID-OUT.         34040001
28545      MOVE INT00003-ITM-NBR        TO IN400-VND-ITM-NBR-OUT.       34050001
28545                                                                   34060001
BV         MOVE BV001-PV-DEPT-OUT       TO IN400-VND-DEPT-OUT.          34070001
BV         MOVE BV001-PV-ENT-ID-OUT     TO IN400-VND-ENT-ID-OUT.        34080001
BV         MOVE BV001-PV-RLTNSHP-ID-OUT TO IN400-VND-ML-LO-MDSE-LVL-ID. 34090001
BV         MOVE BV001-PV-BRAND-OUT      TO IN400-VND-LBL-SEQ-NBR.       34100001
BV                                                                      34110001
28545 ******************************************************************34123002
28545 ******************************************************************34130001
28545 ******************************************************************34140001
28545 * BRAND VENDOR RELATIONSHIP UTILITY FUNCTIONS.                    34141001
28545 ******************************************************************34142001
BV         COPY BVPD001.                                                34143001
BV                                                                      34144001
