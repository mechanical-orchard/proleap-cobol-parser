000100*------------------------*                                        00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*------------------------*                                        00030000
000400 PROGRAM-ID.     APKRP093.                                        00040000
000500 AUTHOR.         KEVIN CATLIN.                                    00050000
000600 DATE-WRITTEN.   NOVEMBER, 2002.                                  00060000
000700 DATE-COMPILED.                                                   00070000
000800*---------------------------------------------------------------* 00080000
000900*            MANUAL INVOICE TERMS DISCREPANCY REPORT            * 00090007
001000*---------------------------------------------------------------* 00100000
001100*                      COBOL 2 WITH SQL                         * 00110001
001200*---------------------------------------------------------------* 00120000
001300*                                                               * 00130000
001400*    THE PURPOSE OF THIS PROGRAM IS TO CREATE A REPORT THAT     * 00140000
001500*    WILL SHOW, FOR A GIVEN WEEK, MANUAL INVOICES ENTERED THAT  * 00150001
001600*    HAVE DISCREPANCIES BETWEEN THE INVOICE TERMS SELECTED AND  * 00160001
001700*    THE PO TERMS.  THE INVOICES SELECTED ARE NON-IMPORT        * 00170024
001800*    MERCHANDISE INVOICES, DO NOT INCLUDE LETTER OF CREDIT      * 00180024
001900*    INVOICES, AND INCLUDE ALL STATUSES EXCEPT FOR DELETED.     * 00190024
002000*                                                               * 00200000
002100*---------------------------------------------------------------* 00210000
002200*                                                               * 00220000
002300* DB2/PS TABLES:                              DCLGENS:          * 00230000
002400*  1. AP-INVOICE TABLE                        (TINVOIC)         * 00240000
002500*  2. AP-MERCHANDISE INVOICE TABLE            (TMDINVC)         * 00250000
002600*  3. PO-PURCHASE AGREEMENT TABLE             (TPOAGMT)         * 00260006
002700*  4. EX-PAYMENT TERM TYPE TABLE              (TPAYTRM)         * 00270006
002800*  5. PO-PURCHASE TABLE                       (TPURCHS)         * 00280015
002900*  6. AP-INVOICE PAYMENT TERMS TABLE          (TINVCTM)         * 00290015
003000*  7. EXTERNAL ENTERPRISE TABLE               (TEXTENT)         * 00300015
003100*  8. EXTERNAL ENTERPRISE NAME TABLE          (TENTNME)         * 00310015
003200*  9. AP-PAYMENT CONTROL TABLE                (TAPCNTL)         * 00320015
003300*                                                               * 00330000
003400* OUTPUT:                                                       * 00340000
003500*                                                               * 00350000
003600*  1. MANUAL INVOICE TERMS DISCREPANCY RPT.   APKRP093-1        * 00360024
003700*                                                               * 00370000
003800*---------------------------------------------------------------* 00380000
003900* CHANGE LOG:                                                   * 00390000
004000*   DATE  MM/DD/YY                                              * 00400000
004100*       CHANGE MADE: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  * 00410006
004200*       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  * 00420006
004300*       MADE BY: XXXXX XXXXXX            WR/IR #: WR99999       * 00430000
004400*                                                               * 00440000
004500*   DATE  01/02/2003                                            * 00450028
004600*       CHANGE MADE: INITIAL VERSION.                           * 00460000
004700*       MADE BY: KEVIN CATLIN            WR/IR #: WR24338       * 00470000
004800*                                                               * 00471029
004900*   DATE  10/29/2014                                            * 00472029
005000*       CHANGE MADE: PO EXTENDED DIGIT CHANGES.                 * 00473029
005100*       EXTENDED PO# FROM 7 TO 9.                               * 00473129
005101*       MADE BY: COGNIZANT               WR/IR #: CHG0094517    * 00474029
005102*---------------------------------------------------------------* 00480000
005103                                                                  00490000
005104*---------------------*                                           00500000
005105 ENVIRONMENT DIVISION.                                            00510000
005200*---------------------*                                           00520000
005300 CONFIGURATION SECTION.                                           00530000
005400 SOURCE-COMPUTER.    IBM-3090.                                    00540000
005500 OBJECT-COMPUTER.    IBM-3090.                                    00550000
005600                                                                  00560000
005700 INPUT-OUTPUT SECTION.                                            00570000
005800 FILE-CONTROL.                                                    00580000
005900                                                                  00590000
006000     SELECT REPORT-FILE            ASSIGN TO RPT01.               00600000
006100                                                                  00610000
006200*--------------*                                                  00620000
006300 DATA DIVISION.                                                   00630000
006400*--------------*                                                  00640000
006500 FILE SECTION.                                                    00650000
006600                                                                  00660000
006700 FD  REPORT-FILE                                                  00670000
006800     RECORDING MODE IS F                                          00680000
006900     LABEL RECORDS ARE STANDARD                                   00690000
007000     BLOCK CONTAINS 0 RECORDS                                     00700000
007100     DATA RECORD IS REPORT-REC.                                   00710000
007200 01  REPORT-REC                  PIC  X(132).                     00720006
007300                                                                  00730000
007400 EJECT                                                            00740000
007500                                                                  00750000
007600 WORKING-STORAGE SECTION.                                         00760000
007700                                                                  00770000
007800 01  PROGRAM-CONSTANTS.                                           00780000
007900     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP093'. 00790000
008000                                                                  00800000
008100 01  PV-PROCESS-COUNTERS.                                         00810000
008200     05  PV-INV-CSR-COUNT        PIC  9(08)     VALUE ZEROS.      00820000
008300     05  PV-INV-WRT-COUNT        PIC  9(08)     VALUE ZEROS.      00830000
008400                                                                  00840000
008500 01  PV-REPORT-CONTROLS.                                          00850000
008600     05  PV-POINVC-UNIT          PIC S99        VALUE +3.         00860016
008700     05  PV-LINE-COUNT           PIC S999       VALUE +0.         00870000
008800     05  PC-LINES-PER-PAGE-MAX   PIC S999       VALUE +60.        00880001
008900     05  PV-PAGE-COUNT           PIC S9(05)     VALUE +0.         00890016
009000                                                                  00900000
009100 01  PROGRAM-SWITCHES.                                            00910000
009200     05  PS-END-OF-CSR-SW        PIC  X         VALUE 'N'.        00920025
009300         88  NOT-END-OF-CSR                     VALUE 'N'.        00930000
009400         88  END-OF-CSR                         VALUE 'Y'.        00940000
009500     05  PS-CURSOR--SW           PIC  X         VALUE 'N'.        00950025
009600         88  CURSOR-CLOSED                      VALUE 'N'.        00960000
009700         88  CURSOR-OPEN                        VALUE 'Y'.        00970000
009800     05  PS-TERMS-SW             PIC  X         VALUE 'N'.        00980025
009900         88  TERMS-MATCH                        VALUE 'N'.        00990025
010000         88  TERMS-DISCREPANCY                  VALUE 'Y'.        01000025
010100                                                                  01010000
010200 01  HOLD-FIELDS.                                                 01020000
010300     05  HOLD-VENDOR-NAME        PIC X(30)      VALUE SPACES.     01030009
010400                                                                  01040000
010500 01  PROGRAM-VARIABLES.                                           01050000
010600     05  PV-WEEK-END-DATE        PIC X(10)      VALUE SPACES.     01060006
010700     05  PV-WEEK-BEGIN-DATE      PIC X(10)      VALUE SPACES.     01070006
010800     05  PV-PO-DISC-PCT          PIC ZZ9.99     VALUE ZEROES.     01080009
010900     05  PV-INVC-DISC-PCT        PIC ZZ9.99     VALUE ZEROES.     01090009
011000     05  PV-DISC-EXTENDED-DAYS   PIC S9(4) COMP VALUE ZEROES.     01100011
011100     05  PV-CURRENT-DATE.                                         01110012
011200         10  PV-CURRENT-CCYY.                                     01120012
011300             15  PV-CURRENT-CC     PIC  9(02)   VALUE ZEROES.     01130012
011400             15  PV-CURRENT-YEAR   PIC  9(02)   VALUE ZEROES.     01140012
011500         10  PV-CURRENT-MONTH      PIC  9(02)   VALUE ZEROES.     01150012
011600         10  PV-CURRENT-DAY        PIC  9(02)   VALUE ZEROES.     01160012
011700     05  PV-CURRENT-TIME.                                         01170012
011800         10  PV-CURRENT-HOUR       PIC  9(02)   VALUE ZEROES.     01180012
011900         10  PV-CURRENT-MINUTE     PIC  9(02)   VALUE ZEROES.     01190012
012000         10  FILLER                PIC  9(02)   VALUE ZEROES.     01200012
012100                                                                  01210000
012200 EJECT                                                            01220000
012300                                                                  01230000
012400*----------------------------------------------------------------*01240000
012500*    STANDARD HEADER LAYOUT                                       01250000
012600*----------------------------------------------------------------*01260000
012700     COPY DPWS132.                                                01270000
012800                                                                  01280000
012900*----------------------------------------------------------------*01290000
013000*    REPORT LAYOUT                                                01300000
013100*----------------------------------------------------------------*01310000
013200                                                                  01320000
013300 01  H2-HEADER2.                                                  01330000
013400     05  FILLER                  PIC  X(47)     VALUE SPACES.     01340020
013500     05  H2-TITLE                PIC  X(39)     VALUE             01350000
013600         'MANUAL INVOICE TERMS DISCREPANCY REPORT'.               01360006
013700     05  FILLER                  PIC  X(46)     VALUE SPACES.     01370020
013800                                                                  01380000
013900 01  H3-HEADER3.                                                  01390000
014000     05  FILLER                  PIC  X(62)     VALUE SPACES.     01400022
014100     05  FILLER                  PIC  X(08)     VALUE             01410003
014200         'DISC PCT'.                                              01420003
014300     05  FILLER                  PIC  X(05)     VALUE SPACES.     01430003
014400     05  FILLER                  PIC  X(13)     VALUE             01440003
014500         'DISC DAYS QTY'.                                         01450003
014600     05  FILLER                  PIC  X(05)     VALUE SPACES.     01460003
014700     05  FILLER                  PIC  X(11)     VALUE             01470003
014800         'NET DAY QTY'.                                           01480003
014900     05  FILLER                  PIC  X(05)     VALUE SPACES.     01490003
015000     05  FILLER                  PIC  X(16)     VALUE             01500003
015100         'EXTENDED DAY QTY'.                                      01510003
015200     05  FILLER                  PIC  X(07)     VALUE SPACES.     01520022
015300                                                                  01530000
015400 01  BL-BLANK-LINE               PIC  X(132)    VALUE SPACES.     01540006
015500                                                                  01550000
015600 01  D1-VENDOR-DETAIL.                                            01560003
015700     05  FILLER                  PIC  X(13)     VALUE             01570003
015800         'VENDOR NAME: '.                                         01580003
015900     05  D1-VENDOR-NAME          PIC  X(30)     VALUE SPACES.     01590003
016000     05  FILLER                  PIC  X(89)     VALUE SPACES.     01600003
016100                                                                  01610000
016200 01  D2-PO-DETAIL.                                                01620003
016300     05  FILLER                  PIC X(04)      VALUE SPACES.     01630003
016400     05  FILLER                  PIC X(11)      VALUE             01640003
016500         'PO NUMBER: '.                                           01650003
016600     05  D2-PO-NBR               PIC 9(09)      VALUE ZEROS.      01660029
016700     05  FILLER                  PIC X(19)      VALUE SPACES.     01670029
016800     05  FILLER                  PIC X(10)      VALUE             01680016
016900         'PO TERMS: '.                                            01690016
017000     05  FILLER                  PIC X(10)      VALUE SPACES.     01700022
017100     05  D2-PO-DISC-PCT          PIC ZZ9.99.                      01710021
017200     05  FILLER                  PIC X(10)      VALUE SPACES.     01720003
017300     05  D2-PO-DISC-DAYS-QTY     PIC ZZ9.                         01730003
017400     05  FILLER                  PIC X(15)      VALUE SPACES.     01740003
017500     05  D2-PO-DUE-DAY-QTY       PIC ZZ9.                         01750003
017600     05  FILLER                  PIC X(15)      VALUE SPACES.     01760003
017700     05  D2-PO-EXTD-DAY-QTY      PIC ZZ9.                         01770009
017800     05  FILLER                  PIC X(14)      VALUE SPACES.     01780022
017900                                                                  01790003
018000 01  D3-INVOICE-DETAIL.                                           01800003
018100     05  FILLER                  PIC X(04)      VALUE SPACES.     01810003
018200     05  FILLER                  PIC X(12)      VALUE             01820004
018300         'INVOICE ID: '.                                          01830004
018400     05  D3-INVC-ID              PIC X(22)      VALUE ZEROS.      01840009
018500     05  FILLER                  PIC X(04)      VALUE SPACES.     01850022
018600     05  FILLER                  PIC X(13)      VALUE             01860016
018700         '*INVC TERMS: '.                                         01870016
018800     05  FILLER                  PIC X(08)      VALUE SPACES.     01880022
018900     05  D3-INVC-DISC-PCT        PIC ZZ9.99.                      01890009
019000     05  FILLER                  PIC X(10)      VALUE SPACES.     01900003
019100     05  D3-INVC-DISC-DAYS-QTY   PIC ZZ9.                         01910009
019200     05  FILLER                  PIC X(15)      VALUE SPACES.     01920003
019300     05  D3-INVC-DUE-DAY-QTY     PIC ZZ9.                         01930009
019400     05  FILLER                  PIC X(15)      VALUE SPACES.     01940003
019500     05  D3-INVC-EXTD-DAY-QTY    PIC ZZ9.                         01950009
019600     05  FILLER                  PIC X(14)      VALUE SPACES.     01960022
019700                                                                  01970003
019800 01  NO-INVOICE-LINE.                                             01980006
019900     05  FILLER                  PIC  X(48)     VALUE SPACES.     01990006
020000     05  FILLER                  PIC  X(36)     VALUE             02000006
020100         '*** NO INVOICE DATA TO REPORT ON ***'.                  02010006
020200     05  FILLER                  PIC  X(48)     VALUE SPACES.     02020006
020300                                                                  02030000
020400 01  END-OF-REPORT.                                               02040000
020500     05  FILLER                  PIC  X(50)     VALUE SPACES.     02050020
020600     05  FILLER                  PIC  X(33)     VALUE             02060004
020700         '***  E N D  O F  R E P O R T  ***'.                     02070004
020800     05  FILLER                  PIC  X(49)     VALUE SPACES.     02080020
020900                                                                  02090000
021000*----------------------------------------------------------------*02100000
021100*    SQL COMMUNICATIONS AREA DCLGEN                               02110000
021200*----------------------------------------------------------------*02120000
021300     EXEC SQL                                                     02130000
021400         INCLUDE SQLCA                                            02140000
021500     END-EXEC.                                                    02150000
021600                                                                  02160000
021700*----------------------------------------------------------------*02170000
021800*    AP-INVOICE TABLE                                             02180000
021900*----------------------------------------------------------------*02190000
022000     EXEC SQL                                                     02200000
022100         INCLUDE TINVOIC                                          02210000
022200     END-EXEC.                                                    02220000
022300                                                                  02230000
022400*----------------------------------------------------------------*02240000
022500*    AP-MERCHANDISE INVOICE TABLE                                 02250000
022600*----------------------------------------------------------------*02260000
022700     EXEC SQL                                                     02270000
022800         INCLUDE TMDINVC                                          02280000
022900     END-EXEC.                                                    02290000
023000                                                                  02300000
023100*----------------------------------------------------------------*02310000
023200*    PO-PURCHASE AGREEMENT TABLE                                  02320000
023300*----------------------------------------------------------------*02330000
023400     EXEC SQL                                                     02340000
023500         INCLUDE TPOAGMT                                          02350000
023600     END-EXEC.                                                    02360000
023700                                                                  02370000
023800*----------------------------------------------------------------*02380000
023900*    EX-PAYMENT TERM TYPE TABLE                                   02390000
024000*----------------------------------------------------------------*02400000
024100     EXEC SQL                                                     02410000
024200         INCLUDE TPAYTRM                                          02420000
024300     END-EXEC.                                                    02430000
024400                                                                  02440000
024500*----------------------------------------------------------------*02450015
024600*    PO-PURCHASE TABLE                                            02460015
024700*----------------------------------------------------------------*02470015
024800     EXEC SQL                                                     02480015
024900         INCLUDE TPURCHS                                          02490015
025000     END-EXEC.                                                    02500015
025100                                                                  02510015
025200*----------------------------------------------------------------*02520000
025300*    AP-INVOICE PAYMENT TERMS TABLE                               02530000
025400*----------------------------------------------------------------*02540000
025500     EXEC SQL                                                     02550000
025600         INCLUDE TINVCTM                                          02560000
025700     END-EXEC.                                                    02570000
025800                                                                  02580000
025900*----------------------------------------------------------------*02590000
026000*    EXTERNAL ENTERPRISE TABLE                                    02600000
026100*----------------------------------------------------------------*02610000
026200     EXEC SQL                                                     02620000
026300         INCLUDE TEXTENT                                          02630000
026400     END-EXEC.                                                    02640000
026500                                                                  02650000
026600*----------------------------------------------------------------*02660000
026700*    EXTERNAL ENTERPRISE NAME TABLE                               02670000
026800*----------------------------------------------------------------*02680000
026900     EXEC SQL                                                     02690000
027000         INCLUDE TENTNME                                          02700000
027100     END-EXEC.                                                    02710000
027200                                                                  02720000
027300*----------------------------------------------------------------*02730006
027400*    AP-PAYMENT CONTROL TABLE                                     02740006
027500*----------------------------------------------------------------*02750006
027600     EXEC SQL                                                     02760006
027700         INCLUDE TAPCNTL                                          02770006
027800     END-EXEC.                                                    02780006
027900                                                                  02790006
028000*----------------------------------------------------------------*02800000
028100*    INVOICE CURSOR                                               02810000
028200*----------------------------------------------------------------*02820000
028300     EXEC SQL                                                     02830000
028400        DECLARE INVOICE_CSR CURSOR FOR                            02840000
028500          SELECT IV.PO_NBR                                        02850009
028600                ,IV.INVC_ID                                       02860009
028700                ,IT.DISC_PCT                                      02870009
028800                ,IT.DISC_DUE_DAY_QTY                              02880009
028900                ,IT.NET_DUE_DAY_QTY                               02890009
029000                ,IT.EXTD_DAYS_QTY                                 02900025
029100                ,PT.DISCOUNT_PCT                                  02910025
029200                ,PT.DISCOUNT_DAYS_QTY                             02920025
029300                ,PT.DUE_DAY_QTY                                   02930009
029400                ,PA.DISC_PAY_DAY_QTY                              02940025
029500                ,EN.ENT_NAME_DESC                                 02950009
029600           FROM  TINVOIC  IV                                      02960009
029700                ,TMDINVC  MI                                      02970009
029800                ,TINVCTM  IT                                      02980009
029900                ,TPOAGMT  PA                                      02990009
030000                ,TPAYTRM  PT                                      03000009
030100                ,TPURCHS  PU                                      03010009
030200                ,TEXTENT  EX                                      03020009
030300                ,TENTNME  EN                                      03030009
030400          WHERE  IV.PO_NBR            = MI.PO_NBR                 03040009
030500            AND  IV.INVC_ID           = MI.INVC_ID                03050009
030600            AND  IV.PO_NBR            = IT.PO_NBR                 03060009
030700            AND  IV.INVC_ID           = IT.INVC_ID                03070009
030800            AND  IV.PO_NBR            = PA.PO_NBR                 03080009
030900            AND  PA.PAYT_TERM_ID      = PT.PAY_TERM_ID            03090009
031000            AND  IV.PO_NBR            = PU.PO_NBR                 03100009
031100            AND  IV.RMIT_VND_ID       = EX.DUN_NBR                03110009
031200            AND  EX.ENT_ID            = EN.ENT_ID                 03120009
031300            AND  IV.ENTR_MTHD_CDE     = 'MN'                      03130009
031400            AND  IV.INVC_TYP_CDE      = 'MI'                      03140009
031500            AND  IV.STATUS_CDE       <> 'DE'                      03150009
031600            AND  IV.CRE_DTE     BETWEEN :PV-WEEK-BEGIN-DATE       03160009
031700                                    AND :PV-WEEK-END-DATE         03170009
031800            AND  MI.TERM_SEL_CDE      = 'I'                       03180009
031900            AND  IT.TERM_SEQ_NBR      = 1                         03190009
032000            AND  PA.VER_STATUS_CDE    = 'A'                       03200009
032100            AND  PA.AGRMT_TYP_ID      = '2'                       03210009
032200            AND  PA.PAYT_TERM_ID     <> 76                        03220009
032300            AND  PU.VER_STATUS_CDE    = 'A'                       03230009
032400            AND  PU.PO_TYP_CDE NOT IN ('IE','IF','IM')            03240009
032500            AND  EN.TYPE_CDE          = '01'                      03250017
032600       ORDER BY  EN.ENT_NAME_DESC                                 03260009
032700                ,IV.PO_NBR                                        03270009
032800                ,IV.INVC_ID                                       03280009
032900     END-EXEC.                                                    03290000
033000                                                                  03300000
033100*----------------------------------------------------------------*03310000
033200*    ABEND DATA AREAS                                             03320000
033300*----------------------------------------------------------------*03330000
033400 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      03340000
033500                                   COMP         SYNC.             03350000
033600                                                                  03360000
033700     88  AC-ANY-ERROR                           VALUE  +4001      03370000
033800                                                THRU   +4019.     03380000
033900     88  AC-OPEN-ERROR                          VALUE  +4005.     03390000
034000     88  AC-CLOSE-ERROR                         VALUE  +4006.     03400000
034100     88  AC-INVALID-DATA                        VALUE  +4008.     03410000
034200     88  AC-DB2-ERROR                           VALUE  +4013.     03420000
034300     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     03430000
034400     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     03440000
034500                                                                  03450000
034600 01  ABEND-AREAS.                                                 03460000
034700     05  AA-ABEND-LIT              PIC  X(40)   VALUE             03470000
034800             '*****       ABEND'.                                 03480000
034900     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             03490000
035000             '*****   PROGRAM: APKRP093'.                         03500000
035100     05  AA-PARAGRAPH-LIT.                                        03510000
035200         10  FILLER                PIC  X(17)   VALUE             03520000
035300             '***** PARAGRAPH: '.                                 03530000
035400         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     03540000
035500     05  AA-MESSAGE-LINE-1.                                       03550000
035600         10  FILLER                PIC  X(06)   VALUE '*****'.    03560000
035700         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     03570000
035800     05  AA-MESSAGE-LINE-2.                                       03580000
035900         10  FILLER                PIC  X(06)   VALUE '*****'.    03590000
036000         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     03600000
036100     05  AA-DB2-ERROR-LIT          PIC  X(40)   VALUE             03610000
036200             '*****    DB2 ERROR'.                                03620000
036300     05  AA-DB2-OPERATION-LIT.                                    03630000
036400         10  FILLER                PIC  X(17)   VALUE             03640000
036500             '***** OPERATION: '.                                 03650000
036600         10  AA-DB2-OPERATION.                                    03660000
036700             15  AA-DB2-OP-1       PIC  X(25)   VALUE SPACES.     03670000
036800             15  AA-DB2-OP-2       PIC  X(25)   VALUE SPACES.     03680000
036900     05  AA-DB2-TABLE-1            PIC  X(08)   VALUE SPACES.     03690000
037000     05  AA-DB2-TABLE-2            PIC  X(08)   VALUE SPACES.     03700000
037100     05  AA-DB2-TABLE-3            PIC  X(08)   VALUE SPACES.     03710000
037200     05  AA-DB2-TABLE-4            PIC  X(08)   VALUE SPACES.     03720000
037300     05  AA-DB2-TABLE-5            PIC  X(08)   VALUE SPACES.     03730000
037400                                                                  03740000
037500*----------------------------------------------------------------*03750000
037600*    SQLCA FORMATTED MESSAGE AREA                                 03760000
037700*----------------------------------------------------------------*03770000
037800     COPY DPWS004.                                                03780000
037900                                                                  03790000
038000 01  FILLER                      PIC  X(25)     VALUE             03800000
038100     '** END OF APKRP093 W/S **'.                                 03810000
038200                                                                  03820000
038300*-------------------*                                             03830000
038400 PROCEDURE DIVISION.                                              03840000
038500*-------------------*                                             03850000
038600 A100-MAINLINE.                                                   03860000
038700                                                                  03870000
038800     PERFORM B100-INITIALIZE.                                     03880000
038900                                                                  03890000
039000     PERFORM B200-PROCESS-INVC-CSR                                03900009
039100         UNTIL END-OF-CSR.                                        03910009
039200                                                                  03920000
039300     PERFORM B300-END-OF-PROGRAM.                                 03930000
039400                                                                  03940000
039500     GOBACK.                                                      03950000
039600                                                                  03960000
039700                                                                  03970000
039800*----------------------------------------------------------------*03980000
039900*    INITIALIZATION PROCESSING                                   *03990000
040000*                                                                *04000000
040100*    - OPEN FILE.                                                *04010000
040200*    - INTIALIZE LAYOUTS.                                        *04020000
040300*    - FORMAT PAGE HEADINGS.                                     *04030000
040400*    - OPEN DB2 CURSOR AND FETCH FIRST RECORD.                   *04040000
040500*    - PROCESS HEADER RECORD DATA.                               *04050000
040600*----------------------------------------------------------------*04060000
040700 B100-INITIALIZE.                                                 04070000
040800                                                                  04080000
040900     DISPLAY '**------  APKRP093  (PROCESSING MSGS)  ------**'.   04090000
041000                                                                  04100000
041100     OPEN OUTPUT REPORT-FILE.                                     04110009
041200                                                                  04120000
041300     INITIALIZE  DCLTINVOIC                                       04130006
041400                 DCLTMDINVC                                       04140006
041500                 DCLTPOAGMT                                       04150006
041600                 DCLTPAYTRM                                       04160006
041700                 DCLTPURCHS                                       04170015
041800                 DCLTINVCTM                                       04180006
041900                 DCLTEXTENT                                       04190006
042000                 DCLTENTNME                                       04200006
042100                 DCLTAPCNTL.                                      04210006
042200                                                                  04220000
042300*    FORMAT HEADING DATA                                          04230000
042400     MOVE FUNCTION CURRENT-DATE       TO PV-CURRENT-DATE.         04240000
042500     MOVE PV-CURRENT-MONTH            TO DP132-RUN-MONTH.         04250000
042600     MOVE PV-CURRENT-DAY              TO DP132-RUN-DAY.           04260000
042700     MOVE PV-CURRENT-YEAR             TO DP132-RUN-YEAR.          04270000
042800                                                                  04280000
042900     ACCEPT PV-CURRENT-TIME           FROM TIME.                  04290000
043000     MOVE PV-CURRENT-HOUR             TO DP132-RUN-HOUR.          04300000
043100     MOVE PV-CURRENT-MINUTE           TO DP132-RUN-MINUTE.        04310000
043200     MOVE PC-PROGRAM-NAME             TO DP132-PROGRAM-NAME.      04320000
043300     MOVE 1                           TO DP132-REPORT-NUMBER.     04330000
043400                                                                  04340000
043500     PERFORM W100-WRITE-HEADINGS.                                 04350000
043600                                                                  04360000
043700     PERFORM S100-GET-WEEKLY-DATES.                               04370006
043800     DISPLAY '*** WEEK BEGIN DATE: ' PV-WEEK-BEGIN-DATE.          04380017
043900     DISPLAY '*** WEEK END DATE: ' PV-WEEK-END-DATE.              04390017
044000                                                                  04400006
044100*    PERFORM OPEN AND INITIAL FETCH OF THE INVOICE CURSOR         04410009
044200     PERFORM X100-OPEN-INVOICE-CSR.                               04420006
044300                                                                  04430006
044400     PERFORM S200-FETCH-INVOICE-CSR.                              04440006
044500                                                                  04450006
044600     IF END-OF-CSR                                                04460006
044700        DISPLAY 'NO RECORDS FOUND WITH CURSOR!!!'                 04470018
044800     END-IF.                                                      04480006
044900                                                                  04490000
045000                                                                  04500000
045100*----------------------------------------------------------------*04510000
045200*    PROCESS INVOICE CURSOR                                      *04520000
045300*                                                                *04530000
045400*    - PROCESS MULTIPLE SELECT STATEMENTS                        *04540000
045500*    - PERFORM CALCULATIONS FOR REPORT                           *04550000
045600*    - PRINT REPORT RECORD                                       *04560000
045700*    - FETCH NEXT RECORD                                         *04570000
045800*----------------------------------------------------------------*04580000
045900 B200-PROCESS-INVC-CSR.                                           04590009
046000                                                                  04600000
046100     PERFORM S300-GET-EXTEND-DAYS.                                04610025
046200                                                                  04620025
046300     PERFORM C100-COMPARE-TERMS.                                  04630025
046400                                                                  04640025
046500     IF TERMS-DISCREPANCY                                         04650025
046600        IF ENTNME-ENT-NAME-DESC NOT EQUAL HOLD-VENDOR-NAME        04660025
046700           PERFORM W200-WRITE-VENDOR-DETAIL                       04670025
046800        END-IF                                                    04680025
046900        PERFORM D100-CONVERT-PCT                                  04690025
047000        PERFORM F100-FORMAT-DETAIL                                04700025
047100        PERFORM W300-WRITE-DETAIL                                 04710025
047200     END-IF                                                       04720025
047300                                                                  04730016
047400     PERFORM S200-FETCH-INVOICE-CSR.                              04740009
047500                                                                  04750000
047600                                                                  04760009
047700*----------------------------------------------------------------*04770000
047800*    END OF PROGRAM                                              *04780000
047900*    - PROCESS THE END OF REPORT LINE                            *04790018
048000*    - CLOSE THE CURSOR AND FILE                                 *04800010
048100*    - DISPLAY PROGRAM COUNTS.                                   *04810010
048200*----------------------------------------------------------------*04820000
048300 B300-END-OF-PROGRAM.                                             04830000
048400                                                                  04840000
048500     IF PV-INV-WRT-COUNT > 0                                      04850026
048600        PERFORM W400-WRITE-EOR                                    04860026
048700     ELSE                                                         04870026
048800        WRITE REPORT-REC FROM NO-INVOICE-LINE                     04880026
048900          AFTER ADVANCING +3 LINES                                04890026
049000        PERFORM W400-WRITE-EOR                                    04900026
049100     END-IF                                                       04910026
049200                                                                  04920000
049300     IF CURSOR-OPEN                                               04930009
049400        PERFORM X200-CLOSE-INVOICE-CSR                            04940009
049500     END-IF                                                       04950009
049600                                                                  04960009
049700     CLOSE REPORT-FILE.                                           04970009
049800                                                                  04980009
049900     DISPLAY '*************************************************'. 04990000
050000     DISPLAY '** TOTAL RECORDS READ = ' PV-INV-CSR-COUNT.         05000016
050100     DISPLAY '** TOTAL INVOICES WRT = ' PV-INV-WRT-COUNT.         05010016
050200     DISPLAY '*************************************************'. 05020016
050300     DISPLAY '**         END OF APKRP093 PROCESSING          **'. 05030000
050400     DISPLAY '*************************************************'. 05040000
050500                                                                  05050000
050600                                                                  05060000
050700*----------------------------------------------------------------*05070000
050800*    COMPARE INVOICE TERMS VERSUS PO TERMS                       *05080025
050900*----------------------------------------------------------------*05090000
051000 C100-COMPARE-TERMS.                                              05100025
051100                                                                  05110000
051200     IF (INVCTM-DISC-PCT NOT EQUAL PAYTRM-DISCOUNT-PCT) OR        05120027
051300        (INVCTM-DISC-DUE-DAY-QTY NOT EQUAL                        05130025
051400                                   PAYTRM-DISCOUNT-DAYS-QTY) OR   05140025
051500        (INVCTM-NET-DUE-DAY-QTY NOT EQUAL PAYTRM-DUE-DAY-QTY) OR  05150025
051600        (INVCTM-EXTD-DAYS-QTY NOT EQUAL POAGMT-DISC-PAY-DAY-QTY)  05160025
051700          SET TERMS-DISCREPANCY TO TRUE                           05170025
051800     ELSE                                                         05180025
051900          SET TERMS-MATCH TO TRUE                                 05190025
052000     END-IF.                                                      05200025
052100                                                                  05210000
052200                                                                  05220000
052300*----------------------------------------------------------------*05230025
052400*    CONVERT DECIMAL PERCENT TO WHOLE NUMBER PERCENT FOR REPORT  *05240025
052500*----------------------------------------------------------------*05250025
052600 D100-CONVERT-PCT.                                                05260025
052700                                                                  05270025
052800     COMPUTE PV-PO-DISC-PCT = PAYTRM-DISCOUNT-PCT * 100.          05280025
052900     COMPUTE PV-INVC-DISC-PCT = INVCTM-DISC-PCT * 100.            05290025
053000                                                                  05300025
053100                                                                  05310025
053200*----------------------------------------------------------------*05320000
053300*    FORMATS THE DETAIL LINES OF THE REPORT.                     *05330010
053400*----------------------------------------------------------------*05340000
053500 F100-FORMAT-DETAIL.                                              05350000
053600                                                                  05360010
053700     MOVE INVOIC-PO-NBR             TO D2-PO-NBR.                 05370009
053800     MOVE PV-PO-DISC-PCT            TO D2-PO-DISC-PCT.            05380010
053900     MOVE PAYTRM-DISCOUNT-DAYS-QTY  TO D2-PO-DISC-DAYS-QTY.       05390009
054000     MOVE PAYTRM-DUE-DAY-QTY        TO D2-PO-DUE-DAY-QTY.         05400009
054100     MOVE POAGMT-DISC-PAY-DAY-QTY   TO D2-PO-EXTD-DAY-QTY.        05410009
054200                                                                  05420009
054300     MOVE INVOIC-INVC-ID            TO D3-INVC-ID.                05430009
054400     MOVE PV-INVC-DISC-PCT          TO D3-INVC-DISC-PCT.          05440010
054500     MOVE INVCTM-DISC-DUE-DAY-QTY   TO D3-INVC-DISC-DAYS-QTY.     05450009
054600     MOVE INVCTM-NET-DUE-DAY-QTY    TO D3-INVC-DUE-DAY-QTY.       05460009
054700     MOVE INVCTM-EXTD-DAYS-QTY      TO D3-INVC-EXTD-DAY-QTY.      05470009
054800                                                                  05480000
054900                                                                  05490000
055000*----------------------------------------------------------------*05500006
055100*    GET WEEKLY BEGIN AND END DATES.                             *05510006
055200*----------------------------------------------------------------*05520006
055300 S100-GET-WEEKLY-DATES.                                           05530006
055400                                                                  05540006
055500     EXEC SQL                                                     05550006
055600         SELECT  BTCH_PRC_DTE                                     05560006
055700                ,(BTCH_PRC_DTE - 7 DAYS)                          05570006
055800           INTO  :PV-WEEK-END-DATE                                05580006
055900                ,:PV-WEEK-BEGIN-DATE                              05590006
056000           FROM  TAPCNTL                                          05600006
056100     END-EXEC.                                                    05610006
056200                                                                  05620006
056300     EVALUATE TRUE                                                05630006
056400         WHEN SQLCODE = ZERO                                      05640006
056500            CONTINUE                                              05650006
056600                                                                  05660006
056700         WHEN SQLWARN0 NOT = SPACES                               05670006
056800         WHEN SQLCODE NOT  = ZERO                                 05680006
056900            MOVE 'S100-GET-WEEKLY-DATES'                          05690006
057000                                TO AA-PARAGRAPH-NAME              05700006
057100            MOVE 'UNSUCCESSFUL SELECT'                            05710006
057200                                TO AA-DB2-OPERATION               05720006
057300            MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                 05730006
057400            MOVE SPACES         TO AA-DB2-TABLE-2                 05740006
057500                                   AA-DB2-TABLE-3                 05750006
057600                                   AA-DB2-TABLE-4                 05760006
057700                                   AA-DB2-TABLE-5                 05770006
057800            PERFORM Z999-DB2-ABEND                                05780006
057900     END-EVALUATE.                                                05790006
058000                                                                  05800006
058100                                                                  05810006
058200*---------------------------------------------------------------- 05820000
058300*    FETCH THE INVOICE_CSR CURSOR.                                05830000
058400*---------------------------------------------------------------- 05840000
058500 S200-FETCH-INVOICE-CSR.                                          05850006
058600                                                                  05860000
058700     EXEC SQL                                                     05870000
058800         FETCH  INVOICE_CSR                                       05880009
058900          INTO  :INVOIC-PO-NBR                                    05890009
059000               ,:INVOIC-INVC-ID                                   05900009
059100               ,:INVCTM-DISC-PCT                                  05910009
059200               ,:INVCTM-DISC-DUE-DAY-QTY                          05920009
059300               ,:INVCTM-NET-DUE-DAY-QTY                           05930009
059400               ,:INVCTM-EXTD-DAYS-QTY                             05940025
059500               ,:PAYTRM-DISCOUNT-PCT                              05950025
059600               ,:PAYTRM-DISCOUNT-DAYS-QTY                         05960009
059700               ,:PAYTRM-DUE-DAY-QTY                               05970025
059800               ,:POAGMT-DISC-PAY-DAY-QTY                          05980025
059900               ,:ENTNME-ENT-NAME-DESC                             05990009
060000     END-EXEC.                                                    06000000
060100                                                                  06010000
060200     EVALUATE TRUE                                                06020000
060300         WHEN SQLCODE = ZERO                                      06030000
060400             ADD 1 TO PV-INV-CSR-COUNT                            06040000
060500                                                                  06050000
060600         WHEN SQLCODE = +100                                      06060000
060700             SET END-OF-CSR TO TRUE                               06070000
060800                                                                  06080000
060900         WHEN SQLWARN0 NOT = SPACES                               06090000
061000         WHEN SQLCODE  NOT = ZERO                                 06100000
061100             MOVE 'S200-FETCH-INVOICE-CSR'                        06110006
061200                                 TO AA-PARAGRAPH-NAME             06120000
061300             MOVE 'UNSUCCESSFUL FETCH FROM INVOICE_CSR'           06130000
061400                                 TO AA-DB2-OPERATION              06140000
061500             MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                06150000
061600             MOVE 'TMDINVC'      TO AA-DB2-TABLE-2                06160000
061700             MOVE 'TINVCTM'      TO AA-DB2-TABLE-3                06170016
061800             MOVE 'TPOAGMT'      TO AA-DB2-TABLE-4                06180016
061900             MOVE 'TPAYTRM'      TO AA-DB2-TABLE-5                06190016
062000             PERFORM Z999-DB2-ABEND                               06200000
062100     END-EVALUATE.                                                06210000
062200                                                                  06220000
062300                                                                  06230000
062400*---------------------------------------------------------------- 06240000
062500*    GET ADDITIONAL EXTENDED DAYS FOR PO, IF THEY EXIST           06250010
062600*---------------------------------------------------------------- 06260000
062700 S300-GET-EXTEND-DAYS.                                            06270009
062800                                                                  06280000
062900     EXEC SQL                                                     06290000
063000         SELECT  DISC_PAY_DAY_QTY                                 06300013
063100           INTO  :PV-DISC-EXTENDED-DAYS                           06310000
063200           FROM  TPOAGMT                                          06320013
063300          WHERE  PO_NBR         = :INVOIC-PO-NBR                  06330013
063400            AND  VER_STATUS_CDE = 'A'                             06340013
063500            AND  AGRMT_TYP_ID   = '5'                             06350013
063600            AND  TYP_CDE        =  1                              06360013
063700     END-EXEC.                                                    06370000
063800                                                                  06380000
063900     EVALUATE TRUE                                                06390000
064000         WHEN SQLCODE = ZERO                                      06400000
064100            ADD PV-DISC-EXTENDED-DAYS TO POAGMT-DISC-PAY-DAY-QTY  06410000
064200                                                                  06420000
064300         WHEN SQLCODE = +100                                      06430000
064400            CONTINUE                                              06440000
064500                                                                  06450000
064600         WHEN SQLWARN0 NOT = SPACES                               06460000
064700         WHEN SQLCODE  NOT = ZERO                                 06470000
064800            DISPLAY 'PO NBR: ' INVOIC-PO-NBR                      06480000
064900            MOVE 'S300-GET-EXTEND-DAYS' TO AA-PARAGRAPH-NAME      06490009
065000            MOVE 'UNSUCCESSFUL SELECT'  TO AA-DB2-OPERATION       06500000
065100            MOVE 'TPOAGMT'              TO AA-DB2-TABLE-1         06510000
065200            MOVE SPACES                 TO AA-DB2-TABLE-2         06520000
065300                                           AA-DB2-TABLE-3         06530000
065400                                           AA-DB2-TABLE-4         06540000
065500                                           AA-DB2-TABLE-5         06550000
065600            PERFORM Z999-DB2-ABEND                                06560000
065700     END-EVALUATE.                                                06570000
065800                                                                  06580000
065900                                                                  06590000
066000*----------------------------------------------------------------*06600000
066100*    WRITE PAGE HEADING LINES                                    *06610010
066200*----------------------------------------------------------------*06620000
066300 W100-WRITE-HEADINGS.                                             06630000
066400                                                                  06640000
066500     ADD +1                      TO PV-PAGE-COUNT.                06650000
066600     MOVE PV-PAGE-COUNT          TO DP132-PAGE-NUMBER.            06660000
066700                                                                  06670000
066800* HEADING LINE 1 (STANDARD)                                       06680000
066900     WRITE REPORT-REC FROM DP132-STANDRD-HEADER-132-COLS          06690009
067000       AFTER ADVANCING PAGE.                                      06700000
067100                                                                  06710000
067200     WRITE REPORT-REC FROM H2-HEADER2                             06720000
067300       AFTER ADVANCING +2 LINES.                                  06730000
067400                                                                  06740000
067500     WRITE REPORT-REC FROM H3-HEADER3                             06750009
067600       AFTER ADVANCING +2 LINES.                                  06760009
067700                                                                  06770009
067800     MOVE +5                     TO PV-LINE-COUNT.                06780009
067900                                                                  06790000
068000                                                                  06800000
068100*----------------------------------------------------------------*06810000
068200*    WRITE VENDOR DETAIL HEADING                                 *06820010
068300*----------------------------------------------------------------*06830000
068400 W200-WRITE-VENDOR-DETAIL.                                        06840009
068500                                                                  06850000
068600     IF (PV-LINE-COUNT + 5) > PC-LINES-PER-PAGE-MAX               06860018
068700        PERFORM W100-WRITE-HEADINGS                               06870018
068800     END-IF                                                       06880018
068900                                                                  06890018
069000     MOVE ENTNME-ENT-NAME-DESC TO D1-VENDOR-NAME                  06900018
069100                                  HOLD-VENDOR-NAME.               06910018
069200                                                                  06920018
069300     WRITE REPORT-REC FROM D1-VENDOR-DETAIL                       06930018
069400       AFTER ADVANCING +2 LINES.                                  06940018
069500                                                                  06950018
069600     ADD +2            TO PV-LINE-COUNT.                          06960018
069700                                                                  06970018
069800     INITIALIZE D1-VENDOR-DETAIL.                                 06980018
069900                                                                  06990000
070000                                                                  07000000
070100*----------------------------------------------------------------*07010000
070200*    WRITE DETAIL LINE                                           *07020010
070300*----------------------------------------------------------------*07030000
070400 W300-WRITE-DETAIL.                                               07040010
070500                                                                  07050000
070600     IF (PV-LINE-COUNT + PV-POINVC-UNIT) > PC-LINES-PER-PAGE-MAX  07060016
070700         PERFORM W100-WRITE-HEADINGS                              07070000
070800     END-IF                                                       07080000
070900                                                                  07090000
071000     WRITE REPORT-REC FROM D2-PO-DETAIL                           07100019
071100       AFTER ADVANCING +2 LINES.                                  07110016
071200                                                                  07120016
071300     WRITE REPORT-REC FROM D3-INVOICE-DETAIL                      07130019
071400       AFTER ADVANCING +1 LINES.                                  07140016
071500                                                                  07150000
071600     ADD +3          TO  PV-LINE-COUNT.                           07160016
071700     ADD 1           TO  PV-INV-WRT-COUNT.                        07170016
071800                                                                  07180018
071900     INITIALIZE D2-PO-DETAIL                                      07190018
072000                D3-INVOICE-DETAIL.                                07200018
072100                                                                  07210000
072200                                                                  07220000
072300*----------------------------------------------------------------*07230016
072400*    WRITE END OF REPORT LINE                                    *07240016
072500*----------------------------------------------------------------*07250016
072600 W400-WRITE-EOR.                                                  07260016
072700                                                                  07270016
072800     IF (PV-LINE-COUNT + 3) > PC-LINES-PER-PAGE-MAX               07280016
072900         PERFORM W100-WRITE-HEADINGS                              07290016
073000     END-IF                                                       07300016
073100                                                                  07310016
073200     WRITE REPORT-REC FROM END-OF-REPORT                          07320016
073300       AFTER ADVANCING +3 LINES.                                  07330016
073400                                                                  07340016
073500                                                                  07350016
073600*---------------------------------------------------------------- 07360000
073700*    OPEN INVOICE_CSR CURSOR                                      07370010
073800*---------------------------------------------------------------- 07380000
073900 X100-OPEN-INVOICE-CSR.                                           07390000
074000                                                                  07400000
074100     EXEC SQL                                                     07410000
074200         OPEN INVOICE_CSR                                         07420000
074300     END-EXEC.                                                    07430000
074400                                                                  07440000
074500     EVALUATE TRUE                                                07450000
074600         WHEN SQLCODE = ZERO                                      07460000
074700             SET CURSOR-OPEN TO TRUE                              07470000
074800                                                                  07480000
074900         WHEN SQLWARN0 NOT = SPACES                               07490000
075000         WHEN SQLCODE  NOT = ZERO                                 07500000
075100             MOVE 'X100-OPEN-INVOICE-CSR'                         07510000
075200                                 TO AA-PARAGRAPH-NAME             07520000
075300             MOVE 'UNSUCCESSFUL OPEN ON INVOICE_CSR'              07530000
075400                                 TO AA-DB2-OPERATION              07540000
075500             MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                07550000
075600             MOVE 'TMDINVC'      TO AA-DB2-TABLE-2                07560000
075700             MOVE 'TINVCTM'      TO AA-DB2-TABLE-3                07570016
075800             MOVE 'TPOAGMT'      TO AA-DB2-TABLE-4                07580016
075900             MOVE 'TPAYTRM'      TO AA-DB2-TABLE-5                07590016
076000             PERFORM Z999-DB2-ABEND                               07600000
076100     END-EVALUATE.                                                07610000
076200                                                                  07620000
076300                                                                  07630000
076400*---------------------------------------------------------------- 07640000
076500*    CLOSE THE INVOICE_CSR CURSOR                                 07650010
076600*---------------------------------------------------------------- 07660000
076700 X200-CLOSE-INVOICE-CSR.                                          07670006
076800                                                                  07680000
076900     EXEC SQL                                                     07690000
077000         CLOSE INVOICE_CSR                                        07700000
077100     END-EXEC.                                                    07710000
077200                                                                  07720000
077300     EVALUATE TRUE                                                07730000
077400         WHEN SQLCODE = ZERO                                      07740000
077500             CONTINUE                                             07750000
077600                                                                  07760000
077700         WHEN SQLWARN0 NOT = SPACES                               07770000
077800         WHEN SQLCODE  NOT = ZERO                                 07780000
077900             MOVE 'X200-CLOSE-INVOICE-CSR'                        07790006
078000                                 TO AA-PARAGRAPH-NAME             07800000
078100             MOVE 'UNSUCCESSFUL CLOSE ON INVOICE_CSR'             07810000
078200                                 TO AA-DB2-OPERATION              07820000
078300             MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                07830000
078400             MOVE 'TMDINVC'      TO AA-DB2-TABLE-2                07840000
078500             MOVE 'TINVCTM'      TO AA-DB2-TABLE-3                07850016
078600             MOVE 'TPOAGMT'      TO AA-DB2-TABLE-4                07860016
078700             MOVE 'TPAYTRM'      TO AA-DB2-TABLE-5                07870016
078800             PERFORM Z999-DB2-ABEND                               07880000
078900       END-EVALUATE.                                              07890000
079000                                                                  07900000
079100                                                                  07910000
079200*----------------------------------------------------------------*07920000
079300*    DB2 ABEND ROUTINE                                           *07930000
079400*----------------------------------------------------------------*07940000
079500 Z999-DB2-ABEND.                                                  07950000
079600                                                                  07960000
079700     CLOSE REPORT-FILE.                                           07970009
079800                                                                  07980000
079900     DISPLAY AA-ABEND-LIT.                                        07990000
080000     DISPLAY AA-MESSAGE-LINE-1.                                   08000000
080100     DISPLAY AA-MESSAGE-LINE-2.                                   08010000
080200     DISPLAY AA-DB2-ERROR-LIT.                                    08020000
080300     DISPLAY AA-PROGRAM-LIT.                                      08030000
080400     DISPLAY AA-PARAGRAPH-LIT.                                    08040000
080500     DISPLAY AA-DB2-OPERATION-LIT.                                08050000
080600     DISPLAY AA-DB2-TABLE-1.                                      08060000
080700     DISPLAY AA-DB2-TABLE-2.                                      08070000
080800     DISPLAY AA-DB2-TABLE-3.                                      08080000
080900     DISPLAY AA-DB2-TABLE-4.                                      08090000
081000     DISPLAY AA-DB2-TABLE-5.                                      08100000
081100     SET AC-DB2-ERROR TO TRUE.                                    08110000
081200                                                                  08120000
081300     COPY DPPD004.                                                08130000
081400                                                                  08140000
081500     CALL 'ILBOABN0' USING ABEND-CODE.                            08150000
081600                                                                  08160000
