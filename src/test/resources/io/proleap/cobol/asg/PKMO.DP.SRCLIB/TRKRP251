000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    TRKRP251.                                         00050000
000600 AUTHOR.        DAVE PHELPS                                       00060000
000700*               PATRICK BURKE - MAJOR REVISION 12/08/99           00070000
000800 INSTALLATION.  KOHLS.                                            00080000
000900 DATE-WRITTEN   AUG.,1998.                                        00090000
001000 DATE-COMPILED.                                                   00100000
001100                                                                  00110000
001200*----------------------------------------------------------------*00120000
001300* THIS PROGRAM CREATES AN ERROR REPORT OF DATA THAT DID NOT PASS  00130000
001400* EDITS OR RECEIVED WARNINGS IN EDIT OR UPDATE PROGRAMS.          00140000
001500*----------------------------------------------------------------*00150000
      * ****************************************************************00151003
      * CHANGE DESCRIPTION                                              00152003
      * ****************************************************************00153003
      * DATE  07/01/2010                                                00154003
      *  CHANGE MADE: ADDED THE NEW RECORD TYPE 'ARVDCN' WHICH WOULD    00155003
      *  CONTAIN INFORMATION PERTAINING TO THE ARRIVAL OF CONTAINERS AT 00156003
      *  THE DECONSOLIDATOR. THIS IS BEING DONE AS PART OF THE IMPORT   00157003
      *  REPLENISHMENT PROJECT 2010.                                    00158003
      * MADE BY: MONIKA SACHDEVA         TKID: TKMAW78                  00159003
      * CHANGES TAGGED AS MS 07/01/2010                                 00159103
001600                                                                  00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000                                                                  00200000
002100 CONFIGURATION SECTION.                                           00210000
002200                                                                  00220000
002300 SOURCE-COMPUTER.        IBM-3090.                                00230000
002400 OBJECT-COMPUTER.        IBM-3090.                                00240000
002500                                                                  00250000
002600 INPUT-OUTPUT SECTION.                                            00260000
002700                                                                  00270000
002800 FILE-CONTROL.                                                    00280000
002900                                                                  00290000
003000     SELECT ERROR-FILE                                            00300000
003100         ASSIGN TO INP01.                                         00310000
003200                                                                  00320000
003300     SELECT ERROR-REPORT-FILE                                     00330000
003400         ASSIGN TO RPT01.                                         00340000
003500                                                                  00350000
003600******************************************************************00360000
003700 DATA DIVISION.                                                   00370000
003800******************************************************************00380000
003900                                                                  00390000
004000 FILE SECTION.                                                    00400000
004100                                                                  00410000
004200 FD  ERROR-FILE                                                   00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     BLOCK CONTAINS 0 RECORDS.                                    00450000
004600                                                                  00460000
004700 01  ERROR-RECORD                     PIC  X(508).                00470000
004800                                                                  00480000
004900                                                                  00490000
005000 FD  ERROR-REPORT-FILE                                            00500000
005100     RECORDING MODE IS F                                          00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     BLOCK CONTAINS 0 RECORDS.                                    00530000
005400                                                                  00540000
005500 01  ERROR-REPORT-RECORD              PIC  X(132).                00550000
005600                                                                  00560000
005700                                                                  00570000
005800*----------------------------------------------------------------*00580000
005900 WORKING-STORAGE SECTION.                                         00590000
006000*----------------------------------------------------------------*00600000
006100                                                                  00610000
006200*----------------------------------------------------------------*00620000
006300***  WORK FIELDS FOR THE ERROR REPORT                             00630000
006400*----------------------------------------------------------------*00640000
006500     COPY TRRD251.                                                00650001
006600                                                                  00660000
006700*----------------------------------------------------------------*00670000
006800***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00680000
006900*----------------------------------------------------------------*00690000
007000     COPY DPWS132O.                                               00700001
007100                                                                  00710000
007200 01  HL-P1-PAGE-HEADER-1.                                         00720000
007300         10 FILLER                   PIC  X(02)      VALUE SPACES.00730000
007400     05  HL-P1-TRANS-DATE.                                        00740000
007500         10 HL-P1-TRANS-MM           PIC  X(02)      VALUE SPACE. 00750000
007600         10 FILLER                   PIC  X(01)      VALUE '/'.   00760000
007700         10 HL-P1-TRANS-DD           PIC  X(02)      VALUE SPACE. 00770000
007800         10 FILLER                   PIC  X(01)      VALUE '/'.   00780000
007900         10 HL-P1-TRANS-YY           PIC  X(02)      VALUE SPACE. 00790000
008000     05  FILLER                      PIC  X(02)      VALUE SPACE. 00800000
008100     05  HL-P1-TRANS-TIME.                                        00810000
008200         10 HL-P1-TRANS-TIME-HH      PIC  X(02)      VALUE SPACE. 00820000
008300         10 FILLER                   PIC  X(01)      VALUE ':'.   00830000
008400         10 HL-P1-TRANS-TIME-MM      PIC  X(02)      VALUE SPACE. 00840000
008500     05  FILLER                      PIC  X(01)      VALUE SPACE. 00850000
008600     05  FILLER                      PIC  X(13)      VALUE        00860000
008700         'TRANSMIT DATE'.                                         00870000
008800     05  FILLER                      PIC  X(16)      VALUE SPACE. 00880000
008900     05  FILLER                      PIC  X(38)      VALUE        00890000
009000         '    IMPORT PURCHASE ORDER TRACKING    '.                00900000
009100     05  FILLER                      PIC  X(17)      VALUE SPACE. 00910000
009200     05  FILLER                      PIC  X(07)      VALUE        00920000
009300         'FILE ID'.                                               00930000
009400     05  FILLER                      PIC  X(02)      VALUE SPACE. 00940000
009500     05  HL-P1-FILE-ID               PIC  X(09)      VALUE SPACE. 00950000
009600     05  FILLER                      PIC  X(12)      VALUE SPACE. 00960000
009700                                                                  00970000
009800 01  HL-P2-PAGE-HEADER-2.                                         00980000
009900         10 FILLER                   PIC  X(02)      VALUE SPACES.00990000
010000     05  HL-P2-LOAD-DATE.                                         01000000
010100         10 HL-P2-LOAD-MM            PIC  X(02)      VALUE SPACE. 01010000
010200         10 FILLER                   PIC  X(01)      VALUE '/'.   01020000
010300         10 HL-P2-LOAD-DD            PIC  X(02)      VALUE SPACE. 01030000
010400         10 FILLER                   PIC  X(01)      VALUE '/'.   01040000
010500         10 HL-P2-LOAD-YY            PIC  X(02)      VALUE SPACE. 01050000
010600     05  FILLER                      PIC  X(02)      VALUE SPACE. 01060000
010700     05  HL-P2-LOAD-TIME.                                         01070000
010800         10 HL-P2-LOAD-TIME-HH       PIC  X(02)      VALUE SPACE. 01080000
010900         10 FILLER                   PIC  X(01)      VALUE ':'.   01090000
011000         10 HL-P2-LOAD-TIME-MM       PIC  X(02)      VALUE SPACE. 01100000
011100     05  FILLER                      PIC  X(01)      VALUE SPACE. 01110000
011200     05  FILLER                      PIC  X(13)      VALUE        01120000
011300         'LOAD DATE    '.                                         01130000
011400     05  FILLER                      PIC  X(16)      VALUE SPACE. 01140000
011500     05  FILLER                      PIC  X(39)      VALUE        01150000
011600         '  VESSEL / VOYAGE DELIVERY LOAD ERRORS '.               01160000
011700     05  FILLER                      PIC  X(16)      VALUE SPACE. 01170000
011800     05  HL-P2-ENTITY                PIC  X(30)      VALUE SPACES.01180000
011900     05  FILLER                      PIC  X(01)      VALUE SPACE. 01190000
012000                                                                  01200000
012100 01  HL-C1-CNTNR-HEADER-1.                                        01210000
012200     05  FILLER                      PIC  X(53)      VALUE SPACE. 01220000
012300     05  FILLER                      PIC  X(14)      VALUE        01230000
012400         'DECONSOLIDATER'.                                        01240000
012500     05  FILLER                      PIC  X(65)      VALUE SPACE. 01250000
012600                                                                  01260000
012700 01  HL-C2-CNTNR-HEADER-2.                                        01270000
012800     05  FILLER                      PIC  X(09)      VALUE        01280000
012900         'CONTAINER'.                                             01290000
013000     05  FILLER                      PIC  X(16)      VALUE SPACE. 01300000
013100     05  FILLER                      PIC  X(11)      VALUE        01310000
013200         'VESSEL NAME'.                                           01320000
013300     05  FILLER                      PIC  X(17)      VALUE SPACE. 01330000
013400     05  FILLER                      PIC  X(14)      VALUE        01340000
013500         '     SCAC     '.                                        01350000
013600     05  FILLER                      PIC  X(07)      VALUE SPACE. 01360000
013700     05  FILLER                      PIC  X(22)      VALUE        01370000
013800         '   PORT OF ENTRY      '.                                01380000
013900     05  HL-C2-TEXT-MSG              PIC  X(36)      VALUE SPACE. 01390000
014000                                                                  01400000
014100 01  DL-C1-CNTNR-LINE.                                            01410000
014200     05  DL-C1-CONTAINER            PIC  X(12)    VALUE SPACES.   01420000
014300     05  FILLER                     PIC  X(13)    VALUE SPACES.   01430000
014400     05  DL-C1-VESSEL-NAME          PIC  X(25)    VALUE SPACES.   01440000
014500     05  FILLER                     PIC  X(08)    VALUE SPACES.   01450000
014600     05  DL-C1-DCONSLR-SCAC         PIC  X(04)    VALUE SPACES.   01460000
014700     05  FILLER                     PIC  X(15)    VALUE SPACES.   01470000
014800     05  DL-C1-POE                  PIC  X(30)    VALUE SPACES.   01480000
014900     05  FILLER                     PIC  X(25)    VALUE SPACES.   01490000
015000                                                                  01500000
015100 01  HL-D1-DETAIL-HEADER-1.                                       01510000
015200     05  FILLER                      PIC  X(04)      VALUE        01520000
015300         'RECD'.                                                  01530000
015400     05  FILLER                      PIC  X(03)      VALUE SPACE. 01540000
015500     05  FILLER                      PIC  X(03)      VALUE        01550000
015600         'TRN'.                                                   01560000
015700     05  FILLER                      PIC  X(135)     VALUE SPACE. 01570000
015800                                                                  01580000
015900 01  HL-D2-DETAIL-HEADER-2.                                       01590000
016000     05  FILLER                      PIC  X(04)      VALUE        01600000
016100         'TYPE'.                                                  01610000
016200     05  FILLER                      PIC  X(03)      VALUE SPACE. 01620000
016300     05  FILLER                      PIC  X(04)      VALUE        01630000
016400         'TYPE'.                                                  01640000
016500     05  FILLER                      PIC  X(02)      VALUE SPACE. 01650000
016600     05  FILLER                      PIC  X(09)      VALUE        01660000
016700         'PO NUMBER'.                                             01670000
016800     05  FILLER                      PIC  X(03)      VALUE SPACE. 01680000
016900     05  FILLER                      PIC  X(22)      VALUE        01690000
017000         'EXTERNAL REFERENCE NBR'.                                01700000
017100     05  FILLER                      PIC  X(30)      VALUE SPACE. 01710000
017200     05  HL-D2-TIME-1-COL-HDR        PIC  X(29)      VALUE SPACE. 01720000
017300     05  FILLER                      PIC  X(25)      VALUE SPACE. 01730000
017400                                                                  01740000
017500 01  DL-D1-DETAIL-LINE.                                           01750000
017600     05  DL-D1-RECD-TYPE            PIC  X(06)    VALUE SPACES.   01760000
017700     05  FILLER                     PIC  X(03)    VALUE SPACES.   01770000
017800     05  DL-D1-TRN-TYP              PIC  X(01)    VALUE SPACES.   01780000
017900     05  FILLER                     PIC  X(03)    VALUE SPACES.   01790000
018000     05  DL-D1-PO-NBR               PIC  X(09)    VALUE SPACES.   01800000
018100     05  FILLER                     PIC  X(03)    VALUE SPACES.   01810000
018200     05  DL-D1-EXTL-REF-NBR         PIC  X(15)    VALUE SPACES.   01820000
018300     05  FILLER                     PIC  X(37)    VALUE SPACES.   01830000
018400     05  DL-D1-DATE-1.                                            01840000
018500         10  DL-D1-DATE-1-MM        PIC  X(02)    VALUE SPACES.   01850000
018600         10  DL-D1-DATE-1-SLASH-1   PIC  X(01)    VALUE SPACES.   01860000
018700         10  DL-D1-DATE-1-DD        PIC  X(02)    VALUE SPACES.   01870000
018800         10  DL-D1-DATE-1-SLASH-2   PIC  X(01)    VALUE SPACES.   01880000
018900         10  DL-D1-DATE-1-CCYY      PIC  X(04)    VALUE SPACES.   01890000
019000     05  FILLER                     PIC  X(02)    VALUE SPACES.   01900000
019100     05  DL-D1-TIME-1.                                            01910000
019200         10  DL-D1-TIME-1-HH        PIC  X(02)    VALUE SPACES.   01920000
019300         10  DL-D1-TIME-1-COLON     PIC  X(01)    VALUE SPACES.   01930000
019400         10  DL-D1-TIME-1-MM        PIC  X(02)    VALUE SPACES.   01940000
019500                                                                  01950000
019600 01  HL-ERROR-HEADING-LINE.                                       01960000
019700     05  FILLER                      PIC  X(25)      VALUE SPACE. 01970000
019800     05  FILLER                      PIC  X(13)      VALUE        01980000
019900         'DATA IN ERROR'.                                         01990000
020000     05  FILLER                      PIC  X(06)      VALUE SPACE. 02000000
020100     05  FILLER                      PIC  X(10)      VALUE        02010000
020200         'DATA VALUE'.                                            02020000
020300     05  FILLER                      PIC  X(16)      VALUE SPACE. 02030000
020400     05  FILLER                      PIC  X(04)      VALUE        02040000
020500         'TYPE'.                                                  02050000
020600     05  FILLER                      PIC  X(03)      VALUE SPACE. 02060000
020700     05  FILLER                      PIC  X(07)      VALUE        02070000
020800         'MESSAGE'.                                               02080000
020900     05  FILLER                      PIC  X(48)      VALUE SPACE. 02090000
021000                                                                  02100000
021100 01  EL-ERROR-DETAIL-LINE.                                        02110000
021200     05  FILLER                     PIC  X(25)    VALUE SPACES.   02120000
021300     05  EL-DATA-ERROR              PIC  X(15)    VALUE SPACES.   02130000
021400     05  FILLER                     PIC  X(04)    VALUE SPACES.   02140000
021500     05  EL-DATA-VALUE              PIC  X(20)    VALUE SPACES.   02150000
021600     05  FILLER                     PIC  X(06)    VALUE SPACES.   02160000
021700     05  EL-DATA-TYPE               PIC  X(03)    VALUE SPACES.   02170000
021800     05  FILLER                     PIC  X(04)    VALUE SPACES.   02180000
021900     05  EL-DATA-MSG                PIC  X(50)    VALUE SPACES.   02190000
022000     05  FILLER                     PIC  X(05)    VALUE SPACES.   02200000
022100                                                                  02210000
022200 01  INVALID-HEADING-1.                                           02220000
022300     05  FILLER                      PIC  X(04)      VALUE        02230000
022400         'RECD'.                                                  02240000
022500     05  FILLER                      PIC  X(03)      VALUE SPACE. 02250000
022600     05  FILLER                      PIC  X(04)      VALUE        02260000
022700         'TRN '.                                                  02270000
022800     05  FILLER                      PIC  X(120)     VALUE SPACE. 02280000
022900                                                                  02290000
023000 01  INVALID-HEADING-2.                                           02300000
023100     05  FILLER                      PIC  X(04)      VALUE        02310000
023200         'TYPE'.                                                  02320000
023300     05  FILLER                      PIC  X(03)      VALUE SPACE. 02330000
023400     05  FILLER                      PIC  X(04)      VALUE        02340000
023500         'TYPE'.                                                  02350000
023600     05  FILLER                      PIC  X(02)      VALUE SPACES.02360000
023700     05  FILLER                      PIC  X(13)      VALUE        02370000
023800         'DATA IN ERROR'.                                         02380000
023900     05  FILLER                      PIC  X(11)      VALUE SPACE. 02390000
024000     05  FILLER                      PIC  X(10)      VALUE        02400000
024100         'DATA VALUE'.                                            02410000
024200     05  FILLER                      PIC  X(12)      VALUE SPACE. 02420000
024300     05  FILLER                      PIC  X(04)      VALUE        02430000
024400         'TYPE'.                                                  02440000
024500     05  FILLER                      PIC  X(04)      VALUE SPACE. 02450000
024600     05  FILLER                      PIC  X(07)      VALUE        02460000
024700         'MESSAGE'.                                               02470000
024800     05  FILLER                      PIC  X(58)      VALUE SPACE. 02480000
024900                                                                  02490000
025000 01  INVALID-DETAIL-1.                                            02500000
025100     05  INVALID-RECD-TYPE          PIC  X(06)    VALUE SPACES.   02510000
025200     05  FILLER                     PIC  X(03)    VALUE SPACES.   02520000
025300     05  INVALID-TRN-TYPE           PIC  X(01)    VALUE SPACES.   02530000
025400     05  FILLER                     PIC  X(03)    VALUE SPACES.   02540000
025500     05  INVALID-DATA-ERROR         PIC  X(15)    VALUE SPACES.   02550000
025600     05  FILLER                     PIC  X(09)    VALUE SPACES.   02560000
025700     05  INVALID-DATA-VALUE         PIC  X(20)    VALUE SPACES.   02570000
025800     05  FILLER                     PIC  X(02)    VALUE SPACES.   02580000
025900     05  INVALID-DATA-TYPE          PIC  X(03)    VALUE SPACES.   02590000
026000     05  FILLER                     PIC  X(05)    VALUE SPACES.   02600000
026100     05  INVALID-DATA-MSG           PIC  X(50)    VALUE SPACES.   02610000
026200     05  FILLER                     PIC  X(15)    VALUE SPACES.   02620000
026300                                                                  02630000
026400 01  TRL-HEADING-LINE-1.                                          02640000
026500     05  FILLER                      PIC  X(31)      VALUE        02650000
026600         'A = ADD, C = CHANGE, D = DELETE'.                       02660000
026700     05  FILLER                      PIC  X(101)     VALUE SPACE. 02670000
026800                                                                  02680000
026900 01  ER-END-OF-REPORT-LINE.                                       02690000
027000     05  FILLER                     PIC  X(54)    VALUE SPACE.    02700000
027100     05  FILLER                     PIC  X(25)    VALUE           02710000
027200         '***** END OF REPORT *****'.                             02720000
027300     05  FILLER                     PIC  X(53)    VALUE SPACE.    02730000
027400                                                                  02740000
027500 01  EP-EMPTY-REPORT-LINE.                                        02750000
027600     05  FILLER                     PIC  X(25)    VALUE           02760000
027700         '******* NO DATA *********'.                             02770000
027800     05  FILLER                     PIC  X(107)   VALUE SPACE.    02780000
027900                                                                  02790000
028000 01  PS-PROGRAM-SWITCHES.                                         02800000
028100     05  PS-EOF-ERROR-FILE-SW       PIC  X(01)    VALUE SPACE.    02810000
028200         88  PS-EOF-ERROR-FILE                    VALUE 'Y'.      02820000
028300     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    02830000
028400         88  PS-NEW-PAGE                          VALUE 'Y'.      02840000
028500         88  PS-NEW-PAGE-NO                       VALUE 'N'.      02850000
028600     05  PS-DETAIL-SW               PIC  X(01)    VALUE 'Y'.      02860000
028700         88  PS-DETAIL                            VALUE 'Y'.      02870000
028800         88  PS-DETAIL-NO                         VALUE 'N'.      02880000
028900                                                                  02890000
029000 01 PC-PROGRAM-CONSTANTS.                                         02900000
029100     05  PC-PAGE-SIZE-054           PIC S9(04)    VALUE +054      02910000
029200                                                  COMP SYNC.      02920000
029300     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      02930000
029400                                                  COMP SYNC.      02940000
029500     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +6        02950000
029600                                                  COMP SYNC.      02960000
029700     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        02970000
029800                                                  COMP SYNC.      02980000
029900     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       02990000
030000                                                  COMP SYNC.      03000000
030100     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           03010000
030200         'TRKRP251'.                                              03020000
030300     05  PC-A                       PIC  X(01)    VALUE 'A'.      03030000
030400     05  PC-01                      PIC  X(02)    VALUE '01'.     03040000
030500                                                                  03050000
030600     05  PC-DEFAULT-DATE            PIC  X(10)    VALUE           03060000
030700         '01 01 0001'.                                            03070000
030800     05  PC-DEFAULT-TIME            PIC  X(05)    VALUE           03080000
030900         '00 00'.                                                 03090000
031000     05  PC-RECYCLE-TEXT            PIC  X(36)    VALUE           03100000
031100         'RDD - RECYCLE FROM CONTAINER DELETE '.                  03110000
031200                                                                  03120000
031300 01  PV-PROGRAM-VARIABLES.                                        03130000
031400     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      03140000
031500                                                  COMP SYNC.      03150000
031600     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   03160000
031700     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   03170000
031800     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   03180000
031900         88 PV-ADU-REC-TYP-CDE-ADU       VALUE 'ADU  '.           03190000
032000         88 PV-ADD-REC-TYP-CDE-ADD       VALUE 'ADD  '.           03200000
032100         88 PV-ETA-REC-TYP-CDE-ETA       VALUE 'ETA  '.           03210000
032200     05  PV-PREV-CONTNR-ID          PIC  X(15)    VALUE SPACES.   03220000
032300     05  PV-PREV-TRN-TYP            PIC  X(01)    VALUE SPACES.   03230000
032400     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   03240000
032500     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)   VALUE ZEROES.   03250000
032600     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     03260000
032700                                                                  03270000
032800 01  SD-SYSTEM-DATE.                                              03280000
032900     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   03290000
033000     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   03300000
033100     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   03310000
033200                                                                  03320000
033300 01  ST-SYSTEM-TIME.                                              03330000
033400     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   03340000
033500     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   03350000
033600     05  FILLER                     PIC  9(04)      VALUE ZERO.   03360000
033700                                                                  03370000
033800******************************************************************03380000
033900 PROCEDURE DIVISION.                                              03390000
034000******************************************************************03400000
034100                                                                  03410000
034200*----------------------------------------------------------------*03420000
034300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     03430000
034400*      PROGRAM.                                                   03440000
034500*----------------------------------------------------------------*03450000
034600                                                                  03460000
034700 0000-PROGRAM-MAINLINE.                                           03470000
034800                                                                  03480000
034900     PERFORM 1000-INITIALIZE.                                     03490000
035000                                                                  03500000
035100     IF PS-DETAIL-NO                                              03510000
035200        CONTINUE                                                  03520000
035300     ELSE                                                         03530000
035400        PERFORM 2000-PROCESS-REPORT-DATA                          03540000
035500          UNTIL PS-EOF-ERROR-FILE.                                03550000
035600                                                                  03560000
035700     PERFORM 9000-EOJ-ROUTINE.                                    03570000
035800                                                                  03580000
035900     STOP RUN.                                                    03590000
036000                                                                  03600000
036100******************************************************************03610000
036200*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    03620000
036300*    -- OPEN FILES                                                03630000
036400*    -- SET UP AND PRINT REPORT HEADINGS                          03640000
036500******************************************************************03650000
036600                                                                  03660000
036700 1000-INITIALIZE.                                                 03670000
036800                                                                  03680000
036900     OPEN INPUT  ERROR-FILE                                       03690000
037000          OUTPUT ERROR-REPORT-FILE.                               03700000
037100                                                                  03710000
037200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03720000
037300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03730000
037400                                                                  03740000
037500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03750000
037600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03760000
037700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03770000
037800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03780000
037900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03790000
038000                                                                  03800000
038100     MOVE PC-CURRENT-PROGRAM-NAME                                 03810000
038200                                 TO DP132O-PROGRAM-NAME.          03820000
038300                                                                  03830000
038400     MOVE 1                      TO DP132O-REPORT-NUMBER.         03840000
038500                                                                  03850000
038600     INITIALIZE     PS-NEW-PAGE-SW.                               03860000
038700                                                                  03870000
038800     PERFORM 7000-READ-ERROR-FILE UNTIL                           03880000
038900             PS-EOF-ERROR-FILE OR                                 03890000
039000            (TR251-RPT-TYP-ERROR AND                              03900000
039100             NOT TR251-REC-TYP-HDR-CDE-HDR).                      03910000
039200                                                                  03920000
039300     IF PS-EOF-ERROR-FILE                                         03930000
039400        CONTINUE                                                  03940000
039500     ELSE                                                         03950000
039600        PERFORM 2060-MOVE-CNTNR-LINE-FIELDS                       03960000
039700     END-IF.                                                      03970000
039800                                                                  03980000
039900     PERFORM  8000-WRITE-PAGE-HEADINGS.                           03990000
040000                                                                  04000000
040100     IF TR251-ERROR-TYPE = 'EMT' OR                               04010000
040200           PS-EOF-ERROR-FILE                                      04020000
040300        SET PS-DETAIL-NO TO TRUE                                  04030000
040400     ELSE                                                         04040000
040500        PERFORM 2025-BUILD-ERROR-RPT-DATA                         04050000
040600     END-IF.                                                      04060000
040700                                                                  04070000
040800****************************************************************  04080000
040900*  PROCESSING FOR ERROR RECORDS.                                  04090000
041000******************************************************************04100000
041100                                                                  04110000
041200 2000-PROCESS-REPORT-DATA.                                        04120000
041300                                                                  04130000
041400     MOVE SPACES TO TR251-RPT-TYP.                                04140000
041500                                                                  04150000
041600     PERFORM 7000-READ-ERROR-FILE UNTIL                           04160000
041700             PS-EOF-ERROR-FILE OR                                 04170000
041800            (TR251-RPT-TYP-ERROR AND                              04180000
041900             NOT TR251-REC-TYP-HDR-CDE-HDR)                       04190000
042000                                                                  04200000
042100     IF PS-EOF-ERROR-FILE                                         04210000
042200        CONTINUE                                                  04220000
042300     ELSE                                                         04230000
042400        IF TR251-RPT-TYP-ERROR                                    04240000
042500           PERFORM 2025-BUILD-ERROR-RPT-DATA                      04250000
042600        END-IF                                                    04260000
042700     END-IF.                                                      04270000
042800                                                                  04280000
042900******************************************************************04290000
043000*  BUILD THE LINES FOR THE REPORT.                                04300000
043100******************************************************************04310000
043200                                                                  04320000
      * MS 07/01/2010                                                   04321006
      * ADDED THE PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.     04322007
                                                                        04323006
043300 2025-BUILD-ERROR-RPT-DATA.                                       04330000
043400                                                                  04340000
043500     IF TR251-REC-TYP-DVN-CDE-DVN  OR                             04350000
043600        TR251-REC-TYP-DVNRD-CDE-DVNRDD                            04360000
043700        PERFORM 3500-MOVE-DVN-TO-DETAIL                           04370000
043800     END-IF.                                                      04380000
043900                                                                  04390000
044000     IF TR251-REC-TYP-DPU-CDE-DPU  OR                             04400000
044100        TR251-REC-TYP-DPURD-CDE-DPURDD                            04410000
044200        PERFORM 3600-MOVE-DPU-TO-DETAIL                           04420000
044300     END-IF.                                                      04430000
044400                                                                  04440000
044500     IF TR251-REC-TYP-DLV-CDE-DLV  OR                             04450000
044600        TR251-REC-TYP-DLVRD-CDE-DLVRDD                            04460000
044700        PERFORM 3700-MOVE-DLV-TO-DETAIL                           04470000
044800     END-IF.                                                      04480000
044900                                                                  04490000
045000     IF TR251-REC-TYP-CRP-CDE-CRP  OR                             04500000
045100        TR251-REC-TYP-CRPRD-CDE-CRPRDD                            04510000
045200        PERFORM 3710-MOVE-CRP-TO-DETAIL                           04520000
045300     END-IF.                                                      04530000
045400                                                                  04540000
045500     IF TR251-REC-TYP-RTN-CDE-RTN  OR                             04550000
045600        TR251-REC-TYP-RTNRD-CDE-RTNRDD                            04560000
045700        PERFORM 3720-MOVE-RTN-TO-DETAIL                           04570000
045800     END-IF.                                                      04580000
045900                                                                  04590000
           IF TR251-REC-TYP-ARVDCN-CD-ARVDCN  OR                        04591003
              TR251-REC-TYP-ARVDRD-CD-ARVDRD                            04592002
              PERFORM 3730-MOVE-ARVDCN-TO-DETAIL                        04593001
           END-IF.                                                      04594001
                                                                        04595006
046000     IF TR251-ERROR-TYPE = 'EDI'                                  04600000
046100        PERFORM 3800-MOVE-ERROR-TO-DETAIL                         04610000
046200     END-IF.                                                      04620000
046300                                                                  04630000
046400*    *********************************************                04640000
046500*    * CLEAN UP DATE/TIME FIELDS BEFORE PRINT    *                04650000
046600*    *********************************************                04660000
046700     IF DL-D1-DATE-1-MM      NOT NUMERIC OR                       04670000
046800        DL-D1-DATE-1       = PC-DEFAULT-DATE                      04680000
046900        MOVE SPACES TO DL-D1-DATE-1                               04690000
047000     ELSE                                                         04700000
047100        MOVE '/'   TO DL-D1-DATE-1-SLASH-1                        04710000
047200                      DL-D1-DATE-1-SLASH-2                        04720000
047300     END-IF.                                                      04730000
047400                                                                  04740000
047500                                                                  04750000
047600     IF DL-D1-TIME-1-HH      NOT NUMERIC OR                       04760000
047700        DL-D1-TIME-1       = PC-DEFAULT-TIME                      04770000
047800        MOVE SPACES TO DL-D1-TIME-1                               04780000
047900     ELSE                                                         04790000
048000        MOVE ':' TO DL-D1-TIME-1-COLON                            04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048300*    *********************************************                04830000
048400                                                                  04840000
048500     PERFORM 2050-CHECK-FOR-PREVIOUS.                             04850000
048600                                                                  04860000
048700     PERFORM 8100-WRITE-ERROR-RPT-DETAIL.                         04870000
048800                                                                  04880000
048900****************************************************************  04890000
049000*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             04900000
049100*  DATA IS NOT REPEATED FOR CONTAINER-NO                          04910000
049200* *************************************************************** 04920000
049300                                                                  04930000
049400 2050-CHECK-FOR-PREVIOUS.                                         04940000
049500                                                                  04950000
049600                                                                  04960000
049700     IF TR251-CONTNR-ID = PV-PREV-CONTNR-ID  AND                  04970000
049800        TR251-TRN-TYP   = PV-PREV-TRN-TYP    AND                  04980000
049900        (TR251-ERROR-TYPE   NOT =  'EDI')                         04990000
050000        CONTINUE                                                  05000000
050100     ELSE                                                         05010000
050200        PERFORM 2060-MOVE-CNTNR-LINE-FIELDS                       05020000
050300        SET PS-NEW-PAGE         TO TRUE                           05030000
050400        PERFORM  8000-WRITE-PAGE-HEADINGS                         05040000
050500     END-IF.                                                      05050000
050600                                                                  05060000
050700****************************************************************  05070000
050800*  THESE FIELDS GET MOVED ONLY WHEN THERE'S A CONTAINER BREAK.    05080000
050900* *************************************************************** 05090000
051000                                                                  05100000
051100 2060-MOVE-CNTNR-LINE-FIELDS.                                     05110000
051200                                                                  05120000
051300     MOVE TR251-CONTNR-ID     TO DL-C1-CONTAINER                  05130000
051400                                 PV-PREV-CONTNR-ID.               05140000
051500     MOVE TR251-TRN-TYP       TO PV-PREV-TRN-TYP.                 05150000
051600     MOVE TR251-DPU-IMPRT-VEH-NM                                  05160000
051700                              TO DL-C1-VESSEL-NAME.               05170000
051800     MOVE TR251-DCONSLR-SCAC-ID                                   05180000
051900                              TO DL-C1-DCONSLR-SCAC.              05190000
052000     MOVE TR251-POE-NM        TO DL-C1-POE.                       05200000
052100                                                                  05210000
052200******************************************************************05220000
052300* MOVE DVN DATA TO REPORT DETAIL LINE                             05230000
052400******************************************************************05240000
052500                                                                  05250000
052600 3500-MOVE-DVN-TO-DETAIL.                                         05260000
052700                                                                  05270000
052800     INITIALIZE   DL-D1-DETAIL-LINE.                              05280000
052900                                                                  05290000
053000     MOVE TR251-REC-TYP-DVN-CDE (1:3) TO DL-D1-RECD-TYPE.         05300000
053100     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           05310000
053200     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            05320000
053300     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05330000
053400                                                                  05340000
053500     MOVE TR251-DVN-CONTNR-DEVAN-DTE (1:4) TO                     05350000
053600         DL-D1-DATE-1-CCYY.                                       05360000
053700     MOVE TR251-DVN-CONTNR-DEVAN-DTE (5:2) TO                     05370000
053800         DL-D1-DATE-1-MM.                                         05380000
053900     MOVE TR251-DVN-CONTNR-DEVAN-DTE (7:2) TO                     05390000
054000         DL-D1-DATE-1-DD.                                         05400000
054100                                                                  05410000
054200     MOVE TR251-DVN-CONTNR-DEVAN-TM (1:2) TO                      05420000
054300           DL-D1-TIME-1-HH.                                       05430000
054400     MOVE TR251-DVN-CONTNR-DEVAN-TM (3:2) TO                      05440000
054500           DL-D1-TIME-1-MM.                                       05450000
054600                                                                  05460000
054700     MOVE 'CONTAINER DEVAN '                                      05470000
054800                             TO HL-D2-TIME-1-COL-HDR.             05480000
054900                                                                  05490000
055000     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           05500000
055100                                                                  05510000
055200******************************************************************05520000
055300* MOVE DPU DATA TO REPORT DETAIL LINE                             05530000
055400******************************************************************05540000
055500                                                                  05550000
055600 3600-MOVE-DPU-TO-DETAIL.                                         05560000
055700                                                                  05570000
055800     INITIALIZE  DL-D1-DETAIL-LINE.                               05580000
055900                                                                  05590000
056000     MOVE TR251-REC-TYP-DPU-CDE (1:3) TO DL-D1-RECD-TYPE.         05600000
056100     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           05610000
056200     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            05620000
056300     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05630000
056400                                                                  05640000
056500     MOVE TR251-DPU-DELY-ORD-RCVD-DTE (1:4) TO                    05650000
056600         DL-D1-DATE-1-CCYY.                                       05660000
056700     MOVE TR251-DPU-DELY-ORD-RCVD-DTE (5:2) TO                    05670000
056800         DL-D1-DATE-1-MM.                                         05680000
056900     MOVE TR251-DPU-DELY-ORD-RCVD-DTE (7:2) TO                    05690000
057000         DL-D1-DATE-1-DD.                                         05700000
057100                                                                  05710000
057200     MOVE TR251-DPU-DELY-ORD-RCVD-TM (1:2) TO                     05720000
057300           DL-D1-TIME-1-HH.                                       05730000
057400     MOVE TR251-DPU-DELY-ORD-RCVD-TM (3:2) TO                     05740000
057500           DL-D1-TIME-1-MM.                                       05750000
057600                                                                  05760000
057700     MOVE 'DELY ORDER RCVD  '                                     05770000
057800                             TO HL-D2-TIME-1-COL-HDR.             05780000
057900                                                                  05790000
058000     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           05800000
058100                                                                  05810000
058200******************************************************************05820000
058300* MOVE DLV DATA TO REPORT DETAIL LINE                             05830000
058400******************************************************************05840000
058500                                                                  05850000
058600 3700-MOVE-DLV-TO-DETAIL.                                         05860000
058700                                                                  05870000
058800     INITIALIZE   DL-D1-DETAIL-LINE.                              05880000
058900                                                                  05890000
059000     MOVE TR251-REC-TYP-DLV-CDE (1:3) TO DL-D1-RECD-TYPE.         05900000
059100     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           05910000
059200     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            05920000
059300     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      05930000
059400                                                                  05940000
059500     MOVE TR251-DLV-CONTNR-PCKUP-DTE (1:4) TO                     05950000
059600         DL-D1-DATE-1-CCYY.                                       05960000
059700     MOVE TR251-DLV-CONTNR-PCKUP-DTE (5:2) TO                     05970000
059800         DL-D1-DATE-1-MM.                                         05980000
059900     MOVE TR251-DLV-CONTNR-PCKUP-DTE (7:2) TO                     05990000
060000         DL-D1-DATE-1-DD.                                         06000000
060100                                                                  06010000
060200     MOVE TR251-DLV-CONTNR-PCKUP-TM (1:2) TO                      06020000
060300           DL-D1-TIME-1-HH.                                       06030000
060400     MOVE TR251-DLV-CONTNR-PCKUP-TM (3:2) TO                      06040000
060500           DL-D1-TIME-1-MM.                                       06050000
060600                                                                  06060000
060700     MOVE 'CONTAINER PICKUP '                                     06070000
060800                             TO HL-D2-TIME-1-COL-HDR.             06080000
060900                                                                  06090000
061000     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           06100000
061100                                                                  06110000
061200******************************************************************06120000
061300* MOVE CRP DATA TO REPORT DETAIL LINE                             06130000
061400******************************************************************06140000
061500                                                                  06150000
061600 3710-MOVE-CRP-TO-DETAIL.                                         06160000
061700                                                                  06170000
061800     INITIALIZE   DL-D1-DETAIL-LINE.                              06180000
061900                                                                  06190000
062000     MOVE TR251-REC-TYP-CRP-CDE (1:3) TO DL-D1-RECD-TYPE.         06200000
062100     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           06210000
062200     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            06220000
062300     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      06230000
062400                                                                  06240000
062500     MOVE TR251-CRP-FRGT-RLSE-DTE (1:4) TO                        06250000
062600         DL-D1-DATE-1-CCYY.                                       06260000
062700     MOVE TR251-CRP-FRGT-RLSE-DTE (5:2) TO                        06270000
062800         DL-D1-DATE-1-MM.                                         06280000
062900     MOVE TR251-CRP-FRGT-RLSE-DTE (7:2) TO                        06290000
063000         DL-D1-DATE-1-DD.                                         06300000
063100                                                                  06310000
063200     MOVE TR251-CRP-FRGT-RLSE-TM (1:2) TO                         06320000
063300           DL-D1-TIME-1-HH.                                       06330000
063400     MOVE TR251-CRP-FRGT-RLSE-TM (3:2) TO                         06340000
063500           DL-D1-TIME-1-MM.                                       06350000
063600                                                                  06360000
063700     MOVE 'CONTAINER READY FOR PICKUP '                           06370000
063800                             TO HL-D2-TIME-1-COL-HDR.             06380000
063900                                                                  06390000
064000     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           06400000
064100                                                                  06410000
064200******************************************************************06420000
064300* MOVE RTN DATA TO REPORT DETAIL LINE                             06430000
064400******************************************************************06440000
064500                                                                  06450000
064600 3720-MOVE-RTN-TO-DETAIL.                                         06460000
064700                                                                  06470000
064800     INITIALIZE   DL-D1-DETAIL-LINE.                              06480000
064900                                                                  06490000
065000     MOVE TR251-REC-TYP-CRP-CDE (1:3) TO DL-D1-RECD-TYPE.         06500000
065100     MOVE TR251-TRN-TYP               TO DL-D1-TRN-TYP.           06510000
065200     MOVE TR251-PO-NBR                TO DL-D1-PO-NBR.            06520000
065300     MOVE TR251-EXTL-REF-NBR          TO DL-D1-EXTL-REF-NBR.      06530000
065400                                                                  06540000
065500     MOVE TR251-RTN-CONTNR-RETURN-DTE (1:4) TO                    06550000
065600         DL-D1-DATE-1-CCYY.                                       06560000
065700     MOVE TR251-RTN-CONTNR-RETURN-DTE (5:2) TO                    06570000
065800         DL-D1-DATE-1-MM.                                         06580000
065900     MOVE TR251-RTN-CONTNR-RETURN-DTE (7:2) TO                    06590000
066000         DL-D1-DATE-1-DD.                                         06600000
066100                                                                  06610000
066200     MOVE TR251-RTN-CONTNR-RETURN-TM (1:2) TO                     06620000
066300           DL-D1-TIME-1-HH.                                       06630000
066400     MOVE TR251-RTN-CONTNR-RETURN-TM (3:2) TO                     06640000
066500           DL-D1-TIME-1-MM.                                       06650000
066600                                                                  06660000
066700     MOVE 'CONTAINER RETURNED '                                   06670000
066800                             TO HL-D2-TIME-1-COL-HDR.             06680000
066900                                                                  06690000
067000     PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           06700000
067100                                                                  06710000
      * MS 07/01/2010 BEG                                               06710106
      * ADDDED THE PARA 3730 FOR THE PROCESSING OF ARVDCN RECORDS.      06710204
                                                                        06710403
       3730-MOVE-ARVDCN-TO-DETAIL.                                      06711003
                                                                        06712001
           INITIALIZE  DL-D1-DETAIL-LINE.                               06713001
                                                                        06714001
           MOVE TR251-REC-TYP-ARVDCN-CDE (1:6)    TO DL-D1-RECD-TYPE.   06715008
           MOVE TR251-TRN-TYP                     TO DL-D1-TRN-TYP.     06716003
           MOVE TR251-PO-NBR                      TO DL-D1-PO-NBR.      06717003
           MOVE TR251-EXTL-REF-NBR                TO DL-D1-EXTL-REF-NBR.06718003
                                                                        06719001
           MOVE TR251-ARVDCN-ARRIVE-DECON-DTE (1:4) TO                  06719101
                   DL-D1-DATE-1-CCYY.                                   06719201
           MOVE TR251-ARVDCN-ARRIVE-DECON-DTE (5:2) TO                  06719301
                   DL-D1-DATE-1-MM.                                     06719401
           MOVE TR251-ARVDCN-ARRIVE-DECON-DTE (7:2) TO                  06719501
                   DL-D1-DATE-1-DD.                                     06719601
                                                                        06719701
           MOVE TR251-ARVDCN-ARRIVE-DECON-TM (1:2)  TO                  06719803
                   DL-D1-TIME-1-HH.                                     06719901
           MOVE TR251-ARVDCN-ARRIVE-DECON-TM (3:2)  TO                  06720003
                   DL-D1-TIME-1-MM.                                     06720101
                                                                        06720201
           MOVE 'CONTAINER ARRIVED AT DECON'                            06720301
                                                TO HL-D2-TIME-1-COL-HDR.06720403
                                                                        06720501
           PERFORM 3800-MOVE-ERROR-TO-DETAIL.                           06720603
                                                                        06720703
      * MS 07/01/2010 END                                               06720803
067200******************************************************************06721000
067300*3800-MOVE-ERROR-TO-DETAIL.                                       06730000
067400******************************************************************06740000
067500                                                                  06750000
067600 3800-MOVE-ERROR-TO-DETAIL.                                       06760000
067700                                                                  06770000
067800     MOVE TR251-DATA-IN-ERROR    TO EL-DATA-ERROR.                06780000
067900     MOVE TR251-DATA-VALUE-NUM   TO EL-DATA-VALUE.                06790000
068000     MOVE TR251-ERROR-TYPE       TO EL-DATA-TYPE.                 06800000
068100     MOVE TR251-ERROR-MSG        TO EL-DATA-MSG.                  06810000
068200                                                                  06820000
068300******************************************************************06831000
068400*  READ THE ERROR-FILE                                           *06840000
068500******************************************************************06850000
068600 7000-READ-ERROR-FILE.                                            06860000
068700                                                                  06870000
068800     READ ERROR-FILE                                              06880000
068900        INTO TR251-RECORD                                         06890000
069000           AT END                                                 06900000
069100              SET PS-EOF-ERROR-FILE TO TRUE.                      06910000
069200                                                                  06920000
069300     IF TR251-REC-TYP-HDR-CDE-HDR                                 06930000
069400        MOVE TR251-HDR-CONSOL-TRNS-DTE (5:2) TO                   06940000
069500           HL-P1-TRANS-MM                                         06950000
069600        MOVE TR251-HDR-CONSOL-TRNS-DTE (7:2) TO                   06960000
069700           HL-P1-TRANS-DD                                         06970000
069800        MOVE TR251-HDR-CONSOL-TRNS-DTE (3:2) TO                   06980000
069900           HL-P1-TRANS-YY                                         06990000
070000        MOVE TR251-HDR-CONSOL-TRNS-TM (1:2) TO                    07000000
070100           HL-P1-TRANS-TIME-HH                                    07010000
070200        MOVE TR251-HDR-CONSOL-TRNS-TM (3:2) TO                    07020000
070300           HL-P1-TRANS-TIME-MM                                    07030000
070400        MOVE TR251-HDR-CONSOL-FIL-ID TO                           07040000
070500           HL-P1-FILE-ID                                          07050000
070600        MOVE TR251-HDR-LOAD-DTE (5:2) TO                          07060000
070700           HL-P2-LOAD-MM                                          07070000
070800        MOVE TR251-HDR-LOAD-DTE (7:2) TO                          07080000
070900           HL-P2-LOAD-DD                                          07090000
071000        MOVE TR251-HDR-LOAD-DTE (3:2) TO                          07100000
071100           HL-P2-LOAD-YY                                          07110000
071200        MOVE TR251-HDR-LOAD-TM (1:2) TO                           07120000
071300           HL-P2-LOAD-TIME-HH                                     07130000
071400        MOVE TR251-HDR-LOAD-TM (3:2) TO                           07140000
071500           HL-P2-LOAD-TIME-MM                                     07150000
071600        MOVE TR251-HDR-CONSOL-ENTNME TO                           07160000
071700           HL-P2-ENTITY                                           07170000
071800        MOVE TR251-REC-TYP-HDR-CDE TO                             07180000
071900           PV-REC-TYP-CDE-PREV                                    07190000
072000     END-IF.                                                      07200000
072100                                                                  07210000
072200***************************************************************** 07220000
072300*  PRINT THE HEADINGS ON EACH PAGE.                             * 07230000
072400***************************************************************** 07240000
                                                                        07240106
      * MS 07/01/2010                                                   07241006
      * ADDED PROCESSING FOR ARVDRD TYPE OF RECORD                      07242006
                                                                        07243006
072500 8000-WRITE-PAGE-HEADINGS.                                        07250000
072600                                                                  07260000
072700     ADD 1                TO PV-PAGE-COUNT.                       07270000
072800     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  07280000
072900                                                                  07290000
073000     IF PV-PAGE-COUNT > 1                                         07300000
073100        PERFORM                                                   07310000
073200           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          07320000
073300           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 07330000
073400                                                                  07340000
073500           WRITE ERROR-REPORT-RECORD FROM PV-BLANK-LINE           07350000
073600              AFTER ADVANCING 1 LINE                              07360000
073700                                                                  07370000
073800        END-PERFORM                                               07380000
073900                                                                  07390000
074000        IF PV-LINES-USED > PC-PAGE-SIZE-060                       07400000
074100           WRITE ERROR-REPORT-RECORD FROM TRL-HEADING-LINE-1      07410000
074200              AFTER ADVANCING 2 LINES                             07420000
074300        END-IF                                                    07430000
074400     END-IF.                                                      07440000
074500                                                                  07450000
074600     WRITE ERROR-REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS07460000
074700        AFTER ADVANCING PAGE.                                     07470000
074800                                                                  07480000
074900     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       07490000
075000                                                                  07500000
075100     WRITE ERROR-REPORT-RECORD FROM HL-P1-PAGE-HEADER-1           07510000
075200        AFTER ADVANCING 1 LINE.                                   07520000
075300                                                                  07530000
075400     WRITE ERROR-REPORT-RECORD FROM HL-P2-PAGE-HEADER-2           07540000
075500        AFTER ADVANCING 1 LINE.                                   07550000
075600                                                                  07560000
075700     WRITE ERROR-REPORT-RECORD FROM HL-C1-CNTNR-HEADER-1          07570000
075800        AFTER ADVANCING 2 LINES.                                  07580000
075900                                                                  07590000
076000     IF TR251-REC-TYP-DPURD-CDE-DPURDD  OR                        07600000
076100        TR251-REC-TYP-DLVRD-CDE-DLVRDD  OR                        07610000
076200        TR251-REC-TYP-DVNRD-CDE-DVNRDD  OR                        07620000
076300        TR251-REC-TYP-CRPRD-CDE-CRPRDD  OR                        07630000
              TR251-REC-TYP-RTNRD-CDE-RTNRDD  OR                        07641003
              TR251-REC-TYP-ARVDRD-CD-ARVDRD                            07642003
076500         MOVE PC-RECYCLE-TEXT         TO HL-C2-TEXT-MSG           07650000
076600     ELSE                                                         07660000
076700         MOVE SPACES                  TO HL-C2-TEXT-MSG           07670000
076800     END-IF.                                                      07680000
076900                                                                  07690000
077000     WRITE ERROR-REPORT-RECORD FROM HL-C2-CNTNR-HEADER-2          07700000
077100        AFTER ADVANCING 1 LINES.                                  07710000
077200                                                                  07720000
077300     WRITE ERROR-REPORT-RECORD FROM DL-C1-CNTNR-LINE              07730000
077400        AFTER ADVANCING 1 LINES.                                  07740000
077500                                                                  07750000
077600     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07760000
077700                                                                  07770000
077800******************************************************************07780000
077900*  WRITE THE ERROR REPORT DETAIL RECORD.                          07790000
078000******************************************************************07800000
                                                                        07801006
      * MS 07/01/2010                                                   07801106
      * ADDED PROCESSING FOR ARVDCN AND ARVDRD TYPE OF RECORDS.         07802006
                                                                        07803006
078100 8100-WRITE-ERROR-RPT-DETAIL.                                     07810000
078200                                                                  07820000
078300     IF PV-LINES-USED >= PC-PAGE-SIZE-054                         07830000
078400        SET PS-NEW-PAGE  TO TRUE                                  07840000
078500        PERFORM 8000-WRITE-PAGE-HEADINGS                          07850000
078600     END-IF.                                                      07860000
078700                                                                  07870000
078800     EVALUATE TRUE                                                07880000
078900                                                                  07890000
079000       WHEN TR251-REC-TYP-DVN-CDE-DVN                             07900000
079100       WHEN TR251-REC-TYP-DPU-CDE-DPU                             07910000
079200       WHEN TR251-REC-TYP-DLV-CDE-DLV                             07920000
079300       WHEN TR251-REC-TYP-CRP-CDE-CRP                             07930000
079400       WHEN TR251-REC-TYP-RTN-CDE-RTN                             07940000
             WHEN TR251-REC-TYP-ARVDCN-CD-ARVDCN                        07941003
079500       WHEN TR251-REC-TYP-DVNRD-CDE-DVNRDD                        07950000
079600       WHEN TR251-REC-TYP-DPURD-CDE-DPURDD                        07960000
079700       WHEN TR251-REC-TYP-DLVRD-CDE-DLVRDD                        07970000
079800       WHEN TR251-REC-TYP-CRPRD-CDE-CRPRDD                        07980000
079900       WHEN TR251-REC-TYP-RTNRD-CDE-RTNRDD                        07990000
             WHEN TR251-REC-TYP-ARVDRD-CD-ARVDRD                        07991003
080000        PERFORM 8200-WRITE-DETAIL-RECORD                          08000000
080100                                                                  08010000
080200       WHEN TR251-ERROR-TYPE = 'EDI'                              08020000
080300        WRITE ERROR-REPORT-RECORD FROM HL-ERROR-HEADING-LINE      08030000
080400           AFTER ADVANCING 1 LINES                                08040000
080500        WRITE ERROR-REPORT-RECORD FROM EL-ERROR-DETAIL-LINE       08050000
080600           AFTER ADVANCING 1 LINES                                08060000
080700        ADD 2 TO PV-LINES-USED                                    08070000
080800        SET PS-NEW-PAGE-NO TO TRUE                                08080000
080900        MOVE TR251-REC-TYP-HDR-CDE TO  PV-REC-TYP-CDE-PREV        08090000
081000                                                                  08100000
081100       WHEN OTHER                                                 08110000
081200        PERFORM 8500-INVALID-RECORD-TYPE                          08120000
081300                                                                  08130000
081400     END-EVALUATE.                                                08140000
081500                                                                  08150000
081600******************************************************************08160000
081700*  PRINT DETAIL ERROR RECORD                                      08170000
081800******************************************************************08180000
081900                                                                  08190000
082000 8200-WRITE-DETAIL-RECORD.                                        08200000
082100                                                                  08210000
082200     IF TR251-REC-TYP-DPU-CDE = PV-REC-TYP-CDE-PREV AND           08220000
082300        PS-NEW-PAGE-NO                                            08230000
082400        CONTINUE                                                  08240000
082500     ELSE                                                         08250000
082600        WRITE ERROR-REPORT-RECORD FROM HL-D1-DETAIL-HEADER-1      08260000
082700           AFTER ADVANCING 2 LINES                                08270000
082800        WRITE ERROR-REPORT-RECORD FROM HL-D2-DETAIL-HEADER-2      08280000
082900           AFTER ADVANCING 1 LINES                                08290000
083000        ADD 3 TO PV-LINES-USED                                    08300000
083100     END-IF.                                                      08310000
083200                                                                  08320000
083300     WRITE ERROR-REPORT-RECORD FROM DL-D1-DETAIL-LINE             08330000
083400        AFTER ADVANCING 1 LINES.                                  08340000
083500     WRITE ERROR-REPORT-RECORD FROM HL-ERROR-HEADING-LINE         08350000
083600        AFTER ADVANCING 1 LINES.                                  08360000
083700     WRITE ERROR-REPORT-RECORD FROM EL-ERROR-DETAIL-LINE          08370000
083800        AFTER ADVANCING 1 LINES.                                  08380000
083900     ADD 3 TO PV-LINES-USED.                                      08390000
084000                                                                  08400000
084100     SET PS-NEW-PAGE-NO TO TRUE.                                  08410000
084200     MOVE TR251-REC-TYP-DPU-CDE TO  PV-REC-TYP-CDE-PREV.          08420000
084300                                                                  08430000
084400                                                                  08440000
084500******************************************************************08450000
084600* PRINT LINE WHEN RECORD TYPE INVALID                             08460000
084700******************************************************************08470000
084800                                                                  08480000
084900 8500-INVALID-RECORD-TYPE.                                        08490000
085000                                                                  08500000
085100     MOVE TR251-REC-TYP-HDR-CDE  TO INVALID-RECD-TYPE.            08510000
085200     MOVE TR251-TRN-TYP          TO INVALID-TRN-TYPE.             08520000
085300     MOVE TR251-DATA-IN-ERROR    TO INVALID-DATA-ERROR.           08530000
085400     MOVE TR251-DATA-VALUE-NUM   TO INVALID-DATA-VALUE.           08540000
085500     MOVE TR251-ERROR-TYPE       TO INVALID-DATA-TYPE.            08550000
085600     MOVE TR251-ERROR-MSG        TO INVALID-DATA-MSG.             08560000
085700                                                                  08570000
085800     IF TR251-REC-TYP-DPU-CDE = PV-REC-TYP-CDE-PREV AND           08580000
085900        PS-NEW-PAGE-NO                                            08590000
086000        CONTINUE                                                  08600000
086100     ELSE                                                         08610000
086200        WRITE ERROR-REPORT-RECORD FROM INVALID-HEADING-1          08620000
086300           AFTER ADVANCING 2 LINES                                08630000
086400                                                                  08640000
086500        WRITE ERROR-REPORT-RECORD FROM INVALID-HEADING-2          08650000
086600           AFTER ADVANCING 1 LINES                                08660000
086700                                                                  08670000
086800        ADD 3 TO PV-LINES-USED                                    08680000
086900                                                                  08690000
087000     END-IF.                                                      08700000
087100                                                                  08710000
087200     WRITE ERROR-REPORT-RECORD FROM INVALID-DETAIL-1              08720000
087300           AFTER ADVANCING 1 LINES.                               08730000
087400                                                                  08740000
087500     ADD 1 TO PV-LINES-USED.                                      08750000
087600     SET PS-NEW-PAGE-NO TO TRUE.                                  08760000
087700     MOVE TR251-REC-TYP-DPU-CDE TO  PV-REC-TYP-CDE-PREV.          08770000
087800                                                                  08780000
087900******************************************************************08790000
088000*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  08800000
088100*  THE CURSOR.                                                    08810000
088200******************************************************************08820000
088300 9000-EOJ-ROUTINE.                                                08830000
088400                                                                  08840000
088500     IF PS-DETAIL-NO                                              08850000
088600        WRITE ERROR-REPORT-RECORD FROM EP-EMPTY-REPORT-LINE       08860000
088700            AFTER ADVANCING 2 LINES                               08870000
088800                                                                  08880000
088900        WRITE ERROR-REPORT-RECORD FROM ER-END-OF-REPORT-LINE      08890000
089000            AFTER ADVANCING 2 LINES                               08900000
089100     ELSE                                                         08910000
089200        IF PV-LINES-USED > PC-PAGE-SIZE-060                       08920000
089300           PERFORM 8000-WRITE-PAGE-HEADINGS                       08930000
089400        END-IF                                                    08940000
089500                                                                  08950000
089600        WRITE ERROR-REPORT-RECORD FROM ER-END-OF-REPORT-LINE      08960000
089700            AFTER ADVANCING 2 LINES                               08970000
089800                                                                  08980000
089900        ADD 2 TO PV-LINES-USED                                    08990000
090000                                                                  09000000
090100        PERFORM                                                   09010000
090200           VARYING PV-LINES-USED FROM PV-LINES-USED BY 1          09020000
090300           UNTIL PV-LINES-USED > PC-PAGE-SIZE-060                 09030000
090400                                                                  09040000
090500           WRITE ERROR-REPORT-RECORD FROM PV-BLANK-LINE           09050000
090600              AFTER ADVANCING 1 LINE                              09060000
090700                                                                  09070000
090800        END-PERFORM                                               09080000
090900                                                                  09090000
091000        IF PV-LINES-USED > PC-PAGE-SIZE-060                       09100000
091100           WRITE ERROR-REPORT-RECORD FROM TRL-HEADING-LINE-1      09110000
091200              AFTER ADVANCING 2 LINES                             09120000
091300        END-IF                                                    09130000
091400     END-IF.                                                      09140000
091500                                                                  09150000
091600     CLOSE ERROR-FILE                                             09160000
091700           ERROR-REPORT-FILE.                                     09170000
