000100******************************************************************00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300 PROGRAM-ID.             RCKUT124.                                00030002
000400 AUTHOR.                 LARRY SCHLEICHER.                        00040002
000500 INSTALLATION.           KOHLS.                                   00050002
000600 DATE-WRITTEN            SEPTEMBER,2003.                          00060002
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900******************************************************************00090002
001000* THIS PROGRAM WILL DETERMINE IF AN ORDER IS READY FOR            00100002
001100* VERIFICATION.                                                   00110002
001200******************************************************************00120002
001300 ENVIRONMENT DIVISION.                                            00130002
001400 DATA DIVISION.                                                   00140002
001500******************************************************************00150002
001600 WORKING-STORAGE SECTION.                                         00160002
001700******************************************************************00170002
001800*                                                                 00180002
001900     COPY RCWS038.                                                00190002
002000*                                                                 00200002
002100     COPY RCWS289.                                                00210002
002200*                                                                 00220002
002300     COPY RCWS071.                                                00230002
002400*                                                                 00240002
002500*---------------------------------------------------------------* 00250002
002600*    LAYOUT FOR THE CALLED DATE ROUTINE - DPKUT500              * 00260002
002700*---------------------------------------------------------------* 00270002
002800     COPY DPWS500.                                                00280002
002900                                                                  00290002
003000 01  DK-DB2-KEYS.                                                 00300002
003100     05  DK-PO-NBR                       PIC S9(09) COMP SYNC.    00310002
003200     05  DK-RCVR-NBR                     PIC S9(09) COMP SYNC.    00320002
003300     05  DK-PREPK-ID                     PIC S9(04) COMP SYNC.    00330002
003400     05  DK-LINE-NBR                     PIC S9(09) COMP SYNC.    00340002
003500     05  DK-AUDIT-LINE                   PIC S9(04) COMP SYNC.    00350002
003600     05  DK-AUDIT-PREPACK                PIC S9(09) COMP SYNC.    00360002
003700     05  DK-OPER-UNT-ID                  PIC S9(04) COMP SYNC.    00370002
003800     05  DK-FCLTY-ID                     PIC S9(04) COMP SYNC.    00380002
003900     05  DK-STR-NBR                      PIC S9(04) COMP.         00390002
004000     05  DK-IN-PROCESS-STR-NBR           PIC S9(04) COMP.         00400002
004010     05  DK-WORK-DATE                    PIC X(10).               00401002
004020                                                                  00402002
004030 01  PC-PROGRAM-CONSTANTS.                                        00403002
004040     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00404002
004050                     '9999-09-09-09.09.09.999999'.                00405002
004060     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00406002
004070                     '9999-09-09'.                                00407002
004080     05  PC-DEFAULT-TIME              PIC X(26)  VALUE            00408002
004090                     '01.01.01'.                                  00409002
004100     05  PC-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00410002
004200                                                     COMP SYNC.   00420002
004300     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKUT124'. 00430002
004400     05  PC-TRAILER-UNLOAD            PIC X(08) VALUE 'RCKUT129'. 00440002
004500     05  PC-HOT-COMPLETE              PIC X(08) VALUE 'PCKCS161'. 00450002
004600     05  PC-CHECK-IN-VERIFY           PIC X(08) VALUE 'SUKCS764'. 00460002
004700     05  PC-CHECK-IN-START            PIC X(08) VALUE 'SUKRF502'. 00470002
004800     05  PC-SWEEPER                   PIC X(08) VALUE 'RCKCS291'. 00480002
004900     05  PC-CONFIRM-VERIFY            PIC X(08) VALUE 'RCKCS297'. 00490002
004910     05  PC-P2L-PCC-UPLOAD            PIC X(08) VALUE 'PCKCS722'. 00491002
004920     05  PC-P2L-AL-UPLOAD             PIC X(08) VALUE 'PCKCS766'. 00492002
004921     05  PC-PRINT-AND-APPLY           PIC X(08) VALUE 'SUKCS771'. 00492102
004922                                                                  00492202
004923 01  PS-PROGRAM-SWITCHES.                                         00492302
004924     05  PS-MORE-STORE-SW               PIC X(01)   VALUE 'N'.    00492402
004925         88  PS-MORE-STORE                          VALUE 'Y'.    00492502
004926         88  PS-NO-MORE-STORE                       VALUE 'N'.    00492602
004927     05  PS-CASEPACK-NOT-PERFORMED-SW   PIC X(01)   VALUE 'N'.    00492702
004928         88  PS-CASEPACK-NOT-PERFORMED              VALUE 'Y'.    00492802
004929         88  PS-CASEPACK-PERFORMED                  VALUE 'N'.    00492902
004930     05  PS-TDISTHD-UPDATED-SW          PIC X(01)   VALUE 'N'.    00493002
004940         88  PS-TDISTHD-UPDATED                     VALUE 'Y'.    00494002
004950         88  PS-TDISTHD-UPDATED-NO                  VALUE 'N'.    00495002
004960     05  PS-FIRST-TIME-SW               PIC X(01)   VALUE 'Y'.    00496002
004970         88  PS-FIRST-TIME                          VALUE 'Y'.    00497002
004980         88  PS-NOT-FIRST-TIME                      VALUE 'N'.    00498002
004990     05  PS-MORE-PACK-LINES-SW          PIC X(01)   VALUE 'N'.    00499002
005000         88  PS-MORE-PACK-LINES                     VALUE 'Y'.    00500002
005100         88  PS-NO-MORE-PACK-LINES                  VALUE 'N'.    00510002
005200     05  PS-MORE-DISTRO-SW              PIC X(01)   VALUE 'N'.    00520002
005300         88  PS-MORE-DISTRO                         VALUE 'Y'.    00530002
005400         88  PS-NO-MORE-DISTRO                      VALUE 'N'.    00540002
005500     05  PS-IN-TROUBLE-SW               PIC X(01)   VALUE 'N'.    00550002
005600         88  PS-IN-TROUBLE                          VALUE 'Y'.    00560002
005700         88  PS-NOT-IN-TROUBLE                      VALUE 'N'.    00570002
005800     05  PS-INVENTORY-CYCLE-SW          PIC X(01)   VALUE 'N'.    00580002
005900         88  PS-INVENTORY-CYCLE                     VALUE 'Y'.    00590002
006000         88  PS-NO-INVENTORY-CYCLE                  VALUE 'N'.    00600002
006100     05  PS-FREIGHT-BILL-FOUND-SW       PIC X(01)   VALUE 'N'.    00610002
006200         88  PS-FREIGHT-BILL-FOUND                  VALUE 'Y'.    00620002
006300         88  PS-NO-FREIGHT-BILL-FOUND               VALUE 'N'.    00630002
006400     05  PS-RECDIS-FOUND-SW             PIC X(01)   VALUE 'N'.    00640002
006500         88  PS-RECDIS-FOUND                        VALUE 'Y'.    00650002
006600         88  PS-NO-RECDIS-FOUND                     VALUE 'N'.    00660002
006700     05  PS-DISTHD-FOUND-SW             PIC X(01)   VALUE 'N'.    00670002
006800         88  PS-DISTHD-FOUND                        VALUE 'Y'.    00680002
006900         88  PS-NO-DISTHD-FOUND                     VALUE 'N'.    00690002
007000     05  PS-MORE-PACKS-SW               PIC X(01)   VALUE 'N'.    00700002
007100         88  PS-MORE-PACKS                          VALUE 'Y'.    00710002
007200         88  PS-NO-MORE-PACKS                       VALUE 'N'.    00720002
007300     05  PS-ACTIVE-RECEIVER-SW          PIC X(01)   VALUE 'N'.    00730002
007400         88  PS-ACTIVE-RECEIVER                     VALUE 'Y'.    00740002
007500         88  PS-NO-ACTIVE-RECEIVER                  VALUE 'N'.    00750002
007600     05  PS-ACTIVE-LINE-SW              PIC X(01)   VALUE 'N'.    00760002
007700         88  PS-ACTIVE-LINE                         VALUE 'Y'.    00770002
007800         88  PS-NO-ACTIVE-LINE                      VALUE 'N'.    00780002
007900     05  PS-OPEN-AUDITS-SW              PIC X(01)   VALUE 'N'.    00790002
008000         88  PS-OPEN-AUDITS                         VALUE 'Y'.    00800002
008100         88  PS-NO-OPEN-AUDITS                      VALUE 'N'.    00810002
008200     05  PS-STR-INV-CYCLE-SW            PIC X(01)   VALUE 'N'.    00820002
008300         88  PS-STR-IN-INV-CYCLE                    VALUE 'Y'.    00830002
008400         88  PS-STR-NOT-IN-INV-CYCLE                VALUE 'N'.    00840002
008500     05  PS-ERROR-SW                    PIC X(01)   VALUE 'Y'.    00850002
008600         88  PS-NO-ERROR                            VALUE 'Y'.    00860002
008700         88  PS-ERROR                               VALUE 'N'.    00870002
008800     05  PS-ARRIVED-SW                  PIC X(01)   VALUE 'Y'.    00880002
008900         88  PS-ARRIVED                             VALUE 'Y'.    00890002
009000         88  PS-NOT-ARRIVED                         VALUE 'N'.    00900002
009100     05  PS-UNITS-WORKED-ERROR-SW       PIC X(01)   VALUE 'N'.    00910002
009200         88  PS-UNITS-WORKED-ERROR                  VALUE 'Y'.    00920002
009300         88  PS-NO-UNITS-WORKED-ERROR               VALUE 'N'.    00930002
009400     05  PS-VERIFY-MODULE-SW            PIC X(01)   VALUE 'N'.    00940002
009500         88  PS-DONT-SUBMIT-E200                    VALUE 'N'.    00950002
009600         88  PS-DO-SUBMIT-E200                      VALUE 'Y'.    00960002
009700     05  PS-MORE-RECITM-SW              PIC X(01)   VALUE 'N'.    00970002
009800         88  PS-MORE-RECITM-YES                     VALUE 'Y'.    00980002
009900         88  PS-MORE-RECITM-NO                      VALUE 'N'.    00990002
010000     05  PS-RECITM-ODD-UNITS-SW         PIC X(01)   VALUE 'N'.    01000002
010100         88  PS-RECITM-ODD-UNITS-YES                VALUE 'Y'.    01010002
010200         88  PS-RECITM-ODD-UNITS-NO                 VALUE 'N'.    01020002
010300     05  PS-DISTDT-ODD-UNITS-SW         PIC X(01)   VALUE 'N'.    01030002
010400         88  PS-DISTDT-ODD-UNITS-YES                VALUE 'Y'.    01040002
010500         88  PS-DISTDT-ODD-UNITS-NO                 VALUE 'N'.    01050002
010600     05  PS-PHY-LABELS-USED-SW          PIC X(01)   VALUE 'N'.    01060002
010700         88  PS-PHY-LABELS-USED                     VALUE 'Y'.    01070002
010800         88  PS-PHY-LABELS-NOT-USED                 VALUE 'N'.    01080002
010900     05  PS-STR-INV-SW                  PIC X(01)   VALUE 'N'.    01090002
011000         88  PS-STR-IN-INV                          VALUE 'Y'.    01100002
011100         88  PS-STR-NOT-INV                         VALUE 'N'.    01110002
011200     05  PS-DC-FLUSH-SW                 PIC  X(01)  VALUE 'N'.    01120002
011300         88  PS-DC-FLUSH-YES                        VALUE 'Y'.    01130002
011400         88  PS-DC-FLUSH-NO                         VALUE 'N'.    01140002
011500                                                                  01150002
011600 01  PV-PROGRAM-VARIABLES.                                        01160002
011700     05  PV-PRCG-STAT-CDE               PIC X(01).                01170002
011800     05  PV-DB2-FREIGHT-COUNT           PIC S9(09)  VALUE ZEROS   01180002
011900                                                     COMP-3.      01190002
011910     05  PV-DB2-TROUBLE-COUNT           PIC S9(9)   VALUE +0      01191002
011920                                                    COMP-3.       01192002
011930     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      01193002
011940                                                    COMP-3.       01194002
011950     05  PV-OPEN-AUDIT-COUNT            PIC S9(9)   VALUE +0      01195002
011960                                                    COMP-3.       01196002
011970     05  PV-CHECK-IN-COUNT              PIC S9(9)   VALUE +0      01197002
011980                                                    COMP-3.       01198002
011990     05  PV-MANIFESTED-COUNT            PIC S9(9)   VALUE +0      01199002
012000                                                    COMP-3.       01200002
012100     05  PV-SMOOTHED-COUNT              PIC S9(9)   VALUE +0      01210002
012200                                                    COMP-3.       01220002
012300     05  PV-CURRENT-TIMESTAMP           PIC X(26)   VALUE         01230002
012400                                                       SPACES.    01240002
012500*                                                                 01250002
012600     05  PV-CURR-DATE                    PIC  X(10)  VALUE ZEROS. 01260002
012700     05  PV-CURRENT-DATE                 PIC  X(10)  VALUE ZEROS. 01270002
012800     05  FILLER   REDEFINES PV-CURRENT-DATE.                      01280002
012900         10  PV-CURRENT-CC               PIC  X(02).              01290002
013000         10  PV-CURRENT-YY               PIC  X(02).              01300002
013100         10  FILLER                      PIC  X(01).              01310002
013200         10  PV-CURRENT-MM               PIC  X(02).              01320002
013300         10  FILLER                      PIC  X(01).              01330002
013400         10  PV-CURRENT-DD               PIC  X(02).              01340002
013500     05  PV-HOLD-CURR-DATE.                                       01350002
013600         10  PV-HOLD-CURR-CC             PIC  9(02).              01360002
013700         10  PV-HOLD-CURR-YY             PIC  9(02).              01370002
013800         10  PV-HOLD-CURR-MM             PIC  9(02).              01380002
013900         10  PV-HOLD-CURR-DD             PIC  9(02).              01390002
014000     05  PV-WORK-DATE-PLUS-7             PIC  X(10)  VALUE ZEROS. 01400002
014100     05  PV-WORK-DATE                    PIC  X(10)  VALUE ZEROS. 01410002
014200     05  FILLER    REDEFINES PV-WORK-DATE.                        01420002
014300         10  PV-WORK-CC                  PIC  X(02).              01430002
014400         10  PV-WORK-YY                  PIC  X(02).              01440002
014500         10  FILLER                      PIC  X(01).              01450002
014600         10  PV-WORK-MM                  PIC  X(02).              01460002
014700         10  FILLER                      PIC  X(01).              01470002
014800         10  PV-WORK-DD                  PIC  X(02).              01480002
014900     05  PV-NEW-WORK-DATE                PIC  X(10)  VALUE ZEROS. 01490002
015000     05  FILLER    REDEFINES PV-NEW-WORK-DATE.                    01500002
015100         10  PV-NEW-WORK-CC              PIC  X(02).              01510002
015200         10  PV-NEW-WORK-YY              PIC  X(02).              01520002
015300         10  FILLER                      PIC  X(01).              01530002
015400         10  PV-NEW-WORK-MM              PIC  X(02).              01540002
015500         10  FILLER                      PIC  X(01).              01550002
015600         10  PV-NEW-WORK-DD              PIC  X(02).              01560002
015700     05  PV-HOLD-WORK-DATE.                                       01570002
015800         10  PV-HOLD-WORK-CC             PIC  9(02).              01580002
015900         10  PV-HOLD-WORK-YY             PIC  9(02).              01590002
016000         10  PV-HOLD-WORK-MM             PIC  9(02).              01600002
016100         10  PV-HOLD-WORK-DD             PIC  9(02).              01610002
016200     05  PV-NEW-HOLD-WORK-DATE.                                   01620002
016300         10  PV-NEW-HOLD-WORK-CC         PIC  9(02).              01630002
016400         10  PV-NEW-HOLD-WORK-YY         PIC  9(02).              01640002
016500         10  PV-NEW-HOLD-WORK-MM         PIC  9(02).              01650002
016600         10  PV-NEW-HOLD-WORK-DD         PIC  9(02).              01660002
016700     05  PV-NULL-IND                  PIC S9(04)  VALUE ZEROS     01670002
016800                                                  COMP SYNC.      01680002
016900     05  PV-RECITM-STATUS-CDE            PIC  X(02) VALUE SPACE.  01690002
017000     05  PV-STR-NULL-IND             PIC S9(04)  VALUE ZERO       01700002
017100                                                  COMP SYNC.      01710002
017200     05  PV-STATUS-COUNTERS.                                      01720002
017300         10 PV-FREIGHT-COUNT          PIC S9(04) VALUE ZERO       01730002
017400                                                    COMP SYNC.    01740002
017410         10 PV-TRBL-RCVR-COUNT        PIC S9(04) VALUE ZERO       01741002
017420                                                    COMP SYNC.    01742002
017430         10 PV-INVENTORY-COUNT        PIC S9(04) VALUE ZERO       01743002
017440                                                    COMP SYNC.    01744002
017450     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01745002
017460                                                     COMP SYNC.   01746002
017470     05  PV-CICS-RESP                    PIC S9(09)  VALUE ZEROS  01747002
017480                                                     COMP SYNC.   01748002
017490     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01749002
017500     05  PV-RCVR-SEQ-NBR                 PIC  S9(9) COMP.         01750002
017600     05  PV-DISPLAY-SQLCODE              PIC -Z(03) VALUE ZEROES. 01760002
017700     05  PV-DISPLAY-SQLCODE-2            PIC -Z(03) VALUE ZEROES. 01770002
017800     05  PV-DISP-PO-NBR                  PIC  9(09).              01780002
017900     05  PV-DISP-RCVR-NBR                PIC  9(04).              01790002
018000     05  PV-DISP-LINE-NBR                PIC  9(04).              01800002
018100     05  PV-DISP-PREPK-ID                PIC  9(04).              01810002
018200     05  PV-DISP-CICS-RESPONSE           PIC  9(09)  VALUE ZEROS. 01820002
018300     05  PV-DISP-OPER-UNT-ID             PIC  Z(04).              01830002
018400     05  PV-DISP-FCLTY-ID                PIC  9(04).              01840002
018500     05  PV-DISP-STR-NBR                 PIC  Z(04).              01850002
018600     05  PV-DISP-SHIPT-UNT-ID            PIC  9(18).              01860002
018700     05  PV-DISP-RCVR-SEQ-NBR            PIC  9(04).              01870002
018800     05  PV-DISP-TRN-TYP-CDE             PIC  X(02).              01880002
018900     05  PV-DISP-NO-VERFY-RSN            PIC  X(01).              01890002
019000     05  PV-PARA-NAME                    PIC  X(23).              01900002
019100                                                                  01910002
019200*---------------------------------------------------------------* 01920002
019300*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 01930002
019400*---------------------------------------------------------------* 01940002
019500     EXEC SQL                                                     01950002
019600         INCLUDE SUT00015                                         01960002
019700     END-EXEC.                                                    01970002
019800******************************************************************01980002
019900*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 01990002
020000******************************************************************02000002
020100     EXEC SQL                                                     02010002
020200          INCLUDE TKRPRPM                                         02020002
020300     END-EXEC.                                                    02030002
020400                                                                  02040002
020500*---------------------------------------------------------------* 02050002
020600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CARTON LOCATION    02060002
020700*  (TSHUNLO)                                                      02070002
020800*---------------------------------------------------------------* 02080002
020900     EXEC SQL                                                     02090002
021000         INCLUDE TSHUNLO                                          02100002
021100     END-EXEC.                                                    02110002
021200                                                                  02120002
021300*---------------------------------------------------------------* 02130002
021400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPT UNT UPC TABLE02140002
021500*  (TSHUUPC)                                                      02150002
021600*---------------------------------------------------------------* 02160002
021700     EXEC SQL                                                     02170002
021800         INCLUDE TSHUUPC                                          02180002
021900     END-EXEC.                                                    02190002
022000                                                                  02200002
022100*---------------------------------------------------------------* 02210002
022200     EXEC SQL                                                     02220002
022300         INCLUDE TSULBXF                                          02230002
022400     END-EXEC.                                                    02240002
022500*---------------------------------------------------------------* 02250002
022600     EXEC SQL                                                     02260002
022700         INCLUDE TPKSLIP                                          02270002
022800     END-EXEC.                                                    02280002
022900*---------------------------------------------------------------* 02290002
023000     EXEC SQL                                                     02300002
023100         INCLUDE TINPKSU                                          02310002
023200     END-EXEC.                                                    02320002
023300*---------------------------------------------------------------* 02330002
023400*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 02340002
023500*---------------------------------------------------------------* 02350002
023600     EXEC SQL                                                     02360002
023700          INCLUDE TRECDIS                                         02370002
023800     END-EXEC.                                                    02380002
023900*---------------------------------------------------------------* 02390002
024000*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 02400002
024100*---------------------------------------------------------------* 02410002
024200     EXEC SQL                                                     02420002
024300          INCLUDE TRECEIV                                         02430002
024400     END-EXEC.                                                    02440002
024500*---------------------------------------------------------------* 02450002
024600*    DB2 AREA FOR XLT_MDSE_INV_PARM-INVENTORY PARAMENTERS TABLE * 02460002
024700*---------------------------------------------------------------* 02470002
024800     EXEC SQL                                                     02480002
024900          INCLUDE XLT00025                                        02490002
025000     END-EXEC.                                                    02500002
025100*---------------------------------------------------------------* 02510002
025200*    DB2 AREA FOR TROUBLE NOTIFICATION TABLE                    * 02520002
025300*---------------------------------------------------------------* 02530002
025400     EXEC SQL                                                     02540002
025500          INCLUDE TTRBNTF                                         02550002
025600     END-EXEC.                                                    02560002
025700*---------------------------------------------------------------* 02570002
025800*    DB2 AREA FOR TROUBLE REASON TABLE                          * 02580002
025900*---------------------------------------------------------------* 02590002
026000     EXEC SQL                                                     02600002
026100          INCLUDE TTRBRSN                                         02610002
026200     END-EXEC.                                                    02620002
026300                                                                  02630002
026400*---------------------------------------------------------------* 02640002
026500*    DB2 AREA FOR TSHIPMT - SHIPMENT TABLE                      * 02650002
026600*---------------------------------------------------------------* 02660002
026700     EXEC SQL                                                     02670002
026800          INCLUDE TSHIPMT                                         02680002
026900     END-EXEC.                                                    02690002
027000/                                                                 02700002
027100*---------------------------------------------------------------* 02710002
027200*    DB2 AREA FOR TSHPTPO - SHIPMENT PO TABLE                   * 02720002
027300*---------------------------------------------------------------* 02730002
027400     EXEC SQL                                                     02740002
027500          INCLUDE TSHPTPO                                         02750002
027600     END-EXEC.                                                    02760002
027700                                                                  02770002
027800     EXEC SQL                                                     02780002
027900          INCLUDE TDISTDT                                         02790002
028000     END-EXEC.                                                    02800002
028100                                                                  02810002
028200     EXEC SQL                                                     02820002
028300          INCLUDE TDISTHD                                         02830002
028400     END-EXEC.                                                    02840002
028500                                                                  02850002
028600     EXEC SQL                                                     02860002
028700          INCLUDE TRECITM                                         02870002
028800     END-EXEC.                                                    02880002
028900*---------------------------------------------------------------* 02890002
029000*    DB2 AREA FOR OUTBOUND SHIPPING UPC TABLE                   * 02900002
029100*---------------------------------------------------------------* 02910002
029200     EXEC SQL                                                     02920002
029300          INCLUDE SUT00028                                        02930002
029400     END-EXEC.                                                    02940002
029500*---------------------------------------------------------------* 02950002
029600* DB2 AREA FOR THE OUBOUND SHIPPPING UNIT TABLE                   02960002
029700*---------------------------------------------------------------* 02970002
029800     EXEC SQL                                                     02980002
029900          INCLUDE SUT00024                                        02990002
030000     END-EXEC.                                                    03000002
030100                                                                  03010002
030200*---------------------------------------------------------------* 03020002
030300* DB2 AREA FOR THE DATE ATTRIBUTE TABLE                           03030002
030400*---------------------------------------------------------------* 03040002
030500     EXEC SQL                                                     03050002
030600          INCLUDE TDTATTR                                         03060002
030700     END-EXEC.                                                    03070002
030800                                                                  03080002
030900******************************************************************03090002
031000*  COMMUNICATIONS AREA FOR DB2                                    03100002
031100******************************************************************03110002
031200     EXEC SQL                                                     03120002
031300         INCLUDE SQLCA                                            03130002
031400     END-EXEC.                                                    03140002
031500                                                                  03150002
031600     EXEC SQL                                                     03160002
031700          DECLARE RECITM-CSR CURSOR                               03170002
031800          FOR SELECT DISTINCT                                     03180002
031900                 ORD_LNE_NBR                                      03190002
032000          FROM   TRECITM                                          03200002
032100          WHERE ORD_NBR          =  :DK-PO-NBR                    03210002
032200           AND  REC_SEQ_NBR      =  :DK-RCVR-NBR                  03220002
032300           AND  PREPK_ID         =  :DK-PREPK-ID                  03230002
032310       WITH UR                                                    03231002
032320     END-EXEC.                                                    03232002
032330                                                                  03233002
032340     EXEC SQL                                                     03234002
032350          DECLARE PBS-STORE-CSR CURSOR                            03235002
032360          FOR SELECT DISTINCT                                     03236002
032370                 A.STR_NBR                                        03237002
032380          FROM   TRECDIS A                                        03238002
032390             ,   TRECITM B                                        03239002
032400          WHERE A.ORD_NBR          =  :DK-PO-NBR                  03240002
032500           AND  A.ORD_NBR          =  B.ORD_NBR                   03250002
032600           AND  A.REC_SEQ_NBR      =  :DK-RCVR-NBR                03260002
032700           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               03270002
032800           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               03280002
033000          WITH UR                                                 03300002
033100     END-EXEC.                                                    03310002
033200                                                                  03320002
033300     EXEC SQL                                                     03330002
033400          DECLARE STORE-CSR CURSOR                                03340002
033500          FOR SELECT DISTINCT                                     03350002
033600                 A.STR_NBR                                        03360002
033700          FROM   TRECDIS A                                        03370002
033800             ,   TRECITM B                                        03380002
033900          WHERE A.ORD_NBR          =  :DK-PO-NBR                  03390002
034000           AND  A.ORD_NBR          =  B.ORD_NBR                   03400002
034100           AND  A.REC_SEQ_NBR      =  :DK-RCVR-NBR                03410002
034200           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               03420002
034300           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               03430002
034400           AND  B.ORD_LNE_NBR      = :DK-LINE-NBR                 03440002
034600          WITH UR                                                 03460002
034700     END-EXEC.                                                    03470002
034800                                                                  03480002
034810     EXEC SQL                                                     03481002
034820          DECLARE STORE-PRPK-CSR CURSOR                           03482002
034830          FOR SELECT DISTINCT                                     03483002
034840                 A.STR_NBR                                        03484002
034850          FROM   TRECDIS A                                        03485002
034860             ,   TRECITM B                                        03486002
034870          WHERE A.ORD_NBR          =  :DK-PO-NBR                  03487002
034880           AND  A.ORD_NBR          =  B.ORD_NBR                   03488002
034890           AND  A.REC_SEQ_NBR      =  :DK-RCVR-NBR                03489002
034891           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               03489102
034892           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               03489202
034893           AND  B.PREPK_ID         = :DK-PREPK-ID                 03489302
034895          WITH UR                                                 03489502
034896     END-EXEC.                                                    03489602
034897                                                                  03489702
034898     EXEC SQL                                                     03489802
034899         DECLARE STORE-MATCH-CSR CURSOR FOR                       03489902
034900          SELECT T1.STR_NBR                                       03490002
035000              ,  T2.STR_NBR                                       03500002
035100          FROM                                                    03510002
035200              (                                                   03520002
035300* 7/13/13 SELECT DISTINCT                                         03530002
035400          SELECT                                                  03540002
035500             A.STR_NBR                                            03550002
035600           FROM TDISTDT A                                         03560002
035700            ,   TRECITM B                                         03570002
035710            ,   TDISTHD C                                         03571002
035720           WHERE A.ORD_NBR            = :DK-PO-NBR                03572002
035730             AND A.ORD_NBR            = B.ORD_NBR                 03573002
035740             AND A.ORD_NBR            = C.ORD_NBR                 03574002
035750             AND A.RCVR_SEQ_NBR       = :DK-RCVR-NBR              03575002
035760             AND A.RCVR_SEQ_NBR       = B.REC_SEQ_NBR             03576002
035770             AND A.RCVR_SEQ_NBR       = C.RCVR_SEQ_NBR            03577002
035780             AND  B.ORD_LNE_NBR       = :DK-LINE-NBR              03578002
035790             AND A.ORD_LNE_NBR        = B.ORD_LNE_NBR             03579002
035800             AND A.ORD_LNE_NBR        = C.ORD_LNE_NBR             03580002
035900                                                                  03590002
036000           ) AS T1                                                03600002
036100                                                                  03610002
036200           LEFT OUTER JOIN                                        03620002
036300                                                                  03630002
036400           (                                                      03640002
036500            SELECT STR_NBR                                        03650002
036600          FROM TRECDIS                                            03660002
036700          WHERE ORD_NBR          =  :DK-PO-NBR                    03670002
036800           AND  REC_SEQ_NBR      =  :DK-RCVR-NBR                  03680002
036900           AND  ORD_LNE_NBR      =  :DK-LINE-NBR                  03690002
037100           ) AS T2                                                03710002
037200           ON                                                     03720002
037300             T1.STR_NBR = T2.STR_NBR                              03730002
037400        WITH UR                                                   03740002
037500     END-EXEC.                                                    03750002
037600                                                                  03760002
037700                                                                  03770002
037800                                                                  03780002
037900******************************************************************03790002
038000 LINKAGE SECTION.                                                 03800002
038100 01  DFHCOMMAREA.                                                 03810002
038200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03820002
038300                                      DEPENDING ON EIBCALEN.      03830002
038400         10  FILLER                   PIC X.                      03840002
038500******************************************************************03850002
038600 PROCEDURE DIVISION.                                              03860002
038700******************************************************************03870002
038800 0000-PROGRAM-MAINLINE.                                           03880002
038900     INITIALIZE PV-PROGRAM-VARIABLES                              03890002
039000                PS-PROGRAM-SWITCHES                               03900002
039100                RC038-FIELDS.                                     03910002
039200     MOVE DFHCOMMAREA              TO RC038-FIELDS.               03920002
039300     MOVE RC038-PO-NBR             TO DK-PO-NBR.                  03930002
039400     MOVE RC038-REC-SEQ-NBR        TO DK-RCVR-NBR.                03940002
039500     MOVE RC038-PO-LNE-NBR         TO DK-LINE-NBR.                03950002
039600     MOVE RC038-PREPACK-ID         TO DK-PREPK-ID.                03960002
039700     MOVE RC038-OPER-UNT-ID        TO DK-OPER-UNT-ID.             03970002
039800     MOVE RC038-FCLTY-ID           TO DK-FCLTY-ID.                03980002
039900     MOVE RC038-RCVR-OPER-UNT-ID   TO DK-STR-NBR.                 03990002
040000     SET PS-NO-ERROR TO TRUE.                                     04000002
040100     SET PS-CASEPACK-PERFORMED TO TRUE.                           04010002
040200     PERFORM 9300-CHECK-LOGGING.                                  04020002
040300                                                                  04030002
040400     IF KRPRPM-FUNC-TXT = 'Y'                                     04040002
040500         MOVE '0000-PROGRAM-MAINLINE '  TO PV-PARA-NAME           04050002
040600         PERFORM 9998-BUILD-MESSAGE                               04060002
040700     END-IF.                                                      04070002
040800                                                                  04080002
040900*    IF KRPRPM-FUNC-TXT = 'Y'                                     04090002
041000*         MOVE RC038-PO-NBR TO PV-DISP-PO-NBR                     04100002
041100*         MOVE RC038-REC-SEQ-NBR TO PV-DISP-RCVR-NBR              04110002
041200*         MOVE RC038-PO-LNE-NBR TO PV-DISP-LINE-NBR               04120002
041300*         STRING   ' RCKUT124 '                                   04130002
041400*                  ' CALLED BY-'                                  04140002
041500*                  RC038-PROGRAM-NAME                             04150002
041600*                  ' PO = '                                       04160002
041700*                  PV-DISP-PO-NBR '-'                             04170002
041800*                  PV-DISP-RCVR-NBR '-'                           04180002
041900*                  PV-DISP-LINE-NBR                               04190002
042000*                  DELIMITED BY SIZE                              04200002
042100*                                  INTO RC038-CRA-RET-MSG         04210002
042200*         PERFORM 9999-WRITE-TO-CSSL                              04220002
042300*     END-IF.                                                     04230002
042400                                                                  04240002
042500     EXEC SQL                                                     04250002
042600         SET :PV-CURR-DATE = CURRENT_DATE                         04260002
042700     END-EXEC.                                                    04270002
042800                                                                  04280002
042900     MOVE PV-CURR-DATE     TO PV-CURRENT-DATE.                    04290002
043000     MOVE PV-CURRENT-CC    TO PV-HOLD-CURR-CC.                    04300002
043100     MOVE PV-CURRENT-YY    TO PV-HOLD-CURR-YY.                    04310002
043200     MOVE PV-CURRENT-MM    TO PV-HOLD-CURR-MM.                    04320002
043300     MOVE PV-CURRENT-DD    TO PV-HOLD-CURR-DD.                    04330002
043400                                                                  04340002
043500     PERFORM 1000-CHECK-IF-ELIGIBLE.                              04350002
043600                                                                  04360002
043700     IF  PS-ERROR OR RC038-PROCESS-NO-UPDATE                      04370002
043800         CONTINUE                                                 04380002
043900     ELSE                                                         04390002
044000     IF  RC038-VERIFY-NO OR                                       04400002
044100         RC038-UNVERIFY                                           04410002
044200         IF RC038-PREPACK                                         04420002
044300             PERFORM 0050-PROCESS-PREPACK                         04430002
044400         ELSE                                                     04440002
044500             IF RC038-UNVERIFY                                    04450002
044600                 MOVE 'R'            TO PV-PRCG-STAT-CDE          04460002
044700                 PERFORM 9150-UPDATE-TDISTHD                      04470002
044800                 IF RC038-PROGRAM-NAME = PC-CONFIRM-VERIFY        04480002
044900                     CONTINUE                                     04490002
045000                 ELSE                                             04500002
045100                                                                  04510002
045200                     IF  KRPRPM-FUNC-TXT = 'Y'                    04520002
045300                         INITIALIZE PV-CICS-MSG-AREA              04530002
045400                         STRING   ' RCKUT124-8400-A'              04540002
045500                                  ' DISTHD-STATUS:'               04550002
045600                                    PV-PRCG-STAT-CDE              04560002
045700                                    DELIMITED BY SIZE             04570002
045710                                 INTO PV-CICS-MSG-AREA            04571002
045720                         MOVE LENGTH OF PV-CICS-MSG-AREA          04572002
045730                                  TO PV-COMMAREA-LENGTH           04573002
045740                                                                  04574002
045750                         EXEC CICS                                04575002
045760                              WRITEQ TD                           04576002
045770                               QUEUE   ('CSSL')                   04577002
045780                                FROM   (PV-CICS-MSG-AREA)         04578002
045790                              LENGTH   (PV-COMMAREA-LENGTH)       04579002
045791                                RESP   (PV-CICS-RESP)             04579102
045792                         END-EXEC                                 04579202
045793                     END-IF                                       04579302
045794                                                                  04579402
045795                     PERFORM 8400-TRACKING                        04579502
045796                 END-IF                                           04579602
045797                 IF SQLCODE = ZERO                                04579702
045798                     PERFORM 9200-UPDATE-TDISTDT                  04579802
045799                 END-IF                                           04579902
045800             ELSE                                                 04580002
045900                 IF PS-NO-DISTHD-FOUND                            04590002
046000                     CONTINUE                                     04600002
046100                 ELSE                                             04610002
046200                     SET PS-TDISTHD-UPDATED-NO TO TRUE            04620002
046300                     PERFORM 9100-UPDATE-TDISTHD                  04630002
046400                     IF PS-TDISTHD-UPDATED                        04640002
046500                         IF RC038-PROGRAM-NAME = PC-CONFIRM-VERIFY04650002
046600                             CONTINUE                             04660002
046700                         ELSE                                     04670002
046800                                                                  04680002
046900                             IF  KRPRPM-FUNC-TXT = 'Y'            04690002
047000                                 INITIALIZE PV-CICS-MSG-AREA      04700002
047100                                 STRING   ' RCKUT124-8400-B'      04710002
047200                                          ' DISTHD-STATUS:'       04720002
047210                                            PV-PRCG-STAT-CDE      04721002
047220                                            DELIMITED BY SIZE     04722002
047230                                         INTO PV-CICS-MSG-AREA    04723002
047240                                 MOVE LENGTH OF PV-CICS-MSG-AREA  04724002
047250                                          TO PV-COMMAREA-LENGTH   04725002
047260                                                                  04726002
047270                                 EXEC CICS                        04727002
047280                                      WRITEQ TD                   04728002
047290                                       QUEUE ('CSSL')             04729002
047291                                        FROM (PV-CICS-MSG-AREA)   04729102
047292                                      LENGTH (PV-COMMAREA-LENGTH) 04729202
047293                                        RESP (PV-CICS-RESP)       04729302
047294                                 END-EXEC                         04729402
047295                             END-IF                               04729502
047296                                                                  04729602
047297                             PERFORM 8400-TRACKING                04729702
047298                         END-IF                                   04729802
047299                     END-IF                                       04729902
047300                 END-IF                                           04730002
047400             END-IF                                               04740002
047500         END-IF                                                   04750002
047600     ELSE                                                         04760002
047700         IF PS-CASEPACK-NOT-PERFORMED                             04770002
047800             SET RC038-CASEPACK-NOT-PERFORMED TO TRUE             04780002
047900         END-IF                                                   04790002
048000     END-IF                                                       04800002
048100     END-IF.                                                      04810002
048200     MOVE RC038-FIELDS            TO DFHCOMMAREA.                 04820002
048300     GOBACK.                                                      04830002
048400                                                                  04840002
048500 0050-PROCESS-PREPACK.                                            04850002
048600     PERFORM 8220-OPEN-CURSOR.                                    04860002
048700     SET PS-FIRST-TIME  TO TRUE.                                  04870002
048800     PERFORM 8235-FETCH-CURSOR UNTIL                              04880002
048900             PS-NO-MORE-PACK-LINES.                               04890002
049000     PERFORM 8240-CLOSE-CURSOR.                                   04900002
049100                                                                  04910002
049200*----------------------------------------------------------------*04920002
049300 1000-CHECK-IF-ELIGIBLE.                                          04930002
049400*    IF KRPRPM-FUNC-TXT = 'Y'                                     04940002
049500*        MOVE '1000-CHECK-IF-ELIGIBLE'  TO PV-PARA-NAME           04950002
049600*        PERFORM 9998-BUILD-MESSAGE                               04960002
049700*    END-IF.                                                      04970002
049800                                                                  04980002
049900     SET PS-NO-ERROR  TO TRUE.                                    04990002
050000     IF RC038-PBS                                                 05000002
050100         IF RC038-PROCESS-NO-UPDATE                               05010002
050200            CONTINUE                                              05020002
050300         ELSE                                                     05030002
050400            PERFORM 9000-INSERT-DIST-HEADER                       05040002
050500         END-IF                                                   05050002
050600         PERFORM 8000-CHECK-FOR-TROUBLE                           05060002
050700         IF PS-IN-TROUBLE                                         05070002
050800             SET RC038-RECV-TROUBLE     TO TRUE                   05080002
050900         ELSE                                                     05090002
051000             IF RC038-UNVERIFY                                    05100002
051100                 PERFORM 8070-CHECK-FOR-TROUBLE                   05110002
051200             ELSE                                                 05120002
051300                 PERFORM 8050-CHECK-FOR-TROUBLE                   05130002
051400             END-IF                                               05140002
051500             IF PS-IN-TROUBLE                                     05150002
051600                 SET RC038-LINE-TROUBLE     TO TRUE               05160002
051700             END-IF                                               05170002
051800         END-IF                                                   05180002
051900                                                                  05190002
052000         IF PS-NOT-IN-TROUBLE AND                                 05200002
052100            PS-NO-ERROR                                           05210002
052200             PERFORM 8100-SELECT-FREIGHT-BILL                     05220002
052300                                                                  05230002
052400             IF (PS-FREIGHT-BILL-FOUND OR                         05240002
052500                RC038-DIRECT-STR) AND                             05250002
052600                PS-NO-ERROR                                       05260002
052700                 PERFORM 8200-SELECT-TRECEIV                      05270002
052800                 PERFORM 8210-COUNT-TRECEIV                       05280002
052900*                PERFORM 8250-SELECT-TRECITM                      05290002
053000                 PERFORM 8251-SELECT-TRECITM-PBS                  05300002
053100                                                                  05310002
053200                 IF PS-ACTIVE-RECEIVER AND                        05320002
053300                    PS-ACTIVE-LINE     AND                        05330002
053400                    PS-ARRIVED         AND                        05340002
053500                    PS-NO-ERROR                                   05350002
053600                     PERFORM 3000-PROCESS-STORE-CSR               05360002
053700                                                                  05370002
053800                     IF PS-STR-NOT-IN-INV-CYCLE AND               05380002
053900                        PS-NO-ERROR                               05390002
054000                         SET PS-NO-OPEN-AUDITS TO TRUE            05400002
054100                         IF RC038-AUTOVE-PO-YES                   05410002
054200                            PERFORM 8900-COUNT-OPEN-AUD-RCVR      05420002
054201**GB -CHECK FOR OPEN RFID AUDITS 04/2/14                          05420102
054210                            IF PS-NO-OPEN-AUDITS                  05421002
054220                               PERFORM 8910-COUNT-OPEN-RFID-AUD   05422002
054230                            END-IF                                05423002
054240**GB -CHECK FOR OPEN RFID AUDITS 04/2/14                          05424002
054300                            IF PS-OPEN-AUDITS                     05430002
054400                               SET RC038-OPEN-SYSTEM-AUDIT        05440002
054500                                                    TO TRUE       05450002
054600                            END-IF                                05460002
054700                         END-IF                                   05470002
054800                         IF PS-NO-OPEN-AUDITS AND                 05480002
054900                            PS-NO-ERROR                           05490002
055000                             PERFORM 8700-COUNT-CHECK-IN          05500002
055100* IN PBS LOGIC                                                    05510002
055200                             IF PV-CHECK-IN-COUNT > 0  AND        05520002
055300                                RC038-AUTOVE-PO-YES               05530002
055400                                 PERFORM 8740-COUNT-MANIFESTED-PBS05540002
055500                                                                  05550002
055600                                 IF PV-MANIFESTED-COUNT > 0       05560002
055700                                      SET RC038-VERIFY-NO         05570002
055800                                          RC038-NOT-MANIFESTD     05580002
055900                                                           TO TRUE05590002
056000                                 ELSE                             05600002
056100                                     SET RC038-VERIFY-YES  TO TRUE05610002
056200                                 END-IF                           05620002
056300                             ELSE                                 05630002
056400                                 SET RC038-VERIFY-YES  TO TRUE    05640002
056500                             END-IF                               05650002
056600                         ELSE                                     05660002
056700                             SET RC038-VERIFY-NO   TO TRUE        05670002
056800                             SET RC038-OPEN-SYSTEM-AUDIT TO TRUE  05680002
056900                         END-IF                                   05690002
057000                     ELSE                                         05700002
057100                         SET RC038-VERIFY-NO   TO TRUE            05710002
057200                         SET RC038-STORE-INVENTORY TO TRUE        05720002
057300                     END-IF                                       05730002
057400                 ELSE                                             05740002
057500                     SET RC038-VERIFY-NO   TO TRUE                05750002
057600                 END-IF                                           05760002
057700             ELSE                                                 05770002
057800                 SET RC038-VERIFY-NO   TO TRUE                    05780002
057900                 SET RC038-NO-PRO      TO TRUE                    05790002
058000             END-IF                                               05800002
058100         ELSE                                                     05810002
058200             SET RC038-VERIFY-NO   TO TRUE                        05820002
058300         END-IF                                                   05830002
058400     ELSE                                                         05840002
058500         SET PS-NO-OPEN-AUDITS TO TRUE                            05850002
058600         IF RC038-AUTOVE-PO-YES                                   05860002
058700            IF RC038-PROCESS-BY-RCVR                              05870002
058800               PERFORM 8900-COUNT-OPEN-AUD-RCVR                   05880002
058900            ELSE                                                  05890002
059000               PERFORM 8905-COUNT-OPEN-AUD-LINE                   05900002
059100            END-IF                                                05910002
059101**GB -CHECK FOR OPEN RFID AUDITS 04/2/14                          05910102
059102**GB -ONLY CHECK IF NO OPEN QC AUDITS                             05910202
059110            IF PS-NO-OPEN-AUDITS                                  05911002
059120               PERFORM 8910-COUNT-OPEN-RFID-AUD                   05912002
059130            END-IF                                                05913002
059140**GB -CHECK FOR OPEN RFID AUDITS 04/2/14                          05914002
059200            IF PS-OPEN-AUDITS                                     05920002
059300               SET RC038-OPEN-SYSTEM-AUDIT TO TRUE                05930002
059400            END-IF                                                05940002
059500         END-IF                                                   05950002
059600         IF PS-NO-OPEN-AUDITS AND PS-NO-ERROR                     05960002
059700            PERFORM 8000-CHECK-FOR-TROUBLE                        05970002
059800            IF PS-IN-TROUBLE                                      05980002
059900               SET RC038-RECV-TROUBLE     TO TRUE                 05990002
060000            ELSE                                                  06000002
060100               IF RC038-UNVERIFY                                  06010002
060200                   PERFORM 8070-CHECK-FOR-TROUBLE                 06020002
060300               ELSE                                               06030002
060400                   PERFORM 8050-CHECK-FOR-TROUBLE                 06040002
060500               END-IF                                             06050002
060600               IF PS-IN-TROUBLE                                   06060002
060700                   SET RC038-LINE-TROUBLE     TO TRUE             06070002
060800               END-IF                                             06080002
060900            END-IF                                                06090002
061000                                                                  06100002
061100             IF PS-NOT-IN-TROUBLE AND PS-NO-OPEN-AUDITS           06110002
061200                    AND PS-NO-ERROR                               06120002
061300                 PERFORM 8100-SELECT-FREIGHT-BILL                 06130002
061400                                                                  06140002
061500                 IF PS-FREIGHT-BILL-FOUND AND PS-NO-ERROR         06150002
061600                     PERFORM 8200-SELECT-TRECEIV                  06160002
061700                     PERFORM 8210-COUNT-TRECEIV                   06170002
061800                                                                  06180002
061900                     IF RC038-PREPACK                             06190002
062000                        PERFORM 2000-TRECITM-FOR-PACKS            06200002
062100                     ELSE                                         06210002
062200                        PERFORM 8250-SELECT-TRECITM               06220002
062300                     END-IF                                       06230002
062400                                                                  06240002
062500                     IF PS-ACTIVE-RECEIVER AND                    06250002
062600                        PS-ACTIVE-LINE     AND                    06260002
062700                        PS-ARRIVED         AND                    06270002
062800                        PS-NO-ERROR                               06280002
062900                                                                  06290002
063000                         IF PS-RECDIS-FOUND AND PS-NO-ERROR       06300002
063100                             PERFORM 3000-PROCESS-STORE-CSR       06310002
063200                                                                  06320002
063300                             IF PS-STR-NOT-IN-INV-CYCLE AND       06330002
063400                                PS-NO-ERROR                       06340002
063500                                 PERFORM 8700-COUNT-CHECK-IN      06350002
063600                                                                  06360002
063700                                 IF PV-CHECK-IN-COUNT > 0  AND    06370002
063800                                    RC038-AUTOVE-PO-YES           06380002
063900                                     PERFORM 8750-COUNT-MANIFESTED06390002
064000                                                                  06400002
064100                                     IF PV-MANIFESTED-COUNT > 0   06410002
064200                                      PERFORM 8751-CHK-FOR-PHY-LBL06420002
064300                                      IF PS-PHY-LABELS-USED       06430002
064400                                         SET RC038-VERIFY-YES     06440002
064500                                                     TO TRUE      06450002
064600                                      ELSE                        06460002
064700                                        SET RC038-VERIFY-NO       06470002
064800                                            RC038-NOT-MANIFESTD   06480002
064900                                                           TO TRUE06490002
065000                                      END-IF                      06500002
065100                                     ELSE                         06510002
065200                                       SET RC038-VERIFY-YES TO    06520002
065300                                                              TRUE06530002
065400                                     END-IF                       06540002
065500                                 ELSE                             06550002
065600                                     SET RC038-VERIFY-YES  TO TRUE06560002
065700                                 END-IF                           06570002
065800                             ELSE                                 06580002
065900                                SET RC038-VERIFY-NO   TO TRUE     06590002
066000                                SET RC038-STORE-INVENTORY TO TRUE 06600002
066100                             END-IF                               06610002
066200                         ELSE                                     06620002
066300                             SET RC038-VERIFY-NO   TO TRUE        06630002
066400                         END-IF                                   06640002
066500                     ELSE                                         06650002
066600                         SET RC038-VERIFY-NO   TO TRUE            06660002
066700                     END-IF                                       06670002
066800                 ELSE                                             06680002
066900                     SET RC038-VERIFY-NO   TO TRUE                06690002
067000                     SET RC038-NO-PRO      TO TRUE                06700002
067100                 END-IF                                           06710002
067200             ELSE                                                 06720002
067300                SET RC038-VERIFY-NO   TO TRUE                     06730002
067400             END-IF                                               06740002
067500         ELSE                                                     06750002
067600            SET RC038-VERIFY-NO   TO TRUE                         06760002
067700         END-IF                                                   06770002
067800     END-IF.                                                      06780002
067900     PERFORM 8600-SELECT-TDISTHD.                                 06790002
068000                                                                  06800002
068100 2000-TRECITM-FOR-PACKS.                                          06810002
068200*    IF KRPRPM-FUNC-TXT = 'Y'                                     06820002
068300*        MOVE '2000-TRECITM-FOR-PACKS'  TO PV-PARA-NAME           06830002
068400*        PERFORM 9998-BUILD-MESSAGE                               06840002
068500*    END-IF.                                                      06850002
068600                                                                  06860002
068700     PERFORM 8220-OPEN-CURSOR.                                    06870002
068800     PERFORM 8230-FETCH-CURSOR UNTIL                              06880002
068900             PS-NO-MORE-PACK-LINES OR                             06890002
069000             PS-NO-ACTIVE-LINE OR                                 06900002
069100             PS-ERROR.                                            06910002
069200     PERFORM 8240-CLOSE-CURSOR.                                   06920002
069300                                                                  06930002
069400 3000-PROCESS-STORE-CSR.                                          06940002
069500*    IF KRPRPM-FUNC-TXT = 'Y'                                     06950002
069600*        MOVE '3000-PROCESS-STORE-CSR'  TO PV-PARA-NAME           06960002
069700*        PERFORM 9998-BUILD-MESSAGE                               06970002
069800*    END-IF.                                                      06980002
069900                                                                  06990002
070000     SET PS-STR-NOT-IN-INV-CYCLE TO TRUE                          07000002
070100     SET PS-STR-NOT-INV          TO TRUE                          07010002
070200     PERFORM 3100A-CHK4-DC-FLUSH-PARM.                            07020002
070300     IF PS-DC-FLUSH-YES                                           07030002
070400         PERFORM 3100-CHECK-FOR-INV                               07040002
070500     END-IF                                                       07050002
070600                                                                  07060002
070700     IF PS-STR-IN-INV                                             07070002
070800        SET PS-MORE-STORE TO TRUE                                 07080002
070900        IF RC038-PBS   AND                                        07090002
071000           DK-LINE-NBR = 0                                        07100002
071100           PERFORM 8335-OPEN-CURSOR                               07110002
071200           PERFORM 8375-FETCH-CURSOR                              07120002
071300               UNTIL PS-NO-MORE-STORE                             07130002
071400               OR PS-STR-IN-INV-CYCLE                             07140002
071410               OR PS-ERROR                                        07141002
071420           PERFORM 8397-CLOSE-CURSOR                              07142002
071430        ELSE                                                      07143002
071440           IF RC038-PREPACK                                       07144002
071450              PERFORM 8340-OPEN-CURSOR                            07145002
071460              PERFORM 8370-FETCH-CURSOR                           07146002
071470                  UNTIL PS-NO-MORE-STORE                          07147002
071480                  OR PS-STR-IN-INV-CYCLE                          07148002
071490                  OR PS-ERROR                                     07149002
071491              PERFORM 8395-CLOSE-CURSOR                           07149102
071492           ELSE                                                   07149202
071493              PERFORM 8330-OPEN-CURSOR                            07149302
071494              PERFORM 8360-FETCH-CURSOR                           07149402
071495                  UNTIL PS-NO-MORE-STORE                          07149502
071496                  OR PS-STR-IN-INV-CYCLE                          07149602
071497                  OR PS-ERROR                                     07149702
071498              PERFORM 8390-CLOSE-CURSOR                           07149802
071499           END-IF                                                 07149902
071500        END-IF                                                    07150002
071600     END-IF.                                                      07160002
071700                                                                  07170002
071800*-----------------------------------------------------------------07180002
071900*  CHECK TKRPRPM TO SEE IF THE DC'S NEED TO BE FLUSHED.           07190002
072000*-----------------------------------------------------------------07200002
072100 3100A-CHK4-DC-FLUSH-PARM.                                        07210002
072101                                                                  07210102
072102     EXEC SQL                                                     07210202
072103          SELECT  FUNC_TXT                                        07210302
072104          INTO   :KRPRPM-FUNC-TXT                                 07210402
072105          FROM  TKRPRPM                                           07210502
072106          WHERE LOC_ID            =  90                           07210602
072107            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      07210702
072108            AND FUNC_PRC_STAT_CDE =  'AC'                         07210802
072109     END-EXEC.                                                    07210902
072110                                                                  07211002
072111     EVALUATE TRUE                                                07211102
072112         WHEN SQLCODE = +0                                        07211202
072113            IF KRPRPM-FUNC-TXT = 'N'                              07211302
072114                SET PS-DC-FLUSH-NO  TO TRUE                       07211402
072115            ELSE                                                  07211502
072116                SET PS-DC-FLUSH-YES TO TRUE                       07211602
072117            END-IF                                                07211702
072118         WHEN OTHER                                               07211802
072119                SET PS-DC-FLUSH-NO  TO TRUE                       07211902
072120     END-EVALUATE.                                                07212002
072121                                                                  07212102
072122*----------------------------------------------------------------*07212202
072123 3100-CHECK-FOR-INV.                                              07212302
072124                                                                  07212402
072125     EXEC SQL                                                     07212502
072126              SELECT  LOC_NBR                                     07212602
072127                INTO  :XLT00025-LOC-NBR                           07212702
072128                FROM  XLT_MDSE_INV_PARM                           07212802
072129               WHERE  DC_CTOFF_DTE    >= (CURRENT_DATE - 7 DAYS)  07212902
072130                AND   DC_CTOFF_DTE    <= (CURRENT_DATE + 7 DAYS)  07213002
072140                AND   ACTV_IND         = 'Y'                      07214002
072150                AND   LOC_INV_STAT_CDE = 'IN'                     07215002
072160     END-EXEC.                                                    07216002
072170                                                                  07217002
072180         EVALUATE TRUE                                            07218002
072190             WHEN SQLCODE = +0                                    07219002
072200             WHEN SQLCODE = -811                                  07220002
072300                SET  PS-STR-IN-INV                                07230002
072400                     PS-STR-NOT-IN-INV-CYCLE TO TRUE              07240002
072500             WHEN SQLCODE = +100                                  07250002
072510                SET  PS-STR-NOT-INV                               07251002
072511                     PS-STR-NOT-IN-INV-CYCLE TO TRUE              07251102
072512             WHEN SQLWARN0 NOT = SPACES                           07251202
072513             WHEN SQLCODE < ZERO                                  07251302
072514             WHEN SQLCODE > ZERO                                  07251402
072515                SET PS-ERROR                                      07251502
072516                    RC038-INVALID-SQL    TO TRUE                  07251602
072517                MOVE SQLCODE             TO PV-DISPLAY-SQLCODE    07251702
072518                MOVE DK-PO-NBR           TO PV-DISP-PO-NBR        07251802
072519                MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR      07251902
072520                MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID      07252002
072521                MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR      07252102
072522                STRING   ' RCKUT124-3100-'                        07252202
072523                         ' CALLED BY-'                            07252302
072524                         RC038-PROGRAM-NAME                       07252402
072525                         '  SQLCODE='                             07252502
072526                         PV-DISPLAY-SQLCODE                       07252602
072527                         ' PO '                                   07252702
072528                         PV-DISP-PO-NBR '-'                       07252802
072529                         PV-DISP-RCVR-NBR                         07252902
072530                         PV-DISP-LINE-NBR                         07253002
072531                         ' PACK '                                 07253102
072532                         PV-DISP-PREPK-ID                         07253202
072533                         DELIMITED BY SIZE                        07253302
072534                                         INTO RC038-CRA-RET-MSG   07253402
072535                PERFORM 9999-WRITE-TO-CSSL                        07253502
072536         END-EVALUATE.                                            07253602
072537                                                                  07253702
072538*----------------------------------------------------------------*07253802
072539 4000-PROCESS-CURSOR.                                             07253902
072540*    IF KRPRPM-FUNC-TXT = 'Y'                                     07254002
072550*        MOVE '4000-PROCESS-CURSOR'     TO PV-PARA-NAME           07255002
072551*        PERFORM 9998-BUILD-MESSAGE                               07255102
072552*    END-IF.                                                      07255202
072553                                                                  07255302
072554     SET PS-RECDIS-FOUND TO TRUE.                                 07255402
072555     PERFORM 8500-OPEN-CURSOR.                                    07255502
072556     PERFORM 8530-FETCH-CURSOR                                    07255602
072557         UNTIL PS-NO-MORE-DISTRO                                  07255702
072558         OR PS-NO-RECDIS-FOUND                                    07255802
072559         OR PS-ERROR.                                             07255902
072560     PERFORM 8560-CLOSE-CURSOR.                                   07256002
072570                                                                  07257002
072580 5000-PROCESS-DATES.                                              07258002
072590*    IF KRPRPM-FUNC-TXT = 'Y'                                     07259002
072600*        MOVE '5000-PROCESS-DATES '     TO PV-PARA-NAME           07260002
072700*        PERFORM 9998-BUILD-MESSAGE                               07270002
072800*    END-IF.                                                      07280002
072900                                                                  07290002
073000                                                                  07300002
073100     SET PS-STR-NOT-IN-INV-CYCLE TO TRUE.                         07310002
073200     MOVE XLT00025-DC-CTOFF-DTE TO PV-WORK-DATE.                  07320002
073300     MOVE PV-WORK-CC        TO PV-HOLD-WORK-CC.                   07330002
073400     MOVE PV-WORK-YY        TO PV-HOLD-WORK-YY.                   07340002
073500     MOVE PV-WORK-MM        TO PV-HOLD-WORK-MM.                   07350002
073600     MOVE PV-WORK-DD        TO PV-HOLD-WORK-DD.                   07360002
073700                                                                  07370002
073800     IF PV-HOLD-CURR-DATE < PV-HOLD-WORK-DATE  OR                 07380002
073900        PV-HOLD-CURR-DATE = PV-HOLD-WORK-DATE                     07390002
074000**** NOT IN INVENTORY CYCLE                                       07400002
074100        CONTINUE                                                  07410002
074200     ELSE                                                         07420002
074300         PERFORM 5010-GET-NEXT-DATE                               07430002
074400         IF PV-HOLD-CURR-DATE > PV-NEW-HOLD-WORK-DATE             07440002
074500**** NOT IN INVENTORY CYCLE                                       07450002
074600            CONTINUE                                              07460002
074700         ELSE                                                     07470002
074800**** IN INVENTORY CYCLE                                           07480002
074900             SET PS-STR-IN-INV-CYCLE TO TRUE                      07490002
075000             SET RC038-STORE-INVENTORY TO TRUE                    07500002
075100         END-IF                                                   07510002
075200     END-IF.                                                      07520002
075300                                                                  07530002
075400 5010-GET-NEXT-DATE.                                              07540002
075500                                                                  07550002
075510***  MOVE THE CUTOFF DATE TO A DK FIELD                           07551002
075520                                                                  07552002
075530     MOVE PV-WORK-DATE TO DK-WORK-DATE.                           07553002
075540                                                                  07554002
075550     EXEC SQL                                                     07555002
075560         SELECT                                                   07556002
075570                FSCL_WK_BEG_DTE                                   07557002
075580         INTO                                                     07558002
075590               :DTATTR-FSCL-WK-BEG-DTE                            07559002
075600         FROM   TDTATTR                                           07560002
075700         WHERE KY_DTE = DATE(:DK-WORK-DATE) + 7 DAYS              07570002
075800     END-EXEC.                                                    07580002
075900                                                                  07590002
076000     EVALUATE TRUE                                                07600002
076100         WHEN SQLCODE = 0                                         07610002
076200              MOVE DTATTR-FSCL-WK-BEG-DTE TO PV-NEW-WORK-DATE     07620002
076300              MOVE PV-NEW-WORK-CC TO PV-NEW-HOLD-WORK-CC          07630002
076400              MOVE PV-NEW-WORK-YY TO PV-NEW-HOLD-WORK-YY          07640002
076500              MOVE PV-NEW-WORK-MM TO PV-NEW-HOLD-WORK-MM          07650002
076600              MOVE PV-NEW-WORK-DD TO PV-NEW-HOLD-WORK-DD          07660002
076700         WHEN SQLWARN NOT = SPACE                                 07670002
076800         WHEN SQLCODE NOT = ZERO                                  07680002
076900             SET PS-ERROR                                         07690002
077000                 RC038-INVALID-SQL    TO TRUE                     07700002
077100             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       07710002
077200             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           07720002
077300             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         07730002
077310             STRING   ' RCKUT124-5010-'                           07731002
077320                      ' CALLED BY-'                               07732002
077321                      RC038-PROGRAM-NAME                          07732102
077322                      '  SQLCODE='                                07732202
077323                      PV-DISPLAY-SQLCODE                          07732302
077324                      ' PO = '                                    07732402
077325                      PV-DISP-PO-NBR '-'                          07732502
077326                      PV-DISP-RCVR-NBR                            07732602
077327                      DELIMITED BY SIZE                           07732702
077328                                      INTO RC038-CRA-RET-MSG      07732802
077329             PERFORM 9999-WRITE-TO-CSSL                           07732902
077330     END-EVALUATE.                                                07733002
077331*                                                                 07733102
077332                                                                  07733202
077333 8000-CHECK-FOR-TROUBLE.                                          07733302
077334*    IF KRPRPM-FUNC-TXT = 'Y'                                     07733402
077335*        MOVE '8000-CHECK-FOR-TROUBLE'  TO PV-PARA-NAME           07733502
077336*        PERFORM 9998-BUILD-MESSAGE                               07733602
077337*    END-IF.                                                      07733702
077338                                                                  07733802
077339                                                                  07733902
077340     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        07734002
077341                                                                  07734102
077342     EXEC SQL                                                     07734202
077343          SELECT COUNT(*)                                         07734302
077344          INTO  :PV-DB2-TROUBLE-COUNT :PV-NULL-IND                07734402
077345          FROM   TTRBNTF A                                        07734502
077346                ,TTRBRSN B                                        07734602
077347          WHERE  A.PO_NBR           =  :DK-PO-NBR                 07734702
077348          AND    A.REC_SEQ_NBR      =  :DK-RCVR-NBR               07734802
077349          AND    A.PO_LNE_NBR       =  0                          07734902
077350          AND    A.PREPK_ID         =  0                          07735002
077360          AND    A.RESOLVED_IND    IN  ('N', 'I', 'R')            07736002
077370          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             07737002
077380          AND    B.NOTIF_IND        =  'T'                        07738002
077390     END-EXEC.                                                    07739002
077400                                                                  07740002
077500     EVALUATE TRUE                                                07750002
077600         WHEN SQLCODE = ZERO                                      07760002
077700         WHEN SQLCODE = +100                                      07770002
077800              CONTINUE                                            07780002
077900         WHEN SQLWARN0 NOT = SPACE                                07790002
078000         WHEN SQLCODE NOT = ZERO                                  07800002
078100             SET PS-ERROR                                         07810002
078200                 RC038-INVALID-SQL    TO TRUE                     07820002
078300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       07830002
078400             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           07840002
078500             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         07850002
078600             STRING   ' RCKUT124-8000-'                           07860002
078700                      ' CALLED BY-'                               07870002
078800                      RC038-PROGRAM-NAME                          07880002
078900                      '  SQLCODE='                                07890002
079000                      PV-DISPLAY-SQLCODE                          07900002
079100                      ' PO = '                                    07910002
079200                      PV-DISP-PO-NBR '-'                          07920002
079300                      PV-DISP-RCVR-NBR                            07930002
079400                      DELIMITED BY SIZE                           07940002
079500                                      INTO RC038-CRA-RET-MSG      07950002
079600             PERFORM 9999-WRITE-TO-CSSL                           07960002
079700     END-EVALUATE.                                                07970002
079800     IF PV-NULL-IND = -1                                          07980002
079900         MOVE ZERO             TO PV-DB2-TROUBLE-COUNT            07990002
080000     END-IF.                                                      08000002
080100                                                                  08010002
080200     IF  PV-DB2-TROUBLE-COUNT EQUAL ZERO                          08020002
080300         SET PS-NOT-IN-TROUBLE TO  TRUE                           08030002
080400     ELSE                                                         08040002
080500         SET PS-IN-TROUBLE     TO  TRUE                           08050002
080600     END-IF.                                                      08060002
080700                                                                  08070002
080800 8050-CHECK-FOR-TROUBLE.                                          08080002
080900*    IF KRPRPM-FUNC-TXT = 'Y'                                     08090002
081000*        MOVE '8050-CHECK-FOR-TROUBLE'  TO PV-PARA-NAME           08100002
081100*        PERFORM 9998-BUILD-MESSAGE                               08110002
081200*    END-IF.                                                      08120002
081300                                                                  08130002
081400                                                                  08140002
081500     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        08150002
081600                                                                  08160002
081700     EXEC SQL                                                     08170002
081800          SELECT COUNT(*)                                         08180002
081900          INTO  :PV-DB2-TROUBLE-COUNT :PV-NULL-IND                08190002
082000          FROM   TTRBNTF A                                        08200002
082100                ,TTRBRSN B                                        08210002
082200          WHERE  A.PO_NBR           =  :DK-PO-NBR                 08220002
082300          AND    A.REC_SEQ_NBR      =  :DK-RCVR-NBR               08230002
082400          AND  ((A.PO_LNE_NBR       >  0                          08240002
082500          AND    B.TRBL_LVL_IND     <>  'M')                      08250002
082600           OR   (A.PREPK_ID         >  0                          08260002
082700          AND    B.TRBL_LVL_IND     =  'M'))                      08270002
082800          AND    A.RESOLVED_IND    IN  ('N','I','R')              08280002
082900          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             08290002
083000          AND    B.NOTIF_IND        =  'T'                        08300002
083100     END-EXEC.                                                    08310002
083200                                                                  08320002
083300     EVALUATE TRUE                                                08330002
083400         WHEN SQLCODE = ZERO                                      08340002
083500         WHEN SQLCODE = +100                                      08350002
083600              CONTINUE                                            08360002
083700         WHEN SQLWARN0 NOT = SPACE                                08370002
083800         WHEN SQLCODE NOT = ZERO                                  08380002
083900             SET PS-ERROR                                         08390002
084000                 RC038-INVALID-SQL    TO TRUE                     08400002
084100             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       08410002
084200             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           08420002
084300             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         08430002
084400             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         08440002
084500             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         08450002
084600             STRING   ' RCKUT124-8050-'                           08460002
084700                      ' CALLED BY-'                               08470002
084800                      RC038-PROGRAM-NAME                          08480002
084900                      '  SQLCODE='                                08490002
085000                      PV-DISPLAY-SQLCODE                          08500002
085100                      ' PO '                                      08510002
085200                      PV-DISP-PO-NBR '-'                          08520002
085300                      PV-DISP-RCVR-NBR                            08530002
085400                      PV-DISP-LINE-NBR                            08540002
085500                      ' PACK '                                    08550002
085600                      PV-DISP-PREPK-ID                            08560002
085700                      DELIMITED BY SIZE                           08570002
085800                                      INTO RC038-CRA-RET-MSG      08580002
085900             PERFORM 9999-WRITE-TO-CSSL                           08590002
086000     END-EVALUATE.                                                08600002
086100                                                                  08610002
086200     IF PV-NULL-IND = -1                                          08620002
086300         MOVE ZERO             TO PV-DB2-TROUBLE-COUNT            08630002
086400     END-IF.                                                      08640002
086500                                                                  08650002
086600     IF  PV-DB2-TROUBLE-COUNT EQUAL ZERO                          08660002
086700         CONTINUE                                                 08670002
086800     ELSE                                                         08680002
086900         SET PS-IN-TROUBLE     TO  TRUE                           08690002
087000     END-IF.                                                      08700002
087100                                                                  08710002
087200 8070-CHECK-FOR-TROUBLE.                                          08720002
087300*    IF KRPRPM-FUNC-TXT = 'Y'                                     08730002
087400*        MOVE '8070-CHECK-FOR-TROUBLE'  TO PV-PARA-NAME           08740002
087500*        PERFORM 9998-BUILD-MESSAGE                               08750002
087600*    END-IF.                                                      08760002
087700                                                                  08770002
087800                                                                  08780002
087900     MOVE ZERO                   TO  PV-DB2-TROUBLE-COUNT.        08790002
088000                                                                  08800002
088100     EXEC SQL                                                     08810002
088200          SELECT COUNT(*)                                         08820002
088300          INTO  :PV-DB2-TROUBLE-COUNT :PV-NULL-IND                08830002
088400          FROM   TTRBNTF A                                        08840002
088500                ,TTRBRSN B                                        08850002
088600          WHERE  A.PO_NBR           =  :DK-PO-NBR                 08860002
088700          AND    A.REC_SEQ_NBR      =  :DK-RCVR-NBR               08870002
088800          AND    A.TRBL_RSN_CDE     <>  375                       08880002
088900          AND  ((A.PO_LNE_NBR       >  0                          08890002
089000          AND    B.TRBL_LVL_IND     <>  'M')                      08900002
089100           OR   (A.PREPK_ID         >  0                          08910002
089200          AND    B.TRBL_LVL_IND     =  'M'))                      08920002
089300          AND    A.RESOLVED_IND    IN  ('N','I','R')              08930002
089400          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             08940002
089500          AND    B.NOTIF_IND        =  'T'                        08950002
089600     END-EXEC.                                                    08960002
089700                                                                  08970002
089800     EVALUATE TRUE                                                08980002
089900         WHEN SQLCODE = ZERO                                      08990002
090000         WHEN SQLCODE = +100                                      09000002
090100              CONTINUE                                            09010002
090200         WHEN SQLWARN0 NOT = SPACE                                09020002
090300         WHEN SQLCODE NOT = ZERO                                  09030002
090400             SET PS-ERROR                                         09040002
090500                 RC038-INVALID-SQL    TO TRUE                     09050002
090600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       09060002
090700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           09070002
090800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         09080002
090900             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         09090002
091000             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         09100002
091100             STRING   ' RCKUT124-8070-'                           09110002
091200                      ' CALLED BY-'                               09120002
091300                      RC038-PROGRAM-NAME                          09130002
091400                      '  SQLCODE='                                09140002
091500                      PV-DISPLAY-SQLCODE                          09150002
091600                      ' PO '                                      09160002
091700                      PV-DISP-PO-NBR '-'                          09170002
091800                      PV-DISP-RCVR-NBR                            09180002
091900                      PV-DISP-LINE-NBR                            09190002
092000                      ' PACK '                                    09200002
092100                      PV-DISP-PREPK-ID                            09210002
092200                      DELIMITED BY SIZE                           09220002
092300                                      INTO RC038-CRA-RET-MSG      09230002
092400             PERFORM 9999-WRITE-TO-CSSL                           09240002
092500     END-EVALUATE.                                                09250002
092600                                                                  09260002
092700     IF PV-NULL-IND = -1                                          09270002
092800         MOVE ZERO             TO PV-DB2-TROUBLE-COUNT            09280002
092900     END-IF.                                                      09290002
093000                                                                  09300002
093100     IF  PV-DB2-TROUBLE-COUNT EQUAL ZERO                          09310002
093200         CONTINUE                                                 09320002
093300     ELSE                                                         09330002
093400         SET PS-IN-TROUBLE     TO  TRUE                           09340002
093500     END-IF.                                                      09350002
093600                                                                  09360002
093700 8100-SELECT-FREIGHT-BILL.                                        09370002
093800*    IF KRPRPM-FUNC-TXT = 'Y'                                     09380002
093900*        MOVE '8100-SELECT-FREIGHT-BILL' TO PV-PARA-NAME          09390002
094000*        PERFORM 9998-BUILD-MESSAGE                               09400002
094100*    END-IF.                                                      09410002
094200                                                                  09420002
094300                                                                  09430002
094400     INITIALIZE PV-DB2-FREIGHT-COUNT.                             09440002
094500                                                                  09450002
094600     EXEC SQL                                                     09460002
094700          SELECT COUNT(*)                                         09470002
094800            INTO :PV-DB2-FREIGHT-COUNT                            09480002
094900            FROM TSHIPMT A,                                       09490002
095000                 TSHPTPO B                                        09500002
095100           WHERE B.PO_NBR      = :DK-PO-NBR                       09510002
095200             AND B.REC_SEQ_NBR = :DK-RCVR-NBR                     09520002
095300             AND A.SHIPT_ID    = B.SHIPT_ID                       09530002
095400             AND NOT A.PRO_NBR = ' '                              09540002
095500     END-EXEC.                                                    09550002
095600                                                                  09560002
095700     EVALUATE TRUE                                                09570002
095800         WHEN SQLCODE = +0                                        09580002
095900              IF PV-DB2-FREIGHT-COUNT > 0                         09590002
096000                 SET PS-FREIGHT-BILL-FOUND TO TRUE                09600002
096100              ELSE                                                09610002
096200                 SET PS-NO-FREIGHT-BILL-FOUND TO TRUE             09620002
096300              END-IF                                              09630002
096400         WHEN SQLCODE = +100                                      09640002
096500              SET PS-NO-FREIGHT-BILL-FOUND  TO TRUE               09650002
096600                                                                  09660002
096700         WHEN SQLWARN0 NOT = SPACE                                09670002
096800         WHEN SQLCODE NOT = ZERO                                  09680002
096900             SET PS-ERROR                                         09690002
097000                 RC038-INVALID-SQL    TO TRUE                     09700002
097100             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       09710002
097200             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           09720002
097300             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         09730002
097400             STRING   ' RCKUT124-8100-'                           09740002
097500                      ' CALLED BY-'                               09750002
097600                      RC038-PROGRAM-NAME                          09760002
097700                      '  SQLCODE='                                09770002
097800                      PV-DISPLAY-SQLCODE                          09780002
097900                      ' PO = '                                    09790002
098000                      PV-DISP-PO-NBR '-'                          09800002
098100                      PV-DISP-RCVR-NBR                            09810002
098200                      DELIMITED BY SIZE                           09820002
098300                                      INTO RC038-CRA-RET-MSG      09830002
098400             PERFORM 9999-WRITE-TO-CSSL                           09840002
098500     END-EVALUATE.                                                09850002
098600                                                                  09860002
098700 8200-SELECT-TRECEIV.                                             09870002
098800*    IF KRPRPM-FUNC-TXT = 'Y'                                     09880002
098900*        MOVE '8200-SELECT-TRECEIV'      TO PV-PARA-NAME          09890002
099000*        PERFORM 9998-BUILD-MESSAGE                               09900002
099100*    END-IF.                                                      09910002
099200                                                                  09920002
099300     EXEC SQL                                                     09930002
099400          SELECT                                                  09940002
099500                 STATUS_CDE                                       09950002
099600             ,   VER_STATUS_CDE                                   09960002
099700           INTO                                                   09970002
099800                :RECEIV-STATUS-CDE                                09980002
099900             ,  :RECEIV-VER-STATUS-CDE                            09990002
100000          FROM  TRECEIV                                           10000002
100100          WHERE  ORD_NBR          =  :DK-PO-NBR                   10010002
100200          AND    REC_SEQ_NBR      =  :DK-RCVR-NBR                 10020002
100300     END-EXEC.                                                    10030002
100400                                                                  10040002
100500     EVALUATE TRUE                                                10050002
100600         WHEN SQLCODE = ZERO                                      10060002
100700              IF RECEIV-VER-STATUS-CDE NOT = 'A'                  10070002
100800                  SET RC038-RCVR-NOT-ACTIVE TO TRUE               10080002
100900                  SET PS-NO-ACTIVE-RECEIVER TO TRUE               10090002
101000              ELSE                                                10100002
101100                  IF RECEIV-STATUS-CDE = 'VE'                     10110002
101200                      IF RC038-VERIFY                             10120002
101300                          SET RC038-RECEIVER-ALREADY-VE TO TRUE   10130002
101400                          SET PS-NO-ACTIVE-RECEIVER     TO TRUE   10140002
101500                      ELSE                                        10150002
101600                          SET PS-ACTIVE-RECEIVER     TO TRUE      10160002
101700                      END-IF                                      10170002
101800                  ELSE                                            10180002
101900                      SET PS-ACTIVE-RECEIVER     TO TRUE          10190002
102000                  END-IF                                          10200002
102100              END-IF                                              10210002
102200         WHEN SQLCODE = +100                                      10220002
102300              SET RC038-RCVR-NOT-FOUND   TO TRUE                  10230002
102400         WHEN SQLWARN0 NOT = SPACE                                10240002
102500         WHEN SQLCODE NOT = ZERO                                  10250002
102600             SET PS-ERROR                                         10260002
102700                 RC038-INVALID-SQL    TO TRUE                     10270002
102800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       10280002
102900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           10290002
103000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         10300002
103100             STRING   ' RCKUT124-8200-'                           10310002
103200                      ' CALLED BY-'                               10320002
103300                      RC038-PROGRAM-NAME                          10330002
103400                      '  SQLCODE='                                10340002
103500                      PV-DISPLAY-SQLCODE                          10350002
103600                      ' PO = '                                    10360002
103700                      PV-DISP-PO-NBR '-'                          10370002
103800                      PV-DISP-RCVR-NBR                            10380002
103900                      DELIMITED BY SIZE                           10390002
104000                                      INTO RC038-CRA-RET-MSG      10400002
104100             PERFORM 9999-WRITE-TO-CSSL                           10410002
104200     END-EVALUATE.                                                10420002
104300                                                                  10430002
104400 8210-COUNT-TRECEIV.                                              10440002
104500*    IF KRPRPM-FUNC-TXT = 'Y'                                     10450002
104600*        MOVE '8210-COUNT-TRECEIV '      TO PV-PARA-NAME          10460002
104700*        PERFORM 9998-BUILD-MESSAGE                               10470002
104800*    END-IF.                                                      10480002
104900                                                                  10490002
105000                                                                  10500002
105100     MOVE 0              TO PV-DB2-COUNT.                         10510002
105200                                                                  10520002
105300     EXEC SQL                                                     10530002
105400          SELECT COUNT(*)                                         10540002
105500            INTO :PV-DB2-COUNT :PV-NULL-IND                       10550002
105600            FROM TRECEIV                                          10560002
105700           WHERE ORD_NBR        = :DK-PO-NBR                      10570002
105800             AND REC_SEQ_NBR    = :DK-RCVR-NBR                    10580002
105900             AND VER_STATUS_CDE = 'A'                             10590002
106000             AND REC_TMST       = :PC-DEFAULT-TMST                10600002
106100     END-EXEC.                                                    10610002
106200                                                                  10620002
106300     EVALUATE TRUE                                                10630002
106400         WHEN SQLCODE = +0                                        10640002
106500         WHEN SQLCODE = +100                                      10650002
106600             IF PV-DB2-COUNT > ZERO                               10660002
106700                 SET PS-NOT-ARRIVED TO TRUE                       10670002
106800                 SET RC038-NOT-ARRIVED TO TRUE                    10680002
106900             ELSE                                                 10690002
107000                 SET PS-ARRIVED     TO TRUE                       10700002
107100             END-IF                                               10710002
107200         WHEN SQLWARN0 NOT = SPACES                               10720002
107300         WHEN SQLCODE < +0                                        10730002
107400         WHEN SQLCODE > +0                                        10740002
107500             SET PS-ERROR                                         10750002
107600                 RC038-INVALID-SQL    TO TRUE                     10760002
107700             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       10770002
107800             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           10780002
107900             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         10790002
108000             STRING   ' RCKUT124-8210-'                           10800002
108100                      ' CALLED BY-'                               10810002
108200                      RC038-PROGRAM-NAME                          10820002
108300                      '  SQLCODE='                                10830002
108400                      PV-DISPLAY-SQLCODE                          10840002
108500                      ' PO = '                                    10850002
108600                      PV-DISP-PO-NBR '-'                          10860002
108700                      PV-DISP-RCVR-NBR                            10870002
108800                      DELIMITED BY SIZE                           10880002
108900                                      INTO RC038-CRA-RET-MSG      10890002
109000             PERFORM 9999-WRITE-TO-CSSL                           10900002
109100     END-EVALUATE.                                                10910002
109200                                                                  10920002
109300                                                                  10930002
109400 8220-OPEN-CURSOR.                                                10940002
109500*    IF KRPRPM-FUNC-TXT = 'Y'                                     10950002
109600*        MOVE '8220-OPEN-CURSOR   '      TO PV-PARA-NAME          10960002
109700*        PERFORM 9998-BUILD-MESSAGE                               10970002
109800*    END-IF.                                                      10980002
109900                                                                  10990002
110000     EXEC SQL                                                     11000002
110100         OPEN RECITM-CSR                                          11010002
110200     END-EXEC.                                                    11020002
110300                                                                  11030002
110400     EVALUATE TRUE                                                11040002
110500         WHEN SQLCODE = ZERO                                      11050002
110600             SET PS-MORE-PACK-LINES TO TRUE                       11060002
110700                                                                  11070002
110800         WHEN SQLWARN0 NOT = SPACE                                11080002
110900         WHEN SQLCODE  NOT = ZERO                                 11090002
111000             SET PS-ERROR                                         11100002
111100                 RC038-INVALID-SQL    TO TRUE                     11110002
111200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       11120002
111300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           11130002
111400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         11140002
111500             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      11150002
111600             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         11160002
111700             STRING   ' RCKUT124-8220-'                           11170002
111800                      ' CALLED BY-'                               11180002
111900                      RC038-PROGRAM-NAME                          11190002
112000                      '  SQLCODE='                                11200002
112100                      PV-DISPLAY-SQLCODE                          11210002
112200                      ' PO = '                                    11220002
112300                      PV-DISP-OPER-UNT-ID '-'                     11230002
112400                      PV-DISP-PO-NBR '-'                          11240002
112500                      PV-DISP-RCVR-NBR                            11250002
112600                      ' PACK  = '                                 11260002
112700                      PV-DISP-PREPK-ID                            11270002
112800                      DELIMITED BY SIZE                           11280002
112900                                      INTO RC038-CRA-RET-MSG      11290002
113000             PERFORM 9999-WRITE-TO-CSSL                           11300002
113100     END-EVALUATE.                                                11310002
113200                                                                  11320002
113300 8230-FETCH-CURSOR.                                               11330002
113400*    IF KRPRPM-FUNC-TXT = 'Y'                                     11340002
113500*        MOVE '8230-FETCH-CURSOR  '      TO PV-PARA-NAME          11350002
113600*        PERFORM 9998-BUILD-MESSAGE                               11360002
113700*    END-IF.                                                      11370002
113800                                                                  11380002
113900                                                                  11390002
114000     EXEC SQL                                                     11400002
114100         FETCH RECITM-CSR                                         11410002
114200           INTO                                                   11420002
114300            :RECITM-ORD-LNE-NBR                                   11430002
114400     END-EXEC.                                                    11440002
114500                                                                  11450002
114600     EVALUATE TRUE                                                11460002
114700         WHEN SQLCODE = ZERO                                      11470002
114800             MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR               11480002
114900             PERFORM 8250-SELECT-TRECITM                          11490002
115000                                                                  11500002
115100         WHEN SQLCODE = +100                                      11510002
115200             SET PS-NO-MORE-PACK-LINES TO TRUE                    11520002
115300                                                                  11530002
115400         WHEN SQLWARN0 NOT = SPACE                                11540002
115500         WHEN SQLCODE  NOT = ZERO                                 11550002
115600             SET PS-ERROR                                         11560002
115700                 RC038-INVALID-SQL    TO TRUE                     11570002
115800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       11580002
115900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           11590002
116000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         11600002
116100             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      11610002
116200             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         11620002
116300             STRING   ' RCKUT124-8230-'                           11630002
116400                      ' CALLED BY-'                               11640002
116500                      RC038-PROGRAM-NAME                          11650002
116600                      '  SQLCODE='                                11660002
116700                      PV-DISPLAY-SQLCODE                          11670002
116800                      ' PO = '                                    11680002
116900                      PV-DISP-OPER-UNT-ID '-'                     11690002
117000                      PV-DISP-PO-NBR '-'                          11700002
117100                      PV-DISP-RCVR-NBR                            11710002
117200                      ' PACK  = '                                 11720002
117300                      PV-DISP-PREPK-ID                            11730002
117400                      DELIMITED BY SIZE                           11740002
117500                                      INTO RC038-CRA-RET-MSG      11750002
117600             PERFORM 9999-WRITE-TO-CSSL                           11760002
117700     END-EVALUATE.                                                11770002
117800                                                                  11780002
117900 8235-FETCH-CURSOR.                                               11790002
118000*    IF KRPRPM-FUNC-TXT = 'Y'                                     11800002
118100*        MOVE '8235-FETCH-CURSOR  '      TO PV-PARA-NAME          11810002
118200*        PERFORM 9998-BUILD-MESSAGE                               11820002
118300*    END-IF.                                                      11830002
118400                                                                  11840002
118500                                                                  11850002
118600     EXEC SQL                                                     11860002
118700         FETCH RECITM-CSR                                         11870002
118800           INTO                                                   11880002
118900            :RECITM-ORD-LNE-NBR                                   11890002
119000     END-EXEC.                                                    11900002
119100                                                                  11910002
119200     EVALUATE TRUE                                                11920002
119300         WHEN SQLCODE = ZERO                                      11930002
119400             MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR               11940002
119500             IF RC038-UNVERIFY                                    11950002
119600                 MOVE 'R'            TO PV-PRCG-STAT-CDE          11960002
119700                 PERFORM 9150-UPDATE-TDISTHD                      11970002
119800                 IF RC038-PROGRAM-NAME = PC-CONFIRM-VERIFY        11980002
119900                     CONTINUE                                     11990002
120000                 ELSE                                             12000002
120100                     IF PS-FIRST-TIME                             12010002
120200                                                                  12020002
120300                         IF  KRPRPM-FUNC-TXT = 'Y'                12030002
120400                             INITIALIZE PV-CICS-MSG-AREA          12040002
120410                             STRING   ' RCKUT124-8400-C'          12041002
120420                                      ' DISTHD-STATUS:'           12042002
120430                                        PV-PRCG-STAT-CDE          12043002
120440                                        DELIMITED BY SIZE         12044002
120450                                     INTO PV-CICS-MSG-AREA        12045002
120460                             MOVE LENGTH OF PV-CICS-MSG-AREA      12046002
120470                                      TO PV-COMMAREA-LENGTH       12047002
120480                                                                  12048002
120490                             EXEC CICS                            12049002
120491                                  WRITEQ TD                       12049102
120492                                   QUEUE ('CSSL')                 12049202
120493                                    FROM (PV-CICS-MSG-AREA)       12049302
120494                                  LENGTH (PV-COMMAREA-LENGTH)     12049402
120495                                    RESP (PV-CICS-RESP)           12049502
120496                             END-EXEC                             12049602
120497                         END-IF                                   12049702
120498                                                                  12049802
120499                         PERFORM 8400-TRACKING                    12049902
120500                         SET PS-NOT-FIRST-TIME  TO TRUE           12050002
120600                     END-IF                                       12060002
120700                 END-IF                                           12070002
120800                 IF SQLCODE = ZERO                                12080002
120900                     PERFORM 9200-UPDATE-TDISTDT                  12090002
121000                 END-IF                                           12100002
121100             ELSE                                                 12110002
121200                 SET PS-TDISTHD-UPDATED-NO TO TRUE                12120002
121300                 PERFORM 9100-UPDATE-TDISTHD                      12130002
121400                 IF PS-TDISTHD-UPDATED                            12140002
121500                     IF RC038-PROGRAM-NAME = PC-CONFIRM-VERIFY    12150002
121600                         CONTINUE                                 12160002
121700                     ELSE                                         12170002
121800                         IF PS-FIRST-TIME                         12180002
121900                                                                  12190002
121910                             IF  KRPRPM-FUNC-TXT = 'Y'            12191002
121920                                 INITIALIZE PV-CICS-MSG-AREA      12192002
121930                                 STRING   ' RCKUT124-8400-D'      12193002
121940                                          ' DISTHD-STATUS:'       12194002
121941                                            PV-PRCG-STAT-CDE      12194102
121942                                            DELIMITED BY SIZE     12194202
121943                                         INTO PV-CICS-MSG-AREA    12194302
121944                                 MOVE LENGTH OF PV-CICS-MSG-AREA  12194402
121945                                          TO PV-COMMAREA-LENGTH   12194502
121946                                                                  12194602
121947                                 EXEC CICS                        12194702
121948                                      WRITEQ TD                   12194802
121949                                       QUEUE ('CSSL')             12194902
121950                                        FROM (PV-CICS-MSG-AREA)   12195002
121960                                      LENGTH (PV-COMMAREA-LENGTH) 12196002
121970                                        RESP (PV-CICS-RESP)       12197002
121980                                 END-EXEC                         12198002
121990                             END-IF                               12199002
121991                                                                  12199102
121992                             PERFORM 8400-TRACKING                12199202
121993                             SET PS-NOT-FIRST-TIME  TO TRUE       12199302
121994                         END-IF                                   12199402
121995                     END-IF                                       12199502
121996                 END-IF                                           12199602
121997             END-IF                                               12199702
121998                                                                  12199802
121999         WHEN SQLCODE = +100                                      12199902
122000             SET PS-NO-MORE-PACK-LINES TO TRUE                    12200002
122100                                                                  12210002
122200         WHEN SQLWARN0 NOT = SPACE                                12220002
122300         WHEN SQLCODE  NOT = ZERO                                 12230002
122400             SET PS-ERROR                                         12240002
122500                 RC038-INVALID-SQL    TO TRUE                     12250002
122600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       12260002
122700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           12270002
122800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         12280002
122900             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      12290002
123000             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         12300002
123100             STRING   ' RCKUT124-8235-'                           12310002
123200                      ' CALLED BY-'                               12320002
123300                      RC038-PROGRAM-NAME                          12330002
123400                      '  SQLCODE='                                12340002
123500                      PV-DISPLAY-SQLCODE                          12350002
123600                      ' PO = '                                    12360002
123700                      PV-DISP-OPER-UNT-ID '-'                     12370002
123800                      PV-DISP-PO-NBR '-'                          12380002
123900                      PV-DISP-RCVR-NBR '-'                        12390002
124000                      ' PACK  = '                                 12400002
124100                      PV-DISP-PREPK-ID                            12410002
124200                      DELIMITED BY SIZE                           12420002
124300                                      INTO RC038-CRA-RET-MSG      12430002
124400             PERFORM 9999-WRITE-TO-CSSL                           12440002
124500     END-EVALUATE.                                                12450002
124600                                                                  12460002
124700 8240-CLOSE-CURSOR.                                               12470002
124800*    IF KRPRPM-FUNC-TXT = 'Y'                                     12480002
124900*        MOVE '8240-CLOSE-CURSOR  '      TO PV-PARA-NAME          12490002
125000*        PERFORM 9998-BUILD-MESSAGE                               12500002
125100*    END-IF.                                                      12510002
125200                                                                  12520002
125300                                                                  12530002
125400     EXEC SQL                                                     12540002
125500         CLOSE RECITM-CSR                                         12550002
125600     END-EXEC.                                                    12560002
125700                                                                  12570002
125800     EVALUATE TRUE                                                12580002
125900         WHEN SQLCODE = ZERO                                      12590002
126000             CONTINUE                                             12600002
126100                                                                  12610002
126200         WHEN SQLWARN0 NOT = SPACE                                12620002
126300         WHEN SQLCODE  NOT = ZERO                                 12630002
126400             SET PS-ERROR                                         12640002
126500                 RC038-INVALID-SQL    TO TRUE                     12650002
126600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       12660002
126700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           12670002
126800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         12680002
126900             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      12690002
127000             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         12700002
127100             STRING   ' RCKUT124-8240-'                           12710002
127200                      ' CALLED BY-'                               12720002
127300                      RC038-PROGRAM-NAME                          12730002
127400                      '  SQLCODE='                                12740002
127500                      PV-DISPLAY-SQLCODE                          12750002
127600                      ' PO = '                                    12760002
127700                      PV-DISP-OPER-UNT-ID '-'                     12770002
127800                      PV-DISP-PO-NBR '-'                          12780002
127900                      PV-DISP-RCVR-NBR                            12790002
128000                      ' PACK  = '                                 12800002
128100                      PV-DISP-PREPK-ID                            12810002
128200                      DELIMITED BY SIZE                           12820002
128300                                      INTO RC038-CRA-RET-MSG      12830002
128400             PERFORM 9999-WRITE-TO-CSSL                           12840002
128500     END-EVALUATE.                                                12850002
128600                                                                  12860002
128700 8250-SELECT-TRECITM.                                             12870002
128800*    IF KRPRPM-FUNC-TXT = 'Y'                                     12880002
128900*        MOVE '8250-SELECT-TRECITM'      TO PV-PARA-NAME          12890002
129000*        PERFORM 9998-BUILD-MESSAGE                               12900002
129100*    END-IF.                                                      12910002
129200                                                                  12920002
129300                                                                  12930002
129400     EXEC SQL                                                     12940002
129500          SELECT                                                  12950002
129600                 STATUS_CDE                                       12960002
129700           INTO                                                   12970002
129800                :RECITM-STATUS-CDE                                12980002
129900          FROM  TRECITM                                           12990002
130000          WHERE  ORD_NBR          =  :DK-PO-NBR                   13000002
130100          AND    ORD_LNE_NBR      =  :DK-LINE-NBR                 13010002
130200          AND    REC_SEQ_NBR      =  :DK-RCVR-NBR                 13020002
130300          AND    VER_STATUS_CDE   =  'A'                          13030002
130400     END-EXEC.                                                    13040002
130500                                                                  13050002
130600     EVALUATE TRUE                                                13060002
130700         WHEN SQLCODE = ZERO                                      13070002
130800              IF RECITM-STATUS-CDE = 'VE'                         13080002
130900                  IF RC038-VERIFY                                 13090002
131000                      SET PS-NO-ACTIVE-LINE      TO TRUE          13100002
131100                      SET RC038-LINE-ALREADY-VE  TO TRUE          13110002
131200                  ELSE                                            13120002
131300                      SET PS-ACTIVE-LINE         TO TRUE          13130002
131400                  END-IF                                          13140002
131500              ELSE                                                13150002
131600                  IF RC038-UNVERIFY                               13160002
131700                      SET PS-NO-ACTIVE-LINE      TO TRUE          13170002
131800                      SET RC038-LINE-NOT-VE      TO TRUE          13180002
131900                  ELSE                                            13190002
132000                      SET PS-ACTIVE-LINE         TO TRUE          13200002
132100                  END-IF                                          13210002
132200              END-IF                                              13220002
132300                                                                  13230002
132400              IF PS-ACTIVE-RECEIVER AND                           13240002
132500                 PS-ACTIVE-LINE     AND                           13250002
132600******           PS-RECDIS-FOUND    AND                           13260002
132700                 PS-NO-ERROR                                      13270002
132800                   PERFORM 4000-PROCESS-CURSOR                    13280002
132900*             ELSE                                                13290002
133000*                 IF KRPRPM-FUNC-TXT = 'Y'                        13300002
133100*                    INITIALIZE  RC038-CRA-RET-MSG                13310002
133200*                    STRING '8250-SELECT-TRECITM - '              13320002
133300*                            PS-ACTIVE-RECEIVER-SW '-'            13330002
133400*                            PS-ACTIVE-LINE-SW '-'                13340002
133500*                            PS-RECDIS-FOUND-SW '-'               13350002
133600*                            PS-ERROR-SW '-'                      13360002
133700*                                         DELIMITED BY SIZE       13370002
133800*                                   INTO  RC038-CRA-RET-MSG       13380002
133900*                    PERFORM 9999-WRITE-TO-CSSL                   13390002
134000*                 END-IF                                          13400002
134100              END-IF                                              13410002
134200         WHEN SQLCODE = +100                                      13420002
134300              SET PS-NO-ACTIVE-LINE      TO TRUE                  13430002
134400              SET RC038-LINE-NOT-FOUND   TO TRUE                  13440002
134500         WHEN SQLWARN0 NOT = SPACE                                13450002
134600         WHEN SQLCODE NOT = ZERO                                  13460002
134700             SET PS-ERROR                                         13470002
134800                 RC038-INVALID-SQL    TO TRUE                     13480002
134900             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       13490002
135000             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           13500002
135100             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         13510002
135200             STRING   ' RCKUT124-8250-'                           13520002
135300                      ' CALLED BY-'                               13530002
135400                      RC038-PROGRAM-NAME                          13540002
135500                      '  SQLCODE='                                13550002
135600                      PV-DISPLAY-SQLCODE                          13560002
135700                      ' PO = '                                    13570002
135800                      PV-DISP-PO-NBR '-'                          13580002
135900                      PV-DISP-RCVR-NBR                            13590002
136000                      DELIMITED BY SIZE                           13600002
136100                                      INTO RC038-CRA-RET-MSG      13610002
136200             PERFORM 9999-WRITE-TO-CSSL                           13620002
136300     END-EVALUATE.                                                13630002
136400                                                                  13640002
136500                                                                  13650002
136600 8251-SELECT-TRECITM-PBS.                                         13660002
136700*    IF KRPRPM-FUNC-TXT = 'Y'                                     13670002
136800*        MOVE '8251-SELECT-TRECITM-PBS'  TO PV-PARA-NAME          13680002
136900*        PERFORM 9998-BUILD-MESSAGE                               13690002
137000*    END-IF.                                                      13700002
137100                                                                  13710002
137200                                                                  13720002
137300     EXEC SQL                                                     13730002
137400          SELECT                                                  13740002
137500                 STATUS_CDE                                       13750002
137600           INTO                                                   13760002
137700                :PV-RECITM-STATUS-CDE                             13770002
137800          FROM  TRECITM                                           13780002
137900          WHERE  ORD_NBR          =  :DK-PO-NBR                   13790002
138000          AND    REC_SEQ_NBR      =  :DK-RCVR-NBR                 13800002
138100          AND    VER_STATUS_CDE   =  'A'                          13810002
138200     END-EXEC.                                                    13820002
138300                                                                  13830002
138400     EVALUATE TRUE                                                13840002
138500         WHEN SQLCODE = ZERO                                      13850002
138600         WHEN SQLCODE = -811                                      13860002
138700              SET PS-ACTIVE-LINE         TO TRUE                  13870002
138800         WHEN SQLCODE = +100                                      13880002
138900              SET PS-NO-ACTIVE-LINE      TO TRUE                  13890002
139000              SET RC038-LINE-NOT-FOUND   TO TRUE                  13900002
139100         WHEN SQLWARN0 NOT = SPACE                                13910002
139200         WHEN SQLCODE NOT = ZERO                                  13920002
139300             SET PS-ERROR                                         13930002
139400                 RC038-INVALID-SQL    TO TRUE                     13940002
139500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       13950002
139600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           13960002
139700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         13970002
139800             STRING   ' RCKUT124-8251-'                           13980002
139900                      ' CALLED BY-'                               13990002
140000                      RC038-PROGRAM-NAME                          14000002
140100                      '  SQLCODE='                                14010002
140200                      PV-DISPLAY-SQLCODE                          14020002
140300                      ' PO = '                                    14030002
140400                      PV-DISP-PO-NBR '-'                          14040002
140500                      PV-DISP-RCVR-NBR                            14050002
140600                      DELIMITED BY SIZE                           14060002
140700                                      INTO RC038-CRA-RET-MSG      14070002
140800             PERFORM 9999-WRITE-TO-CSSL                           14080002
140900     END-EVALUATE.                                                14090002
141000                                                                  14100002
141100 8330-OPEN-CURSOR.                                                14110002
141200*    IF KRPRPM-FUNC-TXT = 'Y'                                     14120002
141300*        MOVE '8330-OPEN-CURSOR'         TO PV-PARA-NAME          14130002
141400*        PERFORM 9998-BUILD-MESSAGE                               14140002
141500*    END-IF.                                                      14150002
141600                                                                  14160002
141700     EXEC SQL                                                     14170002
141800         OPEN STORE-CSR                                           14180002
141900     END-EXEC.                                                    14190002
142000                                                                  14200002
142100     EVALUATE TRUE                                                14210002
142200         WHEN SQLCODE = ZERO                                      14220002
142300             SET PS-MORE-STORE TO TRUE                            14230002
142400                                                                  14240002
142500         WHEN SQLWARN0 NOT = SPACE                                14250002
142600         WHEN SQLCODE  NOT = ZERO                                 14260002
142700             SET PS-ERROR                                         14270002
142800                 RC038-INVALID-SQL    TO TRUE                     14280002
142900             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       14290002
143000             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           14300002
143100             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         14310002
143200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      14320002
143300             MOVE DK-LINE-NBR         TO PV-DISP-PREPK-ID         14330002
143400             STRING   ' RCKUT124-8330-'                           14340002
143500                      ' CALLED BY-'                               14350002
143600                      RC038-PROGRAM-NAME                          14360002
143700                      '  SQLCODE='                                14370002
143800                      PV-DISPLAY-SQLCODE                          14380002
143900                      ' PO = '                                    14390002
144000                      PV-DISP-OPER-UNT-ID '-'                     14400002
144100                      PV-DISP-PO-NBR '-'                          14410002
144200                      PV-DISP-RCVR-NBR                            14420002
144300                      ' PACK  = '                                 14430002
144400                      PV-DISP-PREPK-ID                            14440002
144500                      DELIMITED BY SIZE                           14450002
144600                                      INTO RC038-CRA-RET-MSG      14460002
144700             PERFORM 9999-WRITE-TO-CSSL                           14470002
144800     END-EVALUATE.                                                14480002
144900                                                                  14490002
145000 8335-OPEN-CURSOR.                                                14500002
145100*    IF KRPRPM-FUNC-TXT = 'Y'                                     14510002
145200*        MOVE '8335-OPEN-CURSOR'         TO PV-PARA-NAME          14520002
145300*        PERFORM 9998-BUILD-MESSAGE                               14530002
145400*    END-IF.                                                      14540002
145500                                                                  14550002
145600     EXEC SQL                                                     14560002
145700         OPEN PBS-STORE-CSR                                       14570002
145800     END-EXEC.                                                    14580002
145900                                                                  14590002
146000     EVALUATE TRUE                                                14600002
146100         WHEN SQLCODE = ZERO                                      14610002
146200             SET PS-MORE-STORE TO TRUE                            14620002
146300                                                                  14630002
146400         WHEN SQLWARN0 NOT = SPACE                                14640002
146500         WHEN SQLCODE  NOT = ZERO                                 14650002
146600             SET PS-ERROR                                         14660002
146700                 RC038-INVALID-SQL    TO TRUE                     14670002
146800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       14680002
146900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           14690002
147000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         14700002
147100             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      14710002
147110             STRING   ' RCKUT124-8335-'                           14711002
147120                      ' CALLED BY-'                               14712002
147130                      RC038-PROGRAM-NAME                          14713002
147140                      '  SQLCODE='                                14714002
147150                      PV-DISPLAY-SQLCODE                          14715002
147160                      ' PO = '                                    14716002
147170                      PV-DISP-OPER-UNT-ID '-'                     14717002
147180                      PV-DISP-PO-NBR '-'                          14718002
147190                      PV-DISP-RCVR-NBR                            14719002
147191                      DELIMITED BY SIZE                           14719102
147192                                      INTO RC038-CRA-RET-MSG      14719202
147193             PERFORM 9999-WRITE-TO-CSSL                           14719302
147194     END-EVALUATE.                                                14719402
147195                                                                  14719502
147196 8340-OPEN-CURSOR.                                                14719602
147197*    IF KRPRPM-FUNC-TXT = 'Y'                                     14719702
147198*        MOVE '8340-OPEN-CURSOR'         TO PV-PARA-NAME          14719802
147199*        PERFORM 9998-BUILD-MESSAGE                               14719902
147200*    END-IF.                                                      14720002
147210                                                                  14721002
147211     EXEC SQL                                                     14721102
147212         OPEN STORE-PRPK-CSR                                      14721202
147213     END-EXEC.                                                    14721302
147214                                                                  14721402
147215     EVALUATE TRUE                                                14721502
147216         WHEN SQLCODE = ZERO                                      14721602
147217             SET PS-MORE-STORE TO TRUE                            14721702
147218                                                                  14721802
147219         WHEN SQLWARN0 NOT = SPACE                                14721902
147220         WHEN SQLCODE  NOT = ZERO                                 14722002
147230             SET PS-ERROR                                         14723002
147240                 RC038-INVALID-SQL    TO TRUE                     14724002
147250             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       14725002
147260             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           14726002
147270             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         14727002
147280             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      14728002
147290             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         14729002
147300             STRING   ' RCKUT124-8340-'                           14730002
147400                      ' CALLED BY-'                               14740002
147500                      RC038-PROGRAM-NAME                          14750002
147600                      '  SQLCODE='                                14760002
147610                      PV-DISPLAY-SQLCODE                          14761002
147620                      ' PO = '                                    14762002
147630                      PV-DISP-OPER-UNT-ID '-'                     14763002
147640                      PV-DISP-PO-NBR '-'                          14764002
147650                      PV-DISP-RCVR-NBR                            14765002
147660                      ' PACK  = '                                 14766002
147670                      PV-DISP-PREPK-ID                            14767002
147680                      DELIMITED BY SIZE                           14768002
147690                                      INTO RC038-CRA-RET-MSG      14769002
147691             PERFORM 9999-WRITE-TO-CSSL                           14769102
147692     END-EVALUATE.                                                14769202
147693                                                                  14769302
147694 8360-FETCH-CURSOR.                                               14769402
147695*    IF KRPRPM-FUNC-TXT = 'Y'                                     14769502
147696*        MOVE '8360-FETCH-CURSOR'        TO PV-PARA-NAME          14769602
147697*        PERFORM 9998-BUILD-MESSAGE                               14769702
147698*    END-IF.                                                      14769802
147699                                                                  14769902
147700                                                                  14770002
147701     EXEC SQL                                                     14770102
147702         FETCH STORE-CSR                                          14770202
147703           INTO                                                   14770302
147704            :RECDIS-STR-NBR                                       14770402
147705     END-EXEC.                                                    14770502
147706                                                                  14770602
147707     EVALUATE TRUE                                                14770702
147708         WHEN SQLCODE = ZERO                                      14770802
147709             IF PS-DC-FLUSH-YES                                   14770902
147710                 PERFORM 8800-CHECK-INV-IN-PROCESS                14771002
147711             END-IF                                               14771102
147725                                                                  14772504
147726         WHEN SQLCODE = +100                                      14772604
147727             SET PS-NO-MORE-STORE TO TRUE                         14772704
147728                                                                  14772804
147729         WHEN SQLWARN0 NOT = SPACE                                14772904
147730         WHEN SQLCODE  NOT = ZERO                                 14773004
147731             SET PS-ERROR                                         14773104
147732                 RC038-INVALID-SQL    TO TRUE                     14773204
147733             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       14773304
147734             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           14773404
147740             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         14774002
147750             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      14775002
147760             MOVE DK-LINE-NBR         TO PV-DISP-PREPK-ID         14776002
147770             STRING   ' RCKUT124-8360-'                           14777002
147780                      ' CALLED BY-'                               14778002
147790                      RC038-PROGRAM-NAME                          14779002
147800                      '  SQLCODE='                                14780002
147900                      PV-DISPLAY-SQLCODE                          14790002
148000                      ' PO = '                                    14800002
148100                      PV-DISP-OPER-UNT-ID '-'                     14810002
148200                      PV-DISP-PO-NBR '-'                          14820002
148300                      PV-DISP-RCVR-NBR                            14830002
148400                      ' PACK  = '                                 14840002
148500                      PV-DISP-PREPK-ID                            14850002
148600                      DELIMITED BY SIZE                           14860002
148700                                      INTO RC038-CRA-RET-MSG      14870002
148800             PERFORM 9999-WRITE-TO-CSSL                           14880002
148900     END-EVALUATE.                                                14890002
149000                                                                  14900002
149100 8370-FETCH-CURSOR.                                               14910002
149200*    IF KRPRPM-FUNC-TXT = 'Y'                                     14920002
149300*        MOVE '83760-FETCH-CURSOR'        TO PV-PARA-NAME         14930002
149400*        PERFORM 9998-BUILD-MESSAGE                               14940002
149500*    END-IF.                                                      14950002
149600                                                                  14960002
149700                                                                  14970002
149800     EXEC SQL                                                     14980002
149900         FETCH STORE-PRPK-CSR                                     14990002
150000           INTO                                                   15000002
150100            :RECDIS-STR-NBR                                       15010002
150200     END-EXEC.                                                    15020002
150300                                                                  15030002
150400     EVALUATE TRUE                                                15040002
150500         WHEN SQLCODE = ZERO                                      15050002
150600             PERFORM 8800-CHECK-INV-IN-PROCESS                    15060002
150700                                                                  15070002
150800         WHEN SQLCODE = +100                                      15080002
150900             SET PS-NO-MORE-STORE TO TRUE                         15090002
151000                                                                  15100002
151100         WHEN SQLWARN0 NOT = SPACE                                15110002
151200         WHEN SQLCODE  NOT = ZERO                                 15120002
151300             SET PS-ERROR                                         15130002
151400                 RC038-INVALID-SQL    TO TRUE                     15140002
151500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       15150002
151600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           15160002
151700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         15170002
151800             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      15180002
151900             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         15190002
152000             STRING   ' RCKUT124-8370-'                           15200002
152100                      ' CALLED BY-'                               15210002
152110                      RC038-PROGRAM-NAME                          15211002
152120                      '  SQLCODE='                                15212002
152130                      PV-DISPLAY-SQLCODE                          15213002
152140                      ' PO = '                                    15214002
152150                      PV-DISP-OPER-UNT-ID '-'                     15215002
152160                      PV-DISP-PO-NBR '-'                          15216002
152170                      PV-DISP-RCVR-NBR                            15217002
152180                      ' PACK  = '                                 15218002
152190                      PV-DISP-PREPK-ID                            15219002
152200                      DELIMITED BY SIZE                           15220002
152201                                      INTO RC038-CRA-RET-MSG      15220102
152202             PERFORM 9999-WRITE-TO-CSSL                           15220202
152203     END-EVALUATE.                                                15220302
152204                                                                  15220402
152205 8375-FETCH-CURSOR.                                               15220502
152206*    IF KRPRPM-FUNC-TXT = 'Y'                                     15220602
152207*        MOVE '8375-FETCH-CURSOR'        TO PV-PARA-NAME          15220702
152208*        PERFORM 9998-BUILD-MESSAGE                               15220802
152209*    END-IF.                                                      15220902
152210                                                                  15221002
152211                                                                  15221102
152212     EXEC SQL                                                     15221202
152213         FETCH PBS-STORE-CSR                                      15221302
152214           INTO                                                   15221402
152215            :RECDIS-STR-NBR                                       15221502
152216     END-EXEC.                                                    15221604
152217                                                                  15221704
152218     EVALUATE TRUE                                                15221804
152219         WHEN SQLCODE = ZERO                                      15221902
152220             PERFORM 8800-CHECK-INV-IN-PROCESS                    15222002
152232         WHEN SQLCODE = +100                                      15223204
152233             SET PS-NO-MORE-STORE TO TRUE                         15223304
152234                                                                  15223404
152235         WHEN SQLWARN0 NOT = SPACE                                15223504
152236         WHEN SQLCODE  NOT = ZERO                                 15223604
152237             SET PS-ERROR                                         15223704
152238                 RC038-INVALID-SQL    TO TRUE                     15223804
152239             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       15223904
152240             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           15224004
152241             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         15224104
152242             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      15224204
152243             STRING   ' RCKUT124-8375-'                           15224304
152244                      ' CALLED BY-'                               15224404
152245                      RC038-PROGRAM-NAME                          15224504
152246                      '  SQLCODE='                                15224604
152247                      PV-DISPLAY-SQLCODE                          15224704
152248                      ' PO = '                                    15224804
152249                      PV-DISP-OPER-UNT-ID '-'                     15224904
152250                      PV-DISP-PO-NBR '-'                          15225004
152251                      PV-DISP-RCVR-NBR                            15225104
152252                      DELIMITED BY SIZE                           15225204
152253                                      INTO RC038-CRA-RET-MSG      15225304
152254             PERFORM 9999-WRITE-TO-CSSL                           15225404
152255     END-EVALUATE.                                                15225504
152256                                                                  15225604
152257 8390-CLOSE-CURSOR.                                               15225704
152258*    IF KRPRPM-FUNC-TXT = 'Y'                                     15225804
152259*        MOVE '8390-CLOSE-CURSOR'        TO PV-PARA-NAME          15225904
152260*        PERFORM 9998-BUILD-MESSAGE                               15226004
152261*    END-IF.                                                      15226104
152262                                                                  15226204
152263                                                                  15226304
152264     EXEC SQL                                                     15226404
152265         CLOSE STORE-CSR                                          15226504
152266     END-EXEC.                                                    15226604
152267                                                                  15226704
152268     EVALUATE TRUE                                                15226804
152269         WHEN SQLCODE = ZERO                                      15226904
152270             CONTINUE                                             15227004
152271                                                                  15227104
152272         WHEN SQLWARN0 NOT = SPACE                                15227204
152273         WHEN SQLCODE  NOT = ZERO                                 15227304
152274             SET PS-ERROR                                         15227404
152275                 RC038-INVALID-SQL    TO TRUE                     15227504
152276             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       15227604
152277             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           15227704
152278             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         15227804
152279             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      15227904
152280             MOVE DK-LINE-NBR         TO PV-DISP-PREPK-ID         15228004
152281             STRING   ' RCKUT124-8390-'                           15228104
152290                      ' CALLED BY-'                               15229002
152300                      RC038-PROGRAM-NAME                          15230002
152400                      '  SQLCODE='                                15240002
152500                      PV-DISPLAY-SQLCODE                          15250002
152600                      ' PO = '                                    15260002
152700                      PV-DISP-OPER-UNT-ID '-'                     15270002
152800                      PV-DISP-PO-NBR '-'                          15280002
152900                      PV-DISP-RCVR-NBR                            15290002
153000                      ' PACK  = '                                 15300002
153100                      PV-DISP-PREPK-ID                            15310002
153200                      DELIMITED BY SIZE                           15320002
153300                                      INTO RC038-CRA-RET-MSG      15330002
153400             PERFORM 9999-WRITE-TO-CSSL                           15340002
153500     END-EVALUATE.                                                15350002
153600                                                                  15360002
153700 8395-CLOSE-CURSOR.                                               15370002
153800*    IF KRPRPM-FUNC-TXT = 'Y'                                     15380002
153900*        MOVE '8395-CLOSE-CURSOR'        TO PV-PARA-NAME          15390002
154000*        PERFORM 9998-BUILD-MESSAGE                               15400002
154100*    END-IF.                                                      15410002
154200                                                                  15420002
154300                                                                  15430002
154400     EXEC SQL                                                     15440002
154500         CLOSE STORE-PRPK-CSR                                     15450002
154600     END-EXEC.                                                    15460002
154700                                                                  15470002
154800     EVALUATE TRUE                                                15480002
154900         WHEN SQLCODE = ZERO                                      15490002
155000             CONTINUE                                             15500002
155100                                                                  15510002
155200         WHEN SQLWARN0 NOT = SPACE                                15520002
155300         WHEN SQLCODE  NOT = ZERO                                 15530002
155400             SET PS-ERROR                                         15540002
155500                 RC038-INVALID-SQL    TO TRUE                     15550002
155600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       15560002
155700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           15570002
155800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         15580002
155900             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      15590002
156000             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         15600002
156100             STRING   ' RCKUT124-8395-'                           15610002
156110                      ' CALLED BY-'                               15611002
156120                      RC038-PROGRAM-NAME                          15612002
156130                      '  SQLCODE='                                15613002
156140                      PV-DISPLAY-SQLCODE                          15614002
156150                      ' PO = '                                    15615002
156160                      PV-DISP-OPER-UNT-ID '-'                     15616002
156170                      PV-DISP-PO-NBR '-'                          15617002
156180                      PV-DISP-RCVR-NBR                            15618002
156190                      ' PACK  = '                                 15619002
156200                      PV-DISP-PREPK-ID                            15620002
156201                      DELIMITED BY SIZE                           15620102
156202                                      INTO RC038-CRA-RET-MSG      15620202
156203             PERFORM 9999-WRITE-TO-CSSL                           15620302
156204     END-EVALUATE.                                                15620402
156205                                                                  15620502
156206 8397-CLOSE-CURSOR.                                               15620602
156207*    IF KRPRPM-FUNC-TXT = 'Y'                                     15620702
156208*        MOVE '8397-CLOSE-CURSOR'        TO PV-PARA-NAME          15620802
156209*        PERFORM 9998-BUILD-MESSAGE                               15620902
156210*    END-IF.                                                      15621002
156211                                                                  15621102
156212                                                                  15621202
156213     EXEC SQL                                                     15621302
156214         CLOSE PBS-STORE-CSR                                      15621402
156215     END-EXEC.                                                    15621502
156216                                                                  15621602
156217     EVALUATE TRUE                                                15621702
156218         WHEN SQLCODE = ZERO                                      15621802
156219             CONTINUE                                             15621902
156220                                                                  15622002
156221         WHEN SQLWARN0 NOT = SPACE                                15622102
156222         WHEN SQLCODE  NOT = ZERO                                 15622202
156223             SET PS-ERROR                                         15622302
156224                 RC038-INVALID-SQL    TO TRUE                     15622402
156225             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       15622502
156226             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           15622602
156227             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         15622702
156228             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      15622802
156229             STRING   ' RCKUT124-8397-'                           15622902
156230                      ' CALLED BY-'                               15623002
156231                      RC038-PROGRAM-NAME                          15623102
156232                      '  SQLCODE='                                15623202
156233                      PV-DISPLAY-SQLCODE                          15623302
156234                      ' PO = '                                    15623402
156235                      PV-DISP-OPER-UNT-ID '-'                     15623502
156236                      PV-DISP-PO-NBR '-'                          15623602
156237                      PV-DISP-RCVR-NBR                            15623702
156238                      DELIMITED BY SIZE                           15623802
156239                                      INTO RC038-CRA-RET-MSG      15623902
156240             PERFORM 9999-WRITE-TO-CSSL                           15624002
156241     END-EVALUATE.                                                15624102
156242                                                                  15624202
156243 8400-TRACKING.                                                   15624302
156244                                                                  15624402
156245     INITIALIZE RC071-FIELDS.                                     15624502
156246     MOVE RC038-PO-NBR              TO RC071-PO-NBR.              15624602
156247     MOVE RC038-REC-SEQ-NBR         TO RC071-PO-RCVR.             15624702
156248     MOVE RC038-PO-LNE-NBR          TO RC071-PO-LINE.             15624802
156249     MOVE RC038-PREPACK-ID          TO RC071-PREPK-ID.            15624902
156250     MOVE RC038-OPER-UNT-ID         TO RC071-SIGNON-LOCATION.     15625002
156251     MOVE RC038-USER-ID             TO RC071-USER-ID.             15625102
156252                                                                  15625202
156253     EVALUATE TRUE                                                15625302
156254        WHEN RC038-PROGRAM-NAME = PC-TRAILER-UNLOAD               15625402
156255            EVALUATE TRUE                                         15625502
156256                WHEN PV-PRCG-STAT-CDE = 'C'                       15625602
156257                    SET RC071-SUSP-TRLUN-CANCELLED TO TRUE        15625702
156258                WHEN PV-PRCG-STAT-CDE = 'E'                       15625802
156259                    SET RC071-SUSP-TRLUN-RCVR-TRBL TO TRUE        15625902
156260                WHEN PV-PRCG-STAT-CDE = 'F'                       15626002
156270                    SET RC071-SUSP-TRLUN-NO-PRONBR TO TRUE        15627002
156280                WHEN PV-PRCG-STAT-CDE = 'G'                       15628002
156290                   SET RC071-SUSP-TRLUN-NT-ARRVD  TO TRUE         15629002
156300                WHEN PV-PRCG-STAT-CDE = 'H'                       15630002
156400                    SET RC071-SUSP-TRLUN-OP-SY-AUD TO TRUE        15640002
156500                WHEN PV-PRCG-STAT-CDE = 'I'                       15650002
156600                   SET RC071-SUSP-TRLUN-ST-INVTRY TO TRUE         15660002
156700                WHEN PV-PRCG-STAT-CDE = 'P'                       15670002
156800                    SET RC071-SUSP-TRLUN-PREV-VRFY TO TRUE        15680002
156900                WHEN PV-PRCG-STAT-CDE = 'J'                       15690002
157000                   SET RC071-SUSP-TRLUN-NOT-MNFST TO TRUE         15700002
157100                WHEN PV-PRCG-STAT-CDE = 'R'                       15710002
157200                   SET RC071-SUSP-TRLUN-FOR-READY TO TRUE         15720002
157300            END-EVALUATE                                          15730002
157400       WHEN RC038-PROGRAM-NAME = PC-HOT-COMPLETE                  15740002
157500            EVALUATE TRUE                                         15750002
157600                WHEN PV-PRCG-STAT-CDE = 'C'                       15760002
157700                    SET RC071-SUSP-HTCMP-CANCELLED TO TRUE        15770002
157800                WHEN PV-PRCG-STAT-CDE = 'E'                       15780002
157900                   SET RC071-SUSP-HTCMP-RCVR-TRBL TO TRUE         15790002
158000                WHEN PV-PRCG-STAT-CDE = 'F'                       15800002
158100                    SET RC071-SUSP-HTCMP-NO-PRONBR TO TRUE        15810002
158200                WHEN PV-PRCG-STAT-CDE = 'G'                       15820002
158300                   SET RC071-SUSP-HTCMP-NT-ARRVD  TO TRUE         15830002
158400                WHEN PV-PRCG-STAT-CDE = 'H'                       15840002
158500                    SET RC071-SUSP-HTCMP-OP-SY-AUD TO TRUE        15850002
158600                WHEN PV-PRCG-STAT-CDE = 'I'                       15860002
158700                   SET RC071-SUSP-HTCMP-ST-INVTRY TO TRUE         15870002
158800                WHEN PV-PRCG-STAT-CDE = 'P'                       15880002
158900                    SET RC071-SUSP-HTCMP-PREV-VRFY TO TRUE        15890002
159000                WHEN PV-PRCG-STAT-CDE = 'J'                       15900002
159100                   SET RC071-SUSP-HTCMP-NOT-MNFST TO TRUE         15910002
159200                WHEN PV-PRCG-STAT-CDE = 'R'                       15920002
159300                   SET RC071-SUSP-HTCMP-FOR-READY TO TRUE         15930002
159400            END-EVALUATE                                          15940002
159500       WHEN RC038-PROGRAM-NAME = PC-SWEEPER                       15950002
159600            EVALUATE TRUE                                         15960002
159700                WHEN PV-PRCG-STAT-CDE = 'C'                       15970002
159800                    SET RC071-SUSP-SWEEP-CANCELLED TO TRUE        15980002
159900                WHEN PV-PRCG-STAT-CDE = 'E'                       15990002
160000                   SET RC071-SUSP-SWEEP-RCVR-TRBL TO TRUE         16000002
160100                WHEN PV-PRCG-STAT-CDE = 'F'                       16010002
160200                    SET RC071-SUSP-SWEEP-NO-PRONBR TO TRUE        16020002
160300                WHEN PV-PRCG-STAT-CDE = 'G'                       16030002
160400                   SET RC071-SUSP-SWEEP-NT-ARRVD  TO TRUE         16040002
160500                WHEN PV-PRCG-STAT-CDE = 'H'                       16050002
160600                    SET RC071-SUSP-SWEEP-OP-SY-AUD TO TRUE        16060002
160700                WHEN PV-PRCG-STAT-CDE = 'I'                       16070002
160800                   SET RC071-SUSP-SWEEP-ST-INVTRY TO TRUE         16080002
160900                WHEN PV-PRCG-STAT-CDE = 'P'                       16090002
161000                    SET RC071-SUSP-SWEEP-PREV-VRFY TO TRUE        16100002
161100                WHEN PV-PRCG-STAT-CDE = 'J'                       16110002
161200                   SET RC071-SUSP-SWEEP-NOT-MNFST TO TRUE         16120002
161300                WHEN PV-PRCG-STAT-CDE = 'R'                       16130002
161400                   SET RC071-SUSP-SWEEP-FOR-READY TO TRUE         16140002
161500            END-EVALUATE                                          16150002
161600        WHEN RC038-PROGRAM-NAME = PC-CHECK-IN-VERIFY              16160002
161700        WHEN RC038-PROGRAM-NAME = PC-CHECK-IN-START               16170002
161800        WHEN RC038-PROGRAM-NAME = PC-PRINT-AND-APPLY              16180002
161900            EVALUATE TRUE                                         16190002
162000                WHEN PV-PRCG-STAT-CDE = 'C'                       16200002
162100                    SET RC071-SUSP-CHKIN-CANCELLED TO TRUE        16210002
162200                WHEN PV-PRCG-STAT-CDE = 'E'                       16220002
162300                   SET RC071-SUSP-CHKIN-RCVR-TRBL TO TRUE         16230002
162400                WHEN PV-PRCG-STAT-CDE = 'F'                       16240002
162500                    SET RC071-SUSP-CHKIN-NO-PRONBR TO TRUE        16250002
162600                WHEN PV-PRCG-STAT-CDE = 'G'                       16260002
162700                   SET RC071-SUSP-CHKIN-NT-ARRVD  TO TRUE         16270002
162800                WHEN PV-PRCG-STAT-CDE = 'H'                       16280002
162900                    SET RC071-SUSP-CHKIN-OP-SY-AUD TO TRUE        16290002
163000                WHEN PV-PRCG-STAT-CDE = 'I'                       16300002
163100                   SET RC071-SUSP-CHKIN-ST-INVTRY TO TRUE         16310002
163200                WHEN PV-PRCG-STAT-CDE = 'P'                       16320002
163300                    SET RC071-SUSP-CHKIN-PREV-VRFY TO TRUE        16330002
163400                WHEN PV-PRCG-STAT-CDE = 'J'                       16340002
163500                   SET RC071-SUSP-CHKIN-NOT-MNFST TO TRUE         16350002
163600                WHEN PV-PRCG-STAT-CDE = 'R'                       16360002
163700                   SET RC071-SUSP-CHKIN-FOR-READY TO TRUE         16370002
163800            END-EVALUATE                                          16380002
163900        WHEN RC038-PROGRAM-NAME = PC-P2L-PCC-UPLOAD               16390002
164000        WHEN RC038-PROGRAM-NAME = PC-P2L-AL-UPLOAD                16400002
164100            EVALUATE TRUE                                         16410002
164200                WHEN PV-PRCG-STAT-CDE = 'C'                       16420002
164300                    SET RC071-SUSP-P2LUP-CANCELLED TO TRUE        16430002
164400                WHEN PV-PRCG-STAT-CDE = 'E'                       16440002
164500                    SET RC071-SUSP-P2LUP-RCVR-TRBL TO TRUE        16450002
164600                WHEN PV-PRCG-STAT-CDE = 'F'                       16460002
164700                    SET RC071-SUSP-P2LUP-NO-PRONBR TO TRUE        16470002
164800                WHEN PV-PRCG-STAT-CDE = 'G'                       16480002
164900                   SET RC071-SUSP-P2LUP-NT-ARRVD  TO TRUE         16490002
165000                WHEN PV-PRCG-STAT-CDE = 'H'                       16500002
165010                    SET RC071-SUSP-P2LUP-OP-SY-AUD TO TRUE        16501002
165020                WHEN PV-PRCG-STAT-CDE = 'I'                       16502002
165030                   SET RC071-SUSP-P2LUP-ST-INVTRY TO TRUE         16503002
165040                WHEN PV-PRCG-STAT-CDE = 'P'                       16504002
165050                    SET RC071-SUSP-P2LUP-PREV-VRFY TO TRUE        16505002
165060                WHEN PV-PRCG-STAT-CDE = 'J'                       16506002
165070                   SET RC071-SUSP-P2LUP-NOT-MNFST TO TRUE         16507002
165080                WHEN PV-PRCG-STAT-CDE = 'R'                       16508002
165090                   SET RC071-SUSP-P2LUP-FOR-READY TO TRUE         16509002
165091            END-EVALUATE                                          16509102
165092     END-EVALUATE                                                 16509202
165093                                                                  16509302
165094     MOVE RC038-PROGRAM-NAME        TO RC071-CALLING-PROGRAM      16509402
165095                                                                  16509502
165096     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        16509602
165097                                                                  16509702
165098     IF  KRPRPM-FUNC-TXT = 'Y'                                    16509802
165099         INITIALIZE PV-CICS-MSG-AREA                              16509902
165100         STRING   ' RCKUT124-8400-'                               16510002
165110                    RC071-FIELDS                                  16511002
165111                      DELIMITED BY SIZE                           16511102
165112                                INTO PV-CICS-MSG-AREA             16511202
165113         MOVE LENGTH OF PV-CICS-MSG-AREA                          16511302
165114                                  TO PV-COMMAREA-LENGTH           16511402
165115                                                                  16511502
165116         EXEC CICS                                                16511602
165117              WRITEQ TD                                           16511702
165118               QUEUE   ('CSSL')                                   16511802
165119                FROM   (PV-CICS-MSG-AREA)                         16511902
165120              LENGTH   (PV-COMMAREA-LENGTH)                       16512002
165121                RESP   (PV-CICS-RESP)                             16512102
165122         END-EXEC                                                 16512202
165123                                                                  16512302
165124     END-IF.                                                      16512402
165125                                                                  16512502
165126     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  16512602
165127                                        RC071-COMMAREA            16512702
165128                                        RC071-FIELDS.             16512802
165129                                                                  16512902
165130     EVALUATE TRUE                                                16513002
165131         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     16513102
165132             IF  RC071-INVALID-SQL     OR                         16513202
165133                 RC071-DATABASE-BUSY                              16513302
165134                 STRING ' RCKUT137 - '        DELIMITED BY SIZE   16513402
165135                   '8700-TRACK-CONFIRMATION'  DELIMITED BY SIZE   16513502
165136                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   16513602
165137                        RC071-SUCCESS-IND     DELIMITED BY SIZE   16513702
165138                                         INTO RC071-CRA-RET-MSG   16513802
165139             MOVE RC071-CRA-RET-MSG       TO PV-CICS-MSG-AREA     16513902
165140                 PERFORM 9999-WRITE-TO-CSSL                       16514002
165150                 SET RC071-NOT-SUCCESSFUL TO TRUE                 16515002
165160             END-IF                                               16516002
165170         WHEN OTHER                                               16517002
165180             STRING ' RCKUT125 (OTHER) -' DELIMITED BY SIZE       16518002
165190                '8700-TRACK-CONFIRMATION' DELIMITED BY SIZE       16519002
165200                    ' RETURN MESSAGE - '  DELIMITED BY SIZE       16520002
165300                    RC071-SUCCESS-IND     DELIMITED BY SIZE       16530002
165400                                         INTO RC071-CRA-RET-MSG   16540002
165500             MOVE RC071-CRA-RET-MSG       TO PV-CICS-MSG-AREA     16550002
165600             PERFORM 9999-WRITE-TO-CSSL                           16560002
165700             SET RC071-NOT-SUCCESSFUL TO TRUE                     16570002
165800     END-EVALUATE.                                                16580002
165900                                                                  16590002
166000                                                                  16600002
166100 8500-OPEN-CURSOR.                                                16610002
166200*    IF KRPRPM-FUNC-TXT = 'Y'                                     16620002
166300*        MOVE '8500-OPEN-CURSOR'         TO PV-PARA-NAME          16630002
166400*        PERFORM 9998-BUILD-MESSAGE                               16640002
166500*    END-IF.                                                      16650002
166600                                                                  16660002
166700     EXEC SQL                                                     16670002
166800         OPEN STORE-MATCH-CSR                                     16680002
166900     END-EXEC.                                                    16690002
167000                                                                  16700002
167100     EVALUATE TRUE                                                16710002
167200         WHEN SQLCODE = ZERO                                      16720002
167300             SET PS-MORE-DISTRO TO TRUE                           16730002
167400                                                                  16740002
167500         WHEN SQLWARN0 NOT = SPACE                                16750002
167600         WHEN SQLCODE  NOT = ZERO                                 16760002
167700             SET PS-ERROR                                         16770002
167800                 RC038-INVALID-SQL    TO TRUE                     16780002
167900             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       16790002
168000             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           16800002
168100             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         16810002
168200             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         16820002
168300             STRING   ' RCKUT124-8500-'                           16830002
168400                      ' CALLED BY-'                               16840002
168500                      RC038-PROGRAM-NAME                          16850002
168600                      '  SQLCODE='                                16860002
168700                      PV-DISPLAY-SQLCODE                          16870002
168800                      ' PO = '                                    16880002
168900                      PV-DISP-PO-NBR '-'                          16890002
169000                      PV-DISP-RCVR-NBR '-'                        16900002
169100                      PV-DISP-LINE-NBR                            16910002
169200                      DELIMITED BY SIZE                           16920002
169300                                      INTO RC038-CRA-RET-MSG      16930002
169400             PERFORM 9999-WRITE-TO-CSSL                           16940002
169500     END-EVALUATE.                                                16950002
169600                                                                  16960002
169700 8530-FETCH-CURSOR.                                               16970002
169800*    IF KRPRPM-FUNC-TXT = 'Y'                                     16980002
169900*        MOVE '8530-FETCH-CURSOR'        TO PV-PARA-NAME          16990002
170000*        PERFORM 9998-BUILD-MESSAGE                               17000002
170100*    END-IF.                                                      17010002
170200                                                                  17020002
170300                                                                  17030002
170400     EXEC SQL                                                     17040002
170500         FETCH STORE-MATCH-CSR                                    17050002
170600           INTO                                                   17060002
170700             :DISTDT-STR-NBR                                      17070002
170800         ,   :RECDIS-STR-NBR:PV-STR-NULL-IND                      17080002
170900     END-EXEC.                                                    17090002
171000                                                                  17100002
171100     EVALUATE TRUE                                                17110002
171200         WHEN SQLCODE = ZERO                                      17120002
171300             IF PV-STR-NULL-IND = -1                              17130002
171400                 SET PS-NO-RECDIS-FOUND                           17140002
171500                     RC038-DISTRO-NO-MATCH                        17150002
171600                     PS-NO-MORE-DISTRO TO TRUE                    17160002
171700             END-IF                                               17170002
171800                                                                  17180002
171900         WHEN SQLCODE = +100                                      17190002
172000             SET PS-NO-MORE-DISTRO TO TRUE                        17200002
172100                                                                  17210002
172200         WHEN SQLWARN0 NOT = SPACE                                17220002
172300         WHEN SQLCODE  NOT = ZERO                                 17230002
172400             SET PS-ERROR                                         17240002
172500                 RC038-INVALID-SQL    TO TRUE                     17250002
172600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       17260002
172700             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           17270002
172800             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         17280002
172900             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         17290002
173000             STRING   ' RCKUT124-8530-'                           17300002
173100                      ' CALLED BY-'                               17310002
173200                      RC038-PROGRAM-NAME                          17320002
173300                      '  SQLCODE='                                17330002
173400                      PV-DISPLAY-SQLCODE                          17340002
173500                      ' PO = '                                    17350002
173600                      PV-DISP-PO-NBR '-'                          17360002
173700                      PV-DISP-RCVR-NBR '-'                        17370002
173800                      PV-DISP-LINE-NBR                            17380002
173900                      DELIMITED BY SIZE                           17390002
174000                                      INTO RC038-CRA-RET-MSG      17400002
174100             PERFORM 9999-WRITE-TO-CSSL                           17410002
174200     END-EVALUATE.                                                17420002
174300                                                                  17430002
174400 8560-CLOSE-CURSOR.                                               17440002
174500*    IF KRPRPM-FUNC-TXT = 'Y'                                     17450002
174600*        MOVE '8560-CLOSE-CURSOR'        TO PV-PARA-NAME          17460002
174700*        PERFORM 9998-BUILD-MESSAGE                               17470002
174800*    END-IF.                                                      17480002
174900                                                                  17490002
175000                                                                  17500002
175100     EXEC SQL                                                     17510002
175200         CLOSE STORE-MATCH-CSR                                    17520002
175300     END-EXEC.                                                    17530002
175400                                                                  17540002
175500     EVALUATE TRUE                                                17550002
175600         WHEN SQLCODE = ZERO                                      17560002
175700             CONTINUE                                             17570002
175800                                                                  17580002
175900         WHEN SQLWARN0 NOT = SPACE                                17590002
176000         WHEN SQLCODE  NOT = ZERO                                 17600002
176100             SET PS-ERROR                                         17610002
176200                 RC038-INVALID-SQL    TO TRUE                     17620002
176300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       17630002
176400             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           17640002
176500             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         17650002
176600             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         17660002
176700             STRING   ' RCKUT124-8560-'                           17670002
176800                      ' CALLED BY-'                               17680002
176900                      RC038-PROGRAM-NAME                          17690002
177000                      '  SQLCODE='                                17700002
177100                      PV-DISPLAY-SQLCODE                          17710002
177200                      ' PO = '                                    17720002
177300                      PV-DISP-PO-NBR '-'                          17730002
177400                      PV-DISP-RCVR-NBR '-'                        17740002
177500                      PV-DISP-LINE-NBR                            17750002
177600                      DELIMITED BY SIZE                           17760002
177700                                      INTO RC038-CRA-RET-MSG      17770002
177800             PERFORM 9999-WRITE-TO-CSSL                           17780002
177900     END-EVALUATE.                                                17790002
178000                                                                  17800002
178100                                                                  17810002
178200 8600-SELECT-TDISTHD.                                             17820002
178300*    IF KRPRPM-FUNC-TXT = 'Y'                                     17830002
178400*        MOVE '8600-SELECT-TDISTHD'      TO PV-PARA-NAME          17840002
178500*        PERFORM 9998-BUILD-MESSAGE                               17850002
178600*    END-IF.                                                      17860002
178700                                                                  17870002
178800                                                                  17880002
178900     EXEC SQL                                                     17890002
179000         SELECT TOT_CART_CNT                                      17900002
179100             ,  PRCG_STAT_CDE                                     17910002
179200           INTO :DISTHD-TOT-CART-CNT                              17920002
179300             ,  :DISTHD-PRCG-STAT-CDE                             17930002
179400           FROM TDISTHD                                           17940002
179500         WHERE  ORD_NBR             = :DK-PO-NBR                  17950002
179600           AND  RCVR_SEQ_NBR        = :DK-RCVR-NBR                17960002
179700           AND  ORD_LNE_NBR         = :DK-LINE-NBR                17970002
179800     END-EXEC.                                                    17980002
179900                                                                  17990002
180000     EVALUATE TRUE                                                18000002
180100         WHEN SQLCODE = ZERO                                      18010002
180200             IF RC038-PBS                                         18020002
180300                 SET PS-DISTHD-FOUND  TO TRUE                     18030002
180400             ELSE                                                 18040002
180500                 IF DISTHD-TOT-CART-CNT > 0                       18050002
180600                     SET PS-DISTHD-FOUND  TO TRUE                 18060002
180700                 ELSE                                             18070002
180800                     SET PS-NO-DISTHD-FOUND  TO TRUE              18080002
180900                     SET PS-CASEPACK-NOT-PERFORMED TO TRUE        18090002
181000                 END-IF                                           18100002
181100             END-IF                                               18110002
181200         WHEN SQLCODE = +100                                      18120002
181300             MOVE SPACES TO DISTHD-PRCG-STAT-CDE                  18130002
181400             SET PS-NO-DISTHD-FOUND  TO TRUE                      18140002
181500             SET PS-CASEPACK-NOT-PERFORMED TO TRUE                18150002
181600         WHEN SQLCODE = -305                                      18160002
181700              CONTINUE                                            18170002
181800         WHEN SQLWARN0 NOT = SPACE                                18180002
181900         WHEN SQLCODE NOT = ZERO                                  18190002
182000             SET PS-ERROR                                         18200002
182100                 RC038-INVALID-SQL    TO TRUE                     18210002
182200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       18220002
182300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           18230002
182400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         18240002
182500             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         18250002
182600             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      18260002
182700             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          18270002
182800             STRING   ' RCKUT124-8600-'                           18280002
182900                      ' CALLED BY-'                               18290002
183000                      RC038-PROGRAM-NAME                          18300002
183100                      '  SQLCODE='                                18310002
183200                      PV-DISPLAY-SQLCODE                          18320002
183300                      ' PO = '                                    18330002
183400                      PV-DISP-OPER-UNT-ID '-'                     18340002
183500                      PV-DISP-PO-NBR  '-'                         18350002
183600                      PV-DISP-RCVR-NBR '-'                        18360002
183700                      PV-DISP-LINE-NBR                            18370002
183800                      ' STR  = '                                  18380002
183900                      PV-DISP-STR-NBR                             18390002
184000                      DELIMITED BY SIZE                           18400002
184100                                      INTO RC038-CRA-RET-MSG      18410002
184200             PERFORM 9999-WRITE-TO-CSSL                           18420002
184300     END-EVALUATE.                                                18430002
184400                                                                  18440002
184500 8700-COUNT-CHECK-IN.                                             18450002
184600                                                                  18460002
184700     EXEC SQL                                                     18470002
184800          SELECT   COUNT (DISTINCT C.SHIPT_UNT_ID)                18480002
184900            INTO  :PV-CHECK-IN-COUNT                              18490002
185000            FROM  TPKSLIP A                                       18500002
185100                , TINPKSU B                                       18510002
185200                , TSHUNLO C                                       18520002
185300           WHERE                                                  18530002
185400                  A.PO_NBR        = :DK-PO-NBR                    18540002
185500             AND  A.REC_SEQ_NBR   = :DK-RCVR-NBR                  18550002
185600             AND  A.PO_NBR        = B.PO_NBR                      18560002
185700             AND  A.SEQ_NBR       = B.SEQ_NBR                     18570002
185800             AND  C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                18580002
185900             AND  C.ACTV_CDE      = 'A'                           18590002
186000             AND  C.SCN_LOC_ID    = 'RECV'                        18600002
186100     END-EXEC.                                                    18610002
186200                                                                  18620002
186300     EVALUATE TRUE                                                18630002
186400         WHEN SQLCODE = ZERO                                      18640002
186500         WHEN SQLCODE = -305                                      18650002
186600         WHEN SQLCODE = +100                                      18660002
186700             CONTINUE                                             18670002
186800         WHEN SQLWARN0 NOT = SPACE                                18680002
186900         WHEN SQLCODE NOT = ZERO                                  18690002
187000             SET PS-ERROR                                         18700002
187100                 RC038-INVALID-SQL    TO TRUE                     18710002
187200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       18720002
187300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           18730002
187400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         18740002
187500             STRING   ' RCKUT124-8700-'                           18750002
187600                      ' CALLED BY-'                               18760002
187700                      RC038-PROGRAM-NAME                          18770002
187800                      '  SQLCODE='                                18780002
187900                      PV-DISPLAY-SQLCODE                          18790002
188000                      ' PO = '                                    18800002
188100                      PV-DISP-PO-NBR  '-'                         18810002
188200                      PV-DISP-RCVR-NBR                            18820002
188300                      DELIMITED BY SIZE                           18830002
188400                                      INTO RC038-CRA-RET-MSG      18840002
188500             PERFORM 9999-WRITE-TO-CSSL                           18850002
188600     END-EVALUATE.                                                18860002
188700                                                                  18870002
188800                                                                  18880002
188900 8740-COUNT-MANIFESTED-PBS.                                       18890002
189000                                                                  18900002
189100                                                                  18910002
189200     EXEC SQL                                                     18920002
189300          SELECT  COUNT (DISTINCT C.SHIPT_UNT_ID)                 18930002
189400            INTO  :PV-MANIFESTED-COUNT                            18940002
189500            FROM  TPKSLIP A                                       18950002
189600                , TINPKSU B                                       18960002
189700                , TSHUNLO C                                       18970002
189800           WHERE                                                  18980002
189900                  A.PO_NBR        = :DK-PO-NBR                    18990002
190000             AND  A.REC_SEQ_NBR   = :DK-RCVR-NBR                  19000002
190100             AND  A.PO_NBR        = B.PO_NBR                      19010002
190200             AND  A.SEQ_NBR       = B.SEQ_NBR                     19020002
190300             AND  C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                19030002
190400             AND  A.VER_STAT_CDE  = 'A'                           19040002
190500             AND  C.ACTV_CDE      = 'A'                           19050002
190600             AND  C.SCN_LOC_ID    = 'RECV'                        19060002
190700             AND  C.OPER_UNT_ID   = :DK-OPER-UNT-ID               19070002
190800             AND NOT EXISTS                                       19080002
190900             (SELECT *                                            19090002
191000               FROM TSULBXF D                                     19100002
191100               WHERE  C.SHIPT_UNT_ID  = D.SHIPT_UNT_ID)           19110002
191200             AND NOT EXISTS                                       19120002
191300             (SELECT *                                            19130002
191400               FROM SUT_OTBND_CART Z                              19140002
191500                   ,SUT_OTBND_UPC  Y                              19150002
191600               WHERE  Y.TRN_NBR = A.PO_NBR                        19160002
191700                 AND  Y.RCVR_SEQ_NBR = A.REC_SEQ_NBR              19170002
191800                 AND  A.STR_DEST_NBR = Z.DEST_LOC_NBR             19180002
191900                 AND  Z.SHIPT_UNT_ID = Y.SHIPT_UNT_ID             19190002
191910                 AND  Y.TRN_NBR = Y.TRN_NBR                       19191002
191920                 AND  Y.RCVR_SEQ_NBR = Y.RCVR_SEQ_NBR             19192002
191930                 AND  Y.TRN_LNE_NBR = Y.TRN_LNE_NBR               19193002
191940                 AND  Z.CART_SRC_CDE = 'SMO'                      19194002
191950                 AND  Z.ACTV_IND     = 'Y'  )                     19195002
191960     END-EXEC.                                                    19196002
191970                                                                  19197002
191980     EVALUATE TRUE                                                19198002
191990         WHEN SQLCODE = ZERO                                      19199002
192000         WHEN SQLCODE = -305                                      19200002
192100         WHEN SQLCODE = +100                                      19210002
192200             CONTINUE                                             19220002
192300         WHEN SQLWARN0 NOT = SPACE                                19230002
192400         WHEN SQLCODE NOT = ZERO                                  19240002
192500             SET PS-ERROR                                         19250002
192600                 RC038-INVALID-SQL    TO TRUE                     19260002
192700             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       19270002
192800             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           19280002
192900             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         19290002
193000             STRING   ' RCKUT124-8740-'                           19300002
193100                      ' CALLED BY-'                               19310002
193200                      RC038-PROGRAM-NAME                          19320002
193300                      '  SQLCODE='                                19330002
193400                      PV-DISPLAY-SQLCODE                          19340002
193500                      ' PO = '                                    19350002
193600                      PV-DISP-PO-NBR  '-'                         19360002
193700                      PV-DISP-RCVR-NBR                            19370002
193800                      DELIMITED BY SIZE                           19380002
193900                                      INTO RC038-CRA-RET-MSG      19390002
194000             PERFORM 9999-WRITE-TO-CSSL                           19400002
194100     END-EVALUATE.                                                19410002
194200                                                                  19420002
194300                                                                  19430002
194400                                                                  19440002
194500 8750-COUNT-MANIFESTED.                                           19450002
194600                                                                  19460002
194700     EXEC SQL                                                     19470002
194800          SELECT  COUNT(DISTINCT C.SHIPT_UNT_ID)                  19480002
194900            INTO  :PV-MANIFESTED-COUNT                            19490002
195000            FROM  TPKSLIP A                                       19500002
195100                , TINPKSU B                                       19510002
195200                , TSHUNLO C                                       19520002
195300                , TSHUUPC D                                       19530002
195400           WHERE                                                  19540002
195500                  A.PO_NBR        = :DK-PO-NBR                    19550002
195600             AND  A.REC_SEQ_NBR   = :DK-RCVR-NBR                  19560002
195700             AND  A.PO_NBR        = B.PO_NBR                      19570002
195800             AND  A.SEQ_NBR       = B.SEQ_NBR                     19580002
195900             AND  A.VER_STAT_CDE  = 'A'                           19590002
196000             AND  C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                19600002
196100             AND  C.ACTV_CDE      = 'A'                           19610002
196200             AND  C.SCN_LOC_ID    = 'RECV'                        19620002
196300             AND  C.OPER_UNT_ID   = :DK-OPER-UNT-ID               19630002
196400             AND  B.SHIPT_UNT_ID  = D.SHIPT_UNT_ID                19640002
196500             AND  B.PO_NBR        = D.TRN_NBR                     19650002
196600             AND  D.TRN_LNE_NBR   = :DK-LINE-NBR                  19660002
196700             AND NOT EXISTS                                       19670002
196800             (SELECT *                                            19680002
196900               FROM  TSULBXF D                                    19690002
197000               WHERE  C.SHIPT_UNT_ID  = D.SHIPT_UNT_ID)           19700002
197100     END-EXEC.                                                    19710002
197200                                                                  19720002
197300     EVALUATE TRUE                                                19730002
197400         WHEN SQLCODE = ZERO                                      19740002
197500         WHEN SQLCODE = -305                                      19750002
197600         WHEN SQLCODE = +100                                      19760002
197700             CONTINUE                                             19770002
197800         WHEN SQLWARN0 NOT = SPACE                                19780002
197900         WHEN SQLCODE NOT = ZERO                                  19790002
198000             SET PS-ERROR                                         19800002
198100                 RC038-INVALID-SQL    TO TRUE                     19810002
198200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       19820002
198300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           19830002
198400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         19840002
198500             STRING   ' RCKUT124-8750-'                           19850002
198600                      ' CALLED BY-'                               19860002
198700                      RC038-PROGRAM-NAME                          19870002
198800                      '  SQLCODE='                                19880002
198900                      PV-DISPLAY-SQLCODE                          19890002
199000                      ' PO = '                                    19900002
199100                      PV-DISP-PO-NBR  '-'                         19910002
199200                      PV-DISP-RCVR-NBR                            19920002
199300                      DELIMITED BY SIZE                           19930002
199400                                      INTO RC038-CRA-RET-MSG      19940002
199500             PERFORM 9999-WRITE-TO-CSSL                           19950002
199600     END-EVALUATE.                                                19960002
199700                                                                  19970002
199800                                                                  19980002
199900 8751-CHK-FOR-PHY-LBL.                                            19990002
200000                                                                  20000002
200100     EXEC SQL                                                     20010002
200200          SELECT  ORD_NBR                                         20020002
200300            INTO  :DISTHD-ORD-NBR                                 20030002
200400            FROM  TDISTHD A                                       20040002
200500           WHERE                                                  20050002
200600                  A.ORD_NBR       = :DK-PO-NBR                    20060002
200700             AND  A.RCVR_SEQ_NBR  = :DK-RCVR-NBR                  20070002
200800             AND  A.ORD_LNE_NBR   = :DK-LINE-NBR                  20080002
200900             AND  A.UCC128_DAT_USG_CDE IN ('I','N',' ')           20090002
201000             AND  A.CRE_USR_ID NOT IN ('HOTCMPLT','TRLRUNLD')     20100002
201100             AND  A.TOT_CART_CNT  > 0                             20110002
201200     END-EXEC.                                                    20120002
201300                                                                  20130002
201400     EVALUATE TRUE                                                20140002
201500         WHEN SQLCODE = ZERO                                      20150002
201600             SET PS-PHY-LABELS-USED TO TRUE                       20160002
201700         WHEN SQLCODE = +100                                      20170002
201800             CONTINUE                                             20180002
201900         WHEN SQLWARN0 NOT = SPACE                                20190002
202000         WHEN SQLCODE NOT = ZERO                                  20200002
202100             SET PS-ERROR                                         20210002
202200                 RC038-INVALID-SQL    TO TRUE                     20220002
202300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       20230002
202400             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           20240002
202500             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         20250002
202600             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         20260002
202700             STRING   ' RCKUT124-8751-'                           20270002
202800                      ' CALLED BY-'                               20280002
202900                      RC038-PROGRAM-NAME                          20290002
203000                      '  SQLCODE='                                20300002
203100                      PV-DISPLAY-SQLCODE                          20310002
203200                      ' PO = '                                    20320002
203300                      PV-DISP-PO-NBR  '-'                         20330002
203400                      PV-DISP-RCVR-NBR '-'                        20340002
203500                      PV-DISP-LINE-NBR '-'                        20350002
203600                      DELIMITED BY SIZE                           20360002
203700                                      INTO RC038-CRA-RET-MSG      20370002
203800             PERFORM 9999-WRITE-TO-CSSL                           20380002
203900     END-EVALUATE.                                                20390002
204000                                                                  20400002
204100                                                                  20410002
204200 8800-CHECK-INV-IN-PROCESS.                                       20420002
204300*    IF KRPRPM-FUNC-TXT = 'Y'                                     20430002
204400*        MOVE '8800-CHECK-INV-IN-PROCESS' TO PV-PARA-NAME         20440002
204500*        PERFORM 9998-BUILD-MESSAGE                               20450002
204600*    END-IF.                                                      20460002
204700                                                                  20470002
204800     EXEC SQL                                                     20480002
204900          SELECT                                                  20490002
205000                 A.DC_CTOFF_DTE                                   20500002
205100             ,   (A.DC_CTOFF_DTE + 7 DAYS)                        20510002
205200          INTO                                                    20520002
205300                 :XLT00025-DC-CTOFF-DTE                           20530002
205400             ,   :PV-WORK-DATE-PLUS-7                             20540002
205500          FROM                                                    20550002
205600                XLT_MDSE_INV_PARM A                               20560002
205700          WHERE A.LOC_NBR           =  :RECDIS-STR-NBR            20570002
205800           AND  A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)         20580002
205900           AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)         20590002
206000           AND  A.ACTV_IND         = 'Y'                          20600002
206100           AND  A.LOC_INV_STAT_CDE = 'IN'                         20610002
206200     END-EXEC.                                                    20620002
206300                                                                  20630002
206400     EVALUATE TRUE                                                20640002
206500         WHEN SQLCODE = ZERO                                      20650002
206600         WHEN SQLCODE = -811                                      20660002
206700              PERFORM 5000-PROCESS-DATES                          20670002
206800                                                                  20680002
206900         WHEN SQLCODE = +100                                      20690002
207000              SET PS-STR-NOT-IN-INV-CYCLE TO TRUE                 20700002
207100                                                                  20710002
207200         WHEN SQLWARN0 NOT = SPACE                                20720002
207300         WHEN SQLCODE NOT = ZERO                                  20730002
207400             SET PS-ERROR                                         20740002
207500                 RC038-INVALID-SQL    TO TRUE                     20750002
207600             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       20760002
207700             MOVE RECDIS-STR-NBR      TO PV-DISP-STR-NBR          20770002
207800             STRING   ' RCKUT124-8800-'                           20780002
207900                      ' CALLED BY-'                               20790002
208000                      RC038-PROGRAM-NAME                          20800002
208100                      '  SQLCODE='                                20810002
208200                      PV-DISPLAY-SQLCODE                          20820002
208300                      ' STORE = '                                 20830002
208400                      PV-DISP-STR-NBR                             20840002
208500                      DELIMITED BY SIZE                           20850002
208600                                      INTO RC038-CRA-RET-MSG      20860002
208700             PERFORM 9999-WRITE-TO-CSSL                           20870002
208800     END-EVALUATE.                                                20880002
208900                                                                  20890002
209000 8900-COUNT-OPEN-AUD-RCVR.                                        20900002
209100*    IF KRPRPM-FUNC-TXT = 'Y'                                     20910002
209200*        MOVE '8900-COUNT-OPEN-AUD-RCVR ' TO PV-PARA-NAME         20920002
209300*        PERFORM 9998-BUILD-MESSAGE                               20930002
209400*    END-IF.                                                      20940002
209500                                                                  20950002
209600                                                                  20960002
209700     IF RC038-PBS                                                 20970002
209800         MOVE 0                 TO DK-AUDIT-LINE                  20980002
209900         MOVE 0                 TO DK-AUDIT-PREPACK               20990002
210000     ELSE                                                         21000002
210100         IF RC038-BULK-CASE                                       21010002
210200             MOVE DK-LINE-NBR       TO DK-AUDIT-LINE              21020002
210300             MOVE 0                 TO DK-AUDIT-PREPACK           21030002
210400         ELSE                                                     21040002
210500             MOVE 0                 TO DK-AUDIT-LINE              21050002
210600             MOVE DK-PREPK-ID       TO DK-AUDIT-PREPACK           21060002
210700         END-IF                                                   21070002
210800     END-IF.                                                      21080002
210900                                                                  21090002
211000     EXEC SQL                                                     21100002
211100          SELECT COUNT(*)                                         21110002
211200          INTO   :PV-OPEN-AUDIT-COUNT                             21120002
211300          FROM   SUT_PO_AUD_REQ                                   21130002
211400          WHERE  PO_NBR         = :DK-PO-NBR                      21140002
211500            AND  RCVR_SEQ_NBR   = :DK-RCVR-NBR                    21150002
211600            AND (PO_LNE_NBR     = :DK-AUDIT-LINE                  21160002
211700             OR  PO_PREPK_ID    = :DK-AUDIT-PREPACK)              21170002
211800            AND  AUD_STAT_CDE   = 'I'                             21180002
211900     END-EXEC.                                                    21190002
212000                                                                  21200002
212100     EVALUATE TRUE                                                21210002
212200         WHEN SQLCODE = ZERO                                      21220002
212300              IF PV-OPEN-AUDIT-COUNT > 0                          21230002
212400                  SET PS-OPEN-AUDITS         TO TRUE              21240002
212500              ELSE                                                21250002
212600                  SET PS-NO-OPEN-AUDITS      TO TRUE              21260002
212700              END-IF                                              21270002
212800         WHEN SQLCODE = +100                                      21280002
212900         WHEN SQLCODE = -305                                      21290002
213000              SET PS-NO-OPEN-AUDITS      TO TRUE                  21300002
213100         WHEN SQLWARN0 NOT = SPACE                                21310002
213200         WHEN SQLCODE NOT = ZERO                                  21320002
213300             SET PS-ERROR                                         21330002
213400                 RC038-INVALID-SQL    TO TRUE                     21340002
213500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       21350002
213600             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           21360002
213700             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         21370002
213800             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         21380002
213900             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         21390002
214000             STRING   ' RCKUT124-8900-'                           21400002
214100                      ' CALLED BY-'                               21410002
214200                      RC038-PROGRAM-NAME                          21420002
214300                      '  SQLCODE='                                21430002
214400                      PV-DISPLAY-SQLCODE                          21440002
214500                      ' PO = '                                    21450002
214600                      PV-DISP-PO-NBR '-'                          21460002
214700                      PV-DISP-RCVR-NBR                            21470002
214800                      ' LINE= '                                   21480002
214900                      PV-DISP-LINE-NBR                            21490002
215000                      ' PACK= '                                   21500002
215100                      PV-DISP-PREPK-ID                            21510002
215200                      DELIMITED BY SIZE                           21520002
215300                                      INTO RC038-CRA-RET-MSG      21530002
215400             PERFORM 9999-WRITE-TO-CSSL                           21540002
215500     END-EVALUATE.                                                21550002
215600                                                                  21560002
215700 8905-COUNT-OPEN-AUD-LINE.                                        21570002
215800*    IF KRPRPM-FUNC-TXT = 'Y'                                     21580002
215900*        MOVE '8905-COUNT-OPEN-AUD-LINE ' TO PV-PARA-NAME         21590002
216000*        PERFORM 9998-BUILD-MESSAGE                               21600002
216100*    END-IF.                                                      21610002
216200                                                                  21620002
216300                                                                  21630002
216400     IF RC038-PBS                                                 21640002
216500         MOVE 0                 TO DK-AUDIT-LINE                  21650002
216600         MOVE 0                 TO DK-AUDIT-PREPACK               21660002
216700     ELSE                                                         21670002
216800         IF RC038-BULK-CASE                                       21680002
216900             MOVE DK-LINE-NBR       TO DK-AUDIT-LINE              21690002
217000             MOVE 0                 TO DK-AUDIT-PREPACK           21700002
217100         ELSE                                                     21710002
217200             MOVE 0                 TO DK-AUDIT-LINE              21720002
217300             MOVE DK-PREPK-ID       TO DK-AUDIT-PREPACK           21730002
217400         END-IF                                                   21740002
217500     END-IF.                                                      21750002
217600                                                                  21760002
217700     EXEC SQL                                                     21770002
217800          SELECT COUNT(*)                                         21780002
217900          INTO   :PV-OPEN-AUDIT-COUNT                             21790002
218000          FROM   SUT_PO_AUD_REQ                                   21800002
218100          WHERE  PO_NBR         = :DK-PO-NBR                      21810002
218200            AND  RCVR_SEQ_NBR   = :DK-RCVR-NBR                    21820002
218300            AND  PO_LNE_NBR     = :DK-AUDIT-LINE                  21830002
218400            AND  PO_PREPK_ID    = :DK-AUDIT-PREPACK               21840002
218500            AND  AUD_STAT_CDE   = 'I'                             21850002
218600     END-EXEC.                                                    21860002
218700                                                                  21870002
218800     EVALUATE TRUE                                                21880002
218900         WHEN SQLCODE = ZERO                                      21890002
219000              IF PV-OPEN-AUDIT-COUNT > 0                          21900002
219100                  SET PS-OPEN-AUDITS         TO TRUE              21910002
219200              ELSE                                                21920002
219300                  SET PS-NO-OPEN-AUDITS      TO TRUE              21930002
219400              END-IF                                              21940002
219500         WHEN SQLCODE = +100                                      21950002
219600         WHEN SQLCODE = -305                                      21960002
219700              SET PS-NO-OPEN-AUDITS      TO TRUE                  21970002
219800         WHEN SQLWARN0 NOT = SPACE                                21980002
219900         WHEN SQLCODE NOT = ZERO                                  21990002
220000             SET PS-ERROR                                         22000002
220100                 RC038-INVALID-SQL    TO TRUE                     22010002
220200             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       22020002
220300             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           22030002
220400             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         22040002
220500             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         22050002
220600             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         22060002
220700             STRING   ' RCKUT124-8905-'                           22070002
220800                      ' CALLED BY-'                               22080002
220900                      RC038-PROGRAM-NAME                          22090002
221000                      '  SQLCODE='                                22100002
221100                      PV-DISPLAY-SQLCODE                          22110002
221200                      ' PO = '                                    22120002
221300                      PV-DISP-PO-NBR '-'                          22130002
221400                      PV-DISP-RCVR-NBR                            22140002
221500                      ' LINE= '                                   22150002
221600                      PV-DISP-LINE-NBR                            22160002
221700                      ' PACK= '                                   22170002
221800                      PV-DISP-PREPK-ID                            22180002
221900                      DELIMITED BY SIZE                           22190002
222000                                      INTO RC038-CRA-RET-MSG      22200002
222100             PERFORM 9999-WRITE-TO-CSSL                           22210002
222200     END-EVALUATE.                                                22220002
222300                                                                  22230002
222400                                                                  22240002
222410 8910-COUNT-OPEN-RFID-AUD.                                        22241002
222460                                                                  22246002
222502     EXEC SQL                                                     22250202
222503          SELECT COUNT(*)                                         22250302
222504          INTO   :PV-OPEN-AUDIT-COUNT                             22250402
222505          FROM   SUT_PO_AUD_REQ                                   22250502
222506          WHERE  PO_NBR         = :DK-PO-NBR                      22250602
222507            AND  RCVR_SEQ_NBR   = :DK-RCVR-NBR                    22250702
222508            AND  PKGNG_TYP_CDE  = 'RF'                            22250802
222510            AND  AUD_STAT_CDE   = 'I'                             22251002
222511     END-EXEC.                                                    22251102
222512                                                                  22251202
222513     EVALUATE TRUE                                                22251302
222514         WHEN SQLCODE = ZERO                                      22251402
222515              IF PV-OPEN-AUDIT-COUNT > 0                          22251502
222516                  SET PS-OPEN-AUDITS         TO TRUE              22251602
222517              ELSE                                                22251702
222518                  SET PS-NO-OPEN-AUDITS      TO TRUE              22251802
222519              END-IF                                              22251902
222520         WHEN SQLCODE = +100                                      22252002
222521         WHEN SQLCODE = -305                                      22252102
222522              SET PS-NO-OPEN-AUDITS      TO TRUE                  22252202
222523         WHEN SQLWARN0 NOT = SPACE                                22252302
222524         WHEN SQLCODE NOT = ZERO                                  22252402
222525             SET PS-ERROR                                         22252502
222526                 RC038-INVALID-SQL    TO TRUE                     22252602
222527             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       22252702
222528             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           22252802
222529             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         22252902
222530             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         22253002
222531             MOVE DK-PREPK-ID         TO PV-DISP-PREPK-ID         22253102
222532             STRING   ' RCKUT124-8910-'                           22253202
222533                      ' CALLED BY-'                               22253302
222534                      RC038-PROGRAM-NAME                          22253402
222535                      '  SQLCODE='                                22253502
222536                      PV-DISPLAY-SQLCODE                          22253602
222537                      ' PO = '                                    22253702
222538                      PV-DISP-PO-NBR '-'                          22253802
222539                      PV-DISP-RCVR-NBR                            22253902
222540                      ' LINE= '                                   22254002
222541                      PV-DISP-LINE-NBR                            22254102
222542                      ' PACK= '                                   22254202
222543                      PV-DISP-PREPK-ID                            22254302
222544                      DELIMITED BY SIZE                           22254402
222545                                      INTO RC038-CRA-RET-MSG      22254502
222546             PERFORM 9999-WRITE-TO-CSSL                           22254602
222547     END-EVALUATE.                                                22254702
222548                                                                  22254802
222549                                                                  22254902
222550 9000-INSERT-DIST-HEADER.                                         22255002
222600*    IF KRPRPM-FUNC-TXT = 'Y'                                     22260002
222700*        MOVE '9000-INSERT-DIST-HEADER'   TO PV-PARA-NAME         22270002
222800*        PERFORM 9998-BUILD-MESSAGE                               22280002
222900*    END-IF.                                                      22290002
223000                                                                  22300002
223100                                                                  22310002
223200     MOVE  PC-DEFAULT-TMST       TO  DISTHD-RSLTS-RCVD-TMST       22320002
223300                                     DISTHD-VRFD-TMST             22330002
223400                                     DISTHD-FCSE-CNFRMN-TMST      22340002
223500                                     DISTHD-DLT-REQ-TMST.         22350002
223600                                                                  22360002
223700     EXEC SQL                                                     22370002
223800          INSERT INTO TDISTHD                                     22380002
223900           ( ORD_NBR                                              22390002
224000            ,RCVR_SEQ_NBR                                         22400002
224100            ,ORD_LNE_NBR                                          22410002
224200            ,WRK_ORD_SEQ_NBR                                      22420002
224300            ,OPER_UNT_ID                                          22430002
224400            ,DISTRB_PRC_AREA_ID                                   22440002
224500            ,PRCG_STAT_CDE                                        22450002
224600            ,CRE_TMST                                             22460002
224700            ,RSLTS_RCVD_TMST                                      22470002
224800            ,VRFD_TMST                                            22480002
224900            ,PRC_AREA_MODU_ID                                     22490002
225000            ,CRE_USR_ID                                           22500002
225100            ,TOT_CART_CNT                                         22510002
225200            ,CART_DWNLD_DTE                                       22520002
225300            ,CART_DWNLD_TM                                        22530002
225400            ,CART_DWNLD_USR_ID                                    22540002
225500            ,FCSE_CART_CNT                                        22550002
225600            ,FCSE_LBL_TYP_CDE                                     22560002
225700            ,P2L_CART_CNT                                         22570002
225800            ,INPK_CART_CNT                                        22580002
225900            ,INPK_UNT_QTY                                         22590002
226000            ,INPK_CNVYB_IND                                       22600002
226100            ,OTPK_UNT_QTY                                         22610002
226200            ,SYS_CRE_CDE                                          22620002
226300            ,SPC_INSTR_DESC                                       22630002
226400            ,FCSE_CNFRMN_TMST                                     22640002
226500            ,CRE_LBL_OPT_CDE                                      22650002
226600            ,ODD_CART_UNT_QTY                                     22660002
226700            ,DLT_REQ_TMST                                         22670002
226800            ,PREPK_LNE_PRC_CDE                                    22680002
226900            ,CAL_UNT_PRCD_QTY                                     22690002
227000            ,UCC128_DAT_USG_CDE                                   22700002
227100            ,P2L_SCN_CART_CNT                                     22710002
227200           )                                                      22720002
227300         VALUES (                                                 22730002
227400             :DK-PO-NBR                                           22740002
227500           , :DK-RCVR-NBR                                         22750002
227600           , 0                                                    22760002
227700           , 0                                                    22770002
227800           , :DK-OPER-UNT-ID                                      22780002
227900           , 'RECV'                                               22790002
228000           , 'R'                                                  22800002
228100           ,  CURRENT TIMESTAMP                                   22810002
228200           , :DISTHD-RSLTS-RCVD-TMST                              22820002
228300           , :DISTHD-VRFD-TMST                                    22830002
228400           , ' '                                                  22840002
228500           , :RC038-PROGRAM-NAME                                  22850002
228600           , 0                                                    22860002
228700           , :PC-DEFAULT-DATE                                     22870002
228800           , :PC-DEFAULT-TIME                                     22880002
228900           , ' '                                                  22890002
229000           , 0                                                    22900002
229100           , ' '                                                  22910002
229200           , 0                                                    22920002
229300           , 0                                                    22930002
229400           , 0                                                    22940002
229500           , ' '                                                  22950002
229600           , 0                                                    22960002
229700           , 'F'                                                  22970002
229800           , ' '                                                  22980002
229900           , :DISTHD-FCSE-CNFRMN-TMST                             22990002
230000           , ' '                                                  23000002
230100           , 0                                                    23010002
230200           , :DISTHD-DLT-REQ-TMST                                 23020002
230300           , ' '                                                  23030002
230400           , 0                                                    23040002
230500           , ' '                                                  23050002
230600           , 0                                                    23060002
230700         )                                                        23070002
230800     END-EXEC.                                                    23080002
230900                                                                  23090002
231000     EVALUATE TRUE                                                23100002
231100         WHEN SQLCODE = ZERO                                      23110002
231200         WHEN SQLCODE = -803                                      23120002
231300              CONTINUE                                            23130002
231400         WHEN SQLWARN0 NOT = SPACE                                23140002
231500         WHEN SQLCODE NOT = ZERO                                  23150002
231600             SET PS-ERROR                                         23160002
231700                 RC038-INVALID-SQL    TO TRUE                     23170002
231800             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       23180002
231900             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           23190002
232000             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         23200002
232100             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      23210002
232200             STRING   ' RCKUT124-9000-'                           23220002
232300                      ' CALLED BY-'                               23230002
232400                      RC038-PROGRAM-NAME                          23240002
232500                      '  SQLCODE='                                23250002
232600                      PV-DISPLAY-SQLCODE                          23260002
232700                      ' PO = '                                    23270002
232800                      PV-DISP-OPER-UNT-ID '-'                     23280002
232900                      PV-DISP-PO-NBR '-'                          23290002
233000                      PV-DISP-RCVR-NBR                            23300002
233100                      DELIMITED BY SIZE                           23310002
233200                                      INTO RC038-CRA-RET-MSG      23320002
233300             PERFORM 9999-WRITE-TO-CSSL                           23330002
233400     END-EVALUATE.                                                23340002
233500                                                                  23350002
233600 9100-UPDATE-TDISTHD.                                             23360002
233700*    IF KRPRPM-FUNC-TXT = 'Y'                                     23370002
233800*        MOVE '9100-UPDATE-TDISTHD      ' TO PV-PARA-NAME         23380002
233900*        PERFORM 9998-BUILD-MESSAGE                               23390002
234000*    END-IF.                                                      23400002
234100                                                                  23410002
234200                                                                  23420002
234300     IF RC038-LINE-NOT-FOUND OR                                   23430002
234400        RC038-RCVR-NOT-ACTIVE                                     23440002
234500         MOVE 'C'            TO PV-PRCG-STAT-CDE                  23450002
234600     ELSE                                                         23460002
234700     IF RC038-RECV-TROUBLE OR                                     23470002
234800        RC038-LINE-TROUBLE OR                                     23480002
234900        RC038-DISTRO-NO-MATCH                                     23490002
235000         IF DISTHD-PRCG-STAT-CDE  = 'L'                           23500002
235100             MOVE 'L'            TO PV-PRCG-STAT-CDE              23510002
235200         ELSE                                                     23520002
235300             MOVE 'E'            TO PV-PRCG-STAT-CDE              23530002
235400         END-IF                                                   23540002
235500     ELSE                                                         23550002
235600     IF RC038-NO-PRO                                              23560002
235700         MOVE 'F'            TO PV-PRCG-STAT-CDE                  23570002
235800     ELSE                                                         23580002
235900     IF RC038-NOT-ARRIVED                                         23590002
236000         MOVE 'G'            TO PV-PRCG-STAT-CDE                  23600002
236100     ELSE                                                         23610002
236200     IF RC038-OPEN-SYSTEM-AUDIT                                   23620002
236300         MOVE 'H'            TO PV-PRCG-STAT-CDE                  23630002
236400     ELSE                                                         23640002
236500     IF RC038-STORE-INVENTORY                                     23650002
236600         MOVE 'I'            TO PV-PRCG-STAT-CDE                  23660002
236700     ELSE                                                         23670002
236800     IF RC038-LINE-ALREADY-VE OR                                  23680002
236900        RC038-RECEIVER-ALREADY-VE                                 23690002
237000         MOVE 'P'            TO PV-PRCG-STAT-CDE                  23700002
237100     ELSE                                                         23710002
237200     IF RC038-NOT-MANIFESTD                                       23720002
237300         MOVE 'J'            TO PV-PRCG-STAT-CDE                  23730002
237400     END-IF                                                       23740002
237500     END-IF                                                       23750002
237600     END-IF                                                       23760002
237700     END-IF                                                       23770002
237800     END-IF                                                       23780002
237900     END-IF                                                       23790002
238000     END-IF                                                       23800002
238100     END-IF.                                                      23810002
238200     IF RC038-PBS                                                 23820002
238300         MOVE 0                  TO DK-LINE-NBR                   23830002
238400     END-IF.                                                      23840002
238500     IF DISTHD-PRCG-STAT-CDE NOT = PV-PRCG-STAT-CDE               23850002
238600         PERFORM 9130-UPDATE-TDISTHD                              23860002
238700         SET PS-TDISTHD-UPDATED   TO TRUE                         23870002
238800     END-IF.                                                      23880002
238900                                                                  23890002
239000 9130-UPDATE-TDISTHD.                                             23900002
239100     EXEC SQL                                                     23910002
239200         UPDATE TDISTHD                                           23920002
239300             SET PRCG_STAT_CDE   = :PV-PRCG-STAT-CDE              23930002
239400         WHERE  ORD_NBR             = :DK-PO-NBR                  23940002
239500           AND  RCVR_SEQ_NBR        = :DK-RCVR-NBR                23950002
239600           AND  ORD_LNE_NBR         = :DK-LINE-NBR                23960002
239700     END-EXEC.                                                    23970002
239800                                                                  23980002
239900     EVALUATE TRUE                                                23990002
240000         WHEN SQLCODE = ZERO                                      24000002
240100         WHEN SQLCODE = +100                                      24010002
240200              CONTINUE                                            24020002
240300         WHEN SQLWARN0 NOT = SPACE                                24030002
240400         WHEN SQLCODE NOT = ZERO                                  24040002
240500             SET PS-ERROR                                         24050002
240600                 RC038-INVALID-SQL    TO TRUE                     24060002
240700             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       24070002
240800             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           24080002
240900             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         24090002
241000             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         24100002
241100             STRING   ' RCKUT124-9130-'                           24110002
241200                      ' CALLED BY-'                               24120002
241300                      RC038-PROGRAM-NAME                          24130002
241400                      '  SQLCODE='                                24140002
241500                      PV-DISPLAY-SQLCODE                          24150002
241600                      ' PO = '                                    24160002
241700                      PV-DISP-PO-NBR '-'                          24170002
241800                      PV-DISP-RCVR-NBR '-'                        24180002
241900                      PV-DISP-LINE-NBR                            24190002
242000                      DELIMITED BY SIZE                           24200002
242100                                      INTO RC038-CRA-RET-MSG      24210002
242200             PERFORM 9999-WRITE-TO-CSSL                           24220002
242300     END-EVALUATE.                                                24230002
242400                                                                  24240002
242500 9150-UPDATE-TDISTHD.                                             24250002
242600*    IF KRPRPM-FUNC-TXT = 'Y'                                     24260002
242700*        MOVE '9150-UPDATE-TDISTHD      ' TO PV-PARA-NAME         24270002
242800*        PERFORM 9998-BUILD-MESSAGE                               24280002
242900*    END-IF.                                                      24290002
243000                                                                  24300002
243100                                                                  24310002
243200     IF RC038-PBS                                                 24320002
243300         MOVE 0                  TO DK-LINE-NBR                   24330002
243400     END-IF.                                                      24340002
243500                                                                  24350002
243600     EXEC SQL                                                     24360002
243700         UPDATE TDISTHD                                           24370002
243800             SET PRCG_STAT_CDE   = :PV-PRCG-STAT-CDE              24380002
243900               , VRFD_TMST       = :PC-DEFAULT-TMST               24390002
244000         WHERE  ORD_NBR             = :DK-PO-NBR                  24400002
244100           AND  RCVR_SEQ_NBR        = :DK-RCVR-NBR                24410002
244200           AND  ORD_LNE_NBR         = :DK-LINE-NBR                24420002
244300     END-EXEC.                                                    24430002
244400                                                                  24440002
244500     EVALUATE TRUE                                                24450002
244600         WHEN SQLCODE = ZERO                                      24460002
244700         WHEN SQLCODE = +100                                      24470002
244800              CONTINUE                                            24480002
244900         WHEN SQLWARN0 NOT = SPACE                                24490002
245000         WHEN SQLCODE NOT = ZERO                                  24500002
245100             SET PS-ERROR                                         24510002
245200                 RC038-INVALID-SQL    TO TRUE                     24520002
245300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       24530002
245400             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           24540002
245500             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         24550002
245600             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         24560002
245700             STRING   ' RCKUT124-9150-'                           24570002
245800                      ' CALLED BY-'                               24580002
245900                      RC038-PROGRAM-NAME                          24590002
246000                      '  SQLCODE='                                24600002
246100                      PV-DISPLAY-SQLCODE                          24610002
246200                      ' PO = '                                    24620002
246300                      PV-DISP-PO-NBR  '-'                         24630002
246400                      PV-DISP-RCVR-NBR '-'                        24640002
246500                      PV-DISP-LINE-NBR                            24650002
246600                      DELIMITED BY SIZE                           24660002
246700                                      INTO RC038-CRA-RET-MSG      24670002
246800             PERFORM 9999-WRITE-TO-CSSL                           24680002
246900     END-EVALUATE.                                                24690002
247000                                                                  24700002
247100 9200-UPDATE-TDISTDT.                                             24710002
247200*    IF KRPRPM-FUNC-TXT = 'Y'                                     24720002
247300*        MOVE '9200-UPDATE-TDISTDT'       TO PV-PARA-NAME         24730002
247400*        PERFORM 9998-BUILD-MESSAGE                               24740002
247500*    END-IF.                                                      24750002
247600                                                                  24760002
247700     EXEC SQL                                                     24770002
247800         UPDATE TDISTDT                                           24780002
247900             SET RCVG_PSTD_STAT_CDE = 'N'                         24790002
248000         WHERE  ORD_NBR             = :DK-PO-NBR                  24800002
248100           AND  RCVR_SEQ_NBR        = :DK-RCVR-NBR                24810002
248200           AND  ORD_LNE_NBR         = :DK-LINE-NBR                24820002
248300     END-EXEC.                                                    24830002
248400                                                                  24840002
248500     EVALUATE TRUE                                                24850002
248600         WHEN SQLCODE = ZERO                                      24860002
248700         WHEN SQLCODE = +100                                      24870002
248800              CONTINUE                                            24880002
248900         WHEN SQLWARN0 NOT = SPACE                                24890002
249000         WHEN SQLCODE NOT = ZERO                                  24900002
249100             SET PS-ERROR                                         24910002
249200                 RC038-INVALID-SQL    TO TRUE                     24920002
249300             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       24930002
249400             MOVE DK-PO-NBR           TO PV-DISP-PO-NBR           24940002
249500             MOVE DK-RCVR-NBR         TO PV-DISP-RCVR-NBR         24950002
249600             MOVE DK-LINE-NBR         TO PV-DISP-LINE-NBR         24960002
249700             STRING   ' RCKUT124-9200-'                           24970002
249800                      ' CALLED BY-'                               24980002
249900                      RC038-PROGRAM-NAME                          24990002
250000                      '  SQLCODE='                                25000002
250100                      PV-DISPLAY-SQLCODE                          25010002
250200                      ' PO = '                                    25020002
250300                      PV-DISP-PO-NBR '-'                          25030002
250400                      PV-DISP-RCVR-NBR '-'                        25040002
250500                      PV-DISP-LINE-NBR                            25050002
250600                      DELIMITED BY SIZE                           25060002
250700                                      INTO RC038-CRA-RET-MSG      25070002
250800             PERFORM 9999-WRITE-TO-CSSL                           25080002
250900     END-EVALUATE.                                                25090002
251000                                                                  25100002
251100 9300-CHECK-LOGGING.                                              25110002
251200*    IF KRPRPM-FUNC-TXT = 'Y'                                     25120002
251300*        MOVE '9300-CHECK-LOGGING '       TO PV-PARA-NAME         25130002
251400*        PERFORM 9998-BUILD-MESSAGE                               25140002
251500*    END-IF.                                                      25150002
251600                                                                  25160002
251700     EXEC SQL                                                     25170002
251800         SELECT FUNC_TXT                                          25180002
251900           INTO :KRPRPM-FUNC-TXT                                  25190002
252000           FROM TKRPRPM                                           25200002
252100          WHERE SYS_PRC_FUNC_CDE  = 'RC124D'                      25210002
252200            AND LOC_ID            = :DK-OPER-UNT-ID               25220002
252300            AND INTFC_SYS_CDE     = 'KHL'                         25230002
252400            AND FUNC_PRC_STAT_CDE = 'AC'                          25240002
252500     END-EXEC.                                                    25250002
252600                                                                  25260002
252700     EVALUATE TRUE                                                25270002
252800         WHEN SQLCODE = ZERO                                      25280002
252900         WHEN SQLCODE = +100                                      25290002
253000              CONTINUE                                            25300002
253100         WHEN SQLWARN0 NOT = SPACE                                25310002
253200         WHEN SQLCODE NOT = ZERO                                  25320002
253300             SET PS-ERROR                                         25330002
253400                 RC038-INVALID-SQL    TO TRUE                     25340002
253500             MOVE SQLCODE             TO PV-DISPLAY-SQLCODE       25350002
253600             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      25360002
253700             STRING   ' RCKUT124-9300-'                           25370002
253800                      ' CALLED BY-'                               25380002
253900                      RC038-PROGRAM-NAME                          25390002
254000                      '  SQLCODE='                                25400002
254100                      PV-DISPLAY-SQLCODE                          25410002
254200                      ' OPER = '                                  25420002
254300                      PV-DISP-OPER-UNT-ID                         25430002
254400                      DELIMITED BY SIZE                           25440002
254500                                      INTO RC038-CRA-RET-MSG      25450002
254600             PERFORM 9999-WRITE-TO-CSSL                           25460002
254700     END-EVALUATE.                                                25470002
254800                                                                  25480002
254900                                                                  25490002
255000 9902-SYNCPOINT.                                                  25500002
255100     EXEC CICS                                                    25510002
255200         SYNCPOINT                                                25520002
255300     END-EXEC.                                                    25530002
255400                                                                  25540002
255500 9998-BUILD-MESSAGE.                                              25550002
255600      MOVE RC038-PO-NBR      TO PV-DISP-PO-NBR.                   25560002
255700      MOVE RC038-REC-SEQ-NBR TO PV-DISP-RCVR-NBR.                 25570002
255800      MOVE RC038-PO-LNE-NBR  TO PV-DISP-LINE-NBR.                 25580002
255900      MOVE RC038-PREPACK-ID  TO PV-DISP-PREPK-ID.                 25590002
256000      STRING   ' RCKUT124 '                                       25600002
256100               PV-PARA-NAME                                       25610002
256200               ' PO = '                                           25620002
256300               PV-DISP-PO-NBR '-'                                 25630002
256400               PV-DISP-RCVR-NBR '-'                               25640002
256500               PV-DISP-LINE-NBR                                   25650002
256600               ' PACK-'                                           25660002
256700               PV-DISP-PREPK-ID                                   25670002
256800               DELIMITED BY SIZE                                  25680002
256900                               INTO RC038-CRA-RET-MSG.            25690002
257000      PERFORM 9999-WRITE-TO-CSSL.                                 25700002
257100                                                                  25710002
257200 9999-WRITE-TO-CSSL.                                              25720002
257300                                                                  25730002
257400     MOVE RC038-CRA-RET-MSG       TO PV-CICS-MSG-AREA.            25740002
257500     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      25750002
257600                                                                  25760002
257700     EXEC CICS                                                    25770002
257800          WRITEQ TD                                               25780002
257900           QUEUE   ('CSSL')                                       25790002
258000            FROM   (PV-CICS-MSG-AREA)                             25800002
258100          LENGTH   (PV-COMMAREA-LENGTH)                           25810002
258200            RESP   (PV-CICS-RESP)                                 25820002
258300     END-EXEC.                                                    25830002
258400                                                                  25840002
