000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             CMKUT007.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            10-29-2021.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL PROCESS IDENTIFIED CICS TRANSACTION    *00120000
001300*  FAILURES, AND FACILITATE INCIDENT CREATION FOR CASES THAT     *00130000
001400*  REQUIRE IT.                                                   *00140000
001500******************************************************************00150000
001600                                                                  00160000
001700******************************************************************00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900******************************************************************00190000
002000                                                                  00200000
002010 CONFIGURATION SECTION.                                           00201000
002020                                                                  00202000
002030 SOURCE-COMPUTER.        IBM-3090.                                00203000
002040 OBJECT-COMPUTER.        IBM-3090.                                00204000
002050                                                                  00205000
002060 INPUT-OUTPUT SECTION.                                            00206000
002070                                                                  00207000
002080 FILE-CONTROL.                                                    00208000
002090                                                                  00209000
002100     SELECT TRANSACTION-SYSID-FILE                                00210000
002200         ASSIGN TO INP01.                                         00220000
002300                                                                  00230000
002400     SELECT SYSTEM-ID-DEFAULT-FILE                                00240000
002500         ASSIGN TO INP02.                                         00250000
002600                                                                  00260000
002700     SELECT TRANSACTION-EXCP-FILE                                 00270000
002800         ASSIGN TO INP03.                                         00280000
002900                                                                  00290000
003000     SELECT CICS-ABEND-EXCP-FILE                                  00300000
003100         ASSIGN TO INP04.                                         00310000
003200                                                                  00320000
003300     SELECT INCIDENT-IMAGE-FILE                                   00330000
003400         ASSIGN TO OUT01.                                         00340000
003500                                                                  00350000
003600******************************************************************00360000
003700 DATA DIVISION.                                                   00370000
003800******************************************************************00380000
003900                                                                  00390000
004000 FILE SECTION.                                                    00400000
004100                                                                  00410000
004200 FD  TRANSACTION-SYSID-FILE                                       00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     BLOCK CONTAINS 0 RECORDS                                     00450000
004600     RECORD CONTAINS 80 CHARACTERS                                00460000
004700     DATA RECORD IS TS-TRANSACTION-SYSID-RECORD.                  00470000
004800                                                                  00480000
004900 01  TS-TRANSACTION-SYSID-RECORD PIC X(80).                       00490000
005000                                                                  00500000
005100 FD  SYSTEM-ID-DEFAULT-FILE                                       00510000
005200     RECORDING MODE IS F                                          00520000
005300     LABEL RECORDS ARE STANDARD                                   00530000
005400     BLOCK CONTAINS 0 RECORDS                                     00540000
005500     RECORD CONTAINS 80 CHARACTERS                                00550000
005600     DATA RECORD IS SI-SYSTEM-ID-DEFAULT-RECORD.                  00560000
005700                                                                  00570000
005800 01  SI-SYSTEM-ID-DEFAULT-RECORD PIC X(80).                       00580000
005900                                                                  00590000
006000 FD  TRANSACTION-EXCP-FILE                                        00600000
006100     RECORDING MODE IS F                                          00610000
006200     LABEL RECORDS ARE STANDARD                                   00620000
006300     BLOCK CONTAINS 0 RECORDS                                     00630000
006400     RECORD CONTAINS 80 CHARACTERS                                00640000
006500     DATA RECORD IS TE-TRANSACTION-EXCP-RECORD.                   00650000
006600                                                                  00660000
006700 01  TE-TRANSACTION-EXCP-RECORD  PIC X(80).                       00670000
006800                                                                  00680000
006900 FD  CICS-ABEND-EXCP-FILE                                         00690000
007000     RECORDING MODE IS F                                          00700000
007100     LABEL RECORDS ARE STANDARD                                   00710000
007200     BLOCK CONTAINS 0 RECORDS                                     00720000
007300     RECORD CONTAINS 80 CHARACTERS                                00730000
007400     DATA RECORD IS CA-CICS-ABEND-EXCP-RECORD.                    00740000
007500                                                                  00750000
007600 01  CA-CICS-ABEND-EXCP-RECORD   PIC X(80).                       00760000
007700                                                                  00770000
007800 FD  INCIDENT-IMAGE-FILE                                          00780000
007900     RECORDING MODE IS F                                          00790000
008000     LABEL RECORDS ARE STANDARD                                   00800000
008100     BLOCK CONTAINS 0 RECORDS                                     00810000
008200     RECORD CONTAINS 350 CHARACTERS                               00820000
008300     DATA RECORD IS II-INCIDENT-IMAGE-RECORD.                     00830000
008400                                                                  00840000
008500 01  II-INCIDENT-IMAGE-RECORD    PIC X(350).                      00850000
008600                                                                  00860000
008700 WORKING-STORAGE SECTION.                                         00870000
008800                                                                  00880000
008900*                                                                 00890000
009000*  CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORD LAYOUT     00900000
009100*                                                                 00910000
009200     COPY CMRD004.                                                00920000
009300                                                                  00930000
009400*                                                                 00940000
009500*  CICS TRANSACTION ID TO SYSTEM ID ASSOCIATION RECORD LAYOUT     00950000
009600*                                                                 00960000
009700     COPY CMRD006.                                                00970000
009800                                                                  00980000
009900*                                                                 00990000
010000*  CICS TRANSACTION ID INCIDENT EXCEPTIONS RECORD LAYOUT          01000000
010100*                                                                 01010000
010200     COPY CMRD007.                                                01020000
010300                                                                  01030000
010400 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         01040000
010500                                              COMP SYNC.          01050000
010600     88  AC-CONTROL-CARD-ERROR                VALUE +4003.        01060000
010700                                                                  01070000
010800 01  PS-PROGRAM-SWITCHES.                                         01080000
010900     05  PS-END-OF-TRAN-SYSID-FILE-IND                            01090000
011000                                 PIC X(1)     VALUE 'N'.          01100000
011100         88  PS-END-OF-TRAN-SYSID-FILE        VALUE 'Y'.          01110000
011200     05  PS-END-OF-SYSID-DFLT-FILE-IND                            01120000
011300                                 PIC X(1)     VALUE 'N'.          01130000
011400         88  PS-END-OF-SYSID-DFLT-FILE        VALUE 'Y'.          01140000
011500     05  PS-END-OF-TRAN-EXCP-FILE-IND                             01150000
011600                                 PIC X(1)     VALUE 'N'.          01160000
011700         88  PS-END-OF-TRAN-EXCP-FILE         VALUE 'Y'.          01170000
011800     05  PS-END-OF-ABEND-EXCP-FILE-IND                            01180000
011900                                 PIC X(1)     VALUE 'N'.          01190000
012000         88  PS-END-OF-ABEND-EXCP-FILE        VALUE 'Y'.          01200000
012100     05  PS-PARAMETER-OVERFLOW-IND                                01210000
012200                                 PIC X(1)     VALUE 'N'.          01220000
012300         88  PS-PARAMETER-OVERFLOW            VALUE 'Y'.          01230000
012400         88  PS-NO-PARAMETER-OVERFLOW         VALUE 'N'.          01240000
012500     05  PS-TRANSACTION-SYSID-FOUND-IND                           01250000
012600                                 PIC X(1)     VALUE 'N'.          01260000
012700         88  PS-TRANSACTION-SYSID-FOUND       VALUE 'Y'.          01270000
012800         88  PS-TRANSACTION-SYSID-NOT-FOUND   VALUE 'N'.          01280000
012900     05  PS-SYSID-DFLT-FOUND-IND                                  01290000
013000                                 PIC X(1)     VALUE 'N'.          01300000
013100         88  PS-SYSID-DFLT-FOUND              VALUE 'Y'.          01310000
013200         88  PS-SYSID-DFLT-NOT-FOUND          VALUE 'N'.          01320000
013300     05  PS-TRANSACTION-EXCP-FOUND-IND                            01330000
013400                                 PIC X(1)     VALUE 'N'.          01340000
013500         88  PS-TRANSACTION-EXCP-FOUND        VALUE 'Y'.          01350000
013600         88  PS-TRANSACTION-EXCP-NOT-FOUND    VALUE 'N'.          01360000
013700     05  PS-CICS-ABEND-EXCP-FOUND-IND                             01370000
013800                                 PIC X(1)     VALUE 'N'.          01380000
013900         88  PS-CICS-ABEND-EXCP-FOUND         VALUE 'Y'.          01390000
014000         88  PS-CICS-ABEND-EXCP-NOT-FOUND     VALUE 'N'.          01400000
014100     05  PS-DEFAULT-ASSIGNMENT-IND                                01410000
014200                                 PIC X(1)     VALUE 'N'.          01420000
014300         88  PS-USE-DEFAULT-ASSIGNMENT        VALUE 'Y'.          01430000
014400         88  PS-DONT-USE-DEFAULT-ASSIGNMENT   VALUE 'N'.          01440000
014500     05  PS-CREATE-INCIDENT-IND  PIC X(1)     VALUE 'Y'.          01450000
014600         88  PS-CREATE-INCIDENT               VALUE 'Y'.          01460000
014700         88  PS-DONT-CREATE-INCIDENT          VALUE 'N'.          01470000
014800                                                                  01480000
014900 01  PC-PROGRAM-CONSTANTS.                                        01490000
015000     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'CMKUT007'.   01500000
015100     05  PC-PARAMETER-LIST-SIZE  PIC S9(4)    VALUE 100           01510000
015200                                              COMP SYNC.          01520000
015300     05  PC-DEFAULT-PARAMETER-COUNT                               01530000
015400                                 PIC S9(4)    VALUE 5             01540000
015500                                              COMP SYNC.          01550000
015600     05  PC-ERROR-DISPLAY-TAG    PIC X(12)    VALUE               01560000
015700         '** ERROR ** '.                                          01570000
015800     05  PC-COMMA-SEPARATOR      PIC X(1)     VALUE ','.          01580000
015900     05  PC-SEMICOLON            PIC X(1)     VALUE ';'.          01590000
016000     05  PC-COMPUTER-TYPE        PIC X(7)     VALUE 'TYPE=MF'.    01600000
016100     05  PC-COMPUTER-SRC         PIC X(4)     VALUE 'SRC='.       01610000
016200     05  PC-JOB-NAME             PIC X(6)     VALUE 'PRGNM='.     01620000
016300     05  PC-JOB-STEP             PIC X(6)     VALUE 'STPNM='.     01630000
016400     05  PC-JOB-NUMBER           PIC X(6)     VALUE 'JBNBR='.     01640000
016500     05  PC-JOB-RC               PIC X(6)     VALUE 'RTNCD='.     01650000
016600     05  PC-JOB-DATE             PIC X(4)     VALUE 'DAY='.       01660000
016700     05  PC-JOB-TIME             PIC X(5)     VALUE 'TIME='.      01670000
016800     05  PC-NOT-APPLICABLE       PIC X(3)     VALUE 'N/A'.        01680000
016900     05  PC-CICS-INCIDENT        PIC X(20)    VALUE               01690000
017000         'DESC=CICS/TRANS'.                                       01700000
017100     05  PC-IMPACT               PIC X(4)     VALUE 'IMP='.       01710000
017200     05  PC-URGENCY              PIC X(4)     VALUE 'URG='.       01720000
017300     05  PC-ASSIGNMENT-GROUP     PIC X(4)     VALUE 'GRP='.       01730000
017400                                                                  01740000
017500 01  PV-PROGRAM-VARIABLES.                                        01750000
017600     05  PV-PARAMETER-LIST-SIZE-DISPLAY                           01760000
017700                                 PIC ZZZ9     VALUE ZEROS.        01770000
017800     05  PV-PARAMETER-LIST       PIC X(100)   VALUE SPACES.       01780000
017900     05  PV-PARAMETER-LIST-REST  PIC X(100)   VALUE SPACES.       01790000
018000*                                                                 01800000
018100*    THE PARAMETER STRING IS PASSED FROM AN EXEC STATEMENT        01810000
018200*    WITH "," DELIMITERS ON THE INDIVIDUAL VALUES.  THE MAXIMUM   01820000
018300*    PARAMETER LENGTH THAT CAN BE PASSED FROM JCL IS 100          01830000
018400*    CHARACTERS.                                                  01840000
018500*                                                                 01850000
018600     05  PV-PARAMETER-FIELDS.                                     01860000
018700         10 PV-PARM-SYSNAME      PIC X(8)     VALUE SPACES.       01870000
018800         10 PV-PARM-M3           PIC X(17)    VALUE SPACES.       01880000
018900         10 PV-PARM-M4           PIC X(10)    VALUE SPACES.       01890000
019000         10 PV-PARM-M5           PIC X(10)    VALUE SPACES.       01900000
019100         10 PV-PARM-M6           PIC X(40)    VALUE SPACES.       01910000
019200     05  PV-PARAMETER-POINTER    PIC S9(9)    VALUE ZEROS         01920000
019300                                              COMP SYNC.          01930000
019400     05  PV-PARAMETER-LIST-OVERFLOW                               01940000
019500                                 PIC X(100)   VALUE SPACES.       01950000
019600     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         01960000
019700                                              COMP SYNC.          01970000
019800     05  PV-CICS-REGION          PIC X(8)     VALUE SPACES.       01980000
019900     05  PV-TRANSACTION-ID       PIC X(4)     VALUE SPACES.       01990000
020000     05  PV-PROGRAM-NAME         PIC X(8)     VALUE SPACES.       02000000
020100     05  PV-CICS-ABEND-CODE      PIC X(4)     VALUE SPACES.       02010000
020200     05  PV-INCIDENT-DESCRIPTION PIC X(45)    VALUE SPACES.       02020000
020300     05  PV-ASSIGNMENT-INFORMATION.                               02030000
020400         10  PV-AI-SYSTEM-ID     PIC X(2).                        02040000
020500             88  PV-AI-INFRASTRUCTURE-SYSTEM-ID                   02050000
020600                                              VALUE 'DP'.         02060000
020700         10  PV-AI-IMPACT        PIC X(1).                        02070000
020800             88  PV-AI-DEFAULT-IMPACT         VALUE '4'.          02080000
020900         10  PV-AI-URGENCY       PIC X(1).                        02090000
021000             88  PV-AI-DEFAULT-URGENCY        VALUE '2'.          02100000
021100         10  PV-AI-ASSIGNMENT-GROUP                               02110000
021200                                 PIC X(60).                       02120000
021300             88  PV-AI-DEFAULT-ASSIGNMENT     VALUE               02130000
021400                 'Mainframe Technical Support - CICS'.            02140000
021500         10  PV-AI-FINAL-ASSIGNMENT-GROUP                         02150000
021600                                 PIC X(80).                       02160000
021700     05  PV-JOB-NAME-TRUNC       PIC X(17)    VALUE SPACES.       02170000
021800     05  PV-INCIDENT-TYPE-TRUNC  PIC X(10)    VALUE SPACES.       02180000
021900     05  PV-INCIDENT-MESSAGE-TEXT                                 02190000
022000                                 PIC X(250)   VALUE SPACES.       02200000
022100     05  PV-CURRENT-ERROR        PIC X(100)   VALUE SPACES.       02210000
022200         88  PV-CE-JOB-NAME-LENGTH            VALUE               02220000
022300             'PARSED JOB NAME IS LONGER THAN ACCEPTABLE LENGTH'.  02230000
022400     05  PV-CURRENT-DATE-JULIAN  PIC 9(5)     VALUE ZEROS.        02240000
022500     05  PV-CURRENT-DATE         PIC X(8)     VALUE SPACES.       02250000
022600     05  FILLER                  REDEFINES PV-CURRENT-DATE.       02260000
022700         10  PV-CD-YEAR          PIC 9(4).                        02270000
022800         10  PV-CD-MONTH         PIC 9(2).                        02280000
022900         10  PV-CD-DAY           PIC 9(2).                        02290000
023000     05  PV-CURRENT-INCIDENT-TIME.                                02300000
023100         10  PV-CI-HOUR          PIC 9(2)     VALUE ZEROS.        02310000
023200         10  FILLER              PIC X(1)     VALUE ':'.          02320000
023300         10  PV-CI-MINUTE        PIC 9(2)     VALUE ZEROS.        02330000
023400         10  FILLER              PIC X(1)     VALUE ':'.          02340000
023500         10  PV-CI-SECOND        PIC 9(2)     VALUE ZEROS.        02350000
023600         10  FILLER              PIC X(1)     VALUE '.'.          02360000
023700         10  PV-CI-SECOND-HUNDREDTHS                              02370000
023800                                 PIC 9(2)     VALUE ZEROS.        02380000
023900     05  PV-CURRENT-TIME.                                         02390000
024000         10  PV-CT-HOUR          PIC 9(2)     VALUE ZEROS.        02400000
024100         10  PV-CT-MINUTE        PIC 9(2)     VALUE ZEROS.        02410000
024200         10  PV-CT-SECOND        PIC 9(2)     VALUE ZEROS.        02420000
024300         10  PV-CT-SECOND-HUNDREDTHS                              02430000
024400                                 PIC 9(2)     VALUE ZEROS.        02440000
024500                                                                  02450000
024600 01  CA-CICS-ABEND-EXCEPTION-RECORD.                              02460000
024700     05  CA-CICS-ABEND-CODE      PIC X(4)     VALUE SPACES.       02470000
024800     05  FILLER                  PIC X(1)     VALUE SPACES.       02480000
024810     05  CA-TRANSACTION-ID       PIC X(4)     VALUE SPACES.       02481000
024811         88  CA-ALL-TRANSACTION-IDS           VALUE SPACES.       02481100
024820     05  FILLER                  PIC X(71)    VALUE SPACES.       02482000
024900                                                                  02490000
025000 01  PT-PROGRAM-TOTALS.                                           02500000
025100     05  PT-TRANID-SYSID-RCDS-READ                                02510000
025200                                 PIC S9(7)    VALUE ZEROS         02520000
025300                                              COMP-3.             02530000
025400     05  PT-SYSID-DFLT-RECORDS-READ                               02540000
025500                                 PIC S9(7)    VALUE ZEROS         02550000
025600                                              COMP-3.             02560000
025700     05  PT-TRANID-EXCP-RECORDS-READ                              02570000
025800                                 PIC S9(7)    VALUE ZEROS         02580000
025900                                              COMP-3.             02590000
026000     05  PT-ABEND-EXCP-RECORDS-READ                               02600000
026100                                 PIC S9(7)    VALUE ZEROS         02610000
026200                                              COMP-3.             02620000
026300     05  PT-INC-IMAGE-RCDS-WRITTEN                                02630000
026400                                 PIC S9(7)    VALUE ZEROS         02640000
026500                                              COMP-3.             02650000
026600                                                                  02660000
026700 01  TD-TOTAL-DISPLAY-MESSAGE.                                    02670000
026800     05  TD-TOTAL-ID             PIC X(51)    VALUE SPACE.        02680000
026900         88  TD-TRANID-SYSID-RCDS-READ-ID     VALUE               02690000
027000             'TRANSACTION TO SYSTEM ID RECORDS READ  . . . . . '. 02700000
027100         88  TD-SYSID-DFLT-RECORDS-READ-ID    VALUE               02710000
027200             'SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORDS READ. '. 02720000
027300         88  TD-TRANID-EXCP-RECORDS-READ-ID   VALUE               02730000
027400             'TRANSACTION ID EXCEPTION RECORDS READ  . . . . . '. 02740000
027500         88  TD-ABEND-EXCP-RECORDS-READ-ID    VALUE               02750000
027600             'CICS ABEND CODE EXCEPTION RECORDS READ . . . . . '. 02760000
027700         88  TD-INC-IMAGE-RCDS-WRITTEN-ID                         02770000
027800                                              VALUE               02780000
027900             'CICS INCIDENT IMAGE RECORDS WRITTEN  . . . . . . '. 02790000
028000     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    02800000
028100                                              VALUE ZEROS.        02810000
028200                                                                  02820000
028300******************************************************************02830000
028400 LINKAGE SECTION.                                                 02840000
028500******************************************************************02850000
028600                                                                  02860000
028700 01  LS-PARAMETER-LIST.                                           02870000
028800     05  LS-PARAMETER-LIST-SIZE  PIC S9(4)    COMP.               02880000
028900     05  LS-PARAMETER-LIST-DISPLAY.                               02890000
029000         10  LS-PARAMETER-LIST-DETAIL                             02900000
029100                                 PIC X(100).                      02910000
029200                                                                  02920000
029300******************************************************************02930000
029400 PROCEDURE DIVISION USING LS-PARAMETER-LIST.                      02940000
029500******************************************************************02950000
029600                                                                  02960000
029700 0000-MAINLINE.                                                   02970000
029800                                                                  02980000
029900     PERFORM 1000-INITIALIZE.                                     02990000
030000                                                                  03000000
030100     PERFORM 2000-FIND-TRANSACTION-DETAILS.                       03010000
030200                                                                  03020000
030300     PERFORM 5000-SET-FINAL-ASSIGNMENT.                           03030000
030400                                                                  03040000
030500     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         03050000
030600                                                                  03060000
030700     PERFORM 9000-EOJ-ROUTINE.                                    03070000
030800                                                                  03080000
030900     STOP RUN.                                                    03090000
031000                                                                  03100000
031100******************************************************************03110000
031200*  INITIALIZE FOR PROGRAM PROCESSING.  VALIDATE THE PARAMETER    *03120000
031300*  LIST.                                                         *03130000
031400******************************************************************03140000
031500                                                                  03150000
031600 1000-INITIALIZE.                                                 03160000
031700     IF (LS-PARAMETER-LIST-SIZE > ZEROES)                         03170000
031800         MOVE LS-PARAMETER-LIST-DISPLAY(1:LS-PARAMETER-LIST-SIZE) 03180000
031900                   TO PV-PARAMETER-LIST                           03190000
032000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - PARAMETER LIST = "'  03200000
032100                   PV-PARAMETER-LIST(1:LS-PARAMETER-LIST-SIZE)    03210000
032200                   '"'                                            03220000
032300         IF (PV-PARAMETER-LIST = SPACES)                          03230000
032400             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                03240000
032500                       PC-ERROR-DISPLAY-TAG ' - BLANK PARAMETERS '03250000
032600                       'PASSED'                                   03260000
032700             SET AC-CONTROL-CARD-ERROR TO TRUE                    03270000
032800             CALL 'ILBOABN0' USING ABEND-CODE                     03280000
032900         ELSE                                                     03290000
033000             IF (LS-PARAMETER-LIST-SIZE > PC-PARAMETER-LIST-SIZE) 03300000
033100                 MOVE LS-PARAMETER-LIST-SIZE TO                   03310000
033200                           PV-PARAMETER-LIST-SIZE-DISPLAY         03320000
033300                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '   03330000
033400                           'PARAMETER LIST SIZE'                  03340000
033500                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - PARAMETER ' 03350000
033600                           'LIST SIZE OF '                        03360000
033700                           PV-PARAMETER-LIST-SIZE-DISPLAY         03370000
033800                           ' DETECTED'                            03380000
033900                 SET AC-CONTROL-CARD-ERROR TO TRUE                03390000
034000                 CALL 'ILBOABN0' USING ABEND-CODE                 03400000
034100             END-IF                                               03410000
034200         END-IF                                                   03420000
034300     ELSE                                                         03430000
034400         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    03440000
034500                   PC-ERROR-DISPLAY-TAG ' - NO PARAMETERS PASSED' 03450000
034600         SET AC-CONTROL-CARD-ERROR TO TRUE                        03460000
034700         CALL 'ILBOABN0' USING ABEND-CODE                         03470000
034800     END-IF.                                                      03480000
034900                                                                  03490000
035000     INITIALIZE PV-PARAMETER-FIELDS                               03500000
035100                PV-TALLY.                                         03510000
035200     MOVE +1 TO PV-PARAMETER-POINTER.                             03520000
035300     SET PS-NO-PARAMETER-OVERFLOW TO TRUE.                        03530000
035400     UNSTRING PV-PARAMETER-LIST                                   03540000
035500         DELIMITED BY ","                                         03550000
035600         INTO PV-PARM-SYSNAME                                     03560000
035700              PV-PARM-M3                                          03570000
035800              PV-PARM-M4                                          03580000
035900              PV-PARM-M5                                          03590000
036000              PV-PARM-M6                                          03600000
036100         WITH POINTER PV-PARAMETER-POINTER                        03610000
036200         TALLYING IN PV-TALLY                                     03620000
036300         ON OVERFLOW SET PS-PARAMETER-OVERFLOW TO TRUE            03630000
036400     END-UNSTRING.                                                03640000
036500                                                                  03650000
036600     IF (PS-PARAMETER-OVERFLOW)                                   03660000
036700         MOVE LS-PARAMETER-LIST-DETAIL (PV-PARAMETER-POINTER:     03670000
036800                   (LS-PARAMETER-LIST-SIZE -                      03680000
036900                   PV-PARAMETER-POINTER + 1)) TO                  03690000
037000             PV-PARAMETER-LIST-OVERFLOW                           03700000
037100         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    03710000
037200                   PC-ERROR-DISPLAY-TAG                           03720000
037300                   ' - PARAMETER OVERFLOW ERROR'                  03730000
037400         DISPLAY PC-CURRENT-PROGRAM-NAME                          03740000
037500                   ' -     CURRENT POINTER = '                    03750000
037600                   PV-PARAMETER-POINTER                           03760000
037700         DISPLAY PC-CURRENT-PROGRAM-NAME                          03770000
037800                   ' -     OVERFLOW DETAILS = '                   03780000
037900                   PV-PARAMETER-LIST-OVERFLOW                     03790000
038000         SET AC-CONTROL-CARD-ERROR TO TRUE                        03800000
038100         CALL 'ILBOABN0' USING ABEND-CODE                         03810000
038200     END-IF.                                                      03820000
038300                                                                  03830000
038400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - PARSED PARAMETERS '     03840000
038500     DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     SYSNAME = '         03850000
038600               PV-PARM-SYSNAME.                                   03860000
038700     DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     M3 = '              03870000
038800               PV-PARM-M3.                                        03880000
038900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     M4 = '              03890000
039000               PV-PARM-M4.                                        03900000
039100     DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     M5 = '              03910000
039200               PV-PARM-M5.                                        03920000
039300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     M6 = '              03930000
039400               PV-PARM-M6.                                        03940000
039500                                                                  03950000
039600     IF (PV-TALLY NOT = PC-DEFAULT-PARAMETER-COUNT)               03960000
039700         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    03970000
039800                   PC-ERROR-DISPLAY-TAG ' - INVALID PARAMETER '   03980000
039900                   'COUNT'                                        03990000
040000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - PARAMETER COUNT = ' 04000000
040100                   PV-TALLY                                       04010000
040200         SET AC-CONTROL-CARD-ERROR TO TRUE                        04020000
040300         CALL 'ILBOABN0' USING ABEND-CODE                         04030000
040400     END-IF.                                                      04040000
040500                                                                  04050000
040600     MOVE PV-PARM-M3 TO PV-CICS-REGION.                           04060000
040700     MOVE PV-PARM-M4 TO PV-TRANSACTION-ID.                        04070000
040800     MOVE PV-PARM-M5 TO PV-PROGRAM-NAME.                          04080000
040900     MOVE PV-PARM-M6 TO PV-CICS-ABEND-CODE.                       04090000
041000                                                                  04100000
041100     OPEN OUTPUT INCIDENT-IMAGE-FILE.                             04110000
041200                                                                  04120000
041300     ACCEPT PV-CURRENT-DATE-JULIAN FROM DAY.                      04130000
041400     MOVE FUNCTION CURRENT-DATE (1:4) TO PV-CD-YEAR.              04140000
041500     MOVE FUNCTION CURRENT-DATE (5:2) TO PV-CD-MONTH.             04150000
041600     MOVE FUNCTION CURRENT-DATE (7:2) TO PV-CD-DAY.               04160000
041700     MOVE FUNCTION CURRENT-DATE (9:2) TO PV-CI-HOUR               04170000
041800                                         PV-CT-HOUR.              04180000
041900     MOVE FUNCTION CURRENT-DATE (11:2) TO PV-CI-MINUTE            04190000
042000                                          PV-CT-MINUTE.           04200000
042100     MOVE FUNCTION CURRENT-DATE (13:2) TO PV-CI-SECOND            04210000
042200                                          PV-CT-SECOND.           04220000
042300     MOVE FUNCTION CURRENT-DATE (15:2) TO PV-CI-SECOND-HUNDREDTHS 04230000
042400                                          PV-CT-SECOND-HUNDREDTHS.04240000
042500*1000-EXIT.                                                       04250000
042600                                                                  04260000
042700******************************************************************04270000
042800*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *04280000
042900******************************************************************04290000
043000                                                                  04300000
043100 1500-DISPLAY-PROGRAM-TOTALS.                                     04310000
043200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '.                      04320000
043300                                                                  04330000
043400     SET TD-TRANID-SYSID-RCDS-READ-ID TO TRUE                     04340000
043500     MOVE PT-TRANID-SYSID-RCDS-READ TO TD-TOTAL-AMOUNT.           04350000
043600     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       04360000
043700               TD-TOTAL-DISPLAY-MESSAGE.                          04370000
043800                                                                  04380000
043900     SET TD-SYSID-DFLT-RECORDS-READ-ID TO TRUE.                   04390000
044000     MOVE PT-SYSID-DFLT-RECORDS-READ TO TD-TOTAL-AMOUNT.          04400000
044100     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       04410000
044200               TD-TOTAL-DISPLAY-MESSAGE.                          04420000
044300                                                                  04430000
044400     SET TD-TRANID-EXCP-RECORDS-READ-ID TO TRUE.                  04440000
044500     MOVE PT-TRANID-EXCP-RECORDS-READ TO TD-TOTAL-AMOUNT.         04450000
044600     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       04460000
044700               TD-TOTAL-DISPLAY-MESSAGE.                          04470000
044800                                                                  04480000
044900     SET TD-ABEND-EXCP-RECORDS-READ-ID TO TRUE.                   04490000
045000     MOVE PT-ABEND-EXCP-RECORDS-READ TO TD-TOTAL-AMOUNT.          04500000
045100     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       04510000
045200               TD-TOTAL-DISPLAY-MESSAGE.                          04520000
045300                                                                  04530000
045400     SET TD-INC-IMAGE-RCDS-WRITTEN-ID TO TRUE.                    04540000
045500     MOVE PT-INC-IMAGE-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.           04550000
045600     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       04560000
045700               TD-TOTAL-DISPLAY-MESSAGE.                          04570000
045800*1500-EXIT.                                                       04580000
045900                                                                  04590000
046000******************************************************************04600000
046100*  FIND THE TRANSACTION DETAILS FOR THE CURRENT TRANSACTION ID,  *04610000
046200*  AND CHECK FOR INCIDENT EXCEPTIONS FOR THE CURRENT CICS ABEND  *04620000
046300*  CODE.                                                         *04630000
046400******************************************************************04640000
046500                                                                  04650000
046600 2000-FIND-TRANSACTION-DETAILS.                                   04660000
046700     PERFORM 4000-FIND-SYSTEM-ID.                                 04670000
046800                                                                  04680000
046900     IF (PS-TRANSACTION-SYSID-NOT-FOUND)                          04690000
047000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - TRANSACTION ID '     04700000
047100                   'TO SYSTEM ID ASSOCIATION NOT FOUND'           04710000
047200         DISPLAY PC-CURRENT-PROGRAM-NAME ' - THIS WILL DEFAULT '  04720000
047300                   'TO BEING TREATED AS AN INFRASTRUCTURE '       04730000
047400                   'TRANSACTION'                                  04740000
047500         SET PV-AI-INFRASTRUCTURE-SYSTEM-ID TO TRUE               04750000
047600     ELSE                                                         04760000
047700         DISPLAY PC-CURRENT-PROGRAM-NAME ' - TRANSACTION ID '     04770000
047800                   PV-TRANSACTION-ID ' IS ASSOCIATED TO THE '     04780000
047900                   CM006-SYSTEM-ID ' SYSTEM ID'                   04790000
048000         MOVE CM006-SYSTEM-ID TO PV-AI-SYSTEM-ID                  04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048300     PERFORM 4100-FIND-SYSID-DEFAULT.                             04830000
048400                                                                  04840000
048500     IF (PS-SYSID-DFLT-NOT-FOUND)                                 04850000
048600         INITIALIZE PV-CURRENT-ERROR                              04860000
048700         DISPLAY PC-CURRENT-PROGRAM-NAME ' - NO SYSTEM ID '       04870000
048800                   'DEFAULT ASSIGNMENT GROUP FOUND FOR SYSTEM ID '04880000
048900                 PV-AI-SYSTEM-ID                                  04890000
049000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - THIS WILL DEFAULT '  04900000
049100                   'TO BEING ASSIGNED TO MAINFRAME TECHNICAL '    04910000
049200                   'SUPPORT'                                      04920000
049300         SET PV-AI-DEFAULT-ASSIGNMENT TO TRUE                     04930000
049400     ELSE                                                         04940000
049500         DISPLAY PC-CURRENT-PROGRAM-NAME ' - THE DEFAULT '        04950000
049600                   'ASSIGNMENT GROUP FOUND FOR SYSTEM ID '        04960000
049700                   PV-AI-SYSTEM-ID ' IS ' CM004-ASSIGNMENT-GROUP  04970000
049800         MOVE CM004-ASSIGNMENT-GROUP TO PV-AI-ASSIGNMENT-GROUP    04980000
049900     END-IF.                                                      04990000
050000                                                                  05000000
050100     SET PS-USE-DEFAULT-ASSIGNMENT TO TRUE.                       05010000
050200     SET PV-AI-DEFAULT-IMPACT                                     05020000
050300         PV-AI-DEFAULT-URGENCY TO TRUE.                           05030000
050400     MOVE PV-AI-ASSIGNMENT-GROUP TO PV-AI-FINAL-ASSIGNMENT-GROUP. 05040000
050500                                                                  05050000
050600     PERFORM 4200-FIND-TRANSACTION-EXCP.                          05060000
050700                                                                  05070000
050800     IF (PS-TRANSACTION-EXCP-FOUND)                               05080000
050810         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                   05081004
050900         DISPLAY PC-CURRENT-PROGRAM-NAME ' - AN INCIDENT '        05090000
051000                   'EXCEPTION WAS FOUND FOR TRANSACTION ID '      05100000
051100                   PV-TRANSACTION-ID                              05110000
051200         IF (CM007-SUPPRESS-INCIDENT)                             05120000
051300             DISPLAY PC-CURRENT-PROGRAM-NAME ' - TRANSACTION '    05130000
051400                       'ID ' PV-TRANSACTION-ID ' HAS INCIDENTS '  05140000
051500                       'SUPPRESSED - NO INCIDENT WILL BE CREATED' 05150000
051600         END-IF                                                   05160000
051700         IF (CM007-OVERRIDE-IMPACT NOT = SPACES)                  05170000
051800             DISPLAY PC-CURRENT-PROGRAM-NAME ' - IMPACT '         05180000
051900                       'OVERRIDDEN TO ' CM007-OVERRIDE-IMPACT     05190000
052000             MOVE CM007-OVERRIDE-IMPACT TO PV-AI-IMPACT           05200000
052100         END-IF                                                   05210000
052200         IF (CM007-OVERRIDE-URGENCY NOT = SPACES)                 05220000
052300             DISPLAY PC-CURRENT-PROGRAM-NAME ' - URGENCY '        05230000
052400                       'OVERRIDDEN TO ' CM007-OVERRIDE-URGENCY    05240000
052500             MOVE CM007-OVERRIDE-URGENCY TO PV-AI-URGENCY         05250000
052600         END-IF                                                   05260000
052700         IF (CM007-OVERRIDE-ASSIGNMENT-GRP NOT = SPACES)          05270000
052800             DISPLAY PC-CURRENT-PROGRAM-NAME ' - ASSIGNMENT '     05280000
052900                       'GROUP OVERRIDEN TO '                      05290000
053000                       CM007-OVERRIDE-ASSIGNMENT-GRP              05300000
053100             MOVE CM007-OVERRIDE-ASSIGNMENT-GRP TO                05310000
053200                       PV-AI-FINAL-ASSIGNMENT-GROUP               05320000
053300             SET PS-DONT-USE-DEFAULT-ASSIGNMENT TO TRUE           05330000
053400         END-IF                                                   05340000
053500     END-IF.                                                      05350000
053600                                                                  05360000
053700     PERFORM 4300-FIND-CICS-ABEND-EXCP.                           05370000
053800                                                                  05380000
053900     IF (PS-CICS-ABEND-EXCP-FOUND)                                05390000
053910         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                   05391004
054000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - A CICS ABEND CODE '  05400000
054100                   'EXCEPTION WAS FOUND FOR ' PV-CICS-ABEND-CODE  05410000
054110         IF (CA-TRANSACTION-ID NOT = SPACES)                      05411000
054111             DISPLAY PC-CURRENT-PROGRAM-NAME ' - THE EXCEPTION '  05411100
054112                       'IS SPECIFIC TO THE '  CA-TRANSACTION-ID   05411200
054113                       ' TRANSACTION ID'                          05411302
054120         END-IF                                                   05412000
054200         DISPLAY PC-CURRENT-PROGRAM-NAME ' - NO INCIDENT WILL '   05420000
054300                   'BE CREATED'                                   05430000
054400     END-IF.                                                      05440000
054500*2000-EXIT.                                                       05450000
054600                                                                  05460000
054700******************************************************************05470000
054800*  FIND THE SYSTEM ID ASSOCIATION WITH THE CURRENT TRANSACTION   *05480000
054900*  ID.  OPEN THE TRANSACTION ID TO SYSTEM ID ASSOCIATION FILE.   *05490000
055000*  READ AND EVALUATE THE CURRENT TRANSACTION ID VS. THE SINGLE   *05500000
055100*  TRANSACTION ID OR RANGE OF TRANSACTION IDS ON THE ASSOCIATION *05510000
055200*  RECORD UNTIL EITHER THE ASSOCIATION IS FOUND, OR THE END OF   *05520000
055300*  THE FILE HAS BEEN REACHED.  THE FILE WILL NOT BE READ BEYOND  *05530000
055400*  WHERE THE RECORD HAS BEEN FOUND, SO THE VARIABLES FOR THE     *05540000
055500*  RECORD LAYOUT CAN BE USED IN LATER PROCESSING.  CLOSE THE     *05550000
055600*  TRANSACTION ID TO SYSTEM ID ASSOCIATION FILE.                 *05560000
055700******************************************************************05570000
055800                                                                  05580000
055900 4000-FIND-SYSTEM-ID.                                             05590000
056000     SET PS-TRANSACTION-SYSID-NOT-FOUND TO TRUE.                  05600000
056100                                                                  05610000
056200     OPEN INPUT TRANSACTION-SYSID-FILE.                           05620000
056300                                                                  05630000
056400     PERFORM 7000-READ-TRAN-SYSID-FILE.                           05640000
056500                                                                  05650000
056600     PERFORM                                                      05660000
056700             UNTIL ((PS-END-OF-TRAN-SYSID-FILE)                   05670000
056800                     OR (PS-TRANSACTION-SYSID-FOUND))             05680000
056900         IF ((CM006-START-TRANSACTION-ID = PV-TRANSACTION-ID)     05690000
057000                 AND (CM006-SINGLE-TRANSACTION-ID))               05700000
057100             SET PS-TRANSACTION-SYSID-FOUND TO TRUE               05710000
057200         END-IF                                                   05720000
057300         IF ((CM006-START-TRANSACTION-ID <= PV-TRANSACTION-ID)    05730000
057400                 AND (CM006-END-TRANSACTION-ID >=                 05740000
057500                                            PV-TRANSACTION-ID))   05750000
057600             SET PS-TRANSACTION-SYSID-FOUND TO TRUE               05760000
057700         END-IF                                                   05770000
057800         IF (PS-TRANSACTION-SYSID-NOT-FOUND)                      05780000
057900             PERFORM 7000-READ-TRAN-SYSID-FILE                    05790000
058000         END-IF                                                   05800000
058100     END-PERFORM.                                                 05810000
058200                                                                  05820000
058300     CLOSE TRANSACTION-SYSID-FILE.                                05830000
058400*4000-EXIT.                                                       05840000
058500                                                                  05850000
058600******************************************************************05860000
058700*  FIND THE DEFAULT ASSIGNMENT GROUP FOR THE SYSTEM ID           *05870000
058800*  ASSOCIATED WITH THE CURRENT JOB NAME.  OPEN THE CALL LIST     *05880000
058900*  SYSTEM ID DEFAULT ASSIGNMENT GROUP FILE.  READ AND EVALUATE   *05890000
059000*  SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORDS UNTIL EITHER THE   *05900000
059100*  DEFAULT ASSIGNMENT FOR THE CURRENT SYSTEM ID IS FOUND, OR     *05910000
059200*  THE END OF THE FILE HAS BEEN REACHED.  THE FILE WILL NOT BE   *05920000
059300*  READ BEYOND WHERE THE RECORD HAS BEEN FOUND, SO THE VARIABLES *05930000
059400*  FOR THE RECORD LAYOUT CAN BE USED IN LATER PROCESSING.  CLOSE *05940000
059500*  THE CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUP FILE.        *05950000
059600******************************************************************05960000
059700                                                                  05970000
059800 4100-FIND-SYSID-DEFAULT.                                         05980000
059900     SET PS-SYSID-DFLT-NOT-FOUND TO TRUE.                         05990000
060000                                                                  06000000
060100     OPEN INPUT SYSTEM-ID-DEFAULT-FILE.                           06010000
060200                                                                  06020000
060300     PERFORM 7100-READ-SYSID-DFLT-FILE.                           06030000
060400                                                                  06040000
060500     PERFORM                                                      06050000
060600             UNTIL ((PS-END-OF-SYSID-DFLT-FILE)                   06060000
060700                     OR (PS-SYSID-DFLT-FOUND))                    06070000
060800         IF (CM004-SYSTEM-ID = PV-AI-SYSTEM-ID)                   06080000
060900             SET PS-SYSID-DFLT-FOUND TO TRUE                      06090000
061000         END-IF                                                   06100000
061100         IF (PS-SYSID-DFLT-NOT-FOUND)                             06110000
061200             PERFORM 7100-READ-SYSID-DFLT-FILE                    06120000
061300         END-IF                                                   06130000
061400     END-PERFORM.                                                 06140000
061500                                                                  06150000
061600     CLOSE SYSTEM-ID-DEFAULT-FILE.                                06160000
061700*4100-EXIT.                                                       06170000
061800                                                                  06180000
061900******************************************************************06190000
062000*  FIND ANY DEFINED TRANSACTION ID INCIDENT EXCEPTION.  OPEN THE *06200000
062100*  TRANSACTION ID INCIDENT EXCEPTION FILE.  READ AND EVALUATE    *06210000
062200*  TRANSACTION ID INCIDENT EXCEPTION RECORDS UNTIL EITHER AN     *06220000
062300*  EXCEPTION IS FOUND, OR THE END OF FILE HAS BEEN REACHED.      *06230000
062400*  THE FILE WILL NOT BE READ BEYOND WHERE THE RECORD HAS BEEN    *06240000
062500*  FOUND SO THE VARIABLES IN THE RECORD LAYOUT CAN BE USED IN    *06250000
062600*  LATER PROCESSING.  CLOSE THE TRANSACTION ID INCIDENT          *06260000
062700*  EXCEPTION FILE.                                               *06270000
062800******************************************************************06280000
062900                                                                  06290000
063000 4200-FIND-TRANSACTION-EXCP.                                      06300000
063100     SET PS-TRANSACTION-EXCP-NOT-FOUND TO TRUE.                   06310000
063200                                                                  06320000
063300     OPEN INPUT TRANSACTION-EXCP-FILE.                            06330000
063400                                                                  06340000
063500     PERFORM 7200-READ-TRAN-EXCP-FILE.                            06350000
063600                                                                  06360000
063700     PERFORM                                                      06370000
063800             UNTIL ((PS-END-OF-TRAN-EXCP-FILE)                    06380000
063900                     OR (PS-TRANSACTION-EXCP-FOUND))              06390000
064000         IF (CM007-TRANSACTION-ID = PV-TRANSACTION-ID)            06400000
064100             SET PS-TRANSACTION-EXCP-FOUND TO TRUE                06410000
064200         END-IF                                                   06420000
064300         IF (PS-TRANSACTION-EXCP-NOT-FOUND)                       06430000
064400             PERFORM 7200-READ-TRAN-EXCP-FILE                     06440000
064500         END-IF                                                   06450000
064600     END-PERFORM.                                                 06460000
064700                                                                  06470000
064800     CLOSE TRANSACTION-EXCP-FILE.                                 06480000
064900*4200-EXIT.                                                       06490000
065000                                                                  06500000
065100******************************************************************06510000
065200*  FIND ANY DEFINED CICS ABEND CODE INCIDENT EXCEPTION.  OPEN    *06520000
065300*  THE CICS ABEND CODE INCIDENT EXCEPTION FILE.  READ AND        *06530000
065400*  EVALUATE CICS ABEND CODE INCIDENT EXCEPTION RECORDS UNTIL     *06540000
065500*  EITHER AN EXCEPTION IS FOUND, OR THE END OF FILE HAS BEEN     *06550000
065601*  REACHED.  EXCEPTIONS CAN BE FOR SPECIFIC TRANSACTION IDS      *06560100
065610*  OR FOR ANY OCCURRENCE OF THE CICS ABEND CODE.  THE FILE       *06561000
065611*  WILL NOT BE READ BEYOND WHERE A MATCHING EXCEPTION IS FOUND   *06561100
065620*  SO THE VARIABLES IN THE RECORD LAYOUT CAN BE USED IN LATER    *06562000
065630*  PROCESSING.  CLOSE THE CICS ABEND CODE INCIDENT EXCEPTION     *06563000
065640*  FILE.                                                         *06564000
065700******************************************************************06570000
065800                                                                  06580000
065900 4300-FIND-CICS-ABEND-EXCP.                                       06590000
065910     SET PS-CICS-ABEND-EXCP-NOT-FOUND TO TRUE.                    06591000
065920                                                                  06592000
065930     OPEN INPUT CICS-ABEND-EXCP-FILE.                             06593000
065940                                                                  06594000
065950     PERFORM 7300-READ-ABEND-EXCP-FILE.                           06595000
065960                                                                  06596000
065970     PERFORM                                                      06597000
065980             UNTIL ((PS-END-OF-ABEND-EXCP-FILE)                   06598000
065990                     OR (PS-CICS-ABEND-EXCP-FOUND))               06599000
066000         IF (CA-CICS-ABEND-CODE = PV-CICS-ABEND-CODE)             06600000
066001             IF ((CA-ALL-TRANSACTION-IDS) OR                      06600100
066002                     (CA-TRANSACTION-ID = PV-TRANSACTION-ID))     06600201
066003                 SET PS-CICS-ABEND-EXCP-FOUND TO TRUE             06600300
066004             END-IF                                               06600400
066005         END-IF                                                   06600500
066006         IF (PS-CICS-ABEND-EXCP-NOT-FOUND)                        06600600
066007             PERFORM 7300-READ-ABEND-EXCP-FILE                    06600700
066008         END-IF                                                   06600800
066009     END-PERFORM.                                                 06600900
066010                                                                  06601000
066011     CLOSE CICS-ABEND-EXCP-FILE.                                  06601100
066012*4300-EXIT.                                                       06601200
066013                                                                  06601300
066014******************************************************************06601400
066015*  MAKE THE FINAL INCIDENT DECISION.                             *06601500
066020******************************************************************06602000
066030                                                                  06603000
066040 5000-SET-FINAL-ASSIGNMENT.                                       06604000
066050     SET PS-CREATE-INCIDENT TO TRUE.                              06605000
066060                                                                  06606000
066070     IF ((PS-TRANSACTION-EXCP-FOUND)                              06607000
066080             AND (CM007-SUPPRESS-INCIDENT))                       06608000
066090         SET PS-DONT-CREATE-INCIDENT TO TRUE                      06609000
066100     END-IF.                                                      06610000
066200                                                                  06620000
066300     IF (PS-CICS-ABEND-EXCP-FOUND)                                06630000
066400         SET PS-DONT-CREATE-INCIDENT TO TRUE                      06640000
066500     END-IF.                                                      06650000
066600                                                                  06660000
066700                                                                  06670000
066800     MOVE PC-CICS-INCIDENT TO PV-INCIDENT-DESCRIPTION.            06680000
066900     STRING PC-COMPUTER-TYPE                    DELIMITED BY SIZE 06690000
067000            PC-SEMICOLON                        DELIMITED BY SIZE 06700000
067100            PC-COMPUTER-SRC                     DELIMITED BY SIZE 06710000
067200            PV-PARM-SYSNAME                     DELIMITED BY SPACE06720000
067300            PC-SEMICOLON                        DELIMITED BY SIZE 06730000
067400            PC-JOB-NAME                         DELIMITED BY SIZE 06740000
067500            PV-CICS-REGION                      DELIMITED BY SPACE06750000
067600            PC-SEMICOLON                        DELIMITED BY SIZE 06760000
067700            PC-JOB-STEP                         DELIMITED BY SIZE 06770000
067800            PV-TRANSACTION-ID                   DELIMITED BY SIZE 06780000
067900            PC-SEMICOLON                        DELIMITED BY SIZE 06790000
068000            PC-JOB-NUMBER                       DELIMITED BY SIZE 06800000
068100            PV-PROGRAM-NAME                     DELIMITED BY SPACE06810000
068200            PC-SEMICOLON                        DELIMITED BY SIZE 06820000
068300            PC-JOB-RC                           DELIMITED BY SIZE 06830000
068400            PV-CICS-ABEND-CODE                  DELIMITED BY SIZE 06840000
068500            PC-SEMICOLON                        DELIMITED BY SIZE 06850000
068600            PC-JOB-DATE                         DELIMITED BY SIZE 06860000
068700            PV-CURRENT-DATE-JULIAN              DELIMITED BY SIZE 06870000
068800            PC-SEMICOLON                        DELIMITED BY SIZE 06880000
068900            PC-JOB-TIME                         DELIMITED BY SIZE 06890000
069000            PV-CURRENT-INCIDENT-TIME            DELIMITED BY SIZE 06900000
069100            PC-SEMICOLON                        DELIMITED BY SIZE 06910000
069200            PV-INCIDENT-DESCRIPTION             DELIMITED BY SPACE06920000
069300            PC-SEMICOLON                        DELIMITED BY SIZE 06930000
069400            PC-IMPACT                           DELIMITED BY SIZE 06940000
069500            PV-AI-IMPACT                        DELIMITED BY SPACE06950000
069600            PC-SEMICOLON                        DELIMITED BY SIZE 06960000
069610            PC-URGENCY                          DELIMITED BY SIZE 06961000
069620            PV-AI-URGENCY                       DELIMITED BY SPACE06962000
069630            PC-SEMICOLON                        DELIMITED BY SIZE 06963000
069640            PC-ASSIGNMENT-GROUP                 DELIMITED BY SIZE 06964000
069641            PV-AI-FINAL-ASSIGNMENT-GROUP        DELIMITED BY '  ' 06964100
069642         INTO PV-INCIDENT-MESSAGE-TEXT.                           06964200
069643                                                                  06964300
069644     IF (PS-CREATE-INCIDENT)                                      06964400
069645         DISPLAY PC-CURRENT-PROGRAM-NAME ' - INCIDENT MESSAGE = "'06964500
069646                   PV-INCIDENT-MESSAGE-TEXT '"'                   06964600
069647         PERFORM 8000-WRITE-INCIDENT-IMAGE                        06964700
069648     END-IF.                                                      06964800
069649*5000-EXIT.                                                       06964900
069650                                                                  06965000
069651******************************************************************06965100
069652*  READ A TRANSACTION ID TO SYSTEM ID ASSOCIATION RECORD.        *06965200
069653******************************************************************06965300
069654                                                                  06965400
069655 7000-READ-TRAN-SYSID-FILE.                                       06965500
069656     READ TRANSACTION-SYSID-FILE                                  06965600
069657         INTO CM006-TRANSACTION-SYSID-RECORD                      06965700
069658         AT END                                                   06965800
069659             SET PS-END-OF-TRAN-SYSID-FILE TO TRUE                06965900
069660             SUBTRACT +1 FROM PT-TRANID-SYSID-RCDS-READ           06966000
069670     END-READ.                                                    06967000
069680                                                                  06968000
069690     ADD +1 TO PT-TRANID-SYSID-RCDS-READ.                         06969000
069700*7000-EXIT.                                                       06970000
069800                                                                  06980000
069900******************************************************************06990000
070000*  READ A SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORD.             *07000000
070100******************************************************************07010000
070200                                                                  07020000
070300 7100-READ-SYSID-DFLT-FILE.                                       07030000
070400     READ SYSTEM-ID-DEFAULT-FILE                                  07040000
070500         INTO CM004-SYSID-DFLT-GROUP-RECORD                       07050000
070600         AT END                                                   07060000
070700             SET PS-END-OF-SYSID-DFLT-FILE TO TRUE                07070000
070800             SUBTRACT +1 FROM PT-SYSID-DFLT-RECORDS-READ          07080000
070900     END-READ.                                                    07090000
071000                                                                  07100000
071100     ADD +1 TO PT-SYSID-DFLT-RECORDS-READ.                        07110000
071200*7100-EXIT.                                                       07120000
071300                                                                  07130000
071400******************************************************************07140000
071500*  READ A TRANSACTION ID INCIDENT EXCEPTION RECORD.              *07150000
071600******************************************************************07160000
071700                                                                  07170000
071800 7200-READ-TRAN-EXCP-FILE.                                        07180000
071900     READ TRANSACTION-EXCP-FILE                                   07190000
072000         INTO CM007-TRANSACTION-EXCP-RECORD                       07200000
072100         AT END                                                   07210000
072200             SET PS-END-OF-TRAN-EXCP-FILE TO TRUE                 07220000
072300             SUBTRACT +1 FROM PT-TRANID-EXCP-RECORDS-READ         07230000
072400     END-READ.                                                    07240000
072500                                                                  07250000
072600     ADD +1 TO PT-TRANID-EXCP-RECORDS-READ.                       07260000
072700*7200-EXIT.                                                       07270000
072800                                                                  07280000
072900******************************************************************07290000
073000*  READ A CICS ABEND CODE INCIDENT EXCEPTION RECORD.             *07300000
073100******************************************************************07310000
073200                                                                  07320000
073300 7300-READ-ABEND-EXCP-FILE.                                       07330000
073400     READ CICS-ABEND-EXCP-FILE                                    07340000
073500         INTO CA-CICS-ABEND-EXCEPTION-RECORD                      07350000
073600         AT END                                                   07360000
073700             SET PS-END-OF-ABEND-EXCP-FILE TO TRUE                07370000
073800             SUBTRACT +1 FROM PT-ABEND-EXCP-RECORDS-READ          07380000
073900     END-READ.                                                    07390000
074000                                                                  07400000
074100     ADD +1 TO PT-ABEND-EXCP-RECORDS-READ.                        07410000
074200*7300-EXIT.                                                       07420000
074300                                                                  07430000
074400******************************************************************07440000
074500*  WRITE A CICS INCIDENT IMAGE.                                  *07450000
074600******************************************************************07460000
074700                                                                  07470000
074800 8000-WRITE-INCIDENT-IMAGE.                                       07480000
074810     INITIALIZE II-INCIDENT-IMAGE-RECORD.                         07481000
074820     MOVE PV-TRANSACTION-ID TO PV-JOB-NAME-TRUNC.                 07482000
074830     MOVE PV-CICS-ABEND-CODE TO PV-INCIDENT-TYPE-TRUNC.           07483000
074840     STRING PV-CURRENT-DATE              DELIMITED BY SIZE        07484000
074850            PV-CURRENT-TIME              DELIMITED BY SIZE        07485000
074860            PV-PARM-SYSNAME              DELIMITED BY SIZE        07486000
074870            PV-JOB-NAME-TRUNC            DELIMITED BY SIZE        07487000
074880            PV-INCIDENT-TYPE-TRUNC       DELIMITED BY SIZE        07488000
074890            PV-INCIDENT-MESSAGE-TEXT     DELIMITED BY SIZE        07489000
074900         INTO II-INCIDENT-IMAGE-RECORD.                           07490000
075000     WRITE II-INCIDENT-IMAGE-RECORD.                              07500000
075100                                                                  07510000
075200     ADD +1 TO PT-INC-IMAGE-RCDS-WRITTEN.                         07520000
075300*8000-EXIT.                                                       07530000
075400                                                                  07540000
075500******************************************************************07550000
075600*  CLOSE ALL FILES.                                              *07560000
075700******************************************************************07570000
075800                                                                  07580000
075900 9000-EOJ-ROUTINE.                                                07590000
076000     CLOSE INCIDENT-IMAGE-FILE.                                   07600000
076100*9000-EXIT.                                                       07610000
