000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     BRKUT004.                                        00020038
000300 AUTHOR.         KRYSTEN LEARY.                                   00030038
000400 DATE-WRITTEN.   MARCH 2005.                                      00040038
000410                                                                  00041049
000500*************************************************************     00050000
000600*   COBOL 2                                                 *     00060025
000700*-----------------------------------------------------------*     00070038
000800*   CREATE CREDIT REFUND CHECKS FILE FOR IMPORT INTO T-RECS *     00080038
000900*-----------------------------------------------------------*     00090038
001000* PROGRAM OVERVIEW:                                         *     00100021
001100* THIS PROGRAM WILL READ IN THE CREDIT REFUND CHECK FILE    *     00110038
001200* AND FORMAT THE DATA TO THE BANK RECONCILIATION T-RECS     *     00120038
001300* APPLICATION RECORD LAYOUT.  THIS DATA WILL THEN BE FTP'D  *     00130038
001400* TO THE LAN FOR IMPORT INTO T-RECS.                        *     00140038
001600*-----------------------------------------------------------*     00160049
001800* INPUT:                                                    *     00180000
001900*  1. CREDIT FILE                                           *     00190038
002100*                                                           *     00210000
002200* OUTPUT:                                                   *     00220000
002300*  1. BANK RECON FILE                  (APRD085)            *     00230007
002600*-----------------------------------------------------------*     00260049
002700* CHANGE LOG:                                               *     00270000
002800*                                                           *     00280000
002810* DATE  03/16/2005                                          *     00281048
002820*    CHANGE MADE: BANK RECONCILIATION -- CREDIT IMPORT      *     00282048
002830*    INITIAL VERSION.                                       *     00283048
002840*    MADE BY: KRYSTEN LEARY           WR/IR #: WR28513      *     00284048
004500*************************************************************     00450002
004600                                                                  00460002
004700 ENVIRONMENT DIVISION.                                            00470002
004800                                                                  00480002
004900 INPUT-OUTPUT SECTION.                                            00490002
005000                                                                  00500002
005100 FILE-CONTROL.                                                    00510002
005200     SELECT CREDIT-FILE             ASSIGN TO INP01.              00520038
005300     SELECT RECON-FILE              ASSIGN TO OUT01.              00530008
005500                                                                  00550049
005700 DATA DIVISION.                                                   00570002
005900 FILE SECTION.                                                    00590002
006000                                                                  00600049
006100 FD  CREDIT-FILE                                                  00610038
006200     RECORDING MODE IS F                                          00620002
006300     LABEL RECORDS ARE STANDARD                                   00630002
006500     BLOCK CONTAINS 0  RECORDS                                    00650002
006600     DATA RECORD IS CREDIT-RECORD.                                00660038
006700 01  CREDIT-RECORD               PIC  X(150).                     00670038
006800                                                                  00680049
006900 FD  RECON-FILE                                                   00690007
007000     RECORDING MODE IS F                                          00700007
007100     LABEL RECORDS ARE STANDARD                                   00710007
007200     DATA RECORD IS RECON-RECORD.                                 00720039
007300 01  RECON-RECORD                PIC  X(775).                     00730039
007400                                                                  00740049
008300 WORKING-STORAGE SECTION.                                         00830002
009300*----------------------------------------------------------------*00930008
009400* BANK RECON FILE COPYBOOK (OUTPUT)                              *00940039
009500*----------------------------------------------------------------*00950008
009600     COPY APRD085.                                                00960008
009700                                                                  00970049
009710 01  FILLER                        PIC X(25)    VALUE             00971049
009720                             'WS FOR BRKUT004 BEGINS==>'.         00972049
009730                                                                  00973049
009800 01  ARP-STANDARD-RECORD-LAYOUT.                                  00980039
009900     05  ARP-RECORD-TYPE           PIC X(01)     VALUE SPACES.    00990042
010000     05  FILLER                    PIC X(01)     VALUE ','.       01000039
010100     05  FILLER                    PIC 9(02)     VALUE ZEROES.    01010039
010200     05  ARP-BANK-ONE-ACCT-NBR     PIC 9(18)     VALUE 20968707.  01020039
010210     05  FILLER                    PIC X(01)     VALUE ','.       01021039
010220     05  ARP-CHECK-NBR             PIC 9(18)     VALUE ZEROES.    01022039
010230     05  FILLER                    PIC X(01)     VALUE ','.       01023039
010240     05  ARP-CHECK-AMT             PIC 9(16)V99  VALUE ZEROES.    01024039
010250     05  FILLER                    PIC X(01)     VALUE ','.       01025039
010260     05  ARP-CHECK-DATE.                                          01026039
010270         10  ARP-CHECK-CC          PIC X(02)     VALUE SPACES.    01027039
010280         10  ARP-CHECK-YY          PIC X(02)     VALUE SPACES.    01028039
010290         10  ARP-CHECK-MM          PIC X(02)     VALUE SPACES.    01029039
010291         10  ARP-CHECK-DD          PIC X(02)     VALUE SPACES.    01029139
010292     05  FILLER                    PIC X(01)     VALUE ','.       01029239
010293     05  ARP-PAID-DATE             PIC X(08)     VALUE SPACES.    01029339
010294     05  FILLER                    PIC X(01)     VALUE ','.       01029439
010295     05  ARP-ADDITIONAL-DATA       PIC X(15)     VALUE SPACES.    01029539
010296     05  FILLER                    PIC X(56)     VALUE ','.       01029639
010297                                                                  01029739
010300 01  WS-SWITCH-AREA.                                              01030002
010400     05  WS-END-OF-INPUT-SW        PIC X(03)  VALUE 'NO '.        01040002
010500         88  WS-END-OF-INPUT                  VALUE 'YES'.        01050002
010600         88  WS-NOT-END-OF-INPUT              VALUE 'NO '.        01060002
010700                                                                  01070049
010800 01  WS-PROGRAM-COUNTERS.                                         01080002
010900     05  WS-INPUT-COUNT            PIC  9(09) VALUE ZEROS.        01090002
011000     05  WS-OUTPUT-COUNT           PIC  9(09) VALUE ZEROS.        01100002
011200                                                                  01120002
011300 01  DATE-IN.                                                     01130034
011400     05 DATE-IN-YY                 PIC X(02).                     01140041
011500     05 DATE-IN-MM                 PIC X(02).                     01150041
011600     05 DATE-IN-DD                 PIC X(02).                     01160041
011700                                                                  01170034
011800 01  PV-DATE                       PIC X(08).                     01180041
011900 01  PV-DATE-RED REDEFINES PV-DATE.                               01190010
012000     05  PV-DATE-CC                PIC X(02).                     01200041
012100     05  PV-DATE-YY                PIC X(02).                     01210041
012200     05  PV-DATE-MM                PIC X(02).                     01220041
012300     05  PV-DATE-DD                PIC X(02).                     01230041
013100                                                                  01310036
013200 01  PV-TOT-PAYT-AMT               PIC 9(18)V99999                01320036
013300                                              VALUE ZEROS.        01330036
013400                                                                  01340036
016300 01  FILLER                        PIC X(25) VALUE                01630036
016400          '<====WS FOR BRKUT004 ENDS'.                            01640038
016500                                                                  01650036
016520*------------------------------                                   01652049
016600 PROCEDURE DIVISION.                                              01660036
016610*------------------------------                                   01661049
017300 A100-MAINLINE.                                                   01730036
017400                                                                  01740036
017500     PERFORM B100-HOUSEKEEPING.                                   01750036
017700     PERFORM B200-CREATE-BANK-RECON-REC                           01770036
017800          UNTIL WS-END-OF-INPUT.                                  01780051
018200     PERFORM B300-END-OF-JOB.                                     01820051
018300     STOP RUN.                                                    01830049
018600                                                                  01860036
018800*---------------------------------------------------------------* 01880049
018900*  INITIALIZATION                                               * 01890039
019000*---------------------------------------------------------------* 01900049
019200 B100-HOUSEKEEPING.                                               01920036
019300                                                                  01930036
020900     OPEN INPUT CREDIT-FILE                                       02090039
021000         OUTPUT RECON-FILE.                                       02100050
021200                                                                  02120036
021300     PERFORM R100-READ-CREDIT-FILE.                               02130039
021400                                                                  02140039
022600     IF WS-END-OF-INPUT                                           02260036
022700        DISPLAY '***********************************************' 02270036
022800        DISPLAY '* NO PAYROLL RECORDS WERE FOUND FOR THIS JOB  *' 02280036
022900        DISPLAY '* RUN.                                        *' 02290036
023000        DISPLAY '***********************************************' 02300036
023100     END-IF.                                                      02310036
023200                                                                  02320036
023300     ACCEPT DATE-IN  FROM DATE.                                   02330036
023400     MOVE '20'       TO PV-DATE-CC.                               02340036
023500     MOVE DATE-IN-YY TO PV-DATE-YY.                               02350036
023600     MOVE DATE-IN-MM TO PV-DATE-MM.                               02360036
023700     MOVE DATE-IN-DD TO PV-DATE-DD.                               02370036
023800                                                                  02380036
024000*---------------------------------------------------------------* 02400049
024100*  CREATE THE BANK RECON RECORD                                 * 02410041
024200*---------------------------------------------------------------* 02420049
024400 B200-CREATE-BANK-RECON-REC.                                      02440036
024500                                                                  02450036
024600     PERFORM M100-MOVE-FIELDS.                                    02460036
024610     PERFORM R100-READ-CREDIT-FILE.                               02461039
024700                                                                  02470036
029000*---------------------------------------------------------------* 02900049
029100*  END OF PROGRAM PROCESSING                                    * 02910039
029200*---------------------------------------------------------------* 02920049
029400 B300-END-OF-JOB.                                                 02940051
029500                                                                  02950036
029600     CLOSE CREDIT-FILE                                            02960039
029700           RECON-FILE.                                            02970050
029900                                                                  02990036
030000     DISPLAY '**********************************************'.    03000036
030100     DISPLAY '---- BRKUT004 RECORD COUNTS ----'.                  03010038
030200     DISPLAY '**********************************************'.    03020036
030300     DISPLAY 'RECORDS READ         = ' WS-INPUT-COUNT.            03030036
030400     DISPLAY 'RECORDS WRITTEN      = ' WS-OUTPUT-COUNT.           03040036
030600                                                                  03060036
030800*----------------------------------------------------------------*03080049
030900* MOVE THE INPUT CREDIT FIELDS TO THE BANK RECON FIELDS          *03090039
031000*----------------------------------------------------------------*03100049
031200 M100-MOVE-FIELDS.                                                03120036
031300                                                                  03130036
031310     IF ARP-STANDARD-RECORD-LAYOUT(1:1) = 'O'                     03131046
031400        MOVE 'D'                          TO AP085-REC-TYP        03140045
031500        MOVE 'CR1'                        TO AP085-IMPRT-ACCT-ID  03150045
031600        MOVE PV-DATE                      TO AP085-POST-DTE       03160045
031700        MOVE ARP-CHECK-DATE               TO AP085-EFF-DTE        03170045
031800        MOVE 'CR'                         TO AP085-TRN-TYP        03180045
031900        MOVE 'C'                          TO AP085-DR-CR          03190045
032000        MOVE ARP-CHECK-AMT                TO AP085-PAYT-AMT       03200045
032100        MOVE ARP-CHECK-NBR                TO AP085-CK-NBR         03210045
032200        MOVE SPACES                       TO AP085-VND-NBR        03220042
032300                                             AP085-CK-STAT        03230042
039100                                             AP085-VND-NM         03910045
039110                                                                  03911039
039120        ADD ARP-CHECK-AMT                 TO PV-TOT-PAYT-AMT      03912045
039130        PERFORM W100-WRITE-OUTPUT                                 03913045
039131     END-IF.                                                      03913145
039140                                                                  03914049
039200*----------------------------------------------------------------*03920049
039300*  READ THE INPUT FILE INTO THE BANK-ONE-REC PAYROLL LAYOUT      *03930039
039400*----------------------------------------------------------------*03940049
039600 R100-READ-CREDIT-FILE.                                           03960040
039700                                                                  03970036
039800     READ CREDIT-FILE INTO ARP-STANDARD-RECORD-LAYOUT             03980040
039900          AT END                                                  03990036
040000             SET WS-END-OF-INPUT TO TRUE.                         04000036
040100                                                                  04010036
040200     IF WS-NOT-END-OF-INPUT                                       04020036
040300        ADD 1 TO WS-INPUT-COUNT                                   04030036
040400     END-IF.                                                      04040036
040500                                                                  04050036
042100*----------------------------------------------------------------*04210049
042200*  WRITE THE RECON RECORD TO THE RECON FILE                      *04220039
042300*----------------------------------------------------------------*04230049
042500 W100-WRITE-OUTPUT.                                               04250036
042600                                                                  04260036
042700     WRITE RECON-RECORD FROM AP085-DETAIL-RECORD.                 04270039
042900     ADD 1 TO WS-OUTPUT-COUNT.                                    04290036
043000                                                                  04300036
