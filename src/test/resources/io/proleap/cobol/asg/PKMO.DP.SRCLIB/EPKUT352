000100 IDENTIFICATION DIVISION.                                         00010011
000200 PROGRAM-ID.      EPKUT352.                                       00020011
000300 AUTHOR.          COGNIZANT.                                      00030011
000400 DATE-WRITTEN.    SEPTEMBER,2013.                                 00040011
000500                                                                  00050011
000600*-----------------------------------------------------------      00060011
000700*            SIMPLE PRICING CORRECTION IDENTIFIER                 00070011
000800*-----------------------------------------------------------      00080011
000900*-----------------------------------------------------------      00090011
001000* HISTORY LOG:                                                    00100011
001100*-----------------------------------------------------------      00110011
001200* DATE: 09/30/2013                                                00120066
001300* WR/IR#:                                                         00130066
001400* PROGRAMMER: COGNIZANT                                           00140066
001500* THIS PROGRAM IS A MODIFIED VERSION OF EPKUT125.                 00150066
001600* DESCRIPTION: REMOVED THE EMERGENCY FILE EXTRACT PROCESS IN THE  00160066
001700*   NIGHTLY CYCLE. THIS IS DONE TO AVOID SORTING ISSUE FOR PROMO  00170066
001800*   SEND TO STORES.                                               00180066
001900* DATE:                                                           00190011
002000* WR/IR#:                                                         00200011
002100* PROGRAMMER:                                                     00210011
002200* DESCRIPTION:                                                    00220011
002300                                                                  00230050
002400*----------------------------------------------------------       00240011
002500 ENVIRONMENT DIVISION.                                            00250011
002600*----------------------------------------------------------       00260011
002700 CONFIGURATION SECTION.                                           00270011
002800 SOURCE-COMPUTER.        IBM-3090.                                00280011
002900 OBJECT-COMPUTER.        IBM-3090.                                00290011
003000                                                                  00300011
003100 INPUT-OUTPUT SECTION.                                            00310011
003200                                                                  00320011
003300 FILE-CONTROL.                                                    00330011
003400                                                                  00340011
003500     SELECT CONTROL-CARD-PGM-LAST-RUN-TMST                        00350044
003600       ASSIGN TO INP01.                                           00360047
003700     SELECT CONTROL-CARD-PGM-CURR-TMST                            00370066
003800       ASSIGN TO INP02.                                           00380047
003900     SELECT CONTROL-CARD-CURR-PRICG-DTE                           00390045
004000       ASSIGN TO INP03.                                           00400047
004100     SELECT CONTROL-CARD-FUTRE-CORR-DTE                           00410045
004200       ASSIGN TO INP04.                                           00420047
004300     SELECT CONTROL-CARD-CRIT-EFF-DTE                             00430045
004400       ASSIGN TO INP05.                                           00440047
004500     SELECT PROMO-NIGHT-FILE                                      00450045
004600       ASSIGN TO OUT01.                                           00460047
004700                                                                  00470045
004800 DATA DIVISION.                                                   00480045
004900 FILE SECTION.                                                    00490045
005000                                                                  00500045
005100 FD  CONTROL-CARD-PGM-LAST-RUN-TMST                               00510045
005200     RECORDING MODE F                                             00520045
005300     BLOCK CONTAINS 0 RECORDS                                     00530045
005400     LABEL RECORDS ARE OMITTED                                    00540045
005500     DATA RECORD IS CNTRL-CARD-PGM-LAST-RUN-REC.                  00550045
005600 01  CNTRL-CARD-PGM-LAST-RUN-REC                   PIC  X(080).   00560047
005700                                                                  00570045
005800 FD  CONTROL-CARD-PGM-CURR-TMST                                   00580066
005900     RECORDING MODE F                                             00590045
006000     BLOCK CONTAINS 0 RECORDS                                     00600045
006100     LABEL RECORDS ARE OMITTED                                    00610045
006200     DATA RECORD IS CNTRL-CARD-PGM-CURR-RUN-REC.                  00620045
006300 01  CNTRL-CARD-PGM-CURR-RUN-REC                   PIC  X(080).   00630047
006400                                                                  00640066
006500 FD  CONTROL-CARD-CURR-PRICG-DTE                                  00650045
006600     RECORDING MODE F                                             00660045
006700     BLOCK CONTAINS 0 RECORDS                                     00670045
006800     LABEL RECORDS ARE OMITTED                                    00680045
006900     DATA RECORD IS CNTRL-CARD-CURR-PRICG-DTE-REC.                00690045
007000 01  CNTRL-CARD-CURR-PRICG-DTE-REC                 PIC  X(080).   00700047
007100                                                                  00710045
007200 FD  CONTROL-CARD-FUTRE-CORR-DTE                                  00720045
007300     RECORDING MODE F                                             00730045
007400     BLOCK CONTAINS 0 RECORDS                                     00740045
007500     LABEL RECORDS ARE OMITTED                                    00750045
007600     DATA RECORD IS CNTRL-CARD-FUTRE-CORR-DTE-REC.                00760045
007700 01  CNTRL-CARD-FUTRE-CORR-DTE-REC                 PIC  X(080).   00770047
007800                                                                  00780045
007900 FD  CONTROL-CARD-CRIT-EFF-DTE                                    00790045
008000     RECORDING MODE F                                             00800045
008100     BLOCK CONTAINS 0 RECORDS                                     00810045
008200     LABEL RECORDS ARE OMITTED                                    00820045
008300     DATA RECORD IS CNTRL-CARD-CRIT-EFF-DTE-REC.                  00830045
008400 01  CNTRL-CARD-CRIT-EFF-DTE-REC                   PIC  X(080).   00840047
008500                                                                  00850045
008600 FD  PROMO-NIGHT-FILE                                             00860045
008700     RECORDING MODE F                                             00870045
008800     BLOCK CONTAINS 0 RECORDS                                     00880045
008900     LABEL RECORDS ARE OMITTED                                    00890045
009000     DATA RECORD IS PROMO-NIGHT-ID-RECORD.                        00900045
009100 01  PROMO-NIGHT-RECORD                            PIC X(200).    00910047
009200                                                                  00920045
009300 WORKING-STORAGE SECTION.                                         00930045
009400*-----------------------------------------------------------      00940045
009500* PS - PROGRAM SWITCHES                                           00950045
009600*-----------------------------------------------------------      00960045
009700 01  PS-PROGRAM-SWITCHES.                                         00970045
009800     05  PS-SMP-PRICG-CSR-EOF-SW                   PIC  X(001).   00980047
009900       88  PS-SMP-PRICG-CSR-EOF                      VALUE 'Y'.   00990047
010000       88  PS-SMP-PRICG-CSR-NOT-EOF                  VALUE 'N'.   01000047
010100     05  PS-SMP-PRICG-ADHOC-CSR-EOF-SW             PIC  X(001).   01010047
010200       88  PS-SMP-PRICG-ADHOC-CSR-EOF                VALUE 'Y'.   01020047
010300       88  PS-SMP-PRICG-ADHOC-CSR-NOT-EOF            VALUE 'N'.   01030047
010400     05  PS-REC-FOUND-SW                           PIC  X(001).   01040047
010500       88  PS-REC-FOUND                              VALUE 'Y'.   01050047
010600       88  PS-NO-REC-FOUND                           VALUE 'N'.   01060047
010700     05  PS-WRITE-PROMO-SW                         PIC  X(001).   01070047
010800       88  PS-WRITE-PROMO                            VALUE 'Y'.   01080047
010900       88  PS-DONT-WRITE-PROMO                       VALUE 'N'.   01090047
011000     05  PS-FILE-STATUS                            PIC  X(002).   01100047
011100       88  PS-SUCCESSFUL-COMPLETION                  VALUE '00'.  01110047
011200       88  PS-END-OF-FILE                            VALUE '10'.  01120047
011300       88  PS-SUCCESSFUL-OPEN                        VALUE '97'.  01130047
011400     05  PS-END-OF-CNTL-CRD-SW                     PIC  X(001).   01140047
011500       88  PS-END-OF-CNTL-CRD-FILE                   VALUE 'Y'.   01150047
011600       88  PS-NOT-END-OF-CNTL-CRD-FILE               VALUE 'N'.   01160047
011700                                                                  01170045
011800*-----------------------------------------------------------      01180045
011900* PROGRAM CONSTANTS                                               01190045
012000*-----------------------------------------------------------      01200045
012100 01  PC-PROGRAM-CONSTANTS.                                        01210045
012200     05  PC-CURRENT-PROGRAM-NAME                   PIC  X(008)    01220047
012300       VALUE 'EPKUT352'.                                          01230045
012400     05  PC-PRICING-BUS-EVENT                      PIC  X(003)    01240047
012500       VALUE '090'.                                               01250045
012600     05  PC-ADHOC-DEV-BUS-EVENT                    PIC  X(003)    01260047
012700       VALUE '050'.                                               01270045
012800     05  PC-RMS-PRC-SETUP-IND                      PIC  X(001)    01280047
012900       VALUE 'R'.                                                 01290045
013000     05  PC-ADHOC-PRC-SETUP-IND                    PIC  X(001)    01300047
013100       VALUE 'A'.                                                 01310045
013200     05  PC-ADHOC-STR-GRP-TYP-CDE                  PIC  X(005)    01320047
013300       VALUE '99999'.                                             01330047
013400     05  PC-ADHOC-STR-SPEC-CDE                     PIC  X(004)    01340047
013500       VALUE '5000'.                                              01350045
013600     05  PC-STR-SELN-HIER-CDE                      PIC  X(002)    01360047
013700       VALUE '61'.                                                01370045
013800     05  PC-FILE-ACT-TYPE                          PIC  X(003)    01380047
013900       VALUE 'CHG'.                                               01390045
014000     05  PC-APPLY-NIGHTLY                          PIC  X(001)    01400047
014100       VALUE 'N'.                                                 01410045
014200     05  PC-SMP-PRICG-STAT-CDE                     PIC  X(001).   01420047
014300       88  PC-SCHEDULED-STATUS                       VALUE 'S'.   01430047
014400       88  PC-DELETE-STATUS                          VALUE 'D'.   01440047
014500       88  PC-CANCEL-STATUS                          VALUE 'C'.   01450047
014600     05  PC-ADD-STAT-CDE                           PIC  X(001)    01460047
014700       VALUE 'A'.                                                 01470045
014800     05  PC-DELETE-STAT-CDE                        PIC  X(001)    01480047
014900       VALUE 'D'.                                                 01490045
015000     05  PC-MDSE-INCL-IND                          PIC  X(001)    01500047
015100       VALUE 'I'.                                                 01510045
015200                                                                  01520045
015300*-----------------------------------------------------------      01530045
015400* PV- PROGRAM VARIABLES                                           01540045
015500*-----------------------------------------------------------      01550045
015600 01  PV-PROGRAM-VARAIBLES.                                        01560045
015700     05  PV-SQL-SUB                                PIC S9(004)    01570047
015800                                                     VALUE +0     01580047
015900                                                     COMP.        01590047
016000     05  PV-ACTL-STRT-TMST.                                       01600045
016100       10  PV-ACTL-STRT-TMST-DATE                  PIC  X(010)    01610047
016200                                                     VALUE SPACES.01620047
016300       10  FILLER                                  PIC  X(016)    01630047
016400                                                     VALUE SPACES.01640048
016500     05  PV-SOR-LAST-UPD-TMST                      PIC  X(026)    01650047
016600                                                     VALUE SPACES.01660047
016700     05  PV-EFF-STRT-TMST                          PIC  X(026)    01670047
016800                                                     VALUE SPACES.01680047
016900     05  PV-EFF-END-TMST                           PIC  X(026)    01690047
017000                                                     VALUE SPACES.01700047
017100     05  PV-EFF-END-NULL                           PIC S9(004)    01710047
017200                                                     VALUE ZEROS  01720048
017300                                                     COMP.        01730047
017400     05  PV-ABEND-CODE                             PIC  9999      01740047
017500                                                     VALUE ZEROS  01750048
017600                                                     COMP.        01760048
017700     05  PV-FUL-FILE-STR                           PIC  9(005)    01770047
017800                                                     VALUE ZEROS. 01780047
017900     05  EP111-CC-DATE-PLUS1                       PIC  X(010)    01790047
018000                                                     VALUE SPACES.01800047
018100     05  EP113-CC-CRNT-DTE-MINUS1                  PIC  X(010)    01810047
018200                                                     VALUE SPACES.01820047
018300                                                                  01830024
018400*----------------------------------------------------------       01840011
018500* FULL FILE EXTRACT OUTPUT FILE.                                  01850011
018600*----------------------------------------------------------       01860011
018700     COPY EPRD072.                                                01870011
018800                                                                  01880011
018900*----------------------------------------------------------       01890011
019000* EPCC111 CONTROL CARD LAYOUT                                     01900011
019100*----------------------------------------------------------       01910011
019200     COPY EPRD111.                                                01920011
019300                                                                  01930011
019400*----------------------------------------------------------       01940011
019500* EPCC113 CONTROL CARD LAYOUT                                     01950011
019600*----------------------------------------------------------       01960011
019700     COPY EPRD113.                                                01970011
019800                                                                  01980011
019900*----------------------------------------------------------       01990011
020000* EPCC400 CONTROL CARD LAYOUT                                     02000013
020100*----------------------------------------------------------       02010011
020200     COPY EPRD400.                                                02020013
020300                                                                  02030011
020400*----------------------------------------------------------       02040066
020500* EPCC401 CONTROL CARD LAYOUT                                     02050013
020600*----------------------------------------------------------       02060011
020700     COPY EPRD401.                                                02070013
020800                                                                  02080066
020900*----------------------------------------------------------       02090011
021000* EPCC128 CONTROL CARD LAYOUT                                     02100066
021100*----------------------------------------------------------       02110011
021200     COPY EPRD128.                                                02120011
021300                                                                  02130011
021400*----------------------------------------------------------       02140011
021500* DATE ROUTINE COPY MEMBERS                                       02150011
021600*----------------------------------------------------------       02160011
021700     COPY DPWS500.                                                02170011
021800                                                                  02180011
021900*-----------------------------------------------------------      02190011
022000* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         02200011
022100*-----------------------------------------------------------      02210011
022200     COPY DPWS004.                                                02220011
022300                                                                  02230011
022400*-----------------------------------------------------------      02240011
022500* DB2 ABEND COPYBOOK                                              02250011
022600*-----------------------------------------------------------      02260011
022700     COPY DPWS900.                                                02270011
022800                                                                  02280011
022900*-----------------------------------------------------------      02290011
023000* DB2 MESSAGE AREA                                                02300011
023100*-----------------------------------------------------------      02310011
023200     COPY SQLCA2.                                                 02320011
023300                                                                  02330011
023400*-----------------------------------------------------------      02340011
023500* PROGRAM COUNTERS                                                02350011
023600*-----------------------------------------------------------      02360011
023700 01  PC-PROGRAM-COUNTERS.                                         02370011
023800     05  PC-CNT-READ-RECS                          PIC  9(009)    02380047
023900                                                     VALUE 0.     02390047
024000     05  PC-CNT-NIGHT-RECS                         PIC  9(009)    02400047
024100                                                     VALUE 0.     02410047
024200     05  PC-CNT-PROMO-RECS                         PIC  9(009)    02420047
024300                                                     VALUE 0.     02430047
024400     05  PC-CNT-RMS-RECS                           PIC  9(009)    02440047
024500                                                     VALUE 0.     02450047
024600     05  PC-CNT-ADHOC-RECS                         PIC  9(009)    02460047
024700                                                     VALUE 0.     02470047
024800     05  PC-CNT-DEVT-RECS                          PIC  9(009)    02480047
024900                                                     VALUE 0.     02490047
025000     05  PC-CNT-PMAP-RECS                          PIC  9(009)    02500047
025100                                                     VALUE 0.     02510047
025200     05  PC-CNT-ERROR-RECS                         PIC  9(009)    02520047
025300                                                     VALUE 0.     02530047
025400     05  PC-CNT-ALL-RECS                           PIC  9(009)    02540047
025500                                                     VALUE 0.     02550047
025600     05  PC-CNT-SPACES                             PIC  9(009)    02560047
025700                                                     VALUE 0.     02570047
025800     05  PC-CNT-POS                                PIC  9(009)    02580047
025900                                                     VALUE 0.     02590047
026000     05  PC-CNT-EXCL-CHECK                         PIC  9(009)    02600047
026100                                                     VALUE 0.     02610047
026200     05  PC-MAX-RETRIES                            PIC S9(004)    02620047
026300                                                     VALUE +5     02630047
026400                                                     COMP.        02640047
026500                                                                  02650011
026600*-----------------------------------------------------------      02660011
026700* ERROR HANDLING                                                  02670011
026800*-----------------------------------------------------------      02680011
026900 01  PV-MISC-ABEND-FIELDS.                                        02690026
027000     05  PV-PARAGRAPH-NAME                         PIC  X(030)    02700047
027100                                                     VALUE SPACE. 02710047
027200     05  PV-OPERATION-MSG-1                        PIC  X(040)    02720047
027300                                                     VALUE SPACE. 02730047
027400     05  PV-OPERATION-MSG-2                        PIC  X(040)    02740047
027500                                                     VALUE SPACE. 02750047
027600     05  PV-DB2-OPERATION                          PIC  X(030)    02760047
027700                                                     VALUE SPACE. 02770047
027800 01  ABEND-CODE                                    PIC S9(004)    02780047
027900                                                     VALUE ZEROS  02790047
028000                                                     COMP         02800047
028100                                                     SYNC.        02810047
028200   88  ABEND-4003-CTRL-CARD-ERROR                    VALUE +4003. 02820047
028300   88  ABEND-4013-DB2-ERROR                          VALUE +4013. 02830047
028400   88  ABEND-4019-CAL-SUB-ERROR                      VALUE +4019. 02840047
028500   88  ABEND-4020-MQ-ERROR                           VALUE +4020. 02850047
028600   88  ABEND-4444-FORCED-ABEND                       VALUE +4444. 02860047
028700   88  ABEND-4008                                    VALUE +4008. 02870047
028800                                                                  02880026
028900                                                                  02890011
029000*-----------------------------------------------------------      02900011
029100* DB2 COMMUNICATIONS AREA                                         02910011
029200*-----------------------------------------------------------      02920011
029300     EXEC SQL                                                     02930011
029400       INCLUDE SQLCA                                              02940026
029500     END-EXEC.                                                    02950011
029600                                                                  02960011
029700*-----------------------------------------------------------      02970046
029800* DB2 TABLE XST00023(XST_STR_GP_MBSHP) - STORE GROUP              02980046
029900*-----------------------------------------------------------      02990046
030000     EXEC SQL                                                     03000011
030100       INCLUDE XST00023                                           03010026
030200     END-EXEC.                                                    03020011
030300                                                                  03030011
030400*-----------------------------------------------------------      03040014
030500* DB2 TABLE XST00028(XST_MDSE_LNE_SELN) - MERCHANDISE TABLE       03050014
030600*-----------------------------------------------------------      03060014
030700     EXEC SQL                                                     03070014
030800       INCLUDE XST00028                                           03080026
030900     END-EXEC.                                                    03090014
031000                                                                  03100014
031100*-----------------------------------------------------------      03110011
031200* DB2 TABLE XST00029(XST_PROMO_STR_GP) - STORE ZONE PRICING       03120011
031300*                                               TABLE             03130011
031400*-----------------------------------------------------------      03140011
031500     EXEC SQL                                                     03150011
031600       INCLUDE XST00029                                           03160026
031700     END-EXEC.                                                    03170011
031800                                                                  03180011
031900*-----------------------------------------------------------      03190011
032000* DB2 TABLE XST00030(XST_SMP_PRICG) SIMPLE PRICING                03200014
032100*-----------------------------------------------------------      03210011
032200     EXEC SQL                                                     03220011
032300       INCLUDE XST00030                                           03230027
032400     END-EXEC.                                                    03240011
032500                                                                  03250014
032600*-----------------------------------------------------------      03260014
032700* DB2 TABLE XST00031(XST_PROMO_ADHC_RLT) ADHOC RELATION           03270014
032800*-----------------------------------------------------------      03280014
032900     EXEC SQL                                                     03290014
033000       INCLUDE XST00031                                           03300025
033100     END-EXEC.                                                    03310014
033200                                                                  03320011
033300*-----------------------------------------------------------      03330011
033400* DB2 TABLE XST00033(XST_PROMO_ADHC_STR) PROMO ADHOC STORES       03340014
033500*-----------------------------------------------------------      03350011
033600     EXEC SQL                                                     03360011
033700       INCLUDE XST00033                                           03370026
033800     END-EXEC.                                                    03380011
033900                                                                  03390011
034000*-----------------------------------------------------------      03400011
034100* SIMPLE PRICING CHANGE INTERFACE INCLUDE CURSOR. (RMS)           03410015
034200*-----------------------------------------------------------      03420011
034300     EXEC SQL                                                     03430011
034400       DECLARE SMP-PRICG-RMS CURSOR FOR                           03440047
034500         SELECT SMPPRC.STAT_CDE                                   03450026
034600               ,SMPPRC.LAST_UPD_TMST                              03460026
034700               ,SMPPRC.SOR_LAST_UPD_TMST                          03470026
034800               ,STRGP.PROMO_INTFC_ID                              03480026
034900               ,STRGP.MDSE_LNE_ID                                 03490026
035000               ,STRGP.STR_GP_TYP_CDE                              03500026
035100               ,STRGP.STR_GP_ID                                   03510026
035200               ,STRGP.STR_SELN_HIER_CDE                           03520026
035300               ,STRGP.ACTL_STRT_TMST                              03530026
035400               ,STRGP.ACTL_END_TMST                               03540026
035500               ,MDSSEL.PRICG_TYP_CDE                              03550026
035600         FROM XST_SMP_PRICG      SMPPRC                           03560047
035700             ,XST_PROMO_STR_GP   STRGP                            03570047
035800             ,XST_MDSE_LNE_SELN  MDSSEL                           03580047
035900         WHERE SMPPRC.PROMO_INTFC_ID = MDSSEL.PROMO_INTFC_ID      03590047
036000           AND SMPPRC.MDSE_LNE_ID    = MDSSEL.MDSE_LNE_ID         03600047
036100           AND MDSSEL.PROMO_INTFC_ID = STRGP.PROMO_INTFC_ID       03610047
036200           AND MDSSEL.MDSE_LNE_ID    = STRGP.MDSE_LNE_ID          03620047
036300           AND STRGP.STAT_CDE  IN ('S')                           03630047
036400           AND (SMPPRC.LAST_UPD_TMST                              03640047
036500               BETWEEN :EP400-CC-PREV-RUN-CUTOFF-TMST             03650047
036600                   AND :EP401-CC-CURR-RUN-CUTOFF-TMST)            03660047
036700           AND ((:EP111-CC-CRNT-DTE                               03670047
036800               BETWEEN DATE(STRGP.ACTL_STRT_TMST)                 03680047
036900                   AND DATE(STRGP.ACTL_END_TMST))                 03690047
037000           OR  (DATE(STRGP.ACTL_STRT_TMST)                        03700047
037100               BETWEEN :EP111-CC-DATE-PLUS1                       03710047
037200                   AND :EP113-CC-CRNT-DTE-MINUS1))                03720047
037300         FOR FETCH ONLY                                           03730047
037400         WITH UR                                                  03740047
037500     END-EXEC.                                                    03750011
037600                                                                  03760011
037700*-----------------------------------------------------------      03770011
037800* SIMPLE PRICING CHANGE ID ADHOC CURSOR.                          03780015
037900*-----------------------------------------------------------      03790011
038000     EXEC SQL                                                     03800011
038100       DECLARE SMP-PRICG-ADHOC CURSOR FOR                         03810015
038200         SELECT SMPPRC.STAT_CDE                                   03820026
038300               ,SMPPRC.LAST_UPD_TMST                              03830026
038400               ,SMPPRC.SOR_LAST_UPD_TMST                          03840026
038500               ,ADHOC.PROMO_INTFC_ID                              03850026
038600               ,ADHOC.MDSE_LNE_ID                                 03860026
038700               ,ADHOC.ADHC_STR_GP_ID                              03870026
038800               ,ADHOC.STR_SELN_HIER_CDE                           03880026
038900               ,ADHOC.ACTL_STRT_TMST                              03890026
039000               ,ADHOC.ACTL_END_TMST                               03900026
039100               ,MDSSEL.PRICG_TYP_CDE                              03910026
039200        FROM XST_SMP_PRICG      SMPPRC                            03920047
039300            ,XST_PROMO_ADHC_RLT ADHOC                             03930047
039400            ,XST_MDSE_LNE_SELN  MDSSEL                            03940047
039500        WHERE SMPPRC.PROMO_INTFC_ID = MDSSEL.PROMO_INTFC_ID       03950047
039600          AND SMPPRC.MDSE_LNE_ID    = MDSSEL.MDSE_LNE_ID          03960047
039700          AND ADHOC.PROMO_INTFC_ID  = MDSSEL.PROMO_INTFC_ID       03970047
039800          AND ADHOC.MDSE_LNE_ID     = MDSSEL.MDSE_LNE_ID          03980047
039900          AND ADHOC.STAT_CDE  IN ('S')                            03990047
040000          AND (SMPPRC.LAST_UPD_TMST                               04000047
040100              BETWEEN :EP400-CC-PREV-RUN-CUTOFF-TMST              04010047
040200                  AND :EP401-CC-CURR-RUN-CUTOFF-TMST)             04020047
040300          AND ((:EP111-CC-CRNT-DTE                                04030047
040400              BETWEEN DATE(ADHOC.ACTL_STRT_TMST)                  04040047
040500                  AND DATE(ADHOC.ACTL_END_TMST))                  04050047
040600          OR  (DATE(ADHOC.ACTL_STRT_TMST)                         04060047
040700              BETWEEN :EP111-CC-DATE-PLUS1                        04070047
040800                  AND :EP113-CC-CRNT-DTE-MINUS1))                 04080047
040900        FOR FETCH ONLY                                            04090047
041000        WITH UR                                                   04100047
041100     END-EXEC.                                                    04110011
041200                                                                  04120011
041300 LINKAGE SECTION.                                                 04130018
041400                                                                  04140018
041500*----------------------------------------------------------       04150018
041600 PROCEDURE DIVISION.                                              04160018
041700*----------------------------------------------------------       04170018
041800 0000-MAINLINE.                                                   04180018
041900                                                                  04190018
042000     PERFORM 1000-INITIALIZATION.                                 04200018
042100                                                                  04210018
042200     PERFORM 2000-PROCESS-SIMPLE-PRICING.                         04220018
042300                                                                  04230018
042400     PERFORM 9999-WRAPUP.                                         04240018
042500                                                                  04250018
042600     GOBACK.                                                      04260018
042700                                                                  04270018
042800*0000-EXIT.                                                       04280018
042900 EJECT.                                                           04290018
043000                                                                  04300018
043100*----------------------------------------------------------       04310018
043200* 1000-INITIALIZATION.                                            04320018
043300*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      04330018
043400*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      04340018
043500*     PARAMETERS IT MAY NEED TO USE TO READ THE PROMO             04350018
043600*     INTERFACE ID FILE.                                          04360018
043700*----------------------------------------------------------       04370018
043800 1000-INITIALIZATION.                                             04380011
043900                                                                  04390011
044000     OPEN INPUT  CONTROL-CARD-CURR-PRICG-DTE                      04400026
044100                 CONTROL-CARD-FUTRE-CORR-DTE                      04410026
044200                 CONTROL-CARD-PGM-CURR-TMST                       04420066
044300                 CONTROL-CARD-PGM-LAST-RUN-TMST                   04430026
044400                 CONTROL-CARD-CRIT-EFF-DTE.                       04440026
044500     OPEN OUTPUT PROMO-NIGHT-FILE.                                04450011
044600*                PROMO-EMERGENCY-FILE.                            04460011
044700                                                                  04470011
044800     INITIALIZE EP072-PROMO-INTFC-RECORD.                         04480011
044900                                                                  04490011
045000     PERFORM 1010-READ-PGM-CURR-RUN-CARD.                         04500011
045100     PERFORM 1020-READ-PGM-LAST-RUN-CARD.                         04510026
045200     PERFORM 1030-READ-CURR-PRICG-DTE-CARD.                       04520026
045300     PERFORM 1040-READ-FUTRE-CORR-DTE-CARD.                       04530026
045400     PERFORM 1050-READ-CRIT-EFF-DTE-CARD.                         04540026
045500     PERFORM 6100-DATE-ROUTINE.                                   04550011
045600                                                                  04560011
045700*1000-EXIT.                                                       04570011
045800 EJECT.                                                           04580011
045900                                                                  04590011
046000*----------------------------------------------------------       04600026
046100* 1010-READ-PGM-CURR-RUN-CARD.                                    04610026
046200*     READ CONTROL CARD EPCC401. THIS CONTROL CARD CONTAINS       04620026
046300*     THE CURRENT TIMESTAMP                                       04630026
046400*----------------------------------------------------------       04640026
046500 1010-READ-PGM-CURR-RUN-CARD.                                     04650026
046600                                                                  04660026
046700     READ CONTROL-CARD-PGM-CURR-TMST                              04670026
046800                                    INTO EP401-CC-CONTROL-CARD    04680026
046900       AT END                                                     04690026
047000          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    04700026
047100                                                                  04710026
047200     IF PS-END-OF-CNTL-CRD-FILE                                   04720026
047300       DISPLAY ' '                                                04730026
047400       DISPLAY '** ABEND     **'                                  04740026
047500       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      04750026
047600       DISPLAY '** PARAGRAPH **  = 1010-READ-PGM-CURR-RUN-CARD'   04760026
047700       DISPLAY '** CONTROL FILE IS EMPTY  '                       04770026
047800       DISPLAY ' '                                                04780026
047900       MOVE +4002 TO ABEND-CODE                                   04790026
048000       CALL 'ILBOABN0' USING ABEND-CODE                           04800026
048100     ELSE                                                         04810026
048200       DISPLAY '** PROGRAM CURR RUN CONTROL CARD  **'             04820026
048300       DISPLAY '** EPCC401    **  =' EP401-CC-CURR-RUN-CUTOFF-TMST04830029
048400       DISPLAY ' '                                                04840028
048500     END-IF.                                                      04850026
048600                                                                  04860026
048700*1010-EXIT.                                                       04870026
048800 EJECT.                                                           04880026
048900                                                                  04890026
049000*----------------------------------------------------------       04900066
049100* 1020-READ-PGM-LAST-RUN-CARD.                                    04910026
049200*     READ CONTROL CARD EPCC400. THIS CONTROL CARD CONTAINS       04920026
049300*     THE TIMESTAMP FROM THE LAST RUN OF EPKUT352                 04930026
049400*----------------------------------------------------------       04940026
049500 1020-READ-PGM-LAST-RUN-CARD.                                     04950026
049600                                                                  04960026
049700     READ CONTROL-CARD-PGM-LAST-RUN-TMST                          04970026
049800                                    INTO EP400-CC-CONTROL-CARD    04980026
049900       AT END                                                     04990026
050000          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05000026
050100                                                                  05010026
050200     IF PS-END-OF-CNTL-CRD-FILE                                   05020026
050300       DISPLAY ' '                                                05030026
050400       DISPLAY '** ABEND     **'                                  05040026
050500       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05050026
050600       DISPLAY '** PARAGRAPH **  = 1020-READ-PGM-LAST-RUN-CARD'   05060026
050700       DISPLAY '** CONTROL FILE IS EMPTY  '                       05070026
050800       DISPLAY ' '                                                05080026
050900       MOVE +4002 TO ABEND-CODE                                   05090026
051000       CALL 'ILBOABN0' USING ABEND-CODE                           05100026
051100     ELSE                                                         05110026
051200       DISPLAY '** PROGRAM LAST RUN CONTROL CARD  **'             05120026
051300       DISPLAY '** EPCC400    **  =' EP400-CC-PREV-RUN-CUTOFF-TMST05130029
051400       DISPLAY ' '                                                05140028
051500     END-IF.                                                      05150026
051600                                                                  05160026
051700*1020-EXIT.                                                       05170026
051800 EJECT.                                                           05180026
051900                                                                  05190026
052000*----------------------------------------------------------       05200026
052100* 1030-READ-CURR-PRICG-DTE-CARD.                                  05210026
052200*     READ CONTROL CARD EPCC111. THIS CONTROL CARD CONTAINS       05220026
052300*     THE CURRENT PRICING DATE.                                   05230026
052400*----------------------------------------------------------       05240026
052500 1030-READ-CURR-PRICG-DTE-CARD.                                   05250026
052600                                                                  05260026
052700     READ CONTROL-CARD-CURR-PRICG-DTE                             05270026
052800                               INTO EP111-CC-CONTROL-CARD         05280026
052900       AT END                                                     05290026
053000          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05300026
053100                                                                  05310026
053200     IF PS-END-OF-CNTL-CRD-FILE                                   05320026
053300       DISPLAY ' '                                                05330026
053400       DISPLAY '** ABEND     **'                                  05340026
053500       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05350026
053600       DISPLAY '** PARAGRAPH **  = 1030-READ-CURR-PRICG-DTE-CARD' 05360026
053700       DISPLAY '** CONTROL FILE IS EMPTY  '                       05370026
053800       DISPLAY ' '                                                05380026
053900       MOVE +4002 TO ABEND-CODE                                   05390026
054000       CALL 'ILBOABN0' USING ABEND-CODE                           05400026
054100     ELSE                                                         05410026
054200       DISPLAY '** CURRENT PRICING DATE CONTROL CARD  **'         05420026
054300       DISPLAY '** EPCC111       **  = ' EP111-CC-CRNT-DTE        05430026
054400       DISPLAY ' '                                                05440026
054500     END-IF.                                                      05450026
054600                                                                  05460026
054700*1030-EXIT.                                                       05470026
054800 EJECT.                                                           05480026
054900                                                                  05490026
055000*----------------------------------------------------------       05500026
055100* 1040-READ-FUTRE-CORR-DTE-CARD.                                  05510026
055200*     READ CONTROL CARD EPCC113. THIS CONTROL CARD CONTAINS       05520026
055300*     THE NEXT FUTURE CORRECTIONS DATE                            05530026
055400*----------------------------------------------------------       05540026
055500 1040-READ-FUTRE-CORR-DTE-CARD.                                   05550026
055600                                                                  05560026
055700     READ CONTROL-CARD-FUTRE-CORR-DTE                             05570026
055800                               INTO EP113-CC-CONTROL-CARD         05580026
055900       AT END                                                     05590026
056000          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05600026
056100                                                                  05610026
056200     IF PS-END-OF-CNTL-CRD-FILE                                   05620026
056300       DISPLAY ' '                                                05630026
056400       DISPLAY '** ABEND     **'                                  05640026
056500       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05650026
056600       DISPLAY '** PARAGRAPH **  = 1040-READ-FUTRE-CORR-DTE-CARD' 05660026
056700       DISPLAY '** CONTROL FILE IS EMPTY  '                       05670026
056800       DISPLAY ' '                                                05680026
056900       MOVE +4002 TO ABEND-CODE                                   05690026
057000       CALL 'ILBOABN0' USING ABEND-CODE                           05700026
057100     ELSE                                                         05710026
057200       DISPLAY '** FUTURE CORRECTION DATE CONTROL CARD  **'       05720026
057300       DISPLAY '** EPCC113       **  = ' EP113-CC-CRNT-DTE        05730026
057400       DISPLAY ' '                                                05740026
057500     END-IF.                                                      05750026
057600                                                                  05760026
057700*1040-EXIT.                                                       05770026
057800 EJECT.                                                           05780026
057900                                                                  05790026
058000*----------------------------------------------------------       05800026
058100* 1050-READ-CRIT-EFF-DTE-CARD.                                    05810026
058200*     READ CONTROL CARD EPCC128  THIS CONTROL CARD CONTAINS       05820026
058300*     THE CRITICAL EFFECTIVE DATE, WHICH DETERMINES IF CHANGES    05830026
058400*     ARE EMERGENCY OR NIGHTLY.                                   05840026
058500*----------------------------------------------------------       05850026
058600 1050-READ-CRIT-EFF-DTE-CARD.                                     05860026
058700                                                                  05870026
058800     READ CONTROL-CARD-CRIT-EFF-DTE                               05880026
058900                               INTO EP128-CC-CONTROL-CARD         05890026
059000       AT END                                                     05900026
059100          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    05910026
059200                                                                  05920026
059300     IF PS-END-OF-CNTL-CRD-FILE                                   05930026
059400       DISPLAY ' '                                                05940026
059500       DISPLAY '** ABEND     **'                                  05950026
059600       DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME      05960026
059700       DISPLAY '** PARAGRAPH **  = 1050-READ-CRIT-EFF-DTE-CARD'   05970026
059800       DISPLAY '** CONTROL FILE IS EMPTY  '                       05980026
059900       DISPLAY ' '                                                05990026
060000       MOVE +4002 TO ABEND-CODE                                   06000026
060100       CALL 'ILBOABN0' USING ABEND-CODE                           06010026
060200     ELSE                                                         06020026
060300       DISPLAY '** CRITICAL EFFECTIVE DATE CONTROL CARD  **'      06030026
060400       DISPLAY '** EPCC128       **  = ' EP128-CC-CRITICAL-DTE    06040026
060500       DISPLAY ' '                                                06050026
060600     END-IF.                                                      06060026
060700                                                                  06070026
060800*1050-EXIT.                                                       06080026
060900 EJECT.                                                           06090026
061000                                                                  06100026
061100*----------------------------------------------------------       06110011
061200* 2000-PROCESS-SIMPLE-PRICING                                     06120015
061300*     MAIN PROCESSING AREA - EXECUTES RMS AND ADHOC QUERY         06130011
061400*     TO IDENTIFY SIMPLE PRICING CHANGES AND CREATES OUTPUT       06140015
061500*     FILES TO IDENTIFY WHICH STORE GROUP/PROMO INTERFACE I.D     06150015
061600*     COMBO'S NEED RECORDS CREATED FOR THE STORE SERVER.          06160011
061700*----------------------------------------------------------       06170011
061800 2000-PROCESS-SIMPLE-PRICING.                                     06180015
061900                                                                  06190011
062000     PERFORM 2100-PROCESS-RMS-CURSOR.                             06200011
062100                                                                  06210011
062200     PERFORM 2200-PROCESS-ADHOC-CURSOR.                           06220026
062300                                                                  06230016
062400*2000-EXIT.                                                       06240016
062500 EJECT.                                                           06250016
062600                                                                  06260016
062700*----------------------------------------------------------       06270016
062800* 2100-PROCESS-RMS-CURSOR.                                        06280016
062900*     READ THE RECORD FROM THE SIMPLE PRICING TABLE AND           06290015
063000*     CREATE PROMO AND PMAP RECORDS BASED ON THE RECORD READ.     06300011
063100*----------------------------------------------------------       06310011
063200 2100-PROCESS-RMS-CURSOR.                                         06320011
063300                                                                  06330051
063400     PERFORM 2110-OPEN-SMP-PRICG-RMS.                             06340047
063500     PERFORM 2120-FETCH-SMP-PRICG-RMS                             06350048
063600       UNTIL PS-SMP-PRICG-CSR-EOF.                                06360026
063700     PERFORM 2130-CLOSE-SMP-PRICG-RMS.                            06370047
063800                                                                  06380011
063900*2100-EXIT.                                                       06390047
064000 EJECT.                                                           06400011
064100                                                                  06410011
064200*----------------------------------------------------------       06420011
064300* 2110-OPEN-SMP-PRICG-RMS.                                        06430047
064400*     OPEN THE SIMPLE PRICING CURSOR (RMS).                       06440015
064500*----------------------------------------------------------       06450011
064600 2110-OPEN-SMP-PRICG-RMS.                                         06460047
064700                                                                  06470011
064800     PERFORM                                                      06480011
064900         WITH TEST AFTER                                          06490011
065000         VARYING PV-SQL-SUB                                       06500011
065100         FROM 1 BY 1                                              06510011
065200         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 06520011
065300                   OR  SQLCODE = 0)                               06530011
065400                                                                  06540011
065500         EXEC SQL                                                 06550011
065600           OPEN SMP-PRICG-RMS                                     06560051
065700         END-EXEC                                                 06570011
065800                                                                  06580011
065900         EVALUATE TRUE                                            06590011
066000           WHEN SQLCODE = -904                                    06600047
066100           WHEN SQLCODE = -911                                    06610047
066200           WHEN SQLCODE = -913                                    06620047
066300             CONTINUE                                             06630047
066400           WHEN SQLCODE = 0                                       06640047
066500             SET PS-SMP-PRICG-CSR-NOT-EOF TO TRUE                 06650047
066600           WHEN SQLWARN0 NOT EQUAL SPACE                          06660047
066700           WHEN SQLCODE NOT EQUAL ZERO                            06670047
066800             MOVE '2110-OPEN-SMP-PRICG-RMS'                       06680047
066900                                   TO PV-PARAGRAPH-NAME           06690047
067000             MOVE 'ERROR ON OPEN OF SMP PRICG RMS CURSOR'         06700049
067100                                   TO PV-DB2-OPERATION            06710047
067200             PERFORM 9900-SQL-ABEND-ROUTINE                       06720047
067300         END-EVALUATE                                             06730011
067400     END-PERFORM.                                                 06740011
067500                                                                  06750011
067600     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         06760011
067700       MOVE '2110-OPEN-SMP-PRICG-RMS'                             06770047
067800                             TO  PV-PARAGRAPH-NAME                06780011
067900       MOVE 'OPEN RETRIES EXCEEDED'                               06790047
068000                              TO  PV-DB2-OPERATION                06800011
068100       PERFORM 9900-SQL-ABEND-ROUTINE                             06810047
068200     END-IF.                                                      06820011
068300                                                                  06830011
068400*2110-EXIT.                                                       06840011
068500 EJECT.                                                           06850011
068600                                                                  06860011
068700*----------------------------------------------------------       06870011
068800* 2120-FETCH-SMP-PRICG-RMS.                                       06880047
068900*     FETCH THE SIMPLE PRICING ID CURSOR. (RMS)                   06890026
069000*----------------------------------------------------------       06900011
069100 2120-FETCH-SMP-PRICG-RMS.                                        06910047
069200                                                                  06920011
069300     PERFORM                                                      06930011
069400         WITH TEST AFTER                                          06940011
069500         VARYING PV-SQL-SUB                                       06950011
069600         FROM 1 BY 1                                              06960011
069700         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 06970011
069800                   OR  SQLCODE = 0                                06980011
069900                   OR  SQLCODE = +100)                            06990011
070000                                                                  07000011
070100         EXEC SQL                                                 07010051
070200           FETCH SMP-PRICG-RMS                                    07020051
070300           INTO  :XST00030-STAT-CDE                               07030051
070400                ,:XST00030-LAST-UPD-TMST                          07040051
070500                ,:XST00030-SOR-LAST-UPD-TMST                      07050051
070600                ,:XST00029-PROMO-INTFC-ID                         07060051
070700                ,:XST00029-MDSE-LNE-ID                            07070051
070800                ,:XST00029-STR-GP-TYP-CDE                         07080051
070900                ,:XST00029-STR-GP-ID                              07090051
071000                ,:XST00029-STR-SELN-HIER-CDE                      07100051
071100                ,:XST00029-ACTL-STRT-TMST                         07110051
071200                ,:XST00029-ACTL-END-TMST                          07120051
071300                ,:XST00028-PRICG-TYP-CDE                          07130051
071400         END-EXEC                                                 07140051
071500                                                                  07150011
071600         EVALUATE TRUE                                            07160051
071700           WHEN SQLCODE = -904                                    07170051
071800           WHEN SQLCODE = -911                                    07180051
071900           WHEN SQLCODE = -913                                    07190051
072000             CONTINUE                                             07200051
072100           WHEN SQLCODE = ZERO                                    07210051
072200             PERFORM 3000-FORMAT-RMS-OUTPUT                       07220051
072300             ADD 1 TO PC-CNT-RMS-RECS                             07230051
072400           WHEN SQLCODE = +100                                    07240051
072500             SET PS-SMP-PRICG-CSR-EOF TO TRUE                     07250051
072600           WHEN SQLWARN0 NOT EQUAL SPACE                          07260051
072700           WHEN SQLCODE NOT EQUAL ZERO                            07270051
072800             MOVE '2120-FETCH-SMP-PRICG-RMS'                      07280051
072900                                    TO PV-PARAGRAPH-NAME          07290051
073000             MOVE 'ERROR ON FETCHING SMP PRICG RMS CURSOR'        07300051
073100                                    TO PV-DB2-OPERATION           07310051
073200             PERFORM 9900-SQL-ABEND-ROUTINE                       07320051
073300         END-EVALUATE                                             07330051
073400     END-PERFORM.                                                 07340011
073500                                                                  07350011
073600     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         07360051
073700       MOVE '2120-FETCH-SMP-PRICG-RMS'                            07370047
073800                               TO  PV-PARAGRAPH-NAME              07380011
073900       MOVE 'FETCH RETRIES EXCEEDED'                              07390047
074000                               TO  PV-DB2-OPERATION               07400011
074100       PERFORM 9900-SQL-ABEND-ROUTINE                             07410047
074200     END-IF.                                                      07420011
074300                                                                  07430011
074400*2120-EXIT.                                                       07440011
074500 EJECT.                                                           07450011
074600                                                                  07460011
074700*-----------------------------------------------------------      07470011
074800* 2130-CLOSE-SMP-PRICG-RMS.                                       07480047
074900*                                                                 07490011
075000*-----------------------------------------------------------      07500011
075100 2130-CLOSE-SMP-PRICG-RMS.                                        07510047
075200                                                                  07520011
075300     PERFORM                                                      07530011
075400         WITH TEST AFTER                                          07540011
075500         VARYING PV-SQL-SUB                                       07550011
075600         FROM 1 BY 1                                              07560011
075700         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 07570011
075800                   OR  SQLCODE = 0)                               07580011
075900                                                                  07590011
076000         EXEC SQL                                                 07600051
076100           CLOSE SMP-PRICG-RMS                                    07610051
076200         END-EXEC                                                 07620051
076300                                                                  07630011
076400         EVALUATE TRUE                                            07640051
076500           WHEN SQLCODE = -904                                    07650051
076600           WHEN SQLCODE = -911                                    07660051
076700           WHEN SQLCODE = -913                                    07670051
076800           WHEN SQLCODE = 0                                       07680051
076900             CONTINUE                                             07690051
077000           WHEN SQLWARN0 NOT EQUAL SPACE                          07700051
077100           WHEN SQLCODE NOT EQUAL ZERO                            07710051
077200             MOVE '2130-CLOSE-SMP-PRICG-RMS'                      07720051
077300                                       TO PV-PARAGRAPH-NAME       07730051
077400             MOVE 'ERROR ON CLOSE OF SMP PRICG RMS CURSOR'        07740051
077500                                       TO PV-DB2-OPERATION        07750051
077600             PERFORM 9900-SQL-ABEND-ROUTINE                       07760051
077700         END-EVALUATE                                             07770051
077800     END-PERFORM.                                                 07780011
077900                                                                  07790011
078000     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         07800011
078100       MOVE '2130-CLOSE-SMP-PRICG-RMS'                            07810047
078200                               TO  PV-PARAGRAPH-NAME              07820011
078300       MOVE 'CLOSE RETRIES EXCEEDED'                              07830047
078400                               TO  PV-DB2-OPERATION               07840011
078500       PERFORM 9900-SQL-ABEND-ROUTINE                             07850047
078600     END-IF.                                                      07860011
078700                                                                  07870011
078800*2130-EXIT.                                                       07880011
078900 EJECT.                                                           07890011
079000                                                                  07900011
079100*----------------------------------------------------------       07910011
079200* 2200-PROCESS-ADHOC-CURSOR.                                      07920026
079300*     READ THE RECORD FROM THE SIMPLE PRICING TABLE AND           07930026
079400*     CREATE PROMO AND RECORDS BASED ON THE RECORD READ.          07940026
079500*----------------------------------------------------------       07950011
079600 2200-PROCESS-ADHOC-CURSOR.                                       07960026
079700                                                                  07970051
079800     PERFORM 2210-OPEN-SMP-PRICG-ADHOC.                           07980026
079900     PERFORM 2220-FETCH-SMP-PRICG-ADHOC                           07990029
080000       UNTIL PS-SMP-PRICG-ADHOC-CSR-EOF.                          08000047
080100     PERFORM 2230-CLOSE-SMP-PRICG-ADHOC.                          08010026
080200                                                                  08020011
080300*2200-EXIT.                                                       08030011
080400 EJECT.                                                           08040011
080500                                                                  08050011
080600*----------------------------------------------------------       08060011
080700* 2210-OPEN-SMP-PRICG-ADHOC.                                      08070026
080800*     OPEN THE SIMPLE PRICING ADHOC CURSOR.                       08080026
080900*----------------------------------------------------------       08090011
081000 2210-OPEN-SMP-PRICG-ADHOC.                                       08100026
081100                                                                  08110011
081200     PERFORM                                                      08120011
081300         WITH TEST AFTER                                          08130011
081400         VARYING PV-SQL-SUB                                       08140011
081500         FROM 1 BY 1                                              08150011
081600         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 08160011
081700                   OR  SQLCODE = 0)                               08170011
081800                                                                  08180011
081900         EXEC SQL                                                 08190051
082000           OPEN SMP-PRICG-ADHOC                                   08200051
082100         END-EXEC                                                 08210051
082200                                                                  08220011
082300         EVALUATE TRUE                                            08230011
082400           WHEN SQLCODE = -904                                    08240047
082500           WHEN SQLCODE = -911                                    08250047
082600           WHEN SQLCODE = -913                                    08260047
082700             CONTINUE                                             08270047
082800           WHEN SQLCODE = 0                                       08280047
082900             SET PS-SMP-PRICG-ADHOC-CSR-NOT-EOF TO TRUE           08290047
083000           WHEN SQLWARN0 NOT EQUAL SPACE                          08300047
083100           WHEN SQLCODE NOT EQUAL ZERO                            08310047
083200             MOVE '2210-OPEN-SMP-PRICG-ADHOC'                     08320047
083300                                     TO PV-PARAGRAPH-NAME         08330011
083400             MOVE 'ERROR ON OPEN OF SMP PRICG ADHOC CURSOR'       08340047
083500                                     TO PV-DB2-OPERATION          08350011
083600             PERFORM 9900-SQL-ABEND-ROUTINE                       08360047
083700         END-EVALUATE                                             08370011
083800     END-PERFORM.                                                 08380011
083900                                                                  08390011
084000     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         08400011
084100       MOVE '2210-OPEN-SMP-PRICG-ADHOC'                           08410047
084200                             TO  PV-PARAGRAPH-NAME                08420011
084300       MOVE 'OPEN RETRIES EXCEEDED'                               08430047
084400                              TO  PV-DB2-OPERATION                08440011
084500       PERFORM 9900-SQL-ABEND-ROUTINE                             08450047
084600     END-IF.                                                      08460011
084700                                                                  08470011
084800*2210-EXIT.                                                       08480011
084900 EJECT.                                                           08490011
085000                                                                  08500011
085100*----------------------------------------------------------       08510011
085200* 2220-FETCH-SMP-PRICG-ADHOC.                                     08520026
085300*     FETCH THE SIMPLE PRICING ADHOC CURSOR.                      08530026
085400*----------------------------------------------------------       08540011
085500 2220-FETCH-SMP-PRICG-ADHOC.                                      08550026
085600                                                                  08560011
085700     PERFORM                                                      08570011
085800         WITH TEST AFTER                                          08580011
085900         VARYING PV-SQL-SUB                                       08590011
086000         FROM 1 BY 1                                              08600011
086100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 08610011
086200                   OR  SQLCODE = 0                                08620011
086300                   OR  SQLCODE = +100)                            08630011
086400                                                                  08640011
086500         EXEC SQL                                                 08650051
086600           FETCH SMP-PRICG-ADHOC                                  08660051
086700            INTO  :XST00030-STAT-CDE                              08670051
086800                 ,:XST00030-LAST-UPD-TMST                         08680051
086900                 ,:XST00030-SOR-LAST-UPD-TMST                     08690051
087000                 ,:XST00031-PROMO-INTFC-ID                        08700051
087100                 ,:XST00031-MDSE-LNE-ID                           08710051
087200                 ,:XST00031-ADHC-STR-GP-ID                        08720051
087300                 ,:XST00031-STR-SELN-HIER-CDE                     08730051
087400                 ,:XST00031-ACTL-STRT-TMST                        08740051
087500                 ,:XST00031-ACTL-END-TMST                         08750051
087600                 ,:XST00028-PRICG-TYP-CDE                         08760051
087700         END-EXEC                                                 08770051
087800                                                                  08780011
087900         EVALUATE TRUE                                            08790051
088000           WHEN SQLCODE = -904                                    08800051
088100           WHEN SQLCODE = -911                                    08810051
088200           WHEN SQLCODE = -913                                    08820051
088300             CONTINUE                                             08830051
088400           WHEN SQLCODE = ZERO                                    08840051
088500             PERFORM 3100-FORMAT-ADHOC-OUTPUT                     08850051
088600             ADD 1 TO PC-CNT-ADHOC-RECS                           08860051
088700           WHEN SQLCODE = +100                                    08870051
088800             SET PS-SMP-PRICG-ADHOC-CSR-EOF TO TRUE               08880051
088900           WHEN SQLWARN0 NOT EQUAL SPACE                          08890051
089000           WHEN SQLCODE NOT EQUAL ZERO                            08900051
089100             MOVE '2220-FETCH-SMP-PRICG-ADHOC'                    08910051
089200                                    TO PV-PARAGRAPH-NAME          08920051
089300             MOVE 'ERROR ON FETCHING SMP PRICG ADHOC CURSOR'      08930051
089400                                    TO PV-DB2-OPERATION           08940051
089500             DISPLAY 'SQLCODE= ' SQLCODE                          08950051
089600             PERFORM 9900-SQL-ABEND-ROUTINE                       08960051
089700         END-EVALUATE                                             08970051
089800     END-PERFORM.                                                 08980011
089900                                                                  08990011
090000     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         09000051
090100       MOVE '2220-FETCH-SMP-PRICG-ADHOC'                          09010051
090200                              TO  PV-PARAGRAPH-NAME               09020051
090300       MOVE 'FETCH RETRIES EXCEEDED'                              09030051
090400                              TO  PV-DB2-OPERATION                09040051
090500       PERFORM 9900-SQL-ABEND-ROUTINE                             09050051
090600     END-IF.                                                      09060011
090700                                                                  09070011
090800*2220-EXIT.                                                       09080011
090900 EJECT.                                                           09090011
091000                                                                  09100011
091100*-----------------------------------------------------------      09110011
091200* 2230-CLOSE-SMP-PRICG-ADHOC.                                     09120026
091300*     CLOSE THE SIMPLE PRICING ADHOC CURSOR.                      09130026
091400*-----------------------------------------------------------      09140011
091500 2230-CLOSE-SMP-PRICG-ADHOC.                                      09150026
091600                                                                  09160011
091700     PERFORM                                                      09170011
091800         WITH TEST AFTER                                          09180011
091900         VARYING PV-SQL-SUB                                       09190011
092000         FROM 1 BY 1                                              09200011
092100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 09210011
092200                   OR  SQLCODE = 0)                               09220011
092300                                                                  09230011
092400         EXEC SQL                                                 09240051
092500           CLOSE SMP-PRICG-ADHOC                                  09250051
092600         END-EXEC                                                 09260051
092700                                                                  09270011
092800         EVALUATE TRUE                                            09280051
092900           WHEN SQLCODE = -904                                    09290051
093000           WHEN SQLCODE = -911                                    09300051
093100           WHEN SQLCODE = -913                                    09310051
093200           WHEN SQLCODE = 0                                       09320051
093300             CONTINUE                                             09330051
093400           WHEN SQLWARN0 NOT EQUAL SPACE                          09340051
093500           WHEN SQLCODE NOT EQUAL ZERO                            09350051
093600             MOVE '2230-CLOSE-SMP-PRICG-ADHOC'                    09360051
093700                                     TO PV-PARAGRAPH-NAME         09370051
093800             MOVE 'ERROR ON CLOSE OF SMP PRICG ADHOC CURSOR'      09380051
093900                                     TO PV-DB2-OPERATION          09390051
094000             PERFORM 9900-SQL-ABEND-ROUTINE                       09400051
094100         END-EVALUATE                                             09410051
094200     END-PERFORM.                                                 09420011
094300                                                                  09430011
094400     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         09440011
094500       MOVE '2230-CLOSE-SMP-PRICG-ADHOC'                          09450047
094600                               TO  PV-PARAGRAPH-NAME              09460011
094700       MOVE 'CLOSE RETRIES EXCEEDED'                              09470047
094800                               TO  PV-DB2-OPERATION               09480011
094900       PERFORM 9900-SQL-ABEND-ROUTINE                             09490047
095000     END-IF.                                                      09500011
095100                                                                  09510011
095200*2230-EXIT.                                                       09520011
095300 EJECT.                                                           09530011
095400                                                                  09540011
095500*-----------------------------------------------------------      09550026
095600* 3000-FORMAT-RMS-OUTPUT.                                         09560026
095700*     POPULATE COPYBOOK EPRD072.                                  09570026
095800*-----------------------------------------------------------      09580026
095900 3000-FORMAT-RMS-OUTPUT.                                          09590026
096000                                                                  09600026
096100     INITIALIZE EP072-PROMO-INTFC-RECORD.                         09610037
096200     MOVE PC-PRICING-BUS-EVENT                                    09620026
096300                             TO EP072-BUSINESS-EVENT-ID.          09630026
096400     MOVE PC-RMS-PRC-SETUP-IND                                    09640026
096500                             TO EP072-PRC-SETUP-IND.              09650026
096600     MOVE XST00029-STR-GP-TYP-CDE                                 09660026
096700                             TO EP072-SETUP-STR-GRP-TYP-CDE.      09670026
096800     MOVE XST00029-STR-GP-ID                                      09680026
096900                             TO EP072-SETUP-STR-GRP-ID.           09690026
097000     MOVE XST00029-STR-SELN-HIER-CDE                              09700026
097100                             TO EP072-STR-SELN-HIER-CDE.          09710026
097200     MOVE XST00029-STR-GP-TYP-CDE                                 09720026
097300                             TO EP072-DIST-STR-GRP-TYP-CDE.       09730026
097400     MOVE XST00029-STR-GP-ID                                      09740026
097500                             TO EP072-DIST-STR-GRP-ID.            09750026
097600     MOVE PC-FILE-ACT-TYPE   TO EP072-FILE-ACT-TYP.               09760026
097700                                                                  09770026
097800     MOVE XST00029-ACTL-STRT-TMST                                 09780042
097900                             TO PV-ACTL-STRT-TMST.                09790042
098000                                                                  09800042
098100     IF PV-ACTL-STRT-TMST-DATE > EP128-CC-CRITICAL-DTE            09810042
098200       AND PV-ACTL-STRT-TMST-DATE < EP113-CC-CRNT-DTE             09820047
098300         MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND               09830047
098400     END-IF.                                                      09840042
098500                                                                  09850026
098600     MOVE XST00030-STAT-CDE  TO PC-SMP-PRICG-STAT-CDE             09860026
098700                                                                  09870026
098800     IF PC-SCHEDULED-STATUS                                       09880026
098900       MOVE PC-ADD-STAT-CDE                                       09890026
099000                             TO EP072-RECORD-ACTION               09900026
099100     ELSE                                                         09910026
099200       IF PC-DELETE-STATUS OR PC-CANCEL-STATUS                    09920047
099300         MOVE PC-DELETE-STAT-CDE                                  09930047
099400                             TO EP072-RECORD-ACTION               09940047
099500       END-IF                                                     09950047
099600     END-IF.                                                      09960047
099700                                                                  09970026
099800     MOVE XST00029-PROMO-INTFC-ID                                 09980026
099900                             TO EP072-PROMO-INTFC-ID.             09990026
100000     MOVE XST00029-MDSE-LNE-ID                                    10000026
100100                             TO EP072-MERCH-LNE-ID.               10010026
100200     MOVE XST00028-PRICG-TYP-CDE                                  10020026
100300                             TO EP072-PRICG-TYP-CDE.              10030026
100400     MOVE PC-MDSE-INCL-IND                                        10040026
100500                             TO EP072-MDSE-INC-EXC-IND.           10050026
100600     MOVE XST00029-ACTL-STRT-TMST                                 10060026
100700                             TO EP072-STR-GRP-PROMO-STRT-TMST.    10070026
100800     MOVE XST00029-ACTL-END-TMST                                  10080026
100900                             TO EP072-STR-GRP-PROMO-END-TMST.     10090026
101000     MOVE XST00030-SOR-LAST-UPD-TMST                              10100026
101100                             TO EP072-SOR-LAST-UPD-TMST.          10110026
101200                                                                  10120026
101300     IF EP072-APPLY-NIGHTLY                                       10130026
101400       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10140026
101500     ELSE                                                         10150026
101600       MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND                 10160052
101700       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10170026
101800     END-IF.                                                      10180026
101900                                                                  10190026
102000*3000-EXIT.                                                       10200026
102100 EJECT.                                                           10210026
102200*-----------------------------------------------------------      10220026
102300* 3100-FORMAT-ADHOC-OUTPUT.                                       10230026
102400*     POPULATE COPYBOOK EPRD072.                                  10240026
102500*-----------------------------------------------------------      10250026
102600 3100-FORMAT-ADHOC-OUTPUT.                                        10260026
102700                                                                  10270026
102800     INITIALIZE EP072-PROMO-INTFC-RECORD.                         10280037
102900     MOVE PC-PRICING-BUS-EVENT                                    10290026
103000                             TO EP072-BUSINESS-EVENT-ID.          10300026
103100     MOVE PC-ADHOC-PRC-SETUP-IND                                  10310026
103200                             TO EP072-PRC-SETUP-IND.              10320026
103300     MOVE PC-ADHOC-STR-GRP-TYP-CDE                                10330026
103400                             TO EP072-SETUP-STR-GRP-TYP-CDE.      10340026
103500     MOVE XST00031-ADHC-STR-GP-ID                                 10350011
103600                             TO EP072-SETUP-STR-GRP-ID.           10360011
103700     MOVE XST00031-STR-SELN-HIER-CDE                              10370011
103800                             TO EP072-STR-SELN-HIER-CDE.          10380011
103900     MOVE PC-ADHOC-STR-GRP-TYP-CDE                                10390011
104000                             TO EP072-DIST-STR-GRP-TYP-CDE.       10400011
104100     MOVE XST00031-ADHC-STR-GP-ID                                 10410011
104200                             TO EP072-DIST-STR-GRP-ID.            10420011
104300     MOVE PC-FILE-ACT-TYPE   TO EP072-FILE-ACT-TYP.               10430011
104400                                                                  10440011
104500     MOVE XST00031-ACTL-STRT-TMST                                 10450043
104600                             TO PV-ACTL-STRT-TMST.                10460042
104700                                                                  10470042
104800     IF PV-ACTL-STRT-TMST-DATE > EP128-CC-CRITICAL-DTE            10480042
104900       AND PV-ACTL-STRT-TMST-DATE < EP113-CC-CRNT-DTE             10490047
105000         MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND               10500047
105100     END-IF.                                                      10510042
105200                                                                  10520011
105300     MOVE XST00030-STAT-CDE  TO PC-SMP-PRICG-STAT-CDE             10530029
105400                                                                  10540011
105500     IF PC-SCHEDULED-STATUS                                       10550011
105600       MOVE PC-ADD-STAT-CDE                                       10560011
105700                             TO EP072-RECORD-ACTION               10570011
105800     ELSE                                                         10580011
105900       IF PC-DELETE-STATUS OR PC-CANCEL-STATUS                    10590047
106000         MOVE PC-DELETE-STAT-CDE                                  10600047
106100                             TO EP072-RECORD-ACTION               10610047
106200       END-IF                                                     10620047
106300     END-IF.                                                      10630047
106400                                                                  10640011
106500     MOVE XST00031-PROMO-INTFC-ID                                 10650011
106600                             TO EP072-PROMO-INTFC-ID.             10660011
106700     MOVE XST00031-MDSE-LNE-ID                                    10670011
106800                             TO EP072-MERCH-LNE-ID.               10680011
106900     MOVE XST00028-PRICG-TYP-CDE                                  10690011
107000                             TO EP072-PRICG-TYP-CDE.              10700011
107100     MOVE PC-MDSE-INCL-IND                                        10710026
107200                             TO EP072-MDSE-INC-EXC-IND.           10720011
107300     MOVE XST00031-ACTL-STRT-TMST                                 10730011
107400                             TO EP072-STR-GRP-PROMO-STRT-TMST.    10740011
107500     MOVE XST00031-ACTL-END-TMST                                  10750026
107600                             TO EP072-STR-GRP-PROMO-END-TMST.     10760011
107700     MOVE XST00030-SOR-LAST-UPD-TMST                              10770026
107800                             TO EP072-SOR-LAST-UPD-TMST.          10780011
107900                                                                  10790011
108000     IF EP072-APPLY-NIGHTLY                                       10800011
108100       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10810011
108200     ELSE                                                         10820011
108300       MOVE PC-APPLY-NIGHTLY   TO EP072-APPLY-IND                 10830052
108400       PERFORM 4000-WRITE-NIGHT-APPLY-RECORD                      10840052
108500     END-IF.                                                      10850011
108600                                                                  10860011
108700*3100-EXIT.                                                       10870011
108800 EJECT.                                                           10880011
108900                                                                  10890011
109000*----------------------------------------------------------       10900026
109100* 4000-WRITE-NIGHT-APPLY-RECORD.                                  10910026
109200*     WRITES THE PROMO FULL FILE RECORD TO THE FULL FILE          10920026
109300*----------------------------------------------------------       10930011
109400 4000-WRITE-NIGHT-APPLY-RECORD.                                   10940011
109500                                                                  10950011
109600     WRITE PROMO-NIGHT-RECORD FROM EP072-PROMO-INTFC-RECORD.      10960011
109700                                                                  10970011
109800     ADD 1           TO PC-CNT-NIGHT-RECS                         10980011
109900                        PC-CNT-ALL-RECS.                          10990011
110000                                                                  11000011
110100*4000-EXIT.                                                       11010011
110200 EJECT.                                                           11020011
110300                                                                  11030011
110400*----------------------------------------------------------       11040047
110500* DATE ROUTINE TO SET UP THE PROCESS DATE IN                      11050047
110600* CCYYMMDD FORMAT.                                                11060047
110700*----------------------------------------------------------       11070047
110800 6100-DATE-ROUTINE.                                               11080011
110900                                                                  11090011
111000     INITIALIZE DPG51 DPG52 DPG53                                 11100011
111100                DPG54 DPG55 DPG56.                                11110011
111200                                                                  11120011
111300     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11130011
111400     SET DPG51-INCREMENT-DATE       TO TRUE.                      11140011
111500     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      11150011
111600     MOVE 1                         TO DPG51-INCR-DECR-DAYS-9.    11160011
111700     MOVE EP111-CC-CRNT-DTE         TO DPG52-DB2-ISO-DATE-FMT.    11170011
111800                                                                  11180011
111900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11190011
112000                                             DPG54 DPG55 DPG56.   11200011
112100                                                                  11210011
112200     IF DPG54-SEVERE-ERROR OR DPG54-DATE-INVALID                  11220011
112300       DISPLAY '** ABEND **'                                      11230047
112400       DISPLAY '** PROGRAM = EPKUT352'                            11240047
112500       DISPLAY 'DATE = ' EP111-CC-CRNT-DTE                        11250047
112600       DISPLAY DPG54-ERROR-MESSAGE                                11260047
112700       MOVE 4019 TO PV-ABEND-CODE                                 11270047
112800       CALL 'ILBOABN0' USING PV-ABEND-CODE                        11280048
112900     END-IF.                                                      11290047
113000                                                                  11300011
113100     MOVE DPG55-DB2-ISO-DATE-FMT     TO EP111-CC-DATE-PLUS1.      11310011
113200                                                                  11320011
113300     INITIALIZE DPG51 DPG52 DPG53                                 11330011
113400                DPG54 DPG55 DPG56.                                11340011
113500                                                                  11350011
113600     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      11360011
113700     SET DPG51-DECREMENT-DATE       TO TRUE.                      11370011
113800     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      11380011
113900     MOVE 1                         TO DPG51-INCR-DECR-DAYS-9.    11390011
114000     MOVE EP113-CC-CRNT-DTE         TO DPG52-DB2-ISO-DATE-FMT.    11400011
114100                                                                  11410011
114200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11420011
114300                                             DPG54 DPG55 DPG56.   11430011
114400                                                                  11440011
114500     IF DPG54-SEVERE-ERROR OR DPG54-DATE-INVALID                  11450011
114600       DISPLAY '** ABEND **'                                      11460047
114700       DISPLAY '** PROGRAM = EPKUT352'                            11470047
114800       DISPLAY 'DATE = ' EP111-CC-CRNT-DTE                        11480047
114900       DISPLAY DPG54-ERROR-MESSAGE                                11490047
115000       MOVE 4019 TO PV-ABEND-CODE                                 11500047
115100       CALL 'ILBOABN0' USING PV-ABEND-CODE                        11510048
115200     END-IF.                                                      11520047
115300                                                                  11530011
115400     MOVE DPG55-DB2-ISO-DATE-FMT    TO EP113-CC-CRNT-DTE-MINUS1.  11540011
115500                                                                  11550011
115600*6100-EXIT.                                                       11560011
115700 EJECT.                                                           11570011
115800                                                                  11580011
115900*----------------------------------------------------------       11590011
116000* 9900-SQL-ABEND-ROUTINE.                                         11600011
116100*     SQL ABEND ROUTINE.                                          11610011
116200*----------------------------------------------------------       11620011
116300 9900-SQL-ABEND-ROUTINE.                                          11630011
116400                                                                  11640011
116500     DISPLAY '** ABEND     **'.                                   11650011
116600     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11660011
116700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              11670011
116800     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               11680011
116900                                                                  11690011
117000     COPY DPPD004.                                                11700011
117100     SET ABEND-4013-DB2-ERROR TO TRUE.                            11710011
117200     CALL 'ILBOABN0' USING ABEND-CODE.                            11720011
117300                                                                  11730011
117400*9900-EXIT.                                                       11740011
117500 EJECT.                                                           11750011
117600                                                                  11760011
117700*----------------------------------------------------------       11770011
117800* 9999-WRAPUP.                                                    11780011
117900*     END OF PROGRAM ROUTINE.  CLOSES ALL FILES AND DISPLAYS      11790011
118000*     ANY DATA FROM THE PROGRAM.                                  11800011
118100*----------------------------------------------------------       11810011
118200 9999-WRAPUP.                                                     11820011
118300                                                                  11830029
118400     CLOSE CONTROL-CARD-CURR-PRICG-DTE                            11840029
118500           CONTROL-CARD-FUTRE-CORR-DTE                            11850029
118600           CONTROL-CARD-PGM-CURR-TMST                             11860066
118700           CONTROL-CARD-PGM-LAST-RUN-TMST                         11870029
118800           CONTROL-CARD-CRIT-EFF-DTE                              11880029
118900           PROMO-NIGHT-FILE.                                      11890029
119000*          PROMO-EMERGENCY-FILE.                                  11900029
119100                                                                  11910029
119200     DISPLAY ' '.                                                 11920011
119300     DISPLAY '*********************************************'.     11930011
119400     DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            11940011
119500     DISPLAY '*********************************************'.     11950011
119600     DISPLAY 'NUMBER OF NIGHT RECS WRITTEN: ' PC-CNT-NIGHT-RECS.  11960011
119700     DISPLAY 'NUMBER OF RECS FROM RMS QUERY:' PC-CNT-RMS-RECS.    11970011
119800     DISPLAY 'NUMBER OF RECS FROM ADHC QUERY: ' PC-CNT-ADHOC-RECS.11980011
119900     DISPLAY 'ALL RECS WRITTEN: ' PC-CNT-ALL-RECS.                11990011
120000     DISPLAY '*********************************************'.     12000011
120100                                                                  12010011
120200*9999-EXIT.                                                       12020011
120300 EJECT.                                                           12030011
120400                                                                  12040011
