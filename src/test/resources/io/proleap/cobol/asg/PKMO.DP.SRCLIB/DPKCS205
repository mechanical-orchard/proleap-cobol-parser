000100******************************************************************00010013
000200 IDENTIFICATION DIVISION.                                         00020013
000300******************************************************************00030013
000400                                                                  00040013
000500 PROGRAM-ID.                DPKCS205.                             00050013
000600 AUTHOR.                    BRUCE BORCHARDT.                      00060013
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070013
000800 DATE-WRITTEN.              02-15-90.                             00080013
000900 DATE-COMPILED.                                                   00090013
001000                                                                  00100013
001100******************************************************************00110013
001200*  CICS PROGRAM - DPKCS205                                       *00120013
001300*                                                                *00130013
001400*  COMMAND LEVEL SIGN ON PROGRAM                                 *00140013
001500******************************************************************00150013
001600                                                                  00160013
001700******************************************************************00170013
001800 ENVIRONMENT DIVISION.                                            00180013
001900******************************************************************00190013
002000                                                                  00200013
002100******************************************************************00210013
002200 DATA DIVISION.                                                   00220013
002300******************************************************************00230013
002400                                                                  00240013
002500 WORKING-STORAGE SECTION.                                         00250013
002600*                                                                 00260013
002700*  STANDARD ATTENTION IDENTIFIER LIST                             00270013
002800*                                                                 00280013
002900                                                                  00290013
003000     COPY DFHAID.                                                 00300013
003100                                                                  00310013
003200   EJECT                                                          00320013
003300*                                                                 00330013
003400*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          00340013
003500*                                                                 00350013
003600                                                                  00360013
003700     COPY DFHBMSCA.                                               00370013
003800                                                                  00380013
003900   EJECT                                                          00390013
004000*                                                                 00400013
004100*  DESCRIPTIVE ATTRIBUTES                                         00410013
004200*                                                                 00420013
004300                                                                  00430013
004400     COPY DPWS015.                                                00440013
004500                                                                  00450013
004600*                                                                 00460013
004700*  DSECT FOR THE DPKM205 MAPSET                                   00470013
004800*                                                                 00480013
004900                                                                  00490013
005000     COPY DPKM205.                                                00500013
005100                                                                  00510013
005200   EJECT                                                          00520013
005300*                                                                 00530013
005400*  COMM AREA FOR CALL TO SECURITY SUBROUTINE                      00540013
005500*                                                                 00550013
005600                                                                  00560013
005700     COPY DPWS008.                                                00570013
005800                                                                  00580013
005900 01 PV-PROGRAM-VARIABLES.                                         00590013
006000      05 FILLER                       PIC X(9) VALUE 'RESPONSES'. 00600013
006100      05 PV-APPLID                    PIC X(8).                   00610013
006200      05 PV-NETNAME.                                              00620013
006300         10 FILLER                    PIC X(4).                   00630013
006400         10 PV-TERMID                 PIC X(4).                   00640013
006500      05 PV-ABSTIME                   PIC S9(15) COMP-3.          00650013
006600      05 PV-MMDDYY                    PIC X(8).                   00660013
006700      05 PV-TIME                      PIC X(8).                   00670013
006800      05 PV-COM-LEN                   PIC S9(4) COMP VALUE 50.    00680013
006900      05 PV-CICS-RESPONSE             PIC S9(8) COMP.             00690013
007000      05 FILLER                       PIC X(9) VALUE 'RESPONSES'. 00700013
007100      05 PV-RESP                      PIC S9(8) COMP.             00710013
007200      05 PV-RESP2                     PIC S9(8) COMP.             00720013
007300      05 PV-RESP-DISPLAY              PIC X(8).                   00730013
007400      05 PV-RESP2-DISPLAY             PIC X(8).                   00740013
007500      05 PV-SYSID                     PIC X(4).                   00750013
007600      05 PV-SECONDS                   PIC S9(8) COMP VALUE +20.   00760015
007700      05 PV-MESSAGE9-LEN              PIC S9(4) COMP VALUE 19.    00770013
007800 01 MF-MAP-FIELDS.                                                00780013
007900      05 MF-USERID.                                               00790013
008000         10 MF-CICS.                                              00800013
008100            15 MF-USERID1             PIC X VALUE SPACES.         00810013
008200            15 FILLER                 PIC X(3) VALUE SPACES.      00820013
008300         10 FILLER                    PIC X(4) VALUE SPACES.      00830013
008400      05 MF-PASSWORD                  PIC X(8) VALUE SPACES.      00840013
008500      05 MF-NEWPASS1                  PIC X(8) VALUE SPACES.      00850013
008600      05 MF-NEWPASS2                  PIC X(8) VALUE SPACES.      00860013
008700      05 MF-MESSAGE                   PIC X(68) VALUE SPACES.     00870013
008800 01 EM-ERROR-MESSAGES.                                            00880013
008900      05 EM-MESSAGE1                  PIC X(68)                   00890013
009000      VALUE 'PLEASE PROVIDE A PASSWORD BEFORE PRESSING ENTER'.    00900013
009100      05 EM-MESSAGE2                  PIC X(68)                   00910013
009200      VALUE 'PASSWORD AS ENTERED IS INVALID, PLEASE TRY AGAIN'.   00920013
009300      05 EM-MESSAGE3                  PIC X(68) VALUE             00930013
009400      'PASSWORD EXPIRED...PLEASE USE SELF CARE TO CHANGE'.        00940014
009500      05 EM-MESSAGE4                  PIC X(68)                   00950013
009600      VALUE 'INVALID NEW PASSWORD ENTERED, PLEASE TRY AGAIN'.     00960013
009700      05 EM-MESSAGE5                  PIC X(68)                   00970013
009800      VALUE 'YOU ARE NOT AUTHORIZED TO USE THIS SYSTEM'.          00980013
009900      05 EM-MESSAGE6                  PIC X(68) VALUE             00990013
010000      'YOUR USERID HAS BEEN REVOKED, PLEASE CALL THE HELP DESK'.  01000013
010100      05 EM-MESSAGE7                  PIC X(68) VALUE             01010013
010200      'YOUR USERID IS NOT KNOWN TO THE SYSTEM, PLEASE TRY AGAIN'. 01020013
010300      05 EM-MESSAGE8                  PIC X(68) VALUE             01030013
010400      'YOU ARE ALREADY SIGNED ON   DISCONNECTING TO TRY AGAIN  '. 01040013
010500      05 EM-MESSAGE9                  PIC X(19) VALUE             01050013
010600      'SIGN-ON IS COMPLETE'.                                      01060013
010700      05 EM-MESSAGE10                 PIC X(43) VALUE             01070013
010800      'YOU ARE NOT AUTHORIZED TO USE THIS TERMINAL'.              01080013
010900 01 CA-COMMON-AREA.                                               01090013
011000      05 CA-FIRST-PASS                PIC X(1)  VALUE 'Y'.        01100013
011100      05 CA-RECEIVE-MAP2              PIC X(1)  VALUE 'N'.        01110013
011200      05 CA-MMDDYY                    PIC X(8).                   01120013
011300      05 CA-TIME                      PIC X(8).                   01130013
011400      05 CA-NETNAME.                                              01140013
011500         10 FILLER                    PIC X(4).                   01150013
011600         10 CA-TERMID                 PIC X(4).                   01160013
011700      05 CA-APPLID                    PIC X(8).                   01170013
011800      05 CA-PASSWORD                  PIC X(8).                   01180013
011900      05 CA-USERID                    PIC X(8).                   01190013
012000   EJECT                                                          01200013
012100******************************************************************01210013
012200 LINKAGE SECTION.                                                 01220013
012300******************************************************************01230013
012400                                                                  01240013
012500 01  DFHCOMMAREA.                                                 01250013
012600     05  FIRST-PASS                   PIC X(1).                   01260013
012700     05  RECEIVE-MAP2                 PIC X(1).                   01270013
012800     05  FILLER                       PIC X(48).                  01280013
012900                                                                  01290013
013000******************************************************************01300013
013100 PROCEDURE DIVISION.                                              01310013
013200******************************************************************01320013
013300 0000-MAIN-LINE.                                                  01330013
013400     EVALUATE TRUE                                                01340013
013500         WHEN EIBCALEN = ZERO                                     01350013
013600             PERFORM 1000-INIT-MAP1                               01360013
013700             MOVE LOW-VALUES TO DP205AI                           01370013
013800             MOVE -1 TO AUSERIDL                                  01380013
013900             PERFORM 2000-SEND-MAP1 THRU 2001-SEND-MAP1           01390013
014000         WHEN EIBAID = DFHPF3                                     01400013
014100             PERFORM 9000-GO-HOME                                 01410013
014200         WHEN EIBAID = DFHCLEAR                                   01420013
014300             MOVE -1 TO AUSERIDL                                  01430013
014400             PERFORM 8000-SEND-AGAIN                              01440013
014500         WHEN RECEIVE-MAP2 = 'Y'                                  01450013
014600             PERFORM 4010-RECEIVE-MAP2                            01460013
014700             PERFORM 4020-RECEIVE-MAP2-FIELDS                     01470013
014800         WHEN OTHER                                               01480013
014900             PERFORM 3000-RECEIVE-MAP1                            01490013
015000             PERFORM 3010-RECEIVE-MAP1-FIELDS                     01500013
015100     END-EVALUATE.                                                01510013
015200     GOBACK.                                                      01520013
015300 1000-INIT-MAP1.                                                  01530013
015400     EXEC CICS ASKTIME                                            01540013
015500         ABSTIME(PV-ABSTIME)                                      01550013
015600     END-EXEC.                                                    01560013
015700     EXEC CICS FORMATTIME                                         01570013
015800         ABSTIME(PV-ABSTIME)                                      01580013
015900         MMDDYY(PV-MMDDYY)                                        01590013
016000         DATESEP('/')                                             01600013
016100         TIME(PV-TIME)                                            01610013
016200         TIMESEP(':')                                             01620013
016300         END-EXEC.                                                01630013
016400     EXEC CICS ASSIGN                                             01640013
016500         APPLID(PV-APPLID)                                        01650013
016600         NETNAME(PV-NETNAME)                                      01660013
016700     END-EXEC.                                                    01670013
016800 2000-SEND-MAP1.                                                  01680013
016900     MOVE PV-MMDDYY TO ADATEO CA-MMDDYY.                          01690013
017000     MOVE PV-TIME TO ATIMEO CA-TIME.                              01700013
017100     MOVE PV-NETNAME TO ANETNAMO CA-NETNAME.                      01710013
017200     MOVE PV-APPLID TO ASYSTEMO CA-APPLID.                        01720013
017210     EXEC CICS SET TERMINAL(EIBTRMID) NOUCTRAN                    01721017
017220     END-EXEC.                                                    01722016
017300     EXEC CICS                                                    01730013
017400         SEND                                                     01740013
017500             MAP('DP205A')                                        01750013
017600             MAPSET('DPKM205')                                    01760013
017700             ERASE                                                01770013
017800             CURSOR                                               01780013
017900             FORMFEED                                             01790013
018000             WAIT                                                 01800013
018100             RESP(PV-CICS-RESPONSE)                               01810013
018200     END-EXEC.                                                    01820013
018300 2001-SEND-MAP1.                                                  01830013
018400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    01840013
018500          EXEC CICS RETURN END-EXEC.                              01850013
018600     MOVE 'N' TO CA-FIRST-PASS.                                   01860013
018700     EXEC CICS RETURN                                             01870013
018800               TRANSID('Z205')                                    01880013
018900               COMMAREA(CA-COMMON-AREA)                           01890013
019000               LENGTH(PV-COM-LEN)                                 01900013
019100     END-EXEC.                                                    01910013
019200 3000-RECEIVE-MAP1.                                               01920013
019300     MOVE DFHCOMMAREA TO CA-COMMON-AREA.                          01930013
019400     EXEC CICS                                                    01940013
019500         RECEIVE                                                  01950013
019600             MAP('DP205A')                                        01960013
019700             MAPSET('DPKM205')                                    01970013
019800             RESP(PV-CICS-RESPONSE)                               01980013
019900     END-EXEC.                                                    01990013
020000     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        02000013
020100         PERFORM 3010-RECEIVE-MAP1-FIELDS                         02010013
020200     ELSE                                                         02020013
020300         MOVE -1 TO AUSERIDL                                      02030013
020400         PERFORM 8000-SEND-AGAIN.                                 02040013
020500                                                                  02050013
020600 3010-RECEIVE-MAP1-FIELDS.                                        02060013
020700     MOVE AUSERIDI TO MF-USERID CA-USERID.                        02070013
020800     MOVE APSSWRDI TO MF-PASSWORD CA-PASSWORD.                    02080013
020900     IF MF-CICS = 'CICS'                                          02090013
021000         PERFORM 9000-GO-HOME.                                    02100013
021100     IF MF-USERID1 = ' ' OR LOW-VALUES                            02110013
021200         PERFORM 9000-GO-HOME.                                    02120013
021300     EXEC CICS SIGNON                                             02130013
021400         USERID(MF-USERID)                                        02140013
021500         PASSWORD(MF-PASSWORD)                                    02150013
021600         RESP(PV-RESP)                                            02160013
021700         RESP2(PV-RESP2)                                          02170013
021800     END-EXEC.                                                    02180013
021900     MOVE PV-RESP TO PV-RESP-DISPLAY.                             02190013
022000     MOVE PV-RESP2 TO PV-RESP2-DISPLAY.                           02200013
022100     EXEC CICS ASKTIME END-EXEC.                                  02210013
022200     EVALUATE TRUE                                                02220013
022300         WHEN PV-RESP = DFHRESP(USERIDERR)                        02230013
022400             MOVE LOW-VALUES TO DP205AI                           02240013
022500             MOVE -1 TO AUSERIDL                                  02250013
022600             MOVE EM-MESSAGE7 TO AMESSGEO                         02260013
022700             PERFORM 1000-INIT-MAP1                               02270013
022800             PERFORM 2000-SEND-MAP1                               02280013
022900             MOVE 'N' TO CA-FIRST-PASS                            02290013
023000             EXEC CICS RETURN                                     02300013
023100                  TRANSID('Z205')                                 02310013
023200                  COMMAREA(CA-COMMON-AREA)                        02320013
023300                  LENGTH(PV-COM-LEN)                              02330013
023400             END-EXEC                                             02340013
023500         WHEN PV-RESP2 = 1                                        02350013
023600             MOVE LOW-VALUES TO DP205AI                           02360013
023700             MOVE EM-MESSAGE1 TO AMESSGEO                         02370013
023800             MOVE CA-USERID  TO AUSERIDO                          02380013
023900             MOVE DFHUNIMD   TO AUSERIDA                          02390013
024000             MOVE -1 TO APSSWRDL                                  02400013
024100             PERFORM 1000-INIT-MAP1                               02410013
024200             PERFORM 2000-SEND-MAP1                               02420013
024300             MOVE 'N' TO CA-FIRST-PASS                            02430013
024400             EXEC CICS RETURN                                     02440013
024500                  TRANSID('Z205')                                 02450013
024600                  COMMAREA(CA-COMMON-AREA)                        02460013
024700                  LENGTH(PV-COM-LEN)                              02470013
024800             END-EXEC                                             02480013
024900         WHEN PV-RESP2 = 2                                        02490013
025000             MOVE LOW-VALUES TO DP205AI                           02500013
025100             MOVE EM-MESSAGE2 TO AMESSGEO                         02510013
025200             MOVE CA-USERID  TO AUSERIDO                          02520013
025300             MOVE DFHUNIMD   TO AUSERIDA                          02530013
025400             MOVE -1 TO APSSWRDL                                  02540013
025500             PERFORM 1000-INIT-MAP1                               02550013
025600             PERFORM 2000-SEND-MAP1                               02560013
025700             MOVE 'N' TO CA-FIRST-PASS                            02570013
025800             EXEC CICS RETURN                                     02580013
025900                  TRANSID('Z205')                                 02590013
026000                  COMMAREA(CA-COMMON-AREA)                        02600013
026100                  LENGTH(PV-COM-LEN)                              02610013
026200             END-EXEC                                             02620013
026300         WHEN PV-RESP2 = 3                                        02630013
026400             MOVE LOW-VALUES TO DP205AI                           02640013
026500             MOVE EM-MESSAGE3 TO AMESSGEO                         02650013
026600             PERFORM 2000-SEND-MAP1                               02660013
026700             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              02670013
026800             END-EXEC                                             02680013
026900             PERFORM 9000-GO-HOME                                 02690013
027000         WHEN PV-RESP2 = 4                                        02700013
027100             MOVE LOW-VALUES TO DP205BI                           02710013
027200             MOVE EM-MESSAGE4 TO BMESSGEO                         02720013
027300             PERFORM 4000-SEND-MAP2 THRU 4001-SEND-MAP2           02730013
027400             MOVE 'N' TO CA-FIRST-PASS                            02740013
027500             MOVE 'Y' TO CA-RECEIVE-MAP2                          02750013
027600             EXEC CICS RETURN                                     02760013
027700                  TRANSID('Z205')                                 02770013
027800                  COMMAREA(CA-COMMON-AREA)                        02780013
027900                  LENGTH(PV-COM-LEN)                              02790013
028000             END-EXEC                                             02800013
028100         WHEN PV-RESP2 = 8                                        02810013
028200             MOVE LOW-VALUES TO DP205BI                           02820013
028300             MOVE EM-MESSAGE7 TO BMESSGEO                         02830013
028400             PERFORM 4000-SEND-MAP2                               02840013
028500             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              02850013
028600             END-EXEC                                             02860013
028700             PERFORM 9000-GO-HOME                                 02870013
028800         WHEN PV-RESP2 = 9                                        02880013
028900             MOVE LOW-VALUES TO DP205BI                           02890013
029000             MOVE EM-MESSAGE8 TO BMESSGEO                         02900013
029100             PERFORM 4000-SEND-MAP2                               02910013
029200             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              02920013
029300             END-EXEC                                             02930013
029400             PERFORM 9000-GO-HOME                                 02940013
029500         WHEN PV-RESP2 = 16                                       02950013
029600             MOVE LOW-VALUES TO DP205AI                           02960013
029700             MOVE EM-MESSAGE10 TO AMESSGEO                        02970013
029800             PERFORM 1000-INIT-MAP1                               02980013
029900             PERFORM 2000-SEND-MAP1                               02990013
030000             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              03000013
030100             END-EXEC                                             03010013
030200             PERFORM 9000-GO-HOME                                 03020013
030300         WHEN PV-RESP2 = 17                                       03030013
030400             MOVE LOW-VALUES TO DP205BI                           03040013
030500             MOVE EM-MESSAGE5 TO BMESSGEO                         03050013
030600             PERFORM 4000-SEND-MAP2                               03060013
030700             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              03070013
030800             END-EXEC                                             03080013
030900             PERFORM 9000-GO-HOME                                 03090013
031000         WHEN PV-RESP2 = 19                                       03100013
031100             MOVE LOW-VALUES TO DP205BI                           03110013
031200             MOVE EM-MESSAGE6 TO BMESSGEO                         03120013
031300             PERFORM 4000-SEND-MAP2                               03130013
031400             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              03140013
031500             END-EXEC                                             03150013
031600             PERFORM 9000-GO-HOME                                 03160013
031700     END-EVALUATE.                                                03170013
031800     EXEC CICS LINK                                               03180013
031900               PROGRAM  (DP008-SECURITY-SUBROUTINE)               03190013
032000               COMMAREA (DP008-SECURITY-COMMAREA)                 03200013
032100               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          03210013
032200     END-EXEC                                                     03220013
032300     IF  DP008-CALL-SUCCESSFUL                                    03230013
032400         PERFORM 7000-START-ARCH                                  03240013
032500     ELSE                                                         03250013
032600         NEXT SENTENCE                                            03260013
032700     END-IF.                                                      03270013
032800     EXEC CICS RETURN END-EXEC.                                   03280013
032900 4000-SEND-MAP2.                                                  03290013
033000     MOVE CA-MMDDYY TO BDATEO.                                    03300013
033100     MOVE CA-TIME TO BTIMEO.                                      03310013
033200     MOVE CA-NETNAME TO BNETNAMO.                                 03320013
033300     MOVE CA-APPLID TO BSYSTEMO.                                  03330013
033400     MOVE -1 TO BNEWPW1L.                                         03340013
033500     EXEC CICS                                                    03350013
033600         SEND                                                     03360013
033700             MAP('DP205B')                                        03370013
033800             MAPSET('DPKM205')                                    03380013
033900             ERASE                                                03390013
034000             CURSOR                                               03400013
034100             FORMFEED                                             03410013
034200             WAIT                                                 03420013
034300             RESP(PV-CICS-RESPONSE)                               03430013
034400     END-EXEC.                                                    03440013
034500 4001-SEND-MAP2.                                                  03450013
034600     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    03460013
034700          EXEC CICS RETURN END-EXEC.                              03470013
034800     MOVE 'N' TO CA-FIRST-PASS.                                   03480013
034900     MOVE 'Y' TO CA-RECEIVE-MAP2                                  03490013
035000     EXEC CICS RETURN                                             03500013
035100               TRANSID('Z205')                                    03510013
035200               COMMAREA(CA-COMMON-AREA)                           03520013
035300               LENGTH(PV-COM-LEN)                                 03530013
035400     END-EXEC.                                                    03540013
035500 4010-RECEIVE-MAP2.                                               03550013
035600     MOVE DFHCOMMAREA TO CA-COMMON-AREA.                          03560013
035700     EXEC CICS                                                    03570013
035800         RECEIVE                                                  03580013
035900             MAP('DP205B')                                        03590013
036000             MAPSET('DPKM205')                                    03600013
036100             RESP(PV-CICS-RESPONSE)                               03610013
036200     END-EXEC.                                                    03620013
036300     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        03630013
036400         IF BNEWPW1I = BNEWPW2I                                   03640013
036500             PERFORM 4020-RECEIVE-MAP2-FIELDS                     03650013
036600         ELSE                                                     03660013
036700             MOVE LOW-VALUES TO DP205BI                           03670013
036800             MOVE EM-MESSAGE4 TO BMESSGEO                         03680013
036900             PERFORM 4000-SEND-MAP2 THRU 4001-SEND-MAP2           03690013
037000             MOVE 'N' TO CA-FIRST-PASS                            03700013
037100             EXEC CICS RETURN                                     03710013
037200                  TRANSID('Z205')                                 03720013
037300                  COMMAREA(CA-COMMON-AREA)                        03730013
037400                  LENGTH(PV-COM-LEN)                              03740013
037500             END-EXEC                                             03750013
037600     ELSE                                                         03760013
037700         PERFORM 9000-GO-HOME.                                    03770013
037800 4020-RECEIVE-MAP2-FIELDS.                                        03780013
037900     MOVE CA-USERID TO MF-USERID.                                 03790013
038000     MOVE BNEWPW1I TO MF-NEWPASS1.                                03800013
038100     MOVE BNEWPW2I TO MF-NEWPASS2                                 03810013
038200     EXEC CICS SIGNON                                             03820013
038300         USERID(MF-USERID)                                        03830013
038400         PASSWORD(CA-PASSWORD)                                    03840013
038500         NEWPASSWORD(MF-NEWPASS2)                                 03850013
038600         RESP(PV-RESP)                                            03860013
038700         RESP2(PV-RESP2)                                          03870013
038800     END-EXEC.                                                    03880013
038900     MOVE PV-RESP TO PV-RESP-DISPLAY.                             03890013
039000     MOVE PV-RESP2 TO PV-RESP2-DISPLAY.                           03900013
039100     EXEC CICS ASKTIME END-EXEC.                                  03910013
039200     EVALUATE TRUE                                                03920013
039300         WHEN PV-RESP = DFHRESP(USERIDERR)                        03930013
039400             MOVE LOW-VALUES TO DP205BI                           03940013
039500             MOVE EM-MESSAGE7 TO BMESSGEO                         03950013
039600             PERFORM 4000-SEND-MAP2                               03960013
039700             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              03970013
039800             END-EXEC                                             03980013
039900             PERFORM 9000-GO-HOME                                 03990013
040000         WHEN PV-RESP2 = 1                                        04000013
040100             MOVE LOW-VALUES TO DP205BI                           04010013
040200             MOVE EM-MESSAGE1 TO BMESSGEO                         04020013
040300             PERFORM 4000-SEND-MAP2 THRU 4001-SEND-MAP2           04030013
040400             MOVE 'N' TO CA-FIRST-PASS                            04040013
040500             EXEC CICS RETURN                                     04050013
040600                  TRANSID('Z205')                                 04060013
040700                  COMMAREA(CA-COMMON-AREA)                        04070013
040800                  LENGTH(PV-COM-LEN)                              04080013
040900             END-EXEC                                             04090013
041000         WHEN PV-RESP2 = 2                                        04100013
041100             MOVE LOW-VALUES TO DP205BI                           04110013
041200             MOVE EM-MESSAGE2 TO BMESSGEO                         04120013
041300             PERFORM 4000-SEND-MAP2 THRU 4001-SEND-MAP2           04130013
041400             MOVE 'N' TO CA-FIRST-PASS                            04140013
041500             EXEC CICS RETURN                                     04150013
041600                  TRANSID('Z205')                                 04160013
041700                  COMMAREA(CA-COMMON-AREA)                        04170013
041800                  LENGTH(PV-COM-LEN)                              04180013
041900             END-EXEC                                             04190013
042000         WHEN PV-RESP2 = 3                                        04200013
042100             MOVE LOW-VALUES TO DP205BI                           04210013
042200*            MOVE EM-MESSAGE3 TO BMESSGEO                         04220013
042300             PERFORM 4000-SEND-MAP2 THRU 4001-SEND-MAP2           04230013
042400             MOVE 'N' TO CA-FIRST-PASS                            04240013
042500             MOVE 'Y' TO CA-RECEIVE-MAP2                          04250013
042600             EXEC CICS RETURN                                     04260013
042700                  TRANSID('Z205')                                 04270013
042800                  COMMAREA(CA-COMMON-AREA)                        04280013
042900                  LENGTH(PV-COM-LEN)                              04290013
043000             END-EXEC                                             04300013
043100         WHEN PV-RESP2 = 4                                        04310013
043200             MOVE LOW-VALUES TO DP205BI                           04320013
043300             MOVE EM-MESSAGE4 TO BMESSGEO                         04330013
043400             PERFORM 4000-SEND-MAP2 THRU 4001-SEND-MAP2           04340013
043500             EXEC CICS RETURN                                     04350013
043600                  TRANSID('Z205')                                 04360013
043700                  COMMAREA(CA-COMMON-AREA)                        04370013
043800                  LENGTH(PV-COM-LEN)                              04380013
043900             END-EXEC                                             04390013
044000         WHEN PV-RESP2 = 8                                        04400013
044100             MOVE LOW-VALUES TO DP205BI                           04410013
044200             MOVE EM-MESSAGE7 TO BMESSGEO                         04420013
044300             PERFORM 4000-SEND-MAP2                               04430013
044400             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              04440013
044500             END-EXEC                                             04450013
044600             PERFORM 9000-GO-HOME                                 04460013
044700         WHEN PV-RESP2 = 9                                        04470013
044800             MOVE LOW-VALUES TO DP205BI                           04480013
044900             MOVE EM-MESSAGE8 TO BMESSGEO                         04490013
045000             PERFORM 4000-SEND-MAP2                               04500013
045100             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              04510013
045200             END-EXEC                                             04520013
045300             PERFORM 9000-GO-HOME                                 04530013
045400         WHEN PV-RESP2 = 16                                       04540013
045500             MOVE LOW-VALUES TO DP205AI                           04550013
045600             MOVE EM-MESSAGE10 TO AMESSGEO                        04560013
045700             PERFORM 1000-INIT-MAP1                               04570013
045800             PERFORM 2000-SEND-MAP1                               04580013
045900             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              04590013
046000             END-EXEC                                             04600013
046100             PERFORM 9000-GO-HOME                                 04610013
046200         WHEN PV-RESP2 = 17                                       04620013
046300             MOVE LOW-VALUES TO DP205BI                           04630013
046400             MOVE EM-MESSAGE5 TO BMESSGEO                         04640013
046500             PERFORM 4000-SEND-MAP2                               04650013
046600             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              04660013
046700             END-EXEC                                             04670013
046800             PERFORM 9000-GO-HOME                                 04680013
046900         WHEN PV-RESP2 = 19                                       04690013
047000             MOVE LOW-VALUES TO DP205BI                           04700013
047100             MOVE EM-MESSAGE6 TO BMESSGEO                         04710013
047200             PERFORM 4000-SEND-MAP2                               04720013
047300             EXEC CICS DELAY FOR SECONDS(PV-SECONDS)              04730013
047400             END-EXEC                                             04740013
047500             PERFORM 9000-GO-HOME                                 04750013
047600     END-EVALUATE.                                                04760013
047700     EXEC CICS LINK                                               04770013
047800               PROGRAM  (DP008-SECURITY-SUBROUTINE)               04780013
047900               COMMAREA (DP008-SECURITY-COMMAREA)                 04790013
048000               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          04800013
048100     END-EXEC                                                     04810013
048200     IF  DP008-CALL-SUCCESSFUL                                    04820013
048300         PERFORM 7000-START-ARCH                                  04830013
048400     ELSE                                                         04840013
048500         MOVE LOW-VALUES TO DP205BI                               04850013
048600         MOVE EM-MESSAGE5 TO BMESSGEO                             04860013
048700         PERFORM 4000-SEND-MAP2                                   04870013
048800         EXEC CICS DELAY FOR SECONDS(PV-SECONDS)                  04880013
048900         END-EXEC                                                 04890013
049000         PERFORM 9000-GO-HOME                                     04900013
049100     END-IF.                                                      04910013
049200 7000-START-ARCH.                                                 04920013
049300     EXEC CICS ASSIGN                                             04930013
049400               SYSID(PV-SYSID)                                    04940013
049500     END-EXEC.                                                    04950013
049510     EXEC CICS SET TERMINAL(EIBTRMID) UCTRAN                      04951017
049520     END-EXEC.                                                    04952016
049600     IF PV-SYSID = 'CIP1' OR                                      04960013
049700        PV-SYSID = 'CJP1' OR                                      04970013
049800        PV-SYSID = 'CP12' OR                                      04980013
049900        PV-SYSID = 'CIT1' OR                                      04990013
050000        PV-SYSID = 'CIT2' OR                                      05000013
050100        PV-SYSID = 'CIT3' OR                                      05010013
050200        PV-SYSID = 'CIT4' OR                                      05020013
050300        PV-SYSID = 'CILT' OR                                      05030013
050400        PV-SYSID = 'CIQT' OR                                      05040013
050500        PV-SYSID = 'CQT2' OR                                      05050013
050600        PV-SYSID = 'CJQT' OR                                      05060013
050700        PV-SYSID = 'CIST'                                         05070013
050800     THEN                                                         05080013
050900********                                                          05090013
051000*        EXEC CICS SEND CONTROL ERASE FREEKB                      05100013
051100*        END-EXEC                                                 05110013
051200*        EXEC CICS SEND                                           05120013
051300*                  FROM(EM-MESSAGE9)                              05130013
051400*                  LENGTH(PV-MESSAGE9-LEN)                        05140013
051500*        END-EXEC                                                 05150013
051600********                                                          05160013
051700         EXEC CICS START                                          05170013
051800                   TRANSID('Z028')                                05180013
051900                   TERMID(CA-TERMID)                              05190013
052000         END-EXEC                                                 05200013
052100         EXEC CICS RETURN END-EXEC.                               05210013
052200     IF PV-SYSID = 'CIPS' OR                                      05220013
052300        PV-SYSID = 'CIPA' OR                                      05230013
052400        PV-SYSID = 'CIPB' OR                                      05240013
052500        PV-SYSID = 'CIP2' OR                                      05250013
052600        PV-SYSID = 'CIP4' OR                                      05260013
052700        PV-SYSID = 'CJP4' OR                                      05270013
052800        PV-SYSID = 'CIP5' OR                                      05280013
052900        PV-SYSID = 'CIP6' OR                                      05290013
053000        PV-SYSID = 'CJP6' OR                                      05300013
053100        PV-SYSID = 'CP62' OR                                      05310013
053200        PV-SYSID = 'CIP7' OR                                      05320013
053300        PV-SYSID = 'CIP8' OR                                      05330013
053400        PV-SYSID = 'CIP9' OR                                      05340013
053500        PV-SYSID = 'CILA' OR                                      05350013
053600        PV-SYSID = 'CIQA' OR                                      05360013
053700        PV-SYSID = 'CJQA' OR                                      05370013
053800        PV-SYSID = 'CQA2' OR                                      05380013
053900        PV-SYSID = 'CIP3'                                         05390013
054000     THEN                                                         05400013
054100         EXEC CICS SEND CONTROL ERASE FREEKB                      05410013
054200         END-EXEC                                                 05420013
054300         EXEC CICS RETURN END-EXEC.                               05430013
054400 8000-SEND-AGAIN.                                                 05440013
054500         PERFORM 1000-INIT-MAP1.                                  05450013
054600         MOVE LOW-VALUES TO DP205AI.                              05460013
054700         PERFORM 2000-SEND-MAP1 THRU                              05470013
054800                 2001-SEND-MAP1.                                  05480013
054900 9000-GO-HOME.                                                    05490013
055000     EXEC CICS ISSUE DISCONNECT                                   05500013
055100     END-EXEC.                                                    05510013
055200     EXEC CICS RETURN END-EXEC.                                   05520013
