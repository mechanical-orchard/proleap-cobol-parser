000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    SUKCS596.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER.                                  00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  JULY, 2002.                                       00070001
000800 DATE-COMPILED.                                                   00080001
000900*---------------------------------------------------------------* 00090001
001000*    S596 - OUTBOUND TRAILER  - OUTBOUND PO/RCVR CARTON LIST    * 00100001
001100*---------------------------------------------------------------* 00110001
001200*                                                               * 00120001
001300* CHANGE HISTORY:                                               * 00130001
001400* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00140001
001500* ------- ---------- ----------- -------------------------------- 00150001
001600* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS              * 00160001
001700*         08-10-2010 PRASHANTH   INCORPORATE NECESSARY          * 00170001
001800*                                CHANGES TO ALLOW FORWARDING    * 00180001
001900*                                FROM CENTRAL STOCK PULL BY DC  * 00190001
002000*                                SCREEN (CEKCS621)              * 00200001
002100*                                                               * 00210001
002200* PR5148B 09-04-2013 C. PARMLEY  CHANGE TO COME FROM TMKCS532   * 00220005
002300*                                THE UNRESOLVED TROUBLE SCREEN  * 00230001
002400*                                AFTER F21 IS HIT               * 00240001
002500*                                CHG0061291                     * 00250001
002600* PR5148B 09-06-2013 C. PARMLEY  CHANGE TO INCLUDE MISSING      * 00260003
002700*                                END-IF IN PARA 1100-           * 00270003
002800*                                CHG0062043                     * 00280003
002900*---------------------------------------------------------------* 00290001
002910* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00291015
002920* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00292016
002930* MAKING THE CALL DYNAMIC VS STATIC.                              00293016
002931*                                                                 00293118
002932* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00293218
002933* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00293318
002940*---------------------------------------------------------------* 00294016
003000 ENVIRONMENT DIVISION.                                            00300001
003100 DATA DIVISION.                                                   00310001
003200                                                                  00320001
003300 WORKING-STORAGE SECTION.                                         00330001
003400 01  DK-DB2-KEYS.                                                 00340001
003500     05  DK-PO-TRN-NBR                  PIC 9(09) VALUE ZEROES.   00350001
003600     05  DK-TRN-NBR-N REDEFINES DK-PO-TRN-NBR.                    00360001
003700         10  DK-TRN-NBR-X               PIC X(09).                00370001
003800     05  DK-TRN-NBR-9.                                            00380001
003900         10  FILLER                       PIC X(01) VALUE SPACES. 00390001
004000         10  DK-TRN-NBR-8                 PIC X(08) VALUE SPACES. 00400001
004100                                                                  00410001
004200     05  DK-PO-RCVR-NBR-N                 PIC 9(09) VALUE ZEROES. 00420001
004300     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00430001
004400         10  DK-RCVR-NBR-X                PIC X(09).              00440001
004500     05  DK-RCVR-NBR-9.                                           00450001
004600         10  FILLER                       PIC X(06) VALUE SPACES. 00460001
004700         10  DK-RCVR-NBR-3                PIC X(03) VALUE SPACES. 00470001
004800     05  DK-PO-RCVR.                                              00480001
004900         10  DK-PO                        PIC 9(08) VALUE ZEROES. 00490001
005000         10  FILLER                       PIC X(01) VALUE '-'.    00500001
005100         10  DK-RCVR                      PIC 9(03) VALUE ZEROES. 00510001
005200     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00520001
005300                                                   COMP.          00530001
005400     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00540001
005500                                                   COMP.          00550001
005600     05  DK-PO-NBR                      PIC S9(09) COMP.          00560001
005700     05  DK-PO-NBR-COMP10               PIC S9(10) COMP.          00570001
005800     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP.          00580001
005900     05  DK-LINE-NBR                    PIC S9(09) COMP.          00590001
006000     05  DK-CNSTK-REQ-PL-NBR            PIC S9(09) COMP.          00600001
006100     05  DK-TRIP-ID                     PIC S9(09) COMP.          00610001
006200     05  DK-SML-NBR                     PIC S9(18)V COMP-3.       00620001
006300     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00630001
006400     05  DK-BARCODE                     PIC  X(22) VALUE SPACES.  00640001
006500     05  DK-BARCODE-R REDEFINES DK-BARCODE.                       00650001
006600         10  DK-BARCODE-1-2             PIC  9(02).               00660001
006700         10  DK-BARCODE-3-20            PIC  9(18).               00670001
006800         10  DK-BARCODE-21-22           PIC  X(02).               00680001
006900     05  DK-BARCODE-N                   PIC  9(18) VALUE ZEROES.  00690001
007000     05  DK-CRTN-STAT-DESC.                                       00700001
007100         10  DK-INVALID-DESC            PIC X(7) VALUE 'INVALID'. 00710001
007200         10  DK-INACT-DESC              PIC X(7) VALUE 'INACTIV'. 00720001
007300         10  DK-SC-OF-DESC              PIC X(7) VALUE 'SCD OFF'. 00730001
007400         10  DK-SC-ON-DESC              PIC X(7) VALUE 'SCND ON'. 00740001
007500         10  DK-DVRT-DESC               PIC X(7) VALUE 'DIVERTD'. 00750001
007600         10  DK-ASSUM-DESC              PIC X(7) VALUE 'ASSUMED'. 00760001
007700         10  DK-LOADED-DESC             PIC X(7) VALUE 'LOADED '. 00770001
007800         10  DK-CSEPK-DESC              PIC X(7) VALUE 'CASEPCK'. 00780001
007900         10  DK-CK-IN-DESC              PIC X(7) VALUE 'CHKD-IN'. 00790001
008000         10  DK-P2L-DESC                PIC X(7) VALUE 'P2L    '. 00800001
008100         10  DK-RDM-DESC                PIC X(7) VALUE 'CRD RDM'. 00810001
008200         10  DK-RECV-DESC               PIC X(7) VALUE 'CRD RCV'. 00820001
008300         10  DK-ASN-DESC                PIC X(7) VALUE 'CRD ASN'. 00830001
008400         10  DK-SMTH-DESC               PIC X(7) VALUE 'CRD SMO'. 00840001
008500         10  DK-XFER-DESC               PIC X(7) VALUE 'CRD XFR'. 00850001
008600         10  DK-MSTR-DESC               PIC X(7) VALUE 'CRD MST'. 00860001
008700         10  DK-BLD-DESC                PIC X(7) VALUE 'CRD BLD'. 00870001
008710         10  DK-3WD-DESC                PIC X(7) VALUE 'CRD 3WD'. 00871017
008800         10  DK-ASSUMED                 PIC X(7) VALUE 'ASSUMED'. 00880001
008900     05  DK-DEFAULT-BEGIN               PIC S9(09)  VALUE ZERO    00890001
009000                                                    COMP.         00900001
009100     05  DK-DEFAULT-END-LINE            PIC S9(09)  VALUE 9999999 00910001
009200                                                    COMP.         00920001
009300     05  DK-DEFAULT-END-STR             PIC S9(09)  VALUE 9999    00930001
009400                                                    COMP.         00940001
009500     05  DK-LINE-BEGIN                  PIC S9(09)  VALUE ZERO    00950001
009600                                                    COMP.         00960001
009700     05  DK-LINE-END                    PIC S9(09)  VALUE ZERO    00970001
009800                                                    COMP.         00980001
009900     05  DK-STR-BEGIN                   PIC S9(04)  VALUE ZERO    00990001
010000                                                    COMP.         01000001
010100     05  DK-STR-END                     PIC S9(04)  VALUE ZERO    01010001
010200                                                    COMP.         01020001
010400     05  DK-TRN-TYP-CDE                 PIC  X(02)  VALUE SPACES. 01040001
010500                                                                  01050001
010700     05  DK-DC-BEGIN                    PIC S9(04)  VALUE ZERO    01070001
010800                                                    COMP.         01080001
010900     05  DK-DC-END                      PIC S9(04)  VALUE ZERO    01090001
011000                                                    COMP.         01100001
011200 01  PC-PROGRAM-CONSTANTS.                                        01120001
011300     05  PC-DEFAULT-TMST           PIC  X(26)  VALUE              01130001
011400                                  '9999-09-09-09.09.09.999999'.   01140001
011500     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU596A  '.  01150001
011600     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM596'.   01160001
011700     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS596'.  01170001
011900     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  01190001
012000     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           01200001
012100     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           01210001
012200     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         01220001
012300     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         01230001
012500     05  PC-TRBL-LIST-FORMAT       PIC  X(01)  VALUE '5'.         01250001
012700                                                                  01270016
012800     05  PC-DC-LIST-FORMAT         PIC  X(01)  VALUE '3'.         01280001
012900*EKTA                                                             01290001
013000     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +09          01300001
013100                                               COMP SYNC.         01310001
013200     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           01320001
013300                                               COMP SYNC.         01330001
013400     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     01340001
013500                                               COMP-3.            01350001
013600     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           01360001
013700                                               COMP SYNC.         01370001
013800     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            01380001
013900                                               COMP-3.            01390001
014000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       01400001
014100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       01410001
014200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       01420001
014300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       01430001
014400     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         01440001
014500     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       01450001
014600                                               COMP.              01460001
014700     05  PC-INNER-PREPACK          PIC  X(06)  VALUE 'INPRPK'.    01470001
014800     05  PC-MULTI-SKU              PIC  X(06)  VALUE 'MLTSKU'.    01480001
014900     05  PC-SINGLE-SKU             PIC  X(06)  VALUE 'SGLSKU'.    01490001
015000     05  PC-CASEPACK               PIC  X(06)  VALUE 'CASEPK'.    01500001
015100     05  PC-BULK                   PIC  X(06)  VALUE 'BULK  '.    01510001
015200     05  PC-MANUAL                 PIC  X(07)  VALUE 'MANUAL '.   01520001
015300     05  PC-FCS-P2L                PIC  X(07)  VALUE 'FCS&P2L'.   01530001
015400     05  PC-P2L                    PIC  X(07)  VALUE 'P2L    '.   01540001
015500     05  PC-FCSE                   PIC  X(07)  VALUE 'FCSE   '.   01550001
015600*----------------------------------------------------------------*01560001
015700*  SYSTEM MESSAGES                                               *01570001
015800*----------------------------------------------------------------*01580001
015900*   00005 = INVALID VALUE                                        *01590001
016000*   00008 = MUST BE NUMERIC                                      *01600001
016100*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01610001
016200*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01620001
016300*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01630001
016400*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01640001
016500*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01650001
016600*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01660001
016700*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01670001
016800*   00069 - TOP OF LIST                                          *01680001
016900*   00070 - BOTTOM OF LIST                                       *01690001
017000*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01700001
017100*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01710001
017200*   00279 - MORE ITEMS TO DISPLAY                                *01720001
017300*   00743 - TRIP DOES NOT EXIST                                  *01730001
017400*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS DATA             *01740001
017500*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01750001
017600*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01760001
017700*   02792 = ENDING CUTOFF ALREADY EXISTS FOR TRLR-BEGIN CUTOFF NE*01770001
017800*   02793 = CARTON IS ALREADY LOADED ONTO A TRAILER.             *01780001
017900*   02796 = END CUTOFF ASSIGNMENT SUCCESSFUL.                    *01790001
018000*   02799 = END CARTON DIVERT TIME MUST BE GREATER THAN BEGIN CAR*01800001
018100*   99901 = INVALID COMMAND WAS ENTERED                          *01810001
018200*----------------------------------------------------------------*01820001
018300     05  PC-TSYMSG-NUMBERS.                                       01830001
018400         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01840001
018500         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01850001
018600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01860001
018700         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01870001
018800         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01880001
018900         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01890001
019000         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01900001
019100         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01910001
019200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01920001
019300         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01930001
019400         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01940001
019500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01950001
019600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01960001
019700         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01970001
019800         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01980001
019900         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01990001
020000         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  02000001
020100         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  02010001
020200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  02020001
020300         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  02030001
020400         10  PC-TSYMSG-02792            PIC  9(05)  VALUE 02792.  02040001
020500         10  PC-TSYMSG-02793            PIC  9(05)  VALUE 02793.  02050001
020600         10  PC-TSYMSG-02796            PIC  9(05)  VALUE 02796.  02060001
020700         10  PC-TSYMSG-02799            PIC  9(05)  VALUE 02799.  02070001
020800         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02080001
020900*                                                                 02090001
021000 01  PS-PROGRAM-SWITCHES.                                         02100001
021100     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02110001
021200         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02120001
021300         88  PS-BLOCK-ERROR                         VALUE 'N'.    02130001
021400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02140001
021500         88  PS-NO-ERROR                            VALUE 'Y'.    02150001
021600         88  PS-ERROR                               VALUE 'N'.    02160001
021700     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02170001
021800         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02180001
021900         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02190001
022000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02200001
022100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02210001
022200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02220001
022300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02230001
022400         88  PS-DONE                                VALUE 'Y'.    02240001
022500         88  PS-NOT-DONE                            VALUE 'N'.    02250001
022600     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02260001
022700         88  PS-LIST-END                            VALUE 'Y'.    02270001
022800         88  PS-NO-LIST-END                         VALUE 'N'.    02280001
022900     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    02290001
023000         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    02300001
023100         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    02310001
023200     05  PS-LOAD-STATUS-SW              PIC  9(01)  VALUE 0.      02320001
023300         88  PS-ASSUMED                             VALUE 1.      02330001
023400         88  PS-DIVERTED                            VALUE 2.      02340001
023500     05  PS-VRFD-UNTS-SW                PIC  X(01)  VALUE 'N'.    02350001
023600         88  PS-END-OF-VRFD-UNTS-CSR                VALUE 'Y'.    02360001
023800     05  PS-PS-PULL-CSR-SW              PIC  X(01)  VALUE 'N'.    02380001
023900         88  PS-END-OF-CS-PULL-CSR                  VALUE 'Y'.    02390001
024000                                                                  02400016
024100 01  PV-PROGRAM-VARIABLES.                                        02410001
024200     05  PV-SML                          PIC  X(20).              02420001
024300     05  PV-SML-R   REDEFINES PV-SML.                             02430001
024400         10  PV-SML-1-18                 PIC  9(18).              02440001
024500         10  FILLER                      PIC  X(02).              02450001
024600     05  PV-PO-RCVR-PULL                 PIC  X(12).              02460001
024700     05  PV-PULL-X   REDEFINES PV-PO-RCVR-PULL.                   02470001
024800         10  PV-PULL-DIGITS              PIC  Z(08).              02480001
024900         10  PV-CS-IND                   PIC  X(03).              02490001
025000         10  FILLER                      PIC  X(01).              02500001
025100     05  PV-RACF-ERROR-CODE              PIC  9(04) VALUE ZEROES. 02510001
025200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02520001
025300                                                     COMP SYNC.   02530001
025400     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02540001
025500     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02550001
025600     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02560001
025700                                        COMP SYNC.                02570001
025800     05  PV-SUB                         PIC S9(04)  VALUE +0      02580001
025900                                                    COMP SYNC.    02590001
026000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02600001
026100                                                    COMP SYNC.    02610001
026200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02620001
026300                                                    COMP-3.       02630001
026310     05  PV-STR-SCAN-COUNT              PIC S9(09)  VALUE +0      02631011
026320                                                    COMP-3.       02632011
026400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02640001
026500                                                    COMP-3.       02650001
026600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02660001
026700                                                    COMP-3.       02670001
026800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02680001
026900                                                    COMP-3.       02690001
027000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02700001
027100                                                    COMP-3.       02710001
027200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02720001
027300                                                    COMP-3.       02730001
027400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02740001
027500                                                    COMP-3.       02750001
027600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02760001
027700                                                    COMP SYNC.    02770001
027800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02780001
027900                                                    COMP SYNC.    02790001
028000     05  PV-ITEM                        PIC S9(04)  VALUE +0      02800001
028100                                                    COMP SYNC.    02810001
028200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02820001
028300                                                    COMP SYNC.    02830001
028400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02840001
028500                                                    COMP SYNC.    02850001
028600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02860001
028700                                                    COMP SYNC.    02870001
028800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02880001
028900                                                    COMP SYNC.    02890001
029000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02900001
029100                                                    COMP SYNC.    02910001
029200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02920001
029300                                                    COMP SYNC.    02930001
029400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02940001
029500                                                    COMP SYNC.    02950001
029600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02960001
029700                                                    COMP SYNC.    02970001
029800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02980001
029900                                                    COMP SYNC.    02990001
030000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03000001
030100                                                    COMP SYNC.    03010001
030200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03020001
030300                                                    COMP SYNC.    03030001
030400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03040001
030500                                                    COMP SYNC.    03050001
030600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03060001
030700                                                    COMP SYNC.    03070001
030800     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03080001
030900                                                    COMP.         03090001
031000     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03100001
031100                                                    COMP.         03110001
031200     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03120001
031300                                                    COMP.         03130001
031400     05  PV-SOFT-ABORT-MSG.                                       03140001
031500         10  FILLER            PIC X(12) VALUE ' SUKCS596 - '.    03150001
031600         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03160001
031700         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    03170001
031800         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03180001
031900         10  PV-SOFT-PARAGRAPH PIC X(30).                         03190001
032000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03200001
032100                                                     COMP SYNC.   03210001
032200     05  PV-CICS-MSG-AREA.                                        03220001
032300         10  FILLER                      PIC X(05) VALUE 'TASK='. 03230001
032400         10  PV-CICS-TASK                PIC ZZZZ9.               03240001
032500         10  FILLER                      PIC X(01) VALUE SPACES.  03250001
032600         10  PV-CICS-MSG                 PIC X(68) VALUE SPACES.  03260001
032700                                                                  03270001
032800     05  PV-TMST                 PIC X(26)   VALUE SPACES.        03280001
032900     05  PV-TMST-R REDEFINES  PV-TMST.                            03290001
033000         10   PV-TMST-DATE.                                       03300001
033100             15   PV-TMST-CCYY          PIC X(04).                03310001
033200             15   FILLER                PIC X(01).                03320001
033300             15   PV-TMST-MM            PIC X(02).                03330001
033400             15   FILLER                PIC X(01).                03340001
033500             15   PV-TMST-DD            PIC X(02).                03350001
033600         10   FILLER                    PIC X(01).                03360001
033700         10   PV-TMST-TIME.                                       03370001
033800             15   PV-TMST-HRS           PIC X(02).                03380001
033900             15   FILLER                PIC X(01).                03390001
034000             15   PV-TMST-MIN           PIC X(02).                03400001
034100         10   FILLER                    PIC X(01).                03410001
034200         10   PV-TMST-SEC               PIC X(02).                03420001
034300         10   FILLER                    PIC X(07).                03430001
034400     05  PV-DATE-DISPLAY.                                         03440001
034500         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 03450001
034600         10   PV-SLASH-1                PIC X(01)   VALUE '-'.    03460001
034700         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 03470001
034800         10   PV-SLASH-2                PIC X(01)   VALUE '-'.    03480001
034900         10   PV-DISPLAY-YY             PIC X(02)   VALUE SPACES. 03490001
035000     05  PV-TIME-DISPLAY.                                         03500001
035100         10   PV-AT                     PIC X(03)   VALUE SPACES. 03510001
035200         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 03520001
035300         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 03530001
035400         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 03540001
035500         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 03550001
035600         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 03560001
035700     05  PV-DATE-TIME.                                            03570001
035800         10   PV-DT-CC             PIC X(02)  VALUE '20'.         03580001
035900         10   PV-DT-YY             PIC X(02)  VALUE ZEROES.       03590001
036000         10   FILLER               PIC X(01)  VALUE '-'.          03600001
036100         10   PV-DT-MM             PIC X(02)  VALUE ZEROES.       03610001
036200         10   FILLER               PIC X(01)  VALUE '-'.          03620001
036300         10   PV-DT-DD             PIC X(02)  VALUE ZEROES.       03630001
036400         10   FILLER               PIC X(01)  VALUE '-'.          03640001
036500         10   PV-DT-HRS            PIC X(02)   VALUE SPACES.      03650001
036600         10   FILLER               PIC X(01)   VALUE '.'.         03660001
036700         10   PV-DT-MIN            PIC X(02)   VALUE SPACES.      03670001
036800         10   FILLER               PIC X(01)   VALUE '.'.         03680001
036900         10   PV-DT-SEC            PIC X(09)   VALUE '59.999999'. 03690001
037000     05  PV-USA-DATE               PIC  X(10) VALUE SPACES.       03700001
037100     05  PV-JIS-TIME               PIC  X(05) VALUE SPACES.       03710001
037200     05  PV-SELECT-LIST-SEQ        PIC  X(01) VALUE SPACES.       03720001
037300     05  PV-NBR-ITEMS              PIC  9(05) VALUE ZEROES.       03730001
037400     05  PV-SEL-TERM-ID            PIC  X(04).                    03740001
037500     05  PV-SEL-TASK-NUMBER        PIC  9(05).                    03750001
037600     05  PV-SEL-SEQ                PIC  9(01).                    03760001
037800     05  PV-SHPD-QTY               PIC S9(9) COMP-3 VALUE ZEROES. 03780001
037900     05  PV-PULL-NBR-N             PIC Z(08) VALUE ZEROES.        03790001
038000     05  PV-PULL-NBR-CHAR          REDEFINES PV-PULL-NBR-N.       03800001
038100         10  PV-PULL-NBR-X         PIC X(08).                     03810001
038200     05  PV-PULL-NBR.                                             03820001
038300         10  PV-PULL               PIC  X(08).                    03830001
038400         10  PV-TRAN               PIC  X(03).                    03840001
038500     05  PV-PL-REQ-QTY             PIC  S9(9) COMP VALUE ZEROES.  03850001
038600                                                                  03860001
039000     05  PV-FX-UNIT-QTY            PIC S9(9) COMP-3 VALUE ZEROES. 03900001
039100     05  PV-FX-FAST-TRAN-N         PIC Z(10) VALUE ZEROES.        03910001
039200     05  PV-FX-FAST-TRAN-CHAR      REDEFINES PV-FX-FAST-TRAN-N.   03920001
039300         10  PV-FX-FAST-TRAN-X     PIC X(10).                     03930001
039400     05  PV-FX-FAST-TRANSFER.                                     03940001
039500         10  PV-FX-STORE           PIC  9(04).                    03950001
039600         10  PV-FX-FAST-NO         PIC  9(06).                    03960001
039700     05  PV-FX-FAST-EDIT.                                         03970001
039800         10  PV-FX-STORE-EDIT      PIC  9(04).                    03980001
039900         10  PV-FX-DASH            PIC  X(01).                    03990001
040000         10  PV-FX-FAST-NO-EDIT    PIC  9(06).                    04000001
040100                                                                  04010001
040200* DMH 11-16-11 - END                                              04020001
040300                                                                  04030001
040400******************************************************************04040001
040500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **04050001
040600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **04060001
040700**  APPLICATION-SPECIFIC COMMAREA.                              **04070001
040800******************************************************************04080001
040900 01  LQW-LIST-QUEUE-WORK-AREA.                                    04090001
041000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04100001
041100     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           04110001
041200                                        INDEXED BY LQW-IDX.       04120001
041300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04130001
041400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04140001
041500         10  LQW-SELECTED-SW            PIC  X(01).               04150001
041600             88  LQW-SELECT                         VALUE 'S'.    04160001
041700             88  LQW-DESELECT                       VALUE ' '.    04170001
041800         10  LQW-ACTION                 PIC  X(03).               04180001
041900             88  LQW-DEL                            VALUE 'DEL'.  04190001
042000             88  LQW-INQ                            VALUE 'INQ'.  04200001
042100             88  LQW-UPD                            VALUE 'UPD'.  04210001
042200             88  LQW-ERR                            VALUE 'ERR'.  04220001
042300         10  LQW-SML                    PIC  X(20).               04230001
042400         10  LQW-MASTER                 PIC  X(01).               04240001
042500         10  LQW-DEST-NBR               PIC  9(04).               04250001
042600         10  LQW-CREATE                 PIC  X(03).               04260001
042610         10  LQW-STR-SCAN               PIC  X(04).               04261007
042700         10  LQW-STAT-DATE              PIC  X(08).               04270001
042800         10  LQW-STAT-TIME              PIC  X(05).               04280001
042900         10  LQW-UNITS-MANIFST          PIC  9(06).               04290001
043000         10  LQW-LOAD-STATUS            PIC  X(07).               04300001
043100         10  LQW-TRIP-ID                PIC  X(09).               04310001
043200         10  LQW-DOOR-TYP-CDE           PIC  X(02).               04320001
043210         10  LQW-MULT-SCAN-SW           PIC  X(01).               04321011
043300                                                                  04330001
043400*---------------------------------------------------------------* 04340001
043500* SELECTON QUEUE LAYOUT                                         * 04350001
043600*---------------------------------------------------------------* 04360001
043700     COPY SUWS010.                                                04370001
043800                                                                  04380001
043900******************************************************************04390001
044000* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    04400012
044100******************************************************************04410001
044200     COPY PCWS046.                                                04420001
044300                                                                  04430001
044400*---------------------------------------------------------------* 04440001
044500*    MAP LAYOUT                                                 * 04450001
044600*---------------------------------------------------------------* 04460001
044700     COPY SUKM596.                                                04470001
044800*                                                                 04480001
044900 01  MR-OCCURS-LAYOUT                   REDEFINES  SU596AO.       04490001
045000     05  FILLER                         PIC X(224).               04500001
045100     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          04510001
045200         10  MR-SELECTL                 PIC S9(04) COMP.          04520001
045300         10  MR-SELECTA                 PIC  X(01).               04530001
045400         10  MR-SELECTC                 PIC  X(01).               04540001
045500         10  MR-SELECTH                 PIC  X(01).               04550001
045600         10  MR-SELECTI                 PIC  X(01).               04560001
045700                                                                  04570001
045800         10  MR-ACTIONL                 PIC S9(04) COMP.          04580001
045900         10  MR-ACTIONA                 PIC  X(01).               04590001
046000         10  MR-ACTIONC                 PIC  X(01).               04600001
046100         10  MR-ACTIONH                 PIC  X(01).               04610001
046200         10  MR-ACTION                  PIC  X(01).               04620006
046300                                                                  04630001
046400         10  MR-SMLL                    PIC S9(04) COMP.          04640001
046500         10  MR-SMLA                    PIC  X(01).               04650001
046600         10  MR-SMLC                    PIC  X(01).               04660001
046700         10  MR-SMLH                    PIC  X(01).               04670001
046800         10  MR-SML                     PIC  X(20).               04680001
046900                                                                  04690001
047000         10  MR-MASTERL                 PIC S9(04) COMP.          04700001
047100         10  MR-MASTERA                 PIC  X(01).               04710001
047200         10  MR-MASTERC                 PIC  X(01).               04720001
047300         10  MR-MASTERH                 PIC  X(01).               04730001
047400         10  MR-MASTER                  PIC  X(01).               04740001
047500                                                                  04750001
047600         10  MR-DEST-NBRL               PIC S9(04) COMP.          04760001
047700         10  MR-DEST-NBRA               PIC  X(01).               04770001
047800         10  MR-DEST-NBRC               PIC  X(01).               04780001
047900         10  MR-DEST-NBRH               PIC  X(01).               04790001
048000         10  MR-DEST-NBR                PIC  Z(04).               04800001
048100                                                                  04810001
048200         10  MR-CREATEL                 PIC S9(04) COMP.          04820001
048300         10  MR-CREATEA                 PIC  X(01).               04830001
048400         10  MR-CREATEC                 PIC  X(01).               04840001
048500         10  MR-CREATEH                 PIC  X(01).               04850001
048600         10  MR-CREATE                  PIC  X(03).               04860001
048710         10  MR-STR-SCANL                 PIC S9(04) COMP.        04871007
048720         10  MR-STR-SCANA               PIC  X(01).               04872007
048730         10  MR-STR-SCANC               PIC  X(01).               04873007
048740         10  MR-STR-SCANH               PIC  X(01).               04874007
048750         10  MR-STR-SCAN                PIC  X(04).               04875007
048800         10  MR-STAT-DATEL              PIC S9(04) COMP.          04880001
048900         10  MR-STAT-DATEA              PIC  X(01).               04890001
049000         10  MR-STAT-DATEC              PIC  X(01).               04900001
049100         10  MR-STAT-DATEH              PIC  X(01).               04910001
049200         10  MR-STAT-DATE               PIC  X(05).               04920006
049300                                                                  04930001
049400         10  MR-STAT-TIMEL              PIC S9(04) COMP.          04940001
049500         10  MR-STAT-TIMEA              PIC  X(01).               04950001
049600         10  MR-STAT-TIMEC              PIC  X(01).               04960001
049700         10  MR-STAT-TIMEH              PIC  X(01).               04970001
049800         10  MR-STAT-TIME               PIC  X(05).               04980001
049900                                                                  04990001
050000         10  MR-UNTS-MNFSTDL            PIC S9(04) COMP.          05000001
050100         10  MR-UNTS-MNFSTDA            PIC  X(01).               05010001
050200         10  MR-UNTS-MNFSTDC            PIC  X(01).               05020001
050300         10  MR-UNTS-MNFSTDH            PIC  X(01).               05030001
050400         10  MR-UNTS-MNFSTD-X           PIC  X(06).               05040001
050500         10  MR-UNTS-MNFSTD-N REDEFINES MR-UNTS-MNFSTD-X.         05050001
050600             15  MR-UNTS-MNFSTD         PIC  ZZZZZ9.              05060001
050700                                                                  05070001
050800         10  MR-LOAD-STATUSL            PIC S9(04) COMP.          05080001
050900         10  MR-LOAD-STATUSA            PIC  X(01).               05090001
051000         10  MR-LOAD-STATUSC            PIC  X(01).               05100001
051100         10  MR-LOAD-STATUSH            PIC  X(01).               05110001
051200         10  MR-LOAD-STATUS             PIC  X(07).               05120001
051300                                                                  05130001
051400         10  MR-TRIP-IDL                PIC S9(04) COMP.          05140001
051500         10  MR-TRIP-IDA                PIC  X(01).               05150001
051600         10  MR-TRIP-IDC                PIC  X(01).               05160001
051700         10  MR-TRIP-IDH                PIC  X(01).               05170001
051800         10  MR-TRIP-ID                 PIC  X(09).               05180001
051900                                                                  05190001
052000     05  FILLER                         PIC  X(12).               05200001
052100                                                                  05210001
052200*---------------------------------------------------------------* 05220001
052300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05230001
052400*---------------------------------------------------------------* 05240001
052500     COPY DPWS015.                                                05250001
052600                                                                  05260001
052700*---------------------------------------------------------------* 05270001
052800*    FUNCTION KEYS COPYBOOK.                                    * 05280001
052900*---------------------------------------------------------------* 05290001
053000     COPY DPWS016.                                                05300001
053100                                                                  05310001
053200*---------------------------------------------------------------* 05320001
053300*    NUMERIC EDIT LAYOUT.                                       * 05330001
053400*---------------------------------------------------------------* 05340001
053500     COPY DPWS010I.                                               05350001
053600                                                                  05360001
053700*---------------------------------------------------------------* 05370001
053800*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 05380018
053900*---------------------------------------------------------------* 05390001
054000     COPY DPWS030.                                                05400001
054010     COPY DPWS930.                                                05401018
054100                                                                  05410001
054200***************************************************************** 05420001
054300*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 05430001
054400*             LOCATION MODULE (XLKUT071)                        * 05440001
054500***************************************************************** 05450001
054600     COPY XLWS071.                                                05460001
054700                                                                  05470001
054800*---------------------------------------------------------------* 05480001
054900*    STANDARD COMMAREA.                                         * 05490001
055000*---------------------------------------------------------------* 05500001
055100     COPY DPWS020.                                                05510001
055200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05520001
055300                                                                  05530001
055400*---------------------------------------------------------------* 05540001
055500* INTER-APPLICATION COMMAREA.                                   * 05550001
055600*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05560001
055700*             SPEC SCREEN.                                      * 05570001
055800*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05580001
055900*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05590001
056000*---------------------------------------------------------------* 05600001
056100                                                                  05610001
056200         10  INTER-APPL-COMM-AREA       PIC X(200).               05620001
056300     COPY SUWS008.                                                05630001
056400     COPY SUWS009.                                                05640001
056500*---------------------------------------------------------------* 05650001
056600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05660001
056700*---------------------------------------------------------------* 05670001
056800         10  ASC-SPECIFIC-COMMAREA.                               05680001
056900             15  ASC-OPER-UNT-ID             PIC  X(04).          05690001
057000             15  ASC-OPER-UNT-ID-N REDEFINES                      05700001
057100                     ASC-OPER-UNT-ID         PIC  9(04).          05710001
057200             15  ASC-OPER-NAME               PIC  X(25).          05720001
057300             15  ASC-PACKAGE                 PIC  X(07).          05730001
057400             15  ASC-OUTBOUND-TRIP-ID        PIC  X(09).          05740001
057500             15  ASC-STR-NBR-X               PIC  X(04).          05750001
057600             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           05760001
057700                 20  ASC-STR-NBR             PIC  9(04).          05770001
057800             15  ASC-STATUS-DATE             PIC  X(08).          05780001
057900             15  ASC-STATUS-TIME             PIC  X(05).          05790001
058000             15  ASC-SML-NBR                 PIC  X(20).          05800001
058100             15  ASC-CREATE-ID               PIC  X(03).          05810001
058200             15  ASC-PO-RCVR                 PIC  X(12).          05820001
058300             15  ASC-LINE-NBR                PIC  9(04).          05830001
058400             15  ASC-LINE-STAT               PIC  X(02).          05840001
058500             15  ASC-TOT-CRTNS               PIC  Z(06).          05850001
058600             15  ASC-UNTS-VRFD               PIC  9(06).          05860001
058700             15  ASC-UNTS-MNFD               PIC  9(06).          05870001
058800             15  ASC-UNTS-VARI               PIC S9(06).          05880001
058900             15  ASC-PRTR                    PIC  X(06).          05890001
059000             15  ASC-TRIPID                  PIC  9(09).          05900001
059100             15  ASC-PO-NBR                  PIC  9(09).          05910001
059200             15  ASC-PO-NBR-10               PIC  9(10).          05920001
059300             15  ASC-RCVR-NBR                PIC  9(09).          05930001
059400             15  ASC-STATUS-CDE              PIC  XX.             05940001
059500             15  ASC-PACK-BY-ST-IND          PIC  X.              05950001
059600             15  ASC-CURR-OPER-UNT-ID        PIC  S9(4) COMP.     05960001
059700             15  ASC-PKGNG-CDE               PIC  X.              05970001
059800             15  ASC-DSPLY-PKGNG-CD          PIC  X(01).          05980001
059900                 88  ASC-DSP-INNER-PREPK                VALUE 'I'.05990001
060000                 88  ASC-DSP-MULTI-SKU-PREPK            VALUE 'M'.06000001
060100                 88  ASC-DSP-SINGLE-SKU-PREPK           VALUE 'S'.06010001
060200                 88  ASC-DSP-CASEPACK                   VALUE 'C'.06020001
060300                 88  ASC-DSP-BULK-PACK                  VALUE 'B'.06030001
060400             15  ASC-SEQUENCE-SW             PIC  X(01).          06040001
060500                 88  ASC-ALL-CRTNS              VALUE 'A'.        06050001
060600                 88  ASC-LOADED-CRTNS           VALUE 'L'.        06060001
060700                 88  ASC-NOT-LOADED-CRTNS       VALUE 'N'.        06070001
060800             15  FILLER                      PIC  X(015).         06080001
060900*-----------------------------------------------------------------06090001
061000             15  ASC-BLK-SUB                  PIC S9(04) COMP     06100001
061100                                                         SYNC.    06110001
061200             15  ASC-ITEM-SUB                 PIC S9(04) COMP     06120001
061300                                                         SYNC.    06130001
061400             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  06140001
061500             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  06150001
061600             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  06160001
061700             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  06170001
061800             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  06180001
061900             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     06190001
062000                                                         SYNC.    06200001
062100             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  06210001
062200             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  06220001
062300             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         06230001
062400                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06240001
062500                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06250001
062600             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         06260001
062700                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     06270001
062800                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     06280001
062900             15  ASC-LIST-QUEUE-NAME.                             06290001
063000                 20  ASC-LIST-TERM-ID         PIC  X(04).         06300001
063100                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  06310001
063200                 20  ASC-LIST-SEQ             PIC  9(01).         06320001
063400             15  ASC-CS-PULL-SW               PIC  X(01).         06340001
063500                 88  ASC-CS-PULL-TRAN              VALUE 'Y'.     06350001
063600                 88  ASC-NOT-CS-PULL-TRAN          VALUE 'N'.     06360001
063700             15  ASC-FROM-CS-LIST-SW          PIC  X(01).         06370001
063800                 88  ASC-FROM-CS-LIST              VALUE 'Y'.     06380001
063900                 88  ASC-NOT-FROM-CS-LIST          VALUE 'N'.     06390001
064000                                                                  06400001
064200             15  ASC-FX-FAST-TRAN-SW          PIC  X(01).         06420001
064300                 88  ASC-FX-FAST-TRAN              VALUE 'Y'.     06430001
064400                 88  ASC-NOT-FX-FAST-TRAN          VALUE 'N'.     06440001
064500             15  ASC-FROM-FX-LIST-SW          PIC  X(01).         06450001
064600                 88  ASC-FROM-FX-LIST              VALUE 'Y'.     06460001
064700                 88  ASC-NOT-FROM-FX-LIST          VALUE 'N'.     06470001
064900                                                                  06490001
065000             15  ASC-START-ITEM-REQUEST.                          06500001
065100                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06510001
065200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06520001
065300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06530001
065400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06540001
065500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06550001
065600             15  ASC-SEL-QUEUE-NAME-OUT.                          06560001
065700                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         06570001
065800                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  06580001
065900                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         06590001
066000             15  ASC-SEL-QUEUE-NAME-IN.                           06600001
066100                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         06610001
066200                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  06620001
066300                 20  ASC-SEL-SEQ-IN           PIC  9(01).         06630001
066400             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06640001
066500                                                                  06650001
066600*-----------------------------------------------------------------06660001
066700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06670001
066800                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06680001
066900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06690001
067000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06700001
067100                                                                  06710001
067200                 20  ASC-ITEM-ARRAY.                              06720001
067300                     25  ASC-ITEM-ENTRIES OCCURS 09 TIMES.        06730001
067400                         30  ASC-LIST-ITEM-NUMBER                 06740001
067500                                                     PIC S9(09)   06750001
067600                                                     COMP-3.      06760001
067700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06770001
067800                             88  ASC-VALID-SELECT    VALUE ' '    06780001
067900                                                           'S'    06790001
068000                                                           'B'    06800001
068100                                                           'E'.   06810001
068200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06820001
068300                             88  ASC-TEMP-SELECT     VALUE 'S'.   06830001
068400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06840001
068500                             88  ASC-TEMP-END        VALUE 'E'.   06850001
068600                         30  ASC-SELECTED-SW         PIC  X(01).  06860001
068700                             88  ASC-NO-SELECT       VALUE ' '.   06870001
068800                             88  ASC-SELECT          VALUE 'S'.   06880001
068900                             88  ASC-BEGIN           VALUE 'B'.   06890001
069000                             88  ASC-END             VALUE 'E'.   06900001
069100                         30  ASC-ACTION               PIC  X(03). 06910001
069200                         30  ASC-SML                  PIC  X(20). 06920001
069300                         30  ASC-MASTER               PIC  X(01). 06930001
069400                         30  ASC-DEST-NBR             PIC  9(04). 06940001
069500                         30  ASC-CREATE               PIC  X(03). 06950001
069510                         30  ASC-STORE-SCAN           PIC  X(04). 06951008
069600                         30  ASC-STAT-DATE            PIC  X(08). 06960001
069700                         30  ASC-STAT-TIME            PIC  X(05). 06970001
069800                         30  ASC-UNTS-MNFSTD          PIC  9(06). 06980001
069900                         30  ASC-LOAD-STATUS          PIC  X(07). 06990001
070000                         30  ASC-TRIP-ID              PIC  X(09). 07000001
070100                         30  ASC-TRIP-ID-X REDEFINES ASC-TRIP-ID. 07010001
070200                             35  ASC-TRIP-ID-N        PIC  Z(09). 07020001
070300                         30  ASC-DOOR-TYP-CDE         PIC  X(02). 07030001
070310                         30  ASC-MULT-SCAN-SW         PIC  X(01). 07031011
070320                             88  ASC-MULT-SCAN   VALUE 'M'.       07032011
070400                                                                  07040001
070600             15  ASC-DC-ID                   PIC S9(4)  COMP.     07060001
070800*---------------------------------------------------------------* 07080001
070900*    ABEND PROCESSING COPYBOOK.                                 * 07090001
071000*---------------------------------------------------------------* 07100001
071100     COPY DPWS013.                                                07110001
071200                                                                  07120001
071300*---------------------------------------------------------------* 07130001
071400*    SUT_OTBND_CART OUTBOUND CARTON TABLE                         07140001
071500*---------------------------------------------------------------* 07150001
071600     EXEC SQL                                                     07160001
071700          INCLUDE SUT00024                                        07170001
071800     END-EXEC.                                                    07180001
071900                                                                  07190001
072000*---------------------------------------------------------------* 07200001
072100*    SUT_OTBND_UPC UPC TABLE                                      07210001
072200*---------------------------------------------------------------* 07220001
072300     EXEC SQL                                                     07230001
072400          INCLUDE SUT00028                                        07240001
072500     END-EXEC.                                                    07250001
072600                                                                  07260001
072700*---------------------------------------------------------------* 07270001
072800*    SUT_OTBND_VND                                                07280001
072900*---------------------------------------------------------------* 07290001
073000     EXEC SQL                                                     07300001
073100          INCLUDE SUT00026                                        07310001
073200     END-EXEC.                                                    07320001
073300                                                                  07330001
073400*---------------------------------------------------------------* 07340001
073500*    TPKSLIP                                                      07350001
073600*---------------------------------------------------------------* 07360001
073700     EXEC SQL                                                     07370001
073800          INCLUDE TPKSLIP                                         07380001
073900     END-EXEC.                                                    07390001
074000                                                                  07400001
074100*---------------------------------------------------------------* 07410001
074200*    TRECEIV                                                      07420001
074300*---------------------------------------------------------------* 07430001
074400     EXEC SQL                                                     07440001
074500          INCLUDE TRECEIV                                         07450001
074600     END-EXEC.                                                    07460001
074700                                                                  07470001
074800*---------------------------------------------------------------* 07480001
074900*    TRECITM                                                      07490001
075000*---------------------------------------------------------------* 07500001
075100     EXEC SQL                                                     07510001
075200          INCLUDE TRECITM                                         07520001
075300     END-EXEC.                                                    07530001
075400                                                                  07540001
075500*---------------------------------------------------------------* 07550001
075600*    TRECDIS                                                      07560001
075700*---------------------------------------------------------------* 07570001
075800     EXEC SQL                                                     07580001
075900          INCLUDE TRECDIS                                         07590001
076000     END-EXEC.                                                    07600001
076100                                                                  07610001
076200*---------------------------------------------------------------* 07620001
076300*    TSUCRDV - CARTON DIVERT TABLE                                07630001
076400*---------------------------------------------------------------* 07640001
076500     EXEC SQL                                                     07650001
076600          INCLUDE TSUCRDV                                         07660001
076700     END-EXEC.                                                    07670001
076800                                                                  07680001
076900*---------------------------------------------------------------* 07690001
077000*    TCNDCDR - DC DOOR TABLE                                      07700001
077100*---------------------------------------------------------------* 07710001
077200     EXEC SQL                                                     07720001
077300          INCLUDE TCNDCDR                                         07730001
077400     END-EXEC.                                                    07740001
077500                                                                  07750001
077600*---------------------------------------------------------------* 07760001
077700*    TSUOBTR - OUTBOUND TRIP TABLE                                07770001
077800*---------------------------------------------------------------* 07780001
077900     EXEC SQL                                                     07790001
078000          INCLUDE TSUOBTR                                         07800001
078100     END-EXEC.                                                    07810001
078200                                                                  07820001
078300*---------------------------------------------------------------* 07830001
078400*    TSUOBTS - OUTBOUND TRIP STATUS TABLE                         07840001
078500*---------------------------------------------------------------* 07850001
078600     EXEC SQL                                                     07860001
078700          INCLUDE TSUOBTS                                         07870001
078800     END-EXEC.                                                    07880001
078900                                                                  07890001
079100*---------------------------------------------------------------* 07910001
079200*    TCEPLRQ - CENTRAL STOCK PULL REQUEST TABLE                   07920001
079300*---------------------------------------------------------------* 07930001
079400     EXEC SQL                                                     07940001
079500          INCLUDE TCEPLRQ                                         07950001
079600     END-EXEC.                                                    07960001
079700                                                                  07970001
079800*---------------------------------------------------------------* 07980001
079900*    TCEPLIT - CENTRAL STOCK PULL ITEM TABLE                      07990001
080000*---------------------------------------------------------------* 08000001
080100     EXEC SQL                                                     08010001
080200          INCLUDE TCEPLIT                                         08020001
080300     END-EXEC.                                                    08030001
080400                                                                  08040001
080500*---------------------------------------------------------------* 08050001
080600*    TCEPLDS - CENTRAL STOCK STORE TABLE                          08060001
080700*---------------------------------------------------------------* 08070001
080800     EXEC SQL                                                     08080001
080900          INCLUDE TCEPLDS                                         08090001
081000     END-EXEC.                                                    08100001
081100                                                                  08110001
081200*---------------------------------------------------------------* 08120001
081300*    XLT_SKU - SKU TABLE                                          08130001
081400*---------------------------------------------------------------* 08140001
081500     EXEC SQL                                                     08150001
081600          INCLUDE XLT00003                                        08160001
081700     END-EXEC.                                                    08170001
081800                                                                  08180001
081900*---------------------------------------------------------------* 08190001
082000*    XLT_UPC - UPC TABLE                                          08200001
082100*---------------------------------------------------------------* 08210001
082200     EXEC SQL                                                     08220001
082300          INCLUDE XLT00006                                        08230001
082400     END-EXEC.                                                    08240001
082600                                                                  08260001
082700*---------------------------------------------------------------* 08270001
082800*    TSUCDOT - OUTBOUND TRIP/CARTON DIVERT ASSOCIATION TABLE      08280001
082900*---------------------------------------------------------------* 08290001
083000     EXEC SQL                                                     08300001
083100          INCLUDE TSUCDOT                                         08310001
083200     END-EXEC.                                                    08320001
083300                                                                  08330001
083400*---------------------------------------------------------------* 08340001
083500*    DB2 AREA FOR XLT_LOC TABLE                                 * 08350001
083600*---------------------------------------------------------------* 08360001
083700     EXEC SQL                                                     08370001
083800          INCLUDE XLT00010                                        08380001
083900     END-EXEC.                                                    08390001
084000                                                                  08400016
084100*---------------------------------------------------------------* 08410001
084200*    DB2 AREA FOR XLT_DC_LOC_ASGMT TABLE                        * 08420001
084300*---------------------------------------------------------------* 08430001
084400     EXEC SQL                                                     08440001
084500          INCLUDE XLT00014                                        08450001
084600     END-EXEC.                                                    08460001
084700                                                                  08470017
084710*---------------------------------------------------------------* 08471007
084720*    SUT_OTBND_STR_SCN                                          * 08472007
084730*---------------------------------------------------------------* 08473007
084740     EXEC SQL                                                     08474007
084750          INCLUDE SUT00121                                        08475007
084760     END-EXEC.                                                    08476007
084770                                                                  08477007
084800*---------------------------------------------------------------* 08480001
084900*    DB2 AREA FOR COMMUNICATIONS                                * 08490001
085000*---------------------------------------------------------------* 08500001
085100     EXEC SQL                                                     08510001
085200          INCLUDE SQLCA                                           08520001
085300     END-EXEC.                                                    08530001
085400                                                                  08540001
085500*---------------------------------------------------------------* 08550001
085600*  CURSOR TO RETRIEVE CARTONS BY PO, RECEIVER, LINE               08560001
085700*---------------------------------------------------------------* 08570001
085800     EXEC SQL                                                     08580001
085900          DECLARE CARTON-CSR CURSOR FOR                           08590001
086000        SELECT  DISTINCT (A.SHIPT_UNT_ID)                         08600001
086100             ,  B.PRNT_CART_ID                                    08610001
086200             ,  B.MSTR_CART_IND                                   08620001
086300          FROM  SUT_OTBND_UPC A                                   08630001
086400               ,SUT_OTBND_CART B                                  08640001
086500         WHERE  A.TRN_NBR           = :DK-PO-NBR                  08650001
086600           AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR             08660001
086700           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              08670001
086800           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                08680001
086900           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08690001
087000           AND  B.ACTV_IND          = 'Y'                         08700001
087100           AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN               08710001
087200           AND  B.DEST_LOC_NBR     <= :DK-STR-END                 08720001
087400           AND  B.ORGN_LOC_NBR     >= :DK-DC-BEGIN                08740001
087500           AND  B.ORGN_LOC_NBR     <= :DK-DC-END                  08750001
087700       UNION ALL                                                  08770001
087800          SELECT  DISTINCT (A.SHIPT_UNT_ID)                       08780001
087900               ,  B.PRNT_CART_ID                                  08790001
088000               ,  B.MSTR_CART_IND                                 08800001
088100            FROM  SUT_OTBND_UPC A                                 08810001
088200                 ,SUT_OTBND_CART B                                08820001
088300                 ,SUT_OTBND_VND C                                 08830001
088400                 ,TPKSLIP  D                                      08840001
088500         WHERE  A.TRN_NBR           = :DK-PO-NBR                  08850001
088600           AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN              08860001
088700           AND  A.TRN_LNE_NBR      <= :DK-LINE-END                08870001
088800           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              08880001
088900           AND  B.ACTV_IND          = 'Y'                         08890001
089000           AND  B.CART_TYP_CDE NOT LIKE 'P'                       08900001
089100           AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN               08910001
089200           AND  B.DEST_LOC_NBR     <= :DK-STR-END                 08920001
089400           AND  B.ORGN_LOC_NBR     >= :DK-DC-BEGIN                08940001
089500           AND  B.ORGN_LOC_NBR     <= :DK-DC-END                  08950001
089700           AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              08970001
089800           AND  A.TRN_NBR           = C.PO_NBR                    08980001
089900           AND  C.PO_NBR            = D.PO_NBR                    08990001
090000           AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR                   09000001
090100           AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR             09010001
090200           AND  D.VER_STAT_CDE      = 'A'                         09020001
090300     END-EXEC.                                                    09030001
090400                                                                  09040001
090500*---------------------------------------------------------------* 09050001
090600*  CURSOR TO COUNT MANIFESTED UNITS BY PO/RCVR/LINE/STORE         09060001
090700*---------------------------------------------------------------* 09070001
090800     EXEC SQL                                                     09080001
090900          DECLARE MANFSTD-UNITS-CSR CURSOR FOR                    09090001
091000          SELECT  SUM(A.SHPD_UNT_QTY)                             09100001
091100            FROM  SUT_OTBND_UPC A                                 09110001
091200                 ,SUT_OTBND_CART B                                09120001
091300           WHERE  A.TRN_NBR           = :DK-PO-NBR                09130001
091400             AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN            09140001
091500             AND  A.TRN_LNE_NBR      <= :DK-LINE-END              09150001
091600             AND  A.RCVR_SEQ_NBR      = :DK-REC-SEQ-NBR           09160001
091900             AND  A.TRN_TYP_CDE       = :DK-TRN-TYP-CDE           09190001
092000             AND  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID          09200001
092100             AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            09210001
092200             AND  B.ACTV_IND          = 'Y'                       09220001
092300             AND  B.DEST_LOC_NBR >= :DK-STR-BEGIN                 09230001
092400             AND  B.DEST_LOC_NBR <= :DK-STR-END                   09240001
092500     UNION ALL                                                    09250001
092600          SELECT  SUM(A.SHPD_UNT_QTY)                             09260001
092700            FROM  SUT_OTBND_UPC A                                 09270001
092800                 ,SUT_OTBND_CART B                                09280001
092900                 ,SUT_OTBND_VND C                                 09290001
093000                 ,TPKSLIP  D                                      09300001
093100           WHERE  A.TRN_NBR           = :DK-PO-NBR                09310001
093200             AND  A.TRN_LNE_NBR      >= :DK-LINE-BEGIN            09320001
093300             AND  A.TRN_LNE_NBR      <= :DK-LINE-END              09330001
093600             AND  A.TRN_TYP_CDE       = :DK-TRN-TYP-CDE           09360001
093700             AND  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID          09370001
093800             AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            09380001
093900             AND  B.ACTV_IND          = 'Y'                       09390001
094000             AND  B.CART_TYP_CDE NOT LIKE 'P'                     09400001
094100             AND  B.DEST_LOC_NBR     >= :DK-STR-BEGIN             09410001
094200             AND  B.DEST_LOC_NBR     <= :DK-STR-END               09420001
094300             AND  A.TRN_NBR           = C.PO_NBR                  09430001
094400             AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID            09440001
094500             AND  C.PO_NBR            = D.PO_NBR                  09450001
094600             AND  C.PKSL_SEQ_NBR      = D.SEQ_NBR                 09460001
094700             AND  D.REC_SEQ_NBR       = :DK-REC-SEQ-NBR           09470001
094800             AND  D.VER_STAT_CDE      = 'A'                       09480001
094900          END-EXEC                                                09490001
095000                                                                  09500001
095100     EXEC SQL                                                     09510001
095200          DECLARE VRFD-UNTS-CSR CURSOR FOR                        09520001
095300      SELECT  SUM(B.VERIFY_ITM_QTY)                               09530001
095400             ,SUM(B.AP_VERIFY_ITM_QTY)                            09540001
095500             ,A.STATUS_CDE                                        09550001
095600        FROM  TRECITM  A                                          09560001
095700             ,TRECDIS  B                                          09570001
095800       WHERE  A.ORD_NBR           = :DK-PO-NBR                    09580001
095900         AND  A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR               09590001
096000         AND  A.ORD_LNE_NBR      >= :DK-LINE-BEGIN                09600001
096100         AND  A.ORD_LNE_NBR      <= :DK-LINE-END                  09610001
096200         AND  A.VER_STATUS_CDE    = 'A'                           09620001
096300         AND  B.STR_NBR          >= :DK-STR-BEGIN                 09630001
096400         AND  B.STR_NBR          <= :DK-STR-END                   09640001
096500         AND  A.ORD_NBR           = B.ORD_NBR                     09650001
096600         AND  A.REC_SEQ_NBR       = B.REC_SEQ_NBR                 09660001
096700         AND  A.ORD_LNE_NBR       = B.ORD_LNE_NBR                 09670001
096800         AND  A.OPER_UNT_ID       = B.OPER_UNT_ID                 09680001
097000       GROUP BY A.STATUS_CDE                                      09700001
097100     END-EXEC.                                                    09710001
097200                                                                  09720001
098700     EXEC SQL                                                     09870001
098800          DECLARE PULL-VRFD-UNTS-CSR CURSOR FOR                   09880001
098900      SELECT  B.REQ_ORD_QTY                                       09890001
099000             ,A.STAT_CDE                                          09900001
099100        FROM  TCEPLIT A                                           09910001
099200           ,  TCEPLDS B                                           09920001
099300           ,  XLT_LOC C                                           09930001
099400           ,  XLT_DC_LOC_ASGMT  D                                 09940001
099500       WHERE  A.CNSTK_REQ_PL_NBR  =  :DK-PO-NBR                   09950001
099600         AND  A.CNSTK_REQ_PL_NBR  =  B.CNSTK_REQ_PL_NBR           09960001
099700         AND  A.PL_LNE_NBR        =  B.PL_LNE_NBR                 09970001
099800         AND  A.PL_LNE_NBR        >= :DK-LINE-BEGIN               09980001
099900         AND  A.PL_LNE_NBR        <= :DK-LINE-END                 09990001
100000         AND  B.STR_NBR           >= :DK-STR-BEGIN                10000001
100100         AND  B.STR_NBR           <= :DK-STR-END                  10010001
100200         AND  B.STR_NBR = D.LOC_NBR                               10020001
100300         AND  C.LOC_NBR = D.LOC_NBR                               10030001
100400         AND  C.LOC_TYP_CDE = ('DS')                              10040001
100500         AND  D.DC_NBR = :ASC-DC-ID                               10050001
100600         AND  D.EFF_BEG_DTE =                                     10060001
100700                      (SELECT   MAX(E.EFF_BEG_DTE)                10070001
100800                         FROM   XLT_DC_LOC_ASGMT E                10080001
100900                       WHERE    E.LOC_NBR = C.LOC_NBR             10090001
101000                         AND    E.EFF_BEG_DTE <= CURRENT DATE)    10100001
101100     END-EXEC.                                                    10110001
101400                                                                  10140001
101600     EXEC SQL                                                     10160001
101700          DECLARE FAST-TRANS-CRTN-CSR  CURSOR FOR                 10170001
101800           SELECT  DISTINCT (A.SHIPT_UNT_ID)                      10180001
101900                ,  B.PRNT_CART_ID                                 10190001
102000                ,  B.MSTR_CART_IND                                10200001
102100             FROM  SUT_OTBND_UPC A                                10210001
102200                  ,SUT_OTBND_CART B                               10220001
102300            WHERE  A.TRN_NBR           = :DK-PO-NBR               10230001
102400              AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID           10240001
102500              AND  B.ACTV_IND          = 'Y'                      10250001
102600              AND  B.CART_SRC_CDE      = 'FXR'                    10260001
102700     END-EXEC.                                                    10270001
102800                                                                  10280001
102900     EXEC SQL                                                     10290001
103000          DECLARE FAST-TRANS-UNITS-CSR  CURSOR FOR                10300001
103100           SELECT  A.SHPD_UNT_QTY                                 10310001
103200             FROM  SUT_OTBND_UPC A                                10320001
103300                  ,SUT_OTBND_CART B                               10330001
103400            WHERE  A.TRN_NBR           = :DK-PO-NBR               10340001
103500              AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID           10350001
103600              AND  B.ACTV_IND          = 'Y'                      10360001
103700              AND  B.CART_SRC_CDE      = 'FXR'                    10370001
103800     END-EXEC.                                                    10380001
104000                                                                  10400001
104100*-----------------------------------------------------------------10410001
104200 LINKAGE SECTION.                                                 10420001
104300                                                                  10430001
104400 01  DFHCOMMAREA.                                                 10440001
104500     05  FILLER                         OCCURS  1 TO 4072 TIMES   10450001
104600                                        DEPENDING ON EIBCALEN.    10460001
104700         10  FILLER                     PIC X.                    10470001
104800                                                                  10480001
104900                                                                  10490001
105000 PROCEDURE DIVISION.                                              10500001
105100******************************************************************10510001
105200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **10520001
105300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **10530001
105400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **10540001
105500******************************************************************10550001
105600 0000-MAIN-MODULE.                                                10560001
105700     INITIALIZE DP030-CICS-API-FIELDS.                            10570001
105800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       10580001
105900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          10590001
106000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         10600001
106100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       10610001
106200     MOVE LENGTH OF SU596AI        TO DP030-MAP-LENGTH (1).       10620001
106300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     10630001
106400     PERFORM 0001-CALL-CICS-ARCH-API.                             10640001
106500                                                                  10650017
106600     PERFORM 1000-CONTROL-PROCESSING                              10660001
106700                                                                  10670017
106800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10680001
106900     PERFORM 0001-CALL-CICS-ARCH-API.                             10690001
107000                                                                  10700001
107100******************************************************************10710001
107200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10720001
107300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10730001
107400******************************************************************10740001
107500 0001-CALL-CICS-ARCH-API.                                         10750001
107600                                                                  10760001
107700*    CALL 'DPKCS030' USING DFHEIBLK                               10770018
107710     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10771018
107800                           DFHCOMMAREA                            10780001
107900                           DP030-CICS-API-FIELDS                  10790001
108000                           DP020-STANDARD-COMMAREA                10800001
108100                           SU596AI.                               10810001
108200                                                                  10820017
108300     IF  DP030-RC-CALL-SUCCESSFUL                                 10830001
108400         CONTINUE                                                 10840001
108500     ELSE                                                         10850001
108600         SET DP013-NO-ROLLBACK                                    10860001
108700             DP013-XCTL-DISPLAY-RESTART                           10870001
108800             DP013-CICS-ABEND      TO TRUE                        10880001
108900         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        10890001
109000*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX10900018
109100*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      10910018
109110         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10911018
109120-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10912018
109200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10920001
109300         PERFORM DP013-0000-PROCESS-ABEND                         10930001
109400     END-IF.                                                      10940001
109500                                                                  10950001
109600*----------------------------------------------------------------*10960001
109700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10970001
109800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10980001
109900*                                                                *10990001
110000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11000001
110100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11010001
110200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11020001
110300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11030001
110400*----------------------------------------------------------------*11040001
110500 1000-CONTROL-PROCESSING.                                         11050001
110600                                                                  11060001
110700                                                                  11070001
110800     EVALUATE TRUE                                                11080001
110900         WHEN DP020-NEXT-ACT-INITIAL                              11090001
111000                 INITIALIZE ASC-SPECIFIC-COMMAREA                 11100001
111100                 MOVE EIBTRMID   TO ASC-LIST-TERM-ID              11110001
111200                                    ASC-SEL-TERM-ID-OUT           11120001
111300                MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER11130001
111400                                           ASC-SEL-TASK-NUMBER-OUT11140001
111500                 MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ          11150001
111600                 MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT         11160001
111700                 PERFORM 1100-PROCESS-INTER-APPL-COMM             11170001
111800                 PERFORM 4000-BUILD-INITIAL-PANEL                 11180001
111900                                                                  11190001
112000         WHEN DP020-NEXT-ACT-READ-MAP                             11200001
112100             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         11210001
112200             PERFORM 2000-PROCESS-PANEL                           11220001
112300                                                                  11230001
112400         WHEN DP020-NEXT-ACT-RETURN                               11240001
112500             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         11250001
112600             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               11260001
112700             IF ASC-ALL-CRTNS                                     11270001
112800           MOVE 'ALL CARTONS                                     '11280001
112900                                           TO ACTNSTSO            11290001
113000             ELSE                                                 11300001
113100                 IF ASC-LOADED-CRTNS                              11310001
113200           MOVE 'LOADED CARTONS - PRESS F5 TO SEE ALL CARTONS    '11320001
113300                                           TO ACTNSTSO            11330001
113400                 ELSE                                             11340001
113500           MOVE 'NOT LOADED CARTONS - PRESS F5 TO SEE ALL CARTONS'11350001
113600                                                   TO ACTNSTSO    11360001
113700                 END-IF                                           11370001
113800             END-IF                                               11380001
113900             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 11390001
114000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11400001
114100                                                                  11410001
114200         WHEN OTHER                                               11420001
114300             SET DP013-LOGIC-ABEND TO TRUE                        11430001
114400             SET DP013-NO-ROLLBACK TO TRUE                        11440001
114500             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    11450001
114600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    11460001
114700                                   TO DP013-MESSAGE-TEXT(1)       11470001
114800             PERFORM DP013-0000-PROCESS-ABEND                     11480001
114900     END-EVALUATE.                                                11490001
115000                                                                  11500001
115100*----------------------------------------------------------------*11510001
115200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *11520001
115300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *11530001
115400*----------------------------------------------------------------*11540001
115500 1100-PROCESS-INTER-APPL-COMM.                                    11550001
115600     SET PS-COMMAREA-VALID         TO TRUE.                       11560001
115700     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     11570001
115800                                                                  11580001
115900     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          11590001
116000         MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        11600001
116100         MOVE SU008-DEST-STR-NBR      TO ASC-STR-NBR              11610001
116200         MOVE SU008-PO-NBR            TO ASC-PO-NBR               11620001
116300         MOVE SU008-RCVR-NBR          TO ASC-RCVR-NBR             11630001
116400         MOVE SU008-LINE-NBR          TO ASC-LINE-NBR             11640001
116500                                                                  11650001
116700          SET  ASC-NOT-CS-PULL-TRAN                               11670001
116800               ASC-NOT-FX-FAST-TRAN      TO TRUE                  11680001
116900          IF  SU008-CS-PULL-TRAN                                  11690001
117000              SET  ASC-CS-PULL-TRAN      TO TRUE                  11700001
117100          END-IF                                                  11710001
117200          IF  SU008-FX-FAST-TRANSFER                              11720001
117300              SET  ASC-FX-FAST-TRAN      TO  TRUE                 11730001
117400          END-IF                                                  11740001
117600                                                                  11760001
117800         IF  ASC-RCVR-NBR = 0                                     11780001
118000             EVALUATE TRUE                                        11800001
118100                 WHEN ASC-CS-PULL-TRAN                            11810001
118200                      MOVE SU008-OPER-UNT-ID  TO ASC-DC-ID        11820001
118300                 WHEN ASC-FX-FAST-TRAN                            11830001
118400                      MOVE SU008-OPER-UNT-ID  TO ASC-DC-ID        11840001
118500                      MOVE SU008-DEST-STR-NBR TO PV-FX-STORE      11850001
118600                      MOVE SU008-PO-NBR       TO PV-FX-FAST-NO    11860001
118700                      MOVE PV-FX-FAST-TRANSFER                    11870001
118800                        TO PV-FX-FAST-TRAN-CHAR                   11880001
118900                      MOVE PV-FX-FAST-TRAN-N                      11890001
119000                        TO ASC-PO-NBR-10                          11900001
119100                      MOVE SU008-DEST-STR-NBR                     11910001
119200                                          TO PV-FX-STORE-EDIT     11920001
119300                      MOVE SU008-PO-NBR   TO PV-FX-FAST-NO-EDIT   11930001
119400                      MOVE '-'            TO PV-FX-DASH           11940001
119500         END-IF                                                   11950001
119700     ELSE                                                         11970001
119900*    - FROM TMKCS532 -                                            11990001
120000         IF  DP020-INT-APPL-FORMAT-IND = PC-TRBL-LIST-FORMAT      12000001
120100           IF SU009-NUMBER-OF-SELECTED-ITEMS > 0                  12010002
120200              MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID    12020001
120300                                                                  12030001
120400              SET ASC-USE-SELECTION-QUEUE   TO TRUE               12040001
120500              MOVE SU009-NUMBER-OF-SELECTED-ITEMS                 12050001
120600                              TO ASC-NUMBER-OF-SELECTED-ITEMS     12060001
120700           MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS12070001
120800            MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN12080001
120900                                                                  12090001
121000              PERFORM 1125-PREPARE-LIST-ENTRY                     12100001
121100           END-IF                                                 12110001
121300         ELSE                                                     12130001
121500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  12150001
121700             MOVE SU009-PO-RCVR           TO PV-PO-RCVR-PULL      12170001
121800             IF  PV-CS-IND = '-CS'                                12180001
121900                 SET ASC-CS-PULL-TRAN     TO TRUE                 12190001
122000                 MOVE PV-PULL-DIGITS      TO ASC-PO-NBR           12200001
122100             END-IF                                               12210001
122200             IF  DP020-INT-APPL-FORMAT-IND = PC-DC-LIST-FORMAT AND12220001
122300                 SU009-CS-PULL-TRAN                               12230001
122400                 SET ASC-FROM-CS-LIST TO TRUE                     12240001
122500             END-IF                                               12250001
122700                                                                  12270016
122800             IF  SU009-FX-FAST-TRANSFER                           12280001
122900                 SET ASC-FX-FAST-TRAN     TO TRUE                 12290001
123000                                                                  12300001
123100                 MOVE  SU009-PO-RCVR        TO  PV-FX-FAST-EDIT   12310001
123200                 MOVE  PV-FX-STORE-EDIT     TO  PV-FX-STORE       12320001
123300                 MOVE  PV-FX-FAST-NO-EDIT   TO  PV-FX-FAST-NO     12330001
123400                 MOVE  PV-FX-FAST-NO-EDIT   TO  ASC-PO-NBR        12340001
123500                 MOVE  PV-FX-FAST-TRANSFER  TO  ASC-PO-NBR-10     12350001
123600                                                                  12360001
123700             END-IF                                               12370001
123800             IF DP020-INT-APPL-FORMAT-IND = PC-DC-LIST-FORMAT  AND12380001
123900                 SU009-FX-FAST-TRANSFER                           12390001
124000                 SET ASC-FROM-CS-LIST TO TRUE                     12400001
124100             END-IF                                               12410001
124400                                                                  12440001
124500             MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO               12450001
124600                                      ASC-NUMBER-OF-SELECTED-ITEMS12460001
124700           MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS12470001
124800            MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN12480001
124900            MOVE SU009-PO-RCVR            TO ASC-PO-RCVR          12490001
125000            MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID      12500001
125200             MOVE SU009-DEST-STR-NBR       TO ASC-STR-NBR         12520001
125300             MOVE SU009-PACKAGE            TO ASC-PACKAGE         12530001
125500             PERFORM 1120-PREPARE-LIST-ENTRY                      12550001
125600         END-IF                                                   12560001
125700     END-IF.                                                      12570001
125800                                                                  12580001
125900*-----------------------------------------------------------------12590001
126000 1120-PREPARE-LIST-ENTRY.                                         12600001
126100                                                                  12610001
126200     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                12620001
126300     MOVE ZERO                     TO ASC-SEL-ITEM.               12630001
126400     PERFORM 1130-GET-NEXT-RECORD.                                12640001
126500                                                                  12650001
126700*----------------------------------------------------------------*12670001
126800*    ENTRY IS FROM A LIST.  GET THE RECEIVER NUMBER FROM THE     *12680001
126900*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *12690001
127000*----------------------------------------------------------------*12700001
127100 1125-PREPARE-LIST-ENTRY.                                         12710001
127200     MOVE SU010-MAX-ITEMS      TO ASC-SEL-SUB.                    12720001
127300     MOVE ZERO                 TO ASC-SEL-ITEM.                   12730001
127400     MOVE ZERO                 TO ASC-BLK-SUB.                    12740001
127500     PERFORM 1131-GET-NEXT-RECORD.                                12750001
127600                                                                  12760016
127700*-----------------------------------------------------------------12770001
127800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*12780001
127900*-----------------------------------------------------------------12790001
128000 1130-GET-NEXT-RECORD.                                            12800001
128100                                                                  12810001
128200     ADD +1                       TO ASC-SEL-SUB.                 12820001
128300                                                                  12830001
128400     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            12840001
128500         ADD +1                   TO ASC-SEL-ITEM                 12850001
128600         MOVE +1                  TO ASC-SEL-SUB                  12860001
128700     END-IF.                                                      12870001
128800                                                                  12880001
128900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                12890001
129000         PERFORM 9100-READ-SEL-QUEUE                              12900001
129100         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      12910001
129200             MOVE SU010-LINE-NBR (ASC-SEL-SUB)   TO ASC-LINE-NBR  12920001
129300             MOVE SU010-LINE-STAT (ASC-SEL-SUB)  TO ASC-LINE-STAT 12930001
129400             MOVE SU010-UNTS-VRFD(ASC-SEL-SUB)   TO ASC-UNTS-VRFD 12940001
130100             MOVE SU010-UNTS-MFSD (ASC-SEL-SUB)  TO ASC-UNTS-MNFD 13010001
130400                                                                  13040001
130500             MOVE SU010-UNTS-VARI (ASC-SEL-SUB)  TO ASC-UNTS-VARI 13050001
130600             MOVE SU010-TOT-CRTNS (ASC-SEL-SUB)  TO ASC-TOT-CRTNS 13060001
130700             MOVE SU010-TRIP-ID   (ASC-SEL-SUB)  TO ASC-TRIPID    13070001
130800                                                                  13080016
130900             IF  DP020-INT-APPL-FORMAT-IND =                      13090001
131000                                         PC-DC-LIST-FORMAT        13100001
131100                MOVE SU010-OPER-UNIT-ID(ASC-SEL-SUB)  TO ASC-DC-ID13110001
131200             END-IF                                               13120001
131300             IF  ASC-DC-ID  =  0                                  13130001
131400                 MOVE ASC-OPER-UNT-ID  TO  ASC-DC-ID              13140001
131500             END-IF                                               13150001
131600                                                                  13160016
131700             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  13170001
131800             PERFORM 9200-REWRITE-SEL-QUEUE                       13180001
131900         ELSE                                                     13190001
132000             SUBTRACT +1 FROM ASC-SEL-SUB                         13200001
132100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             13210001
132200             SET DP020-MSG-INFORMATIONAL                          13220001
132300                 PS-LIST-END             TO TRUE                  13230001
132400         END-IF                                                   13240001
132500     ELSE                                                         13250001
132600         SUBTRACT +1 FROM ASC-SEL-ITEM                            13260001
132700         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  13270001
132800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             13280001
132900         SET DP020-MSG-INFORMATIONAL                              13290001
133000             PS-LIST-END             TO TRUE                      13300001
133100     END-IF.                                                      13310001
133200                                                                  13320001
133500*-----------------------------------------------------------------13350001
133600*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*13360001
133610*FROM POCTNLST IN TMKCS532                                        13361016
133700*-----------------------------------------------------------------13370001
133800 1131-GET-NEXT-RECORD.                                            13380001
133900                                                                  13390001
134000     ADD +1                       TO ASC-SEL-SUB.                 13400001
134100                                                                  13410001
134200     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            13420001
134300         ADD +1                   TO ASC-SEL-ITEM                 13430001
134400         MOVE +1                  TO ASC-SEL-SUB                  13440001
134500     END-IF.                                                      13450001
134600                                                                  13460001
134700     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                13470001
134800         PERFORM 9100-READ-SEL-QUEUE                              13480001
134900         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      13490001
135000             MOVE SU010-PO-RCVR (ASC-SEL-SUB)    TO ASC-PO-RCVR   13500001
135100                                                                  13510001
135200             IF  DP020-INT-APPL-FORMAT-IND =                      13520001
135300                                         PC-TRBL-LIST-FORMAT      13530001
135400                MOVE SU010-OPER-UNIT-ID(ASC-SEL-SUB)  TO ASC-DC-ID13540001
135500             END-IF                                               13550001
135600             IF  ASC-DC-ID  =  0                                  13560001
135700                 MOVE ASC-OPER-UNT-ID  TO  ASC-DC-ID              13570001
135800             END-IF                                               13580001
135900             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  13590001
136000             PERFORM 9200-REWRITE-SEL-QUEUE                       13600001
136100         ELSE                                                     13610001
136200             SUBTRACT +1 FROM ASC-SEL-SUB                         13620001
136300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             13630001
136400             SET DP020-MSG-INFORMATIONAL                          13640001
136500                 PS-LIST-END             TO TRUE                  13650001
136600         END-IF                                                   13660001
136700     ELSE                                                         13670001
136800         SUBTRACT +1 FROM ASC-SEL-ITEM                            13680001
136900         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  13690001
137000         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             13700001
137100         SET DP020-MSG-INFORMATIONAL                              13710001
137200             PS-LIST-END             TO TRUE                      13720001
137300     END-IF.                                                      13730001
137500                                                                  13750001
137600*-----------------------------------------------------------------13760001
137700*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *13770001
137800*    PROCESSED.                                                  *13780001
137900*-----------------------------------------------------------------13790001
138000 1140-GET-PREV-RECORD.                                            13800001
138100                                                                  13810001
138200     SUBTRACT +1 FROM ASC-SEL-SUB.                                13820001
138300                                                                  13830001
138400     IF  ASC-SEL-SUB < +1                                         13840001
138500         SUBTRACT +1 FROM ASC-SEL-ITEM                            13850001
138600         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  13860001
138700     END-IF.                                                      13870001
138800                                                                  13880001
138900     IF  ASC-SEL-ITEM > ZERO                                      13890001
139000         PERFORM 9100-READ-SEL-QUEUE                              13900001
139100         MOVE SU010-LINE-NBR (ASC-SEL-SUB)   TO ASC-LINE-NBR      13910001
139200         MOVE SU010-LINE-STAT (ASC-SEL-SUB)  TO ASC-LINE-STAT     13920001
139300         MOVE SU010-UNTS-VRFD(ASC-SEL-SUB)   TO ASC-UNTS-VRFD     13930001
139700                                                                  13970001
140200         MOVE SU010-UNTS-MFSD (ASC-SEL-SUB)  TO ASC-UNTS-MNFD     14020001
140400                                                                  14040001
140500         MOVE SU010-UNTS-VARI (ASC-SEL-SUB)  TO ASC-UNTS-VARI     14050001
140600         MOVE SU010-TOT-CRTNS (ASC-SEL-SUB)  TO ASC-TOT-CRTNS     14060001
140700         MOVE SU010-TRIP-ID   (ASC-SEL-SUB)  TO ASC-TRIPID        14070001
140900         MOVE SU010-OPER-UNIT-ID(ASC-SEL-SUB)  TO ASC-DC-ID       14090001
141100         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      14110001
141200         PERFORM 9200-REWRITE-SEL-QUEUE                           14120001
141300     ELSE                                                         14130001
141400         MOVE +1                  TO ASC-SEL-ITEM                 14140001
141500                                     ASC-SEL-SUB                  14150001
141600         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             14160001
141700         SET DP020-MSG-INFORMATIONAL                              14170001
141800             PS-LIST-END             TO TRUE                      14180001
141900     END-IF.                                                      14190001
142000                                                                  14200001
142100*-----------------------------------------------------------------14210001
142200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *14220001
142300*    PROCESSED. (FROM POCTNLST)                                  *14230001
142400*-----------------------------------------------------------------14240001
142500 1141-GET-PREV-RECORD.                                            14250001
142600                                                                  14260001
142700     SUBTRACT +1 FROM ASC-SEL-SUB.                                14270001
142800                                                                  14280001
142900     IF  ASC-SEL-SUB < +1                                         14290001
143000         SUBTRACT +1 FROM ASC-SEL-ITEM                            14300001
143100         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  14310001
143200     END-IF.                                                      14320001
143300                                                                  14330001
143400     IF  ASC-SEL-ITEM > ZERO                                      14340001
143500         PERFORM 9100-READ-SEL-QUEUE                              14350001
143600         MOVE SU010-PO-RCVR (ASC-SEL-SUB)    TO ASC-PO-RCVR       14360001
143700                                                                  14370001
143800         MOVE SU010-OPER-UNIT-ID(ASC-SEL-SUB)  TO ASC-DC-ID       14380001
143900         IF  ASC-DC-ID  =  0                                      14390001
144000             MOVE ASC-OPER-UNT-ID  TO  ASC-DC-ID                  14400001
144100         END-IF                                                   14410001
144200         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      14420001
144300         PERFORM 9200-REWRITE-SEL-QUEUE                           14430001
144400     ELSE                                                         14440001
144500         MOVE +1                  TO ASC-SEL-ITEM                 14450001
144600                                     ASC-SEL-SUB                  14460001
144700         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             14470001
144800         SET DP020-MSG-INFORMATIONAL                              14480001
144900             PS-LIST-END             TO TRUE                      14490001
145000     END-IF.                                                      14500001
145100*----------------------------------------------------------------*14510001
145200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14520001
145300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14530001
145400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14540001
145500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14550001
145600* FUNCTION KEYS CAN GET THIS FAR.                                *14560001
145700*----------------------------------------------------------------*14570001
145800 2000-PROCESS-PANEL.                                              14580001
145900                                                                  14590001
146000     EVALUATE TRUE                                                14600001
146100         WHEN DP020-SRC-AID = DP016-CLEAR                         14610001
146200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    14620001
146300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14630001
146400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14640001
146500                                                                  14650001
146600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    14660001
146700                                                                  14670016
146800* REINITIALIZE ASC-UNTS-MNFD WHEN COMING FROM CRIT SPEC OR        14680001
146900* CENTRAL STOCK LIST SCREEN, OTHERWISE COUNTS DOUBLE EVERY TIME   14690001
147000* F5 IS PRESSED. FROM LINE LIST, DO NOT INIT, AS COUNTS GO TO ZERO14700001
147100             IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT  14710001
147200                 OR ASC-FROM-CS-LIST                              14720001
147300                 MOVE ZEROES TO ASC-UNTS-MNFD                     14730001
147400             END-IF                                               14740001
147500                                                                  14750016
147600             PERFORM 2050-DELETE-LIST-QUEUE                       14760001
147700             PERFORM 4000-BUILD-INITIAL-PANEL                     14770001
147800                                                                  14780001
147900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    14790001
148000             PERFORM 2140-DESELECT-ALL-ITEMS                      14800001
148100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14810001
148200                                                                  14820001
148300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14830001
148400             PERFORM 2150-SELECT-ALL-ITEMS                        14840001
148500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14850001
148600*F20                                                              14860001
148700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14870001
148800             IF  ASC-USE-SELECTION-QUEUE                          14880001
149000               IF DP020-INT-APPL-FORMAT-IND = PC-TRBL-LIST-FORMAT 14900001
149100*                COMES FROM POCTNLST (TMKCS532)                   14910001
149200                 PERFORM 1131-GET-NEXT-RECORD                     14920001
149300                ELSE                                              14930001
149400                 PERFORM 1130-GET-NEXT-RECORD                     14940001
149600               END-IF                                             14960001
149700               IF PS-LIST-END                                     14970001
149800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14980001
149900                     SET PS-NO-LIST-END TO TRUE                   14990001
150000               ELSE                                               15000001
150100                     PERFORM 2050-DELETE-LIST-QUEUE               15010001
150200                     PERFORM 3200-RESET-ATTRIBUTES                15020001
150300                     PERFORM 4000-BUILD-INITIAL-PANEL             15030001
150400               END-IF                                             15040001
150500              ELSE                                                15050001
150600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15060001
150700*                --- BOTTOM OF LIST ---                           15070001
150800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         15080001
150900                 SET DP020-MSG-INFORMATIONAL TO TRUE              15090001
151000             END-IF                                               15100001
151100                                                                  15110001
151200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             15120001
151300             IF  ASC-USE-SELECTION-QUEUE                          15130001
151500               IF DP020-INT-APPL-FORMAT-IND = PC-TRBL-LIST-FORMAT 15150001
151600*                COMES FROM POCTNLST (TMKCS532)                   15160001
151700                 PERFORM 1141-GET-PREV-RECORD                     15170001
151800               ELSE                                               15180001
151900                 PERFORM 1140-GET-PREV-RECORD                     15190001
152000               END-IF                                             15200001
152200                 IF PS-LIST-END                                   15220001
152300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         15230001
152400                     SET PS-NO-LIST-END TO TRUE                   15240001
152500                 ELSE                                             15250001
152600                     PERFORM 2050-DELETE-LIST-QUEUE               15260001
152700                     PERFORM 3200-RESET-ATTRIBUTES                15270001
152800                     PERFORM 4000-BUILD-INITIAL-PANEL             15280001
152900                 END-IF                                           15290001
153000             ELSE                                                 15300001
153100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15310001
153200                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         15320001
153300                 SET DP020-MSG-INFORMATIONAL TO TRUE              15330001
153400             END-IF                                               15340001
153500                                                                  15350001
153600         WHEN OTHER                                               15360001
153700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 15370001
153800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   15380001
153900                                                                  15390001
154000             IF  PS-NO-ERROR                                      15400001
154100                 SET DP030-CONTINUE-GO TO TRUE                    15410001
154200                 PERFORM 2100-CHECK-FUNCTION-KEY                  15420001
154300             ELSE                                                 15430001
154400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15440001
154500                 SET DP030-OVERRIDE-GO TO TRUE                    15450001
154600             END-IF                                               15460001
154700     END-EVALUATE.                                                15470001
154800                                                                  15480001
154900*----------------------------------------------------------------*15490001
155000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *15500001
155100*----------------------------------------------------------------*15510001
155200 2050-DELETE-LIST-QUEUE.                                          15520001
155300                                                                  15530001
155400     EXEC CICS                                                    15540001
155500         DELETEQ TS                                               15550001
155600             QUEUE (ASC-LIST-QUEUE-NAME)                          15560001
155700             RESP  (PV-CICS-RESP)                                 15570001
155800     END-EXEC.                                                    15580001
155900                                                                  15590001
156000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15600001
156100        (PV-CICS-RESP = DFHRESP(QIDERR))                          15610001
156200         CONTINUE                                                 15620001
156300     ELSE                                                         15630001
156400         SET DP013-CICS-ABEND      TO TRUE                        15640001
156500         SET DP013-NO-ROLLBACK     TO TRUE                        15650001
156600                                                                  15660001
156700         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         15670001
156800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    15680001
156900                                   TO DP013-MESSAGE-TEXT (1)      15690001
157000         PERFORM DP013-0000-PROCESS-ABEND                         15700001
157100     END-IF.                                                      15710001
157200                                                                  15720001
157300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  15730001
157400                                                                  15740001
157500*----------------------------------------------------------------*15750001
157600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*15760001
157700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *15770001
157800* CICS ARCHITECTURE API.                                         *15780001
157900*----------------------------------------------------------------*15790001
158000 2100-CHECK-FUNCTION-KEY.                                         15800001
158100                                                                  15810001
158200     EVALUATE TRUE                                                15820001
158300                                                                  15830017
158400* F18 - OUTBOUND TRIP CARTON LIST                                 15840001
158500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15850001
158600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              15860001
158700                 SET ASC-USE-SELECTION-QUEUE TO TRUE              15870001
158800                 INITIALIZE SU009-INTER-APPL-COMMAREA             15880001
158900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                15890001
159000                                TO SU009-NUMBER-OF-SELECTED-ITEMS 15900001
159100                 MOVE ASC-NUMBER-OF-TS-ITEMS                      15910001
159200                                      TO SU009-NUMBER-OF-TS-ITEMS 15920001
159300                 MOVE ASC-SEL-QUEUE-NAME-OUT                      15930001
159400                                      TO SU009-SEL-QUEUE-NAME     15940001
159500                 MOVE ASC-OPER-UNT-ID      TO SU009-OPER-UNT-ID   15950001
159600                 PERFORM 5000-PREPARE-SEL-QUEUE                   15960001
159700             ELSE                                                 15970001
159800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15980001
159900                 SET DP030-OVERRIDE-GO TO TRUE                    15990001
160000                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         16000001
160100                 SET DP020-MSG-WARNING TO TRUE                    16010001
160200             END-IF                                               16020001
160300                                                                  16030017
160400* F22 - CARTON DETAIL                                             16040001
160500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              16050001
160600* F24 - CARTON PACKED DETAIL                                      16060001
160700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              16070001
160800* F23 - CARTON MANIFEST LIST                                      16080001
160900         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              16090001
161000* F14 - SML CARTON FLOW LIST                                      16100005
161100         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              16110005
161200             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              16120001
161300                 SET ASC-USE-SELECTION-QUEUE TO TRUE              16130001
161400                 INITIALIZE SU009-INTER-APPL-COMMAREA             16140001
161500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                16150001
161600                                TO SU009-NUMBER-OF-SELECTED-ITEMS 16160001
161700                 MOVE ASC-NUMBER-OF-TS-ITEMS                      16170001
161800                                      TO SU009-NUMBER-OF-TS-ITEMS 16180001
161900                 MOVE ASC-SEL-QUEUE-NAME-OUT                      16190001
162000                                      TO SU009-SEL-QUEUE-NAME     16200001
162100                 MOVE ASC-OPER-UNT-ID      TO SU009-OPER-UNT-ID   16210001
162200                 MOVE ASC-STR-NBR          TO SU009-DEST-STR-NBR  16220001
162300                 MOVE ASC-OUTBOUND-TRIP-ID TO SU009-TRIP-ID       16230001
162400                 PERFORM 5000-PREPARE-SEL-QUEUE                   16240001
162500             ELSE                                                 16250001
162600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16260001
162700                 SET DP030-OVERRIDE-GO TO TRUE                    16270001
162800                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         16280001
162900                 SET DP020-MSG-WARNING TO TRUE                    16290001
163000             END-IF                                               16300001
163100                                                                  16310001
163200* F16 - SHOW CARTONS NOT LOADED                                   16320001
163300         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              16330001
163400           MOVE 'NOT LOADED CARTONS - PRESS F5 TO SEE ALL CARTONS'16340001
163500                                          TO ACTNSTSO             16350001
163600             SET ASC-NOT-LOADED-CRTNS     TO TRUE                 16360001
163700             MOVE +1                  TO PV-TOP-ITEM              16370001
163800             INITIALIZE          ASC-BLOCK-ENTRIES (1)            16380001
163900                                 ASC-BLOCK-ENTRIES (2)            16390001
164000             MOVE +1         TO ASC-BLK-SUB                       16400001
164100             SET ASC-ITEMS-LEFT-ON-DB  TO TRUE                    16410001
164200                                                                  16420001
164300             MOVE +0         TO ASC-ITEM-SUB                      16430001
164400                                ASC-NUMBER-OF-ITEMS-READ          16440001
164500                                ASC-NUMBER-OF-SELECTED-ITEMS      16450001
164600                                ASC-HIGHEST-BLOCK-WRITTEN         16460001
164700                                ASC-START-OF-SELECTED-RANGE       16470001
164800                                ASC-END-OF-SELECTED-RANGE         16480001
164900                                ASC-ITEM-AT-TOP-OF-PANEL          16490001
165000                                ASC-ITEM-AT-BOT-OF-PANEL          16500001
165100                                                                  16510001
165300             IF ASC-CS-PULL-TRAN                                  16530001
165400                 MOVE ASC-PO-NBR        TO DK-PO-NBR              16540001
165500                 MOVE ZEROES            TO DK-REC-SEQ-NBR         16550001
165600                 MOVE ASC-PO-NBR        TO PV-PULL-NBR-N          16560001
165700                 MOVE PV-PULL-NBR-X     TO PV-PULL                16570001
165800                 MOVE '-CS'             TO PV-TRAN                16580001
165900                 MOVE PV-PULL-NBR       TO ASC-PO-RCVR            16590001
166000                 MOVE ASC-PO-NBR        TO DK-PO-NBR              16600001
166100                 MOVE 'CS'              TO DK-TRN-TYP-CDE         16610001
166200                                                                  16620001
166400             ELSE                                                 16640001
166500             IF ASC-FX-FAST-TRAN                                  16650001
166600                 MOVE ZEROES               TO DK-REC-SEQ-NBR      16660001
166700                 MOVE ASC-PO-NBR           TO PV-FX-FAST-NO       16670001
166800                 MOVE ASC-STR-NBR          TO PV-FX-STORE         16680001
166900                 MOVE ASC-STR-NBR          TO PV-FX-STORE-EDIT    16690001
167000                 MOVE ASC-PO-NBR           TO PV-FX-FAST-NO-EDIT  16700001
167100                 MOVE '-'                  TO PV-FX-DASH          16710001
167200                 MOVE PV-FX-FAST-EDIT      TO ASC-PO-RCVR         16720001
167300                 MOVE 'FX'                 TO DK-TRN-TYP-CDE      16730001
167400             ELSE                                                 16740001
167600                                                                  16760001
167700                 MOVE 'PO'                  TO DK-TRN-TYP-CDE     16770001
167900                                                                  16790001
168000                 IF ASC-PO-RCVR > ZEROES                          16800001
168100                     MOVE ASC-PO-RCVR       TO DK-PO-RCVR         16810001
168200                     MOVE DK-PO             TO DK-PO-NBR          16820001
168300                     MOVE DK-RCVR           TO DK-REC-SEQ-NBR     16830001
168400                 ELSE                                             16840001
168500                     MOVE ASC-PO-NBR        TO DK-PO-NBR          16850001
168600                     MOVE ASC-RCVR-NBR      TO DK-REC-SEQ-NBR     16860001
168700                     MOVE ASC-PO-NBR        TO DK-PO-TRN-NBR      16870001
168800                     MOVE DK-TRN-NBR-X      TO DK-TRN-NBR-9       16880001
168900                     MOVE DK-TRN-NBR-8      TO DK-PO              16890001
169000                     MOVE ASC-RCVR-NBR      TO DK-PO-RCVR-NBR-N   16900001
169100                     MOVE DK-RCVR-NBR-X     TO DK-RCVR-NBR-9      16910001
169200                     MOVE DK-RCVR-NBR-3     TO DK-RCVR            16920001
169300                     MOVE DK-PO-RCVR        TO ASC-PO-RCVR        16930001
169400                 END-IF                                           16940001
169600             END-IF                                               16960001
169700             END-IF                                               16970001
169800                                                                  16980001
169900             IF ASC-LINE-NBR  > ZERO                              16990001
170000                 MOVE ASC-LINE-NBR        TO DK-LINE-BEGIN        17000001
170100                                             DK-LINE-END          17010001
170200             ELSE                                                 17020001
170300                 MOVE DK-DEFAULT-BEGIN    TO DK-LINE-BEGIN        17030001
170400                 MOVE DK-DEFAULT-END-LINE TO DK-LINE-END          17040001
170500             END-IF                                               17050001
170600             IF ASC-STR-NBR > ZERO                                17060001
170700                 MOVE ASC-STR-NBR       TO DK-STR-BEGIN           17070001
170800                                           DK-STR-END             17080001
170900             ELSE                                                 17090001
171000                 MOVE DK-DEFAULT-BEGIN   TO DK-STR-BEGIN          17100001
171100                 MOVE DK-DEFAULT-END-STR TO DK-STR-END            17110001
171200             END-IF                                               17120001
171400             IF ASC-DC-ID > ZERO                                  17140001
171500                 MOVE ASC-DC-ID          TO DK-DC-BEGIN           17150001
171600                                            DK-DC-END             17160001
171700             ELSE                                                 17170001
171800                 MOVE DK-DEFAULT-BEGIN   TO DK-DC-BEGIN           17180001
171900                 MOVE DK-DEFAULT-END-STR TO DK-DC-END             17190001
172000             END-IF                                               17200001
172100                                                                  17210016
172200             SET ASC-ITEMS-LEFT-ON-DB TO TRUE                     17220001
172300             PERFORM 2050-DELETE-LIST-QUEUE                       17230001
172400             IF  ASC-FX-FAST-TRAN                                 17240001
172500                 MOVE  ASC-PO-NBR-10     TO DK-PO-NBR-COMP10      17250001
172600                 MOVE  DK-PO-NBR-COMP10  TO DK-PO-NBR             17260001
172700                 PERFORM 8300-OPEN-FX-CURSOR                      17270001
172800                 PERFORM 4500-READ-ITEMS-FROM-DB                  17280001
172900                 PERFORM 8310-CLOSE-FX-CURSOR                     17290001
173000             ELSE                                                 17300001
173100                 PERFORM 4010-OPEN-CURSOR                         17310001
173200                 PERFORM 4500-READ-ITEMS-FROM-DB                  17320001
173300                 PERFORM 4020-CLOSE-CURSOR                        17330001
173400             END-IF                                               17340001
173500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17350001
173600             SET DP030-OVERRIDE-GO TO TRUE                        17360001
173700                                                                  17370001
173800* F17 - SHOW LOADED CARTONS                                       17380001
173900         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              17390001
174000           MOVE '    LOADED CARTONS - PRESS F5 TO SEE ALL CARTONS'17400001
174100                                      TO ACTNSTSO                 17410001
174200             SET ASC-LOADED-CRTNS     TO TRUE                     17420001
174300             MOVE +1                  TO PV-TOP-ITEM              17430001
174400             INITIALIZE          ASC-BLOCK-ENTRIES (1)            17440001
174500                                 ASC-BLOCK-ENTRIES (2)            17450001
174600             MOVE +1         TO ASC-BLK-SUB                       17460001
174700             SET ASC-ITEMS-LEFT-ON-DB  TO TRUE                    17470001
174800                                                                  17480001
174900             MOVE +0         TO ASC-ITEM-SUB                      17490001
175000                                ASC-NUMBER-OF-ITEMS-READ          17500001
175100                                ASC-NUMBER-OF-SELECTED-ITEMS      17510001
175200                                ASC-HIGHEST-BLOCK-WRITTEN         17520001
175300                                ASC-START-OF-SELECTED-RANGE       17530001
175400                                ASC-END-OF-SELECTED-RANGE         17540001
175500                                ASC-ITEM-AT-TOP-OF-PANEL          17550001
175600                                ASC-ITEM-AT-BOT-OF-PANEL          17560001
175700                                                                  17570001
175900             IF ASC-CS-PULL-TRAN                                  17590001
176000                 MOVE ASC-PO-NBR        TO DK-PO-NBR              17600001
176100                 MOVE ZEROES            TO DK-REC-SEQ-NBR         17610001
176200                 MOVE ASC-PO-NBR        TO PV-PULL-NBR-N          17620001
176300                 MOVE PV-PULL-NBR-X     TO PV-PULL                17630001
176400                 MOVE '-CS'             TO PV-TRAN                17640001
176500                 MOVE PV-PULL-NBR       TO ASC-PO-RCVR            17650001
176700                 MOVE 'CS'              TO DK-TRN-TYP-CDE         17670001
176900             ELSE                                                 17690001
177100             MOVE 'PO'                  TO DK-TRN-TYP-CDE         17710001
177400             IF ASC-PO-RCVR > ZEROES                              17740001
177500                 MOVE ASC-PO-RCVR       TO DK-PO-RCVR             17750001
177600                 MOVE DK-PO             TO DK-PO-NBR              17760001
177700                 MOVE DK-RCVR           TO DK-REC-SEQ-NBR         17770001
177800             ELSE                                                 17780001
177900                 MOVE ASC-PO-NBR        TO DK-PO-NBR              17790001
178000                 MOVE ASC-RCVR-NBR      TO DK-REC-SEQ-NBR         17800001
178100                 MOVE ASC-PO-NBR        TO DK-PO-TRN-NBR          17810001
178200                 MOVE DK-TRN-NBR-X      TO DK-TRN-NBR-9           17820001
178300                 MOVE DK-TRN-NBR-8      TO DK-PO                  17830001
178400                 MOVE ASC-RCVR-NBR      TO DK-PO-RCVR-NBR-N       17840001
178500                 MOVE DK-RCVR-NBR-X     TO DK-RCVR-NBR-9          17850001
178600                 MOVE DK-RCVR-NBR-3     TO DK-RCVR                17860001
178700                 MOVE DK-PO-RCVR        TO ASC-PO-RCVR            17870001
178800             END-IF                                               17880001
178900                                                                  17890016
179000             END-IF                                               17900001
179100             IF ASC-LINE-NBR  > ZERO                              17910001
179200                 MOVE ASC-LINE-NBR        TO DK-LINE-BEGIN        17920001
179300                                             DK-LINE-END          17930001
179400             ELSE                                                 17940001
179500                 MOVE DK-DEFAULT-BEGIN    TO DK-LINE-BEGIN        17950001
179600                 MOVE DK-DEFAULT-END-LINE TO DK-LINE-END          17960001
179700             END-IF                                               17970001
179800             IF ASC-STR-NBR > ZERO                                17980001
179900                 MOVE ASC-STR-NBR       TO DK-STR-BEGIN           17990001
180000                                           DK-STR-END             18000001
180100             ELSE                                                 18010001
180200                 MOVE DK-DEFAULT-BEGIN   TO DK-STR-BEGIN          18020001
180300                 MOVE DK-DEFAULT-END-STR TO DK-STR-END            18030001
180400             END-IF                                               18040001
180500                                                                  18050016
180600             IF ASC-DC-ID > ZERO                                  18060001
180700                 MOVE ASC-DC-ID          TO DK-DC-BEGIN           18070001
180800                                            DK-DC-END             18080001
180900             ELSE                                                 18090001
181000                 MOVE DK-DEFAULT-BEGIN   TO DK-DC-BEGIN           18100001
181100                 MOVE DK-DEFAULT-END-STR TO DK-DC-END             18110001
181200             END-IF                                               18120001
181300                                                                  18130016
181400             SET ASC-ITEMS-LEFT-ON-DB TO TRUE                     18140001
181500             PERFORM 2050-DELETE-LIST-QUEUE                       18150001
181600             PERFORM 4010-OPEN-CURSOR                             18160001
181700             PERFORM 4700-READ-ITEMS-FROM-DB                      18170001
181800             PERFORM 4020-CLOSE-CURSOR                            18180001
181900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18190001
182000             SET DP030-OVERRIDE-GO TO TRUE                        18200001
182100                                                                  18210016
182200* F6 - FIRST PAGE                                                 18220001
182300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  18230001
182400             MOVE +1               TO PV-TOP-ITEM                 18240001
182500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18250001
182600                                                                  18260016
182700* F7 - PREVIOUS PAGE                                              18270001
182800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   18280001
182900             PERFORM 2110-BROWSE-BACKWARD                         18290001
183000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18300001
183100                                                                  18310016
183200* F8 - NEXT PAGE                                                  18320001
183300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   18330001
183400             PERFORM 2120-BROWSE-FORWARD                          18340001
183500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18350001
183600                                                                  18360016
183700* ENTER KEY                                                       18370001
183800         WHEN DP020-SRC-AID = DP016-ENTER                         18380001
183900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   18390001
184000             IF  PS-ERROR                                         18400001
184100                 CONTINUE                                         18410001
184200             ELSE                                                 18420001
184300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18430001
184400             END-IF                                               18440001
184500                                                                  18450001
184600         WHEN OTHER                                               18460001
184700             SET DP013-NO-ROLLBACK                                18470001
184800                 DP013-XCTL-DISPLAY-RESTART                       18480001
184900                 DP013-CICS-ABEND  TO TRUE                        18490001
185000             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    18500001
185100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      18510001
185200                                   TO DP013-MESSAGE-TEXT (1)      18520001
185300             PERFORM DP013-0000-PROCESS-ABEND                     18530001
185400     END-EVALUATE.                                                18540001
185500                                                                  18550016
185600*----------------------------------------------------------------*18560001
185700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *18570001
185800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *18580001
185900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *18590001
186000*    MESSAGE.                                                    *18600001
186100*----------------------------------------------------------------*18610001
186200 2110-BROWSE-BACKWARD.                                            18620001
186300                                                                  18630001
186400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    18640001
186500         GIVING PV-TOP-ITEM.                                      18650001
186600                                                                  18660016
186700     IF  ((PV-TOP-ITEM < +1)                                      18670001
186800       OR (PV-TOP-ITEM = +1))                                     18680001
186900         MOVE +1                   TO PV-TOP-ITEM                 18690001
187000*        -- TOP OF LIST --                                        18700001
187100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18710001
187200         SET DP020-MSG-INFORMATIONAL TO TRUE                      18720001
187300     END-IF.                                                      18730001
187400                                                                  18740001
187500*----------------------------------------------------------------*18750001
187600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *18760001
187700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *18770001
187800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *18780001
187900*----------------------------------------------------------------*18790001
188000 2120-BROWSE-FORWARD.                                             18800001
188100                                                                  18810001
188200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              18820001
188300         GIVING PV-TOP-ITEM.                                      18830001
188400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   18840001
188500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             18850001
188600*        -- BOTTOM OF LIST --                                     18860001
188700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            18870001
188800         SET DP020-MSG-INFORMATIONAL  TO TRUE                     18880001
188900     ELSE                                                         18890001
189000         COMPUTE PV-BOTTOM-ITEM =                                 18900001
189100             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 18910001
189200         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            18920001
189300*            -- BOTTOM OF LIST --                                 18930001
189400             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            18940001
189500             SET DP020-MSG-INFORMATIONAL TO TRUE                  18950001
189600         END-IF                                                   18960001
189700     END-IF.                                                      18970001
189800                                                                  18980001
189900*----------------------------------------------------------------*18990001
190000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *19000001
190100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *19010001
190200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *19020001
190300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *19030001
190400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *19040001
190500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *19050001
190600*----------------------------------------------------------------*19060001
190700 2130-CHECK-FOR-JUMP-BROWSE.                                      19070001
190800     SET PS-NO-ERROR               TO TRUE.                       19080001
190900     IF (ASC-START-ITEM-REQUEST = SPACE)                          19090001
191000         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             19100001
191100     ELSE                                                         19110001
191200         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     19120001
191300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       19130001
191400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     19140001
191500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19150001
191600         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19160016
191610              USING DP010I-NUMERIC-EDIT-AREA                      19161016
191700                                                                  19170001
191800         IF  NOT DP010I-ERROR-DETECTED                            19180001
191900             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N19190001
192000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  19200001
192100                 IF  ASC-START-ITEM-REQUEST-N >                   19210001
192200                                          ASC-NUMBER-OF-ITEMS-READ19220001
192300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         19230001
192400                     COMPUTE PV-TOP-ITEM =                        19240001
192500                             ASC-NUMBER-OF-ITEMS-READ             19250001
192600                             - PC-ITEMS-PER-PANEL + 1             19260001
192700                     IF  PV-TOP-ITEM < +1                         19270001
192800                         MOVE +1   TO PV-TOP-ITEM                 19280001
192900                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 19290001
193000                         SET DP020-MSG-INFORMATIONAL TO TRUE      19300001
193100                     ELSE                                         19310001
193200                         MOVE  PV-TOP-ITEM                        19320001
193300                           TO  ASC-START-ITEM-REQUEST-N           19330001
193400                     END-IF                                       19340001
193500                 ELSE                                             19350001
193600                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 19360001
193700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      19370001
193800                     COMPUTE PV-BOTTOM-ITEM =                     19380001
193900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     19390001
194000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ19400001
194100                         SUBTRACT  PV-TOP-ITEM                    19410001
194200                             FROM  ASC-NUMBER-OF-ITEMS-READ       19420001
194300                           GIVING  ASC-ITEMS-DISPLAYED            19430001
194400                         MOVE  ASC-NUMBER-OF-ITEMS-READ           19440001
194500                           TO  PV-BOTTOM-ITEM                     19450001
194600*                        -- BOTTOM OF LIST --                     19460001
194700                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 19470001
194800                         SET DP020-MSG-INFORMATIONAL TO TRUE      19480001
194900                     END-IF                                       19490001
195000                 END-IF                                           19500001
195100             ELSE                                                 19510001
195200*                --- VALUE OUT OF RANGE ----                      19520001
195300                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        19530001
195400                 MOVE -1           TO ASTRTITL                    19540001
195500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              19550001
195600                 MOVE DP015-REVERSE TO ASTRTITH                   19560001
195700                 MOVE DP015-RED    TO ASTRTITC                    19570001
195800                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           19580001
195900                 SET DP020-MSG-FATAL                              19590001
196000                     PS-ERROR        TO TRUE                      19600001
196100             END-IF                                               19610001
196200         ELSE                                                     19620001
196300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19630001
196400             MOVE -1               TO ASTRTITL                    19640001
196500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19650001
196600             MOVE DP015-REVERSE    TO ASTRTITH                    19660001
196700             MOVE DP015-RED        TO ASTRTITC                    19670001
196800             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               19680001
196900             SET DP020-MSG-FATAL   TO TRUE                        19690001
197000             SET PS-ERROR          TO TRUE                        19700001
197100         END-IF                                                   19710001
197200     END-IF.                                                      19720001
197300                                                                  19730001
197400*----------------------------------------------------------------*19740001
197500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *19750001
197600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *19760001
197700*----------------------------------------------------------------*19770001
197800 2140-DESELECT-ALL-ITEMS.                                         19780001
197900                                                                  19790001
198000     MOVE +1                       TO ASC-BLK-SUB.                19800001
198100                                                                  19810001
198200     PERFORM 2141-CLEAR-SELECTED-INDS                             19820001
198300         VARYING ASC-ITEM-SUB                                     19830001
198400         FROM 1 BY 1                                              19840001
198500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19850001
198600                                                                  19860001
198700     ADD +1                        TO ASC-BLK-SUB.                19870001
198800                                                                  19880001
198900     PERFORM 2141-CLEAR-SELECTED-INDS                             19890001
199000         VARYING ASC-ITEM-SUB                                     19900001
199100         FROM 1 BY 1                                              19910001
199200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19920001
199300                                                                  19930001
199400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19940001
199500                                   TO PV-LIST-ITEM-NUMBER.        19950001
199600                                                                  19960001
199700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19970001
199800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19980001
199900                                                                  19990001
200000     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            20000001
200100         MOVE +1                   TO ASC-BLK-SUB                 20010001
200200                                                                  20020001
200300         PERFORM 5100-WRITE-TEMP-STORAGE                          20030001
200400         MOVE +2                   TO ASC-BLK-SUB                 20040001
200500         PERFORM 5100-WRITE-TEMP-STORAGE                          20050001
200600         MOVE +1                   TO ASC-BLK-SUB                 20060001
200700         MOVE +1                   TO PV-BLOCK-NUMBER             20070001
200800     END-IF.                                                      20080001
200900                                                                  20090001
201000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20100001
201100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      20110001
201200         MOVE +1                   TO ASC-BLK-SUB                 20120001
201300                                                                  20130001
201400         PERFORM 5100-WRITE-TEMP-STORAGE                          20140001
201500         MOVE +2                   TO ASC-BLK-SUB                 20150001
201600         PERFORM 5100-WRITE-TEMP-STORAGE                          20160001
201700         MOVE +1                   TO ASC-BLK-SUB                 20170001
201800                                                                  20180001
201900         MOVE +1                   TO PV-BLOCK-NUMBER             20190001
202000                                                                  20200001
202100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20210001
202200             PV-FIRST-BLOCK-IN-ARRAY - 1                          20220001
202300                                                                  20230001
202400         PERFORM                                                  20240001
202500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20250001
202600                                                                  20260001
202700             PERFORM 4410-READ-TEMP-STORAGE                       20270001
202800                                                                  20280001
202900             PERFORM 2141-CLEAR-SELECTED-INDS                     20290001
203000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 20300001
203100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20310001
203200                                                                  20320001
203300             PERFORM 5100-WRITE-TEMP-STORAGE                      20330001
203400                                                                  20340001
203500             ADD +1                TO PV-BLOCK-NUMBER             20350001
203600                                                                  20360001
203700         END-PERFORM                                              20370001
203800                                                                  20380001
203900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20390001
204000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20400001
204100                                                                  20410001
204200         PERFORM                                                  20420001
204300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20430001
204400                   ASC-HIGHEST-BLOCK-WRITTEN                      20440001
204500                                                                  20450001
204600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20460001
204700                                   TO PV-BLOCK-NUMBER             20470001
204800                                                                  20480001
204900             PERFORM 4410-READ-TEMP-STORAGE                       20490001
205000                                                                  20500001
205100             PERFORM 2141-CLEAR-SELECTED-INDS                     20510001
205200                 VARYING ASC-ITEM-SUB                             20520001
205300                 FROM 1 BY 1                                      20530001
205400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20540001
205500                                                                  20550001
205600             PERFORM 5100-WRITE-TEMP-STORAGE                      20560001
205700                                                                  20570001
205800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20580001
205900         END-PERFORM                                              20590001
206000                                                                  20600001
206100         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          20610001
206200         PERFORM 4410-READ-TEMP-STORAGE                           20620001
206300     END-IF.                                                      20630001
206400                                                                  20640001
206500                                                                  20650001
206600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 20660001
206700     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  20670001
206800     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    20680001
206900                                                                  20690001
207000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20700001
207100                                                                  20710001
207200*----------------------------------------------------------------*20720001
207300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *20730001
207400*----------------------------------------------------------------*20740001
207500 2141-CLEAR-SELECTED-INDS.                                        20750001
207600                                                                  20760001
207700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20770001
207800             NOT EQUAL ZERO                                       20780001
207900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20790001
208000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20800001
208100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    20810001
208200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20820001
208300                                   TO TRUE                        20830001
208400         END-IF                                                   20840001
208500     END-IF.                                                      20850001
208600                                                                  20860001
208700*----------------------------------------------------------------*20870001
208800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *20880001
208900*  FOR ALL ITEMS.                                                *20890001
209000*----------------------------------------------------------------*20900001
209100 2150-SELECT-ALL-ITEMS.                                           20910001
209200                                                                  20920001
209300     MOVE +1                       TO ASC-BLK-SUB.                20930001
209400                                                                  20940001
209500     PERFORM 2151-SET-SELECTED-INDS                               20950001
209600         VARYING ASC-ITEM-SUB                                     20960001
209700         FROM 1 BY 1                                              20970001
209800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20980001
209900                                                                  20990001
210000     ADD +1                        TO ASC-BLK-SUB.                21000001
210100                                                                  21010001
210200     PERFORM 2151-SET-SELECTED-INDS                               21020001
210300         VARYING ASC-ITEM-SUB                                     21030001
210400         FROM 1 BY 1                                              21040001
210500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21050001
210600                                                                  21060001
210700     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       21070001
210800                                                                  21080001
210900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21090001
211000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21100001
211100                                                                  21110001
211200     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            21120001
211300         MOVE +1                   TO ASC-BLK-SUB                 21130001
211400                                                                  21140001
211500         PERFORM 5100-WRITE-TEMP-STORAGE                          21150001
211600         MOVE +2                   TO ASC-BLK-SUB                 21160001
211700         PERFORM 5100-WRITE-TEMP-STORAGE                          21170001
211800         MOVE +1                   TO ASC-BLK-SUB                 21180001
211900         MOVE +1                   TO PV-BLOCK-NUMBER             21190001
212000     END-IF.                                                      21200001
212100                                                                  21210001
212200     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            21220001
212300         MOVE +1                   TO ASC-BLK-SUB                 21230001
212400                                                                  21240001
212500         PERFORM 5100-WRITE-TEMP-STORAGE                          21250001
212600         MOVE +2                   TO ASC-BLK-SUB                 21260001
212700         PERFORM 5100-WRITE-TEMP-STORAGE                          21270001
212800         MOVE +1                   TO ASC-BLK-SUB                 21280001
212900         MOVE +1                   TO PV-BLOCK-NUMBER             21290001
213000     END-IF.                                                      21300001
213100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     21310001
213200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    21320001
213300         MOVE +1                   TO ASC-BLK-SUB                 21330001
213400                                                                  21340001
213500         PERFORM 5100-WRITE-TEMP-STORAGE                          21350001
213600         MOVE +2                   TO ASC-BLK-SUB                 21360001
213700         PERFORM 5100-WRITE-TEMP-STORAGE                          21370001
213800         MOVE +1                   TO ASC-BLK-SUB                 21380001
213900         MOVE +1                   TO PV-BLOCK-NUMBER             21390001
214000                                                                  21400001
214100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21410001
214200             PV-FIRST-BLOCK-IN-ARRAY - 1                          21420001
214300                                                                  21430001
214400         PERFORM                                                  21440001
214500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       21450001
214600                                                                  21460001
214700             PERFORM 4410-READ-TEMP-STORAGE                       21470001
214800                                                                  21480001
214900             PERFORM 2151-SET-SELECTED-INDS                       21490001
215000                 VARYING ASC-ITEM-SUB                             21500001
215100                 FROM 1 BY 1                                      21510001
215200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21520001
215300                                                                  21530001
215400             PERFORM 5100-WRITE-TEMP-STORAGE                      21540001
215500                                                                  21550001
215600             ADD +1                TO PV-BLOCK-NUMBER             21560001
215700                                                                  21570001
215800         END-PERFORM                                              21580001
215900                                                                  21590001
216000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21600001
216100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21610001
216200                                                                  21620001
216300         PERFORM                                                  21630001
216400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21640001
216500                   ASC-HIGHEST-BLOCK-WRITTEN                      21650001
216600                                                                  21660001
216700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21670001
216800                                   TO PV-BLOCK-NUMBER             21680001
216900                                                                  21690001
217000             PERFORM 4410-READ-TEMP-STORAGE                       21700001
217100                                                                  21710001
217200             PERFORM 2151-SET-SELECTED-INDS                       21720001
217300                 VARYING ASC-ITEM-SUB                             21730001
217400                 FROM 1 BY 1                                      21740001
217500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21750001
217600                                                                  21760001
217700             PERFORM 5100-WRITE-TEMP-STORAGE                      21770001
217800                                                                  21780001
217900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21790001
218000                                                                  21800001
218100         END-PERFORM                                              21810001
218200                                                                  21820001
218300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21830001
218400                                   TO PV-BLOCK-NUMBER             21840001
218500                                                                  21850001
218600         PERFORM 4410-READ-TEMP-STORAGE                           21860001
218700     END-IF.                                                      21870001
218800                                                                  21880001
218900                                                                  21890001
219000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             21900001
219100                       ASC-NUMBER-OF-SELECTED-ITEMS.              21910001
219200                                                                  21920001
219300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21930001
219400                                                                  21940001
219500*----------------------------------------------------------------*21950001
219600*    MARK EACH ITEM AS BEING SELECTED.                           *21960001
219700*----------------------------------------------------------------*21970001
219800 2151-SET-SELECTED-INDS.                                          21980001
219900                                                                  21990001
220000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           22000001
220100             NOT EQUAL ZERO                                       22010001
220200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             22020001
220300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             22030001
220400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        22040001
220500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  22050001
220600                               TO  TRUE                           22060001
220700         END-IF                                                   22070001
220800     END-IF.                                                      22080001
220900                                                                  22090001
221000******************************************************************22100001
221100** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **22110001
221200** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **22120001
221300******************************************************************22130001
221400 2200-MOVE-SCREEN-TO-COMMAREA.                                    22140001
221500                                                                  22150001
221600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             22160001
221700     MOVE +1                       TO PV-SUB.                     22170001
221800                                                                  22180016
221900     PERFORM 3100-SET-SUBSCRIPTS.                                 22190001
222000     IF  ASTRTITL > ZERO                                          22200001
222100         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          22210001
222200     ELSE                                                         22220001
222300         IF  ASTRTITF = DP015-ERASE-EOF                           22230001
222400             INITIALIZE ASC-START-ITEM-REQUEST                    22240001
222500         END-IF                                                   22250001
222600     END-IF.                                                      22260001
222700                                                                  22270001
222800     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          22280001
222900         VARYING PV-SUB                                           22290001
223000         FROM 1 BY 1                                              22300001
223100         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      22310001
223200******************************************************************22320001
223300** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**22330001
223400******************************************************************22340001
223500 2210-MOVE-LINES-TO-COMMAREA.                                     22350001
223600     IF MR-SELECTL (PV-SUB) > ZERO                                22360001
223700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             22370001
223800         MOVE MR-SELECTI (PV-SUB)   TO ASC-TEMP-SELECTED-SW       22380001
223900                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 22390001
224000     ELSE                                                         22400001
224100         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                22410001
224200                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     22420001
224300                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        22430001
224400                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 22440001
224500         END-IF                                                   22450001
224600     END-IF.                                                      22460001
224700                                                                  22470001
224800     ADD +1                        TO ASC-ITEM-SUB.               22480001
224900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22490001
225000         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     22500001
225100             COMPUTE PV-BLOCK-NUMBER  =                           22510001
225200                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         22520001
225300                    PC-ITEMS-PER-PANEL                            22530001
225400             PERFORM 5105-REWRITE-ASC-LISTQ                       22540001
225500         END-IF                                                   22550001
225600         ADD +1                    TO ASC-BLK-SUB                 22560001
225700         MOVE +1                   TO ASC-ITEM-SUB                22570001
225800     ELSE                                                         22580001
225900     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             22590001
226000         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     22600001
226100             COMPUTE PV-BLOCK-NUMBER  =                           22610001
226200                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         22620001
226300                    PC-ITEMS-PER-PANEL                            22630001
226400             PERFORM 5105-REWRITE-ASC-LISTQ                       22640001
226500         END-IF                                                   22650001
226600     END-IF.                                                      22660001
226700                                                                  22670001
226800                                                                  22680001
227300******************************************************************22730001
227400** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **22740001
227500** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **22750001
227600******************************************************************22760001
227700 3000-EDIT-DATA-IN-COMMAREA.                                      22770001
227800                                                                  22780001
227900     SET PS-NO-ERROR               TO TRUE.                       22790001
228000     PERFORM 3200-RESET-ATTRIBUTES.                               22800001
228100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     22810001
228200                                                                  22820001
228300**                                                                22830001
228400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              22840001
228500* EDITTING IS DONE FROM THE BOTTOM UP.                            22850001
228600**                                                                22860001
228700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       22870001
228800         ASC-ITEMS-DISPLAYED - 1.                                 22880001
228900     PERFORM 3100-SET-SUBSCRIPTS.                                 22890001
229000                                                                  22900016
229100     IF  PS-NO-ERROR                                              22910001
229200         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        22920001
229300     END-IF.                                                      22930001
229400                                                                  22940001
229500     IF  PS-NO-ERROR                                              22950001
229600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        22960001
229700     END-IF.                                                      22970001
229800                                                                  22980016
229900     IF  ((PS-NO-ERROR)                                           22990001
230000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   23000001
230100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    23010001
230200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  23020001
230300     END-IF.                                                      23030001
230400                                                                  23040001
230500*----------------------------------------------------------------*23050001
230600*   3005-EDIT-COMMAREA-BLOCKS                                    *23060001
230700*----------------------------------------------------------------*23070001
230800 3005-EDIT-COMMAREA-BLOCKS.                                       23080001
230900                                                                  23090001
231000     MOVE +1                       TO PV-BLOCK-NUMBER.            23100001
231100     MOVE +1                       TO ASC-BLK-SUB.                23110001
231200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               23120001
231300                                                                  23130001
231400     COMPUTE PV-BLOCK-NUMBER  =                                   23140001
231500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 23150001
231600            PC-ITEMS-PER-PANEL.                                   23160001
231700                                                                  23170001
231800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          23180001
231900                                                                  23190001
232000     PERFORM                                                      23200001
232100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          23210001
232200          OR PS-ERROR                                             23220001
232300          OR PS-BLOCK-ERROR                                       23230001
232400                                                                  23240001
232500             COMPUTE PV-ITEMS-HOLD  =                             23250001
232600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        23260001
232700                     PC-ITEMS-PER-PANEL - 1                       23270001
232800                                                                  23280001
232900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       23290001
233000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               23300001
233100                     FROM  PV-ITEMS-HOLD                          23310001
233200                   GIVING  PV-ITEMS-DIFF                          23320001
233300                 SUBTRACT  PV-ITEMS-DIFF                          23330001
233400                     FROM  PC-ITEMS-PER-PANEL                     23340001
233500                   GIVING  PV-ITEMS-HOLD                          23350001
233600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              23360001
233700                                              ASC-ITEM-SUB        23370001
233800                                              ASC-ITEMS-DISPLAYED 23380001
233900             ELSE                                                 23390001
234000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              23400001
234100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        23410001
234200             END-IF                                               23420001
234300                                                                  23430001
234400             PERFORM 3300-EDIT-SELECTIONS                         23440001
234500                     VARYING PV-SUB                               23450001
234600                        FROM PV-SUB BY -1                         23460001
234700                       UNTIL PV-SUB < +1                          23470001
234800                                                                  23480001
234900             MOVE +1               TO ASC-BLK-SUB                 23490001
235000                                                                  23500001
235100             PERFORM 5105-REWRITE-ASC-LISTQ                       23510001
235200                                                                  23520001
235300             MOVE +1                TO ASC-BLK-SUB                23530001
235400                                                                  23540001
235500             IF  PS-BLOCK-ERROR                                   23550001
235600                 SET  PS-ERROR     TO TRUE                        23560001
235700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        23570001
235800                                   TO PV-TOP-ITEM                 23580001
235900             ELSE                                                 23590001
236000                 ADD  +1           TO PV-BLOCK-NUMBER             23600001
236100                 IF  PV-BLOCK-NUMBER >                            23610001
236200                     ASC-HIGHEST-BLOCK-WRITTEN                    23620001
236300                     MOVE +2       TO ASC-BLK-SUB                 23630001
236400                     PERFORM 4410-READ-TEMP-STORAGE               23640001
236500                     MOVE +1       TO ASC-BLK-SUB                 23650001
236600                 ELSE                                             23660001
236700                     PERFORM 4410-READ-TEMP-STORAGE               23670001
236800                     ADD  +1        TO PV-BLOCK-NUMBER            23680001
236900                     MOVE +2        TO ASC-BLK-SUB                23690001
237000                     PERFORM 4410-READ-TEMP-STORAGE               23700001
237100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            23710001
237200                     MOVE +1        TO ASC-BLK-SUB                23720001
237300                 END-IF                                           23730001
237400             END-IF                                               23740001
237500     END-PERFORM.                                                 23750001
237600                                                                  23760001
237700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            23770001
237800         PS-ERROR                   OR                            23780001
237900         PS-BLOCK-ERROR                                           23790001
238000         CONTINUE                                                 23800001
238100     ELSE                                                         23810001
238200         MOVE +1                 TO PV-BLOCK-NUMBER               23820001
238300         MOVE +1                 TO ASC-BLK-SUB                   23830001
238400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23840001
238500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           23850001
238600         PERFORM 4410-READ-TEMP-STORAGE                           23860001
238700                                                                  23870001
238800         PERFORM                                                  23880001
238900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              23890001
239000              OR PS-ERROR                                         23900001
239100              OR PS-BLOCK-ERROR                                   23910001
239200                                                                  23920001
239300                 COMPUTE PV-ITEMS-HOLD  =                         23930001
239400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    23940001
239500                         PC-ITEMS-PER-PANEL - 1                   23950001
239600                                                                  23960001
239700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     23970001
239800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           23980001
239900                         FROM  PV-ITEMS-HOLD                      23990001
240000                       GIVING  PV-ITEMS-DIFF                      24000001
240100                     SUBTRACT  PV-ITEMS-DIFF                      24010001
240200                         FROM  PC-ITEMS-PER-PANEL                 24020001
240300                       GIVING  PV-ITEMS-HOLD                      24030001
240400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            24040001
240500                                                ASC-ITEM-SUB      24050001
240600                                               ASC-ITEMS-DISPLAYED24060001
240700                 ELSE                                             24070001
240800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          24080001
240900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    24090001
241000                 END-IF                                           24100001
241100                                                                  24110001
241200                 PERFORM 3300-EDIT-SELECTIONS                     24120001
241300                         VARYING PV-SUB                           24130001
241400                            FROM PV-SUB BY -1                     24140001
241500                           UNTIL PV-SUB < +1                      24150001
241600                                                                  24160001
241700                 MOVE +1               TO ASC-BLK-SUB             24170001
241800                                                                  24180001
241900                 PERFORM 5105-REWRITE-ASC-LISTQ                   24190001
242000                                                                  24200001
242100                 MOVE +1                TO ASC-BLK-SUB            24210001
242200                                                                  24220001
242300                 IF  PS-BLOCK-ERROR                               24230001
242400                     SET  PS-ERROR     TO TRUE                    24240001
242500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    24250001
242600                                       TO PV-TOP-ITEM             24260001
242700                 ELSE                                             24270001
242800                     ADD  +1            TO PV-BLOCK-NUMBER        24280001
242900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      24290001
243000                         MOVE +2        TO ASC-BLK-SUB            24300001
243100                         PERFORM 4410-READ-TEMP-STORAGE           24310001
243200                         MOVE +1        TO ASC-BLK-SUB            24320001
243300                     ELSE                                         24330001
243400                         PERFORM 4410-READ-TEMP-STORAGE           24340001
243500                         ADD  +1        TO PV-BLOCK-NUMBER        24350001
243600                         MOVE +2        TO ASC-BLK-SUB            24360001
243700                         PERFORM 4410-READ-TEMP-STORAGE           24370001
243800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        24380001
243900                         MOVE +1        TO ASC-BLK-SUB            24390001
244000                     END-IF                                       24400001
244100                 END-IF                                           24410001
244200     END-PERFORM.                                                 24420001
244300     MOVE +0 TO PV-ITEMS-HOLD.                                    24430001
244400                                                                  24440001
244500*----------------------------------------------------------------*24450001
244600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *24460001
244700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*24470001
244800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *24480001
244900*                                                                *24490001
245000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *24500001
245100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *24510001
245200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *24520001
245300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *24530001
245400*----------------------------------------------------------------*24540001
245500 3100-SET-SUBSCRIPTS.                                             24550001
245600                                                                  24560001
245700     COMPUTE ASC-ITEM-SUB =                                       24570001
245800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        24580001
245900                                                                  24590001
246000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         24600001
246100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24610001
246200         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               24620001
246300     ELSE                                                         24630001
246400         MOVE +1                     TO ASC-BLK-SUB               24640001
246500     END-IF.                                                      24650001
246600******************************************************************24660001
246700** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **24670001
246800******************************************************************24680001
246900 3200-RESET-ATTRIBUTES.                                           24690001
247000                                                                  24700001
247100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   24710001
247200     MOVE DP015-GREEN              TO ASTRTITC.                   24720001
247300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   24730001
247400                                                                  24740001
247500     PERFORM                                                      24750001
247600         VARYING PV-SUB                                           24760001
247700         FROM 1 BY 1                                              24770001
247800         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        24780001
247900             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    24790001
248000             MOVE DP015-GREEN         TO MR-SELECTC (PV-SUB)      24800001
248100             MOVE DP015-UNDERLINE     TO MR-SELECTH (PV-SUB)      24810001
248110             MOVE DP015-BLUE          TO MR-STR-SCANC (PV-SUB)    24811011
248200     END-PERFORM.                                                 24820001
248300                                                                  24830001
248400******************************************************************24840001
248500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **24850001
248600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **24860001
248700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **24870001
248800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **24880001
248900******************************************************************24890001
249000 3300-EDIT-SELECTIONS.                                            24900001
249100                                                                  24910001
249200     EVALUATE TRUE                                                24920001
249300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24930001
249400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         24940001
249500                 CONTINUE                                         24950001
249600         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         24960001
249700             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        24970001
249800                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   24980001
249900                 MOVE ASC-TEMP-SELECTED-SW                        24990001
250000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25000001
250100                                TO ASC-SELECTED-SW                25010001
250200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25020001
250300             END-IF                                               25030001
250400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     25040001
250500                 = SPACE                                          25050001
250600             EVALUATE TRUE                                        25060001
250700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       25070001
250800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS25080001
250900                     MOVE SPACE TO ASC-SELECTED-SW                25090001
251000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25100001
251100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        25110001
251200                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    25120001
251300                     MOVE SPACE TO ASC-SELECTED-SW                25130001
251400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25140001
251500                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          25150001
251600                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      25160001
251700                     MOVE SPACE TO ASC-SELECTED-SW                25170001
251800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25180001
251900             END-EVALUATE                                         25190001
252000         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           25200001
252100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            25210001
252200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    25220001
252300             END-IF                                               25230001
252400             PERFORM 3310-EDIT-RANGE                              25240001
252500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             25250001
252600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            25260001
252700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    25270001
252800             END-IF                                               25280001
252900             PERFORM 3310-EDIT-RANGE                              25290001
253000         WHEN OTHER                                               25300001
253100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           25310001
253200             SET DP020-MSG-FATAL    TO TRUE                       25320001
253300             MOVE -1                TO ASTRTITL                   25330001
253400             SET DP030-SET-CURSOR-APPL-1                          25340001
253500                                    TO TRUE                       25350001
253600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        25360001
253700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        25370001
253800             SET PS-ERROR TO TRUE                                 25380001
253900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            25390001
254000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     25400001
254100                 MOVE SPACE         TO ASC-SELECTED-SW            25410001
254200                                        (ASC-BLK-SUB ASC-ITEM-SUB)25420001
254300             END-IF                                               25430001
254400     END-EVALUATE.                                                25440001
254500                                                                  25450001
254600     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 25460001
254700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               25470001
254800     IF  ASC-ITEM-SUB < 1                                         25480001
254900         SUBTRACT +1 FROM ASC-BLK-SUB                             25490001
255000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                25500001
255100     END-IF.                                                      25510001
255200                                                                  25520001
255300******************************************************************25530001
255400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **25540001
255500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **25550001
255600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**25560001
255700** THE ENDING.                                                  **25570001
255800******************************************************************25580001
255900 3310-EDIT-RANGE.                                                 25590001
256000                                                                  25600001
256100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                25610001
256200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   25620001
256300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)25630001
256400                                   TO ASC-SELECTED-SW             25640001
256500                                        (ASC-BLK-SUB ASC-ITEM-SUB)25650001
256600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 25660001
256700         ELSE                                                     25670001
256800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     25680001
256900                 CONTINUE                                         25690001
257000             ELSE                                                 25700001
257100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        25710001
257200                 MOVE PC-TSYMSG-00054                             25720001
257300                                       TO DP020-MSG-NUMBER        25730001
257400                 MOVE -1               TO ASTRTITL                25740001
257500                 SET DP020-MSG-FATAL                              25750001
257600                     DP030-SET-CURSOR-APPL-1                      25760001
257700                     PS-ERROR          TO TRUE                    25770001
257800             END-IF                                               25780001
257900         END-IF                                                   25790001
258000     ELSE                                                         25800001
258100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25810001
258200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25820001
258300                                   TO ASC-SELECTED-SW             25830001
258400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25840001
258500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   25850001
258600         ELSE                                                     25860001
258700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25870001
258800                 CONTINUE                                         25880001
258900             ELSE                                                 25890001
259000*                -- ONLY ONE END-OF-RANGE ALLOWED --              25900001
259100                 MOVE PC-TSYMSG-00055                             25910001
259200                                        TO DP020-MSG-NUMBER       25920001
259300                 MOVE -1                TO ASTRTITL               25930001
259400                 SET DP020-MSG-FATAL                              25940001
259500                     DP030-SET-CURSOR-APPL-1                      25950001
259600                     PS-ERROR           TO TRUE                   25960001
259700             END-IF                                               25970001
259800         END-IF                                                   25980001
259900     END-IF.                                                      25990001
260000                                                                  26000017
260100******************************************************************26010001
260200** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **26020001
260300** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **26030001
260400******************************************************************26040001
260500 3400-CHECK-RANGE-SEQUENCE.                                       26050001
260600                                                                  26060001
260700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       26070001
260800       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      26080001
260900       AND  ASC-START-OF-SELECTED-RANGE >                         26090001
261000                                         ASC-END-OF-SELECTED-RANGE26100001
261100*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                26110001
261200         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 26120001
261300         SET DP020-MSG-FATAL TO TRUE                              26130001
261400         SET PS-ERROR TO TRUE                                     26140001
261500         PERFORM 3410-POSITION-AT-ERROR                           26150001
261600     END-IF.                                                      26160001
261700******************************************************************26170001
261800** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **26180001
261900** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **26190001
262000** SHOULD BE POSITIONED ON A RANGE ERROR.                       **26200001
262100******************************************************************26210001
262200 3410-POSITION-AT-ERROR.                                          26220001
262300                                                                  26230001
262400     SET DP030-SET-CURSOR-APPL-1                                  26240001
262500                                   TO TRUE.                       26250001
262600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 26260001
262700                    - PV-TOP-ITEM + 1.                            26270001
262800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26280001
262900         CONTINUE                                                 26290001
263000     ELSE                                                         26300001
263100         MOVE -1                   TO MR-SELECTL (PV-SUB)         26310001
263200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26320001
263300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         26330001
263400     END-IF.                                                      26340001
263500                                                                  26350016
263600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   26360001
263700                    - PV-TOP-ITEM + 1.                            26370001
263800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26380001
263900         CONTINUE                                                 26390001
264000     ELSE                                                         26400001
264100         MOVE -1                   TO MR-SELECTL (PV-SUB)         26410001
264200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26420001
264300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         26430001
264400     END-IF.                                                      26440001
264500                                                                  26450001
264600*----------------------------------------------------------------*26460001
264700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *26470001
264800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *26480001
264900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *26490001
265000*----------------------------------------------------------------*26500001
265100 3500-MARK-RANGE-AS-SELECTED.                                     26510001
265200                                                                  26520001
265300     MOVE +1                       TO  ASC-BLK-SUB.               26530001
265400     PERFORM 3510-MARK-SELECTED-INDS                              26540001
265500         VARYING ASC-ITEM-SUB                                     26550001
265600         FROM 1 BY 1                                              26560001
265700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26570001
265800                                                                  26580001
265900     ADD +1                        TO ASC-BLK-SUB.                26590001
266000     PERFORM 3510-MARK-SELECTED-INDS                              26600001
266100         VARYING ASC-ITEM-SUB                                     26610001
266200         FROM 1 BY 1                                              26620001
266300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26630001
266400                                                                  26640001
266500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26650001
266600                                   TO  PV-LIST-ITEM-NUMBER.       26660001
266700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26670001
266800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         26680001
266900               PC-ITEMS-PER-PANEL).                               26690001
267000                                                                  26700001
267100     MOVE ASC-START-OF-SELECTED-RANGE                             26710001
267200                                   TO PV-START-OF-SELECTED-RANGE. 26720001
267300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            26730001
267400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  26740001
267500               PC-ITEMS-PER-PANEL).                               26750001
267600                                                                  26760001
267700     MOVE ASC-END-OF-SELECTED-RANGE                               26770001
267800                                   TO  PV-END-OF-SELECTED-RANGE.  26780001
267900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26790001
268000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26800001
268100               PC-ITEMS-PER-PANEL).                               26810001
268200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26820001
268300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26830001
268400                                                                  26840001
268500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26850001
268600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26860001
268700         MOVE +1                   TO ASC-BLK-SUB                 26870001
268800         PERFORM 5100-WRITE-TEMP-STORAGE                          26880001
268900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26890001
269000             PV-FIRST-BLOCK-IN-ARRAY - 1                          26900001
269100                                                                  26910001
269200         PERFORM                                                  26920001
269300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26930001
269400                   PV-PREV-BLOCK-IN-ARRAY                         26940001
269500             MOVE PV-FIRST-BLOCK-IN-RANGE                         26950001
269600                                   TO PV-BLOCK-NUMBER             26960001
269700             PERFORM 4410-READ-TEMP-STORAGE                       26970001
269800             PERFORM 3510-MARK-SELECTED-INDS                      26980001
269900                 VARYING ASC-ITEM-SUB                             26990001
270000                 FROM 1 BY 1                                      27000001
270100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27010001
270200             PERFORM 5100-WRITE-TEMP-STORAGE                      27020001
270300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     27030001
270400         END-PERFORM                                              27040001
270500                                                                  27050001
270600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         27060001
270700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     27070001
270800         PERFORM                                                  27080001
270900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       27090001
271000                   PV-LAST-BLOCK-IN-RANGE                         27100001
271100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          27110001
271200                                   TO PV-BLOCK-NUMBER             27120001
271300             PERFORM 4410-READ-TEMP-STORAGE                       27130001
271400             PERFORM 3510-MARK-SELECTED-INDS                      27140001
271500                 VARYING ASC-ITEM-SUB                             27150001
271600                 FROM 1 BY 1                                      27160001
271700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27170001
271800             PERFORM 5100-WRITE-TEMP-STORAGE                      27180001
271900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      27190001
272000         END-PERFORM                                              27200001
272100                                                                  27210001
272200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             27220001
272300                                   TO PV-BLOCK-NUMBER             27230001
272400         PERFORM 4410-READ-TEMP-STORAGE                           27240001
272500     END-IF.                                                      27250001
272600                                                                  27260001
272700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 27270001
272800                                      ASC-END-OF-SELECTED-RANGE.  27280001
272900                                                                  27290001
273000*----------------------------------------------------------------*27300001
273100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *27310001
273200*----------------------------------------------------------------*27320001
273300 3510-MARK-SELECTED-INDS.                                         27330001
273400                                                                  27340001
273500     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         27350001
273600                                ASC-ITEM-SUB) >                   27360001
273700         ASC-START-OF-SELECTED-RANGE)                             27370001
273800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         27380001
273900                                ASC-ITEM-SUB) =                   27390001
274000         ASC-START-OF-SELECTED-RANGE)                             27400001
274100                                                                  27410001
274200         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     27420001
274300                                    ASC-ITEM-SUB) <               27430001
274400             ASC-END-OF-SELECTED-RANGE)                           27440001
274500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     27450001
274600                                    ASC-ITEM-SUB) =               27460001
274700             ASC-END-OF-SELECTED-RANGE)                           27470001
274800                                                                  27480001
274900             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27490001
275000                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   27500001
275100                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   27510001
275200                               TO TRUE                            27520001
275300                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              27530001
275400                               TO TRUE                            27540001
275500                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    27550001
275600             END-IF                                               27560001
275700         END-IF                                                   27570001
275800     END-IF.                                                      27580001
275900                                                                  27590001
276000*----------------------------------------------------------------*27600001
276100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27610001
276200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27620001
276300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27630001
276400*    DISPLAY THE PANEL TO USER.                                  *27640001
276500*----------------------------------------------------------------*27650001
276600 4000-BUILD-INITIAL-PANEL.                                        27660001
276700                                                                  27670001
276800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            27680001
276900                                 ASC-BLOCK-ENTRIES (2).           27690001
277000     MOVE +1                 TO ASC-BLK-SUB.                      27700001
277100     SET ASC-ITEMS-LEFT-ON-DB                                     27710001
277200                             TO TRUE.                             27720001
277300                                                                  27730001
277400     MOVE +0                 TO ASC-ITEM-SUB                      27740001
277500                                ASC-NUMBER-OF-ITEMS-READ          27750001
277600                                ASC-NUMBER-OF-SELECTED-ITEMS      27760001
277700                                ASC-HIGHEST-BLOCK-WRITTEN         27770001
277800                                ASC-START-OF-SELECTED-RANGE       27780001
277900                                ASC-END-OF-SELECTED-RANGE         27790001
278000                                ASC-ITEM-AT-TOP-OF-PANEL.         27800001
278100                                                                  27810001
278200*----------------------------------------------------------------*27820001
278300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27830001
278400*    DISPLAY THE PANEL TO USER.                                  *27840001
278500*----------------------------------------------------------------*27850001
278600                                                                  27860001
278800     IF ASC-CS-PULL-TRAN                                          27880001
278900         MOVE ASC-PO-NBR              TO DK-PO-NBR                27890001
279000         MOVE ZEROES                  TO DK-REC-SEQ-NBR           27900001
279100         MOVE ASC-PO-NBR              TO PV-PULL-NBR-N            27910001
279200         MOVE PV-PULL-NBR-X           TO PV-PULL                  27920001
279300         MOVE '-CS'                   TO PV-TRAN                  27930001
279400         MOVE PV-PULL-NBR             TO ASC-PO-RCVR              27940001
279500         MOVE 'CS'                    TO DK-TRN-TYP-CDE           27950001
279600     ELSE                                                         27960001
279800                                                                  27980001
280000     IF ASC-FX-FAST-TRAN                                          28000001
280100         MOVE ASC-PO-NBR              TO DK-PO-NBR                28010001
280200         MOVE ZEROES                  TO DK-REC-SEQ-NBR           28020001
280300         MOVE ASC-PO-NBR              TO PV-FX-FAST-NO            28030001
280400         MOVE ASC-STR-NBR             TO PV-FX-STORE              28040001
280500         MOVE ASC-STR-NBR             TO PV-FX-STORE-EDIT         28050001
280600         MOVE ASC-PO-NBR              TO PV-FX-FAST-NO-EDIT       28060001
280700         MOVE '-'                     TO PV-FX-DASH               28070001
280800         MOVE PV-FX-FAST-EDIT         TO ASC-PO-RCVR              28080001
280900         MOVE 'FX'                    TO DK-TRN-TYP-CDE           28090001
281000     ELSE                                                         28100001
281100         MOVE 'PO'                        TO DK-TRN-TYP-CDE       28110001
281300                                                                  28130001
281400         IF  ASC-PO-RCVR > ZEROES                                 28140001
281500             MOVE ASC-PO-RCVR       TO DK-PO-RCVR                 28150001
281600             MOVE DK-PO             TO DK-PO-NBR                  28160001
281700             MOVE DK-RCVR           TO DK-REC-SEQ-NBR             28170001
281800         ELSE                                                     28180001
281900             MOVE ASC-PO-NBR        TO DK-PO-NBR                  28190001
282000             MOVE ASC-RCVR-NBR      TO DK-REC-SEQ-NBR             28200001
282100             MOVE ASC-PO-NBR        TO DK-PO-TRN-NBR              28210001
282200             MOVE DK-TRN-NBR-X      TO DK-TRN-NBR-9               28220001
282300             MOVE DK-TRN-NBR-8      TO DK-PO                      28230001
282400             MOVE ASC-RCVR-NBR      TO DK-PO-RCVR-NBR-N           28240001
282500             MOVE DK-RCVR-NBR-X     TO DK-RCVR-NBR-9              28250001
282600             MOVE DK-RCVR-NBR-3     TO DK-RCVR                    28260001
282700             MOVE DK-PO-RCVR        TO ASC-PO-RCVR                28270001
282900         END-IF                                                   28290001
283000     END-IF                                                       28300001
283100     END-IF.                                                      28310001
283200                                                                  28320001
283300     IF ASC-LINE-NBR  > ZERO                                      28330001
283400         MOVE ASC-LINE-NBR        TO DK-LINE-BEGIN                28340001
283500                                     DK-LINE-END                  28350001
283600     ELSE                                                         28360001
283700         MOVE DK-DEFAULT-BEGIN    TO DK-LINE-BEGIN                28370001
283800         MOVE DK-DEFAULT-END-LINE TO DK-LINE-END                  28380001
283900     END-IF.                                                      28390001
284000     IF ASC-STR-NBR > ZERO                                        28400001
284100         MOVE ASC-STR-NBR       TO DK-STR-BEGIN                   28410001
284200                                   DK-STR-END                     28420001
284300     ELSE                                                         28430001
284400         MOVE DK-DEFAULT-BEGIN   TO DK-STR-BEGIN                  28440001
284500         MOVE DK-DEFAULT-END-STR TO DK-STR-END                    28450001
284600     END-IF.                                                      28460001
284700                                                                  28470001
285000     IF ASC-CS-PULL-TRAN                                          28500001
285100         PERFORM 8150-PREPARE-HEADINGS                            28510001
285200     ELSE                                                         28520001
285300     IF ASC-FX-FAST-TRAN                                          28530001
285400         PERFORM 8330-PREPARE-FX-HEADINGS                         28540001
285500     ELSE                                                         28550001
285600         PERFORM 4100-PREPARE-HEADINGS                            28560001
285700     END-IF.                                                      28570001
285900                                                                  28590001
286000     IF  ASC-CS-PULL-TRAN                                         28600001
286100         MOVE DK-DEFAULT-BEGIN   TO DK-DC-BEGIN                   28610001
286200         MOVE DK-DEFAULT-END-STR TO DK-DC-END                     28620001
286300     ELSE                                                         28630001
286400     IF ASC-DC-ID > ZERO                                          28640001
286500         MOVE ASC-DC-ID          TO DK-DC-BEGIN                   28650001
286600                                    DK-DC-END                     28660001
286700     ELSE                                                         28670001
286800         MOVE DK-DEFAULT-BEGIN   TO DK-DC-BEGIN                   28680001
286900         MOVE DK-DEFAULT-END-STR TO DK-DC-END                     28690001
287000     END-IF                                                       28700001
287100     END-IF.                                                      28710001
287400                                                                  28740001
287500     IF ASC-FX-FAST-TRAN                                          28750001
287600         MOVE  ASC-PO-NBR-10     TO DK-PO-NBR-COMP10              28760001
287700         MOVE  DK-PO-NBR-COMP10  TO DK-PO-NBR                     28770001
287800         PERFORM 8300-OPEN-FX-CURSOR                              28780001
287900         PERFORM 4300-READ-ITEMS-FROM-DB                          28790001
288000         PERFORM 8310-CLOSE-FX-CURSOR                             28800001
288100                                                                  28810001
288200     ELSE                                                         28820001
288300         PERFORM 4010-OPEN-CURSOR                                 28830001
288400         PERFORM 4300-READ-ITEMS-FROM-DB                          28840001
288500         PERFORM 4020-CLOSE-CURSOR                                28850001
288600     END-IF.                                                      28860001
288700                                                                  28870001
288800     SET ASC-ALL-CRTNS             TO TRUE.                       28880001
288900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-TOT-CRTNS.              28890001
289000     COMPUTE ASC-UNTS-VARI = ASC-UNTS-MNFD - ASC-UNTS-VRFD.       28900001
289100                                                                  28910001
289200     MOVE +1                   TO  PV-TOP-ITEM.                   28920001
289300                                                                  28930001
289400*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        28940001
289500*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   28950001
289600*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      28960001
289700*    THE ORIGINAL SCREEN.                                         28970001
289800     EVALUATE TRUE                                                28980001
289900         WHEN SU010-SELECTED-ITEMS > 1                            28990001
290000             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  29000001
290100                 SET DP020-MSG-WARNING TO  TRUE                   29010001
290200                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       29020001
290300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29030001
290400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             29040001
290500             ELSE                                                 29050001
290600                 MOVE -1               TO MR-SELECTL (1)          29060001
290700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29070001
290800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             29080001
290900             END-IF                                               29090001
291000         WHEN OTHER                                               29100001
291100             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  29110001
291200                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            29120001
291300                 SET DP020-MSG-FATAL   TO  TRUE                   29130001
291400                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       29140001
291500             ELSE                                                 29150001
291600                 MOVE -1               TO MR-SELECTL (1)          29160001
291700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29170001
291800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             29180001
291900             END-IF                                               29190001
292000     END-EVALUATE.                                                29200001
292100                                                                  29210001
292200*----------------------------------------------------------------*29220001
292300* OPEN THE CURSOR                                                 29230001
292400*----------------------------------------------------------------*29240001
292500 4010-OPEN-CURSOR.                                                29250001
292600     PERFORM                                                      29260001
292700         WITH TEST AFTER                                          29270001
292800         VARYING PV-RETRY-COUNTER                                 29280001
292900         FROM 1 BY 1                                              29290001
293000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29300001
293100                   OR (SQLCODE = ZERO))                           29310001
293200                                                                  29320001
293300         EXEC SQL                                                 29330001
293400              OPEN CARTON-CSR                                     29340001
293500         END-EXEC                                                 29350001
293600                                                                  29360001
293700         EVALUATE TRUE                                            29370001
293800             WHEN SQLCODE = ZERO                                  29380001
293900             WHEN SQLCODE = -904                                  29390001
294000             WHEN SQLCODE = -913                                  29400001
294100                 CONTINUE                                         29410001
294200             WHEN SQLWARN0 NOT = SPACES                           29420001
294300             WHEN SQLCODE < ZERO                                  29430001
294400             WHEN SQLCODE > ZERO                                  29440001
294500                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       29450001
294600                 MOVE 'OPEN CURSOR PROBLEM    - '                 29460001
294700                                   TO DP013-MESSAGE-TEXT (1)      29470001
294800                 MOVE SQLCA        TO DP013-SQLCA                 29480001
294900                 MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)    29490001
295000                 SET DP013-DB2-ABEND                              29500001
295100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           29510001
295200                 PERFORM DP013-0000-PROCESS-ABEND                 29520001
295300         END-EVALUATE                                             29530001
295400     END-PERFORM.                                                 29540001
295500                                                                  29550017
295600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29560001
295700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             29570001
295800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   29580001
295900                                   TO DP013-MESSAGE-TEXT (1)      29590001
296000         MOVE SQLCA                TO DP013-SQLCA                 29600001
296100         MOVE 'SUT00028'           TO DP013-DB2-TABLE-NAME (1)    29610001
296200         SET DP013-DB2-ABEND                                      29620001
296300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   29630001
296400         PERFORM DP013-0000-PROCESS-ABEND                         29640001
296500     END-IF.                                                      29650001
296600                                                                  29660001
296700*----------------------------------------------------------------*29670001
296800* CLOSE THE CURSOR.                                               29680001
296900*----------------------------------------------------------------*29690001
297000 4020-CLOSE-CURSOR.                                               29700001
297100                                                                  29710001
297200     EXEC SQL                                                     29720001
297300          CLOSE CARTON-CSR                                        29730001
297400     END-EXEC.                                                    29740001
297500                                                                  29750001
297600     EVALUATE TRUE                                                29760001
297700         WHEN SQLCODE = ZERO                                      29770001
297800         WHEN SQLCODE = +100                                      29780001
297900             CONTINUE                                             29790001
298000         WHEN SQLWARN0 NOT = SPACES                               29800001
298100         WHEN SQLCODE < ZERO                                      29810001
298200         WHEN SQLCODE > ZERO                                      29820001
298300             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          29830001
298400             MOVE 'CLOSE CURSOR PROBLEM   '                       29840001
298500                               TO DP013-MESSAGE-TEXT (1)          29850001
298600             MOVE SQLCA        TO DP013-SQLCA                     29860001
298700             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        29870001
298800             SET DP013-DB2-ABEND                                  29880001
298900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29890001
299000             PERFORM DP013-0000-PROCESS-ABEND                     29900001
299100     END-EVALUATE.                                                29910001
299200                                                                  29920001
299300*----------------------------------------------------------------*29930001
299400*    FILL IN TOP PART OF SCREEN                                   29940001
299500*----------------------------------------------------------------*29950001
299600 4100-PREPARE-HEADINGS.                                           29960001
299700     PERFORM 4110-GET-TRECEIV-INFO.                               29970001
299800     MOVE ASC-CURR-OPER-UNT-ID TO ASC-OPER-UNT-ID.                29980001
299900     IF ASC-PACK-BY-ST-IND = 'Y'                                  29990001
300000         MOVE  'PBS   '         TO ASC-PACKAGE                    30000001
300100     ELSE                                                         30010001
300200         IF ASC-DSP-INNER-PREPK                                   30020001
300300             MOVE  PC-INNER-PREPACK TO ASC-PACKAGE                30030001
300400         ELSE                                                     30040001
300500             IF ASC-DSP-MULTI-SKU-PREPK                           30050001
300600                 MOVE  PC-MULTI-SKU     TO ASC-PACKAGE            30060001
300700             ELSE                                                 30070001
300800                 IF ASC-DSP-SINGLE-SKU-PREPK                      30080001
300900                     MOVE  PC-SINGLE-SKU    TO ASC-PACKAGE        30090001
301000                 ELSE                                             30100001
301100                     IF ASC-DSP-CASEPACK                          30110001
301200                         MOVE  PC-CASEPACK  TO ASC-PACKAGE        30120001
301300                     ELSE                                         30130001
301400                         IF ASC-DSP-BULK-PACK                     30140001
301500                             MOVE  PC-BULK  TO ASC-PACKAGE        30150001
301600                         END-IF                                   30160001
301700                     END-IF                                       30170001
301800                 END-IF                                           30180001
301900             END-IF                                               30190001
302000         END-IF                                                   30200001
302100     END-IF.                                                      30210001
302200     MOVE 'ALL CARTONS  '     TO ACTNSTSO.                        30220001
302300     MOVE 'N' TO PS-VRFD-UNTS-SW.                                 30230001
302400     MOVE ZEROES  TO ASC-UNTS-VRFD.                               30240001
302500     PERFORM 4200-OPEN-VRFD-UNTS-CSR.                             30250001
302600     PERFORM 4210-FETCH-VRFD-UNTS-CSR                             30260001
302700            UNTIL PS-END-OF-VRFD-UNTS-CSR.                        30270001
302800     PERFORM 4220-CLOSE-VRFD-UNTS-CSR.                            30280001
302900                                                                  30290001
303000*----------------------------------------------------------------*30300001
303100* RETRIEVE INFO FROM TRECEIV                                      30310001
303200*----------------------------------------------------------------*30320001
303300 4110-GET-TRECEIV-INFO.                                           30330001
303400     EXEC SQL                                                     30340001
303500          SELECT A.PACK_BY_ST_IND                                 30350001
303600                ,A.CURR_OPER_UNT_ID                               30360001
303700                ,A.PKGNG_CDE                                      30370001
303800          INTO  :RECEIV-PACK-BY-ST-IND                            30380001
303900               ,:RECEIV-CURR-OPER-UNT-ID                          30390001
304000               ,:RECEIV-PKGNG-CDE                                 30400001
304100           FROM  TRECEIV A                                        30410001
304200          WHERE  A.ORD_NBR        =  :DK-PO-NBR                   30420001
304300            AND  A.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR              30430001
304400            AND  A.VER_STATUS_CDE =  'A'                          30440001
304500     END-EXEC.                                                    30450001
304600     EVALUATE TRUE                                                30460001
304700         WHEN SQLCODE = ZERO                                      30470001
304800             MOVE RECEIV-PACK-BY-ST-IND   TO ASC-PACK-BY-ST-IND   30480001
304900             MOVE RECEIV-CURR-OPER-UNT-ID TO ASC-CURR-OPER-UNT-ID 30490001
305000             MOVE RECEIV-PKGNG-CDE        TO ASC-DSPLY-PKGNG-CD   30500001
305100         WHEN SQLCODE = +100                                      30510001
305200             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                30520001
305300             SET DP020-MSG-FATAL   TO  TRUE                       30530001
305400             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           30540001
305500         WHEN SQLWARN0 NOT = SPACE                                30550001
305600         WHEN SQLCODE NOT = ZERO                                  30560001
305700              MOVE '4110-GET-TRECEIV-INFO ' TO DP013-PARAGRAPH    30570001
305800              MOVE 'GET TRECEIV INFO '                            30580001
305900                               TO DP013-MESSAGE-TEXT (1)          30590001
306000              MOVE SQLCA       TO DP013-SQLCA                     30600001
306100              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)       30610001
306200              SET DP013-DB2-ABEND TO TRUE                         30620001
306300              PERFORM DP013-0000-PROCESS-ABEND                    30630001
306400     END-EVALUATE.                                                30640001
306500                                                                  30650001
306600*----------------------------------------------------------------*30660001
306700* OPEN THE VERIFIED UNITS CURSOR                                  30670001
306800*----------------------------------------------------------------*30680001
306900 4200-OPEN-VRFD-UNTS-CSR.                                         30690001
307000     EXEC SQL                                                     30700001
307100          OPEN VRFD-UNTS-CSR                                      30710001
307200     END-EXEC.                                                    30720001
307300                                                                  30730001
307400     EVALUATE TRUE                                                30740001
307500         WHEN SQLCODE = ZERO                                      30750001
307600         WHEN SQLCODE = -904                                      30760001
307700         WHEN SQLCODE = -913                                      30770001
307800             CONTINUE                                             30780001
307900         WHEN SQLWARN0 NOT = SPACES                               30790001
308000         WHEN SQLCODE < ZERO                                      30800001
308100         WHEN SQLCODE > ZERO                                      30810001
308200             MOVE '4200-OPEN-VRFD-UNTS' TO DP013-PARAGRAPH        30820001
308300             MOVE 'OPEN CURSOR PROBLEM    - '                     30830001
308400                                   TO DP013-MESSAGE-TEXT (1)      30840001
308500             MOVE SQLCA        TO DP013-SQLCA                     30850001
308600             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        30860001
308700             SET DP013-DB2-ABEND                                  30870001
308800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30880001
308900             PERFORM DP013-0000-PROCESS-ABEND                     30890001
309000     END-EVALUATE.                                                30900001
309100                                                                  30910001
309200*----------------------------------------------------------------*30920001
309300* FETCH VERIFIED UNITS CURSOR                                     30930001
309400*----------------------------------------------------------------*30940001
309500 4210-FETCH-VRFD-UNTS-CSR.                                        30950001
309600     EXEC SQL                                                     30960001
309700      FETCH  VRFD-UNTS-CSR                                        30970001
309800       INTO   :RECDIS-VERIFY-ITM-QTY                              30980001
309900             ,:RECDIS-AP-VERIFY-ITM-QTY                           30990001
310000             ,:RECITM-STATUS-CDE                                  31000001
310100     END-EXEC.                                                    31010001
310200                                                                  31020001
310300     EVALUATE TRUE                                                31030001
310400         WHEN SQLCODE = ZERO                                      31040001
310500             MOVE RECITM-STATUS-CDE TO ASC-LINE-STAT              31050001
310600             IF RECITM-STATUS-CDE = 'VE'                          31060001
310700                 ADD RECDIS-AP-VERIFY-ITM-QTY TO ASC-UNTS-VRFD    31070001
310800             ELSE                                                 31080001
310900                 ADD RECDIS-VERIFY-ITM-QTY TO  ASC-UNTS-VRFD      31090001
311000             END-IF                                               31100001
311100         WHEN SQLCODE = +100                                      31110001
311200             SET PS-END-OF-VRFD-UNTS-CSR TO TRUE                  31120001
311300         WHEN SQLWARN0 NOT = SPACE                                31130001
311400         WHEN SQLCODE NOT = ZERO                                  31140001
311500              MOVE '4210-FETCH-VRFD-UNTS' TO DP013-PARAGRAPH      31150001
311600              MOVE 'GET TRECITM INFO '                            31160001
311700                               TO DP013-MESSAGE-TEXT (1)          31170001
311800              MOVE SQLCA       TO DP013-SQLCA                     31180001
311900              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)       31190001
312000              SET DP013-DB2-ABEND TO TRUE                         31200001
312100              PERFORM DP013-0000-PROCESS-ABEND                    31210001
312200     END-EVALUATE.                                                31220001
312300                                                                  31230001
312400*----------------------------------------------------------------*31240001
312500* CLOSE THE VERIFIED UNITS CURSOR.                                31250001
312600*----------------------------------------------------------------*31260001
312700 4220-CLOSE-VRFD-UNTS-CSR.                                        31270001
312800                                                                  31280001
312900     EXEC SQL                                                     31290001
313000          CLOSE VRFD-UNTS-CSR                                     31300001
313100     END-EXEC.                                                    31310001
313200                                                                  31320001
313300     EVALUATE TRUE                                                31330001
313400         WHEN SQLCODE = ZERO                                      31340001
313500         WHEN SQLCODE = +100                                      31350001
313600             CONTINUE                                             31360001
313700         WHEN SQLWARN0 NOT = SPACES                               31370001
313800         WHEN SQLCODE < ZERO                                      31380001
313900         WHEN SQLCODE > ZERO                                      31390001
314000             MOVE '4220-CLOSE-VRFD-UNTS' TO DP013-PARAGRAPH       31400001
314100             MOVE 'CLOSE CURSOR PROBLEM   '                       31410001
314200                               TO DP013-MESSAGE-TEXT (1)          31420001
314300             MOVE SQLCA        TO DP013-SQLCA                     31430001
314400             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        31440001
314500             SET DP013-DB2-ABEND                                  31450001
314600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31460001
314700             PERFORM DP013-0000-PROCESS-ABEND                     31470001
314800     END-EVALUATE.                                                31480001
314900                                                                  31490001
315000*----------------------------------------------------------------*31500001
315100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *31510001
315200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *31520001
315300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *31530001
315400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *31540001
315500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *31550001
315600*                                                                *31560001
315700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *31570001
315800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *31580001
315900*    UPON INITIALIZATION.                                        *31590001
316000*----------------------------------------------------------------*31600001
316100 4300-READ-ITEMS-FROM-DB.                                         31610001
316200                                                                  31620001
316300     PERFORM                                                      31630001
316400         VARYING PV-READ-COUNT                                    31640001
316500         FROM 1 BY 1                                              31650001
316600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    31660001
316700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         31670001
316800                                                                  31680001
316900         IF ASC-FX-FAST-TRAN                                      31690001
317000             PERFORM 8320-FETCH-FX-CURSOR                         31700001
317100         ELSE                                                     31710001
317200             PERFORM 4310-FETCH                                   31720001
317300         END-IF                                                   31730001
317400                                                                  31740001
317500         IF  ASC-ITEMS-LEFT-ON-DB                                 31750001
317600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                31760001
317700                 ADD +1            TO ASC-ITEM-SUB                31770001
317800             ELSE                                                 31780001
317900                 ADD +1            TO ASC-BLK-SUB                 31790001
318000                 MOVE +1           TO ASC-ITEM-SUB                31800001
318100                                                                  31810001
318200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         31820001
318300                     MOVE +1       TO ASC-BLK-SUB                 31830001
318400                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           31840001
318500                     PERFORM 5100-WRITE-TEMP-STORAGE              31850001
318600                     MOVE ASC-BLOCK-ENTRIES                       31860001
318700                                   (PC-MAX-BLOCKS-IN-ARRAY)       31870001
318800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 31880001
318900                     ADD +1        TO ASC-BLK-SUB                 31890001
319000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   31900001
319100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      31910001
319200                                                          TO TRUE 31920001
319300                 END-IF                                           31930001
319400             END-IF                                               31940001
319500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    31950001
319600             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          31960001
319700             MOVE ASC-NUMBER-OF-ITEMS-READ                        31970001
319800                                   TO ASC-LIST-ITEM-NUMBER        31980001
319900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31990001
320000             MOVE SPACES TO ASC-ACTION                            32000001
320100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  32010001
320200             PERFORM 4350-CARTON-INFO                             32020001
320300             IF PS-NO-ERROR                                       32030001
320400                 MOVE PC046-KOHLS-BARCODE                         32040001
320500                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 32050001
320600                 MOVE PC046-DEST-OPER-UNT-ID TO                   32060001
320700                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 32070001
320800                          DK-STR-BEGIN                            32080001
320900                          DK-STR-END                              32090001
321000                 MOVE PC046-SHPUNT-SRC-ID                         32100001
321100                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 32110001
321200                 MOVE PC046-CRTN-STAT-TMST   TO PV-TMST           32120001
321300                 PERFORM 4300A-FORMAT-DATE-TIME                   32130001
321400                 STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)         32140001
321500                     DELIMITED BY SIZE                            32150001
321600                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 32160001
321700                 MOVE PV-JIS-TIME                                 32170001
321800                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 32180001
321900                 MOVE PC046-VENDOR-SHIPT-UNT-ID  TO               32190001
322000                                                DK-SHIPT-UNT-ID   32200001
322100                 IF (SUT00024-PRNT-CART-ID  =  DK-SHIPT-UNT-ID AND32210001
322200                     SUT00024-MSTR-CART-IND NOT = 'Y') OR         32220001
322300                    SUT00024-PRNT-CART-ID  =  0                   32230001
322400                     MOVE SPACES                                  32240001
322500                          TO ASC-MASTER (ASC-BLK-SUB ASC-ITEM-SUB)32250001
322600                 ELSE                                             32260001
322700                     IF SUT00024-MSTR-CART-IND  = 'Y'             32270001
322800                         MOVE 'M'                                 32280001
322900                          TO ASC-MASTER (ASC-BLK-SUB ASC-ITEM-SUB)32290001
323000                     ELSE                                         32300001
323100                         MOVE 'C'                                 32310001
323200                          TO ASC-MASTER (ASC-BLK-SUB ASC-ITEM-SUB)32320001
323300                     END-IF                                       32330001
323400                 END-IF                                           32340001
323500                 MOVE ZEROES TO PV-SHPD-QTY                       32350001
323600                 PERFORM 4360-GET-SHPD-QTY                        32360001
323700                 MOVE PV-SHPD-QTY                                 32370001
323800                    TO ASC-UNTS-MNFSTD (ASC-BLK-SUB ASC-ITEM-SUB) 32380001
324700                                                                  32470001
324800                                                                  32480001
325200                 IF  DP020-INT-APPL-FORMAT-IND =                  32520001
325300                                              PC-CRIT-SPEC-FORMAT 32530001
325400                      OR PC-DC-LIST-FORMAT                        32540001
325500                     ADD PV-SHPD-QTY TO ASC-UNTS-MNFD             32550001
325600                 END-IF                                           32560001
325900                                                                  32590001
326000                 EVALUATE PC046-CRTN-STATUS                       32600001
326100                     WHEN '01'                                    32610001
326200                         MOVE DK-INVALID-DESC TO ASC-LOAD-STATUS  32620001
326300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32630001
326400                     WHEN '02'                                    32640001
326500                         MOVE DK-INACT-DESC  TO ASC-LOAD-STATUS   32650001
326600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32660001
326700                     WHEN '03'                                    32670001
326800                         MOVE DK-SC-OF-DESC  TO ASC-LOAD-STATUS   32680001
326900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32690001
327000                     WHEN '04'                                    32700001
327100                         MOVE DK-SC-ON-DESC  TO ASC-LOAD-STATUS   32710001
327200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32720001
327300                     WHEN '05'                                    32730001
327400                         PERFORM 4305-CHECK-ASSUMED               32740001
327500                         IF PS-DIVERTED                           32750001
327600                             MOVE DK-DVRT-DESC TO ASC-LOAD-STATUS 32760001
327700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32770001
327800                         ELSE                                     32780001
327900                             MOVE DK-ASSUM-DESC TO ASC-LOAD-STATUS32790001
328000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32800001
328100                         END-IF                                   32810001
328200                     WHEN '06'                                    32820001
328300                         MOVE DK-LOADED-DESC TO ASC-LOAD-STATUS   32830001
328400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32840001
328500                     WHEN '07'                                    32850001
328600                         MOVE DK-CSEPK-DESC  TO ASC-LOAD-STATUS   32860001
328700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32870001
328800                     WHEN '08'                                    32880001
328900                         MOVE DK-CK-IN-DESC  TO ASC-LOAD-STATUS   32890001
329000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32900001
329100                     WHEN '09'                                    32910001
329200                         MOVE DK-P2L-DESC    TO ASC-LOAD-STATUS   32920001
329300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32930001
329400                     WHEN '10'                                    32940001
329500                         MOVE DK-RDM-DESC    TO ASC-LOAD-STATUS   32950001
329600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32960001
329700                     WHEN '11'                                    32970001
329800                         MOVE DK-RECV-DESC   TO ASC-LOAD-STATUS   32980001
329900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32990001
330000                     WHEN '12'                                    33000001
330100                         MOVE DK-ASN-DESC    TO ASC-LOAD-STATUS   33010001
330200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33020001
330300                     WHEN '13'                                    33030001
330400                         MOVE DK-SMTH-DESC   TO ASC-LOAD-STATUS   33040001
330500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33050001
330600                     WHEN '14'                                    33060001
330700                         MOVE DK-XFER-DESC   TO ASC-LOAD-STATUS   33070001
330800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33080001
330900                     WHEN '15'                                    33090001
331000                         MOVE DK-MSTR-DESC   TO ASC-LOAD-STATUS   33100001
331100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33110001
331200                     WHEN '16'                                    33120001
331300                         MOVE DK-BLD-DESC    TO ASC-LOAD-STATUS   33130001
331400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33140001
331500                     WHEN '17'                                    33150001
331600                         MOVE 'JEWELRY'      TO ASC-LOAD-STATUS   33160001
331700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33170001
331800                     WHEN '18'                                    33180001
331900                         MOVE 'DAMAGED'      TO ASC-LOAD-STATUS   33190001
332000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33200001
332010                     WHEN '19'                                    33201017
332020                         MOVE DK-3WD-DESC    TO ASC-LOAD-STATUS   33202017
332030                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33203017
332100                 END-EVALUATE                                     33210001
332200                 IF PC046-BEGIN-DIVERT                            33220001
332300                     MOVE 'DVT BEG' TO ASC-LOAD-STATUS            33230001
332400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33240001
332500                 ELSE                                             33250001
332600                     IF PC046-END-DIVERT                          33260001
332700                          MOVE 'DVT END' TO ASC-LOAD-STATUS       33270001
332800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33280001
332900                     END-IF                                       33290001
333000                 END-IF                                           33300001
333100                 MOVE PC046-OTBD-TRIP-ID                          33310001
333200                      TO ASC-TRIP-ID-N (ASC-BLK-SUB ASC-ITEM-SUB) 33320001
333300                 MOVE PC046-DOOR-TYP-CDE                          33330001
333400                   TO ASC-DOOR-TYP-CDE (ASC-BLK-SUB ASC-ITEM-SUB) 33340001
333500                                                                  33350001
333520                 MOVE  SUT00028-SHIPT-UNT-ID                      33352009
333530                   TO  SUT00121-SHIPT-UNT-ID                      33353007
333540                 PERFORM 4370-CHECK-STORE-SCAN                    33354007
333600             ELSE                                                 33360001
333700                 MOVE PC046-KOHLS-BARCODE                         33370001
333800                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 33380001
333900             END-IF                                               33390001
334000         END-IF                                                   33400001
334100     END-PERFORM.                                                 33410001
334200                                                                  33420001
334300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          33430001
334400         MOVE +1               TO ASC-BLK-SUB                     33440001
334500         PERFORM 5100-WRITE-TEMP-STORAGE                          33450001
334600         ADD +1                TO ASC-BLK-SUB                     33460001
334700         PERFORM 5100-WRITE-TEMP-STORAGE                          33470001
334800                                                                  33480001
334900         MOVE 1                TO ASC-BLK-SUB                     33490001
335000                                  PV-BLOCK-NUMBER                 33500001
335100         PERFORM 4410-READ-TEMP-STORAGE                           33510001
335200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             33520001
335300             MOVE 2            TO ASC-BLK-SUB                     33530001
335400                                  PV-BLOCK-NUMBER                 33540001
335500             PERFORM 4410-READ-TEMP-STORAGE                       33550001
335600         END-IF                                                   33560001
335700     END-IF.                                                      33570001
335800                                                                  33580001
335900 4300A-FORMAT-DATE-TIME.                                          33590001
336000                                                                  33600001
336100     EXEC SQL                                                     33610001
336200     SELECT                                                       33620001
336300         CHAR(DATE(:PV-TMST),USA)                                 33630001
336400     ,   SUBSTR(CHAR(TIME(:PV-TMST),JIS),1,5)                     33640001
336500     INTO                                                         33650001
336600         :PV-USA-DATE                                             33660001
336700     ,   :PV-JIS-TIME                                             33670001
336800     FROM SYSIBM.SYSDUMMY1                                        33680001
336900     END-EXEC.                                                    33690001
337000                                                                  33700001
337100     EVALUATE TRUE                                                33710001
337200         WHEN SQLCODE = ZERO                                      33720001
337300             CONTINUE                                             33730001
337400         WHEN SQLWARN0 NOT = SPACE                                33740001
337500         WHEN SQLCODE NOT = ZERO                                  33750001
337600              MOVE '4300A-FORMAT-DATE-TIME'  TO DP013-PARAGRAPH   33760001
337700              MOVE 'FORMAT DATE AND TIME'                         33770001
337800                               TO DP013-MESSAGE-TEXT (1)          33780001
337900              MOVE SQLCA       TO DP013-SQLCA                     33790001
338000              MOVE 'SYSDUMMY1'   TO DP013-DB2-TABLE-NAME (1)      33800001
338100              SET DP013-DB2-ABEND TO TRUE                         33810001
338200              PERFORM DP013-0000-PROCESS-ABEND                    33820001
338300     END-EVALUATE.                                                33830001
338400                                                                  33840001
338500*----------------------------------------------------------------*33850001
338600*  CHECK IF DIVERTED CARTON IS ASSUMED TO BE ON A TRAILER         33860001
338700*----------------------------------------------------------------*33870001
338800 4305-CHECK-ASSUMED.                                              33880001
338900                                                                  33890001
339000      PERFORM 4305A-GET-DVRT-OPER-DOOR.                           33900001
339100                                                                  33910001
339200      MOVE CNDCDR-DOOR-TYP-CDE  TO  PC046-DOOR-TYP-CDE.           33920001
339300                                                                  33930001
339400      IF  CNDCDR-DOOR-TYP-CDE  =  'SH'                            33940001
339500          PERFORM 4305B-GET-SHIP-TRIP                             33950001
339600      ELSE                                                        33960001
339700          IF  CNDCDR-DOOR-TYP-CDE  =  ('ST' OR 'DS')              33970001
339800              PERFORM 4305C-GET-SHUT-STOR-TRIP                    33980001
339900          ELSE                                                    33990001
340000              SET PS-DIVERTED TO TRUE                             34000001
340100          END-IF                                                  34010001
340200      END-IF.                                                     34020001
340300                                                                  34030001
340400      IF  SUOBTR-OTBND-TRIP-ID  >  0                              34040001
340500          PERFORM 4305D-GET-BEG-DIVERT                            34050001
340600      ELSE                                                        34060001
340700          SET PS-DIVERTED TO TRUE                                 34070001
340800      END-IF.                                                     34080001
340900                                                                  34090001
341000*---------------------------------------------------------------* 34100001
341100*  GET THE OPER UNIT AND DIVERTED DOOR INFORMATION              * 34110001
341200*---------------------------------------------------------------* 34120001
341300 4305A-GET-DVRT-OPER-DOOR.                                        34130001
341400                                                                  34140001
341500     EXEC SQL                                                     34150001
341600          SELECT A.OPER_UNT_ID                                    34160001
341700               , A.DOOR_ID                                        34170001
341800               , A.DEST_OPER_UNT_ID                               34180001
341900               , C.DOOR_TYP_CDE                                   34190001
342000            INTO :SUCRDV-OPER-UNT-ID                              34200001
342100               , :SUCRDV-DOOR-ID                                  34210001
342200               , :SUCRDV-DEST-OPER-UNT-ID                         34220001
342300               , :CNDCDR-DOOR-TYP-CDE                             34230001
342400            FROM TSUCRDV A                                        34240001
342500               , TCNDCDR C                                        34250001
342600           WHERE A.SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID         34260001
342700             AND A.ACTV_CDE      =  'A'                           34270001
342800             AND A.OPER_UNT_ID   =  C.OPER_UNT_ID                 34280001
342900             AND A.DIVERT_NBR    =  C.DIVERT_NBR                  34290001
343000             AND A.DIVERT_LOC_ID =  C.DIVERT_LOC_ID               34300001
343100             AND A.DOOR_ID       =  C.DOOR_ID                     34310001
343200             AND A.DIVERT_TMST  IN                                34320001
343300                 (SELECT MAX(B.DIVERT_TMST)                       34330001
343400                    FROM TSUCRDV B                                34340001
343500                   WHERE B.SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID 34350001
343600                     AND B.ACTV_CDE      = 'A')                   34360001
343700     END-EXEC.                                                    34370001
343800                                                                  34380001
343900     EVALUATE TRUE                                                34390001
344000         WHEN SQLCODE = ZEROS                                     34400001
344100              CONTINUE                                            34410001
344200         WHEN SQLCODE = +100                                      34420001
344300             SET PS-DIVERTED TO TRUE                              34430001
344400         WHEN SQLCODE = -904                                      34440001
344500         WHEN SQLCODE = -911                                      34450001
344600         WHEN SQLCODE = -913                                      34460001
344700              INITIALIZE DP013-MESSAGE-TEXT (1)                   34470001
344800              MOVE '4305A-GET-DVRT-OPER'   TO DP013-PARAGRAPH     34480001
344900              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               34490001
345000                                        TO DP013-MESSAGE-TEXT (1) 34500001
345100              STRING  ' CARTON='                                  34510001
345200                      PC046-CARTON-ID      DELIMITED BY SIZE      34520001
345300                                      INTO DP013-MESSAGE-TEXT (2) 34530001
345400              MOVE SQLCA       TO DP013-SQLCA                     34540001
345500              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)       34550001
345600              MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (2)       34560001
345700              SET DP013-DB2-ABEND TO TRUE                         34570001
345800              PERFORM DP013-0000-PROCESS-ABEND                    34580001
345900               SET  PS-ERROR                                      34590001
346000                    DP020-MSG-FATAL TO TRUE                       34600001
346100              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          34610001
346200                                                                  34620001
346300         WHEN OTHER                                               34630001
346400              INITIALIZE DP013-MESSAGE-TEXT (1)                   34640001
346500              MOVE '4305A-GET-DVRT-OPER'   TO DP013-PARAGRAPH     34650001
346600              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               34660001
346700                                        TO DP013-MESSAGE-TEXT (1) 34670001
346800              STRING  ' CARTON='                                  34680001
346900                      PC046-CARTON-ID      DELIMITED BY SIZE      34690001
347000                                      INTO DP013-MESSAGE-TEXT (2) 34700001
347100              MOVE SQLCA       TO DP013-SQLCA                     34710001
347200              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)       34720001
347300              MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (2)       34730001
347400              SET DP013-DB2-ABEND TO TRUE                         34740001
347500              PERFORM DP013-0000-PROCESS-ABEND                    34750001
347600              SET  PS-ERROR                                       34760001
347700                   DP020-MSG-FATAL TO TRUE                        34770001
347800              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          34780001
347900     END-EVALUATE.                                                34790001
348000                                                                  34800001
348100*---------------------------------------------------------------* 34810001
348200*  GET CURRENT OPEN TRIP AT SHIPPING DOOR FOR CARTON DESTINATION* 34820001
348300*---------------------------------------------------------------* 34830001
348400 4305B-GET-SHIP-TRIP.                                             34840001
348500     INITIALIZE DCLTSUOBTR.                                       34850001
348600                                                                  34860001
348700     EXEC SQL                                                     34870001
348800          SELECT A.OTBND_TRIP_ID                                  34880001
348900            INTO :SUOBTR-OTBND-TRIP-ID                            34890001
349000            FROM TSUOBTR A                                        34900001
349100               , TSUOBTS B                                        34910001
349200           WHERE A.DEST_OPER_UNT_ID  = :SUCRDV-DEST-OPER-UNT-ID   34920001
349300             AND A.ORGN_OPER_UNT_ID  = :SUCRDV-OPER-UNT-ID        34930001
349400             AND A.DOOR_TYP_CDE      = 'SH'                       34940001
349500             AND A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID           34950001
349600             AND B.TRIP_STAT_CDE     = 'DO'                       34960001
349700             AND B.DOOR_ID           = :SUCRDV-DOOR-ID            34970001
349800             AND B.OTBND_STAT_TMST   IN                           34980001
349900                   (SELECT MAX(C.OTBND_STAT_TMST)                 34990001
350000                      FROM TSUOBTS C                              35000001
350100                     WHERE B.OTBND_TRIP_ID = C.OTBND_TRIP_ID)     35010001
350200     END-EXEC.                                                    35020001
350300                                                                  35030001
350400     EVALUATE TRUE                                                35040001
350500         WHEN SQLCODE = ZEROS                                     35050001
350600              CONTINUE                                            35060001
350700         WHEN SQLCODE = +100                                      35070001
350800             SET PS-DIVERTED TO TRUE                              35080001
350900         WHEN SQLCODE = -904                                      35090001
351000         WHEN SQLCODE = -911                                      35100001
351100         WHEN SQLCODE = -913                                      35110001
351200              INITIALIZE DP013-MESSAGE-TEXT (1)                   35120001
351300              MOVE '4305B-GET-SHIP-TRIP'   TO DP013-PARAGRAPH     35130001
351400              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               35140001
351500                                        TO DP013-MESSAGE-TEXT (1) 35150001
351600              STRING  ' CARTON='                                  35160001
351700                      PC046-CARTON-ID      DELIMITED BY SIZE      35170001
351800                                      INTO DP013-MESSAGE-TEXT (2) 35180001
351900              MOVE SQLCA       TO DP013-SQLCA                     35190001
352000              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       35200001
352100              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       35210001
352200              SET DP013-DB2-ABEND TO TRUE                         35220001
352300              PERFORM DP013-0000-PROCESS-ABEND                    35230001
352400               SET  PS-ERROR                                      35240001
352500                    DP020-MSG-FATAL TO TRUE                       35250001
352600              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          35260001
352700                                                                  35270001
352800         WHEN OTHER                                               35280001
352900              INITIALIZE DP013-MESSAGE-TEXT (1)                   35290001
353000              MOVE '4305B-GET-SHIP-TRIP'   TO DP013-PARAGRAPH     35300001
353100              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               35310001
353200                                        TO DP013-MESSAGE-TEXT (1) 35320001
353300              STRING  ' CARTON='                                  35330001
353400                      PC046-CARTON-ID      DELIMITED BY SIZE      35340001
353500                                      INTO DP013-MESSAGE-TEXT (2) 35350001
353600              MOVE SQLCA       TO DP013-SQLCA                     35360001
353700              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       35370001
353800              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       35380001
353900              SET DP013-DB2-ABEND TO TRUE                         35390001
354000              PERFORM DP013-0000-PROCESS-ABEND                    35400001
354100              SET  PS-ERROR                                       35410001
354200                   DP020-MSG-FATAL TO TRUE                        35420001
354300              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          35430001
354400     END-EVALUATE.                                                35440001
354500                                                                  35450001
354600                                                                  35460001
354700*---------------------------------------------------------------* 35470001
354800*  GET CURRENT OPEN TRIP FOR SHUTTLE/STORAGE TRAILER            * 35480001
354900*---------------------------------------------------------------* 35490001
355000 4305C-GET-SHUT-STOR-TRIP.                                        35500001
355100     INITIALIZE DCLTSUOBTR.                                       35510001
355200                                                                  35520001
355300     EXEC SQL                                                     35530001
355400          SELECT A.OTBND_TRIP_ID                                  35540001
355500            INTO :SUOBTR-OTBND-TRIP-ID                            35550001
355600            FROM TSUOBTR A                                        35560001
355700               , TSUOBTS B                                        35570001
355800           WHERE A.ORGN_OPER_UNT_ID  = :SUCRDV-OPER-UNT-ID        35580001
355900             AND A.DOOR_TYP_CDE     <> 'SH'                       35590001
356000             AND A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID           35600001
356100             AND A.ORGN_OPER_UNT_ID  =  B.STAT_OPER_UNT_ID        35610001
356200             AND B.TRIP_STAT_CDE     = 'DO'                       35620001
356300             AND B.DOOR_ID           = :SUCRDV-DOOR-ID            35630001
356400             AND B.OTBND_STAT_TMST   IN                           35640001
356500                   (SELECT MAX(C.OTBND_STAT_TMST)                 35650001
356600                      FROM TSUOBTS C                              35660001
356700                     WHERE B.OTBND_TRIP_ID = C.OTBND_TRIP_ID)     35670001
356800     END-EXEC.                                                    35680001
356900                                                                  35690001
357000     EVALUATE TRUE                                                35700001
357100         WHEN SQLCODE = ZEROS                                     35710001
357200              CONTINUE                                            35720001
357300         WHEN SQLCODE = +100                                      35730001
357400             SET PS-DIVERTED TO TRUE                              35740001
357500         WHEN SQLCODE = -904                                      35750001
357600         WHEN SQLCODE = -911                                      35760001
357700         WHEN SQLCODE = -913                                      35770001
357800              INITIALIZE DP013-MESSAGE-TEXT (1)                   35780001
357900              MOVE '4305C-GET-SHUT-STOR'   TO DP013-PARAGRAPH     35790001
358000              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               35800001
358100                                        TO DP013-MESSAGE-TEXT (1) 35810001
358200              STRING  ' CARTON='                                  35820001
358300                      PC046-CARTON-ID      DELIMITED BY SIZE      35830001
358400                                      INTO DP013-MESSAGE-TEXT (2) 35840001
358500              MOVE SQLCA       TO DP013-SQLCA                     35850001
358600              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       35860001
358700              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       35870001
358800              SET DP013-DB2-ABEND TO TRUE                         35880001
358900              PERFORM DP013-0000-PROCESS-ABEND                    35890001
359000               SET  PS-ERROR                                      35900001
359100                    DP020-MSG-FATAL TO TRUE                       35910001
359200              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          35920001
359300                                                                  35930001
359400         WHEN OTHER                                               35940001
359500              INITIALIZE DP013-MESSAGE-TEXT (1)                   35950001
359600              MOVE '4305C-GET-SHUT-STOR'   TO DP013-PARAGRAPH     35960001
359700              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               35970001
359800                                        TO DP013-MESSAGE-TEXT (1) 35980001
359900              STRING  ' CARTON='                                  35990001
360000                      PC046-CARTON-ID      DELIMITED BY SIZE      36000001
360100                                      INTO DP013-MESSAGE-TEXT (2) 36010001
360200              MOVE SQLCA       TO DP013-SQLCA                     36020001
360300              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       36030001
360400              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       36040001
360500              SET DP013-DB2-ABEND TO TRUE                         36050001
360600              PERFORM DP013-0000-PROCESS-ABEND                    36060001
360700              SET  PS-ERROR                                       36070001
360800                   DP020-MSG-FATAL TO TRUE                        36080001
360900              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          36090001
361000     END-EVALUATE.                                                36100001
361100                                                                  36110001
361200                                                                  36120001
361300 4305D-GET-BEG-DIVERT.                                            36130001
361400                                                                  36140001
361500     EXEC SQL                                                     36150001
361600          SELECT A.STRT_DIVERT_TMST                               36160001
361700            INTO :SUCDOT-STRT-DIVERT-TMST                         36170001
361800            FROM TSUCDOT A                                        36180001
361900           WHERE A.OTBND_TRIP_ID     = :SUOBTR-OTBND-TRIP-ID      36190001
362000             AND A.END_DIVERT_TMST   = :PC-DEFAULT-TMST           36200001
362100     END-EXEC.                                                    36210001
362200                                                                  36220001
362300     EVALUATE TRUE                                                36230001
362400         WHEN SQLCODE = ZEROS                                     36240001
362500              IF  SUCDOT-STRT-DIVERT-TMST  <  PC046-CRTN-STAT-TMST36250001
362600                  SET PS-ASSUMED  TO TRUE                         36260001
362700                  MOVE SUOBTR-OTBND-TRIP-ID  TO PC046-OTBD-TRIP-ID36270001
362800              ELSE                                                36280001
362900                  SET PS-DIVERTED TO TRUE                         36290001
363000              END-IF                                              36300001
363100         WHEN SQLCODE = +100                                      36310001
363200             SET PS-DIVERTED TO TRUE                              36320001
363300         WHEN SQLCODE = -904                                      36330001
363400         WHEN SQLCODE = -911                                      36340001
363500         WHEN SQLCODE = -913                                      36350001
363600              INITIALIZE DP013-MESSAGE-TEXT (1)                   36360001
363700              MOVE '4305D-GET-BEG-DIVERT'  TO DP013-PARAGRAPH     36370001
363800              MOVE 'ERROR FINDING DIVERT BEGIN    '               36380001
363900                                        TO DP013-MESSAGE-TEXT (1) 36390001
364000              STRING  ' CARTON='                                  36400001
364100                       PC046-CARTON-ID     DELIMITED BY SIZE      36410001
364200                                      INTO DP013-MESSAGE-TEXT (2) 36420001
364300              MOVE SQLCA       TO DP013-SQLCA                     36430001
364400              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)       36440001
364500              SET DP013-DB2-ABEND TO TRUE                         36450001
364600              PERFORM DP013-0000-PROCESS-ABEND                    36460001
364700               SET  PS-ERROR                                      36470001
364800                    DP020-MSG-FATAL TO TRUE                       36480001
364900              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          36490001
365000                                                                  36500001
365100         WHEN OTHER                                               36510001
365200              INITIALIZE DP013-MESSAGE-TEXT (1)                   36520001
365300              MOVE '4305D-GET-BEG-DIVERT'  TO DP013-PARAGRAPH     36530001
365400              MOVE 'ERROR FINDING DIVERT BEGIN    '               36540001
365500                                        TO DP013-MESSAGE-TEXT (1) 36550001
365600              STRING  ' CARTON='                                  36560001
365700                      PC046-CARTON-ID      DELIMITED BY SIZE      36570001
365800                                      INTO DP013-MESSAGE-TEXT (2) 36580001
365900              MOVE SQLCA       TO DP013-SQLCA                     36590001
366000              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)       36600001
366100              SET DP013-DB2-ABEND TO TRUE                         36610001
366200              PERFORM DP013-0000-PROCESS-ABEND                    36620001
366300              SET  PS-ERROR                                       36630001
366400                   DP020-MSG-FATAL TO TRUE                        36640001
366500              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          36650001
366600     END-EVALUATE.                                                36660001
366700                                                                  36670001
366800*----------------------------------------------------------------*36680001
366900*    FETCH THE CURSOR                                             36690001
367000*----------------------------------------------------------------*36700001
367100 4310-FETCH.                                                      36710001
367500                                                                  36750001
367600     INITIALIZE PC046-COMMAREA-REC.                               36760001
367700                                                                  36770001
367800     EXEC SQL                                                     36780001
367900         FETCH CARTON-CSR                                         36790001
368000         INTO  :SUT00028-SHIPT-UNT-ID                             36800001
368100            ,  :SUT00024-PRNT-CART-ID                             36810001
368200            ,  :SUT00024-MSTR-CART-IND                            36820001
368300     END-EXEC.                                                    36830001
368400                                                                  36840001
368500     EVALUATE TRUE                                                36850001
368600         WHEN SQLCODE = ZEROS                                     36860001
368700              MOVE SUT00028-SHIPT-UNT-ID TO ASC-SML-NBR           36870001
368800                                           PC046-CARTON-ID        36880001
368900         WHEN SQLCODE = +100                                      36890001
369000              SET PS-ERROR  TO TRUE                               36900001
369100         WHEN SQLCODE = -904                                      36910001
369200         WHEN SQLCODE = -911                                      36920001
369300         WHEN SQLCODE = -913                                      36930001
369400              INITIALIZE DP013-MESSAGE-TEXT (1)                   36940001
369500              MOVE '4310-FETCH'            TO DP013-PARAGRAPH     36950001
369600              MOVE 'PROBLEM FETCHING CURSOR'                      36960001
369700                                        TO DP013-MESSAGE-TEXT (1) 36970001
369800              MOVE SQLCA       TO DP013-SQLCA                     36980001
369900              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       36990001
370000              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)       37000001
370100              MOVE 'SUT00026'   TO DP013-DB2-TABLE-NAME (3)       37010001
370200              SET DP013-DB2-ABEND TO TRUE                         37020001
370300              PERFORM DP013-0000-PROCESS-ABEND                    37030001
370400               SET  PS-ERROR                                      37040001
370500                    DP020-MSG-FATAL TO TRUE                       37050001
370600              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          37060001
370700                                                                  37070001
370800         WHEN OTHER                                               37080001
370900              INITIALIZE DP013-MESSAGE-TEXT (1)                   37090001
371000              MOVE '4310-FETCH'            TO DP013-PARAGRAPH     37100001
371100              MOVE 'PROBLEM FETCH CURSOR'                         37110001
371200                                        TO DP013-MESSAGE-TEXT (1) 37120001
371300              MOVE SQLCA       TO DP013-SQLCA                     37130001
371400              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       37140001
371500              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)       37150001
371600              MOVE 'SUT00026'   TO DP013-DB2-TABLE-NAME (3)       37160001
371700              SET DP013-DB2-ABEND TO TRUE                         37170001
371800              PERFORM DP013-0000-PROCESS-ABEND                    37180001
371900              SET  PS-ERROR                                       37190001
372000                   DP020-MSG-FATAL TO TRUE                        37200001
372100              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          37210001
372200     END-EVALUATE.                                                37220001
372300                                                                  37230001
372400     IF  SQLCODE EQUAL +100                                       37240001
372500         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      37250001
372600     END-IF.                                                      37260001
372700                                                                  37270001
373000                                                                  37300001
373100*----------------------------------------------------------------*37310001
373200* CALL PCKUT713 TO RETRIEVE CARTON INFORMATION                    37320012
373300*----------------------------------------------------------------*37330001
373400 4350-CARTON-INFO.                                                37340001
373500                                                                  37350001
373600                                                                  37360001
373700     CALL PC046-CARTON-STATUS-MODULE                              37370001
373800             USING DFHEIBLK                                       37380001
373900             PC046-COMMAREA                                       37390001
374000             PC046-COMMAREA-REC                                   37400001
374100     END-CALL.                                                    37410001
374200                                                                  37420001
374300     PERFORM 4355-VALIDATE-STATUS-CALL.                           37430001
374400                                                                  37440001
374500*----------------------------------------------------------------*37450001
374600* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*37460001
374700*----------------------------------------------------------------*37470001
374800 4355-VALIDATE-STATUS-CALL.                                       37480001
374900                                                                  37490001
375000     IF  PC046-SUCCESSFUL  OR                                     37500001
375200         PC046-CRTN-STAT-ERROR                                    37520001
375400         SET PS-NO-ERROR   TO  TRUE                               37540001
375500     ELSE                                                         37550001
375600         SET  PS-ERROR     TO  TRUE                               37560001
375700     END-IF.                                                      37570001
375800                                                                  37580001
375900*----------------------------------------------------------------*37590001
376000* GET TOTAL MANIFESTED UNIT QTY FROM SUT_OTBND_UPC                37600001
376100*----------------------------------------------------------------*37610001
376200 4360-GET-SHPD-QTY.                                               37620001
376300     EXEC SQL                                                     37630001
376400          OPEN MANFSTD-UNITS-CSR                                  37640001
376500     END-EXEC                                                     37650001
376600                                                                  37660001
376700     EVALUATE TRUE                                                37670001
376800         WHEN SQLCODE = ZERO                                      37680001
376900         WHEN SQLCODE = +100                                      37690001
377000             CONTINUE                                             37700001
377100         WHEN SQLWARN0 NOT = SPACES                               37710001
377200         WHEN SQLCODE < ZERO                                      37720001
377300         WHEN SQLCODE > ZERO                                      37730001
377400             MOVE '4360-GET-SHPD-QTY' TO DP013-PARAGRAPH          37740001
377500             MOVE 'OPEN CURSOR PROBLEM   '                        37750001
377600                               TO DP013-MESSAGE-TEXT (1)          37760001
377700             MOVE SQLCA        TO DP013-SQLCA                     37770001
377800             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        37780001
377900             SET DP013-DB2-ABEND                                  37790001
378000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               37800001
378100             PERFORM DP013-0000-PROCESS-ABEND                     37810001
378200     END-EVALUATE.                                                37820001
378300                                                                  37830001
378400     PERFORM 4367-FETCH-MNFST-CSR UNTIL SQLCODE = +100.           37840001
378500     MOVE ZEROS TO SQLCODE.                                       37850001
378600     PERFORM 4365-CLOSE-MNFST-CSR.                                37860001
378700                                                                  37870001
378800* --------------------------------------------------------------  37880001
378900* CLOSE LINE CURSOR.                                              37890001
379000* --------------------------------------------------------------  37900001
379100  4365-CLOSE-MNFST-CSR.                                           37910001
379200     EXEC SQL                                                     37920001
379300         CLOSE MANFSTD-UNITS-CSR                                  37930001
379400     END-EXEC.                                                    37940001
379500                                                                  37950001
379600     EVALUATE TRUE                                                37960001
379700         WHEN SQLCODE = ZERO                                      37970001
379800         WHEN SQLCODE = +100                                      37980001
379900             CONTINUE                                             37990001
380000         WHEN SQLWARN0 NOT = SPACE                                38000001
380100         WHEN SQLCODE NOT = ZERO                                  38010001
380200             MOVE '4365-CLOSE-MNFST-CSR' TO DP013-PARAGRAPH       38020001
380300             MOVE 'CLOSE CURSOR PROBLEM   '                       38030001
380400                               TO DP013-MESSAGE-TEXT (1)          38040001
380500             MOVE SQLCA        TO DP013-SQLCA                     38050001
380600             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        38060001
380700             SET DP013-DB2-ABEND                                  38070001
380800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38080001
380900             PERFORM DP013-0000-PROCESS-ABEND                     38090001
381000     END-EVALUATE.                                                38100001
381100                                                                  38110001
381200*----------------------------------------------------------------*38120001
381300*    FETCH THE MANIFESTED CURSOR                                  38130001
381400*----------------------------------------------------------------*38140001
381500 4367-FETCH-MNFST-CSR.                                            38150001
381600     EXEC SQL                                                     38160001
381700         FETCH MANFSTD-UNITS-CSR                                  38170001
381800          INTO  :SUT00028-SHPD-UNT-QTY                            38180001
381900     END-EXEC                                                     38190001
382000                                                                  38200001
382100     EVALUATE TRUE                                                38210001
382200         WHEN SQLCODE = ZERO                                      38220001
382300              ADD SUT00028-SHPD-UNT-QTY TO PV-SHPD-QTY            38230001
382400         WHEN SQLCODE = +100                                      38240001
382500              CONTINUE                                            38250001
382600         WHEN SQLCODE = -305                                      38260001
382700              ADD ZEROES         TO PV-SHPD-QTY                   38270001
382800         WHEN SQLWARN0 NOT = SPACE                                38280001
382900         WHEN SQLCODE NOT = ZERO                                  38290001
383000              MOVE '4367-FETCH-MNFST-CSR' TO DP013-PARAGRAPH      38300001
383100              MOVE 'FETCH CURSOR PROBLEM '                        38310001
383200                               TO DP013-MESSAGE-TEXT (1)          38320001
383300              MOVE SQLCA       TO DP013-SQLCA                     38330001
383400              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       38340001
383500              SET DP013-DB2-ABEND TO TRUE                         38350001
383600              PERFORM DP013-0000-PROCESS-ABEND                    38360001
383700     END-EVALUATE.                                                38370001
383800                                                                  38380001
383801                                                                  38380107
383810 4370-CHECK-STORE-SCAN.                                           38381007
383821                                                                  38382107
383824     EXEC SQL                                                     38382407
383825          SELECT SCN_TYP_CDE                                      38382507
383826          INTO  :SUT00121-SCN-TYP-CDE                             38382607
383827           FROM  SUT_OTBND_STR_SCN A                              38382707
383828          WHERE A.SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID           38382807
383829            AND A.CRE_TMST IN                                     38382907
383830                (SELECT MAX(B.CRE_TMST)                           38383007
383831                   FROM SUT_OTBND_STR_SCN B                       38383107
383832                  WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID         38383207
383833                    AND NOT B.SCN_TYP_CDE  =  'SSMS'              38383307
383834                )                                                 38383407
383836     END-EXEC.                                                    38383607
383837                                                                  38383707
383838     EVALUATE TRUE                                                38383807
383839         WHEN SQLCODE = ZEROS                                     38383907
383840              MOVE SUT00121-SCN-TYP-CDE TO ASC-STORE-SCAN         38384007
383841                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38384107
383842              PERFORM 4375-CHECK-MULT-STR-SCAN                    38384211
383848         WHEN SQLCODE = +100                                      38384807
383849              MOVE SPACES               TO ASC-STORE-SCAN         38384907
383850                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38385007
383851                                           ASC-MULT-SCAN-SW       38385111
383852                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38385211
383853                                                                  38385307
383854         WHEN SQLCODE = -904                                      38385407
383855         WHEN SQLCODE = -911                                      38385507
383856         WHEN SQLCODE = -913                                      38385607
383857              INITIALIZE DP013-MESSAGE-TEXT (1)                   38385707
383858              MOVE '4370-CHECK-STORE-SCAN' TO DP013-PARAGRAPH     38385807
383859              MOVE 'ERROR STORE SCAN          '                   38385907
383860                                        TO DP013-MESSAGE-TEXT (1) 38386007
383861              STRING  ' CARTON='                                  38386107
383862                       PC046-CARTON-ID     DELIMITED BY SIZE      38386207
383863                                      INTO DP013-MESSAGE-TEXT (2) 38386307
383864              MOVE SQLCA       TO DP013-SQLCA                     38386407
383865              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       38386507
383866              SET DP013-DB2-ABEND TO TRUE                         38386607
383867              PERFORM DP013-0000-PROCESS-ABEND                    38386707
383868               SET  PS-ERROR                                      38386807
383869                    DP020-MSG-FATAL TO TRUE                       38386907
383870              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          38387007
383871                                                                  38387107
383872         WHEN OTHER                                               38387207
383873              INITIALIZE DP013-MESSAGE-TEXT (1)                   38387307
383874              MOVE '4370-CHECK-STORE-SCAN' TO DP013-PARAGRAPH     38387407
383875              MOVE 'ERROR STORE SCAN              '               38387507
383876                                        TO DP013-MESSAGE-TEXT (1) 38387607
383877              STRING  ' CARTON='                                  38387707
383878                      PC046-CARTON-ID      DELIMITED BY SIZE      38387807
383879                                      INTO DP013-MESSAGE-TEXT (2) 38387907
383880              MOVE SQLCA       TO DP013-SQLCA                     38388007
383881              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       38388107
383882              SET DP013-DB2-ABEND TO TRUE                         38388207
383883              PERFORM DP013-0000-PROCESS-ABEND                    38388307
383884              SET  PS-ERROR                                       38388407
383885                   DP020-MSG-FATAL TO TRUE                        38388507
383886              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          38388607
383887     END-EVALUATE.                                                38388707
383888                                                                  38388807
383890                                                                  38389007
383891 4375-CHECK-MULT-STR-SCAN.                                        38389111
383892                                                                  38389211
383893     EXEC SQL                                                     38389311
383894          SELECT COUNT(*)                                         38389411
383895          INTO  :PV-STR-SCAN-COUNT                                38389511
383896           FROM  SUT_OTBND_STR_SCN                                38389611
383897          WHERE SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID             38389711
383904     END-EXEC.                                                    38390411
383905                                                                  38390511
383906     EVALUATE TRUE                                                38390611
383907         WHEN SQLCODE = ZEROS                                     38390711
383908              IF  PV-STR-SCAN-COUNT  > 1                          38390811
383909                  MOVE 'M'     TO ASC-MULT-SCAN-SW                38390911
383910                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38391011
383911              ELSE                                                38391111
383912                  MOVE SPACES  TO ASC-MULT-SCAN-SW                38391211
383913                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38391311
383914              END-IF                                              38391411
383915         WHEN SQLCODE = +100                                      38391511
383916              MOVE SPACES  TO ASC-MULT-SCAN-SW                    38391611
383917                                       (ASC-BLK-SUB ASC-ITEM-SUB) 38391711
383920                                                                  38392011
383921         WHEN SQLCODE = -904                                      38392111
383922         WHEN SQLCODE = -911                                      38392211
383923         WHEN SQLCODE = -913                                      38392311
383924              INITIALIZE DP013-MESSAGE-TEXT (1)                   38392411
383925              MOVE '4370-CHECK-STORE-SCAN' TO DP013-PARAGRAPH     38392511
383926              MOVE 'ERROR STORE SCAN          '                   38392611
383927                                        TO DP013-MESSAGE-TEXT (1) 38392711
383928              STRING  ' CARTON='                                  38392811
383929                       PC046-CARTON-ID     DELIMITED BY SIZE      38392911
383930                                      INTO DP013-MESSAGE-TEXT (2) 38393011
383931              MOVE SQLCA       TO DP013-SQLCA                     38393111
383932              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       38393211
383933              SET DP013-DB2-ABEND TO TRUE                         38393311
383934              PERFORM DP013-0000-PROCESS-ABEND                    38393411
383935               SET  PS-ERROR                                      38393511
383936                    DP020-MSG-FATAL TO TRUE                       38393611
383937              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          38393711
383938                                                                  38393811
383939         WHEN OTHER                                               38393911
383940              INITIALIZE DP013-MESSAGE-TEXT (1)                   38394011
383941              MOVE '4370-CHECK-STORE-SCAN' TO DP013-PARAGRAPH     38394111
383942              MOVE 'ERROR STORE SCAN              '               38394211
383943                                        TO DP013-MESSAGE-TEXT (1) 38394311
383944              STRING  ' CARTON='                                  38394411
383945                      PC046-CARTON-ID      DELIMITED BY SIZE      38394511
383946                                      INTO DP013-MESSAGE-TEXT (2) 38394611
383947              MOVE SQLCA       TO DP013-SQLCA                     38394711
383948              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       38394811
383949              SET DP013-DB2-ABEND TO TRUE                         38394911
383950              PERFORM DP013-0000-PROCESS-ABEND                    38395011
383951              SET  PS-ERROR                                       38395111
383952                   DP020-MSG-FATAL TO TRUE                        38395211
383953              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          38395311
383954     END-EVALUATE.                                                38395411
383955                                                                  38395511
383956                                                                  38395611
383960*----------------------------------------------------------------*38396001
384000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *38400001
384100*----------------------------------------------------------------*38410001
384200 4400-MOVE-COMMAREA-TO-SCREEN.                                    38420001
384300                                                                  38430001
384400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             38440001
384500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          38450001
384600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          38460001
384700             MOVE +1    TO ASC-BLK-SUB                            38470001
384800             PERFORM 5100-WRITE-TEMP-STORAGE                      38480001
384900             ADD +1     TO ASC-BLK-SUB                            38490001
385000             PERFORM 5100-WRITE-TEMP-STORAGE                      38500001
385100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             38510001
385200                 GIVING PV-BLOCK-NUMBER                           38520001
385300                 REMAINDER PV-REMAINDER                           38530001
385400             IF  PV-REMAINDER > ZERO                              38540001
385500                 ADD +1 TO PV-BLOCK-NUMBER                        38550001
385600             END-IF                                               38560001
385700             MOVE +1    TO ASC-BLK-SUB                            38570001
385800             PERFORM 4410-READ-TEMP-STORAGE                       38580001
385900             ADD +1     TO ASC-BLK-SUB                            38590001
386000                           PV-BLOCK-NUMBER                        38600001
386100             PERFORM 4410-READ-TEMP-STORAGE                       38610001
386200     END-IF.                                                      38620001
386300     MOVE +1            TO ASC-BLK-SUB.                           38630001
386400     COMPUTE ASC-ITEM-SUB =                                       38640001
386500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              38650001
386600         + PC-ITEMS-PER-PANEL).                                   38660001
386700                                                                  38670017
386800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38680001
386900         ADD +1         TO ASC-BLK-SUB                            38690001
387000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            38700001
387100     END-IF.                                                      38710001
387200                                                                  38720017
387300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           38730001
387400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                38740001
387500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        38750001
387600     PERFORM 4420-FORMAT-LIST-LINES                               38760001
387700         VARYING PV-SUB                                           38770001
387800         FROM PC-ITEMS-PER-PANEL BY -1                            38780001
387900         UNTIL PV-SUB < +1.                                       38790001
388000                                                                  38800017
388100     COMPUTE ASC-ITEMS-DISPLAYED =                                38810001
388200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          38820001
388300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    38830001
388400                                      ASTRTITO.                   38840001
388500     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    38850001
388600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    38860001
388700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38870001
388800                                   TO ASELITO.                    38880001
388900                                                                  38890001
389000     MOVE ASC-PO-RCVR              TO APORCVRO.                   38900001
389100     IF ASC-LINE-NBR > ZERO                                       38910001
389200         MOVE ASC-LINE-NBR         TO ALINEO                      38920001
389300         MOVE ASC-LINE-STAT        TO ASTATUSO                    38930001
389400     ELSE                                                         38940001
389500         MOVE 'ALL'                TO ALINEO                      38950001
389600         MOVE SPACES               TO ASTATUSO                    38960001
389700     END-IF.                                                      38970001
389800     MOVE ASC-UNTS-VRFD            TO AVERIFDO.                   38980001
389900     MOVE ASC-TOT-CRTNS            TO ATOTCRTNO.                  38990001
390000     MOVE ASC-UNTS-MNFD            TO AMANFSTDO.                  39000001
390100     MOVE ASC-UNTS-VARI            TO AVARINCEO.                  39010001
390200     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     39020001
390300     MOVE ASC-PACKAGE              TO APACKAGEO.                  39030001
390400*----------------------------------------------------------------*39040001
390500* RETRIEVE NAME FROM LOCATION MODULE - XLKUT071.                  39050001
390600*----------------------------------------------------------------*39060001
390700     INITIALIZE XL071-COMMAREA-REC.                               39070001
390800     MOVE ASC-OPER-UNT-ID TO XL071-LOCATION-NUMBER.               39080001
390900                                                                  39090001
391000     CALL PC-LOCATION-MODULE  USING                               39100001
391100                                    DFHEIBLK                      39110001
391200                                    XL071-COMMAREA                39120001
391300                                    XL071-COMMAREA-REC.           39130001
391400                                                                  39140001
391500     EVALUATE TRUE                                                39150001
391600         WHEN XL071-NO-ERRORS                                     39160001
391700             MOVE XL071-LOC-NM           TO ASC-OPER-NAME         39170001
391800         WHEN OTHER                                               39180001
391900             IF  XL071-LOC-TYP-CDE  =  'HQ'                       39190001
392000                 MOVE XL071-LOC-NM           TO ASC-OPER-NAME     39200001
392100             ELSE                                                 39210001
392200                 MOVE 'STORE NAME NOT FOUND' TO ASC-OPER-NAME     39220001
392300             END-IF                                               39230001
392400     END-EVALUATE.                                                39240001
392500                                                                  39250001
392600     MOVE ASC-OPER-NAME              TO ANAMEO.                   39260001
392700     MOVE ASC-UNTS-VARI              TO AVARINCEO.                39270001
392800     MOVE ASC-PACKAGE                TO APACKAGEO.                39280001
393000                                                                  39300001
393100     IF  DP020-MSG-NUMBER-X = SPACE                               39310001
393200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  39320001
393300*            --- MORE ITEMS TO DISPLAY ----                       39330001
393400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            39340001
393500             SET DP020-MSG-INFORMATIONAL TO TRUE                  39350001
393600         END-IF                                                   39360001
393700     END-IF.                                                      39370001
393800                                                                  39380001
393900*----------------------------------------------------------------*39390001
394000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *39400001
394100*----------------------------------------------------------------*39410001
394200 4410-READ-TEMP-STORAGE.                                          39420001
394300                                                                  39430001
394400     EXEC CICS                                                    39440001
394500         READQ TS                                                 39450001
394600             QUEUE (ASC-LIST-QUEUE-NAME)                          39460001
394700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               39470001
394800             ITEM  (PV-BLOCK-NUMBER)                              39480001
394900             RESP  (PV-CICS-RESP)                                 39490001
395000     END-EXEC.                                                    39500001
395100                                                                  39510001
395200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       39520001
395300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     39530001
395400         CONTINUE                                                 39540001
395500     ELSE                                                         39550001
395600         SET DP013-CICS-ABEND     TO TRUE                         39560001
395700         SET DP013-NO-ROLLBACK    TO TRUE                         39570001
395800         MOVE '4410-READ-TEMP-STORAGE'                            39580001
395900                                  TO DP013-PARAGRAPH              39590001
396000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      39600001
396100                                  TO DP013-MESSAGE-TEXT(1)        39610001
396200         PERFORM DP013-0000-PROCESS-ABEND                         39620001
396300     END-IF.                                                      39630001
396400                                                                  39640001
396500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             39650001
396600                                                                  39660017
396700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         39670001
396800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               39680001
396900     END-IF.                                                      39690001
397000                                                                  39700001
397100*----------------------------------------------------------------*39710001
397200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *39720001
397300*----------------------------------------------------------------*39730001
397400 4420-FORMAT-LIST-LINES.                                          39740001
397500                                                                  39750001
397600     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      39760001
397700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                39770001
397800         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           39780001
397900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           39790001
398000         MOVE SPACE              TO MR-SELECTI (PV-SUB)           39800001
398100                                    MR-ACTION (PV-SUB)            39810001
398200                                    MR-SML (PV-SUB)               39820001
398300                                    MR-MASTER (PV-SUB)            39830001
398400                                    MR-CREATE (PV-SUB)            39840001
398410                                    MR-STR-SCAN (PV-SUB)          39841007
398500                                    MR-STAT-DATE (PV-SUB)         39850001
398600                                    MR-STAT-TIME (PV-SUB)         39860001
398700                                    MR-LOAD-STATUS (PV-SUB)       39870001
398800                                    MR-TRIP-ID (PV-SUB)           39880001
398900                                    MR-UNTS-MNFSTD-X (PV-SUB)     39890001
399000         MOVE ZEROES            TO  MR-DEST-NBR (PV-SUB)          39900001
399100     ELSE                                                         39910001
399200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      39920001
399300                                                   > SPACE        39930001
399400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 39940001
399500                                 TO MR-SELECTI (PV-SUB)           39950001
399600         ELSE                                                     39960001
399700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      39970001
399800                                 TO MR-SELECTI (PV-SUB)           39980001
399900         END-IF                                                   39990001
400000         IF  DP030-SET-CURSOR-TRAILER                             40000001
400100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)40010001
400200                 > SPACE)                                         40020001
400300               OR (PV-SUB = 1))                                   40030001
400400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               40040001
400500                MOVE -1               TO MR-SELECTL (PV-SUB)      40050001
400600             END-IF                                               40060001
400700         END-IF                                                   40070001
400900                                                                  40090001
401000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               40100001
401100                                            TO MR-ACTION (PV-SUB) 40110001
401200         MOVE ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB)                  40120001
401300                                               TO MR-SML (PV-SUB) 40130001
401400         MOVE ASC-MASTER (ASC-BLK-SUB ASC-ITEM-SUB)               40140001
401500                                          TO MR-MASTER (PV-SUB)   40150001
401600         MOVE ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             40160001
401700                                          TO MR-DEST-NBR (PV-SUB) 40170001
401800         MOVE ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)               40180001
401900                                            TO MR-CREATE (PV-SUB) 40190001
401910         MOVE ASC-STORE-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)           40191007
401920                                          TO MR-STR-SCAN (PV-SUB) 40192007
401930         IF  ASC-MULT-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)             40193011
401940             MOVE DP015-RED               TO MR-STR-SCANC(PV-SUB) 40194011
401950         END-IF                                                   40195011
402000         MOVE ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            40200001
402100                                         TO MR-STAT-DATE (PV-SUB) 40210001
402200         MOVE ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            40220001
402300                                         TO MR-STAT-TIME (PV-SUB) 40230001
402400         MOVE ASC-UNTS-MNFSTD (ASC-BLK-SUB ASC-ITEM-SUB)          40240001
402500                                       TO MR-UNTS-MNFSTD (PV-SUB) 40250001
402600         MOVE ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)          40260001
402700                                       TO MR-LOAD-STATUS (PV-SUB) 40270001
402800         MOVE ASC-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)              40280001
402900                                           TO MR-TRIP-ID (PV-SUB) 40290001
403000         IF ASC-DOOR-TYP-CDE (ASC-BLK-SUB ASC-ITEM-SUB)           40300001
403100            NOT = 'SH'                                            40310001
403200               MOVE DP015-YELLOW         TO MR-TRIP-IDC (PV-SUB)  40320001
403300               MOVE -1                   TO MR-TRIP-IDL (PV-SUB)  40330001
403400         ELSE                                                     40340001
403500               MOVE DP015-BLUE           TO MR-TRIP-IDC (PV-SUB)  40350001
403600               MOVE 0                    TO MR-TRIP-IDL (PV-SUB)  40360001
403700         END-IF                                                   40370001
403800     END-IF.                                                      40380001
403900     SUBTRACT +1 FROM ASC-ITEM-SUB                                40390001
404000     IF  ASC-ITEM-SUB < + 1                                       40400001
404100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  40410001
404200         MOVE +1                 TO ASC-BLK-SUB                   40420001
404300     END-IF.                                                      40430001
404400                                                                  40440001
404500******************************************************************40450001
404600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **40460001
404700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **40470001
404800** ISSUE A WARNING.                                             **40480001
404900******************************************************************40490001
405000 4430-CHECK-FOR-BEGIN-AND-END.                                    40500001
405100                                                                  40510001
405200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       40520001
405300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     40530001
405400*            -- NO END-OF-RANGE SPECFIED ---                      40540001
405500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            40550001
405600             SET DP020-MSG-WARNING TO TRUE                        40560001
405700             PERFORM 4431-POSITION-AT-WARNING                     40570001
405800         END-IF                                                   40580001
405900     ELSE                                                         40590001
406000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     40600001
406100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                40610001
406200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            40620001
406300             SET DP020-MSG-WARNING TO TRUE                        40630001
406400             PERFORM 4431-POSITION-AT-WARNING                     40640001
406500         END-IF                                                   40650001
406600     END-IF.                                                      40660001
406700******************************************************************40670001
406800** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **40680001
406900** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **40690001
407000** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **40700001
407100** POSITION THE CURSOR THERE.                                   **40710001
407200******************************************************************40720001
407300 4431-POSITION-AT-WARNING.                                        40730001
407400                                                                  40740001
407500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 40750001
407600                    - PV-TOP-ITEM + 1.                            40760001
407700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      40770001
407800         CONTINUE                                                 40780001
407900     ELSE                                                         40790001
408000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      40800001
408100         MOVE -1                   TO MR-SELECTL (PV-SUB)         40810001
408200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         40820001
408300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         40830001
408400     END-IF.                                                      40840001
408500                                                                  40850017
408600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   40860001
408700                    - PV-TOP-ITEM + 1.                            40870001
408800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      40880001
408900         CONTINUE                                                 40890001
409000     ELSE                                                         40900001
409100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      40910001
409200         MOVE -1                   TO MR-SELECTL (PV-SUB)         40920001
409300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         40930001
409400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         40940001
409500     END-IF.                                                      40950001
409600                                                                  40960001
409700*--------------------------------------------------------------   40970001
409800* THIS PARAGRAPH CREATES THE NOT LOADED CARTON LIST               40980001
409900*--------------------------------------------------------------   40990001
410000 4500-READ-ITEMS-FROM-DB.                                         41000001
410100                                                                  41010001
410200     PERFORM                                                      41020001
410300         VARYING PV-READ-COUNT                                    41030001
410400         FROM 1 BY 1                                              41040001
410500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    41050001
410600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         41060001
410700                                                                  41070001
410800         IF  ASC-FX-FAST-TRAN                                     41080001
410900             PERFORM 8320-FETCH-FX-CURSOR                         41090001
411000         ELSE                                                     41100001
411100             PERFORM 4310-FETCH                                   41110001
411200         END-IF                                                   41120001
411300                                                                  41130001
411400         IF  ASC-ITEMS-LEFT-ON-DB                                 41140001
411500             PERFORM 4350-CARTON-INFO                             41150001
411600             IF PS-NO-ERROR                                       41160001
411700               IF PC046-CRTN-STATUS = '04' OR '06'                41170001
411800                       CONTINUE                                   41180001
411900               ELSE                                               41190001
412000                  IF PC046-BEGIN-DIVERT OR  PC046-END-DIVERT      41200001
412100                       CONTINUE                                   41210001
412200                  ELSE                                            41220001
412300                     IF PC046-CRTN-STATUS =  '05'                 41230001
412400                         PERFORM 4305-CHECK-ASSUMED               41240001
412500                         IF PS-ASSUMED                            41250001
412600                             CONTINUE                             41260001
412700                         ELSE                                     41270001
412710                                                                  41271017
412720*       AT THIS POINT THE CARTON IS NOT MANIFESTED TO A TRAILER   41272014
412730                                                                  41273017
412800                             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL41280001
412900                                 ADD +1            TO ASC-ITEM-SUB41290001
413000                             ELSE                                 41300001
413100                                 ADD +1            TO ASC-BLK-SUB 41310001
413200                                 MOVE +1           TO ASC-ITEM-SUB41320001
413300                                 IF  ASC-BLK-SUB >                41330001
413400                                            PC-MAX-BLOCKS-IN-ARRAY41340001
413500                                     MOVE +1       TO ASC-BLK-SUB 41350001
413600                                     SET ASC-BLOCK-MODIFIED (1)   41360001
413700                                                           TO TRUE41370001
413800                                   PERFORM 5100-WRITE-TEMP-STORAGE41380001
413900                                     MOVE ASC-BLOCK-ENTRIES       41390001
414000                                       (PC-MAX-BLOCKS-IN-ARRAY) TO41400001
414100                                    ASC-BLOCK-ENTRIES(ASC-BLK-SUB)41410001
414200                                    ADD +1        TO ASC-BLK-SUB  41420001
414300                                    INITIALIZE ASC-BLOCK-ENTRIES  41430001
414400                                                     (ASC-BLK-SUB)41440001
414500                                    SET ASC-BLOCK-NOT-MODIFIED    41450001
414600                                             (ASC-BLK-SUB) TO TRUE41460001
414700                                 END-IF                           41470001
414800                             END-IF                               41480001
414900                             ADD +1  TO ASC-NUMBER-OF-ITEMS-READ  41490001
415000                             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)  41500001
415100                                                           TO TRUE41510001
415200                             MOVE ASC-NUMBER-OF-ITEMS-READ        41520001
415300                                           TO ASC-LIST-ITEM-NUMBER41530001
415400                                        (ASC-BLK-SUB ASC-ITEM-SUB)41540001
415500                             MOVE SPACES TO ASC-ACTION            41550001
415600                                        (ASC-BLK-SUB ASC-ITEM-SUB)41560001
415700                            MOVE DK-DVRT-DESC TO ASC-LOAD-STATUS  41570001
415800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41580001
415900                            MOVE 0 TO PS-LOAD-STATUS-SW           41590001
416000                        MOVE PC046-KOHLS-BARCODE                  41600001
416100                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 41610001
416200                                                                  41620017
416300                        MOVE PC046-VENDOR-SHIPT-UNT-ID  TO        41630001
416400                                                DK-SHIPT-UNT-ID   41640001
416500                                                                  41650017
416600                        IF (SUT00024-PRNT-CART-ID                 41660001
416700                                             = DK-SHIPT-UNT-ID AND41670001
416800                           SUT00024-MSTR-CART-IND NOT = 'Y')      41680001
416900                           OR SUT00024-PRNT-CART-ID  =  0         41690001
417000                            MOVE SPACES                           41700001
417100                                 TO ASC-MASTER                    41710001
417200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41720001
417300                        ELSE                                      41730001
417400                             IF SUT00024-MSTR-CART-IND  = 'Y'     41740001
417500                                 MOVE 'M' TO ASC-MASTER           41750001
417600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41760001
417700                             ELSE                                 41770001
417800                                 MOVE 'C' TO ASC-MASTER           41780001
417900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41790001
418000                             END-IF                               41800001
418100                        END-IF                                    41810001
418200                        MOVE PC046-DEST-OPER-UNT-ID TO            41820001
418300                           ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)41830001
418400                             DK-STR-BEGIN                         41840001
418500                             DK-STR-END                           41850001
418600                        MOVE PC046-SHPUNT-SRC-ID                  41860001
418700                          TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)41870001
418800                        MOVE PC046-CRTN-STAT-TMST   TO PV-TMST    41880001
418900                        PERFORM 4300A-FORMAT-DATE-TIME            41890001
419000                        STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)  41900001
419100                        DELIMITED BY SIZE INTO ASC-STAT-DATE      41910001
419200                                        (ASC-BLK-SUB ASC-ITEM-SUB)41920001
419300                        MOVE PV-JIS-TIME TO ASC-STAT-TIME         41930001
419400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41940001
419500                        MOVE PC046-VENDOR-SHIPT-UNT-ID  TO        41950001
419600                                                DK-SHIPT-UNT-ID   41960001
419700                        MOVE ZEROES TO PV-SHPD-QTY                41970001
419800                        PERFORM 4360-GET-SHPD-QTY                 41980001
419900                        MOVE PV-SHPD-QTY TO ASC-UNTS-MNFSTD       41990001
420000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42000001
420100                        MOVE PC046-OTBD-TRIP-ID   TO ASC-TRIP-ID-N42010001
420200                                        (ASC-BLK-SUB ASC-ITEM-SUB)42020001
420300                        MOVE PC046-DOOR-TYP-CDE TO                42030001
420400                       ASC-DOOR-TYP-CDE (ASC-BLK-SUB ASC-ITEM-SUB)42040001
420500                        END-IF                                    42050001
420600                     ELSE                                         42060001
420700                         IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL    42070001
420800                             ADD +1            TO ASC-ITEM-SUB    42080001
420900                         ELSE                                     42090001
421000                             ADD +1            TO ASC-BLK-SUB     42100001
421100                             MOVE +1           TO ASC-ITEM-SUB    42110001
421200                             IF  ASC-BLK-SUB >                    42120001
421300                                            PC-MAX-BLOCKS-IN-ARRAY42130001
421400                                 MOVE +1       TO ASC-BLK-SUB     42140001
421500                                 SET ASC-BLOCK-MODIFIED (1)       42150001
421600                                                           TO TRUE42160001
421700                                 PERFORM 5100-WRITE-TEMP-STORAGE  42170001
421800                                 MOVE ASC-BLOCK-ENTRIES           42180001
421900                                       (PC-MAX-BLOCKS-IN-ARRAY) TO42190001
422000                                    ASC-BLOCK-ENTRIES(ASC-BLK-SUB)42200001
422100                                 ADD +1        TO ASC-BLK-SUB     42210001
422200                                 INITIALIZE ASC-BLOCK-ENTRIES     42220001
422300                                                     (ASC-BLK-SUB)42230001
422400                                 SET ASC-BLOCK-NOT-MODIFIED       42240001
422500                                             (ASC-BLK-SUB) TO TRUE42250001
422600                             END-IF                               42260001
422700                         END-IF                                   42270001
422800                        ADD +1  TO ASC-NUMBER-OF-ITEMS-READ       42280001
422900                        SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)       42290001
423000                                                           TO TRUE42300001
423100                        MOVE ASC-NUMBER-OF-ITEMS-READ             42310001
423200                                           TO ASC-LIST-ITEM-NUMBER42320001
423300                                        (ASC-BLK-SUB ASC-ITEM-SUB)42330001
423400                        MOVE SPACES TO ASC-ACTION                 42340001
423500                                        (ASC-BLK-SUB ASC-ITEM-SUB)42350001
423600                       EVALUATE PC046-CRTN-STATUS                 42360001
423700                          WHEN '01'                               42370001
423800                              MOVE DK-INVALID-DESC TO             42380001
423900                                                  ASC-LOAD-STATUS 42390001
424000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42400001
424100                          WHEN '02'                               42410001
424200                              MOVE DK-INACT-DESC TO               42420001
424300                                                   ASC-LOAD-STATUS42430001
424400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42440001
424500                          WHEN '03'                               42450001
424600                              MOVE DK-SC-OF-DESC TO               42460001
424700                                                   ASC-LOAD-STATUS42470001
424800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42480001
424900                          WHEN '07'                               42490001
425000                              MOVE DK-CSEPK-DESC  TO              42500001
425100                                                   ASC-LOAD-STATUS42510001
425200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42520001
425300                          WHEN '08'                               42530001
425400                              MOVE DK-CK-IN-DESC  TO              42540001
425500                                                   ASC-LOAD-STATUS42550001
425600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42560001
425700                          WHEN '09'                               42570001
425800                              MOVE DK-P2L-DESC    TO              42580001
425900                                                   ASC-LOAD-STATUS42590001
426000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42600001
426100                          WHEN '10'                               42610001
426200                              MOVE DK-RDM-DESC TO                 42620001
426300                                                   ASC-LOAD-STATUS42630001
426400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42640001
426500                          WHEN '11'                               42650001
426600                               MOVE DK-RECV-DESC   TO             42660001
426700                                                   ASC-LOAD-STATUS42670001
426800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42680001
426900                          WHEN '12'                               42690001
427000                              MOVE DK-ASN-DESC TO  ASC-LOAD-STATUS42700001
427100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42710001
427200                          WHEN '13'                               42720001
427300                              MOVE DK-SMTH-DESC TO ASC-LOAD-STATUS42730001
427400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42740001
427500                          WHEN '14'                               42750001
427600                              MOVE DK-XFER-DESC TO ASC-LOAD-STATUS42760001
427700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42770001
427800                          WHEN '15'                               42780001
427900                              MOVE DK-MSTR-DESC   TO              42790001
428000                                                   ASC-LOAD-STATUS42800001
428100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42810001
428200                           WHEN '16'                              42820001
428300                               MOVE DK-BLD-DESC TO ASC-LOAD-STATUS42830001
428400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42840001
428500                           WHEN '17'                              42850001
428600                               MOVE 'JEWELRY'   TO ASC-LOAD-STATUS42860001
428700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42870001
428800                           WHEN '18'                              42880001
428900                               MOVE 'DAMAGED'   TO ASC-LOAD-STATUS42890001
429000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42900001
429010                           WHEN '19'                              42901017
429020                               MOVE DK-3WD-DESC TO ASC-LOAD-STATUS42902017
429030                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42903017
429100                       END-EVALUATE                               42910001
429200                       MOVE PC046-KOHLS-BARCODE                   42920001
429300                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 42930001
429400                                                                  42940017
429500                       MOVE PC046-VENDOR-SHIPT-UNT-ID  TO         42950001
429600                                                DK-SHIPT-UNT-ID   42960001
429700                                                                  42970017
429800                       IF (SUT00024-PRNT-CART-ID  =               42980001
429900                                 DK-SHIPT-UNT-ID AND              42990001
430000                             SUT00024-MSTR-CART-IND NOT = 'Y')    43000001
430100                          OR SUT00024-PRNT-CART-ID  =  0          43010001
430200                            MOVE SPACES                           43020001
430300                                 TO ASC-MASTER                    43030001
430400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43040001
430500                       ELSE                                       43050001
430600                             IF SUT00024-MSTR-CART-IND  = 'Y'     43060001
430700                                 MOVE 'M' TO ASC-MASTER           43070001
430800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43080001
430900                             ELSE                                 43090001
431000                                 MOVE 'C' TO ASC-MASTER           43100001
431100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43110001
431200                             END-IF                               43120001
431300                       END-IF                                     43130001
431400                       MOVE PC046-DEST-OPER-UNT-ID TO             43140001
431500                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 43150001
431600                          DK-STR-BEGIN                            43160001
431700                          DK-STR-END                              43170001
431800                       MOVE PC046-SHPUNT-SRC-ID                   43180001
431900                          TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)43190001
432000                       MOVE PC046-CRTN-STAT-TMST   TO PV-TMST     43200001
432100                       PERFORM 4300A-FORMAT-DATE-TIME             43210001
432200                       STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)   43220001
432300                           DELIMITED BY SIZE                      43230001
432400                           INTO ASC-STAT-DATE                     43240001
432500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43250001
432600                       MOVE PV-JIS-TIME                           43260001
432700                       TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)43270001
432800                       MOVE PC046-VENDOR-SHIPT-UNT-ID  TO         43280001
432900                                                 DK-SHIPT-UNT-ID  43290001
433000                       MOVE ZEROES TO PV-SHPD-QTY                 43300001
433100                       PERFORM 4360-GET-SHPD-QTY                  43310001
433200                       MOVE PV-SHPD-QTY TO ASC-UNTS-MNFSTD        43320001
433300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 43330001
433400                       MOVE PC046-OTBD-TRIP-ID                    43340001
433500                       TO ASC-TRIP-ID-N (ASC-BLK-SUB ASC-ITEM-SUB)43350001
433600                       MOVE PC046-DOOR-TYP-CDE TO                 43360001
433700                       ASC-DOOR-TYP-CDE (ASC-BLK-SUB ASC-ITEM-SUB)43370001
433710                                                                  43371017
433720                       MOVE  SUT00028-SHIPT-UNT-ID                43372013
433730                         TO  SUT00121-SHIPT-UNT-ID                43373013
433740                       PERFORM 4370-CHECK-STORE-SCAN              43374013
433750                                                                  43375017
433800                     END-IF                                       43380001
433900                  END-IF                                          43390001
434000               END-IF                                             43400001
434100             END-IF                                               43410001
434200         END-IF                                                   43420001
434300     END-PERFORM.                                                 43430001
434400                                                                  43440001
434500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          43450001
434600         MOVE +1               TO ASC-BLK-SUB                     43460001
434700         PERFORM 5100-WRITE-TEMP-STORAGE                          43470001
434800         ADD +1                TO ASC-BLK-SUB                     43480001
434900         PERFORM 5100-WRITE-TEMP-STORAGE                          43490001
435000                                                                  43500001
435100         MOVE 1                TO ASC-BLK-SUB                     43510001
435200                                  PV-BLOCK-NUMBER                 43520001
435300         PERFORM 4410-READ-TEMP-STORAGE                           43530001
435400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             43540001
435500             MOVE 2            TO ASC-BLK-SUB                     43550001
435600                                  PV-BLOCK-NUMBER                 43560001
435700             PERFORM 4410-READ-TEMP-STORAGE                       43570001
435800         END-IF                                                   43580001
435900     END-IF.                                                      43590001
436000                                                                  43600001
436100*--------------------------------------------------------------   43610001
436200* THIS PARAGRAPH CREATES THE LOADED CARTON LIST                   43620001
436300*--------------------------------------------------------------   43630001
436400 4700-READ-ITEMS-FROM-DB.                                         43640001
436500                                                                  43650001
436600     PERFORM                                                      43660001
436700         VARYING PV-READ-COUNT                                    43670001
436800         FROM 1 BY 1                                              43680001
436900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    43690001
437000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         43700001
437100                                                                  43710001
437200         PERFORM 4310-FETCH                                       43720001
437300                                                                  43730001
437400         IF  ASC-ITEMS-LEFT-ON-DB                                 43740001
437500             PERFORM 4350-CARTON-INFO                             43750001
437600             IF PS-NO-ERROR                                       43760001
437700                 IF PC046-CRTN-STATUS = '01' OR '02' OR '03' OR   43770001
437800                                        '07' OR '08' OR '09' OR   43780001
437900                                        '10' OR '11' OR '12' OR   43790001
438000                                        '13' OR '14' OR '15' OR   43800001
438100                                        '16' OR '19'              43810017
438200                     CONTINUE                                     43820001
438300                 ELSE                                             43830001
438400                     IF PC046-CRTN-STATUS =  '05'                 43840001
438500                         PERFORM 4305-CHECK-ASSUMED               43850001
438600                         IF PS-DIVERTED                           43860001
438700                             CONTINUE                             43870001
438800                         ELSE                                     43880001
438900                             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL43890001
439000                                 ADD +1            TO ASC-ITEM-SUB43900001
439100                             ELSE                                 43910001
439200                                 ADD +1            TO ASC-BLK-SUB 43920001
439300                                 MOVE +1           TO ASC-ITEM-SUB43930001
439400                                 IF  ASC-BLK-SUB >                43940001
439500                                            PC-MAX-BLOCKS-IN-ARRAY43950001
439600                                     MOVE +1       TO ASC-BLK-SUB 43960001
439700                                     SET ASC-BLOCK-MODIFIED (1)   43970001
439800                                                           TO TRUE43980001
439900                                   PERFORM 5100-WRITE-TEMP-STORAGE43990001
440000                                     MOVE ASC-BLOCK-ENTRIES       44000001
440100                                       (PC-MAX-BLOCKS-IN-ARRAY) TO44010001
440200                                    ASC-BLOCK-ENTRIES(ASC-BLK-SUB)44020001
440300                                    ADD +1        TO ASC-BLK-SUB  44030001
440400                                    INITIALIZE ASC-BLOCK-ENTRIES  44040001
440500                                                     (ASC-BLK-SUB)44050001
440600                                    SET ASC-BLOCK-NOT-MODIFIED    44060001
440700                                             (ASC-BLK-SUB) TO TRUE44070001
440800                                 END-IF                           44080001
440900                             END-IF                               44090001
441000                             ADD +1  TO ASC-NUMBER-OF-ITEMS-READ  44100001
441100                             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)  44110001
441200                                                           TO TRUE44120001
441300                             MOVE ASC-NUMBER-OF-ITEMS-READ        44130001
441400                                           TO ASC-LIST-ITEM-NUMBER44140001
441500                                        (ASC-BLK-SUB ASC-ITEM-SUB)44150001
441600                             MOVE SPACES TO ASC-ACTION            44160001
441700                                        (ASC-BLK-SUB ASC-ITEM-SUB)44170001
441800                            MOVE DK-ASSUM-DESC TO ASC-LOAD-STATUS 44180001
441900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44190001
442000                            MOVE 0 TO PS-LOAD-STATUS-SW           44200001
442100                            MOVE PC046-KOHLS-BARCODE              44210001
442200                             TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB)44220001
442300                                                                  44230017
442400                            MOVE PC046-VENDOR-SHIPT-UNT-ID  TO    44240001
442500                                                DK-SHIPT-UNT-ID   44250001
442600                                                                  44260017
442700                            IF (SUT00024-PRNT-CART-ID  =          44270001
442800                                 DK-SHIPT-UNT-ID AND              44280001
442900                             SUT00024-MSTR-CART-IND NOT = 'Y')    44290001
443000                               OR SUT00024-PRNT-CART-ID  =  0     44300001
443100                                MOVE SPACES                       44310001
443200                                 TO ASC-MASTER                    44320001
443300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44330001
443400                            ELSE                                  44340001
443500                                IF SUT00024-MSTR-CART-IND  = 'Y'  44350001
443600                                   MOVE 'M' TO ASC-MASTER         44360001
443700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44370001
443800                                ELSE                              44380001
443900                                    MOVE 'C' TO ASC-MASTER        44390001
444000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44400001
444100                                 END-IF                           44410001
444200                            END-IF                                44420001
444300                            MOVE PC046-DEST-OPER-UNT-ID TO        44430001
444400                           ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)44440001
444500                             DK-STR-BEGIN                         44450001
444600                             DK-STR-END                           44460001
444700                            MOVE PC046-SHPUNT-SRC-ID              44470001
444800                          TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)44480001
444900                            MOVE PC046-CRTN-STAT-TMST   TO PV-TMST44490001
445000                            PERFORM 4300A-FORMAT-DATE-TIME        44500001
445100                          STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)44510001
445200                            DELIMITED BY SIZE INTO ASC-STAT-DATE  44520001
445300                                        (ASC-BLK-SUB ASC-ITEM-SUB)44530001
445400                            MOVE PV-JIS-TIME TO ASC-STAT-TIME     44540001
445500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44550001
445600                            MOVE PC046-VENDOR-SHIPT-UNT-ID  TO    44560001
445700                                                DK-SHIPT-UNT-ID   44570001
445800                            MOVE ZEROES TO PV-SHPD-QTY            44580001
445900                            PERFORM 4360-GET-SHPD-QTY             44590001
446000                            MOVE PV-SHPD-QTY TO ASC-UNTS-MNFSTD   44600001
446100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 44610001
446200                          MOVE PC046-OTBD-TRIP-ID TO ASC-TRIP-ID-N44620001
446300                                        (ASC-BLK-SUB ASC-ITEM-SUB)44630001
446400                          MOVE PC046-DOOR-TYP-CDE TO              44640001
446500                                        ASC-DOOR-TYP-CDE          44650001
446600                                        (ASC-BLK-SUB ASC-ITEM-SUB)44660001
446700                            END-IF                                44670001
446800                         ELSE                                     44680001
446900                             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL44690001
447000                                 ADD +1            TO ASC-ITEM-SUB44700001
447100                             ELSE                                 44710001
447200                                 ADD +1            TO ASC-BLK-SUB 44720001
447300                                 MOVE +1           TO ASC-ITEM-SUB44730001
447400                                 IF  ASC-BLK-SUB >                44740001
447500                                            PC-MAX-BLOCKS-IN-ARRAY44750001
447600                                     MOVE +1       TO ASC-BLK-SUB 44760001
447700                                     SET ASC-BLOCK-MODIFIED (1)   44770001
447800                                                           TO TRUE44780001
447900                                   PERFORM 5100-WRITE-TEMP-STORAGE44790001
448000                                     MOVE ASC-BLOCK-ENTRIES       44800001
448100                                       (PC-MAX-BLOCKS-IN-ARRAY) TO44810001
448200                                    ASC-BLOCK-ENTRIES(ASC-BLK-SUB)44820001
448300                                     ADD +1        TO ASC-BLK-SUB 44830001
448400                                     INITIALIZE ASC-BLOCK-ENTRIES 44840001
448500                                                     (ASC-BLK-SUB)44850001
448600                                     SET ASC-BLOCK-NOT-MODIFIED   44860001
448700                                             (ASC-BLK-SUB) TO TRUE44870001
448800                                 END-IF                           44880001
448900                             END-IF                               44890001
449000                            ADD +1  TO ASC-NUMBER-OF-ITEMS-READ   44900001
449100                            SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)   44910001
449200                                                           TO TRUE44920001
449300                            MOVE ASC-NUMBER-OF-ITEMS-READ         44930001
449400                                           TO ASC-LIST-ITEM-NUMBER44940001
449500                                        (ASC-BLK-SUB ASC-ITEM-SUB)44950001
449600                            MOVE SPACES TO ASC-ACTION             44960001
449700                                        (ASC-BLK-SUB ASC-ITEM-SUB)44970001
449800                            EVALUATE PC046-CRTN-STATUS            44980001
449900                                WHEN '04'                         44990001
450000                                    MOVE DK-SC-ON-DESC  TO        45000001
450100                                            ASC-LOAD-STATUS       45010001
450200                                        (ASC-BLK-SUB ASC-ITEM-SUB)45020001
450300                                WHEN '06'                         45030001
450400                                    MOVE DK-LOADED-DESC TO        45040001
450500                                             ASC-LOAD-STATUS      45050001
450600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45060001
450700                            END-EVALUATE                          45070001
450800                            IF PC046-BEGIN-DIVERT                 45080001
450900                                MOVE 'DVT BEG' TO ASC-LOAD-STATUS 45090001
451000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  45100001
451100                            ELSE                                  45110001
451200                                IF PC046-END-DIVERT               45120001
451300                                 MOVE 'DVT END' TO ASC-LOAD-STATUS45130001
451400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  45140001
451500                                END-IF                            45150001
451600                            END-IF                                45160001
451700                           MOVE PC046-KOHLS-BARCODE               45170001
451800                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 45180001
451900                           MOVE PC046-VENDOR-SHIPT-UNT-ID  TO     45190001
452000                                                 DK-SHIPT-UNT-ID  45200001
452100                           IF (SUT00024-PRNT-CART-ID  =           45210001
452200                                 DK-SHIPT-UNT-ID AND              45220001
452300                             SUT00024-MSTR-CART-IND NOT = 'Y')    45230001
452400                              OR SUT00024-PRNT-CART-ID  =  0      45240001
452500                                MOVE SPACES                       45250001
452600                                 TO ASC-MASTER                    45260001
452700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45270001
452800                           ELSE                                   45280001
452900                               IF SUT00024-MSTR-CART-IND  = 'Y'   45290001
453000                                   MOVE 'M' TO ASC-MASTER         45300001
453100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45310001
453200                               ELSE                               45320001
453300                                   MOVE 'C' TO ASC-MASTER         45330001
453400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45340001
453500                               END-IF                             45350001
453600                           END-IF                                 45360001
453700                           MOVE PC046-DEST-OPER-UNT-ID TO         45370001
453800                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 45380001
453900                          DK-STR-BEGIN                            45390001
454000                          DK-STR-END                              45400001
454100                           MOVE PC046-SHPUNT-SRC-ID               45410001
454200                          TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)45420001
454300                           MOVE PC046-CRTN-STAT-TMST   TO PV-TMST 45430001
454400                           PERFORM 4300A-FORMAT-DATE-TIME         45440001
454500                          STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)45450001
454600                             DELIMITED BY SIZE                    45460001
454700                             INTO ASC-STAT-DATE                   45470001
454800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45480001
454900                           MOVE PV-JIS-TIME                       45490001
455000                       TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)45500001
455100                           MOVE ZEROES TO PV-SHPD-QTY             45510001
455200                           PERFORM 4360-GET-SHPD-QTY              45520001
455300                           MOVE PV-SHPD-QTY TO ASC-UNTS-MNFSTD    45530001
455400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 45540001
455500                           MOVE PC046-OTBD-TRIP-ID  TO            45550001
455600                          ASC-TRIP-ID-N (ASC-BLK-SUB ASC-ITEM-SUB)45560001
455700                           MOVE PC046-DOOR-TYP-CDE TO             45570001
455800                                        ASC-DOOR-TYP-CDE          45580001
455900                                        (ASC-BLK-SUB ASC-ITEM-SUB)45590001
456000                    END-IF                                        45600001
456100                END-IF                                            45610001
456110                                                                  45611017
456120                MOVE  SUT00028-SHIPT-UNT-ID                       45612010
456130                  TO  SUT00121-SHIPT-UNT-ID                       45613007
456140                PERFORM 4370-CHECK-STORE-SCAN                     45614007
456150                                                                  45615017
456200             END-IF                                               45620001
456300         END-IF                                                   45630001
456400     END-PERFORM.                                                 45640001
456500                                                                  45650001
456600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          45660001
456700         MOVE +1               TO ASC-BLK-SUB                     45670001
456800         PERFORM 5100-WRITE-TEMP-STORAGE                          45680001
456900         ADD +1                TO ASC-BLK-SUB                     45690001
457000         PERFORM 5100-WRITE-TEMP-STORAGE                          45700001
457100                                                                  45710001
457200         MOVE 1                TO ASC-BLK-SUB                     45720001
457300                                  PV-BLOCK-NUMBER                 45730001
457400         PERFORM 4410-READ-TEMP-STORAGE                           45740001
457500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             45750001
457600             MOVE 2            TO ASC-BLK-SUB                     45760001
457700                                  PV-BLOCK-NUMBER                 45770001
457800             PERFORM 4410-READ-TEMP-STORAGE                       45780001
457900         END-IF                                                   45790001
458000     END-IF.                                                      45800001
458100                                                                  45810001
458200*----------------------------------------------------------------*45820001
458300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *45830001
458400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *45840001
458500* FOR THE SELECTED ITEMS QUEUE.                                  *45850001
458600*                                                                *45860001
458700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *45870001
458800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *45880001
458900* THE ARRAY IS FULL.                                             *45890001
459000*----------------------------------------------------------------*45900001
459100 5000-PREPARE-SEL-QUEUE.                                          45910001
459200                                                                  45920001
459300     MOVE +1                   TO  ASC-BLK-SUB.                   45930001
459400     PERFORM 5100-WRITE-TEMP-STORAGE.                             45940001
459500     ADD +1                    TO  ASC-BLK-SUB.                   45950001
459600     PERFORM 5100-WRITE-TEMP-STORAGE.                             45960001
459700                                                                  45970001
459800     MOVE ASC-SEL-QUEUE-NAME-OUT   TO  SU009-SEL-QUEUE-NAME.      45980001
459900     PERFORM 6010-DELETE-SEL-QUEUE.                               45990001
460000                                                                  46000001
460100     SET ASC-UPDATE-TSQ        TO  TRUE.                          46010001
460200                                                                  46020001
460300     SET SU010-IDX             TO  1.                             46030001
460400     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       46040001
460500     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        46050001
460600                                                                  46060001
460700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           46070001
460800             VARYING PV-ITEM                                      46080001
460900             FROM 1 BY 1                                          46090001
461000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     46100001
461100                                                                  46110001
461200     IF  SU010-IDX > 1                                            46120001
461300         PERFORM 5205-WRITE-SEL-QUEUE                             46130001
461400         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        46140001
461500     END-IF.                                                      46150001
461600*----------------------------------------------------------------*46160001
461700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *46170001
461800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *46180001
461900*----------------------------------------------------------------*46190001
462000 5100-WRITE-TEMP-STORAGE.                                         46200001
462100                                                                  46210001
462200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     46220001
462300                                   TO PV-LIST-ITEM-NUMBER.        46230001
462400     COMPUTE PV-BLOCK-NUMBER =                                    46240001
462500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    46250001
462600                                                                  46260001
462700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             46270001
462800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             46280001
462900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      46290001
463000             PERFORM 5105-REWRITE-ASC-LISTQ                       46300001
463100         END-IF                                                   46310001
463200     ELSE                                                         46320001
463300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       46330001
463400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            46340001
463500         PERFORM 5110-WRITE-ASC-LISTQ                             46350001
463600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   46360001
463700     END-IF.                                                      46370001
463800                                                                  46380001
463900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             46390001
464000                                                                  46400001
464100******************************************************************46410001
464200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **46420001
464300** SPECIFIC COMMAREA.                                           **46430001
464400******************************************************************46440001
464500 5105-REWRITE-ASC-LISTQ.                                          46450001
464600                                                                  46460001
464700     EXEC CICS                                                    46470001
464800         WRITEQ TS                                                46480001
464900             QUEUE (ASC-LIST-QUEUE-NAME)                          46490001
465000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               46500001
465100             ITEM  (PV-BLOCK-NUMBER)                              46510001
465200             REWRITE                                              46520001
465300             RESP  (PV-CICS-RESP)                                 46530001
465400     END-EXEC.                                                    46540001
465500                                                                  46550001
465600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           46560001
465700         CONTINUE                                                 46570001
465800     ELSE                                                         46580001
465900         SET DP013-CICS-ABEND            TO TRUE                  46590001
466000         SET DP013-NO-ROLLBACK           TO TRUE                  46600001
466100         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       46610001
466200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     46620001
466300                                         TO DP013-MESSAGE-TEXT(1) 46630001
466400         PERFORM DP013-0000-PROCESS-ABEND                         46640001
466500     END-IF.                                                      46650001
466600                                                                  46660001
466700******************************************************************46670001
466800** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **46680001
466900** SPECIFIC COMMAREA.                                           **46690001
467000******************************************************************46700001
467100 5110-WRITE-ASC-LISTQ.                                            46710001
467200                                                                  46720001
467300     EXEC CICS                                                    46730001
467400         WRITEQ TS                                                46740001
467500             QUEUE (ASC-LIST-QUEUE-NAME)                          46750001
467600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               46760001
467700             ITEM  (PV-BLOCK-NUMBER)                              46770001
467800             RESP  (PV-CICS-RESP)                                 46780001
467900     END-EXEC.                                                    46790001
468000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      46800001
468100         SET DP013-CICS-ABEND      TO TRUE                        46810001
468200         SET DP013-NO-ROLLBACK     TO TRUE                        46820001
468300         MOVE '5110-WRITE-ASC-LISTQ'                              46830001
468400                                   TO DP013-PARAGRAPH             46840001
468500         MOVE 'ATTEMPTING TO WRITE ASC LIST QUEUE'                46850001
468600                                   TO DP013-MESSAGE-TEXT(1)       46860001
468700         PERFORM DP013-0000-PROCESS-ABEND                         46870001
468800     END-IF.                                                      46880001
468900                                                                  46890001
469000*----------------------------------------------------------------*46900001
469100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *46910001
469200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *46920001
469300*----------------------------------------------------------------*46930001
469400 5200-FILL-SEL-QUEUE-RECORD.                                      46940001
469500                                                                  46950001
469600     PERFORM 6112-READ-LIST-QUEUE.                                46960001
469700                                                                  46970001
469800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       46980001
469900         PERFORM                                                  46990001
470000         VARYING LQW-IDX                                          47000001
470100         FROM 1 BY 1                                              47010001
470200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            47020001
470300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          47030001
470400                                                                  47040001
470500             IF  LQW-SELECT (LQW-IDX)                             47050001
470600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              47060001
470700                                   TO SU010-ITEM (SU010-IDX)      47070001
470800                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 47080001
470900                                                                  47090001
471000                 MOVE LQW-SML (LQW-IDX)  TO PV-SML                47100001
471100                 MOVE PV-SML-1-18        TO SU010-SML (SU010-IDX) 47110001
471200                 MOVE LQW-DEST-NBR (LQW-IDX)  TO                  47120001
471300                                       SU010-DEST-NBR (SU010-IDX) 47130001
471400                 MOVE LQW-CREATE (LQW-IDX) TO                     47140001
471500                                         SU010-CREATE (SU010-IDX) 47150001
471600                 MOVE LQW-STAT-DATE (LQW-IDX) TO                  47160001
471700                                       SU010-STAT-DATE(SU010-IDX) 47170001
471800                 MOVE LQW-STAT-TIME (LQW-IDX) TO                  47180001
471900                                       SU010-STAT-TIME(SU010-IDX) 47190001
472000                 MOVE LQW-LOAD-STATUS (LQW-IDX)                   47200001
472100                                 TO SU010-LOAD-STATUS (SU010-IDX) 47210001
472200                 MOVE LQW-TRIP-ID (LQW-IDX)                       47220001
472300                                     TO SU010-TRIP-ID (SU010-IDX) 47230001
472400                 SET SU010-IDX UP BY 1                            47240001
472500                 IF  SU010-IDX > SU010-MAX-ITEMS                  47250001
472600                     PERFORM 5205-WRITE-SEL-QUEUE                 47260001
472700                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    47270001
472800                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         47280001
472900                     SET SU010-IDX TO  1                          47290001
473000                 END-IF                                           47300001
473100             END-IF                                               47310001
473200         END-PERFORM                                              47320001
473300     END-IF.                                                      47330001
473400                                                                  47340001
473500*----------------------------------------------------------------*47350001
473600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *47360001
473700*----------------------------------------------------------------*47370001
473800 5205-WRITE-SEL-QUEUE.                                            47380001
473900                                                                  47390001
474000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            47400001
474100                                   TO SU010-SELECTED-ITEMS.       47410001
474200                                                                  47420001
474300     EXEC CICS                                                    47430001
474400          WRITEQ TS                                               47440001
474500              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      47450001
474600              FROM  (SU010-SELECT-RECORD)                         47460001
474700              ITEM  (PV-SEL-QUEUE-ITEM)                           47470001
474800              RESP  (PV-CICS-RESP)                                47480001
474900     END-EXEC.                                                    47490001
475000                                                                  47500001
475100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47510001
475200         CONTINUE                                                 47520001
475300     ELSE                                                         47530001
475400         SET DP013-CICS-ABEND      TO TRUE                        47540001
475500         SET DP013-NO-ROLLBACK     TO TRUE                        47550001
475600         MOVE '5205-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          47560001
475700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          47570001
475800                                   TO DP013-MESSAGE-TEXT(1)       47580001
475900         PERFORM DP013-0000-PROCESS-ABEND                         47590001
476000     END-IF.                                                      47600001
476100******************************************************************47610001
476200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **47620001
476300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **47630001
476400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **47640001
476500** THE USER.                                                    **47650001
476600******************************************************************47660001
476700 6000-REFRESH-PANEL-FROM-TEMP.                                    47670001
476800                                                                  47680001
476900     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      47690001
477000         SET ASC-NO-TSQ-UPDATE TO TRUE                            47700001
477100         MOVE ZERO                 TO PV-SAVE-ITEM                47710001
477200                                      PV-SEL-QUEUE-ITEM           47720001
477300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        47730001
477400                                   TO PV-HOLD-SELECTED-ITEMS      47740001
477500         MOVE +1                   TO PV-ITEMS-PROCESSED          47750001
477600         PERFORM 6100-UPDATE-TSQ                                  47760001
477700             UNTIL PV-ITEMS-PROCESSED >                           47770001
477800                                     PV-HOLD-SELECTED-ITEMS       47780001
477900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         47790001
478000                    ASC-BLOCK-ENTRIES (2)                         47800001
478100     END-IF.                                                      47810001
478200                                                                  47820001
478300*----------------------------------------------------------------*47830001
478400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *47840001
478500*----------------------------------------------------------------*47850001
478600 6010-DELETE-SEL-QUEUE.                                           47860001
478700                                                                  47870001
478800     EXEC CICS                                                    47880001
478900         DELETEQ TS                                               47890001
479000             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       47900001
479100             RESP  (PV-CICS-RESP)                                 47910001
479200     END-EXEC.                                                    47920001
479300                                                                  47930017
479400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      47940001
479500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         47950001
479600         CONTINUE                                                 47960001
479700     ELSE                                                         47970001
479800         SET DP013-CICS-ABEND TO TRUE                             47980001
479900         SET DP013-NO-ROLLBACK TO TRUE                            47990001
480000         MOVE '6010-DELETE-SEL-QUEUE'                             48000001
480100                        TO DP013-PARAGRAPH                        48010001
480200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         48020001
480300                        TO DP013-MESSAGE-TEXT (1)                 48030001
480400         PERFORM DP013-0000-PROCESS-ABEND                         48040001
480500     END-IF.                                                      48050001
480600                                                                  48060001
480700*----------------------------------------------------------------*48070001
480800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *48080001
480900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *48090001
481000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *48100001
481100*    THE TEMP QUEUE.                                             *48110001
481200*    USE THE SELECT QUE THAT WAS SENT OFF TO THE NEXT PROGRAM.   *48120001
481300*----------------------------------------------------------------*48130001
481400 6100-UPDATE-TSQ.                                                 48140001
481500                                                                  48150001
481600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             48160001
481700     PERFORM 6150-READ-SEL-QUEUE.                                 48170001
481800     PERFORM                                                      48180001
481900         VARYING SU010-IDX                                        48190001
482000         FROM 1 BY 1                                              48200001
482100         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     48210001
482200         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             48220001
482300         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  48230001
482400             PERFORM 6110-PROCESS-ITEMS                           48240001
482500         END-IF                                                   48250001
482600         ADD +1                TO PV-ITEMS-PROCESSED              48260001
482700     END-PERFORM.                                                 48270001
482800     PERFORM 6111-WRITE-LIST-QUEUE.                               48280001
482900                                                                  48290001
483000*----------------------------------------------------------------*48300001
483100*    READ THE LIST QUEUE RECORD.                                 *48310001
483200*----------------------------------------------------------------*48320001
483300 6150-READ-SEL-QUEUE.                                             48330001
483400                                                                  48340001
483500     EXEC CICS                                                    48350001
483600          READQ TS                                                48360001
483700              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      48370001
483800              INTO  (SU010-SELECT-RECORD)                         48380001
483900              ITEM  (PV-SEL-QUEUE-ITEM)                           48390001
484000              RESP  (PV-CICS-RESP)                                48400001
484100     END-EXEC.                                                    48410001
484200                                                                  48420017
484300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          48430001
484400         CONTINUE                                                 48440001
484500     ELSE                                                         48450001
484600         SET DP013-CICS-ABEND      TO  TRUE                       48460001
484700         SET DP013-NO-ROLLBACK     TO  TRUE                       48470001
484800         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           48480001
484900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           48490001
485000                                   TO  DP013-MESSAGE-TEXT(1)      48500001
485100         PERFORM DP013-0000-PROCESS-ABEND                         48510001
485200     END-IF.                                                      48520001
485300                                                                  48530001
485400*----------------------------------------------------------------*48540001
485500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*48550001
485600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*48560001
485700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *48570001
485800*----------------------------------------------------------------*48580001
485900 6110-PROCESS-ITEMS.                                              48590001
486000                                                                  48600001
486100     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          48610001
486200                     / PC-ITEMS-PER-PANEL).                       48620001
486300                                                                  48630001
486400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           48640001
486500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          48650001
486600             PERFORM 6111-WRITE-LIST-QUEUE                        48660001
486700         END-IF                                                   48670001
486800         MOVE PV-ITEM          TO PV-SAVE-ITEM                    48680001
486900                                                                  48690001
487000         PERFORM 6112-READ-LIST-QUEUE                             48700001
487100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               48710001
487200             CONTINUE                                             48720001
487300         END-IF                                                   48730001
487400     END-IF.                                                      48740001
487500                                                                  48750001
487600     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     48760001
487700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              48770001
487800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         48780001
487900     MOVE LQW-SELECTED-SW (PV-SUB)                                48790001
488000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  48800001
488100                                                                  48810001
488200     EVALUATE TRUE                                                48820001
488300         WHEN SU010-INQ (SU010-IDX)                               48830001
488400              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             48840001
488500                                                                  48850001
488600         WHEN SU010-UPD (SU010-IDX)                               48860001
488700              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             48870001
488800                                                                  48880001
488900         WHEN SU010-DEL (SU010-IDX)                               48890001
489000              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             48900001
489100                                                                  48910001
489200         WHEN SU010-ERR (SU010-IDX)                               48920001
489300              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             48930001
489400     END-EVALUATE.                                                48940001
489500                                                                  48950001
489600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                48960001
489700                                                                  48970001
489800*----------------------------------------------------------------*48980001
489900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *48990001
490000*----------------------------------------------------------------*49000001
490100 6111-WRITE-LIST-QUEUE.                                           49010001
490200                                                                  49020001
490300     EXEC CICS                                                    49030001
490400         WRITEQ TS                                                49040001
490500             QUEUE (ASC-LIST-QUEUE-NAME)                          49050001
490600             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     49060001
490700             ITEM  (PV-SAVE-ITEM)                                 49070001
490800             REWRITE                                              49080001
490900             RESP  (PV-CICS-RESP)                                 49090001
491000     END-EXEC.                                                    49100001
491100                                                                  49110017
491200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49120001
491300         CONTINUE                                                 49130001
491400     ELSE                                                         49140001
491500         SET DP013-CICS-ABEND  TO  TRUE                           49150001
491600         SET DP013-NO-ROLLBACK TO  TRUE                           49160001
491700         MOVE '6111-WRITE-LIST-QUEUE'                             49170001
491800                               TO  DP013-PARAGRAPH                49180001
491900         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  49190001
492000                               TO  DP013-MESSAGE-TEXT(1)          49200001
492100         PERFORM DP013-0000-PROCESS-ABEND                         49210001
492200     END-IF.                                                      49220001
492300                                                                  49230001
492400*----------------------------------------------------------------*49240001
492500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*49250001
492600*----------------------------------------------------------------*49260001
492700 6112-READ-LIST-QUEUE.                                            49270001
492800                                                                  49280001
492900     EXEC CICS                                                    49290001
493000         READQ TS                                                 49300001
493100             QUEUE (ASC-LIST-QUEUE-NAME)                          49310001
493200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     49320001
493300             ITEM  (PV-ITEM)                                      49330001
493400             RESP  (PV-CICS-RESP)                                 49340001
493500     END-EXEC.                                                    49350001
493600                                                                  49360017
493700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49370001
493800         CONTINUE                                                 49380001
493900     ELSE                                                         49390001
494000         SET DP013-CICS-ABEND        TO TRUE                      49400001
494100         SET DP013-NO-ROLLBACK       TO TRUE                      49410001
494200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           49420001
494300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    49430001
494400                                     TO DP013-MESSAGE-TEXT(1)     49440001
494500         PERFORM DP013-0000-PROCESS-ABEND                         49450001
494600     END-IF.                                                      49460001
494700                                                                  49470001
494800                                                                  49480001
494900 8000-WRITE-CSSL.                                                 49490001
495000                                                                  49500001
495100     MOVE EIBTASKN TO PV-CICS-TASK                                49510001
495200     MOVE LENGTH OF PV-CICS-MSG-AREA                              49520001
495300               TO PV-COMMAREA-LENGTH                              49530001
495400                                                                  49540001
495500     EXEC CICS                                                    49550001
495600         WRITEQ TD                                                49560001
495700             QUEUE  ('CSSL')                                      49570001
495800             FROM  (PV-CICS-MSG-AREA)                             49580001
495900             LENGTH  (PV-COMMAREA-LENGTH)                         49590001
496000             RESP  (PV-CICS-RESP)                                 49600001
496100     END-EXEC.                                                    49610001
496200                                                                  49620017
496300                                                                  49630017
496400*----------------------------------------------------------------*49640001
496500*    FILL IN TOP PART OF SCREEN FOR CS PULLS                      49650001
496600*----------------------------------------------------------------*49660001
496700 8150-PREPARE-HEADINGS.                                           49670001
496800                                                                  49680001
496900     MOVE SPACES               TO ASC-PACKAGE.                    49690001
497000     MOVE 'ALL CARTONS  '      TO ACTNSTSO.                       49700001
497100                                                                  49710017
497200     IF  DP020-INT-APPL-FORMAT-IND NOT =                          49720001
497300                                     PC-DC-LIST-FORMAT            49730001
497400                                                                  49740017
497500       MOVE ZEROES               TO ASC-UNTS-VRFD                 49750001
497600       PERFORM 8200-OPEN-VRFD-UNTS-CSR                            49760001
497700       PERFORM 8210-FETCH-VRFD-UNTS-CSR                           49770001
497800              UNTIL PS-END-OF-VRFD-UNTS-CSR                       49780001
497900       PERFORM 8220-CLOSE-VRFD-UNTS-CSR                           49790001
498000     END-IF                                                       49800001
498100     PERFORM 8230-GET-TCEPLRQ-INFO.                               49810001
498200                                                                  49820017
498300         MOVE ASC-DC-ID  TO ASC-OPER-UNT-ID-N                     49830001
498700     EVALUATE TRUE                                                49870001
498800         WHEN CEPLRQ-SRC-TYP-CDE = 'MA'                           49880001
498900             MOVE 'ADAM'           TO ASC-PACKAGE                 49890001
499000         WHEN CEPLRQ-SRC-TYP-CDE = 'MR'                           49900001
499100             MOVE 'INFORM'         TO ASC-PACKAGE                 49910001
499200         WHEN CEPLRQ-SRC-TYP-CDE = 'UC'                           49920001
499300             MOVE 'MANUAL'         TO ASC-PACKAGE                 49930001
499400         WHEN CEPLRQ-SRC-TYP-CDE = 'XF'                           49940001
499500             MOVE 'WMXFR'          TO ASC-PACKAGE                 49950001
499600         WHEN OTHER                                               49960001
499700             MOVE 'UNKNWN'         TO ASC-PACKAGE                 49970001
499800     END-EVALUATE.                                                49980001
499900                                                                  49990017
500000                                                                  50000001
500100*----------------------------------------------------------------*50010001
500200* OPEN THE VERIFIED UNITS CURSOR FOR PULLS                        50020001
500300*----------------------------------------------------------------*50030001
500400 8200-OPEN-VRFD-UNTS-CSR.                                         50040001
500500     EXEC SQL                                                     50050001
500600          OPEN PULL-VRFD-UNTS-CSR                                 50060001
500700     END-EXEC.                                                    50070001
500800                                                                  50080001
500900     EVALUATE TRUE                                                50090001
501000         WHEN SQLCODE = ZERO                                      50100001
501100         WHEN SQLCODE = -904                                      50110001
501200         WHEN SQLCODE = -913                                      50120001
501300             CONTINUE                                             50130001
501400         WHEN SQLWARN0 NOT = SPACES                               50140001
501500         WHEN SQLCODE < ZERO                                      50150001
501600         WHEN SQLCODE > ZERO                                      50160001
501700             MOVE '8200-OPEN-VRFD-UNTS' TO DP013-PARAGRAPH        50170001
501800             MOVE 'OPEN CURSOR PROBLEM    - '                     50180001
501900                                   TO DP013-MESSAGE-TEXT (1)      50190001
502000             MOVE SQLCA        TO DP013-SQLCA                     50200001
502100             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        50210001
502200             SET DP013-DB2-ABEND                                  50220001
502300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50230001
502400             PERFORM DP013-0000-PROCESS-ABEND                     50240001
502500     END-EVALUATE.                                                50250001
502600                                                                  50260001
502700*----------------------------------------------------------------*50270001
502800* FETCH VERIFIED UNITS CURSOR FOR PULLS                           50280001
502900*----------------------------------------------------------------*50290001
503000 8210-FETCH-VRFD-UNTS-CSR.                                        50300001
503100     EXEC SQL                                                     50310001
503200      FETCH  PULL-VRFD-UNTS-CSR                                   50320001
503300        INTO  :CEPLIT-PL-REQ-QTY                                  50330001
503400             ,:CEPLIT-STAT-CDE                                    50340001
503500     END-EXEC.                                                    50350001
503600                                                                  50360001
503700     EVALUATE TRUE                                                50370001
503800         WHEN SQLCODE = ZERO                                      50380001
503900             MOVE CEPLIT-STAT-CDE        TO ASC-LINE-STAT         50390001
504000             ADD CEPLIT-PL-REQ-QTY       TO ASC-UNTS-VRFD         50400001
504100         WHEN SQLCODE = +100                                      50410001
504200             SET PS-END-OF-VRFD-UNTS-CSR TO TRUE                  50420001
504300         WHEN SQLWARN0 NOT = SPACE                                50430001
504400         WHEN SQLCODE NOT = ZERO                                  50440001
504500              MOVE '8210-FETCH-VRFD-UNTS' TO DP013-PARAGRAPH      50450001
504600              MOVE 'GET TCEPLIT INFO '                            50460001
504700                               TO DP013-MESSAGE-TEXT (1)          50470001
504800              MOVE SQLCA       TO DP013-SQLCA                     50480001
504900              MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)       50490001
505000              SET DP013-DB2-ABEND TO TRUE                         50500001
505100              PERFORM DP013-0000-PROCESS-ABEND                    50510001
505200     END-EVALUATE.                                                50520001
505300                                                                  50530001
505400*----------------------------------------------------------------*50540001
505500* CLOSE THE VERIFIED UNITS CURSOR FOR PULLS                       50550001
505600*----------------------------------------------------------------*50560001
505700 8220-CLOSE-VRFD-UNTS-CSR.                                        50570001
505800                                                                  50580001
505900     EXEC SQL                                                     50590001
506000          CLOSE PULL-VRFD-UNTS-CSR                                50600001
506100     END-EXEC.                                                    50610001
506200                                                                  50620001
506300     EVALUATE TRUE                                                50630001
506400         WHEN SQLCODE = ZERO                                      50640001
506500         WHEN SQLCODE = +100                                      50650001
506600             CONTINUE                                             50660001
506700         WHEN SQLWARN0 NOT = SPACES                               50670001
506800         WHEN SQLCODE < ZERO                                      50680001
506900         WHEN SQLCODE > ZERO                                      50690001
507000             MOVE '8220-CLOSE-VRFD-UNTS' TO DP013-PARAGRAPH       50700001
507100             MOVE 'CLOSE CURSOR PROBLEM   '                       50710001
507200                               TO DP013-MESSAGE-TEXT (1)          50720001
507300             MOVE SQLCA        TO DP013-SQLCA                     50730001
507400             MOVE 'TCEPLIT '   TO DP013-DB2-TABLE-NAME (1)        50740001
507500             SET DP013-DB2-ABEND                                  50750001
507600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50760001
507700             PERFORM DP013-0000-PROCESS-ABEND                     50770001
507800     END-EVALUATE.                                                50780001
507900                                                                  50790001
508000*----------------------------------------------------------------*50800001
508100* RETRIEVE INFO FROM TCEPLRQ FOR PULL                             50810001
508200*----------------------------------------------------------------*50820001
508300 8230-GET-TCEPLRQ-INFO.                                           50830001
508400                                                                  50840001
508500     EXEC SQL                                                     50850001
508600          SELECT SRC_TYP_CDE                                      50860001
508700               , CNSTK_LOC_ID                                     50870001
508800          INTO  :CEPLRQ-SRC-TYP-CDE                               50880001
508900              , :CEPLRQ-CNSTK-LOC-ID                              50890001
509000           FROM  TCEPLRQ                                          50900001
509100          WHERE  CNSTK_REQ_PL_NBR  = :DK-PO-NBR                   50910001
509200     END-EXEC.                                                    50920001
509300     EVALUATE TRUE                                                50930001
509400         WHEN SQLCODE = ZERO                                      50940001
509500             CONTINUE                                             50950001
509600         WHEN SQLCODE = +100                                      50960001
509700             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                50970001
509800             SET DP020-MSG-FATAL   TO  TRUE                       50980001
509900             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           50990001
510000         WHEN SQLWARN0 NOT = SPACE                                51000001
510100         WHEN SQLCODE NOT = ZERO                                  51010001
510200              MOVE '8210-GET-TCEPLRQ-INFO ' TO DP013-PARAGRAPH    51020001
510300              MOVE 'GET TCEPLRQ INFO '                            51030001
510400                                TO DP013-MESSAGE-TEXT (1)         51040001
510500              MOVE SQLCA        TO DP013-SQLCA                    51050001
510600              MOVE 'TCEPLRQ '   TO DP013-DB2-TABLE-NAME (1)       51060001
510700              SET DP013-DB2-ABEND TO TRUE                         51070001
510800              PERFORM DP013-0000-PROCESS-ABEND                    51080001
510900     END-EVALUATE.                                                51090001
511000                                                                  51100001
511200                                                                  51120001
511500*----------------------------------------------------------------*51150001
511600* OPEN THE FAST TRANSFER CARTON CURSOR                            51160001
511700*----------------------------------------------------------------*51170001
511800 8300-OPEN-FX-CURSOR.                                             51180001
511900     PERFORM                                                      51190001
512000         WITH TEST AFTER                                          51200001
512100         VARYING PV-RETRY-COUNTER                                 51210001
512200         FROM 1 BY 1                                              51220001
512300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               51230001
512400                   OR (SQLCODE = ZERO))                           51240001
512500                                                                  51250001
512600         EXEC SQL                                                 51260001
512700              OPEN FAST-TRANS-CRTN-CSR                            51270001
512800         END-EXEC                                                 51280001
512900                                                                  51290001
513000         EVALUATE TRUE                                            51300001
513100             WHEN SQLCODE = ZERO                                  51310001
513200             WHEN SQLCODE = -904                                  51320001
513300             WHEN SQLCODE = -913                                  51330001
513400                 CONTINUE                                         51340001
513500             WHEN SQLWARN0 NOT = SPACES                           51350001
513600             WHEN SQLCODE < ZERO                                  51360001
513700             WHEN SQLCODE > ZERO                                  51370001
513800                 MOVE '8300-OPEN-FX-CURSOR' TO DP013-PARAGRAPH    51380001
513900                 MOVE 'OPEN FX CARTON CURSOR  - '                 51390001
514000                                   TO DP013-MESSAGE-TEXT (1)      51400001
514100                 MOVE SQLCA        TO DP013-SQLCA                 51410001
514200                 MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)    51420001
514300                 MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (2)    51430001
514400                 SET DP013-DB2-ABEND                              51440001
514500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           51450001
514600                 PERFORM DP013-0000-PROCESS-ABEND                 51460001
514700         END-EVALUATE                                             51470001
514800     END-PERFORM.                                                 51480001
514900                                                                  51490017
515000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        51500001
515100         MOVE '8300-OPEN-FX-CURSOR' TO DP013-PARAGRAPH            51510001
515200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   51520001
515300                                   TO DP013-MESSAGE-TEXT (1)      51530001
515400         MOVE SQLCA                TO DP013-SQLCA                 51540001
515500         MOVE 'SUT00024'           TO DP013-DB2-TABLE-NAME (1)    51550001
515600         MOVE 'SUT00028'           TO DP013-DB2-TABLE-NAME (2)    51560001
515700         SET DP013-DB2-ABEND                                      51570001
515800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   51580001
515900         PERFORM DP013-0000-PROCESS-ABEND                         51590001
516000     END-IF.                                                      51600001
516100                                                                  51610001
516200*----------------------------------------------------------------*51620001
516300* CLOSE THE FX CURSOR                                             51630001
516400*----------------------------------------------------------------*51640001
516500 8310-CLOSE-FX-CURSOR.                                            51650001
516600                                                                  51660001
516700     EXEC SQL                                                     51670001
516800          CLOSE FAST-TRANS-CRTN-CSR                               51680001
516900     END-EXEC.                                                    51690001
517000                                                                  51700001
517100     EVALUATE TRUE                                                51710001
517200         WHEN SQLCODE = ZERO                                      51720001
517300         WHEN SQLCODE = +100                                      51730001
517400             CONTINUE                                             51740001
517500         WHEN SQLWARN0 NOT = SPACES                               51750001
517600         WHEN SQLCODE < ZERO                                      51760001
517700         WHEN SQLCODE > ZERO                                      51770001
517800             MOVE '8310-CLOSE-FX-CURSOR' TO DP013-PARAGRAPH       51780001
517900             MOVE 'CLOSE FX CRTN CURSOR   '                       51790001
518000                               TO DP013-MESSAGE-TEXT (1)          51800001
518100             MOVE SQLCA        TO DP013-SQLCA                     51810001
518200             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)        51820001
518300             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (2)        51830001
518400             SET DP013-DB2-ABEND                                  51840001
518500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               51850001
518600             PERFORM DP013-0000-PROCESS-ABEND                     51860001
518700     END-EVALUATE.                                                51870001
518800                                                                  51880001
518900                                                                  51890001
519000*----------------------------------------------------------------*51900001
519100*    FETCH FAST TRANSFER CARTON CURSOR                            51910001
519200*----------------------------------------------------------------*51920001
519300 8320-FETCH-FX-CURSOR.                                            51930001
519400                                                                  51940001
519800     INITIALIZE PC046-COMMAREA-REC.                               51980001
519900                                                                  51990001
520000     EXEC SQL                                                     52000001
520100         FETCH FAST-TRANS-CRTN-CSR                                52010001
520200         INTO  :SUT00028-SHIPT-UNT-ID                             52020001
520300            ,  :SUT00024-PRNT-CART-ID                             52030001
520400            ,  :SUT00024-MSTR-CART-IND                            52040001
520500     END-EXEC.                                                    52050001
520600                                                                  52060001
520700     EVALUATE TRUE                                                52070001
520800         WHEN SQLCODE = ZEROS                                     52080001
520900              MOVE SUT00028-SHIPT-UNT-ID TO ASC-SML-NBR           52090001
521000                                           PC046-CARTON-ID        52100001
521100         WHEN SQLCODE = +100                                      52110001
521200              SET PS-ERROR  TO TRUE                               52120001
521300         WHEN SQLCODE = -904                                      52130001
521400         WHEN SQLCODE = -911                                      52140001
521500         WHEN SQLCODE = -913                                      52150001
521600              INITIALIZE DP013-MESSAGE-TEXT (1)                   52160001
521700              MOVE '8320-FETCH-FX-CURSOR'  TO DP013-PARAGRAPH     52170001
521800              MOVE 'PROBLEM FETCH FX CURSOR'                      52180001
521900                                        TO DP013-MESSAGE-TEXT (1) 52190001
522000              MOVE SQLCA       TO DP013-SQLCA                     52200001
522100              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)       52210001
522200              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (2)       52220001
522300              SET DP013-DB2-ABEND TO TRUE                         52230001
522400              PERFORM DP013-0000-PROCESS-ABEND                    52240001
522500               SET  PS-ERROR                                      52250001
522600                    DP020-MSG-FATAL TO TRUE                       52260001
522700              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          52270001
522800                                                                  52280001
522900         WHEN OTHER                                               52290001
523000              INITIALIZE DP013-MESSAGE-TEXT (1)                   52300001
523100              MOVE '8320-FETCH-FX-CURSOR'  TO DP013-PARAGRAPH     52310001
523200              MOVE 'PROBLEM FETCH FX CSR'                         52320001
523300                                        TO DP013-MESSAGE-TEXT (1) 52330001
523400              MOVE SQLCA       TO DP013-SQLCA                     52340001
523500              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)       52350001
523600              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (2)       52360001
523700              SET DP013-DB2-ABEND TO TRUE                         52370001
523800              PERFORM DP013-0000-PROCESS-ABEND                    52380001
523900              SET  PS-ERROR                                       52390001
524000                   DP020-MSG-FATAL TO TRUE                        52400001
524100              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          52410001
524200     END-EVALUATE.                                                52420001
524300                                                                  52430001
524400     IF  SQLCODE EQUAL +100                                       52440001
524500         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      52450001
524600     END-IF.                                                      52460001
524700                                                                  52470001
525100                                                                  52510001
525200*----------------------------------------------------------------*52520001
525300*    FILL IN TOP PART OF SCREEN FOR FX - FAST TRANSFERS           52530001
525400*----------------------------------------------------------------*52540001
525500 8330-PREPARE-FX-HEADINGS.                                        52550001
525600                                                                  52560001
525700     MOVE SPACES               TO ASC-PACKAGE.                    52570001
525800     MOVE 'ALL CARTONS  '      TO ACTNSTSO.                       52580001
527100                                                                  52710001
527400                                                                  52740001
527500*-----------------------------------------------------------------52750001
527600*  READ THE LIST QUEUE RECORD                                     52760001
527700*-----------------------------------------------------------------52770001
527800 9100-READ-SEL-QUEUE.                                             52780001
527900                                                                  52790001
528000     EXEC CICS                                                    52800001
528100         READQ TS                                                 52810001
528200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        52820001
528300             INTO  (SU010-SELECT-RECORD)                          52830001
528400             ITEM  (ASC-SEL-ITEM)                                 52840001
528500             RESP  (PV-CICS-RESP)                                 52850001
528600     END-EXEC.                                                    52860001
528700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        52870001
528800         CONTINUE                                                 52880001
528900     ELSE                                                         52890001
529000         SET DP013-LOGIC-ABEND                                    52900001
529100             DP013-NO-ROLLBACK   TO   TRUE                        52910001
529200         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          52920001
529300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   52930001
529400                                 TO   DP013-MESSAGE-TEXT (1)      52940001
529500         PERFORM DP013-0000-PROCESS-ABEND                         52950001
529600     END-IF.                                                      52960001
529700                                                                  52970001
529800*-----------------------------------------------------------------52980001
529900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *52990001
530000*-----------------------------------------------------------------53000001
530100 9200-REWRITE-SEL-QUEUE.                                          53010001
530200                                                                  53020001
530300     EXEC CICS                                                    53030001
530400          WRITEQ TS                                               53040001
530500              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      53050001
530600              FROM   (SU010-SELECT-RECORD)                        53060001
530700              ITEM   (ASC-SEL-ITEM)                               53070001
530800              RESP   (PV-CICS-RESP)                               53080001
530900              REWRITE                                             53090001
531000     END-EXEC.                                                    53100001
531100                                                                  53110001
531200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   53120001
531300         SET DP013-CICS-ABEND                                     53130001
531400             DP013-NO-ROLLBACK     TO TRUE                        53140001
531500         MOVE '9200-REWRITE-SEL-QUEUE'                            53150001
531600                                   TO DP013-PARAGRAPH             53160001
531700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   53170001
531800                                   TO DP013-MESSAGE-TEXT (1)      53180001
531900         PERFORM DP013-0000-PROCESS-ABEND                         53190001
532000     END-IF.                                                      53200001
532100                                                                  53210001
532200*----------------------------------------------------------------*53220001
532300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *53230001
532400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *53240001
532500*----------------------------------------------------------------*53250001
532600 9900-SOFT-ABORT.                                                 53260001
532700                                                                  53270001
532800     EXEC CICS SYNCPOINT                                          53280001
532900          ROLLBACK                                                53290001
533000     END-EXEC.                                                    53300001
533100                                                                  53310001
533200     SET  PS-ERROR                                                53320001
533300          PS-SOFT-ABORT-ERROR                                     53330001
533400          DP020-MSG-FATAL       TO  TRUE.                         53340001
533500                                                                  53350001
533600*----------------------------------------------------------------*53360001
533700*    ABEND PROCESSOR MODULE                                      *53370001
533800*----------------------------------------------------------------*53380001
533900     COPY DPPD013.                                                53390001
534000                                                                  53400001
