000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    VNKCS007.                                         00040000
000500 AUTHOR.        DOUG NOLTNER - STRATAGEM.                         00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  06/93.                                            00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    V007 - VENDOR MAINTENANCE                                   *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO UPDATE OR ADD A VENDOR.     *00120000
001300*                                                                *00130000
001400*    DATE       CHANGE                                           *00140000
001500*    ----       ------                                           *00150000
001600*    11/10/93 - INCLUDE CARRIER FIELDS ON SCREEN                 *00160000
001700*       05/94 - INCLUDE EXPENSE FIELDS ON SCREEN                 *00170000
001800*    09/05/95 - INCLUDE STORE DISTRO LEADTIME ON SCREEN          *00180000
001900*----------------------------------------------------------------*00190000
002000* 10/09/97 - PAUL KEBER/STRATAGEM - WR# 5280                     *00200000
002100*   PREVENT THE ENTRY OF UNDERSCORES IN THE VENDOR NAME FIELDS   *00210000
002200*   IN ORDER TO PREVENT PROBLEMS LOADING DATA WAREHOUSE DB2PE    *00220000
002300*   TABLE INFORMATION.                                           *00230000
002400* DATE  01/30/2001                                               *00240000
002500*     MODIFY THE PROGRAM TO ALLOW FOR THE DATABASE               *00250000
002600*     AND BUSINESS RULE CHANGES BEING MADE TO PREPARE FOR THE    *00260000
002700*     INTERFACE TO RMS SUPPLIER AND PARTNER DATABASES.           *00270000
002800*     MADE BY: L SCHALLHORN                       WR# 21278      *00280000
002900*                                                                *00290000
003000*  DATE  04/18/2001                                              *00300000
003100*      CHANGE MADE: CORRECT BREAK LOGIC ON EXPENSE VENDOR THAT IS*00310000
003200*      NOT A PARTNER.  THIS SHOULD NOT BE SET AS VNDR-IN-RMS = Y.*00320000
003300*      MADE BY: L SCHALLHORN                       WR# 21278     *00330000
003400*                                                                *00340000
003500*  DATE  04/23/2001                                              *00350000
003600*      CHANGE MADE: MODIFIED LOGIC TO SEND VN014-EXT-CAP-EXP     *00360000
003700*      INDICATOR TO PEOPLESOFT PROGRAM.                         .*00370000
003800*      MADE BY: L SCHALLHORN                       WR# 21278     *00380000
003900*                                                                *00390000
004000*  DATE  05/07/2001                                              *00400000
004100*      CHANGE MADE: MODIFIED INSERT TO HARD-CODE A VALUE OF 'N'  *00410000
004200*      IN THE IMPORT INDICATOR.                                 .*00420000
004300*      MADE BY: N EILBES                           WR# 21278     *00430000
004400*                                                                *00440000
004500*  DATE  08/09/2001                                              *00450000
004600*      CHANGE MADE: ADDED CONDITIONAL CHECK FOR THE LINE OF      *00460000
004700*      CREDIT, CHECKING THE VALUE OF THE PARTNER TYPE.  IF IT IS *00470000
004800*      'BK' THEN THE VALUE FROM THE SCREEN IS PASSED OTHERWISE   *00480000
004900*      ZEROES WILL BE PASSED FOR THE LINE OF CREDIT (PARA 8100-).*00490000
005000*      MADE BY: MIKE BESKE                         WR# 20704     *00500000
005100*                                                                *00510000
005200*  DATE  05/30/2003                                              *00520000
005300*      CHANGE MADE: COMPOUND PACK PO CHANGES.                    *00530000
005400*      MADE BY: KEVIN CATLIN            WR/IR #: WR24663         *00540000
005500*                                                                *00550000
005600*  DATE  06/24/2003                                              *00560000
005700*      CHANGE MADE: MODIFIED CONDITION IN PARAGRAPH 8000 TO      *00570000
005800*      UPDATE EXPENSE VENDOR IN RMS ONLY IF IT'S A PARTNER, IN   *00580000
005900*      THE CASE THAT THE VENDOR IS CHANGED FROM MERCH TO EXPENSE.*00590000
006000*      MADE BY: KEVIN CATLIN            WR/IR #: WR24481         *00600000
006100*                                                                *00610000
006200*  DATE  10/09/2003                                              *00620000
006300*      CHANGE MADE: UCC128 CARTON LABEL PROJECT.  ADDED 'S2'     *00630000
006400*      IMPORT PARENT COMPANY AS A VALID VALUE FOR PARTNER CODE.  *00640000
006500*      MADE BY: NANCY EILBES            WR/IR #: WR25358         *00650000
006600*                                                                *00660000
006700*  DATE  11/05/2003                                              *00670000
006800*      CHANGE MADE: ADDED CODE TO DISPLAY AND MAINTAIN 4 NEW     *00680000
006900*      FIELDS FROM THE EXPANDED TEXTENT TABLE: GVRNG_IND,        *00690000
007000*      GVRNG_ENT_ID, CART_LBL_IND, CART_LBL_EFF_DTE. THESE 4     *00700000
007100*      FIELDS WERE ALSO ADDED TO THE RMS PO MESSAGING CODE       *00710000
007200*      THAT WILL CARRY THEIR VALUES TO THAT APPLICATION          *00720000
007300*      (CODE IN PARAGRAPHS: 5100-, 8000-, 8100-).                *00730000
007400*      2 NEW DISPLAY ONLY FIELDS WERE ADDED TO THE SCREEN:       *00740000
007500*      ENT_ID OF THE VENDOR BEING PROCESSED AND THE GOVERNING    *00750000
007600*      ENT ID VENDOR NAME.                                       *00760000
007700*      MADE BY: MIKE BESKE              WR/IR #: WR25358         *00770000
007800*                                                                *00780000
007900*  DATE  11/11/2003                                              *00790000
008000*      CHANGE MADE: REPLACED THE POPULATION OF EXTENT-CARRIER-IND*00800000
008100*      IN PARA 6000-ADD-VENDOR WITH 'Y' IF ASC-PARTNER-TYPE IS A *00810000
008200*      VALID CARRIER ELSE 'N' WILL BE MOVED TO EXTENT-CARRIER-IND*00820000
008300*      THIS WAS CAUSING TRK010 TO ABEND.                         *00830000
008400*      ADDED AN ELSE TO THE IF STMT POPULATING THAT FIELD WITH   *00840000
008500*      'N' IN PARA 5000-UPDATE-VENDOR.                           *00850000
008600*      MADE BY: MIKE BESKE              WR/IR #: P000607432      *00860000
008700*                                                                *00870000
008800*  DATE  11/12/2003                                              *00880000
008900*      CHANGE MADE: CORRECTED VALIDATION EDIT INVOLVING THE      *00890000
009000*      PS-GOVERNING-IND-CHANGED-SW.  IF THE VENDOR HAS A Y       *00900000
009100*      FOR THE VALUE AND IT IS CHANGED, A CHECK WILL BE DONE     *00910000
009200*      TO SEE IF THAT VENDORS ENT ID IS FOUND IN ANY OTHER       *00920000
009300*      VENDORS GVRNG_ENT_ID. IF ANY ARE FOUND, THEN THE CHANGE   *00930000
009400*      WILL NOT BE ALLOWED UNTIL THE ENT ID(S) IS REMOVED FIRST. *00940000
009500*      ADDED AN EDITTING CHECK OF WHAT IS ENTERED FOR THE        *00950000
009600*      GOVERNING-ENT-ID FOR IMBEDDED SPACES.                     *00960000
009700*      MADE BY: MIKE BESKE              WR/IR #: P000607940      *00970000
009800*                                                                *00980000
009900*  DATE  11/24/2003                                              *00990000
010000*      CHANGE MADE: ADDED CODE FOR FIELD LEVEL SECURITY FOR AP   *01000000
010100*      SUPERVISORS.  THEY ARE ONLY ALLOWED UPDATE ACCESS TO THE  *01010000
010200*      FOLLOWING FIELDS AND NO OTHER SCREEN FIELDS:              *01020000
010300*      SHORT NAME, STATUS, VENDOR ON HOLD, PARENT COMPANY, USING *01030000
010400*      FACTOR, SEPARATE PYMTS, PAYMENT HANDLING, CLASSIFICATION, *01040000
010500*      PERSISTENCE, 1099 VENDOR, TAX ID TYPE, TAX ID, WITHOLDING *01050000
010600*      CODE. A ARCHITECTURE FUNCTION WAS CREATED TO DO THE FIELD *01060000
010700*      LEVEL SECURITY CHECK INSTEAD OF A NEW TRANID.  THIS IS THE*01070000
010800*      ACCEPTED STANDARDS FOR FIELD LEVEL SECURITY.  THE FUNCTION*01080000
010900*      IS VNUPHOLD.  THE FOLLOWING PARAGRAPHS WERE MODIFIED FOR  *01090000
011000*      THIS SECURITY: 1110-, 3200-, 4000-.                       *01100000
011100*      MADE BY: MIKE BESKE              WR/IR #: WR25837         *01110000
011200*                                                                *01120000
011300*  DATE  01/09/2004                                              *01130000
011400*      CHANGE MADE: ADDED 'RT' AS A VALID VALUE FOR PAYMENT      *01140000
011500*      HANDLING CODE.                                            *01150000
011600*      MADE BY: NANCY EILBES            WR/IR #: WR24481         *01160000
011700*                                                                *01170000
011800*  DATE  05/24/2004                                              *01180000
011900*      CHANGE MADE: ADDED NEW FIELDS: NDA FLAG AND PARENT VENDOR *01190000
012000*      NUMBER AND ABILITY TO MAINTAIN THEM. THERE WAS SOME       *01200000
012100*      REARRANGING OF FIELDS ON THE SCREEN TO DO THIS.           *01210000
012200*      MADE BY: PAUL OMAN               WR/IR #: WR26951         *01220000
012300*                                                                *01230000
012400*  DATE  07/07/2004                                              *01240000
012500*      CHANGE MADE: ADDED 'FN' AS A VALID VALUE FOR PAYMENT      *01250000
012600*      HANDLING CODE.                                            *01260000
012700*      MADE BY: MARK BURNSIDE           WR/IR #: WR27253         *01270000
012800*                                                                *01280000
012900*  DATE  09/10/2004                                              *01290000
013000*      CHANGE MADE: CORRECTED CODE INVOLVING THE DISPLAY OF THE  *01300000
013100*      STATUS CODE.  THE PROBLEM WAS WHEN LOOKING AT AN INACTIVE *01310000
013200*      VENDOR IN UPDATE MODE.  THE USER WOULD GO TO ANOTHER      *01320000
013300*      SCREEN BY STACKING.  WHEN DONE THE USER WOULD F3 OUT OF   *01330000
013400*      THAT SCREEN AND COME BACK TO THE VENDOR HEADER SCREEN.    *01340000
013500*      NOW THE STATUS CODE WOULD SHOW THE VENDOR AS BEING ACTIVE *01350000
013600*      INSTEAD OF INACTIVE.  THIS WAS ONLY A DISPLAY PROBLEM AS  *01360000
013700*      A CHECK OF THE DATABASE REVEALED THAT THE STATUS CODE WAS *01370000
013800*      STILL 'I'NACTIVE.  THE CODE FOR ADDING A VENDOR AND HAVING*01380000
013900*      THE STATUS DEFAULT TO 'A'CTIVE WAS MAINTAINED, BUT WILL NO*01390000
014000*      LONGER CAUSE THE DISPLAY PROBLEM DESCRIBED ABOVE.         *01400000
014100*      MADE BY: MIKE BESKE              WR/IR #: P000690791      *01410000
014200*                                                                *01420000
014300*  DATE  04/26/2005                                              *01430000
014400*      CHANGE MADE: CHANGED LOGIC ASSIGNING THE NEXT VENDOR      *01440000
014500*      NUMBER TO JUST INCREMENT BY 1 AND ENSURE THAT THE NUMBER  *01450000
014600*      IS NOT FOUND ON TEXTENT.                                  *01460000
014700*      MADE BY: NANCY EILBES            WR/IR #: P000757479      *01470000
014800*                                                                *01480000
014900*  DATE  05/30/2005                                              *01490000
015000*      CHANGE MADE: ADDED LOGIC FOR NEW MNEMONIC FUNCTIONS TO    *01500000
015100*      ACCESS NEW VENDOR CAPABILITY AND RELATIONSHIP SCREENS     *01510000
015200*      (LOCAL-FUNC-05 THRU -08). ALSO ADDED CODE IN PARAGRAPH    *01520000
015300*      8200-LINK-TO-VNKCS023 TO RECOGNIZE MAX CAPABILITIES OR    *01530000
015400*      MAX RELATIONSHIPS EXCEEDED ON RETURN FROM VNKCS023.       *01540000
015500*      MADE BY: JACK KRAMER             WR/IR #: WR25278         *01550000
015600*                                                                *01560000
015700*  DATE  06/07/2005                                              *01570000
015800*      CHANGE MADE: ADDED NEW FIELD, CAPACITY, FOR VENDORS WITH  *01580000
015900*      A PARTNER TYPE OF 'FA'CTORY.  THIS FIELD WILL SHOW THE    *01590000
016000*      MONTHLY CAPACITY FOR A FACTORY.  THE COLUMN LNE_OF_CR_AMT *01600000
016100*      FROM TABLE TEXTENT WILL BE USED TO STORE THIS VALUE.      *01610000
016200*      CODE ADDED IN PARAGRAPHS 2200-, 3000-, 3200-, 4000-,      *01620000
016300*      4400-, 5000-, 6000-, AND 8000-.                           *01630000
016400*      MADE BY: KEVIN CATLIN            WR/IR #: WR28060         *01640000
016500*                                                                *01650000
016600*  DATE  06/13/2005                                              *01660000
016700*      CHANGE MADE: ADDED THE 88 LEVEL VALUE 'OP' TO THE         *01670000
016800*      PV-VALID-PRTNR-TYP FIELD.  INCLUDED LOGIC IN PARAGRAPHS   *01680000
016900*      4000- AND 4400- TO MOVE THE STRING 'OFFICE OF PLACEMENT'  *01690000
017000*      TO THE PARTNER TYPE DESCRIPTION WHEN THE CODE VALUE       *01700000
017100*      EQUALS 'OP'.                                              *01710000
017200*      MADE BY: KRYSTEN LEARY           WR/IR #: WR28905         *01720000
017300*                                                                *01730000
017400*  DATE  07/21/2005                                              *01740000
017500*      CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.    *01750000
017600*      RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO       *01760000
017700*      COPYBOOK VNWS013.                                         *01770000
017800*      MADE BY: KRYSTEN LEARY           WR/IR #: WR28651         *01780000
017900*                                                                *01790000
018000*  DATE  03/24/2006                                              *01800000
018100*      CHANGE MADE: VENDOR ALLOWANCE AUTOMATION PROJECT.         *01810000
018200*      RECOMPILE FROM PRODUCTION TO INCORPORATE CHANGES TO       *01820000
018300*      COPYBOOK VNWS007 AND VNWS013.                             *01830000
018400*      MADE BY: MIKE BESKE              WR/IR #: WR30028         *01840000
018500*                                                                *01850000
018600*  DATE  06/02/2006                                              *01860000
018700*      CHANGE MADE: DEFAULT REQUIREMENTS.                        *01870000
018800*      CHANGED DEFAULTS SO THAT AT INITIAL VENDOR SETUP THE NDA  *01880000
018900*      INDICATOR AND THE EDI PREPACK CODE ARE SET TO 'Y' FOR     *01890000
019000*      VENDORS WHOSE PRIMARY TYPE CODE IS SET TO 'M'.  ALL OTHER *01900000
019100*      VENDORS ARE INITIALLY SET TO AN 'N' UNLESS SETUP          *01910000
019200*      DIFFERENTLY BY THE USER.  ALSO CHANGED THE ERROR MESSAGE  *01920000
019300*      TO INDICATE THAT THE NDA INDICATOR NEEDS TO BE EITHER A   *01930000
019400*      'Y' OR A 'N'.  THIS WAS NECESSARY BECAUSE ENTERING A      *01940000
019500*      SPACE IN THE NDA INDICATOR CAUSED THE PROGRAM TO ABEND.   *01950000
019600*      MADE BY: ROLF NOHE               WR/IR #: WR30574         *01960000
019700*                                                                *01970000
019800*  DATE  06/05/2006                                              *01980000
019900*      CHANGE MADE:                                              *01990000
020000*      CORRECTED ERROR WHEN ADDING EXPENSE VENDORS.  THE USERS   *02000000
020100*      LEAVE THE EDI PREPACK CODE AS SPACE WHEN ADDING A         *02010000
020200*      EXPENSE VENDOR AND THIS WOULD CAUSE A MESSAGE TO APPEAR   *02020000
020300*      STATING THAT THE EDI PREPACK CODE NEEDED TO BE EITHER A   *02030000
020400*      'Y' OR AN 'N'.  THIS WAS CHANGED TO AUTOMATICALLY INSERT  *02040000
020500*      AN 'N' FOR EITHER A PRIMARY TYPE CODE OF 'E' OR 'F'.      *02050000
020600*      MADE BY: ROLF NOHE               WR/IR #: WR30042         *02060000
020700*                                                                *02070000
020800*  DATE  06/30/2006                                              *02080000
020900*      CHANGE MADE:                                              *02090000
021000*      CORRECTED ERROR WHEN ADDING A MERCHANDISE VENDOR WITHOUT  *02100000
021100*      ENTERING THE NDA INDICATOR.  THIS WAS CAUSING THE PROGRAM *02110000
021200*      TO ABEND.  IF THE VENDOR TYPE IS 'M' AND THE NDA          *02120000
021300*      INDICATOR IS LEFT BLANK THE NDA INDICATOR WILL            *02130000
021400*      BE FILLED IN WITH A 'Y'.                                  *02140000
021500*      MADE BY: ROLF NOHE               WR/IR #: P000895944      *02150000
021600*                                                                *02160000
021700*  DATE  10/18/2006                                              *02170000
021800*      CHANGE MADE:                                              *02180000
021900*      ADDED 'EM' (EMPLOYEE) AS A VALID VALUE FOR PAYMENT        *02190000
022000*      HANDLING CODE.                                            *02200000
022100*      MADE BY: NANCY EILBES            WR/IR #: WR30042         *02210000
022200*                                                                *02220000
022300*  DATE  06/13/2007                                              *02230000
022400*      CHANGE MADE:                                              *02240000
022500*      ADDED 'AT' AS A VALID VALUE FOR PAYMENT HANDLING CODE.    *02250000
022600*      MADE BY: MICHELE RINDFLEISCH     WR/IR #: P001033802      *02260000
022700*                                                                *02270000
022800*  DATE  01/11/2008                                              *02280000
022900*      CHANGE MADE: ADDED F23=CERTIFNS FUNCTIONALITY TO SCREEN   *02290000
023000*      MAP VNKM007. WHEN USER PRESSES KEY, CONTROL WILL TRANSFER *02300000
023100*      TO VMKCS037-CERTIFICATION COUNT.                          *02310000
023200*      MADE BY: CHRISTINE TWIEHAUS      WR/IR #: WR32218         *02320000
023300*                                                                *02330000
023400*  DATE  05/19/2008                                              *02340000
023500*      CHANGE MADE: ADD 88 LEVWEL VALUE 'CL' TO PV-VALID-PRNTR-TYP02350000
023600*      MADE BY: GREG WISIALOWSKI        WR/IR #: WR34276         *02360000
023700*                                                                *02370000
023800*  DATE  02/06/2009                                              *02380000
023900*      CHANGE MADE: MOVED CODE TO SET DEFAULT VALUES FOR THE NDA *02390000
024000*                   AND EDI INDICATORS FROM THE 3000- PARA TO    *02400000
024100*                   THE 6000-ADD-VENDOR PARA.                    *02410000
024200*                   TO FIX ISSUE WITH EDI INDICTOR BEING RESET   *02420000
024300*                   TO A 'Y' WHEN THE VENDOR WAS PUT ON HOLD.    *02430000
024400*      MADE BY: SCOTT KRUSCHKA          WR/IR #: INC000000690636 *02440000
024500*                                                                *02450000
024600*  DATE  07/22/2009                                              *02460000
024700*      CHANGE MADE:                                              *02470000
024800*      ADDED 'KC' (KOHLS CARES FOR KIDS) AS A VALID VALUE FOR    *02480000
024900*      PAYMENT HANDLING CODE.                                    *02490000
025000*      MADE BY: NANCY EILBES            WR/IR #: INC000000883395 *02500000
025100*                                                                *02510000
025200*  DATE  07/22/2009                                              *02520000
025300*      CHANGE MADE:                                              *02530000
025400*      ADDED 'AS' (ACADEMIC SCHOLARSHIP) AS A VALID VALUE FOR    *02540000
025500*      PAYMENT HANDLING CODE.                                    *02550000
025600*      MADE BY: NANCY EILBES            WR/IR #: INC000000894676 *02560000
025700*                                                                *02570000
025800* DATE  11/01/2009                                               *02580000
025900*     CHANGE MADE:                                               *02590000
026000*     LOGIC THAT ASSIGNS THE NEXT VALID SHORTNAME WAS LOOPING    *02600000
026100*     WHEN THE SHORTNAME HAD LESS THAN 7 CHARACTERS AND ANOTHER  *02610000
026200*     SHORTNAME ALREADY EXISTED THAT STARTED WITH THE SAME       *02620000
026300*     CHARACTERS BUT HAD A NUMBER AS PART OF THE SHORTNAME THAT  *02630000
026400*     WASN'T PART OF THE INCREMENTED NUMBER.  THE SUFFIX THAT WAS*02640000
026500*     BEING INCREMENTED TO KEEP SHORTNAME FROM DUPLICATING WAS   *02650000
026600*     BEING WIPED OUT IN THE REPEATING LOGIC. CREATED A SEPARATE *02660000
026700*     WORK FIELD TO INCREMENT THE SUFFIX OUTSIDE OF THE ARRAY    *02670000
026800*     THAT IS USED TO MANAGE THE CHARACTERS IN THE SHORT NAME.   *02680000
026900*     THIS CORRECTED THE LOOPING ISSUE.                          *02690000
027000*     MADE BY: NANCY EILBES            WR/IR #: INC000001022359  *02700000
027100*                                                                *02710000
027200*  DATE  11/02/2009                                              *02720000
027300*      CHANGE MADE:                                              *02730000
027400*      NEW INCREMENT FIELD HAD TO BE MOVED BACK TO THE ORIGINAL  *02740000
027500*      FIELD FOR SHORTNAMES THAT HAVE 7 CHARACTERS.              *02750000
027600*      THIS CORRECTED THE LOOPING ISSUE.                         *02760000
027700*      MADE BY: NANCY EILBES            WR/IR #: INC000001022359 *02770000
027800*                                                                *02780000
027900*  DATE  03/03/2010                                              *02790000
028000*      CHANGE MADE:                                              *02800000
028100*      ADDED 'NP' (NONPROFIT A-TEAM) AS A VALID VALUE FOR        *02810000
028200*      PAYMENT HANDLING CODE.                                    *02820000
028300*      MADE BY: NANCY EILBES            WR/IR #: INC000001168120 *02830000
028400*                                                                *02840000
028500*  DATE  06/08/2010                                              *02850000
028600*      CHANGE MADE: ADDED CODE TO HANDLE THE SITUATION WHERE THE *02860000
028700*      SHORTNAME OF 7 CHARS/3 DIGIT SEQ NBR HAS REACHED THE MAX  *02870000
028800*      SEQ NBR OF 999.  THE NEW CODE WILL USE THE FIRST 6 OF THE *02880000
028900*      7 CHARS AND A 4 DIGIT SEQ NBR STARTING WITH 1000 AND A MAX*02890000
029000*      9999.  NEW PARAS 5070-, 5075-, 5076-, 5077-, 5078-.       *02900000
029100*      MOD PARA 5050-.                                           *02910000
029200*      MADE BY: MIKE BESKE              WR/IR #: PKE000000004206 *02920000
029300*                                                                *02930000
029400*  DATE  07/15/2010                                              *02940000
029500*      CHANGE MADE:                                              *02950000
029600*      ADDED 'FI' (FINANCE) AS A VALID VALUE FOR PAYMENT         *02960000
029700*      HANDLING CODE.                                            *02970000
029800*      MADE BY: NANCY EILBES            WR/IR #: INC000001323150 *02980000
029900*                                                                *02990000
030000*  DATE  12/01/2011                                              *03000000
030100*      CHANGE MADE:                                              *03010000
030200*      ADDED A CALL TO VNKUT040 TO COMMIT PS ORACLE CHANGES.     *03020000
030300*      MADE BY: MADHURA PETHE           WR/IR #: WR37038         *03030000
030400*                                                                *03040000
030500*  DATE  12/17/2012                                              *03050000
030600*      CHANGE MADE:                                              *03060000
030700*      ADDED 'CT' (CREDIT) AS A VALID VALUE FOR PAYMENT          *03070000
030800*      HANDLING CODE.                                            *03080000
030900*      MADE BY: NANCY EILBES            WR/IR #: CRQ000000037933 *03090000
030910*                                                                *03091000
030911*  DATE  09/25/2014                                              *03091100
030912*      CHANGE MADE:                                              *03091200
030913*      ADDED 'TX' (TAX) AS A VALID VALUE FOR PAYMENT             *03091300
030914*      HANDLING CODE.                                            *03091400
030915*      MADE BY: NANCY EILBES            WR/IR #: CHG0093882      *03091500
030916*                                                                *03091600
030917*  DATE  09/30/2014                                              *03091700
030918*      CHANGE MADE:                                              *03091800
030919*      CALLED NEW SUB-ROUTINE VNKUT054 TO DERIVE ADDITIONAL      *03091900
030920*      VENDOR TYPES.                                             *03092000
030930*      MADE BY: COGNIZANT               WR/IR #: CHG0099490      *03093000
030940*                                                                *03094000
030950*  DATE  04/26/2016                                              *03095000
030960*      CHANGE MADE:                                              *03096000
030961*      ADDED 'IV' (INTERNAL VENDOR) AND 'CP' (CHECK PULL) AS     *03096100
030962*      VALID VALUES FOR PAYMENT HANDLING CODE.                   *03096200
030963*      MADE BY: NANCY EILBES            WR/IR #: CHG0140413      *03096300
030964*                                                                *03096400
030965*  DATE  06/01/2018                                              *03096500
030966*   CHANGE MADE: REMOVED ALL REFERENCES TO ASC-FED-TX-ID-TYP-CDE,*03096600
030967*   ASC-FED-TX-ID-NBR, ATAXIDTO AND ATAXIDO AS THESE FIELDS WERE *03096700
030968*   REMOVED FROM THE MAP.  ALSO REMOVED THESE COLUMNS FROM ALL   *03096800
030969*   SELECT AND UPDATE SQL STATEMENTS. THESE FIELDS WILL BE SET   *03096900
030970*   TO SPACES ON INSERTS AND WILL NO LONGER BE PASSED TO         *03097000
030971*   VNKUT040 TO UPDATE PS.                                       *03097100
030972*      MADE BY: NANCY EILBES            WR/IR #: CHG0199468      *03097200
030973*  DATE  03/22/2019                                              *03097300
030974*   CHANGE MADE: ADDED CHECK TO NOT CALL PEOPLESOFT CALLED       *03097400
030975*   MODULES AS PART OF THE PS REPLACEMENT TO ORACLE. *            03097500
030976*   BASED ON TKRPRPM PARAMTER LOOKUP 'ERPDTE'. IF CURRENT DATE *  03097600
030977*   IS GREATER THEN PARAMATER DATE, ASC-ERP-OIC-LIVE-YES OR *     03097700
030978*   ASC-ERP-OIC-LIVE-NO WILL BE SET AND CHECKED IN THE PROGRAM *  03097800
030979*        MADE BY: GERMAN BANDA            WR/IR #: CHG0220043 *   03097900
030980*                                                                *03098000
030981*  DATE  05/23/2019                                              *03098100
030982*      CHANGE MADE:                                              *03098200
030983*      ADDED 'CN' (CONSTRUCTION) AS A VALID VALUE FOR PAYMENT    *03098300
030984*      HANDLING CODE.                                            *03098400
030985*      MADE BY: NANCY EILBES            WR/IR #: CHG0224418      *03098500
030986*                                                                *03098600
030987*  DATE  09/03/2019                                              *03098700
030988*      CHANGE MADE:                                              *03098800
030989*      MODIFIED 5000-UPDATE-VENDOR TO ADD LOGIC TO CAPTURE       *03098900
030990*      CHANGES TO PAYMENT HANDLING CODE ON THE TVNDTAU TABLE.    *03099000
030991*      ONLY CHANGES TO STATUS WERE BEING CAPTURED.               *03099100
030992*      MADE BY: NANCY EILBES            WR/IR #: CHG0230630      *03099200
030993*                                                                *03099300
030994*  DATE  05/18/2020                                              *03099400
030995*   CHANGE MADE: REMOVE F23 KEY, LOCAL-FUNC-09, WHICH LINKED     *03099500
030996*                TO THE VENDOR CERTIFICATION SCREENS. ALSO       *03099600
030997*                REMOVED CALLS TO VNKUT054 & VNKUT040.           *03099700
030998*   MADE BY: JEAN KURK               WR/IR #: CHG0243494         *03099800
030999*                                                                *03099900
031000*  DATE  09/22/2020                                              *03100000
031001*      CHANGE MADE:                                              *03100100
031002*      ADDED 'MP' (MARKETPLACE) AS A VALID VALUE FOR PAYMENT     *03100200
031003*      HANDLING CODE.                                            *03100300
031004*      MADE BY: NANCY EILBES            WR/IR #: CHG0249110      *03100400
031005*                                                                *03100500
031006*  DATE  10/21/2020                                              *03100600
031007*      CHANGE MADE:                                              *03100700
031008*      ADDED 'DP' (DAILY PAYMENTS) AS A VALID VALUE FOR PAYMENT  *03100800
031009*      HANDLING CODE.                                            *03100900
031010*      MADE BY: NANCY EILBES            WR/IR #: CHG0250361      *03101000
031011*                                                                *03101100
031012*  DATE  02/11/2021                                              *03101200
031013*      CHANGE MADE:                                              *03101300
031014*      ADDED 'SB' (SEPHORA BEAUTY) AS A VALID VALUE FOR PAYMENT  *03101400
031015*      HANDLING CODE.                                            *03101500
031016*      MADE BY: NANCY EILBES            WR/IR #: CHG0253820      *03101600
031017*                                                                *03101700
031018*  DATE  09/07/2021                                              *03101800
031019*            - CHANGE CALL OF DPKUT100 TO                        *03101900
031020*              CALL DP010I-NUMERIC-EDIT-ROUTINE                  *03102000
031021*              MAKING THE CALL DYNAMIC VS STATIC                 *03102100
031022*      MADE BY: GERMAN BANDA            WR/IR #: CHG0261091      *03102200
031023*                                                                *03102300
031024*  DATE  01/05/2023                                              *03102400
031025*            - CHANGE CALL OF DPKCS030 TO DYNAMIC                *03102500
031026*      AP DIRECT IMPORT MODIFICATIONS: ADDED 'NX' AS A VALID     *03102600
031027*      VALUE FOR PAYMENT HANDLING CODE. - NAE                    *03102700
031028*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *03102800
031029*                                                                *03102901
031030*  DATE  02/01/2023                                              *03103001
031032*      AP DIRECT IMPORT MODIFICATIONS: ADDED 'NX' AS A VALID     *03103201
031033*      VALUE FOR PAYMENT HANDLING CODE.                          *03103301
031034*      MADE BY: NANCY EILBES            WR/IR #: CHG0285531      *03103402
031035*----------------------------------------------------------------*03103501
031036******************************************************************03103601
031037                                                                  03103701
031038                                                                  03103801
031040 ENVIRONMENT DIVISION.                                            03104000
031050                                                                  03105000
031060                                                                  03106000
031070 DATA DIVISION.                                                   03107000
031080                                                                  03108000
031090 WORKING-STORAGE SECTION.                                         03109000
031100                                                                  03110000
031200 01  PC-PROGRAM-CONSTANTS.                                        03120000
031300     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'VNKCS007'.  03130000
031400     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'VN007A  '.  03140000
031500     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'VNKM007 '.  03150000
031600     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           03160000
031700                                              COMP.               03170000
031800     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           03180000
031900                                              COMP.               03190000
032000     05  PC-CALENDAR-MODULE       PIC  X(08)  VALUE 'DPKUT500'.   03200000
032100     05  PC-VNKCS023              PIC  X(08)  VALUE 'VNKCS023'.   03210000
032200     05  PC-VNKCS024              PIC  X(08)  VALUE 'VNKCS024'.   03220000
032300     05  PC-INTER-APPL-CODES.                                     03230000
032400         10  PC-INTER-APPL-ADD    PIC  X(01)  VALUE '2'.          03240000
032500         10  PC-INTER-APPL-UP-CRIT                                03250000
032600                                  PIC  X(01)  VALUE '3'.          03260000
032700         10  PC-INTER-APPL-UP-LIST                                03270000
032800                                  PIC  X(01)  VALUE '4'.          03280000
032900     05  PC-INIT-TIMESTAMP        PIC  X(26)  VALUE               03290000
033000         '0001-01-01-00.00.00.000000'.                            03300000
033100     05  PC-INIT-EXP-TMST         PIC  X(26)  VALUE               03310000
033200         '9999-09-09-09.09.09.999999'.                            03320000
033300     05  PC-DEFAULT-DATE          PIC  X(10)  VALUE               03330000
033400         '9999-09-09'.                                            03340000
033500     05  PC-VALID-DIGITS              PIC X.                      03350000
033600         88 VALID-DIGITS              VALUES                      03360000
033700            '0' '1' '2' '3' '4' '5' '6' '7' '8' '9'.              03370000
033800                                                                  03380000
033900     05  PC-TSYMSG-NUMBERS.                                       03390000
034000         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       03400000
034100         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       03410000
034200         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       03420000
034300         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       03430000
034400         10  PC-TSYMSG-00032      PIC  9(05)  VALUE  00032.       03440000
034500         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       03450000
034600         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       03460000
034700         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       03470000
034800         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       03480000
034900         10  PC-TSYMSG-00117      PIC  9(05)  VALUE  00117.       03490000
035000         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       03500000
035100         10  PC-TSYMSG-00159      PIC  9(05)  VALUE  00159.       03510000
035200         10  PC-TSYMSG-00160      PIC  9(05)  VALUE  00160.       03520000
035300         10  PC-TSYMSG-00166      PIC  9(05)  VALUE  00166.       03530000
035400         10  PC-TSYMSG-00349      PIC  9(05)  VALUE  00349.       03540000
035500         10  PC-TSYMSG-00368      PIC  9(05)  VALUE  00368.       03550000
035600         10  PC-TSYMSG-00398      PIC  9(05)  VALUE  00398.       03560000
035700         10  PC-TSYMSG-00475      PIC  9(05)  VALUE  00475.       03570000
035800         10  PC-TSYMSG-00487      PIC  9(05)  VALUE  00487.       03580000
035900         10  PC-TSYMSG-00490      PIC  9(05)  VALUE  00490.       03590000
036000         10  PC-TSYMSG-00495      PIC  9(05)  VALUE  00495.       03600000
036100         10  PC-TSYMSG-00496      PIC  9(05)  VALUE  00496.       03610000
036200         10  PC-TSYMSG-00497      PIC  9(05)  VALUE  00497.       03620000
036300         10  PC-TSYMSG-00498      PIC  9(05)  VALUE  00498.       03630000
036400         10  PC-TSYMSG-00499      PIC  9(05)  VALUE  00499.       03640000
036500         10  PC-TSYMSG-00500      PIC  9(05)  VALUE  00500.       03650000
036600         10  PC-TSYMSG-00689      PIC  9(05)  VALUE  00689.       03660000
036700         10  PC-TSYMSG-00711      PIC  9(05)  VALUE  00711.       03670000
036800         10  PC-TSYMSG-00712      PIC  9(05)  VALUE  00712.       03680000
036900         10  PC-TSYMSG-00713      PIC  9(05)  VALUE  00713.       03690000
037000         10  PC-TSYMSG-00953      PIC  9(05)  VALUE  00953.       03700000
037100         10  PC-TSYMSG-01643      PIC  9(05)  VALUE  01643.       03710000
037200         10  PC-TSYMSG-01693      PIC  9(05)  VALUE  01693.       03720000
037300         10  PC-TSYMSG-01861      PIC  9(05)  VALUE  01861.       03730000
037400         10  PC-TSYMSG-01862      PIC  9(05)  VALUE  01862.       03740000
037500         10  PC-TSYMSG-01863      PIC  9(05)  VALUE  01863.       03750000
037600         10  PC-TSYMSG-01864      PIC  9(05)  VALUE  01864.       03760000
037700         10  PC-TSYMSG-01865      PIC  9(05)  VALUE  01865.       03770000
037800         10  PC-TSYMSG-01866      PIC  9(05)  VALUE  01866.       03780000
037900         10  PC-TSYMSG-01868      PIC  9(05)  VALUE  01868.       03790000
038000         10  PC-TSYMSG-01869      PIC  9(05)  VALUE  01869.       03800000
038100         10  PC-TSYMSG-01870      PIC  9(05)  VALUE  01870.       03810000
038200         10  PC-TSYMSG-01871      PIC  9(05)  VALUE  01871.       03820000
038300         10  PC-TSYMSG-01872      PIC  9(05)  VALUE  01872.       03830000
038400         10  PC-TSYMSG-01873      PIC  9(05)  VALUE  01873.       03840000
038500         10  PC-TSYMSG-01877      PIC  9(05)  VALUE  01877.       03850000
038600         10  PC-TSYMSG-01944      PIC  9(05)  VALUE  01944.       03860000
038700         10  PC-TSYMSG-01983      PIC  9(05)  VALUE  01983.       03870000
038800         10  PC-TSYMSG-02017      PIC  9(05)  VALUE  02017.       03880000
038900         10  PC-TSYMSG-02057      PIC  9(05)  VALUE  02057.       03890000
039000         10  PC-TSYMSG-02622      PIC  9(05)  VALUE  02622.       03900000
039100         10  PC-TSYMSG-02625      PIC  9(05)  VALUE  02625.       03910000
039200         10  PC-TSYMSG-02626      PIC  9(05)  VALUE  02626.       03920000
039300         10  PC-TSYMSG-02630      PIC  9(05)  VALUE  02630.       03930000
039400         10  PC-TSYMSG-02631      PIC  9(05)  VALUE  02631.       03940000
039500         10  PC-TSYMSG-02632      PIC  9(05)  VALUE  02632.       03950000
039600         10  PC-TSYMSG-02633      PIC  9(05)  VALUE  02633.       03960000
039700         10  PC-TSYMSG-02637      PIC  9(05)  VALUE  02637.       03970000
039800         10  PC-TSYMSG-02638      PIC  9(05)  VALUE  02638.       03980000
039900         10  PC-TSYMSG-02639      PIC  9(05)  VALUE  02639.       03990000
040000         10  PC-TSYMSG-02640      PIC  9(05)  VALUE  02640.       04000000
040100         10  PC-TSYMSG-02645      PIC  9(05)  VALUE  02645.       04010000
040200         10  PC-TSYMSG-02646      PIC  9(05)  VALUE  02646.       04020000
040300         10  PC-TSYMSG-02669      PIC  9(05)  VALUE  02669.       04030000
040400         10  PC-TSYMSG-02672      PIC  9(05)  VALUE  02672.       04040000
040500         10  PC-TSYMSG-03062      PIC  9(05)  VALUE  03062.       04050000
040600         10  PC-TSYMSG-03162      PIC  9(05)  VALUE  03162.       04060000
040700         10  PC-TSYMSG-03167      PIC  9(05)  VALUE  03167.       04070000
040800         10  PC-TSYMSG-03168      PIC  9(05)  VALUE  03168.       04080000
040900         10  PC-TSYMSG-03169      PIC  9(05)  VALUE  03169.       04090000
041000         10  PC-TSYMSG-03170      PIC  9(05)  VALUE  03170.       04100000
041100         10  PC-TSYMSG-03171      PIC  9(05)  VALUE  03171.       04110000
041200         10  PC-TSYMSG-03172      PIC  9(05)  VALUE  03172.       04120000
041300         10  PC-TSYMSG-03173      PIC  9(05)  VALUE  03173.       04130000
041400         10  PC-TSYMSG-03174      PIC  9(05)  VALUE  03174.       04140000
041500         10  PC-TSYMSG-03188      PIC  9(05)  VALUE  03188.       04150000
041600         10  PC-TSYMSG-03372      PIC  9(05)  VALUE  03372.       04160000
041700         10  PC-TSYMSG-03376      PIC  9(05)  VALUE  03376.       04170000
041800         10  PC-TSYMSG-03380      PIC  9(05)  VALUE  03380.       04180000
041900         10  PC-TSYMSG-03381      PIC  9(05)  VALUE  03381.       04190000
042000         10  PC-TSYMSG-03624      PIC  9(05)  VALUE  03624.       04200000
042100         10  PC-TSYMSG-03626      PIC  9(05)  VALUE  03626.       04210000
042200*                                                                 04220000
042300 01  PS-PROGRAM-SWITCHES.                                         04230000
042400     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         04240000
042500         88  PS-ERROR                         VALUE  'Y'.         04250000
042600         88  PS-NO-ERROR                      VALUE  'N'.         04260000
042700     05  PS-PARENT-ERROR-SW       PIC  X(01)  VALUE  'N'.         04270000
042800         88  PS-PARENT-ERROR-YES              VALUE  'Y'.         04280000
042900         88  PS-PARENT-ERROR-NO               VALUE  'N'.         04290000
043000     05  PS-REMOVE-PARENT-SW      PIC  X(01)  VALUE  'N'.         04300000
043100         88  PS-REMOVE-PARENT-YES             VALUE  'Y'.         04310000
043200         88  PS-REMOVE-PARENT-NO              VALUE  'N'.         04320000
043300     05  PS-SELECT-SW             PIC  X(01)  VALUE  ' '.         04330000
043400         88  PS-SELECT-BY-NAME                VALUE  'A'.         04340000
043500         88  PS-SELECT-BY-NUMBER              VALUE  'B'.         04350000
043600     05  PS-DATE-ERROR-SW         PIC  X(01)  VALUE  'N'.         04360000
043700         88  PS-DATE-ERROR                    VALUE  'Y'.         04370000
043800         88  PS-NO-DATE-ERROR                 VALUE  'N'.         04380000
043900     05  PS-VENDOR-NBR-DERIVED-SW PIC  X(01)  VALUE  'N'.         04390000
044000         88  PS-VENDOR-NBR-DERIVED            VALUE  'Y'.         04400000
044100         88  PS-VENDOR-NBR-NOT-DERIVED        VALUE  'N'.         04410000
044200     05  PV-VENDOR-NBR-ENTERED-SW  PIC  X(01) VALUE  'N'.         04420000
044300         88  VENDOR-NUMBER-ENTERED            VALUE  'Y'.         04430000
044400         88  VENDOR-NUMBER-NOT-ENTERED        VALUE  'N'.         04440000
044500     05  PS-VN-UPDATE-PERFORMED-SW PIC X(01)  VALUE  'N'.         04450000
044600         88  VN-UPDATE-PERFORMED              VALUE  'Y'.         04460000
044700         88  VN-UPDATE-NOT-PERFORMED          VALUE  'N'.         04470000
044800     05  PS-VN-PRIM-TYP-CHG-SW     PIC X(01)  VALUE  'N'.         04480000
044900         88  VN-PRIM-CHG-FROM-MERCH           VALUE  'Y'.         04490000
045000         88  VN-PRIM-NOT-CHG-FROM-MERCH       VALUE  'N'.         04500000
045100     05  PS-VN007-UPDATE-PRFRMD-SW PIC X(01)  VALUE 'N'.          04510000
045200         88 VN007-UPDATE-PRFRMD               VALUE  'Y'.         04520000
045300         88 VN007-UPDATE-NOT-PRFRMD           VALUE  'N'.         04530000
045400     05  PS-VN007-DELETE-PRFRMD-SW PIC X(01)  VALUE 'N'.          04540000
045500         88 VN007-DELETE-PRFRMD               VALUE  'Y'.         04550000
045600         88 VN007-CHANGE-PRTNR-TYPE           VALUE  'P'.         04560000
045700         88 VN007-DELETE-NOT-PRFRMD           VALUE  'N'.         04570000
045800     05  PS-VN-STATUS-CHANGE-SW PIC X(01)     VALUE  'N'.         04580000
045900         88  VN-STATUS-CHANGE                 VALUE  'Y'.         04590000
046000         88  VN-STATUS-NOT-CHANGED            VALUE  'N'.         04600000
046100     05  PS-VN-HANDLING-CHANGE-SW PIC X(01)   VALUE  'N'.         04610000
046200         88  VN-HANDLING-CHANGE               VALUE  'Y'.         04620000
046300         88  VN-HANDLING-NOT-CHANGED          VALUE  'N'.         04630000
046400     05  PS-TVNDTAU-ROW-FND-SW  PIC X(01)     VALUE  'N'.         04640000
046500         88  TVNDTAU-ROW-FOUND                VALUE  'Y'.         04650000
046600         88  TVNDTAU-ROW-NOT-FOUND            VALUE  'N'.         04660000
046700     05  PS-SHORTNAME-DERIVED     PIC  X(01)  VALUE 'N'.          04670000
046800         88 SHORTNAME-DERIVED                 VALUE 'Y'.          04680000
046900         88 SHORTNAME-NOT-DERIVED             VALUE 'N'.          04690000
047000     05  PS-SHORTNAME-LT-7CHAR    PIC  X(01)  VALUE 'N'.          04700000
047100         88 SHORTNAME-LT-7CHAR                VALUE 'Y'.          04710000
047200         88 SHORTNAME-NOT-LT-7CHAR            VALUE 'N'.          04720000
047300     05  PS-NO-EXISTING-SNAME     PIC  X(01)  VALUE 'N'.          04730000
047400         88 EXISTING-SNAME                    VALUE 'Y'.          04740000
047500         88 NO-EXISTING-SNAME                 VALUE 'N'.          04750000
047600     05  PS-SNAME-LENGTH          PIC  X(01)  VALUE ' '.          04760000
047700         88 SNAME-LENGTH-GE7                  VALUE ' '.          04770000
047800         88 SNAME-LENGTH-2                    VALUE '2'.          04780000
047900         88 SNAME-LENGTH-3                    VALUE '3'.          04790000
048000         88 SNAME-LENGTH-4                    VALUE '4'.          04800000
048100         88 SNAME-LENGTH-5                    VALUE '5'.          04810000
048200         88 SNAME-LENGTH-6                    VALUE '6'.          04820000
048300     05  PS-NOT-VALID-SHORTNAME-SW PIC X(01)  VALUE 'N'.          04830000
048400         88 PS-VALID-SHORTNAME                VALUE 'Y'.          04840000
048500         88 PS-NOT-VALID-SHORTNAME            VALUE 'N'.          04850000
048600     05  PS-UPDATE-NDA-IND-SW      PIC X(01)  VALUE 'N'.          04860000
048700         88 PS-DONT-UPDATE-NDA-IND            VALUE 'N'.          04870000
048800         88 PS-UPDATE-NDA-IND                 VALUE 'Y'.          04880000
048900     05  PS-GOVERNING-IND-CHANGED-SW                              04890000
049000                                   PIC X(01)  VALUE 'N'.          04900000
049100         88 PS-GOVERNING-IND-NOT-CHANGED      VALUE 'N'.          04910000
049200         88 PS-GOVERNING-IND-CHANGED          VALUE 'Y'.          04920000
049300     05  PS-VALID-ENT-ID-DIGITS-SW PIC X      VALUE 'Y'.          04930000
049400         88  PS-VALID-ENT-ID-DIGITS           VALUE 'Y'.          04940000
049500         88  PS-INVALID-ENT-ID-DIGITS         VALUE 'N'.          04950000
049600     05  PS-UPDATE-PREPACK-IND-SW  PIC X(01)  VALUE 'N'.          04960000
049700         88 PS-DONT-UPDATE-PREPACK-IND        VALUE 'N'.          04970000
049800         88 PS-UPDATE-PREPACK-IND             VALUE 'Y'.          04980000
049900     05  PS-LONGNAME-FOUND-SW      PIC X(01)  VALUE 'N'.          04990000
050000         88 PS-LONGNAME-NOT-FOUND             VALUE 'N'.          05000000
050100         88 PS-LONGNAME-FOUND                 VALUE 'Y'.          05010000
050200     05  PS-UPDT-PRTNR-NO-LNG-NM-SW PIC X(01) VALUE 'Y'.          05020000
050300         88 PS-UPDT-PRTNR-HAS-LNG-NM          VALUE 'Y'.          05030000
050400         88 PS-UPDT-PRTNR-NO-LNG-NM           VALUE 'N'.          05040000
050500     05  PS-NEW-SHORTNAME-FOUND-SW PIC X(01)  VALUE 'N'.          05050000
050600         88 PS-NEW-SHORTNAME-FOUND-ON-DB      VALUE 'Y'.          05060000
050700         88 PS-NEW-SHORTNAME-NOT-FOUND        VALUE 'N'.          05070000
050800     05  PS-CHECK-NEW-SHORTNAME-SW PIC X(01)  VALUE 'N'.          05080000
050900         88 PS-CHECK-NEW-SHORTNAME            VALUE 'Y'.          05090000
051000         88 PS-DONT-CHECK-NEW-SHORTNAME       VALUE 'N'.          05100000
051100     05  PS-MAX-SEQ-NBR-REACHED-SW PIC X(01)  VALUE 'N'.          05110000
051200         88 PS-MAX-SEQ-NBR-REACHED            VALUE 'Y'.          05120000
051300         88 PS-MAX-SEQ-NBR-NOT-REACHED        VALUE 'N'.          05130000
051400*                                                                 05140000
051500 01  PV-PROGRAM-VARIABLES.                                        05150000
051600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            05160000
051700                                              COMP SYNC.          05170000
051800     05  PV-IND-VAR               PIC S9(04)  VALUE +0            05180000
051900                                              COMP SYNC.          05190000
052000     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            05200000
052100                                              COMP SYNC.          05210000
052200     05  PV-UNDERSCORE-COUNT      PIC S9(04)  VALUE +0            05220000
052300                                              COMP SYNC.          05230000
052400     05  PV-DOT-COUNT             PIC S9(04)  VALUE +0            05240000
052500                                              COMP SYNC.          05250000
052600     05  PV-DEC-COUNT             PIC S9(04)  VALUE +0            05260000
052700                                              COMP SYNC.          05270000
052800     05  PV-LNE-OF-CR-AMT            PIC 9(10).9(02).             05280000
052900     05  PV-LNE-OF-CR-AMT-RED REDEFINES PV-LNE-OF-CR-AMT.         05290000
053000         10  PV-LNE-OF-CR-AMT-DLLR   PIC 9(10).                   05300000
053100         10  FILLER                  PIC X(01).                   05310000
053200         10  PV-LNE-OF-CR-AMT-CENT   PIC 9(02).                   05320000
053300     05  PV-LINE-OF-CREDIT           PIC S9(10)V9(02).            05330000
053400     05  PV-LINE-OF-CREDIT-RED REDEFINES PV-LINE-OF-CREDIT.       05340000
053500         10  PV-LINE-OF-CREDIT-DLLR  PIC S9(10).                  05350000
053600         10  PV-LINE-OF-CREDIT-CENT  PIC V9(02).                  05360000
053700                                                                  05370000
053800     05  PV-STRING                    PIC X(09).                  05380000
053900     05  PV-LASTPOS                   PIC S9(04) COMP.            05390000
054000                                                                  05400000
054100     05  PV-GENTID.                                               05410000
054200         10  PV-GENTID-AREA           OCCURS 9 TIMES              05420000
054300                                      INDEXED BY GENTID-INDX.     05430000
054400             15  PV-GENTID-ONE        PIC X(01).                  05440000
054500                                                                  05450000
054600     05  PV-BEGIN-DATE            PIC  X(10)  VALUE SPACES.       05460000
054700     05  PV-END-DATE              PIC  X(10)  VALUE SPACES.       05470000
054800     05  PV-PARENT-NAME           PIC  X(30)  VALUE SPACES.       05480000
054900     05  PV-PARENT-VENDOR-NBR-N   PIC  9(09)  VALUE 0.            05490000
055000     05  PV-PARENT-VENDOR-NBR REDEFINES PV-PARENT-VENDOR-NBR-N    05500000
055100                                  PIC  X(09).                     05510000
055200     05  PV-WORK-DATE             PIC  X(10)  VALUE SPACES.       05520000
055300     05  PV-WORK-DATE-RED REDEFINES PV-WORK-DATE.                 05530000
055400         10  PV-WORK-DATE-CY      PIC  9(04).                     05540000
055500         10  PV-FILLER            PIC  X(01).                     05550000
055600         10  PV-WORK-DATE-MM      PIC  9(02).                     05560000
055700         10  PV-FILLER            PIC  X(01).                     05570000
055800         10  PV-WORK-DATE-DD      PIC  9(02).                     05580000
055900     05  PV-PARENT-ENT-ID         PIC S9(09)  COMP.               05590000
056000     05  PV-ENT-SNAME-DESC        PIC  X(30)  VALUE SPACES.       05600000
056100     05  PV-ENT-ID-9              PIC  9(09)  VALUE ZEROES.       05610000
056200     05  PV-ENT-ID                PIC S9(09)  VALUE ZEROES.       05620000
056300     05  PV-EXTENT-NDA-IND        PIC  X(01)  VALUE SPACE.        05630000
056400     05  PV-EXTENT-NDA-BEG-DTE    PIC  X(10)  VALUE SPACE.        05640000
056500     05  PV-EXTENT-NDA-END-DTE    PIC  X(10)  VALUE SPACE.        05650000
056600     05  PV-EXTENT-PREPACK-IND    PIC  X(01)  VALUE SPACE.        05660000
056700     05  PV-ONE                   PIC  X(01)  VALUE SPACE.        05670000
056800     05  PV-TYPE-CODE             PIC  X(02)  VALUE SPACES.       05680000
056900     05  PV-VEND-NAME             PIC  X(30)  VALUE SPACES.       05690000
057000     05  PV-LONG-ENT-NAME-DESC    PIC X(250)  VALUE SPACE.        05700000
057100     05  PV-BEGIN-DATE-CCYYMMDD   PIC  X(08)  VALUE SPACES.       05710000
057200     05  PV-END-DATE-CCYYMMDD     PIC  X(08)  VALUE SPACES.       05720000
057300     05  PV-INT-APPL-FORMAT-IND   PIC  X(01).                     05730000
057400     05  PV-SCAC-BREAK.                                           05740000
057500         10  PV-SCAC-B1           PIC  X(01).                     05750000
057600         10  PV-SCAC-B2           PIC  X(01).                     05760000
057700         10  PV-SCAC-B3           PIC  X(01).                     05770000
057800         10  PV-SCAC-B4           PIC  X(01).                     05780000
057900     05  PV-BASE-NUMBER           PIC 9(09)  VALUE 0.             05790000
058000     05  PV-BASE-NUMBER-RED REDEFINES PV-BASE-NUMBER.             05800000
058100         10  PV-BASE-DIGIT        PIC 9                           05810000
058200                            OCCURS  9 TIMES INDEXED CD-X.         05820000
058300     05  PV-NO-DIGITS             PIC 9      VALUE 9.             05830000
058400     05  PV-CHECK-DIGIT           PIC 9      VALUE ZERO.          05840000
058500     05  PV-VNDR-NBR-CALC         PIC X(09).                      05850000
058600     05  PV-VNDR-NBR-CALC-RED REDEFINES PV-VNDR-NBR-CALC.         05860000
058700         10  PV-VNDR-NBR-CALC-N   PIC 9(09).                      05870000
058800     05  PV-VENDOR-COUNT          PIC 9(04)  VALUE ZEROES.        05880000
058900     05  PV-DUN-NBR               PIC X(09)  VALUE SPACES.        05890000
059000                                                                  05900000
059100     05  PV-SNAME-CNT             PIC S9(04) VALUE +0             05910000
059200                                            COMP SYNC.            05920000
059300     05  PV-POINTER               PIC S9(04) VALUE +0             05930000
059400                                            COMP SYNC.            05940000
059500     05  PV-VENDOR-NAME-TABLE.                                    05950000
059600         10  VENDOR-NAME           OCCURS 30 TIMES                05960000
059700                               INDEXED BY NAME-INDX.              05970000
059800           15 VENDOR-NAME-BYTE   PIC  X(01)  VALUE SPACES.        05980000
059900                                                                  05990000
060000     05  PV-SHORTNAME-LT-7CHAR.                                   06000000
060100         10  PV-SHORT-7CHAR        PIC  X(07).                    06010000
060200         10  PV-SHORT-SUFF         PIC  X(03).                    06020000
060300         10  PV-SHORT-REST         PIC  X(20).                    06030000
060400     05  PV-SNAME-INDX             PIC  9(02).                    06040000
060500     05 PV-SHORTNAME-1000X         PIC  X(10)  VALUE SPACES.      06050000
060600     05 PV-SHORTNAME-1000X-RED REDEFINES PV-SHORTNAME-1000X.      06060000
060700        10 PV-SHORTNAME-1000X-6X   PIC  X(06).                    06070000
060800        10 PV-SHORTNAME-1000X-4X   PIC  X(04).                    06080000
060900     05 PV-SHORTNAME-LIKE          PIC  X(07)  VALUE SPACES.      06090000
061000     05 PV-SHORTNAME-LIKE-RED REDEFINES PV-SHORTNAME-LIKE.        06100000
061100        10 PV-SHORTNAME-LIKE-6X    PIC  X(06).                    06110000
061200        10 PV-SHORTNAME-LIKE-1X    PIC  X(01).                    06120000
061300     05 PV-SHORTNAME-MAX           PIC  X(30)  VALUE SPACES.      06130000
061400     05 PV-SHORTNAME-MAX-RED REDEFINES PV-SHORTNAME-MAX.          06140000
061500        10 PV-SHORTNAME-MAX-6X     PIC  X(06).                    06150000
061600        10 PV-SHORTNAME-MAX-4X     PIC  X(04).                    06160000
061700        10 PV-SHORTNAME-MAX-20X    PIC  X(20).                    06170000
061800     05 PV-SHORTNAME-NEW           PIC  X(30)  VALUE SPACES.      06180000
061900     05 PV-SHORTNAME-NEW-RED REDEFINES PV-SHORTNAME-NEW.          06190000
062000        10 PV-SHORTNAME-NEW-6X     PIC  X(06).                    06200000
062100        10 PV-SHORTNAME-NEW-4X     PIC  X(04).                    06210000
062200        10 PV-SHORTNAME-NEW-20X    PIC  X(20).                    06220000
062300     05 PV-SNM-SUFFIX-INCR4        PIC  9(04).                    06230000
062400     05 PV-SNM-SUFFIX-INCR         PIC  9(03).                    06240000
062500     05 PV-ENT-DESC-SNAME          PIC  X(10)  VALUE SPACES.      06250000
062600     05 PV-ENT-DESC-LGTH2 REDEFINES PV-ENT-DESC-SNAME.            06260000
062700        10 PV-ENT-DESC-L2-SNM      PIC  X(02).                    06270000
062800        10 PV-ENT-DESC-L2-SUFF     PIC  X(03).                    06280000
062900        10 PV-ENT-DESC-L2-REST     PIC  X(05).                    06290000
063000     05 PV-ENT-DESC-LGTH3 REDEFINES PV-ENT-DESC-SNAME.            06300000
063100        10 PV-ENT-DESC-L3-SNM      PIC  X(03).                    06310000
063200        10 PV-ENT-DESC-L3-SUFF     PIC  X(03).                    06320000
063300        10 PV-ENT-DESC-L3-REST     PIC  X(04).                    06330000
063400     05 PV-ENT-DESC-LGTH4 REDEFINES PV-ENT-DESC-SNAME.            06340000
063500        10 PV-ENT-DESC-L4-SNM      PIC  X(04).                    06350000
063600        10 PV-ENT-DESC-L4-SUFF     PIC  X(03).                    06360000
063700        10 PV-ENT-DESC-L4-REST     PIC  X(03).                    06370000
063800     05 PV-ENT-DESC-LGTH5 REDEFINES PV-ENT-DESC-SNAME.            06380000
063900        10 PV-ENT-DESC-L5-SNM      PIC  X(05).                    06390000
064000        10 PV-ENT-DESC-L5-SUFF     PIC  X(03).                    06400000
064100        10 PV-ENT-DESC-L5-REST     PIC  X(02).                    06410000
064200     05 PV-ENT-DESC-LGTH6 REDEFINES PV-ENT-DESC-SNAME.            06420000
064300        10 PV-ENT-DESC-L6-SNM      PIC  X(06).                    06430000
064400        10 PV-ENT-DESC-L6-SUFF     PIC  X(03).                    06440000
064500        10 PV-ENT-DESC-L6-REST     PIC  X(01).                    06450000
064600     05 PV-SHORTNAME-TABLE.                                       06460000
064700        10 PV-SHORTNAME-VALUE      OCCURS 7 TIMES.                06470000
064800           15 SHORTNAME-BYTE       PIC X(01)  VALUE SPACES.       06480000
064900        10 PV-SHORTNAME-SUFFIX     PIC X(03)  VALUE SPACES.       06490000
065000        10 PV-SNAME-SUFF-NUM1 REDEFINES PV-SHORTNAME-SUFFIX.      06500000
065100           15 PV-SNM-SUFFIX        PIC 9(03).                     06510000
065200        10 PV-SNAME-SUFF-NUM2 REDEFINES PV-SHORTNAME-SUFFIX.      06520000
065300           15 PV-SNM-SUFF-POS1     PIC 9(01).                     06530000
065400           15 PV-SNM-SUFF-POS2     PIC 9(01).                     06540000
065500           15 PV-SNM-SUFF-POS3     PIC 9(01).                     06550000
065600        10 PV-SHORTNAME-REST       PIC X(20)  VALUE SPACES.       06560000
065700     05 PV-SHORTNAME-COMPARE       PIC  X(30).                    06570000
065800     05 PV-SNAME-SUBSTR-CMPR1      PIC  X(07).                    06580000
065900     05 PV-SNAME-SUBSTR-CHARS REDEFINES PV-SNAME-SUBSTR-CMPR1.    06590000
066000        10 PV-SNAME-SUB-POS-1      PIC  X(01).                    06600000
066100        10 PV-SNAME-SUB-POS-2      PIC  X(01).                    06610000
066200        10 PV-SNAME-SUB-POS-3      PIC  X(01).                    06620000
066300        10 PV-SNAME-SUB-POS-4      PIC  X(01).                    06630000
066400        10 PV-SNAME-SUB-POS-5      PIC  X(01).                    06640000
066500        10 PV-SNAME-SUB-POS-6      PIC  X(01).                    06650000
066600        10 PV-SNAME-SUB-POS-7      PIC  X(01).                    06660000
066700     05 PV-SNAME-SUBSTR-LT-7CHAR.                                 06670000
066800        10 PV-SNAME-SUBSTR-LGTH6   PIC  X(06).                    06680000
066900        10 PV-SNAME-SUBSTR-LGTH5   PIC  X(05).                    06690000
067000        10 PV-SNAME-SUBSTR-LGTH4   PIC  X(04).                    06700000
067100        10 PV-SNAME-SUBSTR-LGTH3   PIC  X(03).                    06710000
067200        10 PV-SNAME-SUBSTR-LGTH2   PIC  X(02).                    06720000
067300     05 PV-VALID-CHARACTER         PIC  X(01).                    06730000
067400        88 VALID-CHARACTER        VALUES '0', '1', '2', '3', '4', 06740000
067500                                         '5', '6', '7', '8', '9', 06750000
067600                                         'A', 'B', 'C', 'D', 'E', 06760000
067700                                         'F', 'G', 'H', 'I', 'J', 06770000
067800                                         'K', 'L', 'M', 'N', 'O', 06780000
067900                                         'P', 'Q', 'R', 'S', 'T', 06790000
068000                                         'U', 'V', 'W', 'X', 'Y', 06800000
068100                                         'Z'.                     06810000
068200     05 PV-VALID-PRNTR-TYP         PIC  X(02).                    06820000
068300        88 VALID-PRNTR-TYP        VALUES 'AG', 'BK', 'FA', 'TM',  06830000
068400                                         'S1', 'S2', 'OP', 'CL'.  06840000
068500     05 PV-VALID-CARRIER           PIC  X(02).                    06850000
068600        88 VALID-CARRIER          VALUES 'BR', 'CO', 'CR', 'DE',  06860000
068700                                         'FF'.                    06870000
068800                                                                  06880000
068900**--------------------------------------------------------------**06890000
069000** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **06900000
069100** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **06910000
069200**--------------------------------------------------------------**06920000
069300     COPY VNWS003.                                                06930000
069400 EJECT                                                            06940000
069500                                                                  06950000
069600*----------------------------------------------------------------*06960000
069700*    MAP LAYOUT                                                  *06970000
069800*----------------------------------------------------------------*06980000
069900                                                                  06990000
070000     COPY VNKM007.                                                07000000
070100                                                                  07010000
070200 EJECT                                                            07020000
070300*----------------------------------------------------------------*07030000
070400*    ATTRIBUTE SETTINGS COPYBOOK.                                *07040000
070500*----------------------------------------------------------------*07050000
070600                                                                  07060000
070700     COPY DPWS015.                                                07070000
070800                                                                  07080000
070900*----------------------------------------------------------------*07090000
071000*    FUNCTION KEYS COPYBOOK                                      *07100000
071100*----------------------------------------------------------------*07110000
071200                                                                  07120000
071300     COPY DPWS016.                                                07130000
071400                                                                  07140000
071500 EJECT                                                            07150000
071600**--------------------------------------------------------------**07160000
071700** COMMAREA FOR VNKCS024                                        **07170000
071800**--------------------------------------------------------------**07180000
071900 01 VN007-COMMAREA.                                               07190000
072000     COPY VNWS007.                                                07200000
072100 EJECT                                                            07210000
072200**--------------------------------------------------------------**07220000
072300** COMMAREA FOR VNKCS023                                        **07230000
072400**--------------------------------------------------------------**07240000
072500 01 VN013-COMMAREA.                                               07250000
072600     COPY VNWS013.                                                07260000
072700 EJECT                                                            07270000
072800**--------------------------------------------------------------**07280000
072900** NUMERIC EDIT LAYOUT (DPKUT100)                               **07290000
073000**--------------------------------------------------------------**07300000
073100     COPY DPWS010I.                                               07310000
073200 EJECT                                                            07320000
073300**--------------------------------------------------------------**07330000
073400** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **07340000
073500**--------------------------------------------------------------**07350000
073600     COPY DPWS030.                                                07360000
073700     COPY DPWS930.                                                07370000
073800 EJECT                                                            07380000
073900**--------------------------------------------------------------**07390000
074000*    STANDARD COMMAREA.                                           07400000
074100**--------------------------------------------------------------**07410000
074200                                                                  07420000
074300     COPY DPWS020.                                                07430000
074400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07440000
074500                                                                  07450000
074600***************************************************************** 07460000
074700*    INTER-APPLICATION COMMAREA.                                  07470000
074800***************************************************************** 07480000
074900                                                                  07490000
075000         10  INTER-APPL-COMM-AREA PIC X(200).                     07500000
075100     COPY VNWS001.                                                07510000
075200     COPY VNWS002.                                                07520000
075300     COPY VNWS004.                                                07530000
075400***************************************************************** 07540000
075500*    SPECIFIC COMMMAREA FOR VNKCS007.                             07550000
075600***************************************************************** 07560000
075700         10  ASC-SPECIFIC-COMMAREA.                               07570000
075800             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            07580000
075900             15  ASC-USE-SELECTION-QUEUE-IND                      07590000
076000                                           PIC  X(01).            07600000
076100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 07610000
076200             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            07620000
076300             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    07630000
076400             15  ASC-NUMBER-OF-SELECTED-ITEMS                     07640000
076500                                           PIC S9(09)  COMP-3.    07650000
076600             15  ASC-SEL-SUB               PIC S9(04)  COMP.      07660000
076700             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      07670000
076800             15  ASC-ADD-COMPLETE-SW       PIC  X(01).            07680000
076900                 88  ASC-ADD-COMPLETE                  VALUE 'Y'. 07690000
077000                 88  ASC-ADD-PENDING                   VALUE 'N'. 07700000
077100             15  ASC-ADD-MDEPT-SW          PIC  X(01).            07710000
077200                 88  ASC-NO-MDEPT                      VALUE 'N'. 07720000
077300                 88  ASC-ADD-MDEPT                     VALUE 'Y'. 07730000
077400             15  ASC-ADD-EDEPT-SW          PIC  X(01).            07740000
077500                 88  ASC-NO-EDEPT                      VALUE 'N'. 07750000
077600                 88  ASC-ADD-EDEPT                     VALUE 'Y'. 07760000
077700             15  ASC-MERCH-AUTH-SW         PIC  X(01).            07770000
077800                 88  ASC-NO-MERCH-AUTH                 VALUE 'N'. 07780000
077900                 88  ASC-MERCH-AUTH                    VALUE 'Y'. 07790000
078000             15  ASC-CAR-AUTH-SW           PIC  X(01).            07800000
078100                 88  ASC-NO-CAR-AUTH                   VALUE 'N'. 07810000
078200                 88  ASC-CAR-AUTH                      VALUE 'Y'. 07820000
078300             15  ASC-EXPENSE-AUTH-SW       PIC  X(01).            07830000
078400                 88  ASC-NO-EXPENSE-AUTH               VALUE 'N'. 07840000
078500                 88  ASC-EXPENSE-AUTH                  VALUE 'Y'. 07850000
078600             15  ASC-FACTOR-AUTH-SW        PIC  X(01).            07860000
078700                 88  ASC-NO-FACTOR-AUTH                VALUE 'N'. 07870000
078800                 88  ASC-FACTOR-AUTH                   VALUE 'Y'. 07880000
078900             15  ASC-PARENT-AUTH-SW        PIC  X(01).            07890000
079000                 88  ASC-NO-PARENT-AUTH                VALUE 'N'. 07900000
079100                 88  ASC-PARENT-AUTH                   VALUE 'Y'. 07910000
079200             15  ASC-PREPACK-EDI-AUTH-SW   PIC  X(01).            07920000
079300                 88  ASC-NO-PREPACK-EDI-AUTH           VALUE 'N'. 07930000
079400                 88  ASC-PREPACK-EDI-AUTH              VALUE 'Y'. 07940000
079500             15  ASC-VENDOR-HOLD-AUTH-SW   PIC  X(01).            07950000
079600                 88  ASC-NO-VENDOR-HOLD-AUTH           VALUE 'N'. 07960000
079700                 88  ASC-VENDOR-HOLD-AUTH              VALUE 'Y'. 07970000
079800             15 ASC-VNDR-NBR-POPULATED-SW  PIC  X(01).            07980000
079900                 88  ASC-VNDR-NBR-POPULATED            VALUE 'Y'. 07990000
080000                 88  ASC-VNDR-NBR-NOT-POPULATED        VALUE 'N'. 08000000
080100             15 ASC-PRNT-CO-ENT-ID         PIC S9(09)  COMP.      08010000
080200*                                                                 08020000
080300             15  ASC-SCREEN-DATA.                                 08030000
080400                 20  ASC-VEND-NAME         PIC  X(30).            08040000
080500                 20  ASC-VEND-SNME         PIC  X(10).            08050000
080600                 20  ASC-PRIMARY-TYPE      PIC  X(01).            08060000
080700                 20  ASC-PRIMARY-DESC      PIC  X(11).            08070000
080800                 20  ASC-DUN-NBR           PIC  X(09).            08080000
080900                 20  ASC-DUN-NBR-N REDEFINES ASC-DUN-NBR          08090000
081000                                           PIC  9(09).            08100000
081100                 20  ASC-STATUS-CDE        PIC  X(01).            08110000
081200                 20  ASC-VND-ENT-ID        PIC S9(09) COMP.       08120000
081300                 20  ASC-HLD-PAYT-IND      PIC  X(01).            08130000
081400                 20  ASC-PARENT-NAME       PIC  X(30).            08140000
081500                 20  ASC-PARENT-VENDOR-NBR.                       08150000
081600                     25  ASC-PARENT-VENDOR-NBR-N  PIC 9(09).      08160000
081700                 20  ASC-PREPACK-EDI-CDE   PIC  X(01).            08170000
081800                 20  ASC-VND-USING-FACTOR  PIC  X(01).            08180000
081900                 20  ASC-SEPERATE-PYMTS    PIC  X(01).            08190000
082000                 20  ASC-PAY-HNDLNG-CDE    PIC  X(02).            08200000
082100                 20  ASC-NDA-IND           PIC  X(01).            08210000
082200                 20  ASC-DEPT-NBR          PIC  X(03).            08220000
082300                 20  ASC-DEPT-NBR-N REDEFINES ASC-DEPT-NBR        08230000
082400                                           PIC  9(03).            08240000
082500                 20  ASC-INHOUSE-NBR       PIC  X(03).            08250000
082600                 20  ASC-INHOUSE-NBR-N REDEFINES ASC-INHOUSE-NBR  08260000
082700                                           PIC  9(03).            08270000
082800                 20  ASC-PRNT-CO-IND       PIC  X(01).            08280000
082900                 20  ASC-PARTNER-IND       PIC  X(01).            08290000
083000                 20  ASC-PARTNER-TYPE      PIC  X(02).            08300000
083100                 20  ASC-PARTNER-DESC      PIC  X(20).            08310000
083200                 20  ASC-SCAC-CDE          PIC  X(04).            08320000
083300                 20  ASC-CARR-MAN-PRO-IND  PIC  X(01).            08330000
083400                 20  ASC-LINE-OF-CREDIT    PIC  9(10).99.         08340000
083500                 20  ASC-LINE-OF-CREDIT-X REDEFINES               08350000
083600                     ASC-LINE-OF-CREDIT    PIC  X(13).            08360000
083700                 20  ASC-CAP-EXP-CDE       PIC  X(01).            08370000
083800                 20  ASC-DPTE-NBR          PIC  X(03).            08380000
083900                 20  ASC-DPTE-NBR-N REDEFINES ASC-DPTE-NBR        08390000
084000                                           PIC  9(03).            08400000
084100                 20  ASC-VND-CLSN-CDE      PIC  X(01).            08410000
084200                 20  ASC-VND-PRSST-CDE     PIC  X(01).            08420000
084300                 20  ASC-1099-NEEDED       PIC  X(01).            08430000
084400*                20  ASC-FED-TX-ID-TYP-CDE PIC  X(01).            08440000
084500*                20  ASC-FED-TX-ID-NBR     PIC  X(09).            08450000
084600*                20  ASC-FED-TX-ID-NBR-N REDEFINES                08460000
084700*                    ASC-FED-TX-ID-NBR     PIC  9(09).            08470000
084800                 20  ASC-WITHHOLD-CDE      PIC  X(05).            08480000
084900                 20  ASC-FACT-CAPACITY     PIC  9(11).            08490000
085000                 20  ASC-FACT-CAPACITY-X REDEFINES                08500000
085100                     ASC-FACT-CAPACITY     PIC  X(11).            08510000
085200             15  ASC-KEY-DATA.                                    08520000
085300                 20  ASC-ENT-ID            PIC S9(09) COMP.       08530000
085400                 20  ASC-KEY-VEND-NAME     PIC  X(30).            08540000
085500                 20  ASC-KEY-DUNS          PIC  X(09).            08550000
085600             15  ASC-CURRENT-DATE          PIC  X(10).            08560000
085700     EJECT                                                        08570000
085800*----------------------------------------------------------------*08580000
085900*    ABEND PROCESSING COPYBOOK.                                  *08590000
086000*----------------------------------------------------------------*08600000
086100                                                                  08610000
086200     COPY DPWS013.                                                08620000
086300                                                                  08630000
086400*----------------------------------------------------------------*08640000
086500*    CICSAUTH PROCESSING COPYBOOK.                               *08650000
086600*----------------------------------------------------------------*08660000
086700                                                                  08670000
086800     COPY DPWS008.                                                08680000
086900                                                                  08690000
087000*----------------------------------------------------------------*08700000
087100*    DATE ROUTINE (DPKUT500) COPYBOOK.                           *08710000
087200*----------------------------------------------------------------*08720000
087300                                                                  08730000
087400     COPY DPWS500.                                                08740000
087500                                                                  08750000
087600 EJECT                                                            08760000
087700*----------------------------------------------------------------*08770000
087800*    DB2 AREA FOR EXTERNAL ENTERPRISE                            *08780000
087900*----------------------------------------------------------------*08790000
088000     EXEC SQL                                                     08800000
088100          INCLUDE TEXTENT                                         08810000
088200     END-EXEC.                                                    08820000
088300*----------------------------------------------------------------*08830000
088400*    DB2 AREA FOR VENDOR DETAIL HISTORY TABLE                    *08840000
088500*----------------------------------------------------------------*08850000
088600     EXEC SQL                                                     08860000
088700          INCLUDE TVNDTAU                                         08870000
088800     END-EXEC.                                                    08880000
088900*----------------------------------------------------------------*08890000
089000*    DB2 AREA FOR ENTERPRISE NAME                                *08900000
089100*----------------------------------------------------------------*08910000
089200     EXEC SQL                                                     08920000
089300          INCLUDE TENTNME                                         08930000
089400     END-EXEC.                                                    08940000
089500*----------------------------------------------------------------*08950000
089600*    DB2 AREA FOR VENDOR CONTROL TABLE                           *08960000
089700*----------------------------------------------------------------*08970000
089800     EXEC SQL                                                     08980000
089900          INCLUDE TVNDCTL                                         08990000
090000     END-EXEC.                                                    09000000
090100*----------------------------------------------------------------*09010000
090200*    DB2 AREA FOR MERCHANDISE AREA                               *09020000
090300*----------------------------------------------------------------*09030000
090400     EXEC SQL                                                     09040000
090500          INCLUDE TMDSEAR                                         09050000
090600     END-EXEC.                                                    09060000
090700*----------------------------------------------------------------*09070000
090800*    DB2 AREA FOR VENDOR DEPARTMENT                              *09080000
090900*----------------------------------------------------------------*09090000
091000     EXEC SQL                                                     09100000
091100          INCLUDE TVNDDPT                                         09110000
091200     END-EXEC.                                                    09120000
091300*----------------------------------------------------------------*09130000
091400*    DB2 AREA FOR ORGANIZATIONAL UNIT                            *09140000
091500*----------------------------------------------------------------*09150000
091600     EXEC SQL                                                     09160000
091700          INCLUDE TORGUNT                                         09170000
091800     END-EXEC.                                                    09180000
091900*---------------------------------------------------------------* 09190000
092000*    DB2 AREA FOR SYSDUMMY1 IBM TABLE                           * 09200000
092100*---------------------------------------------------------------* 09210000
092200     EXEC SQL                                                     09220000
092300          INCLUDE SYSDUMMY                                        09230000
092400     END-EXEC.                                                    09240000
092500                                                                  09250000
092600*----------------------------------------------------------------*09260000
092700*    CURSOR FOR SHORTNAMES WITH 4 DIGIT SEQ NUMBERS              *09270000
092800*----------------------------------------------------------------*09280000
092900     EXEC SQL                                                     09290000
093000          DECLARE SHORTNAME_CSR CURSOR FOR                        09300000
093100          SELECT A.ENT_NAME_DESC                                  09310000
093200            FROM TENTNME A                                        09320000
093300           WHERE A.TYPE_CDE = '04'                                09330000
093400             AND A.ENT_NAME_DESC LIKE :PV-SHORTNAME-LIKE          09340000
093500             AND A.ENT_NAME_DESC >= :PV-SHORTNAME-1000X           09350000
093600           ORDER BY A.ENT_NAME_DESC DESC                          09360000
093700            WITH UR                                               09370000
093800     END-EXEC.                                                    09380000
093900                                                                  09390000
094000*----------------------------------------------------------------*09400000
094100*    VENDOR NUMBER CURSOR                                        *09410000
094200*----------------------------------------------------------------*09420000
094300     EXEC SQL                                                     09430000
094400          DECLARE VND_NBR_CSR CURSOR FOR                          09440000
094500          SELECT LAST_ASG_VND_NBR                                 09450000
094600            FROM TVNDCTL                                          09460000
094700             FOR UPDATE OF LAST_ASG_VND_NBR                       09470000
094800     END-EXEC.                                                    09480000
094900                                                                  09490000
095000*----------------------------------------------------------------*09500000
095100*    DB2 AREA FOR COMMUNICATIONS                                 *09510000
095200*----------------------------------------------------------------*09520000
095300     EXEC SQL                                                     09530000
095400          INCLUDE SQLCA                                           09540000
095500     END-EXEC.                                                    09550000
095600                                                                  09560000
095700 EJECT                                                            09570000
095800 LINKAGE SECTION.                                                 09580000
095900                                                                  09590000
096000 01  DFHCOMMAREA.                                                 09600000
096100     05  FILLER                         OCCURS  1 TO 4072 TIMES   09610000
096200                                        DEPENDING ON EIBCALEN.    09620000
096300         10  FILLER                     PIC X.                    09630000
096400                                                                  09640000
096500                                                                  09650000
096600 PROCEDURE DIVISION.                                              09660000
096700***************************************************************** 09670000
096800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 09680000
096900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 09690000
097000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 09700000
097100**                                                             ** 09710000
097200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 09720000
097300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 09730000
097400***************************************************************** 09740000
097500 0000-MAIN-MODULE.                                                09750000
097600                                                                  09760000
097700     INITIALIZE DP030-CICS-API-FIELDS.                            09770000
097800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09780000
097900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09790000
098000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09800000
098100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09810000
098200     MOVE LENGTH OF VN007AI        TO DP030-MAP-LENGTH (1).       09820000
098300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09830000
098400     PERFORM 0001-CALL-CICS-ARCH-API.                             09840000
098500                                                                  09850000
098600     PERFORM 1000-CONTROL-PROCESSING.                             09860000
098700                                                                  09870000
098800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09880000
098900     PERFORM 0001-CALL-CICS-ARCH-API.                             09890000
099000                                                                  09900000
099100 0001-CALL-CICS-ARCH-API.                                         09910000
099200                                                                  09920000
099300*    CALL 'DPKCS030' USING DFHEIBLK                               09930000
099400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09940000
099500                           DFHCOMMAREA                            09950000
099600                           DP030-CICS-API-FIELDS                  09960000
099700                           DP020-STANDARD-COMMAREA                09970000
099800                           VN007AI.                               09980000
099900                                                                  09990000
100000     IF  DP030-RC-CALL-SUCCESSFUL                                 10000000
100100         CONTINUE                                                 10010000
100200     ELSE                                                         10020000
100300         SET DP013-NO-ROLLBACK                                    10030000
100400             DP013-XCTL-DISPLAY-RESTART                           10040000
100500             DP013-CICS-ABEND      TO TRUE                        10050000
100600         MOVE 'BEFORE 0000-MAIN-MODULE'                           10060000
100700                                   TO DP013-PARAGRAPH             10070000
100800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX10080000
100900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      10090000
101000         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10100000
101100-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10110000
101200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10120000
101300         PERFORM DP013-0000-PROCESS-ABEND                         10130000
101400     END-IF.                                                      10140000
101500                                                                  10150000
101600*----------------------------------------------------------------*10160000
101700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *10170000
101800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *10180000
101900*----------------------------------------------------------------*10190000
102000 1000-CONTROL-PROCESSING.                                         10200000
102100                                                                  10210000
102200     EVALUATE TRUE                                                10220000
102300         WHEN DP020-NEXT-ACT-INITIAL                              10230000
102400             INITIALIZE ASC-SPECIFIC-COMMAREA                     10240000
102500             MOVE DP020-INT-APPL-FORMAT-IND                       10250000
102600                 TO ASC-INT-APPL-FORMAT-IND                       10260000
102700             PERFORM 1100-FIND-OBJECT-KEYS                        10270000
102800             IF  PS-ERROR                                         10280000
102900                 CONTINUE                                         10290000
103000             ELSE                                                 10300000
103100                 PERFORM 4000-BUILD-INITIAL-PANEL                 10310000
103200                 IF SQLCODE = +100                                10320000
103300                     IF  VN001-DUNS-NUMBER > SPACES               10330000
103400                         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE    10340000
103500                         MOVE PC-TSYMSG-00159                     10350000
103600                                  TO DP020-MSG-NUMBER             10360000
103700                         SET DP020-MSG-INFORMATIONAL TO TRUE      10370000
103800                     ELSE                                         10380000
103900                     IF VN001-VENDOR-NAME > SPACES                10390000
104000                         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE    10400000
104100                         MOVE PC-TSYMSG-00398                     10410000
104200                                  TO DP020-MSG-NUMBER             10420000
104300                         SET DP020-MSG-INFORMATIONAL TO TRUE      10430000
104400                     END-IF                                       10440000
104500                     END-IF                                       10450000
104600                 END-IF                                           10460000
104700             END-IF                                               10470000
104800                                                                  10480000
104900         WHEN DP020-NEXT-ACT-READ-MAP                             10490000
105000             PERFORM 2000-PROCESS-PANEL                           10500000
105100                                                                  10510000
105200         WHEN DP020-NEXT-ACT-RETURN                               10520000
105300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10530000
105400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10540000
105500                                                                  10550000
105600         WHEN OTHER                                               10560000
105700             SET DP013-LOGIC-ABEND TO TRUE                        10570000
105800             SET DP013-NO-ROLLBACK TO TRUE                        10580000
105900             MOVE '1000-CONTROL-PROCESSING'                       10590000
106000                                   TO DP013-PARAGRAPH             10600000
106100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   10610000
106200                                   TO DP013-MESSAGE-TEXT(1)       10620000
106300             MOVE DP020-NEXT-APPL-ACTIVITY                        10630000
106400                                   TO DP013-MESSAGE-TEXT(2)       10640000
106500             PERFORM DP013-0000-PROCESS-ABEND                     10650000
106600     END-EVALUATE.                                                10660000
106700                                                                  10670000
106800******************************************************************10680000
106900** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **10690000
107000** INTER-APPLICATION FORMAT CODE.                               **10700000
107100******************************************************************10710000
107200 1100-FIND-OBJECT-KEYS.                                           10720000
107300                                                                  10730000
107400     INITIALIZE ASC-KEY-DATA.                                     10740000
107500                                                                  10750000
107600     EXEC SQL                                                     10760000
107700         SET :ASC-CURRENT-DATE    = CURRENT DATE                  10770000
107800     END-EXEC.                                                    10780000
107900                                                                  10790000
108000     PERFORM 1110-CHECK-AUTHORIZATIONS.                           10800000
108100                                                                  10810000
108200     EVALUATE ASC-INT-APPL-FORMAT-IND                             10820000
108300         WHEN PC-INTER-APPL-ADD                                   10830000
108400             MOVE ZERO TO ASC-ENT-ID                              10840000
108500             SET ASC-ADD-PENDING TO TRUE                          10850000
108600         WHEN PC-INTER-APPL-UP-CRIT                               10860000
108700             IF  VN001-DUNS-NUMBER > SPACES                       10870000
108800                 MOVE VN001-DUNS-NUMBER TO ASC-KEY-DUNS           10880000
108900             ELSE                                                 10890000
109000             IF VN001-VENDOR-NAME > SPACES                        10900000
109100                 MOVE VN001-VENDOR-NAME TO ASC-KEY-VEND-NAME      10910000
109200             END-IF                                               10920000
109300             END-IF                                               10930000
109400                                                                  10940000
109500         WHEN PC-INTER-APPL-UP-LIST                               10950000
109600             SET ASC-USE-SELECTION-QUEUE TO TRUE                  10960000
109700             MOVE VN002-NUMBER-OF-SELECTED-ITEMS                  10970000
109800                                   TO ASC-NUMBER-OF-SELECTED-ITEMS10980000
109900             MOVE VN002-NUMBER-OF-TS-ITEMS                        10990000
110000                                   TO ASC-NUMBER-OF-TS-ITEMS      11000000
110100             MOVE VN002-SEL-QUEUE-NAME                            11010000
110200                                   TO ASC-SEL-QUEUE-NAME          11020000
110300             PERFORM 1120-PREPARE-LIST-ENTRY                      11030000
110400                                                                  11040000
110500     END-EVALUATE.                                                11050000
110600                                                                  11060000
110700******************************************************************11070000
110800** DETERMINE WHAT VENDOR TYPE USER HAS AUTHORITY TO.            **11080000
110900*  IF THE USER IS AUTHORIZED FOR TRANSACTION V100, THIS MEANS    *11090000
111000*  THAT HE CAN DO MERCHANDISE VENDOR CHANGES.                    *11100000
111100******************************************************************11110000
111200 1110-CHECK-AUTHORIZATIONS.                                       11120000
111300                                                                  11130000
111400     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     11140000
111500     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     11150000
111600     MOVE 'V100'                     TO DP008-RESOURCE-NAME.      11160000
111700                                                                  11170000
111800     EXEC CICS                                                    11180000
111900          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               11190000
112000               COMMAREA (DP008-SECURITY-COMMAREA)                 11200000
112100               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          11210000
112200               RESP     (PV-CICS-RESPONSE)                        11220000
112300     END-EXEC.                                                    11230000
112400                                                                  11240000
112500     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       11250000
112600         IF  DP008-CALL-SUCCESSFUL                                11260000
112700             IF  DP008-ACCESS-ALLOWED                             11270000
112800                 SET ASC-MERCH-AUTH  TO TRUE                      11280000
112900             ELSE                                                 11290000
113000                 SET ASC-NO-MERCH-AUTH                            11300000
113100                                     TO TRUE                      11310000
113200             END-IF                                               11320000
113300         ELSE                                                     11330000
113400             SET DP013-NO-ROLLBACK                                11340000
113500                 DP013-XCTL-DISPLAY-RESTART                       11350000
113600                 DP013-CICS-ABEND  TO TRUE                        11360000
113700             MOVE '1110-CHECK-AUTHORIZATIONS'                     11370000
113800                                   TO DP013-PARAGRAPH             11380000
113900             MOVE 'INVALID RETURN CODE AUTH CALL - MERCH'         11390000
114000                                   TO DP013-MESSAGE-TEXT (1)      11400000
114100             MOVE DP008-ERROR-CODE                                11410000
114200                                   TO DP013-MESSAGE-TEXT (2)      11420000
114300             PERFORM DP013-0000-PROCESS-ABEND                     11430000
114400         END-IF                                                   11440000
114500     ELSE                                                         11450000
114600         SET DP013-NO-ROLLBACK                                    11460000
114700             DP013-XCTL-DISPLAY-RESTART                           11470000
114800             DP013-CICS-ABEND      TO TRUE                        11480000
114900         MOVE '1110-CHECK-AUTHORIZATIONS'                         11490000
115000                                   TO DP013-PARAGRAPH             11500000
115100         MOVE 'FAILED CALL OF AUTH ROUTINE - MERCH'               11510000
115200                                   TO DP013-MESSAGE-TEXT (1)      11520000
115300         PERFORM DP013-0000-PROCESS-ABEND                         11530000
115400     END-IF.                                                      11540000
115500                                                                  11550000
115600******************************************************************11560000
115700*  IF THE USER IS AUTHORIZED FOR TRANSACTION V101, THIS MEANS    *11570000
115800*  THAT HE CAN DO CARRIER VENDOR CHANGES.                        *11580000
115900******************************************************************11590000
116000     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     11600000
116100     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     11610000
116200     MOVE 'V101'                     TO DP008-RESOURCE-NAME.      11620000
116300                                                                  11630000
116400     EXEC CICS                                                    11640000
116500          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               11650000
116600               COMMAREA (DP008-SECURITY-COMMAREA)                 11660000
116700               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          11670000
116800               RESP     (PV-CICS-RESPONSE)                        11680000
116900     END-EXEC.                                                    11690000
117000                                                                  11700000
117100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       11710000
117200         IF  DP008-CALL-SUCCESSFUL                                11720000
117300             IF  DP008-ACCESS-ALLOWED                             11730000
117400                 SET ASC-CAR-AUTH    TO TRUE                      11740000
117500             ELSE                                                 11750000
117600                 SET ASC-NO-CAR-AUTH                              11760000
117700                                     TO TRUE                      11770000
117800             END-IF                                               11780000
117900         ELSE                                                     11790000
118000             SET DP013-NO-ROLLBACK                                11800000
118100                 DP013-XCTL-DISPLAY-RESTART                       11810000
118200                 DP013-CICS-ABEND  TO TRUE                        11820000
118300             MOVE '1110-CHECK-AUTHORIZATIONS'                     11830000
118400                                   TO DP013-PARAGRAPH             11840000
118500             MOVE 'INVALID RETURN CODE AUTH CALL - CAR'           11850000
118600                                   TO DP013-MESSAGE-TEXT (1)      11860000
118700             MOVE DP008-ERROR-CODE                                11870000
118800                                   TO DP013-MESSAGE-TEXT (2)      11880000
118900             PERFORM DP013-0000-PROCESS-ABEND                     11890000
119000         END-IF                                                   11900000
119100     ELSE                                                         11910000
119200         SET DP013-NO-ROLLBACK                                    11920000
119300             DP013-XCTL-DISPLAY-RESTART                           11930000
119400             DP013-CICS-ABEND      TO TRUE                        11940000
119500         MOVE '1110-CHECK-AUTHORIZATIONS'                         11950000
119600                                   TO DP013-PARAGRAPH             11960000
119700         MOVE 'FAILED CALL OF AUTH ROUTINE - CAR'                 11970000
119800                                   TO DP013-MESSAGE-TEXT (1)      11980000
119900         PERFORM DP013-0000-PROCESS-ABEND                         11990000
120000     END-IF.                                                      12000000
120100******************************************************************12010000
120200*  IF THE USER IS AUTHORIZED FOR TRANSACTION V102, THIS MEANS    *12020000
120300*  THAT HE CAN DO EXPENSE VENDOR CHANGES.                         12030000
120400******************************************************************12040000
120500     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     12050000
120600     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     12060000
120700     MOVE 'V102'                     TO DP008-RESOURCE-NAME.      12070000
120800                                                                  12080000
120900     EXEC CICS                                                    12090000
121000          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               12100000
121100               COMMAREA (DP008-SECURITY-COMMAREA)                 12110000
121200               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          12120000
121300               RESP     (PV-CICS-RESPONSE)                        12130000
121400     END-EXEC.                                                    12140000
121500                                                                  12150000
121600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       12160000
121700         IF  DP008-CALL-SUCCESSFUL                                12170000
121800             IF  DP008-ACCESS-ALLOWED                             12180000
121900                 SET ASC-EXPENSE-AUTH TO TRUE                     12190000
122000             ELSE                                                 12200000
122100                 SET ASC-NO-EXPENSE-AUTH TO TRUE                  12210000
122200             END-IF                                               12220000
122300         ELSE                                                     12230000
122400             SET DP013-NO-ROLLBACK                                12240000
122500                 DP013-XCTL-DISPLAY-RESTART                       12250000
122600                 DP013-CICS-ABEND  TO TRUE                        12260000
122700             MOVE '1110-CHECK-AUTHORIZATIONS'                     12270000
122800                                   TO DP013-PARAGRAPH             12280000
122900             MOVE 'INVALID RETURN CODE AUTH CALL - EXPENSE'       12290000
123000                                   TO DP013-MESSAGE-TEXT (1)      12300000
123100             MOVE DP008-ERROR-CODE                                12310000
123200                                   TO DP013-MESSAGE-TEXT (2)      12320000
123300             PERFORM DP013-0000-PROCESS-ABEND                     12330000
123400         END-IF                                                   12340000
123500     ELSE                                                         12350000
123600         SET DP013-NO-ROLLBACK                                    12360000
123700             DP013-XCTL-DISPLAY-RESTART                           12370000
123800             DP013-CICS-ABEND      TO TRUE                        12380000
123900         MOVE '1110-CHECK-AUTHORIZATIONS'                         12390000
124000                                   TO DP013-PARAGRAPH             12400000
124100         MOVE 'FAILED CALL OF AUTH ROUTINE - EXPENSE'             12410000
124200                                   TO DP013-MESSAGE-TEXT (1)      12420000
124300         PERFORM DP013-0000-PROCESS-ABEND                         12430000
124400     END-IF.                                                      12440000
124500                                                                  12450000
124600******************************************************************12460000
124700*  IF THE USER IS AUTHORIZED FOR TRANSACTION V103, THIS MEANS    *12470000
124800*  THAT HE CAN SET UP FACTORS ON THE VENDOR DATABASE             *12480000
124900******************************************************************12490000
125000     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     12500000
125100     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     12510000
125200     MOVE 'V103'                     TO DP008-RESOURCE-NAME.      12520000
125300                                                                  12530000
125400     EXEC CICS                                                    12540000
125500          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               12550000
125600               COMMAREA (DP008-SECURITY-COMMAREA)                 12560000
125700               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          12570000
125800               RESP     (PV-CICS-RESPONSE)                        12580000
125900     END-EXEC.                                                    12590000
126000                                                                  12600000
126100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       12610000
126200         IF  DP008-CALL-SUCCESSFUL                                12620000
126300             IF  DP008-ACCESS-ALLOWED                             12630000
126400                 SET ASC-FACTOR-AUTH TO TRUE                      12640000
126500             ELSE                                                 12650000
126600                 SET ASC-NO-FACTOR-AUTH TO TRUE                   12660000
126700             END-IF                                               12670000
126800         ELSE                                                     12680000
126900             SET DP013-NO-ROLLBACK                                12690000
127000                 DP013-XCTL-DISPLAY-RESTART                       12700000
127100                 DP013-CICS-ABEND  TO TRUE                        12710000
127200             MOVE '1110-CHECK-AUTHORIZATIONS'                     12720000
127300                                   TO DP013-PARAGRAPH             12730000
127400             MOVE 'INVALID RETURN CODE AUTH CALL - FACTOR '       12740000
127500                                   TO DP013-MESSAGE-TEXT (1)      12750000
127600             MOVE DP008-ERROR-CODE                                12760000
127700                                   TO DP013-MESSAGE-TEXT (2)      12770000
127800             PERFORM DP013-0000-PROCESS-ABEND                     12780000
127900         END-IF                                                   12790000
128000     ELSE                                                         12800000
128100         SET DP013-NO-ROLLBACK                                    12810000
128200             DP013-XCTL-DISPLAY-RESTART                           12820000
128300             DP013-CICS-ABEND      TO TRUE                        12830000
128400         MOVE '1110-CHECK-AUTHORIZATIONS'                         12840000
128500                                   TO DP013-PARAGRAPH             12850000
128600         MOVE 'FAILED CALL OF AUTH ROUTINE - FACTOR '             12860000
128700                                   TO DP013-MESSAGE-TEXT (1)      12870000
128800         PERFORM DP013-0000-PROCESS-ABEND                         12880000
128900     END-IF.                                                      12890000
129000                                                                  12900000
129100******************************************************************12910000
129200*  IF THE USER IS AUTHORIZED FOR TRANSACTION V104, THIS MEANS    *12920000
129300*  THAT HE CAN SET UP PARENT COMPANIES ON THE VENDOR DATABASE    *12930000
129400******************************************************************12940000
129500     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     12950000
129600     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     12960000
129700     MOVE 'V104'                     TO DP008-RESOURCE-NAME.      12970000
129800                                                                  12980000
129900     EXEC CICS                                                    12990000
130000          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               13000000
130100               COMMAREA (DP008-SECURITY-COMMAREA)                 13010000
130200               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          13020000
130300               RESP     (PV-CICS-RESPONSE)                        13030000
130400     END-EXEC.                                                    13040000
130500                                                                  13050000
130600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       13060000
130700         IF  DP008-CALL-SUCCESSFUL                                13070000
130800             IF  DP008-ACCESS-ALLOWED                             13080000
130900                 SET ASC-PARENT-AUTH TO TRUE                      13090000
131000             ELSE                                                 13100000
131100                 SET ASC-NO-PARENT-AUTH TO TRUE                   13110000
131200             END-IF                                               13120000
131300         ELSE                                                     13130000
131400             SET DP013-NO-ROLLBACK                                13140000
131500                 DP013-XCTL-DISPLAY-RESTART                       13150000
131600                 DP013-CICS-ABEND  TO TRUE                        13160000
131700             MOVE '1110-CHECK-AUTHORIZATIONS'                     13170000
131800                                   TO DP013-PARAGRAPH             13180000
131900             MOVE 'INVALID RETURN CODE AUTH CALL - PARENT '       13190000
132000                                   TO DP013-MESSAGE-TEXT (1)      13200000
132100             MOVE DP008-ERROR-CODE                                13210000
132200                                   TO DP013-MESSAGE-TEXT (2)      13220000
132300             PERFORM DP013-0000-PROCESS-ABEND                     13230000
132400         END-IF                                                   13240000
132500     ELSE                                                         13250000
132600         SET DP013-NO-ROLLBACK                                    13260000
132700             DP013-XCTL-DISPLAY-RESTART                           13270000
132800             DP013-CICS-ABEND      TO TRUE                        13280000
132900         MOVE '1110-CHECK-AUTHORIZATIONS'                         13290000
133000                                   TO DP013-PARAGRAPH             13300000
133100         MOVE 'FAILED CALL OF AUTH ROUTINE - PARENT '             13310000
133200                                   TO DP013-MESSAGE-TEXT (1)      13320000
133300         PERFORM DP013-0000-PROCESS-ABEND                         13330000
133400     END-IF.                                                      13340000
133500                                                                  13350000
133600******************************************************************13360000
133700*  IF THE USER IS AUTHORIZED FOR TRANSACTION V105, THIS MEANS    *13370000
133800*  THAT HE CAN UPDATE THE PREPACK EDI CODE (ONLY MIO)            *13380000
133900******************************************************************13390000
134000     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     13400000
134100     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     13410000
134200     MOVE 'V105'                     TO DP008-RESOURCE-NAME.      13420000
134300                                                                  13430000
134400     EXEC CICS                                                    13440000
134500          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               13450000
134600               COMMAREA (DP008-SECURITY-COMMAREA)                 13460000
134700               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          13470000
134800               RESP     (PV-CICS-RESPONSE)                        13480000
134900     END-EXEC.                                                    13490000
135000                                                                  13500000
135100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       13510000
135200         IF  DP008-CALL-SUCCESSFUL                                13520000
135300             IF  DP008-ACCESS-ALLOWED                             13530000
135400                 SET ASC-PREPACK-EDI-AUTH TO TRUE                 13540000
135500             ELSE                                                 13550000
135600                 SET ASC-NO-PREPACK-EDI-AUTH TO TRUE              13560000
135700             END-IF                                               13570000
135800         ELSE                                                     13580000
135900             SET DP013-NO-ROLLBACK                                13590000
136000                 DP013-XCTL-DISPLAY-RESTART                       13600000
136100                 DP013-CICS-ABEND  TO TRUE                        13610000
136200             MOVE '1110-CHECK-AUTHORIZATIONS'                     13620000
136300                                   TO DP013-PARAGRAPH             13630000
136400             MOVE 'INVALID RETURN CODE AUTH CALL - PREPAK '       13640000
136500                                   TO DP013-MESSAGE-TEXT (1)      13650000
136600             MOVE DP008-ERROR-CODE                                13660000
136700                                   TO DP013-MESSAGE-TEXT (2)      13670000
136800             PERFORM DP013-0000-PROCESS-ABEND                     13680000
136900         END-IF                                                   13690000
137000     ELSE                                                         13700000
137100         SET DP013-NO-ROLLBACK                                    13710000
137200             DP013-XCTL-DISPLAY-RESTART                           13720000
137300             DP013-CICS-ABEND      TO TRUE                        13730000
137400         MOVE '1110-CHECK-AUTHORIZATIONS'                         13740000
137500                                   TO DP013-PARAGRAPH             13750000
137600         MOVE 'FAILED CALL OF AUTH ROUTINE - PREPAK '             13760000
137700                                   TO DP013-MESSAGE-TEXT (1)      13770000
137800         PERFORM DP013-0000-PROCESS-ABEND                         13780000
137900     END-IF.                                                      13790000
138000                                                                  13800000
138100******************************************************************13810000
138200*  IF THE USER IS AUTHORIZED FOR FUNCTION VNUPHOLD, THIS MEANS   *13820000
138300*  THAT HE CAN UPDATE THE FOLLOWING FIELDS AND NO OTHER FIELDS:  *13830000
138400*  SHORT NAME, STATUS, VENDOR ON HOLD, PARENT COMPANY, USING     *13840000
138500*  FACTOR, SEPARATE PYMTS, PAYMENT HANDLING, CLASSIFICATION,     *13850000
138600*  PERSISTENCE, 1099 VENDOR, TAX ID TYPE, TAX ID, WITHOLDING CDE.*13860000
138700******************************************************************13870000
138800                                                                  13880000
138900     SET DP008-RSRC-TYPE-FUNC        TO TRUE.                     13890000
139000     MOVE 'VNUPHOLD'                 TO DP008-FUNCTION-NAME.      13900000
139100     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     13910000
139200                                                                  13920000
139300     EXEC CICS                                                    13930000
139400          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               13940000
139500               COMMAREA (DP008-SECURITY-COMMAREA)                 13950000
139600               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          13960000
139700               RESP     (PV-CICS-RESPONSE)                        13970000
139800     END-EXEC.                                                    13980000
139900                                                                  13990000
140000     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       14000000
140100         IF  DP008-CALL-SUCCESSFUL                                14010000
140200             IF  DP008-ACCESS-ALLOWED                             14020000
140300                 SET ASC-VENDOR-HOLD-AUTH TO TRUE                 14030000
140400             ELSE                                                 14040000
140500                 SET ASC-NO-VENDOR-HOLD-AUTH TO TRUE              14050000
140600             END-IF                                               14060000
140700         ELSE                                                     14070000
140800             SET DP013-NO-ROLLBACK                                14080000
140900                 DP013-XCTL-DISPLAY-RESTART                       14090000
141000                 DP013-CICS-ABEND  TO TRUE                        14100000
141100             MOVE '1110-CHECK-AUTHORIZATIONS'                     14110000
141200                                   TO DP013-PARAGRAPH             14120000
141300             MOVE 'INVALID RETURN CODE AUTH CALL - VEND HOLD'     14130000
141400                                   TO DP013-MESSAGE-TEXT (1)      14140000
141500             MOVE DP008-ERROR-CODE                                14150000
141600                                   TO DP013-MESSAGE-TEXT (2)      14160000
141700             PERFORM DP013-0000-PROCESS-ABEND                     14170000
141800         END-IF                                                   14180000
141900     ELSE                                                         14190000
142000         SET DP013-NO-ROLLBACK                                    14200000
142100             DP013-XCTL-DISPLAY-RESTART                           14210000
142200             DP013-CICS-ABEND      TO TRUE                        14220000
142300         MOVE '1110-CHECK-AUTHORIZATIONS'                         14230000
142400                                   TO DP013-PARAGRAPH             14240000
142500         MOVE 'FAILED CALL OF AUTH ROUTINE - VEND HOLD'           14250000
142600                                   TO DP013-MESSAGE-TEXT (1)      14260000
142700         PERFORM DP013-0000-PROCESS-ABEND                         14270000
142800     END-IF.                                                      14280000
142900                                                                  14290000
143000*----------------------------------------------------------------*14300000
143100* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *14310000
143200* STORAGE QUEUE PASSED FROM THE LIST.                            *14320000
143300*----------------------------------------------------------------*14330000
143400 1120-PREPARE-LIST-ENTRY.                                         14340000
143500                                                                  14350000
143600     MOVE VN003-MAX-ITEMS          TO ASC-SEL-SUB.                14360000
143700     MOVE ZERO                     TO ASC-SEL-ITEM.               14370000
143800     PERFORM 2110-GET-NEXT-VENDOR.                                14380000
143900                                                                  14390000
144000*----------------------------------------------------------------*14400000
144100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *14410000
144200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *14420000
144300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *14430000
144400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *14440000
144500* FUNCTION KEYS CAN GET THIS FAR.                                *14450000
144600*----------------------------------------------------------------*14460000
144700 2000-PROCESS-PANEL.                                              14470000
144800                                                                  14480000
144900     EVALUATE TRUE                                                14490000
145000         WHEN DP020-SRC-AID = DP016-CLEAR                         14500000
145100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14510000
145200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14520000
145300                                                                  14530000
145400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     14540000
145500             SET DP030-DONT-ERASE                                 14550000
145600                 DP030-SEND-DATAONLY (PC-APPL-MAP)                14560000
145700                                   TO TRUE                        14570000
145800             INITIALIZE ASC-SCREEN-DATA                           14580000
145900             PERFORM 4000-BUILD-INITIAL-PANEL                     14590000
146000             PERFORM 3200-RESET-ATTRIBUTES                        14600000
146100                                                                  14610000
146200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             14620000
146300             IF  ASC-USE-SELECTION-QUEUE                          14630000
146400                 INITIALIZE ASC-SCREEN-DATA                       14640000
146500                 PERFORM 2110-GET-NEXT-VENDOR                     14650000
146600                 PERFORM 4000-BUILD-INITIAL-PANEL                 14660000
146700                 PERFORM 3200-RESET-ATTRIBUTES                    14670000
146800             ELSE                                                 14680000
146900*                --- BOTTOM OF LIST ---                           14690000
147000                 MOVE PC-TSYMSG-00070                             14700000
147100                                   TO DP020-MSG-NUMBER            14710000
147200                 SET DP020-MSG-INFORMATIONAL                      14720000
147300                                   TO TRUE                        14730000
147400             END-IF                                               14740000
147500                                                                  14750000
147600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             14760000
147700             IF  ASC-USE-SELECTION-QUEUE                          14770000
147800                 INITIALIZE ASC-SCREEN-DATA                       14780000
147900                 PERFORM 2120-GET-PREV-VENDOR                     14790000
148000                 PERFORM 4000-BUILD-INITIAL-PANEL                 14800000
148100                 PERFORM 3200-RESET-ATTRIBUTES                    14810000
148200             ELSE                                                 14820000
148300*                --- TOP OF LIST ---                              14830000
148400                 MOVE PC-TSYMSG-00069                             14840000
148500                                   TO DP020-MSG-NUMBER            14850000
148600                 SET DP020-MSG-INFORMATIONAL                      14860000
148700                                   TO TRUE                        14870000
148800             END-IF                                               14880000
148900                                                                  14890000
149000         WHEN OTHER                                               14900000
149100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14910000
149200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14920000
149300             IF  PS-NO-ERROR                                      14930000
149400                 SET DP030-CONTINUE-GO                            14940000
149500                                   TO TRUE                        14950000
149600                 PERFORM 2100-CHECK-FUNCTION-KEY                  14960000
149700             ELSE                                                 14970000
149800                 SET DP030-OVERRIDE-GO                            14980000
149900                                   TO TRUE                        14990000
150000             END-IF                                               15000000
150100     END-EVALUATE.                                                15010000
150200                                                                  15020000
150300*----------------------------------------------------------------*15030000
150400* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *15040000
150500* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *15050000
150600* FROM THE CICS ARCHITECTURE API.                                *15060000
150700*----------------------------------------------------------------*15070000
150800 2100-CHECK-FUNCTION-KEY.                                         15080000
150900                                                                  15090000
151000     EVALUATE TRUE                                                15100000
151100         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 15110000
151200         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              15120000
151300         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              15130000
151400         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              15140000
151500         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              15150000
151600             IF ASC-ENT-ID > ZERO                                 15160000
151700                 INITIALIZE VN004-INTER-APPL-COMMAREA             15170000
151800                 MOVE ASC-ENT-ID TO VN004-ENT-ID                  15180000
151900             ELSE                                                 15190000
152000                 SET DP030-OVERRIDE-GO TO TRUE                    15200000
152100                 MOVE PC-TSYMSG-00166 TO DP020-MSG-NUMBER         15210000
152200                 SET DP020-MSG-WARNING TO TRUE                    15220000
152300             END-IF                                               15230000
152400                                                                  15240000
152500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              15250000
152600             SET DP030-CONTINUE-GO TO TRUE                        15260000
152700             PERFORM 5000-UPDATE-VENDOR                           15270000
152800                                                                  15280000
152900             IF PS-ERROR                                          15290000
153000               CONTINUE                                           15300000
153100             ELSE                                                 15310000
153200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15320000
153300             END-IF                                               15330000
153400                                                                  15340000
153500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              15350000
153600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              15360000
153700             IF ASC-VEND-NAME > SPACES                            15370000
153800                 INITIALIZE VN001-INTER-APPL-COMMAREA             15380000
153900                 MOVE ASC-VEND-NAME TO VN001-VENDOR-NAME          15390000
154000             ELSE                                                 15400000
154100                 SET DP030-OVERRIDE-GO TO TRUE                    15410000
154200                 MOVE PC-TSYMSG-00166 TO DP020-MSG-NUMBER         15420000
154300                 SET DP020-MSG-WARNING TO TRUE                    15430000
154400             END-IF                                               15440000
154500                                                                  15450000
154600         WHEN ASC-ADD-COMPLETE                                    15460000
154700             PERFORM 1100-FIND-OBJECT-KEYS                        15470000
154800             IF  PS-ERROR                                         15480000
154900                 CONTINUE                                         15490000
155000             ELSE                                                 15500000
155100                 PERFORM 4000-BUILD-INITIAL-PANEL                 15510000
155200             END-IF                                               15520000
155300                                                                  15530000
155400         WHEN DP020-SRC-AID = DP016-ENTER                         15540000
155500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15550000
155600                                                                  15560000
155700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              15570000
155800             SET DP030-CONTINUE-GO TO TRUE                        15580000
155900             IF VENDOR-NUMBER-NOT-ENTERED                         15590000
156000                 PERFORM 5600-AUTO-GENERATE-DUNS                  15600000
156100             END-IF                                               15610000
156200             IF PS-ERROR                                          15620000
156300                 CONTINUE                                         15630000
156400             ELSE                                                 15640000
156500                 PERFORM 6000-ADD-VENDOR                          15650000
156600                 IF PS-ERROR                                      15660000
156700                     CONTINUE                                     15670000
156800                 ELSE                                             15680000
156900                     IF VENDOR-NUMBER-NOT-ENTERED                 15690000
157000                         PERFORM 6600-UPDATE-TVNDCTL              15700000
157100                         SET ASC-VNDR-NBR-POPULATED TO TRUE       15710000
157200                     END-IF                                       15720000
157300                     INITIALIZE DCLTVNDTAU                        15730000
157400                     MOVE 'A'             TO VNDTAU-AUD-FUNC-CDE  15740000
157500                     MOVE ASC-ENT-ID      TO VNDTAU-ENT-ID        15750000
157600                     PERFORM 6010-MOVE-TO-DETAIL-HISTORY          15760000
157700                     PERFORM 6020-INSERT-DETAIL-HISTORY-ROW       15770000
157800                     IF ASC-PARTNER-IND = 'Y'                     15780000
157900** DO NOT SEND MESSAGE TO RMS PO FOR PARTNER TYPES 'FA' AND 'S2'  15790000
158000** BECAUSE THESE REQUIRE A LONG NAME BEFORE GOING TO RMS.         15800000
158100**8                     IF (ASC-PARTNER-TYPE NOT = 'FA') OR       15810000
158200                        IF (ASC-PARTNER-TYPE NOT = 'FA') AND      15820000
158300                           (ASC-PARTNER-TYPE NOT = 'S2')          15830000
158400                           PERFORM 8100-INSERT-INTO-RMS           15840000
158500                        END-IF                                    15850000
158600                     END-IF                                       15860000
158700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         15870000
158800                     IF (ASC-PARTNER-IND = 'Y') AND               15880000
158900                        (ASC-PARTNER-TYPE = 'FA' OR 'S2')         15890000
159000**  VENDOR PARTNER ADDED, BUT NOT TO RMS PO - NEEDS LONG NAME     15900000
159100                        MOVE PC-TSYMSG-03624  TO DP020-MSG-NUMBER 15910000
159200                     END-IF                                       15920000
159300                     SET DP020-MSG-INFORMATIONAL                  15930000
159400                                           TO TRUE                15940000
159500                     SET ASC-ADD-COMPLETE TO TRUE                 15950000
159600                     SET DP030-ERASE-UNPROT TO TRUE               15960000
159700                 END-IF                                           15970000
159800             END-IF                                               15980000
159900                                                                  15990000
160000             IF ASC-VNDR-NBR-NOT-POPULATED                        16000000
160100                 PERFORM 5611-CLOSE-VENDOR-NBR-CSR                16010000
160200             END-IF                                               16020000
160300                                                                  16030000
160400         WHEN OTHER                                               16040000
160500             SET DP013-NO-ROLLBACK                                16050000
160600                 DP013-XCTL-DISPLAY-RESTART                       16060000
160700                 DP013-CICS-ABEND  TO TRUE                        16070000
160800             MOVE '2100-CHECK-FUNCTION-KEY'                       16080000
160900                                   TO DP013-PARAGRAPH             16090000
161000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      16100000
161100                                   TO DP013-MESSAGE-TEXT (1)      16110000
161200             PERFORM DP013-0000-PROCESS-ABEND                     16120000
161300     END-EVALUATE.                                                16130000
161400                                                                  16140000
161500******************************************************************16150000
161600** GET THE VENDOR  NUMBER (KEY) OF THE NEXT SELECTED            **16160000
161700** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **16170000
161800******************************************************************16180000
161900 2110-GET-NEXT-VENDOR.                                            16190000
162000                                                                  16200000
162100     ADD +1                        TO ASC-SEL-SUB.                16210000
162200     IF  ASC-SEL-SUB > VN003-MAX-ITEMS                            16220000
162300         ADD +1                    TO ASC-SEL-ITEM                16230000
162400         MOVE +1                   TO ASC-SEL-SUB                 16240000
162500     END-IF.                                                      16250000
162600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                16260000
162700         PERFORM 9100-READ-SEL-QUEUE                              16270000
162800         IF  VN003-ENT-ID (ASC-SEL-SUB) > ZERO                    16280000
162900             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      16290000
163000                                   TO ASC-ENT-ID                  16300000
163100             SET VN003-INQ (ASC-SEL-SUB)                          16310000
163200                                   TO TRUE                        16320000
163300             PERFORM 9200-REWRITE-LIST-QUEUE                      16330000
163400         ELSE                                                     16340000
163500             SUBTRACT +1 FROM ASC-SEL-SUB                         16350000
163600*            --- BOTTOM OF LIST ---                               16360000
163700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16370000
163800             SET DP020-MSG-INFORMATIONAL                          16380000
163900                                   TO TRUE                        16390000
164000         END-IF                                                   16400000
164100     ELSE                                                         16410000
164200         SUBTRACT +1 FROM ASC-SEL-ITEM                            16420000
164300         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 16430000
164400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16440000
164500         SET DP020-MSG-INFORMATIONAL                              16450000
164600                                   TO TRUE                        16460000
164700     END-IF.                                                      16470000
164800                                                                  16480000
164900******************************************************************16490000
165000** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **16500000
165100** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **16510000
165200******************************************************************16520000
165300 2120-GET-PREV-VENDOR.                                            16530000
165400                                                                  16540000
165500     SUBTRACT +1 FROM ASC-SEL-SUB.                                16550000
165600     IF  ASC-SEL-SUB < +1                                         16560000
165700         SUBTRACT +1 FROM ASC-SEL-ITEM                            16570000
165800         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 16580000
165900     END-IF.                                                      16590000
166000                                                                  16600000
166100     IF  ASC-SEL-ITEM > ZERO                                      16610000
166200         PERFORM 9100-READ-SEL-QUEUE                              16620000
166300         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          16630000
166400                                   TO ASC-ENT-ID                  16640000
166500     ELSE                                                         16650000
166600         MOVE +1                   TO ASC-SEL-ITEM                16660000
166700                                      ASC-SEL-SUB                 16670000
166800*        --- TOP OF LIST ---                                      16680000
166900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16690000
167000         SET DP020-MSG-INFORMATIONAL                              16700000
167100                                   TO TRUE                        16710000
167200     END-IF.                                                      16720000
167300                                                                  16730000
167400*----------------------------------------------------------------*16740000
167500* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *16750000
167600* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *16760000
167700* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *16770000
167800*----------------------------------------------------------------*16780000
167900 2200-MOVE-SCREEN-TO-COMMAREA.                                    16790000
168000                                                                  16800000
168100     IF AVNNAMEL > ZERO                                           16810000
168200         MOVE AVNNAMEI             TO ASC-VEND-NAME               16820000
168300     ELSE                                                         16830000
168400         IF AVNNAMEF = DP015-ERASE-EOF                            16840000
168500             MOVE SPACE            TO ASC-VEND-NAME               16850000
168600         END-IF                                                   16860000
168700     END-IF.                                                      16870000
168800                                                                  16880000
168900     IF AVNSNMEL > ZERO                                           16890000
169000         MOVE AVNSNMEI             TO ASC-VEND-SNME               16900000
169100     ELSE                                                         16910000
169200         IF AVNSNMEF = DP015-ERASE-EOF                            16920000
169300             MOVE SPACE            TO ASC-VEND-SNME               16930000
169400         END-IF                                                   16940000
169500     END-IF.                                                      16950000
169600                                                                  16960000
169700     IF AVNSTATL > ZERO                                           16970000
169800         MOVE AVNSTATI             TO ASC-STATUS-CDE              16980000
169900     ELSE                                                         16990000
170000         IF AVNSTATF = DP015-ERASE-EOF                            17000000
170100             MOVE SPACE            TO ASC-STATUS-CDE              17010000
170200         END-IF                                                   17020000
170300         IF ASC-ADD-PENDING                                       17030000
170400             MOVE 'A'              TO ASC-STATUS-CDE              17040000
170500         END-IF                                                   17050000
170600     END-IF.                                                      17060000
170700                                                                  17070000
170800     IF ADUNNBRL > ZERO                                           17080000
170900         MOVE ADUNNBRI             TO ASC-DUN-NBR                 17090000
171000     ELSE                                                         17100000
171100         IF ADUNNBRF = DP015-ERASE-EOF                            17110000
171200             MOVE SPACE            TO ASC-DUN-NBR                 17120000
171300         END-IF                                                   17130000
171400     END-IF.                                                      17140000
171500                                                                  17150000
171600     IF APRNTCOL > ZERO AND                                       17160000
171700        APRNTNBL > ZERO                                           17170000
171800         SET PS-PARENT-ERROR-YES TO TRUE                          17180000
171900     ELSE                                                         17190000
172000         SET PS-PARENT-ERROR-NO TO TRUE                           17200000
172100     END-IF.                                                      17210000
172200                                                                  17220000
172300     IF APRNTCOL > ZERO                                           17230000
172400         MOVE APRNTCOI             TO ASC-PARENT-NAME             17240000
172500     ELSE                                                         17250000
172600         IF APRNTCOF = DP015-ERASE-EOF                            17260000
172700             MOVE SPACE            TO ASC-PARENT-NAME             17270000
172800         END-IF                                                   17280000
172900     END-IF.                                                      17290000
173000                                                                  17300000
173100     IF APRNTNBL > ZERO                                           17310000
173200         MOVE APRNTNBI             TO ASC-PARENT-VENDOR-NBR       17320000
173300     ELSE                                                         17330000
173400         IF APRNTNBF = DP015-ERASE-EOF                            17340000
173500             MOVE SPACE            TO ASC-PARENT-VENDOR-NBR       17350000
173600         END-IF                                                   17360000
173700     END-IF.                                                      17370000
173800                                                                  17380000
173900     IF APRNTCOF = DP015-ERASE-EOF OR                             17390000
174000        APRNTNBF = DP015-ERASE-EOF                                17400000
174100         SET PS-REMOVE-PARENT-YES TO TRUE                         17410000
174200     ELSE                                                         17420000
174300         SET PS-REMOVE-PARENT-NO TO TRUE                          17430000
174400     END-IF.                                                      17440000
174500                                                                  17450000
174600     IF AVNHOLDL > ZERO                                           17460000
174700         MOVE AVNHOLDI             TO ASC-HLD-PAYT-IND            17470000
174800     ELSE                                                         17480000
174900         IF AVNHOLDF = DP015-ERASE-EOF                            17490000
175000             MOVE SPACE            TO ASC-HLD-PAYT-IND            17500000
175100         END-IF                                                   17510000
175200     END-IF.                                                      17520000
175300                                                                  17530000
175400     IF AUSEFACL > ZERO                                           17540000
175500         MOVE AUSEFACI             TO ASC-VND-USING-FACTOR        17550000
175600     ELSE                                                         17560000
175700         IF AUSEFACF = DP015-ERASE-EOF                            17570000
175800             MOVE SPACE            TO ASC-VND-USING-FACTOR        17580000
175900         END-IF                                                   17590000
176000     END-IF.                                                      17600000
176100                                                                  17610000
176200     IF ASEPPAYL > ZERO                                           17620000
176300         MOVE ASEPPAYI             TO ASC-SEPERATE-PYMTS          17630000
176400     ELSE                                                         17640000
176500         IF ASEPPAYF = DP015-ERASE-EOF                            17650000
176600             MOVE SPACE            TO ASC-SEPERATE-PYMTS          17660000
176700         END-IF                                                   17670000
176800     END-IF.                                                      17680000
176900                                                                  17690000
177000     IF APPEDIL > ZERO                                            17700000
177100         MOVE APPEDII              TO ASC-PREPACK-EDI-CDE         17710000
177200     ELSE                                                         17720000
177300         IF APPEDIF = DP015-ERASE-EOF                             17730000
177400             MOVE SPACE            TO ASC-PREPACK-EDI-CDE         17740000
177500         END-IF                                                   17750000
177600     END-IF.                                                      17760000
177700                                                                  17770000
177800     IF ASC-NO-MDEPT                                              17780000
177900         MOVE SPACE                TO ASC-DEPT-NBR                17790000
178000     ELSE                                                         17800000
178100         IF ADPTNBRL > ZERO                                       17810000
178200             MOVE ADPTNBRI         TO ASC-DEPT-NBR                17820000
178300         ELSE                                                     17830000
178400             IF ADPTNBRF = DP015-ERASE-EOF                        17840000
178500                 MOVE SPACE        TO ASC-DEPT-NBR                17850000
178600             END-IF                                               17860000
178700         END-IF                                                   17870000
178800     END-IF.                                                      17880000
178900                                                                  17890000
179000     IF ASC-NO-MDEPT                                              17900000
179100         MOVE SPACE                TO ASC-INHOUSE-NBR             17910000
179200     ELSE                                                         17920000
179300         IF AINHSL > ZERO                                         17930000
179400             MOVE AINHSI           TO ASC-INHOUSE-NBR             17940000
179500         ELSE                                                     17950000
179600             IF AINHSF = DP015-ERASE-EOF                          17960000
179700                 MOVE SPACE        TO ASC-INHOUSE-NBR             17970000
179800             END-IF                                               17980000
179900         END-IF                                                   17990000
180000     END-IF.                                                      18000000
180100                                                                  18010000
180200     IF APRMTYPL > ZERO                                           18020000
180300         MOVE APRMTYPI             TO ASC-PRIMARY-TYPE            18030000
180400         MOVE ATYPDSCI             TO ASC-PRIMARY-DESC            18040000
180500     ELSE                                                         18050000
180600         IF APRMTYPF = DP015-ERASE-EOF                            18060000
180700             MOVE SPACE            TO ASC-PRIMARY-TYPE            18070000
180800                                      ASC-PRIMARY-DESC            18080000
180900         END-IF                                                   18090000
181000     END-IF.                                                      18100000
181100                                                                  18110000
181200     IF APRTNRL > ZERO                                            18120000
181300         MOVE APRTNRI             TO ASC-PARTNER-IND              18130000
181400     ELSE                                                         18140000
181500         IF APRTNRF = DP015-ERASE-EOF                             18150000
181600             MOVE SPACE            TO ASC-PARTNER-IND             18160000
181700         END-IF                                                   18170000
181800     END-IF.                                                      18180000
181900                                                                  18190000
182000     IF APTNRTYL > ZERO                                           18200000
182100        MOVE APTNRTYI              TO ASC-PARTNER-TYPE            18210000
182200        MOVE APTRDSCI              TO ASC-PARTNER-DESC            18220000
182300     ELSE                                                         18230000
182400        IF APTNRTYF = DP015-ERASE-EOF                             18240000
182500           MOVE SPACES             TO ASC-PARTNER-TYPE            18250000
182600                                      ASC-PARTNER-DESC            18260000
182700     END-IF.                                                      18270000
182800                                                                  18280000
182900     IF ASCACL > ZERO                                             18290000
183000         MOVE ASCACI               TO ASC-SCAC-CDE                18300000
183100     ELSE                                                         18310000
183200         IF ASCACF = DP015-ERASE-EOF                              18320000
183300             MOVE SPACE            TO ASC-SCAC-CDE                18330000
183400         END-IF                                                   18340000
183500     END-IF.                                                      18350000
183600                                                                  18360000
183700     IF AMANPROL > ZERO                                           18370000
183800         MOVE AMANPROI             TO ASC-CARR-MAN-PRO-IND        18380000
183900     ELSE                                                         18390000
184000         IF AMANPROF = DP015-ERASE-EOF                            18400000
184100             MOVE SPACE            TO ASC-CARR-MAN-PRO-IND        18410000
184200         END-IF                                                   18420000
184300     END-IF.                                                      18430000
184400                                                                  18440000
184500     IF ALNCRDTL > ZERO                                           18450000
184600        MOVE ALNCRDTI              TO ASC-LINE-OF-CREDIT-X        18460000
184700     ELSE                                                         18470000
184800         IF ALNCRDTF = DP015-ERASE-EOF                            18480000
184900             MOVE ZEROES           TO ASC-LINE-OF-CREDIT-X        18490000
185000         END-IF                                                   18500000
185100     END-IF.                                                      18510000
185200                                                                  18520000
185300     IF ACPACTYL > ZERO                                           18530000
185400        MOVE ACPACTYI              TO ASC-FACT-CAPACITY-X         18540000
185500     ELSE                                                         18550000
185600         IF ACPACTYF = DP015-ERASE-EOF                            18560000
185700             MOVE ZEROES           TO ASC-FACT-CAPACITY-X         18570000
185800         END-IF                                                   18580000
185900     END-IF.                                                      18590000
186000                                                                  18600000
186100     IF ACAPEXPL > ZERO                                           18610000
186200         MOVE ACAPEXPI             TO ASC-CAP-EXP-CDE             18620000
186300     ELSE                                                         18630000
186400         IF ACAPEXPF = DP015-ERASE-EOF                            18640000
186500             MOVE SPACE            TO ASC-CAP-EXP-CDE             18650000
186600         END-IF                                                   18660000
186700     END-IF.                                                      18670000
186800                                                                  18680000
186900     IF ASC-NO-EDEPT                                              18690000
187000         MOVE SPACE                TO ASC-DPTE-NBR                18700000
187100     ELSE                                                         18710000
187200         IF ADPTEXPL > ZERO                                       18720000
187300             MOVE ADPTEXPI         TO ASC-DPTE-NBR                18730000
187400         ELSE                                                     18740000
187500             IF ADPTEXPF = DP015-ERASE-EOF                        18750000
187600                 MOVE SPACE        TO ASC-DPTE-NBR                18760000
187700             END-IF                                               18770000
187800         END-IF                                                   18780000
187900     END-IF.                                                      18790000
188000                                                                  18800000
188100     IF ACLASFCL > ZERO                                           18810000
188200         MOVE ACLASFCI             TO ASC-VND-CLSN-CDE            18820000
188300     ELSE                                                         18830000
188400         IF ACLASFCF = DP015-ERASE-EOF                            18840000
188500             MOVE SPACE            TO ASC-VND-CLSN-CDE            18850000
188600         END-IF                                                   18860000
188700     END-IF.                                                      18870000
188800                                                                  18880000
188900     IF APERSISL > ZERO                                           18890000
189000         MOVE APERSISI             TO ASC-VND-PRSST-CDE           18900000
189100     ELSE                                                         18910000
189200         IF APERSISF = DP015-ERASE-EOF                            18920000
189300             MOVE SPACE            TO ASC-VND-PRSST-CDE           18930000
189400         END-IF                                                   18940000
189500     END-IF.                                                      18950000
189600                                                                  18960000
189700     IF A1099L > ZERO                                             18970000
189800         MOVE A1099I               TO ASC-1099-NEEDED             18980000
189900     ELSE                                                         18990000
190000         IF A1099F = DP015-ERASE-EOF                              19000000
190100             MOVE SPACE            TO ASC-1099-NEEDED             19010000
190200         END-IF                                                   19020000
190300     END-IF.                                                      19030000
190400                                                                  19040000
190500*    IF ATAXIDTL > ZERO                                           19050000
190600*        MOVE ATAXIDTI             TO ASC-FED-TX-ID-TYP-CDE       19060000
190700*    ELSE                                                         19070000
190800*        IF ATAXIDTF = DP015-ERASE-EOF                            19080000
190900*            MOVE SPACE            TO ASC-FED-TX-ID-TYP-CDE       19090000
191000*        END-IF                                                   19100000
191100*    END-IF.                                                      19110000
191200                                                                  19120000
191300*    IF ATAXIDL > ZERO                                            19130000
191400*        MOVE ATAXIDI              TO ASC-FED-TX-ID-NBR           19140000
191500*    ELSE                                                         19150000
191600*        IF ATAXIDF = DP015-ERASE-EOF                             19160000
191700*            MOVE SPACE            TO ASC-FED-TX-ID-NBR           19170000
191800*        END-IF                                                   19180000
191900*    END-IF.                                                      19190000
192000                                                                  19200000
192100     IF AWTHCDEL > ZERO                                           19210000
192200         MOVE AWTHCDEI             TO ASC-WITHHOLD-CDE            19220000
192300     ELSE                                                         19230000
192400         IF AWTHCDEF = DP015-ERASE-EOF                            19240000
192500             MOVE SPACE            TO ASC-WITHHOLD-CDE            19250000
192600         END-IF                                                   19260000
192700     END-IF.                                                      19270000
192800                                                                  19280000
192900     IF APARINDL > ZERO                                           19290000
193000         MOVE APARINDI             TO ASC-PRNT-CO-IND             19300000
193100     ELSE                                                         19310000
193200         IF APARINDF = DP015-ERASE-EOF                            19320000
193300             MOVE SPACE            TO ASC-PRNT-CO-IND             19330000
193400         END-IF                                                   19340000
193500     END-IF.                                                      19350000
193600                                                                  19360000
193700     IF APAYHNDL > ZERO                                           19370000
193800         MOVE APAYHNDI             TO ASC-PAY-HNDLNG-CDE          19380000
193900     ELSE                                                         19390000
194000         IF APAYHNDF = DP015-ERASE-EOF                            19400000
194100             MOVE SPACE            TO ASC-PAY-HNDLNG-CDE          19410000
194200         END-IF                                                   19420000
194300     END-IF.                                                      19430000
194400                                                                  19440000
194500     IF ANDAINDL > ZERO                                           19450000
194600        MOVE ANDAINDI            TO ASC-NDA-IND                   19460000
194700     ELSE                                                         19470000
194800         IF ANDAINDF = DP015-ERASE-EOF                            19480000
194900            MOVE 'N'                 TO ASC-NDA-IND               19490000
195000         END-IF                                                   19500000
195100     END-IF.                                                      19510000
195200                                                                  19520000
195300                                                                  19530000
195400*----------------------------------------------------------------*19540000
195500* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *19550000
195600* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *19560000
195700* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *19570000
195800*----------------------------------------------------------------*19580000
195900 3000-EDIT-DATA-IN-COMMAREA.                                      19590000
196000                                                                  19600000
196100     PERFORM 3200-RESET-ATTRIBUTES.                               19610000
196200                                                                  19620000
196300     IF  ASC-PRIMARY-TYPE = 'M' OR 'E' OR 'F'                     19630000
196400         CONTINUE                                                 19640000
196500     ELSE                                                         19650000
196600         SET PS-ERROR              TO TRUE                        19660000
196700         SET DP020-MSG-FATAL       TO TRUE                        19670000
196800*  VALID VALUES ONLY M, E, F                                      19680000
196900         MOVE PC-TSYMSG-02622      TO DP020-MSG-NUMBER            19690000
197000         MOVE DP015-UNP-ALP-BRT-OFF                               19700000
197100                                   TO APRMTYPA                    19710000
197200         MOVE DP015-RED            TO APRMTYPC                    19720000
197300         MOVE DP015-REVERSE        TO APRMTYPH                    19730000
197400         MOVE -1                   TO APRMTYPL                    19740000
197500         SET DP030-SET-CURSOR-APPL-1                              19750000
197600                                   TO TRUE                        19760000
197700     END-IF.                                                      19770000
197800                                                                  19780000
197900     IF ASC-PRIMARY-TYPE = 'M'                                    19790000
198000        IF ASC-MERCH-AUTH                                         19800000
198100           CONTINUE                                               19810000
198200        ELSE                                                      19820000
198300            SET PS-ERROR           TO TRUE                        19830000
198400            SET DP020-MSG-FATAL    TO TRUE                        19840000
198500*  NOT AUTHORIZED FOR THIS VENDOR TYPE                            19850000
198600         MOVE PC-TSYMSG-02633      TO DP020-MSG-NUMBER            19860000
198700            MOVE DP015-UNP-ALP-BRT-OFF                            19870000
198800                                      TO APRMTYPA                 19880000
198900            MOVE DP015-RED         TO APRMTYPC                    19890000
199000            MOVE DP015-REVERSE     TO APRMTYPH                    19900000
199100            MOVE -1                TO APRMTYPL                    19910000
199200            SET DP030-SET-CURSOR-APPL-1                           19920000
199300                                      TO TRUE                     19930000
199400        END-IF                                                    19940000
199500     END-IF.                                                      19950000
199600                                                                  19960000
199700     IF ASC-PRIMARY-TYPE = 'F'                                    19970000
199800        IF ASC-FACTOR-AUTH                                        19980000
199900           CONTINUE                                               19990000
200000        ELSE                                                      20000000
200100            SET PS-ERROR           TO TRUE                        20010000
200200            SET DP020-MSG-FATAL    TO TRUE                        20020000
200300*  NOT AUTHORIZED FOR THIS VENDOR TYPE                            20030000
200400         MOVE PC-TSYMSG-02633      TO DP020-MSG-NUMBER            20040000
200500            MOVE DP015-UNP-ALP-BRT-OFF                            20050000
200600                                      TO APRMTYPA                 20060000
200700            MOVE DP015-RED         TO APRMTYPC                    20070000
200800            MOVE DP015-REVERSE     TO APRMTYPH                    20080000
200900            MOVE -1                TO APRMTYPL                    20090000
201000            SET DP030-SET-CURSOR-APPL-1                           20100000
201100                                      TO TRUE                     20110000
201200        END-IF                                                    20120000
201300     END-IF.                                                      20130000
201400                                                                  20140000
201500     IF ASC-PRIMARY-TYPE = 'E'                                    20150000
201600        IF ASC-EXPENSE-AUTH OR ASC-CAR-AUTH                       20160000
201700           CONTINUE                                               20170000
201800        ELSE                                                      20180000
201900            SET PS-ERROR           TO TRUE                        20190000
202000            SET DP020-MSG-FATAL    TO TRUE                        20200000
202100*  NOT AUTHORIZED FOR THIS VENDOR TYPE                            20210000
202200         MOVE PC-TSYMSG-02633      TO DP020-MSG-NUMBER            20220000
202300           MOVE DP015-UNP-ALP-BRT-OFF                             20230000
202400                                     TO APRMTYPA                  20240000
202500           MOVE DP015-RED          TO APRMTYPC                    20250000
202600           MOVE DP015-REVERSE      TO APRMTYPH                    20260000
202700           MOVE -1                 TO APRMTYPL                    20270000
202800           SET DP030-SET-CURSOR-APPL-1                            20280000
202900                                     TO TRUE                      20290000
203000        END-IF                                                    20300000
203100     END-IF.                                                      20310000
203200                                                                  20320000
203300     IF  ASC-PRNT-CO-IND = 'Y' OR 'N' OR SPACE                    20330000
203400         CONTINUE                                                 20340000
203500     ELSE                                                         20350000
203600         SET PS-ERROR              TO TRUE                        20360000
203700         SET DP020-MSG-FATAL       TO TRUE                        20370000
203800         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            20380000
203900         MOVE DP015-UNP-ALP-BRT-OFF                               20390000
204000                                   TO APARINDA                    20400000
204100         MOVE DP015-RED            TO APARINDC                    20410000
204200         MOVE DP015-REVERSE        TO APARINDH                    20420000
204300         MOVE -1                   TO APARINDL                    20430000
204400         SET DP030-SET-CURSOR-APPL-1                              20440000
204500                                   TO TRUE                        20450000
204600     END-IF.                                                      20460000
204700                                                                  20470000
204800     IF ASC-PRNT-CO-IND = 'N' OR SPACE                            20480000
204900        MOVE 'N' TO ASC-PRNT-CO-IND                               20490000
205000     ELSE                                                         20500000
205100        IF ASC-PRNT-CO-IND = 'Y'                                  20510000
205200           IF ASC-PRIMARY-TYPE = 'M'                              20520000
205300              CONTINUE                                            20530000
205400           ELSE                                                   20540000
205500              SET PS-ERROR       TO TRUE                          20550000
205600              SET DP020-MSG-FATAL TO TRUE                         20560000
205700              MOVE PC-TSYMSG-02639 TO DP020-MSG-NUMBER            20570000
205800              MOVE DP015-UNP-ALP-BRT-OFF                          20580000
205900                                        TO APARINDA               20590000
206000              MOVE DP015-RED     TO APARINDC                      20600000
206100              MOVE DP015-REVERSE TO APARINDH                      20610000
206200              MOVE -1            TO APARINDL                      20620000
206300              SET DP030-SET-CURSOR-APPL-1                         20630000
206400                                        TO TRUE                   20640000
206500           END-IF                                                 20650000
206600        END-IF                                                    20660000
206700     END-IF.                                                      20670000
206800                                                                  20680000
206900     IF  ASC-PAY-HNDLNG-CDE = 'PR' OR 'RE' OR 'RT' OR 'FN' OR     20690000
207000                              'CT' OR 'TX' OR 'IV' OR 'CN' OR     20700000
207100                              'CP' OR 'CR' OR 'CV' OR 'MP' OR     20710000
207200                              'LR' OR 'TU' OR 'TH' OR 'FR' OR     20720000
207300                              'AP' OR 'ZB' OR 'LF' OR 'DP' OR     20730000
207400                              'SB' OR 'NX'                        20740000
207500         CONTINUE                                                 20750000
207600     ELSE                                                         20760000
207700      IF ASC-PAY-HNDLNG-CDE = SPACES OR LOW-VALUES                20770000
207800          MOVE 'RE'         TO ASC-PAY-HNDLNG-CDE                 20780000
207900      ELSE                                                        20790000
208000          SET PS-ERROR              TO TRUE                       20800000
208100          SET DP020-MSG-FATAL       TO TRUE                       20810000
208200          MOVE PC-TSYMSG-02017      TO DP020-MSG-NUMBER           20820000
208300          MOVE DP015-UNP-ALP-BRT-OFF                              20830000
208400                                    TO APAYHNDA                   20840000
208500          MOVE DP015-RED            TO APAYHNDC                   20850000
208600          MOVE DP015-REVERSE        TO APAYHNDH                   20860000
208700          MOVE -1                   TO APAYHNDL                   20870000
208800          SET DP030-SET-CURSOR-APPL-1                             20880000
208900                                    TO TRUE                       20890000
209000      END-IF.                                                     20900000
209100                                                                  20910000
209200     IF  ASC-WITHHOLD-CDE > SPACE                                 20920000
209300         IF  ASC-PRIMARY-TYPE = 'E'                               20930000
209400             IF  ASC-1099-NEEDED = 'Y'                            20940000
209500                 IF ASC-WITHHOLD-CDE = '01' OR '02' OR '03' OR    20950000
209600                                       '04' OR '05' OR '06' OR    20960000
209700                               '07' OR '08' OR '09' OR '10'       20970000
209800                     CONTINUE                                     20980000
209900                 ELSE                                             20990000
210000                     SET PS-ERROR              TO TRUE            21000000
210100                     SET DP020-MSG-FATAL       TO TRUE            21010000
210200                     MOVE PC-TSYMSG-01944                         21020000
210300                                               TO DP020-MSG-NUMBER21030000
210400                     MOVE DP015-UNP-ALP-BRT-OFF                   21040000
210500                                       TO AWTHCDEA                21050000
210600                     MOVE DP015-RED            TO AWTHCDEC        21060000
210700                     MOVE DP015-REVERSE        TO AWTHCDEH        21070000
210800                     MOVE -1                   TO AWTHCDEL        21080000
210900                     SET DP030-SET-CURSOR-APPL-1                  21090000
211000                                               TO TRUE            21100000
211100                 END-IF                                           21110000
211200             ELSE                                                 21120000
211300                 SET PS-ERROR          TO TRUE                    21130000
211400                 SET DP020-MSG-FATAL   TO TRUE                    21140000
211500                 MOVE PC-TSYMSG-01983  TO DP020-MSG-NUMBER        21150000
211600                 MOVE DP015-UNP-ALP-BRT-OFF                       21160000
211700                                       TO AWTHCDEA                21170000
211800                 MOVE DP015-RED        TO AWTHCDEC                21180000
211900                 MOVE DP015-REVERSE    TO AWTHCDEH                21190000
212000                 MOVE -1               TO AWTHCDEL                21200000
212100                 SET DP030-SET-CURSOR-APPL-1                      21210000
212200                                       TO TRUE                    21220000
212300             END-IF                                               21230000
212400         ELSE                                                     21240000
212500             SET PS-ERROR              TO TRUE                    21250000
212600             SET DP020-MSG-FATAL       TO TRUE                    21260000
212700             MOVE PC-TSYMSG-01862                                 21270000
212800                                       TO DP020-MSG-NUMBER        21280000
212900             MOVE DP015-UNP-ALP-BRT-OFF                           21290000
213000                               TO AWTHCDEA                        21300000
213100             MOVE DP015-RED            TO AWTHCDEC                21310000
213200             MOVE DP015-REVERSE        TO AWTHCDEH                21320000
213300             MOVE -1                   TO AWTHCDEL                21330000
213400             SET DP030-SET-CURSOR-APPL-1                          21340000
213500                                       TO TRUE                    21350000
213600         END-IF                                                   21360000
213700     ELSE                                                         21370000
213800         IF  ASC-PRIMARY-TYPE = 'E'                               21380000
213900             IF  ASC-1099-NEEDED = 'Y'                            21390000
214000                 SET PS-ERROR              TO TRUE                21400000
214100                 SET DP020-MSG-FATAL       TO TRUE                21410000
214200                 MOVE PC-TSYMSG-01944      TO DP020-MSG-NUMBER    21420000
214300                 MOVE DP015-UNP-ALP-BRT-OFF                       21430000
214400                                           TO AWTHCDEA            21440000
214500                 MOVE DP015-RED            TO AWTHCDEC            21450000
214600                 MOVE DP015-REVERSE        TO AWTHCDEH            21460000
214700                 MOVE -1                   TO AWTHCDEL            21470000
214800                 SET DP030-SET-CURSOR-APPL-1                      21480000
214900                                           TO TRUE                21490000
215000             END-IF                                               21500000
215100         END-IF                                                   21510000
215200     END-IF.                                                      21520000
215300                                                                  21530000
215400*    IF  ASC-FED-TX-ID-NBR > SPACE                                21540000
215500*        IF  ASC-PRIMARY-TYPE = 'E'                               21550000
215600*            IF  ASC-1099-NEEDED = 'Y'                            21560000
215700*                MOVE ASC-FED-TX-ID-NBR TO DP010I-UNEDITED-FIELD  21570000
215800*                MOVE 9                 TO DP010I-MAXIMUM-DIGITS  21580000
215900*                MOVE 0                 TO DP010I-MAXIMUM-DECIMALS21590000
216000*                SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE          21600000
216100*                CALL 'DPKUT100' USING DP010I-NUMERIC-EDIT-AREA   21610000
216200*                IF DP010I-ERROR-DETECTED                         21620000
216300*                    SET PS-ERROR          TO TRUE                21630000
216400*                    SET DP020-MSG-FATAL   TO TRUE                21640000
216500*                    --- MUST BE NUMERIC    ---                   21650000
216600*                    MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    21660000
216700*                    MOVE DP015-UNP-ALP-BRT-OFF                   21670000
216800*                                          TO ATAXIDA             21680000
216900*                    MOVE DP015-RED        TO ATAXIDC             21690000
217000*                    MOVE DP015-REVERSE    TO ATAXIDH             21700000
217100*                    MOVE -1               TO ATAXIDL             21710000
217200*                    SET DP030-SET-CURSOR-APPL-1                  21720000
217300*                                          TO TRUE                21730000
217400*                ELSE                                             21740000
217500*                    MOVE DP010I-NUMERIC-FIELD                    21750000
217600*                                          TO ASC-FED-TX-ID-NBR-N 21760000
217700*                END-IF                                           21770000
217800*            ELSE                                                 21780000
217900*                SET PS-ERROR          TO TRUE                    21790000
218000*                SET DP020-MSG-FATAL   TO TRUE                    21800000
218100*                MOVE PC-TSYMSG-01983  TO DP020-MSG-NUMBER        21810000
218200*                MOVE DP015-UNP-ALP-BRT-OFF                       21820000
218300*                                      TO ATAXIDA                 21830000
218400*                MOVE DP015-RED        TO ATAXIDC                 21840000
218500*                MOVE DP015-REVERSE    TO ATAXIDH                 21850000
218600*                MOVE -1               TO ATAXIDL                 21860000
218700*                SET DP030-SET-CURSOR-APPL-1                      21870000
218800*                                      TO TRUE                    21880000
218900*            END-IF                                               21890000
219000*        ELSE                                                     21900000
219100*            SET PS-ERROR          TO TRUE                        21910000
219200*            SET DP020-MSG-FATAL   TO TRUE                        21920000
219300*            MOVE PC-TSYMSG-01862  TO DP020-MSG-NUMBER            21930000
219400*            MOVE DP015-UNP-ALP-BRT-OFF                           21940000
219500*                                  TO ATAXIDA                     21950000
219600*            MOVE DP015-RED        TO ATAXIDC                     21960000
219700*            MOVE DP015-REVERSE    TO ATAXIDH                     21970000
219800*            MOVE -1               TO ATAXIDL                     21980000
219900*            SET DP030-SET-CURSOR-APPL-1                          21990000
220000*                                  TO TRUE                        22000000
220100*        END-IF                                                   22010000
220200*    ELSE                                                         22020000
220300*        IF  ASC-PRIMARY-TYPE = 'E'    TO TRUE                    22030000
220400*            IF  ASC-1099-NEEDED = 'Y' TO TRUE                    22040000
220500*                SET PS-ERROR          TO TRUE                    22050000
220600*                SET DP020-MSG-FATAL   TO TRUE                    22060000
220700*                MOVE PC-TSYMSG-01863  TO DP020-MSG-NUMBER        22070000
220800*                MOVE DP015-UNP-ALP-BRT-OFFRUE                    22080000
220900*                                      TO ATAXIDA                 22090000
221000*                MOVE DP015-RED        TO ATAXIDC                 22100000
221100*                MOVE DP015-REVERSE    TO ATAXIDH                 22110000
221200*                MOVE -1               TO ATAXIDL                 22120000
221300*                SET DP030-SET-CURSOR-APPL-1UE                    22130000
221400*                                      TO TRUE                    22140000
221500*            END-IF                    TO TRUE                    22150000
221600*        END-IF                        TO TRUE                    22160000
221700*    END-IF.                           TO TRUE                    22170000
221800                                                                  22180000
221900*                                                                 22190000
222000*    IF  ASC-FED-TX-ID-TYP-CDE = 'S' OR 'F'                       22200000
222100*        IF  ASC-PRIMARY-TYPE = 'E'                               22210000
222200*            IF  ASC-1099-NEEDED = 'Y'                            22220000
222300*                CONTINUE                                         22230000
222400*            ELSE                                                 22240000
222500*                SET PS-ERROR          TO TRUE                    22250000
222600*                SET DP020-MSG-FATAL   TO TRUE                    22260000
222700*                MOVE PC-TSYMSG-01983  TO DP020-MSG-NUMBER        22270000
222800*                MOVE DP015-UNP-ALP-BRT-OFF                       22280000
222900*                                      TO ATAXIDTA                22290000
223000*                MOVE DP015-RED        TO ATAXIDTC                22300000
223100*                MOVE DP015-REVERSE    TO ATAXIDTH                22310000
223200*                MOVE -1               TO ATAXIDTL                22320000
223300*                SET DP030-SET-CURSOR-APPL-1                      22330000
223400*                                      TO TRUE                    22340000
223500*            END-IF                                               22350000
223600*        ELSE                                                     22360000
223700*            SET PS-ERROR          TO TRUE                        22370000
223800*            SET DP020-MSG-FATAL   TO TRUE                        22380000
223900*            MOVE PC-TSYMSG-01862  TO DP020-MSG-NUMBER            22390000
224000*            MOVE DP015-UNP-ALP-BRT-OFF                           22400000
224100*                                  TO ATAXIDTA                    22410000
224200*            MOVE DP015-RED        TO ATAXIDTC                    22420000
224300*            MOVE DP015-REVERSE    TO ATAXIDTH                    22430000
224400*            MOVE -1               TO ATAXIDTL                    22440000
224500*            SET DP030-SET-CURSOR-APPL-1                          22450000
224600*                                  TO TRUE                        22460000
224700*        END-IF                                                   22470000
224800*    ELSE                                                         22480000
224900*        IF  ASC-FED-TX-ID-TYP-CDE = SPACES                       22490000
225000*            IF  ASC-PRIMARY-TYPE = 'E'                           22500000
225100*                IF  ASC-1099-NEEDED = 'Y'                        22510000
225200*                    SET PS-ERROR          TO TRUE                22520000
225300*                    SET DP020-MSG-FATAL   TO TRUE                22530000
225400*                    MOVE PC-TSYMSG-01863  TO DP020-MSG-NUMBER    22540000
225500*                    MOVE DP015-UNP-ALP-BRT-OFF                   22550000
225600*                                          TO ATAXIDTA            22560000
225700*                    MOVE DP015-RED        TO ATAXIDTC            22570000
225800*                    MOVE DP015-REVERSE    TO ATAXIDTH            22580000
225900*                    MOVE -1               TO ATAXIDTL            22590000
226000*                    SET DP030-SET-CURSOR-APPL-1                  22600000
226100*                                          TO TRUE                22610000
226200*                END-IF                                           22620000
226300*            END-IF                                               22630000
226400*        ELSE                                                     22640000
226500*            SET PS-ERROR          TO TRUE                        22650000
226600*            SET DP020-MSG-FATAL   TO TRUE                        22660000
226700*            MOVE PC-TSYMSG-01864  TO DP020-MSG-NUMBER            22670000
226800*            MOVE DP015-UNP-ALP-BRT-OFF                           22680000
226900*                                  TO ATAXIDTA                    22690000
227000*            MOVE DP015-RED        TO ATAXIDTC                    22700000
227100*            MOVE DP015-REVERSE    TO ATAXIDTH                    22710000
227200*            MOVE -1               TO ATAXIDTL                    22720000
227300*            SET DP030-SET-CURSOR-APPL-1                          22730000
227400*                                  TO TRUE                        22740000
227500*        END-IF                                                   22750000
227600*    END-IF.                                                      22760000
227700                                                                  22770000
227800     IF  ASC-1099-NEEDED = 'Y' OR 'N' OR SPACE                    22780000
227900         IF ASC-1099-NEEDED = 'Y' AND                             22790000
228000            (ASC-PRIMARY-TYPE = 'M' OR 'F')                       22800000
228100             SET PS-ERROR              TO TRUE                    22810000
228200             SET DP020-MSG-FATAL       TO TRUE                    22820000
228300             MOVE PC-TSYMSG-01862      TO DP020-MSG-NUMBER        22830000
228400             MOVE DP015-UNP-ALP-BRT-OFF                           22840000
228500                                       TO A1099A                  22850000
228600             MOVE DP015-RED            TO A1099C                  22860000
228700             MOVE DP015-REVERSE        TO A1099H                  22870000
228800             MOVE -1                   TO A1099L                  22880000
228900             SET DP030-SET-CURSOR-APPL-1                          22890000
229000                                       TO TRUE                    22900000
229100         END-IF                                                   22910000
229200         IF ASC-1099-NEEDED = SPACE                               22920000
229300             MOVE 'N' TO ASC-1099-NEEDED                          22930000
229400         END-IF                                                   22940000
229500     ELSE                                                         22950000
229600         SET PS-ERROR              TO TRUE                        22960000
229700         SET DP020-MSG-FATAL       TO TRUE                        22970000
229800         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            22980000
229900         MOVE DP015-UNP-ALP-BRT-OFF                               22990000
230000                                   TO A1099A                      23000000
230100         MOVE DP015-RED            TO A1099C                      23010000
230200         MOVE DP015-REVERSE        TO A1099H                      23020000
230300         MOVE -1                   TO A1099L                      23030000
230400         SET DP030-SET-CURSOR-APPL-1                              23040000
230500                                   TO TRUE                        23050000
230600     END-IF.                                                      23060000
230700                                                                  23070000
230800     IF  ASC-VND-PRSST-CDE = SPACE                                23080000
230900         MOVE 'R' TO ASC-VND-PRSST-CDE                            23090000
231000     END-IF.                                                      23100000
231100                                                                  23110000
231200      IF  ASC-CAP-EXP-CDE = 'Y' OR 'B'                            23120000
231300          IF  ASC-VND-PRSST-CDE = 'R'                             23130000
231400              CONTINUE                                            23140000
231500          ELSE                                                    23150000
231600              SET PS-ERROR             TO TRUE                    23160000
231700              SET DP020-MSG-FATAL      TO TRUE                    23170000
231800              MOVE PC-TSYMSG-01871     TO DP020-MSG-NUMBER        23180000
231900              MOVE DP015-UNP-ALP-BRT-OFF                          23190000
232000                                    TO APERSISA                   23200000
232100              MOVE DP015-RED           TO APERSISC                23210000
232200              MOVE DP015-REVERSE       TO APERSISH                23220000
232300              MOVE -1                  TO APERSISL                23230000
232400              SET DP030-SET-CURSOR-APPL-1                         23240000
232500                                    TO TRUE                       23250000
232600          END-IF                                                  23260000
232700      ELSE                                                        23270000
232800          IF  ASC-VND-PRSST-CDE = 'R' OR 'O' OR 'P'               23280000
232900              CONTINUE                                            23290000
233000          ELSE                                                    23300000
233100              SET PS-ERROR             TO TRUE                    23310000
233200              SET DP020-MSG-FATAL      TO TRUE                    23320000
233300              MOVE PC-TSYMSG-01865     TO DP020-MSG-NUMBER        23330000
233400              MOVE DP015-UNP-ALP-BRT-OFF                          23340000
233500                                    TO APERSISA                   23350000
233600              MOVE DP015-RED           TO APERSISC                23360000
233700              MOVE DP015-REVERSE       TO APERSISH                23370000
233800              MOVE -1                  TO APERSISL                23380000
233900              SET DP030-SET-CURSOR-APPL-1                         23390000
234000                                    TO TRUE                       23400000
234100          END-IF                                                  23410000
234200      END-IF.                                                     23420000
234300                                                                  23430000
234400     IF  ASC-VND-CLSN-CDE = SPACE                                 23440000
234500         MOVE 'R'                      TO ASC-VND-CLSN-CDE        23450000
234600     END-IF.                                                      23460000
234700                                                                  23470000
234800      IF     ASC-VND-CLSN-CDE = 'E' OR 'R'                        23480000
234900          CONTINUE                                                23490000
235000      ELSE                                                        23500000
235100          SET PS-ERROR                 TO TRUE                    23510000
235200          SET DP020-MSG-FATAL          TO TRUE                    23520000
235300          MOVE PC-TSYMSG-01866         TO DP020-MSG-NUMBER        23530000
235400          MOVE DP015-UNP-ALP-BRT-OFF                              23540000
235500                                    TO ACLASFCA                   23550000
235600          MOVE DP015-RED               TO ACLASFCC                23560000
235700          MOVE DP015-REVERSE           TO ACLASFCH                23570000
235800          MOVE -1                      TO ACLASFCL                23580000
235900          SET DP030-SET-CURSOR-APPL-1                             23590000
236000                                    TO TRUE                       23600000
236100      END-IF.                                                     23610000
236200                                                                  23620000
236300                                                                  23630000
236400     IF  ASC-DPTE-NBR = SPACE                                     23640000
236500         IF  ASC-PRIMARY-TYPE = 'E' AND ASC-ADD-EDEPT AND         23650000
236600            (ASC-CAP-EXP-CDE = 'Y' OR 'B')                        23660000
236700             SET PS-ERROR          TO TRUE                        23670000
236800             SET DP020-MSG-FATAL   TO TRUE                        23680000
236900             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            23690000
237000             MOVE DP015-UNP-ALP-BRT-OFF                           23700000
237100                                   TO ADPTEXPA                    23710000
237200             MOVE DP015-RED        TO ADPTEXPC                    23720000
237300             MOVE DP015-REVERSE    TO ADPTEXPH                    23730000
237400             MOVE -1               TO ADPTEXPL                    23740000
237500             SET DP030-SET-CURSOR-APPL-1                          23750000
237600                                   TO TRUE                        23760000
237700         END-IF                                                   23770000
237800     ELSE                                                         23780000
237900         IF ASC-CAP-EXP-CDE = 'N'                                 23790000
238000             SET PS-ERROR          TO TRUE                        23800000
238100             SET DP020-MSG-FATAL   TO TRUE                        23810000
238200             MOVE PC-TSYMSG-01868  TO DP020-MSG-NUMBER            23820000
238300             MOVE DP015-UNP-ALP-BRT-OFF                           23830000
238400                                   TO ADPTEXPA                    23840000
238500             MOVE DP015-RED        TO ADPTEXPC                    23850000
238600             MOVE DP015-REVERSE    TO ADPTEXPH                    23860000
238700             MOVE -1               TO ADPTEXPL                    23870000
238800             SET DP030-SET-CURSOR-APPL-1                          23880000
238900                                   TO TRUE                        23890000
239000         END-IF                                                   23900000
239100         IF  ASC-PRIMARY-TYPE = 'F'                               23910000
239200             SET PS-ERROR          TO TRUE                        23920000
239300             SET DP020-MSG-FATAL   TO TRUE                        23930000
239400             MOVE PC-TSYMSG-01868  TO DP020-MSG-NUMBER            23940000
239500             MOVE DP015-UNP-ALP-BRT-OFF                           23950000
239600                                   TO ADPTEXPA                    23960000
239700             MOVE DP015-RED        TO ADPTEXPC                    23970000
239800             MOVE DP015-REVERSE    TO ADPTEXPH                    23980000
239900             MOVE -1               TO ADPTEXPL                    23990000
240000             SET DP030-SET-CURSOR-APPL-1                          24000000
240100                                   TO TRUE                        24010000
240200         ELSE                                                     24020000
240300             MOVE ASC-DPTE-NBR TO DP010I-UNEDITED-FIELD           24030000
240400             MOVE 3            TO DP010I-MAXIMUM-DIGITS           24040000
240500             MOVE 0            TO DP010I-MAXIMUM-DECIMALS         24050000
240600             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              24060000
240700             CALL DP010I-NUMERIC-EDIT-ROUTINE                     24070000
240800                         USING DP010I-NUMERIC-EDIT-AREA           24080000
240900             IF DP010I-ERROR-DETECTED                             24090000
241000                 SET PS-ERROR          TO TRUE                    24100000
241100                 SET DP020-MSG-FATAL   TO TRUE                    24110000
241200*                --- MUST BE NUMERIC    ---                       24120000
241300                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        24130000
241400                 MOVE DP015-UNP-ALP-BRT-OFF                       24140000
241500                                       TO ADPTEXPA                24150000
241600                 MOVE DP015-RED        TO ADPTEXPC                24160000
241700                 MOVE DP015-REVERSE    TO ADPTEXPH                24170000
241800                 MOVE -1               TO ADPTEXPL                24180000
241900                 SET DP030-SET-CURSOR-APPL-1                      24190000
242000                                       TO TRUE                    24200000
242100             ELSE                                                 24210000
242200                 MOVE DP010I-NUMERIC-FIELD TO ASC-DPTE-NBR-N      24220000
242300                 PERFORM 3322-SELECT-TORGUNT                      24230000
242400                 IF SQLCODE = +100                                24240000
242500                     SET DP020-MSG-FATAL                          24250000
242600                         PS-ERROR      TO TRUE                    24260000
242700*                    --- INVALID DEPARTMENT ---                   24270000
242800                     MOVE PC-TSYMSG-00032 TO DP020-MSG-NUMBER     24280000
242900                     MOVE DP015-UNP-ALP-BRT-OFF                   24290000
243000                                       TO ADPTEXPA                24300000
243100                     MOVE DP015-RED    TO ADPTEXPC                24310000
243200                     MOVE DP015-REVERSE                           24320000
243300                                       TO ADPTEXPH                24330000
243400                     MOVE -1           TO ADPTEXPL                24340000
243500                     SET DP030-SET-CURSOR-APPL-1                  24350000
243600                                       TO TRUE                    24360000
243700                 END-IF                                           24370000
243800             END-IF                                               24380000
243900         END-IF                                                   24390000
244000     END-IF.                                                      24400000
244100                                                                  24410000
244200     IF  ASC-CAP-EXP-CDE = 'Y' OR 'N' OR 'B' OR SPACES            24420000
244300         IF  ASC-CAP-EXP-CDE = 'Y' OR 'B'                         24430000
244400             IF  ASC-PRIMARY-TYPE = 'E' OR 'M'                    24440000
244500                 CONTINUE                                         24450000
244600             ELSE                                                 24460000
244700                 SET PS-ERROR          TO TRUE                    24470000
244800                 SET DP020-MSG-FATAL   TO TRUE                    24480000
244900                 MOVE PC-TSYMSG-02640  TO DP020-MSG-NUMBER        24490000
245000                 MOVE DP015-UNP-ALP-BRT-OFF                       24500000
245100                                       TO ACAPEXPA                24510000
245200                 MOVE DP015-RED        TO ACAPEXPC                24520000
245300                 MOVE DP015-REVERSE    TO ACAPEXPH                24530000
245400                 MOVE -1               TO ACAPEXPL                24540000
245500                 SET DP030-SET-CURSOR-APPL-1                      24550000
245600                                       TO TRUE                    24560000
245700             END-IF                                               24570000
245800         ELSE                                                     24580000
245900             IF  ASC-CAP-EXP-CDE = SPACES                         24590000
246000                 MOVE 'N' TO ASC-CAP-EXP-CDE                      24600000
246100             END-IF                                               24610000
246200         END-IF                                                   24620000
246300     ELSE                                                         24630000
246400         SET PS-ERROR              TO TRUE                        24640000
246500         SET DP020-MSG-FATAL       TO TRUE                        24650000
246600         MOVE PC-TSYMSG-01873      TO DP020-MSG-NUMBER            24660000
246700         MOVE DP015-UNP-ALP-BRT-OFF                               24670000
246800                                   TO ACAPEXPA                    24680000
246900         MOVE DP015-RED            TO ACAPEXPC                    24690000
247000         MOVE DP015-REVERSE        TO ACAPEXPH                    24700000
247100         MOVE -1                   TO ACAPEXPL                    24710000
247200         SET DP030-SET-CURSOR-APPL-1                              24720000
247300                                   TO TRUE                        24730000
247400     END-IF.                                                      24740000
247500                                                                  24750000
247600     IF  ASC-CARR-MAN-PRO-IND = 'Y' OR 'N' OR SPACE               24760000
247700         IF ASC-CARR-MAN-PRO-IND = SPACE                          24770000
247800             MOVE 'N' TO ASC-CARR-MAN-PRO-IND                     24780000
247900         ELSE                                                     24790000
248000             CONTINUE                                             24800000
248100         END-IF                                                   24810000
248200     ELSE                                                         24820000
248300         SET PS-ERROR              TO TRUE                        24830000
248400         SET DP020-MSG-FATAL       TO TRUE                        24840000
248500         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            24850000
248600         MOVE DP015-UNP-ALP-BRT-OFF                               24860000
248700                                   TO AMANPROA                    24870000
248800         MOVE DP015-RED            TO AMANPROC                    24880000
248900         MOVE DP015-REVERSE        TO AMANPROH                    24890000
249000         MOVE -1                   TO AMANPROL                    24900000
249100         SET DP030-SET-CURSOR-APPL-1                              24910000
249200                                   TO TRUE                        24920000
249300     END-IF.                                                      24930000
249400                                                                  24940000
249500     IF  ASC-PARTNER-IND = 'Y' OR 'N' OR SPACE                    24950000
249600         IF ASC-PARTNER-IND = SPACE                               24960000
249700             MOVE 'N' TO ASC-PARTNER-IND                          24970000
249800         ELSE                                                     24980000
249900             CONTINUE                                             24990000
250000         END-IF                                                   25000000
250100     ELSE                                                         25010000
250200         SET PS-ERROR              TO TRUE                        25020000
250300         SET DP020-MSG-FATAL       TO TRUE                        25030000
250400         MOVE PC-TSYMSG-00689      TO DP020-MSG-NUMBER            25040000
250500         MOVE DP015-UNP-ALP-BRT-OFF                               25050000
250600                                   TO APTNRTYA                    25060000
250700         MOVE DP015-RED            TO APTNRTYC                    25070000
250800         MOVE DP015-REVERSE        TO APTNRTYH                    25080000
250900         MOVE -1                   TO APTNRTYL                    25090000
251000         SET DP030-SET-CURSOR-APPL-1                              25100000
251100                                   TO TRUE                        25110000
251200     END-IF.                                                      25120000
251300                                                                  25130000
251400     MOVE ASC-PARTNER-TYPE TO PV-VALID-CARRIER                    25140000
251500                              PV-VALID-PRNTR-TYP.                 25150000
251600                                                                  25160000
251700     IF ASC-PARTNER-IND = 'N'                                     25170000
251800        IF ASC-PARTNER-TYPE = 'NA' OR SPACES                      25180000
251900           CONTINUE                                               25190000
252000        ELSE                                                      25200000
252100           SET PS-ERROR             TO TRUE                       25210000
252200           SET DP020-MSG-FATAL      TO TRUE                       25220000
252300           MOVE PC-TSYMSG-02632     TO DP020-MSG-NUMBER           25230000
252400* TO HAVE A PARTNER TYPE, PARTNER MUST BE 'Y'                     25240000
252500           MOVE DP015-UNP-ALP-BRT-OFF                             25250000
252600                                   TO APTNRTYA                    25260000
252700           MOVE DP015-RED           TO APTNRTYC                   25270000
252800           MOVE DP015-REVERSE       TO APTNRTYH                   25280000
252900           MOVE -1                  TO APTNRTYL                   25290000
253000           SET DP030-SET-CURSOR-APPL-1                            25300000
253100                                   TO TRUE                        25310000
253200       END-IF                                                     25320000
253300     END-IF.                                                      25330000
253400                                                                  25340000
253500     IF ASC-PARTNER-IND = 'Y'                                     25350000
253600        IF ASC-PRIMARY-TYPE = 'E'                                 25360000
253700           IF VALID-CARRIER                                       25370000
253800              IF ASC-CAR-AUTH                                     25380000
253900                 CONTINUE                                         25390000
254000              ELSE                                                25400000
254100                 SET PS-ERROR              TO TRUE                25410000
254200                 SET DP020-MSG-FATAL       TO TRUE                25420000
254300*  AUTHORIZATION/PARTNER TYPE NOT VALID FOR CARRIER               25430000
254400                 MOVE PC-TSYMSG-02625 TO DP020-MSG-NUMBER         25440000
254500                 MOVE DP015-UNP-ALP-BRT-OFF                       25450000
254600                                      TO APRMTYPA                 25460000
254700                                         APTNRTYA                 25470000
254800                 MOVE DP015-RED         TO APRMTYPC               25480000
254900                                     APTNRTYC                     25490000
255000                 MOVE DP015-REVERSE     TO APRMTYPH               25500000
255100                                     APTNRTYH                     25510000
255200                 MOVE -1                TO APRMTYPL               25520000
255300                                     APTNRTYL                     25530000
255400                 SET DP030-SET-CURSOR-APPL-1                      25540000
255500                                  TO TRUE                         25550000
255600              END-IF                                              25560000
255700           ELSE                                                   25570000
255800              IF VALID-PRNTR-TYP                                  25580000
255900                 CONTINUE                                         25590000
256000              ELSE                                                25600000
256100                 SET PS-ERROR     TO TRUE                         25610000
256200                 SET DP020-MSG-FATAL TO TRUE                      25620000
256300                 MOVE PC-TSYMSG-02630 TO DP020-MSG-NUMBER         25630000
256400* VALID PARTNER TYPES ARE AG,BK,BR,CO,CR,DE,FA,FF,S1,S2,TM        25640000
256500                 MOVE DP015-UNP-ALP-BRT-OFF                       25650000
256600                                           TO APTNRTYA            25660000
256700                 MOVE DP015-RED   TO APTNRTYC                     25670000
256800                 MOVE DP015-REVERSE TO APTNRTYH                   25680000
256900                 MOVE -1          TO APTNRTYL                     25690000
257000                 SET DP030-SET-CURSOR-APPL-1                      25700000
257100                                           TO TRUE                25710000
257200              END-IF                                              25720000
257300           END-IF                                                 25730000
257400        ELSE                                                      25740000
257500           SET PS-ERROR        TO TRUE                            25750000
257600           SET DP020-MSG-FATAL TO TRUE                            25760000
257700           MOVE PC-TSYMSG-02631 TO DP020-MSG-NUMBER               25770000
257800* PRIMARY TYPE MUST BE 'E', EXPENSE VENDOR                        25780000
257900           MOVE DP015-UNP-ALP-BRT-OFF                             25790000
258000                               TO APTNRTYA                        25800000
258100           MOVE DP015-RED      TO APTNRTYC                        25810000
258200           MOVE DP015-REVERSE  TO APTNRTYH                        25820000
258300           MOVE -1             TO APTNRTYL                        25830000
258400           SET DP030-SET-CURSOR-APPL-1                            25840000
258500                                     TO TRUE                      25850000
258600        END-IF                                                    25860000
258700     END-IF.                                                      25870000
258800                                                                  25880000
258900     IF  ASC-CARR-MAN-PRO-IND = 'Y'                               25890000
259000         IF VALID-CARRIER                                         25900000
259100            CONTINUE                                              25910000
259200         ELSE                                                     25920000
259300             SET PS-ERROR          TO TRUE                        25930000
259400             SET DP020-MSG-FATAL   TO TRUE                        25940000
259500             MOVE PC-TSYMSG-00711  TO DP020-MSG-NUMBER            25950000
259600             MOVE DP015-UNP-ALP-BRT-OFF                           25960000
259700                                   TO AMANPROA                    25970000
259800             MOVE DP015-RED        TO AMANPROC                    25980000
259900             MOVE DP015-REVERSE    TO AMANPROH                    25990000
260000             MOVE -1               TO AMANPROL                    26000000
260100             SET DP030-SET-CURSOR-APPL-1                          26010000
260200                                   TO TRUE                        26020000
260300         END-IF                                                   26030000
260400     END-IF.                                                      26040000
260500                                                                  26050000
260600     IF  ASC-SCAC-CDE = SPACE                                     26060000
260700         IF VALID-CARRIER                                         26070000
260800             SET PS-ERROR          TO TRUE                        26080000
260900             SET DP020-MSG-FATAL   TO TRUE                        26090000
261000*            -- SCAC REQUIRED IF CAR IS ENTERED --                26100000
261100             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            26110000
261200             MOVE DP015-UNP-ALP-BRT-OFF                           26120000
261300                                   TO ASCACA                      26130000
261400             MOVE DP015-RED        TO ASCACC                      26140000
261500             MOVE DP015-REVERSE    TO ASCACH                      26150000
261600             MOVE -1               TO ASCACL                      26160000
261700             SET DP030-SET-CURSOR-APPL-1                          26170000
261800                                   TO TRUE                        26180000
261900         ELSE                                                     26190000
262000             CONTINUE                                             26200000
262100     ELSE                                                         26210000
262200         IF NOT VALID-CARRIER                                     26220000
262300             SET PS-ERROR          TO TRUE                        26230000
262400             SET DP020-MSG-FATAL   TO TRUE                        26240000
262500             MOVE PC-TSYMSG-00711  TO DP020-MSG-NUMBER            26250000
262600             MOVE DP015-UNP-ALP-BRT-OFF                           26260000
262700                                   TO ASCACA                      26270000
262800             MOVE DP015-RED        TO ASCACC                      26280000
262900             MOVE DP015-REVERSE    TO ASCACH                      26290000
263000             MOVE -1               TO ASCACL                      26300000
263100             SET DP030-SET-CURSOR-APPL-1                          26310000
263200                                   TO TRUE                        26320000
263300         ELSE                                                     26330000
263400             PERFORM 3350-SELECT-TEXTENT-SCAC-CDE                 26340000
263500             IF SQLCODE = ZERO                                    26350000
263600                 IF EXTENT-ENT-ID = ASC-ENT-ID                    26360000
263700                     CONTINUE                                     26370000
263800                 ELSE                                             26380000
263900                     SET PS-ERROR          TO TRUE                26390000
264000                     SET DP020-MSG-FATAL   TO TRUE                26400000
264100*                    --- SCAC ALREADY EXISTS ---                  26410000
264200                     MOVE PC-TSYMSG-00713  TO DP020-MSG-NUMBER    26420000
264300                     MOVE DP015-UNP-ALP-BRT-OFF                   26430000
264400                                   TO ASCACA                      26440000
264500                     MOVE DP015-RED        TO ASCACC              26450000
264600                     MOVE DP015-REVERSE    TO ASCACH              26460000
264700                     MOVE -1               TO ASCACL              26470000
264800                     SET DP030-SET-CURSOR-APPL-1                  26480000
264900                                   TO TRUE                        26490000
265000                 END-IF                                           26500000
265100             END-IF                                               26510000
265200             MOVE ASC-SCAC-CDE             TO PV-SCAC-BREAK       26520000
265300             IF PV-SCAC-B1 = SPACE OR                             26530000
265400                PV-SCAC-B2 = SPACE OR                             26540000
265500                PV-SCAC-B3 = SPACE OR                             26550000
265600                PV-SCAC-B4 = SPACE                                26560000
265700                     SET PS-ERROR          TO TRUE                26570000
265800                     SET DP020-MSG-FATAL   TO TRUE                26580000
265900*                    --- SCAC CONTAINS SPACES---                  26590000
266000                     MOVE PC-TSYMSG-00712  TO DP020-MSG-NUMBER    26600000
266100                     MOVE DP015-UNP-ALP-BRT-OFF                   26610000
266200                                   TO ASCACA                      26620000
266300                     MOVE DP015-RED        TO ASCACC              26630000
266400                     MOVE DP015-REVERSE    TO ASCACH              26640000
266500                     MOVE -1               TO ASCACL              26650000
266600                     SET DP030-SET-CURSOR-APPL-1                  26660000
266700                                   TO TRUE                        26670000
266800             ELSE                                                 26680000
266900                 CONTINUE                                         26690000
267000             END-IF                                               26700000
267100         END-IF                                                   26710000
267200     END-IF.                                                      26720000
267300                                                                  26730000
267400     IF ASC-PRIMARY-TYPE = 'E'                                    26740000
267500        PERFORM 3050-EDIT-LINE-OF-CREDIT                          26750000
267600     ELSE                                                         26760000
267700*       INSPECT ASC-LINE-OF-CREDIT TALLYING PV-DOT-COUNT          26770000
267800*           FOR ALL '.'                                           26780000
267900        MOVE ASC-LINE-OF-CREDIT   TO PV-LNE-OF-CR-AMT             26790000
268000        MOVE PV-LNE-OF-CR-AMT-DLLR TO PV-LINE-OF-CREDIT-DLLR      26800000
268100        COMPUTE PV-LINE-OF-CREDIT-CENT = PV-LNE-OF-CR-AMT-CENT    26810000
268200                                      / 100                       26820000
268300        IF PV-LINE-OF-CREDIT > 0                                  26830000
268400*       IF PV-LINE-OF-CREDIT > 0 OR                               26840000
268500*          PV-DOT-COUNT > 0                                       26850000
268600           SET PS-ERROR              TO TRUE                      26860000
268700           SET DP020-MSG-FATAL       TO TRUE                      26870000
268800           MOVE PC-TSYMSG-02672      TO DP020-MSG-NUMBER          26880000
268900           MOVE DP015-UNP-ALP-BRT-OFF                             26890000
269000                                     TO ALNCRDTA                  26900000
269100           MOVE DP015-RED            TO ALNCRDTC                  26910000
269200           MOVE DP015-REVERSE        TO ALNCRDTH                  26920000
269300           MOVE -1                   TO ALNCRDTL                  26930000
269400           SET DP030-SET-CURSOR-APPL-1                            26940000
269500                                     TO TRUE                      26950000
269600        END-IF                                                    26960000
269700     END-IF.                                                      26970000
269800                                                                  26980000
269900     IF ASC-PARTNER-IND = 'Y'                                     26990000
270000         IF ASC-PARTNER-TYPE = 'FA'                               27000000
270100             INSPECT ASC-FACT-CAPACITY-X                          27010000
270200                         TALLYING PV-DEC-COUNT FOR ALL '.'        27020000
270300             IF PV-DEC-COUNT = 0                                  27030000
270400                 EXEC CICS BIF DEEDIT                             27040000
270500                               FIELD (ASC-FACT-CAPACITY)          27050000
270600                               LENGTH(11)                         27060000
270700                 END-EXEC                                         27070000
270800             ELSE                                                 27080000
270900*CAPACITY FIELD CAN ONLY BE A WHOLE NUMBER -- NO DECIMALS ALLOWED 27090000
271000                 SET PS-ERROR                TO TRUE              27100000
271100                 SET DP020-MSG-FATAL         TO TRUE              27110000
271200                 MOVE PC-TSYMSG-03376        TO DP020-MSG-NUMBER  27120000
271300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACPACTYA          27130000
271400                 MOVE DP015-RED              TO ACPACTYC          27140000
271500                 MOVE DP015-REVERSE          TO ACPACTYH          27150000
271600                 MOVE -1                     TO ACPACTYL          27160000
271700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              27170000
271800             END-IF                                               27180000
271900         ELSE                                                     27190000
272000             EXEC CICS BIF DEEDIT                                 27200000
272100                           FIELD (ASC-FACT-CAPACITY)              27210000
272200                           LENGTH(11)                             27220000
272300             END-EXEC                                             27230000
272400             IF ASC-FACT-CAPACITY > 0                             27240000
272500*     -- CAPACITY FIELD IS VALID ONLY FOR PARTNER TYPE OF 'FA'    27250000
272600                 SET PS-ERROR                TO TRUE              27260000
272700                 SET DP020-MSG-FATAL         TO TRUE              27270000
272800                 MOVE PC-TSYMSG-03372        TO DP020-MSG-NUMBER  27280000
272900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACPACTYA          27290000
273000                 MOVE DP015-RED              TO ACPACTYC          27300000
273100                 MOVE DP015-REVERSE          TO ACPACTYH          27310000
273200                 MOVE -1                     TO ACPACTYL          27320000
273300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              27330000
273400             END-IF                                               27340000
273500         END-IF                                                   27350000
273600     ELSE                                                         27360000
273700         EXEC CICS BIF DEEDIT                                     27370000
273800                       FIELD (ASC-FACT-CAPACITY)                  27380000
273900                       LENGTH(11)                                 27390000
274000         END-EXEC                                                 27400000
274100         IF ASC-FACT-CAPACITY > 0                                 27410000
274200           AND ASC-PARTNER-TYPE NOT EQUAL 'FA'                    27420000
274300*     -- CAPACITY FIELD IS VALID ONLY FOR PARTNER TYPE OF 'FA'    27430000
274400             SET PS-ERROR                TO TRUE                  27440000
274500             SET DP020-MSG-FATAL         TO TRUE                  27450000
274600             MOVE PC-TSYMSG-03372        TO DP020-MSG-NUMBER      27460000
274700             MOVE DP015-UNP-ALP-BRT-OFF  TO ACPACTYA              27470000
274800             MOVE DP015-RED              TO ACPACTYC              27480000
274900             MOVE DP015-REVERSE          TO ACPACTYH              27490000
275000             MOVE -1                     TO ACPACTYL              27500000
275100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  27510000
275200         END-IF                                                   27520000
275300     END-IF.                                                      27530000
275400                                                                  27540000
275500     IF  ASC-INHOUSE-NBR = SPACE                                  27550000
275600         IF  ASC-PRIMARY-TYPE = 'M' AND ASC-ADD-MDEPT             27560000
275700             SET PS-ERROR          TO TRUE                        27570000
275800             SET DP020-MSG-FATAL   TO TRUE                        27580000
275900             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            27590000
276000             MOVE DP015-UNP-NUM-BRT-OFF                           27600000
276100                                   TO AINHSA                      27610000
276200             MOVE DP015-RED        TO AINHSC                      27620000
276300             MOVE DP015-REVERSE    TO AINHSH                      27630000
276400             MOVE -1               TO AINHSL                      27640000
276500             SET DP030-SET-CURSOR-APPL-1                          27650000
276600                                   TO TRUE                        27660000
276700         END-IF                                                   27670000
276800     ELSE                                                         27680000
276900         IF  ASC-PRIMARY-TYPE = 'E' OR 'F'                        27690000
277000             SET PS-ERROR          TO TRUE                        27700000
277100             SET DP020-MSG-FATAL   TO TRUE                        27710000
277200             MOVE PC-TSYMSG-00495  TO DP020-MSG-NUMBER            27720000
277300             MOVE DP015-UNP-NUM-BRT-OFF                           27730000
277400                                   TO AINHSA                      27740000
277500             MOVE DP015-RED        TO AINHSC                      27750000
277600             MOVE DP015-REVERSE    TO AINHSH                      27760000
277700             MOVE -1               TO AINHSL                      27770000
277800             SET DP030-SET-CURSOR-APPL-1                          27780000
277900                                   TO TRUE                        27790000
278000         ELSE                                                     27800000
278100             MOVE ASC-INHOUSE-NBR TO DP010I-UNEDITED-FIELD        27810000
278200             MOVE 3           TO DP010I-MAXIMUM-DIGITS            27820000
278300             MOVE 0           TO DP010I-MAXIMUM-DECIMALS          27830000
278400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              27840000
278500             CALL DP010I-NUMERIC-EDIT-ROUTINE                     27850000
278600                         USING DP010I-NUMERIC-EDIT-AREA           27860000
278700             IF DP010I-ERROR-DETECTED                             27870000
278800                 SET PS-ERROR          TO TRUE                    27880000
278900                 SET DP020-MSG-FATAL   TO TRUE                    27890000
279000*                --- MUST BE NUMERIC    ---                       27900000
279100                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        27910000
279200                 MOVE DP015-UNP-NUM-BRT-OFF                       27920000
279300                                       TO AINHSA                  27930000
279400                 MOVE DP015-RED        TO AINHSC                  27940000
279500                 MOVE DP015-REVERSE    TO AINHSH                  27950000
279600                 MOVE -1               TO AINHSL                  27960000
279700                 SET DP030-SET-CURSOR-APPL-1                      27970000
279800                                       TO TRUE                    27980000
279900             ELSE                                                 27990000
280000                 MOVE DP010I-NUMERIC-FIELD TO ASC-INHOUSE-NBR-N   28000000
280100             END-IF                                               28010000
280200         END-IF                                                   28020000
280300     END-IF.                                                      28030000
280400                                                                  28040000
280500     IF  ASC-DEPT-NBR = SPACE                                     28050000
280600         IF  ASC-PRIMARY-TYPE = 'M' AND ASC-ADD-MDEPT             28060000
280700             SET PS-ERROR          TO TRUE                        28070000
280800             SET DP020-MSG-FATAL   TO TRUE                        28080000
280900             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            28090000
281000             MOVE DP015-UNP-ALP-BRT-OFF                           28100000
281100                                   TO ADPTNBRA                    28110000
281200             MOVE DP015-RED        TO ADPTNBRC                    28120000
281300             MOVE DP015-REVERSE    TO ADPTNBRH                    28130000
281400             MOVE -1               TO ADPTNBRL                    28140000
281500             SET DP030-SET-CURSOR-APPL-1                          28150000
281600                                   TO TRUE                        28160000
281700         END-IF                                                   28170000
281800     ELSE                                                         28180000
281900         IF  ASC-PRIMARY-TYPE = 'E' OR 'F'                        28190000
282000             SET PS-ERROR          TO TRUE                        28200000
282100             SET DP020-MSG-FATAL   TO TRUE                        28210000
282200             MOVE PC-TSYMSG-00495  TO DP020-MSG-NUMBER            28220000
282300             MOVE DP015-UNP-ALP-BRT-OFF                           28230000
282400                                   TO ADPTNBRA                    28240000
282500             MOVE DP015-RED        TO ADPTNBRC                    28250000
282600             MOVE DP015-REVERSE    TO ADPTNBRH                    28260000
282700             MOVE -1               TO ADPTNBRL                    28270000
282800             SET DP030-SET-CURSOR-APPL-1                          28280000
282900                                   TO TRUE                        28290000
283000         ELSE                                                     28300000
283100             MOVE ASC-DEPT-NBR TO DP010I-UNEDITED-FIELD           28310000
283200             MOVE 3           TO DP010I-MAXIMUM-DIGITS            28320000
283300             MOVE 0           TO DP010I-MAXIMUM-DECIMALS          28330000
283400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              28340000
283500             CALL DP010I-NUMERIC-EDIT-ROUTINE                     28350000
283600                         USING DP010I-NUMERIC-EDIT-AREA           28360000
283700             IF DP010I-ERROR-DETECTED                             28370000
283800                 SET PS-ERROR          TO TRUE                    28380000
283900                 SET DP020-MSG-FATAL   TO TRUE                    28390000
284000*                --- MUST BE NUMERIC    ---                       28400000
284100                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        28410000
284200                 MOVE DP015-UNP-ALP-BRT-OFF                       28420000
284300                                       TO ADPTNBRA                28430000
284400                 MOVE DP015-RED        TO ADPTNBRC                28440000
284500                 MOVE DP015-REVERSE    TO ADPTNBRH                28450000
284600                 MOVE -1               TO ADPTNBRL                28460000
284700                 SET DP030-SET-CURSOR-APPL-1                      28470000
284800                                       TO TRUE                    28480000
284900             ELSE                                                 28490000
285000                 MOVE DP010I-NUMERIC-FIELD TO ASC-DEPT-NBR-N      28500000
285100                 PERFORM 3320-SELECT-TMDSEAR                      28510000
285200                 IF SQLCODE = +100                                28520000
285300                     SET DP020-MSG-FATAL                          28530000
285400                         PS-ERROR      TO TRUE                    28540000
285500*                    --- INVALID DEPARTMENT ---                   28550000
285600                     MOVE PC-TSYMSG-00032 TO DP020-MSG-NUMBER     28560000
285700                     MOVE DP015-UNP-ALP-BRT-OFF                   28570000
285800                                       TO ADPTNBRA                28580000
285900                     MOVE DP015-RED    TO ADPTNBRC                28590000
286000                     MOVE DP015-REVERSE                           28600000
286100                                       TO ADPTNBRH                28610000
286200                     MOVE -1           TO ADPTNBRL                28620000
286300                     SET DP030-SET-CURSOR-APPL-1                  28630000
286400                                       TO TRUE                    28640000
286500                 ELSE                                             28650000
286600                     MOVE ASC-INHOUSE-NBR-N                       28660000
286700                                       TO VNDDPT-INHOUSE-NBR      28670000
286800                     PERFORM 3330-SELECT-TVNDDPT                  28680000
286900                     IF SQLCODE = +0                              28690000
287000                         IF VNDDPT-ENT-ID = ASC-ENT-ID            28700000
287100                             CONTINUE                             28710000
287200                         ELSE                                     28720000
287300                             SET PS-ERROR          TO TRUE        28730000
287400                             SET DP020-MSG-FATAL   TO TRUE        28740000
287500*                            --- INHOUSE ALREADY EXISTS ---       28750000
287600                             MOVE PC-TSYMSG-00475                 28760000
287700                                       TO DP020-MSG-NUMBER        28770000
287800                             MOVE DP015-UNP-NUM-BRT-OFF           28780000
287900                                       TO AINHSA                  28790000
288000                             MOVE DP015-RED    TO AINHSC          28800000
288100                             MOVE DP015-REVERSE                   28810000
288200                                       TO AINHSH                  28820000
288300                             MOVE -1           TO AINHSL          28830000
288400                             SET DP030-SET-CURSOR-APPL-1          28840000
288500                                       TO TRUE                    28850000
288600                         END-IF                                   28860000
288700                     END-IF                                       28870000
288800                 END-IF                                           28880000
288900             END-IF                                               28890000
289000         END-IF                                                   28900000
289100     END-IF.                                                      28910000
289200                                                                  28920000
289300*    IF  ASC-MDSE-IND = 'N' AND ASC-CARRIER-IND = 'N' AND         28930000
289400*        ASC-EXPENSE-IND = 'N' AND ASC-FCTR-IND = 'N' AND         28940000
289500*        ASC-PRNT-CO-IND = 'N'                                    28950000
289600*                                                                 28960000
289700*        SET PS-ERROR              TO TRUE                        28970000
289800*        SET DP020-MSG-FATAL       TO TRUE                        28980000
289900*        MOVE PC-TSYMSG-00689      TO DP020-MSG-NUMBER            28990000
290000*        IF ASC-MERCH-AUTH                                        29000000
290100*            MOVE DP015-UNP-ALP-BRT-OFF                           29010000
290200*                                  TO AMDSINDA                    29020000
290300*            MOVE DP015-RED        TO AMDSINDC                    29030000
290400*            MOVE DP015-REVERSE    TO AMDSINDH                    29040000
290500*            MOVE -1               TO AMDSINDL                    29050000
290600*            SET DP030-SET-CURSOR-APPL-1                          29060000
290700*                                  TO TRUE                        29070000
290800*        END-IF                                                   29080000
290900*        IF ASC-EXPENSE-AUTH                                      29090000
291000*            MOVE DP015-UNP-ALP-BRT-OFF                           29100000
291100*                                  TO AEXPINDA                    29110000
291200*            MOVE DP015-RED        TO AEXPINDC                    29120000
291300*            MOVE DP015-REVERSE    TO AEXPINDH                    29130000
291400*            MOVE -1               TO AEXPINDL                    29140000
291500*            SET DP030-SET-CURSOR-APPL-1                          29150000
291600*                                  TO TRUE                        29160000
291700*        END-IF                                                   29170000
291800*        IF ASC-CAR-AUTH                                          29180000
291900*            MOVE DP015-UNP-ALP-BRT-OFF                           29190000
292000*                                  TO ACARINDA                    29200000
292100*            MOVE DP015-RED        TO ACARINDC                    29210000
292200*            MOVE DP015-REVERSE    TO ACARINDH                    29220000
292300*            MOVE -1               TO ACARINDL                    29230000
292400*            SET DP030-SET-CURSOR-APPL-1                          29240000
292500*                                  TO TRUE                        29250000
292600*        END-IF                                                   29260000
292700*        IF ASC-FACTOR-AUTH                                       29270000
292800*            MOVE DP015-UNP-ALP-BRT-OFF                           29280000
292900*                                  TO AFACINDA                    29290000
293000*            MOVE DP015-RED        TO AFACINDC                    29300000
293100*            MOVE DP015-REVERSE    TO AFACINDH                    29310000
293200*            MOVE -1               TO AFACINDL                    29320000
293300*            SET DP030-SET-CURSOR-APPL-1                          29330000
293400*                                  TO TRUE                        29340000
293500*        END-IF                                                   29350000
293600*        IF ASC-PARENT-AUTH                                       29360000
293700*            MOVE DP015-UNP-ALP-BRT-OFF                           29370000
293800*                                  TO APARINDA                    29380000
293900*            MOVE DP015-RED        TO APARINDC                    29390000
294000*            MOVE DP015-REVERSE    TO APARINDH                    29400000
294100*            MOVE -1               TO APARINDL                    29410000
294200*            SET DP030-SET-CURSOR-APPL-1                          29420000
294300*                                  TO TRUE                        29430000
294400*        END-IF                                                   29440000
294500*    END-IF.                                                      29450000
294600                                                                  29460000
294700     IF  ASC-SEPERATE-PYMTS = 'N' OR 'Y' OR SPACE                 29470000
294800         IF ASC-SEPERATE-PYMTS = SPACE                            29480000
294900             MOVE 'N' TO ASC-SEPERATE-PYMTS                       29490000
295000         ELSE                                                     29500000
295100             CONTINUE                                             29510000
295200         END-IF                                                   29520000
295300     ELSE                                                         29530000
295400         SET PS-ERROR              TO TRUE                        29540000
295500         SET DP020-MSG-FATAL       TO TRUE                        29550000
295600         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            29560000
295700         MOVE DP015-UNP-ALP-BRT-OFF                               29570000
295800                                   TO ASEPPAYA                    29580000
295900         MOVE DP015-RED            TO ASEPPAYC                    29590000
296000         MOVE DP015-REVERSE        TO ASEPPAYH                    29600000
296100         MOVE -1                   TO ASEPPAYL                    29610000
296200         SET DP030-SET-CURSOR-APPL-1                              29620000
296300                                   TO TRUE                        29630000
296400     END-IF.                                                      29640000
296500                                                                  29650000
296600     IF  ASC-VND-USING-FACTOR = 'N' OR 'Y' OR SPACE               29660000
296700         IF ASC-VND-USING-FACTOR = SPACE                          29670000
296800             MOVE 'N' TO ASC-VND-USING-FACTOR                     29680000
296900         ELSE                                                     29690000
297000             CONTINUE                                             29700000
297100         END-IF                                                   29710000
297200     ELSE                                                         29720000
297300         SET PS-ERROR              TO TRUE                        29730000
297400         SET DP020-MSG-FATAL       TO TRUE                        29740000
297500         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            29750000
297600         MOVE DP015-UNP-ALP-BRT-OFF                               29760000
297700                                   TO AUSEFACA                    29770000
297800         MOVE DP015-RED            TO AUSEFACC                    29780000
297900         MOVE DP015-REVERSE        TO AUSEFACH                    29790000
298000         MOVE -1                   TO AUSEFACL                    29800000
298100         SET DP030-SET-CURSOR-APPL-1                              29810000
298200                                   TO TRUE                        29820000
298300     END-IF.                                                      29830000
298400                                                                  29840000
298500     IF  ASC-HLD-PAYT-IND = 'N' OR 'Y' OR SPACE                   29850000
298600         IF ASC-HLD-PAYT-IND = SPACE                              29860000
298700             MOVE 'N' TO ASC-HLD-PAYT-IND                         29870000
298800         ELSE                                                     29880000
298900             CONTINUE                                             29890000
299000         END-IF                                                   29900000
299100     ELSE                                                         29910000
299200         SET PS-ERROR              TO TRUE                        29920000
299300         SET DP020-MSG-FATAL       TO TRUE                        29930000
299400         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            29940000
299500         MOVE DP015-UNP-ALP-BRT-OFF                               29950000
299600                                   TO AVNHOLDA                    29960000
299700         MOVE DP015-RED            TO AVNHOLDC                    29970000
299800         MOVE DP015-REVERSE        TO AVNHOLDH                    29980000
299900         MOVE -1                   TO AVNHOLDL                    29990000
300000         SET DP030-SET-CURSOR-APPL-1                              30000000
300100                                   TO TRUE                        30010000
300200     END-IF.                                                      30020000
300300                                                                  30030000
300400                                                                  30040000
300500     IF  PS-PARENT-ERROR-YES                                      30050000
300600         SET PS-ERROR          TO TRUE                            30060000
300700         SET DP020-MSG-FATAL   TO TRUE                            30070000
300800**       --- ONLY ONE OF FIELD SHOULD BE ENTERED -----            30080000
300900         MOVE PC-TSYMSG-01693  TO DP020-MSG-NUMBER                30090000
301000         MOVE DP015-UNP-ALP-BRT-OFF                               30100000
301100                               TO APRNTCOA                        30110000
301200                                  APRNTNBA                        30120000
301300         MOVE DP015-RED        TO APRNTNBC                        30130000
301400                                  APRNTCOC                        30140000
301500         MOVE DP015-REVERSE    TO APRNTNBH                        30150000
301600                                  APRNTCOH                        30160000
301700         MOVE -1               TO APRNTCOL                        30170000
301800         SET DP030-SET-CURSOR-APPL-1                              30180000
301900                               TO TRUE                            30190000
302000     END-IF.                                                      30200000
302100                                                                  30210000
302200     IF PS-NO-ERROR                                               30220000
302300        EVALUATE TRUE                                             30230000
302400            WHEN PS-REMOVE-PARENT-YES                             30240000
302500                 MOVE SPACES         TO ASC-PARENT-NAME           30250000
302600                                        APRNTCOO                  30260000
302700                 INITIALIZE             ASC-PRNT-CO-ENT-ID        30270000
302800                                        ASC-PARENT-VENDOR-NBR     30280000
302900                                                                  30290000
303000            WHEN ASC-PARENT-VENDOR-NBR-N > 0                      30300000
303100                 MOVE ASC-PARENT-VENDOR-NBR TO                    30310000
303200                                      DP010I-UNEDITED-FIELD       30320000
303300                 MOVE 9            TO DP010I-MAXIMUM-DIGITS       30330000
303400                 MOVE 0            TO DP010I-MAXIMUM-DECIMALS     30340000
303500                 SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE          30350000
303600                 CALL DP010I-NUMERIC-EDIT-ROUTINE                 30360000
303700                         USING DP010I-NUMERIC-EDIT-AREA           30370000
303800                 IF DP010I-ERROR-DETECTED                         30380000
303900                     SET PS-ERROR          TO TRUE                30390000
304000                     SET DP020-MSG-FATAL   TO TRUE                30400000
304100**              --- MUST BE NUMERIC    ---                        30410000
304200                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    30420000
304300                     MOVE DP015-UNP-ALP-BRT-OFF                   30430000
304400                                           TO APRNTNBA            30440000
304500                     MOVE DP015-RED        TO APRNTNBC            30450000
304600                     MOVE DP015-REVERSE    TO APRNTNBH            30460000
304700                     MOVE -1               TO APRNTNBL            30470000
304800                     SET DP030-SET-CURSOR-APPL-1                  30480000
304900                                           TO TRUE                30490000
305000                 ELSE                                             30500000
305100                     MOVE DP010I-NUMERIC-FIELD                    30510000
305200                                      TO ASC-PARENT-VENDOR-NBR-N  30520000
305300                                         PV-PARENT-VENDOR-NBR-N   30530000
305400                     SET PS-SELECT-BY-NUMBER TO TRUE              30540000
305500                                                                  30550000
305600                     PERFORM 3100-VALIDATE-PARENT-NAME            30560000
305700                                                                  30570000
305800                     IF SQLCODE = 0                               30580000
305900                        MOVE ENTNME-ENT-NAME-DESC TO              30590000
306000                                          ASC-PARENT-NAME         30600000
306100                                          APRNTCOO                30610000
306200                        MOVE PV-PARENT-ENT-ID TO                  30620000
306300                                           ASC-PRNT-CO-ENT-ID     30630000
306400                     ELSE                                         30640000
306500                        SET PS-ERROR          TO TRUE             30650000
306600                        SET DP020-MSG-FATAL   TO TRUE             30660000
306700**                      --- VENDOR NAME NOT FOUND ---             30670000
306800                        MOVE PC-TSYMSG-01869  TO DP020-MSG-NUMBER 30680000
306900                        MOVE DP015-UNP-ALP-BRT-OFF                30690000
307000                                              TO APRNTNBA         30700000
307100                        MOVE DP015-RED        TO APRNTNBC         30710000
307200                        MOVE DP015-REVERSE    TO APRNTNBH         30720000
307300                        MOVE -1               TO APRNTNBL         30730000
307400                        SET DP030-SET-CURSOR-APPL-1               30740000
307500                                              TO TRUE             30750000
307600                     END-IF                                       30760000
307700                 END-IF                                           30770000
307800                                                                  30780000
307900            WHEN ASC-PARENT-NAME > SPACES                         30790000
308000                 SET PS-SELECT-BY-NAME TO TRUE                    30800000
308100                 PERFORM 3100-VALIDATE-PARENT-NAME                30810000
308200                 IF SQLCODE = +0                                  30820000
308300                    IF EXTENT-PRNT-CO-IND = 'N'                   30830000
308400                        SET PS-ERROR              TO TRUE         30840000
308500                        SET DP020-MSG-FATAL       TO TRUE         30850000
308600                        MOVE PC-TSYMSG-01870      TO              30860000
308700                                            DP020-MSG-NUMBER      30870000
308800                        MOVE DP015-UNP-ALP-BRT-OFF                30880000
308900                                                  TO APRNTCOA     30890000
309000                        MOVE DP015-RED            TO APRNTCOC     30900000
309100                        MOVE DP015-REVERSE        TO APRNTCOH     30910000
309200                        MOVE -1                   TO APRNTCOL     30920000
309300                        SET DP030-SET-CURSOR-APPL-1               30930000
309400                                                  TO TRUE         30940000
309500                    ELSE                                          30950000
309600                        MOVE ENTNME-ENT-NAME-DESC TO              30960000
309700                                             ASC-PARENT-NAME      30970000
309800                                             APRNTCOO             30980000
309900                        MOVE PV-PARENT-ENT-ID TO                  30990000
310000                                             ASC-PRNT-CO-ENT-ID   31000000
310100                        MOVE PV-PARENT-VENDOR-NBR TO              31010000
310200                                           ASC-PARENT-VENDOR-NBR  31020000
310300                    END-IF                                        31030000
310400                ELSE                                              31040000
310500                    IF SQLCODE = +100                             31050000
310600                        SET PS-ERROR          TO TRUE             31060000
310700                        SET DP020-MSG-FATAL   TO TRUE             31070000
310800                        MOVE PC-TSYMSG-01869  TO DP020-MSG-NUMBER 31080000
310900                        MOVE DP015-UNP-ALP-BRT-OFF                31090000
311000                                              TO APRNTCOA         31100000
311100                        MOVE DP015-RED        TO APRNTCOC         31110000
311200                        MOVE DP015-REVERSE    TO APRNTCOH         31120000
311300                        MOVE -1               TO APRNTCOL         31130000
311400                        SET DP030-SET-CURSOR-APPL-1               31140000
311500                                              TO TRUE             31150000
311600                    END-IF                                        31160000
311700                END-IF                                            31170000
311800                                                                  31180000
311900        END-EVALUATE.                                             31190000
312000                                                                  31200000
312100     IF  ASC-DUN-NBR = SPACE                                      31210000
312200         SET VENDOR-NUMBER-NOT-ENTERED TO TRUE                    31220000
312300     ELSE                                                         31230000
312400         SET VENDOR-NUMBER-ENTERED TO TRUE                        31240000
312500         MOVE ASC-DUN-NBR TO DP010I-UNEDITED-FIELD                31250000
312600         MOVE 9           TO DP010I-MAXIMUM-DIGITS                31260000
312700         MOVE 0           TO DP010I-MAXIMUM-DECIMALS              31270000
312800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  31280000
312900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         31290000
313000                         USING DP010I-NUMERIC-EDIT-AREA           31300000
313100         IF DP010I-ERROR-DETECTED                                 31310000
313200             SET PS-ERROR          TO TRUE                        31320000
313300             SET DP020-MSG-FATAL   TO TRUE                        31330000
313400*            --- MUST BE NUMERIC    ---                           31340000
313500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            31350000
313600             MOVE DP015-UNP-ALP-BRT-OFF                           31360000
313700                                   TO ADUNNBRA                    31370000
313800             MOVE DP015-RED        TO ADUNNBRC                    31380000
313900             MOVE DP015-REVERSE    TO ADUNNBRH                    31390000
314000             MOVE -1               TO ADUNNBRL                    31400000
314100             SET DP030-SET-CURSOR-APPL-1                          31410000
314200                                   TO TRUE                        31420000
314300         ELSE                                                     31430000
314400             MOVE DP010I-NUMERIC-FIELD TO ASC-DUN-NBR-N           31440000
314500             MOVE ASC-DUN-NBR          TO PV-DUN-NBR              31450000
314600             PERFORM 3310-SELECT-TEXTENT-DUN                      31460000
314700             IF SQLCODE = ZERO                                    31470000
314800                 IF EXTENT-ENT-ID = ASC-ENT-ID                    31480000
314900                     CONTINUE                                     31490000
315000                 ELSE                                             31500000
315100                     SET PS-ERROR          TO TRUE                31510000
315200                     SET DP020-MSG-FATAL   TO TRUE                31520000
315300*                    --- DUNS NBR ALREADY EXISTS ---              31530000
315400                     MOVE PC-TSYMSG-00160  TO DP020-MSG-NUMBER    31540000
315500                     MOVE DP015-UNP-ALP-BRT-OFF                   31550000
315600                                   TO ADUNNBRA                    31560000
315700                     MOVE DP015-RED        TO ADUNNBRC            31570000
315800                     MOVE DP015-REVERSE    TO ADUNNBRH            31580000
315900                     MOVE -1               TO ADUNNBRL            31590000
316000                     SET DP030-SET-CURSOR-APPL-1                  31600000
316100                                   TO TRUE                        31610000
316200                 END-IF                                           31620000
316300              END-IF                                              31630000
316400         END-IF                                                   31640000
316500     END-IF.                                                      31650000
316600                                                                  31660000
316700     IF  ASC-NDA-IND = 'Y' OR 'N' OR SPACE                        31670000
316800         IF ASC-ADD-COMPLETE-SW = 'N'                             31680000
316900            CONTINUE                                              31690000
317000         ELSE                                                     31700000
317100            SET PS-DONT-UPDATE-NDA-IND TO TRUE                    31710000
317200            PERFORM 3400-CHECK-NDA-IND-ON-TABLE                   31720000
317300*****    NDA IND ON TEXTENT = 'Y'                                 31730000
317400            IF PV-EXTENT-NDA-IND = ASC-NDA-IND                    31740000
317500               CONTINUE                                           31750000
317600            ELSE                                                  31760000
317700               SET PS-UPDATE-NDA-IND TO TRUE                      31770000
317800               EXEC SQL                                           31780000
317900                    SET :PV-WORK-DATE = CURRENT DATE              31790000
318000               END-EXEC                                           31800000
318100                                                                  31810000
318200               IF ASC-NDA-IND = 'Y'                               31820000
318300                  MOVE PV-WORK-DATE    TO PV-BEGIN-DATE           31830000
318400                  MOVE PC-DEFAULT-DATE TO PV-END-DATE             31840000
318500               ELSE                                               31850000
318600                  MOVE PV-EXTENT-NDA-BEG-DTE TO PV-BEGIN-DATE     31860000
318700                 MOVE PV-WORK-DATE          TO PV-END-DATE        31870000
318800               END-IF                                             31880000
318900            END-IF                                                31890000
319000         END-IF                                                   31900000
319100     ELSE                                                         31910000
319200* NDA INDICATOR CAN ONLY BE 'Y' OR 'N'                            31920000
319300         SET PS-ERROR              TO TRUE                        31930000
319400         SET DP020-MSG-FATAL       TO TRUE                        31940000
319500         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            31950000
319600         MOVE DP015-UNP-ALP-BRT-OFF TO ANDAINDA                   31960000
319700         MOVE DP015-RED            TO ANDAINDC                    31970000
319800         MOVE DP015-REVERSE        TO ANDAINDH                    31980000
319900         MOVE -1                   TO ANDAINDL                    31990000
320000         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     32000000
320100     END-IF.                                                      32010000
320200                                                                  32020000
320300     IF PS-UPDATE-NDA-IND-SW = 'Y'                                32030000
320400        IF ASC-NDA-IND = SPACE                                    32040000
320500           SET PS-ERROR                 TO TRUE                   32050000
320600           SET DP020-MSG-FATAL          TO TRUE                   32060000
320700           MOVE PC-TSYMSG-00349         TO DP020-MSG-NUMBER       32070000
320800           MOVE DP015-UNP-ALP-BRT-OFF   TO ANDAINDA               32080000
320900           MOVE DP015-RED               TO ANDAINDC               32090000
321000           MOVE DP015-REVERSE           TO ANDAINDH               32100000
321100           MOVE -1                      TO ANDAINDL               32110000
321200           SET DP030-SET-CURSOR-APPL-1  TO TRUE                   32120000
321300        END-IF                                                    32130000
321400     ELSE                                                         32140000
321500        IF ASC-PRIMARY-TYPE = 'E' OR 'F'                          32150000
321600           IF ASC-NDA-IND = SPACE                                 32160000
321700              MOVE 'N' TO ASC-NDA-IND                             32170000
321800           END-IF                                                 32180000
321900        ELSE                                                      32190000
322000           IF ASC-PRIMARY-TYPE = 'M' AND                          32200000
322100              ASC-NDA-IND = SPACE                                 32210000
322200              MOVE 'Y' TO ASC-NDA-IND                             32220000
322300           END-IF                                                 32230000
322400        END-IF                                                    32240000
322500     END-IF.                                                      32250000
322600                                                                  32260000
322700     IF ASC-STATUS-CDE = 'A' OR 'I'                               32270000
322800         IF ASC-STATUS-CDE = 'I'                                  32280000
322900            SET PS-UPDATE-NDA-IND TO TRUE                         32290000
323000                                                                  32300000
323100            MOVE 'N'             TO ASC-NDA-IND                   32310000
323200            MOVE PC-DEFAULT-DATE TO PV-BEGIN-DATE                 32320000
323300            MOVE PC-DEFAULT-DATE TO PV-END-DATE                   32330000
323400         END-IF                                                   32340000
323500     ELSE                                                         32350000
323600         SET PS-ERROR              TO TRUE                        32360000
323700         SET DP020-MSG-FATAL       TO TRUE                        32370000
323800         MOVE PC-TSYMSG-00496      TO DP020-MSG-NUMBER            32380000
323900         MOVE DP015-UNP-ALP-BRT-OFF                               32390000
324000                                   TO AVNSTATA                    32400000
324100         MOVE DP015-RED            TO AVNSTATC                    32410000
324200         MOVE DP015-REVERSE        TO AVNSTATH                    32420000
324300         MOVE -1                   TO AVNSTATL                    32430000
324400         SET DP030-SET-CURSOR-APPL-1                              32440000
324500                                   TO TRUE                        32450000
324600     END-IF.                                                      32460000
324700                                                                  32470000
324800     IF  ASC-VEND-SNME NOT = SPACES                               32480000
324900         MOVE '04' TO PV-TYPE-CODE                                32490000
325000         MOVE ASC-VEND-SNME TO PV-VEND-NAME                       32500000
325100         PERFORM 3300-SELECT-TENTNME-NAME                         32510000
325200         IF SQLCODE = ZERO                                        32520000
325300             IF ENTNME-ENT-ID = ASC-ENT-ID AND                    32530000
325400                ENTNME-TYPE-CDE = PV-TYPE-CODE                    32540000
325500                 CONTINUE                                         32550000
325600             ELSE                                                 32560000
325700                 SET PS-ERROR          TO TRUE                    32570000
325800                 SET DP020-MSG-FATAL   TO TRUE                    32580000
325900*                --- NAME     ALREADY EXISTS ---                  32590000
326000                 MOVE PC-TSYMSG-00490  TO DP020-MSG-NUMBER        32600000
326100                 MOVE DP015-UNP-ALP-BRT-OFF                       32610000
326200                               TO AVNSNMEA                        32620000
326300                 MOVE DP015-RED        TO AVNSNMEC                32630000
326400                 MOVE DP015-REVERSE    TO AVNSNMEH                32640000
326500                 MOVE -1               TO AVNSNMEL                32650000
326600                 SET DP030-SET-CURSOR-APPL-1                      32660000
326700                               TO TRUE                            32670000
326800             END-IF                                               32680000
326900         END-IF                                                   32690000
327000     END-IF.                                                      32700000
327100                                                                  32710000
327200     IF  ASC-VEND-NAME = SPACES                                   32720000
327300         SET PS-ERROR              TO TRUE                        32730000
327400         SET DP020-MSG-FATAL       TO TRUE                        32740000
327500         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            32750000
327600         MOVE DP015-UNP-ALP-BRT-OFF                               32760000
327700                                   TO AVNNAMEA                    32770000
327800         MOVE DP015-RED            TO AVNNAMEC                    32780000
327900         MOVE DP015-REVERSE        TO AVNNAMEH                    32790000
328000         MOVE -1                   TO AVNNAMEL                    32800000
328100         SET DP030-SET-CURSOR-APPL-1                              32810000
328200                                   TO TRUE                        32820000
328300     ELSE                                                         32830000
328400**     CHECK THE PRIMARY VENDOR NAME FIELD FOR UNDERSCORES        32840000
328500         MOVE ZERO TO PV-UNDERSCORE-COUNT                         32850000
328600         INSPECT ASC-VEND-NAME                                    32860000
328700             TALLYING PV-UNDERSCORE-COUNT                         32870000
328800             FOR ALL '_'                                          32880000
328900         IF PV-UNDERSCORE-COUNT > ZERO                            32890000
329000             SET PS-ERROR          TO TRUE                        32900000
329100             SET DP020-MSG-FATAL   TO TRUE                        32910000
329200***        ** AN UNDERSCORE (_) IS AN INVALID CHARACTER --        32920000
329300***           PLEASE REMOVE **                                    32930000
329400             MOVE PC-TSYMSG-01643  TO DP020-MSG-NUMBER            32940000
329500             MOVE DP015-UNP-ALP-BRT-OFF                           32950000
329600                                   TO AVNNAMEA                    32960000
329700             MOVE DP015-RED        TO AVNNAMEC                    32970000
329800             MOVE DP015-REVERSE    TO AVNNAMEH                    32980000
329900             MOVE -1               TO AVNNAMEL                    32990000
330000             SET DP030-SET-CURSOR-APPL-1                          33000000
330100                                   TO TRUE                        33010000
330200         ELSE                                                     33020000
330300             MOVE '01'             TO PV-TYPE-CODE                33030000
330400             MOVE ASC-VEND-NAME    TO PV-VEND-NAME                33040000
330500             PERFORM 3300-SELECT-TENTNME-NAME                     33050000
330600             IF SQLCODE = ZERO                                    33060000
330700                 IF ENTNME-ENT-ID = ASC-ENT-ID AND                33070000
330800                    ENTNME-TYPE-CDE = PV-TYPE-CODE                33080000
330900                     CONTINUE                                     33090000
331000                 ELSE                                             33100000
331100                     SET PS-ERROR  TO TRUE                        33110000
331200                     SET DP020-MSG-FATAL                          33120000
331300                                   TO TRUE                        33130000
331400*                --- NAME     ALREADY EXISTS ---                  33140000
331500                     MOVE PC-TSYMSG-00490 TO DP020-MSG-NUMBER     33150000
331600                     MOVE DP015-UNP-ALP-BRT-OFF                   33160000
331700                                   TO AVNNAMEA                    33170000
331800                     MOVE DP015-RED                               33180000
331900                                   TO AVNNAMEC                    33190000
332000                     MOVE DP015-REVERSE                           33200000
332100                                   TO AVNNAMEH                    33210000
332200                     MOVE -1       TO AVNNAMEL                    33220000
332300                     SET DP030-SET-CURSOR-APPL-1                  33230000
332400                                   TO TRUE                        33240000
332500                 END-IF                                           33250000
332600             END-IF                                               33260000
332700         END-IF                                                   33270000
332800     END-IF.                                                      33280000
332900                                                                  33290000
333000     IF  ASC-VEND-NAME > SPACES AND                               33300000
333100         ASC-VEND-NAME = ASC-VEND-SNME                            33310000
333200         SET PS-ERROR              TO TRUE                        33320000
333300         SET DP020-MSG-FATAL       TO TRUE                        33330000
333400*        --- NAME     ALREADY EXISTS ---                          33340000
333500         MOVE PC-TSYMSG-00490      TO DP020-MSG-NUMBER            33350000
333600         MOVE DP015-UNP-ALP-BRT-OFF                               33360000
333700                                   TO AVNSNMEA                    33370000
333800         MOVE DP015-RED            TO AVNSNMEC                    33380000
333900         MOVE DP015-REVERSE        TO AVNSNMEH                    33390000
334000         MOVE -1                   TO AVNSNMEL                    33400000
334100         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    33410000
334200     END-IF.                                                      33420000
334300                                                                  33430000
334400     IF  PS-NO-ERROR                                              33440000
334500         MOVE -1                   TO AVNNAMEL                    33450000
334600         SET DP030-SET-CURSOR-APPL-1                              33460000
334700                                   TO TRUE                        33470000
334800     END-IF.                                                      33480000
334900                                                                  33490000
335000     IF ASC-PREPACK-EDI-CDE = 'Y' OR 'N' OR 'C' OR 'X'            33500000
335100         SET PS-DONT-UPDATE-PREPACK-IND TO TRUE                   33510000
335200         PERFORM 3500-CHECK-PREPK-IND-ON-TABLE                    33520000
335300*****    PREPACK IND ON TEXTENT = 'Y'                             33530000
335400         IF PV-EXTENT-PREPACK-IND = ASC-PREPACK-EDI-CDE           33540000
335500            CONTINUE                                              33550000
335600         ELSE                                                     33560000
335700            SET PS-UPDATE-PREPACK-IND TO TRUE                     33570000
335800         END-IF                                                   33580000
335900     ELSE                                                         33590000
336000* PREPACK INDICATOR CAN ONLY BE 'Y' OR 'N'                        33600000
336100         IF ASC-PRIMARY-TYPE = 'E' OR 'F'                         33610000
336200            IF ASC-PREPACK-EDI-CDE = SPACE                        33620000
336300               MOVE 'N' TO ASC-PREPACK-EDI-CDE                    33630000
336400            END-IF                                                33640000
336500         ELSE                                                     33650000
336600            SET PS-ERROR              TO TRUE                     33660000
336700            SET DP020-MSG-FATAL       TO TRUE                     33670000
336800            MOVE PC-TSYMSG-03062      TO DP020-MSG-NUMBER         33680000
336900            MOVE DP015-UNP-ALP-BRT-OFF                            33690000
337000                                      TO APPEDIA                  33700000
337100            MOVE DP015-RED            TO APPEDIC                  33710000
337200            MOVE DP015-REVERSE        TO APPEDIH                  33720000
337300            MOVE -1                   TO APPEDIL                  33730000
337400            SET DP030-SET-CURSOR-APPL-1                           33740000
337500                                      TO TRUE                     33750000
337600         END-IF                                                   33760000
337700     END-IF.                                                      33770000
337800                                                                  33780000
337900     IF PS-UPDATE-PREPACK-IND-SW = 'Y'                            33790000
338000        IF ASC-PREPACK-EDI-CDE = SPACE                            33800000
338100           SET PS-ERROR                TO TRUE                    33810000
338200           SET DP020-MSG-FATAL         TO TRUE                    33820000
338300           MOVE PC-TSYMSG-00349        TO DP020-MSG-NUMBER        33830000
338400           MOVE DP015-UNP-ALP-BRT-OFF  TO APPEDIA                 33840000
338500           MOVE DP015-RED              TO APPEDIC                 33850000
338600           MOVE DP015-REVERSE          TO APPEDIH                 33860000
338700           MOVE -1                     TO APPEDIL                 33870000
338800           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    33880000
338900        END-IF                                                    33890000
339000     END-IF.                                                      33900000
339100                                                                  33910000
339200*----------------------------------------------------------------*33920000
339300* PERFORM EDITS ON THE LINE OF CREDIT FIELD.                     *33930000
339400*----------------------------------------------------------------*33940000
339500 3050-EDIT-LINE-OF-CREDIT.                                        33950000
339600     IF ASC-PARTNER-TYPE = 'BK'                                   33960000
339700        INSPECT ASC-LINE-OF-CREDIT TALLYING PV-DOT-COUNT          33970000
339800            FOR ALL '.'                                           33980000
339900        IF PV-DOT-COUNT = 0                                       33990000
340000           SET PS-ERROR           TO TRUE                         34000000
340100           SET DP020-MSG-FATAL    TO TRUE                         34010000
340200           MOVE PC-TSYMSG-02669   TO DP020-MSG-NUMBER             34020000
340300           MOVE DP015-UNP-ALP-BRT-OFF                             34030000
340400                                  TO ALNCRDTA                     34040000
340500           MOVE DP015-RED         TO ALNCRDTC                     34050000
340600           MOVE DP015-REVERSE     TO ALNCRDTH                     34060000
340700           MOVE -1                TO ALNCRDTL                     34070000
340800           SET DP030-SET-CURSOR-APPL-1                            34080000
340900                                  TO TRUE                         34090000
341000        ELSE                                                      34100000
341100           MOVE ASC-LINE-OF-CREDIT   TO PV-LNE-OF-CR-AMT          34110000
341200           MOVE PV-LNE-OF-CR-AMT-DLLR TO PV-LINE-OF-CREDIT-DLLR   34120000
341300           COMPUTE PV-LINE-OF-CREDIT-CENT = PV-LNE-OF-CR-AMT-CENT 34130000
341400                                            / 100                 34140000
341500           IF PV-LINE-OF-CREDIT > 0                               34150000
341600              CONTINUE                                            34160000
341700           ELSE                                                   34170000
341800              SET PS-ERROR           TO TRUE                      34180000
341900              SET DP020-MSG-FATAL    TO TRUE                      34190000
342000              MOVE PC-TSYMSG-02637   TO DP020-MSG-NUMBER          34200000
342100              MOVE DP015-UNP-ALP-BRT-OFF                          34210000
342200                                     TO ALNCRDTA                  34220000
342300              MOVE DP015-RED         TO ALNCRDTC                  34230000
342400              MOVE DP015-REVERSE     TO ALNCRDTH                  34240000
342500              MOVE -1                TO ALNCRDTL                  34250000
342600              SET DP030-SET-CURSOR-APPL-1                         34260000
342700                                     TO TRUE                      34270000
342800           END-IF                                                 34280000
342900        END-IF                                                    34290000
343000     ELSE                                                         34300000
343100*       INSPECT ASC-LINE-OF-CREDIT TALLYING PV-DOT-COUNT          34310000
343200*           FOR ALL '.'                                           34320000
343300        MOVE ASC-LINE-OF-CREDIT   TO PV-LNE-OF-CR-AMT             34330000
343400        MOVE PV-LNE-OF-CR-AMT-DLLR TO PV-LINE-OF-CREDIT-DLLR      34340000
343500        COMPUTE PV-LINE-OF-CREDIT-CENT = PV-LNE-OF-CR-AMT-CENT    34350000
343600                                      / 100                       34360000
343700        IF PV-LINE-OF-CREDIT > 0                                  34370000
343800*       IF PV-LINE-OF-CREDIT > 0 OR                               34380000
343900*          PV-DOT-COUNT = 0                                       34390000
344000           SET PS-ERROR              TO TRUE                      34400000
344100           SET DP020-MSG-FATAL       TO TRUE                      34410000
344200           MOVE PC-TSYMSG-02638      TO DP020-MSG-NUMBER          34420000
344300           MOVE DP015-UNP-ALP-BRT-OFF                             34430000
344400                                     TO ALNCRDTA                  34440000
344500           MOVE DP015-RED            TO ALNCRDTC                  34450000
344600           MOVE DP015-REVERSE        TO ALNCRDTH                  34460000
344700           MOVE -1                   TO ALNCRDTL                  34470000
344800           SET DP030-SET-CURSOR-APPL-1                            34480000
344900                                     TO TRUE                      34490000
345000        END-IF                                                    34500000
345100     END-IF.                                                      34510000
345200                                                                  34520000
345300*----------------------------------------------------------------*34530000
345400* VALIDATE THE PARENT VENDOR NAME ENTERED IS A VALID VENDOR      *34540000
345500*----------------------------------------------------------------*34550000
345600 3100-VALIDATE-PARENT-NAME.                                       34560000
345700                                                                  34570000
345800     PERFORM                                                      34580000
345900         WITH TEST AFTER                                          34590000
346000         VARYING PV-RETRY-COUNTER                                 34600000
346100         FROM 1 BY 1                                              34610000
346200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34620000
346300                   OR (SQLCODE = ZERO)                            34630000
346400                   OR (SQLCODE = +100))                           34640000
346500                                                                  34650000
346600         IF PS-SELECT-BY-NAME                                     34660000
346700            EXEC SQL                                              34670000
346800                SELECT C.ENT_NAME_DESC,                           34680000
346900                       A.PRNT_CO_IND,                             34690000
347000                       A.ENT_ID,                                  34700000
347100                       A.DUN_NBR                                  34710000
347200                INTO  :ENTNME-ENT-NAME-DESC,                      34720000
347300                      :EXTENT-PRNT-CO-IND,                        34730000
347400                      :PV-PARENT-ENT-ID,                          34740000
347500                      :PV-PARENT-VENDOR-NBR                       34750000
347600                FROM TEXTENT A,                                   34760000
347700                     TENTNME B,                                   34770000
347800                     TENTNME C                                    34780000
347900                WHERE B.ENT_NAME_DESC = :ASC-PARENT-NAME          34790000
348000                  AND A.ENT_ID = B.ENT_ID                         34800000
348100                  AND A.STATUS_CDE = 'A'                          34810000
348200                  AND B.ENT_ID = C.ENT_ID                         34820000
348300                  AND C.TYPE_CDE = '01'                           34830000
348400            END-EXEC                                              34840000
348500         ELSE                                                     34850000
348600            EXEC SQL                                              34860000
348700                SELECT B.ENT_NAME_DESC,                           34870000
348800                       A.PRNT_CO_IND,                             34880000
348900                       A.ENT_ID                                   34890000
349000                INTO  :ENTNME-ENT-NAME-DESC,                      34900000
349100                      :EXTENT-PRNT-CO-IND,                        34910000
349200                      :PV-PARENT-ENT-ID                           34920000
349300                FROM TEXTENT A,                                   34930000
349400                     TENTNME B                                    34940000
349500                WHERE A.DUN_NBR = :PV-PARENT-VENDOR-NBR           34950000
349600                  AND A.ENT_ID = B.ENT_ID                         34960000
349700                  AND A.STATUS_CDE = 'A'                          34970000
349800                  AND B.TYPE_CDE = '01'                           34980000
349900            END-EXEC                                              34990000
350000         END-IF                                                   35000000
350100                                                                  35010000
350200         EVALUATE TRUE                                            35020000
350300             WHEN SQLCODE = ZERO                                  35030000
350400             WHEN SQLCODE = +100                                  35040000
350500             WHEN SQLCODE = -904                                  35050000
350600             WHEN SQLCODE = -913                                  35060000
350700                 CONTINUE                                         35070000
350800             WHEN SQLWARN0 NOT = SPACES                           35080000
350900             WHEN SQLCODE < ZERO                                  35090000
351000             WHEN SQLCODE > ZERO                                  35100000
351100                 MOVE '3100-VALIDATE-PARENT-NAME'                 35110000
351200                                   TO DP013-PARAGRAPH             35120000
351300                 MOVE 'SELECT PARENT NAME:             '          35130000
351400                                   TO DP013-MESSAGE-TEXT (1)      35140000
351500                 MOVE PV-VEND-NAME                                35150000
351600                                   TO DP013-MESSAGE-TEXT (2)      35160000
351700                 MOVE SQLCA        TO DP013-SQLCA                 35170000
351800                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    35180000
351900                 SET DP013-DB2-ABEND                              35190000
352000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35200000
352100                 PERFORM DP013-0000-PROCESS-ABEND                 35210000
352200         END-EVALUATE                                             35220000
352300     END-PERFORM.                                                 35230000
352400                                                                  35240000
352500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35250000
352600         MOVE '3100-VALIDATE-PARENT-NAME'                         35260000
352700                                   TO DP013-PARAGRAPH             35270000
352800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35280000
352900                                   TO DP013-MESSAGE-TEXT (1)      35290000
353000         MOVE 'SELECT PARENT ANME'                                35300000
353100                                   TO DP013-MESSAGE-TEXT (2)      35310000
353200         MOVE PV-VEND-NAME         TO DP013-MESSAGE-TEXT (3)      35320000
353300         MOVE SQLCA                TO DP013-SQLCA                 35330000
353400         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    35340000
353500         SET DP013-DB2-ABEND                                      35350000
353600             DP013-XCTL-DISPLAY-RESTART                           35360000
353700                                   TO TRUE                        35370000
353800         PERFORM DP013-0000-PROCESS-ABEND                         35380000
353900     END-IF.                                                      35390000
354000                                                                  35400000
354100                                                                  35410000
354200*----------------------------------------------------------------*35420000
354300* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *35430000
354400* MAP.                                                           *35440000
354500*----------------------------------------------------------------*35450000
354600 3200-RESET-ATTRIBUTES.                                           35460000
354700                                                                  35470000
354800     MOVE DP015-UNP-ALP-NOR-OFF    TO AVNNAMEA                    35480000
354900                                      AVNSNMEA                    35490000
355000                                      AVNSTATA                    35500000
355100                                      APRMTYPA                    35510000
355200                                      ADUNNBRA                    35520000
355300                                      APRNTCOA                    35530000
355400                                      APRNTNBA                    35540000
355500                                      AVNHOLDA                    35550000
355600                                      AUSEFACA                    35560000
355700                                      ASEPPAYA                    35570000
355800                                      APPEDIA                     35580000
355900                                      ANDAINDA                    35590000
356000                                      ADPTNBRA                    35600000
356100                                      APTNRTYA                    35610000
356200                                      ASCACA                      35620000
356300                                      AMANPROA                    35630000
356400                                      ACAPEXPA                    35640000
356500                                      ADPTEXPA                    35650000
356600                                      ACLASFCA                    35660000
356700                                      APERSISA                    35670000
356800                                      A1099A                      35680000
356900*                                     ATAXIDTA                    35690000
357000*                                     ATAXIDA                     35700000
357100                                      AWTHCDEA                    35710000
357200                                      APARINDA                    35720000
357300                                      APAYHNDA.                   35730000
357400     MOVE DP015-UNP-NUM-NOR-OFF    TO AINHSA                      35740000
357500                                      ALNCRDTA                    35750000
357600                                      ACPACTYA.                   35760000
357700     MOVE DP015-ASK-NOR-OFF        TO ADPTLBLA                    35770000
357800                                      AINHLBLA                    35780000
357900                                      AEXPLBLA.                   35790000
358000     MOVE DP015-GREEN              TO AVNNAMEC                    35800000
358100                                      AVNSNMEC                    35810000
358200                                      APRMTYPC                    35820000
358300                                      AVNSTATC                    35830000
358400                                      ADUNNBRC                    35840000
358500                                      APRNTCOC                    35850000
358600                                      APRNTNBC                    35860000
358700                                      AVNHOLDC                    35870000
358800                                      AUSEFACC                    35880000
358900                                      ASEPPAYC                    35890000
359000                                      APPEDIC                     35900000
359100                                      ADPTNBRC                    35910000
359200                                      AINHSC                      35920000
359300                                      APTNRTYC                    35930000
359400                                      ASCACC                      35940000
359500                                      AMANPROC                    35950000
359600                                      ALNCRDTC                    35960000
359700                                      ACPACTYC                    35970000
359800                                      ACAPEXPC                    35980000
359900                                      ADPTEXPC                    35990000
360000                                      ACLASFCC                    36000000
360100                                      APERSISC                    36010000
360200                                      A1099C                      36020000
360300*                                     ATAXIDTC                    36030000
360400*                                     ATAXIDC                     36040000
360500                                      AWTHCDEC                    36050000
360600                                      APARINDC                    36060000
360700                                      APAYHNDC                    36070000
360800                                      ANDAINDC.                   36080000
360900     MOVE DP015-WHITE              TO ADPTLBLC                    36090000
361000                                      AINHLBLC                    36100000
361100                                      AEXPLBLC.                   36110000
361200     MOVE DP015-UNDERLINE          TO AVNNAMEH                    36120000
361300                                      AVNSNMEH                    36130000
361400                                      AVNSTATH                    36140000
361500                                      ADUNNBRH                    36150000
361600                                      APRMTYPH                    36160000
361700                                      APRNTCOH                    36170000
361800                                      APRNTNBH                    36180000
361900                                      AVNHOLDH                    36190000
362000                                      AUSEFACH                    36200000
362100                                      ASEPPAYH                    36210000
362200                                      APPEDIH                     36220000
362300                                      ADPTNBRH                    36230000
362400                                      AINHSH                      36240000
362500                                      APTNRTYH                    36250000
362600                                      ASCACH                      36260000
362700                                      AMANPROH                    36270000
362800                                      ALNCRDTH                    36280000
362900                                      ACPACTYH                    36290000
363000                                      ACAPEXPH                    36300000
363100                                      ADPTEXPH                    36310000
363200                                      ACLASFCH                    36320000
363300                                      APERSISH                    36330000
363400                                      A1099H                      36340000
363500*                                     ATAXIDTH                    36350000
363600*                                     ATAXIDH                     36360000
363700                                      AWTHCDEH                    36370000
363800                                      APARINDH                    36380000
363900                                      APAYHNDH                    36390000
364000                                      ANDAINDH.                   36400000
364100     MOVE DP015-HL-OFF             TO ADPTLBLH                    36410000
364200                                      AINHLBLH                    36420000
364300                                      AEXPLBLH.                   36430000
364400                                                                  36440000
364500     IF ASC-NO-MERCH-AUTH                                         36450000
364600         MOVE DP015-ASK-NOR-OFF    TO                             36460000
364700                                      ADPTNBRA                    36470000
364800                                      AINHSA                      36480000
364900         MOVE DP015-BLUE           TO                             36490000
365000                                      ADPTNBRC                    36500000
365100                                      AINHSC                      36510000
365200         MOVE DP015-HL-OFF         TO                             36520000
365300                                      ADPTNBRH                    36530000
365400                                      AINHSH                      36540000
365500     END-IF.                                                      36550000
365600                                                                  36560000
365700     IF ASC-NO-CAR-AUTH                                           36570000
365800         MOVE DP015-ASK-NOR-OFF    TO                             36580000
365900                                      ASCACA                      36590000
366000                                      AMANPROA                    36600000
366100         MOVE DP015-BLUE           TO                             36610000
366200                                      ASCACC                      36620000
366300                                      AMANPROC                    36630000
366400         MOVE DP015-HL-OFF         TO                             36640000
366500                                      ASCACH                      36650000
366600                                      AMANPROH                    36660000
366700     END-IF.                                                      36670000
366800                                                                  36680000
366900     IF ASC-NO-EXPENSE-AUTH                                       36690000
367000         MOVE DP015-ASK-NOR-OFF    TO                             36700000
367100                                      ACAPEXPA                    36710000
367200                                      ADPTEXPA                    36720000
367300                                      ACLASFCA                    36730000
367400                                      APERSISA                    36740000
367500                                      A1099A                      36750000
367600*                                     ATAXIDTA                    36760000
367700*                                     ATAXIDA                     36770000
367800                                      AWTHCDEA                    36780000
367900         MOVE DP015-BLUE           TO                             36790000
368000                                      ACAPEXPC                    36800000
368100                                      ADPTEXPC                    36810000
368200                                      ACLASFCC                    36820000
368300                                      APERSISC                    36830000
368400                                      A1099C                      36840000
368500*                                     ATAXIDTC                    36850000
368600*                                     ATAXIDC                     36860000
368700                                      AWTHCDEC                    36870000
368800         MOVE DP015-HL-OFF         TO                             36880000
368900                                      ACAPEXPH                    36890000
369000                                      ADPTEXPH                    36900000
369100                                      ACLASFCH                    36910000
369200                                      APERSISH                    36920000
369300                                      A1099H                      36930000
369400*                                     ATAXIDTH                    36940000
369500*                                     ATAXIDH                     36950000
369600                                      AWTHCDEH                    36960000
369700     END-IF.                                                      36970000
369800                                                                  36980000
369900*    IF ASC-NO-FACTOR-AUTH                                        36990000
370000*        MOVE DP015-ASK-NOR-OFF    TO AFACINDA                    37000000
370100*        MOVE DP015-BLUE           TO AFACINDC                    37010000
370200*        MOVE DP015-HL-OFF         TO AFACINDH                    37020000
370300*    END-IF.                                                      37030000
370400                                                                  37040000
370500     IF ASC-NO-PARENT-AUTH                                        37050000
370600         MOVE DP015-ASK-NOR-OFF    TO APARINDA                    37060000
370700         MOVE DP015-BLUE           TO APARINDC                    37070000
370800         MOVE DP015-HL-OFF         TO APARINDH                    37080000
370900     END-IF.                                                      37090000
371000                                                                  37100000
371100     IF ASC-NO-MDEPT                                              37110000
371200         MOVE DP015-ASK-DRK-OFF    TO ADPTLBLA                    37120000
371300                                      ADPTNBRA                    37130000
371400                                      AINHLBLA                    37140000
371500                                      AINHSA                      37150000
371600     END-IF.                                                      37160000
371700                                                                  37170000
371800     IF ASC-NO-EDEPT                                              37180000
371900         MOVE DP015-ASK-DRK-OFF    TO AEXPLBLA                    37190000
372000                                      ADPTEXPA                    37200000
372100     END-IF.                                                      37210000
372200                                                                  37220000
372300     IF ASC-VNDR-NBR-POPULATED                                    37230000
372400         MOVE DP015-ASK-NOR-OFF    TO ADUNNBRA                    37240000
372500         MOVE DP015-BLUE           TO ADUNNBRC                    37250000
372600         MOVE DP015-HL-OFF         TO ADUNNBRH                    37260000
372700     END-IF.                                                      37270000
372800                                                                  37280000
372900     IF ASC-NO-PREPACK-EDI-AUTH                                   37290000
373000         MOVE DP015-ASK-NOR-OFF    TO APPEDIA                     37300000
373100         MOVE DP015-BLUE           TO APPEDIC                     37310000
373200         MOVE DP015-HL-OFF         TO APPEDIH                     37320000
373300     END-IF.                                                      37330000
373400                                                                  37340000
373500******************************************************************37350000
373600** IMPORTANT NOTE:                                                37360000
373700** IMPORTANT NOTE:                                                37370000
373800** IMPORTANT NOTE:                                                37380000
373900**** WHENEVER A NEW FIELD IS ADDED TO THE ONLINE SCREEN, YOU WILL 37390000
374000**** HAVE TO DETERMINE IF IT NEEDS TO BE ADDED TO THE IF STMT FOR 37400000
374100**** ASC-VENDOR-HOLD-AUTH BELOW.  THIS BLOCKS ALL FIELDS THAT CAN 37410000
374200**** NOT BE UPDATED BY AP MANAGEMENT LEVEL USERS.  IF THE SCREEN  37420000
374300**** FIELD IS NOT UNDER THIS IF STMT THEN THESE USERS WILL BE ABLE37430000
374400**** TO UPDATE IT.                                                37440000
374500******************************************************************37450000
374600     IF ASC-VENDOR-HOLD-AUTH                                      37460000
374700         MOVE DP015-ASK-NOR-OFF    TO AVNNAMEA                    37470000
374800                                      APRMTYPA                    37480000
374900                                      ADUNNBRA                    37490000
375000                                      APPEDIA                     37500000
375100                                      ADPTNBRA                    37510000
375200                                      AINHSA                      37520000
375300                                      APARINDA                    37530000
375400                                      APRTNRA                     37540000
375500                                      APTNRTYA                    37550000
375600                                      ASCACA                      37560000
375700                                      AMANPROA                    37570000
375800                                      ALNCRDTA                    37580000
375900                                      ACPACTYA                    37590000
376000                                      ACAPEXPA                    37600000
376100                                      ADPTEXPA                    37610000
376200         MOVE DP015-BLUE           TO AVNNAMEC                    37620000
376300                                      APRMTYPC                    37630000
376400                                      ADUNNBRC                    37640000
376500                                      APPEDIC                     37650000
376600                                      ADPTNBRC                    37660000
376700                                      AINHSC                      37670000
376800                                      APARINDC                    37680000
376900                                      APRTNRC                     37690000
377000                                      APTNRTYC                    37700000
377100                                      ASCACC                      37710000
377200                                      AMANPROC                    37720000
377300                                      ALNCRDTC                    37730000
377400                                      ACPACTYC                    37740000
377500                                      ACAPEXPC                    37750000
377600                                      ADPTEXPC                    37760000
377700         MOVE DP015-HL-OFF         TO AVNNAMEH                    37770000
377800                                      APRMTYPH                    37780000
377900                                      ADUNNBRH                    37790000
378000                                      APPEDIH                     37800000
378100                                      ADPTNBRH                    37810000
378200                                      AINHSH                      37820000
378300                                      APARINDH                    37830000
378400                                      APRTNRH                     37840000
378500                                      APTNRTYH                    37850000
378600                                      ASCACH                      37860000
378700                                      AMANPROH                    37870000
378800                                      ALNCRDTH                    37880000
378900                                      ACPACTYH                    37890000
379000                                      ACAPEXPH                    37900000
379100                                      ADPTEXPH                    37910000
379200                                                                  37920000
379300     END-IF.                                                      37930000
379400                                                                  37940000
379500*----------------------------------------------------------------*37950000
379600*  CHECK FOR DUPLICATE NAME.                                      37960000
379700*----------------------------------------------------------------*37970000
379800 3300-SELECT-TENTNME-NAME.                                        37980000
379900     PERFORM                                                      37990000
380000         WITH TEST AFTER                                          38000000
380100         VARYING PV-RETRY-COUNTER                                 38010000
380200         FROM 1 BY 1                                              38020000
380300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38030000
380400                   OR (SQLCODE = ZERO)                            38040000
380500                   OR (SQLCODE = +100))                           38050000
380600                                                                  38060000
380700         EXEC SQL                                                 38070000
380800             SELECT ENT_ID,                                       38080000
380900                    TYPE_CDE                                      38090000
381000             INTO  :ENTNME-ENT-ID,                                38100000
381100                   :ENTNME-TYPE-CDE                               38110000
381200             FROM TENTNME                                         38120000
381300             WHERE                                                38130000
381400                ENT_NAME_DESC = :PV-VEND-NAME                     38140000
381500         END-EXEC                                                 38150000
381600                                                                  38160000
381700         EVALUATE TRUE                                            38170000
381800             WHEN SQLCODE = ZERO                                  38180000
381900             WHEN SQLCODE = +100                                  38190000
382000             WHEN SQLCODE = -904                                  38200000
382100             WHEN SQLCODE = -913                                  38210000
382200                 CONTINUE                                         38220000
382300             WHEN SQLWARN0 NOT = SPACES                           38230000
382400             WHEN SQLCODE < ZERO                                  38240000
382500             WHEN SQLCODE > ZERO                                  38250000
382600                 MOVE '3300-SELECT-TENTNME-NAME'                  38260000
382700                                   TO DP013-PARAGRAPH             38270000
382800                 MOVE 'SELECT ENTERPRISE FOR VEND NAME:'          38280000
382900                                   TO DP013-MESSAGE-TEXT (1)      38290000
383000                 MOVE PV-VEND-NAME                                38300000
383100                                   TO DP013-MESSAGE-TEXT (2)      38310000
383200                 MOVE SQLCA        TO DP013-SQLCA                 38320000
383300                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    38330000
383400                 SET DP013-DB2-ABEND                              38340000
383500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38350000
383600                 PERFORM DP013-0000-PROCESS-ABEND                 38360000
383700         END-EVALUATE                                             38370000
383800     END-PERFORM.                                                 38380000
383900                                                                  38390000
384000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38400000
384100         MOVE '3300-SELECT-TENTNME-NAME'                          38410000
384200                                   TO DP013-PARAGRAPH             38420000
384300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38430000
384400                                   TO DP013-MESSAGE-TEXT (1)      38440000
384500         MOVE 'ENTERPRISE FOR VEND NAME'                          38450000
384600                                   TO DP013-MESSAGE-TEXT (2)      38460000
384700         MOVE PV-VEND-NAME         TO DP013-MESSAGE-TEXT (3)      38470000
384800         MOVE SQLCA                TO DP013-SQLCA                 38480000
384900         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    38490000
385000         SET DP013-DB2-ABEND                                      38500000
385100             DP013-XCTL-DISPLAY-RESTART                           38510000
385200                                   TO TRUE                        38520000
385300         PERFORM DP013-0000-PROCESS-ABEND                         38530000
385400     END-IF.                                                      38540000
385500                                                                  38550000
385600*----------------------------------------------------------------*38560000
385700*  CHECK FOR DUPLICATE DUNS NUMBER.                               38570000
385800*----------------------------------------------------------------*38580000
385900 3310-SELECT-TEXTENT-DUN.                                         38590000
386000     PERFORM                                                      38600000
386100         WITH TEST AFTER                                          38610000
386200         VARYING PV-RETRY-COUNTER                                 38620000
386300         FROM 1 BY 1                                              38630000
386400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38640000
386500                   OR (SQLCODE = ZERO)                            38650000
386600                   OR (SQLCODE = +100))                           38660000
386700                                                                  38670000
386800         EXEC SQL                                                 38680000
386900             SELECT                                               38690000
387000                 ENT_ID                                           38700000
387100             INTO                                                 38710000
387200                 :EXTENT-ENT-ID                                   38720000
387300             FROM TEXTENT                                         38730000
387400             WHERE                                                38740000
387500                DUN_NBR = :PV-DUN-NBR                             38750000
387600         END-EXEC                                                 38760000
387700                                                                  38770000
387800         EVALUATE TRUE                                            38780000
387900             WHEN SQLCODE = ZERO                                  38790000
388000             WHEN SQLCODE = +100                                  38800000
388100             WHEN SQLCODE = -904                                  38810000
388200             WHEN SQLCODE = -913                                  38820000
388300                 CONTINUE                                         38830000
388400             WHEN SQLWARN0 NOT = SPACES                           38840000
388500             WHEN SQLCODE < ZERO                                  38850000
388600             WHEN SQLCODE > ZERO                                  38860000
388700                 MOVE '3310-SELECT-TEXTENT-DUN'                   38870000
388800                                   TO DP013-PARAGRAPH             38880000
388900                 MOVE 'SELECT ENTERPRISE FOR DUN NBR:'            38890000
389000                                   TO DP013-MESSAGE-TEXT (1)      38900000
389100                 MOVE ASC-DUN-NBR                                 38910000
389200                                   TO DP013-MESSAGE-TEXT (2)      38920000
389300                 MOVE SQLCA        TO DP013-SQLCA                 38930000
389400                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    38940000
389500                 SET DP013-DB2-ABEND                              38950000
389600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38960000
389700                 PERFORM DP013-0000-PROCESS-ABEND                 38970000
389800         END-EVALUATE                                             38980000
389900     END-PERFORM.                                                 38990000
390000                                                                  39000000
390100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39010000
390200         MOVE '3310-SELECT-TEXTENT-DUN'                           39020000
390300                                   TO DP013-PARAGRAPH             39030000
390400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     39040000
390500                                   TO DP013-MESSAGE-TEXT (1)      39050000
390600         MOVE 'ENTERPRISE FOR DUN NBR: '                          39060000
390700                                   TO DP013-MESSAGE-TEXT (2)      39070000
390800         MOVE ASC-DUN-NBR          TO DP013-MESSAGE-TEXT (3)      39080000
390900         MOVE SQLCA                TO DP013-SQLCA                 39090000
391000         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    39100000
391100         SET DP013-DB2-ABEND                                      39110000
391200             DP013-XCTL-DISPLAY-RESTART                           39120000
391300                                   TO TRUE                        39130000
391400         PERFORM DP013-0000-PROCESS-ABEND                         39140000
391500     END-IF.                                                      39150000
391600 EJECT                                                            39160000
391700*----------------------------------------------------------------*39170000
391800* SELECT IF THIS IS VALID DEPARTMENT NUMBER.                     *39180000
391900*----------------------------------------------------------------*39190000
392000                                                                  39200000
392100 3320-SELECT-TMDSEAR.                                             39210000
392200     PERFORM                                                      39220000
392300         WITH TEST AFTER                                          39230000
392400         VARYING PV-RETRY-COUNTER                                 39240000
392500         FROM 1 BY 1                                              39250000
392600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39260000
392700                   OR (SQLCODE = ZERO)                            39270000
392800                   OR (SQLCODE = +100))                           39280000
392900                                                                  39290000
393000         EXEC SQL                                                 39300000
393100             SELECT DEPT_NBR                                      39310000
393200             INTO  :MDSEAR-DEPT-NBR                               39320000
393300             FROM TMDSEAR                                         39330000
393400             WHERE OPERCO_NBR   = :DP020-OPERATING-COMPANY        39340000
393500               AND DEPT_NBR     = :ASC-DEPT-NBR                   39350000
393600               AND MDSELV_CDE   = 'DPT'                           39360000
393700               AND STRT_DTE     <= CURRENT DATE                   39370000
393800               AND END_DTE      >= CURRENT DATE                   39380000
393900         END-EXEC                                                 39390000
394000                                                                  39400000
394100         EVALUATE TRUE                                            39410000
394200             WHEN SQLCODE = ZERO                                  39420000
394300             WHEN SQLCODE = +100                                  39430000
394400             WHEN SQLCODE = -904                                  39440000
394500             WHEN SQLCODE = -913                                  39450000
394600                 CONTINUE                                         39460000
394700             WHEN SQLWARN0 NOT = SPACES                           39470000
394800             WHEN SQLCODE < ZERO                                  39480000
394900             WHEN SQLCODE > ZERO                                  39490000
395000                 MOVE '3320-SELECT-TMDSEAR'                       39500000
395100                                   TO DP013-PARAGRAPH             39510000
395200                 MOVE 'SELECT MERCHANDISE DEPT:'                  39520000
395300                                   TO DP013-MESSAGE-TEXT (1)      39530000
395400                 MOVE ASC-DEPT-NBR                                39540000
395500                                   TO DP013-MESSAGE-TEXT (2)      39550000
395600                 MOVE SQLCA        TO DP013-SQLCA                 39560000
395700                 MOVE 'TMDSEAR'    TO DP013-DB2-TABLE-NAME (1)    39570000
395800                 SET DP013-DB2-ABEND                              39580000
395900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39590000
396000                 PERFORM DP013-0000-PROCESS-ABEND                 39600000
396100         END-EVALUATE                                             39610000
396200     END-PERFORM.                                                 39620000
396300                                                                  39630000
396400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39640000
396500         MOVE '3320-SELECT-TMDSEAR'                               39650000
396600                                   TO DP013-PARAGRAPH             39660000
396700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     39670000
396800                                   TO DP013-MESSAGE-TEXT (1)      39680000
396900         MOVE 'MERCHANDISE DEPARTMENT:'                           39690000
397000                                   TO DP013-MESSAGE-TEXT (2)      39700000
397100         MOVE ASC-DEPT-NBR         TO DP013-MESSAGE-TEXT (3)      39710000
397200         MOVE SQLCA                TO DP013-SQLCA                 39720000
397300         MOVE 'TMDSEAR'            TO DP013-DB2-TABLE-NAME (1)    39730000
397400         SET DP013-DB2-ABEND                                      39740000
397500             DP013-XCTL-DISPLAY-RESTART                           39750000
397600                                   TO TRUE                        39760000
397700         PERFORM DP013-0000-PROCESS-ABEND                         39770000
397800     END-IF.                                                      39780000
397900                                                                  39790000
398000 3322-SELECT-TORGUNT.                                             39800000
398100                                                                  39810000
398200     PERFORM                                                      39820000
398300         WITH TEST AFTER                                          39830000
398400         VARYING PV-RETRY-COUNTER                                 39840000
398500         FROM 1 BY 1                                              39850000
398600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39860000
398700                   OR (SQLCODE = ZERO)                            39870000
398800                   OR (SQLCODE = +100))                           39880000
398900                                                                  39890000
399000         EXEC SQL                                                 39900000
399100                 SELECT ORGUNT_NICK_NAME                          39910000
399200                   INTO :ORGUNT-ORGUNT-NICK-NAME                  39920000
399300                   FROM TORGUNT                                   39930000
399400                  WHERE ORGUNT_NICK_NAME = :ASC-DPTE-NBR          39940000
399500                    AND ORGUNT_TYP_CDE   = '01'                   39950000
399600         END-EXEC                                                 39960000
399700                                                                  39970000
399800         EVALUATE TRUE                                            39980000
399900             WHEN SQLCODE = ZERO                                  39990000
400000             WHEN SQLCODE = +100                                  40000000
400100             WHEN SQLCODE = -904                                  40010000
400200             WHEN SQLCODE = -913                                  40020000
400300                  CONTINUE                                        40030000
400400                                                                  40040000
400500             WHEN SQLWARN0 NOT = SPACES                           40050000
400600             WHEN SQLCODE < ZERO                                  40060000
400700             WHEN SQLCODE > ZERO                                  40070000
400800                  MOVE '3322-SELECT-TORGUNT'                      40080000
400900                                    TO DP013-PARAGRAPH            40090000
401000                  MOVE 'SELECT EXPENSE DEPT:'                     40100000
401100                                    TO DP013-MESSAGE-TEXT (1)     40110000
401200                  MOVE ASC-DPTE-NBR                               40120000
401300                                    TO DP013-MESSAGE-TEXT (2)     40130000
401400                  MOVE SQLCA        TO DP013-SQLCA                40140000
401500                  MOVE 'TORGUNT'    TO DP013-DB2-TABLE-NAME (1)   40150000
401600                  SET DP013-DB2-ABEND                             40160000
401700                      DP013-XCTL-DISPLAY-RESTART TO TRUE          40170000
401800                  PERFORM DP013-0000-PROCESS-ABEND                40180000
401900         END-EVALUATE                                             40190000
402000     END-PERFORM.                                                 40200000
402100                                                                  40210000
402200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         40220000
402300         MOVE '3322-SELECT-TORGUNT'                               40230000
402400                                   TO DP013-PARAGRAPH             40240000
402500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     40250000
402600                                   TO DP013-MESSAGE-TEXT (1)      40260000
402700         MOVE 'EXPENSE DEPARTMENT:'                               40270000
402800                                   TO DP013-MESSAGE-TEXT (2)      40280000
402900         MOVE ASC-DPTE-NBR         TO DP013-MESSAGE-TEXT (3)      40290000
403000         MOVE SQLCA                TO DP013-SQLCA                 40300000
403100         MOVE 'TORGUNT'            TO DP013-DB2-TABLE-NAME (1)    40310000
403200         SET DP013-DB2-ABEND                                      40320000
403300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   40330000
403400         PERFORM DP013-0000-PROCESS-ABEND                         40340000
403500     END-IF.                                                      40350000
403600                                                                  40360000
403700******************************************************************40370000
403800* SELECT ON THE TVNDDPT TABLE TO VERIFY THAT THE INHOUSE DOES    *40380000
403900* NOT ALREADY EXIST.                                             *40390000
404000******************************************************************40400000
404100 3330-SELECT-TVNDDPT.                                             40410000
404200                                                                  40420000
404300     PERFORM                                                      40430000
404400         WITH TEST AFTER                                          40440000
404500         VARYING PV-RETRY-COUNTER                                 40450000
404600         FROM 1 BY 1                                              40460000
404700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40470000
404800                   OR (SQLCODE = ZERO)                            40480000
404900                   OR (SQLCODE = +100))                           40490000
405000                                                                  40500000
405100         EXEC SQL                                                 40510000
405200             SELECT ENT_ID                                        40520000
405300             INTO  :VNDDPT-ENT-ID                                 40530000
405400             FROM TVNDDPT                                         40540000
405500             WHERE DEPT_NBR = :ASC-DEPT-NBR                       40550000
405600               AND INHOUSE_NBR  = :VNDDPT-INHOUSE-NBR             40560000
405700         END-EXEC                                                 40570000
405800                                                                  40580000
405900         EVALUATE TRUE                                            40590000
406000             WHEN SQLCODE = ZERO                                  40600000
406100             WHEN SQLCODE = +100                                  40610000
406200             WHEN SQLCODE = -904                                  40620000
406300             WHEN SQLCODE = -913                                  40630000
406400                 CONTINUE                                         40640000
406500             WHEN SQLWARN0 NOT = SPACES                           40650000
406600             WHEN SQLCODE < ZERO                                  40660000
406700             WHEN SQLCODE > ZERO                                  40670000
406800                 MOVE '3330-SELECT-TVNDDPT'                       40680000
406900                                   TO DP013-PARAGRAPH             40690000
407000                 MOVE 'SELECT VENDOR DEPARTMENT'                  40700000
407100                                   TO DP013-MESSAGE-TEXT (1)      40710000
407200                 MOVE SQLCA        TO DP013-SQLCA                 40720000
407300                 MOVE 'TVNDDPT'    TO DP013-DB2-TABLE-NAME (1)    40730000
407400                 SET DP013-DB2-ABEND                              40740000
407500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40750000
407600                 PERFORM DP013-0000-PROCESS-ABEND                 40760000
407700         END-EVALUATE                                             40770000
407800     END-PERFORM.                                                 40780000
407900                                                                  40790000
408000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40800000
408100         MOVE '3330-SELECT-TVNDDPT'                               40810000
408200                                   TO DP013-PARAGRAPH             40820000
408300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     40830000
408400                                   TO DP013-MESSAGE-TEXT (1)      40840000
408500         MOVE 'VENDOR DEPARTMENT'                                 40850000
408600                                   TO DP013-MESSAGE-TEXT (2)      40860000
408700         MOVE SQLCA                TO DP013-SQLCA                 40870000
408800         MOVE 'TVNDDPT'            TO DP013-DB2-TABLE-NAME (1)    40880000
408900         SET DP013-DB2-ABEND                                      40890000
409000             DP013-XCTL-DISPLAY-RESTART                           40900000
409100                                   TO TRUE                        40910000
409200         PERFORM DP013-0000-PROCESS-ABEND                         40920000
409300     END-IF.                                                      40930000
409400 EJECT                                                            40940000
409500                                                                  40950000
409600*----------------------------------------------------------------*40960000
409700*  CHECK FOR DUPLICATE SCAC.                                      40970000
409800*----------------------------------------------------------------*40980000
409900 3350-SELECT-TEXTENT-SCAC-CDE.                                    40990000
410000     PERFORM                                                      41000000
410100         WITH TEST AFTER                                          41010000
410200         VARYING PV-RETRY-COUNTER                                 41020000
410300         FROM 1 BY 1                                              41030000
410400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41040000
410500                   OR (SQLCODE = ZERO)                            41050000
410600                   OR (SQLCODE = +100))                           41060000
410700                                                                  41070000
410800         EXEC SQL                                                 41080000
410900             SELECT                                               41090000
411000                 ENT_ID                                           41100000
411100             INTO                                                 41110000
411200                 :EXTENT-ENT-ID                                   41120000
411300             FROM TEXTENT                                         41130000
411400             WHERE                                                41140000
411500                SCAC_CDE = :ASC-SCAC-CDE                          41150000
411600         END-EXEC                                                 41160000
411700                                                                  41170000
411800         EVALUATE TRUE                                            41180000
411900             WHEN SQLCODE = ZERO                                  41190000
412000             WHEN SQLCODE = +100                                  41200000
412100             WHEN SQLCODE = -904                                  41210000
412200             WHEN SQLCODE = -913                                  41220000
412300                 CONTINUE                                         41230000
412400             WHEN SQLWARN0 NOT = SPACES                           41240000
412500             WHEN SQLCODE < ZERO                                  41250000
412600             WHEN SQLCODE > ZERO                                  41260000
412700                 MOVE '3350-SELECT-TEXTENT-SCAC'                  41270000
412800                                   TO DP013-PARAGRAPH             41280000
412900                 MOVE 'SELECT ENTERPRISE FOR SCAC:'               41290000
413000                                   TO DP013-MESSAGE-TEXT (1)      41300000
413100                 MOVE ASC-SCAC-CDE                                41310000
413200                                   TO DP013-MESSAGE-TEXT (2)      41320000
413300                 MOVE SQLCA        TO DP013-SQLCA                 41330000
413400                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    41340000
413500                 SET DP013-DB2-ABEND                              41350000
413600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           41360000
413700                 PERFORM DP013-0000-PROCESS-ABEND                 41370000
413800         END-EVALUATE                                             41380000
413900     END-PERFORM.                                                 41390000
414000                                                                  41400000
414100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        41410000
414200         MOVE '3350-SELECT-TEXTENT-SCAC'                          41420000
414300                                   TO DP013-PARAGRAPH             41430000
414400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     41440000
414500                                   TO DP013-MESSAGE-TEXT (1)      41450000
414600         MOVE 'ENTERPRISE FOR SCAC: '                             41460000
414700                                   TO DP013-MESSAGE-TEXT (2)      41470000
414800         MOVE ASC-SCAC-CDE         TO DP013-MESSAGE-TEXT (3)      41480000
414900         MOVE SQLCA                TO DP013-SQLCA                 41490000
415000         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    41500000
415100         SET DP013-DB2-ABEND                                      41510000
415200             DP013-XCTL-DISPLAY-RESTART                           41520000
415300                                   TO TRUE                        41530000
415400         PERFORM DP013-0000-PROCESS-ABEND                         41540000
415500     END-IF.                                                      41550000
415600                                                                  41560000
415700*----------------------------------------------------------------*41570000
415800*  CHECK TEXTENT FOR THE NDA IND VALUE                            41580000
415900*----------------------------------------------------------------*41590000
416000 3400-CHECK-NDA-IND-ON-TABLE.                                     41600000
416100                                                                  41610000
416200     EXEC SQL                                                     41620000
416300       SELECT NDA_IND                                             41630000
416400             ,NDA_BEG_DTE                                         41640000
416500             ,NDA_END_DTE                                         41650000
416600         INTO :PV-EXTENT-NDA-IND                                  41660000
416700             ,:PV-EXTENT-NDA-BEG-DTE                              41670000
416800             ,:PV-EXTENT-NDA-END-DTE                              41680000
416900         FROM TEXTENT                                             41690000
417000        WHERE ENT_ID       = :ASC-ENT-ID                          41700000
417100     END-EXEC.                                                    41710000
417200                                                                  41720000
417300     EVALUATE TRUE                                                41730000
417400         WHEN SQLCODE = +0                                        41740000
417500              CONTINUE                                            41750000
417600         WHEN SQLCODE = +100                                      41760000
417700              MOVE 'N' TO PV-EXTENT-NDA-IND                       41770000
417800         WHEN SQLWARN0 NOT = SPACES                               41780000
417900         WHEN SQLCODE < ZERO                                      41790000
418000         WHEN SQLCODE > ZERO                                      41800000
418100             MOVE '3400-CHECK-NDA-IND-ON-TABLE  '                 41810000
418200                               TO DP013-PARAGRAPH                 41820000
418300             MOVE 'SELECT FOR NDA IND '                           41830000
418400                               TO DP013-MESSAGE-TEXT (1)          41840000
418500             MOVE SPACES       TO DP013-MESSAGE-TEXT (2)          41850000
418600             MOVE SQLCA        TO DP013-SQLCA                     41860000
418700             MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)        41870000
418800             SET DP013-DB2-ABEND                                  41880000
418900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41890000
419000             PERFORM DP013-0000-PROCESS-ABEND                     41900000
419100     END-EVALUATE.                                                41910000
419200                                                                  41920000
419300                                                                  41930000
419400*----------------------------------------------------------------*41940000
419500*  CHECK TEXTENT FOR THE PREPACK IND VALUE                        41950000
419600*----------------------------------------------------------------*41960000
419700 3500-CHECK-PREPK-IND-ON-TABLE.                                   41970000
419800                                                                  41980000
419900     EXEC SQL                                                     41990000
420000       SELECT EDI_PO_PREPK_CDE                                    42000000
420100         INTO :PV-EXTENT-PREPACK-IND                              42010000
420200         FROM TEXTENT                                             42020000
420300        WHERE ENT_ID       = :ASC-ENT-ID                          42030000
420400     END-EXEC.                                                    42040000
420500                                                                  42050000
420600     EVALUATE TRUE                                                42060000
420700         WHEN SQLCODE = +0                                        42070000
420800              CONTINUE                                            42080000
420900         WHEN SQLCODE = +100                                      42090000
421000              MOVE 'N' TO PV-EXTENT-PREPACK-IND                   42100000
421100         WHEN SQLWARN0 NOT = SPACES                               42110000
421200         WHEN SQLCODE < ZERO                                      42120000
421300         WHEN SQLCODE > ZERO                                      42130000
421400             MOVE '3500-CHECK-PREPK-IND-ON-TABLE  '               42140000
421500                               TO DP013-PARAGRAPH                 42150000
421600             MOVE 'SELECT FOR PREPACK IND '                       42160000
421700                               TO DP013-MESSAGE-TEXT (1)          42170000
421800             MOVE SPACES       TO DP013-MESSAGE-TEXT (2)          42180000
421900             MOVE SQLCA        TO DP013-SQLCA                     42190000
422000             MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)        42200000
422100             SET DP013-DB2-ABEND                                  42210000
422200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42220000
422300             PERFORM DP013-0000-PROCESS-ABEND                     42230000
422400     END-EVALUATE.                                                42240000
422500                                                                  42250000
422600                                                                  42260000
422700 EJECT                                                            42270000
422800*----------------------------------------------------------------*42280000
422900*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *42290000
423000*    ENTRY.                                                      *42300000
423100*----------------------------------------------------------------*42310000
423200 4000-BUILD-INITIAL-PANEL.                                        42320000
423300                                                                  42330000
423400     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       42340000
423500     MOVE -1                       TO AVNNAMEL.                   42350000
423600                                                                  42360000
423700     EVALUATE ASC-INT-APPL-FORMAT-IND                             42370000
423800         WHEN PC-INTER-APPL-ADD                                   42380000
423900             MOVE SPACES TO ASC-VEND-NAME                         42390000
424000                            ASC-VEND-SNME                         42400000
424100                            ASC-STATUS-CDE                        42410000
424200                            ASC-DUN-NBR                           42420000
424300                            ASC-PARENT-NAME                       42430000
424400                            ASC-HLD-PAYT-IND                      42440000
424500                            ASC-VND-USING-FACTOR                  42450000
424600                            ASC-SEPERATE-PYMTS                    42460000
424700                            ASC-PREPACK-EDI-CDE                   42470000
424800                            ASC-PRIMARY-TYPE                      42480000
424900                            ASC-PRIMARY-DESC                      42490000
425000                            ASC-PARTNER-IND                       42500000
425100                            ASC-PARTNER-TYPE                      42510000
425200                            ASC-PARTNER-DESC                      42520000
425300                            ASC-DEPT-NBR                          42530000
425400                            ASC-INHOUSE-NBR                       42540000
425500                            ASC-SCAC-CDE                          42550000
425600                            ASC-CARR-MAN-PRO-IND                  42560000
425700                            ASC-CAP-EXP-CDE                       42570000
425800                            ASC-DPTE-NBR                          42580000
425900                            ASC-VND-CLSN-CDE                      42590000
426000                            ASC-VND-PRSST-CDE                     42600000
426100                            ASC-1099-NEEDED                       42610000
426200*                           ASC-FED-TX-ID-TYP-CDE                 42620000
426300*                           ASC-FED-TX-ID-NBR                     42630000
426400                            ASC-WITHHOLD-CDE                      42640000
426500                            ASC-PRNT-CO-IND                       42650000
426600                            ASC-PAY-HNDLNG-CDE                    42660000
426700                            ASC-LINE-OF-CREDIT-X                  42670000
426800                            ASC-FACT-CAPACITY-X                   42680000
426900                            ASC-NDA-IND                           42690000
427000             MOVE ZEROES TO ASC-VND-ENT-ID                        42700000
427100                            ASC-PARENT-VENDOR-NBR                 42710000
427200                                                                  42720000
427300             SET ASC-ADD-MDEPT                                    42730000
427400                 ASC-ADD-EDEPT TO TRUE                            42740000
427500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 42750000
427600                                                                  42760000
427700         WHEN PC-INTER-APPL-UP-CRIT                               42770000
427800             IF ASC-KEY-VEND-NAME > SPACES                        42780000
427900                 PERFORM 4101-GET-ENT-VIA-NAME                    42790000
428000                 IF SQLCODE = ZERO                                42800000
428100                     PERFORM 4200-GET-VENDOR-VIA-ENT              42810000
428200                 END-IF                                           42820000
428300             ELSE                                                 42830000
428400                 IF ASC-KEY-DUNS > SPACES                         42840000
428500                     PERFORM 4102-GET-ENT-VIA-DUNS                42850000
428600                     IF SQLCODE = ZERO                            42860000
428700                         PERFORM 4200-GET-VENDOR-VIA-ENT          42870000
428800                     END-IF                                       42880000
428900                 ELSE                                             42890000
429000                     IF SQLCODE = ZERO                            42900000
429100                         PERFORM 4200-GET-VENDOR-VIA-ENT          42910000
429200                     END-IF                                       42920000
429300                 END-IF                                           42930000
429400             END-IF                                               42940000
429500             MOVE ENTNME-ENT-NAME-DESC                            42950000
429600                         TO ASC-VEND-NAME                         42960000
429700             MOVE EXTENT-STATUS-CDE                               42970000
429800                         TO ASC-STATUS-CDE                        42980000
429900             MOVE EXTENT-DUN-NBR                                  42990000
430000                         TO ASC-DUN-NBR                           43000000
430100             MOVE EXTENT-HLD-PAYT-IND                             43010000
430200                         TO ASC-HLD-PAYT-IND                      43020000
430300             MOVE EXTENT-PAY-FCTR-VND-IND                         43030000
430400                         TO ASC-VND-USING-FACTOR                  43040000
430500             MOVE EXTENT-NDA-IND                                  43050000
430600                         TO ASC-NDA-IND                           43060000
430700             MOVE EXTENT-SEPR-INVC-PAYT-IND                       43070000
430800                         TO ASC-SEPERATE-PYMTS                    43080000
430900             MOVE EXTENT-EDI-PO-PREPK-CDE                         43090000
431000                         TO ASC-PREPACK-EDI-CDE                   43100000
431100*            MOVE EXTENT-MDSE-VENDOR-IND                          43110000
431200*                        TO ASC-MDSE-IND                          43120000
431300*            MOVE EXTENT-SHIP-INSTR-REQD                          43130000
431400*                        TO ASC-DC-SPLIT-IND                      43140000
431500*            MOVE EXTENT-SHIP-INSTR-LT-QTY                        43150000
431600*                        TO ASC-DC-SPLIT-LEAD-N                   43160000
431700                                                                  43170000
431800*            MOVE EXTENT-IMPRT-IND                                43180000
431900*                        TO ASC-IMPORT-IND                        43190000
432000                                                                  43200000
432100*            MOVE EXTENT-CARRIER-IND                              43210000
432200*                        TO ASC-CARRIER-IND                       43220000
432300             MOVE EXTENT-SCAC-CDE                                 43230000
432400                         TO ASC-SCAC-CDE                          43240000
432500             MOVE EXTENT-CARR-MAN-PRO-IND                         43250000
432600                         TO ASC-CARR-MAN-PRO-IND                  43260000
432700*            MOVE EXTENT-EXP-VEND-IND                             43270000
432800*                        TO ASC-EXPENSE-IND                       43280000
432900             MOVE EXTENT-CAP-EXP-CDE                              43290000
433000                         TO ASC-CAP-EXP-CDE                       43300000
433100             MOVE EXTENT-VND-CLSN-CDE                             43310000
433200                         TO ASC-VND-CLSN-CDE                      43320000
433300             MOVE EXTENT-VND-PRSST-CDE                            43330000
433400                         TO ASC-VND-PRSST-CDE                     43340000
433500             MOVE EXTENT-NEED-1099-IND                            43350000
433600                         TO ASC-1099-NEEDED                       43360000
433700*            MOVE EXTENT-FED-TX-ID-TYP-CDE                        43370000
433800*                        TO ASC-FED-TX-ID-TYP-CDE                 43380000
433900*            MOVE EXTENT-FED-TX-ID-NBR                            43390000
434000*                        TO ASC-FED-TX-ID-NBR                     43400000
434100             MOVE EXTENT-WHLDG-PAYT-TYP-CDE                       43410000
434200                         TO ASC-WITHHOLD-CDE                      43420000
434300*            MOVE EXTENT-FCTR-IND                                 43430000
434400*                        TO ASC-FCTR-IND                          43440000
434500             MOVE EXTENT-PRNT-CO-IND                              43450000
434600                         TO ASC-PRNT-CO-IND                       43460000
434700             MOVE EXTENT-PAYT-HNDLG-CDE                           43470000
434800                         TO ASC-PAY-HNDLNG-CDE                    43480000
434900             MOVE ASC-ENT-ID          TO PV-ENT-ID                43490000
435000             MOVE PV-ENT-ID                                       43500000
435100                         TO ASC-VND-ENT-ID                        43510000
435200             MOVE EXTENT-PRTNR-IND                                43520000
435300                         TO ASC-PARTNER-IND                       43530000
435400             MOVE EXTENT-PRTNR-TYP-CDE                            43540000
435500                         TO ASC-PARTNER-TYPE                      43550000
435600             EVALUATE TRUE                                        43560000
435700                WHEN  ASC-PARTNER-TYPE = 'AG'                     43570000
435800                      MOVE 'AGENT'       TO ASC-PARTNER-DESC      43580000
435900                WHEN  ASC-PARTNER-TYPE = 'BK'                     43590000
436000                      MOVE 'BANK'        TO ASC-PARTNER-DESC      43600000
436100                WHEN  ASC-PARTNER-TYPE = 'BR'                     43610000
436200                      MOVE 'BROKER'      TO ASC-PARTNER-DESC      43620000
436300                WHEN  ASC-PARTNER-TYPE = 'CL'                     43630000
436400                      MOVE 'CARTON LABEL MAKER'                   43640000
436500                                         TO ASC-PARTNER-DESC      43650000
436600                WHEN  ASC-PARTNER-TYPE = 'CO'                     43660000
436700                      MOVE 'CONSOLIDATOR' TO ASC-PARTNER-DESC     43670000
436800                WHEN  ASC-PARTNER-TYPE = 'CR'                     43680000
436900                      MOVE 'CARRIER'     TO ASC-PARTNER-DESC      43690000
437000                WHEN  ASC-PARTNER-TYPE = 'DE'                     43700000
437100                      MOVE 'DECONSOLIDATOR' TO ASC-PARTNER-DESC   43710000
437200                WHEN  ASC-PARTNER-TYPE = 'FA'                     43720000
437300                      MOVE 'FACTORY'     TO ASC-PARTNER-DESC      43730000
437400                WHEN  ASC-PARTNER-TYPE = 'FF'                     43740000
437500                    MOVE 'FREIGHT FORWARDER' TO ASC-PARTNER-DESC  43750000
437600                WHEN  ASC-PARTNER-TYPE = 'OP'                     43760000
437700                    MOVE 'OFFICE OF PLACEMENT' TO ASC-PARTNER-DESC43770000
437800                WHEN  ASC-PARTNER-TYPE = 'S1'                     43780000
437900                    MOVE 'MAKER' TO ASC-PARTNER-DESC              43790000
438000                WHEN  ASC-PARTNER-TYPE = 'S2'                     43800000
438100                    MOVE 'IMPORT PARENT CO' TO ASC-PARTNER-DESC   43810000
438200                WHEN  ASC-PARTNER-TYPE = 'TM'                     43820000
438300                    MOVE 'TICKET MAKER' TO ASC-PARTNER-DESC       43830000
438400                WHEN  OTHER                                       43840000
438500                    MOVE '       '      TO ASC-PARTNER-DESC       43850000
438600             END-EVALUATE                                         43860000
438700             IF EXTENT-LNE-OF-CR-AMT NUMERIC                      43870000
438800                IF ASC-PARTNER-TYPE = 'FA'                        43880000
438900                   MOVE EXTENT-LNE-OF-CR-AMT                      43890000
439000                               TO ASC-FACT-CAPACITY               43900000
439100                   MOVE ZEROES TO ASC-LINE-OF-CREDIT              43910000
439200                ELSE                                              43920000
439300                   MOVE EXTENT-LNE-OF-CR-AMT                      43930000
439400                               TO ASC-LINE-OF-CREDIT              43940000
439500                   MOVE ZEROES TO ASC-FACT-CAPACITY               43950000
439600                END-IF                                            43960000
439700             ELSE                                                 43970000
439800                MOVE ZEROES TO ASC-LINE-OF-CREDIT                 43980000
439900                               ASC-FACT-CAPACITY                  43990000
440000                               EXTENT-LNE-OF-CR-AMT               44000000
440100             END-IF                                               44010000
440200             MOVE EXTENT-PRIM-TYP-CDE                             44020000
440300                         TO ASC-PRIMARY-TYPE                      44030000
440400             EVALUATE TRUE                                        44040000
440500                WHEN  ASC-PRIMARY-TYPE = 'M'                      44050000
440600                      MOVE 'MERCHANDISE' TO ASC-PRIMARY-DESC      44060000
440700                      SET ASC-NO-MDEPT                            44070000
440800                          ASC-ADD-EDEPT TO TRUE                   44080000
440900                WHEN  ASC-PRIMARY-TYPE = 'E'                      44090000
441000                      MOVE 'EXPENSE'     TO ASC-PRIMARY-DESC      44100000
441100                      SET ASC-ADD-MDEPT                           44110000
441200                          ASC-NO-EDEPT  TO TRUE                   44120000
441300                WHEN  OTHER                                       44130000
441400                      MOVE 'FACTOR'      TO ASC-PRIMARY-DESC      44140000
441500                      SET ASC-ADD-EDEPT                           44150000
441600                          ASC-ADD-MDEPT TO TRUE                   44160000
441700             END-EVALUATE                                         44170000
441800             IF ASC-DUN-NBR > SPACES                              44180000
441900                 SET ASC-VNDR-NBR-POPULATED TO TRUE               44190000
442000             ELSE                                                 44200000
442100                 SET ASC-VNDR-NBR-NOT-POPULATED TO TRUE           44210000
442200             END-IF                                               44220000
442300                                                                  44230000
442400             IF SQLCODE = ZERO                                    44240000
442500                 PERFORM 4300-GET-VEND-SHORT-NAME                 44250000
442600                 MOVE PV-ENT-SNAME-DESC                           44260000
442700                         TO ASC-VEND-SNME                         44270000
442800                 IF EXTENT-PRNT-CO-ENT-ID > ZEROES                44280000
442900                     PERFORM 4310-GET-VEND-PARENT-NAME            44290000
443000                 ELSE                                             44300000
443100                     MOVE SPACES TO ASC-PARENT-NAME               44310000
443200                                    ASC-PARENT-VENDOR-NBR         44320000
443300                 END-IF                                           44330000
443400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             44340000
443500                 MOVE ZERO TO SQLCODE                             44350000
443600             END-IF                                               44360000
443700                                                                  44370000
443800         WHEN PC-INTER-APPL-UP-LIST                               44380000
443900             PERFORM 4200-GET-VENDOR-VIA-ENT                      44390000
444000                                                                  44400000
444100             MOVE ENTNME-ENT-NAME-DESC                            44410000
444200                         TO ASC-VEND-NAME                         44420000
444300             MOVE EXTENT-STATUS-CDE                               44430000
444400                         TO ASC-STATUS-CDE                        44440000
444500             MOVE EXTENT-DUN-NBR                                  44450000
444600                         TO ASC-DUN-NBR                           44460000
444700             MOVE EXTENT-HLD-PAYT-IND                             44470000
444800                         TO ASC-HLD-PAYT-IND                      44480000
444900             MOVE EXTENT-PAY-FCTR-VND-IND                         44490000
445000                         TO ASC-VND-USING-FACTOR                  44500000
445100             MOVE EXTENT-NDA-IND                                  44510000
445200                         TO ASC-NDA-IND                           44520000
445300             MOVE EXTENT-SEPR-INVC-PAYT-IND                       44530000
445400                         TO ASC-SEPERATE-PYMTS                    44540000
445500             MOVE EXTENT-EDI-PO-PREPK-CDE                         44550000
445600                         TO ASC-PREPACK-EDI-CDE                   44560000
445700*            MOVE EXTENT-MDSE-VENDOR-IND                          44570000
445800*                        TO ASC-MDSE-IND                          44580000
445900*            MOVE EXTENT-SHIP-INSTR-REQD                          44590000
446000*                        TO ASC-DC-SPLIT-IND                      44600000
446100*            MOVE EXTENT-SHIP-INSTR-LT-QTY                        44610000
446200*                        TO ASC-DC-SPLIT-LEAD-N                   44620000
446300                                                                  44630000
446400*            MOVE EXTENT-IMPRT-IND                                44640000
446500*                        TO ASC-IMPORT-IND                        44650000
446600                                                                  44660000
446700*            MOVE EXTENT-CARRIER-IND                              44670000
446800*                        TO ASC-CARRIER-IND                       44680000
446900             MOVE EXTENT-SCAC-CDE                                 44690000
447000                         TO ASC-SCAC-CDE                          44700000
447100             MOVE EXTENT-CARR-MAN-PRO-IND                         44710000
447200                         TO ASC-CARR-MAN-PRO-IND                  44720000
447300*            MOVE EXTENT-EXP-VEND-IND                             44730000
447400*                        TO ASC-EXPENSE-IND                       44740000
447500             MOVE EXTENT-CAP-EXP-CDE                              44750000
447600                         TO ASC-CAP-EXP-CDE                       44760000
447700             MOVE EXTENT-VND-CLSN-CDE                             44770000
447800                         TO ASC-VND-CLSN-CDE                      44780000
447900             MOVE EXTENT-VND-PRSST-CDE                            44790000
448000                         TO ASC-VND-PRSST-CDE                     44800000
448100             MOVE EXTENT-NEED-1099-IND                            44810000
448200                         TO ASC-1099-NEEDED                       44820000
448300*            MOVE EXTENT-FED-TX-ID-TYP-CDE                        44830000
448400*                        TO ASC-FED-TX-ID-TYP-CDE                 44840000
448500*            MOVE EXTENT-FED-TX-ID-NBR                            44850000
448600*                        TO ASC-FED-TX-ID-NBR                     44860000
448700             MOVE EXTENT-WHLDG-PAYT-TYP-CDE                       44870000
448800                         TO ASC-WITHHOLD-CDE                      44880000
448900*            MOVE EXTENT-FCTR-IND                                 44890000
449000*                        TO ASC-FCTR-IND                          44900000
449100             MOVE EXTENT-PRNT-CO-IND                              44910000
449200                         TO ASC-PRNT-CO-IND                       44920000
449300             MOVE EXTENT-PAYT-HNDLG-CDE                           44930000
449400                         TO ASC-PAY-HNDLNG-CDE                    44940000
449500             MOVE ASC-ENT-ID          TO PV-ENT-ID                44950000
449600             MOVE PV-ENT-ID                                       44960000
449700                         TO ASC-VND-ENT-ID                        44970000
449800             MOVE EXTENT-PRTNR-IND                                44980000
449900                         TO ASC-PARTNER-IND                       44990000
450000             MOVE EXTENT-PRTNR-TYP-CDE                            45000000
450100                         TO ASC-PARTNER-TYPE                      45010000
450200             EVALUATE TRUE                                        45020000
450300                WHEN  ASC-PARTNER-TYPE = 'AG'                     45030000
450400                      MOVE 'AGENT'       TO ASC-PARTNER-DESC      45040000
450500                WHEN  ASC-PARTNER-TYPE = 'BK'                     45050000
450600                      MOVE 'BANK'        TO ASC-PARTNER-DESC      45060000
450700                WHEN  ASC-PARTNER-TYPE = 'BR'                     45070000
450800                      MOVE 'BROKER'      TO ASC-PARTNER-DESC      45080000
450900                WHEN  ASC-PARTNER-TYPE = 'CO'                     45090000
451000                      MOVE 'CONSOLIDATOR' TO ASC-PARTNER-DESC     45100000
451100                WHEN  ASC-PARTNER-TYPE = 'CR'                     45110000
451200                      MOVE 'CARRIER'     TO ASC-PARTNER-DESC      45120000
451300                WHEN  ASC-PARTNER-TYPE = 'DE'                     45130000
451400                      MOVE 'DECONSOLIDATOR' TO ASC-PARTNER-DESC   45140000
451500                WHEN  ASC-PARTNER-TYPE = 'FA'                     45150000
451600                      MOVE 'FACTORY'     TO ASC-PARTNER-DESC      45160000
451700                WHEN  ASC-PARTNER-TYPE = 'FF'                     45170000
451800                    MOVE 'FREIGHT FORWARDER' TO ASC-PARTNER-DESC  45180000
451900                WHEN  ASC-PARTNER-TYPE = 'OP'                     45190000
452000                    MOVE 'OFFICE OF PLACEMENT' TO ASC-PARTNER-DESC45200000
452100                WHEN  ASC-PARTNER-TYPE = 'S1'                     45210000
452200                    MOVE 'MAKER       ' TO ASC-PARTNER-DESC       45220000
452300                WHEN  ASC-PARTNER-TYPE = 'S2'                     45230000
452400                    MOVE 'IMPORT PARENT CO' TO ASC-PARTNER-DESC   45240000
452500                WHEN  ASC-PARTNER-TYPE = 'TM'                     45250000
452600                    MOVE 'TICKET MAKER' TO ASC-PARTNER-DESC       45260000
452700                WHEN  OTHER                                       45270000
452800                    MOVE '       '      TO ASC-PARTNER-DESC       45280000
452900             END-EVALUATE                                         45290000
453000             IF EXTENT-LNE-OF-CR-AMT NUMERIC                      45300000
453100                IF ASC-PARTNER-TYPE = 'FA'                        45310000
453200                   MOVE EXTENT-LNE-OF-CR-AMT                      45320000
453300                               TO ASC-FACT-CAPACITY               45330000
453400                   MOVE ZEROES TO ASC-LINE-OF-CREDIT              45340000
453500                ELSE                                              45350000
453600                   MOVE EXTENT-LNE-OF-CR-AMT                      45360000
453700                               TO ASC-LINE-OF-CREDIT              45370000
453800                   MOVE ZEROES TO ASC-FACT-CAPACITY               45380000
453900                END-IF                                            45390000
454000             ELSE                                                 45400000
454100                MOVE ZEROES TO ASC-LINE-OF-CREDIT                 45410000
454200                               ASC-FACT-CAPACITY                  45420000
454300                               EXTENT-LNE-OF-CR-AMT               45430000
454400             END-IF                                               45440000
454500             MOVE EXTENT-PRIM-TYP-CDE                             45450000
454600                         TO ASC-PRIMARY-TYPE                      45460000
454700             EVALUATE TRUE                                        45470000
454800                WHEN  ASC-PRIMARY-TYPE = 'M'                      45480000
454900                      MOVE 'MERCHANDISE' TO ASC-PRIMARY-DESC      45490000
455000                      SET ASC-NO-MDEPT                            45500000
455100                          ASC-ADD-EDEPT TO TRUE                   45510000
455200                WHEN  ASC-PRIMARY-TYPE = 'E'                      45520000
455300                      MOVE 'EXPENSE'     TO ASC-PRIMARY-DESC      45530000
455400                      SET ASC-ADD-MDEPT                           45540000
455500                          ASC-NO-EDEPT  TO TRUE                   45550000
455600                WHEN  OTHER                                       45560000
455700                      MOVE 'FACTOR'      TO ASC-PRIMARY-DESC      45570000
455800                      SET ASC-ADD-EDEPT                           45580000
455900                          ASC-ADD-MDEPT TO TRUE                   45590000
456000             END-EVALUATE                                         45600000
456100             IF ASC-DUN-NBR > SPACES                              45610000
456200                 SET ASC-VNDR-NBR-POPULATED TO TRUE               45620000
456300             ELSE                                                 45630000
456400                 SET ASC-VNDR-NBR-NOT-POPULATED TO TRUE           45640000
456500             END-IF                                               45650000
456600                                                                  45660000
456700             IF SQLCODE = ZERO                                    45670000
456800                 PERFORM 4300-GET-VEND-SHORT-NAME                 45680000
456900                 IF EXTENT-PRNT-CO-ENT-ID > ZEROES                45690000
457000                     PERFORM 4310-GET-VEND-PARENT-NAME            45700000
457100                 ELSE                                             45710000
457200                     MOVE SPACES TO ASC-PARENT-NAME               45720000
457300                                    ASC-PARENT-VENDOR-NBR         45730000
457400                 END-IF                                           45740000
457500                 MOVE PV-ENT-SNAME-DESC                           45750000
457600                         TO ASC-VEND-SNME                         45760000
457700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             45770000
457800                 MOVE ZERO TO SQLCODE                             45780000
457900             END-IF                                               45790000
458000         END-EVALUATE.                                            45800000
458100                                                                  45810000
458200*----------------------------------------------------------------*45820000
458300* DETERMINE ENT-ID BASED ON KEYS PASSED.                         *45830000
458400*----------------------------------------------------------------*45840000
458500 4101-GET-ENT-VIA-NAME.                                           45850000
458600                                                                  45860000
458700     PERFORM                                                      45870000
458800         WITH TEST AFTER                                          45880000
458900         VARYING PV-RETRY-COUNTER                                 45890000
459000         FROM 1 BY 1                                              45900000
459100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45910000
459200                   OR (SQLCODE = ZERO)                            45920000
459300                   OR (SQLCODE = +100))                           45930000
459400                                                                  45940000
459500         EXEC SQL                                                 45950000
459600             SELECT B.ENT_ID                                      45960000
459700             INTO   :ASC-ENT-ID                                   45970000
459800             FROM   TEXTENT B,                                    45980000
459900                    TENTNME A                                     45990000
460000             WHERE  A.ENT_NAME_DESC = :ASC-KEY-VEND-NAME          46000000
460100               AND  B.ENT_ID   = A.ENT_ID                         46010000
460200         END-EXEC                                                 46020000
460300                                                                  46030000
460400         EVALUATE TRUE                                            46040000
460500             WHEN SQLCODE = ZERO                                  46050000
460600             WHEN SQLCODE = +100                                  46060000
460700             WHEN SQLCODE = -904                                  46070000
460800             WHEN SQLCODE = -913                                  46080000
460900                 CONTINUE                                         46090000
461000             WHEN SQLWARN0 NOT = SPACES                           46100000
461100             WHEN SQLCODE < ZERO                                  46110000
461200             WHEN SQLCODE > ZERO                                  46120000
461300                 MOVE '4101-GET-ENT-VIA-NAME'                     46130000
461400                                   TO DP013-PARAGRAPH             46140000
461500                 MOVE 'SELECT VENDOR'                             46150000
461600                                   TO DP013-MESSAGE-TEXT (1)      46160000
461700                 MOVE SQLCA        TO DP013-SQLCA                 46170000
461800                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    46180000
461900                 SET DP013-DB2-ABEND                              46190000
462000                     DP013-XCTL-DISPLAY-RESTART                   46200000
462100                                   TO TRUE                        46210000
462200                 PERFORM DP013-0000-PROCESS-ABEND                 46220000
462300         END-EVALUATE                                             46230000
462400     END-PERFORM.                                                 46240000
462500                                                                  46250000
462600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46260000
462700         MOVE '4101-GET-ENT-VIA-NAME'                             46270000
462800                                   TO DP013-PARAGRAPH             46280000
462900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46290000
463000                                   TO DP013-MESSAGE-TEXT (1)      46300000
463100         MOVE 'VENDOR       '      TO DP013-MESSAGE-TEXT (2)      46310000
463200         MOVE SQLCA                TO DP013-SQLCA                 46320000
463300         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    46330000
463400         SET DP013-DB2-ABEND                                      46340000
463500             DP013-XCTL-DISPLAY-RESTART                           46350000
463600                                   TO TRUE                        46360000
463700         PERFORM DP013-0000-PROCESS-ABEND                         46370000
463800     END-IF.                                                      46380000
463900                                                                  46390000
464000 4102-GET-ENT-VIA-DUNS.                                           46400000
464100                                                                  46410000
464200     PERFORM                                                      46420000
464300         WITH TEST AFTER                                          46430000
464400         VARYING PV-RETRY-COUNTER                                 46440000
464500         FROM 1 BY 1                                              46450000
464600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46460000
464700                   OR (SQLCODE = ZERO)                            46470000
464800                   OR (SQLCODE = +100))                           46480000
464900                                                                  46490000
465000         EXEC SQL                                                 46500000
465100             SELECT ENT_ID                                        46510000
465200             INTO   :ASC-ENT-ID                                   46520000
465300             FROM   TEXTENT                                       46530000
465400             WHERE  DUN_NBR  = :ASC-KEY-DUNS                      46540000
465500         END-EXEC                                                 46550000
465600                                                                  46560000
465700         EVALUATE TRUE                                            46570000
465800             WHEN SQLCODE = ZERO                                  46580000
465900             WHEN SQLCODE = +100                                  46590000
466000             WHEN SQLCODE = -904                                  46600000
466100             WHEN SQLCODE = -913                                  46610000
466200                 CONTINUE                                         46620000
466300             WHEN SQLWARN0 NOT = SPACES                           46630000
466400             WHEN SQLCODE < ZERO                                  46640000
466500             WHEN SQLCODE > ZERO                                  46650000
466600                 MOVE '4102-GET-ENT-VIA-DUNS'                     46660000
466700                                   TO DP013-PARAGRAPH             46670000
466800                 MOVE 'SELECT VENDOR'                             46680000
466900                                   TO DP013-MESSAGE-TEXT (1)      46690000
467000                 MOVE SQLCA        TO DP013-SQLCA                 46700000
467100                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    46710000
467200                 SET DP013-DB2-ABEND                              46720000
467300                     DP013-XCTL-DISPLAY-RESTART                   46730000
467400                                   TO TRUE                        46740000
467500                 PERFORM DP013-0000-PROCESS-ABEND                 46750000
467600         END-EVALUATE                                             46760000
467700     END-PERFORM.                                                 46770000
467800                                                                  46780000
467900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46790000
468000         MOVE '4102-GET-ENT-VIA-DUNS'                             46800000
468100                                   TO DP013-PARAGRAPH             46810000
468200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46820000
468300                                   TO DP013-MESSAGE-TEXT (1)      46830000
468400         MOVE 'VENDOR       '      TO DP013-MESSAGE-TEXT (2)      46840000
468500         MOVE SQLCA                TO DP013-SQLCA                 46850000
468600         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    46860000
468700         SET DP013-DB2-ABEND                                      46870000
468800             DP013-XCTL-DISPLAY-RESTART                           46880000
468900                                   TO TRUE                        46890000
469000         PERFORM DP013-0000-PROCESS-ABEND                         46900000
469100     END-IF.                                                      46910000
469200                                                                  46920000
469300*----------------------------------------------------------------*46930000
469400* SELECT A ROW FROM THE DB2 SYSTEM VENDOR TABLE.                 *46940000
469500*----------------------------------------------------------------*46950000
469600 4200-GET-VENDOR-VIA-ENT.                                         46960000
469700                                                                  46970000
469800     PERFORM                                                      46980000
469900         WITH TEST AFTER                                          46990000
470000         VARYING PV-RETRY-COUNTER                                 47000000
470100         FROM 1 BY 1                                              47010000
470200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47020000
470300                   OR (SQLCODE = ZERO)                            47030000
470400                   OR (SQLCODE = +100))                           47040000
470500                                                                  47050000
470600         EXEC SQL                                                 47060000
470700             SELECT B.ENT_NAME_DESC,                              47070000
470800                    A.STATUS_CDE,                                 47080000
470900                    A.DUN_NBR,                                    47090000
471000                    A.PRNT_CO_ENT_ID,                             47100000
471100                    A.SCAC_CDE,                                   47110000
471200                    A.CARR_MAN_PRO_IND,                           47120000
471300                    A.CAP_EXP_CDE,                                47130000
471400                    A.VND_CLSN_CDE,                               47140000
471500                    A.VND_PRSST_CDE,                              47150000
471600                    A.NEED_1099_IND,                              47160000
471700*                   A.FED_TX_ID_TYP_CDE,                          47170000
471800*                   A.FED_TX_ID_NBR,                              47180000
471900                    A.PRNT_CO_IND,                                47190000
472000                    A.HLD_PAYT_IND,                               47200000
472100                    A.PAY_FCTR_VND_IND,                           47210000
472200                    A.SEPR_INVC_PAYT_IND,                         47220000
472300                    A.WHLDG_PAYT_TYP_CDE,                         47230000
472400                    A.PAYT_HNDLG_CDE,                             47240000
472500                    A.EDI_PO_PREPK_CDE,                           47250000
472600                    A.PRIM_TYP_CDE,                               47260000
472700                    A.PRTNR_IND,                                  47270000
472800                    A.PRTNR_TYP_CDE,                              47280000
472900                    A.LNE_OF_CR_AMT,                              47290000
473000                    A.NDA_IND,                                    47300000
473100                    A.NDA_BEG_DTE,                                47310000
473200                    A.NDA_END_DTE                                 47320000
473300             INTO   :ENTNME-ENT-NAME-DESC,                        47330000
473400                    :EXTENT-STATUS-CDE,                           47340000
473500                    :EXTENT-DUN-NBR,                              47350000
473600                    :EXTENT-PRNT-CO-ENT-ID,                       47360000
473700                    :EXTENT-SCAC-CDE,                             47370000
473800                    :EXTENT-CARR-MAN-PRO-IND,                     47380000
473900                    :EXTENT-CAP-EXP-CDE,                          47390000
474000                    :EXTENT-VND-CLSN-CDE,                         47400000
474100                    :EXTENT-VND-PRSST-CDE,                        47410000
474200                    :EXTENT-NEED-1099-IND,                        47420000
474300*                   :EXTENT-FED-TX-ID-TYP-CDE,                    47430000
474400*                   :EXTENT-FED-TX-ID-NBR,                        47440000
474500                    :EXTENT-PRNT-CO-IND,                          47450000
474600                    :EXTENT-HLD-PAYT-IND,                         47460000
474700                    :EXTENT-PAY-FCTR-VND-IND,                     47470000
474800                    :EXTENT-SEPR-INVC-PAYT-IND,                   47480000
474900                    :EXTENT-WHLDG-PAYT-TYP-CDE,                   47490000
475000                    :EXTENT-PAYT-HNDLG-CDE,                       47500000
475100                    :EXTENT-EDI-PO-PREPK-CDE,                     47510000
475200                    :EXTENT-PRIM-TYP-CDE,                         47520000
475300                    :EXTENT-PRTNR-IND,                            47530000
475400                    :EXTENT-PRTNR-TYP-CDE,                        47540000
475500                    :EXTENT-LNE-OF-CR-AMT,                        47550000
475600                    :EXTENT-NDA-IND,                              47560000
475700                    :EXTENT-NDA-BEG-DTE,                          47570000
475800                    :EXTENT-NDA-END-DTE                           47580000
475900             FROM   TEXTENT A,                                    47590000
476000                    TENTNME B                                     47600000
476100             WHERE  A.ENT_ID   = :ASC-ENT-ID                      47610000
476200               AND  B.ENT_ID   = A.ENT_ID                         47620000
476300               AND  B.TYPE_CDE = '01'                             47630000
476400         END-EXEC                                                 47640000
476500                                                                  47650000
476600         EVALUATE TRUE                                            47660000
476700             WHEN SQLCODE = ZERO                                  47670000
476800             WHEN SQLCODE = -904                                  47680000
476900             WHEN SQLCODE = -913                                  47690000
477000                 CONTINUE                                         47700000
477100             WHEN SQLCODE = +100                                  47710000
477200                 MOVE ZERO TO EXTENT-LNE-OF-CR-AMT                47720000
477300             WHEN SQLWARN0 NOT = SPACES                           47730000
477400             WHEN SQLCODE < ZERO                                  47740000
477500             WHEN SQLCODE > ZERO                                  47750000
477600                 MOVE '4200-GET-VENDOR-VIA-ENT'                   47760000
477700                                   TO DP013-PARAGRAPH             47770000
477800                 MOVE 'SELECT VENDOR'                             47780000
477900                                   TO DP013-MESSAGE-TEXT (1)      47790000
478000                 MOVE SQLCA        TO DP013-SQLCA                 47800000
478100                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    47810000
478200                 SET DP013-DB2-ABEND                              47820000
478300                     DP013-XCTL-DISPLAY-RESTART                   47830000
478400                                   TO TRUE                        47840000
478500                 PERFORM DP013-0000-PROCESS-ABEND                 47850000
478600         END-EVALUATE                                             47860000
478700     END-PERFORM.                                                 47870000
478800                                                                  47880000
478900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47890000
479000         MOVE '4200-GET-VENDOR-VIA-ENT'                           47900000
479100                                   TO DP013-PARAGRAPH             47910000
479200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     47920000
479300                                   TO DP013-MESSAGE-TEXT (1)      47930000
479400         MOVE 'VENDOR       '      TO DP013-MESSAGE-TEXT (2)      47940000
479500         MOVE SQLCA                TO DP013-SQLCA                 47950000
479600         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    47960000
479700         SET DP013-DB2-ABEND                                      47970000
479800             DP013-XCTL-DISPLAY-RESTART                           47980000
479900                                   TO TRUE                        47990000
480000         PERFORM DP013-0000-PROCESS-ABEND                         48000000
480100     END-IF.                                                      48010000
480200                                                                  48020000
480300*----------------------------------------------------------------*48030000
480400* SELECT A ROW FROM THE DB2 SYSTEM VENDOR NAME TABLE.            *48040000
480500*----------------------------------------------------------------*48050000
480600 4300-GET-VEND-SHORT-NAME.                                        48060000
480700                                                                  48070000
480800     PERFORM                                                      48080000
480900         WITH TEST AFTER                                          48090000
481000         VARYING PV-RETRY-COUNTER                                 48100000
481100         FROM 1 BY 1                                              48110000
481200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48120000
481300                   OR (SQLCODE = ZERO)                            48130000
481400                   OR (SQLCODE = +100))                           48140000
481500                                                                  48150000
481600         EXEC SQL                                                 48160000
481700             SELECT ENT_NAME_DESC                                 48170000
481800             INTO   :PV-ENT-SNAME-DESC                            48180000
481900             FROM   TENTNME                                       48190000
482000             WHERE  ENT_ID   = :ASC-ENT-ID                        48200000
482100               AND  TYPE_CDE = '04'                               48210000
482200         END-EXEC                                                 48220000
482300                                                                  48230000
482400         EVALUATE TRUE                                            48240000
482500             WHEN SQLCODE = +100                                  48250000
482600                 MOVE SPACES TO PV-ENT-SNAME-DESC                 48260000
482700             WHEN SQLCODE = ZERO                                  48270000
482800             WHEN SQLCODE = -904                                  48280000
482900             WHEN SQLCODE = -913                                  48290000
483000                 CONTINUE                                         48300000
483100             WHEN SQLWARN0 NOT = SPACES                           48310000
483200             WHEN SQLCODE < ZERO                                  48320000
483300             WHEN SQLCODE > ZERO                                  48330000
483400                 MOVE '4300-GET-VENDOR-SNAME'                     48340000
483500                                   TO DP013-PARAGRAPH             48350000
483600                 MOVE 'SELECT VENDOR NAME'                        48360000
483700                                   TO DP013-MESSAGE-TEXT (1)      48370000
483800                 MOVE SQLCA        TO DP013-SQLCA                 48380000
483900                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    48390000
484000                 SET DP013-DB2-ABEND                              48400000
484100                     DP013-XCTL-DISPLAY-RESTART                   48410000
484200                                   TO TRUE                        48420000
484300                 PERFORM DP013-0000-PROCESS-ABEND                 48430000
484400         END-EVALUATE                                             48440000
484500     END-PERFORM.                                                 48450000
484600                                                                  48460000
484700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48470000
484800         MOVE '4300-GET-VENDOR-SNAME'                             48480000
484900                                   TO DP013-PARAGRAPH             48490000
485000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     48500000
485100                                   TO DP013-MESSAGE-TEXT (1)      48510000
485200         MOVE 'VENDOR SNAME '      TO DP013-MESSAGE-TEXT (2)      48520000
485300         MOVE SQLCA                TO DP013-SQLCA                 48530000
485400         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    48540000
485500         SET DP013-DB2-ABEND                                      48550000
485600             DP013-XCTL-DISPLAY-RESTART                           48560000
485700                                   TO TRUE                        48570000
485800         PERFORM DP013-0000-PROCESS-ABEND                         48580000
485900     END-IF.                                                      48590000
486000                                                                  48600000
486100*----------------------------------------------------------------*48610000
486200* RETRIEVE PARENT COMPANY NAME.                                  *48620000
486300*----------------------------------------------------------------*48630000
486400 4310-GET-VEND-PARENT-NAME.                                       48640000
486500                                                                  48650000
486600     PERFORM                                                      48660000
486700         WITH TEST AFTER                                          48670000
486800         VARYING PV-RETRY-COUNTER                                 48680000
486900         FROM 1 BY 1                                              48690000
487000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48700000
487100                   OR (SQLCODE = ZERO)                            48710000
487200                   OR (SQLCODE = +100))                           48720000
487300                                                                  48730000
487400         EXEC SQL                                                 48740000
487500             SELECT NME.ENT_NAME_DESC,                            48750000
487600                    ENT.DUN_NBR                                   48760000
487700             INTO   :ASC-PARENT-NAME,                             48770000
487800                    :PV-PARENT-VENDOR-NBR                         48780000
487900             FROM   TENTNME   NME                                 48790000
488000                   ,TEXTENT   ENT                                 48800000
488100             WHERE  NME.ENT_ID   = :EXTENT-PRNT-CO-ENT-ID         48810000
488200               AND  NME.ENT_ID = ENT.ENT_ID                       48820000
488300               AND  NME.TYPE_CDE = '01'                           48830000
488400         END-EXEC                                                 48840000
488500                                                                  48850000
488600         EVALUATE TRUE                                            48860000
488700             WHEN SQLCODE = +0                                    48870000
488800                 MOVE PV-PARENT-VENDOR-NBR TO                     48880000
488900                                ASC-PARENT-VENDOR-NBR             48890000
489000             WHEN SQLCODE = +100                                  48900000
489100                 MOVE SPACES TO ASC-PARENT-NAME                   48910000
489200                                ASC-PARENT-VENDOR-NBR             48920000
489300             WHEN SQLCODE = ZERO                                  48930000
489400             WHEN SQLCODE = -904                                  48940000
489500             WHEN SQLCODE = -913                                  48950000
489600                 CONTINUE                                         48960000
489700             WHEN SQLWARN0 NOT = SPACES                           48970000
489800             WHEN SQLCODE < ZERO                                  48980000
489900             WHEN SQLCODE > ZERO                                  48990000
490000                 MOVE '4310-GET-VEND-PARENT-NAME'                 49000000
490100                                   TO DP013-PARAGRAPH             49010000
490200                 MOVE 'SELECT VENDOR PARENT NAME'                 49020000
490300                                   TO DP013-MESSAGE-TEXT (1)      49030000
490400                 MOVE SQLCA        TO DP013-SQLCA                 49040000
490500                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    49050000
490600                 SET DP013-DB2-ABEND                              49060000
490700                     DP013-XCTL-DISPLAY-RESTART                   49070000
490800                                   TO TRUE                        49080000
490900                 PERFORM DP013-0000-PROCESS-ABEND                 49090000
491000         END-EVALUATE                                             49100000
491100     END-PERFORM.                                                 49110000
491200                                                                  49120000
491300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49130000
491400         MOVE '4310-GET-VEND-PARENT-NAME'                         49140000
491500                                   TO DP013-PARAGRAPH             49150000
491600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     49160000
491700                                   TO DP013-MESSAGE-TEXT (1)      49170000
491800         MOVE 'VENDOR PARENT'      TO DP013-MESSAGE-TEXT (2)      49180000
491900         MOVE SQLCA                TO DP013-SQLCA                 49190000
492000         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    49200000
492100         SET DP013-DB2-ABEND                                      49210000
492200             DP013-XCTL-DISPLAY-RESTART                           49220000
492300                                   TO TRUE                        49230000
492400         PERFORM DP013-0000-PROCESS-ABEND                         49240000
492500     END-IF.                                                      49250000
492600                                                                  49260000
492700*----------------------------------------------------------------*49270000
492800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *49280000
492900*----------------------------------------------------------------*49290000
493000                                                                  49300000
493100 4400-MOVE-COMMAREA-TO-SCREEN.                                    49310000
493200                                                                  49320000
493300     MOVE ASC-VEND-NAME            TO AVNNAMEO.                   49330000
493400     MOVE ASC-VEND-SNME            TO AVNSNMEO.                   49340000
493500     MOVE ASC-STATUS-CDE           TO AVNSTATO.                   49350000
493600     MOVE ASC-DUN-NBR              TO ADUNNBRO.                   49360000
493700     MOVE ASC-PARENT-NAME          TO APRNTCOO.                   49370000
493800     MOVE ASC-PARENT-VENDOR-NBR-N  TO APRNTNBO.                   49380000
493900     MOVE ASC-HLD-PAYT-IND         TO AVNHOLDO.                   49390000
494000     MOVE ASC-VND-USING-FACTOR     TO AUSEFACO.                   49400000
494100                                                                  49410000
494200     MOVE ASC-NDA-IND              TO ANDAINDO.                   49420000
494300                                                                  49430000
494400     MOVE ASC-SEPERATE-PYMTS       TO ASEPPAYO.                   49440000
494500     MOVE ASC-PREPACK-EDI-CDE      TO APPEDIO.                    49450000
494600     MOVE ASC-DEPT-NBR             TO ADPTNBRO.                   49460000
494700     MOVE ASC-INHOUSE-NBR          TO AINHSO.                     49470000
494800     MOVE ASC-PRIMARY-TYPE         TO APRMTYPO.                   49480000
494900     MOVE ASC-PARTNER-IND          TO APRTNRO.                    49490000
495000     MOVE ASC-PARTNER-TYPE         TO APTNRTYO.                   49500000
495100     MOVE ASC-LINE-OF-CREDIT       TO ALNCRDTO.                   49510000
495200     MOVE ASC-FACT-CAPACITY        TO ACPACTYO.                   49520000
495300     MOVE ASC-SCAC-CDE             TO ASCACO.                     49530000
495400     MOVE ASC-CARR-MAN-PRO-IND     TO AMANPROO.                   49540000
495500     MOVE ASC-CAP-EXP-CDE          TO ACAPEXPO.                   49550000
495600     MOVE ASC-DPTE-NBR             TO ADPTEXPO.                   49560000
495700     MOVE ASC-VND-CLSN-CDE         TO ACLASFCO.                   49570000
495800     MOVE ASC-VND-PRSST-CDE        TO APERSISO.                   49580000
495900     MOVE ASC-1099-NEEDED          TO A1099O.                     49590000
496000*    MOVE ASC-FED-TX-ID-TYP-CDE    TO ATAXIDTO.                   49600000
496100*    MOVE ASC-FED-TX-ID-NBR        TO ATAXIDO.                    49610000
496200     MOVE ASC-WITHHOLD-CDE         TO AWTHCDEO.                   49620000
496300     MOVE ASC-PRNT-CO-IND          TO APARINDO.                   49630000
496400     MOVE ASC-PAY-HNDLNG-CDE       TO APAYHNDO.                   49640000
496500     MOVE ASC-VND-ENT-ID           TO AENTIDO.                    49650000
496600                                                                  49660000
496700     EVALUATE TRUE                                                49670000
496800        WHEN  ASC-PARTNER-TYPE = 'AG'                             49680000
496900              MOVE 'AGENT'             TO ASC-PARTNER-DESC        49690000
497000        WHEN  ASC-PARTNER-TYPE = 'BK'                             49700000
497100              MOVE 'BANK'              TO ASC-PARTNER-DESC        49710000
497200        WHEN  ASC-PARTNER-TYPE = 'BR'                             49720000
497300              MOVE 'BROKER'            TO ASC-PARTNER-DESC        49730000
497400        WHEN  ASC-PARTNER-TYPE = 'CL'                             49740000
497500              MOVE 'CARTON LABEL MAKER'                           49750000
497600                                       TO ASC-PARTNER-DESC        49760000
497700        WHEN  ASC-PARTNER-TYPE = 'CO'                             49770000
497800              MOVE 'CONSOLIDATOR'      TO ASC-PARTNER-DESC        49780000
497900        WHEN  ASC-PARTNER-TYPE = 'CR'                             49790000
498000              MOVE 'CARRIER'           TO ASC-PARTNER-DESC        49800000
498100        WHEN  ASC-PARTNER-TYPE = 'DE'                             49810000
498200              MOVE 'DECONSOLIDATOR'    TO ASC-PARTNER-DESC        49820000
498300        WHEN  ASC-PARTNER-TYPE = 'FA'                             49830000
498400              MOVE 'FACTORY'           TO ASC-PARTNER-DESC        49840000
498500        WHEN  ASC-PARTNER-TYPE = 'FF'                             49850000
498600              MOVE 'FREIGHT FORWARDER' TO ASC-PARTNER-DESC        49860000
498700        WHEN  ASC-PARTNER-TYPE = 'OP'                             49870000
498800              MOVE 'OFFICE OF PLACEMENT' TO ASC-PARTNER-DESC      49880000
498900        WHEN  ASC-PARTNER-TYPE = 'S1'                             49890000
499000              MOVE 'MAKER'             TO ASC-PARTNER-DESC        49900000
499100        WHEN  ASC-PARTNER-TYPE = 'S2'                             49910000
499200              MOVE 'IMPORT PARENT CO'  TO ASC-PARTNER-DESC        49920000
499300        WHEN  ASC-PARTNER-TYPE = 'TM'                             49930000
499400              MOVE 'TICKET MAKER'      TO ASC-PARTNER-DESC        49940000
499500        WHEN  OTHER                                               49950000
499600              MOVE '       '           TO ASC-PARTNER-DESC        49960000
499700     END-EVALUATE.                                                49970000
499800                                                                  49980000
499900     EVALUATE TRUE                                                49990000
500000        WHEN  ASC-PRIMARY-TYPE = 'M'                              50000000
500100              MOVE 'MERCHANDISE' TO ASC-PRIMARY-DESC              50010000
500200        WHEN  ASC-PRIMARY-TYPE = 'E'                              50020000
500300              MOVE 'EXPENSE'     TO ASC-PRIMARY-DESC              50030000
500400        WHEN  OTHER                                               50040000
500500              MOVE 'FACTOR'      TO ASC-PRIMARY-DESC              50050000
500600     END-EVALUATE.                                                50060000
500700                                                                  50070000
500800     MOVE ASC-PARTNER-DESC         TO APTRDSCO.                   50080000
500900     MOVE ASC-PRIMARY-DESC         TO ATYPDSCO.                   50090000
501000                                                                  50100000
501100     IF ASC-NO-MERCH-AUTH                                         50110000
501200         MOVE DP015-ASK-NOR-OFF    TO                             50120000
501300                                      ADPTNBRA                    50130000
501400                                      AINHSA                      50140000
501500         MOVE DP015-BLUE           TO                             50150000
501600                                      ADPTNBRC                    50160000
501700                                      AINHSC                      50170000
501800         MOVE DP015-HL-OFF         TO                             50180000
501900                                      ADPTNBRH                    50190000
502000                                      AINHSH                      50200000
502100     END-IF.                                                      50210000
502200                                                                  50220000
502300     IF ASC-NO-CAR-AUTH                                           50230000
502400         MOVE DP015-ASK-NOR-OFF    TO                             50240000
502500                                      ASCACA                      50250000
502600                                      AMANPROA                    50260000
502700         MOVE DP015-BLUE           TO                             50270000
502800                                      ASCACC                      50280000
502900                                      AMANPROC                    50290000
503000         MOVE DP015-HL-OFF         TO                             50300000
503100                                      ASCACH                      50310000
503200                                      AMANPROH                    50320000
503300     END-IF.                                                      50330000
503400                                                                  50340000
503500     IF ASC-NO-EXPENSE-AUTH                                       50350000
503600         MOVE DP015-ASK-NOR-OFF    TO                             50360000
503700                                      ACAPEXPA                    50370000
503800                                      ADPTEXPA                    50380000
503900                                      ACLASFCA                    50390000
504000                                      APERSISA                    50400000
504100                                      A1099A                      50410000
504200*                                     ATAXIDTA                    50420000
504300*                                     ATAXIDA                     50430000
504400                                      AWTHCDEA                    50440000
504500         MOVE DP015-BLUE           TO                             50450000
504600                                      ACAPEXPC                    50460000
504700                                      ADPTEXPC                    50470000
504800                                      ACLASFCC                    50480000
504900                                      APERSISC                    50490000
505000                                      A1099C                      50500000
505100*                                     ATAXIDTC                    50510000
505200*                                     ATAXIDC                     50520000
505300                                      AWTHCDEC                    50530000
505400         MOVE DP015-HL-OFF         TO                             50540000
505500                                      ACAPEXPH                    50550000
505600                                      ADPTEXPH                    50560000
505700                                      ACLASFCH                    50570000
505800                                      APERSISH                    50580000
505900                                      A1099H                      50590000
506000*                                     ATAXIDTH                    50600000
506100*                                     ATAXIDH                     50610000
506200                                      AWTHCDEH                    50620000
506300     END-IF.                                                      50630000
506400                                                                  50640000
506500     IF ASC-NO-FACTOR-AUTH                                        50650000
506600         MOVE DP015-ASK-NOR-OFF    TO AUSEFACA                    50660000
506700         MOVE DP015-BLUE           TO AUSEFACC                    50670000
506800         MOVE DP015-HL-OFF         TO AUSEFACH                    50680000
506900     END-IF.                                                      50690000
507000                                                                  50700000
507100     IF ASC-NO-PARENT-AUTH                                        50710000
507200         MOVE DP015-ASK-NOR-OFF    TO APARINDA                    50720000
507300         MOVE DP015-BLUE           TO APARINDC                    50730000
507400         MOVE DP015-HL-OFF         TO APARINDH                    50740000
507500     END-IF.                                                      50750000
507600                                                                  50760000
507700     IF ASC-NO-MDEPT                                              50770000
507800         MOVE DP015-ASK-DRK-OFF    TO ADPTLBLA                    50780000
507900                                      ADPTNBRA                    50790000
508000                                      AINHLBLA                    50800000
508100                                      AINHSA                      50810000
508200     END-IF.                                                      50820000
508300                                                                  50830000
508400     IF ASC-NO-EDEPT                                              50840000
508500         MOVE DP015-ASK-DRK-OFF    TO AEXPLBLA                    50850000
508600                                      ADPTEXPA                    50860000
508700     END-IF.                                                      50870000
508800                                                                  50880000
508900     IF ASC-VNDR-NBR-POPULATED                                    50890000
509000         MOVE DP015-ASK-NOR-OFF    TO ADUNNBRA                    50900000
509100         MOVE DP015-BLUE           TO ADUNNBRC                    50910000
509200         MOVE DP015-HL-OFF         TO ADUNNBRH                    50920000
509300     END-IF.                                                      50930000
509400                                                                  50940000
509500     IF ASC-NO-PREPACK-EDI-AUTH                                   50950000
509600         MOVE DP015-ASK-NOR-OFF    TO APPEDIA                     50960000
509700         MOVE DP015-BLUE           TO APPEDIC                     50970000
509800         MOVE DP015-HL-OFF         TO APPEDIH                     50980000
509900     END-IF.                                                      50990000
510000                                                                  51000000
510100******************************************************************51010000
510200** IMPORTANT NOTE:                                                51020000
510300** IMPORTANT NOTE:                                                51030000
510400** IMPORTANT NOTE:                                                51040000
510500**** WHENEVER A NEW FIELD IS ADDED TO THE ONLINE SCREEN, YOU WILL 51050000
510600**** HAVE TO DETERMINE IF IT NEEDS TO BE ADDED TO THE IF STMT FOR 51060000
510700**** ASC-VENDOR-HOLD-AUTH BELOW.  THIS BLOCKS ALL FIELDS THAT CAN 51070000
510800**** NOT BE UPDATED BY AP MANAGEMENT LEVEL USERS.  IF THE SCREEN  51080000
510900**** FIELD IS NOT UNDER THIS IF STMT THEN THESE USERS WILL BE ABLE51090000
511000**** TO UPDATE IT.                                                51100000
511100******************************************************************51110000
511200     IF ASC-VENDOR-HOLD-AUTH                                      51120000
511300         MOVE DP015-ASK-NOR-OFF    TO AVNNAMEA                    51130000
511400                                      APRMTYPA                    51140000
511500                                      ADUNNBRA                    51150000
511600                                      APPEDIA                     51160000
511700                                      ADPTNBRA                    51170000
511800                                      AINHSA                      51180000
511900                                      APARINDA                    51190000
512000                                      APRTNRA                     51200000
512100                                      APTNRTYA                    51210000
512200                                      ASCACA                      51220000
512300                                      AMANPROA                    51230000
512400                                      ALNCRDTA                    51240000
512500                                      ACPACTYA                    51250000
512600                                      ACAPEXPA                    51260000
512700                                      ADPTEXPA                    51270000
512800         MOVE DP015-BLUE           TO AVNNAMEC                    51280000
512900                                      APRMTYPC                    51290000
513000                                      ADUNNBRC                    51300000
513100                                      APPEDIC                     51310000
513200                                      ADPTNBRC                    51320000
513300                                      AINHSC                      51330000
513400                                      APARINDC                    51340000
513500                                      APRTNRC                     51350000
513600                                      APTNRTYC                    51360000
513700                                      ASCACC                      51370000
513800                                      AMANPROC                    51380000
513900                                      ALNCRDTC                    51390000
514000                                      ACPACTYC                    51400000
514100                                      ACAPEXPC                    51410000
514200                                      ADPTEXPC                    51420000
514300         MOVE DP015-HL-OFF         TO AVNNAMEH                    51430000
514400                                      APRMTYPH                    51440000
514500                                      ADUNNBRH                    51450000
514600                                      APPEDIH                     51460000
514700                                      ADPTNBRH                    51470000
514800                                      AINHSH                      51480000
514900                                      APARINDH                    51490000
515000                                      APRTNRH                     51500000
515100                                      APTNRTYH                    51510000
515200                                      ASCACH                      51520000
515300                                      AMANPROH                    51530000
515400                                      ALNCRDTH                    51540000
515500                                      ACPACTYH                    51550000
515600                                      ACAPEXPH                    51560000
515700                                      ADPTEXPH                    51570000
515800     END-IF.                                                      51580000
515900                                                                  51590000
516000*----------------------------------------------------------------*51600000
516100* APPLY THE CHANGES TO THE DB2 TABLE.                            *51610000
516200*----------------------------------------------------------------*51620000
516300 5000-UPDATE-VENDOR.                                              51630000
516400                                                                  51640000
516500     SET VN-UPDATE-NOT-PERFORMED                                  51650000
516600         TVNDTAU-ROW-NOT-FOUND                                    51660000
516700         VN-STATUS-NOT-CHANGED                                    51670000
516800         VN007-UPDATE-NOT-PRFRMD                                  51680000
516900         VN007-DELETE-NOT-PRFRMD                                  51690000
517000         VN-PRIM-NOT-CHG-FROM-MERCH TO TRUE.                      51700000
517100                                                                  51710000
517200     INITIALIZE DCLTVNDTAU                                        51720000
517300                VN007-COMMAREA                                    51730000
517400                VN013-COMMAREA.                                   51740000
517500     PERFORM 6030-SELECT-TEXTENT-DETAIL.                          51750000
517600     PERFORM 6040-SELECT-TENTNME01-NAME.                          51760000
517700     PERFORM 6045-SELECT-TENTNME05-NAME.                          51770000
517800     PERFORM 6050-CHECK-FOR-UPDATE.                               51780000
517900                                                                  51790000
518000     IF (ASC-PRIMARY-TYPE = 'E' AND ASC-PARTNER-IND = 'Y')        51800000
518100        OR EXTENT-VND-IN-RMS-IND = 'Y'                            51810000
518200        PERFORM 8000-CHECK-FOR-RMS                                51820000
518300     ELSE                                                         51830000
518400        IF ASC-PRIMARY-TYPE = 'M' AND                             51840000
518500           EXTENT-PRIM-TYP-CDE = 'M' AND                          51850000
518600           EXTENT-VND-IN-RMS-IND = 'N' AND                        51860000
518700           ASC-STATUS-CDE = 'A'                                   51870000
518800           SET VN013-ACTION-ADD                                   51880000
518900               VN013-FUNCTION-VENDOR TO TRUE                      51890000
519000           MOVE ASC-ENT-ID            TO VN013-ENT-ID             51900000
519100           MOVE ASC-DUN-NBR           TO VN013-VND-NBR            51910000
519200           MOVE ASC-STATUS-CDE        TO VN013-STATUS-CDE         51920000
519300           MOVE ASC-PREPACK-EDI-CDE   TO VN013-PO-PREPK-CDE       51930000
519400           MOVE EXTENT-PRIM-TYP-CDE   TO VN013-PRIM-TYP-CDE       51940000
519500           MOVE EXTENT-VND-IN-RMS-IND TO VN013-VND-IN-RMS-IND     51950000
519600           MOVE ENTNME-ENT-NAME-DESC  TO VN013-ENT-NAME-DESC      51960000
519700     END-IF.                                                      51970000
519800                                                                  51980000
519900     IF VN-UPDATE-PERFORMED                                       51990000
520000        MOVE 'U'               TO VNDTAU-AUD-FUNC-CDE             52000000
520100        MOVE ASC-ENT-ID        TO VNDTAU-ENT-ID                   52010000
520200        IF VN-STATUS-CHANGE                                       52020000
520300          PERFORM 6060-SELECT-TVNDTAU                             52030000
520400          IF TVNDTAU-ROW-FOUND                                    52040000
520500             PERFORM 6070-UPDATE-TVNDTAU-CHG-TMST                 52050000
520600          END-IF                                                  52060000
520700        END-IF                                                    52070000
520800        IF VN-STATUS-CHANGE                                       52080000
520900        OR VN-HANDLING-CHANGE                                     52090000
521000           MOVE PC-INIT-EXP-TMST  TO VNDTAU-PREV-STAT-CHG-TMST    52100000
521100           PERFORM 6020-INSERT-DETAIL-HISTORY-ROW                 52110000
521200        END-IF                                                    52120000
521300     END-IF.                                                      52130000
521400                                                                  52140000
521500     IF VN013-ACTION-DELETE                                       52150000
521600        SET VN013-FUNCTION-VENDOR  TO TRUE                        52160000
521700        MOVE ASC-ENT-ID            TO VN013-ENT-ID                52170000
521800        MOVE ASC-DUN-NBR           TO VN013-VND-NBR               52180000
521900        MOVE ASC-PREPACK-EDI-CDE   TO VN013-PO-PREPK-CDE          52190000
522000        MOVE EXTENT-PRIM-TYP-CDE   TO VN013-PRIM-TYP-CDE          52200000
522100        MOVE EXTENT-VND-IN-RMS-IND TO VN013-VND-IN-RMS-IND        52210000
522200        MOVE EXTENT-STATUS-CDE     TO VN013-STATUS-CDE            52220000
522300        MOVE ENTNME-ENT-NAME-DESC  TO VN013-ENT-NAME-DESC         52230000
522400        MOVE 'N'                   TO EXTENT-VND-IN-RMS-IND       52240000
522500     END-IF.                                                      52250000
522600                                                                  52260000
522700** WHEN THE PARTNER TYPE HAS BEEN UPDATED SEND A DELETE MESSAGE   52270000
522800** TO RMS PO USING THE UNCHANGED DATA FROM THE DATABASES.         52280000
522900     IF VN007-CHANGE-PRTNR-TYPE                                   52290000
523000        MOVE ASC-DUN-NBR           TO VN007-VND-NBR               52300000
523100        MOVE ASC-ENT-ID            TO VN007-ENT-ID                52310000
523200        MOVE ASC-PREPACK-EDI-CDE   TO VN007-PO-PREPK-CDE          52320000
523300        MOVE EXTENT-PRIM-TYP-CDE   TO VN007-PRIM-TYP-CDE          52330000
523400        MOVE EXTENT-PRTNR-TYP-CDE  TO VN007-PRTNR-TYP-CDE         52340000
523500        MOVE EXTENT-STATUS-CDE     TO VN007-STATUS-CDE            52350000
523600        MOVE ENTNME-ENT-NAME-DESC  TO VN007-ENT-NAME-DESC         52360000
523700        MOVE EXTENT-SCAC-CDE       TO VN007-SCAC-CDE              52370000
523800        IF EXTENT-PRTNR-TYP-CDE = 'FA'                            52380000
523900            MOVE ZEROES TO VN007-LINE-OF-CR-AMT                   52390000
524000        ELSE                                                      52400000
524100            MOVE EXTENT-LNE-OF-CR-AMT  TO VN007-LINE-OF-CR-AMT    52410000
524200        END-IF                                                    52420000
524300        MOVE PV-LONG-ENT-NAME-DESC TO VN007-LONGNAME              52430000
524400        MOVE 'Y'                   TO VN007-PRTNR-DELETE-IND      52440000
524500** SEND THE DELETE PARTNER MESSAGE ONLY WHEN                      52450000
524600** EXTENT-VND-IN-RMS-IND = 'Y' BEFORE THE TEXTENT UPDATES         52460000
524700** ARE APPLIED.                                                   52470000
524800        IF EXTENT-VND-IN-RMS-IND = 'Y'                            52480000
524900           MOVE 'N'                TO VN007-VND-IN-RMS-IND        52490000
525000           MOVE 'N'                TO EXTENT-VND-IN-RMS-IND       52500000
525100           PERFORM 8300-LINK-TO-VNKCS024                          52510000
525200        END-IF                                                    52520000
525300     END-IF.                                                      52530000
525400                                                                  52540000
525500** SET UP A DELETE MESSAGE FOR AN UPDATED PRIMARY TYPE CODE       52550000
525600** USING THE UNCHANGED DATA FROM THE DATABASES.                   52560000
525700     IF VN007-DELETE-PRFRMD                                       52570000
525800        MOVE ASC-DUN-NBR           TO VN007-VND-NBR               52580000
525900        MOVE ASC-ENT-ID            TO VN007-ENT-ID                52590000
526000        MOVE ASC-PREPACK-EDI-CDE   TO VN007-PO-PREPK-CDE          52600000
526100        MOVE EXTENT-PRIM-TYP-CDE   TO VN007-PRIM-TYP-CDE          52610000
526200        MOVE EXTENT-PRTNR-TYP-CDE  TO VN007-PRTNR-TYP-CDE         52620000
526300        MOVE EXTENT-STATUS-CDE     TO VN007-STATUS-CDE            52630000
526400        MOVE ENTNME-ENT-NAME-DESC  TO VN007-ENT-NAME-DESC         52640000
526500        MOVE EXTENT-SCAC-CDE       TO VN007-SCAC-CDE              52650000
526600        IF EXTENT-PRTNR-TYP-CDE = 'FA'                            52660000
526700            MOVE ZEROES TO VN007-LINE-OF-CR-AMT                   52670000
526800        ELSE                                                      52680000
526900            MOVE EXTENT-LNE-OF-CR-AMT  TO VN007-LINE-OF-CR-AMT    52690000
527000        END-IF                                                    52700000
527100        MOVE 'Y'                   TO VN007-PRTNR-DELETE-IND      52710000
527200        MOVE 'N'                   TO EXTENT-VND-IN-RMS-IND       52720000
527300                                      VN007-VND-IN-RMS-IND        52730000
527400        MOVE PV-LONG-ENT-NAME-DESC TO VN007-LONGNAME              52740000
527500     END-IF.                                                      52750000
527600                                                                  52760000
527700** SET UP A MESSAGE TO RMS PO FOR AN UPDATED PARTNER TYPE         52770000
527800** OR AN UPDATED MERCHANDISE VENDOR USING THE CHANGED DATA FROM   52780000
527900** THE SCREEN IN THE ASC- FIELDS.                                 52790000
528000     IF VN007-UPDATE-PRFRMD AND                                   52800000
528100        (VN007-DELETE-NOT-PRFRMD OR VN007-CHANGE-PRTNR-TYPE)      52810000
528200        MOVE ASC-DUN-NBR           TO VN007-VND-NBR               52820000
528300        MOVE ASC-PRIMARY-TYPE      TO VN007-PRIM-TYP-CDE          52830000
528400        MOVE ASC-PARTNER-TYPE      TO VN007-PRTNR-TYP-CDE         52840000
528500        MOVE ASC-STATUS-CDE        TO VN007-STATUS-CDE            52850000
528600        MOVE ASC-VEND-NAME         TO VN007-ENT-NAME-DESC         52860000
528700        MOVE ASC-SCAC-CDE          TO VN007-SCAC-CDE              52870000
528800        IF ASC-PARTNER-TYPE = 'FA'                                52880000
528900            MOVE ZEROES TO VN007-LINE-OF-CR-AMT                   52890000
529000        ELSE                                                      52900000
529100            MOVE ASC-LINE-OF-CREDIT    TO VN007-LINE-OF-CR-AMT    52910000
529200        END-IF                                                    52920000
529300        MOVE ASC-ENT-ID            TO VN007-ENT-ID                52930000
529400        MOVE ASC-PREPACK-EDI-CDE   TO VN007-PO-PREPK-CDE          52940000
529500        MOVE 'N'                   TO VN007-PRTNR-DELETE-IND      52950000
529600                                                                  52960000
529700** DO NOT SET THE VND_IN_RMS_IND ON TEXTENT TO 'Y' AND            52970000
529800** VN007-VND-IN-RMS-IND TO 'Y' IF THE PARTNER TYPE IS             52980000
529900** 'S2' OR 'FA' AND NO LONG NAME HAS BEEN CREATED                 52990000
530000** FOR THE PARTNER.                                               53000000
530100        IF (ASC-PARTNER-TYPE = 'FA' OR 'S2') AND                  53010000
530200           (PS-LONGNAME-NOT-FOUND) AND                            53020000
530300           (EXTENT-VND-IN-RMS-IND = 'N')                          53030000
530400           MOVE 'N'                TO VN007-VND-IN-RMS-IND        53040000
530500           MOVE 'N'                TO EXTENT-VND-IN-RMS-IND       53050000
530600        ELSE                                                      53060000
530700           MOVE 'Y'                TO VN007-VND-IN-RMS-IND        53070000
530800           MOVE 'Y'                TO EXTENT-VND-IN-RMS-IND       53080000
530900        END-IF                                                    53090000
531000                                                                  53100000
531100        MOVE PV-LONG-ENT-NAME-DESC TO VN007-LONGNAME              53110000
531200     END-IF.                                                      53120000
531300                                                                  53130000
531400     IF VN013-ACTION-DELETE OR VN013-ACTION-ADD                   53140000
531500        PERFORM 8200-LINK-TO-VNKCS023                             53150000
531600     END-IF.                                                      53160000
531700                                                                  53170000
531800     IF VN007-DELETE-PRFRMD                                       53180000
531900        PERFORM 8300-LINK-TO-VNKCS024                             53190000
532000     ELSE                                                         53200000
532100        IF VN007-UPDATE-PRFRMD                                    53210000
532200           IF (ASC-PARTNER-TYPE = 'FA' OR 'S2') AND               53220000
532300              (PS-LONGNAME-NOT-FOUND) AND                         53230000
532400              (EXTENT-VND-IN-RMS-IND = 'N')                       53240000
532500*             NEXT SENTENCE                                       53250000
532600              SET PS-UPDT-PRTNR-NO-LNG-NM TO TRUE                 53260000
532700           ELSE                                                   53270000
532800              PERFORM 8300-LINK-TO-VNKCS024                       53280000
532900           END-IF                                                 53290000
533000        END-IF                                                    53300000
533100     END-IF.                                                      53310000
533200                                                                  53320000
533300     IF VN-PRIM-CHG-FROM-MERCH                                    53330000
533400        PERFORM 8400-UPDATE-TVNDDPT                               53340000
533500     END-IF.                                                      53350000
533600                                                                  53360000
533700     MOVE ASC-STATUS-CDE        TO EXTENT-STATUS-CDE.             53370000
533800     MOVE ASC-DUN-NBR           TO EXTENT-DUN-NBR.                53380000
533900     MOVE ASC-PRNT-CO-ENT-ID    TO EXTENT-PRNT-CO-ENT-ID.         53390000
534000     MOVE ASC-HLD-PAYT-IND      TO EXTENT-HLD-PAYT-IND.           53400000
534100     MOVE ASC-VND-USING-FACTOR  TO EXTENT-PAY-FCTR-VND-IND.       53410000
534200     MOVE ASC-NDA-IND           TO EXTENT-NDA-IND.                53420000
534300                                                                  53430000
534400     MOVE ASC-SEPERATE-PYMTS    TO EXTENT-SEPR-INVC-PAYT-IND.     53440000
534500     MOVE ASC-PREPACK-EDI-CDE   TO EXTENT-EDI-PO-PREPK-CDE.       53450000
534600     MOVE ASC-PRIMARY-TYPE      TO EXTENT-PRIM-TYP-CDE.           53460000
534700     MOVE ASC-PARTNER-IND       TO EXTENT-PRTNR-IND.              53470000
534800     MOVE ASC-PARTNER-TYPE      TO EXTENT-PRTNR-TYP-CDE.          53480000
534900     IF ASC-PARTNER-TYPE = 'FA'                                   53490000
535000         MOVE ASC-FACT-CAPACITY TO EXTENT-LNE-OF-CR-AMT           53500000
535100     ELSE                                                         53510000
535200         MOVE ASC-LINE-OF-CREDIT TO EXTENT-LNE-OF-CR-AMT          53520000
535300     END-IF                                                       53530000
535400                                                                  53540000
535500     EVALUATE TRUE                                                53550000
535600        WHEN  ASC-PRIMARY-TYPE = 'M'                              53560000
535700              MOVE 'Y'          TO EXTENT-MDSE-VENDOR-IND         53570000
535800              MOVE 'N'          TO EXTENT-EXP-VEND-IND            53580000
535900                                   EXTENT-FCTR-IND                53590000
536000        WHEN  ASC-PRIMARY-TYPE = 'E'                              53600000
536100              MOVE 'Y'          TO EXTENT-EXP-VEND-IND            53610000
536200              MOVE 'N'          TO EXTENT-FCTR-IND                53620000
536300                                   EXTENT-MDSE-VENDOR-IND         53630000
536400        WHEN  ASC-PRIMARY-TYPE = 'F'                              53640000
536500              MOVE 'Y'          TO EXTENT-FCTR-IND                53650000
536600              MOVE 'N'          TO EXTENT-EXP-VEND-IND            53660000
536700                                   EXTENT-MDSE-VENDOR-IND         53670000
536800     END-EVALUATE.                                                53680000
536900                                                                  53690000
537000     MOVE ASC-PARTNER-TYPE TO  PV-VALID-CARRIER.                  53700000
537100                                                                  53710000
537200     IF  VALID-CARRIER                                            53720000
537300        MOVE 'Y'                TO EXTENT-CARRIER-IND             53730000
537400     ELSE                                                         53740000
537500        MOVE 'N'                TO EXTENT-CARRIER-IND             53750000
537600     END-IF.                                                      53760000
537700                                                                  53770000
537800     MOVE ASC-SCAC-CDE          TO EXTENT-SCAC-CDE.               53780000
537900     MOVE ASC-CARR-MAN-PRO-IND  TO EXTENT-CARR-MAN-PRO-IND.       53790000
538000     MOVE ASC-CAP-EXP-CDE       TO EXTENT-CAP-EXP-CDE.            53800000
538100     MOVE ASC-VND-CLSN-CDE      TO EXTENT-VND-CLSN-CDE.           53810000
538200     MOVE ASC-VND-PRSST-CDE     TO EXTENT-VND-PRSST-CDE.          53820000
538300     MOVE ASC-1099-NEEDED       TO EXTENT-NEED-1099-IND.          53830000
538400*    MOVE ASC-FED-TX-ID-TYP-CDE TO EXTENT-FED-TX-ID-TYP-CDE.      53840000
538500*    MOVE ASC-FED-TX-ID-NBR     TO EXTENT-FED-TX-ID-NBR.          53850000
538600     MOVE ASC-WITHHOLD-CDE      TO EXTENT-WHLDG-PAYT-TYP-CDE.     53860000
538700     MOVE ASC-PRNT-CO-IND       TO EXTENT-PRNT-CO-IND.            53870000
538800     MOVE ASC-PAY-HNDLNG-CDE    TO EXTENT-PAYT-HNDLG-CDE.         53880000
538900     PERFORM 5100-UPDATE-TEXTENT.                                 53890000
539000                                                                  53900000
539100     IF PS-UPDATE-NDA-IND                                         53910000
539200        PERFORM 5160-UPDATE-NDA-IND                               53920000
539300     END-IF.                                                      53930000
539400                                                                  53940000
539500     IF ASC-PRIMARY-TYPE = 'M'                                    53950000
539600         IF ASC-ADD-MDEPT                                         53960000
539700             SET  ASC-NO-MDEPT TO TRUE                            53970000
539800             MOVE ASC-ENT-ID        TO VNDDPT-ENT-ID              53980000
539900             MOVE ASC-DEPT-NBR      TO VNDDPT-DEPT-NBR            53990000
540000             MOVE ASC-INHOUSE-NBR-N TO VNDDPT-INHOUSE-NBR         54000000
540100             MOVE 'M'               TO VNDDPT-VEND-TYP-IND        54010000
540200             MOVE 'N'               TO VNDDPT-INVC-REQ-PO-IND     54020000
540300                                                                  54030000
540400             PERFORM 6400-ADD-TVNDDPT                             54040000
540500             INITIALIZE DCLTVNDTAU                                54050000
540600             MOVE ASC-ENT-ID           TO VNDTAU-ENT-ID           54060000
540700             MOVE ASC-DEPT-NBR         TO VNDTAU-DEPT-NBR         54070000
540800             MOVE 'A'                  TO VNDTAU-STAT-CDE         54080000
540900             MOVE 'D'                  TO VNDTAU-AUD-TYP-CDE      54090000
541000             MOVE PC-INIT-EXP-TMST     TO                         54100000
541100                                       VNDTAU-PREV-STAT-CHG-TMST  54110000
541200             PERFORM 6020-INSERT-DETAIL-HISTORY-ROW               54120000
541300         END-IF                                                   54130000
541400     END-IF.                                                      54140000
541500                                                                  54150000
541600     IF ASC-PRIMARY-TYPE = 'E' AND (ASC-CAP-EXP-CDE = 'Y' OR 'B') 54160000
541700         IF ASC-ADD-EDEPT                                         54170000
541800             SET  ASC-NO-EDEPT TO TRUE                            54180000
541900             MOVE ASC-ENT-ID   TO VNDDPT-ENT-ID                   54190000
542000             MOVE ASC-DPTE-NBR TO VNDDPT-DEPT-NBR                 54200000
542100             MOVE ZERO         TO VNDDPT-INHOUSE-NBR              54210000
542200             MOVE 'E'          TO VNDDPT-VEND-TYP-IND             54220000
542300             MOVE 'N'          TO VNDDPT-INVC-REQ-PO-IND          54230000
542400                                                                  54240000
542500             PERFORM 6400-ADD-TVNDDPT                             54250000
542600             INITIALIZE DCLTVNDTAU                                54260000
542700             MOVE ASC-ENT-ID           TO VNDTAU-ENT-ID           54270000
542800             MOVE ASC-DPTE-NBR         TO VNDTAU-DEPT-NBR         54280000
542900             MOVE 'A'                  TO VNDTAU-STAT-CDE         54290000
543000             MOVE 'D'                  TO VNDTAU-AUD-TYP-CDE      54300000
543100             MOVE PC-INIT-EXP-TMST     TO                         54310000
543200                                       VNDTAU-PREV-STAT-CHG-TMST  54320000
543300             PERFORM 6020-INSERT-DETAIL-HISTORY-ROW               54330000
543400         END-IF                                                   54340000
543500     END-IF.                                                      54350000
543600                                                                  54360000
543700     MOVE ASC-VEND-NAME TO ENTNME-ENT-NAME-DESC.                  54370000
543800     MOVE '01'          TO PV-TYPE-CODE.                          54380000
543900                                                                  54390000
544000     PERFORM 5200-UPDATE-TENTNME.                                 54400000
544100                                                                  54410000
544200     MOVE ASC-VEND-SNME TO ENTNME-ENT-NAME-DESC.                  54420000
544300     MOVE '04'          TO PV-TYPE-CODE.                          54430000
544400     IF ENTNME-ENT-NAME-DESC = SPACES                             54440000
544500        PERFORM 5020-AUTO-GEN-SHORTNAME                           54450000
544600     END-IF.                                                      54460000
544700                                                                  54470000
544800     IF PS-ERROR                                                  54480000
544900        CONTINUE                                                  54490000
545000     ELSE                                                         54500000
545100                                                                  54510000
545200        PERFORM 5200-UPDATE-TENTNME                               54520000
545300                                                                  54530000
545400        IF SQLCODE = +100                                         54540000
545500           PERFORM 5999-GET-MAX-TENTNME                           54550000
545600                                                                  54560000
545700           MOVE ASC-ENT-ID   TO ENTNME-ENT-ID                     54570000
545800           ADD +1            TO ENTNME-SEQ-NBR                    54580000
545900           MOVE PV-TYPE-CODE TO ENTNME-TYPE-CDE                   54590000
546000           IF ENTNME-ENT-NAME-DESC = SPACES                       54600000
546100             PERFORM 5020-AUTO-GEN-SHORTNAME                      54610000
546200           END-IF                                                 54620000
546300           PERFORM 6300-ADD-TENTNME                               54630000
546400        END-IF.                                                   54640000
546500                                                                  54650000
546600     IF PS-ERROR                                                  54660000
546700       CONTINUE                                                   54670000
546800     ELSE                                                         54680000
546900         IF ASC-USE-SELECTION-QUEUE                               54690000
547000             PERFORM 5400-UPDATE-SELECTION-QUEUE                  54700000
547100         END-IF                                                   54710000
547200     END-IF.                                                      54720000
547300     IF PS-UPDT-PRTNR-NO-LNG-NM                                   54730000
547400*       SET DP020-MSG-FATAL         TO TRUE                       54740000
547500        SET DP020-MSG-INFORMATIONAL TO TRUE                       54750000
547600**  VENDOR PARTNER UPDATED, BUT NOT TO RMS PO - NEEDS LONG NAME   54760000
547700        MOVE PC-TSYMSG-03626        TO DP020-MSG-NUMBER           54770000
547800     END-IF.                                                      54780000
547900                                                                  54790000
548000******************************************************************54800000
548100*  THIS PARAGRAPH WILL AUTOMATICALLY GENERATE A SHORT NAME FOR A  54810000
548200*  NEW VENDOR IF THE SHORT NAME FIELD IS LEFT BLANK ON THE ADD    54820000
548300*  SCREEN. IT TAKES THE FIRST 7 CHARACTERS OF THE VENDOR NAME     54830000
548400*  AND FOLLOWS IT WITH A SEQUENTIAL 3 DIGIT NUMBER. IF THE VENDOR 54840000
548500*  HAS LESS THAN 7 CHARACTERS IN THE PRIMARY NAME, THE ROUTINE    54850000
548600*  WILL USE AS MANY CHARACTERS AS THE PRIMARY NAME HAS AND TACK   54860000
548700*  ONLY THREE DIGITS ON THE END. IE - "LEE" WOULD BE "LEE001".    54870000
548800******************************************************************54880000
548900 5020-AUTO-GEN-SHORTNAME.                                         54890000
549000                                                                  54900000
549100     INITIALIZE PV-VENDOR-NAME-TABLE                              54910000
549200                PV-SHORTNAME-TABLE                                54920000
549300                PV-SHORTNAME-LT-7CHAR.                            54930000
549400                                                                  54940000
549500     MOVE ASC-VEND-NAME      TO PV-VENDOR-NAME-TABLE.             54950000
549600     SET SHORTNAME-NOT-DERIVED  TO TRUE.                          54960000
549700     SET SHORTNAME-NOT-LT-7CHAR TO TRUE.                          54970000
549800     MOVE 0 TO PV-SNAME-INDX.                                     54980000
549900                                                                  54990000
550000*    PULL THE FIRST 7 CHARACTERS FROM THE PRIMARY NAME            55000000
550100     PERFORM 5030-DERIVE-SHORTNAME                                55010000
550200        VARYING NAME-INDX FROM 1 BY 1                             55020000
550300          UNTIL NAME-INDX > 30 OR SHORTNAME-DERIVED.              55030000
550400                                                                  55040000
550500*    IF THE VENDOR HAS LESS THAN 7 CHARACTERS, SET THIS SWITCH    55050000
550600     IF NAME-INDX > 30                                            55060000
550700         SET SHORTNAME-LT-7CHAR TO TRUE                           55070000
550800     END-IF.                                                      55080000
550900                                                                  55090000
551000     IF SHORTNAME-DERIVED OR SHORTNAME-LT-7CHAR                   55100000
551100                                                                  55110000
551200         INITIALIZE PV-SNAME-SUBSTR-CMPR1                         55120000
551300         INITIALIZE PV-SNAME-SUBSTR-LT-7CHAR                      55130000
551400         MOVE PV-SHORTNAME-TABLE   TO PV-SNAME-SUBSTR-CMPR1       55140000
551500                                                                  55150000
551600         IF SHORTNAME-LT-7CHAR                                    55160000
551700             PERFORM 5045-FIND-COMPARE-LENGTH                     55170000
551800         ELSE                                                     55180000
551900             SET SNAME-LENGTH-GE7 TO TRUE                         55190000
552000         END-IF                                                   55200000
552100                                                                  55210000
552200*        RETRIEVE THE MAX VENDOR NAME BASED ON THE 7 CHARACTERS   55220000
552300         SET EXISTING-SNAME        TO TRUE                        55230000
552400         MOVE PV-SNAME-INDX        TO PV-POINTER                  55240000
552500         PERFORM 5040-GET-MAX-ENT-NAME-DESC                       55250000
552600                                                                  55260000
552700*        IF THIS NAME EXISTS, FIND NEXT SEQUENTIAL SUFFIX, ELSE   55270000
552800*        MOVE 001 TO THE SUFFIX                                   55280000
552900         IF EXISTING-SNAME                                        55290000
553000             PERFORM 5050-CALC-NEXT-SHORTNAME                     55300000
553100         ELSE                                                     55310000
553200             IF SHORTNAME-LT-7CHAR                                55320000
553300                 INITIALIZE PV-SHORTNAME-LT-7CHAR                 55330000
553400                 MOVE PV-SHORTNAME-TABLE TO PV-SHORTNAME-LT-7CHAR 55340000
553500                 INITIALIZE PV-SHORTNAME-COMPARE                  55350000
553600                 MOVE '001' TO PV-SHORT-SUFF                      55360000
553700                 STRING PV-SHORT-7CHAR DELIMITED BY ' '           55370000
553800                        PV-SHORT-SUFF DELIMITED BY SIZE           55380000
553900                   INTO PV-SHORTNAME-COMPARE                      55390000
554000                 MOVE PV-SHORTNAME-COMPARE TO PV-SHORTNAME-TABLE  55400000
554100             ELSE                                                 55410000
554200                 MOVE 1 TO PV-SNM-SUFFIX                          55420000
554300             END-IF                                               55430000
554400                                                                  55440000
554500             MOVE PV-SHORTNAME-TABLE   TO ENTNME-ENT-NAME-DESC    55450000
554600                                          ASC-VEND-SNME           55460000
554700                                          AVNSNMEO                55470000
554800         END-IF                                                   55480000
554900     END-IF.                                                      55490000
555000                                                                  55500000
555100 5030-DERIVE-SHORTNAME.                                           55510000
555200     IF PV-SNAME-INDX >= 7                                        55520000
555300        SET SHORTNAME-DERIVED TO TRUE                             55530000
555400     ELSE                                                         55540000
555500        MOVE VENDOR-NAME-BYTE(NAME-INDX) TO PV-VALID-CHARACTER    55550000
555600                                                                  55560000
555700        IF VALID-CHARACTER                                        55570000
555800           ADD 1 TO PV-SNAME-INDX                                 55580000
555900           MOVE VENDOR-NAME-BYTE(NAME-INDX) TO                    55590000
556000                                    SHORTNAME-BYTE(PV-SNAME-INDX).55600000
556100                                                                  55610000
556200 5040-GET-MAX-ENT-NAME-DESC.                                      55620000
556300     PERFORM                                                      55630000
556400         WITH TEST AFTER                                          55640000
556500         VARYING PV-RETRY-COUNTER                                 55650000
556600         FROM 1 BY 1                                              55660000
556700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               55670000
556800                   OR (SQLCODE = ZERO)                            55680000
556900                   OR (SQLCODE = +100)                            55690000
557000                   OR (SQLCODE = -305))                           55700000
557100                                                                  55710000
557200         EXEC SQL                                                 55720000
557300          SELECT MAX(ENT_NAME_DESC)                               55730000
557400          INTO  :ENTNME-ENT-NAME-DESC                             55740000
557500          FROM  TENTNME                                           55750000
557600          WHERE (:PV-SNAME-SUBSTR-CMPR1 =                         55760000
557700            SUBSTR(ENT_NAME_DESC,1,:PV-POINTER) AND               55770000
557800            NOT :PV-SNAME-SUBSTR-CMPR1 = '       ') OR            55780000
557900                (:PV-SNAME-SUBSTR-LGTH2 =                         55790000
558000            SUBSTR(ENT_NAME_DESC,1,:PV-POINTER) AND               55800000
558100            NOT :PV-SNAME-SUBSTR-LGTH2 = '  ') OR                 55810000
558200                (:PV-SNAME-SUBSTR-LGTH3 =                         55820000
558300            SUBSTR(ENT_NAME_DESC,1,:PV-POINTER) AND               55830000
558400            NOT :PV-SNAME-SUBSTR-LGTH3 = '   ') OR                55840000
558500                (:PV-SNAME-SUBSTR-LGTH4 =                         55850000
558600            SUBSTR(ENT_NAME_DESC,1,:PV-POINTER) AND               55860000
558700            NOT :PV-SNAME-SUBSTR-LGTH4 = '    ') OR               55870000
558800                (:PV-SNAME-SUBSTR-LGTH5 =                         55880000
558900            SUBSTR(ENT_NAME_DESC,1,:PV-POINTER) AND               55890000
559000            NOT :PV-SNAME-SUBSTR-LGTH5 = '     ') OR              55900000
559100                (:PV-SNAME-SUBSTR-LGTH6 =                         55910000
559200            SUBSTR(ENT_NAME_DESC,1,:PV-POINTER) AND               55920000
559300            NOT :PV-SNAME-SUBSTR-LGTH6 = '      ')                55930000
559400         END-EXEC                                                 55940000
559500                                                                  55950000
559600         EVALUATE TRUE                                            55960000
559700             WHEN SQLCODE = ZERO                                  55970000
559800             WHEN SQLCODE = -904                                  55980000
559900             WHEN SQLCODE = -913                                  55990000
560000                 CONTINUE                                         56000000
560100             WHEN SQLCODE = +100                                  56010000
560200             WHEN SQLCODE = -305                                  56020000
560300                 SET NO-EXISTING-SNAME TO TRUE                    56030000
560400             WHEN SQLWARN0 NOT = SPACES                           56040000
560500             WHEN SQLCODE < ZERO                                  56050000
560600             WHEN SQLCODE > ZERO                                  56060000
560700                 MOVE '5040-GET-MAX-ENT-NAME-DESC'                56070000
560800                                   TO DP013-PARAGRAPH             56080000
560900                 MOVE 'SELECT MAX ENT NAME'                       56090000
561000                                   TO DP013-MESSAGE-TEXT (1)      56100000
561100                 MOVE SQLCA        TO DP013-SQLCA                 56110000
561200                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    56120000
561300                 SET DP013-DB2-ABEND                              56130000
561400                     DP013-XCTL-DISPLAY-RESTART                   56140000
561500                                   TO TRUE                        56150000
561600                 PERFORM DP013-0000-PROCESS-ABEND                 56160000
561700         END-EVALUATE                                             56170000
561800     END-PERFORM.                                                 56180000
561900                                                                  56190000
562000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        56200000
562100         MOVE '5040-GET-MAX-ENT-NAME-DESC'                        56210000
562200                                   TO DP013-PARAGRAPH             56220000
562300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     56230000
562400                                   TO DP013-MESSAGE-TEXT (1)      56240000
562500         MOVE 'MAX ENT NAME'       TO DP013-MESSAGE-TEXT (2)      56250000
562600         MOVE SQLCA                TO DP013-SQLCA                 56260000
562700         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    56270000
562800         SET DP013-DB2-ABEND                                      56280000
562900             DP013-XCTL-DISPLAY-RESTART                           56290000
563000                                   TO TRUE                        56300000
563100         PERFORM DP013-0000-PROCESS-ABEND                         56310000
563200     END-IF.                                                      56320000
563300                                                                  56330000
563400******************************************************************56340000
563500**  MUST GET LENGTH OF SHORTNAME (WHEN LESS THAN 7 CHARACTERS)  **56350000
563600**  TO USE IN SELECT FOR MAX ENT NAME.                          **56360000
563700******************************************************************56370000
563800 5045-FIND-COMPARE-LENGTH.                                        56380000
563900     IF PV-SNAME-SUB-POS-3 = ' '                                  56390000
564000       MOVE PV-SNAME-SUBSTR-CMPR1   TO PV-SNAME-SUBSTR-LGTH2      56400000
564100       INITIALIZE PV-SNAME-SUBSTR-CMPR1                           56410000
564200       SET SNAME-LENGTH-2 TO TRUE                                 56420000
564300     ELSE                                                         56430000
564400     IF PV-SNAME-SUB-POS-4 = ' '                                  56440000
564500       MOVE PV-SNAME-SUBSTR-CMPR1   TO PV-SNAME-SUBSTR-LGTH3      56450000
564600       INITIALIZE PV-SNAME-SUBSTR-CMPR1                           56460000
564700       SET SNAME-LENGTH-3 TO TRUE                                 56470000
564800     ELSE                                                         56480000
564900     IF PV-SNAME-SUB-POS-5 = ' '                                  56490000
565000       MOVE PV-SNAME-SUBSTR-CMPR1   TO PV-SNAME-SUBSTR-LGTH4      56500000
565100       INITIALIZE PV-SNAME-SUBSTR-CMPR1                           56510000
565200       SET SNAME-LENGTH-4 TO TRUE                                 56520000
565300     ELSE                                                         56530000
565400     IF PV-SNAME-SUB-POS-6 = ' '                                  56540000
565500       MOVE PV-SNAME-SUBSTR-CMPR1 TO PV-SNAME-SUBSTR-LGTH5        56550000
565600       INITIALIZE PV-SNAME-SUBSTR-CMPR1                           56560000
565700       SET SNAME-LENGTH-5 TO TRUE                                 56570000
565800     ELSE                                                         56580000
565900     IF PV-SNAME-SUB-POS-7 = ' '                                  56590000
566000       MOVE PV-SNAME-SUBSTR-CMPR1 TO PV-SNAME-SUBSTR-LGTH6        56600000
566100       INITIALIZE PV-SNAME-SUBSTR-CMPR1                           56610000
566200       SET SNAME-LENGTH-6 TO TRUE.                                56620000
566300                                                                  56630000
566400******************************************************************56640000
566500***    CALCULATE NEXT AVAILABLE SHORT NAME SUFFIX              ***56650000
566600******************************************************************56660000
566700 5050-CALC-NEXT-SHORTNAME.                                        56670000
566800     INITIALIZE PV-SHORTNAME-TABLE                                56680000
566900                PV-ENT-DESC-SNAME                                 56690000
567000                PV-SHORTNAME-LT-7CHAR.                            56700000
567100     MOVE ENTNME-ENT-NAME-DESC TO PV-ENT-DESC-SNAME.              56710000
567200                                                                  56720000
567300******************************************************************56730000
567400***   WHEN SHORTNAME IS LESS THAN 7 CHARACTERS MUST SPLIT      ***56740000
567500***   SHORTNAME & SUFFIX IN ORDER TO CALCULATE THE NEXT        ***56750000
567600***   AVAILABLE SHORTNAME SUFFIX NUMBER.                       ***56760000
567700******************************************************************56770000
567800     EVALUATE TRUE                                                56780000
567900                                                                  56790000
568000         WHEN SNAME-LENGTH-2                                      56800000
568100             MOVE PV-ENT-DESC-L2-SNM    TO PV-SHORT-7CHAR         56810000
568200             MOVE PV-ENT-DESC-L2-SUFF   TO PV-SHORT-SUFF          56820000
568300             MOVE PV-SHORTNAME-LT-7CHAR TO PV-SHORTNAME-TABLE     56830000
568400                                                                  56840000
568500         WHEN SNAME-LENGTH-3                                      56850000
568600             MOVE PV-ENT-DESC-L3-SNM    TO PV-SHORT-7CHAR         56860000
568700             MOVE PV-ENT-DESC-L3-SUFF   TO PV-SHORT-SUFF          56870000
568800             MOVE PV-SHORTNAME-LT-7CHAR TO PV-SHORTNAME-TABLE     56880000
568900                                                                  56890000
569000         WHEN SNAME-LENGTH-4                                      56900000
569100             MOVE PV-ENT-DESC-L4-SNM    TO PV-SHORT-7CHAR         56910000
569200             MOVE PV-ENT-DESC-L4-SUFF   TO PV-SHORT-SUFF          56920000
569300             MOVE PV-SHORTNAME-LT-7CHAR TO PV-SHORTNAME-TABLE     56930000
569400                                                                  56940000
569500         WHEN SNAME-LENGTH-5                                      56950000
569600             MOVE PV-ENT-DESC-L5-SNM    TO PV-SHORT-7CHAR         56960000
569700             MOVE PV-ENT-DESC-L5-SUFF   TO PV-SHORT-SUFF          56970000
569800             MOVE PV-SHORTNAME-LT-7CHAR TO PV-SHORTNAME-TABLE     56980000
569900                                                                  56990000
570000         WHEN SNAME-LENGTH-6                                      57000000
570100             MOVE PV-ENT-DESC-L6-SNM    TO PV-SHORT-7CHAR         57010000
570200             MOVE PV-ENT-DESC-L6-SUFF   TO PV-SHORT-SUFF          57020000
570300             MOVE PV-SHORTNAME-LT-7CHAR TO PV-SHORTNAME-TABLE     57030000
570400                                                                  57040000
570500         WHEN OTHER                                               57050000
570600             MOVE PV-ENT-DESC-SNAME     TO PV-SHORTNAME-TABLE     57060000
570700                                                                  57070000
570800     END-EVALUATE.                                                57080000
570900                                                                  57090000
571000     IF PV-SNM-SUFFIX NOT NUMERIC                                 57100000
571100         MOVE '000' TO PV-SHORTNAME-SUFFIX                        57110000
571200     END-IF.                                                      57120000
571300                                                                  57130000
571400******************************************************************57140000
571500** IF SUFFIX IS = 999 BEFORE COMPUTE, THEN THE AUTO GENERATED   **57150000
571600** SHORTNAMES OF 7 CHARS AND 3 DIGIT SEQ NUMBER IS MAXED OUT    **57160000
571700** FOR THIS VENDOR NAME. WHEN THIS HAPPENS THE AUTO GENERATED   **57170000
571800** SHORTNAME WILL BE THE FIRST 6 OF THE 7 CHARS AND 4 DIGIT SEQ **57180000
571900** NUMBER STARTING AT 1000 WITH A MAX OF 9999.  ALSO THE        **57190000
572000** SHORTNAME CAN STILL BE MANUALLY ENTERED ON DATA ENTRY SCREEN.**57200000
572100******************************************************************57210000
572200     IF PV-SNM-SUFFIX = 999                                       57220000
572300        PERFORM 5070-BUILD-SHORTNAME-GT-999                       57230000
572400     ELSE                                                         57240000
572500        SET PS-NOT-VALID-SHORTNAME TO TRUE                        57250000
572600        MOVE PV-SNM-SUFFIX TO PV-SNM-SUFFIX-INCR                  57260000
572700        PERFORM 5060-BUILD-SHORTNAME                              57270000
572800           UNTIL PS-VALID-SHORTNAME                               57280000
572900     END-IF.                                                      57290000
573000                                                                  57300000
573100******************************************************************57310000
573200** WHEN SHORTNAME DERIVED IS LESS THAN 7 CHARACTERS PERFORM STRING57320000
573300** TO REMOVE SPACES BETWEEN DERIVED NAME AND SUFFIX               57330000
573400******************************************************************57340000
573500                                                                  57350000
573600 5060-BUILD-SHORTNAME.                                            57360000
573700                                                                  57370000
573800     COMPUTE PV-SNM-SUFFIX-INCR = PV-SNM-SUFFIX-INCR + 1.         57380000
573900                                                                  57390000
574000     MOVE PV-SNM-SUFFIX-INCR TO PV-SNM-SUFFIX.                    57400000
574100                                                                  57410000
574200     IF SHORTNAME-LT-7CHAR                                        57420000
574300         INITIALIZE PV-SHORTNAME-COMPARE                          57430000
574400         MOVE PV-SNM-SUFFIX-INCR TO PV-SHORT-SUFF                 57440000
574500         STRING PV-SHORT-7CHAR DELIMITED BY ' '                   57450000
574600                PV-SHORT-SUFF DELIMITED BY SIZE                   57460000
574700           INTO PV-SHORTNAME-COMPARE                              57470000
574800         INITIALIZE PV-SHORTNAME-TABLE                            57480000
574900         MOVE PV-SHORTNAME-COMPARE TO PV-SHORTNAME-TABLE          57490000
575000     END-IF.                                                      57500000
575100                                                                  57510000
575200     MOVE PV-SHORTNAME-TABLE   TO ENTNME-ENT-NAME-DESC            57520000
575300                                  ASC-VEND-SNME                   57530000
575400                                  AVNSNMEO.                       57540000
575500                                                                  57550000
575600     PERFORM 5065-VALIDATE-SHORTNAME.                             57560000
575700                                                                  57570000
575800******************************************************************57580000
575900** VERIFY SHORTNAME IS NOT ALREADY TAKEN.                       **57590000
576000******************************************************************57600000
576100 5065-VALIDATE-SHORTNAME.                                         57610000
576200                                                                  57620000
576300     PERFORM                                                      57630000
576400         WITH TEST AFTER                                          57640000
576500         VARYING PV-RETRY-COUNTER                                 57650000
576600         FROM 1 BY 1                                              57660000
576700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               57670000
576800                   OR (SQLCODE = ZERO)                            57680000
576900                   OR (SQLCODE = +100))                           57690000
577000                                                                  57700000
577100         EXEC SQL                                                 57710000
577200             SELECT COUNT(*)                                      57720000
577300               INTO  :PV-SNAME-CNT                                57730000
577400               FROM TENTNME                                       57740000
577500             WHERE                                                57750000
577600                ENT_NAME_DESC = :ENTNME-ENT-NAME-DESC             57760000
577700         END-EXEC                                                 57770000
577800                                                                  57780000
577900         EVALUATE TRUE                                            57790000
578000             WHEN SQLCODE = ZERO                                  57800000
578100                 IF PV-SNAME-CNT > 0                              57810000
578200                     CONTINUE                                     57820000
578300                 ELSE                                             57830000
578400                     SET PS-VALID-SHORTNAME TO TRUE               57840000
578500                 END-IF                                           57850000
578600             WHEN SQLCODE = +100                                  57860000
578700                 SET PS-VALID-SHORTNAME TO TRUE                   57870000
578800             WHEN SQLCODE = -904                                  57880000
578900             WHEN SQLCODE = -913                                  57890000
579000                 CONTINUE                                         57900000
579100             WHEN SQLWARN0 NOT = SPACES                           57910000
579200             WHEN SQLCODE < ZERO                                  57920000
579300             WHEN SQLCODE > ZERO                                  57930000
579400                 MOVE '5065-VALIDATE-SHORTNAME'                   57940000
579500                                   TO DP013-PARAGRAPH             57950000
579600                 MOVE 'SELECT TENTNME FOR VEND NAME:'             57960000
579700                                   TO DP013-MESSAGE-TEXT (1)      57970000
579800                 MOVE PV-VEND-NAME                                57980000
579900                                   TO DP013-MESSAGE-TEXT (2)      57990000
580000                 MOVE SQLCA        TO DP013-SQLCA                 58000000
580100                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    58010000
580200                 SET DP013-DB2-ABEND                              58020000
580300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           58030000
580400                 PERFORM DP013-0000-PROCESS-ABEND                 58040000
580500         END-EVALUATE                                             58050000
580600     END-PERFORM.                                                 58060000
580700                                                                  58070000
580800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        58080000
580900         MOVE '5065-VALIDATE-SHORTNAME'                           58090000
581000                                   TO DP013-PARAGRAPH             58100000
581100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     58110000
581200                                   TO DP013-MESSAGE-TEXT (1)      58120000
581300         MOVE 'TENTNME FOR VEND NAME'                             58130000
581400                                   TO DP013-MESSAGE-TEXT (2)      58140000
581500         MOVE PV-VEND-NAME         TO DP013-MESSAGE-TEXT (3)      58150000
581600         MOVE SQLCA                TO DP013-SQLCA                 58160000
581700         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    58170000
581800         SET DP013-DB2-ABEND                                      58180000
581900             DP013-XCTL-DISPLAY-RESTART                           58190000
582000                                   TO TRUE                        58200000
582100         PERFORM DP013-0000-PROCESS-ABEND                         58210000
582200     END-IF.                                                      58220000
582300                                                                  58230000
582400******************************************************************58240000
582500** WHEN SHORTNAME ENDS IN 999 THEN ATTEMPT TO CREATE A SHORTNAME  58250000
582600** THAT USES A SEQ NUMBER >= 1000.  THERE WILL ONLY BE ONE ATTEMPT58260000
582700** TO DO THIS.  IF THE ATTEMPT CANNOT BE DONE OR THE 4 DIGIT SEQ  58270000
582800** NUMBER IS ALREADY = 9999, THEN THE EXISTING ERROR MESSAGE 2057 58280000
582900** WILL BE DISPLAYED ON THE SCREEN.                               58290000
583000******************************************************************58300000
583100                                                                  58310000
583200 5070-BUILD-SHORTNAME-GT-999.                                     58320000
583300                                                                  58330000
583400     MOVE PV-ENT-DESC-SNAME TO PV-SHORTNAME-1000X-6X              58340000
583500                               PV-SHORTNAME-LIKE-6X               58350000
583600                               PV-SHORTNAME-NEW-6X.               58360000
583700     MOVE '1000'            TO PV-SHORTNAME-1000X-4X.             58370000
583800     MOVE '%'               TO PV-SHORTNAME-LIKE-1X.              58380000
583900                                                                  58390000
584000     PERFORM 5075-OPEN-SHORTNAME-CSR.                             58400000
584100     PERFORM 5076-FETCH-SHORTNAME-CSR.                            58410000
584200     PERFORM 5077-CLOSE-SHORTNAME-CSR.                            58420000
584300                                                                  58430000
584400******************************************************************58440000
584500** ADD CODE TO CHECK IF SUFFIX IS = 9999 BEFORE COMPUTE. THIS   **58450000
584600** MEANS THERE ARE NO MORE AUTO GENERATED SHORTNAMES AVAILABLE  **58460000
584700** FOR THIS VENDOR NAME. IF THIS HAPPENS WILL NEED TO MAKE AUTO **58470000
584800** GENERATED SHORTNAME 5 CHARACTERS PLUS 5 NUMERICS FOR MAX OF  **58480000
584900** 99999 OR SHORTNAME MUST BE MANUALLY ENTERED ON DATA ENTRY    **58490000
585000** SCREEN.                                                      **58500000
585100******************************************************************58510000
585200     IF PS-NEW-SHORTNAME-FOUND-ON-DB OR                           58520000
585300        PS-MAX-SEQ-NBR-REACHED                                    58530000
585400**   VENDOR SHORTNAME SUFFIX MAXIMUM REACHED - CONTACT DP         58540000
585500        MOVE PC-TSYMSG-02057        TO DP020-MSG-NUMBER           58550000
585600        SET PS-ERROR                TO TRUE                       58560000
585700        SET DP020-MSG-FATAL         TO TRUE                       58570000
585800        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       58580000
585900     ELSE                                                         58590000
586000        MOVE PV-SHORTNAME-NEW TO ENTNME-ENT-NAME-DESC             58600000
586100                                 ASC-VEND-SNME                    58610000
586200                                 AVNSNMEO                         58620000
586300     END-IF.                                                      58630000
586400                                                                  58640000
586500*----------------------------------------------------------------*58650000
586600* OPENS SHORTNAME CURSOR                                         *58660000
586700*----------------------------------------------------------------*58670000
586800 5075-OPEN-SHORTNAME-CSR.                                         58680000
586900                                                                  58690000
587000     PERFORM                                                      58700000
587100         WITH TEST AFTER                                          58710000
587200         VARYING PV-RETRY-COUNTER                                 58720000
587300         FROM 1 BY 1                                              58730000
587400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               58740000
587500                   OR (SQLCODE = ZERO))                           58750000
587600                                                                  58760000
587700         EXEC SQL                                                 58770000
587800             OPEN SHORTNAME_CSR                                   58780000
587900         END-EXEC                                                 58790000
588000                                                                  58800000
588100         EVALUATE TRUE                                            58810000
588200             WHEN SQLCODE = ZERO                                  58820000
588300             WHEN SQLCODE = -904                                  58830000
588400             WHEN SQLCODE = -913                                  58840000
588500                 CONTINUE                                         58850000
588600             WHEN SQLWARN0 NOT = SPACES                           58860000
588700             WHEN SQLCODE < ZERO                                  58870000
588800             WHEN SQLCODE > ZERO                                  58880000
588900                 MOVE '5075-OPEN-SHORTNAME-CSR    '               58890000
589000                                   TO DP013-PARAGRAPH             58900000
589100                 MOVE 'OPEN SHORTNAME CSR    '                    58910000
589200                                   TO DP013-MESSAGE-TEXT (1)      58920000
589300                 MOVE SQLCA        TO DP013-SQLCA                 58930000
589400                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    58940000
589500                 SET DP013-DB2-ABEND                              58950000
589600                     DP013-XCTL-DISPLAY-RESTART                   58960000
589700                                   TO TRUE                        58970000
589800                 PERFORM DP013-0000-PROCESS-ABEND                 58980000
589900         END-EVALUATE                                             58990000
590000     END-PERFORM.                                                 59000000
590100                                                                  59010000
590200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        59020000
590300         MOVE '5075-OPEN-SHORTNAME-CSR '                          59030000
590400                                   TO DP013-PARAGRAPH             59040000
590500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN'       59050000
590600                                   TO DP013-MESSAGE-TEXT (1)      59060000
590700         MOVE 'SHORTNAME CSR '     TO DP013-MESSAGE-TEXT (2)      59070000
590800         MOVE SQLCA                TO DP013-SQLCA                 59080000
590900         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    59090000
591000         SET DP013-DB2-ABEND                                      59100000
591100             DP013-XCTL-DISPLAY-RESTART                           59110000
591200                                   TO TRUE                        59120000
591300         PERFORM DP013-0000-PROCESS-ABEND                         59130000
591400     END-IF.                                                      59140000
591500                                                                  59150000
591600*----------------------------------------------------------------*59160000
591700* RETRIEVE SHORTNAME WITH THE HIGHEST SEQ NUMBER ON TENTNME FOR  *59170000
591800* THE VENDOR NAME BEING ADDED.  THIS HIGHEST SEQ NUMBER WILL     *59180000
591900* HAVE 1 ADDED TO IT FOR THE NEW SHORTNAME TO BE INSERTED LATER. *59190000
592000*                                                                *59200000
592100* IF THERE IS NO SHORTNAME FETCHED THEN 1000 IS USED AS THE      *59210000
592200* DEFAULT 4 DIGIT SEQ NUMBER FOR THE NEW SHORTNAME.              *59220000
592300*----------------------------------------------------------------*59230000
592400 5076-FETCH-SHORTNAME-CSR.                                        59240000
592500                                                                  59250000
592600     SET PS-DONT-CHECK-NEW-SHORTNAME TO TRUE.                     59260000
592700                                                                  59270000
592800     PERFORM                                                      59280000
592900         WITH TEST AFTER                                          59290000
593000         VARYING PV-RETRY-COUNTER                                 59300000
593100         FROM 1 BY 1                                              59310000
593200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59320000
593300                   OR (SQLCODE = ZERO)                            59330000
593400                   OR (SQLCODE = +100))                           59340000
593500                                                                  59350000
593600         EXEC SQL                                                 59360000
593700             FETCH SHORTNAME_CSR                                  59370000
593800             INTO  :PV-SHORTNAME-MAX                              59380000
593900         END-EXEC                                                 59390000
594000                                                                  59400000
594100         EVALUATE TRUE                                            59410000
594200             WHEN SQLCODE = ZERO                                  59420000
594300                  IF PV-SHORTNAME-MAX-4X = '9999'                 59430000
594400                     SET PS-DONT-CHECK-NEW-SHORTNAME              59440000
594500                         PS-MAX-SEQ-NBR-REACHED      TO TRUE      59450000
594600                  ELSE                                            59460000
594700                     MOVE PV-SHORTNAME-MAX-4X TO                  59470000
594800                          PV-SNM-SUFFIX-INCR4                     59480000
594900                     COMPUTE PV-SNM-SUFFIX-INCR4 =                59490000
595000                             PV-SNM-SUFFIX-INCR4 + 1              59500000
595100                     MOVE PV-SNM-SUFFIX-INCR4 TO                  59510000
595200                          PV-SHORTNAME-NEW-4X                     59520000
595300                     SET PS-CHECK-NEW-SHORTNAME                   59530000
595400                         PS-MAX-SEQ-NBR-NOT-REACHED  TO TRUE      59540000
595500                  END-IF                                          59550000
595600             WHEN SQLCODE = +100                                  59560000
595700                  MOVE '1000' TO PV-SHORTNAME-NEW-4X              59570000
595800                  SET PS-CHECK-NEW-SHORTNAME TO TRUE              59580000
595900             WHEN SQLCODE = -904                                  59590000
596000             WHEN SQLCODE = -913                                  59600000
596100                 CONTINUE                                         59610000
596200             WHEN SQLWARN0 NOT = SPACES                           59620000
596300             WHEN SQLCODE < ZERO                                  59630000
596400             WHEN SQLCODE > ZERO                                  59640000
596500                 MOVE '5076-FETCH-SHORTNAME-CSR      '            59650000
596600                                   TO DP013-PARAGRAPH             59660000
596700                 MOVE SQLCA        TO DP013-SQLCA                 59670000
596800                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    59680000
596900                 SET DP013-DB2-ABEND                              59690000
597000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           59700000
597100                 PERFORM DP013-0000-PROCESS-ABEND                 59710000
597200         END-EVALUATE                                             59720000
597300     END-PERFORM.                                                 59730000
597400                                                                  59740000
597500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        59750000
597600         MOVE '5076-FETCH-SHORTNAME-CSR      '                    59760000
597700                                   TO DP013-PARAGRAPH             59770000
597800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO FETCH '     59780000
597900                                   TO DP013-MESSAGE-TEXT (1)      59790000
598000         MOVE 'SHORTNAME MAX SEQ '                                59800000
598100                                   TO DP013-MESSAGE-TEXT (2)      59810000
598200         MOVE SQLCA                TO DP013-SQLCA                 59820000
598300         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    59830000
598400         SET DP013-DB2-ABEND                                      59840000
598500             DP013-XCTL-DISPLAY-RESTART                           59850000
598600                                   TO TRUE                        59860000
598700         PERFORM DP013-0000-PROCESS-ABEND                         59870000
598800     END-IF.                                                      59880000
598900                                                                  59890000
599000     IF PS-CHECK-NEW-SHORTNAME                                    59900000
599100        PERFORM 5078-CHECK-NEW-SHORTNAME                          59910000
599200     END-IF.                                                      59920000
599300                                                                  59930000
599400*----------------------------------------------------------------*59940000
599500* CLOSE SHORTNAME CURSOR                                         *59950000
599600*----------------------------------------------------------------*59960000
599700 5077-CLOSE-SHORTNAME-CSR.                                        59970000
599800                                                                  59980000
599900     PERFORM                                                      59990000
600000         WITH TEST AFTER                                          60000000
600100         VARYING PV-RETRY-COUNTER                                 60010000
600200         FROM 1 BY 1                                              60020000
600300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60030000
600400                   OR (SQLCODE = ZERO))                           60040000
600500                                                                  60050000
600600         EXEC SQL                                                 60060000
600700             CLOSE SHORTNAME_CSR                                  60070000
600800         END-EXEC                                                 60080000
600900                                                                  60090000
601000         EVALUATE TRUE                                            60100000
601100             WHEN SQLCODE = ZERO                                  60110000
601200             WHEN SQLCODE = -904                                  60120000
601300             WHEN SQLCODE = -913                                  60130000
601400                 CONTINUE                                         60140000
601500             WHEN SQLWARN0 NOT = SPACES                           60150000
601600             WHEN SQLCODE < ZERO                                  60160000
601700             WHEN SQLCODE > ZERO                                  60170000
601800                 MOVE '5077-CLOSE-SHORTNAME-CSR '                 60180000
601900                                   TO DP013-PARAGRAPH             60190000
602000                 MOVE 'CLOSE SHORTNAME CSR '                      60200000
602100                                   TO DP013-MESSAGE-TEXT (1)      60210000
602200                 MOVE SQLCA        TO DP013-SQLCA                 60220000
602300                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    60230000
602400                 SET DP013-DB2-ABEND                              60240000
602500                     DP013-XCTL-DISPLAY-RESTART                   60250000
602600                                   TO TRUE                        60260000
602700                 PERFORM DP013-0000-PROCESS-ABEND                 60270000
602800         END-EVALUATE                                             60280000
602900     END-PERFORM.                                                 60290000
603000                                                                  60300000
603100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60310000
603200         MOVE '5077-CLOSE-SHORTNAME-CSR '                         60320000
603300                                   TO DP013-PARAGRAPH             60330000
603400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO CLOSE'      60340000
603500                                   TO DP013-MESSAGE-TEXT (1)      60350000
603600         MOVE 'SHORTNAME CSR '     TO DP013-MESSAGE-TEXT (2)      60360000
603700         MOVE SQLCA                TO DP013-SQLCA                 60370000
603800         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    60380000
603900         SET DP013-DB2-ABEND                                      60390000
604000             DP013-XCTL-DISPLAY-RESTART                           60400000
604100                                   TO TRUE                        60410000
604200         PERFORM DP013-0000-PROCESS-ABEND                         60420000
604300     END-IF.                                                      60430000
604400                                                                  60440000
604500*----------------------------------------------------------------*60450000
604600* CHECK IF THE NEW SHORTNAME IS ALREADY ON THE DATABASE          *60460000
604700*----------------------------------------------------------------*60470000
604800 5078-CHECK-NEW-SHORTNAME.                                        60480000
604900                                                                  60490000
605000     PERFORM                                                      60500000
605100         WITH TEST AFTER                                          60510000
605200         VARYING PV-RETRY-COUNTER                                 60520000
605300         FROM 1 BY 1                                              60530000
605400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60540000
605500                   OR (SQLCODE = ZERO)                            60550000
605600                   OR (SQLCODE = +100))                           60560000
605700                                                                  60570000
605800         EXEC SQL                                                 60580000
605900           SELECT '1'                                             60590000
606000            INTO  :PV-ONE                                         60600000
606100             FROM SYSIBM.SYSDUMMY1 X                              60610000
606200            WHERE EXISTS (SELECT 1                                60620000
606300                            FROM TENTNME                          60630000
606400                           WHERE ENT_NAME_DESC = :PV-SHORTNAME-NEW60640000
606500                             AND TYPE_CDE = '04'                  60650000
606600                             AND X.IBMREQD = X.IBMREQD)           60660000
606700         END-EXEC                                                 60670000
606800                                                                  60680000
606900         EVALUATE TRUE                                            60690000
607000             WHEN SQLCODE = ZERO                                  60700000
607100             WHEN SQLCODE = -811                                  60710000
607200                 SET PS-NEW-SHORTNAME-FOUND-ON-DB TO TRUE         60720000
607300             WHEN SQLCODE = +100                                  60730000
607400                 SET PS-NEW-SHORTNAME-NOT-FOUND TO TRUE           60740000
607500             WHEN SQLCODE = -904                                  60750000
607600             WHEN SQLCODE = -913                                  60760000
607700                 CONTINUE                                         60770000
607800             WHEN SQLWARN0 NOT = SPACES                           60780000
607900             WHEN SQLCODE < ZERO                                  60790000
608000             WHEN SQLCODE > ZERO                                  60800000
608100                 MOVE '5078-CHECK-NEW-SHORTNAME'                  60810000
608200                                   TO DP013-PARAGRAPH             60820000
608300                 MOVE 'CHECK SHORTNAME EXISTS'                    60830000
608400                                   TO DP013-MESSAGE-TEXT (1)      60840000
608500                 MOVE SQLCA        TO DP013-SQLCA                 60850000
608600                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    60860000
608700                 SET DP013-DB2-ABEND                              60870000
608800                     DP013-XCTL-DISPLAY-RESTART                   60880000
608900                                   TO TRUE                        60890000
609000                 PERFORM DP013-0000-PROCESS-ABEND                 60900000
609100         END-EVALUATE                                             60910000
609200     END-PERFORM.                                                 60920000
609300                                                                  60930000
609400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60940000
609500         MOVE '5078-CHECK-NEW-SHORTNAME'                          60950000
609600                                   TO DP013-PARAGRAPH             60960000
609700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     60970000
609800                                   TO DP013-MESSAGE-TEXT (1)      60980000
609900         MOVE 'SHORTNAME   '       TO DP013-MESSAGE-TEXT (2)      60990000
610000         MOVE SQLCA                TO DP013-SQLCA                 61000000
610100         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    61010000
610200         SET DP013-DB2-ABEND                                      61020000
610300             DP013-XCTL-DISPLAY-RESTART                           61030000
610400                                   TO TRUE                        61040000
610500         PERFORM DP013-0000-PROCESS-ABEND                         61050000
610600     END-IF.                                                      61060000
610700                                                                  61070000
610800******************************************************************61080000
610900** UPDATE THE ROW ON THE DB2 TABLE.                             **61090000
611000******************************************************************61100000
611100 5100-UPDATE-TEXTENT.                                             61110000
611200                                                                  61120000
611300     PERFORM                                                      61130000
611400         WITH TEST AFTER                                          61140000
611500         VARYING PV-RETRY-COUNTER                                 61150000
611600         FROM 1 BY 1                                              61160000
611700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61170000
611800                   OR (SQLCODE = ZERO))                           61180000
611900         EXEC SQL                                                 61190000
612000           UPDATE TEXTENT                                         61200000
612100              SET STATUS_CDE         = :EXTENT-STATUS-CDE,        61210000
612200                  PRNT_CO_ENT_ID     = :EXTENT-PRNT-CO-ENT-ID,    61220000
612300                  HLD_PAYT_IND       = :EXTENT-HLD-PAYT-IND,      61230000
612400                  PAY_FCTR_VND_IND   = :EXTENT-PAY-FCTR-VND-IND,  61240000
612500                  SEPR_INVC_PAYT_IND = :EXTENT-SEPR-INVC-PAYT-IND,61250000
612600                  EDI_PO_PREPK_CDE   = :EXTENT-EDI-PO-PREPK-CDE,  61260000
612700                  NDA_IND            = :EXTENT-NDA-IND,           61270000
612800                  NDA_BEG_DTE        = :EXTENT-NDA-BEG-DTE,       61280000
612900                  NDA_END_DTE        = :EXTENT-NDA-END-DTE,       61290000
613000                  MDSE_VENDOR_IND    = :EXTENT-MDSE-VENDOR-IND,   61300000
613100                  CARRIER_IND        = :EXTENT-CARRIER-IND,       61310000
613200                  SCAC_CDE           = :EXTENT-SCAC-CDE,          61320000
613300                  CARR_MAN_PRO_IND   = :EXTENT-CARR-MAN-PRO-IND,  61330000
613400                  EXP_VEND_IND       = :EXTENT-EXP-VEND-IND,      61340000
613500                  CAP_EXP_CDE        = :EXTENT-CAP-EXP-CDE,       61350000
613600                  VND_CLSN_CDE       = :EXTENT-VND-CLSN-CDE,      61360000
613700                  VND_PRSST_CDE      = :EXTENT-VND-PRSST-CDE,     61370000
613800                  NEED_1099_IND      = :EXTENT-NEED-1099-IND,     61380000
613900*                 FED_TX_ID_TYP_CDE  = :EXTENT-FED-TX-ID-TYP-CDE, 61390000
614000*                 FED_TX_ID_NBR      = :EXTENT-FED-TX-ID-NBR,     61400000
614100                  WHLDG_PAYT_TYP_CDE = :EXTENT-WHLDG-PAYT-TYP-CDE,61410000
614200                  FCTR_IND           = :EXTENT-FCTR-IND,          61420000
614300                  PRNT_CO_IND        = :EXTENT-PRNT-CO-IND,       61430000
614400                  PAYT_HNDLG_CDE     = :EXTENT-PAYT-HNDLG-CDE,    61440000
614500                  LAST_UPD_BY_UID    = :DP020-USERID,             61450000
614600                  LAST_UPD_TMST      = CURRENT TIMESTAMP,         61460000
614700                  PRIM_TYP_CDE       = :EXTENT-PRIM-TYP-CDE,      61470000
614800                  PRTNR_IND          = :EXTENT-PRTNR-IND,         61480000
614900                  PRTNR_TYP_CDE      = :EXTENT-PRTNR-TYP-CDE,     61490000
615000                  LNE_OF_CR_AMT      = :EXTENT-LNE-OF-CR-AMT,     61500000
615100                  VND_IN_RMS_IND     = :EXTENT-VND-IN-RMS-IND     61510000
615200             WHERE ENT_ID  = :ASC-ENT-ID                          61520000
615300         END-EXEC                                                 61530000
615400                                                                  61540000
615500         EVALUATE TRUE                                            61550000
615600             WHEN SQLCODE = ZERO                                  61560000
615700             WHEN SQLCODE = -904                                  61570000
615800             WHEN SQLCODE = -913                                  61580000
615900                 CONTINUE                                         61590000
616000             WHEN SQLWARN0 NOT = SPACES                           61600000
616100             WHEN SQLCODE < ZERO                                  61610000
616200             WHEN SQLCODE > ZERO                                  61620000
616300                 MOVE '5100-UPDATE-TEXTENT'                       61630000
616400                                   TO DP013-PARAGRAPH             61640000
616500                 MOVE 'UPDATE A ROW ON THE EXTERNAL ENT TABLE'    61650000
616600                                   TO DP013-MESSAGE-TEXT(1)       61660000
616700                 MOVE SQLCA        TO DP013-SQLCA                 61670000
616800                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    61680000
616900                 SET DP013-DB2-ABEND                              61690000
617000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           61700000
617100                 PERFORM DP013-0000-PROCESS-ABEND                 61710000
617200         END-EVALUATE                                             61720000
617300     END-PERFORM.                                                 61730000
617400                                                                  61740000
617500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        61750000
617600         MOVE '5100-UPDATE-TEXTENT'                               61760000
617700                                   TO DP013-PARAGRAPH             61770000
617800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A VEN61780000
617900-             'DOR'                TO DP013-MESSAGE-TEXT (1)      61790000
618000         MOVE SQLCA                TO DP013-SQLCA                 61800000
618100         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    61810000
618200         SET DP013-DB2-ABEND                                      61820000
618300             DP013-XCTL-DISPLAY-RESTART                           61830000
618400                                   TO TRUE                        61840000
618500         PERFORM DP013-0000-PROCESS-ABEND                         61850000
618600     END-IF.                                                      61860000
618700                                                                  61870000
618800******************************************************************61880000
618900** UPDATE THE NDA INDICATOR AND BEGIN/END DATES ON TEXTENT.     **61890000
619000******************************************************************61900000
619100 5160-UPDATE-NDA-IND.                                             61910000
619200                                                                  61920000
619300     MOVE ASC-NDA-IND             TO EXTENT-NDA-IND.              61930000
619400                                                                  61940000
619500     PERFORM                                                      61950000
619600         WITH TEST AFTER                                          61960000
619700         VARYING PV-RETRY-COUNTER                                 61970000
619800         FROM 1 BY 1                                              61980000
619900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61990000
620000                   OR (SQLCODE = ZERO))                           62000000
620100         EXEC SQL                                                 62010000
620200           UPDATE TEXTENT                                         62020000
620300              SET NDA_IND            = :EXTENT-NDA-IND            62030000
620400                 ,NDA_BEG_DTE        = :PV-BEGIN-DATE             62040000
620500                 ,NDA_END_DTE        = :PV-END-DATE               62050000
620600             WHERE ENT_ID  = :ASC-ENT-ID                          62060000
620700         END-EXEC                                                 62070000
620800                                                                  62080000
620900         EVALUATE TRUE                                            62090000
621000             WHEN SQLCODE = ZERO                                  62100000
621100             WHEN SQLCODE = -904                                  62110000
621200             WHEN SQLCODE = -913                                  62120000
621300                 CONTINUE                                         62130000
621400             WHEN SQLWARN0 NOT = SPACES                           62140000
621500             WHEN SQLCODE < ZERO                                  62150000
621600             WHEN SQLCODE > ZERO                                  62160000
621700                 MOVE '5160-UPDATE-NDA-IND'                       62170000
621800                                   TO DP013-PARAGRAPH             62180000
621900                 MOVE 'UPDATE THE NDA IND AND DATES'              62190000
622000                                   TO DP013-MESSAGE-TEXT(1)       62200000
622100                 MOVE SQLCA        TO DP013-SQLCA                 62210000
622200                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    62220000
622300                 SET DP013-DB2-ABEND                              62230000
622400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           62240000
622500                 PERFORM DP013-0000-PROCESS-ABEND                 62250000
622600         END-EVALUATE                                             62260000
622700     END-PERFORM.                                                 62270000
622800                                                                  62280000
622900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        62290000
623000         MOVE '5160-UPDATE-NDA-IND'                               62300000
623100                                   TO DP013-PARAGRAPH             62310000
623200         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO UPDATE NDA      62320000
623300-             'IND DATA'           TO DP013-MESSAGE-TEXT (1)      62330000
623400         MOVE SQLCA                TO DP013-SQLCA                 62340000
623500         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    62350000
623600         SET DP013-DB2-ABEND                                      62360000
623700             DP013-XCTL-DISPLAY-RESTART                           62370000
623800                                   TO TRUE                        62380000
623900         PERFORM DP013-0000-PROCESS-ABEND                         62390000
624000     END-IF.                                                      62400000
624100                                                                  62410000
624200 5200-UPDATE-TENTNME.                                             62420000
624300                                                                  62430000
624400     PERFORM                                                      62440000
624500         WITH TEST AFTER                                          62450000
624600         VARYING PV-RETRY-COUNTER                                 62460000
624700         FROM 1 BY 1                                              62470000
624800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62480000
624900                   OR (SQLCODE = ZERO)                            62490000
625000                   OR (SQLCODE = +100))                           62500000
625100         EXEC SQL                                                 62510000
625200             UPDATE TENTNME                                       62520000
625300                 SET ENT_NAME_DESC   = :ENTNME-ENT-NAME-DESC      62530000
625400             WHERE ENT_ID   = :ASC-ENT-ID                         62540000
625500               AND TYPE_CDE = :PV-TYPE-CODE                       62550000
625600         END-EXEC                                                 62560000
625700                                                                  62570000
625800         EVALUATE TRUE                                            62580000
625900             WHEN SQLCODE = ZERO                                  62590000
626000             WHEN SQLCODE = +100                                  62600000
626100             WHEN SQLCODE = -904                                  62610000
626200             WHEN SQLCODE = -913                                  62620000
626300                 CONTINUE                                         62630000
626400             WHEN SQLWARN0 NOT = SPACES                           62640000
626500             WHEN SQLCODE < ZERO                                  62650000
626600             WHEN SQLCODE > ZERO                                  62660000
626700                 MOVE '5200-UPDATE-TENTNME'                       62670000
626800                                   TO DP013-PARAGRAPH             62680000
626900                 MOVE 'UPDATE A ROW ON THE ENTITY NAME TABLE'     62690000
627000                                   TO DP013-MESSAGE-TEXT(1)       62700000
627100                 MOVE SQLCA        TO DP013-SQLCA                 62710000
627200                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    62720000
627300                 SET DP013-DB2-ABEND                              62730000
627400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           62740000
627500                 PERFORM DP013-0000-PROCESS-ABEND                 62750000
627600         END-EVALUATE                                             62760000
627700     END-PERFORM.                                                 62770000
627800                                                                  62780000
627900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        62790000
628000         MOVE '5200-UPDATE-TENTNME'                               62800000
628100                                   TO DP013-PARAGRAPH             62810000
628200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A VEN62820000
628300-             'DOR NAME'           TO DP013-MESSAGE-TEXT (1)      62830000
628400         MOVE SQLCA                TO DP013-SQLCA                 62840000
628500         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    62850000
628600         SET DP013-DB2-ABEND                                      62860000
628700             DP013-XCTL-DISPLAY-RESTART                           62870000
628800                                   TO TRUE                        62880000
628900         PERFORM DP013-0000-PROCESS-ABEND                         62890000
629000     END-IF.                                                      62900000
629100                                                                  62910000
629200*----------------------------------------------------------------*62920000
629300* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *62930000
629400* OBJECT WAS UDPATED.                                            *62940000
629500*----------------------------------------------------------------*62950000
629600 5400-UPDATE-SELECTION-QUEUE.                                     62960000
629700                                                                  62970000
629800     PERFORM 9100-READ-SEL-QUEUE.                                 62980000
629900     SET VN003-UPD (ASC-SEL-SUB) TO TRUE.                         62990000
630000     PERFORM 9200-REWRITE-LIST-QUEUE.                             63000000
630100                                                                  63010000
630200*----------------------------------------------------------------*63020000
630300* AUTOMATICALLY GENERATE A DUNS NUMBER FOR THE VENDOR IF ONE IS  *63030000
630400* NOT ENTERED.                                                   *63040000
630500*----------------------------------------------------------------*63050000
630600 5600-AUTO-GENERATE-DUNS.                                         63060000
630700                                                                  63070000
630800     PERFORM 5609-OPEN-VENDOR-NBR-CSR.                            63080000
630900     PERFORM 5610-FETCH-VENDOR-NBR-CSR.                           63090000
631000     SET PS-VENDOR-NBR-NOT-DERIVED TO TRUE.                       63100000
631100     COMPUTE PV-VNDR-NBR-CALC-N = PV-VNDR-NBR-CALC-N + 1.         63110000
631200     INITIALIZE PV-VENDOR-COUNT.                                  63120000
631300     PERFORM 5605-CALCULATE-VENDOR-NUMBER                         63130000
631400       UNTIL PS-VENDOR-NBR-DERIVED.                               63140000
631500                                                                  63150000
631600*----------------------------------------------------------------*63160000
631700* CALCULATE THE VENDOR NUMBER                                    *63170000
631800*----------------------------------------------------------------*63180000
631900 5605-CALCULATE-VENDOR-NUMBER.                                    63190000
632000                                                                  63200000
632100     IF PV-VENDOR-COUNT = 100                                     63210000
632200         PERFORM 6600-UPDATE-TVNDCTL                              63220000
632300         SET PS-VENDOR-NBR-DERIVED TO TRUE                        63230000
632400         SET PS-ERROR          TO TRUE                            63240000
632500         SET DP020-MSG-FATAL   TO TRUE                            63250000
632600*        --- CANNOT GENERATE VENDOR NUMBER -- RETRY ---           63260000
632700         MOVE PC-TSYMSG-01877  TO DP020-MSG-NUMBER                63270000
632800         MOVE DP015-UNP-ALP-BRT-OFF                               63280000
632900                               TO ADUNNBRA                        63290000
633000         MOVE DP015-RED        TO ADUNNBRC                        63300000
633100         MOVE DP015-REVERSE    TO ADUNNBRH                        63310000
633200         MOVE -1               TO ADUNNBRL                        63320000
633300         SET DP030-SET-CURSOR-APPL-1                              63330000
633400                               TO TRUE                            63340000
633500     END-IF.                                                      63350000
633600                                                                  63360000
633700     MOVE PV-VNDR-NBR-CALC TO PV-DUN-NBR.                         63370000
633800     PERFORM 3310-SELECT-TEXTENT-DUN.                             63380000
633900     IF SQLCODE = +0                                              63390000
634000        ADD 1 TO PV-VNDR-NBR-CALC-N                               63400000
634100        ADD 1 TO PV-VENDOR-COUNT                                  63410000
634200     ELSE                                                         63420000
634300        SET PS-VENDOR-NBR-DERIVED TO TRUE                         63430000
634400        MOVE PV-VNDR-NBR-CALC TO ASC-DUN-NBR                      63440000
634500     END-IF.                                                      63450000
634600                                                                  63460000
634700     MOVE PV-VNDR-NBR-CALC TO VNDCTL-LAST-ASG-VND-NBR.            63470000
634800                                                                  63480000
634900*----------------------------------------------------------------*63490000
635000* OPENS VENDOR NUMBER CURSOR                                     *63500000
635100*----------------------------------------------------------------*63510000
635200 5609-OPEN-VENDOR-NBR-CSR.                                        63520000
635300                                                                  63530000
635400     PERFORM                                                      63540000
635500         WITH TEST AFTER                                          63550000
635600         VARYING PV-RETRY-COUNTER                                 63560000
635700         FROM 1 BY 1                                              63570000
635800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               63580000
635900                   OR (SQLCODE = ZERO))                           63590000
636000                                                                  63600000
636100         EXEC SQL                                                 63610000
636200             OPEN VND_NBR_CSR                                     63620000
636300         END-EXEC                                                 63630000
636400                                                                  63640000
636500         EVALUATE TRUE                                            63650000
636600             WHEN SQLCODE = ZERO                                  63660000
636700             WHEN SQLCODE = -904                                  63670000
636800             WHEN SQLCODE = -913                                  63680000
636900                 CONTINUE                                         63690000
637000             WHEN SQLWARN0 NOT = SPACES                           63700000
637100             WHEN SQLCODE < ZERO                                  63710000
637200             WHEN SQLCODE > ZERO                                  63720000
637300                 MOVE '5609-OPEN-VENDOR-NUMBER-CSR'               63730000
637400                                   TO DP013-PARAGRAPH             63740000
637500                 MOVE 'OPEN VENDOR NUMBER CSR'                    63750000
637600                                   TO DP013-MESSAGE-TEXT (1)      63760000
637700                 MOVE SQLCA        TO DP013-SQLCA                 63770000
637800                 MOVE 'TVNDCTL'    TO DP013-DB2-TABLE-NAME (1)    63780000
637900                 SET DP013-DB2-ABEND                              63790000
638000                     DP013-XCTL-DISPLAY-RESTART                   63800000
638100                                   TO TRUE                        63810000
638200                 PERFORM DP013-0000-PROCESS-ABEND                 63820000
638300         END-EVALUATE                                             63830000
638400     END-PERFORM.                                                 63840000
638500                                                                  63850000
638600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        63860000
638700         MOVE '5609-OPEN-VENDOR-NBR-CSR'                          63870000
638800                                   TO DP013-PARAGRAPH             63880000
638900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN'       63890000
639000                                   TO DP013-MESSAGE-TEXT (1)      63900000
639100         MOVE 'VENDOR NBR CSR'     TO DP013-MESSAGE-TEXT (2)      63910000
639200         MOVE SQLCA                TO DP013-SQLCA                 63920000
639300         MOVE 'TVNDCTL'            TO DP013-DB2-TABLE-NAME (1)    63930000
639400         SET DP013-DB2-ABEND                                      63940000
639500             DP013-XCTL-DISPLAY-RESTART                           63950000
639600                                   TO TRUE                        63960000
639700         PERFORM DP013-0000-PROCESS-ABEND                         63970000
639800     END-IF.                                                      63980000
639900                                                                  63990000
640000*----------------------------------------------------------------*64000000
640100* RETRIEVE THE LAST GENERATED VENDOR NUMBER.                     *64010000
640200* USING A CURSOR TO HOLD A LOCK ON THIS TABLE UNTIL SO ANOTHER   *64020000
640300* USER DOESN'T GRAB THE SAME VENDOR                              *64030000
640400*----------------------------------------------------------------*64040000
640500 5610-FETCH-VENDOR-NBR-CSR.                                       64050000
640600                                                                  64060000
640700     PERFORM                                                      64070000
640800         WITH TEST AFTER                                          64080000
640900         VARYING PV-RETRY-COUNTER                                 64090000
641000         FROM 1 BY 1                                              64100000
641100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               64110000
641200                   OR (SQLCODE = ZERO))                           64120000
641300                                                                  64130000
641400         EXEC SQL                                                 64140000
641500             FETCH VND_NBR_CSR                                    64150000
641600             INTO  :VNDCTL-LAST-ASG-VND-NBR                       64160000
641700         END-EXEC                                                 64170000
641800                                                                  64180000
641900         EVALUATE TRUE                                            64190000
642000             WHEN SQLCODE = ZERO                                  64200000
642100                  MOVE VNDCTL-LAST-ASG-VND-NBR TO PV-VNDR-NBR-CALC64210000
642200             WHEN SQLCODE = -904                                  64220000
642300             WHEN SQLCODE = -913                                  64230000
642400                 CONTINUE                                         64240000
642500             WHEN SQLWARN0 NOT = SPACES                           64250000
642600             WHEN SQLCODE < ZERO                                  64260000
642700             WHEN SQLCODE > ZERO                                  64270000
642800                 MOVE '5610-FETCH-VENDOR-NBR-CSR     '            64280000
642900                                   TO DP013-PARAGRAPH             64290000
643000                 MOVE SQLCA        TO DP013-SQLCA                 64300000
643100                 MOVE 'TVNDCTL'    TO DP013-DB2-TABLE-NAME (1)    64310000
643200                 SET DP013-DB2-ABEND                              64320000
643300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           64330000
643400                 PERFORM DP013-0000-PROCESS-ABEND                 64340000
643500         END-EVALUATE                                             64350000
643600     END-PERFORM.                                                 64360000
643700                                                                  64370000
643800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        64380000
643900         MOVE '5610-FETCH-VENDOR-NBR-CSR     '                    64390000
644000                                   TO DP013-PARAGRAPH             64400000
644100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     64410000
644200                                   TO DP013-MESSAGE-TEXT (1)      64420000
644300         MOVE 'LAST VENDOR NUMBER'                                64430000
644400                                   TO DP013-MESSAGE-TEXT (2)      64440000
644500         MOVE SQLCA                TO DP013-SQLCA                 64450000
644600         MOVE 'TVNDCTL'            TO DP013-DB2-TABLE-NAME (1)    64460000
644700         SET DP013-DB2-ABEND                                      64470000
644800             DP013-XCTL-DISPLAY-RESTART                           64480000
644900                                   TO TRUE                        64490000
645000         PERFORM DP013-0000-PROCESS-ABEND                         64500000
645100     END-IF.                                                      64510000
645200                                                                  64520000
645300*----------------------------------------------------------------*64530000
645400* CLOSE VENDOR NUMBER CURSOR                                     *64540000
645500*----------------------------------------------------------------*64550000
645600 5611-CLOSE-VENDOR-NBR-CSR.                                       64560000
645700                                                                  64570000
645800     PERFORM                                                      64580000
645900         WITH TEST AFTER                                          64590000
646000         VARYING PV-RETRY-COUNTER                                 64600000
646100         FROM 1 BY 1                                              64610000
646200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               64620000
646300                   OR (SQLCODE = ZERO))                           64630000
646400                                                                  64640000
646500         EXEC SQL                                                 64650000
646600             CLOSE VND_NBR_CSR                                    64660000
646700         END-EXEC                                                 64670000
646800                                                                  64680000
646900         EVALUATE TRUE                                            64690000
647000             WHEN SQLCODE = ZERO                                  64700000
647100             WHEN SQLCODE = -904                                  64710000
647200             WHEN SQLCODE = -913                                  64720000
647300                 CONTINUE                                         64730000
647400             WHEN SQLWARN0 NOT = SPACES                           64740000
647500             WHEN SQLCODE < ZERO                                  64750000
647600             WHEN SQLCODE > ZERO                                  64760000
647700                 MOVE '5611-CLOSE-VENDOR-NBR-CSR'                 64770000
647800                                   TO DP013-PARAGRAPH             64780000
647900                 MOVE 'CLOSE VENDOR NBR CSR'                      64790000
648000                                   TO DP013-MESSAGE-TEXT (1)      64800000
648100                 MOVE SQLCA        TO DP013-SQLCA                 64810000
648200                 MOVE 'TVNDCTL'    TO DP013-DB2-TABLE-NAME (1)    64820000
648300                 SET DP013-DB2-ABEND                              64830000
648400                     DP013-XCTL-DISPLAY-RESTART                   64840000
648500                                   TO TRUE                        64850000
648600                 PERFORM DP013-0000-PROCESS-ABEND                 64860000
648700         END-EVALUATE                                             64870000
648800     END-PERFORM.                                                 64880000
648900                                                                  64890000
649000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        64900000
649100         MOVE '5611-CLOSE-VENDOR-NBR-CSR'                         64910000
649200                                   TO DP013-PARAGRAPH             64920000
649300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO CLOSE'      64930000
649400                                   TO DP013-MESSAGE-TEXT (1)      64940000
649500         MOVE 'VENDOR NBR CSR'     TO DP013-MESSAGE-TEXT (2)      64950000
649600         MOVE SQLCA                TO DP013-SQLCA                 64960000
649700         MOVE 'TVNDCTL'            TO DP013-DB2-TABLE-NAME (1)    64970000
649800         SET DP013-DB2-ABEND                                      64980000
649900             DP013-XCTL-DISPLAY-RESTART                           64990000
650000                                   TO TRUE                        65000000
650100         PERFORM DP013-0000-PROCESS-ABEND                         65010000
650200     END-IF.                                                      65020000
650300                                                                  65030000
650400*----------------------------------------------------------------*65040000
650500* SELECT A ROW FROM THE DB2 SYSTEM VENDOR NAME TABLE.            *65050000
650600*----------------------------------------------------------------*65060000
650700 5999-GET-MAX-TENTNME.                                            65070000
650800                                                                  65080000
650900     PERFORM                                                      65090000
651000         WITH TEST AFTER                                          65100000
651100         VARYING PV-RETRY-COUNTER                                 65110000
651200         FROM 1 BY 1                                              65120000
651300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65130000
651400                   OR (SQLCODE = ZERO))                           65140000
651500                                                                  65150000
651600         EXEC SQL                                                 65160000
651700             SELECT MAX(SEQ_NBR)                                  65170000
651800             INTO   :ENTNME-SEQ-NBR                               65180000
651900             FROM   TENTNME                                       65190000
652000             WHERE  ENT_ID   = :ASC-ENT-ID                        65200000
652100         END-EXEC                                                 65210000
652200                                                                  65220000
652300         EVALUATE TRUE                                            65230000
652400             WHEN SQLCODE = ZERO                                  65240000
652500             WHEN SQLCODE = -904                                  65250000
652600             WHEN SQLCODE = -913                                  65260000
652700                 CONTINUE                                         65270000
652800             WHEN SQLWARN0 NOT = SPACES                           65280000
652900             WHEN SQLCODE < ZERO                                  65290000
653000             WHEN SQLCODE > ZERO                                  65300000
653100                 MOVE '5999-GET-MAX-TENTNME'                      65310000
653200                                   TO DP013-PARAGRAPH             65320000
653300                 MOVE 'SELECT MAX SEQ NBR'                        65330000
653400                                   TO DP013-MESSAGE-TEXT (1)      65340000
653500                 MOVE SQLCA        TO DP013-SQLCA                 65350000
653600                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    65360000
653700                 SET DP013-DB2-ABEND                              65370000
653800                     DP013-XCTL-DISPLAY-RESTART                   65380000
653900                                   TO TRUE                        65390000
654000                 PERFORM DP013-0000-PROCESS-ABEND                 65400000
654100         END-EVALUATE                                             65410000
654200     END-PERFORM.                                                 65420000
654300                                                                  65430000
654400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        65440000
654500         MOVE '5999-GET-MAX-TENTNME'                              65450000
654600                                   TO DP013-PARAGRAPH             65460000
654700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     65470000
654800                                   TO DP013-MESSAGE-TEXT (1)      65480000
654900         MOVE 'MAX SEQ NBR '       TO DP013-MESSAGE-TEXT (2)      65490000
655000         MOVE SQLCA                TO DP013-SQLCA                 65500000
655100         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    65510000
655200         SET DP013-DB2-ABEND                                      65520000
655300             DP013-XCTL-DISPLAY-RESTART                           65530000
655400                                   TO TRUE                        65540000
655500         PERFORM DP013-0000-PROCESS-ABEND                         65550000
655600     END-IF.                                                      65560000
655700                                                                  65570000
655800*----------------------------------------------------------------*65580000
655900* ADD THE INPUT TO THE DB2 TABLE.                                *65590000
656000*----------------------------------------------------------------*65600000
656100 6000-ADD-VENDOR.                                                 65610000
656200                                                                  65620000
656300     PERFORM 6100-GET-MAX-ENT-ID.                                 65630000
656400                                                                  65640000
656500     MOVE EXTENT-ENT-ID        TO ASC-ENT-ID                      65650000
656600                                  ASC-VND-ENT-ID.                 65660000
656700     MOVE ASC-STATUS-CDE       TO EXTENT-STATUS-CDE.              65670000
656800     MOVE ASC-DUN-NBR          TO EXTENT-DUN-NBR.                 65680000
656900     MOVE ASC-PRNT-CO-ENT-ID   TO EXTENT-PRNT-CO-ENT-ID.          65690000
657000     MOVE ASC-PRIMARY-TYPE     TO EXTENT-PRIM-TYP-CDE.            65700000
657100     MOVE ASC-PARTNER-IND      TO EXTENT-PRTNR-IND.               65710000
657200     MOVE ASC-PARTNER-TYPE     TO EXTENT-PRTNR-TYP-CDE            65720000
657300                                  PV-VALID-CARRIER.               65730000
657400                                                                  65740000
657500     IF  VALID-CARRIER                                            65750000
657600        MOVE 'Y'               TO EXTENT-CARRIER-IND              65760000
657700     ELSE                                                         65770000
657800        MOVE 'N'               TO EXTENT-CARRIER-IND              65780000
657900     END-IF.                                                      65790000
658000                                                                  65800000
658100     IF ASC-PRIMARY-TYPE = 'M'                                    65810000
658200         IF ASC-PREPACK-EDI-CDE = ' '                             65820000
658300             MOVE 'Y' TO ASC-PREPACK-EDI-CDE                      65830000
658400         END-IF                                                   65840000
658500         IF ASC-NDA-IND = ' '                                     65850000
658600             MOVE 'Y' TO ASC-NDA-IND                              65860000
658700         END-IF                                                   65870000
658800     END-IF.                                                      65880000
658900                                                                  65890000
659000     IF ASC-PARTNER-TYPE = 'FA'                                   65900000
659100         MOVE ASC-FACT-CAPACITY TO EXTENT-LNE-OF-CR-AMT           65910000
659200     ELSE                                                         65920000
659300         MOVE ASC-LINE-OF-CREDIT  TO  PV-LNE-OF-CR-AMT            65930000
659400         MOVE PV-LNE-OF-CR-AMT-DLLR  TO  PV-LINE-OF-CREDIT-DLLR   65940000
659500         COMPUTE PV-LINE-OF-CREDIT-CENT =                         65950000
659600                                   PV-LNE-OF-CR-AMT-CENT / 100    65960000
659700         MOVE PV-LINE-OF-CREDIT  TO  EXTENT-LNE-OF-CR-AMT         65970000
659800     END-IF                                                       65980000
659900     MOVE ASC-HLD-PAYT-IND     TO EXTENT-HLD-PAYT-IND.            65990000
660000     MOVE ASC-VND-USING-FACTOR TO EXTENT-PAY-FCTR-VND-IND.        66000000
660100     MOVE ASC-NDA-IND           TO EXTENT-NDA-IND.                66010000
660200                                                                  66020000
660300     IF ASC-NDA-IND = 'N'                                         66030000
660400        MOVE PC-DEFAULT-DATE TO EXTENT-NDA-BEG-DTE                66040000
660500                                EXTENT-NDA-END-DTE                66050000
660600     ELSE                                                         66060000
660700        EXEC SQL                                                  66070000
660800             SET :PV-WORK-DATE = CURRENT DATE                     66080000
660900        END-EXEC                                                  66090000
661000                                                                  66100000
661100        MOVE PV-WORK-DATE    TO EXTENT-NDA-BEG-DTE                66110000
661200        MOVE PC-DEFAULT-DATE TO EXTENT-NDA-END-DTE                66120000
661300     END-IF.                                                      66130000
661400                                                                  66140000
661500     MOVE ASC-SEPERATE-PYMTS   TO EXTENT-SEPR-INVC-PAYT-IND.      66150000
661600     MOVE ASC-PREPACK-EDI-CDE  TO EXTENT-EDI-PO-PREPK-CDE.        66160000
661700     MOVE 'N'                  TO EXTENT-ASN-TRSCP-IND.           66170000
661800     MOVE ASC-SCAC-CDE         TO EXTENT-SCAC-CDE.                66180000
661900     MOVE ASC-CARR-MAN-PRO-IND TO EXTENT-CARR-MAN-PRO-IND.        66190000
662000     MOVE ASC-CAP-EXP-CDE      TO EXTENT-CAP-EXP-CDE.             66200000
662100     MOVE ASC-VND-CLSN-CDE      TO EXTENT-VND-CLSN-CDE.           66210000
662200     MOVE ASC-VND-PRSST-CDE     TO EXTENT-VND-PRSST-CDE.          66220000
662300     MOVE ASC-1099-NEEDED      TO EXTENT-NEED-1099-IND.           66230000
662400*    MOVE ASC-FED-TX-ID-TYP-CDE TO EXTENT-FED-TX-ID-TYP-CDE.      66240000
662500*    MOVE ASC-FED-TX-ID-NBR     TO EXTENT-FED-TX-ID-NBR.          66250000
662600     MOVE ASC-WITHHOLD-CDE      TO EXTENT-WHLDG-PAYT-TYP-CDE.     66260000
662700     MOVE ASC-PRNT-CO-IND       TO EXTENT-PRNT-CO-IND.            66270000
662800     MOVE ASC-PAY-HNDLNG-CDE    TO EXTENT-PAYT-HNDLG-CDE.         66280000
662900     MOVE SPACES                TO EXTENT-LAST-UPD-BY-UID.        66290000
663000     MOVE PC-INIT-TIMESTAMP     TO EXTENT-LAST-UPD-TMST.          66300000
663100     MOVE SPACE                 TO EXTENT-IMPRT-IND.              66310000
663200     MOVE ASC-PREPACK-EDI-CDE   TO EXTENT-EDI-PO-PREPK-CDE        66320000
663300     EVALUATE TRUE                                                66330000
663400        WHEN  ASC-PRIMARY-TYPE = 'M'                              66340000
663500              MOVE 'Y'          TO EXTENT-MDSE-VENDOR-IND         66350000
663600              MOVE 'N'          TO EXTENT-EXP-VEND-IND            66360000
663700                                   EXTENT-FCTR-IND                66370000
663800        WHEN  ASC-PRIMARY-TYPE = 'E'                              66380000
663900              MOVE 'Y'          TO EXTENT-EXP-VEND-IND            66390000
664000              MOVE 'N'          TO EXTENT-FCTR-IND                66400000
664100                                   EXTENT-MDSE-VENDOR-IND         66410000
664200        WHEN  ASC-PRIMARY-TYPE = 'F'                              66420000
664300              MOVE 'Y'          TO EXTENT-FCTR-IND                66430000
664400              MOVE 'N'          TO EXTENT-EXP-VEND-IND            66440000
664500                                   EXTENT-MDSE-VENDOR-IND         66450000
664600     END-EVALUATE.                                                66460000
664700                                                                  66470000
664800     IF ASC-PARTNER-IND = 'Y'                                     66480000
664900        IF ASC-PARTNER-TYPE = 'FA' OR 'S2'                        66490000
665000           MOVE 'N'             TO EXTENT-VND-IN-RMS-IND          66500000
665100        ELSE                                                      66510000
665200           MOVE 'Y'             TO EXTENT-VND-IN-RMS-IND          66520000
665300        END-IF                                                    66530000
665400     ELSE                                                         66540000
665500        MOVE 'N'                TO EXTENT-VND-IN-RMS-IND          66550000
665600     END-IF.                                                      66560000
665700                                                                  66570000
665800     PERFORM 6200-ADD-TEXTENT.                                    66580000
665900                                                                  66590000
666000     IF SQLCODE = -803                                            66600000
666100         PERFORM 6600-UPDATE-TVNDCTL                              66610000
666200         SET PS-VENDOR-NBR-DERIVED TO TRUE                        66620000
666300         SET PS-ERROR          TO TRUE                            66630000
666400         SET DP020-MSG-FATAL   TO TRUE                            66640000
666500*        --- CANNOT GENERATE VENDOR NUMBER AT THIS TIME -- RETRY  66650000
666600         MOVE PC-TSYMSG-01877  TO DP020-MSG-NUMBER                66660000
666700         MOVE DP015-UNP-ALP-BRT-OFF                               66670000
666800                               TO ADUNNBRA                        66680000
666900         MOVE DP015-RED        TO ADUNNBRC                        66690000
667000         MOVE DP015-REVERSE    TO ADUNNBRH                        66700000
667100         MOVE -1               TO ADUNNBRL                        66710000
667200         SET DP030-SET-CURSOR-APPL-1                              66720000
667300                               TO TRUE                            66730000
667400     ELSE                                                         66740000
667500         MOVE ASC-ENT-ID    TO ENTNME-ENT-ID                      66750000
667600         MOVE 1             TO ENTNME-SEQ-NBR                     66760000
667700         MOVE ASC-VEND-NAME TO ENTNME-ENT-NAME-DESC               66770000
667800         MOVE '01'          TO ENTNME-TYPE-CDE                    66780000
667900                                                                  66790000
668000         PERFORM 6300-ADD-TENTNME                                 66800000
668100                                                                  66810000
668200         MOVE ASC-ENT-ID    TO ENTNME-ENT-ID                      66820000
668300         MOVE 2             TO ENTNME-SEQ-NBR                     66830000
668400         MOVE ASC-VEND-SNME TO ENTNME-ENT-NAME-DESC               66840000
668500         MOVE '04'          TO ENTNME-TYPE-CDE                    66850000
668600         IF ENTNME-ENT-NAME-DESC = SPACES                         66860000
668700           PERFORM 5020-AUTO-GEN-SHORTNAME                        66870000
668800         END-IF                                                   66880000
668900         PERFORM 6300-ADD-TENTNME                                 66890000
669000                                                                  66900000
669100         IF ASC-DEPT-NBR > SPACES                                 66910000
669200             MOVE ASC-ENT-ID        TO VNDDPT-ENT-ID              66920000
669300             MOVE ASC-DEPT-NBR      TO VNDDPT-DEPT-NBR            66930000
669400             MOVE ASC-INHOUSE-NBR-N TO VNDDPT-INHOUSE-NBR         66940000
669500             MOVE 'M'               TO VNDDPT-VEND-TYP-IND        66950000
669600             MOVE 'N'               TO VNDDPT-INVC-REQ-PO-IND     66960000
669700                                                                  66970000
669800             PERFORM 6400-ADD-TVNDDPT                             66980000
669900             INITIALIZE DCLTVNDTAU                                66990000
670000             MOVE ASC-ENT-ID           TO VNDTAU-ENT-ID           67000000
670100             MOVE ASC-DEPT-NBR         TO VNDTAU-DEPT-NBR         67010000
670200             MOVE 'A'                  TO VNDTAU-STAT-CDE         67020000
670300             MOVE 'D'                  TO VNDTAU-AUD-TYP-CDE      67030000
670400             MOVE PC-INIT-EXP-TMST     TO                         67040000
670500                                       VNDTAU-PREV-STAT-CHG-TMST  67050000
670600             PERFORM 6020-INSERT-DETAIL-HISTORY-ROW               67060000
670700         END-IF                                                   67070000
670800                                                                  67080000
670900         IF ASC-DPTE-NBR > SPACES                                 67090000
671000             MOVE ASC-ENT-ID        TO VNDDPT-ENT-ID              67100000
671100             MOVE ASC-DPTE-NBR      TO VNDDPT-DEPT-NBR            67110000
671200             MOVE ZERO              TO VNDDPT-INHOUSE-NBR         67120000
671300             MOVE 'E'               TO VNDDPT-VEND-TYP-IND        67130000
671400             MOVE 'N'               TO VNDDPT-INVC-REQ-PO-IND     67140000
671500                                                                  67150000
671600             PERFORM 6400-ADD-TVNDDPT                             67160000
671700             INITIALIZE DCLTVNDTAU                                67170000
671800             MOVE ASC-ENT-ID           TO VNDTAU-ENT-ID           67180000
671900             MOVE ASC-DPTE-NBR         TO VNDTAU-DEPT-NBR         67190000
672000             MOVE 'A'                  TO VNDTAU-STAT-CDE         67200000
672100             MOVE 'D'                  TO VNDTAU-AUD-TYP-CDE      67210000
672200             MOVE PC-INIT-EXP-TMST     TO                         67220000
672300                                       VNDTAU-PREV-STAT-CHG-TMST  67230000
672400             PERFORM 6020-INSERT-DETAIL-HISTORY-ROW               67240000
672500         END-IF                                                   67250000
672600                                                                  67260000
672700     END-IF.                                                      67270000
672800                                                                  67280000
672900 6010-MOVE-TO-DETAIL-HISTORY.                                     67290000
673000     MOVE ASC-VEND-NAME        TO VNDTAU-VND-NM.                  67300000
673100     MOVE ASC-STATUS-CDE       TO VNDTAU-STAT-CDE.                67310000
673200     MOVE ASC-PRIMARY-TYPE     TO VNDTAU-PRIM-TYP-CDE.            67320000
673300     MOVE ASC-PARTNER-IND      TO VNDTAU-PRTNR-IND.               67330000
673400     MOVE ASC-PARTNER-TYPE     TO VNDTAU-PRTNR-TYP-CDE.           67340000
673500     MOVE ASC-PRNT-CO-IND      TO VNDTAU-PRNT-CO-IND-CDE.         67350000
673600     MOVE ASC-VND-USING-FACTOR TO VNDTAU-PAY-FCTR-IND-CDE.        67360000
673700     MOVE ASC-HLD-PAYT-IND     TO VNDTAU-HLD-PAYT-IND-CDE.        67370000
673800     MOVE ASC-SEPERATE-PYMTS   TO VNDTAU-SEPR-INVC-IND-CDE.       67380000
673900     MOVE ASC-PAY-HNDLNG-CDE   TO VNDTAU-PAYT-HNDLG-CDE.          67390000
674000     MOVE ASC-1099-NEEDED      TO VNDTAU-NEED-1099-IND-CDE.       67400000
674100     MOVE SPACES               TO VNDTAU-FED-TX-ID-NBR.           67410000
674200     MOVE PC-INIT-EXP-TMST     TO VNDTAU-PREV-STAT-CHG-TMST.      67420000
674300                                                                  67430000
674400 6020-INSERT-DETAIL-HISTORY-ROW.                                  67440000
674500     PERFORM                                                      67450000
674600         WITH TEST AFTER                                          67460000
674700         VARYING PV-RETRY-COUNTER                                 67470000
674800         FROM 1 BY 1                                              67480000
674900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67490000
675000                   OR (SQLCODE = ZERO))                           67500000
675100         EXEC SQL                                                 67510000
675200             INSERT INTO TVNDTAU                                  67520000
675300                 ( ENT_ID                                         67530000
675400                  ,AUD_TMST                                       67540000
675500                  ,LAST_UPD_BY_USR_ID                             67550000
675600                  ,AUD_FUNC_CDE                                   67560000
675700                  ,VND_NM                                         67570000
675800                  ,STAT_CDE                                       67580000
675900                  ,PRNT_CO_IND_CDE                                67590000
676000                  ,PAY_FCTR_IND_CDE                               67600000
676100                  ,HLD_PAYT_IND_CDE                               67610000
676200                  ,SEPR_INVC_IND_CDE                              67620000
676300                  ,PAYT_HNDLG_CDE                                 67630000
676400                  ,NEED_1099_IND_CDE                              67640000
676500                  ,FED_TX_ID_NBR                                  67650000
676600                  ,DEPT_NBR                                       67660000
676700                  ,PREV_STAT_CHG_TMST                             67670000
676800                  ,AUD_TYP_CDE                                    67680000
676900                  ,PRIM_TYP_CDE                                   67690000
677000                  ,PRTNR_IND                                      67700000
677100                  ,PRTNR_TYP_CDE)                                 67710000
677200             VALUES                                               67720000
677300                 (:VNDTAU-ENT-ID                                  67730000
677400                 ,CURRENT TIMESTAMP                               67740000
677500                 ,:DP020-USERID                                   67750000
677600                 ,:VNDTAU-AUD-FUNC-CDE                            67760000
677700                 ,:VNDTAU-VND-NM                                  67770000
677800                 ,:VNDTAU-STAT-CDE                                67780000
677900                 ,:VNDTAU-PRNT-CO-IND-CDE                         67790000
678000                 ,:VNDTAU-PAY-FCTR-IND-CDE                        67800000
678100                 ,:VNDTAU-HLD-PAYT-IND-CDE                        67810000
678200                 ,:VNDTAU-SEPR-INVC-IND-CDE                       67820000
678300                 ,:VNDTAU-PAYT-HNDLG-CDE                          67830000
678400                 ,:VNDTAU-NEED-1099-IND-CDE                       67840000
678500                 ,:VNDTAU-FED-TX-ID-NBR                           67850000
678600                 ,:VNDTAU-DEPT-NBR                                67860000
678700                 ,:VNDTAU-PREV-STAT-CHG-TMST                      67870000
678800                 ,:VNDTAU-AUD-TYP-CDE                             67880000
678900                 ,:VNDTAU-PRIM-TYP-CDE                            67890000
679000                 ,:VNDTAU-PRTNR-IND                               67900000
679100                 ,:VNDTAU-PRTNR-TYP-CDE)                          67910000
679200         END-EXEC                                                 67920000
679300                                                                  67930000
679400         EVALUATE TRUE                                            67940000
679500             WHEN SQLCODE = ZERO                                  67950000
679600             WHEN SQLCODE = -904                                  67960000
679700             WHEN SQLCODE = -913                                  67970000
679800                 CONTINUE                                         67980000
679900             WHEN SQLWARN0 NOT = SPACES                           67990000
680000             WHEN SQLCODE < ZERO                                  68000000
680100             WHEN SQLCODE > ZERO                                  68010000
680200                 MOVE '6020-INSERT-DETAIL-HISTORY-ROW'            68020000
680300                                   TO DP013-PARAGRAPH             68030000
680400                 MOVE 'ADD A ROW TO THE DETAIL HISTORY TBL'       68040000
680500                                   TO DP013-MESSAGE-TEXT(1)       68050000
680600                 MOVE SQLCA        TO DP013-SQLCA                 68060000
680700                 MOVE 'TVNDTAU'    TO DP013-DB2-TABLE-NAME (1)    68070000
680800                 SET DP013-DB2-ABEND                              68080000
680900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           68090000
681000                 PERFORM DP013-0000-PROCESS-ABEND                 68100000
681100         END-EVALUATE                                             68110000
681200     END-PERFORM.                                                 68120000
681300                                                                  68130000
681400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        68140000
681500         MOVE '6020-INSERT-DETAIL-HISTORY-ROW'                    68150000
681600                                   TO DP013-PARAGRAPH             68160000
681700         MOVE 'MAX RETRIES EXCEEDED TRYING TO INSERT TVNDTAU ROW' 68170000
681800                                   TO DP013-MESSAGE-TEXT (1)      68180000
681900         MOVE SQLCA                TO DP013-SQLCA                 68190000
682000         MOVE 'TVNDTAU'            TO DP013-DB2-TABLE-NAME (1)    68200000
682100         SET DP013-DB2-ABEND                                      68210000
682200             DP013-XCTL-DISPLAY-RESTART                           68220000
682300                                   TO TRUE                        68230000
682400         PERFORM DP013-0000-PROCESS-ABEND                         68240000
682500     END-IF.                                                      68250000
682600                                                                  68260000
682700******************************************************************68270000
682800*   SELECT TEXTENT VALUES FOR VENDOR DETAIL COMPARE              *68280000
682900******************************************************************68290000
683000 6030-SELECT-TEXTENT-DETAIL.                                      68300000
683100     PERFORM                                                      68310000
683200         WITH TEST AFTER                                          68320000
683300         VARYING PV-RETRY-COUNTER                                 68330000
683400         FROM 1 BY 1                                              68340000
683500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68350000
683600                   OR (SQLCODE = ZERO)                            68360000
683700                   OR (SQLCODE = +100))                           68370000
683800                                                                  68380000
683900         EXEC SQL                                                 68390000
684000             SELECT STATUS_CDE,                                   68400000
684100                    NEED_1099_IND,                                68410000
684200*                   FED_TX_ID_NBR,                                68420000
684300                    PRNT_CO_IND,                                  68430000
684400                    HLD_PAYT_IND,                                 68440000
684500                    PAY_FCTR_VND_IND,                             68450000
684600                    SEPR_INVC_PAYT_IND,                           68460000
684700                    PAYT_HNDLG_CDE,                               68470000
684800                    SCAC_CDE,                                     68480000
684900                    EDI_PO_PREPK_CDE,                             68490000
685000                    NDA_IND,                                      68500000
685100                    NDA_BEG_DTE,                                  68510000
685200                    NDA_END_DTE,                                  68520000
685300                    PRIM_TYP_CDE,                                 68530000
685400                    PRTNR_IND,                                    68540000
685500                    PRTNR_TYP_CDE,                                68550000
685600                    LNE_OF_CR_AMT,                                68560000
685700                    VND_IN_RMS_IND                                68570000
685800              INTO :EXTENT-STATUS-CDE,                            68580000
685900                   :EXTENT-NEED-1099-IND,                         68590000
686000*                  :EXTENT-FED-TX-ID-NBR,                         68600000
686100                   :EXTENT-PRNT-CO-IND,                           68610000
686200                   :EXTENT-HLD-PAYT-IND,                          68620000
686300                   :EXTENT-PAY-FCTR-VND-IND,                      68630000
686400                   :EXTENT-SEPR-INVC-PAYT-IND,                    68640000
686500                   :EXTENT-PAYT-HNDLG-CDE,                        68650000
686600                   :EXTENT-SCAC-CDE,                              68660000
686700                   :EXTENT-EDI-PO-PREPK-CDE,                      68670000
686800                   :EXTENT-NDA-IND,                               68680000
686900                   :EXTENT-NDA-BEG-DTE,                           68690000
687000                   :EXTENT-NDA-END-DTE,                           68700000
687100                   :EXTENT-PRIM-TYP-CDE,                          68710000
687200                   :EXTENT-PRTNR-IND,                             68720000
687300                   :EXTENT-PRTNR-TYP-CDE,                         68730000
687400                   :EXTENT-LNE-OF-CR-AMT,                         68740000
687500                   :EXTENT-VND-IN-RMS-IND                         68750000
687600             FROM TEXTENT                                         68760000
687700             WHERE ENT_ID = :ASC-ENT-ID                           68770000
687800         END-EXEC                                                 68780000
687900                                                                  68790000
688000         EVALUATE TRUE                                            68800000
688100             WHEN SQLCODE = ZERO                                  68810000
688200             WHEN SQLCODE = +100                                  68820000
688300             WHEN SQLCODE = -904                                  68830000
688400             WHEN SQLCODE = -913                                  68840000
688500                 CONTINUE                                         68850000
688600             WHEN SQLWARN0 NOT = SPACES                           68860000
688700             WHEN SQLCODE < ZERO                                  68870000
688800             WHEN SQLCODE > ZERO                                  68880000
688900                 MOVE '6030-SELECT-TEXTENT-DETAIL'                68890000
689000                                   TO DP013-PARAGRAPH             68900000
689100                 MOVE 'SELECT EXTERNAL ENTITY TABLE '             68910000
689200                                   TO DP013-MESSAGE-TEXT (1)      68920000
689300                 MOVE SQLCA        TO DP013-SQLCA                 68930000
689400                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    68940000
689500                 SET DP013-DB2-ABEND                              68950000
689600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           68960000
689700                 PERFORM DP013-0000-PROCESS-ABEND                 68970000
689800         END-EVALUATE                                             68980000
689900     END-PERFORM.                                                 68990000
690000                                                                  69000000
690100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        69010000
690200         MOVE '6030-SELECT-TEXTENT-DETAIL'                        69020000
690300                                   TO DP013-PARAGRAPH             69030000
690400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     69040000
690500                                   TO DP013-MESSAGE-TEXT (1)      69050000
690600         MOVE 'EXTERNAL ENTITY ROW'                               69060000
690700                                   TO DP013-MESSAGE-TEXT (2)      69070000
690800         MOVE SQLCA                TO DP013-SQLCA                 69080000
690900         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    69090000
691000         SET DP013-DB2-ABEND                                      69100000
691100             DP013-XCTL-DISPLAY-RESTART                           69110000
691200                                   TO TRUE                        69120000
691300         PERFORM DP013-0000-PROCESS-ABEND                         69130000
691400     END-IF.                                                      69140000
691500                                                                  69150000
691600******************************************************************69160000
691700*   SELECT TENTNME NAME FOR VENDOR DETAIL COMPARE                *69170000
691800******************************************************************69180000
691900 6040-SELECT-TENTNME01-NAME.                                      69190000
692000     PERFORM                                                      69200000
692100         WITH TEST AFTER                                          69210000
692200         VARYING PV-RETRY-COUNTER                                 69220000
692300         FROM 1 BY 1                                              69230000
692400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69240000
692500                   OR (SQLCODE = ZERO)                            69250000
692600                   OR (SQLCODE = +100))                           69260000
692700                                                                  69270000
692800         EXEC SQL                                                 69280000
692900             SELECT ENT_NAME_DESC                                 69290000
693000             INTO  :ENTNME-ENT-NAME-DESC                          69300000
693100             FROM TENTNME                                         69310000
693200             WHERE                                                69320000
693300                ENT_ID = :ASC-ENT-ID AND TYPE_CDE = '01'          69330000
693400         END-EXEC                                                 69340000
693500                                                                  69350000
693600         EVALUATE TRUE                                            69360000
693700             WHEN SQLCODE = ZERO                                  69370000
693800             WHEN SQLCODE = +100                                  69380000
693900             WHEN SQLCODE = -904                                  69390000
694000             WHEN SQLCODE = -913                                  69400000
694100                 CONTINUE                                         69410000
694200             WHEN SQLWARN0 NOT = SPACES                           69420000
694300             WHEN SQLCODE < ZERO                                  69430000
694400             WHEN SQLCODE > ZERO                                  69440000
694500                 MOVE '6040-SELECT-TENTNME01-NAME'                69450000
694600                                   TO DP013-PARAGRAPH             69460000
694700                 MOVE 'SELECT ENTERPRISE FOR VEND NAME:'          69470000
694800                                   TO DP013-MESSAGE-TEXT (1)      69480000
694900                 MOVE SQLCA        TO DP013-SQLCA                 69490000
695000                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    69500000
695100                 SET DP013-DB2-ABEND                              69510000
695200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           69520000
695300                 PERFORM DP013-0000-PROCESS-ABEND                 69530000
695400         END-EVALUATE                                             69540000
695500     END-PERFORM.                                                 69550000
695600                                                                  69560000
695700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        69570000
695800         MOVE '6040-SELECT-TENTNME01-NAME'                        69580000
695900                                   TO DP013-PARAGRAPH             69590000
696000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     69600000
696100                                   TO DP013-MESSAGE-TEXT (1)      69610000
696200         MOVE 'ENTERPRISE FOR VEND NAME'                          69620000
696300                                   TO DP013-MESSAGE-TEXT (2)      69630000
696400         MOVE SQLCA                TO DP013-SQLCA                 69640000
696500         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    69650000
696600         SET DP013-DB2-ABEND                                      69660000
696700             DP013-XCTL-DISPLAY-RESTART                           69670000
696800                                   TO TRUE                        69680000
696900         PERFORM DP013-0000-PROCESS-ABEND                         69690000
697000     END-IF.                                                      69700000
697100                                                                  69710000
697200******************************************************************69720000
697300*   SELECT THE LONG NAME FROM TENTNME FOR USE IN RMS PO MESSAGES *69730000
697400******************************************************************69740000
697500 6045-SELECT-TENTNME05-NAME.                                      69750000
697600     PERFORM                                                      69760000
697700         WITH TEST AFTER                                          69770000
697800         VARYING PV-RETRY-COUNTER                                 69780000
697900         FROM 1 BY 1                                              69790000
698000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69800000
698100                   OR (SQLCODE = ZERO)                            69810000
698200                   OR (SQLCODE = +100))                           69820000
698300                                                                  69830000
698400         EXEC SQL                                                 69840000
698500             SELECT ENT_NAME_DESC                                 69850000
698600             INTO  :PV-LONG-ENT-NAME-DESC                         69860000
698700             FROM TENTNME                                         69870000
698800             WHERE ENT_ID = :ASC-ENT-ID                           69880000
698900               AND TYPE_CDE = '05'                                69890000
699000         END-EXEC                                                 69900000
699100                                                                  69910000
699200         EVALUATE TRUE                                            69920000
699300             WHEN SQLCODE = ZERO                                  69930000
699400                 SET PS-LONGNAME-FOUND TO TRUE                    69940000
699500             WHEN SQLCODE = +100                                  69950000
699600                 SET PS-LONGNAME-NOT-FOUND TO TRUE                69960000
699700                 MOVE SPACE TO PV-LONG-ENT-NAME-DESC              69970000
699800             WHEN SQLCODE = -904                                  69980000
699900             WHEN SQLCODE = -913                                  69990000
700000                 CONTINUE                                         70000000
700100             WHEN SQLWARN0 NOT = SPACES                           70010000
700200             WHEN SQLCODE < ZERO                                  70020000
700300             WHEN SQLCODE > ZERO                                  70030000
700400                 MOVE '6045-SELECT-TENTNME05-NAME'                70040000
700500                                   TO DP013-PARAGRAPH             70050000
700600                 MOVE 'SELECT ENTERPRISE FOR LONG NAME:'          70060000
700700                                   TO DP013-MESSAGE-TEXT (1)      70070000
700800                 MOVE SQLCA        TO DP013-SQLCA                 70080000
700900                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    70090000
701000                 SET DP013-DB2-ABEND                              70100000
701100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           70110000
701200                 PERFORM DP013-0000-PROCESS-ABEND                 70120000
701300         END-EVALUATE                                             70130000
701400     END-PERFORM.                                                 70140000
701500                                                                  70150000
701600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        70160000
701700         MOVE '6045-SELECT-TENTNME05-NAME'                        70170000
701800                                   TO DP013-PARAGRAPH             70180000
701900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     70190000
702000                                   TO DP013-MESSAGE-TEXT (1)      70200000
702100         MOVE 'ENTERPRISE FOR LONG NAME'                          70210000
702200                                   TO DP013-MESSAGE-TEXT (2)      70220000
702300         MOVE SQLCA                TO DP013-SQLCA                 70230000
702400         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    70240000
702500         SET DP013-DB2-ABEND                                      70250000
702600             DP013-XCTL-DISPLAY-RESTART                           70260000
702700                                   TO TRUE                        70270000
702800         PERFORM DP013-0000-PROCESS-ABEND                         70280000
702900     END-IF.                                                      70290000
703000                                                                  70300000
703100 6050-CHECK-FOR-UPDATE.                                           70310000
703200                                                                  70320000
703300     IF ASC-VEND-NAME NOT = ENTNME-ENT-NAME-DESC                  70330000
703400        SET VN-UPDATE-PERFORMED TO TRUE                           70340000
703500        MOVE ASC-VEND-NAME        TO VNDTAU-VND-NM.               70350000
703600                                                                  70360000
703700     IF ASC-STATUS-CDE NOT = EXTENT-STATUS-CDE                    70370000
703800        SET VN-UPDATE-PERFORMED                                   70380000
703900            VN-STATUS-CHANGE TO TRUE                              70390000
704000        MOVE ASC-STATUS-CDE       TO VNDTAU-STAT-CDE.             70400000
704100                                                                  70410000
704200     IF ASC-PRIMARY-TYPE NOT = EXTENT-PRIM-TYP-CDE                70420000
704300        SET VN-UPDATE-PERFORMED   TO TRUE                         70430000
704400        MOVE ASC-PRIMARY-TYPE     TO VNDTAU-PRIM-TYP-CDE          70440000
704500        IF EXTENT-PRIM-TYP-CDE = 'M'                              70450000
704600           SET VN-PRIM-CHG-FROM-MERCH TO TRUE                     70460000
704700        END-IF                                                    70470000
704800     END-IF.                                                      70480000
704900                                                                  70490000
705000     IF ASC-PARTNER-IND NOT = EXTENT-PRTNR-IND                    70500000
705100        SET VN-UPDATE-PERFORMED   TO TRUE                         70510000
705200        MOVE ASC-PARTNER-IND      TO VNDTAU-PRTNR-IND             70520000
705300     END-IF.                                                      70530000
705400                                                                  70540000
705500     IF ASC-PARTNER-TYPE NOT = EXTENT-PRTNR-TYP-CDE               70550000
705600        SET VN-UPDATE-PERFORMED TO TRUE                           70560000
705700        MOVE ASC-PARTNER-TYPE     TO VNDTAU-PRTNR-TYP-CDE         70570000
705800     END-IF.                                                      70580000
705900                                                                  70590000
706000     IF ASC-PRNT-CO-IND NOT = EXTENT-PRNT-CO-IND                  70600000
706100        SET VN-UPDATE-PERFORMED   TO TRUE                         70610000
706200        MOVE ASC-PRNT-CO-IND      TO VNDTAU-PRNT-CO-IND-CDE.      70620000
706300                                                                  70630000
706400     IF ASC-VND-USING-FACTOR NOT = EXTENT-PAY-FCTR-VND-IND        70640000
706500        SET VN-UPDATE-PERFORMED   TO TRUE                         70650000
706600        MOVE ASC-VND-USING-FACTOR TO VNDTAU-PAY-FCTR-IND-CDE.     70660000
706700                                                                  70670000
706800     IF ASC-HLD-PAYT-IND NOT = EXTENT-HLD-PAYT-IND                70680000
706900        SET VN-UPDATE-PERFORMED   TO TRUE                         70690000
707000        MOVE ASC-HLD-PAYT-IND     TO VNDTAU-HLD-PAYT-IND-CDE.     70700000
707100                                                                  70710000
707200     IF ASC-SEPERATE-PYMTS NOT = EXTENT-SEPR-INVC-PAYT-IND        70720000
707300        SET VN-UPDATE-PERFORMED   TO TRUE                         70730000
707400        MOVE ASC-SEPERATE-PYMTS   TO VNDTAU-SEPR-INVC-IND-CDE.    70740000
707500                                                                  70750000
707600     IF ASC-PAY-HNDLNG-CDE NOT = EXTENT-PAYT-HNDLG-CDE            70760000
707700        SET VN-UPDATE-PERFORMED                                   70770000
707800            VN-HANDLING-CHANGE    TO TRUE                         70780000
707900        MOVE ASC-PAY-HNDLNG-CDE   TO VNDTAU-PAYT-HNDLG-CDE.       70790000
708000                                                                  70800000
708100                                                                  70810000
708200     IF ASC-1099-NEEDED NOT = EXTENT-NEED-1099-IND                70820000
708300        SET VN-UPDATE-PERFORMED   TO TRUE                         70830000
708400        MOVE ASC-1099-NEEDED      TO VNDTAU-NEED-1099-IND-CDE.    70840000
708500                                                                  70850000
708600*    IF ASC-FED-TX-ID-NBR NOT = EXTENT-FED-TX-ID-NBR              70860000
708700*       SET VN-UPDATE-PERFORMED   TO TRUE                         70870000
708800*       MOVE ASC-FED-TX-ID-NBR    TO VNDTAU-FED-TX-ID-NBR.        70880000
708900                                                                  70890000
709000*CJG                                                              70900000
709100 6060-SELECT-TVNDTAU.                                             70910000
709200     PERFORM WITH TEST AFTER                                      70920000
709300             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 70930000
709400               UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES OR         70940000
709500                     SQLCODE = ZERO OR                            70950000
709600                     SQLCODE = +100                               70960000
709700                                                                  70970000
709800        EXEC SQL                                                  70980000
709900                SELECT ENT_ID                                     70990000
710000                  INTO :VNDTAU-ENT-ID                             71000000
710100                  FROM TVNDTAU                                    71010000
710200                 WHERE ENT_ID   = :ASC-ENT-ID                     71020000
710300                   AND STAT_CDE > ' '                             71030000
710400                   AND AUD_FUNC_CDE IN ('A', 'U')                 71040000
710500                   AND AUD_TYP_CDE = ' '                          71050000
710600                   AND PREV_STAT_CHG_TMST > CURRENT TIMESTAMP     71060000
710700        END-EXEC                                                  71070000
710800                                                                  71080000
710900         EVALUATE TRUE                                            71090000
711000             WHEN SQLCODE = ZERO                                  71100000
711100                 SET TVNDTAU-ROW-FOUND TO TRUE                    71110000
711200             WHEN SQLCODE = +100                                  71120000
711300                 SET TVNDTAU-ROW-NOT-FOUND TO TRUE                71130000
711400             WHEN SQLCODE = -904                                  71140000
711500             WHEN SQLCODE = -913                                  71150000
711600                 CONTINUE                                         71160000
711700                                                                  71170000
711800             WHEN SQLWARN0 NOT = SPACES                           71180000
711900             WHEN SQLCODE < ZERO                                  71190000
712000             WHEN SQLCODE > ZERO                                  71200000
712100                 MOVE '6060-SELECT-TVNDTAU'                       71210000
712200                                   TO DP013-PARAGRAPH             71220000
712300                 MOVE 'SELECT VENDOR DETAIL AUD'                  71230000
712400                                   TO DP013-MESSAGE-TEXT (1)      71240000
712500                 MOVE SQLCA        TO DP013-SQLCA                 71250000
712600                 MOVE 'TVNDTAU'    TO DP013-DB2-TABLE-NAME (1)    71260000
712700                 SET DP013-DB2-ABEND                              71270000
712800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           71280000
712900                 PERFORM DP013-0000-PROCESS-ABEND                 71290000
713000         END-EVALUATE                                             71300000
713100     END-PERFORM.                                                 71310000
713200                                                                  71320000
713300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        71330000
713400         MOVE '6060-SELECT-TVNDTAU'  TO DP013-PARAGRAPH           71340000
713500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     71350000
713600                                  TO DP013-MESSAGE-TEXT (1)       71360000
713700         MOVE 'VENDOR DTL AUDIT ' TO DP013-MESSAGE-TEXT (2)       71370000
713800         MOVE SQLCA               TO DP013-SQLCA                  71380000
713900         MOVE 'TVNDTAU'           TO DP013-DB2-TABLE-NAME (1)     71390000
714000         SET DP013-DB2-ABEND                                      71400000
714100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   71410000
714200         PERFORM DP013-0000-PROCESS-ABEND                         71420000
714300     END-IF.                                                      71430000
714400                                                                  71440000
714500** UPDATE PREV STATUS CHANGE TIMESTAMP FROM ALL 9'S FOR CURRENT   71450000
714600** ROW WITH CURRENT TIMESTAMP BEFOR ADDING NEW ROW FOR STATUS     71460000
714700** CHANGE                                                         71470000
714800 6070-UPDATE-TVNDTAU-CHG-TMST.                                    71480000
714900     PERFORM                                                      71490000
715000         WITH TEST AFTER                                          71500000
715100         VARYING PV-RETRY-COUNTER                                 71510000
715200         FROM 1 BY 1                                              71520000
715300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               71530000
715400                   OR (SQLCODE = ZERO))                           71540000
715500         EXEC SQL                                                 71550000
715600             UPDATE TVNDTAU                                       71560000
715700                SET PREV_STAT_CHG_TMST = CURRENT TIMESTAMP        71570000
715800             WHERE ENT_ID   = :ASC-ENT-ID                         71580000
715900               AND STAT_CDE > ' '                                 71590000
716000               AND AUD_FUNC_CDE IN ('A', 'U')                     71600000
716100               AND AUD_TYP_CDE = ' '                              71610000
716200               AND PREV_STAT_CHG_TMST > CURRENT TIMESTAMP         71620000
716300         END-EXEC                                                 71630000
716400                                                                  71640000
716500         EVALUATE TRUE                                            71650000
716600             WHEN SQLCODE = ZERO                                  71660000
716700             WHEN SQLCODE = -904                                  71670000
716800             WHEN SQLCODE = -913                                  71680000
716900                 CONTINUE                                         71690000
717000             WHEN SQLWARN0 NOT = SPACES                           71700000
717100             WHEN SQLCODE < ZERO                                  71710000
717200             WHEN SQLCODE > ZERO                                  71720000
717300                 MOVE '6070-UPDATE-TVNDTAU-CHG-TMST'              71730000
717400                                   TO DP013-PARAGRAPH             71740000
717500                 MOVE 'UPDATE A ROW ON THE TVNDTAU TABLE    '     71750000
717600                                   TO DP013-MESSAGE-TEXT(1)       71760000
717700                 MOVE SQLCA        TO DP013-SQLCA                 71770000
717800                 MOVE 'TVNDTAU'    TO DP013-DB2-TABLE-NAME (1)    71780000
717900                 SET DP013-DB2-ABEND                              71790000
718000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           71800000
718100                 PERFORM DP013-0000-PROCESS-ABEND                 71810000
718200         END-EVALUATE                                             71820000
718300     END-PERFORM.                                                 71830000
718400                                                                  71840000
718500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        71850000
718600         MOVE '6070-UPDATE-TVNDTAU-CHG-TMST'                      71860000
718700                                   TO DP013-PARAGRAPH             71870000
718800         MOVE 'MAXIMUM RETRIES EXCEEDED TRYING TO UPDATE TVNDTAU' 71880000
718900                                   TO DP013-MESSAGE-TEXT (1)      71890000
719000         MOVE SQLCA                TO DP013-SQLCA                 71900000
719100         MOVE 'TVNDTAU'            TO DP013-DB2-TABLE-NAME (1)    71910000
719200         SET DP013-DB2-ABEND                                      71920000
719300             DP013-XCTL-DISPLAY-RESTART                           71930000
719400                                   TO TRUE                        71940000
719500         PERFORM DP013-0000-PROCESS-ABEND                         71950000
719600     END-IF.                                                      71960000
719700                                                                  71970000
719800*----------------------------------------------------------------*71980000
719900*  GET MAX ENT-ID PLUS 1 FOR NEW VENDOR.                          71990000
720000*----------------------------------------------------------------*72000000
720100 6100-GET-MAX-ENT-ID.                                             72010000
720200                                                                  72020000
720300     PERFORM                                                      72030000
720400         WITH TEST AFTER                                          72040000
720500         VARYING PV-RETRY-COUNTER                                 72050000
720600         FROM 1 BY 1                                              72060000
720700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               72070000
720800                   OR (SQLCODE = ZERO))                           72080000
720900         EXEC SQL                                                 72090000
721000             SELECT MAX(ENT_ID) + 1                               72100000
721100             INTO :EXTENT-ENT-ID                                  72110000
721200             FROM TEXTENT                                         72120000
721300         END-EXEC                                                 72130000
721400                                                                  72140000
721500         EVALUATE TRUE                                            72150000
721600             WHEN SQLCODE = ZERO                                  72160000
721700             WHEN SQLCODE = -904                                  72170000
721800             WHEN SQLCODE = -913                                  72180000
721900                 CONTINUE                                         72190000
722000             WHEN SQLWARN0 NOT = SPACES                           72200000
722100             WHEN SQLCODE < ZERO                                  72210000
722200             WHEN SQLCODE > ZERO                                  72220000
722300                 MOVE '6100-GET-MAX-ENT-ID'                       72230000
722400                                   TO DP013-PARAGRAPH             72240000
722500                 MOVE 'SELECT MAX ENT ID'                         72250000
722600                                   TO DP013-MESSAGE-TEXT (1)      72260000
722700                 MOVE SQLCA        TO DP013-SQLCA                 72270000
722800                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    72280000
722900                 SET DP013-DB2-ABEND                              72290000
723000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           72300000
723100                 PERFORM DP013-0000-PROCESS-ABEND                 72310000
723200         END-EVALUATE                                             72320000
723300     END-PERFORM.                                                 72330000
723400                                                                  72340000
723500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        72350000
723600         MOVE '6100-GET-MAX-ENT-ID'                               72360000
723700                                   TO DP013-PARAGRAPH             72370000
723800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     72380000
723900                                   TO DP013-MESSAGE-TEXT (1)      72390000
724000         MOVE 'MAX ENT-ID '                                       72400000
724100                                   TO DP013-MESSAGE-TEXT (2)      72410000
724200         MOVE SQLCA                TO DP013-SQLCA                 72420000
724300         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    72430000
724400         SET DP013-DB2-ABEND                                      72440000
724500             DP013-XCTL-DISPLAY-RESTART                           72450000
724600                                   TO TRUE                        72460000
724700         PERFORM DP013-0000-PROCESS-ABEND                         72470000
724800     END-IF.                                                      72480000
724900                                                                  72490000
725000******************************************************************72500000
725100** ADD THE ROW TO THE DB2 TABLE.                                **72510000
725200******************************************************************72520000
725300 6200-ADD-TEXTENT.                                                72530000
725400                                                                  72540000
725500     PERFORM                                                      72550000
725600         WITH TEST AFTER                                          72560000
725700         VARYING PV-RETRY-COUNTER                                 72570000
725800         FROM 1 BY 1                                              72580000
725900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               72590000
726000                   OR (SQLCODE = ZERO)                            72600000
726100                   OR (SQLCODE = -803))                           72610000
726200         EXEC SQL                                                 72620000
726300             INSERT INTO TEXTENT                                  72630000
726400                 (ENT_ID,                                         72640000
726500                  SCAC_CDE,                                       72650000
726600                  DUN_NBR,                                        72660000
726700                  ASN_TRSCP_IND,                                  72670000
726800                  FED_EXPRESS_NBR,                                72680000
726900                  MDSE_VENDOR_IND,                                72690000
727000                  CARRIER_IND,                                    72700000
727100                  STATUS_CDE,                                     72710000
727200                  CARR_MAN_PRO_IND,                               72720000
727300                  EDI214_TEST_IND,                                72730000
727400                  IMPRT_IND,                                      72740000
727500                  SHIP_INSTR_LT_QTY,                              72750000
727600                  SHIP_INSTR_REQD,                                72760000
727700                  EXP_VEND_IND,                                   72770000
727800                  NEED_1099_IND,                                  72780000
727900                  CRE_BY_UID,                                     72790000
728000                  CRE_TMST,                                       72800000
728100                  LAST_UPD_BY_UID,                                72810000
728200                  LAST_UPD_TMST,                                  72820000
728300                  CFY_SLSRNK_NBR,                                 72830000
728400                  PFY_SLSRNK_NBR,                                 72840000
728500                  CRE_ASN_FCST_IND,                               72850000
728600                  CRE_SHIPT_FCST_IND,                             72860000
728700                  STR_DISTRO_LT_QTY,                              72870000
728800                  VLD_CART_LBL_IND,                               72880000
728900                  PRNT_CO_ENT_ID,                                 72890000
729000                  VND_CLSN_CDE,                                   72900000
729100                  VND_PRSST_CDE,                                  72910000
729200                  FED_TX_ID_TYP_CDE,                              72920000
729300                  FED_TX_ID_NBR,                                  72930000
729400                  FCTR_IND,                                       72940000
729500                  PRNT_CO_IND,                                    72950000
729600                  CAP_EXP_CDE,                                    72960000
729700                  HLD_PAYT_IND,                                   72970000
729800                  PAY_FCTR_VND_IND,                               72980000
729900                  SEPR_INVC_PAYT_IND,                             72990000
730000                  WHLDG_PAYT_TYP_CDE,                             73000000
730100                  PAYT_HNDLG_CDE,                                 73010000
730200                  EDI_PO_PREPK_CDE,                               73020000
730300                  PRIM_TYP_CDE,                                   73030000
730400                  PRTNR_IND,                                      73040000
730500                  PRTNR_TYP_CDE,                                  73050000
730600                  LNE_OF_CR_AMT,                                  73060000
730700                  VND_IN_RMS_IND,                                 73070000
730800                  NDA_IND,                                        73080000
730900                  NDA_BEG_DTE,                                    73090000
731000                  NDA_END_DTE)                                    73100000
731100             VALUES                                               73110000
731200                 (:EXTENT-ENT-ID,                                 73120000
731300                  :EXTENT-SCAC-CDE,                               73130000
731400                  :EXTENT-DUN-NBR,                                73140000
731500                  :EXTENT-ASN-TRSCP-IND,                          73150000
731600                  '         ',                                    73160000
731700                  :EXTENT-MDSE-VENDOR-IND,                        73170000
731800                  :EXTENT-CARRIER-IND,                            73180000
731900                  :EXTENT-STATUS-CDE,                             73190000
732000                  :EXTENT-CARR-MAN-PRO-IND,                       73200000
732100                  ' ',                                            73210000
732200                  'N',                                            73220000
732300                  0,                                              73230000
732400                  ' ',                                            73240000
732500                  :EXTENT-EXP-VEND-IND,                           73250000
732600                  :EXTENT-NEED-1099-IND,                          73260000
732700                  :DP020-USERID,                                  73270000
732800                  CURRENT TIMESTAMP,                              73280000
732900                  :EXTENT-LAST-UPD-BY-UID,                        73290000
733000                  :EXTENT-LAST-UPD-TMST,                          73300000
733100                  0,                                              73310000
733200                  0,                                              73320000
733300                  'N',                                            73330000
733400                  'N',                                            73340000
733500                  0,                                              73350000
733600                  'N',                                            73360000
733700                  :EXTENT-PRNT-CO-ENT-ID,                         73370000
733800                  :EXTENT-VND-CLSN-CDE,                           73380000
733900                  :EXTENT-VND-PRSST-CDE,                          73390000
734000                  ' ',                                            73400000
734100                  ' ',                                            73410000
734200                  :EXTENT-FCTR-IND,                               73420000
734300                  :EXTENT-PRNT-CO-IND,                            73430000
734400                  :EXTENT-CAP-EXP-CDE,                            73440000
734500                  :EXTENT-HLD-PAYT-IND,                           73450000
734600                  :EXTENT-PAY-FCTR-VND-IND,                       73460000
734700                  :EXTENT-SEPR-INVC-PAYT-IND,                     73470000
734800                  :EXTENT-WHLDG-PAYT-TYP-CDE,                     73480000
734900                  :EXTENT-PAYT-HNDLG-CDE,                         73490000
735000                  :EXTENT-EDI-PO-PREPK-CDE,                       73500000
735100                  :EXTENT-PRIM-TYP-CDE,                           73510000
735200                  :EXTENT-PRTNR-IND,                              73520000
735300                  :EXTENT-PRTNR-TYP-CDE,                          73530000
735400                  :EXTENT-LNE-OF-CR-AMT,                          73540000
735500                  :EXTENT-VND-IN-RMS-IND,                         73550000
735600                  :EXTENT-NDA-IND,                                73560000
735700                  :EXTENT-NDA-BEG-DTE,                            73570000
735800                  :EXTENT-NDA-END-DTE)                            73580000
735900         END-EXEC                                                 73590000
736000                                                                  73600000
736100         EVALUATE TRUE                                            73610000
736200             WHEN SQLCODE = ZERO                                  73620000
736300             WHEN SQLCODE = -803                                  73630000
736400             WHEN SQLCODE = -904                                  73640000
736500             WHEN SQLCODE = -913                                  73650000
736600                 CONTINUE                                         73660000
736700             WHEN SQLWARN0 NOT = SPACES                           73670000
736800             WHEN SQLCODE < ZERO                                  73680000
736900             WHEN SQLCODE > ZERO                                  73690000
737000                 MOVE '6200-ADD-TEXTENT'                          73700000
737100                                   TO DP013-PARAGRAPH             73710000
737200                 MOVE 'ADD A ROW ON THE EXTERNAL ENT TABLE'       73720000
737300                                   TO DP013-MESSAGE-TEXT(1)       73730000
737400                 MOVE SQLCA        TO DP013-SQLCA                 73740000
737500                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    73750000
737600                 SET DP013-DB2-ABEND                              73760000
737700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           73770000
737800                 PERFORM DP013-0000-PROCESS-ABEND                 73780000
737900         END-EVALUATE                                             73790000
738000     END-PERFORM.                                                 73800000
738100                                                                  73810000
738200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        73820000
738300         MOVE '6200-ADD-TEXTENT'                                  73830000
738400                                   TO DP013-PARAGRAPH             73840000
738500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO ADD A NEW VE73850000
738600-             'NDOR'               TO DP013-MESSAGE-TEXT (1)      73860000
738700         MOVE SQLCA                TO DP013-SQLCA                 73870000
738800         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    73880000
738900         SET DP013-DB2-ABEND                                      73890000
739000             DP013-XCTL-DISPLAY-RESTART                           73900000
739100                                   TO TRUE                        73910000
739200         PERFORM DP013-0000-PROCESS-ABEND                         73920000
739300     END-IF.                                                      73930000
739400                                                                  73940000
739500 6300-ADD-TENTNME.                                                73950000
739600                                                                  73960000
739700     PERFORM                                                      73970000
739800         WITH TEST AFTER                                          73980000
739900         VARYING PV-RETRY-COUNTER                                 73990000
740000         FROM 1 BY 1                                              74000000
740100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               74010000
740200                   OR (SQLCODE = ZERO))                           74020000
740300         EXEC SQL                                                 74030000
740400             INSERT INTO TENTNME                                  74040000
740500                 (ENT_ID,                                         74050000
740600                  SEQ_NBR,                                        74060000
740700                  ENT_NAME_DESC,                                  74070000
740800                  TYPE_CDE)                                       74080000
740900             VALUES                                               74090000
741000                 (:ENTNME-ENT-ID,                                 74100000
741100                  :ENTNME-SEQ-NBR,                                74110000
741200                  :ENTNME-ENT-NAME-DESC,                          74120000
741300                  :ENTNME-TYPE-CDE)                               74130000
741400         END-EXEC                                                 74140000
741500                                                                  74150000
741600         EVALUATE TRUE                                            74160000
741700             WHEN SQLCODE = ZERO                                  74170000
741800             WHEN SQLCODE = -904                                  74180000
741900             WHEN SQLCODE = -913                                  74190000
742000                 CONTINUE                                         74200000
742100             WHEN SQLWARN0 NOT = SPACES                           74210000
742200             WHEN SQLCODE < ZERO                                  74220000
742300             WHEN SQLCODE > ZERO                                  74230000
742400                 MOVE '6300-ADD-TENTNME'                          74240000
742500                                   TO DP013-PARAGRAPH             74250000
742600                 MOVE 'ADD A ROW TO THE ENTITY NAME TABLE'        74260000
742700                                   TO DP013-MESSAGE-TEXT(1)       74270000
742800                 MOVE SQLCA        TO DP013-SQLCA                 74280000
742900                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    74290000
743000                 SET DP013-DB2-ABEND                              74300000
743100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           74310000
743200                 PERFORM DP013-0000-PROCESS-ABEND                 74320000
743300         END-EVALUATE                                             74330000
743400     END-PERFORM.                                                 74340000
743500                                                                  74350000
743600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        74360000
743700         MOVE '6300-ADD-TENTNME'                                  74370000
743800                                   TO DP013-PARAGRAPH             74380000
743900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO ADD A NEW VE74390000
744000-             'NDOR NAME'          TO DP013-MESSAGE-TEXT (1)      74400000
744100         MOVE SQLCA                TO DP013-SQLCA                 74410000
744200         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    74420000
744300         SET DP013-DB2-ABEND                                      74430000
744400             DP013-XCTL-DISPLAY-RESTART                           74440000
744500                                   TO TRUE                        74450000
744600         PERFORM DP013-0000-PROCESS-ABEND                         74460000
744700     END-IF.                                                      74470000
744800                                                                  74480000
744900 6400-ADD-TVNDDPT.                                                74490000
745000                                                                  74500000
745100     PERFORM                                                      74510000
745200         WITH TEST AFTER                                          74520000
745300         VARYING PV-RETRY-COUNTER                                 74530000
745400         FROM 1 BY 1                                              74540000
745500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               74550000
745600                   OR (SQLCODE = ZERO) OR (SQLCODE = -803))       74560000
745700         EXEC SQL                                                 74570000
745800              INSERT INTO TVNDDPT                                 74580000
745900                   ( ENT_ID                                       74590000
746000                    ,DEPT_NBR                                     74600000
746100                    ,INHOUSE_NBR                                  74610000
746200                    ,VEND_TYP_IND                                 74620000
746300                    ,INVC_REQ_PO_IND                              74630000
746400                    ,VND_DEPT_STAT_CD                             74640000
746500                    ,CRE_DTE)                                     74650000
746600              VALUES                                              74660000
746700                   ( :VNDDPT-ENT-ID                               74670000
746800                    ,:VNDDPT-DEPT-NBR                             74680000
746900                    ,:VNDDPT-INHOUSE-NBR                          74690000
747000                    ,:VNDDPT-VEND-TYP-IND                         74700000
747100                    ,:VNDDPT-INVC-REQ-PO-IND                      74710000
747200                    ,'A'                                          74720000
747300                    ,CURRENT DATE)                                74730000
747400         END-EXEC                                                 74740000
747500                                                                  74750000
747600         EVALUATE TRUE                                            74760000
747700             WHEN SQLCODE = ZERO                                  74770000
747800             WHEN SQLCODE = -803                                  74780000
747900             WHEN SQLCODE = -904                                  74790000
748000             WHEN SQLCODE = -913                                  74800000
748100                 CONTINUE                                         74810000
748200             WHEN SQLWARN0 NOT = SPACES                           74820000
748300             WHEN SQLCODE < ZERO                                  74830000
748400             WHEN SQLCODE > ZERO                                  74840000
748500                 MOVE '6400-ADD-TVNDDPT'                          74850000
748600                                   TO DP013-PARAGRAPH             74860000
748700                 MOVE 'ADD A ROW ON THE VENDOR DEPT TABLE'        74870000
748800                                   TO DP013-MESSAGE-TEXT(1)       74880000
748900                 MOVE SQLCA        TO DP013-SQLCA                 74890000
749000                 MOVE 'TVNDDPT'    TO DP013-DB2-TABLE-NAME (1)    74900000
749100                 SET DP013-DB2-ABEND                              74910000
749200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           74920000
749300                 PERFORM DP013-0000-PROCESS-ABEND                 74930000
749400         END-EVALUATE                                             74940000
749500     END-PERFORM.                                                 74950000
749600                                                                  74960000
749700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        74970000
749800         MOVE '6400-ADD-TVNDDPT'   TO DP013-PARAGRAPH             74980000
749900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO ADD A VENDOR74990000
750000-             ' DEPARTMENT'        TO DP013-MESSAGE-TEXT (1)      75000000
750100         MOVE SQLCA                TO DP013-SQLCA                 75010000
750200         MOVE 'TVNDDPT'            TO DP013-DB2-TABLE-NAME (1)    75020000
750300         SET DP013-DB2-ABEND                                      75030000
750400             DP013-XCTL-DISPLAY-RESTART                           75040000
750500                                   TO TRUE                        75050000
750600         PERFORM DP013-0000-PROCESS-ABEND                         75060000
750700     END-IF.                                                      75070000
750800                                                                  75080000
750900*----------------------------------------------------------------*75090000
751000* UPDATE THE VENDOR CONTROL TABLE WITH THE LAST ASSIGNED VENDOR  *75100000
751100* NUMBER.                                                        *75110000
751200*----------------------------------------------------------------*75120000
751300 6600-UPDATE-TVNDCTL.                                             75130000
751400                                                                  75140000
751500     PERFORM                                                      75150000
751600         WITH TEST AFTER                                          75160000
751700         VARYING PV-RETRY-COUNTER                                 75170000
751800         FROM 1 BY 1                                              75180000
751900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               75190000
752000                   OR (SQLCODE = ZERO))                           75200000
752100         EXEC SQL                                                 75210000
752200             UPDATE TVNDCTL                                       75220000
752300                SET LAST_ASG_VND_NBR = :VNDCTL-LAST-ASG-VND-NBR   75230000
752400              WHERE CURRENT OF VND_NBR_CSR                        75240000
752500         END-EXEC                                                 75250000
752600                                                                  75260000
752700         EVALUATE TRUE                                            75270000
752800             WHEN SQLCODE = ZERO                                  75280000
752900             WHEN SQLCODE = -904                                  75290000
753000             WHEN SQLCODE = -913                                  75300000
753100                 CONTINUE                                         75310000
753200             WHEN SQLWARN0 NOT = SPACES                           75320000
753300             WHEN SQLCODE < ZERO                                  75330000
753400             WHEN SQLCODE > ZERO                                  75340000
753500                 MOVE '6600-UPDATE-TVNDCTL'                       75350000
753600                                   TO DP013-PARAGRAPH             75360000
753700                 MOVE 'UPDATE A ROW ON THE VENDOR CNTL TABLE'     75370000
753800                                   TO DP013-MESSAGE-TEXT(1)       75380000
753900                 MOVE SQLCA        TO DP013-SQLCA                 75390000
754000                 MOVE 'TVNDCTL'    TO DP013-DB2-TABLE-NAME (1)    75400000
754100                 SET DP013-DB2-ABEND                              75410000
754200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           75420000
754300                 PERFORM DP013-0000-PROCESS-ABEND                 75430000
754400         END-EVALUATE                                             75440000
754500     END-PERFORM.                                                 75450000
754600                                                                  75460000
754700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        75470000
754800         MOVE '6600-UPDATE-TVNDCTL'                               75480000
754900                                   TO DP013-PARAGRAPH             75490000
755000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A VEN75500000
755100-             'DOR CNTL'           TO DP013-MESSAGE-TEXT (1)      75510000
755200         MOVE SQLCA                TO DP013-SQLCA                 75520000
755300         MOVE 'TVNDCTL'            TO DP013-DB2-TABLE-NAME (1)    75530000
755400         SET DP013-DB2-ABEND                                      75540000
755500             DP013-XCTL-DISPLAY-RESTART                           75550000
755600                                   TO TRUE                        75560000
755700         PERFORM DP013-0000-PROCESS-ABEND                         75570000
755800     END-IF.                                                      75580000
755900                                                                  75590000
756000 8000-CHECK-FOR-RMS.                                              75600000
756100                                                                  75610000
756200     IF ASC-PARTNER-TYPE NOT = EXTENT-PRTNR-TYP-CDE               75620000
756300        IF EXTENT-PRTNR-TYP-CDE = SPACES                          75630000
756400           SET VN007-UPDATE-PRFRMD TO TRUE                        75640000
756500        ELSE                                                      75650000
756600           SET VN007-CHANGE-PRTNR-TYPE                            75660000
756700               VN007-UPDATE-PRFRMD TO TRUE                        75670000
756800        END-IF                                                    75680000
756900     END-IF.                                                      75690000
757000                                                                  75700000
757100     IF ASC-PARTNER-IND NOT = EXTENT-PRTNR-IND                    75710000
757200        IF ASC-PARTNER-IND = 'N'                                  75720000
757300           SET VN007-DELETE-PRFRMD TO TRUE                        75730000
757400        ELSE                                                      75740000
757500           SET VN007-UPDATE-PRFRMD TO TRUE                        75750000
757600        END-IF                                                    75760000
757700     END-IF.                                                      75770000
757800                                                                  75780000
757900     IF ASC-PRIMARY-TYPE NOT = EXTENT-PRIM-TYP-CDE                75790000
758000        IF EXTENT-PRIM-TYP-CDE = 'M'                              75800000
758100           IF EXTENT-VND-IN-RMS-IND = 'Y'                         75810000
758200              SET VN013-ACTION-DELETE TO TRUE                     75820000
758300           END-IF                                                 75830000
758400           IF ASC-PRIMARY-TYPE = 'E' AND                          75840000
758500              ASC-PARTNER-IND = 'Y'                               75850000
758600               SET VN007-UPDATE-PRFRMD TO TRUE                    75860000
758700           END-IF                                                 75870000
758800        ELSE                                                      75880000
758900           IF EXTENT-PRIM-TYP-CDE = 'E'                           75890000
759000              IF EXTENT-PRTNR-IND = 'Y'                           75900000
759100                 SET VN007-DELETE-PRFRMD TO TRUE                  75910000
759200              END-IF                                              75920000
759300           END-IF                                                 75930000
759400        END-IF                                                    75940000
759500     END-IF.                                                      75950000
759600                                                                  75960000
759700     IF ASC-VEND-NAME NOT = ENTNME-ENT-NAME-DESC                  75970000
759800           SET VN007-UPDATE-PRFRMD TO TRUE                        75980000
759900     END-IF.                                                      75990000
760000                                                                  76000000
760100     IF ASC-STATUS-CDE NOT = EXTENT-STATUS-CDE                    76010000
760200           SET VN007-UPDATE-PRFRMD TO TRUE                        76020000
760300     END-IF.                                                      76030000
760400                                                                  76040000
760500     IF ASC-SCAC-CDE NOT = EXTENT-SCAC-CDE                        76050000
760600        SET VN007-UPDATE-PRFRMD TO TRUE                           76060000
760700     END-IF.                                                      76070000
760800                                                                  76080000
760900     IF ASC-PREPACK-EDI-CDE NOT = EXTENT-EDI-PO-PREPK-CDE         76090000
761000        SET VN007-UPDATE-PRFRMD TO TRUE                           76100000
761100     END-IF.                                                      76110000
761200                                                                  76120000
761300     IF ASC-PARTNER-TYPE = 'FA'                                   76130000
761400       OR EXTENT-PRTNR-TYP-CDE = 'FA'                             76140000
761500         CONTINUE                                                 76150000
761600     ELSE                                                         76160000
761700         MOVE ASC-LINE-OF-CREDIT   TO PV-LNE-OF-CR-AMT            76170000
761800         MOVE PV-LNE-OF-CR-AMT-DLLR TO PV-LINE-OF-CREDIT-DLLR     76180000
761900         COMPUTE PV-LINE-OF-CREDIT-CENT =                         76190000
762000                                   PV-LNE-OF-CR-AMT-CENT / 100    76200000
762100         IF PV-LINE-OF-CREDIT  NOT = EXTENT-LNE-OF-CR-AMT         76210000
762200            SET VN007-UPDATE-PRFRMD TO TRUE                       76220000
762300         END-IF                                                   76230000
762400     END-IF.                                                      76240000
762500                                                                  76250000
762600 8100-INSERT-INTO-RMS.                                            76260000
762700                                                                  76270000
762800     INITIALIZE VN007-INTERFACE-MESSAGE-PARMS.                    76280000
762900                                                                  76290000
763000     MOVE ASC-DUN-NBR           TO VN007-VND-NBR.                 76300000
763100     MOVE ASC-PRIMARY-TYPE      TO VN007-PRIM-TYP-CDE.            76310000
763200     MOVE ASC-PARTNER-TYPE      TO VN007-PRTNR-TYP-CDE.           76320000
763300     MOVE 'Y'                   TO VN007-VND-IN-RMS-IND.          76330000
763400     MOVE ASC-STATUS-CDE        TO VN007-STATUS-CDE.              76340000
763500     MOVE ASC-VEND-NAME         TO VN007-ENT-NAME-DESC.           76350000
763600     MOVE ASC-SCAC-CDE          TO VN007-SCAC-CDE.                76360000
763700     MOVE ASC-ENT-ID            TO VN007-ENT-ID.                  76370000
763800     MOVE ASC-PREPACK-EDI-CDE   TO VN007-PO-PREPK-CDE.            76380000
763900                                                                  76390000
764000     IF ASC-PARTNER-TYPE = 'BK'                                   76400000
764100        MOVE ASC-LINE-OF-CREDIT TO VN007-LINE-OF-CR-AMT           76410000
764200     ELSE                                                         76420000
764300        MOVE ZEROES             TO VN007-LINE-OF-CR-AMT           76430000
764400     END-IF.                                                      76440000
764500                                                                  76450000
764600     MOVE 'N'                TO VN007-PRTNR-DELETE-IND.           76460000
764700                                                                  76470000
764800     MOVE PV-LONG-ENT-NAME-DESC                                   76480000
764900                             TO VN007-LONGNAME.                   76490000
765000     MOVE ' '                TO VN007-LONGNAME-DELETE-IND.        76500000
765100**8  MOVE 'N'                TO VN007-LONGNAME-DELETE-IND.        76510000
765200                                                                  76520000
765300     PERFORM 8300-LINK-TO-VNKCS024.                               76530000
765400                                                                  76540000
765500 8200-LINK-TO-VNKCS023.                                           76550000
765600                                                                  76560000
765700     EXEC CICS LINK PROGRAM (PC-VNKCS023)                         76570000
765800                   COMMAREA (VN013-COMMAREA)                      76580000
765900                       RESP (PV-CICS-RESPONSE)                    76590000
766000     END-EXEC.                                                    76600000
766100                                                                  76610000
766200     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   76620000
766300         CONTINUE                                                 76630000
766400     ELSE                                                         76640000
766500        MOVE VN013-PROGRAM-NAME   TO DP013-PROGRAM                76650000
766600        MOVE VN013-PARAGRAPH-NAME TO DP013-PARAGRAPH              76660000
766700        MOVE VN013-MESSAGE        TO DP013-MESSAGE-TEXT (1)       76670000
766800        MOVE VN013-SQLCODE        TO DP013-SQLCA                  76680000
766900        SET DP013-DB2-ABEND                                       76690000
767000            DP013-ROLLBACK                                        76700000
767100            DP013-XCTL-DISPLAY-RESTART TO TRUE                    76710000
767200        PERFORM DP013-0000-PROCESS-ABEND                          76720000
767300     END-IF.                                                      76730000
767400                                                                  76740000
767500     IF VN013-MAX-ADDR-EXCEEDED                                   76750000
767600        MOVE PC-TSYMSG-02645 TO DP020-MSG-NUMBER                  76760000
767700        SET DP020-MSG-WARNING TO TRUE                             76770000
767800     END-IF.                                                      76780000
767900                                                                  76790000
768000     IF VN013-MAX-DEPT-EXCEEDED                                   76800000
768100         MOVE PC-TSYMSG-02646  TO DP020-MSG-NUMBER                76810000
768200         SET DP020-MSG-WARNING TO TRUE                            76820000
768300     END-IF.                                                      76830000
768400                                                                  76840000
768500     IF VN013-MAX-CPBLTY-EXCEEDED                                 76850000
768600         MOVE PC-TSYMSG-03380  TO DP020-MSG-NUMBER                76860000
768700         SET DP020-MSG-WARNING TO TRUE                            76870000
768800     END-IF.                                                      76880000
768900                                                                  76890000
769000     IF VN013-MAX-RLTNSHP-EXCEEDED                                76900000
769100         MOVE PC-TSYMSG-03381  TO DP020-MSG-NUMBER                76910000
769200         SET DP020-MSG-WARNING TO TRUE                            76920000
769300     END-IF.                                                      76930000
769400                                                                  76940000
769500     IF VN013-RMS-VENDOR-ADDED                                    76950000
769600        MOVE 'Y' TO EXTENT-VND-IN-RMS-IND                         76960000
769700     END-IF.                                                      76970000
769800                                                                  76980000
769900 8300-LINK-TO-VNKCS024.                                           76990000
770000                                                                  77000000
770100     EXEC CICS LINK PROGRAM (PC-VNKCS024)                         77010000
770200                   COMMAREA (VN007-COMMAREA)                      77020000
770300                       RESP (PV-CICS-RESPONSE)                    77030000
770400     END-EXEC.                                                    77040000
770500                                                                  77050000
770600     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   77060000
770700         CONTINUE                                                 77070000
770800     ELSE                                                         77080000
770900        MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM                77090000
771000        MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH              77100000
771100        MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT (1)       77110000
771200        MOVE VN007-REASON-CODE    TO DP013-SQLCA                  77120000
771300        SET DP013-DB2-ABEND                                       77130000
771400            DP013-ROLLBACK                                        77140000
771500            DP013-XCTL-DISPLAY-RESTART TO TRUE                    77150000
771600        PERFORM DP013-0000-PROCESS-ABEND                          77160000
771700     END-IF.                                                      77170000
771800                                                                  77180000
771900 8400-UPDATE-TVNDDPT.                                             77190000
772000                                                                  77200000
772100     PERFORM                                                      77210000
772200         WITH TEST AFTER                                          77220000
772300         VARYING PV-RETRY-COUNTER                                 77230000
772400         FROM 1 BY 1                                              77240000
772500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               77250000
772600                   OR (SQLCODE = ZERO))                           77260000
772700         EXEC SQL                                                 77270000
772800             UPDATE TVNDDPT                                       77280000
772900                SET VND_DEPT_STAT_CD = 'I'                        77290000
773000              WHERE ENT_ID = :EXTENT-ENT-ID                       77300000
773100         END-EXEC                                                 77310000
773200                                                                  77320000
773300         EVALUATE TRUE                                            77330000
773400             WHEN SQLCODE = ZERO                                  77340000
773500             WHEN SQLCODE = -904                                  77350000
773600             WHEN SQLCODE = -913                                  77360000
773700                 CONTINUE                                         77370000
773800             WHEN SQLWARN0 NOT = SPACES                           77380000
773900             WHEN SQLCODE < ZERO                                  77390000
774000             WHEN SQLCODE > ZERO                                  77400000
774100                 MOVE '8400-UPDATE-TVNDDPT'                       77410000
774200                                   TO DP013-PARAGRAPH             77420000
774300                 MOVE 'UPDATE ROWS ON TVNDDPT TO INACTIVE   '     77430000
774400                                   TO DP013-MESSAGE-TEXT(1)       77440000
774500                 MOVE SQLCA        TO DP013-SQLCA                 77450000
774600                 MOVE 'TVNDDPT'    TO DP013-DB2-TABLE-NAME (1)    77460000
774700                 SET DP013-DB2-ABEND                              77470000
774800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           77480000
774900                 PERFORM DP013-0000-PROCESS-ABEND                 77490000
775000         END-EVALUATE                                             77500000
775100     END-PERFORM.                                                 77510000
775200                                                                  77520000
775300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        77530000
775400         MOVE '8400-UPDATE-TVNDDPT'                               77540000
775500                                   TO DP013-PARAGRAPH             77550000
775600         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO UPDATE TVNDDPT' 77560000
775700                                   TO DP013-MESSAGE-TEXT (1)      77570000
775800         MOVE SQLCA                TO DP013-SQLCA                 77580000
775900         MOVE 'TVNDDPT'            TO DP013-DB2-TABLE-NAME (1)    77590000
776000         SET DP013-DB2-ABEND                                      77600000
776100             DP013-XCTL-DISPLAY-RESTART                           77610000
776200                                   TO TRUE                        77620000
776300         PERFORM DP013-0000-PROCESS-ABEND                         77630000
776400     END-IF.                                                      77640000
776500                                                                  77650000
776600                                                                  77660000
776700*----------------------------------------------------------------*77670000
776800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *77680000
776900*----------------------------------------------------------------*77690000
777000 9100-READ-SEL-QUEUE.                                             77700000
777100                                                                  77710000
777200     EXEC CICS                                                    77720000
777300         READQ TS                                                 77730000
777400             QUEUE (ASC-SEL-QUEUE-NAME)                           77740000
777500             INTO  (VN003-VENDOR-SEL-REC)                         77750000
777600             ITEM  (ASC-SEL-ITEM)                                 77760000
777700             RESP  (PV-CICS-RESPONSE)                             77770000
777800     END-EXEC.                                                    77780000
777900                                                                  77790000
778000     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   77800000
778100         CONTINUE                                                 77810000
778200     ELSE                                                         77820000
778300         SET DP013-LOGIC-ABEND                                    77830000
778400             DP013-NO-ROLLBACK     TO TRUE                        77840000
778500         MOVE '9100-READ-SEL-QUEUE'                               77850000
778600                                   TO DP013-PARAGRAPH             77860000
778700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   77870000
778800                                   TO DP013-MESSAGE-TEXT (1)      77880000
778900         PERFORM DP013-0000-PROCESS-ABEND                         77890000
779000     END-IF.                                                      77900000
779100                                                                  77910000
779200*----------------------------------------------------------------*77920000
779300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *77930000
779400*----------------------------------------------------------------*77940000
779500 9200-REWRITE-LIST-QUEUE.                                         77950000
779600                                                                  77960000
779700     EXEC CICS                                                    77970000
779800          WRITEQ TS                                               77980000
779900              QUEUE  (ASC-SEL-QUEUE-NAME)                         77990000
780000              FROM   (VN003-VENDOR-SEL-REC)                       78000000
780100              ITEM   (ASC-SEL-ITEM)                               78010000
780200              RESP   (PV-CICS-RESPONSE)                           78020000
780300              REWRITE                                             78030000
780400     END-EXEC.                                                    78040000
780500                                                                  78050000
780600     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               78060000
780700         SET DP013-CICS-ABEND                                     78070000
780800             DP013-NO-ROLLBACK     TO TRUE                        78080000
780900         MOVE '9200-REWRITE-LIST-QUEUE'                           78090000
781000                                   TO DP013-PARAGRAPH             78100000
781100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   78110000
781200                                   TO DP013-MESSAGE-TEXT (1)      78120000
781300         PERFORM DP013-0000-PROCESS-ABEND                         78130000
781400     END-IF.                                                      78140000
781500                                                                  78150000
781600*----------------------------------------------------------------*78160000
781700*    ABEND PROCESSOR MODULE                                      *78170000
781800*----------------------------------------------------------------*78180000
781900     COPY DPPD013.                                                78190000
