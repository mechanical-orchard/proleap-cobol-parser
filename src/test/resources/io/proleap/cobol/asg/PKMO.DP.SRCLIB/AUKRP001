000100******************************************************************00010025
000200 IDENTIFICATION DIVISION.                                         00020001
000300 PROGRAM-ID.             AUKRP001.                                00030001
000400 AUTHOR.                 BARB ERTL.                               00040001
000500 INSTALLATION.           KOHLS.                                   00050001
000600 DATE-WRITTEN            FEBRUARY 2008.                           00060001
000700 DATE-COMPILED.                                                   00070001
000800                                                                  00080001
000920******************************************************************00092022
001000*  BLACKHAWK RECONCILIATION REPORTING                            *00100001
001100******************************************************************00110001
001110******************************************************************00111022
001120*  09/26/11 TY HOPP  INCEASED SIZE OF TABLE AND PV-MAX-SUB FROM  *00112023
001121*                    500 TO 999.                                 *00112123
C66917*  10/25/13 COGNIZANT INCREASED SIZE OF TABLE AND PV-MAX-SU      *00112230
C66917*                     FROM 999 TO 1500.                          *00112329
C66917*  10/23/16 COGNIZANT INCREASED SIZE OF TABLE AND PV-MAX-SU      *00112431
C66917*                     FROM 1500 TO 2000.                         *00112531
001130******************************************************************00113022
001200 ENVIRONMENT DIVISION.                                            00120001
001300 CONFIGURATION SECTION.                                           00130001
001400                                                                  00140001
001500 SOURCE-COMPUTER.        IBM-3090.                                00150001
001600 OBJECT-COMPUTER.        IBM-3090.                                00160001
001700                                                                  00170001
001800 INPUT-OUTPUT SECTION.                                            00180001
001900                                                                  00190001
002000 FILE-CONTROL.                                                    00200001
002100     SELECT DATE-CARD-FILE                                        00210001
002200         ASSIGN TO INP01.                                         00220001
002300                                                                  00230001
002400     SELECT REPORT-FILE-IN                                        00240001
002500         ASSIGN TO INP02.                                         00250001
002600                                                                  00260001
002700     SELECT RECONCILED-REPORT                                     00270004
002800         ASSIGN TO RPT01.                                         00280001
002900                                                                  00290001
003000     SELECT AUDIT-REPORT                                          00300003
003100         ASSIGN TO RPT02.                                         00310001
003200                                                                  00320001
003300******************************************************************00330001
003400 DATA DIVISION.                                                   00340001
003500 FILE SECTION.                                                    00350001
003600                                                                  00360001
003700 FD  DATE-CARD-FILE                                               00370001
003800     RECORDING MODE IS F                                          00380001
003900     BLOCK CONTAINS 0 RECORDS                                     00390001
004000     LABEL RECORDS ARE STANDARD.                                  00400001
004100                                                                  00410001
004200 01  DATE-CARD-RECORD                       PIC X(80).            00420001
004300                                                                  00430001
004400 FD  REPORT-FILE-IN                                               00440001
004500     RECORDING MODE IS F                                          00450001
004600     BLOCK CONTAINS 0 RECORDS                                     00460001
004700     LABEL RECORDS ARE STANDARD.                                  00470001
004800                                                                  00480001
004900 01  REPORT-RECORD                          PIC X(150).           00490001
005000                                                                  00500001
005100 FD  RECONCILED-REPORT                                            00510004
005200     RECORDING MODE IS F                                          00520001
005300     BLOCK CONTAINS 0 RECORDS                                     00530001
005400     LABEL RECORDS ARE STANDARD.                                  00540001
005500                                                                  00550001
005600 01  RECONCILED-RECORD                      PIC X(132).           00560004
005700                                                                  00570001
005800 FD  AUDIT-REPORT                                                 00580003
005900     RECORDING MODE IS F                                          00590001
006000     LABEL RECORDS ARE STANDARD                                   00600001
006100     BLOCK CONTAINS 0 RECORDS.                                    00610001
006200                                                                  00620001
006300 01  AUDIT-RECORD                           PIC X(132).           00630003
006400                                                                  00640001
006500******************************************************************00650001
006600 WORKING-STORAGE SECTION.                                         00660001
006700******************************************************************00670001
006800                                                                  00680001
006900******************************************************************00690001
007000*  BLACKHAWK REPORT RECORD LAYOUT                                *00700001
007100******************************************************************00710001
007200     COPY AURD013.                                                00720001
007300                                                                  00730001
007400******************************************************************00740001
007500*  KOHL'S STANDARD REPORT HEADING                                *00750001
007600******************************************************************00760001
007700     COPY DPWS132.                                                00770001
007800                                                                  00780001
007900 01  RP1-HEADING-LINE-2.                                          00790001
008000     05  FILLER                       PIC  X(46)  VALUE SPACES.   00800001
008100     05  RP1-SUBTITLE.                                            00810001
008200         10  FILLER                   PIC  X(05)  VALUE SPACES.   00820001
008300         10  RP1-SUBNAME              PIC  X(26)  VALUE SPACES.   00830016
008400     05  FILLER                       PIC  X(01)  VALUE SPACES.   00840001
008500     05  RP1-DATE.                                                00850001
008600         10  RP1-DATE-MM              PIC  X(02).                 00860001
008700         10  FILLER                   PIC  X(01)  VALUE '/'.      00870001
008800         10  RP1-DATE-DD              PIC  X(02).                 00880001
008900         10  FILLER                   PIC  X(01)  VALUE '/'.      00890001
009000         10  RP1-DATE-CC              PIC  X(02).                 00900001
009100         10  RP1-DATE-YY              PIC  X(02).                 00910001
009200     05  FILLER                       PIC  X(44)  VALUE SPACES.   00920016
009300                                                                  00930001
009400 01  RP1-HEADING-LINE-4.                                          00940001
009500     05  FILLER                       PIC  X(01)  VALUE SPACE.    00950001
009600     05  FILLER                       PIC  X(10)  VALUE           00960001
009700                                          'TRANS DATE'.           00970001
009800     05  FILLER                       PIC  X(08)  VALUE SPACES.   00980010
009900     05  FILLER                       PIC  X(07)  VALUE 'CARD ID'.00990001
010000     05  FILLER                       PIC  X(19)  VALUE SPACES.   01000013
010100     05  FILLER                       PIC  X(03)  VALUE 'UPC'.    01010010
010200     05  FILLER                       PIC  X(07)  VALUE SPACES.   01020010
010300     05  FILLER                       PIC  X(09)  VALUE           01030001
010400                                          'TRANS AMT'.            01040001
010500     05  FILLER                       PIC  X(02)  VALUE SPACES.   01050001
010600     05  FILLER                       PIC  X(05)  VALUE 'STORE'.  01060001
010700     05  FILLER                       PIC  X(02)  VALUE SPACES.   01070001
010800     05  FILLER                       PIC  X(08)  VALUE           01080001
010900                                          'REGISTER'.             01090001
011000     05  FILLER                       PIC  X(02)  VALUE SPACES.   01100001
011100     05  FILLER                       PIC  X(08)  VALUE           01110001
011200                                          'TRANS   '.             01120001
011300     05  FILLER                       PIC  X(02)  VALUE SPACES.   01130001
011400     05  FILLER                       PIC  X(07)  VALUE 'PARTNER'.01140001
011500     05  FILLER                       PIC  X(02)  VALUE SPACES.   01150001
011600     05  RP1-COMMENT-LINE             PIC  X(30)  VALUE SPACES.   01160013
011700                                                                  01170001
011800 01  RP1-DETAIL-LINE.                                             01180001
011900     05  FILLER                       PIC  X(01)  VALUE SPACE.    01190001
012000     05  RP1-TRANS-DATE               PIC  X(10)  VALUE SPACES.   01200001
012100     05  FILLER                       PIC  X(03)  VALUE SPACES.   01210001
012200     05  RP1-CARD-ID                  PIC  X(19)  VALUE SPACES.   01220009
012300     05  FILLER                       PIC  X(05)  VALUE SPACES.   01230010
012400     05  RP1-UPC                      PIC  Z(15)  VALUE SPACES.   01240001
012500     05  FILLER                       PIC  X(03)  VALUE SPACES.   01250014
012600     05  RP1-TRANS-AMT                PIC  ZZZ99.99-.             01260011
012700     05  FILLER                       PIC  X(02)  VALUE SPACES.   01270001
012800     05  RP1-STORE                    PIC  Z(04)  VALUE SPACES.   01280001
012900     05  FILLER                       PIC  X(05)  VALUE SPACES.   01290010
013000     05  RP1-REGISTER                 PIC  Z(04)  VALUE SPACES.   01300001
013100     05  FILLER                       PIC  X(04)  VALUE SPACES.   01310015
013200     05  RP1-TRN-NBR                  PIC  Z(04)  VALUE SPACES.   01320006
013300     05  FILLER                       PIC  X(04)  VALUE SPACES.   01330014
013400     05  RP1-PARTNER                  PIC  X(08)  VALUE SPACES.   01340001
013500     05  FILLER                       PIC  X(02)  VALUE SPACES.   01350011
013600     05  RP1-DETAIL-COMMENT           PIC  X(30)  VALUE SPACES.   01360015
013700                                                                  01370001
013800 01  RPT-TOTAL-LINE-1.                                            01380001
013900     05  FILLER                       PIC  X(01)  VALUE SPACE.    01390001
014000     05  FILLER                       PIC  X(06)  VALUE 'TOTALS'. 01400001
014100     05  FILLER                       PIC  X(18)  VALUE SPACES.   01410021
014200     05  FILLER                       PIC  X(10)  VALUE           01420011
014300                                          'RECONCILED'.           01430001
014400     05  FILLER                       PIC  X(15)  VALUE SPACES.   01440020
014500     05  FILLER                       PIC  X(13)  VALUE           01450001
014600                                          'MISSING KOHLS'.        01460001
014700     05  FILLER                       PIC  X(13)  VALUE SPACES.   01470020
014800     05  FILLER                       PIC  X(17)  VALUE           01480005
014900                                          'MISSING BLACKHAWK'.    01490001
015000     05  FILLER                       PIC  X(12)  VALUE SPACES.   01500020
015100     05  FILLER                       PIC  X(14)  VALUE           01510011
015200                                          'MULTIPLE RECON'.       01520011
015300     05  FILLER                       PIC  X(13)  VALUE SPACES.   01530020
015400                                                                  01540001
015500 01  RPT-TOTAL-LINE-2.                                            01550001
015600     05  FILLER                       PIC  X(19)  VALUE SPACE.    01560018
015700     05  FILLER                       PIC  X(06)  VALUE 'NUMBER'. 01570001
015800     05  FILLER                       PIC  X(10)  VALUE SPACES.   01580019
015900     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01590001
016000     05  FILLER                       PIC  X(05)  VALUE SPACES.   01600020
016100     05  FILLER                       PIC  X(06)  VALUE 'NUMBER'. 01610001
016200     05  FILLER                       PIC  X(10)  VALUE SPACES.   01620020
016300     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01630001
016400     05  FILLER                       PIC  X(06)  VALUE SPACES.   01640020
016500     05  FILLER                       PIC  X(06)  VALUE 'NUMBER'. 01650001
016600     05  FILLER                       PIC  X(10)  VALUE SPACES.   01660020
016700     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01670001
016800     05  FILLER                       PIC  X(06)  VALUE SPACES.   01680020
016900     05  FILLER                       PIC  X(06)  VALUE 'NUMBER'. 01690007
017000     05  FILLER                       PIC  X(10)  VALUE SPACES.   01700020
017100     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01710007
017200     05  FILLER                       PIC  X(08)  VALUE SPACES.   01720020
017300                                                                  01730001
017400 01  RPT-TOTAL-DETAIL-LINE.                                       01740001
017500     05  FILLER                       PIC  X(01)  VALUE SPACE.    01750001
017600     05  TOTAL-DATE                   PIC  X(10)  VALUE SPACES.   01760001
017700     05  FILLER                       PIC  X(03)  VALUE SPACES.   01770010
017800     05  TOTAL-RECONCILED-NBR         PIC  ZZZ,ZZZ,ZZ9.           01780017
017900     05  FILLER                       PIC  X(02)  VALUE SPACES.   01790011
018000     05  TOTAL-RECONCILED-AMT         PIC  ZZZ,ZZZ,Z99.99.        01800017
018100     05  FILLER                       PIC  X(02)  VALUE SPACES.   01810010
018200     05  TOTAL-GC-NBR                 PIC  Z,ZZZ,ZZ9.             01820017
018300     05  FILLER                       PIC  X(02)  VALUE SPACES.   01830010
018400     05  TOTAL-GC-AMT                 PIC  ZZZ,ZZZ,Z99.99.        01840017
018500     05  FILLER                       PIC  X(03)  VALUE SPACES.   01850010
018600     05  TOTAL-BLACKHAWK-NBR          PIC  Z,ZZZ,ZZ9.             01860017
018700     05  FILLER                       PIC  X(02)  VALUE SPACES.   01870010
018800     05  TOTAL-BLACKHAWK-AMT          PIC  ZZZ,ZZZ,Z99.99.        01880017
018900     05  FILLER                       PIC  X(03)  VALUE SPACES.   01890010
019000     05  TOTAL-MULTI-RECON-NBR        PIC  Z,ZZZ,ZZ9.             01900017
019100     05  FILLER                       PIC  X(02)  VALUE SPACES.   01910010
019200     05  TOTAL-MULTI-RECON-AMT        PIC  ZZZ,ZZZ,Z99.99.        01920017
019300     05  FILLER                       PIC  X(09)  VALUE SPACES.   01930017
019400                                                                  01940001
019500 01  END-OF-REPORT-LINE.                                          01950001
019600     05  FILLER                       PIC  X(51)  VALUE SPACE.    01960001
019700     05  FILLER                       PIC  X(29)  VALUE           01970001
019800         '*****   END OF REPORT   *****'.                         01980001
019900     05  FILLER                       PIC  X(52)  VALUE SPACE.    01990001
020000                                                                  02000001
020100 01  PC-PROGRAM-CONSTANTS.                                        02010001
020200     05  PC-PROGRAM-NAME              PIC  X(08)  VALUE           02020001
020300                                                    'AUKRP001'.   02030001
020400     05  PC-LINES-PER-PAGE            PIC S9(04)  VALUE +60       02040001
020500                                                     COMP SYNC.   02050001
020600                                                                  02060001
020700 01  PS-PROGRAM-SWITCHES.                                         02070001
020800     05  PS-END-OF-REPORT-FILE-SW     PIC X(01)   VALUE 'N'.      02080001
020900         88  PS-END-OF-REPORT-FILE                VALUE 'Y'.      02090001
021000     05  PS-END-OF-CARD-FILE-SW       PIC X(01)   VALUE 'N'.      02100001
021100         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      02110001
021200     05  PS-DETAIL-RECORDS-YES-SW     PIC X(01)   VALUE 'N'.      02120001
021300         88  PS-DETAIL-RECORDS-YES                VALUE 'Y'.      02130001
021400                                                                  02140001
021500 01  PV-PROGRAM-VARIABLES.                                        02150001
021600     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACE.    02160001
021700     05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACE.    02170001
021800     05  PV-DB2-OPERATION             PIC  X(30)  VALUE SPACE.    02180001
C66917     05  PV-SUB                       PIC S9(05)  VALUE +0 COMP.  02190029
022000     05  PV-MAX-ARRAY                 PIC S9(04)  VALUE +0 COMP.  02200003
022100*    05  PV-MAX-SUB                   PIC S9(04)  VALUE +500 COMP.02210022
C66917     05  PV-MAX-SUB                  PIC S9(05)  VALUE +5000 COMP.02211032
022200     05  PV-PAGE-COUNT                PIC S9(04)  VALUE +0 COMP.  02220001
022300     05  PV-PAGE-COUNT1               PIC S9(04)  VALUE +0 COMP.  02230001
022400     05  PV-LINE-COUNT                PIC S9(04)  VALUE +0 COMP.  02240001
022500     05  PV-LINE-COUNT1               PIC S9(04)  VALUE +0 COMP.  02250001
022600     05  PV-TRANSACTION-DATE          PIC  X(10) VALUE SPACES.    02260003
022700     05  PV-MULTI-LITERAL.                                        02270003
022800         10  FILLER                   PIC  X(12)  VALUE           02280003
022900                                                 'PRIOR RECON '.  02290003
023000         10  PV-PRIOR-RECON-DATE      PIC  X(10)  VALUE SPACES.   02300003
023100                                                                  02310001
023200 01  PA-PROGRAM-ACCUMULATORS.                                     02320003
023300*    05  PA-TOTAL-ENTRY OCCURS 500 TIMES.                         02330022
C66917     05  PA-TOTAL-ENTRY OCCURS 5000 TIMES.                        02331032
023400         10  PA-DATE                  PIC X(10)     VALUE SPACES. 02340003
023500         10  PA-RECONCILED-NBR        PIC S9(09)    VALUE ZEROES. 02350003
023600         10  PA-RECONCILED-AMT        PIC S9(09)V99 VALUE ZEROES. 02360003
023700         10  PA-MISSING-GC-NBR        PIC S9(07)    VALUE ZEROES. 02370003
023800         10  PA-MISSING-GC-AMT        PIC S9(09)V99 VALUE ZEROES. 02380003
023900         10  PA-MISSING-BLACKHAWK-NBR PIC S9(07)    VALUE ZEROES. 02390003
024000         10  PA-MISSING-BLACKHAWK-AMT PIC S9(09)V99 VALUE ZEROES. 02400003
024100         10  PA-MULTI-RECON-NBR       PIC S9(07)    VALUE ZEROES. 02410003
024200         10  PA-MULTI-RECON-AMT       PIC S9(09)V99 VALUE ZEROES. 02420003
024300                                                                  02430001
024400******************************************************************02440001
024500* RECORD LAYOUT FOR INPUT DATE CARD                               02450001
024600******************************************************************02460001
024700 01  CC-CONTROL-CARD.                                             02470001
024800     05  CC-DATE-CCYY-MM-DD.                                      02480001
024900         10  CC-CONTROL-DATE-CC       PIC  X(02)   VALUE SPACES.  02490001
025000         10  CC-CONTROL-DATE-YY       PIC  X(02)   VALUE SPACES.  02500001
025100         10  FILLER                   PIC  X(01)   VALUE SPACES.  02510001
025200         10  CC-CONTROL-DATE-MM       PIC  X(02)   VALUE SPACES.  02520001
025300         10  FILLER                   PIC  X(01)   VALUE SPACES.  02530001
025400         10  CC-CONTROL-DATE-DD       PIC  X(02)   VALUE SPACES.  02540001
025500      05  FILLER                      PIC  X(70)   VALUE SPACES.  02550001
025600                                                                  02560001
025700 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       02570001
025800                                                 COMP SYNC.       02580001
025900     88  AC-CONTROL-CARD-ERROR                   VALUE +4003.     02590001
026000     88  AC-TABLE-OVERFLOW                       VALUE +4004.     02600001
026100     88  AC-DATE-ERROR                           VALUE +4019.     02610001
026200                                                                  02620001
026300 01  SD-SYSTEM-DATE.                                              02630001
026400     05  SD-SYSTEM-YEAR               PIC  9(02)  VALUE ZEROS.    02640001
026500     05  SD-SYSTEM-MONTH              PIC  9(02)  VALUE ZEROS.    02650001
026600     05  SD-SYSTEM-DAY                PIC  9(02)  VALUE ZEROS.    02660001
026700                                                                  02670001
026800 01  ST-SYSTEM-TIME.                                              02680001
026900     05  ST-SYSTEM-HOUR               PIC  9(02)  VALUE ZEROS.    02690001
027000     05  ST-SYSTEM-MINUTE             PIC  9(02)  VALUE ZEROS.    02700001
027100     05  FILLER                       PIC  9(04)  VALUE ZEROS.    02710001
027200                                                                  02720001
027300******************************************************************02730001
027400* DATE ROUTINE COPY MEMBERS                                       02740001
027500******************************************************************02750001
027600     COPY DPWS500.                                                02760001
027700                                                                  02770001
027800******************************************************************02780001
027900 PROCEDURE DIVISION.                                              02790001
028000******************************************************************02800001
028100 0000-PROGRAM-MAINLINE.                                           02810001
028200                                                                  02820001
028300     PERFORM 1000-INITIALIZE.                                     02830001
028400                                                                  02840001
028500     PERFORM 2000-PROCESS-REPORT-FILE                             02850001
028600       UNTIL PS-END-OF-REPORT-FILE.                               02860001
028700                                                                  02870001
028800     IF PS-DETAIL-RECORDS-YES                                     02880001
028900         PERFORM 8000-WRITE-TOTAL-LINE                            02890001
029000     END-IF.                                                      02900001
029100                                                                  02910001
029200     PERFORM 9000-EOJ-ROUTINE.                                    02920001
029300                                                                  02930001
029400     STOP RUN.                                                    02940001
029500                                                                  02950001
029600******************************************************************02960001
029700*  1000-INITIALIZE                                                02970001
029800******************************************************************02980001
029900 1000-INITIALIZE.                                                 02990001
030000                                                                  03000001
030100     OPEN INPUT  DATE-CARD-FILE                                   03010001
030200                 REPORT-FILE-IN                                   03020001
030300          OUTPUT RECONCILED-REPORT                                03030004
030400                 AUDIT-REPORT.                                    03040003
030500                                                                  03050001
030600     ACCEPT SD-SYSTEM-DATE  FROM DATE.                            03060001
030700     ACCEPT ST-SYSTEM-TIME  FROM TIME.                            03070001
030800                                                                  03080001
030900     MOVE SD-SYSTEM-MONTH          TO  DP132-RUN-MONTH.           03090001
031000     MOVE SD-SYSTEM-DAY            TO  DP132-RUN-DAY.             03100001
031100     MOVE SD-SYSTEM-YEAR           TO  DP132-RUN-YEAR.            03110001
031200     MOVE ST-SYSTEM-HOUR           TO  DP132-RUN-HOUR.            03120001
031300     MOVE ST-SYSTEM-MINUTE         TO  DP132-RUN-MINUTE.          03130001
031400                                                                  03140001
031500     MOVE PC-PROGRAM-NAME  TO  DP132-PROGRAM-NAME.                03150001
031600                                                                  03160001
031700     PERFORM 1400-PROCESS-CONTROL-CARD.                           03170001
031800                                                                  03180001
031900     PERFORM 5000-RECONCILED-REPORT-HEADER.                       03190004
032000     PERFORM 6000-AUDIT-REPORT-HEADER.                            03200003
032100                                                                  03210001
032200     PERFORM 7000-READ-REPORT-FILE.                               03220001
032300                                                                  03230001
032400     IF PS-END-OF-REPORT-FILE                                     03240001
032500         CONTINUE                                                 03250001
032600     ELSE                                                         03260001
032700         SET PS-DETAIL-RECORDS-YES TO TRUE                        03270001
032800     END-IF.                                                      03280001
032900                                                                  03290001
033000***************************************************************** 03300001
033100* 1400-PROCESS-CONTROL-CARD                                       03310001
033200* READ DATE CONTROL CARD FOR FISCAL MONTH-END DATE.               03320001
033300* CALL DATE ROUTINE TO GET MAX FISCAL PERIOD.                     03330001
033400***************************************************************** 03340001
033500 1400-PROCESS-CONTROL-CARD.                                       03350001
033600                                                                  03360001
033700     PERFORM 1410-READ-DATE-CARD-FILE.                            03370001
033800                                                                  03380001
033900     IF PS-END-OF-CARD-FILE                                       03390001
034000         MOVE '1400-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   03400001
034100         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  03410001
034200         SET AC-CONTROL-CARD-ERROR TO TRUE                        03420001
034300         PERFORM 9999-ABEND                                       03430001
034400     END-IF.                                                      03440001
034500                                                                  03450001
034600     PERFORM 9975-DATE-ROUTINE.                                   03460001
034700                                                                  03470001
034800     MOVE CC-CONTROL-DATE-CC       TO RP1-DATE-CC.                03480001
034900     MOVE CC-CONTROL-DATE-YY       TO RP1-DATE-YY.                03490001
035000     MOVE CC-CONTROL-DATE-MM       TO RP1-DATE-MM.                03500001
035100     MOVE CC-CONTROL-DATE-DD       TO RP1-DATE-DD.                03510001
035200                                                                  03520001
035300     DISPLAY 'AUKRP001 CONTROL CARD DATE: '                       03530001
035400                          CC-CONTROL-CARD.                        03540001
035500                                                                  03550001
035600******************************************************************03560001
035700* 1410-READ-DATE-CARD-FILE                                        03570001
035800******************************************************************03580001
035900 1410-READ-DATE-CARD-FILE.                                        03590001
036000                                                                  03600001
036100     READ DATE-CARD-FILE INTO CC-CONTROL-CARD                     03610001
036200       AT END                                                     03620001
036300           SET PS-END-OF-CARD-FILE TO TRUE.                       03630001
036400                                                                  03640001
036500******************************************************************03650001
036600* 2000-PROCESS-REPORT-FILE                                       *03660001
036700******************************************************************03670001
036800 2000-PROCESS-REPORT-FILE.                                        03680001
036900                                                                  03690001
037000     IF AU013-SLS-DTE = PV-TRANSACTION-DATE                       03700003
037100         CONTINUE                                                 03710001
037200     ELSE                                                         03720001
037300         MOVE AU013-SLS-DTE          TO PV-TRANSACTION-DATE       03730003
037400         ADD +1                      TO PV-SUB                    03740001
037500         IF PV-SUB > PV-MAX-SUB                                   03750001
037600             MOVE '2000-PROCESS-REPORT-FILE' TO PV-PARAGRAPH-NAME 03760001
037700             MOVE 'DATE TABLE OVER LIMIT' TO PV-OPERATION-MSG-1   03770001
037800             SET AC-TABLE-OVERFLOW TO TRUE                        03780001
037900             PERFORM 9999-ABEND                                   03790001
038000         END-IF                                                   03800001
038100     END-IF.                                                      03810001
038200                                                                  03820001
038300     EVALUATE TRUE                                                03830001
038400         WHEN AU013-POSTING                                       03840003
038500              PERFORM 2200-PROCESS-RECONCILED-DATA                03850001
038600         WHEN AU013-MISSING-KOHLS                                 03860003
038700              PERFORM 2400-PROCESS-MISSING-GC-DATA                03870001
038800         WHEN AU013-MISSING-BLACKHAWK                             03880003
038900              PERFORM 2600-PROCESS-MISSING-BLACKHAWK              03890001
039000         WHEN AU013-MULTIPLE-RECON                                03900003
039100              PERFORM 2800-MULTI-RECON                            03910003
039200         WHEN OTHER                                               03920001
039300              PERFORM 9999-ABEND                                  03930001
039400     END-EVALUATE.                                                03940001
039500                                                                  03950001
039600     PERFORM 7000-READ-REPORT-FILE.                               03960001
039700                                                                  03970001
039800******************************************************************03980001
039900* 2200-PROCESS-RECONCILED-DATA                                   *03990001
040000******************************************************************04000001
040100 2200-PROCESS-RECONCILED-DATA.                                    04010001
040200                                                                  04020001
040300     PERFORM 4000-MOVE-REPORT-DATA.                               04030001
040400                                                                  04040001
040500     ADD +1                       TO PA-RECONCILED-NBR(PV-SUB).   04050003
040600     ADD AU013-TRANSACTION-AMT    TO PA-RECONCILED-AMT(PV-SUB).   04060003
040700     MOVE AU013-SLS-DTE           TO PA-DATE(PV-SUB).             04070003
040800     MOVE SPACES                  TO RP1-DETAIL-COMMENT.          04080001
040900                                                                  04090001
041000     IF PV-LINE-COUNT > PC-LINES-PER-PAGE                         04100001
041100         PERFORM 5000-RECONCILED-REPORT-HEADER                    04110004
041200     END-IF.                                                      04120001
041300                                                                  04130001
041400     WRITE RECONCILED-RECORD FROM RP1-DETAIL-LINE AFTER           04140004
041500            ADVANCING 1 LINE                                      04150001
041600     ADD +1 TO PV-LINE-COUNT.                                     04160001
041700                                                                  04170001
041800******************************************************************04180001
041900* 2400-PROCESS-MISSING-GC-DATA                                   *04190001
042000******************************************************************04200001
042100 2400-PROCESS-MISSING-GC-DATA.                                    04210001
042200                                                                  04220001
042300     PERFORM 4000-MOVE-REPORT-DATA.                               04230001
042400     MOVE 'MISSING KOHLS TRANSACTION' TO RP1-DETAIL-COMMENT.      04240001
042500                                                                  04250001
042600     ADD +1                       TO PA-MISSING-GC-NBR(PV-SUB).   04260003
042700     ADD AU013-TRANSACTION-AMT    TO PA-MISSING-GC-AMT(PV-SUB).   04270003
042800     MOVE AU013-SLS-DTE           TO PA-DATE(PV-SUB).             04280003
042900                                                                  04290001
043000     IF PV-LINE-COUNT1 > PC-LINES-PER-PAGE                        04300001
043100         PERFORM 6000-AUDIT-REPORT-HEADER                         04310003
043200     END-IF.                                                      04320001
043300                                                                  04330001
043400     WRITE AUDIT-RECORD FROM RP1-DETAIL-LINE AFTER                04340003
043500            ADVANCING 1 LINE                                      04350001
043600     ADD +1 TO PV-LINE-COUNT1.                                    04360001
043700                                                                  04370001
043800******************************************************************04380001
043900* 2600-PROCESS-MISSING-BLACKHAWK                                 *04390001
044000******************************************************************04400001
044100 2600-PROCESS-MISSING-BLACKHAWK.                                  04410001
044200                                                                  04420001
044300     PERFORM 4000-MOVE-REPORT-DATA.                               04430001
044400     MOVE 'MISSING BLACKHAWK TRANSACTION' TO RP1-DETAIL-COMMENT.  04440001
044500                                                                  04450001
044600     ADD +1                   TO PA-MISSING-BLACKHAWK-NBR(PV-SUB).04460003
044700     ADD AU013-TRANSACTION-AMT                                    04470003
044800                              TO PA-MISSING-BLACKHAWK-AMT(PV-SUB).04480003
044900     MOVE AU013-SLS-DTE TO PA-DATE(PV-SUB).                       04490003
045000                                                                  04500001
045100     IF PV-LINE-COUNT1 > PC-LINES-PER-PAGE                        04510001
045200         PERFORM 6000-AUDIT-REPORT-HEADER                         04520003
045300     END-IF.                                                      04530001
045400                                                                  04540001
045500     WRITE AUDIT-RECORD FROM RP1-DETAIL-LINE AFTER                04550003
045600            ADVANCING 1 LINE                                      04560001
045700     ADD +1 TO PV-LINE-COUNT1.                                    04570001
045800                                                                  04580001
045900******************************************************************04590001
046000* 2800-MULTI-RECON                                               *04600003
046100******************************************************************04610001
046200 2800-MULTI-RECON.                                                04620003
046300                                                                  04630001
046400     PERFORM 4000-MOVE-REPORT-DATA.                               04640003
046500     MOVE AU013-PREV-RECON-DTE TO PV-PRIOR-RECON-DATE.            04650003
046600     MOVE PV-MULTI-LITERAL     TO RP1-DETAIL-COMMENT.             04660003
046700                                                                  04670003
046800     ADD +1                   TO PA-MULTI-RECON-NBR(PV-SUB).      04680003
046900     ADD AU013-TRANSACTION-AMT                                    04690003
047000                              TO PA-MULTI-RECON-AMT(PV-SUB).      04700003
047100     MOVE AU013-SLS-DTE TO PA-DATE(PV-SUB).                       04710003
047200                                                                  04720003
047300     IF PV-LINE-COUNT1 > PC-LINES-PER-PAGE                        04730003
047400         PERFORM 6000-AUDIT-REPORT-HEADER                         04740003
047500     END-IF.                                                      04750003
047600                                                                  04760003
047700     WRITE AUDIT-RECORD FROM RP1-DETAIL-LINE AFTER                04770003
047800            ADVANCING 1 LINE                                      04780003
047900     ADD +1 TO PV-LINE-COUNT1.                                    04790003
048000                                                                  04800003
048100******************************************************************04810001
048200* 4000-MOVE-REPORT-DATA                                          *04820001
048300******************************************************************04830001
048400 4000-MOVE-REPORT-DATA.                                           04840001
048500                                                                  04850001
048600     MOVE AU013-SLS-DTE            TO RP1-TRANS-DATE.             04860003
048700     MOVE AU013-GIFT-CARD-NBR      TO RP1-CARD-ID.                04870003
048800     MOVE AU013-UPC                TO RP1-UPC.                    04880003
048900     MOVE AU013-TRANSACTION-AMT    TO RP1-TRANS-AMT.              04890003
049000     MOVE AU013-STR-NBR            TO RP1-STORE.                  04900003
049100     MOVE AU013-RGST-ID            TO RP1-REGISTER.               04910003
049200     MOVE AU013-TRN-NBR            TO RP1-TRN-NBR.                04920003
049300     MOVE AU013-PARTNER            TO RP1-PARTNER.                04930003
049400                                                                  04940001
049500******************************************************************04950001
049600* 5000-RECONCILED-REPORT-HEADER                                  *04960004
049700******************************************************************04970001
049800 5000-RECONCILED-REPORT-HEADER.                                   04980004
049900                                                                  04990001
050000     MOVE 4             TO PV-LINE-COUNT.                         05000001
050100     ADD  1             TO PV-PAGE-COUNT.                         05010001
050200     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     05020001
050300     MOVE 1             TO DP132-REPORT-NUMBER.                   05030001
050400     MOVE SPACES        TO RP1-COMMENT-LINE.                      05040001
050500     MOVE 'BLACKHAWK SETTLEMENT REPORT FOR' TO RP1-SUBTITLE.      05050001
050600                                                                  05060001
050700     WRITE RECONCILED-RECORD                                      05070004
050800       FROM DP132-STANDRD-HEADER-132-COLS                         05080001
050900         AFTER ADVANCING PAGE.                                    05090001
051000                                                                  05100001
051100     WRITE RECONCILED-RECORD                                      05110004
051200         FROM RP1-HEADING-LINE-2                                  05120001
051300         AFTER ADVANCING 1 LINE.                                  05130001
051400                                                                  05140001
051500     WRITE RECONCILED-RECORD                                      05150004
051600         FROM RP1-HEADING-LINE-4                                  05160001
051700         AFTER ADVANCING 1 LINE.                                  05170001
051800                                                                  05180001
051900******************************************************************05190001
052000* 6000-WRITE-AUDIT-REPORT-HEADER                                 *05200003
052100******************************************************************05210001
052200 6000-AUDIT-REPORT-HEADER.                                        05220003
052300                                                                  05230001
052400     MOVE 4               TO PV-LINE-COUNT1.                      05240001
052500     ADD  1               TO PV-PAGE-COUNT1.                      05250001
052600     MOVE PV-PAGE-COUNT1  TO DP132-PAGE-NUMBER.                   05260001
052700     MOVE 2               TO DP132-REPORT-NUMBER.                 05270001
052800     MOVE 'ERROR MESSAGE' TO RP1-COMMENT-LINE.                    05280001
052900     MOVE SPACES          TO RP1-SUBTITLE.                        05290001
053000     MOVE 'BLACKHAWK AUDIT REPORT FOR' TO RP1-SUBNAME.            05300001
053100                                                                  05310001
053200     WRITE AUDIT-RECORD                                           05320003
053300       FROM DP132-STANDRD-HEADER-132-COLS                         05330001
053400         AFTER ADVANCING PAGE.                                    05340001
053500                                                                  05350001
053600     WRITE AUDIT-RECORD                                           05360003
053700         FROM RP1-HEADING-LINE-2                                  05370001
053800         AFTER ADVANCING 1 LINE.                                  05380001
053900                                                                  05390001
054000     WRITE AUDIT-RECORD                                           05400003
054100         FROM RP1-HEADING-LINE-4                                  05410001
054200         AFTER ADVANCING 1 LINE.                                  05420001
054300                                                                  05430001
054400******************************************************************05440001
054500* 7000-READ-REPORT-FILE                                          *05450001
054600*    READ THE INPUT FILE AND SET THE END OF FILE SWITCH WHEN     *05460001
054700*    THERE IS NO MORE RECORDS TO READ.                           *05470001
054800******************************************************************05480001
054900 7000-READ-REPORT-FILE.                                           05490001
055000                                                                  05500001
055100     READ REPORT-FILE-IN INTO AU013-DETAIL-TRANS                  05510003
055200         AT END                                                   05520001
055300             SET PS-END-OF-REPORT-FILE TO TRUE.                   05530001
055400                                                                  05540001
055500******************************************************************05550001
055600* 8000-WRITE-TOTAL-LINE                                          *05560001
055700******************************************************************05570001
055800 8000-WRITE-TOTAL-LINE.                                           05580001
055900                                                                  05590001
056000     MOVE PV-SUB TO PV-MAX-ARRAY.                                 05600001
056100     ADD +4      TO PV-LINE-COUNT                                 05610001
056200                    PV-LINE-COUNT1.                               05620001
056300                                                                  05630001
056400     IF PV-LINE-COUNT > PC-LINES-PER-PAGE                         05640001
056500         PERFORM 5000-RECONCILED-REPORT-HEADER                    05650004
056600     END-IF.                                                      05660001
056700                                                                  05670001
056800     WRITE RECONCILED-RECORD FROM RPT-TOTAL-LINE-1                05680004
056900           AFTER ADVANCING 2 LINES                                05690001
057000                                                                  05700001
057100     WRITE RECONCILED-RECORD FROM RPT-TOTAL-LINE-2                05710004
057200           AFTER ADVANCING 1 LINE                                 05720001
057300                                                                  05730001
057400     IF PV-LINE-COUNT1 > PC-LINES-PER-PAGE                        05740001
057500         PERFORM 6000-AUDIT-REPORT-HEADER                         05750003
057600     END-IF.                                                      05760001
057700                                                                  05770001
057800     WRITE AUDIT-RECORD FROM RPT-TOTAL-LINE-1                     05780003
057900           AFTER ADVANCING 2 LINES                                05790001
058000                                                                  05800001
058100     WRITE AUDIT-RECORD FROM RPT-TOTAL-LINE-2                     05810003
058200           AFTER ADVANCING 1 LINE                                 05820001
058300                                                                  05830001
058400     PERFORM 8100-UNLOAD-TOTAL-DATA                               05840001
058500     VARYING PV-SUB FROM 1 BY 1                                   05850001
058600       UNTIL PV-SUB > PV-MAX-ARRAY.                               05860001
058700                                                                  05870001
058800     WRITE RECONCILED-RECORD FROM END-OF-REPORT-LINE              05880004
058900           AFTER ADVANCING 2 LINES.                               05890001
059000                                                                  05900001
059100     WRITE AUDIT-RECORD FROM END-OF-REPORT-LINE                   05910003
059200           AFTER ADVANCING 2 LINES.                               05920001
059300                                                                  05930001
059400******************************************************************05940001
059500* 8100-UNLOAD-TOTAL-DATA                                         *05950001
059600******************************************************************05960001
059700 8100-UNLOAD-TOTAL-DATA.                                          05970001
059800                                                                  05980001
059900     MOVE PA-DATE(PV-SUB)                 TO TOTAL-DATE.          05990004
060000     MOVE PA-RECONCILED-NBR(PV-SUB)       TO TOTAL-RECONCILED-NBR.06000004
060100     MOVE PA-RECONCILED-AMT(PV-SUB)       TO TOTAL-RECONCILED-AMT.06010004
060200     MOVE PA-MISSING-GC-NBR(PV-SUB)       TO TOTAL-GC-NBR.        06020004
060300     MOVE PA-MISSING-GC-AMT(PV-SUB)       TO TOTAL-GC-AMT.        06030004
060400     MOVE PA-MISSING-BLACKHAWK-NBR(PV-SUB) TO TOTAL-BLACKHAWK-NBR.06040003
060500     MOVE PA-MISSING-BLACKHAWK-AMT(PV-SUB) TO TOTAL-BLACKHAWK-AMT.06050003
060600     MOVE PA-MULTI-RECON-NBR(PV-SUB)     TO TOTAL-MULTI-RECON-NBR.06060004
060700     MOVE PA-MULTI-RECON-AMT(PV-SUB)     TO TOTAL-MULTI-RECON-AMT.06070004
060800                                                                  06080001
060900     IF PV-LINE-COUNT > PC-LINES-PER-PAGE                         06090001
061000         PERFORM 5000-RECONCILED-REPORT-HEADER                    06100004
061100         WRITE RECONCILED-RECORD FROM RPT-TOTAL-LINE-1            06110004
061200           AFTER ADVANCING 2 LINES                                06120001
061300                                                                  06130001
061400         WRITE RECONCILED-RECORD FROM RPT-TOTAL-LINE-2            06140004
061500           AFTER ADVANCING 1 LINE                                 06150001
061600     END-IF.                                                      06160001
061700                                                                  06170001
061800     WRITE RECONCILED-RECORD FROM RPT-TOTAL-DETAIL-LINE           06180004
061900           AFTER ADVANCING 1 LINE.                                06190001
062000     ADD +1 TO PV-LINE-COUNT.                                     06200001
062100                                                                  06210001
062200     IF PV-LINE-COUNT1 > PC-LINES-PER-PAGE                        06220001
062300         PERFORM 6000-AUDIT-REPORT-HEADER                         06230003
062400         WRITE AUDIT-RECORD FROM RPT-TOTAL-LINE-1                 06240003
062500           AFTER ADVANCING 2 LINES                                06250001
062600                                                                  06260001
062700         WRITE AUDIT-RECORD FROM RPT-TOTAL-LINE-2                 06270003
062800           AFTER ADVANCING 1 LINE                                 06280001
062900     END-IF.                                                      06290001
063000                                                                  06300001
063100     WRITE AUDIT-RECORD FROM RPT-TOTAL-DETAIL-LINE                06310003
063200           AFTER ADVANCING 1 LINE.                                06320001
063300                                                                  06330001
063400     ADD +1 TO PV-LINE-COUNT1.                                    06340001
063500                                                                  06350001
063600******************************************************************06360001
063700* 9000-EOJ-ROUTINE.                                              *06370001
063800******************************************************************06380001
063900 9000-EOJ-ROUTINE.                                                06390001
064000                                                                  06400001
064100     CLOSE DATE-CARD-FILE                                         06410001
064200           REPORT-FILE-IN                                         06420001
064300           RECONCILED-REPORT                                      06430004
064400           AUDIT-REPORT.                                          06440003
064500                                                                  06450001
064600******************************************************************06460001
064700*     9975-DATE-ROUTINE.                                         *06470001
064800* ==> PROCESSES:                                                 *06480001
064900*     -VALIDATES THE DATE INPUT ON THE CONTROL FILE              *06490001
065000* ==> PERFORMED FROM: B100-INITIALIZE                            *06500001
065100******************************************************************06510001
065200 9975-DATE-ROUTINE.                                               06520001
065300                                                                  06530001
065400     INITIALIZE DPG51 DPG52 DPG53                                 06540001
065500                DPG54 DPG55 DPG56.                                06550001
065600                                                                  06560001
065700     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     06570001
065800                                                                  06580001
065900     MOVE CC-DATE-CCYY-MM-DD        TO DPG52-LK-DATE-INPUT.       06590001
066000     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      06600001
066100                                                                  06610001
066200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            06620001
066300       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 06630001
066400                                                                  06640001
066500     EVALUATE TRUE                                                06650001
066600         WHEN DPG54-SEVERE-ERROR                                  06660001
066700         WHEN DPG54-DATE-INVALID                                  06670001
066800             SET AC-DATE-ERROR TO TRUE                            06680001
066900             PERFORM 9999-ABEND                                   06690001
067000     END-EVALUATE.                                                06700001
067100******************************************************************06710001
067200* 9999-ABEND - PERFORMS A NON-SQL-ABEND                           06720001
067300******************************************************************06730001
067400 9999-ABEND.                                                      06740001
067500     DISPLAY '** ABEND           **'.                             06750001
067600     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          06760001
067700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        06770001
067800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       06780001
067900     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         06790001
