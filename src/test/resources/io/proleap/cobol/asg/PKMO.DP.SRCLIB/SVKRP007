000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SVKRP007.                                00050000
000600 AUTHOR.                 DAVE COLOMBO - COMPUWARE.                00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            JANUARY 2000.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200* * * *>>>   THIS PROGRAM MUST BE COMPILED COBOL/390   <<<* * * * 00120000
001300***************************************************************** 00130000
001400*                                                                 00140000
001500*  THIS PROGRAM WILL CREATE MONTHLY STORED VALUE CARD AGING       00150000
001600*  REPORTS FROM AN INPUT FILE CONTAINING CARD ACTIVITY.           00160000
001700*                                                                 00170000
001800*  THE INPUT ACTIVITY FILE (INP01) CONTAINS CARD ACTIVITY DATA,   00180000
001900*  IN THE FORM OF ISSUE RECORDS AND TENDER RECORDS.  AN ISSUE     00190000
002000*  RECORD HOLDS ISSUE DATA SUCH AS ISSUE DATE AND ISSUE AMOUNT.   00200000
002100*  TENDER RECORDS HOLD TENDER DATA SUCH AS DATES TENDERED, AND    00210000
002200*  TENDERED AMOUNTS.  EACH CARD HAS ONE OR MORE ISSUE RECORDS,    00220000
002300*  AND ZERO OR MANY TENDER RECORDS, DEPENDING ON HOW MANY TIMES   00230000
002400*  THE CARD WAS TENDERED.                                         00240000
002500*                                                                 00250000
002600*  THIS CARD ACTIVITY IS ACCUMULATED BY FISCAL PERIOD IN          00260000
002700*  WORKING STORAGE TABLES AND THEN PRINTED ON 2 OUTPUT REPORTS.   00270000
002800*  - SVKRP007-1  AGING REPORT IN DOLLARS (RPT01).                 00280000
002900*  - SVKRP007-2  AGING REPORT IN COUNTS  (RPT02).                 00290000
003000*                                                                 00300000
003100*  BOTH REPORTS ARE COMPOSED OF TWO PARTS:                        00310000
003200*  - PART 1: AGING REPORT BY CARD STOCK TYPE                      00320000
003300*  - PART 2: AGING REPORT FOR ALL CARDS                           00330000
003400*                                                                 00340000
003500*  THE INPUT CARD DATE FILE (INP02) CONTAINS A FISCAL MONTH END   00350000
003600*  DATE, WHICH WILL BE USED TO DETERMINE THE LAST FISCAL PERIOD   00360000
003700*  TO BE USED FOR THE REPORTS.                                    00370000
003800*                                                                 00380000
003900*  WHILE PROCESSING A CARD, THE TENDERED AMOUNTS ARE SUBTRACTED   00390000
004000*  FROM THE ISSUE AMOUNT.  IF A CARD IS FOUND TO HAVE A BALANCE   00400000
004100*  REMAINING, (DETERMINED BY SUBTRACTING TENDERED AMOUNTS FROM    00410000
004200*  THE ISSUE AMOUNT), A RECORD FOR THE CARD IS WRITTEN TO THE     00420000
004300*  OUTPUT BALANCE FILE (OUT01).                                   00430000
004400*                                                                 00440000
004500***************************************************************** 00450000
004600***************************************************************** 00460000
004700****  DESCRIPTION OF THE USE OF TABLES TO PRODUCE REPORTS  ****** 00470000
004800***************************************************************** 00480000
004900***************************************************************** 00490000
005000*  THESE TABLES ACCUMULATE INPUT DATA FOR BOTH REPORTS:           00500000
005100*   - TB1-PART-1-TABLE (TABLE 1) HOLDS PART 1 DATA.               00510000
005200*   - TB2-PART-2-TABLE (TABLE 2) HOLDS PART 2 DATA.               00520000
005300*                                                                 00530000
005400*  EACH TABLE ENTRY IS A FISCAL PERIOD DETAIL LINE ON A REPORT:   00540000
005500*   - "DLR" ENTRIES GET PRINTED ON THE SVKRP007-1 "DOLLAR" REPORT.00550000
005600*   - "CNT" ENTRIES GET PRINTED ON THE SVKRP007-2 "COUNT" REPORT. 00560000
005700*                                                                 00570000
005800*  THE INPUT RECORDS ARE ORDERED TO PRODUCE PART 1.               00580000
005900******************************************************************00590000
006000*  AT START OF PROGRAM:                                           00600000
006100*                                                                 00610000
006200*  1. TABLE 2 IS INITIALIZED TO HAVE ENTRIES FOR ALL FISCAL       00620000
006300*     PERIODS USED IN THE REPORTS.                                00630000
006400*  2. THE FIRST INPUT RECORD IS READ.                             00640000
006500*  3. EACH TABLE 2 ENTRY IS READ, COMPARING THE INPUT RECORD ISSUE00650000
006600*     DATE TO THE FIRST AND LAST FISCAL PERIOD DATES IN THE       00660000
006700*     TABLE 2 ENTRY, UNTIL THE FISCAL PERIOD IN WHICH THE CARD WAS00670000
006800*     ISSUED IS FOUND. WHEN FOUND, THIS FISCAL PERIOD IS MOVED TO 00680000
006900*     THE FIRST ENTRY IN TABLE 1, MAKING IT THE CURRENT PERIOD.   00690000
007000******************************************************************00700000
007100*  AS THE INPUT FILE IS READ:                                     00710000
007200*                                                                 00720000
007300*  TABLES 1 & 2 ARE USED TO ACCUMULATE DATA FROM INPUT RECORDS.   00730000
007400*  PART 1 OF BOTH REPORTS IS PRINTED UNTIL THE END OF FILE.       00740000
007500*                                                                 00750000
007600*  I. WHEN AN INPUT RECORD IS READ:                               00760000
007700*     A. DOLLAR VALUES (DLR) AND CARD COUNTS (CNT) ARE ACCUMULATED00770000
007800*        IN TABLE 1 FOR CARDS OF THE CURRENT CARD STOCK TYPE,     00780000
007900*        ISSUED WITHIN THE CURRENT FISCAL PERIOD.                 00790000
008000*     B. DOLLAR VALUES (DLR) AND CARD COUNTS (CNT) ARE ACCUMULATED00800000
008100*        IN TABLE 2 FOR ALL THE CARD STOCK TYPES, ISSUED WITHIN   00810000
008200*        THE CURRENT FISCAL PERIOD.                               00820000
008300*                                                                 00830000
008400*  II. WHEN A CONTROL BREAK ON THE FISCAL PERIOD IN WHICH THE CARD00840000
008500*      WAS ISSUED OCCURS:                                         00850000
008600*     A. THE DOLLAR VALUES OF THE CURRENT FISCAL PERIOD ENTRY IN  00860000
008700*        TABLE 1 ARE PRINTED AS A DOLLAR DETAIL LINE ON REPORT 1. 00870000
008800*     B. THE DOLLAR VALUES OF THE CURRENT FISCAL PERIOD ENTRY IN  00880000
008900*        TABLE 1 ARE ACCUMULATED IN "DLR" TOTAL FIELDS.           00890000
009000*     C. THE INDEX FOR TABLE 1 IS INCREMENTED BY 1.               00900000
009100*     D. (SAME AS I.A ABOVE).                                     00910000
009200*     E. THE TABLE 1 INDEX IS INCREMENTED TO THE NEXT ENTRY AND   00920000
009300*        TABLE 2 INDEX IS INCREMENTED TO THE NEXT ENTRY.          00930000
009400*        THE INPUT RECORD ISSUE DATE IS COMPARED TO THE FIRST AND 00940000
009500*        LAST FISCAL PERIOD DATES IN THE TABLE 2 ENTRY.  THIS     00950000
009600*        PROCESS CONTINUES UNTIL THE FISCAL PERIOD IN WHICH THE   00960000
009700*        THE CARD WAS ISSUED IS FOUND.  WHEN FOUND, THIS FISCAL   00970000
009800*        PERIOD IS MOVED TO THE CURRENT TABLE 1 ENTRY, MAKING IT  00980000
009900*        THE CURRENT PERIOD.  DURING THIS PROCESS, THE KEYS OF    00990000
010000*        THE UNMATCHED TABLE 2 ENTRY GET MOVED TO THE TABLE 1     01000000
010100*        ENTRY, KEEPING THE TWO TABLES IN SYNC (AND PREVENTING    01010000
010200*        GAPS BETWEEN DATES WHEN PRINTING PART 1 ON A REPORT).    01020000
010300*     F. (SAME AS I.B ABOVE).                                     01030000
010400*                                                                 01040000
010500*  III. WHEN A CONTROL BREAK ON CARD STOCK TYPE OCCURS:           01050000
010600*     A. THE ACCUMULATED "DLR" TOTAL FIELDS ARE PRINTED           01060000
010700*        ON REPORT 1 FOR THE PREVIOUS CARD STOCK TYPE.            01070000
010800*     B. THE TABLE 1 CARD COUNTS ARE UNLOADED FOR EACH FISCAL     01080000
010900*        PERIOD AND PRINTED AS COUNT DETAIL LINES ON REPORT 2,    01090000
011000*        UNTIL ALL CARD COUNT TABLE ENTRIES ARE UNLOADED. AS THEY 01100000
011100*        ARE UNLOADED, EACH COUNT IS ACCUMULATED IN A "CNT" TOTAL 01110000
011200*        FIELD, AND EACH TABLE 1 ENTRY IS ZEROED OUT.             01120000
011300*     C. THE ACCUMULATED "CNT" TOTAL FIELDS ARE PRINTED ON        01130000
011400*        REPORT 2                                                 01140000
011500*     D. A PAGE BREAK ON REPORT 1 OCCURS, TO PRINT HEADINGS       01150000
011600*        FOR THE CURRENT CARD STOCK TYPE.                         01160000
011700*     E. (SAME AS II.A - II.F ABOVE).                             01170000
011800*                                                                 01180000
011900*  IV. WHEN REPORT 1 IS COMPLETED (END OF INPUT FILE):            01190000
012000*     A. (SAME AS III.A - III. C ABOVE).                          01200000
012100*     B. THE TABLE 2 DOLLAR VALUES ARE UNLOADED FOR EACH FISCAL   01210000
012200*        PERIOD AND PRINTED AS DOLLAR DETAIL LINES ON REPORT 1,   01220000
012300*        UNTIL ALL DOLLAR VALUE TABLE ENTRIES ARE UNLOADED.  AS   01230000
012400*        THEY ARE UNLOADED, EACH DOLLAR VALUE IS ACCUMULATED IN   01240000
012500*        "DLR" TOTALS FIELDS.                                     01250000
012600*     C. THE ACCUMULATED "DLR" TOTALS ARE PRINTED ON REPORT 1     01260000
012700*     D. THE TABLE 2 CARD COUNTS ARE UNLOADED FOR EACH FISCAL     01270000
012800*        PERIOD AND PRINTED AS COUNT DETAIL LINES ON REPORT 2,    01280000
012900*        UNTIL ALL CARD COUNT TABLE ENTRIES ARE UNLOADED.  AS     01290000
013000*        THEY ARE UNLOADED, EACH COUNT IS ACCUMULATED IN A        01300000
013100*        "CNT" TOTAL FIELD.                                       01310000
013200*     E. THE ACCUMULATED "CNT" TOTAL FIELDS ARE PRINTED ON        01320000
013300*        REPORT 2.                                                01330000
013400******************************************************************01340000
013500* MODIFICATIONS:                                                  01350000
013600******************************************************************01360000
013700* 08/13/10  TY HOPP                                               01370000
013800*   COMMENT OUT CALL TO 2660-PROCESS-SERVICE-FEES TO AVOID TAKING 01380000
013900*   SERVICE FEES ON CARDS. PER JAMES MORTONSON AND ANDREA DEMLER  01390000
014000*   FEES SHOULD NEVER BE TAKEN ON GIFT CARDS.                     01400000
014100*   CHANGES MARKED TDH001.                                        01410000
014200* 02/01/11  TY HOPP                                               01420000
014300*   TRUNCATION ISSUE, CHANGED LENGTH OF '-,---,--9.99' TO         01430000
014400*   '--,---,--9.99' IN ORDER TO CAPTURE MILLIONS PLACE.           01440000
014500*   CHANGES MARKED TDH2.                                          01450000
014600* 09/19/12  TY HOPP                                               01460000
014700*   MOVE LOCATION OF 2650-PARA TO CORRECT UNREDEMMED              01470000
014800*   CHANGES MARKED TDH3.                                          01480000
C50050* 08/29/16  COGNIZANT                                             01490000
C50050*   MODIFIED  THE TABLE LIMIT VALUE FROM 240 TO 300 IN ORDER      01500000
C50050*   AVOID ABENDS.                                                 01510000
C60667* 08/30/21  COGNIZANT                                             01511003
C60667*   MODIFIED  THE TABLE LIMIT VALUE FROM 300 TO 900 IN ORDER      01512003
C60667*   AVOID ABENDS.                                                 01513003
014900******************************************************************01520000
015000 ENVIRONMENT DIVISION.                                            01530000
015100***************************************************************** 01540000
015200                                                                  01550000
015300 CONFIGURATION SECTION.                                           01560000
015400                                                                  01570000
015500 SOURCE-COMPUTER.        IBM-3090.                                01580000
015600 OBJECT-COMPUTER.        IBM-3090.                                01590000
015700                                                                  01600000
015800 INPUT-OUTPUT SECTION.                                            01610000
015900                                                                  01620000
016000 FILE-CONTROL.                                                    01630000
016100                                                                  01640000
016200     SELECT ACTIVITY-FILE                                         01650000
016300         ASSIGN TO INP01.                                         01660000
016400                                                                  01670000
016500     SELECT DATE-CARD-FILE                                        01680000
016600         ASSIGN TO INP02.                                         01690000
016700                                                                  01700000
017000                                                                  01710000
017300                                                                  01720000
017400     SELECT BALANCE-FILE                                          01730000
017500         ASSIGN TO OUT01.                                         01740000
017600                                                                  01750000
017900                                                                  01760000
018200                                                                  01770000
018300     SELECT DOLLAR-REPORT-FILE                                    01780000
018400         ASSIGN TO RPT01.                                         01790000
018500                                                                  01800000
018600     SELECT COUNT-REPORT-FILE                                     01810000
018700         ASSIGN TO RPT02.                                         01820000
018800                                                                  01830000
019100                                                                  01840000
019200******************************************************************01850000
019300 DATA DIVISION.                                                   01860000
019400******************************************************************01870000
019500                                                                  01880000
019600 FILE SECTION.                                                    01890000
019700                                                                  01900000
019800 FD  ACTIVITY-FILE                                                01910000
019900     RECORDING MODE IS F                                          01920000
020000     LABEL RECORDS ARE STANDARD                                   01930000
020100     BLOCK CONTAINS 0 RECORDS.                                    01940000
020200                                                                  01950000
020300 01  ACTIVITY-RECORD                 PIC  X(125).                 01960000
020400                                                                  01970000
020500 FD  DATE-CARD-FILE                                               01980000
020600     RECORDING MODE IS F                                          01990000
020700     BLOCK CONTAINS 0 RECORDS                                     02000000
020800     LABEL RECORDS ARE STANDARD.                                  02010000
020900                                                                  02020000
021000 01  DATE-CARD-RECORD                PIC X(80).                   02030000
021100                                                                  02040000
021600                                                                  02050000
021800                                                                  02060000
022300                                                                  02070000
022500                                                                  02080000
022600 FD  BALANCE-FILE                                                 02090000
022700     RECORDING MODE IS F                                          02100000
022800     LABEL RECORDS ARE STANDARD                                   02110000
022900     BLOCK CONTAINS 0 RECORDS.                                    02120000
023000                                                                  02130000
023100 01  BALANCE-RECORD                  PIC  X(80).                  02140000
023200                                                                  02150000
023700                                                                  02160000
023900                                                                  02170000
024400                                                                  02180000
024600                                                                  02190000
024700 FD  DOLLAR-REPORT-FILE                                           02200000
024800     RECORDING MODE IS F                                          02210000
024900     BLOCK CONTAINS 0  RECORDS.                                   02220000
025000                                                                  02230000
025100 01  DOLLAR-REPORT-RECORD            PIC  X(200).                 02240000
025200                                                                  02250000
025300 FD  COUNT-REPORT-FILE                                            02260000
025400     RECORDING MODE IS F                                          02270000
025500     BLOCK CONTAINS 0  RECORDS.                                   02280000
025600                                                                  02290000
025700 01  COUNT-REPORT-RECORD             PIC  X(200).                 02300000
025800                                                                  02310000
026200                                                                  02320000
026400                                                                  02330000
026500******************************************************************02340000
026600 WORKING-STORAGE SECTION.                                         02350000
026700******************************************************************02360000
026800 01  FILLER                            PIC X(50)  VALUE           02370000
026900     ' *** WORKING STORAGE STARTS HERE FOR SVKRP007 *** '.        02380000
027000                                                                  02390000
027100******************************************************************02400000
027200* RECORD LAYOUT FOR INPUT ACTIVITY FILE                           02410000
027300******************************************************************02420000
027400     COPY SVRD036.                                                02430000
      ******************************************************************02440000
028400* RECORD LAYOUT FOR INPUT ACTIVITY FILE                           02450000
028500******************************************************************02460000
028600     COPY SVRD036 REPLACING 'SV036-' BY 'SV36SV-'.                02470000
028700******************************************************************02480000
028800* RECORD LAYOUT FOR INPUT DATE CARD (FISCAL MONTH-END DATE)       02490000
028900******************************************************************02500000
029000  01  CC-CONTROL-CARD.                                            02510000
029100      05  CC-REPORT-TYPE               PIC X(01)  VALUE SPACE.    02520000
029200      05  CC-MONTH-END-CCYY-MM-DD      PIC X(10)  VALUE SPACES.   02530000
029300      05  FILLER                       PIC X(69)  VALUE SPACES.   02540000
029400******************************************************************02550000
029500* RECORD LAYOUT FOR BREAKAGE CONTROL CARD                         02560000
029600******************************************************************02570000
029700  01  CC-BREAKAGE-CONTROL.                                        02580000
029800      05  BC-GIFT-PCT                  PIC V9(04) VALUE ZERO.     02590000
029900      05  BC-KCK-PCT                   PIC V9(04) VALUE ZERO.     02600000
030000      05  BC-KMRC-PCT                  PIC V9(04) VALUE ZERO.     02610000
030100      05  FILLER                       PIC X(68)  VALUE SPACES.   02620000
030700******************************************************************02630000
030800* RECORD LAYOUT FOR OUTPUT BALANCE FILE                           02640000
030900******************************************************************02650000
031000     COPY SVRD003.                                                02660000
031100                                                                  02670000
031200******************************************************************02680000
031300*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             02690000
031400******************************************************************02700000
031500     COPY DPWS500.                                                02710000
031600                                                                  02720000
031700 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      02730000
031800                                                  COMP.           02740000
031900     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    02750000
032000     88  AC-TABLE-OVERFLOW-ERROR                  VALUE +4004.    02760000
032100     88  AC-DATASET-DATA-ERROR                    VALUE +4008.    02770000
032200     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    02780000
032300                                                                  02790000
032400 01  PS-PROGRAM-SWITCHES.                                         02800000
032500     05  PS-END-OF-ACTVY-FILE-SW       PIC X(01)  VALUE 'N'.      02810000
032600         88  PS-END-OF-ACTVY-FILE                 VALUE 'Y'.      02820000
032700     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      02830000
032800         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      02840000
033300     05  PS-DATE-IS-CARD-INPUT-SW      PIC X(01)  VALUE 'Y'.      02850000
033400         88  PS-DATE-IS-CARD-INPUT                VALUE 'Y'.      02860000
033500         88  PS-DATE-IS-NOT-CARD-INPUT            VALUE 'N'.      02870000
033900     05  PS-TABLE-2-DATE-FOUND-SW      PIC X(01)  VALUE 'N'.      02880000
034000         88  PS-TABLE-2-DATE-FOUND                VALUE 'Y'.      02890000
034100         88  PS-TABLE-2-DATE-NOT-FOUND            VALUE 'N'.      02900000
034500     05  PS-DATA-LOADED-SW             PIC X(01)  VALUE 'N'.      02910000
034600         88  PS-DATA-LOADED                       VALUE 'Y'.      02920000
034700         88  PS-DATA-NOT-LOADED                   VALUE 'N'.      02930000
034800     05  PS-FEE-COUNTED-SW             PIC X(01)  VALUE 'N'.      02940000
034900         88  PS-FEE-COUNTED                       VALUE 'Y'.      02950000
035000         88  PS-FEE-NOT-COUNTED                   VALUE 'N'.      02960000
035100     05  PS-FEE-SW                     PIC X(01)  VALUE 'N'.      02970000
035200         88  PS-FEE                               VALUE 'Y'.      02980000
035300         88  PS-DO-NOT-FEE                        VALUE 'N'.      02990000
035700     05  PS-STATE-SW                   PIC X(01)  VALUE 'N'.      03000000
035800         88  PS-STATE-FOUND                       VALUE 'Y'.      03010000
035900         88  PS-STATE-NOT-FOUND                   VALUE 'N'.      03020000
036000     05  PS-FEE-STATE-SW               PIC X(01)  VALUE 'N'.      03030000
036100         88  PS-FEE-STATE-FOUND                   VALUE 'Y'.      03040000
036200         88  PS-FEE-STATE-NOT-FOUND               VALUE 'N'.      03050000
036300                                                                  03060000
036400 01  PC-CONSTANTS.                                                03070000
036500     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +73.     03080000
C60667     05  PC-TABLE-LIMIT              PIC S9(04)    VALUE +900.    03090003
036700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          03100000
036800                                                   'SVKRP007'.    03110000
036900     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       03120000
037000     05  PC-REPORT-NBR-2             PIC  9(01)    VALUE 2.       03130000
037200     05  PC-ALL-CARDS-DESC           PIC  X(09)    VALUE          03140000
037300         'ALL CARDS'.                                             03150000
037400     05  PC-GIFT-CARDS-DESC          PIC  X(36)    VALUE          03160000
037500         'ALL GIFT CARDS EXCEPT KCK'.                             03170000
037600     05  PC-KCK-CARDS-DESC           PIC  X(36)    VALUE          03180000
037700         'KCK      - KOHLS CARES FOR KIDS'.                       03190000
037800     05  PC-KMRC-CARDS-DESC          PIC  X(36)    VALUE          03200000
037900         'KMRC     - MERCHANDISE RETURN CREDIT'.                  03210000
038000     05  PC-H2-DESC-DOLLARS          PIC  X(07)    VALUE          03220000
038100         'DOLLARS'.                                               03230000
038200     05  PC-H2-DESC-COUNTS           PIC  X(07)    VALUE          03240000
038300         'COUNTS '.                                               03250000
038400     05  PC-H4-DESC-1-DOLLARS        PIC  X(07)    VALUE          03260000
038500         'DOLLARS'.                                               03270000
038600     05  PC-H4-DESC-2-DOLLARS        PIC  X(08)    VALUE          03280000
038700         ' DOLLARS'.                                              03290000
038800     05  PC-H4-DESC-3-DOLLARS        PIC  X(07)    VALUE          03300000
038900         'DOLLARS'.                                               03310000
039000     05  PC-H4-DESC-1-COUNTS         PIC  X(07)    VALUE          03320000
039100         ' NUMBER'.                                               03330000
039200     05  PC-H4-DESC-2-COUNTS         PIC  X(08)    VALUE          03340000
039300         '- NUMBER'.                                              03350000
039400     05  PC-H4-DESC-3-COUNTS         PIC  X(07)    VALUE          03360000
039500         'NUMBER '.                                               03370000
039600                                                                  03380000
039700 01  PV-MISC-COUNT-FIELDS.                                        03390000
039800     05  PV-SVKRP007-1-PAGE-CNT      PIC S9(04)    VALUE ZERO     03400000
039900                                                   COMP-3.        03410000
040000     05  PV-SVKRP007-1-LINE-CNT      PIC S9(04)    VALUE ZERO     03420000
040100                                                   COMP.          03430000
040200     05  PV-SVKRP007-2-PAGE-CNT      PIC S9(04)    VALUE ZERO     03440000
040300                                                   COMP-3.        03450000
040400     05  PV-SVKRP007-2-LINE-CNT      PIC S9(04)    VALUE ZERO     03460000
040500                                                   COMP.          03470000
041100******************************************************************03480000
041200*  FIELDS TO FOR SYSOUT DISPLAY.                                  03490000
041300******************************************************************03500000
041400 01  PV-DISPLAY-FIELDS.                                           03510000
041500     05  PV-DISPLAY-ISSUE-REC-CNT    PIC S9(11)    COMP-3         03520000
041600                                                   VALUE ZERO.    03530000
041700     05  PV-DISPLAY-TENDER-REC-CNT   PIC S9(11)    COMP-3         03540000
041800                                                   VALUE ZERO.    03550000
041900     05  PV-DISPLAY-SRV-FEE-REC-CNT  PIC S9(11)    COMP-3         03560000
042000                                                   VALUE ZERO.    03570000
042100     05  PV-DISPLAY-ACTIVITY-REC-CNT PIC S9(11)    COMP-3         03580000
042200                                                   VALUE ZERO.    03590000
042300     05  PV-DISPLAY-BALANCE-REC-CNT  PIC S9(11)    COMP-3         03600000
042400                                                   VALUE ZERO.    03610000
042700     05  PV-DISPLAY-NEG-BAL-REC-CNT  PIC S9(11)    COMP-3         03620000
042800                                                   VALUE ZERO.    03630000
042900     05  PV-DISPLAY-COUNT            PIC 99999999999              03640000
043000                                                   VALUE ZERO.    03650000
043100******************************************************************03660000
043200*  FIELDS TO HOLD TOTALS FOR PRINTING A REPORT TOTAL LINE.        03670000
043300******************************************************************03680000
043400 01  PV-TOT-ACCUM-FIELDS.                                         03690000
043500     05  PV-TOT-DLR-ISSUED           PIC S9(11)V99 COMP-3         03700000
043600                                                   VALUE ZERO.    03710000
043900     05  PV-TOT-DLR-PRIOR            PIC S9(11)V99 COMP-3         03720000
044000                                                   VALUE ZERO.    03730000
044100     05  PV-TOT-DLR-REV-PRIOR        PIC S9(11)V99 COMP-3         03740000
044200                                                   VALUE ZERO.    03750000
044300     05  PV-TOT-DLR-REV              PIC S9(11)V99 COMP-3         03760000
044400                                                   VALUE ZERO.    03770000
044500     05  PV-TOT-DLR-URDMD-AV         PIC S9(11)V99 COMP-3         03780000
044600                                                   VALUE ZERO.    03790000
044700     05  PV-TOT-DLR-URDMD-HQ         PIC S9(07)V99 COMP-3         03800000
044800                                                   VALUE ZERO.    03810000
044900     05  PV-TOT-DLR-URDMD-IN         PIC S9(07)V99 COMP-3         03820000
045000                                                   VALUE ZERO.    03830000
045100     05  PV-TOT-DLR-URDMD-OTR        PIC S9(07)V99 COMP-3         03840000
045200                                                   VALUE ZERO.    03850000
045300     05  PV-TOT-CNT-ISSUED           PIC S9(11)    COMP-3         03860000
045400                                                   VALUE ZERO.    03870000
045500     05  PV-TOT-CNT-PRIOR            PIC S9(11)    COMP-3         03880000
045600                                                   VALUE ZERO.    03890000
045700     05  PV-TOT-CNT-REV-PRIOR        PIC S9(11)    COMP-3         03900000
045800                                                   VALUE ZERO.    03910000
045900     05  PV-TOT-CNT-URDMD-AV         PIC S9(11)    COMP-3         03920000
046000                                                   VALUE ZERO.    03930000
046100     05  PV-TOT-CNT-URDMD-HQ         PIC S9(07)    COMP-3         03940000
046200                                                   VALUE ZERO.    03950000
046300     05  PV-TOT-CNT-URDMD-IN         PIC S9(07)    COMP-3         03960000
046400                                                   VALUE ZERO.    03970000
046500     05  PV-TOT-CNT-URDMD-OTR        PIC S9(07)    COMP-3         03980000
046600                                                   VALUE ZERO.    03990000
046700     05  PV-TOT-BREAKAGE-PRIOR       PIC S9(11)V99 COMP-3         04000000
046800                                                   VALUE ZERO.    04010000
047100     05  PV-TOT-ACCUM-REVENUE        PIC S9(11)V99 COMP-3         04020000
047200                                                   VALUE ZERO.    04030000
047300     05  PV-TOT-MO-DATA              OCCURS  6 TIMES              04040000
047400                                     INDEXED BY PV-TOT-IDX.       04050000
047500         10  PV-TOT-DLR-MO-QTY       PIC S9(09)V99 COMP-3         04060000
047600                                                   VALUE ZERO.    04070000
047700         10  PV-TOT-DLR-REV-MO-QTY   PIC S9(09)V99 COMP-3         04080000
047800                                                   VALUE ZERO.    04090000
047900         10  PV-TOT-CNT-MO-QTY       PIC S9(09)    COMP-3         04100000
048000                                                   VALUE ZERO.    04110000
048100         10  PV-TOT-CNT-REV-MO-QTY   PIC S9(09)    COMP-3         04120000
048200                                                   VALUE ZERO.    04130000
048500                                                                  04140000
048600 01  PV-GC-ACCUM-FIELDS.                                          04150000
048700                                                                  04160000
048800     05  PV-GC-DLR-ISSUED            PIC S9(11)V99 COMP-3         04170000
048900                                                  VALUE ZERO.     04180000
049000     05  PV-GC-DLR-PRIOR             PIC S9(11)V99 COMP-3         04190000
049100                                                  VALUE ZERO.     04200000
049200     05  PV-GC-DLR-REV-PRIOR         PIC S9(11)V99 COMP-3         04210000
049300                                                  VALUE ZERO.     04220000
049400     05  PV-GC-DLR-REV               PIC S9(11)V99 COMP-3         04230000
049500                                                  VALUE ZERO.     04240000
049600     05  PV-GC-DLR-URDMD-AV          PIC S9(11)V99 COMP-3         04250000
049700                                                  VALUE ZERO.     04260000
049800     05  PV-GC-DLR-URDMD-HQ          PIC S9(07)V99 COMP-3         04270000
049900                                                  VALUE ZERO.     04280000
050000     05  PV-GC-DLR-URDMD-IN          PIC S9(07)V99 COMP-3         04290000
050100                                                  VALUE ZERO.     04300000
050200     05  PV-GC-DLR-URDMD-OTR         PIC S9(07)V99 COMP-3         04310000
050300                                                  VALUE ZERO.     04320000
050400     05  PV-GC-CNT-ISSUED            PIC S9(11)    COMP-3         04330000
050500                                                  VALUE ZERO.     04340000
050600     05  PV-GC-CNT-PRIOR             PIC S9(11)    COMP-3         04350000
050700                                                  VALUE ZERO.     04360000
050800     05  PV-GC-CNT-REV-PRIOR         PIC S9(11)    COMP-3         04370000
050900                                                  VALUE ZERO.     04380000
051000     05  PV-GC-CNT-URDMD-AV          PIC S9(11)    COMP-3         04390000
051100                                                  VALUE ZERO.     04400000
051200     05  PV-GC-CNT-URDMD-HQ          PIC S9(07)    COMP-3         04410000
051300                                                  VALUE ZERO.     04420000
051400     05  PV-GC-CNT-URDMD-IN          PIC S9(07)    COMP-3         04430000
051500                                                  VALUE ZERO.     04440000
051600     05  PV-GC-CNT-URDMD-OTR         PIC S9(07)    COMP-3         04450000
051700                                                   VALUE ZERO.    04460000
051800     05  PV-GC-MO-DATA               OCCURS  6 TIMES              04470000
051900                                     INDEXED BY PV-GC-IDX.        04480000
052000         10  PV-GC-DLR-MO-QTY        PIC S9(09)V99 COMP-3         04490000
052100                                                  VALUE ZERO.     04500000
052200         10  PV-GC-DLR-REV-MO-QTY    PIC S9(09)V99 COMP-3         04510000
052300                                                  VALUE ZERO.     04520000
052400         10  PV-GC-CNT-MO-QTY        PIC S9(09)    COMP-3         04530000
052500                                                  VALUE ZERO.     04540000
052600         10  PV-GC-CNT-REV-MO-QTY    PIC S9(09)    COMP-3         04550000
052700                                                   VALUE ZERO.    04560000
052800                                                                  04570000
052900******************************************************************04580000
053000*  FIELDS TO HOLD TOTALS FOR ECOMM AUTHORIZED TOTAL LINE.        *04590000
053100******************************************************************04600000
053200 01  PV-EA-TOT-ACCUM-FIELDS.                                      04610000
053300     05  PV-EA-TOT-DLR-ISSUED        PIC S9(11)V99 COMP-3         04620000
053400                                                   VALUE ZERO.    04630000
053500     05  PV-EA-TOT-DLR-PRIOR         PIC S9(11)V99 COMP-3         04640000
053600                                                   VALUE ZERO.    04650000
053700     05  PV-EA-TOT-MO-DATA           OCCURS  6 TIMES              04660000
053800                                     INDEXED BY PV-EA-TOT-IDX.    04670000
053900         10  PV-EA-TOT-DLR-MO        PIC S9(09)V99 COMP-3         04680000
054000                                                   VALUE ZERO.    04690000
054100                                                                  04700000
054200******************************************************************04710000
054300*  FIELDS TO HOLD TOTALS FOR ECOMM AUTH TOTAL LINE WITHOUT KCK   *04720000
054400******************************************************************04730000
054500 01  PV-EAK-TOT-ACCUM-FIELDS.                                     04740000
054600     05  PV-EAK-TOT-DLR-ISSUED        PIC S9(11)V99 COMP-3        04750000
054700                                                   VALUE ZERO.    04760000
054800     05  PV-EAK-TOT-DLR-PRIOR         PIC S9(11)V99 COMP-3        04770000
054900                                                   VALUE ZERO.    04780000
055000     05  PV-EAK-TOT-MO-DATA           OCCURS  6 TIMES             04790000
055100                                     INDEXED BY PV-EAK-TOT-IDX.   04800000
055200         10  PV-EAK-TOT-DLR-MO        PIC S9(09)V99 COMP-3        04810000
055300                                                   VALUE ZERO.    04820000
055400                                                                  04830000
055500******************************************************************04840000
055600*  FIELDS TO HOLD TOTALS FOR ECOMM ALL CARDS AUTH. TOTAL LINE.   *04850000
055700******************************************************************04860000
055800 01  PV-AC-TOT-ACCUM-FIELDS.                                      04870000
055900     05  PV-AC-TOT-DLR-ISSUED        PIC S9(11)V99 COMP-3         04880000
056000                                                   VALUE ZERO.    04890000
056100     05  PV-AC-TOT-DLR-PRIOR         PIC S9(11)V99 COMP-3         04900000
056200                                                   VALUE ZERO.    04910000
056300     05  PV-AC-TOT-MO-DATA           OCCURS  6 TIMES              04920000
056400                                     INDEXED BY PV-AC-TOT-IDX.    04930000
056500         10  PV-AC-TOT-DLR-MO        PIC S9(09)V99 COMP-3         04940000
056600                                                   VALUE ZERO.    04950000
056700                                                                  04960000
056800******************************************************************04970000
056900*  FIELDS TO HOLD GRAND TOTAL FOR ALL CARDS.                     *04980000
057000******************************************************************04990000
057100 01  PV-GT-TOT-ACCUM-FIELDS.                                      05000000
057200     05  PV-GT-TOT-DLR-ISSUED        PIC S9(11)V99 COMP-3         05010000
057300                                                   VALUE ZERO.    05020000
057400     05  PV-GT-TOT-DLR-PRIOR         PIC S9(11)V99 COMP-3         05030000
057500                                                   VALUE ZERO.    05040000
057600     05  PV-GT-TOT-MO-DATA           OCCURS  6 TIMES              05050000
057700                                     INDEXED BY PV-GT-TOT-IDX.    05060000
057800         10  PV-GT-TOT-DLR-MO        PIC S9(09)V99 COMP-3         05070000
057900                                                   VALUE ZERO.    05080000
058000                                                                  05090000
058100******************************************************************05100000
058200*  FIELDS USED FOR CALCULATIONS OF PERCENTS SHIFTING DECIMALS.    05110000
058300******************************************************************05120000
058400 01  PV-CALC-WORK-FIELDS.                                         05130000
058500     05  PV-PERCENT-SHIFTED          PIC S9(03)V99 VALUE ZERO     05140000
058600                                                   COMP-3.        05150000
058700     05  PV-GC-PERCENT-SHIFTED       PIC S9(03)V99 VALUE ZERO     05160000
058800                                                   COMP-3.        05170000
058900     05  PV-PERCENT-DECIMAL          PIC S9V9(4)   VALUE ZERO     05180000
059000                                                   COMP-3.        05190000
059300     05  PV-PARTIAL-DLR              PIC S9(11)V99 VALUE ZERO     05200000
059400                                                   COMP-3.        05210000
059500     05  PV-GT-PARTIAL-DLR           PIC S9(11)V99 VALUE ZERO     05220000
059600                                                   COMP-3.        05230000
059900     05  PV-TOTAL-DLR                PIC S9(11)V99 VALUE ZERO     05240000
060000                                                   COMP-3.        05250000
060300     05  PV-PARTIAL-CNT              PIC S9(11)    VALUE ZERO     05260000
060400                                                   COMP-3.        05270000
060700     05  PV-TOTAL-CNT                PIC S9(11)    VALUE ZERO     05280000
060800                                                   COMP-3.        05290000
061100     05  PV-FEE-PERIODS              PIC S9(04)    VALUE ZERO.    05300000
061200     05  PV-SAVE-FEE-MN-QTY          PIC S9(04)    VALUE ZERO     05310000
061300                                                   COMP-3.        05320000
061400     05  PV-SRV-FEE-INACTIVE-PRD     PIC  X(10)    VALUE SPACE.   05330000
061600     05  PV-DLR-NET-REV              PIC S9(11)V99 VALUE ZERO.    05340000
064400******************************************************************05350000
064500*  FIELDS USED TO DETERMINE CONTROL BREAKS.                       05360000
064600******************************************************************05370000
064700 01  PV-SAVE-FIELDS.                                              05380000
064800     05  PV-SAVE-CRD-NBR             PIC S9(12)    COMP-3         05390000
064900                                                   VALUE ZERO.    05400000
065000     05  PV-SAVE-ISSUE-DATE          PIC X(10)     VALUE SPACE.   05410000
065100     05  PV-SAVE-ISSUE-TMSTMP        PIC X(26)     VALUE SPACE.   05420000
065200     05  PV-SAVE-FST-DATE            PIC X(10)     VALUE SPACE.   05430000
065300     05  PV-SAVE-LST-DATE            PIC X(10)     VALUE SPACE.   05440000
065400     05  PV-SAVE-PER-ABBR            PIC X(03)     VALUE SPACE.   05450000
065500     05  PV-SAVE-ISSUE-CCYYPP        PIC 9(06)     VALUE ZERO.    05460000
065600     05  PV-SAVE-CRD-STK-TYP         PIC X(08)     VALUE SPACE.   05470000
065700     05  PV-SAVE-CRD-STK-DESC        PIC X(25)     VALUE SPACE.   05480000
065800     05  PV-SAVE-CRD-VALUE           PIC S9(07)V99 COMP-3         05490000
065900                                                   VALUE ZERO.    05500000
066000     05  PV-SAVE-STAT-CDE            PIC X(02)     VALUE SPACE.   05510000
066100     05  PV-SAVE-LST-ACTVY-DTE       PIC X(10)     VALUE SPACE.   05520000
066200     05  PV-SAVE-CRD-LST-ACTVY-DTE   PIC X(10)     VALUE SPACE.   05530000
066300     05  PV-SAVE-CRD-TYP-CDE         PIC S9(01)    VALUE ZERO.    05540000
066400     05  PV-SAVE-ISSUE-STR-NBR       PIC S9(04)    VALUE ZERO     05550000
066500                                                   COMP.          05560000
066600     05  PV-SAVE-ISSUE-ST-CDE        PIC  X(02)    VALUE SPACE.   05570000
066700     05  PV-SUB                      PIC 9(03)     VALUE ZERO.    05580000
066800     05  PV-MAX-STATE                PIC S9(03)     VALUE +120.   05590000
066900     05  PV-SAVE-ST-CDE              PIC X(02)     VALUE SPACE.   05600000
067000     05  PV-SAVE-FEE-ST-CDE          PIC X(02)     VALUE SPACE.   05610000
067100     05  PV-HOLD-FEE-MN-QTY          PIC S9(04)    VALUE ZERO     05620000
067200                                                   COMP-3.        05630000
067300     05  PV-HOLD-ST-CDE              PIC  X(02)    VALUE SPACE.   05640000
067400                                                                  05650000
067500 01  PV-MISC-FIELDS.                                              05660000
067600     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACE.   05670000
067700     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     05680000
067800                                                   COMP.          05690000
067900     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   05700000
068000     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   05710000
068100     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   05720000
068200     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACE.   05730000
068300     05  PV-FIRST-STOCK-ENTRY        PIC S9(04)    VALUE +300     05740000
068400                                                   COMP.          05750000
068500     05  PV-LAST-STOCK-ENTRY         PIC S9(04)    VALUE ZERO     05760000
068600                                                   COMP.          05770000
068700     05  PV-FIRST-GC-ENTRY           PIC S9(04)    VALUE +300     05780000
068800                                                   COMP.          05790000
068900     05  PV-LAST-GC-ENTRY            PIC S9(04)    VALUE ZERO     05800000
069000                                                   COMP.          05810000
069100     05  PV-TB2-IDX                  PIC S9(04)    VALUE ZERO     05820000
069200                                                   COMP.          05830000
069300     05  PV-BREAKAGE-START-SUB       PIC S9(04)    VALUE ZERO     05840000
069400                                                   COMP.          05850000
069500     05  PV-BREAKAGE-SUB             PIC S9(04)    VALUE ZERO     05860000
069600                                                   COMP.          05870000
069700                                                                  05880000
069800 01  PV-DATE-AND-TIME-FIELDS.                                     05890000
069900*****  MAXIMUM FISCAL PERIOD USED IN REPORTS.                     05900000
070000     05  PV-MAX-CCYYPP               PIC 9(06)     VALUE ZERO.    05910000
070100     05  FILLER REDEFINES PV-MAX-CCYYPP.                          05920000
070200         10  PV-MAX-CCYY             PIC 9(04).                   05930000
070300         10  PV-MAX-PP               PIC 9(02).                   05940000
070400     05  PV-FEE-CUTOFF-DATE          PIC X(10)     VALUE SPACE.   05950000
070500*****  REUSEABLE DATE WORK FIELD IN CCYY-MM-DD FORMAT.            05960000
070600     05  PV-WORK-CCYY-MM-DD          PIC X(10)     VALUE SPACE.   05970000
070700     05  PV-WORK-CCYYPP-1            PIC X(06)     VALUE SPACE.   05980000
070800     05  PV-WORK-CCYYPP-2            PIC X(06)     VALUE SPACE.   05990000
070900     05  PV-FEE-DATE                 PIC X(10)     VALUE SPACE.   06000000
071000     05  PV-FEE-CCYYPP               PIC 9(06)     VALUE ZERO.    06010000
071100*****  FIELDS TO RECEIVE DATES FROM THE CALENDAR ROUTINE.         06020000
071200     05  PV-FISCAL-PER-FST-DATE      PIC X(10)     VALUE SPACE.   06030000
071300     05  PV-FISCAL-PER-LST-DATE      PIC X(10)     VALUE SPACE.   06040000
071400     05  PV-FISCAL-YEAR-CCYY         PIC 9(04)     VALUE ZERO.    06050000
071500     05  PV-FISCAL-PER-NBR           PIC 9(02)     VALUE ZERO.    06060000
071600     05  PV-MONTH-NAME               PIC X(09)     VALUE SPACE.   06070000
071700     05  PV-MONTH-ABBR               PIC X(03)     VALUE SPACE.   06080000
071800     05  PV-FISCAL-PER-DIFF          PIC S9(04)    VALUE ZERO.    06090000
071900*****  FIELDS FOR REPORT HEADINGS.                                06100000
072000     05  PV-CURR-DATE-CCYYMMDD.                                   06110000
072100         10  PV-CURR-DATE-CCYY       PIC  9(04).                  06120000
072200         10  PV-CURR-DATE-MM         PIC  9(02).                  06130000
072300         10  PV-CURR-DATE-DD         PIC  9(02).                  06140000
072400     05  PV-CURR-TIME.                                            06150000
072500         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    06160000
072600         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    06170000
072700         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    06180000
072800                                                                  06190000
072900******************************************************************06200000
073000*  TOP OF PAGE HEADING LINE FOR PRINTING A 200 CHARACTER REPORT.  06210000
073100******************************************************************06220000
073200     COPY DPWS200.                                                06230000
073300                                                                  06240000
073400******************************************************************06250000
073500*  HEADING LINES FOR ALL  STORED VALUE AGING REPORTS.             06260000
073600******************************************************************06270000
073700 01  H2-HEADING-LINE-2.                                           06280000
073800     05  FILLER                      PIC  X(76)    VALUE SPACE.   06290000
073900     05  FILLER                      PIC  X(28)    VALUE          06300000
074000        'STORED VALUE FEE REPORT FOR '.                           06310000
074100     05  H2-MONTH                    PIC  X(09)    VALUE SPACE.   06320000
074200     05  FILLER                      PIC  X(01)    VALUE SPACE.   06330000
074300     05  H2-YEAR                     PIC  X(04)    VALUE SPACE.   06340000
074400     05  FILLER                      PIC  X(03)    VALUE ' - '.   06350000
074500     05  H2-RPT-DESC                 PIC  X(07)    VALUE SPACE.   06360000
074600     05  FILLER                      PIC  X(72)    VALUE SPACE.   06370000
074700                                                                  06380000
074800 01  H2-HEADING-LINE-2B.                                          06390000
074900     05  FILLER                      PIC  X(76)    VALUE SPACE.   06400000
075000     05  FILLER                      PIC  X(33)    VALUE          06410000
075100        'STORED VALUE BREAKAGE REPORT FOR '.                      06420000
075200     05  H2B-MONTH                   PIC  X(09)    VALUE SPACE.   06430000
075300     05  FILLER                      PIC  X(01)    VALUE SPACE.   06440000
075400     05  H2B-YEAR                    PIC  X(04)    VALUE SPACE.   06450000
075500     05  FILLER                      PIC  X(77)    VALUE SPACE.   06460000
075600                                                                  06470000
075700 01  H3-HEADING-LINE-3.                                           06480000
075800     05  FILLER                      PIC  X(18)    VALUE          06490000
075900        'CARD STOCK TYPE:  '.                                     06500000
076000     05  H3-CRD-STK-DESC             PIC  X(36)    VALUE SPACE.   06510000
076100     05  FILLER                      PIC  X(146)   VALUE SPACE.   06520000
076200                                                                  06530000
076300 01  H4-HEADING-LINE-4.                                           06540000
076400     05  FILLER                      PIC  X(16)    VALUE          06550000
076500        'MONTH/YR        '.                                       06560000
076600     05  H4-RPT-DESC-1               PIC  X(07)    VALUE SPACE.   06570000
076700     05  FILLER                      PIC  X(06)    VALUE SPACE.   06580000
076800     05  FILLER                      PIC  X(43)    VALUE ALL '-'. 06590000
076900     05  H4-RPT-DESC-2               PIC  X(08)    VALUE SPACE.   06600000
077000     05  FILLER                      PIC  X(10)    VALUE          06610000
077100        ' TENDERED '.                                             06620000
077200     05  FILLER                      PIC  X(42)    VALUE ALL '-'. 06630000
077300     05  FILLER                      PIC  X(13)                   06640000
077400                                       VALUE '     CORP RCV'.     06650000
077500     05  FILLER                      PIC  X(08)    VALUE SPACE.   06660000
077600     05  FILLER                      PIC  X(05)                   06670000
077700                                       VALUE 'OTHER'.             06680000
077800     05  FILLER                      PIC  X(10)    VALUE SPACE.   06690000
077900     05  H4-RPT-DESC-3               PIC  X(07)    VALUE SPACE.   06700000
078000     05  FILLER                      PIC  X(05)    VALUE SPACE.   06710000
078100     05  FILLER                      PIC  X(09)                   06720000
078200                                       VALUE ' INACTIVE'.         06730000
?FIX01     05  FILLER                      PIC  X(11)    VALUE SPACE.   06740000
?FIX01*    05  FILLER                      PIC  X(04)    VALUE SPACE.   06750000
?FIX01*    05  FILLER                      PIC  X(07)                   06760000
?FIX01*                                      VALUE 'PCT/NET'.           06770000
078600                                                                  06780000
080700                                                                  06790000
080800 01  H5-HEADING-LINE-5.                                           06800000
080900     05  FILLER                      PIC  X(48)    VALUE          06810000
081000        ' ISSUED          ISSUED              PRIOR      '.       06820000
081100     05  H5-MO-DATA                  PIC  X(90)    VALUE SPACE.   06830000
081200     05  FILLER                      PIC  X(01)    VALUE SPACE.   06840000
081300     05  FILLER                      PIC  X(06)                   06850000
081400                                       VALUE 'UNRDMD'.            06860000
081500     05  FILLER                      PIC  X(07)    VALUE SPACE.   06870000
081600     05  FILLER                      PIC  X(06)                   06880000
081700                                       VALUE 'UNRDMD'.            06890000
081800     05  FILLER                      PIC  X(07)    VALUE SPACE.   06900000
081900     05  FILLER                      PIC  X(10)    VALUE          06910000
082000                                             'UNREDEEMED'.        06920000
082100     05  FILLER                      PIC  X(07)    VALUE SPACE.   06930000
082200     05  FILLER                      PIC  X(06)                   06940000
082300                                       VALUE 'UNRDMD'.            06950000
?FIX01     05  FILLER                      PIC  X(12)    VALUE SPACE.   06960000
?FIX01*    05  FILLER                      PIC  X(05)    VALUE SPACE.   06970000
?FIX01*    05  FILLER                      PIC  X(07)                   06980000
?FIX01*                                      VALUE 'UNRDMD '.           06990000
082700                                                                  07000000
082800 01  H5-HEADING-LINE-5B.                                          07010000
082900     05  FILLER                      PIC  X(24)    VALUE          07020000
083000        ' ISSUED          ISSUED'.                                07030000
083100     05  FILLER                      PIC  X(02)    VALUE SPACE.   07040000
083200     05  FILLER                      PIC  X(16)    VALUE          07050000
083300        'TO BE RECOGNIZED'.                                       07060000
083400     05  FILLER                      PIC  X(11)    VALUE SPACE.   07070000
083500     05  FILLER                      PIC  X(05)    VALUE          07080000
083600        'PRIOR'.                                                  07090000
083700     05  FILLER                      PIC  X(07)    VALUE SPACE.   07100000
083800     05  H5-MO-DATA-B                PIC  X(90)    VALUE SPACE.   07110000
083900     05  FILLER                      PIC  X(02)    VALUE SPACE.   07120000
084000     05  FILLER                      PIC  X(18)    VALUE          07130000
084100         'RECOGNIZED TO DATE'.                                    07140000
084200     05  FILLER                      PIC  X(09)    VALUE SPACE.   07150000
084300     05  FILLER                      PIC  X(14)    VALUE          07160000
084400         'TO DATE       '.                                        07170000
084500     05  FILLER                      PIC  X(02)    VALUE SPACE.   07180000
084600                                                                  07190000
084700******************************************************************07200000
084800*  DETAIL LINE FOR DOLLARS STORED VALUE AGING REPORT.             07210000
084900******************************************************************07220000
085000 01  DL1-DETAIL-LINE-1.                                           07230000
085100     05  DL1-MO-1                    PIC  X(03)    VALUE SPACE.   07240000
085200     05  FILLER                      PIC  X(01)    VALUE '-'.     07250000
085300     05  DL1-YR-1                    PIC  X(04)    VALUE SPACE.   07260000
085400     05  DL1-ISSUED-QTY-1            PIC  Z,ZZZ,ZZZ,ZZ9.99        07270000
085500                                                   VALUE ZERO.    07280000
085600     05  FILLER                      PIC  X(02)    VALUE SPACE.   07290000
085700     05  DL1-PRIOR-QTY-1             PIC  Z,ZZZ,ZZZ,ZZ9.99        07300000
085800                                                   VALUE ZERO.    07310000
085900     05  FILLER                      PIC  X(01)    VALUE SPACE.   07320000
086000     05  DL1-MO-DATA-1               PIC  X(90)    VALUE SPACE.   07330000
086100*TDH205  DL1-URDMD-HQ-QTY-1          PIC  -,---,--9.99            07340000
086200     05  DL1-URDMD-HQ-QTY-1          PIC  --,---,--9.99           07350000
086300                                                   VALUE ZERO.    07360000
086400     05  DL1-URDMD-OTR-QTY-1         PIC  --,---,--9.99           07370000
086500                                                   VALUE ZERO.    07380000
086600     05  DL2-NET-REV-QTY-2           PIC  --,---,---,--9.99       07390000
086700                                                   VALUE ZERO.    07400000
086800     05  DL1-URDMD-IN-QTY-1          PIC  --,---,--9.99           07410000
086900                                                   VALUE ZERO.    07420000
087000*TDH205  FILLER                      PIC  X(04)    VALUE SPACE.   07430000
087100     05  FILLER                      PIC  X(03)    VALUE SPACE.   07440000
?FIX01*    05  DL1-URDMD-PERCENT-1         PIC  ---9.99  VALUE ZERO.    07450000
?FIX01*    05  FILLER                      PIC  X(01)    VALUE '%'.     07460000
087400                                                                  07470000
087500******************************************************************07480000
087600*  DETAIL LINE FOR BREAKAGE.                                      07490000
087700******************************************************************07500000
090000******************************************************************07510000
090100*  DETAIL LINE FOR COUNTS STORED VALUE AGING REPORT.              07520000
090200******************************************************************07530000
090300 01  DL1B-DETAIL-LINE-1.                                          07540000
090400     05  DL1B-MO-1                   PIC  X(03)    VALUE SPACE.   07550000
090500     05  FILLER                      PIC  X(01)    VALUE '-'.     07560000
090600     05  DL1B-YR-1                   PIC  X(04)    VALUE SPACE.   07570000
090700     05  FILLER                      PIC  X(02)    VALUE SPACE.   07580000
090800     05  DL1B-ISSUED-QTY-1           PIC  ZZ,ZZZ,ZZZ,ZZ9          07590000
090900                                                   VALUE ZERO.    07600000
091000     05  FILLER                      PIC  X(04)    VALUE SPACE.   07610000
091100     05  DL1B-PRIOR-QTY-1            PIC  ZZ,ZZZ,ZZZ,ZZ9          07620000
091200                                                   VALUE ZERO.    07630000
091300     05  FILLER                      PIC  X(04)    VALUE SPACE.   07640000
091400     05  DL1B-MO-DATA-1              PIC  X(90)    VALUE SPACE.   07650000
091500     05  DL1B-URDMD-HQ-QTY-1         PIC  -,---,--9               07660000
091600                                                   VALUE ZERO.    07670000
091700     05  FILLER                      PIC  X(04)    VALUE SPACE.   07680000
091800     05  DL1B-URDMD-OTR-QTY-1        PIC  -,---,--9               07690000
091900                                                   VALUE ZERO.    07700000
092000     05  FILLER                      PIC  X(04)    VALUE SPACE.   07710000
092100     05  DL1B-URDMD-AV-QTY-1         PIC  --,---,---,--9          07720000
092200                                                   VALUE ZERO.    07730000
092300     05  FILLER                      PIC  X(02)    VALUE SPACE.   07740000
092400     05  DL1B-URDMD-IN-QTY-1         PIC  -,---,--9               07750000
092500                                                   VALUE ZERO.    07760000
092600     05  FILLER                      PIC  X(04)    VALUE SPACE.   07770000
?FIX01*    05  DL1B-URDMD-PERCENT-1        PIC  ---9.99  VALUE ZERO.    07780000
?FIX01*    05  FILLER                      PIC  X(01)    VALUE '%'.     07790000
?FIX01*    05  FILLER                      PIC  X(01)    VALUE SPACE.   07800000
093000                                                                  07810000
093100******************************************************************07820000
093200*  DETAIL LINE FOR REVENUE DOLLARS STORED VALUE AGING REPORT.     07830000
093300******************************************************************07840000
093400 01  DL2-DETAIL-LINE-2.                                           07850000
093500     05  FILLER                      PIC  X(09)    VALUE          07860000
093600        '  REVENUE'.                                              07870000
093700     05  FILLER                      PIC  X(17)    VALUE SPACE.   07880000
093800     05  DL2-REV-PRIOR-QTY-2         PIC  Z,ZZZ,ZZZ,ZZ9.99        07890000
093900                                                   VALUE ZERO.    07900000
094000     05  FILLER                      PIC  X(01)    VALUE SPACE.   07910000
094100     05  DL2-MO-DATA-2               PIC  X(90)    VALUE SPACE.   07920000
094200     05  FILLER                      PIC  X(26)    VALUE SPACE.   07930000
094300     05  DL2-REV-QTY-2               PIC  Z,ZZZ,ZZZ,ZZ9.99        07940000
094400                                                   VALUE ZERO.    07950000
094500     05  FILLER                      PIC  X(08)    VALUE SPACE.   07960000
094600     05  DL1-URDMD-AV-QTY-1          PIC  -,---,---,--9.99        07970000
094700                                                   VALUE ZERO.    07980000
094800     05  FILLER                      PIC  X(01)    VALUE SPACE.   07990000
094900                                                                  08000000
095000******************************************************************08010000
095100*  DETAIL LINE FOR REVENUE COUNTS STORED VALUE AGING REPORT.      08020000
095200******************************************************************08030000
095300 01  DL2B-DETAIL-LINE-2.                                          08040000
095400     05  FILLER                      PIC  X(09)    VALUE          08050000
095500        '  REVENUE'.                                              08060000
095600     05  FILLER                      PIC  X(19)    VALUE SPACE.   08070000
095700     05  DL2B-REV-PRIOR-QTY-2        PIC  ZZ,ZZZ,ZZZ,ZZ9          08080000
095800                                                   VALUE ZERO.    08090000
095900     05  FILLER                      PIC  X(04)    VALUE SPACE.   08100000
096000     05  DL2B-MO-DATA-2              PIC  X(90)    VALUE SPACE.   08110000
096100     05  FILLER                      PIC  X(64)    VALUE SPACE.   08120000
096200                                                                  08130000
096300******************************************************************08140000
096400*  TOTAL LINE FOR DOLLARS STORED VALUE AGING REPORT.              08150000
096500******************************************************************08160000
096600 01  TL1-TOTAL-LINE-1.                                            08170000
096700     05  TL1-TOT-DESC                PIC  X(07)    VALUE SPACE.   08180000
096800     05  TL1-ISSUED-QTY-1            PIC  ZZ,ZZZ,ZZZ,ZZ9.99       08190000
096900                                                   VALUE ZERO.    08200000
097000     05  TL1-EA-ISSUED-QTY-1 REDEFINES TL1-ISSUED-QTY-1.          08210000
097100         10  FILLER                  PIC  X(17).                  08220000
097200     05  FILLER                      PIC  X(01)    VALUE SPACE.   08230000
097300     05  TL1-PRIOR-QTY-1             PIC  ZZ,ZZZ,ZZZ,ZZ9.99       08240000
097400                                                   VALUE ZERO.    08250000
097500     05  FILLER                      PIC  X(01)    VALUE SPACE.   08260000
097600     05  TL1-MO-DATA-1               PIC  X(90)    VALUE SPACE.   08270000
097700*TDH205  TL1-URDMD-HQ-QTY-1          PIC  -,---,--9.99            08280000
097800     05  TL1-URDMD-HQ-QTY-1          PIC  --,---,--9.99           08290000
097900                                                   VALUE ZERO.    08300000
098000     05  TL1-EA-URDMD-HQ-QTY-1 REDEFINES TL1-URDMD-HQ-QTY-1.      08310000
098100         10 FILLER                   PIC X(13).                   08320000
098200     05  TL1-URDMD-OTR-QTY-1         PIC  --,---,--9.99           08330000
098300                                                   VALUE ZERO.    08340000
098400     05  TL1-EA-URDMD-OTR-QTY-1 REDEFINES TL1-URDMD-OTR-QTY-1.    08350000
098500         10 FILLER                   PIC X(13).                   08360000
098600     05  TL2-NET-REV-QTY-2           PIC  --,---,---,--9.99       08370000
098700                                                   VALUE ZERO.    08380000
098800     05  TL2-EA-NET-REV-QTY-2 REDEFINES TL2-NET-REV-QTY-2.        08390000
098900         10 FILLER                   PIC X(17).                   08400000
099000     05  TL1-URDMD-IN-QTY-1          PIC  --,---,--9.99           08410000
099100                                                   VALUE ZERO.    08420000
099200     05  TL1-EA-URDMD-IN-QTY-1 REDEFINES TL1-URDMD-IN-QTY-1.      08430000
099300         10 FILLER                   PIC X(13).                   08440000
099400*TDH205  FILLER                      PIC X(04)     VALUE SPACES.  08450000
099500     05  FILLER                      PIC X(03)     VALUE SPACES.  08460000
?FIX01*    05  TL1-URDMD-PERCENT-1         PIC  ---9.99  VALUE ZERO.    08470000
?FIX01*    05  TL1-EA-URDMD-PERCENT-1 REDEFINES TL1-URDMD-PERCENT-1.    08480000
?FIX01*        10 FILLER                   PIC  X(07).                  08490000
?FIX01*    05  TL1-PERCENT                 PIC  X(01)    VALUE '%'.     08500000
100000                                                                  08510000
100100******************************************************************08520000
100200*  TOTAL LINE FOR BREAKAGE.                                       08530000
100300******************************************************************08540000
102500                                                                  08550000
102600******************************************************************08560000
102700*  TOTAL LINE FOR COUNTS STORED VALUE AGING REPORT.               08570000
102800******************************************************************08580000
102900 01  TL1B-TOTAL-LINE-1.                                           08590000
103000     05  FILLER                      PIC  X(10)    VALUE          08600000
103100         'TOTALS    '.                                            08610000
103200     05  TL1B-ISSUED-QTY-1           PIC  ZZ,ZZZ,ZZZ,ZZ9          08620000
103300                                                   VALUE ZERO.    08630000
103400     05  FILLER                      PIC  X(04)    VALUE SPACE.   08640000
103500     05  TL1B-PRIOR-QTY-1            PIC  ZZ,ZZZ,ZZZ,ZZ9          08650000
103600                                                   VALUE ZERO.    08660000
103700     05  FILLER                      PIC  X(04)    VALUE SPACE.   08670000
103800     05  TL1B-MO-DATA-1              PIC  X(90)    VALUE SPACE.   08680000
103900     05  TL1B-URDMD-HQ-QTY-1         PIC  -,---,--9               08690000
104000                                                   VALUE ZERO.    08700000
104100     05  FILLER                      PIC  X(04)    VALUE SPACE.   08710000
104200     05  TL1B-URDMD-OTR-QTY-1        PIC  -,---,--9               08720000
104300                                                   VALUE ZERO.    08730000
104400     05  FILLER                      PIC  X(04)    VALUE SPACE.   08740000
104500     05  TL1B-URDMD-AV-QTY-1         PIC  --,---,---,--9          08750000
104600                                                   VALUE ZERO.    08760000
104700     05  FILLER                      PIC  X(02)    VALUE SPACE.   08770000
104800     05  TL1B-URDMD-IN-QTY-1         PIC  -,---,--9               08780000
104900                                                   VALUE ZERO.    08790000
105000     05  FILLER                      PIC  X(04)    VALUE SPACE.   08800000
?FIX01*    05  TL1B-URDMD-PERCENT-1        PIC  ---9.99  VALUE ZERO.    08810000
?FIX01*    05  FILLER                      PIC  X(02)    VALUE '% '.    08820000
105300                                                                  08830000
105400******************************************************************08840000
105500*  TOTAL LINE FOR REVENUE DOLLARS STORED VALUE AGING REPORT.      08850000
105600******************************************************************08860000
105700 01  TL2-TOTAL-LINE-2.                                            08870000
105800     05  FILLER                      PIC  X(09)    VALUE          08880000
105900        '  REVENUE'.                                              08890000
106000     05  FILLER                      PIC  X(17)    VALUE SPACE.   08900000
106100     05  TL2-REV-PRIOR-QTY-2         PIC  Z,ZZZ,ZZZ,ZZ9.99        08910000
106200                                                   VALUE ZERO.    08920000
106300     05  FILLER                      PIC  X(01)    VALUE SPACE.   08930000
106400     05  TL2-MO-DATA-2               PIC  X(90)    VALUE SPACE.   08940000
106500     05  FILLER                      PIC  X(26)    VALUE SPACE.   08950000
106600     05  TL2-REV-QTY-2               PIC  Z,ZZZ,ZZZ,ZZ9.99        08960000
106700                                                   VALUE ZERO.    08970000
106800     05  FILLER                      PIC  X(07)    VALUE SPACE.   08980000
106900     05  TL1-URDMD-AV-QTY-1          PIC  --,---,---,--9.99       08990000
107000                                                   VALUE ZERO.    09000000
107100     05  FILLER                      PIC  X(01)    VALUE SPACE.   09010000
107200                                                                  09020000
107300******************************************************************09030000
107400*  TOTAL LINE FOR REVENUE COUNTS STORED VALUE AGING REPORT.       09040000
107500******************************************************************09050000
107600 01  TL2B-TOTAL-LINE-2.                                           09060000
107700     05  FILLER                      PIC  X(09)    VALUE          09070000
107800        '  REVENUE'.                                              09080000
107900     05  FILLER                      PIC  X(19)    VALUE SPACE.   09090000
108000     05  TL2B-REV-PRIOR-QTY-2        PIC  ZZ,ZZZ,ZZZ,ZZ9          09100000
108100                                                   VALUE ZERO.    09110000
108200     05  FILLER                      PIC  X(04)    VALUE SPACE.   09120000
108300     05  TL2B-MO-DATA-2              PIC  X(90)    VALUE SPACE.   09130000
108400     05  FILLER                      PIC  X(64)    VALUE SPACE.   09140000
108500                                                                  09150000
108600******************************************************************09160000
108700*  TABLE TO PRINT 6 DOLLAR COLUMNS OF MONTH DATA ON A DETAIL/     09170000
108800*  TOTAL LINE.                                                    09180000
108900******************************************************************09190000
109000 01  PL-PRINT-LINE-TABLE.                                         09200000
109100     05  PL-PRINT-LINE-ENTRY         OCCURS  6 TIMES              09210000
109200                                     INDEXED BY PL-IDX.           09220000
109300         10  PL-MO-QTY               PIC  ZZZ,ZZZ,ZZ9.99          09230000
109400                                                   VALUE ZERO.    09240000
109500         10  FILLER                  PIC  X(01)    VALUE SPACE.   09250000
109600                                                                  09260000
109700******************************************************************09270000
109800*  TABLE TO PRINT 6 COUNT COLUMNS OF MONTH DATA ON A DETAIL/      09280000
109900*  TOTAL LINE.                                                    09290000
110000******************************************************************09300000
110100 01  PL2-PRINT-LINE-TABLE.                                        09310000
110200     05  PL2-PRINT-LINE-ENTRY        OCCURS  6 TIMES              09320000
110300                                     INDEXED BY PL2-IDX.          09330000
110400         10  PL2-MO-QTY              PIC  ZZZ,ZZZ,ZZ9             09340000
110500                                                   VALUE ZERO.    09350000
110600         10  FILLER                  PIC  X(04)    VALUE SPACE.   09360000
110700                                                                  09370000
110800******************************************************************09380000
110900*  TABLE TO PRINT 6 COLUMNS OF MONTH HEADINGS ON A HEADING LINE.  09390000
111000******************************************************************09400000
111100 01  HL-HEADING-LINE-TABLE.                                       09410000
111200     05  HL-HEADING-LINE-ENTRY       OCCURS 6 TIMES               09420000
111300                                     INDEXED BY HL-IDX.           09430000
111400         10  FILLER                  PIC  X(01)    VALUE SPACE.   09440000
111500         10  HL-MO-ABBR              PIC  X(03)    VALUE SPACE.   09450000
111600         10  FILLER                  PIC  X(01)    VALUE '-'.     09460000
111700         10  HL-CCYY                 PIC  X(04)    VALUE SPACE.   09470000
111800         10  FILLER                  PIC  X(06)    VALUE SPACE.   09480000
111900                                                                  09490000
112000******************************************************************09500000
112100*  UNDER LINES FOR DOLLAR STORED VALUE AGING REPORT.              09510000
112200******************************************************************09520000
112300 01  UL-UNDER-LINE.                                               09530000
112400     05  FILLER                      PIC  X(200)   VALUE ALL '-'. 09540000
112500                                                                  09550000
115300******************************************************************09560000
115400*  BLANK LINE FOR BOTH STORED VALUE AGING REPORTS.                09570000
115500******************************************************************09580000
115600 01  BL-BLANK-LINE.                                               09590000
115700     05  FILLER                      PIC  X(200)   VALUE SPACE.   09600000
115800                                                                  09610000
115900******************************************************************09620000
116000*  COPYBOOK OF MERCHANDISE CARD CONSTANTS                         09630000
116100******************************************************************09640000
116200     COPY SVWS004.                                                09650000
116300******************************************************************09660000
116400* TABLE TO HOLD DATA FOR PART 1 OF BOTH REPORTS.                  09670000
116500******************************************************************09680000
116600 01  TTB1-PART-1-TABLE.                                           09690000
C60667     05  TB1-PART-1-ENTRY            OCCURS 900 TIMES.            09700003
116800         10  TB1-FISCAL-CCYYPP       PIC 9(06)     VALUE ZERO.    09710000
116900         10  FILLER REDEFINES TB1-FISCAL-CCYYPP.                  09720000
117000             15  TB1-FISCAL-CCYY     PIC 9(04).                   09730000
117100             15  TB1-FISCAL-PP       PIC 9(02).                   09740000
117200         10  TB1-FISCAL-PER-ABBR     PIC X(03)     VALUE SPACE.   09750000
117300         10  TB1-DLR-ISSUED          PIC S9(11)V99 COMP-3         09760000
117400                                                   VALUE ZERO.    09770000
117700         10  TB1-DLR-PRIOR           PIC S9(11)V99 COMP-3         09780000
117800                                                   VALUE ZERO.    09790000
117900         10  TB1-DLR-REV-PRIOR       PIC S9(11)V99 COMP-3         09800000
118000                                                   VALUE ZERO.    09810000
118100         10  TB1-DLR-REV             PIC S9(11)V99 COMP-3         09820000
118200                                                   VALUE ZERO.    09830000
118300         10  TB1-DLR-URDMD-AV        PIC S9(11)V99 COMP-3         09840000
118400                                                   VALUE ZERO.    09850000
118500         10  TB1-DLR-URDMD-HQ        PIC S9(07)V99 COMP-3         09860000
118600                                                   VALUE ZERO.    09870000
118700         10  TB1-DLR-URDMD-IN        PIC S9(07)V99 COMP-3         09880000
118800                                                   VALUE ZERO.    09890000
118900         10  TB1-DLR-URDMD-OTR       PIC S9(07)V99 COMP-3         09900000
119000                                                   VALUE ZERO.    09910000
119100         10  TB1-CNT-ISSUED          PIC S9(11)    COMP-3         09920000
119200                                                   VALUE ZERO.    09930000
119300         10  TB1-CNT-PRIOR           PIC S9(11)    COMP-3         09940000
119400                                                   VALUE ZERO.    09950000
119500         10  TB1-CNT-REV-PRIOR       PIC S9(11)    COMP-3         09960000
119600                                                   VALUE ZERO.    09970000
119700         10  TB1-CNT-URDMD-AV        PIC S9(11)    COMP-3         09980000
119800                                                   VALUE ZERO.    09990000
119900         10  TB1-CNT-URDMD-HQ        PIC S9(07)    COMP-3         10000000
120000                                                   VALUE ZERO.    10010000
120100         10  TB1-CNT-URDMD-IN        PIC S9(07)    COMP-3         10020000
120200                                                   VALUE ZERO.    10030000
120300         10  TB1-CNT-URDMD-OTR       PIC S9(07)    COMP-3         10040000
120400                                                   VALUE ZERO.    10050000
121100         10  TB1-MO-DATA             OCCURS  6 TIMES              10060000
121200                                     INDEXED BY TB1-M-IDX.        10070000
121300             15  TB1-DLR-MO-QTY      PIC S9(09)V99 COMP-3         10080000
121400                                                   VALUE ZERO.    10090000
121500             15  TB1-CNT-MO-QTY      PIC S9(09)    COMP-3         10100000
121600                                                   VALUE ZERO.    10110000
121700             15  TB1-DLR-REV-MO-QTY  PIC S9(09)V99 COMP-3         10120000
121800                                                   VALUE ZERO.    10130000
121900             15  TB1-CNT-REV-MO-QTY  PIC S9(09)    COMP-3         10140000
122000                                                   VALUE ZERO.    10150000
122300******************************************************************10160000
122400* TABLE TO HOLD DATA FOR PART 2 OF BOTH REPORTS.                  10170000
122500******************************************************************10180000
122600 01  TB2-PART-2-TABLE.                                            10190000
C60667     05  TB2-PART-2-ENTRY            OCCURS 900 TIMES.            10200003
122800         10  TB2-FISCAL-CCYYPP       PIC 9(06)     VALUE ZERO.    10210000
122900         10  FILLER REDEFINES TB2-FISCAL-CCYYPP.                  10220000
123000             15  TB2-FISCAL-CCYY     PIC 9(04).                   10230000
123100             15  TB2-FISCAL-PP       PIC 9(02).                   10240000
123200         10  TB2-FISCAL-PER-ABBR     PIC X(03)     VALUE SPACE.   10250000
123300         10  TB2-FISCAL-FST-DATE     PIC X(10)     VALUE SPACE.   10260000
123400         10  TB2-FISCAL-LST-DATE     PIC X(10)     VALUE SPACE.   10270000
123500         10  TB2-DLR-ISSUED          PIC S9(11)V99 COMP-3         10280000
123600                                                   VALUE ZERO.    10290000
123700         10  TB2-DLR-PRIOR           PIC S9(11)V99 COMP-3         10300000
123800                                                   VALUE ZERO.    10310000
123900         10  TB2-DLR-REV-PRIOR       PIC S9(11)V99 COMP-3         10320000
124000                                                   VALUE ZERO.    10330000
124100         10  TB2-DLR-REV             PIC S9(11)V99 COMP-3         10340000
124200                                                   VALUE ZERO.    10350000
124300         10  TB2-DLR-URDMD-AV        PIC S9(11)V99 COMP-3         10360000
124400                                                   VALUE ZERO.    10370000
124500         10  TB2-DLR-URDMD-HQ        PIC S9(07)V99 COMP-3         10380000
124600                                                   VALUE ZERO.    10390000
124700         10  TB2-DLR-URDMD-IN        PIC S9(07)V99 COMP-3         10400000
124800                                                   VALUE ZERO.    10410000
124900         10  TB2-DLR-URDMD-OTR       PIC S9(07)V99 COMP-3         10420000
125000                                                   VALUE ZERO.    10430000
125100         10  TB2-CNT-ISSUED          PIC S9(11)    COMP-3         10440000
125200                                                   VALUE ZERO.    10450000
125300         10  TB2-CNT-PRIOR           PIC S9(11)    COMP-3         10460000
125400                                                   VALUE ZERO.    10470000
125500         10  TB2-CNT-REV-PRIOR       PIC S9(11)    COMP-3         10480000
125600                                                   VALUE ZERO.    10490000
125700         10  TB2-CNT-URDMD-AV        PIC S9(11)    COMP-3         10500000
125800                                                   VALUE ZERO.    10510000
125900         10  TB2-CNT-URDMD-HQ        PIC S9(07)    COMP-3         10520000
126000                                                   VALUE ZERO.    10530000
126100         10  TB2-CNT-URDMD-IN        PIC S9(07)    COMP-3         10540000
126200                                                   VALUE ZERO.    10550000
126300         10  TB2-CNT-URDMD-OTR       PIC S9(07)  COMP-3           10560000
126400                                                   VALUE ZERO.    10570000
126500         10  TB2-MO-DATA             OCCURS  6 TIMES              10580000
126600                                     INDEXED BY TB2-M-IDX.        10590000
126700             15  TB2-DLR-MO-QTY      PIC S9(09)V99 COMP-3         10600000
126800                                                   VALUE ZERO.    10610000
126900             15  TB2-CNT-MO-QTY      PIC S9(09)    COMP-3         10620000
127000                                                   VALUE ZERO.    10630000
127100             15  TB2-DLR-REV-MO-QTY  PIC S9(09)V99 COMP-3         10640000
127200                                                   VALUE ZERO.    10650000
127300             15  TB2-CNT-REV-MO-QTY  PIC S9(09)    COMP-3         10660000
127400                                                   VALUE ZERO.    10670000
127500 01  TB2-TABLE-CONTROLS.                                          10680000
127600     05  TB2-NBR-ENTRIES             PIC S9(4)     VALUE +1       10690000
127700                                                   COMP.          10700000
127800******************************************************************10710000
127900* TABLE TO HOLD RANGE OF FISCAL DATES TO BE SHOWN ON REPORTS.     10720000
128000******************************************************************10730000
128100 01  TB3-FISCAL-DATE-TABLE.                                       10740000
128200     05  TB3-FISCAL-DATE-ENTRY       OCCURS  6 TIMES              10750000
128300                                     INDEXED BY TB3-IDX.          10760000
128400         10  TB3-FIRST-DATE          PIC X(10)     VALUE SPACE.   10770000
128500         10  TB3-LAST-DATE           PIC X(10)     VALUE SPACE.   10780000
128600         10  TB3-FISCAL-YEAR         PIC 9(04)     VALUE ZERO.    10790000
128700         10  TB3-FISCAL-PD           PIC 9(02)     VALUE ZERO.    10800000
128800                                                                  10810000
128900******************************************************************10820000
129000* TABLE TO HOLD DATA FOR GIFT CARD TOTALS.                        10830000
129100******************************************************************10840000
129200 01  TTB4-PART-GC-TABLE.                                          10850000
C60667     05  TB4-PART-GC-ENTRY           OCCURS 900 TIMES.            10860003
129400         10  TB4-FISCAL-CCYYPP       PIC 9(06)     VALUE ZERO.    10870000
129500         10  FILLER REDEFINES TB4-FISCAL-CCYYPP.                  10880000
129600             15  TB4-FISCAL-CCYY     PIC 9(04).                   10890000
129700             15  TB4-FISCAL-PP       PIC 9(02).                   10900000
129800         10  TB4-FISCAL-PER-ABBR     PIC X(03)     VALUE SPACE.   10910000
129900         10  TB4-FISCAL-FST-DATE     PIC X(10)     VALUE SPACE.   10920000
130000         10  TB4-FISCAL-LST-DATE     PIC X(10)     VALUE SPACE.   10930000
130100         10  TB4-DLR-ISSUED          PIC S9(11)V99 COMP-3         10940000
130200                                                   VALUE ZERO.    10950000
130500         10  TB4-DLR-PRIOR           PIC S9(11)V99 COMP-3         10960000
130600                                                   VALUE ZERO.    10970000
130700         10  TB4-DLR-REV-PRIOR       PIC S9(11)V99 COMP-3         10980000
130800                                                   VALUE ZERO.    10990000
130900         10  TB4-DLR-REV             PIC S9(11)V99 COMP-3         11000000
131000                                                   VALUE ZERO.    11010000
131100         10  TB4-DLR-URDMD-AV        PIC S9(11)V99 COMP-3         11020000
131200                                                   VALUE ZERO.    11030000
131300         10  TB4-DLR-URDMD-HQ        PIC S9(07)V99 COMP-3         11040000
131400                                                   VALUE ZERO.    11050000
131500         10  TB4-DLR-URDMD-IN        PIC S9(07)V99 COMP-3         11060000
131600                                                   VALUE ZERO.    11070000
131700         10  TB4-DLR-URDMD-OTR       PIC S9(07)V99 COMP-3         11080000
131800                                                   VALUE ZERO.    11090000
131900         10  TB4-CNT-ISSUED          PIC S9(11)    COMP-3         11100000
132000                                                   VALUE ZERO.    11110000
132100         10  TB4-CNT-PRIOR           PIC S9(11)    COMP-3         11120000
132200                                                   VALUE ZERO.    11130000
132300         10  TB4-CNT-REV-PRIOR       PIC S9(11)    COMP-3         11140000
132400                                                   VALUE ZERO.    11150000
132500         10  TB4-CNT-URDMD-AV        PIC S9(11)    COMP-3         11160000
132600                                                   VALUE ZERO.    11170000
132700         10  TB4-CNT-URDMD-HQ        PIC S9(07)    COMP-3         11180000
132800                                                   VALUE ZERO.    11190000
132900         10  TB4-CNT-URDMD-IN        PIC S9(07)    COMP-3         11200000
133000                                                   VALUE ZERO.    11210000
133100         10  TB4-CNT-URDMD-OTR       PIC S9(07)    COMP-3         11220000
133200                                                   VALUE ZERO.    11230000
133900         10  TB4-MO-DATA             OCCURS  6 TIMES              11240000
134000                                     INDEXED BY TB4-M-IDX.        11250000
134100             15  TB4-DLR-MO-QTY      PIC S9(09)V99 COMP-3         11260000
134200                                                   VALUE ZERO.    11270000
134300             15  TB4-CNT-MO-QTY      PIC S9(09)    COMP-3         11280000
134400                                                   VALUE ZERO.    11290000
134500             15  TB4-DLR-REV-MO-QTY  PIC S9(09)V99 COMP-3         11300000
134600                                                   VALUE ZERO.    11310000
134700             15  TB4-CNT-REV-MO-QTY  PIC S9(09)    COMP-3         11320000
134800                                                   VALUE ZERO.    11330000
137800***************************************************************** 11340000
137900* TABLE TO HOLD FEE INFORMATION FROM SVT_ST_FEE.                * 11350000
138000***************************************************************** 11360000
138100 01  TB5-SVT-ST-FEE.                                              11370000
138200     05  TB5-FEE-TABLE               OCCURS 120 TIMES.            11380000
138300         10 TB5-ST-CDE               PIC  X(02)  VALUE SPACES.    11390000
138400         10 TB5-CRD-TYP-CDE          PIC S9(01)V COMP-3           11400000
138500                                                 VALUE ZERO.      11410000
138600         10 TB5-FEE-MN-QTY           PIC S9(04)  COMP             11420000
138700                                                 VALUE ZERO.      11430000
138800*                                                                 11440000
138900******************************************************************11450000
140100***************************************************************** 11460000
140200* PROCEDURE DIVISION.                                           * 11470000
140300***************************************************************** 11480000
140400 PROCEDURE DIVISION.                                              11490000
140500                                                                  11500000
140600 0000-MAINLINE-PROCESSING.                                        11510000
140700                                                                  11520000
140800     PERFORM 1000-INITIALIZE-PROGRAM.                             11530000
140900     PERFORM 2000-PRODUCE-REPORTS-PART-1.                         11540000
141000     PERFORM 3000-PRODUCE-REPORTS-PART-2.                         11550000
141100     PERFORM 3050-PRODUCE-REPORTS-PART-3.                         11560000
141200                                                                  11570000
141700     MOVE PV-DISPLAY-ISSUE-REC-CNT    TO PV-DISPLAY-COUNT.        11580000
141800     DISPLAY '           ISSUE RECORDS READ = ' PV-DISPLAY-COUNT. 11590000
141900     MOVE PV-DISPLAY-TENDER-REC-CNT   TO PV-DISPLAY-COUNT.        11600000
142000     DISPLAY '          TENDER RECORDS READ = ' PV-DISPLAY-COUNT. 11610000
142300     MOVE PV-DISPLAY-ACTIVITY-REC-CNT TO PV-DISPLAY-COUNT.        11620000
142400     DISPLAY '     TOTAL INPUT RECORDS READ = ' PV-DISPLAY-COUNT. 11630000
142500     MOVE PV-DISPLAY-BALANCE-REC-CNT  TO PV-DISPLAY-COUNT.        11640000
142600     DISPLAY 'TOTAL BALANCE RECORDS WRITTEN = ' PV-DISPLAY-COUNT. 11650000
142700     MOVE PV-DISPLAY-NEG-BAL-REC-CNT  TO PV-DISPLAY-COUNT.        11660000
142800     DISPLAY 'TOTAL NEG BAL RECORDS WRITTEN = ' PV-DISPLAY-COUNT. 11670000
143000     DISPLAY 'TOTAL     FEE RECORDS WRITTEN = ' PV-DISPLAY-COUNT. 11680000
143200                                                                  11690000
143300     CLOSE ACTIVITY-FILE                                          11700000
143500           BALANCE-FILE                                           11710000
143800           DOLLAR-REPORT-FILE                                     11720000
143900           COUNT-REPORT-FILE                                      11730000
144100                                                                  11740000
144200     STOP RUN.                                                    11750000
144300                                                                  11760000
144400******************************************************************11770000
144500* 1000-INITIALIZE-PROGRAM                                         11780000
144600* OPEN FILES, GET CONTROL CARD, FORMAT GLOBAL REPORT HEADINGS.    11790000
144700* INITIALIZE TABLE 2.                                             11800000
144800******************************************************************11810000
144900 1000-INITIALIZE-PROGRAM.                                         11820000
145000                                                                  11830000
145100     OPEN INPUT  DATE-CARD-FILE                                   11840000
145300                 ACTIVITY-FILE                                    11850000
145500          OUTPUT BALANCE-FILE                                     11860000
145800                 DOLLAR-REPORT-FILE                               11870000
145900                 COUNT-REPORT-FILE                                11880000
146100                                                                  11890000
146200     PERFORM 1100-PROCESS-CONTROL-CARD.                           11900000
146300     PERFORM 1200-GET-FISCAL-PERIOD-RANGE.                        11910000
146400     PERFORM 1300-FORMAT-FISCAL-HEADINGS.                         11920000
146500     PERFORM 1400-FORMAT-DATE-TIME-HEADING.                       11930000
146800******************************************************************11940000
146900* 1100-PROCESS-CONTROL-CARD                                       11950000
147000* READ DATE CONTROL CARD FOR FISCAL MONTH-END DATE.               11960000
147100* CALL DATE ROUTINE TO GET MAX FISCAL PERIOD.                     11970000
147200******************************************************************11980000
147300 1100-PROCESS-CONTROL-CARD.                                       11990000
147400                                                                  12000000
147500     PERFORM 1110-READ-DATE-CARD-FILE.                            12010000
147600     CLOSE DATE-CARD-FILE.                                        12020000
147700     IF PS-END-OF-CARD-FILE                                       12030000
147800         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   12040000
147900         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  12050000
148000         SET AC-CONTROL-CARD-ERROR TO TRUE                        12060000
148100         PERFORM 9999-ABEND                                       12070000
148200     END-IF.                                                      12080000
148300                                                                  12090000
148400     SET PS-DATE-IS-CARD-INPUT    TO TRUE.                        12100000
148500     MOVE CC-MONTH-END-CCYY-MM-DD TO PV-WORK-CCYY-MM-DD.          12110000
148600     DISPLAY 'SVKRP007 CONTROL CARD DATE = ' PV-WORK-CCYY-MM-DD.  12120000
148700     PERFORM 1500-GET-FISCAL-445-DATES.                           12130000
148800     MOVE PV-FISCAL-YEAR-CCYY     TO PV-MAX-CCYY                  12140000
148900                                     H2-YEAR                      12150000
149000                                     H2B-YEAR.                    12160000
149100     MOVE PV-FISCAL-PER-NBR       TO PV-MAX-PP.                   12170000
149200     MOVE PV-MONTH-NAME           TO H2-MONTH                     12180000
149300                                     H2B-MONTH.                   12190000
149400     MOVE PV-FISCAL-PER-LST-DATE  TO PV-FEE-DATE.                 12200000
149500                                                                  12210000
149600* DETERMINE CUTOFF DATE FOR INACTIVE PERIOD                       12220000
149700     MOVE SV004-SRV-FEE-INACTIVE-PRD                              12230000
149800                                  TO PV-FEE-PERIODS.              12240000
149900     PERFORM 9200-DECREMENT-PERIOD.                               12250000
150000     MOVE PV-FISCAL-PER-FST-DATE  TO PV-SRV-FEE-INACTIVE-PRD.     12260000
150100     DISPLAY 'FEE CUTOFF DATE = ' PV-SRV-FEE-INACTIVE-PRD.        12270000
150200                                                                  12280000
150300******************************************************************12290000
150400* 1110-READ-DATE-CARD-FILE                                        12300000
150500* READ DATE CONTROL CARD.                                         12310000
150600******************************************************************12320000
150700 1110-READ-DATE-CARD-FILE.                                        12330000
150800     READ DATE-CARD-FILE INTO CC-CONTROL-CARD                     12340000
150900        AT END                                                    12350000
151000           SET PS-END-OF-CARD-FILE TO TRUE.                       12360000
151100                                                                  12370000
151200******************************************************************12380000
151300* 1200-GET-FISCAL-PERIOD-RANGE                                    12390000
151400* LOAD THE RANGE OF DATE KEYS INTO TABLE 2.                       12400000
151500* THESE KEYS ARE ACTUALLY FISCAL YEAR AND FISCAL PERIOD (CCYYPP). 12410000
151600* THE RANGE BEGINS WITH THE FISCAL CCYYPP DERIVED FROM THE        12420000
151700* SV004-CARD-INITIAL-DATE AND ENDS WITH THE FISCAL CCYYPP DERIVED 12430000
151800* FROM THE INPUT CONTROL CARD DATE (PV-MAX-CCYYPP FROM PARA 1100).12440000
151900******************************************************************12450000
152000 1200-GET-FISCAL-PERIOD-RANGE.                                    12460000
152100                                                                  12470000
152200     SET PS-DATA-NOT-LOADED TO TRUE.                              12480000
152300     PERFORM 1210-LOAD-TABLE-2-ENTRY                              12490000
152400        VARYING PV-TB2-IDX FROM +1 BY +1                          12500000
152500           UNTIL PS-DATA-LOADED.                                  12510000
152600                                                                  12520000
152700******************************************************************12530000
152800* 1210-LOAD-TABLE-2-ENTRY                                         12540000
152900* TB2-NBR-ENTRIES HAS AN INITIAL VALUE OF +1.                     12550000
153000******************************************************************12560000
153100 1210-LOAD-TABLE-2-ENTRY.                                         12570000
153200                                                                  12580000
153300     IF PV-TB2-IDX = +1                                           12590000
153400         SET PS-DATE-IS-NOT-CARD-INPUT      TO TRUE               12600000
153500         MOVE SV004-CARD-INIT-DATE-ISO-FMT  TO PV-WORK-CCYY-MM-DD 12610000
153600         PERFORM 1500-GET-FISCAL-445-DATES                        12620000
153700     ELSE                                                         12630000
153800         ADD +1 TO TB2-NBR-ENTRIES                                12640000
153900         IF TB2-NBR-ENTRIES > PC-TABLE-LIMIT                      12650000
154000             MOVE '1210-LOAD-TABLE-2-ENTRY ' TO PV-PARAGRAPH-NAME 12660000
154100             MOVE 'TABLE 2 EXCEEDED MAX NUMBER OF ENTRIES '       12670000
154200                                            TO PV-OPERATION-MSG-1 12680000
154300             SET AC-TABLE-OVERFLOW-ERROR    TO TRUE               12690000
154400             PERFORM 9999-ABEND                                   12700000
154500         END-IF                                                   12710000
154600         PERFORM 1510-INCREMENT-FISCAL-PERIOD                     12720000
154700     END-IF.                                                      12730000
154800                                                                  12740000
154900     MOVE PV-FISCAL-YEAR-CCYY    TO TB2-FISCAL-CCYY(PV-TB2-IDX)   12750000
155000                                    TB1-FISCAL-CCYY(PV-TB2-IDX)   12760000
155100                                    TB4-FISCAL-CCYY(PV-TB2-IDX).  12770000
155200     MOVE PV-FISCAL-PER-NBR      TO TB2-FISCAL-PP(PV-TB2-IDX)     12780000
155300                                    TB1-FISCAL-PP(PV-TB2-IDX)     12790000
155400                                    TB4-FISCAL-PP(PV-TB2-IDX).    12800000
155500     MOVE PV-MONTH-ABBR          TO                               12810000
155600                                 TB2-FISCAL-PER-ABBR(PV-TB2-IDX)  12820000
155700                                 TB1-FISCAL-PER-ABBR(PV-TB2-IDX)  12830000
155800                                 TB4-FISCAL-PER-ABBR(PV-TB2-IDX). 12840000
155900     MOVE PV-FISCAL-PER-FST-DATE TO                               12850000
156000                                 TB2-FISCAL-FST-DATE(PV-TB2-IDX)  12860000
156100                                 TB4-FISCAL-FST-DATE(PV-TB2-IDX). 12870000
156200     MOVE PV-FISCAL-PER-LST-DATE TO                               12880000
156300                                 TB2-FISCAL-LST-DATE(PV-TB2-IDX)  12890000
156400                                 TB4-FISCAL-LST-DATE(PV-TB2-IDX). 12900000
156500                                                                  12910000
156600     IF SV004-BREAKAGE-INIT-FISC-YR =                             12920000
156700                                 TB2-FISCAL-CCYY(PV-TB2-IDX)      12930000
156800         IF SV004-BREAKAGE-INIT-FISC-PD =                         12940000
156900                                 TB2-FISCAL-PP(PV-TB2-IDX)        12950000
157000             MOVE PV-TB2-IDX TO PV-BREAKAGE-START-SUB             12960000
157100         END-IF                                                   12970000
157200     END-IF.                                                      12980000
157300                                                                  12990000
157400     IF TB2-FISCAL-CCYYPP(PV-TB2-IDX) = PV-MAX-CCYYPP             13000000
157500         SET PS-DATA-LOADED TO TRUE                               13010000
157600     END-IF.                                                      13020000
157700                                                                  13030000
157800******************************************************************13040000
157900* 1300-FORMAT-FISCAL-HEADINGS                                     13050000
158000*    FORMAT H5-HEADING-LINE-5 MONTH AND YEAR DATA BY UNLOADING    13060000
158100*    FISCAL PERIOD ABBR AND FISCAL YEAR FROM THE LAST 12 TABLE 2  13070000
158200*    ENTRIES.                                                     13080000
158300*    ALSO, LOAD FISCAL DATE RANGES TO MATCHING TABLE 3 ENTRIES.   13090000
158400*    THE TABLE 3 DATES WILL BE USED TO COMPARE INPUT TENDER DATES.13100000
158500******************************************************************13110000
158600 1300-FORMAT-FISCAL-HEADINGS.                                     13120000
158700                                                                  13130000
158800     MOVE TB2-NBR-ENTRIES TO PV-TB2-IDX.                          13140000
158900     PERFORM                                                      13150000
159000       VARYING HL-IDX FROM +6 BY -1                               13160000
159100       UNTIL HL-IDX < +1                                          13170000
159200         SET TB3-IDX TO HL-IDX                                    13180000
159300         MOVE TB2-FISCAL-PER-ABBR(PV-TB2-IDX)                     13190000
159400                                      TO HL-MO-ABBR(HL-IDX)       13200000
159500         MOVE TB2-FISCAL-CCYY(PV-TB2-IDX)                         13210000
159600                                      TO HL-CCYY(HL-IDX)          13220000
159700         MOVE TB2-FISCAL-FST-DATE(PV-TB2-IDX)                     13230000
159800                                      TO TB3-FIRST-DATE(TB3-IDX)  13240000
159900         MOVE TB2-FISCAL-LST-DATE(PV-TB2-IDX)                     13250000
160000                                      TO TB3-LAST-DATE(TB3-IDX)   13260000
160100         MOVE TB2-FISCAL-CCYY(PV-TB2-IDX)                         13270000
160200                                      TO TB3-FISCAL-YEAR(TB3-IDX) 13280000
160300         MOVE TB2-FISCAL-PP(PV-TB2-IDX)                           13290000
160400                                      TO TB3-FISCAL-PD(TB3-IDX)   13300000
160500         COMPUTE PV-TB2-IDX = PV-TB2-IDX - 1                      13310000
160600     END-PERFORM.                                                 13320000
160700     MOVE HL-HEADING-LINE-TABLE            TO H5-MO-DATA          13330000
160800                                              H5-MO-DATA-B.       13340000
160900                                                                  13350000
161000******************************************************************13360000
161100* 1400-FORMAT-DATE-TIME-HEADING                                   13370000
161200*    GET CURRENT DATE AND TIME FROM SYSTEM.                       13380000
161300*    FORMAT DATE AND TIME FIELDS IN THE TOP PAGE HEADING LINE     13390000
161400*    (USED BY BOTH REPORTS).                                      13400000
161500******************************************************************13410000
161600 1400-FORMAT-DATE-TIME-HEADING.                                   13420000
161700                                                                  13430000
161800     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   13440000
161900     ACCEPT PV-CURR-TIME FROM TIME.                               13450000
162000                                                                  13460000
162100     MOVE PV-CURR-DATE-MM             TO DP200-RUN-MONTH.         13470000
162200     MOVE PV-CURR-DATE-DD             TO DP200-RUN-DAY.           13480000
162300     MOVE PV-CURR-DATE-CCYY           TO DP200-RUN-YEAR.          13490000
162400                                                                  13500000
162500     MOVE PV-CURR-TIME-HH             TO DP200-RUN-HOUR.          13510000
162600     MOVE PV-CURR-TIME-MM             TO DP200-RUN-MINUTE.        13520000
162700     MOVE PC-CURRENT-PROGRAM-NAME     TO DP200-PROGRAM-NAME.      13530000
162800                                                                  13540000
162900******************************************************************13550000
163000* 1500-GET-FISCAL-445-DATES                                       13560000
163100* CALL KOHLS CALENDAR ROUTINE TO TAKE A DATE IN DB2 ISO FORMAT    13570000
163200* (CCYY-MM-DD) AND RETURN 4-4-5 (JAN - DEC) FISCAL DATE FIELDS.   13580000
163300******************************************************************13590000
163400 1500-GET-FISCAL-445-DATES.                                       13600000
163500                                                                  13610000
163600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              13620000
163700                                                                  13630000
163800     SET DPG51-FISCAL-JAN-DEC-F2       TO TRUE.                   13640000
163900     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   13650000
164000     MOVE PV-WORK-CCYY-MM-DD           TO DPG52-LK-DATE-INPUT.    13660000
164100     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   13670000
164200                                                                  13680000
164300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    13690000
164400                                             DPG54 DPG55 DPG56.   13700000
164500     EVALUATE TRUE                                                13710000
164600         WHEN DPG54-SEVERE-ERROR                                  13720000
164700         WHEN DPG54-DATE-INVALID                                  13730000
164800             MOVE '1500-GET-FISCAL-445-DATES'                     13740000
164900                                           TO PV-PARAGRAPH-NAME   13750000
165000             IF PS-DATE-IS-CARD-INPUT                             13760000
165100                 MOVE 'INVALID CONTROL CARD FISCAL DATE'          13770000
165200                                           TO PV-OPERATION-MSG-1  13780000
165300                 SET AC-CONTROL-CARD-ERROR TO TRUE                13790000
165400             ELSE                                                 13800000
165500                 MOVE 'ERROR PROCESSING FISCAL DATE'              13810000
165600                                           TO PV-OPERATION-MSG-1  13820000
165700                 SET AC-CALENDAR-ROUTINE-ERROR TO TRUE            13830000
165800             END-IF                                               13840000
165900             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  13850000
166000             PERFORM 9999-ABEND                                   13860000
166100     END-EVALUATE.                                                13870000
166200                                                                  13880000
166300     MOVE DPG56-FISCAL-YEAR-CCYY       TO PV-FISCAL-YEAR-CCYY.    13890000
166400     MOVE DPG56-FISCAL-PERIOD-NBR      TO PV-FISCAL-PER-NBR.      13900000
166500     MOVE DPG56-FISCAL-PERIOD-NAME     TO PV-MONTH-NAME.          13910000
166600     MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3 TO PV-MONTH-ABBR.        13920000
166700     MOVE DPG56-FIRST-FP-DB2-ISO-FMT   TO PV-FISCAL-PER-FST-DATE. 13930000
166800     MOVE DPG56-LAST-FP-DB2-ISO-FMT    TO PV-FISCAL-PER-LST-DATE. 13940000
166900                                                                  13950000
167000******************************************************************13960000
167100* 1510-INCREMENT-FISCAL-PERIOD                                    13970000
167200* CALL KOHLS CALENDAR ROUTINE TO TAKE A 4-4-5 FISCAL YEAR AND     13980000
167300* FISCAL PERIOD (CCYYPP), INCREMENT THE FISCAL PERIOD, AND RETURN 13990000
167400* 4-4-5 (JAN - DEC) FISCAL DATE FIELDS FOR THE NEW FISCAL PERIOD. 14000000
167500******************************************************************14010000
167600 1510-INCREMENT-FISCAL-PERIOD.                                    14020000
167700                                                                  14030000
167800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              14040000
167900                                                                  14050000
168000     SET DPG51-FISCAL-JAN-DEC-F2   TO TRUE.                       14060000
168100     SET DPG51-INCREMENT-DATE      TO TRUE.                       14070000
168200     MOVE 1 TO DPG51-INCR-DECR-FISCAL-PRD-9.                      14080000
168300     MOVE PV-FISCAL-YEAR-CCYY      TO DPG52-FISCAL-CC-PRD-YR.     14090000
168400     MOVE PV-FISCAL-PER-NBR        TO DPG52-FISCAL-CC-PRD-PP.     14100000
168500     SET DPG52-LK-DTE-FISC-PRD-CC  TO TRUE.                       14110000
168600                                                                  14120000
168700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    14130000
168800                                             DPG54 DPG55 DPG56.   14140000
168900     EVALUATE TRUE                                                14150000
169000         WHEN DPG54-SEVERE-ERROR                                  14160000
169100         WHEN DPG54-DATE-INVALID                                  14170000
169200             MOVE '1510-INCREMENT-FISCAL-PERIOD'                  14180000
169300                                       TO PV-PARAGRAPH-NAME       14190000
169400             MOVE 'ERROR INCREMENTING FISCAL PERIOD'              14200000
169500                                       TO PV-OPERATION-MSG-1      14210000
169600             MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2      14220000
169700             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                14230000
169800             PERFORM 9999-ABEND                                   14240000
169900     END-EVALUATE.                                                14250000
170000     MOVE DPG56-FISCAL-YEAR-CCYY       TO PV-FISCAL-YEAR-CCYY.    14260000
170100     MOVE DPG56-FISCAL-PERIOD-NBR      TO PV-FISCAL-PER-NBR.      14270000
170200     MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3 TO PV-MONTH-ABBR.        14280000
170300     MOVE DPG56-FIRST-FP-DB2-ISO-FMT   TO PV-FISCAL-PER-FST-DATE. 14290000
170400     MOVE DPG56-LAST-FP-DB2-ISO-FMT    TO PV-FISCAL-PER-LST-DATE. 14300000
170500                                                                  14310000
170600******************************************************************14320000
184700******************************************************************14330000
185800*2000-PRODUCE-REPORTS-PART-1                                      14340000
185900******************************************************************14350000
186000 2000-PRODUCE-REPORTS-PART-1.                                     14360000
186100                                                                  14370000
186200     PERFORM 2100-PREPARE-FOR-PART-1.                             14380000
186300     PERFORM 2200-PROCESS-ACTIVITY-RECS                           14390000
186400       UNTIL PS-END-OF-ACTVY-FILE.                                14400000
186500*TDH001                                                           14410000
186600*    PERFORM 2660-PROCESS-SERVICE-FEES.                           14420000
186700*TDH001                                                           14430000
186800     PERFORM 2700-ACCUM-UNRDMD-COUNTS.                            14440000
187300                                                                  14450000
187400     PERFORM 2800-PRINT-PART1-RPT1-DET-LINE                       14460000
187500         VARYING PV-TB2-IDX FROM PV-FIRST-STOCK-ENTRY BY +1       14470000
187600         UNTIL PV-TB2-IDX > PV-LAST-STOCK-ENTRY.                  14480000
187700     PERFORM 4700-PRINT-RPT1-TOTAL-LINE.                          14490000
187800     PERFORM 2900-PRINT-PART1-RPT2.                               14500000
187900                                                                  14510000
188000******************************************************************14520000
188100* 2100-PREPARE-FOR-PART-1.                                        14530000
188200*   DO PRIME READ OF ACTIVITY FILE, SET UP CONTROL BREAK FIELDS.  14540000
188300*   FIND THE TABLE 2 ENTRY WITH THE FISCAL PERIOD THE FIRST INPUT 14550000
188400*   RECORD WAS ISSUED.  SET THE 1ST ENTRY IN TABLE 1 TO POINT TO  14560000
188500*   FISCAL PERIOD FOUND IN TABLE 2.                               14570000
188600*   FORMAT PART 1 HEADINGS.                                       14580000
188700******************************************************************14590000
188800 2100-PREPARE-FOR-PART-1.                                         14600000
188900                                                                  14610000
189000     PERFORM 7000-READ-ACTIVITY-FILE.                             14620000
189100     IF PS-END-OF-ACTVY-FILE                                      14630000
189200         MOVE '2100-PREPARE-FOR-PART-1'    TO PV-PARAGRAPH-NAME   14640000
189300         MOVE 'NO INPUT DATA TO PROCESS'   TO PV-OPERATION-MSG-1  14650000
189400         SET AC-DATASET-DATA-ERROR TO TRUE                        14660000
189500         PERFORM 9999-ABEND                                       14670000
189600     END-IF.                                                      14680000
189700                                                                  14690000
189800     MOVE SV036-CRD-STK-TYP-ID   TO PV-SAVE-CRD-STK-TYP.          14700000
189900     MOVE SV036-CRD-STK-TYP-DESC TO PV-SAVE-CRD-STK-DESC.         14710000
190000                                                                  14720000
190100     MOVE SV036-ISSUE-TIMESTAMP(1:10) TO PV-SAVE-ISSUE-DATE.      14730000
190200     MOVE SV036-ISSUE-TIMESTAMP       TO PV-SAVE-ISSUE-TMSTMP.    14740000
190300     MOVE SV036-CRD-TYP-CDE           TO PV-SAVE-CRD-TYP-CDE.     14750000
190400     MOVE SV036-ISSUE-STR-NBR         TO PV-SAVE-ISSUE-STR-NBR.   14760000
190500     MOVE SV036-ST-CDE                TO PV-SAVE-ISSUE-ST-CDE.    14770000
190600                                                                  14780000
190700     MOVE +1                          TO PV-TB2-IDX.              14790000
190800     PERFORM 6000-FIND-FISCAL-PERIOD.                             14800000
190900                                                                  14810000
191000     MOVE SV036-CRD-NBR          TO PV-SAVE-CRD-NBR.              14820000
191100     SET PS-FEE-NOT-COUNTED      TO TRUE.                         14830000
191200                                                                  14840000
191300     PERFORM 4000-FORMAT-RPT1-HEADINGS.                           14850000
191400     PERFORM 8000-PRINT-RPT1-HEADINGS.                            14860000
191500                                                                  14870000
191600******************************************************************14880000
191700* 2200-PROCESS-ACTIVITY-RECS.                                     14890000
191800*  PROCESS THE STORED VALUE CARD ACTIVITY FILE.                   14900000
191900*  INPUT FILE IS SORTED IN FOLLOWING ORDER:                       14910000
192000*     CARD STOCK TYPE ID, CARD NUMBER, ISSUE DATE                 14920000
192100******************************************************************14930000
192200 2200-PROCESS-ACTIVITY-RECS.                                      14940000
192300                                                                  14950000
192400     IF SV036-CRD-STK-TYP-ID = PV-SAVE-CRD-STK-TYP                14960000
192500         IF SV036-CRD-NBR = PV-SAVE-CRD-NBR                       14970000
192600            MOVE SV036-ISSUE-TIMESTAMP(1:10) TO PV-WORK-CCYY-MM-DD14980000
192700            IF  PV-WORK-CCYY-MM-DD >= PV-SAVE-FST-DATE            14990000
192800            AND PV-WORK-CCYY-MM-DD <= PV-SAVE-LST-DATE            15000000
192900                CONTINUE                                          15010000
193000            ELSE                                                  15020000
193100                PERFORM 2400-PROCESS-BREAK-ON-DATE                15030000
193200            END-IF                                                15040000
193300         ELSE                                                     15050000
193400             PERFORM 2300-PROCESS-BREAK-ON-CARD                   15060000
193500         END-IF                                                   15070000
193600     ELSE                                                         15080000
193700         PERFORM 2500-PROCESS-BREAK-ON-CRD-STK                    15090000
193800     END-IF.                                                      15100000
193900                                                                  15110000
194000     MOVE +1           TO PV-SUB.                                 15120000
194100     SET PS-FEE-STATE-NOT-FOUND TO TRUE.                          15130000
194200     MOVE SV036-ST-CDE TO PV-SAVE-ST-CDE.                         15140000
194300     PERFORM 9000-CHECK-STATE-FEE-PERIOD                          15150000
194400       UNTIL PV-SUB > PV-MAX-STATE                                15160000
194500          OR PS-STATE-FOUND                                       15170000
194600          OR PS-FEE-STATE-FOUND.                                  15180000
194700                                                                  15190000
194800     PERFORM 2600-ACCUM-TOTALS.                                   15200000
194900     PERFORM 7000-READ-ACTIVITY-FILE.                             15210000
195000                                                                  15220000
195100******************************************************************15230000
195200* 2300-PROCESS-BREAK-ON-CARD                                      15240000
195300*  PROCESS CONTROL BREAK ON CARD NUMBER:                          15250000
195400*    ADD TO AN UNREDEEMED COUNT FOR THE LAST CARD.                15260000
195500******************************************************************15270000
195600 2300-PROCESS-BREAK-ON-CARD.                                      15280000
195700                                                                  15290000
195800*TDH001                                                           15300000
195900*    PERFORM 2660-PROCESS-SERVICE-FEES.                           15310000
196000*TDH001                                                           15320000
196100     PERFORM 2700-ACCUM-UNRDMD-COUNTS.                            15330000
196200     MOVE SV036-CRD-NBR               TO PV-SAVE-CRD-NBR.         15340000
196300     MOVE SV036-ISSUE-TIMESTAMP       TO PV-SAVE-ISSUE-TMSTMP.    15350000
196400     MOVE SV036-ISSUE-TIMESTAMP(1:10) TO PV-SAVE-ISSUE-DATE.      15360000
196500     MOVE SV036-CRD-TYP-CDE           TO PV-SAVE-CRD-TYP-CDE.     15370000
196600     MOVE SV036-ISSUE-STR-NBR         TO PV-SAVE-ISSUE-STR-NBR.   15380000
196700     MOVE SV036-ST-CDE                TO PV-SAVE-ISSUE-ST-CDE.    15390000
196800     MOVE ZERO                        TO PV-SAVE-CRD-VALUE        15400000
196900                                         PV-HOLD-FEE-MN-QTY       15410000
197000                                         PV-SAVE-FEE-MN-QTY.      15420000
197100     MOVE SPACES                     TO PV-SAVE-CRD-LST-ACTVY-DTE.15430000
197200     SET PS-STATE-NOT-FOUND                                       15440000
197300         PS-FEE-NOT-COUNTED           TO TRUE.                    15450000
197400                                                                  15460000
197500     MOVE +1                          TO PV-TB2-IDX.              15470000
197600     PERFORM 6000-FIND-FISCAL-PERIOD.                             15480000
197700                                                                  15490000
197800******************************************************************15500000
197900* 2400-PROCESS-BREAK-ON-DATE                                      15510000
198000*  PROCESS CONTROL BREAK ON ISSUE DATE:                           15520000
198100*    ADD TO AN UNREDEEMED COUNT FOR THE LAST CARD OF LAST DATE.   15530000
198200*    PRINT DETAIL LINE OF DOLLAR TOTALS FOR LAST DATE.            15540000
198300*    INCREASE TABLE INDEX AND LOAD CURRENT INPUT DATA TO TABLE.   15550000
198400******************************************************************15560000
198500 2400-PROCESS-BREAK-ON-DATE.                                      15570000
198600                                                                  15580000
198700     MOVE SV036-ISSUE-TIMESTAMP(1:10) TO PV-SAVE-ISSUE-DATE.      15590000
198800     MOVE SV036-ISSUE-TIMESTAMP       TO PV-SAVE-ISSUE-TMSTMP.    15600000
198900                                                                  15610000
199000     PERFORM 6000-FIND-FISCAL-PERIOD.                             15620000
199100                                                                  15630000
199200******************************************************************15640000
199300* 2500-PROCESS-BREAK-ON-CRD-STK                                   15650000
199400*  PROCESS CONTROL BREAK ON CARD STOCK:                           15660000
199500*    ADD TO AN UNREDEEMED COUNT FOR THE LAST CARD OF LAST DATE.   15670000
199600*    PRINT DETAIL LINE OF DOLLAR TOTALS.                          15680000
199700*    PRINT TOTAL LINE OF RPT 1 DOLLAR TOTALS FOR LAST CARD STOCK. 15690000
199800*    PRINT RPT 1 COUNT REPORT FOR LAST CARD STOCK & ZERO OUT ALL  15700000
199900*    ENTRIES IN TABLE 1.                                          15710000
200000******************************************************************15720000
200100 2500-PROCESS-BREAK-ON-CRD-STK.                                   15730000
200200                                                                  15740000
200300*TDH001                                                           15750000
200400*    PERFORM 2660-PROCESS-SERVICE-FEES.                           15760000
200500*TDH001                                                           15770000
200600     PERFORM 2700-ACCUM-UNRDMD-COUNTS.                            15780000
200700                                                                  15790000
201100                                                                  15800000
201200     INITIALIZE PV-TOT-ACCUM-FIELDS.                              15810000
201300                                                                  15820000
201400     PERFORM 2800-PRINT-PART1-RPT1-DET-LINE                       15830000
201500         VARYING PV-TB2-IDX FROM PV-FIRST-STOCK-ENTRY BY +1       15840000
201600         UNTIL PV-TB2-IDX > PV-LAST-STOCK-ENTRY.                  15850000
201700     PERFORM 4700-PRINT-RPT1-TOTAL-LINE.                          15860000
201800     PERFORM 2900-PRINT-PART1-RPT2.                               15870000
201900                                                                  15880000
202000     MOVE SV036-CRD-NBR               TO PV-SAVE-CRD-NBR.         15890000
202100     MOVE SV036-ISSUE-TIMESTAMP(1:10) TO PV-SAVE-ISSUE-DATE.      15900000
202200     MOVE SV036-ISSUE-TIMESTAMP       TO PV-SAVE-ISSUE-TMSTMP.    15910000
202300     MOVE SV036-CRD-TYP-CDE           TO PV-SAVE-CRD-TYP-CDE.     15920000
202400     MOVE SV036-ISSUE-STR-NBR         TO PV-SAVE-ISSUE-STR-NBR.   15930000
202500     MOVE SV036-ST-CDE                TO PV-SAVE-ISSUE-ST-CDE.    15940000
202600     MOVE ZERO                        TO PV-SAVE-CRD-VALUE        15950000
202700                                         PV-LAST-STOCK-ENTRY      15960000
202800                                         PV-HOLD-FEE-MN-QTY       15970000
202900                                         PV-SAVE-FEE-MN-QTY.      15980000
203000     INITIALIZE PV-TOT-ACCUM-FIELDS                               15990000
203100                PV-EA-TOT-ACCUM-FIELDS                            16000000
203200                PV-GT-TOT-ACCUM-FIELDS                            16010000
203300                PV-GT-PARTIAL-DLR.                                16020000
203400                                                                  16030000
203500     MOVE PC-TABLE-LIMIT              TO PV-FIRST-STOCK-ENTRY.    16040000
203600     SET PS-STATE-NOT-FOUND                                       16050000
203700         PS-FEE-NOT-COUNTED           TO TRUE.                    16060000
203800     MOVE SPACES                    TO PV-SAVE-CRD-LST-ACTVY-DTE. 16070000
203900                                                                  16080000
204000     MOVE +1                        TO PV-TB2-IDX.                16090000
204100     PERFORM 6000-FIND-FISCAL-PERIOD.                             16100000
204200                                                                  16110000
204300     MOVE SV036-CRD-STK-TYP-ID        TO PV-SAVE-CRD-STK-TYP.     16120000
204400     MOVE SV036-CRD-STK-TYP-DESC      TO PV-SAVE-CRD-STK-DESC.    16130000
204500                                                                  16140000
204600     PERFORM 4000-FORMAT-RPT1-HEADINGS.                           16150000
204700     PERFORM 8000-PRINT-RPT1-HEADINGS.                            16160000
204800                                                                  16170000
204900******************************************************************16180000
205000* 2600-ACCUM-TOTALS.                                              16190000
205100*  ADD AMOUNTS FROM CURRENT INPUT REC TO RUNNING DOLLAR TOTALS    16200000
205200******************************************************************16210000
205300 2600-ACCUM-TOTALS.                                               16220000
205400                                                                  16230000
205500     EVALUATE TRUE                                                16240000
205600         WHEN SV036-ACTVY-TYP-CDE = SV004-TENDER-ACT-TYP-N        16250000
205700             IF SV036-TENDER-TIMESTAMP(1:10) >                    16260000
205800                       PV-SAVE-CRD-LST-ACTVY-DTE                  16270000
205900                 MOVE SV036-TENDER-TIMESTAMP(1:10)                16280000
206000                                      TO PV-SAVE-CRD-LST-ACTVY-DTE16290000
206100             END-IF                                               16300000
206200             PERFORM 2610-ACCUM-TENDER-TOTALS                     16310000
206300             ADD +1 TO PV-DISPLAY-TENDER-REC-CNT                  16320000
206400         WHEN SV036-ACTVY-TYP-CDE = SV004-SRV-FEE-ACT-TYP-N       16330000
206500             IF SV036-TRN-VOID-IND = 'Y'                          16340000
206600                 IF SV036-TENDER-TIMESTAMP(1:10) >                16350000
206700                       PV-SAVE-CRD-LST-ACTVY-DTE                  16360000
206800                    MOVE SV036-TENDER-TIMESTAMP(1:10)             16370000
206900                                      TO PV-SAVE-CRD-LST-ACTVY-DTE16380000
207000                 END-IF                                           16390000
207100             ELSE                                                 16400000
207200                 PERFORM 2610-ACCUM-TENDER-TOTALS                 16410000
207300                 ADD +1 TO PV-DISPLAY-SRV-FEE-REC-CNT             16420000
207400             END-IF                                               16430000
207500         WHEN OTHER                                               16440000
207600             ADD  SV036-APP-AUTH-AMT   TO PV-SAVE-CRD-VALUE       16450000
207700             MOVE SV036-CRD-STAT-CDE   TO PV-SAVE-STAT-CDE        16460000
207800             MOVE SV036-ISSUE-TIMESTAMP(1:10)                     16470000
207900                                    TO PV-SAVE-LST-ACTVY-DTE      16480000
208000                                         PV-SAVE-CRD-LST-ACTVY-DTE16490000
208100             IF ((SV036-E-BUS-IND NOT = 'Y') OR                   16500000
208200                 (SV036-E-BUS-IND     = 'Y' AND                   16510000
208300                  SV036-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR 16520000
208400                  SV036-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD)) 16530000
208500                 ADD SV036-APP-AUTH-AMT                           16540000
208600                                     TO TB1-DLR-ISSUED(PV-TB2-IDX)16550000
208700                 ADD SV036-APP-AUTH-AMT                           16560000
208800                                     TO TB2-DLR-ISSUED(PV-TB2-IDX)16570000
208900                 IF SV036-ISSUE-CNT = +1                          16580000
209000                     ADD +1          TO TB1-CNT-ISSUED(PV-TB2-IDX)16590000
209100                     ADD +1          TO TB2-CNT-ISSUED(PV-TB2-IDX)16600000
209200                 END-IF                                           16610000
209300                 IF SV036-CRD-TYP-CDE = 2                         16620000
209400                     IF SV036-CRD-STK-TYP-ID = 'KCK'              16630000
209500                         CONTINUE                                 16640000
209600                     ELSE                                         16650000
209700                         ADD SV036-APP-AUTH-AMT                   16660000
209800                                     TO TB4-DLR-ISSUED(PV-TB2-IDX)16670000
209900                         IF SV036-ISSUE-CNT = +1                  16680000
210000                             ADD +1  TO TB4-CNT-ISSUED(PV-TB2-IDX)16690000
210100                         END-IF                                   16700000
210200                     END-IF                                       16710000
210300                 END-IF                                           16720000
210400*TDH3 -ADDED HERE                                                 16730000
210500             PERFORM 2650-ACCUM-UNRDMD-DOLLARS                    16740000
210600*TDH3 -ADDED HERE                                                 16750000
210700             ELSE                                                 16760000
210800                 ADD SV036-APP-AUTH-AMT TO PV-EA-TOT-DLR-ISSUED   16770000
210900                 ADD SV036-APP-AUTH-AMT TO PV-AC-TOT-DLR-ISSUED   16780000
211000                 IF SV036-CRD-TYP-CDE = 2                         16790000
211100                     IF SV036-CRD-STK-TYP-ID = 'KCK'              16800000
211200                         CONTINUE                                 16810000
211300                     ELSE                                         16820000
211400                         ADD SV036-APP-AUTH-AMT TO                16830000
211500                                          PV-EAK-TOT-DLR-ISSUED   16840000
211600                     END-IF                                       16850000
211700                 END-IF                                           16860000
211800             END-IF                                               16870000
211900             ADD +1 TO PV-DISPLAY-ISSUE-REC-CNT                   16880000
212000*TDH3 MOVED  PERFORM 2650-ACCUM-UNRDMD-DOLLARS                    16890000
212100     END-EVALUATE.                                                16900000
212200                                                                  16910000
212300******************************************************************16920000
212400* 2610-ACCUM-TENDER-TOTALS                                        16930000
212500*  ADD AMOUNTS FROM CURRENT INPUT REC TO RUNNING DOLLAR TOTALS    16940000
212600******************************************************************16950000
212700 2610-ACCUM-TENDER-TOTALS.                                        16960000
212800     ADD SV036-APP-AUTH-AMT            TO PV-SAVE-CRD-VALUE.      16970000
212900     MOVE SV036-TENDER-TIMESTAMP(1:10) TO PV-SAVE-LST-ACTVY-DTE.  16980000
213000     PERFORM                                                      16990000
213100       VARYING TB1-M-IDX FROM +1 BY +1                            17000000
213200       UNTIL TB1-M-IDX > +6                                       17010000
213300         SET TB2-M-IDX TO TB1-M-IDX                               17020000
213400         SET TB3-IDX   TO TB1-M-IDX                               17030000
213500         SET TB4-M-IDX TO TB1-M-IDX                               17040000
213600         SET PV-EA-TOT-IDX TO TB1-M-IDX                           17050000
213700         SET PV-EAK-TOT-IDX TO TB1-M-IDX                          17060000
213800         SET PV-AC-TOT-IDX TO TB1-M-IDX                           17070000
213900         IF  PV-SAVE-LST-ACTVY-DTE >= TB3-FIRST-DATE(TB3-IDX)     17080000
214000         AND PV-SAVE-LST-ACTVY-DTE <= TB3-LAST-DATE(TB3-IDX)      17090000
214100             PERFORM 2615-ACCUM-MONTHLY-TOTALS                    17100000
214200         ELSE                                                     17110000
214300             IF TB1-M-IDX = +1                                    17120000
214400             AND PV-SAVE-LST-ACTVY-DTE < TB3-FIRST-DATE(TB3-IDX)  17130000
214500                 PERFORM 2620-ACCUM-PRIOR-TOTALS                  17140000
214600             END-IF                                               17150000
214700         END-IF                                                   17160000
214800     END-PERFORM.                                                 17170000
214900                                                                  17180000
215000******************************************************************17190000
215100* 2615-ACCUM-MONTHLY-TOTALS                                       17200000
215200*  ADD AMOUNTS FROM CURRENT INPUT REC TO TABLED MONTHLY TOTALS    17210000
215300******************************************************************17220000
215400 2615-ACCUM-MONTHLY-TOTALS.                                       17230000
215500                                                                  17240000
215600     IF SV036-ACTVY-TYP-CDE = SV004-SRV-FEE-ACT-TYP-N             17250000
215700         ADD SV036-APP-AUTH-AMT TO                                17260000
215800                        TB1-DLR-REV-MO-QTY(PV-TB2-IDX, TB1-M-IDX) 17270000
215900         ADD SV036-APP-AUTH-AMT TO                                17280000
216000                        TB2-DLR-REV-MO-QTY(PV-TB2-IDX, TB2-M-IDX) 17290000
216100         ADD SV036-APP-AUTH-AMT TO                                17300000
216200                           TB2-DLR-REV (PV-TB2-IDX)               17310000
216300         ADD SV036-APP-AUTH-AMT TO                                17320000
216400                           TB1-DLR-REV (PV-TB2-IDX)               17330000
216500         IF SV036-CRD-TYP-CDE = 2                                 17340000
216600             IF SV036-CRD-STK-TYP-ID = 'KCK'                      17350000
216700                 CONTINUE                                         17360000
216800             ELSE                                                 17370000
216900                 ADD SV036-APP-AUTH-AMT TO                        17380000
217000                        TB4-DLR-REV-MO-QTY(PV-TB2-IDX, TB4-M-IDX) 17390000
217100                 ADD SV036-APP-AUTH-AMT TO                        17400000
217200                        TB4-DLR-REV (PV-TB2-IDX)                  17410000
217300                 IF SV036-FEE-CNT = 1 OR PS-FEE-NOT-COUNTED       17420000
217400                    ADD +1 TO                                     17430000
217500                        TB4-CNT-REV-MO-QTY(PV-TB2-IDX, TB4-M-IDX) 17440000
217600                 END-IF                                           17450000
217700             END-IF                                               17460000
217800         END-IF                                                   17470000
217900         IF SV036-FEE-CNT = 1 OR PS-FEE-NOT-COUNTED               17480000
218000             ADD +1  TO TB1-CNT-REV-MO-QTY(PV-TB2-IDX, TB1-M-IDX) 17490000
218100             ADD +1  TO TB2-CNT-REV-MO-QTY(PV-TB2-IDX, TB2-M-IDX) 17500000
218200             SET PS-FEE-COUNTED TO TRUE                           17510000
218300         END-IF                                                   17520000
218400         PERFORM 2650-ACCUM-UNRDMD-DOLLARS                        17530000
218500     ELSE                                                         17540000
218600         IF ((SV036-E-BUS-IND NOT = 'Y') OR                       17550000
218700             (SV036-E-BUS-IND     = 'Y' AND                       17560000
218800              SV036-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR     17570000
218900              SV036-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))     17580000
219000              ADD SV036-APP-AUTH-AMT TO                           17590000
219100                            TB1-DLR-MO-QTY(PV-TB2-IDX, TB1-M-IDX) 17600000
219200              ADD SV036-APP-AUTH-AMT TO                           17610000
219300                            TB2-DLR-MO-QTY(PV-TB2-IDX, TB2-M-IDX) 17620000
219400              IF SV036-CRD-TYP-CDE = 2                            17630000
219500                  IF SV036-CRD-STK-TYP-ID = 'KCK'                 17640000
219600                      CONTINUE                                    17650000
219700                  ELSE                                            17660000
219800                      ADD SV036-APP-AUTH-AMT TO                   17670000
219900                            TB4-DLR-MO-QTY(PV-TB2-IDX, TB4-M-IDX) 17680000
220000                      IF SV036-TND-CNT = 1                        17690000
220100                          ADD +1 TO                               17700000
220200                            TB4-CNT-MO-QTY(PV-TB2-IDX, TB4-M-IDX) 17710000
220300                      END-IF                                      17720000
220400                  END-IF                                          17730000
220500               END-IF                                             17740000
220600               IF SV036-TND-CNT = 1                               17750000
220700                   ADD +1         TO                              17760000
220800                           TB1-CNT-MO-QTY(PV-TB2-IDX, TB1-M-IDX)  17770000
220900                   ADD +1         TO                              17780000
221000                           TB2-CNT-MO-QTY(PV-TB2-IDX, TB2-M-IDX)  17790000
221100              END-IF                                              17800000
221200              PERFORM 2650-ACCUM-UNRDMD-DOLLARS                   17810000
221300         ELSE                                                     17820000
221400             ADD SV036-APP-AUTH-AMT TO                            17830000
221500                                 PV-EA-TOT-DLR-MO(PV-EA-TOT-IDX)  17840000
221600             ADD SV036-APP-AUTH-AMT TO                            17850000
221700                                 PV-AC-TOT-DLR-MO(PV-AC-TOT-IDX)  17860000
221800             IF SV036-CRD-TYP-CDE = 2                             17870000
221900                 IF SV036-CRD-STK-TYP-ID = 'KCK'                  17880000
222000                     CONTINUE                                     17890000
222100                 ELSE                                             17900000
222200                     ADD SV036-APP-AUTH-AMT TO                    17910000
222300                               PV-EAK-TOT-DLR-MO(PV-EAK-TOT-IDX)  17920000
222400                 END-IF                                           17930000
222500             END-IF                                               17940000
222600         END-IF                                                   17950000
222700     END-IF.                                                      17960000
222800                                                                  17970000
222900******************************************************************17980000
223000* 2620-ACCUM-PRIOR-TOTALS                                         17990000
223100*  ADD AMOUNTS FROM CURRENT INPUT REC TO TABLED PRIOR TOTALS      18000000
223200******************************************************************18010000
223300 2620-ACCUM-PRIOR-TOTALS.                                         18020000
223400                                                                  18030000
223500     IF SV036-ACTVY-TYP-CDE = SV004-SRV-FEE-ACT-TYP-N             18040000
223600         ADD SV036-APP-AUTH-AMT TO TB1-DLR-REV-PRIOR(PV-TB2-IDX)  18050000
223700         ADD SV036-APP-AUTH-AMT TO TB2-DLR-REV-PRIOR(PV-TB2-IDX)  18060000
223800         ADD SV036-APP-AUTH-AMT TO TB1-DLR-REV(PV-TB2-IDX)        18070000
223900         ADD SV036-APP-AUTH-AMT TO TB2-DLR-REV(PV-TB2-IDX)        18080000
224000         IF SV036-CRD-TYP-CDE = 2                                 18090000
224100             IF SV036-CRD-STK-TYP-ID = 'KCK'                      18100000
224200                 CONTINUE                                         18110000
224300             ELSE                                                 18120000
224400                 ADD SV036-APP-AUTH-AMT TO                        18130000
224500                                     TB4-DLR-REV-PRIOR(PV-TB2-IDX)18140000
224600                 ADD SV036-APP-AUTH-AMT TO TB4-DLR-REV(PV-TB2-IDX)18150000
224700                 IF SV036-FEE-CNT = 1 OR PS-FEE-NOT-COUNTED       18160000
224800                     ADD +1       TO TB4-CNT-REV-PRIOR(PV-TB2-IDX)18170000
224900                 END-IF                                           18180000
225000             END-IF                                               18190000
225100         END-IF                                                   18200000
225200         IF SV036-FEE-CNT = 1 OR PS-FEE-NOT-COUNTED               18210000
225300             ADD +1             TO TB1-CNT-REV-PRIOR(PV-TB2-IDX)  18220000
225400             ADD +1             TO TB2-CNT-REV-PRIOR(PV-TB2-IDX)  18230000
225500             SET PS-FEE-COUNTED TO TRUE                           18240000
225600         END-IF                                                   18250000
225700         PERFORM 2650-ACCUM-UNRDMD-DOLLARS                        18260000
225800     ELSE                                                         18270000
225900         IF ((SV036-E-BUS-IND NOT = 'Y') OR                       18280000
226000             (SV036-E-BUS-IND     = 'Y' AND                       18290000
226100              SV036-ACTVY-STAT-CDE = SV004-STAT-NO-AUTH-CD OR     18300000
226200              SV036-ACTVY-STAT-CDE = SV004-STAT-VERIFIED-CD))     18310000
226300               ADD SV036-APP-AUTH-AMT TO TB1-DLR-PRIOR(PV-TB2-IDX)18320000
226400               ADD SV036-APP-AUTH-AMT TO TB2-DLR-PRIOR(PV-TB2-IDX)18330000
226500               IF SV036-CRD-TYP-CDE = 2                           18340000
226600                   IF SV036-CRD-STK-TYP-ID = 'KCK'                18350000
226700                       CONTINUE                                   18360000
226800                   ELSE                                           18370000
226900                       ADD SV036-APP-AUTH-AMT TO                  18380000
227000                                     TB4-DLR-PRIOR(PV-TB2-IDX)    18390000
227100                       IF SV036-TND-CNT = 1                       18400000
227200                           ADD +1  TO TB4-CNT-PRIOR(PV-TB2-IDX)   18410000
227300                       END-IF                                     18420000
227400                   END-IF                                         18430000
227500               END-IF                                             18440000
227600               IF SV036-TND-CNT = 1                               18450000
227700                   ADD +1             TO TB1-CNT-PRIOR(PV-TB2-IDX)18460000
227800                   ADD +1             TO TB2-CNT-PRIOR(PV-TB2-IDX)18470000
227900               END-IF                                             18480000
228000               PERFORM 2650-ACCUM-UNRDMD-DOLLARS                  18490000
228100         ELSE                                                     18500000
228200             ADD SV036-APP-AUTH-AMT TO PV-EA-TOT-DLR-PRIOR        18510000
228300             ADD SV036-APP-AUTH-AMT TO PV-AC-TOT-DLR-PRIOR        18520000
228400             IF SV036-CRD-TYP-CDE = 2                             18530000
228500                 IF SV036-CRD-STK-TYP-ID = 'KCK'                  18540000
228600                     CONTINUE                                     18550000
228700                 ELSE                                             18560000
228800                     ADD SV036-APP-AUTH-AMT TO                    18570000
228900                                       PV-EAK-TOT-DLR-PRIOR       18580000
229000                 END-IF                                           18590000
229100             END-IF                                               18600000
229200         END-IF                                                   18610000
229300     END-IF.                                                      18620000
229400                                                                  18630000
229500******************************************************************18640000
229600* 2650-ACCUM-UNRDMD-DOLLARS                                       18650000
229700*  ADD AMOUNTS FROM CURRENT INPUT REC TO RUNNING DOLLAR TOTALS    18660000
229800******************************************************************18670000
229900 2650-ACCUM-UNRDMD-DOLLARS.                                       18680000
230000                                                                  18690000
230100     EVALUATE TRUE                                                18700000
230200       WHEN SV036-CRD-STAT-CDE = SV004-CRD-STAT-TYP-AVAILABLE     18710000
230300           ADD SV036-APP-AUTH-AMT                                 18720000
230400                        TO TB1-DLR-URDMD-AV(PV-TB2-IDX)           18730000
230500           ADD SV036-APP-AUTH-AMT                                 18740000
230600                        TO TB2-DLR-URDMD-AV(PV-TB2-IDX)           18750000
230700           IF SV036-CRD-TYP-CDE = 2                               18760000
230800             IF SV036-CRD-STK-TYP-ID = 'KCK'                      18770000
230900                 CONTINUE                                         18780000
231000             ELSE                                                 18790000
231100                ADD SV036-APP-AUTH-AMT                            18800000
231200                          TO TB4-DLR-URDMD-AV(PV-TB2-IDX)         18810000
231300             END-IF                                               18820000
231400           END-IF                                                 18830000
231500       WHEN SV036-CRD-STAT-CDE = SV004-CRD-STAT-TYP-CORP          18840000
231600           ADD SV036-APP-AUTH-AMT                                 18850000
231700                        TO TB1-DLR-URDMD-HQ(PV-TB2-IDX)           18860000
231800           ADD SV036-APP-AUTH-AMT                                 18870000
231900                        TO TB2-DLR-URDMD-HQ(PV-TB2-IDX)           18880000
232000           IF SV036-CRD-TYP-CDE = 2                               18890000
232100             IF SV036-CRD-STK-TYP-ID = 'KCK'                      18900000
232200                 CONTINUE                                         18910000
232300             ELSE                                                 18920000
232400                ADD SV036-APP-AUTH-AMT                            18930000
232500                        TO TB4-DLR-URDMD-HQ(PV-TB2-IDX)           18940000
232600             END-IF                                               18950000
232700           END-IF                                                 18960000
232800       WHEN SV036-CRD-STAT-CDE = SV004-CRD-STAT-TYP-INACTIVE      18970000
232900           ADD SV036-APP-AUTH-AMT                                 18980000
233000                        TO TB1-DLR-URDMD-IN(PV-TB2-IDX)           18990000
233100           ADD SV036-APP-AUTH-AMT                                 19000000
233200                        TO TB2-DLR-URDMD-IN(PV-TB2-IDX)           19010000
233300           IF SV036-CRD-TYP-CDE = 2                               19020000
233400             IF SV036-CRD-STK-TYP-ID = 'KCK'                      19030000
233500                 CONTINUE                                         19040000
233600             ELSE                                                 19050000
233700                ADD SV036-APP-AUTH-AMT                            19060000
233800                        TO TB4-DLR-URDMD-IN(PV-TB2-IDX)           19070000
233900             END-IF                                               19080000
234000           END-IF                                                 19090000
234100       WHEN OTHER                                                 19100000
234200           ADD SV036-APP-AUTH-AMT                                 19110000
234300                        TO TB1-DLR-URDMD-OTR(PV-TB2-IDX)          19120000
234400           ADD SV036-APP-AUTH-AMT                                 19130000
234500                        TO TB2-DLR-URDMD-OTR(PV-TB2-IDX)          19140000
234600           IF SV036-CRD-TYP-CDE = 2                               19150000
234700             IF SV036-CRD-STK-TYP-ID = 'KCK'                      19160000
234800                 CONTINUE                                         19170000
234900             ELSE                                                 19180000
235000                ADD SV036-APP-AUTH-AMT                            19190000
235100                        TO TB4-DLR-URDMD-OTR(PV-TB2-IDX)          19200000
235200             END-IF                                               19210000
235300           END-IF                                                 19220000
235400     END-EVALUATE.                                                19230000
235500                                                                  19240000
239900******************************************************************19250000
240000* 2700-ACCUM-UNRDMD-COUNTS                                        19260000
240100*  IF A BALANCE REMAINED ON THE LAST CARD:                        19270000
240200*    COUNT THE CARD BY ADDING 1 TO AN UNREDEEEMED CARD COUNT TOTAL19280000
240300*    WRITE AN OUTPUT RECORD WITH THE BALANCE OF THE LAST CARD.    19290000
240400******************************************************************19300000
240500 2700-ACCUM-UNRDMD-COUNTS.                                        19310000
240600                                                                  19320000
240700     IF PV-SAVE-CRD-VALUE > ZERO                                  19330000
240800         EVALUATE TRUE                                            19340000
240900             WHEN PV-SAVE-STAT-CDE = SV004-CRD-STAT-TYP-AVAILABLE 19350000
241000                ADD +1 TO TB1-CNT-URDMD-AV(PV-TB2-IDX)            19360000
241100                ADD +1 TO TB2-CNT-URDMD-AV(PV-TB2-IDX)            19370000
241200                IF SV036-CRD-TYP-CDE = 2                          19380000
241300                  IF SV036-CRD-STK-TYP-ID = 'KCK'                 19390000
241400                      CONTINUE                                    19400000
241500                  ELSE                                            19410000
241600                      ADD +1 TO TB4-CNT-URDMD-AV(PV-TB2-IDX)      19420000
241700                  END-IF                                          19430000
241800                END-IF                                            19440000
241900             WHEN PV-SAVE-STAT-CDE = SV004-CRD-STAT-TYP-CORP      19450000
242000                ADD +1 TO TB1-CNT-URDMD-HQ(PV-TB2-IDX)            19460000
242100                ADD +1 TO TB2-CNT-URDMD-HQ(PV-TB2-IDX)            19470000
242200                IF SV036-CRD-TYP-CDE = 2                          19480000
242300                  IF SV036-CRD-STK-TYP-ID = 'KCK'                 19490000
242400                      CONTINUE                                    19500000
242500                  ELSE                                            19510000
242600                      ADD +1 TO TB4-CNT-URDMD-HQ(PV-TB2-IDX)      19520000
242700                  END-IF                                          19530000
242800                END-IF                                            19540000
242900             WHEN PV-SAVE-STAT-CDE = SV004-CRD-STAT-TYP-INACTIVE  19550000
243000                ADD +1 TO TB1-CNT-URDMD-IN(PV-TB2-IDX)            19560000
243100                ADD +1 TO TB2-CNT-URDMD-IN(PV-TB2-IDX)            19570000
243200                IF SV036-CRD-TYP-CDE = 2                          19580000
243300                  IF SV036-CRD-STK-TYP-ID = 'KCK'                 19590000
243400                      CONTINUE                                    19600000
243500                  ELSE                                            19610000
243600                      ADD +1 TO TB4-CNT-URDMD-IN(PV-TB2-IDX)      19620000
243700                  END-IF                                          19630000
243800                END-IF                                            19640000
243900             WHEN OTHER                                           19650000
244000                ADD +1 TO TB1-CNT-URDMD-OTR(PV-TB2-IDX)           19660000
244100                ADD +1 TO TB2-CNT-URDMD-OTR(PV-TB2-IDX)           19670000
244200                IF SV036-CRD-TYP-CDE = 2                          19680000
244300                  IF SV036-CRD-STK-TYP-ID = 'KCK'                 19690000
244400                      CONTINUE                                    19700000
244500                  ELSE                                            19710000
244600                      ADD +1 TO TB4-CNT-URDMD-OTR(PV-TB2-IDX)     19720000
244700                  END-IF                                          19730000
244800                END-IF                                            19740000
244900         END-EVALUATE                                             19750000
245000     END-IF.                                                      19760000
245100                                                                  19770000
245200     IF PV-SAVE-CRD-VALUE NOT EQUAL ZERO                          19780000
245300         IF PV-SAVE-STAT-CDE = SV004-CRD-STAT-TYP-AVAILABLE       19790000
245400             PERFORM 7500-CREATE-BALANCE-RECORD                   19800000
245500         END-IF                                                   19810000
245600     END-IF.                                                      19820000
245700                                                                  19830000
253200******************************************************************19840000
253300* 2800-PRINT-PART1-RPT1-DET-LINE                                  19850000
253400*  PRINT A DETAIL LINE FOR PART 1 (BY CARD STK TYPE)              19860000
253500*  OF REPORT 1 (DOLLARS).                                         19870000
253600******************************************************************19880000
253700 2800-PRINT-PART1-RPT1-DET-LINE.                                  19890000
253800                                                                  19900000
253900     IF (PV-SVKRP007-1-LINE-CNT + 2) > PC-LINE-LIMIT              19910000
254000         PERFORM 8000-PRINT-RPT1-HEADINGS                         19920000
254100     END-IF.                                                      19930000
254200                                                                  19940000
254300     MOVE BL-BLANK-LINE     TO  PV-PRINT-RECORD.                  19950000
254400     MOVE +1                TO PV-LINE-SPACING.                   19960000
254500     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         19970000
254600                                                                  19980000
254700     MOVE TB1-FISCAL-PER-ABBR(PV-TB2-IDX) TO DL1-MO-1.            19990000
254800     MOVE TB1-FISCAL-CCYY(PV-TB2-IDX)  TO  DL1-YR-1.              20000000
254900                                                                  20010000
255000     ADD  TB1-DLR-PRIOR(PV-TB2-IDX) TO PV-TOT-DLR-PRIOR.          20020000
255100     MOVE TB1-DLR-PRIOR(PV-TB2-IDX) TO DL1-PRIOR-QTY-1.           20030000
255200                                                                  20040000
255300     PERFORM                                                      20050000
255400       VARYING TB1-M-IDX FROM +1 BY +1                            20060000
255500       UNTIL TB1-M-IDX > +6                                       20070000
255600         SET PL-IDX       TO TB1-M-IDX                            20080000
255700         SET PV-TOT-IDX   TO TB1-M-IDX                            20090000
255800         ADD  TB1-DLR-MO-QTY (PV-TB2-IDX, TB1-M-IDX)              20100000
255900                                 TO PV-TOT-DLR-MO-QTY(PV-TOT-IDX) 20110000
256000         MOVE TB1-DLR-MO-QTY (PV-TB2-IDX, TB1-M-IDX)              20120000
256100                                       TO  PL-MO-QTY(PL-IDX)      20130000
256200     END-PERFORM.                                                 20140000
256300     MOVE PL-PRINT-LINE-TABLE          TO  DL1-MO-DATA-1          20150000
256400                                                                  20160000
256500     ADD  TB1-DLR-ISSUED(PV-TB2-IDX)   TO  PV-TOT-DLR-ISSUED.     20170000
256600     MOVE TB1-DLR-ISSUED(PV-TB2-IDX)   TO  DL1-ISSUED-QTY-1       20180000
256700                                           PV-TOTAL-DLR.          20190000
256800                                                                  20200000
256900     ADD  TB1-DLR-URDMD-AV(PV-TB2-IDX) TO  PV-TOT-DLR-URDMD-AV.   20210000
257000     MOVE TB1-DLR-URDMD-AV(PV-TB2-IDX) TO  DL1-URDMD-AV-QTY-1.    20220000
257100                                                                  20230000
257200     ADD  TB1-DLR-URDMD-HQ(PV-TB2-IDX) TO  PV-TOT-DLR-URDMD-HQ.   20240000
257300     MOVE TB1-DLR-URDMD-HQ(PV-TB2-IDX) TO  DL1-URDMD-HQ-QTY-1.    20250000
257400                                                                  20260000
257500     ADD  TB1-DLR-URDMD-IN(PV-TB2-IDX) TO  PV-TOT-DLR-URDMD-IN.   20270000
257600     MOVE TB1-DLR-URDMD-IN(PV-TB2-IDX) TO  DL1-URDMD-IN-QTY-1.    20280000
257700                                                                  20290000
257800     ADD  TB1-DLR-URDMD-OTR(PV-TB2-IDX) TO PV-TOT-DLR-URDMD-OTR.  20300000
257900     MOVE TB1-DLR-URDMD-OTR(PV-TB2-IDX) TO DL1-URDMD-OTR-QTY-1.   20310000
258000                                                                  20320000
258100                                                                  20330000
258200     ADD  TB1-DLR-REV-PRIOR(PV-TB2-IDX) TO PV-TOT-DLR-REV-PRIOR.  20340000
258300     MOVE TB1-DLR-REV-PRIOR(PV-TB2-IDX) TO DL2-REV-PRIOR-QTY-2.   20350000
258400                                                                  20360000
258500     PERFORM                                                      20370000
258600       VARYING TB1-M-IDX FROM +1 BY +1                            20380000
258700       UNTIL TB1-M-IDX > +6                                       20390000
258800         SET PL-IDX       TO TB1-M-IDX                            20400000
258900         SET PV-TOT-IDX   TO TB1-M-IDX                            20410000
259000         ADD  TB1-DLR-REV-MO-QTY (PV-TB2-IDX, TB1-M-IDX)          20420000
259100                             TO PV-TOT-DLR-REV-MO-QTY(PV-TOT-IDX) 20430000
259200         MOVE TB1-DLR-REV-MO-QTY (PV-TB2-IDX, TB1-M-IDX)          20440000
259300                                       TO  PL-MO-QTY(PL-IDX)      20450000
259400     END-PERFORM.                                                 20460000
259500     MOVE PL-PRINT-LINE-TABLE          TO  DL2-MO-DATA-2.         20470000
259600                                                                  20480000
259700     ADD  TB1-DLR-REV(PV-TB2-IDX)      TO  PV-TOT-DLR-REV.        20490000
259800     MOVE TB1-DLR-REV(PV-TB2-IDX)      TO  DL2-REV-QTY-2.         20500000
259900                                                                  20510000
260000     COMPUTE PV-DLR-NET-REV = TB1-DLR-URDMD-AV (PV-TB2-IDX)       20520000
260100                            + (TB1-DLR-REV (PV-TB2-IDX) * -1).    20530000
260200                                                                  20540000
260300     MOVE PV-DLR-NET-REV               TO  DL2-NET-REV-QTY-2      20550000
260400                                           PV-PARTIAL-DLR.        20560000
260500                                                                  20570000
260600     PERFORM 5100-CALCULATE-DLR-PERCENT.                          20580000
?FIX01*    MOVE PV-PERCENT-SHIFTED   TO  DL1-URDMD-PERCENT-1.           20590000
260800                                                                  20600000
260900     MOVE DL1-DETAIL-LINE-1 TO  PV-PRINT-RECORD.                  20610000
261000     MOVE +1                TO  PV-LINE-SPACING.                  20620000
261100     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         20630000
261200                                                                  20640000
261300     MOVE DL2-DETAIL-LINE-2 TO  PV-PRINT-RECORD.                  20650000
261400     MOVE +1                TO  PV-LINE-SPACING.                  20660000
261500     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         20670000
261600                                                                  20680000
261700******************************************************************20690000
261800* 2900-PRINT-PART1-RPT2.                                          20700000
261900*  UNLOAD TABLE 1 TO PRINT PART 1 (BY CARD STOCK TYPE) OF         20710000
262000*  REPORT 2 (COUNTS) FOR THE PREVIOUS CARD STOCK.                 20720000
262100******************************************************************20730000
262200 2900-PRINT-PART1-RPT2.                                           20740000
262300     PERFORM 4100-FORMAT-RPT2-HEADINGS.                           20750000
262400     PERFORM 8500-PRINT-RPT2-HEADINGS.                            20760000
262500     PERFORM 2910-PRINT-PART1-RPT2-DET-LINE                       20770000
262600        VARYING PV-TB2-IDX FROM PV-FIRST-STOCK-ENTRY BY +1        20780000
262700           UNTIL PV-TB2-IDX > PV-LAST-STOCK-ENTRY                 20790000
262800              OR PV-TB2-IDX > TB2-NBR-ENTRIES.                    20800000
262900     PERFORM 4900-PRINT-RPT2-TOTAL-LINE.                          20810000
263000                                                                  20820000
263100******************************************************************20830000
263200* 2910-PRINT-PART1-RPT2-DET-LINE                                  20840000
263300*  PRINT A DETAIL LINE FOR PART 1 (BY CARD STK TYPE) OF REPORT 2  20850000
263400*  (COUNTS) & ZERO OUT ALL PART 1 DATA FOR THIS ENTRY IN TABLE 1. 20860000
263500******************************************************************20870000
263600 2910-PRINT-PART1-RPT2-DET-LINE.                                  20880000
263700                                                                  20890000
263800     IF (PV-SVKRP007-2-LINE-CNT + 2) > PC-LINE-LIMIT              20900000
263900         PERFORM 8500-PRINT-RPT2-HEADINGS                         20910000
264000     END-IF.                                                      20920000
264100                                                                  20930000
264200     MOVE BL-BLANK-LINE      TO  PV-PRINT-RECORD.                 20940000
264300     MOVE +1                 TO PV-LINE-SPACING.                  20950000
264400     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         20960000
264500                                                                  20970000
264600     MOVE TB1-FISCAL-PER-ABBR(PV-TB2-IDX) TO DL1B-MO-1.           20980000
264700     MOVE TB1-FISCAL-CCYY(PV-TB2-IDX)  TO  DL1B-YR-1.             20990000
264800                                                                  21000000
264900     ADD  TB1-CNT-PRIOR(PV-TB2-IDX) TO PV-TOT-CNT-PRIOR.          21010000
265000     MOVE TB1-CNT-PRIOR(PV-TB2-IDX) TO DL1B-PRIOR-QTY-1.          21020000
265100                                                                  21030000
265200     PERFORM                                                      21040000
265300       VARYING TB1-M-IDX FROM +1 BY +1                            21050000
265400       UNTIL TB1-M-IDX > +6                                       21060000
265500         SET PL2-IDX      TO TB1-M-IDX                            21070000
265600         SET PV-TOT-IDX   TO TB1-M-IDX                            21080000
265700         ADD  TB1-CNT-MO-QTY (PV-TB2-IDX, TB1-M-IDX)              21090000
265800                                 TO PV-TOT-CNT-MO-QTY(PV-TOT-IDX) 21100000
265900         MOVE TB1-CNT-MO-QTY (PV-TB2-IDX, TB1-M-IDX)              21110000
266000                                      TO  PL2-MO-QTY(PL2-IDX)     21120000
266100     END-PERFORM.                                                 21130000
266200     MOVE PL2-PRINT-LINE-TABLE        TO  DL1B-MO-DATA-1.         21140000
266300                                                                  21150000
266400     ADD  TB1-CNT-ISSUED(PV-TB2-IDX)  TO  PV-TOT-CNT-ISSUED.      21160000
266500     MOVE TB1-CNT-ISSUED(PV-TB2-IDX)  TO  DL1B-ISSUED-QTY-1       21170000
266600                                          PV-TOTAL-CNT.           21180000
266700                                                                  21190000
266800     ADD  TB1-CNT-URDMD-AV(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-AV.    21200000
266900     MOVE TB1-CNT-URDMD-AV(PV-TB2-IDX) TO DL1B-URDMD-AV-QTY-1     21210000
267000                                          PV-PARTIAL-CNT.         21220000
267100                                                                  21230000
267200     PERFORM 5300-CALCULATE-CNT-PERCENT.                          21240000
?FIX01*    MOVE PV-PERCENT-SHIFTED  TO DL1B-URDMD-PERCENT-1.            21250000
267400                                                                  21260000
267500     ADD  TB1-CNT-URDMD-HQ(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-HQ.    21270000
267600     MOVE TB1-CNT-URDMD-HQ(PV-TB2-IDX) TO DL1B-URDMD-HQ-QTY-1.    21280000
267700                                                                  21290000
267800     ADD  TB1-CNT-URDMD-IN(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-IN.    21300000
267900     MOVE TB1-CNT-URDMD-IN(PV-TB2-IDX) TO DL1B-URDMD-IN-QTY-1.    21310000
268000                                                                  21320000
268100     ADD  TB1-CNT-URDMD-OTR(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-OTR.  21330000
268200     MOVE TB1-CNT-URDMD-OTR(PV-TB2-IDX) TO DL1B-URDMD-OTR-QTY-1.  21340000
268300                                                                  21350000
268400     MOVE DL1B-DETAIL-LINE-1 TO  PV-PRINT-RECORD.                 21360000
268500     MOVE +1                 TO  PV-LINE-SPACING.                 21370000
268600     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         21380000
268700                                                                  21390000
268800     ADD  TB1-CNT-REV-PRIOR(PV-TB2-IDX) TO PV-TOT-CNT-REV-PRIOR.  21400000
268900     MOVE TB1-CNT-REV-PRIOR(PV-TB2-IDX) TO DL2B-REV-PRIOR-QTY-2.  21410000
269000                                                                  21420000
269100     PERFORM                                                      21430000
269200       VARYING TB1-M-IDX FROM +1 BY +1                            21440000
269300       UNTIL TB1-M-IDX > +6                                       21450000
269400         SET PL2-IDX      TO TB1-M-IDX                            21460000
269500         SET PV-TOT-IDX   TO TB1-M-IDX                            21470000
269600         ADD  TB1-CNT-REV-MO-QTY (PV-TB2-IDX, TB1-M-IDX)          21480000
269700                          TO PV-TOT-CNT-REV-MO-QTY(PV-TOT-IDX)    21490000
269800         MOVE TB1-CNT-REV-MO-QTY (PV-TB2-IDX, TB1-M-IDX)          21500000
269900                          TO  PL2-MO-QTY(PL2-IDX)                 21510000
270000     END-PERFORM.                                                 21520000
270100     MOVE PL2-PRINT-LINE-TABLE        TO  DL2B-MO-DATA-2.         21530000
270200                                                                  21540000
270300     MOVE DL2B-DETAIL-LINE-2 TO  PV-PRINT-RECORD.                 21550000
270400     MOVE +1                 TO  PV-LINE-SPACING.                 21560000
270500     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         21570000
270600                                                                  21580000
270700     PERFORM 2920-ZERO-TABLE-1-ENTRY.                             21590000
270800                                                                  21600000
270900******************************************************************21610000
271000* 2920-ZERO-TABLE-1-ENTRY                                         21620000
271100******************************************************************21630000
271200 2920-ZERO-TABLE-1-ENTRY.                                         21640000
271300     MOVE ZEROS TO TB1-DLR-ISSUED(PV-TB2-IDX)                     21650000
271500                   TB1-DLR-PRIOR(PV-TB2-IDX)                      21660000
271600                   TB1-DLR-REV-PRIOR(PV-TB2-IDX)                  21670000
271700                   TB1-DLR-REV(PV-TB2-IDX)                        21680000
271800                   TB1-DLR-URDMD-AV(PV-TB2-IDX)                   21690000
271900                   TB1-DLR-URDMD-HQ(PV-TB2-IDX)                   21700000
272000                   TB1-DLR-URDMD-IN(PV-TB2-IDX)                   21710000
272100                   TB1-DLR-URDMD-OTR(PV-TB2-IDX)                  21720000
272200                   TB1-CNT-ISSUED(PV-TB2-IDX)                     21730000
272300                   TB1-CNT-PRIOR(PV-TB2-IDX)                      21740000
272400                   TB1-CNT-REV-PRIOR(PV-TB2-IDX)                  21750000
272500                   TB1-CNT-URDMD-AV(PV-TB2-IDX)                   21760000
272600                   TB1-CNT-URDMD-HQ(PV-TB2-IDX)                   21770000
272700                   TB1-CNT-URDMD-IN(PV-TB2-IDX)                   21780000
272800                   TB1-CNT-URDMD-OTR(PV-TB2-IDX)                  21790000
273100     PERFORM                                                      21800000
273200       VARYING TB1-M-IDX FROM +1 BY +1                            21810000
273300       UNTIL TB1-M-IDX > +6                                       21820000
273400         MOVE ZEROS TO TB1-DLR-MO-QTY(PV-TB2-IDX, TB1-M-IDX)      21830000
273500         MOVE ZEROS TO TB1-CNT-MO-QTY(PV-TB2-IDX, TB1-M-IDX)      21840000
273600         MOVE ZEROS TO TB1-DLR-REV-MO-QTY(PV-TB2-IDX, TB1-M-IDX)  21850000
273700         MOVE ZEROS TO TB1-CNT-REV-MO-QTY(PV-TB2-IDX, TB1-M-IDX)  21860000
273900     END-PERFORM.                                                 21870000
274000                                                                  21880000
274100******************************************************************21890000
274200* 3000-PRODUCE-REPORTS-PART-2                                     21900000
274300******************************************************************21910000
274400 3000-PRODUCE-REPORTS-PART-2.                                     21920000
274500                                                                  21930000
274600     PERFORM 3100-PREPARE-FOR-PART-2.                             21940000
274700     PERFORM 3200-PRODUCE-PART2-RPT1.                             21950000
274800     PERFORM 3300-PRODUCE-PART2-RPT2.                             21960000
274900                                                                  21970000
275000******************************************************************21980000
275100* 3050-PRODUCE-REPORTS-PART-3                                     21990000
275200******************************************************************22000000
275300 3050-PRODUCE-REPORTS-PART-3.                                     22010000
275400                                                                  22020000
275500     PERFORM 3150-GIFT-CARD-TOTALS.                               22030000
275600     PERFORM 3250-PRODUCE-GC-PART2-RPT1.                          22040000
275700     PERFORM 3350-PRODUCE-GC-PART2-RPT2.                          22050000
275800     INITIALIZE PV-TOT-ACCUM-FIELDS.                              22060000
275900*    PERFORM 3710-BREAKAGE.                                       22070000
276000                                                                  22080000
276100******************************************************************22090000
276200* 3100-PREPARE-FOR-PART-2.                                        22100000
276300*   FORMAT REPORT 1 HEADINGS.                                     22110000
276400******************************************************************22120000
276500 3100-PREPARE-FOR-PART-2.                                         22130000
276600                                                                  22140000
276700     MOVE PC-ALL-CARDS-DESC     TO H3-CRD-STK-DESC.               22150000
276800     PERFORM 4000-FORMAT-RPT1-HEADINGS.                           22160000
276900     PERFORM 8000-PRINT-RPT1-HEADINGS.                            22170000
277000                                                                  22180000
277100******************************************************************22190000
277200* 3150-GIFT-CARD-TOTALS.                                          22200000
277300*   FORMAT REPORT 1 HEADINGS.                                     22210000
277400******************************************************************22220000
277500 3150-GIFT-CARD-TOTALS.                                           22230000
277600                                                                  22240000
277700     MOVE PC-GIFT-CARDS-DESC     TO H3-CRD-STK-DESC.              22250000
277800     PERFORM 4000-FORMAT-RPT1-HEADINGS.                           22260000
277900     PERFORM 8000-PRINT-RPT1-HEADINGS.                            22270000
278000                                                                  22280000
278100******************************************************************22290000
278200* 3200-PROCESS-PART2-RPT1                                         22300000
278300******************************************************************22310000
278400 3200-PRODUCE-PART2-RPT1.                                         22320000
278500                                                                  22330000
278600     PERFORM 3400-PRINT-PART2-RPT1-DET-LINE                       22340000
278700        VARYING PV-TB2-IDX FROM +1 BY +1                          22350000
278800           UNTIL PV-TB2-IDX > TB2-NBR-ENTRIES.                    22360000
278900     PERFORM 5050-PRINT-RPT1-ALLCARDS-TOTAL.                      22370000
279000                                                                  22380000
279100******************************************************************22390000
279200* 3250-PROCESS-GC-PART2-RPT1                                      22400000
279300******************************************************************22410000
279400 3250-PRODUCE-GC-PART2-RPT1.                                      22420000
279500                                                                  22430000
279600     PERFORM 3450-PRINT-PART2-RPT1-GC-LINE                        22440000
279700        VARYING PV-TB2-IDX FROM PV-FIRST-GC-ENTRY BY +1           22450000
279800           UNTIL PV-TB2-IDX > PV-LAST-GC-ENTRY                    22460000
279900              OR PV-TB2-IDX > TB2-NBR-ENTRIES.                    22470000
280000     PERFORM 4800-PRINT-RPT1-GC-LINE.                             22480000
280100                                                                  22490000
280200******************************************************************22500000
280300* 3300-PROCESS-PART2-RPT2                                         22510000
280400******************************************************************22520000
280500 3300-PRODUCE-PART2-RPT2.                                         22530000
280600                                                                  22540000
280700     PERFORM 4100-FORMAT-RPT2-HEADINGS.                           22550000
280800     PERFORM 8500-PRINT-RPT2-HEADINGS.                            22560000
280900     PERFORM 3500-PRINT-PART2-RPT2-DET-LINE                       22570000
281000        VARYING PV-TB2-IDX FROM +1 BY +1                          22580000
281100           UNTIL PV-TB2-IDX > TB2-NBR-ENTRIES.                    22590000
281200     PERFORM 4900-PRINT-RPT2-TOTAL-LINE.                          22600000
281300                                                                  22610000
281400******************************************************************22620000
281500* 3350-PROCESS-GC-PART2-RPT2                                      22630000
281600******************************************************************22640000
281700 3350-PRODUCE-GC-PART2-RPT2.                                      22650000
281800                                                                  22660000
281900     PERFORM 4100-FORMAT-RPT2-HEADINGS.                           22670000
282000     PERFORM 8500-PRINT-RPT2-HEADINGS.                            22680000
282100     PERFORM 3600-PRINT-PART2-RPT2-GC-LINE                        22690000
282200        VARYING PV-TB2-IDX FROM PV-FIRST-GC-ENTRY BY +1           22700000
282300           UNTIL PV-TB2-IDX > PV-LAST-GC-ENTRY                    22710000
282400              OR PV-TB2-IDX > TB2-NBR-ENTRIES.                    22720000
282500     PERFORM 5000-PRINT-RPT2-GC-LINE.                             22730000
282600                                                                  22740000
282700******************************************************************22750000
282800* 3400-PRINT-PART2-RPT1-DET-LINE                                  22760000
282900*  THIS PARAGRAPH WILL PRINT THE REPORT 2 DOLLAR DETAIL LINE.     22770000
283000******************************************************************22780000
283100 3400-PRINT-PART2-RPT1-DET-LINE.                                  22790000
283200                                                                  22800000
283300     IF (PV-SVKRP007-1-LINE-CNT + 2) > PC-LINE-LIMIT              22810000
283400         PERFORM 8000-PRINT-RPT1-HEADINGS                         22820000
283500     END-IF.                                                      22830000
283600                                                                  22840000
283700     MOVE BL-BLANK-LINE      TO  PV-PRINT-RECORD.                 22850000
283800     MOVE +1                 TO PV-LINE-SPACING.                  22860000
283900     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         22870000
284000                                                                  22880000
284100     MOVE TB2-FISCAL-PER-ABBR(PV-TB2-IDX) TO DL1-MO-1.            22890000
284200     MOVE TB2-FISCAL-CCYY(PV-TB2-IDX)  TO  DL1-YR-1.              22900000
284300                                                                  22910000
284400     ADD  TB2-DLR-PRIOR(PV-TB2-IDX) TO PV-TOT-DLR-PRIOR.          22920000
284500     MOVE TB2-DLR-PRIOR(PV-TB2-IDX) TO DL1-PRIOR-QTY-1.           22930000
284600                                                                  22940000
284700     PERFORM                                                      22950000
284800       VARYING TB2-M-IDX FROM +1 BY +1                            22960000
284900       UNTIL TB2-M-IDX > +6                                       22970000
285000         SET PL-IDX       TO TB2-M-IDX                            22980000
285100         SET PV-TOT-IDX   TO TB2-M-IDX                            22990000
285200         ADD  TB2-DLR-MO-QTY (PV-TB2-IDX, TB2-M-IDX)              23000000
285300                                TO  PV-TOT-DLR-MO-QTY(PV-TOT-IDX) 23010000
285400         MOVE TB2-DLR-MO-QTY (PV-TB2-IDX, TB2-M-IDX)              23020000
285500                                TO  PL-MO-QTY(PL-IDX)             23030000
285600     END-PERFORM.                                                 23040000
285700     MOVE PL-PRINT-LINE-TABLE        TO DL1-MO-DATA-1.            23050000
285800                                                                  23060000
285900     ADD  TB2-DLR-ISSUED(PV-TB2-IDX) TO PV-TOT-DLR-ISSUED.        23070000
286000     MOVE TB2-DLR-ISSUED(PV-TB2-IDX) TO DL1-ISSUED-QTY-1          23080000
286100                                      PV-TOTAL-DLR.               23090000
286200                                                                  23100000
286300     ADD  TB2-DLR-URDMD-AV(PV-TB2-IDX) TO PV-TOT-DLR-URDMD-AV.    23110000
286400     MOVE TB2-DLR-URDMD-AV(PV-TB2-IDX) TO DL1-URDMD-AV-QTY-1.     23120000
286500                                                                  23130000
286600     ADD  TB2-DLR-URDMD-HQ(PV-TB2-IDX) TO PV-TOT-DLR-URDMD-HQ.    23140000
286700     MOVE TB2-DLR-URDMD-HQ(PV-TB2-IDX) TO DL1-URDMD-HQ-QTY-1.     23150000
286800                                                                  23160000
286900     ADD  TB2-DLR-URDMD-IN(PV-TB2-IDX) TO PV-TOT-DLR-URDMD-IN.    23170000
287000     MOVE TB2-DLR-URDMD-IN(PV-TB2-IDX) TO DL1-URDMD-IN-QTY-1.     23180000
287100                                                                  23190000
287200     ADD  TB2-DLR-URDMD-OTR(PV-TB2-IDX) TO PV-TOT-DLR-URDMD-OTR.  23200000
287300     MOVE TB2-DLR-URDMD-OTR(PV-TB2-IDX) TO DL1-URDMD-OTR-QTY-1.   23210000
287400                                                                  23220000
287500     ADD  TB2-DLR-REV-PRIOR(PV-TB2-IDX) TO PV-TOT-DLR-REV-PRIOR.  23230000
287600     MOVE TB2-DLR-REV-PRIOR(PV-TB2-IDX) TO DL2-REV-PRIOR-QTY-2.   23240000
287700                                                                  23250000
287800     PERFORM                                                      23260000
287900       VARYING TB2-M-IDX FROM +1 BY +1                            23270000
288000       UNTIL TB2-M-IDX > +6                                       23280000
288100         SET PL-IDX       TO TB2-M-IDX                            23290000
288200         SET PV-TOT-IDX   TO TB2-M-IDX                            23300000
288300         ADD  TB2-DLR-REV-MO-QTY (PV-TB2-IDX, TB2-M-IDX)          23310000
288400                          TO  PV-TOT-DLR-REV-MO-QTY(PV-TOT-IDX)   23320000
288500         MOVE TB2-DLR-REV-MO-QTY (PV-TB2-IDX, TB2-M-IDX)          23330000
288600                          TO  PL-MO-QTY(PL-IDX)                   23340000
288700     END-PERFORM.                                                 23350000
288800     MOVE PL-PRINT-LINE-TABLE     TO  DL2-MO-DATA-2.              23360000
288900                                                                  23370000
289000     ADD  TB2-DLR-REV(PV-TB2-IDX) TO  PV-TOT-DLR-REV.             23380000
289100     MOVE TB2-DLR-REV(PV-TB2-IDX) TO  DL2-REV-QTY-2.              23390000
289200                                                                  23400000
289300     COMPUTE PV-DLR-NET-REV = TB2-DLR-URDMD-AV(PV-TB2-IDX)        23410000
289400                        + (TB2-DLR-REV(PV-TB2-IDX) * -1).         23420000
289500     MOVE PV-DLR-NET-REV          TO  DL2-NET-REV-QTY-2           23430000
289600                                      PV-PARTIAL-DLR.             23440000
289700                                                                  23450000
289800     PERFORM 5100-CALCULATE-DLR-PERCENT.                          23460000
?FIX01*    MOVE  PV-PERCENT-SHIFTED       TO DL1-URDMD-PERCENT-1.       23470000
290000                                                                  23480000
290100     MOVE DL1-DETAIL-LINE-1       TO  PV-PRINT-RECORD.            23490000
290200     MOVE +1                      TO  PV-LINE-SPACING.            23500000
290300     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         23510000
290400                                                                  23520000
290500     MOVE DL2-DETAIL-LINE-2       TO  PV-PRINT-RECORD.            23530000
290600     MOVE +1                      TO  PV-LINE-SPACING.            23540000
290700     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         23550000
290800                                                                  23560000
290900******************************************************************23570000
291000* 3450-PRINT-PART2-RPT1-GC-LINE                                   23580000
291100*  THIS PARAGRAPH WILL PRINT THE REPORT 2 DOLLAR GIFT CARD LINE.  23590000
291200******************************************************************23600000
291300 3450-PRINT-PART2-RPT1-GC-LINE.                                   23610000
291400                                                                  23620000
291500     IF (PV-SVKRP007-1-LINE-CNT + 2) > PC-LINE-LIMIT              23630000
291600         PERFORM 8000-PRINT-RPT1-HEADINGS                         23640000
291700     END-IF.                                                      23650000
291800                                                                  23660000
291900     MOVE BL-BLANK-LINE      TO  PV-PRINT-RECORD.                 23670000
292000     MOVE +1                 TO PV-LINE-SPACING.                  23680000
292100     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         23690000
292200                                                                  23700000
292300     MOVE TB4-FISCAL-PER-ABBR(PV-TB2-IDX) TO DL1-MO-1.            23710000
292400     MOVE TB4-FISCAL-CCYY(PV-TB2-IDX)  TO  DL1-YR-1.              23720000
292500                                                                  23730000
292600     ADD  TB4-DLR-PRIOR(PV-TB2-IDX) TO PV-GC-DLR-PRIOR.           23740000
292700     MOVE TB4-DLR-PRIOR(PV-TB2-IDX) TO DL1-PRIOR-QTY-1.           23750000
292800                                                                  23760000
292900     PERFORM                                                      23770000
293000       VARYING TB4-M-IDX FROM +1 BY +1                            23780000
293100       UNTIL TB4-M-IDX > +6                                       23790000
293200         SET PL-IDX       TO TB4-M-IDX                            23800000
293300         SET PV-GC-IDX    TO TB4-M-IDX                            23810000
293400         ADD  TB4-DLR-MO-QTY (PV-TB2-IDX, TB4-M-IDX)              23820000
293500                                TO  PV-GC-DLR-MO-QTY(PV-GC-IDX)   23830000
293600         MOVE TB4-DLR-MO-QTY (PV-TB2-IDX, TB4-M-IDX)              23840000
293700                                TO  PL-MO-QTY(PL-IDX)             23850000
293800     END-PERFORM.                                                 23860000
293900     MOVE PL-PRINT-LINE-TABLE        TO DL1-MO-DATA-1.            23870000
294000                                                                  23880000
294100     ADD  TB4-DLR-ISSUED(PV-TB2-IDX) TO PV-GC-DLR-ISSUED.         23890000
294200     MOVE TB4-DLR-ISSUED(PV-TB2-IDX) TO DL1-ISSUED-QTY-1          23900000
294300                                      PV-TOTAL-DLR.               23910000
294400                                                                  23920000
294500     ADD  TB4-DLR-URDMD-AV(PV-TB2-IDX) TO PV-GC-DLR-URDMD-AV.     23930000
294600     MOVE TB4-DLR-URDMD-AV(PV-TB2-IDX) TO DL1-URDMD-AV-QTY-1.     23940000
294700                                                                  23950000
294800     ADD  TB4-DLR-URDMD-HQ(PV-TB2-IDX) TO PV-GC-DLR-URDMD-HQ.     23960000
294900     MOVE TB4-DLR-URDMD-HQ(PV-TB2-IDX) TO DL1-URDMD-HQ-QTY-1.     23970000
295000                                                                  23980000
295100     ADD  TB4-DLR-URDMD-IN(PV-TB2-IDX) TO PV-GC-DLR-URDMD-IN.     23990000
295200     MOVE TB4-DLR-URDMD-IN(PV-TB2-IDX) TO DL1-URDMD-IN-QTY-1.     24000000
295300                                                                  24010000
295400     ADD  TB4-DLR-URDMD-OTR(PV-TB2-IDX) TO PV-GC-DLR-URDMD-OTR.   24020000
295500     MOVE TB4-DLR-URDMD-OTR(PV-TB2-IDX) TO DL1-URDMD-OTR-QTY-1.   24030000
295600                                                                  24040000
295700     ADD  TB4-DLR-REV-PRIOR(PV-TB2-IDX) TO PV-GC-DLR-REV-PRIOR.   24050000
295800     MOVE TB4-DLR-REV-PRIOR(PV-TB2-IDX) TO DL2-REV-PRIOR-QTY-2.   24060000
295900                                                                  24070000
296000     PERFORM                                                      24080000
296100       VARYING TB4-M-IDX FROM +1 BY +1                            24090000
296200       UNTIL TB4-M-IDX > +6                                       24100000
296300         SET PL-IDX       TO TB4-M-IDX                            24110000
296400         SET PV-GC-IDX    TO TB4-M-IDX                            24120000
296500         ADD  TB4-DLR-REV-MO-QTY (PV-TB2-IDX, TB4-M-IDX)          24130000
296600                          TO  PV-GC-DLR-REV-MO-QTY(PV-GC-IDX)     24140000
296700         MOVE TB4-DLR-REV-MO-QTY (PV-TB2-IDX, TB4-M-IDX)          24150000
296800                          TO  PL-MO-QTY(PL-IDX)                   24160000
296900     END-PERFORM.                                                 24170000
297000     MOVE PL-PRINT-LINE-TABLE     TO  DL2-MO-DATA-2.              24180000
297100                                                                  24190000
297200     ADD  TB4-DLR-REV(PV-TB2-IDX) TO  PV-GC-DLR-REV.              24200000
297300     MOVE TB4-DLR-REV(PV-TB2-IDX) TO  DL2-REV-QTY-2.              24210000
297400                                                                  24220000
297500     COMPUTE PV-DLR-NET-REV = TB4-DLR-URDMD-AV(PV-TB2-IDX)        24230000
297600                        + (TB4-DLR-REV(PV-TB2-IDX) * -1).         24240000
297700     MOVE PV-DLR-NET-REV          TO  DL2-NET-REV-QTY-2           24250000
297800                                      PV-PARTIAL-DLR.             24260000
297900                                                                  24270000
298000     PERFORM 5100-CALCULATE-DLR-PERCENT.                          24280000
?FIX01*    MOVE  PV-PERCENT-SHIFTED       TO DL1-URDMD-PERCENT-1.       24290000
298200                                                                  24300000
298300     MOVE DL1-DETAIL-LINE-1       TO  PV-PRINT-RECORD.            24310000
298400     MOVE +1                      TO  PV-LINE-SPACING.            24320000
298500     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         24330000
298600                                                                  24340000
298700     MOVE DL2-DETAIL-LINE-2       TO  PV-PRINT-RECORD.            24350000
298800     MOVE +1                      TO  PV-LINE-SPACING.            24360000
298900     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         24370000
299000                                                                  24380000
299100                                                                  24390000
299200******************************************************************24400000
299300* 3500-PRINT-PART2-RPT2-DET-LINE                                  24410000
299400*  THIS PARAGRAPH WILL PRINT THE REPORT 2 COUNT DETAIL LINE.      24420000
299500******************************************************************24430000
299600 3500-PRINT-PART2-RPT2-DET-LINE.                                  24440000
299700                                                                  24450000
299800     IF (PV-SVKRP007-2-LINE-CNT + 2) > PC-LINE-LIMIT              24460000
299900         PERFORM 8500-PRINT-RPT2-HEADINGS                         24470000
300000     END-IF.                                                      24480000
300100                                                                  24490000
300200     MOVE BL-BLANK-LINE      TO  PV-PRINT-RECORD.                 24500000
300300     MOVE +1                 TO PV-LINE-SPACING.                  24510000
300400     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         24520000
300500                                                                  24530000
300600     MOVE TB2-FISCAL-PER-ABBR(PV-TB2-IDX) TO DL1B-MO-1.           24540000
300700     MOVE TB2-FISCAL-CCYY(PV-TB2-IDX)  TO  DL1B-YR-1.             24550000
300800                                                                  24560000
300900     ADD  TB2-CNT-PRIOR(PV-TB2-IDX) TO PV-TOT-CNT-PRIOR.          24570000
301000     MOVE TB2-CNT-PRIOR(PV-TB2-IDX) TO DL1B-PRIOR-QTY-1.          24580000
301100                                                                  24590000
301200     PERFORM                                                      24600000
301300       VARYING TB2-M-IDX FROM +1 BY +1                            24610000
301400       UNTIL TB2-M-IDX > +6                                       24620000
301500         SET PL2-IDX      TO TB2-M-IDX                            24630000
301600         SET PV-TOT-IDX   TO TB2-M-IDX                            24640000
301700         ADD  TB2-CNT-MO-QTY (PV-TB2-IDX, TB2-M-IDX)              24650000
301800                                 TO PV-TOT-CNT-MO-QTY(PV-TOT-IDX) 24660000
301900         MOVE TB2-CNT-MO-QTY (PV-TB2-IDX, TB2-M-IDX)              24670000
302000                                 TO PL2-MO-QTY(PL2-IDX)           24680000
302100     END-PERFORM.                                                 24690000
302200     MOVE PL2-PRINT-LINE-TABLE    TO DL1B-MO-DATA-1.              24700000
302300                                                                  24710000
302400     ADD  TB2-CNT-ISSUED(PV-TB2-IDX) TO PV-TOT-CNT-ISSUED         24720000
302500     MOVE TB2-CNT-ISSUED(PV-TB2-IDX) TO DL1B-ISSUED-QTY-1         24730000
302600                                      PV-TOTAL-CNT.               24740000
302700                                                                  24750000
302800     ADD  TB2-CNT-URDMD-AV(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-AV.    24760000
302900     MOVE TB2-CNT-URDMD-AV(PV-TB2-IDX) TO DL1B-URDMD-AV-QTY-1     24770000
303000                                        PV-PARTIAL-CNT.           24780000
303100                                                                  24790000
303200     PERFORM 5300-CALCULATE-CNT-PERCENT.                          24800000
?FIX01*    MOVE PV-PERCENT-SHIFTED TO  DL1B-URDMD-PERCENT-1.            24810000
303400                                                                  24820000
303500     ADD  TB2-CNT-URDMD-HQ(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-HQ.    24830000
303600     MOVE TB2-CNT-URDMD-HQ(PV-TB2-IDX) TO DL1B-URDMD-HQ-QTY-1.    24840000
303700                                                                  24850000
303800     ADD  TB2-CNT-URDMD-IN(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-IN.    24860000
303900     MOVE TB2-CNT-URDMD-IN(PV-TB2-IDX) TO DL1B-URDMD-IN-QTY-1.    24870000
304000                                                                  24880000
304100     ADD  TB2-CNT-URDMD-OTR(PV-TB2-IDX) TO PV-TOT-CNT-URDMD-OTR.  24890000
304200     MOVE TB2-CNT-URDMD-OTR(PV-TB2-IDX) TO DL1B-URDMD-OTR-QTY-1.  24900000
304300                                                                  24910000
304400     MOVE DL1B-DETAIL-LINE-1      TO  PV-PRINT-RECORD.            24920000
304500     MOVE +1                      TO  PV-LINE-SPACING.            24930000
304600     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         24940000
304700                                                                  24950000
304800     ADD  TB2-CNT-REV-PRIOR(PV-TB2-IDX) TO PV-TOT-CNT-REV-PRIOR.  24960000
304900     MOVE TB2-CNT-REV-PRIOR(PV-TB2-IDX) TO DL2B-REV-PRIOR-QTY-2.  24970000
305000                                                                  24980000
305100     PERFORM                                                      24990000
305200       VARYING TB2-M-IDX FROM +1 BY +1                            25000000
305300       UNTIL TB2-M-IDX > +6                                       25010000
305400         SET PL2-IDX      TO TB2-M-IDX                            25020000
305500         SET PV-TOT-IDX   TO TB2-M-IDX                            25030000
305600         ADD  TB2-CNT-REV-MO-QTY (PV-TB2-IDX, TB2-M-IDX)          25040000
305700                          TO PV-TOT-CNT-REV-MO-QTY(PV-TOT-IDX)    25050000
305800         MOVE TB2-CNT-REV-MO-QTY (PV-TB2-IDX, TB2-M-IDX)          25060000
305900                          TO PL2-MO-QTY(PL2-IDX)                  25070000
306000     END-PERFORM.                                                 25080000
306100     MOVE PL2-PRINT-LINE-TABLE    TO DL2B-MO-DATA-2.              25090000
306200                                                                  25100000
306300     MOVE DL2B-DETAIL-LINE-2      TO  PV-PRINT-RECORD.            25110000
306400     MOVE +1                      TO  PV-LINE-SPACING.            25120000
306500     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         25130000
306600                                                                  25140000
306700******************************************************************25150000
306800* 3600-PRINT-PART2-RPT2-GC-LINE                                   25160000
306900*  THIS PARAGRAPH WILL PRINT THE REPORT 2 COUNT GC DETAIL LINE.   25170000
307000******************************************************************25180000
307100 3600-PRINT-PART2-RPT2-GC-LINE.                                   25190000
307200                                                                  25200000
307300     IF (PV-SVKRP007-2-LINE-CNT + 2) > PC-LINE-LIMIT              25210000
307400         PERFORM 8500-PRINT-RPT2-HEADINGS                         25220000
307500     END-IF.                                                      25230000
307600                                                                  25240000
307700     MOVE BL-BLANK-LINE      TO  PV-PRINT-RECORD.                 25250000
307800     MOVE +1                 TO PV-LINE-SPACING.                  25260000
307900     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         25270000
308000                                                                  25280000
308100     MOVE TB4-FISCAL-PER-ABBR(PV-TB2-IDX) TO DL1B-MO-1.           25290000
308200     MOVE TB4-FISCAL-CCYY(PV-TB2-IDX)  TO  DL1B-YR-1.             25300000
308300                                                                  25310000
308400     ADD  TB4-CNT-PRIOR(PV-TB2-IDX) TO PV-GC-CNT-PRIOR.           25320000
308500     MOVE TB4-CNT-PRIOR(PV-TB2-IDX) TO DL1B-PRIOR-QTY-1.          25330000
308600                                                                  25340000
308700     PERFORM                                                      25350000
308800       VARYING TB4-M-IDX FROM +1 BY +1                            25360000
308900       UNTIL TB4-M-IDX > +6                                       25370000
309000         SET PL2-IDX      TO TB4-M-IDX                            25380000
309100         SET PV-GC-IDX    TO TB4-M-IDX                            25390000
309200         ADD  TB4-CNT-MO-QTY (PV-TB2-IDX, TB4-M-IDX)              25400000
309300                           TO PV-GC-CNT-MO-QTY(PV-GC-IDX)         25410000
309400         MOVE TB4-CNT-MO-QTY (PV-TB2-IDX, TB4-M-IDX)              25420000
309500                                 TO PL2-MO-QTY(PL2-IDX)           25430000
309600     END-PERFORM.                                                 25440000
309700     MOVE PL2-PRINT-LINE-TABLE    TO DL1B-MO-DATA-1.              25450000
309800                                                                  25460000
309900     ADD  TB4-CNT-ISSUED(PV-TB2-IDX) TO PV-GC-CNT-ISSUED          25470000
310000     MOVE TB4-CNT-ISSUED(PV-TB2-IDX) TO DL1B-ISSUED-QTY-1         25480000
310100                                      PV-TOTAL-CNT.               25490000
310200                                                                  25500000
310300     ADD  TB4-CNT-URDMD-AV(PV-TB2-IDX) TO PV-GC-CNT-URDMD-AV.     25510000
310400     MOVE TB4-CNT-URDMD-AV(PV-TB2-IDX) TO DL1B-URDMD-AV-QTY-1     25520000
310500                                        PV-PARTIAL-CNT.           25530000
310600                                                                  25540000
310700     PERFORM 5300-CALCULATE-CNT-PERCENT.                          25550000
?FIX01*    MOVE PV-PERCENT-SHIFTED TO  DL1B-URDMD-PERCENT-1.            25560000
310900                                                                  25570000
311000     ADD  TB4-CNT-URDMD-HQ(PV-TB2-IDX) TO PV-GC-CNT-URDMD-HQ.     25580000
311100     MOVE TB4-CNT-URDMD-HQ(PV-TB2-IDX) TO DL1B-URDMD-HQ-QTY-1.    25590000
311200                                                                  25600000
311300     ADD  TB4-CNT-URDMD-IN(PV-TB2-IDX) TO PV-GC-CNT-URDMD-IN.     25610000
311400     MOVE TB4-CNT-URDMD-IN(PV-TB2-IDX) TO DL1B-URDMD-IN-QTY-1.    25620000
311500                                                                  25630000
311600     ADD  TB4-CNT-URDMD-OTR(PV-TB2-IDX) TO PV-GC-CNT-URDMD-OTR.   25640000
311700     MOVE TB4-CNT-URDMD-OTR(PV-TB2-IDX) TO DL1B-URDMD-OTR-QTY-1.  25650000
311800                                                                  25660000
311900     MOVE DL1B-DETAIL-LINE-1      TO  PV-PRINT-RECORD.            25670000
312000     MOVE +1                      TO  PV-LINE-SPACING.            25680000
312100     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         25690000
312200                                                                  25700000
312300     ADD  TB4-CNT-REV-PRIOR(PV-TB2-IDX) TO PV-GC-CNT-REV-PRIOR.   25710000
312400     MOVE TB4-CNT-REV-PRIOR(PV-TB2-IDX) TO DL2B-REV-PRIOR-QTY-2.  25720000
312500                                                                  25730000
312600     PERFORM                                                      25740000
312700       VARYING TB4-M-IDX FROM +1 BY +1                            25750000
312800       UNTIL TB4-M-IDX > +6                                       25760000
312900         SET PL2-IDX      TO TB4-M-IDX                            25770000
313000         SET PV-GC-IDX    TO TB4-M-IDX                            25780000
313100         ADD  TB4-CNT-REV-MO-QTY (PV-TB2-IDX, TB4-M-IDX)          25790000
313200                        TO PV-GC-CNT-REV-MO-QTY(PV-GC-IDX)        25800000
313300         MOVE TB4-CNT-REV-MO-QTY (PV-TB2-IDX, TB4-M-IDX)          25810000
313400                          TO PL2-MO-QTY(PL2-IDX)                  25820000
313500     END-PERFORM.                                                 25830000
313600     MOVE PL2-PRINT-LINE-TABLE    TO DL2B-MO-DATA-2.              25840000
313700                                                                  25850000
313800     MOVE DL2B-DETAIL-LINE-2      TO  PV-PRINT-RECORD.            25860000
313900     MOVE +1                      TO  PV-LINE-SPACING.            25870000
314000     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         25880000
314100                                                                  25890000
320600******************************************************************25900000
320700* 4000-FORMAT-RPT1-HEADINGS                                       25910000
320800*  MOVE HEADING DESCRIPTIONS SPECIFIC TO THE DOLLARS REPORT.      25920000
320900******************************************************************25930000
321000 4000-FORMAT-RPT1-HEADINGS.                                       25940000
321100                                                                  25950000
321200     MOVE PC-H2-DESC-DOLLARS     TO  H2-RPT-DESC.                 25960000
321300     MOVE PC-H4-DESC-1-DOLLARS   TO  H4-RPT-DESC-1.               25970000
321400     MOVE PC-H4-DESC-2-DOLLARS   TO  H4-RPT-DESC-2.               25980000
321500     MOVE PC-H4-DESC-3-DOLLARS   TO  H4-RPT-DESC-3.               25990000
321600                                                                  26000000
321700******************************************************************26010000
321800* 4100-FORMAT-RPT2-HEADINGS                                       26020000
321900*  MOVE HEADING DESCRIPTIONS SPECIFIC TO THE COUNTS REPORT.       26030000
322000******************************************************************26040000
322100 4100-FORMAT-RPT2-HEADINGS.                                       26050000
322200                                                                  26060000
322300     MOVE PC-H2-DESC-COUNTS      TO  H2-RPT-DESC.                 26070000
322400     MOVE PC-H4-DESC-1-COUNTS    TO  H4-RPT-DESC-1.               26080000
322500     MOVE PC-H4-DESC-2-COUNTS    TO  H4-RPT-DESC-2.               26090000
322600     MOVE PC-H4-DESC-3-COUNTS    TO  H4-RPT-DESC-3.               26100000
322700                                                                  26110000
322800******************************************************************26120000
322900* 4700-PRINT-RPT1-TOTAL-LINE                                      26130000
323000*  THIS PARAGRAPH WILL PRINT A REPORT DOLLAR TOTAL LINE.          26140000
323100******************************************************************26150000
323200 4700-PRINT-RPT1-TOTAL-LINE.                                      26160000
323300                                                                  26170000
323400     IF (PV-SVKRP007-1-LINE-CNT + 1) > PC-LINE-LIMIT              26180000
323500         PERFORM 8000-PRINT-RPT1-HEADINGS                         26190000
323600     END-IF.                                                      26200000
323700                                                                  26210000
323800     MOVE 'ECAUTH'           TO TL1-TOT-DESC.                     26220000
323900     MOVE '      -     '     TO TL1-EA-URDMD-HQ-QTY-1             26230000
324000                                TL1-EA-URDMD-IN-QTY-1             26240000
324100                                TL1-EA-URDMD-OTR-QTY-1.           26250000
324200     MOVE '        -       ' TO TL2-EA-NET-REV-QTY-2.             26260000
?FIX01*    MOVE '    -  '          TO TL1-EA-URDMD-PERCENT-1.           26270000
?FIX01*    MOVE SPACES             TO TL1-PERCENT.                      26280000
324500                                                                  26290000
324600     MOVE PV-EA-TOT-DLR-ISSUED TO TL1-ISSUED-QTY-1.               26300000
324700     ADD  PV-EA-TOT-DLR-ISSUED TO PV-GT-TOT-DLR-ISSUED.           26310000
324800                                                                  26320000
324900     MOVE PV-EA-TOT-DLR-PRIOR TO TL1-PRIOR-QTY-1.                 26330000
325000     ADD  PV-EA-TOT-DLR-PRIOR TO PV-GT-TOT-DLR-PRIOR              26340000
325100                                 PV-GT-PARTIAL-DLR.               26350000
325200     PERFORM                                                      26360000
325300       VARYING PV-EA-TOT-IDX FROM +1 BY +1                        26370000
325400       UNTIL PV-EA-TOT-IDX > +6                                   26380000
325500         SET PV-GT-TOT-IDX TO PV-EA-TOT-IDX                       26390000
325600         SET PL-IDX TO PV-EA-TOT-IDX                              26400000
325700         MOVE PV-EA-TOT-DLR-MO(PV-EA-TOT-IDX) TO PL-MO-QTY(PL-IDX)26410000
325800         ADD  PV-EA-TOT-DLR-MO(PV-EA-TOT-IDX) TO                  26420000
325900                                  PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) 26430000
326000         ADD  PV-EA-TOT-DLR-MO(PV-EA-TOT-IDX) TO                  26440000
326100                                  PV-GT-PARTIAL-DLR               26450000
326200     END-PERFORM.                                                 26460000
326300     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     26470000
326400                                                                  26480000
326500     MOVE UL-UNDER-LINE           TO  PV-PRINT-RECORD.            26490000
326600     MOVE +1                      TO  PV-LINE-SPACING.            26500000
326700     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         26510000
326800                                                                  26520000
326900     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            26530000
327000     MOVE +1                      TO  PV-LINE-SPACING.            26540000
327100     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         26550000
327200                                                                  26560000
?FIX01*    MOVE '% '               TO  TL1-PERCENT.                     26570000
327400     MOVE 'VERFYD'           TO  TL1-TOT-DESC.                    26580000
327500     MOVE PV-TOT-DLR-PRIOR   TO  TL1-PRIOR-QTY-1.                 26590000
327600     ADD  PV-TOT-DLR-PRIOR   TO PV-GT-TOT-DLR-PRIOR.              26600000
327700                                                                  26610000
327800     PERFORM                                                      26620000
327900       VARYING PV-TOT-IDX FROM +1 BY +1                           26630000
328000       UNTIL PV-TOT-IDX > +6                                      26640000
328100         SET PL-IDX TO PV-TOT-IDX                                 26650000
328200         SET PV-GT-TOT-IDX TO PV-TOT-IDX                          26660000
328300         MOVE PV-TOT-DLR-MO-QTY(PV-TOT-IDX) TO PL-MO-QTY(PL-IDX)  26670000
328400         ADD PV-TOT-DLR-MO-QTY(PV-TOT-IDX)  TO                    26680000
328500                                  PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) 26690000
328600     END-PERFORM.                                                 26700000
328700     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     26710000
328800                                                                  26720000
328900     MOVE PV-TOT-DLR-ISSUED       TO  TL1-ISSUED-QTY-1            26730000
329000                                      PV-TOTAL-DLR.               26740000
329100     ADD PV-TOT-DLR-ISSUED        TO PV-GT-TOT-DLR-ISSUED.        26750000
329200                                                                  26760000
329300     MOVE PV-TOT-DLR-URDMD-HQ     TO  TL1-URDMD-HQ-QTY-1.         26770000
329400                                                                  26780000
329500     MOVE PV-TOT-DLR-URDMD-IN     TO  TL1-URDMD-IN-QTY-1.         26790000
329600                                                                  26800000
329700     MOVE PV-TOT-DLR-URDMD-OTR    TO  TL1-URDMD-OTR-QTY-1.        26810000
329800     COMPUTE PV-DLR-NET-REV = PV-TOT-DLR-URDMD-AV                 26820000
329900                            + (PV-TOT-DLR-REV * -1).              26830000
330000                                                                  26840000
330100     MOVE PV-DLR-NET-REV          TO  TL2-NET-REV-QTY-2           26850000
330200                                      PV-PARTIAL-DLR.             26860000
330300                                                                  26870000
330400     PERFORM 5100-CALCULATE-DLR-PERCENT.                          26880000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1-URDMD-PERCENT-1.            26890000
330600                                                                  26900000
330700     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            26910000
330800     MOVE +1                      TO  PV-LINE-SPACING.            26920000
330900     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         26930000
331000                                                                  26940000
331100     MOVE 'TOTALS'                TO  TL1-TOT-DESC.               26950000
331200     MOVE PV-GT-TOT-DLR-PRIOR     TO  TL1-PRIOR-QTY-1.            26960000
331300     PERFORM                                                      26970000
331400       VARYING PV-GT-TOT-IDX FROM +1 BY +1                        26980000
331500       UNTIL PV-GT-TOT-IDX > +6                                   26990000
331600         SET PL-IDX TO PV-GT-TOT-IDX                              27000000
331700         MOVE PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) TO PL-MO-QTY(PL-IDX)27010000
331800     END-PERFORM.                                                 27020000
331900     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     27030000
332000     MOVE PV-GT-TOT-DLR-ISSUED    TO  TL1-ISSUED-QTY-1            27040000
332100                                      PV-TOTAL-DLR.               27050000
332200     MOVE PV-TOT-DLR-URDMD-HQ     TO  TL1-URDMD-HQ-QTY-1.         27060000
332300     MOVE PV-TOT-DLR-URDMD-IN     TO  TL1-URDMD-IN-QTY-1.         27070000
332400     MOVE PV-TOT-DLR-URDMD-OTR    TO  TL1-URDMD-OTR-QTY-1.        27080000
332500     COMPUTE PV-DLR-NET-REV = PV-DLR-NET-REV + PV-GT-PARTIAL-DLR. 27090000
332600                                                                  27100000
332700     MOVE PV-DLR-NET-REV          TO  TL2-NET-REV-QTY-2           27110000
332800                                      PV-PARTIAL-DLR.             27120000
332900                                                                  27130000
333000     PERFORM 5100-CALCULATE-DLR-PERCENT.                          27140000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1-URDMD-PERCENT-1.            27150000
333200                                                                  27160000
333300     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            27170000
333400     MOVE +1                      TO  PV-LINE-SPACING.            27180000
333500     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         27190000
333600                                                                  27200000
333700     MOVE PV-TOT-DLR-REV-PRIOR    TO  TL2-REV-PRIOR-QTY-2.        27210000
333800                                                                  27220000
333900     PERFORM                                                      27230000
334000       VARYING PV-TOT-IDX FROM +1 BY +1                           27240000
334100       UNTIL PV-TOT-IDX > +6                                      27250000
334200         SET PL-IDX TO PV-TOT-IDX                                 27260000
334300         MOVE PV-TOT-DLR-REV-MO-QTY(PV-TOT-IDX)                   27270000
334400                                  TO PL-MO-QTY(PL-IDX)            27280000
334500     END-PERFORM.                                                 27290000
334600     MOVE PL-PRINT-LINE-TABLE     TO TL2-MO-DATA-2.               27300000
334700                                                                  27310000
334800     MOVE PV-TOT-DLR-REV          TO  TL2-REV-QTY-2.              27320000
334900                                                                  27330000
335000     COMPUTE PV-TOT-DLR-URDMD-AV = PV-DLR-NET-REV +               27340000
335100                                   PV-TOT-DLR-REV.                27350000
335200     MOVE PV-TOT-DLR-URDMD-AV     TO  TL1-URDMD-AV-QTY-1.         27360000
335300                                                                  27370000
335400     MOVE TL2-TOTAL-LINE-2        TO  PV-PRINT-RECORD.            27380000
335500     MOVE +1                      TO  PV-LINE-SPACING.            27390000
335600     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         27400000
335700                                                                  27410000
335800     INITIALIZE PV-TOT-ACCUM-FIELDS                               27420000
335900                PV-EA-TOT-ACCUM-FIELDS                            27430000
336000                PV-GT-TOT-ACCUM-FIELDS                            27440000
336100                PV-GT-PARTIAL-DLR.                                27450000
336200                                                                  27460000
336300******************************************************************27470000
336400* 4800-PRINT-RPT1-GC-LINE                                         27480000
336500*  THIS PARAGRAPH WILL PRINT A REPORT DOLLAR TOTAL LINE.          27490000
336600******************************************************************27500000
336700 4800-PRINT-RPT1-GC-LINE.                                         27510000
336800                                                                  27520000
336900     IF (PV-SVKRP007-1-LINE-CNT + 1) > PC-LINE-LIMIT              27530000
337000         PERFORM 8000-PRINT-RPT1-HEADINGS                         27540000
337100     END-IF.                                                      27550000
337200                                                                  27560000
337300     MOVE 'ECAUTH'           TO TL1-TOT-DESC.                     27570000
337400     MOVE '        -       ' TO TL1-EA-ISSUED-QTY-1.              27580000
337500     MOVE '      -     '     TO TL1-EA-URDMD-HQ-QTY-1             27590000
337600                                TL1-EA-URDMD-IN-QTY-1             27600000
337700                                TL1-EA-URDMD-OTR-QTY-1.           27610000
337800     MOVE '        -       ' TO TL2-EA-NET-REV-QTY-2.             27620000
?FIX01*    MOVE '    -  '          TO TL1-EA-URDMD-PERCENT-1.           27630000
?FIX01*    MOVE SPACES             TO TL1-PERCENT.                      27640000
338100                                                                  27650000
338200     MOVE PV-EAK-TOT-DLR-ISSUED TO TL1-ISSUED-QTY-1.              27660000
338300     ADD  PV-EAK-TOT-DLR-ISSUED TO PV-GT-TOT-DLR-ISSUED.          27670000
338400                                                                  27680000
338500     MOVE PV-EAK-TOT-DLR-PRIOR TO TL1-PRIOR-QTY-1.                27690000
338600     ADD  PV-EAK-TOT-DLR-PRIOR TO PV-GT-TOT-DLR-PRIOR             27700000
338700                                  PV-GT-PARTIAL-DLR.              27710000
338800     PERFORM                                                      27720000
338900       VARYING PV-EAK-TOT-IDX FROM +1 BY +1                       27730000
339000       UNTIL PV-EAK-TOT-IDX > +6                                  27740000
339100         SET PV-GT-TOT-IDX TO PV-EAK-TOT-IDX                      27750000
339200         SET PL-IDX TO PV-EAK-TOT-IDX                             27760000
339300         MOVE PV-EAK-TOT-DLR-MO(PV-EAK-TOT-IDX) TO                27770000
339400                                  PL-MO-QTY(PL-IDX)               27780000
339500         ADD  PV-EAK-TOT-DLR-MO(PV-EAK-TOT-IDX) TO                27790000
339600                                  PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) 27800000
339700         ADD  PV-EAK-TOT-DLR-MO(PV-EAK-TOT-IDX) TO                27810000
339800                                  PV-GT-PARTIAL-DLR               27820000
339900     END-PERFORM.                                                 27830000
340000     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     27840000
340100                                                                  27850000
340200     MOVE UL-UNDER-LINE           TO  PV-PRINT-RECORD.            27860000
340300     MOVE +1                      TO  PV-LINE-SPACING.            27870000
340400     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         27880000
340500                                                                  27890000
340600     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            27900000
340700     MOVE +1                      TO  PV-LINE-SPACING.            27910000
340800     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         27920000
340900                                                                  27930000
?FIX01*    MOVE '% '                TO  TL1-PERCENT.                    27940000
341100     MOVE 'VERFYD'            TO  TL1-TOT-DESC.                   27950000
341200     MOVE PV-GC-DLR-PRIOR     TO  TL1-PRIOR-QTY-1.                27960000
341300     ADD  PV-GC-DLR-PRIOR     TO PV-GT-TOT-DLR-PRIOR.             27970000
341400                                                                  27980000
341500     PERFORM                                                      27990000
341600       VARYING PV-GC-IDX FROM +1 BY +1                            28000000
341700       UNTIL PV-GC-IDX > +6                                       28010000
341800         SET PL-IDX TO PV-GC-IDX                                  28020000
341900         SET PV-GT-TOT-IDX TO PV-GC-IDX                           28030000
342000         MOVE PV-GC-DLR-MO-QTY(PV-GC-IDX) TO     PL-MO-QTY(PL-IDX)28040000
342100         ADD PV-GC-DLR-MO-QTY(PV-GC-IDX)  TO                      28050000
342200                                PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX)   28060000
342300     END-PERFORM.                                                 28070000
342400     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     28080000
342500                                                                  28090000
342600     MOVE PV-GC-DLR-ISSUED        TO  TL1-ISSUED-QTY-1            28100000
342700                                      PV-TOTAL-DLR.               28110000
342800     ADD PV-GC-DLR-ISSUED         TO PV-GT-TOT-DLR-ISSUED.        28120000
342900                                                                  28130000
343000     COMPUTE PV-DLR-NET-REV = PV-GC-DLR-URDMD-AV                  28140000
343100                            + (PV-GC-DLR-REV * -1).               28150000
343200     MOVE PV-DLR-NET-REV          TO  TL2-NET-REV-QTY-2           28160000
343300                                      PV-PARTIAL-DLR.             28170000
343400                                                                  28180000
343500     PERFORM 5100-CALCULATE-DLR-PERCENT.                          28190000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1-URDMD-PERCENT-1.            28200000
343700     MOVE PV-GC-DLR-URDMD-HQ      TO  TL1-URDMD-HQ-QTY-1.         28210000
343800     MOVE PV-GC-DLR-URDMD-IN      TO  TL1-URDMD-IN-QTY-1.         28220000
343900     MOVE PV-GC-DLR-URDMD-OTR     TO  TL1-URDMD-OTR-QTY-1.        28230000
344000                                                                  28240000
344100     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            28250000
344200     MOVE +1                      TO  PV-LINE-SPACING.            28260000
344300     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         28270000
344400                                                                  28280000
344500     MOVE 'TOTALS'                TO  TL1-TOT-DESC.               28290000
344600     MOVE PV-GT-TOT-DLR-PRIOR     TO  TL1-PRIOR-QTY-1.            28300000
344700     PERFORM                                                      28310000
344800       VARYING PV-GT-TOT-IDX FROM +1 BY +1                        28320000
344900       UNTIL PV-GT-TOT-IDX > +6                                   28330000
345000         SET PL-IDX TO PV-GT-TOT-IDX                              28340000
345100         MOVE PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) TO PL-MO-QTY(PL-IDX)28350000
345200     END-PERFORM.                                                 28360000
345300     MOVE PL-PRINT-LINE-TABLE     TO TL1-MO-DATA-1.               28370000
345400     MOVE PV-GT-TOT-DLR-ISSUED    TO  TL1-ISSUED-QTY-1            28380000
345500                                      PV-TOTAL-DLR.               28390000
345600     MOVE PV-GC-DLR-URDMD-HQ      TO  TL1-URDMD-HQ-QTY-1.         28400000
345700     MOVE PV-GC-DLR-URDMD-IN      TO  TL1-URDMD-IN-QTY-1.         28410000
345800     MOVE PV-GC-DLR-URDMD-OTR     TO  TL1-URDMD-OTR-QTY-1.        28420000
345900     COMPUTE PV-DLR-NET-REV = PV-DLR-NET-REV + PV-GT-PARTIAL-DLR. 28430000
346000                                                                  28440000
346100     MOVE PV-DLR-NET-REV          TO  TL2-NET-REV-QTY-2           28450000
346200                                      PV-PARTIAL-DLR.             28460000
346300                                                                  28470000
346400     PERFORM 5100-CALCULATE-DLR-PERCENT.                          28480000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1-URDMD-PERCENT-1.            28490000
346600                                                                  28500000
346700     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            28510000
346800     MOVE +1                      TO  PV-LINE-SPACING.            28520000
346900     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         28530000
347000                                                                  28540000
347100     MOVE PV-GC-DLR-REV-PRIOR      TO  TL2-REV-PRIOR-QTY-2.       28550000
347200                                                                  28560000
347300     PERFORM                                                      28570000
347400       VARYING PV-GC-IDX FROM +1 BY +1                            28580000
347500       UNTIL PV-GC-IDX > +6                                       28590000
347600         SET PL-IDX TO PV-GC-IDX                                  28600000
347700         MOVE PV-GC-DLR-REV-MO-QTY(PV-GC-IDX)                     28610000
347800                                  TO PL-MO-QTY(PL-IDX)            28620000
347900     END-PERFORM.                                                 28630000
348000     MOVE PL-PRINT-LINE-TABLE     TO TL2-MO-DATA-2.               28640000
348100     COMPUTE PV-GC-DLR-URDMD-AV = PV-DLR-NET-REV +                28650000
348200                                  PV-GC-DLR-REV.                  28660000
348300     MOVE PV-GC-DLR-URDMD-AV      TO  TL1-URDMD-AV-QTY-1.         28670000
348400                                                                  28680000
348500     MOVE PV-GC-DLR-REV           TO  TL2-REV-QTY-2.              28690000
348600                                                                  28700000
348700     MOVE TL2-TOTAL-LINE-2        TO  PV-PRINT-RECORD.            28710000
348800     MOVE +1                      TO  PV-LINE-SPACING.            28720000
348900     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         28730000
349000                                                                  28740000
349100     INITIALIZE PV-GC-ACCUM-FIELDS                                28750000
349200                PV-AC-TOT-ACCUM-FIELDS                            28760000
349300                PV-GT-TOT-ACCUM-FIELDS                            28770000
349400                PV-GT-PARTIAL-DLR.                                28780000
349500                                                                  28790000
349600******************************************************************28800000
349700* 4900-PRINT-RPT2-TOTAL-LINE                                      28810000
349800*  THIS PARAGRAPH WILL PRINT A REPORT COUNT TOTAL LINE.           28820000
349900******************************************************************28830000
350000 4900-PRINT-RPT2-TOTAL-LINE.                                      28840000
350100                                                                  28850000
350200     IF (PV-SVKRP007-2-LINE-CNT + 1) > PC-LINE-LIMIT              28860000
350300         PERFORM 8500-PRINT-RPT2-HEADINGS                         28870000
350400     END-IF.                                                      28880000
350500                                                                  28890000
350600     MOVE PV-TOT-CNT-PRIOR   TO  TL1B-PRIOR-QTY-1.                28900000
350700                                                                  28910000
350800     PERFORM                                                      28920000
350900       VARYING PV-TOT-IDX FROM +1 BY +1                           28930000
351000       UNTIL PV-TOT-IDX > +6                                      28940000
351100         SET PL2-IDX TO PV-TOT-IDX                                28950000
351200         MOVE PV-TOT-CNT-MO-QTY(PV-TOT-IDX) TO PL2-MO-QTY(PL2-IDX)28960000
351300     END-PERFORM.                                                 28970000
351400     MOVE PL2-PRINT-LINE-TABLE              TO TL1B-MO-DATA-1.    28980000
351500                                                                  28990000
351600     MOVE PV-TOT-CNT-ISSUED       TO  TL1B-ISSUED-QTY-1           29000000
351700                                      PV-TOTAL-CNT.               29010000
351800                                                                  29020000
351900     MOVE PV-TOT-CNT-URDMD-AV     TO  TL1B-URDMD-AV-QTY-1         29030000
352000                                      PV-PARTIAL-CNT.             29040000
352100                                                                  29050000
352200     PERFORM 5300-CALCULATE-CNT-PERCENT.                          29060000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1B-URDMD-PERCENT-1.           29070000
352400                                                                  29080000
352500     MOVE PV-TOT-CNT-URDMD-HQ     TO  TL1B-URDMD-HQ-QTY-1.        29090000
352600                                                                  29100000
352700     MOVE PV-TOT-CNT-URDMD-IN     TO  TL1B-URDMD-IN-QTY-1.        29110000
352800                                                                  29120000
352900     MOVE PV-TOT-CNT-URDMD-OTR    TO  TL1B-URDMD-OTR-QTY-1.       29130000
353000                                                                  29140000
353100     MOVE UL-UNDER-LINE           TO  PV-PRINT-RECORD.            29150000
353200     MOVE +1                      TO  PV-LINE-SPACING.            29160000
353300     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         29170000
353400                                                                  29180000
353500     MOVE TL1B-TOTAL-LINE-1       TO  PV-PRINT-RECORD.            29190000
353600     MOVE +1                      TO  PV-LINE-SPACING.            29200000
353700     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         29210000
353800                                                                  29220000
353900     MOVE PV-TOT-CNT-REV-PRIOR   TO  TL2B-REV-PRIOR-QTY-2.        29230000
354000                                                                  29240000
354100     PERFORM                                                      29250000
354200       VARYING PV-TOT-IDX FROM +1 BY +1                           29260000
354300       UNTIL PV-TOT-IDX > +6                                      29270000
354400         SET PL2-IDX TO PV-TOT-IDX                                29280000
354500         MOVE PV-TOT-CNT-REV-MO-QTY(PV-TOT-IDX)                   29290000
354600                                  TO PL2-MO-QTY(PL2-IDX)          29300000
354700     END-PERFORM.                                                 29310000
354800     MOVE PL2-PRINT-LINE-TABLE    TO TL2B-MO-DATA-2.              29320000
354900                                                                  29330000
355000     MOVE TL2B-TOTAL-LINE-2       TO  PV-PRINT-RECORD.            29340000
355100     MOVE +1                      TO  PV-LINE-SPACING.            29350000
355200     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         29360000
355300                                                                  29370000
355400     INITIALIZE PV-TOT-ACCUM-FIELDS.                              29380000
355500                                                                  29390000
355600******************************************************************29400000
355700* 5000-PRINT-RPT2-GC-LINE                                         29410000
355800*  THIS PARAGRAPH WILL PRINT A REPORT COUNT TOTAL LINE.           29420000
355900******************************************************************29430000
356000 5000-PRINT-RPT2-GC-LINE.                                         29440000
356100                                                                  29450000
356200     IF (PV-SVKRP007-2-LINE-CNT + 1) > PC-LINE-LIMIT              29460000
356300         PERFORM 8500-PRINT-RPT2-HEADINGS                         29470000
356400     END-IF.                                                      29480000
356500                                                                  29490000
356600     MOVE PV-GC-CNT-PRIOR     TO  TL1B-PRIOR-QTY-1.               29500000
356700                                                                  29510000
356800     PERFORM                                                      29520000
356900      VARYING PV-GC-IDX FROM +1 BY +1                             29530000
357000      UNTIL PV-GC-IDX > +6                                        29540000
357100       SET PL2-IDX TO PV-GC-IDX                                   29550000
357200       MOVE PV-GC-CNT-MO-QTY(PV-GC-IDX) TO     PL2-MO-QTY(PL2-IDX)29560000
357300     END-PERFORM.                                                 29570000
357400     MOVE PL2-PRINT-LINE-TABLE              TO TL1B-MO-DATA-1.    29580000
357500                                                                  29590000
357600     MOVE PV-GC-CNT-ISSUED         TO  TL1B-ISSUED-QTY-1          29600000
357700                                       PV-TOTAL-CNT.              29610000
357800                                                                  29620000
357900     MOVE PV-GC-CNT-URDMD-AV       TO  TL1B-URDMD-AV-QTY-1        29630000
358000                                       PV-PARTIAL-CNT.            29640000
358100                                                                  29650000
358200     PERFORM 5300-CALCULATE-CNT-PERCENT.                          29660000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1B-URDMD-PERCENT-1.           29670000
358400                                                                  29680000
358500     MOVE PV-GC-CNT-URDMD-HQ       TO  TL1B-URDMD-HQ-QTY-1.       29690000
358600                                                                  29700000
358700     MOVE PV-GC-CNT-URDMD-IN       TO  TL1B-URDMD-IN-QTY-1.       29710000
358800                                                                  29720000
358900     MOVE PV-GC-CNT-URDMD-OTR      TO  TL1B-URDMD-OTR-QTY-1.      29730000
359000                                                                  29740000
359100     MOVE UL-UNDER-LINE           TO  PV-PRINT-RECORD.            29750000
359200     MOVE +1                      TO  PV-LINE-SPACING.            29760000
359300     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         29770000
359400                                                                  29780000
359500     MOVE TL1B-TOTAL-LINE-1       TO  PV-PRINT-RECORD.            29790000
359600     MOVE +1                      TO  PV-LINE-SPACING.            29800000
359700     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         29810000
359800                                                                  29820000
359900     MOVE PV-GC-CNT-REV-PRIOR     TO  TL2B-REV-PRIOR-QTY-2.       29830000
360000                                                                  29840000
360100     PERFORM                                                      29850000
360200       VARYING PV-GC-IDX FROM +1 BY +1                            29860000
360300       UNTIL PV-GC-IDX > +6                                       29870000
360400         SET PL2-IDX TO PV-GC-IDX                                 29880000
360500         MOVE PV-GC-CNT-REV-MO-QTY(PV-GC-IDX)                     29890000
360600                                  TO PL2-MO-QTY(PL2-IDX)          29900000
360700     END-PERFORM.                                                 29910000
360800     MOVE PL2-PRINT-LINE-TABLE    TO TL2B-MO-DATA-2.              29920000
360900                                                                  29930000
361000     MOVE TL2B-TOTAL-LINE-2       TO  PV-PRINT-RECORD.            29940000
361100     MOVE +1                      TO  PV-LINE-SPACING.            29950000
361200     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         29960000
361300                                                                  29970000
361400     INITIALIZE PV-GC-ACCUM-FIELDS.                               29980000
361500                                                                  29990000
361600******************************************************************30000000
361700* 5050-PRINT-RPT1-ALLCARDS-TOTAL                                 *30010000
361800*  THIS PARAGRAPH WILL PRINT THE ALL CARDS TOTAL LINE.           *30020000
361900******************************************************************30030000
362000 5050-PRINT-RPT1-ALLCARDS-TOTAL.                                  30040000
362100                                                                  30050000
362200     IF (PV-SVKRP007-1-LINE-CNT + 1) > PC-LINE-LIMIT              30060000
362300         PERFORM 8000-PRINT-RPT1-HEADINGS                         30070000
362400     END-IF.                                                      30080000
362500                                                                  30090000
362600     MOVE 'ECAUTH'           TO TL1-TOT-DESC.                     30100000
362700     MOVE '      -     '     TO TL1-EA-URDMD-HQ-QTY-1             30110000
362800                                TL1-EA-URDMD-IN-QTY-1             30120000
362900                                TL1-EA-URDMD-OTR-QTY-1.           30130000
363000     MOVE '        -       ' TO TL2-EA-NET-REV-QTY-2.             30140000
?FIX01*    MOVE '    -  '          TO TL1-EA-URDMD-PERCENT-1.           30150000
?FIX01*    MOVE SPACES             TO TL1-PERCENT.                      30160000
363300                                                                  30170000
363400     MOVE PV-AC-TOT-DLR-ISSUED TO TL1-ISSUED-QTY-1.               30180000
363500     ADD  PV-AC-TOT-DLR-ISSUED TO PV-GT-TOT-DLR-ISSUED.           30190000
363600                                                                  30200000
363700     MOVE PV-AC-TOT-DLR-PRIOR TO TL1-PRIOR-QTY-1.                 30210000
363800     ADD  PV-AC-TOT-DLR-PRIOR TO PV-GT-TOT-DLR-PRIOR              30220000
363900                                 PV-GT-PARTIAL-DLR.               30230000
364000     PERFORM                                                      30240000
364100       VARYING PV-AC-TOT-IDX FROM +1 BY +1                        30250000
364200       UNTIL PV-AC-TOT-IDX > +6                                   30260000
364300         SET PV-GT-TOT-IDX TO PV-AC-TOT-IDX                       30270000
364400         SET PL-IDX TO PV-AC-TOT-IDX                              30280000
364500         MOVE PV-AC-TOT-DLR-MO(PV-AC-TOT-IDX) TO PL-MO-QTY(PL-IDX)30290000
364600         ADD  PV-AC-TOT-DLR-MO(PV-AC-TOT-IDX) TO                  30300000
364700                                  PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) 30310000
364800         ADD  PV-AC-TOT-DLR-MO(PV-AC-TOT-IDX) TO                  30320000
364900                                  PV-GT-PARTIAL-DLR               30330000
365000     END-PERFORM.                                                 30340000
365100     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     30350000
365200                                                                  30360000
365300     MOVE UL-UNDER-LINE           TO  PV-PRINT-RECORD.            30370000
365400     MOVE +1                      TO  PV-LINE-SPACING.            30380000
365500     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         30390000
365600                                                                  30400000
365700     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            30410000
365800     MOVE +1                      TO  PV-LINE-SPACING.            30420000
365900     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         30430000
366000                                                                  30440000
?FIX01*    MOVE '% '               TO  TL1-PERCENT.                     30450000
366200     MOVE 'VERFYD'           TO  TL1-TOT-DESC.                    30460000
366300     MOVE PV-TOT-DLR-PRIOR   TO  TL1-PRIOR-QTY-1.                 30470000
366400     ADD  PV-TOT-DLR-PRIOR   TO PV-GT-TOT-DLR-PRIOR.              30480000
366500                                                                  30490000
366600     PERFORM                                                      30500000
366700       VARYING PV-TOT-IDX FROM +1 BY +1                           30510000
366800       UNTIL PV-TOT-IDX > +6                                      30520000
366900         SET PL-IDX TO PV-TOT-IDX                                 30530000
367000         SET PV-GT-TOT-IDX TO PV-TOT-IDX                          30540000
367100         MOVE PV-TOT-DLR-MO-QTY(PV-TOT-IDX) TO PL-MO-QTY(PL-IDX)  30550000
367200         ADD PV-TOT-DLR-MO-QTY(PV-TOT-IDX)  TO                    30560000
367300                                  PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) 30570000
367400     END-PERFORM.                                                 30580000
367500     MOVE PL-PRINT-LINE-TABLE               TO TL1-MO-DATA-1.     30590000
367600                                                                  30600000
367700     MOVE PV-TOT-DLR-ISSUED       TO  TL1-ISSUED-QTY-1            30610000
367800                                      PV-TOTAL-DLR.               30620000
367900     ADD PV-TOT-DLR-ISSUED        TO PV-GT-TOT-DLR-ISSUED.        30630000
368000                                                                  30640000
368100     MOVE PV-TOT-DLR-URDMD-HQ     TO  TL1-URDMD-HQ-QTY-1.         30650000
368200                                                                  30660000
368300     MOVE PV-TOT-DLR-URDMD-IN     TO  TL1-URDMD-IN-QTY-1.         30670000
368400                                                                  30680000
368500     MOVE PV-TOT-DLR-URDMD-OTR    TO  TL1-URDMD-OTR-QTY-1.        30690000
368600     COMPUTE PV-DLR-NET-REV = PV-TOT-DLR-URDMD-AV                 30700000
368700                            + (PV-TOT-DLR-REV * -1).              30710000
368800                                                                  30720000
368900     MOVE PV-DLR-NET-REV          TO  TL2-NET-REV-QTY-2           30730000
369000                                      PV-PARTIAL-DLR.             30740000
369100                                                                  30750000
369200     PERFORM 5100-CALCULATE-DLR-PERCENT.                          30760000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1-URDMD-PERCENT-1.            30770000
369400                                                                  30780000
369500     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            30790000
369600     MOVE +1                      TO  PV-LINE-SPACING.            30800000
369700     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         30810000
369800                                                                  30820000
369900     MOVE 'TOTALS'                TO  TL1-TOT-DESC.               30830000
370000     MOVE PV-GT-TOT-DLR-PRIOR     TO  TL1-PRIOR-QTY-1.            30840000
370100     PERFORM                                                      30850000
370200       VARYING PV-GT-TOT-IDX FROM +1 BY +1                        30860000
370300       UNTIL PV-GT-TOT-IDX > +6                                   30870000
370400         SET PL-IDX TO PV-GT-TOT-IDX                              30880000
370500         MOVE PV-GT-TOT-DLR-MO(PV-GT-TOT-IDX) TO PL-MO-QTY(PL-IDX)30890000
370600     END-PERFORM.                                                 30900000
370700     MOVE PL-PRINT-LINE-TABLE     TO TL1-MO-DATA-1.               30910000
370800     MOVE PV-GT-TOT-DLR-ISSUED    TO  TL1-ISSUED-QTY-1            30920000
370900                                      PV-TOTAL-DLR.               30930000
371000     MOVE PV-TOT-DLR-URDMD-HQ     TO  TL1-URDMD-HQ-QTY-1.         30940000
371100     MOVE PV-TOT-DLR-URDMD-OTR    TO  TL1-URDMD-OTR-QTY-1.        30950000
371200     COMPUTE PV-DLR-NET-REV = PV-DLR-NET-REV + PV-GT-PARTIAL-DLR. 30960000
371300                                                                  30970000
371400     MOVE PV-DLR-NET-REV          TO  TL2-NET-REV-QTY-2           30980000
371500                                      PV-PARTIAL-DLR.             30990000
371600                                                                  31000000
371700     PERFORM 5100-CALCULATE-DLR-PERCENT.                          31010000
?FIX01*    MOVE  PV-PERCENT-SHIFTED TO  TL1-URDMD-PERCENT-1.            31020000
371900                                                                  31030000
372000     MOVE TL1-TOTAL-LINE-1        TO  PV-PRINT-RECORD.            31040000
372100     MOVE +1                      TO  PV-LINE-SPACING.            31050000
372200     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         31060000
372300                                                                  31070000
372400     MOVE PV-TOT-DLR-REV-PRIOR    TO  TL2-REV-PRIOR-QTY-2.        31080000
372500                                                                  31090000
372600     PERFORM                                                      31100000
372700       VARYING PV-TOT-IDX FROM +1 BY +1                           31110000
372800       UNTIL PV-TOT-IDX > +6                                      31120000
372900         SET PL-IDX TO PV-TOT-IDX                                 31130000
373000         MOVE PV-TOT-DLR-REV-MO-QTY(PV-TOT-IDX)                   31140000
373100                                  TO PL-MO-QTY(PL-IDX)            31150000
373200     END-PERFORM.                                                 31160000
373300     MOVE PL-PRINT-LINE-TABLE     TO TL2-MO-DATA-2.               31170000
373400                                                                  31180000
373500     MOVE PV-TOT-DLR-REV          TO  TL2-REV-QTY-2.              31190000
373600                                                                  31200000
373700     COMPUTE PV-TOT-DLR-URDMD-AV = PV-DLR-NET-REV +               31210000
373800                                   PV-TOT-DLR-REV.                31220000
373900     MOVE PV-TOT-DLR-URDMD-AV     TO  TL1-URDMD-AV-QTY-1.         31230000
374000                                                                  31240000
374100     MOVE TL2-TOTAL-LINE-2        TO  PV-PRINT-RECORD.            31250000
374200     MOVE +1                      TO  PV-LINE-SPACING.            31260000
374300     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         31270000
374400                                                                  31280000
374500     INITIALIZE PV-TOT-ACCUM-FIELDS                               31290000
374600                PV-EA-TOT-ACCUM-FIELDS                            31300000
374700                PV-GT-TOT-ACCUM-FIELDS                            31310000
374800                PV-GT-PARTIAL-DLR.                                31320000
374900                                                                  31330000
375000******************************************************************31340000
375100* 5100-CALCULATE-DLR-PERCENT                                      31350000
375200*  CHECK FOR ZERO TOTAL QUANTITY TO PREVENT DIVIDING BY ZERO.     31360000
375300*  CALCULATE A PERCENTAGE OF A TOTAL DOLLAR QUANTITY.             31370000
375400******************************************************************31380000
375500 5100-CALCULATE-DLR-PERCENT.                                      31390000
375600                                                                  31400000
375700     IF PV-TOTAL-DLR = ZERO                                       31410000
375800         MOVE ZERO TO PV-PERCENT-SHIFTED                          31420000
375900     ELSE                                                         31430000
376000         COMPUTE PV-PERCENT-DECIMAL ROUNDED =                     31440000
376100             PV-PARTIAL-DLR / PV-TOTAL-DLR                        31450000
376200         PERFORM 5500-SHIFT-PERCENT-DECIMAL-PT                    31460000
376300     END-IF.                                                      31470000
376400                                                                  31480000
376500******************************************************************31490000
376600* 5300-CALCULATE-CNT-PERCENT                                      31500000
376700*  CHECK FOR ZERO TOTAL QUANTITY TO PREVENT DIVIDING BY ZERO.     31510000
376800*  CALCULATE A PERCENTAGE OF A TOTAL COUNT QUANTITY.              31520000
376900******************************************************************31530000
377000 5300-CALCULATE-CNT-PERCENT.                                      31540000
377100                                                                  31550000
377200     IF  PV-TOTAL-CNT = ZERO                                      31560000
377300         MOVE ZERO TO PV-PERCENT-SHIFTED                          31570000
377400     ELSE                                                         31580000
377500         COMPUTE PV-PERCENT-DECIMAL ROUNDED =                     31590000
377600             PV-PARTIAL-CNT / PV-TOTAL-CNT                        31600000
377700         PERFORM 5500-SHIFT-PERCENT-DECIMAL-PT                    31610000
377800     END-IF.                                                      31620000
377900                                                                  31630000
378000******************************************************************31640000
378100* 5500-SHIFT-PERCENT-DECIMAL-PT                                   31650000
378200*  MULTIPLY BY 100 MAKING  1.23 123                               31660000
378300******************************************************************31670000
378400 5500-SHIFT-PERCENT-DECIMAL-PT.                                   31680000
378500                                                                  31690000
378600     COMPUTE PV-PERCENT-SHIFTED = PV-PERCENT-DECIMAL * 100.       31700000
378700                                                                  31710000
378800******************************************************************31720000
378900* 6000-FIND-FISCAL-PERIOD.                                        31730000
379000*  STARTING AT THE FIRST ENTRY IN TABLE 2, COMPARE THE INPUT ISSUE31740000
379100*  DATE WITH THE FIRST AND LAST DATES OF EACH ENTRY, UNTIL THE    31750000
379200*  TABLE ENTRY IS FOUND THAT HAS THE ISSUE DATE IN RANGE.         31760000
379300******************************************************************31770000
379400 6000-FIND-FISCAL-PERIOD.                                         31780000
379500                                                                  31790000
379600     SET PS-TABLE-2-DATE-NOT-FOUND TO TRUE.                       31800000
379700                                                                  31810000
379800     PERFORM                                                      31820000
379900       UNTIL PS-TABLE-2-DATE-FOUND                                31830000
380000         IF  PV-SAVE-ISSUE-DATE >= TB2-FISCAL-FST-DATE(PV-TB2-IDX)31840000
380100         AND PV-SAVE-ISSUE-DATE <= TB2-FISCAL-LST-DATE(PV-TB2-IDX)31850000
380200             SET PS-TABLE-2-DATE-FOUND TO TRUE                    31860000
380300             MOVE TB2-FISCAL-CCYYPP(PV-TB2-IDX)                   31870000
380400                                         TO PV-SAVE-ISSUE-CCYYPP  31880000
380500             MOVE TB2-FISCAL-PER-ABBR(PV-TB2-IDX)                 31890000
380600                                         TO PV-SAVE-PER-ABBR      31900000
380700             MOVE TB2-FISCAL-FST-DATE(PV-TB2-IDX)                 31910000
380800                                         TO PV-SAVE-FST-DATE      31920000
380900             MOVE TB2-FISCAL-LST-DATE(PV-TB2-IDX)                 31930000
381000                                         TO PV-SAVE-LST-DATE      31940000
381100             IF PV-TB2-IDX < PV-FIRST-STOCK-ENTRY                 31950000
381200                 MOVE PV-TB2-IDX TO PV-FIRST-STOCK-ENTRY          31960000
381300             END-IF                                               31970000
381400             IF PV-TB2-IDX > PV-LAST-STOCK-ENTRY                  31980000
381500                 MOVE PV-TB2-IDX TO PV-LAST-STOCK-ENTRY           31990000
381600             END-IF                                               32000000
381700             IF SV036-CRD-TYP-CDE = 2                             32010000
381800                 IF SV036-CRD-STK-TYP-ID = 'KCK'                  32020000
381900                     CONTINUE                                     32030000
382000                 ELSE                                             32040000
382100                     IF PV-TB2-IDX < PV-FIRST-GC-ENTRY            32050000
382200                         MOVE PV-TB2-IDX TO PV-FIRST-GC-ENTRY     32060000
382300                     END-IF                                       32070000
382400                     IF PV-TB2-IDX > PV-LAST-GC-ENTRY             32080000
382500                         MOVE PV-TB2-IDX TO PV-LAST-GC-ENTRY      32090000
382600                     END-IF                                       32100000
382700                 END-IF                                           32110000
382800             END-IF                                               32120000
382900         ELSE                                                     32130000
383000             PERFORM 6200-INCREMENT-TABLE-2                       32140000
383100         END-IF                                                   32150000
383200     END-PERFORM.                                                 32160000
383300                                                                  32170000
383400******************************************************************32180000
383500* 6200-INCREMENT-TABLE-2                                          32190000
383600*  INCREMENT PV-TB2-IDX TO POINT TO THE NEXT TABLE 2 ENTRY.       32200000
383700******************************************************************32210000
383800 6200-INCREMENT-TABLE-2.                                          32220000
383900                                                                  32230000
384000     COMPUTE PV-TB2-IDX = PV-TB2-IDX + 1.                         32240000
384100     IF PV-TB2-IDX > TB2-NBR-ENTRIES                              32250000
384200         MOVE '6200-INCREMENT-TABLE-2 '     TO PV-PARAGRAPH-NAME  32260000
384300         MOVE 'TABLE 2 INDEX EXCEEDED MAX ENTRIES  '              32270000
384400                                            TO PV-OPERATION-MSG-1 32280000
384500         SET AC-TABLE-OVERFLOW-ERROR        TO TRUE               32290000
384600         PERFORM 9999-ABEND                                       32300000
384700     END-IF.                                                      32310000
384800                                                                  32320000
384900******************************************************************32330000
385000* 7000-READ-ACTIVITY-FILE                                         32340000
385100*  READ THE CARD ACTIVITY RECORDS.                                32350000
385200******************************************************************32360000
385300 7000-READ-ACTIVITY-FILE.                                         32370000
385400                                                                  32380000
385500     READ ACTIVITY-FILE INTO SV036-RECORD                         32390000
385600         AT END                                                   32400000
385700           SET PS-END-OF-ACTVY-FILE TO TRUE.                      32410000
385800                                                                  32420000
385900     IF NOT PS-END-OF-ACTVY-FILE                                  32430000
386000         ADD +1 TO PV-DISPLAY-ACTIVITY-REC-CNT                    32440000
386100     END-IF.                                                      32450000
386200                                                                  32460000
389200******************************************************************32470000
389300* 7500-CREATE-BALANCE-RECORD                                      32480000
389400*  FORMAT THE REMAINING BALANCE RECORD.                           32490000
389500*  PERFORM A PARAGRAPH TO WRITE THE OUTPUT RECORD.                32500000
389600******************************************************************32510000
389700 7500-CREATE-BALANCE-RECORD.                                      32520000
389800                                                                  32530000
389900     MOVE SPACES                 TO SV003-RECORD.                 32540000
390000     MOVE PV-SAVE-CRD-NBR        TO SV003-CRD-NBR.                32550000
390100     IF PV-SAVE-CRD-STK-TYP = 'KCK     ' OR                       32560000
390200        PV-SAVE-CRD-STK-TYP = 'KMRC    '                          32570000
390300         MOVE PV-SAVE-CRD-STK-TYP    TO SV003-CRD-STK-TYP-ID      32580000
390400     ELSE                                                         32590000
390500         MOVE 'GIFTCARD'             TO SV003-CRD-STK-TYP-ID      32600000
390600     END-IF.                                                      32610000
390700                                                                  32620000
390800     IF PS-STATE-FOUND                                            32630000
390900         MOVE PV-SAVE-FEE-ST-CDE TO SV003-ST-CDE                  32640000
391000         MOVE PV-SAVE-FEE-MN-QTY TO SV003-ST-FEE-MONTH            32650000
391100     ELSE                                                         32660000
391200         IF PV-HOLD-FEE-MN-QTY > SV004-SRV-FEE-INACTIVE-PRD       32670000
391300             MOVE PV-HOLD-FEE-MN-QTY TO SV003-ST-FEE-MONTH        32680000
391400             MOVE PV-HOLD-ST-CDE     TO SV003-ST-CDE              32690000
391500         ELSE                                                     32700000
391600             MOVE SV004-SRV-FEE-INACTIVE-PRD TO SV003-ST-FEE-MONTH32710000
391700             MOVE PV-SAVE-ST-CDE     TO SV003-ST-CDE              32720000
391800         END-IF                                                   32730000
391900     END-IF.                                                      32740000
392000                                                                  32750000
392100     MOVE PV-SAVE-CRD-VALUE      TO SV003-BALANCE.                32760000
392200     MOVE PV-SAVE-CRD-LST-ACTVY-DTE                               32770000
392300                                 TO SV003-LST-ACTVY-DTE.          32780000
392400     PERFORM 7510-WRITE-BALANCE-RECORD.                           32790000
392500                                                                  32800000
392600******************************************************************32810000
392700* 7510-WRITE-BALANCE-RECORD                                       32820000
392800*  WRITE THE REMAINING BALANCE RECORD.                            32830000
392900******************************************************************32840000
393000 7510-WRITE-BALANCE-RECORD.                                       32850000
393100                                                                  32860000
393200     WRITE BALANCE-RECORD                                         32870000
393300         FROM SV003-RECORD.                                       32880000
393400                                                                  32890000
393500     IF PV-SAVE-CRD-VALUE LESS THAN 0                             32900000
393600         ADD +1 TO PV-DISPLAY-NEG-BAL-REC-CNT                     32910000
393700     END-IF.                                                      32920000
393800                                                                  32930000
393900     ADD +1 TO PV-DISPLAY-BALANCE-REC-CNT.                        32940000
394000                                                                  32950000
394100******************************************************************32960000
440200******************************************************************32970000
440300* 8000-PRINT-RPT1-HEADINGS                                        32980000
440400*  PRINT THE HEADINGS FOR REPORT 1.                               32990000
440500******************************************************************33000000
440600 8000-PRINT-RPT1-HEADINGS.                                        33010000
440700                                                                  33020000
440800     MOVE PC-REPORT-NBR-1        TO  DP200-REPORT-NUMBER.         33030000
440900     ADD +1                      TO PV-SVKRP007-1-PAGE-CNT.       33040000
441000     MOVE PV-SVKRP007-1-PAGE-CNT TO DP200-PAGE-NUMBER.            33050000
441100     MOVE DP200-STANDRD-HEADER-200-COLS                           33060000
441200                                 TO PV-PRINT-RECORD.              33070000
441300     PERFORM 8100-WRITE-RPT1-TOP-OF-PAGE.                         33080000
441400                                                                  33090000
441500     MOVE H2-HEADING-LINE-2      TO PV-PRINT-RECORD.              33100000
441600     MOVE +1                     TO PV-LINE-SPACING.              33110000
441700     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         33120000
441800                                                                  33130000
441900     IF H3-CRD-STK-DESC = PC-ALL-CARDS-DESC  OR                   33140000
442000                          PC-GIFT-CARDS-DESC                      33150000
442100         NEXT SENTENCE                                            33160000
442200     ELSE                                                         33170000
442300         MOVE SPACES             TO H3-CRD-STK-DESC               33180000
442400         STRING PV-SAVE-CRD-STK-TYP                               33190000
442500             DELIMITED BY SIZE                                    33200000
442600             ' - '                                                33210000
442700             PV-SAVE-CRD-STK-DESC                                 33220000
442800             DELIMITED BY SIZE                                    33230000
442900             INTO H3-CRD-STK-DESC                                 33240000
443000     END-IF.                                                      33250000
443100                                                                  33260000
443200     MOVE H3-HEADING-LINE-3      TO PV-PRINT-RECORD.              33270000
443300     MOVE +2                     TO PV-LINE-SPACING.              33280000
443400     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         33290000
443500                                                                  33300000
443600     MOVE H4-HEADING-LINE-4      TO PV-PRINT-RECORD.              33310000
443700     MOVE +2                     TO PV-LINE-SPACING.              33320000
443800     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         33330000
443900                                                                  33340000
444000     MOVE H5-HEADING-LINE-5      TO PV-PRINT-RECORD.              33350000
444100     MOVE +1                     TO PV-LINE-SPACING.              33360000
444200     PERFORM 8200-WRITE-RPT1-REPORT-LINE.                         33370000
444300                                                                  33380000
444400******************************************************************33390000
444500* 8100-WRITE-RPT1-TOP-OF-PAGE                                     33400000
444600*  WRITE FIRST REPORT LINE AFTER PAGE BREAK.                      33410000
444700******************************************************************33420000
444800 8100-WRITE-RPT1-TOP-OF-PAGE.                                     33430000
444900                                                                  33440000
445000     WRITE DOLLAR-REPORT-RECORD                                   33450000
445100       FROM PV-PRINT-RECORD                                       33460000
445200         AFTER ADVANCING PAGE.                                    33470000
445300     MOVE +1             TO PV-SVKRP007-1-LINE-CNT.               33480000
445400                                                                  33490000
445500******************************************************************33500000
445600* 8200-WRITE-RPT1-REPORT-LINE                                     33510000
445700*  WRITE REPORT LINE AFTER ADVANCING LINE SPACING.                33520000
445800******************************************************************33530000
445900 8200-WRITE-RPT1-REPORT-LINE.                                     33540000
446000                                                                  33550000
446100     WRITE DOLLAR-REPORT-RECORD                                   33560000
446200       FROM PV-PRINT-RECORD                                       33570000
446300         AFTER ADVANCING PV-LINE-SPACING.                         33580000
446400                                                                  33590000
446500     ADD PV-LINE-SPACING TO PV-SVKRP007-1-LINE-CNT.               33600000
446600                                                                  33610000
446700******************************************************************33620000
446800* 8500-PRINT-RPT2-HEADINGS                                        33630000
446900*  PRINT THE HEADINGS FOR REPORT 2.                               33640000
447000******************************************************************33650000
447100 8500-PRINT-RPT2-HEADINGS.                                        33660000
447200                                                                  33670000
447300     MOVE PC-REPORT-NBR-2        TO  DP200-REPORT-NUMBER.         33680000
447400     ADD +1                      TO PV-SVKRP007-2-PAGE-CNT.       33690000
447500     MOVE PV-SVKRP007-2-PAGE-CNT TO DP200-PAGE-NUMBER.            33700000
447600     MOVE DP200-STANDRD-HEADER-200-COLS                           33710000
447700                                 TO PV-PRINT-RECORD.              33720000
447800     PERFORM 8600-WRITE-RPT2-TOP-OF-PAGE.                         33730000
447900                                                                  33740000
448000     MOVE H2-HEADING-LINE-2      TO PV-PRINT-RECORD.              33750000
448100     MOVE +1                     TO PV-LINE-SPACING.              33760000
448200     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         33770000
448300                                                                  33780000
448400     IF H3-CRD-STK-DESC = PC-ALL-CARDS-DESC  OR                   33790000
448500                          PC-GIFT-CARDS-DESC                      33800000
448600         NEXT SENTENCE                                            33810000
448700     ELSE                                                         33820000
448800         MOVE SPACES             TO H3-CRD-STK-DESC               33830000
448900         STRING PV-SAVE-CRD-STK-TYP                               33840000
449000             DELIMITED BY SIZE                                    33850000
449100             ' - '                                                33860000
449200             PV-SAVE-CRD-STK-DESC                                 33870000
449300             DELIMITED BY SIZE                                    33880000
449400             INTO H3-CRD-STK-DESC                                 33890000
449500     END-IF.                                                      33900000
449600                                                                  33910000
449700     MOVE H3-HEADING-LINE-3      TO PV-PRINT-RECORD.              33920000
449800     MOVE +2                     TO PV-LINE-SPACING.              33930000
449900     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         33940000
450000                                                                  33950000
450100     MOVE H4-HEADING-LINE-4      TO PV-PRINT-RECORD.              33960000
450200     MOVE +2                     TO PV-LINE-SPACING.              33970000
450300     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         33980000
450400                                                                  33990000
450500     MOVE H5-HEADING-LINE-5      TO PV-PRINT-RECORD.              34000000
450600     MOVE +1                     TO PV-LINE-SPACING.              34010000
450700     PERFORM 8700-WRITE-RPT2-REPORT-LINE.                         34020000
450800                                                                  34030000
450900******************************************************************34040000
451000* 8600-WRITE-RPT2-TOP-OF-PAGE                                     34050000
451100*  WRITE FIRST REPORT LINE AFTER PAGE BREAK.                      34060000
451200******************************************************************34070000
451300 8600-WRITE-RPT2-TOP-OF-PAGE.                                     34080000
451400                                                                  34090000
451500     WRITE COUNT-REPORT-RECORD                                    34100000
451600       FROM PV-PRINT-RECORD                                       34110000
451700         AFTER ADVANCING PAGE.                                    34120000
451800     MOVE +1             TO PV-SVKRP007-2-LINE-CNT.               34130000
451900                                                                  34140000
452000******************************************************************34150000
452100* 8700-WRITE-RPT2-REPORT-LINE                                     34160000
452200*  WRITE REPORT LINE AFTER ADVANCING LINE SPACING.                34170000
452300******************************************************************34180000
452400 8700-WRITE-RPT2-REPORT-LINE.                                     34190000
452500                                                                  34200000
452600     WRITE COUNT-REPORT-RECORD                                    34210000
452700       FROM PV-PRINT-RECORD                                       34220000
452800         AFTER ADVANCING PV-LINE-SPACING.                         34230000
452900                                                                  34240000
453000     ADD PV-LINE-SPACING TO PV-SVKRP007-2-LINE-CNT.               34250000
453100                                                                  34260000
453200******************************************************************34270000
453300* 9000-CHECK-STATE-FEE-PERIOD                                    *34280000
453400* ==>                                                            *34290000
453500******************************************************************34300000
453600 9000-CHECK-STATE-FEE-PERIOD.                                     34310000
453700                                                                  34320000
453800     IF SV036-ST-CDE = TB5-ST-CDE (PV-SUB) AND                    34330000
453900        SV036-CRD-TYP-CDE = TB5-CRD-TYP-CDE (PV-SUB)              34340000
454000         SET PS-FEE-STATE-FOUND TO TRUE                           34350000
454100         IF TB5-FEE-MN-QTY (PV-SUB) = ZERO                        34360000
454200            SET PS-STATE-FOUND           TO TRUE                  34370000
454300         END-IF                                                   34380000
454400         MOVE TB5-FEE-MN-QTY (PV-SUB) TO PV-SAVE-FEE-MN-QTY       34390000
454500         MOVE SV036-ST-CDE            TO PV-SAVE-FEE-ST-CDE       34400000
454600         IF PV-SAVE-FEE-MN-QTY > PV-HOLD-FEE-MN-QTY               34410000
454700             MOVE PV-SAVE-FEE-MN-QTY TO PV-HOLD-FEE-MN-QTY        34420000
454800             MOVE PV-SAVE-FEE-ST-CDE TO PV-HOLD-ST-CDE            34430000
454900         END-IF                                                   34440000
455000     END-IF.                                                      34450000
455100     ADD +1 TO PV-SUB.                                            34460000
455200                                                                  34470000
455300******************************************************************34480000
455400* 9100-DETERMINE-CUTOFF-DATE                                     *34490000
455500* DETERMINE CUTOFF DATE FOR INACTIVE PERIOD                      *34500000
455600******************************************************************34510000
455700 9100-DETERMINE-CUTOFF-DATE.                                      34520000
455800                                                                  34530000
455900     IF PV-HOLD-FEE-MN-QTY <= SV004-SRV-FEE-INACTIVE-PRD          34540000
456000         MOVE PV-SRV-FEE-INACTIVE-PRD TO PV-FEE-CUTOFF-DATE       34550000
456100     ELSE                                                         34560000
456200         MOVE PV-HOLD-FEE-MN-QTY      TO PV-FEE-PERIODS           34570000
456300         MOVE PV-HOLD-ST-CDE          TO PV-SAVE-ST-CDE           34580000
456400         PERFORM 9200-DECREMENT-PERIOD                            34590000
456500         MOVE PV-FISCAL-PER-FST-DATE  TO PV-FEE-CUTOFF-DATE       34600000
456600     END-IF.                                                      34610000
456700                                                                  34620000
456800******************************************************************34630000
456900* 9200-DECREMENT-PERIOD.                                          34640000
457000* CALL KOHLS CALENDAR ROUTINE TO TAKE A 4-4-5 FISCAL YEAR AND     34650000
457100* FISCAL PERIOD (CCYYPP), DECREMENT THE FISCAL PERIOD, AND RETURN 34660000
457200* 4-4-5 (JAN - DEC) FISCAL DATE FIELDS FOR THE NEXT FEE PERIOD.   34670000
457300******************************************************************34680000
457400 9200-DECREMENT-PERIOD.                                           34690000
457500                                                                  34700000
457600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              34710000
457700                                                                  34720000
457800     SET DPG51-FISCAL-JAN-DEC-F2      TO TRUE.                    34730000
457900     SET DPG51-DECREMENT-DATE         TO TRUE.                    34740000
458000     MOVE PV-FEE-PERIODS              TO                          34750000
458100                                    DPG51-INCR-DECR-FISCAL-PRD-9. 34760000
458200     MOVE PV-MAX-CCYYPP               TO DPG52-LK-DATE-INPUT.     34770000
458300     SET DPG52-LK-DTE-FISC-PRD-CC     TO TRUE.                    34780000
458400                                                                  34790000
458500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    34800000
458600                                             DPG54 DPG55 DPG56.   34810000
458700     EVALUATE TRUE                                                34820000
458800         WHEN DPG54-SEVERE-ERROR                                  34830000
458900         WHEN DPG54-DATE-INVALID                                  34840000
459000             MOVE '9200-DECREMENT-PERIOD'  TO PV-PARAGRAPH-NAME   34850000
459100             MOVE 'ERROR PROCESSING FISCAL DATE'                  34860000
459200                                           TO PV-OPERATION-MSG-1  34870000
459300             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                34880000
459400             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  34890000
459500             PERFORM 9999-ABEND                                   34900000
459600     END-EVALUATE.                                                34910000
459700                                                                  34920000
459800     MOVE DPG56-FISCAL-YEAR-CCYY       TO PV-FISCAL-YEAR-CCYY.    34930000
459900     MOVE DPG56-FISCAL-PERIOD-NBR      TO PV-FISCAL-PER-NBR.      34940000
460000     MOVE DPG56-FIRST-FP-DB2-ISO-FMT   TO PV-FISCAL-PER-FST-DATE. 34950000
460100     MOVE DPG56-LAST-FP-DB2-ISO-FMT    TO PV-FISCAL-PER-LST-DATE. 34960000
460200                                                                  34970000
460300******************************************************************34980000
460400* 9999-ABEND - PERFORMS A NON-SQL-ABEND                           34990000
460500******************************************************************35000000
460600 9999-ABEND.                                                      35010000
460700     DISPLAY '** ABEND           **'.                             35020000
460800     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  35030000
460900     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        35040000
461000     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       35050000
461100     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       35060000
461200     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         35070000
461300                                                                  35080000
461400******************************************************************35090000
