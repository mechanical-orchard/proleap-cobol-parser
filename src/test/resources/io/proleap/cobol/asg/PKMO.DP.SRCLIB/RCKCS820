000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    RCKCS820.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  04-21-2003.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E820 - ADJUST PACKS VERIFIED BY STORE                      * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF ALL THE PACKS THAT ARE    * 00130000
001400*    ASSOCIATED TO A STORE BY SKU.  BY SELECTING ANY OF THESE   * 00140000
001500*    PACKS, THEY CAN BE 'UPDATED'.                              * 00150000
001600*                                                               * 00160000
001700*---------------------------------------------------------------* 00170000
001710* CHANGE HISTORY                                                * 00171002
001730*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00173001
001740*     DATE:    11/14/2014                                       * 00174001
001750*      RECOMPILE THE PROGRAM AS THE PO NUMBER FIELD IN THE      * 00175001
001760*      COPYBOOK TMWS001 IS INCREASED TO 9 FROM 7.               * 00176001
001770*---------------------------------------------------------------* 00177001
001790* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00179002
001791* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00179102
001792* MAKING THE CALL DYNAMIC VS STATIC.                              00179202
001793*---------------------------------------------------------------* 00179302
001800 EJECT                                                            00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500 01  DK-DB2-KEYS.                                                 00250000
002600     05  DK-OPER-UNT-ID                  PIC S9(04)  COMP SYNC.   00260000
002700     05  DK-FCLTY-ID                     PIC S9(04)  COMP SYNC.   00270000
002800     05  DK-PO-NBR                       PIC S9(09)  COMP SYNC.   00280000
002900     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP SYNC.   00290000
003000     05  DK-PO-DRIVER-LNE                PIC S9(09)  COMP SYNC.   00300000
003010     05  DK-LNE-NBR                      PIC S9(09)  COMP SYNC.   00301000
003020     05  DK-DRIVER-LNE-NBR               PIC S9(09)  COMP SYNC.   00302000
003030     05  DK-HOLD-LNE-NBR                 PIC S9(09)  COMP SYNC.   00303000
003040     05  DK-PREPK-ID                     PIC S9(04)  COMP SYNC.   00304000
003050     05  DK-UPDATE-PACK-ID               PIC S9(04)  COMP SYNC.   00305000
003060     05  DK-STR-NBR                      PIC S9(04)  COMP SYNC.   00306000
003070                                                                  00307000
003080 01  PC-PROGRAM-CONSTANTS.                                        00308000
003090     05  PC-TMKCS520              PIC  X(08)  VALUE  'TMKCS520'.  00309000
003100     05  PC-01-COMP                     PIC S9(4) COMP VALUE 1.   00310000
003200     05  PC-VRFY-ADJ-QUEUE-SEQ          PIC  9      VALUE 6.      00320000
003300     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00330000
003400                                                    'RC820A  '.   00340000
003500     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00350000
003600                                                    'RCKM820 '.   00360000
003700     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00370000
003710                                                    'RCKCS820'.   00371000
003720     05  PC-POST-VERIFY-PGM-NAME        PIC  X(08)  VALUE         00372000
003730                                                    'RCKPV820'.   00373000
003740     05  PC-PCKCS756                    PIC  X(08)  VALUE         00374000
003750                                                    'PCKCS756'.   00375000
003760     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00376000
003770                                                    'RCKCS290'.   00377000
003780     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE +300    00378000
003790                                                    COMP SYNC.    00379000
003800     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00380000
003900     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00390000
004000     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00400000
004100     05  PC-POST-VERFY-INTER-LIST-FMT   PIC  X(01)  VALUE '2'.    00410000
004200     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +8      00420000
004300                                                    COMP SYNC.    00430000
004400     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00440000
004500                                                    COMP SYNC.    00450000
004600     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00460000
004700                                                    +1000000      00470000
004800                                                    COMP-3.       00480000
004900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00490000
005000                                                    COMP SYNC.    00500000
005100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00510000
005200                                                    COMP-3.       00520000
005300     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00530000
005400     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00540000
005500     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00550000
005600     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00560000
005700     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00570000
005800     05  PC-DB2-DEFAULT-TMST            PIC  X(26)  VALUE         00580000
005900         '9999-09-09-09.09.09.999999'.                            00590000
006000     05  PC-TRBL-ALREADY-EXISTS-MSG     PIC  X(56)  VALUE         00600000
006100       'NNNNN-I-REQUESTED TRBL ALREADY EXISTS FOR PO OR PO LINE'. 00610000
006200                                                                  00620000
006300     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00630000
006400     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00640000
006500                                                    COMP SYNC.    00650000
006600                                                                  00660000
006700*                                                                 00670000
006800     05  PC-TSYMSG-NUMBERS.                                       00680000
006900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00690000
007000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00700000
007100         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  00710000
007200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00720000
007300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00730000
007400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00740000
007500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00750000
007600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00760000
007700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00770000
007800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00780000
007900         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  00790000
008000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00800000
008100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00810000
008200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00820000
008300         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00830000
008400         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00840000
008500         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  00850000
008600         10  PC-TSYMSG-01817            PIC  9(05)  VALUE 01817.  00860000
008700         10  PC-TSYMSG-02773            PIC  9(05)  VALUE 02773.  00870000
008800         10  PC-TSYMSG-02875            PIC  9(05)  VALUE 02875.  00880000
008900         10  PC-TSYMSG-03082            PIC  9(05)  VALUE 03082.  00890000
009000         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  00900000
009100         10  PC-TSYMSG-03180            PIC  9(05)  VALUE 03180.  00910000
009110         10  PC-TSYMSG-03233            PIC  9(05)  VALUE 03233.  00911000
009120         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00912000
009130*                                                                 00913000
009140 01  PS-PROGRAM-SWITCHES.                                         00914000
009150     05  PS-CHECK-FOR-RMS-PO-SW       PIC X(01) VALUE 'N'.        00915000
009160         88  PS-CHECKED-FOR-RMS-PO              VALUE 'Y'.        00916000
009170     05  PS-RMS-PO-SW                 PIC X(01) VALUE 'N'.        00917000
009180         88  PS-RMS-PO                          VALUE 'Y'.        00918000
009190         88  PS-NO-RMS-PO                       VALUE 'N'.        00919000
009200     05  PS-NO-DRIVER-INFO-SW           PIC  X(01)  VALUE 'Y'.    00920000
009300         88  PS-NO-DRIVER-INFO                      VALUE 'N'.    00930000
009400         88  PS-DRIVER-INFO                         VALUE 'Y'.    00940000
009500     05  PS-TABLE-LOADED-SW           PIC X.                      00950000
009600         88  PS-TABLE-LOADED                    VALUE 'Y'.        00960000
009700         88  PS-TABLE-NOT-LOADED                VALUE 'N'.        00970000
009800     05  PS-EOT-TRB-SW                PIC X.                      00980000
009810         88  PS-EOT-TRB-TABLE                   VALUE 'Y'.        00981000
009820         88  PS-NOT-EOT-TRB-TABLE               VALUE 'N'.        00982000
009830     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01) VALUE 'N'.        00983000
009840         88  PS-UNITS-WORKED-ERROR              VALUE 'Y'.        00984000
009850         88  PS-NO-UNITS-WORKED-ERROR           VALUE 'N'.        00985000
009860     05  PS-TRECDIS-UPDATE-SW         PIC X(01) VALUE 'N'.        00986000
009870         88  PS-TRECDIS-UPDATE-DONE             VALUE 'Y'.        00987000
009880         88  PS-TRECDIS-UPDATE-NOT-DONE         VALUE 'N'.        00988000
009890     05  PS-SMOOTHED-STORE-SW           PIC  X(01)  VALUE 'N'.    00989000
009900         88  PS-NO-SMOOTHED-STORE                   VALUE 'N'.    00990000
010000         88  PS-SMOOTHED-STORE                      VALUE 'Y'.    01000000
010100     05  PS-UPDATE-SW                   PIC  X(01)  VALUE 'N'.    01010000
010200         88  PS-NO-UPDATES-DONE                     VALUE 'N'.    01020000
010300         88  PS-UPDATES-DONE                        VALUE 'Y'.    01030000
010400     05  PS-NO-TDISTHD-FOUND-SW         PIC  X(01)  VALUE 'Y'.    01040000
010500         88  PS-TDISTHD-FOUND                       VALUE 'Y'.    01050000
010600         88  PS-NO-TDISTHD-FOUND                    VALUE 'N'.    01060000
010700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01070000
010800         88  PS-NO-ERROR                            VALUE 'Y'.    01080000
010900         88  PS-ERROR                               VALUE 'N'.    01090000
011000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01100000
011100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01110000
011200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01120000
011300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01130000
011400         88  PS-DONE                                VALUE 'Y'.    01140000
011500         88  PS-NOT-DONE                            VALUE 'N'.    01150000
011600     05  PS-EOC-PAC-CSR-SW              PIC  X(01)  VALUE 'N'.    01160000
011700         88  PS-EOC-PAC-CSR                         VALUE 'Y'.    01170000
011800         88  PS-NOT-EOC-PAC-CSR                     VALUE 'N'.    01180000
011900     05  PS-UPDATE-QUEUE-SW             PIC  X(01)  VALUE 'N'.    01190000
012000         88  PS-UPDATE-QUEUE                        VALUE 'Y'.    01200000
012100         88  PS-DONT-UPDATE-QUEUE                   VALUE 'N'.    01210000
012200*                                                                 01220000
012300 01  PV-PROGRAM-VARIABLES.                                        01230000
012301     05  PV-PURCHS-STATUS-CDE         PIC X(02).                  01230100
012302     05  PV-PURITM-STATUS-CDE         PIC X(02).                  01230200
012303     05  PV-PURITM-UNT-QTY            PIC S9(9)  COMP.            01230300
012304     05  PV-DEPT-NBR-X.                                           01230400
012305         10  PV-DEPT-NBR              PIC  9(4).                  01230500
012306     05  PV-DEPT-NBR-KEY              PIC S9(4) VALUE +0          01230600
012307                                                COMP-3.           01230700
012308     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01230800
012309                                                COMP-3.           01230900
012310     05  PV-RECDIS-AP-VERIFY-ITM-QTY  PIC S9(9) COMP SYNC.        01231000
012320     05  PV-REC-TYPE                    PIC  X(01).               01232000
012330     05  PV-NOTIF-NBR                   PIC S9(9) VALUE 7         01233000
012340                                                  COMP SYNC.      01234000
012350     05  PV-CYC-ADJ-NBR                 PIC S9(9) VALUE 7         01235000
012360                                                  COMP SYNC.      01236000
012370     05  PV-NOTIF-BEF                 PIC S9(9) VALUE ZERO        01237000
012380                                                COMP SYNC.        01238000
012390     05  PV-CYC-ADJ-BEF               PIC S9(9) VALUE ZERO        01239000
012400                                                COMP SYNC.        01240000
012500     05  PV-CICS-MSG-AREA               PIC  X(100) VALUE SPACE.  01250000
012600     05  PV-CICS-MSG-AREA2              PIC  X(100) VALUE SPACE.  01260000
012700     05  PV-COMMAREA-LENGTH             PIC S9(04) VALUE +0       01270000
012800                                                   COMP SYNC.     01280000
012900     05  PV-VRFY-ITEM                   PIC S9(4)  VALUE ZERO     01290000
013000                                                   COMP SYNC.     01300000
013100     05  PV-SAVE-ITM-QTY                PIC S9(9) VALUE ZERO      01310000
013200                                                COMP.             01320000
013300     05  PV-SUM-ITM-QTY                 PIC S9(9) VALUE ZERO      01330000
013400                                                COMP.             01340000
013500     05  PV-DISPLAY-NO-ZERO             PIC  Z(5).                01350000
013600     05  PV-DISPLAY-ZERO                PIC  Z(4)9.               01360000
013700     05  PV-STR-NBR-Z                   PIC  ZZZ9.                01370000
013800     05  PV-UPDATE-PACK-AMT             PIC  9(05).               01380000
013900     05  PV-UPDATE-PACK                 PIC  S9(09) VALUE ZERO    01390000
014000                                                    COMP.         01400000
014100     05  PV-ORIG-PACK-ACT               PIC  S9(09) VALUE ZERO    01410000
014200                                                    COMP.         01420000
014300     05  PV-ORIG-PACK-VRF               PIC  S9(09) VALUE ZERO    01430000
014400                                                    COMP.         01440000
014500     05  PV-UPDATE-PACK-DIF             PIC  S9(09) VALUE ZERO    01450000
014600                                                    COMP.         01460000
014700     05  PV-LINE-QTY                    PIC  9(09).               01470000
014800     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01480000
014900                                                    COMP SYNC.    01490000
015000     05  PV-RECDVS-COUNT                PIC S9(09)  VALUE ZERO    01500000
015100                                                    COMP-3.       01510000
015200     05  PV-CASE-PKSLP                  PIC S9(09)  VALUE ZERO    01520000
015300                                                    COMP-3.       01530000
015400     05  PV-LNE-AP-VERIFY-ITM-QTY       PIC S9(09)  VALUE +0      01540000
015500                                                    COMP SYNC.    01550000
015600     05  PV-LNE-VERIFY-ITM-QTY          PIC S9(09)  VALUE +0      01560000
015700                                                    COMP SYNC.    01570000
015800     05  PV-LNE-EXPTED-ITM-QTY          PIC S9(09)  VALUE +0      01580000
015900                                                    COMP SYNC.    01590000
016000     05  PV-ODD-DC-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      01600000
016100                                                    COMP SYNC.    01610000
016200     05  PV-ODD-AP-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      01620000
016300                                                    COMP SYNC.    01630000
016400     05  PV-ODD-DC-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      01640000
016500                                                    COMP SYNC.    01650000
016600     05  PV-ODD-AP-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      01660000
016700                                                    COMP SYNC.    01670000
016800     05  PV-TOT-DC-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      01680000
016900                                                    COMP SYNC.    01690000
017000     05  PV-TOT-AP-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      01700000
017100                                                    COMP SYNC.    01710000
017110     05  PV-PKSLIP-PACKS                PIC  9(06).               01711000
017120     05  PV-ACTUAL-PACKS                PIC  9(06).               01712000
017130     05  PV-CASE-PACKS                  PIC  9(06).               01713000
017140     05  PV-VERFYD-PACKS                PIC  9(06).               01714000
017150     05  PV-ODD-UNITS                   PIC  9(06).               01715000
017160     05  PV-DRIVER-RATIO                PIC  9(06).               01716000
017170     05  PV-DISP-PO-NBR                 PIC  9(09).               01717000
017180     05  PV-DISP-OPER-UNT-ID            PIC  9(04).               01718000
017190     05  PV-DISP-FCLTY-ID               PIC  9(04).               01719000
017200     05  PV-DISP-STR-NBR                PIC  9(04).               01720000
017300     05  PV-DISP-REC-SEQ-NBR            PIC  9(09).               01730000
017400     05  PV-DISP-PREPK-ID               PIC  9(04).               01740000
017500     05  PV-DISP-LNE-NBR                PIC  9(09).               01750000
017600     05  PV-DISP-SQL-CODE               PIC +9(04).               01760000
017700     05  PV-DISP-CICS-RESP              PIC +9(04).               01770000
017800     05  PV-SUB                         PIC S9(04)  VALUE +0      01780000
017900                                                    COMP SYNC.    01790000
018000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01800000
018100                                                    COMP SYNC.    01810000
018200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01820000
018300                                                    COMP-3.       01830000
018400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01840000
018500                                                    COMP-3.       01850000
018600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01860000
018700                                                    COMP-3.       01870000
018800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01880000
018900                                                    COMP-3.       01890000
019000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01900000
019100                                                    COMP-3.       01910000
019200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01920000
019300                                                    COMP-3.       01930000
019400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01940000
019500                                                    COMP-3.       01950000
019600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01960000
019700                                                    COMP SYNC.    01970000
019800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01980000
019900                                                    COMP SYNC.    01990000
020000     05  PV-ITEM                        PIC S9(04)  VALUE +0      02000000
020100                                                    COMP SYNC.    02010000
020200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02020000
020300                                                    COMP SYNC.    02030000
020400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02040000
020500                                                    COMP SYNC.    02050000
020600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02060000
020700                                                    COMP SYNC.    02070000
020800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02080000
020900                                                    COMP SYNC.    02090000
021000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02100000
021100                                                    COMP SYNC.    02110000
021200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02120000
021300                                                    COMP SYNC.    02130000
021400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02140000
021500                                                    COMP SYNC.    02150000
021600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02160000
021700                                                    COMP SYNC.    02170000
021800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02180000
021900                                                    COMP SYNC.    02190000
022000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02200000
022100                                                    COMP SYNC.    02210000
022200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02220000
022300                                                    COMP SYNC.    02230000
022400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02240000
022500                                                    COMP SYNC.    02250000
022600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-WORK-TIMESTAMP.                                       02280000
022900         10  PV-WORK-YEAR               PIC X(04).                02290000
023000         10  FILLER                     PIC X(01).                02300000
023100         10  PV-WORK-MONTH              PIC X(02).                02310000
023200         10  FILLER                     PIC X(01).                02320000
023300         10  PV-WORK-DAY                PIC X(02).                02330000
023400         10  FILLER                     PIC X(01).                02340000
023500         10  PV-WORK-HH                 PIC X(02).                02350000
023600         10  FILLER                     PIC X(01).                02360000
023700         10  PV-WORK-MIN                PIC X(02).                02370000
023800         10  FILLER                     PIC X(10).                02380000
023900     05  PV-DISPLAY-DATE.                                         02390000
024000         10  PV-DISPLAY-MONTH           PIC X(02).                02400000
024100         10  PV-SLASH-1                 PIC X(01).                02410000
024200         10  PV-DISPLAY-DAY             PIC X(02).                02420000
024300         10  PV-SLASH-2                 PIC X(01).                02430000
024400         10  PV-DISPLAY-YEAR            PIC X(04).                02440000
024500     05  PV-DISPLAY-TIME.                                         02450000
024600         10  PV-DISPLAY-HH              PIC X(02).                02460000
024700         10  PV-COLON-1                 PIC X(01).                02470000
024800         10  PV-DISPLAY-MM              PIC X(02).                02480000
024900     05  PV-RECEIV-VRFY-INFO.                                     02490000
025000         10  PV-LEFT-PAREN              PIC X(01).                02500000
025100         10  PV-VRFY-DATE               PIC X(10).                02510000
025200         10  FILLER                     PIC X(01).                02520000
025300         10  PV-VRFY-TIME               PIC X(05).                02530000
025400         10  PV-SEPARATOR               PIC X(03).                02540000
025500         10  PV-VRFY-USERID             PIC X(07).                02550000
025600         10  PV-RIGHT-PAREN             PIC X(01).                02560000
025700     05  PV-CURR-OPER-UNT-ID          PIC S9(4)  COMP             02570000
025800                                                 VALUE ZERO.      02580000
025900     05  PV-XLT00010-TYPE-CODE        PIC X(2)   VALUE SPACES.    02590000
026000         88  PV-XLT00010-TYPE-DC                 VALUE 'DC'.      02600000
026100     05  PV-TMST                      PIC X(26).                  02610000
026200     05  PV-CURRENT-TIMESTAMP         PIC X(26) VALUE SPACE.      02620000
026300                                                                  02630000
026400     05  PV-V1-MSG.                                               02640000
026500         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02650000
026600         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02660000
026700         10  PV-V1-P2L-UNITS         PIC 99999   VALUE 0.         02670000
026800         10  FILLER                  PIC X(7)    VALUE '  CASE/'. 02680000
026900         10  PV-V1-CASE-UNITS        PIC 99999   VALUE 0.         02690000
027000     05  PV-V2-MSG.                                               02700000
027010         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02701000
027020         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02702000
027030         10  PV-V2-P2L-UNITS         PIC 99999   VALUE 0.         02703000
027040     05  PV-V3-MSG.                                               02704000
027050         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02705000
027060         10  FILLER                  PIC X(5)    VALUE 'CASE/'.   02706000
027070         10  PV-V3-CASE-UNITS        PIC 99999   VALUE 0.         02707000
027080     05  PV-V4-MSG.                                               02708000
027090         10  FILLER                  PIC X(5)    VALUE 'ACTL '.   02709000
027091         10  FILLER                  PIC X(7)    VALUE 'MANUAL/'. 02709100
027092         10  PV-V4-MANUAL-UNITS      PIC 99999   VALUE 0.         02709200
027093     05  PV-NV1-MSG.                                              02709300
027094         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02709400
027095         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02709500
027096         10  PV-NV1-P2L-UNITS        PIC 99999   VALUE 0.         02709600
027097         10  FILLER                  PIC X(7)    VALUE '  CASE/'. 02709700
027098         10  PV-NV1-CASE-UNITS       PIC 99999   VALUE 0.         02709800
027099     05  PV-NV2-MSG.                                              02709900
027100         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02710000
027101         10  FILLER                  PIC X(4)    VALUE 'P2L/'.    02710100
027102         10  PV-NV2-P2L-UNITS        PIC 99999   VALUE 0.         02710200
027103     05  PV-NV3-MSG.                                              02710300
027104         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02710400
027105         10  FILLER                  PIC X(5)    VALUE 'CASE/'.   02710500
027106         10  PV-NV3-CASE-UNITS       PIC 99999   VALUE 0.         02710600
027107     05  PV-NV4-MSG.                                              02710700
027108         10  FILLER                  PIC X(5)    VALUE 'PKSL '.   02710800
027109         10  FILLER                  PIC X(7)    VALUE 'MANUAL/'. 02710900
027110         10  PV-NV4-MANUAL-UNITS     PIC 99999   VALUE 0.         02711000
027120******************************************************************02712000
027130**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02713000
027140**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02714000
027150**  APPLICATION-SPECIFIC COMMAREA.                              **02715000
027160******************************************************************02716000
027170 01  LQW-LIST-QUEUE-WORK-AREA.                                    02717000
027180     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02718000
027190     05  LQW-ITEM-ENTRIES               OCCURS 8 TIMES            02719000
027200                                        INDEXED BY LQW-IDX.       02720000
027300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02730000
027400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02740000
027500         10  LQW-SELECTED-SW            PIC  X(01).               02750000
027600             88  LQW-SELECT                         VALUE 'S'.    02760000
027700             88  LQW-DESELECT                       VALUE ' '.    02770000
027800         10  LQW-ACTION                 PIC  X(03).               02780000
027900         10  LQW-UPDATE-PACKS           PIC  X(05).               02790000
028000         10  LQW-UPDATE-PACKS-N                                   02800000
028100                        REDEFINES LQW-UPDATE-PACKS                02810000
028200                                        PIC  9(05).               02820000
028300         10  LQW-PACK-SKU               PIC  9(08).               02830000
028400         10  LQW-PACK-ID                PIC  9(04).               02840000
028500         10  LQW-DRIVER-LNE             PIC S9(09)   COMP.        02850000
028600         10  LQW-DRIVER-RATIO           PIC  9(06).               02860000
028700         10  LQW-KEY-VFY-SRC            PIC X(08).                02870000
028800         10  LQW-PACKSLP-PACKS          PIC  9(05).               02880000
028900         10  LQW-ACTUAL-PACKS           PIC  9(05).               02890000
029000         10  LQW-VRFYD-PACKS            PIC  9(05).               02900000
029100         10  LQW-ODD-UNITS              PIC  9(05).               02910000
029200         10  LQW-SOURCE                 PIC  X(08).               02920000
029300         10  LQW-P2L-PKSLIP             PIC  9(05).               02930000
029400         10  LQW-P2L-ACTUAL             PIC  9(05).               02940000
029500         10  LQW-CASE-PKSLIP            PIC  9(05).               02950000
029600         10  LQW-CASE-ACTUAL            PIC  9(05).               02960000
029700         10  LQW-STAT-CDE               PIC  X(02).               02970000
029800         10  LQW-LINE-PACK-ID           PIC  9(04).               02980000
029900         10  LQW-SEL-ZERO-SW            PIC  X(01).               02990000
030000         10  LQW-ACTL-CONFIRMED-SW      PIC  X(01).               03000000
030100         10  LQW-CANNOT-VERIFY-SW       PIC  X(01).               03010000
030200                                                                  03020000
030300     EJECT                                                        03030000
030400*---------------------------------------------------------------* 03040000
030500*    MAP LAYOUT                                                 * 03050000
030510*---------------------------------------------------------------* 03051000
030520                                                                  03052000
030530     COPY RCKM820.                                                03053000
030540*                                                                 03054000
030550 01  MR-OCCURS-LAYOUT                   REDEFINES  RC820AO.       03055000
030560     05  FILLER                         PIC X(235).               03056000
030570     05  MR-SCROLL-AREA                 OCCURS  8 TIMES.          03057000
030580         10  MR-SELECTL                 PIC S9(04) COMP.          03058000
030590         10  MR-SELECTA                 PIC  X(01).               03059000
030600         10  MR-SELECTC                 PIC  X(01).               03060000
030700         10  MR-SELECTH                 PIC  X(01).               03070000
030800         10  MR-SELECTI                 PIC  X(01).               03080000
030900                                                                  03090000
031000         10  MR-ACTIONL                 PIC S9(04) COMP.          03100000
031100         10  MR-ACTIONA                 PIC  X(01).               03110000
031200         10  MR-ACTIONC                 PIC  X(01).               03120000
031300         10  MR-ACTIONH                 PIC  X(01).               03130000
031400         10  MR-ACTION                  PIC  X(03).               03140000
031500                                                                  03150000
031600         10  MR-UPDATE-PACKSL           PIC S9(04) COMP.          03160000
031700         10  MR-UPDATE-PACKSA           PIC  X(01).               03170000
031800         10  MR-UPDATE-PACKSC           PIC  X(01).               03180000
031900         10  MR-UPDATE-PACKSH           PIC  X(01).               03190000
032000         10  MR-UPDATE-PACKS-X.                                   03200000
032100             15  MR-UPDATE-PACKS            PIC  9(05).           03210000
032200                                                                  03220000
032300         10  MR-PACK-SKUL               PIC S9(04) COMP.          03230000
032400         10  MR-PACK-SKUA               PIC  X(01).               03240000
032500         10  MR-PACK-SKUC               PIC  X(01).               03250000
032600         10  MR-PACK-SKUH               PIC  X(01).               03260000
032700         10  MR-PACK-SKU-X.                                       03270000
032800             15  MR-PACK-SKU            PIC  ZZZZZZZ9.            03280000
032900                                                                  03290000
033000         10  MR-PACKSLIP-PACKSL         PIC S9(04) COMP.          03300000
033100         10  MR-PACKSLIP-PACKSA         PIC  X(01).               03310000
033200         10  MR-PACKSLIP-PACKSC         PIC  X(01).               03320000
033300         10  MR-PACKSLIP-PACKSH         PIC  X(01).               03330000
033400         10  MR-PACKSLIP-PACKS-X.                                 03340000
033500             15  MR-PACKSLIP-PACKS      PIC  ZZZZ9.               03350000
033600                                                                  03360000
033700         10  MR-ACTUAL-PACKSL           PIC S9(04) COMP.          03370000
033800         10  MR-ACTUAL-PACKSA           PIC  X(01).               03380000
033900         10  MR-ACTUAL-PACKSC           PIC  X(01).               03390000
034000         10  MR-ACTUAL-PACKSH           PIC  X(01).               03400000
034100         10  MR-ACTUAL-PACKS-X.                                   03410000
034200             15  MR-ACTUAL-PACKS        PIC  ZZZZ9.               03420000
034300                                                                  03430000
034400         10  MR-VRFYD-PACKSL            PIC S9(04) COMP.          03440000
034500         10  MR-VRFYD-PACKSA            PIC  X(01).               03450000
034600         10  MR-VRFYD-PACKSC            PIC  X(01).               03460000
034700         10  MR-VRFYD-PACKSH            PIC  X(01).               03470000
034800         10  MR-VRFYD-PACKS-X.                                    03480000
034900             15  MR-VRFYD-PACKS         PIC  ZZZZ9.               03490000
035000                                                                  03500000
035100         10  MR-ODD-UNITSL              PIC S9(04) COMP.          03510000
035200         10  MR-ODD-UNITSA              PIC  X(01).               03520000
035300         10  MR-ODD-UNITSC              PIC  X(01).               03530000
035400         10  MR-ODD-UNITSH              PIC  X(01).               03540000
035500         10  MR-ODD-UNITS-X.                                      03550000
035600             15  MR-ODD-UNITS           PIC  ZZZZ9.               03560000
035700                                                                  03570000
035800***      10  MR-SOURCEL                 PIC S9(04) COMP.          03580000
035900***      10  MR-SOURCEA                 PIC  X(01).               03590000
036000***      10  MR-SOURCEC                 PIC  X(01).               03600000
036100***      10  MR-SOURCEH                 PIC  X(01).               03610000
036200***      10  MR-SOURCE                  PIC  X(08).               03620000
036300***                                                               03630000
036400***                                                               03640000
036500***      10  MR-P2L-PKSLIPL             PIC S9(04) COMP.          03650000
036600***      10  MR-P2L-PKSLIPA             PIC  X(01).               03660000
036700***      10  MR-P2L-PKSLIPC             PIC  X(01).               03670000
036800***      10  MR-P2L-PKSLIPH             PIC  X(01).               03680000
036900***      10  MR-P2L-PKSLIP-X.                                     03690000
037000***          15  MR-P2L-PKSLIP          PIC  ZZZZ9.               03700000
037100***                                                               03710000
037200***      10  MR-P2L-ACTUALL             PIC S9(04) COMP.          03720000
037300***      10  MR-P2L-ACTUALA             PIC  X(01).               03730000
037400***      10  MR-P2L-ACTUALC             PIC  X(01).               03740000
037500***      10  MR-P2L-ACTUALH             PIC  X(01).               03750000
037600***      10  MR-P2L-ACTUAL-X.                                     03760000
037700***          15  MR-P2L-ACTUAL          PIC  ZZZZ9.               03770000
037800***                                                               03780000
037900***      10  MR-CASE-PKSLIPL            PIC S9(04) COMP.          03790000
038000***      10  MR-CASE-PKSLIPA            PIC  X(01).               03800000
038100***      10  MR-CASE-PKSLIPC            PIC  X(01).               03810000
038200***      10  MR-CASE-PKSLIPH            PIC  X(01).               03820000
038300***      10  MR-CASE-PKSLIP-X.                                    03830000
038400***          15  MR-CASE-PKSLIP         PIC  ZZZZ9.               03840000
038500***                                                               03850000
038600***      10  MR-CASE-ACTUALL            PIC S9(04) COMP.          03860000
038700***      10  MR-CASE-ACTUALA            PIC  X(01).               03870000
038800***      10  MR-CASE-ACTUALC            PIC  X(01).               03880000
038900***      10  MR-CASE-ACTUALH            PIC  X(01).               03890000
039000***      10  MR-CASE-ACTUAL-X.                                    03900000
039100***          15  MR-CASE-ACTUAL         PIC  ZZZZ9.               03910000
039200                                                                  03920000
039300         10  MR-VERIFY-MSGL             PIC S9(04) COMP.          03930000
039400         10  MR-VERIFY-MSGA             PIC  X(01).               03940000
039500         10  MR-VERIFY-MSGC             PIC  X(01).               03950000
039600         10  MR-VERIFY-MSGH             PIC  X(01).               03960000
039610         10  MR-VERIFY-MSG              PIC  X(27).               03961000
039620     EJECT                                                        03962000
039630                                                                  03963000
039640*---------------------------------------------------------------* 03964000
039650*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 03965000
039660*---------------------------------------------------------------* 03966000
039670     COPY RCWS074.                                                03967000
039680                                                                  03968000
039690******************************************************************03969000
039700*  COMMAREA LAYOUT FOR THE RECEIVING TABLE AUDIT MODULE          *03970000
039800*  (RCKCS290)                                                    *03980000
039900******************************************************************03990000
040000     COPY RCWS031.                                                04000000
040100                                                                  04010000
040200******************************************************************04020000
040300*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *04030000
040400******************************************************************04040000
040500     COPY PCWS238.                                                04050000
040600                                                                  04060000
040700******************************************************************04070000
040800*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT   *04080000
040900*  TO RMS PO BY PCKCS759.                                        *04090000
041000******************************************************************04100000
041100     COPY PCWS241.                                                04110000
041200                                                                  04120000
041300***************************************************************** 04130000
041400*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04140000
041500*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 04150000
041510***************************************************************** 04151000
041520     COPY RCWS040.                                                04152000
041530/                                                                 04153000
041540*---------------------------------------------------------------* 04154000
041550*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04155000
041560*---------------------------------------------------------------* 04156000
041570                                                                  04157000
041580     COPY DPWS015.                                                04158000
041590                                                                  04159000
041600*---------------------------------------------------------------* 04160000
041700*    FUNCTION KEYS COPYBOOK.                                    * 04170000
041800*---------------------------------------------------------------* 04180000
041900                                                                  04190000
042000     COPY DPWS016.                                                04200000
042100                                                                  04210000
042200*---------------------------------------------------------------* 04220000
042300*    NUMERIC EDIT LAYOUT.                                       * 04230000
042400*---------------------------------------------------------------* 04240000
042500                                                                  04250000
042600     COPY DPWS010I.                                               04260000
042700 EJECT                                                            04270000
042800******************************************************************04280003
042900** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04290003
042910** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04291003
043000******************************************************************04300003
043100                                                                  04310000
043200     COPY DPWS030.                                                04320000
043210     COPY DPWS930.                                                04321003
043300*---------------------------------------------------------------* 04330000
043400*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 04340000
043500*---------------------------------------------------------------* 04350000
043600     COPY RCWS037.                                                04360000
043700                                                                  04370000
043800*---------------------------------------------------------------* 04380000
043900*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 04390000
044000*---------------------------------------------------------------* 04400000
044100                                                                  04410000
044200     COPY RCWS801.                                                04420000
044300*---------------------------------------------------------------* 04430000
044400*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 04440000
044500*---------------------------------------------------------------* 04450000
044600                                                                  04460000
044700     COPY TMWS002.                                                04470000
044800                                                                  04480000
044900 EJECT                                                            04490000
045000*---------------------------------------------------------------* 04500000
045100*    STANDARD COMMAREA.                                         * 04510000
045200*---------------------------------------------------------------* 04520000
045300                                                                  04530000
045400     COPY DPWS020.                                                04540000
045500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04550000
045600                                                                  04560000
045700*---------------------------------------------------------------* 04570000
045800* INTER-APPLICATION COMMAREA.                                   * 04580000
045900*   RCWS017 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04590000
046000*             SPEC SCREEN.                                      * 04600000
046100*    ****RCWS012 IS USED IN THE RCKCS219 PROGRAM, BUT RCWS017   * 04610000
046200*        IS PASSED FROM THE RCKCS277 PROGRAM, WHICH INCLUDES    * 04620000
046300*        A TROUBLE QUEUE NAME                                     04630000
046400*   RCWS036 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04640000
046500*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04650000
046600*---------------------------------------------------------------* 04660000
046700                                                                  04670000
046800         10  INTER-APPL-COMM-AREA       PIC X(200).               04680000
046900     COPY RCWS017.                                                04690000
047000     COPY RCWS800.                                                04700000
047100     COPY RCWS036.                                                04710000
047200     COPY TMWS001.                                                04720000
047300                                                                  04730000
047400*---------------------------------------------------------------* 04740000
047500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04750000
047600*---------------------------------------------------------------* 04760000
047700         10  ASC-SPECIFIC-COMMAREA.                               04770000
047800             15  ASC-LOCAL-GO-DESTINATION            PIC X(01).   04780000
047900                 88  ASC-RETURNING-FROM-RCVG         VALUE '1'.   04790000
048000                 88  ASC-RETURNING-FROM-TRBL         VALUE '2'.   04800000
048100                 88  ASC-RETURNING-FROM-STR-PACK     VALUE '3'.   04810000
048200             15  ASC-USE-SELECTION-QUEUE-IND                      04820000
048300                                           PIC X(01).             04830000
048400                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        04840000
048500             15  ASC-SEL-QUEUE-NAME-IN     PIC X(08).             04850000
048600             15  ASC-TRB-QUEUE-NAME-IN               PIC X(8).    04860000
048700             15  ASC-VRFY-ADJ-QUEUE-NAME.                         04870000
048800                 20  ASC-VRFY-ADJ-TERM-ID            PIC X(4).    04880000
048900                 20  ASC-VRFY-ADJ-TASK-NUMBER        PIC S9(5)    04890000
049000                                                     COMP-3.      04900000
049100                 20  ASC-VRFY-ADJ-SEQ                PIC 9.       04910000
049200             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     04920000
049300             15  ASC-SEL-SUB               PIC S9(04) COMP.       04930000
049400             15  ASC-SEL-ITEM              PIC S9(04) COMP.       04940000
049500             15  ASC-LIST-KEYS.                                   04950000
049600                 20  ASC-OPER-UNT-ID                 PIC S9(04)   04960000
049700                                                     COMP.        04970000
049800                 20  ASC-FCLTY-ID                    PIC S9(04)   04980000
049900                                                     COMP.        04990000
050000                 20  ASC-FCLTY-NME                   PIC  X(25).  05000000
050100                 20  ASC-RECEIV-VRFY-INFO            PIC  X(28).  05010000
050200                 20  ASC-PO-NBR                      PIC S9(09)   05020000
050300                                                     COMP.        05030000
050400                 20  ASC-PO-LNE-NBR                  PIC S9(09)   05040000
050500                                                     COMP.        05050000
050600                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   05060000
050700                                                     COMP.        05070000
050800                 20  ASC-TOT-PKSLIP-PACKS            PIC S9(07)   05080000
050900                                                     COMP.        05090000
051000                 20  ASC-TOT-ACTUAL-PACKS            PIC S9(07)   05100000
051100                                                     COMP.        05110000
051200                 20  ASC-TOT-VERFYD-PACKS            PIC S9(07)   05120000
051300                                                     COMP.        05130000
051400                 20  ASC-TOT-ODD-UNITS               PIC S9(07)   05140000
051500                                                     COMP.        05150000
051600                 20  ASC-HDR-TOT-ACT-UNTS            PIC S9(07)   05160000
051700                                                     COMP.        05170000
051800                 20  ASC-HDR-TOT-VERFYD-UNTS         PIC S9(07)   05180000
051900                                                     COMP.        05190000
052000                 20  ASC-DEPT-NBR                    PIC  ZZZ9.   05200000
052100                 20  ASC-SOURCE-TYPE                 PIC  X(08).  05210000
052200                 20  ASC-ALL-VFY-SRC                 PIC X(08).   05220000
052300                 20  ASC-STR-NBR                     PIC 9(4).    05230000
052400             15 ASC-TRBL-FOUND-SW                    PIC  X.      05240000
052500                 88 ASC-TRBL-EXISTS             VALUE 'Y'.        05250000
052600                 88 ASC-NO-TRBL-EXISTS          VALUE 'N'.        05260000
052700             15  ASC-TRBL-LVL-IND                PIC X(01).       05270000
052800                 88  ASC-PO-LEVEL-TRBL           VALUE 'P'.       05280000
052900                 88  ASC-LINE-LEVEL-TRBL         VALUE 'L'        05290000
053000                                                       'S'        05300000
053100                                                       'X'        05310000
053200                                                       'M'.       05320000
053300                                                                  05330000
053400             15  ASC-RECEIV-STATUS-CDE               PIC  X(02).  05340000
053500             15  ASC-RECEIV-ML-POST-TMST             PIC  X(26).  05350000
053510             15  ASC-CONFIRM-SWITCH                  PIC X.       05351000
053520                 88  ASC-CONFIRMED                   VALUE 'Y'.   05352000
053530                 88  ASC-NOT-CONFIRMED               VALUE 'N'.   05353000
053540             15  ASC-CONFIRM-UPDATE-SW       PIC X.               05354000
053550                 88  ASC-CONFIRM-UPDATE              VALUE 'Y'.   05355000
053560                 88  ASC-DONT-CONFIRM-UPDATE         VALUE 'N'.   05356000
053570             15  ASC-PACK-BY-ST-SW                   PIC X(01).   05357000
053580                 88  ASC-PACK-BY-STORE        VALUE 'Y'.          05358000
053590                 88  ASC-NOT-PACK-BY-STORE    VALUE 'N'.          05359000
053600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05360000
053700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05370000
053800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05380000
053900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05390000
054000                                                                  05400000
054100                 20  ASC-ITEM-ARRAY.                              05410000
054200                     25  ASC-ITEM-ENTRIES OCCURS  8 TIMES.        05420000
054300                         30  ASC-LIST-ITEM-NUMBER                 05430000
054400                                                     PIC S9(09)   05440000
054500                                                     COMP-3.      05450000
054600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05460000
054700                             88  ASC-VALID-SELECT    VALUE ' '    05470000
054800                                                           'S'    05480000
054900                                                           'B'    05490000
055000                                                           'E'.   05500000
055100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05510000
055200                             88  ASC-TEMP-SELECT     VALUE 'S'.   05520000
055300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05530000
055400                             88  ASC-TEMP-END        VALUE 'E'.   05540000
055500                         30  ASC-SELECTED-SW         PIC  X(01).  05550000
055600                             88  ASC-NO-SELECT       VALUE ' '.   05560000
055700                             88  ASC-SELECT          VALUE 'S'.   05570000
055800                             88  ASC-BEGIN           VALUE 'B'.   05580000
055900                             88  ASC-END             VALUE 'E'.   05590000
056000                         30  ASC-ACTION              PIC  X(03).  05600000
056100                         30  ASC-UPDATE-PACKS        PIC  X(05).  05610000
056200                         30  ASC-UPDATE-PACKS-N                   05620000
056300                                     REDEFINES ASC-UPDATE-PACKS   05630000
056400                                                 PIC 9(05).       05640000
056500                         30  ASC-PACK-SKU            PIC  9(08).  05650000
056600                         30  ASC-PACK-ID             PIC  9(04).  05660000
056700                         30  ASC-DRIVER-LNE          PIC S9(09)   05670000
056800                                                     COMP.        05680000
056900                         30  ASC-DRIVER-RATIO        PIC  9(06).  05690000
057000                         30  ASC-KEY-VFY-SRC         PIC X(08).   05700000
057100                         30  ASC-PACKSLIP-PACKS      PIC  9(05).  05710000
057200                         30  ASC-ACTUAL-PACKS        PIC  9(05).  05720000
057300                         30  ASC-VRFYD-PACKS         PIC  9(05).  05730000
057400                         30  ASC-ODD-UNITS           PIC  9(05).  05740000
057500                         30  ASC-SOURCE              PIC  X(08).  05750000
057600                         30  ASC-P2L-PKSLIP          PIC  9(05).  05760000
057700                         30  ASC-P2L-ACTUAL          PIC  9(05).  05770000
057800                         30  ASC-CASE-PKSLIP         PIC  9(05).  05780000
057900                         30  ASC-CASE-ACTUAL         PIC  9(05).  05790000
058000                         30  ASC-STAT-CDE            PIC  X(02).  05800000
058100                         30  ASC-LINE-PACK-ID        PIC  9(04).  05810000
058200                         30  ASC-SEL-ZERO-SW         PIC X(01).   05820000
058300                             88  ASC-SEL-ZERO-YES    VALUE 'Y'.   05830000
058400                             88  ASC-SEL-ZERO-NO     VALUE 'N'.   05840000
058500                         30  ASC-ACTL-CONFIRMED-SW   PIC X.       05850000
058600                             88  ASC-ACTL-CONFIRMED  VALUE 'Y'.   05860000
058700                             88  ASC-ACTL-NOT-CONFIRMED           05870000
058800                                                     VALUE 'N'.   05880000
058900                         30  ASC-CANNOT-VERIFY-SW    PIC  X(01).  05890000
059000                                                                  05900000
059100             15  ASC-BLK-SUB                         PIC S9(04)   05910000
059200                                                          COMP    05920000
059210                                                          SYNC.   05921000
059220             15  ASC-ITEM-SUB                        PIC S9(04)   05922000
059230                                                          COMP    05923000
059240                                                          SYNC.   05924000
059250             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05925000
059260                                                          COMP-3. 05926000
059270             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05927000
059280                                                          COMP-3. 05928000
059290             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05929000
059300                                                          COMP-3. 05930000
059400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05940000
059500                                                          COMP-3. 05950000
059600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05960000
059700                                                          COMP-3. 05970000
059800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05980000
059900                                                          COMP    05990000
060000                                                          SYNC.   06000000
060100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06010000
060200                                                          COMP-3. 06020000
060300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06030000
060400                                                          COMP-3. 06040000
060500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06050000
060600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06060000
060700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06070000
060800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06080000
060900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06090000
061000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06100000
061100             15  ASC-LIST-QUEUE-NAME.                             06110000
061200                 20  ASC-LIST-TERM-ID                PIC  X(04).  06120000
061300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06130000
061400                                                          COMP-3. 06140000
061500                 20  ASC-LIST-SEQ                    PIC  9(01).  06150000
061600             15  ASC-SEL-QUEUE-NAME-OUT.                          06160000
061700                 20  ASC-SEL-TERM-ID                 PIC  X(04).  06170000
061800                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06180000
061900                                                          COMP-3. 06190000
062000                 20  ASC-SEL-SEQ                     PIC  9(01).  06200000
062100                                                                  06210000
062200             15  ASC-START-ITEM-REQUEST.                          06220000
062300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06230000
062400                                                                  06240000
062500             15  ASC-VERIFY-SW                       PIC  X(01).  06250000
062600                 88  ASC-CAN-VERIFY                  VALUE 'Y'.   06260000
062700                 88  ASC-CANT-VERIFY                 VALUE 'N'.   06270000
062800             15  ASC-UNVERIFY-SW                     PIC  X(01).  06280000
062900                 88  ASC-CAN-UNVERIFY                VALUE 'Y'.   06290000
063000                 88  ASC-CANT-UNVERIFY-FS            VALUE 'F'.   06300000
063100                 88  ASC-CANT-UNVERIFY-ST            VALUE 'S'.   06310000
063200                 88  ASC-CANT-UNVERIFY               VALUE 'N'.   06320000
063300                                                                  06330000
063400             15  ASC-CONFIRM-SWITCH                  PIC X.       06340000
063500                 88  ASC-CONFIRM                     VALUE 'Y'.   06350000
063600                 88  ASC-NOT-CONFIRM                 VALUE 'N'.   06360000
063700                                                                  06370000
063800             15  ASC-CONFIRM-ZERO-SW                 PIC X.       06380000
063900                 88  ASC-CONFIRM-ZERO                VALUE 'Y'.   06390000
064000                 88  ASC-NOT-CONFIRM-ZERO            VALUE 'N'.   06400000
064100                                                                  06410000
064200             15  ASC-CONFIRM-VERIFY-SW               PIC X.       06420000
064300                 88  ASC-CONFIRM-VERIFY              VALUE 'V'.   06430000
064400                 88  ASC-CONFIRM-UNVERIFY            VALUE 'U'.   06440000
064500                 88  ASC-STOP-VERIFY                 VALUE 'U'.   06450000
064600                                                                  06460000
064700             15  ASC-RECDVS-SW                       PIC X.       06470000
064800                 88  ASC-MORE-RECDVS                 VALUE 'Y'.   06480000
064900                 88  ASC-NO-MORE-RECDVS              VALUE 'N'.   06490000
065000             15  ASC-RANGE-CHECK-SW          PIC X.               06500000
065100                 88  ASC-RANGE-ON                    VALUE 'Y'.   06510000
065200                 88  ASC-RANGE-OFF                   VALUE 'N'.   06520000
065300             15  ASC-POST-VERIFIED-RECEIPT-SW        PIC  X(01).  06530000
065400                 88  ASC-POST-VERIFIED-RECEIPT       VALUE 'Y'.   06540000
065500                 88  ASC-NOT-POST-VERIFIED-RECEIPT   VALUE 'N'.   06550000
065600             15  ASC-AUTO-VE-SW                      PIC X(01).   06560000
065700                 88  ASC-AUTO-VE-YES                 VALUE 'Y'.   06570000
065800                 88  ASC-AUTO-VE-NO                  VALUE 'N'.   06580000
065900             15  ASC-FILLER                          PIC X(0978). 06590000
066000                                                                  06600000
066100                                                                  06610000
066200     EJECT                                                        06620000
066300*----------------------------------------------------------------*06630000
066400*    COMMAREA FOR TMKCS520.                                      *06640000
066500*----------------------------------------------------------------*06650000
066600                                                                  06660000
066700     COPY TMWS500.                                                06670000
066800******************************************************************06680000
066900*    HELD TROUBLE SCREEN                                          06690000
067000******************************************************************06700000
067100     COPY TMWS003.                                                06710000
067200                                                                  06720000
067300*---------------------------------------------------------------* 06730000
067400*    ABEND PROCESSING COPYBOOK.                                 * 06740000
067500*---------------------------------------------------------------* 06750000
067600                                                                  06760000
067700     COPY DPWS013.                                                06770000
067800                                                                  06780000
067900 EJECT                                                            06790000
067910***************************************************************** 06791000
067920*    DB2 AREA FOR THE PO/RMS ROLLOUT CONTROL TABLE              * 06792000
067930*    (POT_RMS_RLOUT_CTL)                                        * 06793000
067940***************************************************************** 06794000
067950     EXEC SQL                                                     06795000
067960          INCLUDE POT00006                                        06796000
067970     END-EXEC.                                                    06797000
067980*---------------------------------------------------------------* 06798000
067990*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 06799000
068000*---------------------------------------------------------------* 06800000
068100     EXEC SQL                                                     06810000
068200          INCLUDE TPURCHS                                         06820000
068300     END-EXEC.                                                    06830000
068400*---------------------------------------------------------------* 06840000
068500*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 06850000
068600*---------------------------------------------------------------* 06860000
068700     EXEC SQL                                                     06870000
068800          INCLUDE TPURITM                                         06880000
068900     END-EXEC.                                                    06890000
069000*---------------------------------------------------------------* 06900000
069100*    DB2 AREA FOR PURCHASE ORDER PRE PACK TABLE                 * 06910000
069200*---------------------------------------------------------------* 06920000
069300     EXEC SQL                                                     06930000
069400          INCLUDE TPOPRPK                                         06940000
069500     END-EXEC.                                                    06950000
069600/                                                                 06960000
069700*---------------------------------------------------------------* 06970000
069800*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 06980000
069900*---------------------------------------------------------------* 06990000
070000     EXEC SQL                                                     07000000
070100          INCLUDE TRECEIV                                         07010000
070200     END-EXEC.                                                    07020000
070300*---------------------------------------------------------------* 07030000
070400*    DB2 AREA FOR RECEIPT ITEM TABLE                            * 07040000
070500*---------------------------------------------------------------* 07050000
070600     EXEC SQL                                                     07060000
070700          INCLUDE TRECITM                                         07070000
070800     END-EXEC.                                                    07080000
070900*---------------------------------------------------------------* 07090000
071000*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 07100000
071100*---------------------------------------------------------------* 07110000
071200     EXEC SQL                                                     07120000
071300          INCLUDE TRECDIS                                         07130000
071400     END-EXEC.                                                    07140000
071500*---------------------------------------------------------------* 07150000
071600*    DB2 AREA FOR RECEIPT VERIFIED ODD UNITS TABLE              * 07160000
071700*    (RCT_VRFD_ODD_UNT)                                         * 07170000
071800*---------------------------------------------------------------* 07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE RCT00009                                        07200000
072100     END-EXEC.                                                    07210000
072200*---------------------------------------------------------------* 07220000
072300*    DB2 AREA FOR DIST HEADER                                   * 07230000
072400*---------------------------------------------------------------* 07240000
072500     EXEC SQL                                                     07250000
072600          INCLUDE TDISTHD                                         07260000
072700     END-EXEC.                                                    07270000
072800*---------------------------------------------------------------* 07280000
072900*    DB2 AREA FOR DIST DETAIL                                   * 07290000
073000*---------------------------------------------------------------* 07300000
073100     EXEC SQL                                                     07310000
073200          INCLUDE TDISTDT                                         07320000
073300     END-EXEC.                                                    07330000
073400******************************************************************07340000
073500*    DB2 DCLGEN FOR TRECDVS TABLE                                 07350000
073600******************************************************************07360000
073700     EXEC SQL                                                     07370000
073800          INCLUDE TRECDVS                                         07380000
073900     END-EXEC.                                                    07390000
074000******************************************************************07400000
074100*    DB2 DCLGEN FOR SUT_OTBND_UPC                                 07410000
074200******************************************************************07420000
074300     EXEC SQL                                                     07430000
074400          INCLUDE SUT00028                                        07440000
074500     END-EXEC.                                                    07450000
074600******************************************************************07460000
074700*    DB2 DCLGEN FOR SUT_OTBND_CART                                07470000
074800******************************************************************07480000
074900     EXEC SQL                                                     07490000
075000          INCLUDE SUT00024                                        07500000
075100     END-EXEC.                                                    07510000
075200*----------------------------------------------------------------*07520000
075300*    DB2 DCLGEN FOR THE XLT_LOC DATABASE                          07530000
075400*----------------------------------------------------------------*07540000
075500     EXEC SQL                                                     07550000
075600          INCLUDE XLT00010                                        07560000
075700     END-EXEC.                                                    07570000
075800*---------------------------------------------------------------* 07580000
075900*    DB2 AREA FOR COMMUNICATIONS                                * 07590000
076000*---------------------------------------------------------------* 07600000
076100     EXEC SQL                                                     07610000
076200          INCLUDE SQLCA                                           07620000
076300     END-EXEC.                                                    07630000
076400                                                                  07640000
076500*---------------------------------------------------------------* 07650000
076600                                                                  07660000
076700     EXEC SQL                                                     07670000
076800          DECLARE PACK-SLIP-CSR CURSOR                            07680000
076900          FOR SELECT DISTINCT                                     07690000
077000                B.STATUS_CDE                                      07700000
077100              , B.VRFD_USR_ID                                     07710000
077200              , SUM(D.EXPTED_ITM_QTY)                             07720000
077300              , SUM(D.VERIFY_ITM_QTY)                             07730000
077400              , E.DEPT_NBR                                        07740000
077500              , B.PREPK_ID                                        07750000
077600          FROM    TRECEIV  A                                      07760000
077700              ,   TRECITM  B                                      07770000
077800              ,   TRECDIS  D                                      07780000
077900              ,   TPURCHS  E                                      07790000
078000          WHERE A.ORD_NBR          =  :DK-PO-NBR                  07800000
078100           AND  A.ORD_NBR          =  B.ORD_NBR                   07810000
078200           AND  A.ORD_NBR          =  D.ORD_NBR                   07820000
078300           AND  A.ORD_NBR          =  E.PO_NBR                    07830000
078400           AND  A.VER_STATUS_CDE   =  'A'                         07840000
078500           AND  B.VER_STATUS_CDE   =  'A'                         07850000
078600           AND  E.VER_STATUS_CDE   =  'A'                         07860000
078700           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             07870000
078800           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               07880000
078900           AND  A.OPER_UNT_ID      =  D.OPER_UNT_ID               07890000
079000           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                07900000
079100           AND  A.FCLTY_ID         =  B.FCLTY_ID                  07910000
079200           AND  B.FCLTY_ID         =  D.FCLTY_ID                  07920000
079300           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             07930000
079400           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               07940000
079500           AND  A.REC_SEQ_NBR      =  D.REC_SEQ_NBR               07950000
079600           AND  B.ORD_LNE_NBR      =  D.ORD_LNE_NBR               07960000
079700           AND  D.STR_NBR          =  :DK-STR-NBR                 07970000
079800          GROUP BY                                                07980000
079900                B.PREPK_ID                                        07990000
080000              , E.DEPT_NBR                                        08000000
080100              , B.STATUS_CDE                                      08010000
080200              , B.VRFD_USR_ID                                     08020000
080300          ORDER BY                                                08030000
080400                B.PREPK_ID                                        08040000
080500              , E.DEPT_NBR                                        08050000
080600              , B.STATUS_CDE                                      08060000
080700              , B.VRFD_USR_ID                                     08070000
080800     END-EXEC.                                                    08080000
080900                                                                  08090000
081000******************************************************************08100000
081100*    DB2 CURSOR DEFINITION FOR RETRIEVAL RECDVS ROWS              08110000
081200******************************************************************08120000
081300     EXEC SQL                                                     08130000
081400          DECLARE RECDVS-CURSOR CURSOR FOR                        08140000
081500          SELECT                                                  08150000
081600                  VRFY_SRC_CDE                                    08160000
081700                , EXPTED_ITM_QTY                                  08170000
081800                , VRFY_ITM_QTY                                    08180000
081900            FROM                                                  08190000
082000                  TRECDVS                                         08200000
082100            WHERE                                                 08210000
082200                  ORD_NBR          = :DK-PO-NBR                   08220000
082300              AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR              08230000
082400              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            08240000
082500              AND STR_NBR          = :DK-STR-NBR                  08250000
082600              AND VER_STAT_CDE     = 'A'                          08260000
082700              AND VRFY_SRC_CDE     IN ('P2','CP')                 08270000
082800     END-EXEC.                                                    08280000
082900                                                                  08290000
083000     EXEC SQL                                                     08300000
083100          DECLARE PACK-CURSOR CURSOR WITH HOLD FOR                08310000
083200          SELECT                                                  08320000
083300                 'A'                                              08330000
083400              ,  A.ORD_LNE_NBR                                    08340000
083500              ,  A.VERIFY_ITM_QTY                                 08350000
083600              ,  A.AP_VERIFY_ITM_QTY                              08360000
083700              ,  B.PREPK_RATO_QTY                                 08370000
083800              ,  B.STATUS_CDE                                     08380000
083900              ,  B.PREPK_DRV_LNE_CDE                              08390000
084000          FROM                                                    08400000
084100                 TRECDIS A                                        08410000
084200              ,  TRECITM  B                                       08420000
084300          WHERE                                                   08430000
084400                A.ORD_NBR          =  :DK-PO-NBR                  08440000
084500           AND  A.ORD_NBR          =  B.ORD_NBR                   08450000
084600           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             08460000
084700           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               08470000
084800           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                08480000
084900           AND  A.FCLTY_ID         =  B.FCLTY_ID                  08490000
085000           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             08500000
085100           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               08510000
085200           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               08520000
085400           AND  A.STR_NBR          =  :DK-STR-NBR                 08540000
085500           AND  B.VER_STATUS_CDE   =  'A'                         08550000
085600           AND  B.PREPK_ID         = :DK-UPDATE-PACK-ID           08560000
085700        UNION                                                     08570000
085800          SELECT                                                  08580000
085900                 'B'                                              08590000
086000              ,  A.ORD_LNE_NBR                                    08600000
086100              ,  0                                                08610000
086200              ,  0                                                08620000
086300              ,  A.PREPK_RATO_QTY                                 08630000
086400              ,  A.STATUS_CDE                                     08640000
086410              ,  A.PREPK_DRV_LNE_CDE                              08641000
086420          FROM                                                    08642000
086430                 TRECITM A                                        08643000
086440          WHERE                                                   08644000
086450                A.ORD_NBR          =  :DK-PO-NBR                  08645000
086460           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             08646000
086470           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                08647000
086480           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             08648000
086490           AND  A.PREPK_ID         =  :DK-UPDATE-PACK-ID          08649000
086491           AND  A.VER_STATUS_CDE   =  'A'                         08649100
086492           AND NOT EXISTS                                         08649200
086493               (SELECT *                                          08649300
086494                FROM TRECDIS B                                    08649400
086495         WHERE  A.ORD_NBR          =  B.ORD_NBR                   08649500
086496           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               08649600
086497           AND  A.FCLTY_ID         =  B.FCLTY_ID                  08649700
086498           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               08649800
086499           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               08649900
086500           AND  B.STR_NBR          =  :DK-STR-NBR)                08650004
086502     END-EXEC.                                                    08650200
086503                                                                  08650300
086504 EJECT                                                            08650400
086505 LINKAGE SECTION.                                                 08650500
086506                                                                  08650600
086507 01  DFHCOMMAREA.                                                 08650700
086508     05  FILLER                         OCCURS  1 TO 4072 TIMES   08650800
086509                                        DEPENDING ON EIBCALEN.    08650900
086510         10  FILLER                     PIC X.                    08651000
086520                                                                  08652000
086530 EJECT                                                            08653000
086540 PROCEDURE DIVISION.                                              08654000
086550******************************************************************08655000
086560**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08656000
086570**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08657000
086580**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08658000
086590******************************************************************08659000
086600 0000-MAIN-MODULE.                                                08660000
086700     INITIALIZE DP030-CICS-API-FIELDS.                            08670000
086800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08680000
086900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08690000
087000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08700000
087100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08710000
087200     MOVE LENGTH OF RC820AI        TO DP030-MAP-LENGTH (1).       08720000
087300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08730000
087400     PERFORM 0001-CALL-CICS-ARCH-API.                             08740000
087500*                                                                 08750000
087600     PERFORM 1000-CONTROL-PROCESSING                              08760000
087700*                                                                 08770000
087800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08780000
087900     PERFORM 0001-CALL-CICS-ARCH-API.                             08790000
088000                                                                  08800000
088100******************************************************************08810000
088200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08820000
088300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08830000
088400******************************************************************08840000
088500 0001-CALL-CICS-ARCH-API.                                         08850000
088610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08861003
088700                                    DFHCOMMAREA                   08870003
088800                                    DP030-CICS-API-FIELDS         08880003
088900                                    DP020-STANDARD-COMMAREA       08890003
089000                                    RC820AI.                      08900003
089100*                                                                 08910000
089200     IF  DP030-RC-CALL-SUCCESSFUL                                 08920000
089300         CONTINUE                                                 08930000
089400     ELSE                                                         08940000
089500         SET DP013-NO-ROLLBACK                                    08950000
089600             DP013-XCTL-DISPLAY-RESTART                           08960000
089700             DP013-CICS-ABEND      TO TRUE                        08970000
089800         MOVE '0001-CALL-CICS-ARCH-API'                           08980000
089900                                   TO DP013-PARAGRAPH             08990000
089920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O08992003
089930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08993003
090200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09020000
090300         PERFORM DP013-0000-PROCESS-ABEND                         09030000
090400     END-IF.                                                      09040000
090500*----------------------------------------------------------------*09050000
090600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09060000
090700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09070000
090800*                                                                *09080000
090900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09090000
091000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09100000
091100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09110000
091200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09120000
091300*----------------------------------------------------------------*09130000
091400                                                                  09140000
091500 1000-CONTROL-PROCESSING.                                         09150000
091600                                                                  09160000
091700     EVALUATE TRUE                                                09170000
091800         WHEN DP020-NEXT-ACT-INITIAL                              09180000
091900             INITIALIZE ASC-SPECIFIC-COMMAREA                     09190000
092000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09200000
092100                                      ASC-SEL-TERM-ID             09210000
092200                                      ASC-VRFY-ADJ-TERM-ID        09220000
092300             MOVE DP020-SRC-TASK-NUMBER                           09230000
092400                                   TO ASC-LIST-TASK-NUMBER        09240000
092500                                      ASC-SEL-TASK-NUMBER         09250000
092600                                      ASC-VRFY-ADJ-TASK-NUMBER    09260000
092700             MOVE PC-LIST-QUEUE-SEQ                               09270000
092800                                   TO ASC-LIST-SEQ                09280000
092900             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09290000
093000             MOVE PC-VRFY-ADJ-QUEUE-SEQ                           09300000
093100                                   TO ASC-VRFY-ADJ-SEQ            09310000
093200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09320000
093300***-----$TEMPLATE NOTE$-------------------------------------------09330000
093400*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09340000
093500*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09350000
093600*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09360000
093700***---------------------------------------------------------------09370000
093800             IF  PS-COMMAREA-NOT-VALID                            09380000
093900***              MOVE PC-TSYMSG-99901                             09390000
094000***                                TO DP020-MSG-NUMBER            09400000
094100***              SET DP020-MSG-FATAL                              09410000
094200***                                TO TRUE                        09420000
094300                 SET DP020-NEXT-ACT-APPL-ERROR                    09430000
094400                                   TO TRUE                        09440000
094500             ELSE                                                 09450000
094600                 PERFORM 4000-BUILD-INITIAL-PANEL                 09460000
094700             END-IF                                               09470000
094800                                                                  09480000
094900         WHEN DP020-NEXT-ACT-READ-MAP                             09490000
095000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09500000
095100                                   TO PV-TOP-ITEM                 09510000
095200             PERFORM 2000-PROCESS-PANEL                           09520000
095300                                                                  09530000
095400         WHEN DP020-NEXT-ACT-RETURN                               09540000
095500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09550000
095600                                   TO PV-TOP-ITEM                 09560000
095700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09570000
095800             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09580000
095900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09590000
096000*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09600000
096100                                                                  09610000
096200         WHEN OTHER                                               09620000
096300             SET DP013-LOGIC-ABEND TO TRUE                        09630000
096400             SET DP013-NO-ROLLBACK TO TRUE                        09640000
096500             MOVE '1000-CONTROL-PROCESSING'                       09650000
096600                                   TO DP013-PARAGRAPH             09660000
096700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09670000
096800                                   TO DP013-MESSAGE-TEXT(1)       09680000
096900             PERFORM DP013-0000-PROCESS-ABEND                     09690000
097000     END-EVALUATE.                                                09700000
097100                                                                  09710000
097200 EJECT                                                            09720000
097300*----------------------------------------------------------------*09730000
097400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *09740000
097500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *09750000
097600*----------------------------------------------------------------*09760000
097700                                                                  09770000
097800 1100-PROCESS-INTER-APPL-COMM.                                    09780000
097900                                                                  09790000
098000     SET PS-COMMAREA-VALID         TO TRUE.                       09800000
098100     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     09810000
098200                                                                  09820000
098300                                                                  09830000
098400     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT OR       09840000
098500         DP020-INT-APPL-FORMAT-IND = PC-POST-VERFY-INTER-LIST-FMT 09850000
098600         IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT      09860000
098700             SET ASC-NOT-POST-VERIFIED-RECEIPT  TO TRUE           09870000
098800         ELSE                                                     09880000
098900             SET ASC-POST-VERIFIED-RECEIPT      TO TRUE           09890000
099000         END-IF                                                   09900000
099100                                                                  09910000
099200         MOVE RC017-OPER-UNT-ID    TO  ASC-OPER-UNT-ID            09920000
099300                                       DK-OPER-UNT-ID             09930000
099400         MOVE RC017-FCLTY-ID       TO  ASC-FCLTY-ID               09940000
099500                                       DK-FCLTY-ID                09950000
099600         MOVE RC017-PO-NBR         TO  ASC-PO-NBR                 09960000
099700                                       DK-PO-NBR                  09970000
099800         MOVE RC017-REC-SEQ-NBR    TO  ASC-REC-SEQ-NBR            09980000
099900                                       DK-REC-SEQ-NBR             09990000
100000         MOVE RC017-FCLTY-NME      TO  ASC-FCLTY-NME              10000000
100100         MOVE RC017-PO-LNE-NBR     TO  ASC-PO-LNE-NBR             10010000
100200         MOVE RC017-STR-NBR        TO  ASC-STR-NBR                10020000
100300         MOVE RC017-TRB-QUEUE-NAME TO  ASC-TRB-QUEUE-NAME-IN      10030000
100400     END-IF.                                                      10040000
100500 EJECT                                                            10050000
100600*----------------------------------------------------------------*10060000
100700*    ENTRY IS FROM A LIST.  GET THE KEY INFORMATION FROM THE     *10070000
100800*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *10080000
100900*----------------------------------------------------------------*10090000
101000 1120-PREPARE-LIST-ENTRY.                                         10100000
101100                                                                  10110000
101200     MOVE RC037-MAX-ITEMS          TO ASC-SEL-SUB.                10120000
101300     MOVE ZERO                     TO ASC-SEL-ITEM.               10130000
101400     PERFORM 1200-GET-NEXT-RECORD.                                10140000
101500                                                                  10150000
101600*----------------------------------------------------------------*10160000
101700*    GET THE DATA (KEY) OF THE NEXT SELECTED OBJECT              *10170000
101800*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *10180000
101900*----------------------------------------------------------------*10190000
102000 1200-GET-NEXT-RECORD.                                            10200000
102100                                                                  10210000
102200     ADD +1                        TO ASC-SEL-SUB.                10220000
102300     IF  ASC-SEL-SUB > RC037-MAX-ITEMS                            10230000
102400         ADD +1                    TO ASC-SEL-ITEM                10240000
102500         MOVE +1                   TO ASC-SEL-SUB                 10250000
102600     END-IF.                                                      10260000
102700                                                                  10270000
102800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10280000
102900         PERFORM 9100-READ-SEL-QUEUE                              10290000
103000         IF  RC037-ITEM (ASC-SEL-SUB) > ZERO                      10300000
103100             MOVE RC037-OPER-UNT-ID (ASC-SEL-SUB)                 10310000
103200                                   TO ASC-OPER-UNT-ID             10320000
103300             MOVE RC037-FCLTY-ID (ASC-SEL-SUB)                    10330000
103400                                   TO ASC-FCLTY-ID                10340000
103500             MOVE RC037-PO-NBR (ASC-SEL-SUB)                      10350000
103600                                   TO ASC-PO-NBR                  10360000
103700             MOVE RC037-REC-SEQ-NBR (ASC-SEL-SUB)                 10370000
103800                                   TO ASC-REC-SEQ-NBR             10380000
103900             MOVE RC037-STR-NBR (ASC-SEL-SUB)                     10390000
104000                                   TO DK-STR-NBR                  10400000
104100                                      ASC-STR-NBR                 10410000
104200             SET RC037-INQ (ASC-SEL-SUB)                          10420000
104300                                   TO TRUE                        10430000
104400             PERFORM 9200-REWRITE-SEL-QUEUE                       10440000
104500         ELSE                                                     10450000
104600             SUBTRACT +1 FROM ASC-SEL-SUB                         10460000
104700*            --- BOTTOM OF LIST ---                               10470000
104800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10480000
104900             SET DP020-MSG-INFORMATIONAL                          10490000
105000                                   TO TRUE                        10500000
105100         END-IF                                                   10510000
105200     ELSE                                                         10520000
105300         SUBTRACT +1 FROM ASC-SEL-ITEM                            10530000
105400         MOVE RC037-MAX-ITEMS      TO ASC-SEL-SUB                 10540000
105500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10550000
105600         SET DP020-MSG-INFORMATIONAL                              10560000
105700                                   TO TRUE                        10570000
105800     END-IF.                                                      10580000
105900                                                                  10590000
106000/                                                                 10600000
106100*----------------------------------------------------------------*10610000
106200*    GET THE DATA (KEY) OF THE PREVIOUS SELECTED OBJECT          *10620000
106300*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *10630000
106400*----------------------------------------------------------------*10640000
106500 1300-GET-PREV-RECORD.                                            10650000
106600                                                                  10660000
106700     SUBTRACT +1 FROM ASC-SEL-SUB.                                10670000
106800     IF  ASC-SEL-SUB < +1                                         10680000
106900         SUBTRACT +1 FROM ASC-SEL-ITEM                            10690000
107000         MOVE RC037-MAX-ITEMS      TO ASC-SEL-SUB                 10700000
107100     END-IF.                                                      10710000
107200                                                                  10720000
107300     IF  ASC-SEL-ITEM > ZERO                                      10730000
107400         PERFORM 9100-READ-SEL-QUEUE                              10740000
107500             MOVE RC037-OPER-UNT-ID (ASC-SEL-SUB)                 10750000
107600                                   TO ASC-OPER-UNT-ID             10760000
107700             MOVE RC037-FCLTY-ID (ASC-SEL-SUB)                    10770000
107800                                   TO ASC-FCLTY-ID                10780000
107900             MOVE RC037-PO-NBR (ASC-SEL-SUB)                      10790000
108000                                   TO ASC-PO-NBR                  10800000
108100             MOVE RC037-REC-SEQ-NBR (ASC-SEL-SUB)                 10810000
108200                                   TO ASC-REC-SEQ-NBR             10820000
108300     ELSE                                                         10830000
108400         MOVE +1                   TO ASC-SEL-ITEM                10840000
108500                                      ASC-SEL-SUB                 10850000
108600*        --- TOP OF LIST ---                                      10860000
108700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10870000
108800         SET DP020-MSG-INFORMATIONAL                              10880000
108900                                   TO TRUE                        10890000
109000     END-IF.                                                      10900000
109100                                                                  10910000
109200*----------------------------------------------------------------*10920000
109300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10930000
109400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10940000
109500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10950000
109600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10960000
109700* FUNCTION KEYS CAN GET THIS FAR.                                *10970000
109800*----------------------------------------------------------------*10980000
109900                                                                  10990000
110000 2000-PROCESS-PANEL.                                              11000000
110100     EVALUATE TRUE                                                11010000
110200         WHEN DP020-SRC-AID = DP016-CLEAR                         11020000
110300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11030000
110400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11040000
110500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11050000
110600                                                                  11060000
110700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11070000
110800             PERFORM 2050-DELETE-LIST-QUEUE                       11080000
110900             PERFORM 4000-BUILD-INITIAL-PANEL                     11090000
111000                                                                  11100000
111100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11110000
111200             PERFORM 2140-DESELECT-ALL-ITEMS                      11120000
111300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11130000
111400                                                                  11140000
111500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11150000
111600             PERFORM 2150-SELECT-ALL-ITEMS                        11160000
111700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11170000
111800                                                                  11180000
111900                                                                  11190000
112000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11200000
112100              IF ASC-USE-SELECTION-QUEUE                          11210000
112200                 PERFORM 1200-GET-NEXT-RECORD                     11220000
112300                 MOVE ASC-OPER-UNT-ID     TO DK-OPER-UNT-ID       11230000
112400                 MOVE ASC-FCLTY-ID        TO DK-FCLTY-ID          11240000
112500                 MOVE ASC-PO-NBR          TO DK-PO-NBR            11250000
112600                 MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR           11260000
112700                 IF  PS-ERROR                                     11270000
112800                     SET RC037-ERR (ASC-SEL-SUB)                  11280000
112900                                              TO TRUE             11290000
113000                     PERFORM 9200-REWRITE-SEL-QUEUE               11300000
113100                 ELSE                                             11310000
113200                     PERFORM 4000-BUILD-INITIAL-PANEL             11320000
113300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11330000
113400*                    PERFORM 3200-RESET-ATTRIBUTES                11340000
113500                 END-IF                                           11350000
113600              ELSE                                                11360000
113700*                --- BOTTOM OF LIST ---                           11370000
113800                 MOVE PC-TSYMSG-00070                             11380000
113900                                   TO DP020-MSG-NUMBER            11390000
114000                 SET DP020-MSG-INFORMATIONAL                      11400000
114100                                   TO TRUE                        11410000
114200              END-IF                                              11420000
114300                                                                  11430000
114400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11440000
114500              IF ASC-USE-SELECTION-QUEUE                          11450000
114600                 PERFORM 1300-GET-PREV-RECORD                     11460000
114700                 MOVE ASC-OPER-UNT-ID     TO DK-OPER-UNT-ID       11470000
114800                 MOVE ASC-FCLTY-ID        TO DK-FCLTY-ID          11480000
114900                 MOVE ASC-PO-NBR          TO DK-PO-NBR            11490000
115000                 MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR           11500000
115100                 IF  PS-ERROR                                     11510000
115200                     SET RC037-ERR (ASC-SEL-SUB)                  11520000
115300                                              TO TRUE             11530000
115400                     PERFORM 9200-REWRITE-SEL-QUEUE               11540000
115500                 ELSE                                             11550000
115600                     PERFORM 4000-BUILD-INITIAL-PANEL             11560000
115700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11570000
115800*                    PERFORM 3200-RESET-ATTRIBUTES                11580000
115900                 END-IF                                           11590000
116000              ELSE                                                11600000
116100*                --- TOP OF LIST ---                              11610000
116200                 MOVE PC-TSYMSG-00069                             11620000
116300                                   TO DP020-MSG-NUMBER            11630000
116400                 SET DP020-MSG-INFORMATIONAL                      11640000
116500                                   TO TRUE                        11650000
116600              END-IF                                              11660000
116700                                                                  11670000
116800         WHEN OTHER                                               11680000
116900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11690000
117000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11700000
117100             IF  PS-NO-ERROR                                      11710000
117200                 SET DP030-CONTINUE-GO                            11720000
117300                                 TO TRUE                          11730000
117400                 PERFORM 2100-CHECK-FUNCTION-KEY                  11740000
117500             ELSE                                                 11750000
117600                 SET DP030-OVERRIDE-GO                            11760000
117700                                 TO TRUE                          11770000
117800             END-IF                                               11780000
117900     END-EVALUATE.                                                11790000
118000 EJECT                                                            11800000
118100*----------------------------------------------------------------*11810000
118200*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11820000
118300*----------------------------------------------------------------*11830000
118400 2050-DELETE-LIST-QUEUE.                                          11840000
118500                                                                  11850000
118600     EXEC CICS                                                    11860000
118700         DELETEQ TS                                               11870000
118800             QUEUE (ASC-LIST-QUEUE-NAME)                          11880000
118900             RESP  (PV-CICS-RESP)                                 11890000
119000     END-EXEC.                                                    11900000
119100                                                                  11910000
119200     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11920000
119300        (PV-CICS-RESP = DFHRESP(QIDERR))                          11930000
119400         CONTINUE                                                 11940000
119500     ELSE                                                         11950000
119600         SET DP013-CICS-ABEND      TO TRUE                        11960000
119700         SET DP013-NO-ROLLBACK     TO TRUE                        11970000
119800                                                                  11980000
119900         MOVE '2050-DELETE-LIST-QUEUE'                            11990000
120000                                   TO DP013-PARAGRAPH             12000000
120100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12010000
120200                                   TO DP013-MESSAGE-TEXT (1)      12020000
120300         PERFORM DP013-0000-PROCESS-ABEND                         12030000
120400     END-IF.                                                      12040000
120500                                                                  12050000
120600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12060000
120700 EJECT                                                            12070000
120800*----------------------------------------------------------------*12080000
120900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12090000
121000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12100000
121100* CICS ARCHITECTURE API.                                         *12110000
121200*----------------------------------------------------------------*12120000
121300 2100-CHECK-FUNCTION-KEY.                                         12130000
121400     EVALUATE TRUE                                                12140000
121500****    PF14  GO TO RECEIVER PACK LIST                            12150000
121600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12160000
121700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12170000
121800                 INITIALIZE RC800-INTER-APPL-COMMAREA             12180000
121900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12190000
122000                                TO RC036-NUMBER-OF-SELECTED-ITEMS 12200000
122100                 SET ASC-RETURNING-FROM-RCVG TO TRUE              12210000
122200                 PERFORM 5000-PREPARE-SEL-QUEUE                   12220000
122300             ELSE                                                 12230000
122400                 SET DP030-OVERRIDE-GO                            12240000
122500                                   TO TRUE                        12250000
122600                 MOVE PC-TSYMSG-00057                             12260000
122700                                   TO DP020-MSG-NUMBER            12270000
122800                 SET DP020-MSG-WARNING                            12280000
122900                                   TO TRUE                        12290000
123000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12300000
123100             END-IF                                               12310000
123200                                                                  12320000
123300****    PF15  UPDATE                                              12330000
123400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12340000
123500             IF ASC-RECEIV-STATUS-CDE = 'VE' AND                  12350000
123600                ASC-RECEIV-ML-POST-TMST NOT =                     12360000
123700                                      PC-DB2-DEFAULT-TMST AND     12370000
123800                ASC-NOT-POST-VERIFIED-RECEIPT                     12380000
123900                 SET DP030-OVERRIDE-GO                            12390000
124000                                   TO TRUE                        12400000
124100                 MOVE PC-TSYMSG-03082                             12410000
124200                                   TO DP020-MSG-NUMBER            12420000
124300                 SET DP020-MSG-WARNING                            12430000
124400                                   TO TRUE                        12440000
124500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12450000
124600             ELSE                                                 12460000
124700                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          12470000
124800                     IF ASC-CONFIRM-UPDATE                        12480000
124900                        SET ASC-CONFIRMED TO TRUE                 12490000
124910                        MOVE PC-TSYMSG-01817                      12491000
124920                                    TO  DP020-MSG-NUMBER          12492000
124930                        SET PS-ERROR                              12493000
124940                            DP030-OVERRIDE-GO                     12494000
124950                            DP020-MSG-WARNING TO TRUE             12495000
124960                        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN      12496000
124970                     ELSE                                         12497000
124980                         MOVE ASC-NUMBER-OF-SELECTED-ITEMS        12498000
124990                                TO RC036-NUMBER-OF-SELECTED-ITEMS 12499000
125000                         PERFORM 5000-PREPARE-SEL-QUEUE           12500000
125100                     END-IF                                       12510000
125200                 ELSE                                             12520000
125300                     SET DP030-OVERRIDE-GO                        12530000
125400                                       TO TRUE                    12540000
125500                     MOVE PC-TSYMSG-00057                         12550000
125600                                       TO DP020-MSG-NUMBER        12560000
125700                     SET DP020-MSG-WARNING                        12570000
125800                                       TO TRUE                    12580000
125900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12590000
126000                 END-IF                                           12600000
126100             END-IF                                               12610000
126200                                                                  12620000
126300****    PF18  GO TO NOTIF/TRBL DC LIST                            12630000
126400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12640000
126500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12650000
126600                 INITIALIZE TM001-INTER-APPL-COMMAREA             12660000
126700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12670000
126800                                TO RC036-NUMBER-OF-SELECTED-ITEMS 12680000
126900                 SET ASC-RETURNING-FROM-TRBL TO TRUE              12690000
127000                 PERFORM 5000-PREPARE-SEL-QUEUE                   12700000
127100             ELSE                                                 12710000
127200                 SET DP030-OVERRIDE-GO                            12720000
127300                                   TO TRUE                        12730000
127400                 MOVE PC-TSYMSG-00057                             12740000
127500                                   TO DP020-MSG-NUMBER            12750000
127600                 SET DP020-MSG-WARNING                            12760000
127700                                   TO TRUE                        12770000
127800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12780000
127900             END-IF                                               12790000
128000                                                                  12800000
128100****    PF23  GO TO STORE PACK ITEM LIST VERIFY                   12810000
128200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              12820000
128300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12830000
128400                 INITIALIZE RC036-INTER-APPL-COMMAREA             12840000
128500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12850000
128600                                TO RC036-NUMBER-OF-SELECTED-ITEMS 12860000
128700                 SET ASC-RETURNING-FROM-STR-PACK TO TRUE          12870000
128800                 PERFORM 5000-PREPARE-SEL-QUEUE                   12880000
128900             ELSE                                                 12890000
129000                 SET DP030-OVERRIDE-GO                            12900000
129100                                   TO TRUE                        12910000
129200                 MOVE PC-TSYMSG-00057                             12920000
129300                                   TO DP020-MSG-NUMBER            12930000
129400                 SET DP020-MSG-WARNING                            12940000
129500                                   TO TRUE                        12950000
129600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12960000
129700             END-IF                                               12970000
129800                                                                  12980000
129900****    PF24 SELECT ALL 0                                         12990000
130000         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              13000000
130100             IF ASC-RECEIV-STATUS-CDE = 'VE' AND                  13010000
130200                ASC-RECEIV-ML-POST-TMST NOT =                     13020000
130300                                      PC-DB2-DEFAULT-TMST AND     13030000
130400                ASC-NOT-POST-VERIFIED-RECEIPT                     13040000
130500                 SET DP030-OVERRIDE-GO                            13050000
130600                                   TO TRUE                        13060000
130700                 MOVE PC-TSYMSG-03082                             13070000
130800                                   TO DP020-MSG-NUMBER            13080000
130810                 SET DP020-MSG-WARNING                            13081000
130820                                   TO TRUE                        13082000
130830                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13083000
130840             ELSE                                                 13084000
130850                 PERFORM 2150-SELECT-ALL-ITEMS                    13085000
130860                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13086000
130870             END-IF                                               13087000
130880                                                                  13088000
130890* CONFIRM                                                         13089000
130891         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    13089100
130892             IF ASC-NOT-CONFIRMED                                 13089200
130893                 MOVE PC-TSYMSG-00045   TO  DP020-MSG-NUMBER      13089300
130894                 SET DP020-MSG-FATAL                              13089400
130895                             PS-ERROR        TO  TRUE             13089500
130896             ELSE                                                 13089600
130897                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          13089700
130898                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            13089800
130899                            TO RC036-NUMBER-OF-SELECTED-ITEMS     13089900
130900                     PERFORM 5000-PREPARE-SEL-QUEUE               13090000
131000                 ELSE                                             13100000
131100                     SET DP030-OVERRIDE-GO                        13110000
131200                                       TO TRUE                    13120000
131300                     MOVE PC-TSYMSG-00057                         13130000
131400                                       TO DP020-MSG-NUMBER        13140000
131500                     SET DP020-MSG-WARNING                        13150000
131600                                       TO TRUE                    13160000
131700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13170000
131800                 END-IF                                           13180000
131810             END-IF                                               13181000
131820                                                                  13182000
131830         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13183000
131840             MOVE +1               TO PV-TOP-ITEM                 13184000
131850             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13185000
131860                                                                  13186000
131870         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13187000
131871             PERFORM 2110-BROWSE-BACKWARD                         13187100
131872             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13187200
131873                                                                  13187300
131874         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13187400
131875             PERFORM 2120-BROWSE-FORWARD                          13187500
131876             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13187600
131877                                                                  13187700
131878         WHEN DP020-SRC-AID = DP016-ENTER                         13187800
131879             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13187900
131880             IF  PS-ERROR                                         13188000
131890                 CONTINUE                                         13189000
131900             ELSE                                                 13190000
132000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13200000
132100             END-IF                                               13210000
132200                                                                  13220000
132300********   RESET SWITCHES AFTER UPDATE IS SUCCESSFUL (UNVERIFY)   13230000
132400********         IF  NOT PS-ERROR                                 13240000
132500********             MOVE PC-TSYMSG-00059                         13250000
132600********                           TO  DP020-MSG-NUMBER           13260000
132700********             SET DP020-MSG-INFORMATIONAL                  13270000
132800********                           TO  TRUE                       13280000
132900********             SET ASC-CANT-UNVERIFY                        13290000
133000********                 ASC-NOT-CONFIRM                          13300000
133100********                 ASC-NOT-CONFIRM-ZERO TO TRUE             13310000
133200********         END-IF                                           13320000
133300********                                                          13330000
133400         WHEN OTHER                                               13340000
133500             SET DP013-NO-ROLLBACK                                13350000
133600                 DP013-XCTL-DISPLAY-RESTART                       13360000
133700                 DP013-CICS-ABEND  TO TRUE                        13370000
133800             MOVE '2100-CHECK-FUNCTION-KEY'                       13380000
133900                                   TO DP013-PARAGRAPH             13390000
134000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13400000
134100                                   TO DP013-MESSAGE-TEXT (1)      13410000
134200             PERFORM DP013-0000-PROCESS-ABEND                     13420000
134300     END-EVALUATE.                                                13430000
134400*                                                                 13440000
134500*----------------------------------------------------------------*13450000
134600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13460000
134700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13470000
134800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13480000
134900*    MESSAGE.                                                    *13490000
135000*----------------------------------------------------------------*13500000
135100                                                                  13510000
135200 2110-BROWSE-BACKWARD.                                            13520000
135300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13530000
135400         GIVING PV-TOP-ITEM.                                      13540000
135500*                                                                 13550000
135600     IF  ((PV-TOP-ITEM < +1)                                      13560000
135700       OR (PV-TOP-ITEM = +1))                                     13570000
135800         MOVE +1                   TO PV-TOP-ITEM                 13580000
135900*        -- TOP OF LIST --                                        13590000
136000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13600000
136100         SET DP020-MSG-INFORMATIONAL TO TRUE                      13610000
136200     END-IF.                                                      13620000
136300                                                                  13630000
136400 EJECT                                                            13640000
136500*----------------------------------------------------------------*13650000
136600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13660000
136700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13670000
136800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13680000
136900*----------------------------------------------------------------*13690000
137000                                                                  13700000
137100 2120-BROWSE-FORWARD.                                             13710000
137200                                                                  13720000
137300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13730000
137400         GIVING PV-TOP-ITEM.                                      13740000
137500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13750000
137600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13760000
137700                                   TO PV-TOP-ITEM                 13770000
137800*        -- BOTTOM OF LIST --                                     13780000
137900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13790000
138000         SET DP020-MSG-INFORMATIONAL                              13800000
138100                                   TO TRUE                        13810000
138200     ELSE                                                         13820000
138300         COMPUTE PV-BOTTOM-ITEM =                                 13830000
138400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13840000
138500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13850000
138600*            -- BOTTOM OF LIST --                                 13860000
138700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13870000
138800             SET DP020-MSG-INFORMATIONAL                          13880000
138900                                   TO TRUE                        13890000
139000         END-IF                                                   13900000
139100     END-IF.                                                      13910000
139200 EJECT                                                            13920000
139300*----------------------------------------------------------------*13930000
139400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13940000
139500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13950000
139600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13960000
139700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13970000
139800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13980000
139900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13990000
140000*----------------------------------------------------------------*14000000
140100                                                                  14010000
140200 2130-CHECK-FOR-JUMP-BROWSE.                                      14020000
140300     SET PS-NO-ERROR               TO TRUE.                       14030000
140400     IF (ASC-START-ITEM-REQUEST = SPACE)                          14040000
140500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14050000
140600                                   TO PV-TOP-ITEM                 14060000
140700     ELSE                                                         14070000
140800         MOVE ASC-START-ITEM-REQUEST                              14080000
140900                                   TO DP010I-UNEDITED-FIELD       14090000
141000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       14100000
141100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14110000
141200         SET DP010I-NEGATIVE-NOT-ALLOWED                          14120000
141300                                   TO TRUE                        14130000
141410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14141002
141420              USING DP010I-NUMERIC-EDIT-AREA                      14142002
141500                                                                  14150000
141600         IF  NOT DP010I-ERROR-DETECTED                            14160000
141700             MOVE DP010I-NUMERIC-FIELD                            14170000
141800                                   TO  ASC-START-ITEM-REQUEST-N   14180000
141900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14190000
142000                 IF  ASC-START-ITEM-REQUEST-N >                   14200000
142100                                          ASC-NUMBER-OF-ITEMS-READ14210000
142200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14220000
142300                     COMPUTE PV-TOP-ITEM =                        14230000
142400                             ASC-NUMBER-OF-ITEMS-READ             14240000
142500                             - PC-ITEMS-PER-PANEL + 1             14250000
142600                     IF  PV-TOP-ITEM < +1                         14260000
142700                         MOVE +1   TO PV-TOP-ITEM                 14270000
142800                         MOVE PC-TSYMSG-00070                     14280000
142900                                   TO DP020-MSG-NUMBER            14290000
143000                         SET DP020-MSG-INFORMATIONAL              14300000
143100                                   TO TRUE                        14310000
143200                     END-IF                                       14320000
143300                 ELSE                                             14330000
143400                     MOVE ASC-START-ITEM-REQUEST-N                14340000
143500                                   TO PV-TOP-ITEM                 14350000
143600                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14360000
143700                     COMPUTE PV-BOTTOM-ITEM =                     14370000
143800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14380000
143900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14390000
144000*                        -- BOTTOM OF LIST --                     14400000
144100                         MOVE PC-TSYMSG-00070                     14410000
144200                                   TO DP020-MSG-NUMBER            14420000
144300                         SET DP020-MSG-INFORMATIONAL              14430000
144400                                   TO TRUE                        14440000
144500                     END-IF                                       14450000
144600                 END-IF                                           14460000
144700             ELSE                                                 14470000
144800*                --- VALUE OUT OF RANGE ----                      14480000
144900                 MOVE PC-TSYMSG-00101                             14490000
145000                                   TO DP020-MSG-NUMBER            14500000
145100                 MOVE -1           TO ASTRTITL                    14510000
145200                 SET DP030-SET-CURSOR-APPL-1                      14520000
145300                                   TO TRUE                        14530000
145400                 MOVE DP015-REVERSE                               14540000
145500                                   TO ASTRTITH                    14550000
145600                 MOVE DP015-RED    TO ASTRTITC                    14560000
145700                 MOVE DP015-UNP-NUM-BRT-MDT                       14570000
145800                                   TO ASTRTITA                    14580000
145900                 SET DP020-MSG-FATAL                              14590000
146000                                   TO TRUE                        14600000
146100                 SET PS-ERROR      TO TRUE                        14610000
146200             END-IF                                               14620000
146300                                                                  14630000
146400         ELSE                                                     14640000
146500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14650000
146600             MOVE -1               TO ASTRTITL                    14660000
146700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14670000
146800             MOVE DP015-REVERSE    TO ASTRTITH                    14680000
146900             MOVE DP015-RED        TO ASTRTITC                    14690000
147000             MOVE DP015-UNP-NUM-BRT-MDT                           14700000
147100                                   TO ASTRTITA                    14710000
147200             SET DP020-MSG-FATAL   TO TRUE                        14720000
147300             SET PS-ERROR          TO TRUE                        14730000
147400         END-IF                                                   14740000
147500     END-IF.                                                      14750000
147600 EJECT                                                            14760000
147700*----------------------------------------------------------------*14770000
147800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14780000
147900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14790000
148000*----------------------------------------------------------------*14800000
148100 2140-DESELECT-ALL-ITEMS.                                         14810000
148200     MOVE +1                       TO ASC-BLK-SUB.                14820000
148300                                                                  14830000
148400     PERFORM 2141-CLEAR-SELECTED-INDS                             14840000
148500         VARYING ASC-ITEM-SUB                                     14850000
148600         FROM 1 BY 1                                              14860000
148700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14870000
148800                                                                  14880000
148900     ADD +1                        TO ASC-BLK-SUB.                14890000
149000                                                                  14900000
149100     PERFORM 2141-CLEAR-SELECTED-INDS                             14910000
149200         VARYING ASC-ITEM-SUB                                     14920000
149300         FROM 1 BY 1                                              14930000
149400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14940000
149500                                                                  14950000
149600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14960000
149700                                   TO PV-LIST-ITEM-NUMBER.        14970000
149800                                                                  14980000
149900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14990000
150000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15000000
150100                                                                  15010000
150200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15020000
150300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15030000
150400         MOVE +1                   TO ASC-BLK-SUB                 15040000
150500                                                                  15050000
150600         PERFORM 5100-WRITE-TEMP-STORAGE                          15060000
150700                                                                  15070000
150800         MOVE +1                   TO PV-BLOCK-NUMBER             15080000
150900                                                                  15090000
151000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15100000
151100             PV-FIRST-BLOCK-IN-ARRAY - 1                          15110000
151200                                                                  15120000
151300         PERFORM                                                  15130000
151400             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15140000
151500                                                                  15150000
151600             PERFORM 4410-READ-TEMP-STORAGE                       15160000
151700                                                                  15170000
151800             PERFORM 2141-CLEAR-SELECTED-INDS                     15180000
151900                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15190000
152000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15200000
152100                                                                  15210000
152200             PERFORM 5100-WRITE-TEMP-STORAGE                      15220000
152300                                                                  15230000
152400             ADD +1                TO PV-BLOCK-NUMBER             15240000
152500                                                                  15250000
152600         END-PERFORM                                              15260000
152700                                                                  15270000
152800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15280000
152900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15290000
153000                                                                  15300000
153100         PERFORM                                                  15310000
153200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15320000
153300                   ASC-HIGHEST-BLOCK-WRITTEN                      15330000
153400                                                                  15340000
153500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15350000
153600                                   TO PV-BLOCK-NUMBER             15360000
153700                                                                  15370000
153800             PERFORM 4410-READ-TEMP-STORAGE                       15380000
153900                                                                  15390000
154000             PERFORM 2141-CLEAR-SELECTED-INDS                     15400000
154100                 VARYING ASC-ITEM-SUB                             15410000
154200                 FROM 1 BY 1                                      15420000
154300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15430000
154400                                                                  15440000
154500             PERFORM 5100-WRITE-TEMP-STORAGE                      15450000
154600                                                                  15460000
154700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15470000
154800                                                                  15480000
154900         END-PERFORM                                              15490000
155000                                                                  15500000
155100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15510000
155200                                   TO PV-BLOCK-NUMBER             15520000
155300                                                                  15530000
155400         PERFORM 4410-READ-TEMP-STORAGE                           15540000
155500     END-IF.                                                      15550000
155600                                                                  15560000
155700                                                                  15570000
155800     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15580000
155900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15590000
156000     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15600000
156100                                                                  15610000
156200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15620000
156300                                                                  15630000
156400 EJECT                                                            15640000
156500*----------------------------------------------------------------*15650000
156600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15660000
156700*----------------------------------------------------------------*15670000
156800                                                                  15680000
156900 2141-CLEAR-SELECTED-INDS.                                        15690000
157000                                                                  15700000
157100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15710000
157200             NOT EQUAL ZERO                                       15720000
157300         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15730000
157400             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15740000
157500                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15750000
157600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15760000
157700                                   TO TRUE                        15770000
157800         END-IF                                                   15780000
157900     END-IF.                                                      15790000
158000                                                                  15800000
158100 EJECT                                                            15810000
158200*----------------------------------------------------------------*15820000
158300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15830000
158400*  FOR ALL ITEMS.                                                *15840000
158500*----------------------------------------------------------------*15850000
158600                                                                  15860000
158700 2150-SELECT-ALL-ITEMS.                                           15870000
158800                                                                  15880000
158900     MOVE +1                       TO ASC-BLK-SUB.                15890000
159000                                                                  15900000
159100     PERFORM 2151-SET-SELECTED-INDS                               15910000
159200         VARYING ASC-ITEM-SUB                                     15920000
159300         FROM 1 BY 1                                              15930000
159400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15940000
159500                                                                  15950000
159600     ADD +1                        TO ASC-BLK-SUB.                15960000
159700                                                                  15970000
159800     PERFORM 2151-SET-SELECTED-INDS                               15980000
159900         VARYING ASC-ITEM-SUB                                     15990000
160000         FROM 1 BY 1                                              16000000
160100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16010000
160200                                                                  16020000
160300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16030000
160400                                   TO PV-LIST-ITEM-NUMBER.        16040000
160500                                                                  16050000
160600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16060000
160700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16070000
160800                                                                  16080000
160900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16090000
161000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16100000
161100         MOVE +1                   TO ASC-BLK-SUB                 16110000
161200                                                                  16120000
161300         PERFORM 5100-WRITE-TEMP-STORAGE                          16130000
161400                                                                  16140000
161500         MOVE +1                   TO PV-BLOCK-NUMBER             16150000
161600                                                                  16160000
161700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16170000
161800             PV-FIRST-BLOCK-IN-ARRAY - 1                          16180000
161900                                                                  16190000
162000         PERFORM                                                  16200000
162100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16210000
162200                                                                  16220000
162300             PERFORM 4410-READ-TEMP-STORAGE                       16230000
162400                                                                  16240000
162500             PERFORM 2151-SET-SELECTED-INDS                       16250000
162600                 VARYING ASC-ITEM-SUB                             16260000
162700                 FROM 1 BY 1                                      16270000
162800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16280000
162900                                                                  16290000
163000             PERFORM 5100-WRITE-TEMP-STORAGE                      16300000
163100                                                                  16310000
163200             ADD +1                TO PV-BLOCK-NUMBER             16320000
163300                                                                  16330000
163400         END-PERFORM                                              16340000
163500                                                                  16350000
163600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16360000
163700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16370000
163800                                                                  16380000
163900         PERFORM                                                  16390000
164000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16400000
164100                   ASC-HIGHEST-BLOCK-WRITTEN                      16410000
164200                                                                  16420000
164300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16430000
164400                                   TO PV-BLOCK-NUMBER             16440000
164500                                                                  16450000
164600             PERFORM 4410-READ-TEMP-STORAGE                       16460000
164700                                                                  16470000
164800             PERFORM 2151-SET-SELECTED-INDS                       16480000
164900                 VARYING ASC-ITEM-SUB                             16490000
165000                 FROM 1 BY 1                                      16500000
165100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16510000
165200                                                                  16520000
165300             PERFORM 5100-WRITE-TEMP-STORAGE                      16530000
165400                                                                  16540000
165500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16550000
165600                                                                  16560000
165700         END-PERFORM                                              16570000
165800                                                                  16580000
165900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16590000
166000                                   TO PV-BLOCK-NUMBER             16600000
166100                                                                  16610000
166200         PERFORM 4410-READ-TEMP-STORAGE                           16620000
166300     END-IF.                                                      16630000
166400                                                                  16640000
166500                                                                  16650000
166600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16660000
166700                       ASC-NUMBER-OF-SELECTED-ITEMS.              16670000
166800                                                                  16680000
166900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16690000
167000                                                                  16700000
167100 EJECT                                                            16710000
167200*----------------------------------------------------------------*16720000
167300*    MARK EACH ITEM AS BEING SELECTED.                           *16730000
167400*----------------------------------------------------------------*16740000
167500                                                                  16750000
167600 2151-SET-SELECTED-INDS.                                          16760000
167700                                                                  16770000
167800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16780000
167900             NOT EQUAL ZERO                                       16790000
168000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16800000
168100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16810000
168200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16820000
168300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16830000
168400                               TO  TRUE                           16840000
168500         END-IF                                                   16850000
168600         IF   DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              16860000
168700              MOVE  ZEROES TO ASC-UPDATE-PACKS-N                  16870000
168800                              (ASC-BLK-SUB ASC-ITEM-SUB)          16880000
168900              SET  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)    16890000
169000                           TO  TRUE                               16900000
169100         END-IF                                                   16910000
169200     END-IF.                                                      16920000
169300******************************************************************16930000
169400** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **16940000
169500** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **16950000
169600******************************************************************16960000
169700 2200-MOVE-SCREEN-TO-COMMAREA.                                    16970000
169800                                                                  16980000
169900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16990000
170000     MOVE +1                       TO PV-SUB.                     17000000
170100*                                                                 17010000
170200     PERFORM 3100-SET-SUBSCRIPTS.                                 17020000
170300     IF  ASTRTITL > ZERO                                          17030000
170400         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          17040000
170500     ELSE                                                         17050000
170600         IF  ASTRTITF = DP015-ERASE-EOF                           17060000
170700             INITIALIZE ASC-START-ITEM-REQUEST                    17070000
170800         END-IF                                                   17080000
170900     END-IF.                                                      17090000
171000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17100000
171100         VARYING PV-SUB                                           17110000
171200         FROM 1 BY 1                                              17120000
171300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17130000
171400******************************************************************17140000
171500** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**17150000
171600******************************************************************17160000
171700 2210-MOVE-LINES-TO-COMMAREA.                                     17170000
171800     IF  MR-SELECTL (PV-SUB) > ZERO                               17180000
171900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17190000
172000         MOVE MR-SELECTI (PV-SUB)                                 17200000
172100                                   TO ASC-TEMP-SELECTED-SW        17210000
172200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17220000
172300     ELSE                                                         17230000
172400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17240000
172500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     17250000
172600                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        17260000
172700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17270000
172800         END-IF                                                   17280000
172900     END-IF.                                                      17290000
173000                                                                  17300000
173100     IF MR-UPDATE-PACKSL (PV-SUB) > ZERO                          17310000
173200         MOVE MR-UPDATE-PACKS (PV-SUB)                            17320000
173300                                 TO ASC-UPDATE-PACKS              17330000
173400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17340000
173500     ELSE                                                         17350000
173600         IF MR-UPDATE-PACKSA (PV-SUB) = DP015-ERASE-EOF           17360000
173700             MOVE SPACES         TO ASC-UPDATE-PACKS              17370000
173800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17380000
173900         END-IF                                                   17390000
174000     END-IF.                                                      17400000
174100                                                                  17410000
174200     ADD +1                        TO ASC-ITEM-SUB.               17420000
174300                                                                  17430000
174400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17440000
174500         ADD +1                    TO ASC-BLK-SUB                 17450000
174600         MOVE +1                   TO ASC-ITEM-SUB                17460000
174700     END-IF.                                                      17470000
174800******************************************************************17480000
174900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **17490000
175000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **17500000
175100******************************************************************17510000
175200 3000-EDIT-DATA-IN-COMMAREA.                                      17520000
175300     SET PS-NO-ERROR               TO TRUE.                       17530000
175400     IF ASC-AUTO-VE-YES                                           17540000
175500        CONTINUE                                                  17550000
175600     ELSE                                                         17560000
175700        PERFORM 3200-RESET-ATTRIBUTES                             17570000
175800     END-IF.                                                      17580000
175900     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17590000
176000**                                                                17600000
176100* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17610000
176200* EDITTING IS DONE FROM THE BOTTOM UP.                            17620000
176300**                                                                17630000
176400     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17640000
176500         ASC-ITEMS-DISPLAYED - 1.                                 17650000
176600     PERFORM 3100-SET-SUBSCRIPTS.                                 17660000
176700     PERFORM 3300-EDIT-SELECTIONS                                 17670000
176800         VARYING PV-SUB                                           17680000
176900         FROM PV-SUB BY -1                                        17690000
177000         UNTIL PV-SUB < +1                                        17700000
177100*                                                                 17710000
177200     IF  PS-NO-ERROR                                              17720000
177300         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17730000
177400     END-IF.                                                      17740000
177500*                                                                 17750000
177600     IF  ((PS-NO-ERROR)                                           17760000
177700       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   17770000
177800       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    17780000
177900             PERFORM 3500-MARK-RANGE-AS-SELECTED                  17790000
178000     END-IF.                                                      17800000
178100 EJECT                                                            17810000
178200*----------------------------------------------------------------*17820000
178300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17830000
178400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17840000
178500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17850000
178600*                                                                *17860000
178700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17870000
178800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17880000
178900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17890000
179000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17900000
179100*----------------------------------------------------------------*17910000
179200                                                                  17920000
179300 3100-SET-SUBSCRIPTS.                                             17930000
179400                                                                  17940000
179500     COMPUTE ASC-ITEM-SUB =                                       17950000
179600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17960000
179700                                                                  17970000
179800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17980000
179900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17990000
180000                                                                  18000000
180100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18010000
180200     ELSE                                                         18020000
180300         MOVE +1                     TO ASC-BLK-SUB               18030000
180400     END-IF.                                                      18040000
180500******************************************************************18050000
180600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **18060000
180700******************************************************************18070000
180800                                                                  18080000
180900 3200-RESET-ATTRIBUTES.                                           18090000
181000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18100000
181100     MOVE DP015-GREEN              TO ASTRTITC.                   18110000
181200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18120000
181300*                                                                 18130000
181400     PERFORM                                                      18140000
181500         VARYING PV-SUB                                           18150000
181600         FROM 1 BY 1                                              18160000
181700         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18170000
181800         MOVE DP015-UNP-ALP-NOR-OFF                               18180000
181900                                   TO MR-SELECTA (PV-SUB)         18190000
182000                                    MR-UPDATE-PACKSA (PV-SUB)     18200000
182100         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         18210000
182200                                    MR-UPDATE-PACKSC (PV-SUB)     18220000
182300         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         18230000
182400                                    MR-UPDATE-PACKSH (PV-SUB)     18240000
182500     END-PERFORM.                                                 18250000
182600     IF ASC-RECEIV-STATUS-CDE = 'VE' AND                          18260000
182700        ASC-RECEIV-ML-POST-TMST NOT = PC-DB2-DEFAULT-TMST AND     18270000
182800        ASC-NOT-POST-VERIFIED-RECEIPT                             18280000
182900         PERFORM                                                  18290000
183000             VARYING PV-SUB                                       18300000
183100             FROM 1 BY 1                                          18310000
183200             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    18320000
183300             MOVE DP015-ASK-DRK-OFF  TO MR-UPDATE-PACKSA (PV-SUB) 18330000
183400             MOVE DP015-HL-OFF       TO MR-UPDATE-PACKSH (PV-SUB) 18340000
183500         END-PERFORM                                              18350000
183600     END-IF.                                                      18360000
183700                                                                  18370000
183800******************************************************************18380000
183900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18390000
184000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18400000
184100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18410000
184200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18420000
184300******************************************************************18430000
184400 3300-EDIT-SELECTIONS.                                            18440000
184500     EVALUATE TRUE                                                18450000
184600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18460000
184700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18470000
184800              IF ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)       18480000
184900                 NOT = SPACES                                     18490000
185000                 IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         18500000
185100                     IF ASC-CANNOT-VERIFY-SW                      18510000
185200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18520000
185300                          = 'Y'                                   18530000
185400                         SET ASC-STOP-VERIFY   TO TRUE            18540000
185500                     ELSE                                         18550000
185600                         PERFORM 7090-COUNT-SMOOTHED-CTNS         18560000
185700                         IF PV-DB2-COUNT > 0                      18570000
185800                             SET PS-SMOOTHED-STORE  TO TRUE       18580000
185900                             SET PS-ERROR           TO TRUE       18590000
186000                             MOVE PC-TSYMSG-02773                 18600000
186100                                     TO DP020-MSG-NUMBER          18610000
186200                             SET PS-ERROR                         18620000
186300                                 DP020-MSG-FATAL                  18630000
186400                                 DP030-SET-CURSOR-APPL-1          18640000
186500                                                TO TRUE           18650000
186600                             MOVE -1        TO MR-SELECTL (PV-SUB)18660000
186700                             MOVE DP015-RED TO MR-SELECTC (PV-SUB)18670000
186800                             MOVE DP015-REVERSE                   18680000
186900                                            TO MR-SELECTH (PV-SUB)18690000
187000                         END-IF                                   18700000
187100                     END-IF                                       18710000
187200                 END-IF                                           18720000
187300                 IF (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) OR     18730000
187310                    DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)) AND    18731000
187320                     ASC-AUTO-VE-YES                              18732000
187330                        SET PS-ERROR           TO TRUE            18733000
187340                        MOVE PC-TSYMSG-03180                      18734000
187350                                TO DP020-MSG-NUMBER               18735000
187360                        SET PS-ERROR                              18736000
187370                            DP020-MSG-FATAL                       18737000
187380                            DP030-SET-CURSOR-APPL-1               18738000
187390                                            TO TRUE               18739000
187391                        MOVE -1            TO MR-SELECTL (PV-SUB) 18739100
187392                        MOVE DP015-RED     TO MR-SELECTC (PV-SUB) 18739200
187393                        MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB) 18739300
187394                 END-IF                                           18739400
187395             END-IF                                               18739500
187396         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18739600
187397             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18739700
187398                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18739800
187399                 MOVE ASC-TEMP-SELECTED-SW                        18739900
187400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18740000
187500                                TO ASC-SELECTED-SW                18750000
187600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18760000
187700                 IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)        18770000
187800                     IF ASC-CANNOT-VERIFY-SW                      18780000
187900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18790000
188000                          = 'Y'                                   18800000
188100                         SET ASC-STOP-VERIFY   TO TRUE            18810000
188200                     ELSE                                         18820000
188300                         PERFORM 7090-COUNT-SMOOTHED-CTNS         18830000
188400                         IF PV-DB2-COUNT > 0                      18840000
188500                             SET PS-SMOOTHED-STORE  TO TRUE       18850000
188600                             SET PS-ERROR           TO TRUE       18860000
188700                             MOVE PC-TSYMSG-02773                 18870000
188800                                     TO DP020-MSG-NUMBER          18880000
188900                             SET PS-ERROR                         18890000
189000                                 DP020-MSG-FATAL                  18900000
189100                                 DP030-SET-CURSOR-APPL-1          18910000
189200                                                TO TRUE           18920000
189300                             MOVE -1        TO MR-SELECTL (PV-SUB)18930000
189400                             MOVE DP015-RED TO MR-SELECTC (PV-SUB)18940000
189500                             MOVE DP015-REVERSE                   18950000
189600                                            TO MR-SELECTH (PV-SUB)18960000
189700                         END-IF                                   18970000
189800                     END-IF                                       18980000
189900                 END-IF                                           18990000
190000                 IF (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) OR     19000000
190100                    DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)) AND    19010000
190200                     ASC-AUTO-VE-YES                              19020000
190300                        SET PS-ERROR           TO TRUE            19030000
190310                        MOVE PC-TSYMSG-03180                      19031000
190320                                TO DP020-MSG-NUMBER               19032000
190330                        SET PS-ERROR                              19033000
190340                            DP020-MSG-FATAL                       19034000
190350                            DP030-SET-CURSOR-APPL-1               19035000
190360                                            TO TRUE               19036000
190370                        MOVE -1            TO MR-SELECTL (PV-SUB) 19037000
190380                        MOVE DP015-RED     TO MR-SELECTC (PV-SUB) 19038000
190390                        MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB) 19039000
190391                 END-IF                                           19039100
190392             END-IF                                               19039200
190393         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19039300
190394                 = SPACE                                          19039400
190395             EVALUATE TRUE                                        19039500
190396                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19039600
190397                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19039700
190398                     MOVE SPACE TO ASC-SELECTED-SW                19039800
190399                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19039900
190400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19040000
190500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19050000
190600                     MOVE SPACE TO ASC-SELECTED-SW                19060000
190700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19070000
190800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19080000
190900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19090000
191000                     MOVE SPACE TO ASC-SELECTED-SW                19100000
191100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19110000
191200             END-EVALUATE                                         19120000
191300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19130000
191400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19140000
191500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19150000
191600             END-IF                                               19160000
191700             IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)            19170000
191800                 IF ASC-CANNOT-VERIFY-SW                          19180000
191900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19190000
192000                      = 'Y'                                       19200000
192100                     SET ASC-STOP-VERIFY   TO TRUE                19210000
192200                 END-IF                                           19220000
192300             END-IF                                               19230000
192400             PERFORM 3310-EDIT-RANGE                              19240000
192500                                                                  19250000
192600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19260000
192700             SET ASC-RANGE-ON TO TRUE                             19270000
192800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19280000
192900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19290000
193000             END-IF                                               19300000
193100             IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)             19310000
193200                 IF ASC-CANNOT-VERIFY-SW                          19320000
193300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19330000
193400                      = 'Y'                                       19340000
193500                     SET ASC-STOP-VERIFY   TO TRUE                19350000
193600                 END-IF                                           19360000
193700             END-IF                                               19370000
193800             PERFORM 3310-EDIT-RANGE                              19380000
193900                                                                  19390000
194000         WHEN OTHER                                               19400000
194100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           19410000
194200             SET DP020-MSG-FATAL    TO TRUE                       19420000
194300             MOVE -1                TO MR-SELECTL (PV-SUB)        19430000
194400             SET DP030-SET-CURSOR-APPL-1                          19440000
194500                                    TO TRUE                       19450000
194600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        19460000
194700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        19470000
194800             SET PS-ERROR TO TRUE                                 19480000
194900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19490000
195000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19500000
195100                 MOVE SPACE         TO ASC-SELECTED-SW            19510000
195200                                        (ASC-BLK-SUB ASC-ITEM-SUB)19520000
195300             END-IF                                               19530000
195400     END-EVALUATE.                                                19540000
195500                                                                  19550000
195600**   IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     19560000
195700**      OR ASC-RANGE-ON                                           19570000
195800**      OR ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                   19580000
195900         IF ASC-UPDATE-PACKS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  19590000
196000             MOVE ASC-UPDATE-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)     19600000
196100                                 TO DP010I-UNEDITED-FIELD         19610000
196200             MOVE LENGTH OF ASC-UPDATE-PACKS                      19620000
196300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19630000
196400                                 TO DP010I-MAXIMUM-DIGITS         19640000
196500             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       19650000
196600             SET DP010I-NEGATIVE-NOT-ALLOWED                      19660000
196700                                 TO TRUE                          19670000
196810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     19681002
196820                  USING DP010I-NUMERIC-EDIT-AREA                  19682002
196900                                                                  19690000
197000             IF  DP010I-ERROR-DETECTED                            19700000
197100                 SET PS-ERROR                                     19710000
197200                     DP020-MSG-FATAL                              19720000
197300                     DP030-SET-CURSOR-APPL-1                      19730000
197400                                 TO TRUE                          19740000
197500                 MOVE PC-TSYMSG-00005                             19750000
197600                                 TO DP020-MSG-NUMBER              19760000
197700                 MOVE DP015-UNP-NUM-BRT-OFF                       19770000
197800                                 TO MR-UPDATE-PACKSA (PV-SUB)     19780000
197900                 MOVE -1         TO MR-UPDATE-PACKSL (PV-SUB)     19790000
198000                 MOVE DP015-RED  TO MR-UPDATE-PACKSC (PV-SUB)     19800000
198100                 MOVE DP015-REVERSE                               19810000
198200                                 TO MR-UPDATE-PACKSH (PV-SUB)     19820000
198300                 SET DP030-SET-CURSOR-APPL-1                      19830000
198400                                 TO TRUE                          19840000
198500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19850000
198600             ELSE                                                 19860000
198700                 MOVE DP010I-NUMERIC-FIELD                        19870000
198800                                 TO ASC-UPDATE-PACKS-N            19880000
198900                                    (ASC-BLK-SUB ASC-ITEM-SUB)    19890000
199000                 MOVE ASC-UPDATE-PACKS (ASC-BLK-SUB ASC-ITEM-SUB) 19900000
199100                                 TO MR-UPDATE-PACKS (PV-SUB)      19910000
199200             END-IF                                               19920000
199300         END-IF.                                                  19930000
199400**   END-IF.                                                      19940000
199500                                                                  19950000
199600     SUBTRACT +1 FROM PV-ITEM-IN-USE                              19960000
199700     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19970000
199800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19980000
199900     IF  ASC-ITEM-SUB < 1                                         19990000
200000         SUBTRACT +1 FROM ASC-BLK-SUB                             20000000
200100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                20010000
200200     END-IF.                                                      20020000
200300******************************************************************20030000
200400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20040000
200500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20050000
200600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20060000
200700** THE ENDING.                                                  **20070000
200800******************************************************************20080000
200900 3310-EDIT-RANGE.                                                 20090000
201000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20100000
201100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20110000
201200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20120000
201300                                   TO ASC-SELECTED-SW             20130000
201400                                        (ASC-BLK-SUB ASC-ITEM-SUB)20140000
201500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20150000
201600         ELSE                                                     20160000
201700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20170000
201800                 CONTINUE                                         20180000
201900             ELSE                                                 20190000
202000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20200000
202100                 MOVE PC-TSYMSG-00054                             20210000
202200                                   TO DP020-MSG-NUMBER            20220000
202300                 SET DP020-MSG-FATAL                              20230000
202400                                   TO TRUE                        20240000
202500                 MOVE -1           TO MR-SELECTL (PV-SUB)         20250000
202600                 SET DP030-SET-CURSOR-APPL-1                      20260000
202700                                   TO TRUE                        20270000
202800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20280000
202900                 MOVE DP015-UNDERLINE                             20290000
203000                                   TO MR-SELECTH (PV-SUB)         20300000
203100                 SET PS-ERROR      TO TRUE                        20310000
203200             END-IF                                               20320000
203300         END-IF                                                   20330000
203400     ELSE                                                         20340000
203500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20350000
203600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20360000
203700                                   TO ASC-SELECTED-SW             20370000
203800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20380000
203900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20390000
204000         ELSE                                                     20400000
204100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20410000
204200                 CONTINUE                                         20420000
204300             ELSE                                                 20430000
204400*                -- ONLY ONE END-OF-RANGE ALLOWED --              20440000
204500                 MOVE PC-TSYMSG-00055                             20450000
204600                                   TO DP020-MSG-NUMBER            20460000
204700                 SET DP020-MSG-FATAL                              20470000
204800                                   TO TRUE                        20480000
204900                 MOVE -1           TO MR-SELECTL (PV-SUB)         20490000
205000                 SET DP030-SET-CURSOR-APPL-1                      20500000
205100                                   TO TRUE                        20510000
205200                 SET PS-ERROR      TO TRUE                        20520000
205300             END-IF                                               20530000
205400         END-IF                                                   20540000
205500     END-IF.                                                      20550000
205600*                                                                 20560000
205700******************************************************************20570000
205800** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20580000
205900** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20590000
206000******************************************************************20600000
206100 3400-CHECK-RANGE-SEQUENCE.                                       20610000
206200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20620000
206300       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20630000
206400       AND  ASC-START-OF-SELECTED-RANGE >                         20640000
206500                                         ASC-END-OF-SELECTED-RANGE20650000
206600*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20660000
206700         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20670000
206800         SET DP020-MSG-FATAL TO TRUE                              20680000
206900         SET PS-ERROR TO TRUE                                     20690000
207000         PERFORM 3410-POSITION-AT-ERROR                           20700000
207100     END-IF.                                                      20710000
207200******************************************************************20720000
207300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20730000
207400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20740000
207500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20750000
207600******************************************************************20760000
207700 3410-POSITION-AT-ERROR.                                          20770000
207800     SET DP030-SET-CURSOR-APPL-1                                  20780000
207900                                   TO TRUE.                       20790000
208000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20800000
208100                    - PV-TOP-ITEM + 1.                            20810000
208200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20820000
208300         CONTINUE                                                 20830000
208400     ELSE                                                         20840000
208500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20850000
208600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20860000
208700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20870000
208800     END-IF.                                                      20880000
208900*                                                                 20890000
209000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20900000
209100                    - PV-TOP-ITEM + 1.                            20910000
209200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20920000
209300         CONTINUE                                                 20930000
209400     ELSE                                                         20940000
209500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20950000
209600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20960000
209700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20970000
209800     END-IF.                                                      20980000
209900 EJECT                                                            20990000
210000*----------------------------------------------------------------*21000000
210100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *21010000
210200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21020000
210300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21030000
210400*----------------------------------------------------------------*21040000
210500                                                                  21050000
210600 3500-MARK-RANGE-AS-SELECTED.                                     21060000
210700     MOVE +1                       TO  ASC-BLK-SUB.               21070000
210800     PERFORM 3510-MARK-SELECTED-INDS                              21080000
210900         VARYING ASC-ITEM-SUB                                     21090000
211000         FROM 1 BY 1                                              21100000
211100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21110000
211200                                                                  21120000
211300     ADD +1                        TO ASC-BLK-SUB.                21130000
211400     PERFORM 3510-MARK-SELECTED-INDS                              21140000
211500         VARYING ASC-ITEM-SUB                                     21150000
211600         FROM 1 BY 1                                              21160000
211700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21170000
211800                                                                  21180000
211900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21190000
212000                                   TO  PV-LIST-ITEM-NUMBER.       21200000
212100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21210000
212200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21220000
212300               PC-ITEMS-PER-PANEL).                               21230000
212400                                                                  21240000
212500     MOVE ASC-START-OF-SELECTED-RANGE                             21250000
212600                                   TO PV-START-OF-SELECTED-RANGE. 21260000
212700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21270000
212800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21280000
212900               PC-ITEMS-PER-PANEL).                               21290000
213000                                                                  21300000
213100     MOVE ASC-END-OF-SELECTED-RANGE                               21310000
213200                                   TO  PV-END-OF-SELECTED-RANGE.  21320000
213300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21330000
213400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21340000
213500               PC-ITEMS-PER-PANEL).                               21350000
213600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21360000
213700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21370000
213800                                                                  21380000
213900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21390000
214000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21400000
214100         MOVE +1                   TO ASC-BLK-SUB                 21410000
214200         PERFORM 5100-WRITE-TEMP-STORAGE                          21420000
214300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21430000
214400             PV-FIRST-BLOCK-IN-ARRAY - 1                          21440000
214500                                                                  21450000
214600         PERFORM                                                  21460000
214700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21470000
214800                   PV-PREV-BLOCK-IN-ARRAY                         21480000
214900             MOVE PV-FIRST-BLOCK-IN-RANGE                         21490000
215000                                   TO PV-BLOCK-NUMBER             21500000
215100             PERFORM 4410-READ-TEMP-STORAGE                       21510000
215200             PERFORM 3510-MARK-SELECTED-INDS                      21520000
215300                 VARYING ASC-ITEM-SUB                             21530000
215400                 FROM 1 BY 1                                      21540000
215500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21550000
215600             PERFORM 5100-WRITE-TEMP-STORAGE                      21560000
215700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21570000
215800         END-PERFORM                                              21580000
215900                                                                  21590000
216000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21600000
216100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21610000
216200         PERFORM                                                  21620000
216300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21630000
216400                   PV-LAST-BLOCK-IN-RANGE                         21640000
216500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21650000
216600                                   TO PV-BLOCK-NUMBER             21660000
216700             PERFORM 4410-READ-TEMP-STORAGE                       21670000
216800             PERFORM 3510-MARK-SELECTED-INDS                      21680000
216900                 VARYING ASC-ITEM-SUB                             21690000
217000                 FROM 1 BY 1                                      21700000
217100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21710000
217200             PERFORM 5100-WRITE-TEMP-STORAGE                      21720000
217300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21730000
217400         END-PERFORM                                              21740000
217500                                                                  21750000
217600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21760000
217700                                   TO PV-BLOCK-NUMBER             21770000
217800         PERFORM 4410-READ-TEMP-STORAGE                           21780000
217900     END-IF.                                                      21790000
218000                                                                  21800000
218100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21810000
218200                                      ASC-END-OF-SELECTED-RANGE.  21820000
218300                                                                  21830000
218400 EJECT                                                            21840000
218500*----------------------------------------------------------------*21850000
218600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21860000
218700*----------------------------------------------------------------*21870000
218800                                                                  21880000
218900 3510-MARK-SELECTED-INDS.                                         21890000
219000                                                                  21900000
219100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21910000
219200                                ASC-ITEM-SUB) >                   21920000
219300         ASC-START-OF-SELECTED-RANGE)                             21930000
219400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21940000
219500                                ASC-ITEM-SUB) =                   21950000
219600         ASC-START-OF-SELECTED-RANGE)                             21960000
219700                                                                  21970000
219800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21980000
219900                                    ASC-ITEM-SUB) <               21990000
220000             ASC-END-OF-SELECTED-RANGE)                           22000000
220100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     22010000
220200                                    ASC-ITEM-SUB) =               22020000
220300             ASC-END-OF-SELECTED-RANGE)                           22030000
220400                                                                  22040000
220500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          22050000
220600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   22060000
220700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   22070000
220800                               TO TRUE                            22080000
220900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22090000
221000                               TO TRUE                            22100000
221100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    22110000
221200             END-IF                                               22120000
221300         END-IF                                                   22130000
221400     END-IF.                                                      22140000
221500                                                                  22150000
221600 EJECT                                                            22160000
221700*----------------------------------------------------------------*22170000
221800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22180000
221900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22190000
222000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22200000
222100*    DISPLAY THE PANEL TO USER.                                  *22210000
222200*----------------------------------------------------------------*22220000
222300                                                                  22230000
222400 4000-BUILD-INITIAL-PANEL.                                        22240000
222500                                                                  22250000
222600     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            22260000
222700                                 ASC-BLOCK-ENTRIES (2).           22270000
222800     MOVE +1                 TO ASC-BLK-SUB.                      22280000
222900     SET ASC-ITEMS-LEFT-ON-DB                                     22290000
223000         ASC-CAN-VERIFY                                           22300000
223100         ASC-CAN-UNVERIFY    TO TRUE.                             22310000
223200                                                                  22320000
223300     MOVE +0                 TO ASC-ITEM-SUB                      22330000
223400                                ASC-NUMBER-OF-ITEMS-READ          22340000
223500                                ASC-NUMBER-OF-SELECTED-ITEMS      22350000
223600                                ASC-HIGHEST-BLOCK-WRITTEN         22360000
223700                                ASC-START-OF-SELECTED-RANGE       22370000
223800                                ASC-END-OF-SELECTED-RANGE         22380000
223900                                ASC-ITEM-AT-TOP-OF-PANEL          22390000
224000                                ASC-TOT-PKSLIP-PACKS              22400000
224100                                ASC-TOT-ACTUAL-PACKS              22410000
224200                                ASC-TOT-VERFYD-PACKS              22420000
224300                                ASC-TOT-ODD-UNITS                 22430000
224400                                ASC-HDR-TOT-ACT-UNTS              22440000
224500                                ASC-HDR-TOT-VERFYD-UNTS.          22450000
224510                                                                  22451000
224520     PERFORM 4150-CALL-AUTOVE-MODULE.                             22452000
224521     MOVE RC040-AUTO-VE-SW          TO ASC-AUTO-VE-SW.            22452100
224560                                                                  22456000
224570     PERFORM 4100-PREPARE-CURSOR.                                 22457000
224580                                                                  22458000
224590     PERFORM 5300-GET-TRECEIV-STATUS.                             22459000
224600                                                                  22460000
224700*    PERFORM 4350-SELECT-PRE-PACK-ID.                             22470000
224800                                                                  22480000
224900     PERFORM 4010-OPEN-CURSOR.                                    22490000
225000                                                                  22500000
225100     PERFORM 4300-READ-ITEMS-FROM-DB.                             22510000
225200                                                                  22520000
225300     PERFORM 4020-CLOSE-CURSOR.                                   22530000
225400                                                                  22540000
225500**   PERFORM 4320-SUM-TRECDIS.                                    22550000
225600**   MOVE RECDIS-AP-VERIFY-ITM-QTY TO ASC-HDR-TOT-VERFYD-UNTS.    22560000
225700**   MOVE RECDIS-VERIFY-ITM-QTY    TO ASC-HDR-TOT-ACT-UNTS.       22570000
225800                                                                  22580000
225900     IF RECITM-STATUS-CDE = 'VE'                                  22590000
226000        MOVE '  ACTUAL'  TO ASC-SOURCE-TYPE                       22600000
226100     ELSE                                                         22610000
226200        MOVE 'EXPECTED'  TO ASC-SOURCE-TYPE                       22620000
226300     END-IF.                                                      22630000
226400                                                                  22640000
226500     MOVE +1                   TO  PV-TOP-ITEM.                   22650000
226600     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22660000
226700         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    22670000
226800         SET DP020-MSG-FATAL   TO  TRUE                           22680000
226900         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               22690000
227000     ELSE                                                         22700000
227100         IF PS-NO-DRIVER-INFO                                     22710000
227200             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                22720000
227300             SET DP020-MSG-FATAL   TO  TRUE                       22730000
227310             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            22731000
227320             STRING 'PACK ID '                                    22732000
227330                    PV-DISP-PREPK-ID                              22733000
227340                    ' - RATIO SET TO ZERO - CONTACT COC'          22734000
227350                                  DELIMITED BY SIZE               22735000
227360                             INTO  DP020-MSG-MESSAGE              22736000
227370             SET DP020-MSG-FATAL                                  22737000
227380                 PS-ERROR      TO  TRUE                           22738000
227390         ELSE                                                     22739000
227391             MOVE -1               TO MR-SELECTL (1)              22739100
227392             SET DP030-SET-CURSOR-APPL-1                          22739200
227393                                   TO TRUE                        22739300
227394             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22739400
227395         END-IF                                                   22739500
227396     END-IF.                                                      22739600
227397 EJECT                                                            22739700
227398                                                                  22739800
227399 4010-OPEN-CURSOR.                                                22739900
227400     PERFORM                                                      22740000
227500         WITH TEST AFTER                                          22750000
227600         VARYING PV-RETRY-COUNTER                                 22760000
227700         FROM 1 BY 1                                              22770000
227800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22780000
227900                   OR (SQLCODE = ZERO))                           22790000
228000                                                                  22800000
228100             EXEC SQL                                             22810000
228200                  OPEN PACK-SLIP-CSR                              22820000
228300             END-EXEC                                             22830000
228400                                                                  22840000
228500         EVALUATE TRUE                                            22850000
228600             WHEN SQLCODE = ZERO                                  22860000
228700             WHEN SQLCODE = -904                                  22870000
228800             WHEN SQLCODE = -913                                  22880000
228900                 CONTINUE                                         22890000
229000             WHEN SQLWARN0 NOT = SPACES                           22900000
229100             WHEN SQLCODE < ZERO                                  22910000
229200             WHEN SQLCODE > ZERO                                  22920000
229300                 MOVE '4010-OPEN-CURSOR'                          22930000
229400                                   TO DP013-PARAGRAPH             22940000
229500                 MOVE 'OPEN PACK SLIP CURSOR - '                  22950000
229600                                   TO DP013-MESSAGE-TEXT (1)      22960000
229700                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          22970000
229800                 MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR     22980000
229900                 MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID     22990000
230000                 MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID        23000000
230100                 MOVE DK-STR-NBR       TO PV-DISP-STR-NBR         23010000
230200                 STRING ' PO = '                                  23020000
230300                        PV-DISP-PO-NBR                            23030000
230400                        ' RECV ='                                 23040000
230500                        PV-DISP-REC-SEQ-NBR                       23050000
230600                        ' OPER = '                                23060000
230700                        PV-DISP-OPER-UNT-ID                       23070000
230800                        ' FCLTY = '                               23080000
230900                        PV-DISP-FCLTY-ID                          23090000
231000                        ' STORE ='                                23100000
231100                        PV-DISP-STR-NBR     DELIMITED BY SIZE     23110000
231200                                 INTO DP013-MESSAGE-TEXT (2)      23120000
231300                 MOVE SQLCA        TO DP013-SQLCA                 23130000
231400                 MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)    23140000
231500                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)    23150000
231600                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)    23160000
231700                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)    23170000
231800                 SET DP013-DB2-ABEND                              23180000
231900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23190000
232000                 PERFORM DP013-0000-PROCESS-ABEND                 23200000
232100         END-EVALUATE                                             23210000
232200     END-PERFORM.                                                 23220000
232300*                                                                 23230000
232400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23240000
232500         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             23250000
232600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   23260000
232700                                   TO DP013-MESSAGE-TEXT (1)      23270000
232800         MOVE ASC-PO-NBR           TO PV-DISP-PO-NBR              23280000
232900         MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID         23290000
233000         MOVE ASC-FCLTY-ID         TO PV-DISP-FCLTY-ID            23300000
233100         MOVE ASC-REC-SEQ-NBR      TO PV-DISP-REC-SEQ-NBR         23310000
233200         STRING ' PO = '                                          23320000
233300                PV-DISP-PO-NBR                                    23330000
233400                ' OPER = '                                        23340000
233500                PV-DISP-OPER-UNT-ID                               23350000
233600                ' FCLTY = '                                       23360000
233700                PV-DISP-FCLTY-ID                                  23370000
233800                ' RECV ='                                         23380000
233900                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             23390000
234000                         INTO DP013-MESSAGE-TEXT (2)              23400000
234100         MOVE SQLCA                TO DP013-SQLCA                 23410000
234200         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    23420000
234300         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (2)    23430000
234400         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (3)    23440000
234500         SET DP013-DB2-ABEND                                      23450000
234600             DP013-XCTL-DISPLAY-RESTART                           23460000
234700                                   TO TRUE                        23470000
234800         PERFORM DP013-0000-PROCESS-ABEND                         23480000
234900     END-IF.                                                      23490000
235000                                                                  23500000
235100 EJECT                                                            23510000
235200                                                                  23520000
235300 4020-CLOSE-CURSOR.                                               23530000
235400     EXEC SQL                                                     23540000
235500         CLOSE PACK-SLIP-CSR                                      23550000
235600     END-EXEC.                                                    23560000
235700*                                                                 23570000
235800     EVALUATE TRUE                                                23580000
235900         WHEN SQLCODE = ZERO                                      23590000
236000             CONTINUE                                             23600000
236100         WHEN SQLWARN0 NOT = SPACES                               23610000
236200         WHEN SQLCODE < ZERO                                      23620000
236300         WHEN SQLCODE > ZERO                                      23630000
236400             MOVE '4020-CLOSE-CURSOR'                             23640000
236500                               TO DP013-PARAGRAPH                 23650000
236600             MOVE 'CLOSE PACK SLIP CURSOR '                       23660000
236700                               TO DP013-MESSAGE-TEXT (1)          23670000
236800             MOVE SQLCA        TO DP013-SQLCA                     23680000
236900             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              23690000
237000             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         23700000
237100             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         23710000
237200             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            23720000
237300             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             23730000
237400             STRING ' PO = '                                      23740000
237500                    PV-DISP-PO-NBR                                23750000
237600                    ' RECV ='                                     23760000
237700                    PV-DISP-REC-SEQ-NBR                           23770000
237800                    ' OPER = '                                    23780000
237900                    PV-DISP-OPER-UNT-ID                           23790000
238000                    ' FCLTY = '                                   23800000
238100                    PV-DISP-FCLTY-ID                              23810000
238200                    ' STORE ='                                    23820000
238300                    PV-DISP-STR-NBR     DELIMITED BY SIZE         23830000
238400                             INTO DP013-MESSAGE-TEXT (2)          23840000
238500             MOVE SQLCA        TO DP013-SQLCA                     23850000
238600             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        23860000
238700             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        23870000
238800             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)        23880000
238900             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)        23890000
239000             SET DP013-DB2-ABEND                                  23900000
239100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23910000
239200             PERFORM DP013-0000-PROCESS-ABEND                     23920000
239300     END-EVALUATE.                                                23930000
239400                                                                  23940000
239500 EJECT                                                            23950000
239600*----------------------------------------------------------------*23960000
239700*    SET UP THE HOST VARIABLES.                                  *23970000
239800*----------------------------------------------------------------*23980000
239900                                                                  23990000
240000 4100-PREPARE-CURSOR.                                             24000000
240100                                                                  24010000
240200     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 24020000
240300     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    24030000
240400     MOVE ASC-PO-NBR           TO DK-PO-NBR.                      24040000
240500     MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.                 24050000
240600     MOVE ASC-STR-NBR          TO DK-STR-NBR.                     24060000
240700                                                                  24070000
240800 EJECT                                                            24080000
240900*----------------------------------------------------------------*24090000
241000*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          24100000
241100*----------------------------------------------------------------*24110000
241200 4150-CALL-AUTOVE-MODULE.                                         24120000
241300                                                                  24130000
241400     INITIALIZE RC040-FIELDS.                                     24140000
241500     MOVE DK-OPER-UNT-ID      TO RC040-SIGNON-LOCATION.           24150000
241600     MOVE DK-PO-NBR           TO RC040-PO-NBR                     24160000
241610     MOVE DK-REC-SEQ-NBR      TO RC040-PO-RCVR                    24161000
241620     MOVE DP020-USERID        TO RC040-USER-ID.                   24162000
241630     MOVE 'RCKCS820'          TO RC040-CALLING-PROGRAM.           24163000
241640                                                                  24164000
241650     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  24165000
241660                                        RC040-COMMAREA            24166000
241670                                        RC040-FIELDS.             24167000
241680                                                                  24168000
241690     EVALUATE TRUE                                                24169000
241691         WHEN RC040-SUCCESSFUL                                    24169100
241692              CONTINUE                                            24169200
241693         WHEN RC040-DATABASE-BUSY OR                              24169300
241694              RC040-INVALID-SQL                                   24169400
241695                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       24169500
241696                  SET DP020-MSG-WARNING TO TRUE                   24169600
241697                  SET DP030-OVERRIDE-GO TO TRUE                   24169700
241698                  SET PS-ERROR          TO TRUE                   24169800
241699         WHEN RC040-NOT-SUCCESSFUL                                24169900
241700                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       24170000
241710                  SET DP020-MSG-WARNING TO TRUE                   24171000
241720                  SET DP030-OVERRIDE-GO TO TRUE                   24172000
241730                  SET PS-ERROR          TO TRUE                   24173000
241731         WHEN OTHER                                               24173100
241732             MOVE '4150-CHECK-AUTOVE ' TO DP013-PARAGRAPH         24173200
241733             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              24173300
241734                                         TO DP013-MESSAGE-TEXT (1)24173400
241735             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)24173500
241736             MOVE RC040-SQLCA            TO DP013-SQLCA           24173600
241737             SET DP013-DB2-ABEND                                  24173700
241738                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              24173800
241739             SET PS-ERROR                    TO TRUE              24173900
241740             PERFORM DP013-0000-PROCESS-ABEND                     24174000
241741                                                                  24174100
241742     END-EVALUATE.                                                24174200
241743                                                                  24174300
241744*----------------------------------------------------------------*24174400
241745*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *24174500
241746*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *24174600
241747*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *24174700
241748*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *24174800
241749*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *24174900
241750*                                                                *24175000
241760*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *24176000
241770*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *24177000
241780*    UPON INITIALIZATION.                                        *24178000
241790*----------------------------------------------------------------*24179000
241800                                                                  24180000
241900 4300-READ-ITEMS-FROM-DB.                                         24190000
242000                                                                  24200000
242100     PERFORM                                                      24210000
242200         VARYING PV-READ-COUNT                                    24220000
242300         FROM 1 BY 1                                              24230000
242400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    24240000
242500            OR (ASC-NO-ITEMS-LEFT-ON-DB)                          24250000
242600            OR PS-NO-DRIVER-INFO)                                 24260000
242700                                                                  24270000
242800         PERFORM 4310-FETCH                                       24280000
242900                                                                  24290000
243000         IF  ASC-ITEMS-LEFT-ON-DB                                 24300000
243100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                24310000
243200                 ADD +1            TO ASC-ITEM-SUB                24320000
243300             ELSE                                                 24330000
243400                 ADD +1            TO ASC-BLK-SUB                 24340000
243500                 MOVE +1           TO ASC-ITEM-SUB                24350000
243600                                                                  24360000
243700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         24370000
243800                     MOVE +1       TO ASC-BLK-SUB                 24380000
243900                     SET ASC-BLOCK-MODIFIED (1)                   24390000
244000                                   TO TRUE                        24400000
244100                     PERFORM 5100-WRITE-TEMP-STORAGE              24410000
244200                     MOVE ASC-BLOCK-ENTRIES                       24420000
244300                               (PC-MAX-BLOCKS-IN-ARRAY)           24430000
244400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 24440000
244500                     ADD +1        TO ASC-BLK-SUB                 24450000
244600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   24460000
244700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      24470000
244800                                   TO TRUE                        24480000
244900                 END-IF                                           24490000
245000             END-IF                                               24500000
245100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    24510000
245200             MOVE ASC-NUMBER-OF-ITEMS-READ                        24520000
245300                                   TO ASC-LIST-ITEM-NUMBER        24530000
245400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24540000
245500             MOVE RECEIV-STATUS-CDE TO ASC-RECEIV-STATUS-CDE      24550000
245600             MOVE RECEIV-ML-POST-TMST                             24560000
245700                                    TO ASC-RECEIV-ML-POST-TMST    24570000
245800             MOVE RECITM-STATUS-CDE                               24580000
245900                                   TO ASC-STAT-CDE                24590000
246000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24600000
246100             MOVE RECITM-PREPK-ID  TO ASC-LINE-PACK-ID            24610000
246200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24620000
246300             MOVE RECITM-PREPK-ID   TO DK-PREPK-ID                24630000
246400             PERFORM 4340-SELECT-DRIVER-RATIO                     24640000
246500             MOVE POPRPK-PK-SKU-NBR TO ASC-PACK-SKU               24650000
246600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24660000
246700             MOVE RECITM-PREPK-ID   TO ASC-PACK-ID                24670000
246800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24680000
246900             MOVE RECITM-PREPK-RATO-QTY TO PV-DRIVER-RATIO        24690000
247000                                           ASC-DRIVER-RATIO       24700000
247100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24710000
247200             MOVE RECITM-ORD-LNE-NBR    TO DK-PO-DRIVER-LNE       24720000
247300                                           ASC-DRIVER-LNE         24730000
247400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24740000
247500             MOVE 'N'          TO ASC-CANNOT-VERIFY-SW            24750000
247600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24760000
247700             IF RECITM-STATUS-CDE = 'VE'                          24770000
247800                 MOVE 'MANUAL' TO ASC-KEY-VFY-SRC                 24780000
247900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24790000
248000                 IF ASC-ALL-VFY-SRC = SPACES                      24800000
248100                    MOVE 'MANUAL' TO ASC-ALL-VFY-SRC              24810000
248200                 END-IF                                           24820000
248300                 IF RECITM-VRFD-USR-ID (1:2) = 'TK'               24830000
248301                 OR RECITM-VRFD-USR-ID (1:2) = 'TC'               24830100
248302                 OR RECITM-VRFD-USR-ID (1:2) = 'TV'               24830200
248310                  OR SPACES                                       24831000
248320                     MOVE 'MANUAL' TO ASC-SOURCE                  24832000
248330                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24833000
248340                 ELSE                                             24834000
248350                     MOVE RECITM-VRFD-USR-ID TO ASC-SOURCE        24835000
248360                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24836000
248370                  END-IF                                          24837000
248380             ELSE                                                 24838000
248390                 MOVE ASC-DRIVER-LNE   (ASC-BLK-SUB ASC-ITEM-SUB) 24839000
248400                                        TO DK-HOLD-LNE-NBR        24840000
248500                 PERFORM 5460-SELECT-TDISTHD                      24850000
248600                 IF PS-NO-TDISTHD-FOUND                           24860000
248700                     MOVE 'MANUAL' TO ASC-SOURCE                  24870000
248800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24880000
248900                     MOVE 'MANUAL' TO ASC-KEY-VFY-SRC             24890000
249000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24900000
249100                     IF ASC-ALL-VFY-SRC = SPACES                  24910000
249200                        MOVE 'MANUAL' TO ASC-ALL-VFY-SRC          24920000
249300                     END-IF                                       24930000
249400                 ELSE                                             24940000
249500                     IF DISTHD-VRFD-TMST = PC-DB2-DEFAULT-TMST AND24950000
249600                        DISTHD-TOT-CART-CNT > 0                   24960000
249700                         MOVE 'Y'     TO ASC-CANNOT-VERIFY-SW     24970000
249800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      24980000
249900                     END-IF                                       24990000
250000                     IF DISTHD-TOT-CART-CNT = 0                   25000000
250100                         MOVE 'MANUAL' TO ASC-SOURCE              25010000
250200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25020000
250300                         MOVE 'MANUAL' TO ASC-KEY-VFY-SRC         25030000
250310                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25031000
250320                         IF ASC-ALL-VFY-SRC = SPACES              25032000
250330                            MOVE 'MANUAL' TO ASC-ALL-VFY-SRC      25033000
250340                         END-IF                                   25034000
250350                     ELSE                                         25035000
250360                         IF (DISTHD-P2L-CART-CNT = 0              25036000
250370                            AND (DISTHD-FCSE-CART-CNT > 0         25037000
250380                            OR DISTHD-INPK-CART-CNT > 0))         25038000
250390                              MOVE 'CASE' TO ASC-SOURCE           25039000
250400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25040000
250500                              MOVE 'CASE' TO ASC-KEY-VFY-SRC      25050000
250600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25060000
250700                             IF ASC-ALL-VFY-SRC = 'MANUAL' OR     25070000
250800                                ASC-ALL-VFY-SRC = SPACES          25080000
250900                                MOVE 'CASE' TO ASC-ALL-VFY-SRC    25090000
251000                             END-IF                               25100000
251100                         ELSE                                     25110000
251200                           IF (DISTHD-P2L-CART-CNT > 0            25120000
251300                             AND (DISTHD-FCSE-CART-CNT > 0        25130000
251400                               OR DISTHD-INPK-CART-CNT > 0))      25140000
251500                               MOVE 'P2L/CASE'                    25150000
251600                                             TO ASC-SOURCE        25160000
251700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    25170000
251800                               MOVE 'P2L/CASE' TO ASC-KEY-VFY-SRC 25180000
251810                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25181000
251820                               IF ASC-ALL-VFY-SRC = 'MANUAL' OR   25182000
251821                                  ASC-ALL-VFY-SRC = SPACES        25182100
251823                                  MOVE 'P2L/CASE'                 25182300
251824                                                TO ASC-ALL-VFY-SRC25182400
251825                               END-IF                             25182500
251826                           ELSE                                   25182600
251827                           IF (DISTHD-P2L-CART-CNT > 0            25182700
251828                              AND (DISTHD-FCSE-CART-CNT = 0       25182800
251829                              AND DISTHD-INPK-CART-CNT = 0))      25182900
251830                              MOVE 'P2L'  TO ASC-SOURCE           25183000
251831                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25183100
251840                               MOVE 'P2L' TO ASC-KEY-VFY-SRC      25184000
251850                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25185000
251860                               IF ASC-ALL-VFY-SRC = 'MANUAL' OR   25186000
251870                                  ASC-ALL-VFY-SRC = SPACES        25187000
251880                                  MOVE 'P2L'  TO ASC-ALL-VFY-SRC  25188000
251890                               END-IF                             25189000
251900                           ELSE                                   25190000
252000                               MOVE 'MANUAL' TO  ASC-SOURCE       25200000
252100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25210000
252200                               MOVE 'MANUAL' TO ASC-KEY-VFY-SRC   25220000
252300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25230000
252400                               IF ASC-ALL-VFY-SRC = SPACES        25240000
252500                                  MOVE 'MANUAL' TO ASC-ALL-VFY-SRC25250000
252600                               END-IF                             25260000
252700                           END-IF                                 25270000
252800                           END-IF                                 25280000
252900                         END-IF                                   25290000
253000                     END-IF                                       25300000
253100                 END-IF                                           25310000
253200             END-IF                                               25320000
253300             IF  RECEIV-FS-POST-TMST NOT EQUAL TO                 25330000
253400                 PC-DB2-DEFAULT-TMST                              25340000
253500                    SET ASC-CANT-UNVERIFY-FS                      25350000
253600                               TO  TRUE                           25360000
253700             END-IF                                               25370000
253800             IF  RECITM-STATUS-CDE NOT EQUAL 'VE'                 25380000
253900                 SET ASC-CANT-UNVERIFY-ST                         25390000
254000                               TO  TRUE                           25400000
254100             END-IF                                               25410000
254110                                                                  25411000
254120             PERFORM 4360-CALL-RCKUT128                           25412000
254130                                                                  25413000
254140**           PERFORM 7055-GET-TDISTHD                             25414000
254150**           PERFORM 4330-SUM-TRECDIS-DRIVER                      25415000
254160**           PERFORM 4380-SELECT-ODD-UNITS-DRIVER                 25416000
254170**           PERFORM 4390-SELECT-ODD-UNITS                        25417000
254180**           IF PV-DRIVER-RATIO > 0                               25418000
254190**               COMPUTE PV-PKSLIP-PACKS =                        25419000
254200**                       PV-LNE-EXPTED-ITM-QTY   / PV-DRIVER-RATIO25420000
254300**               COMPUTE PV-ACTUAL-PACKS =                        25430000
254400**                  (PV-LNE-VERIFY-ITM-QTY                        25440000
254500**                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)   25450000
254600**                                               / PV-DRIVER-RATIO25460000
254700**               COMPUTE PV-VERFYD-PACKS =                        25470000
254701**                  (PV-LNE-AP-VERIFY-ITM-QTY                     25470100
254702**                                - PV-ODD-AP-VERIFY-ODU-PK-QTY)  25470200
254703**                                               / PV-DRIVER-RATIO25470300
254704**           ELSE                                                 25470400
254705**               MOVE 0            TO PV-PKSLIP-PACKS             25470500
254706**               MOVE 0            TO PV-ACTUAL-PACKS             25470600
254707**               MOVE 0            TO PV-VERFYD-PACKS             25470700
254708**           END-IF                                               25470800
254709             MOVE RC074-TOTAL-INVC-PACK-QTY                       25470900
254710                                   TO  ASC-PACKSLIP-PACKS         25471000
254720                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25472000
254730             ADD RC074-TOTAL-INVC-PACK-QTY                        25473000
254740                                   TO  ASC-TOT-PKSLIP-PACKS       25474000
254750             MOVE RC074-TOTAL-ACTL-PACK-QTY                       25475000
254760                                   TO  ASC-ACTUAL-PACKS           25476000
254770                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25477000
254780             ADD RC074-TOTAL-ACTL-PACK-QTY                        25478000
254790                                   TO  ASC-TOT-ACTUAL-PACKS       25479000
254800             MOVE RC074-VERIFY-PACK-QTY                           25480000
254900                                   TO  ASC-VRFYD-PACKS            25490000
255000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25500000
255100             ADD RC074-VERIFY-PACK-QTY                            25510000
255200                                  TO  ASC-TOT-VERFYD-PACKS        25520000
255300             IF RECITM-STATUS-CDE = 'VE'                          25530000
255400                 MOVE RC074-VERIFY-ODD-QTY                        25540000
255500                                   TO  ASC-ODD-UNITS              25550000
255600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25560000
255700             ELSE                                                 25570000
255800                 MOVE RC074-ACTUAL-ODD-QTY                        25580000
255900                                   TO  ASC-ODD-UNITS              25590000
256000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 25600000
256100             END-IF                                               25610000
256200             ADD ASC-ODD-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)         25620000
256300                                   TO  ASC-TOT-ODD-UNITS          25630000
256400             MOVE PURCHS-DEPT-NBR                                 25640000
256500                               TO ASC-DEPT-NBR                    25650000
256600             ADD RC074-VERIFY-ITM-QTY  TO ASC-HDR-TOT-VERFYD-UNTS 25660000
256700             ADD RC074-TOTAL-ACTL-ITM-QTY TO ASC-HDR-TOT-ACT-UNTS 25670000
256800         END-IF                                                   25680000
256900     END-PERFORM.                                                 25690000
257000                                                                  25700000
257100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          25710000
257200         MOVE +1               TO ASC-BLK-SUB                     25720000
257300         PERFORM 5100-WRITE-TEMP-STORAGE                          25730000
257400         ADD +1                TO ASC-BLK-SUB                     25740000
257500         PERFORM 5100-WRITE-TEMP-STORAGE                          25750000
257600                                                                  25760000
257700         MOVE 1                TO ASC-BLK-SUB                     25770000
257800                                  PV-BLOCK-NUMBER                 25780000
257900         PERFORM 4410-READ-TEMP-STORAGE                           25790000
258000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             25800000
258100             MOVE 2            TO ASC-BLK-SUB                     25810000
258200                                  PV-BLOCK-NUMBER                 25820000
258300             PERFORM 4410-READ-TEMP-STORAGE                       25830000
258400         END-IF                                                   25840000
258500     END-IF.                                                      25850000
258600 EJECT                                                            25860000
258700                                                                  25870000
258800 4310-FETCH.                                                      25880000
258900                                                                  25890000
259000     EXEC SQL                                                     25900000
259100          FETCH PACK-SLIP-CSR                                     25910000
259200          INTO  :RECITM-STATUS-CDE                                25920000
259300              , :RECITM-VRFD-USR-ID                               25930000
259400              , :RECDIS-EXPTED-ITM-QTY                            25940000
259500              , :RECDIS-VERIFY-ITM-QTY                            25950000
259600              , :PURCHS-DEPT-NBR                                  25960000
259700              , :RECITM-PREPK-ID                                  25970000
259800                                                                  25980000
259900     END-EXEC.                                                    25990000
260000                                                                  26000000
260100     EVALUATE TRUE                                                26010000
260200         WHEN SQLCODE = ZERO                                      26020000
260300         WHEN SQLCODE = +100                                      26030000
260400              CONTINUE                                            26040000
260500         WHEN SQLWARN0 NOT = SPACE                                26050000
260600         WHEN SQLCODE NOT = ZERO                                  26060000
260700              MOVE '4310-FETCH-CURSOR'                            26070000
260800                               TO DP013-PARAGRAPH                 26080000
260900              MOVE 'FETCH PACK SLIP CURSOR'                       26090000
261000                               TO DP013-MESSAGE-TEXT (1)          26100000
261100              MOVE SQLCA       TO DP013-SQLCA                     26110000
261200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             26120000
261300              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        26130000
261400              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        26140000
261500              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           26150000
261600              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            26160000
261700              STRING ' PO = '                                     26170000
261800                     PV-DISP-PO-NBR                               26180000
261900                     ' RECV ='                                    26190000
262000                     PV-DISP-REC-SEQ-NBR                          26200000
262100                     ' OPER = '                                   26210000
262200                     PV-DISP-OPER-UNT-ID                          26220000
262300                     ' FCLTY = '                                  26230000
262400                     PV-DISP-FCLTY-ID                             26240000
262500                     ' STORE ='                                   26250000
262600                     PV-DISP-STR-NBR     DELIMITED BY SIZE        26260000
262700                              INTO DP013-MESSAGE-TEXT (2)         26270000
262800              MOVE SQLCA        TO DP013-SQLCA                    26280000
262900              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)       26290000
263000              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)       26300000
263100              MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)       26310000
263200              MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)       26320000
263300              SET DP013-DB2-ABEND                                 26330000
263400                               TO TRUE                            26340000
263500              PERFORM DP013-0000-PROCESS-ABEND                    26350000
263600     END-EVALUATE.                                                26360000
263700                                                                  26370000
263800     IF  SQLCODE EQUAL +100                                       26380000
263900         SET ASC-NO-ITEMS-LEFT-ON-DB                              26390000
264000                                   TO TRUE                        26400000
264100     END-IF.                                                      26410000
264200                                                                  26420000
264300 4320-SUM-TRECDIS.                                                26430000
264400                                                                  26440000
264500     MOVE ZERO                 TO RECDIS-AP-VERIFY-ITM-QTY.       26450000
264600     MOVE ZERO                 TO RECDIS-VERIFY-ITM-QTY.          26460000
264700                                                                  26470000
264800     EXEC SQL                                                     26480000
264900          SELECT                                                  26490000
265000                 SUM(A.AP_VERIFY_ITM_QTY)                         26500000
265100                ,SUM(A.VERIFY_ITM_QTY)                            26510000
265200          INTO                                                    26520000
265300                :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND            26530000
265400               ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND               26540000
265500          FROM                                                    26550000
265600                 TRECDIS A                                        26560000
265700              ,  TRECITM  B                                       26570000
265800          WHERE                                                   26580000
265900                A.ORD_NBR          =  :DK-PO-NBR                  26590000
266000           AND  A.ORD_NBR          =  B.ORD_NBR                   26600000
266100           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             26610000
266200           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               26620000
266300           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                26630000
266400           AND  A.FCLTY_ID         =  B.FCLTY_ID                  26640000
266500           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             26650000
266600           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               26660000
266700           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               26670000
266900           AND  B.VER_STATUS_CDE   =  'A'                         26690000
267000           AND  A.STR_NBR          = :DK-STR-NBR                  26700000
267100                                                                  26710000
267200     END-EXEC.                                                    26720000
267300                                                                  26730000
267400     EVALUATE TRUE                                                26740000
267500         WHEN SQLCODE = ZERO                                      26750000
267600         WHEN SQLCODE = +100                                      26760000
267700              CONTINUE                                            26770000
267800         WHEN SQLCODE = -904                                      26780000
267900         WHEN SQLCODE = -911                                      26790000
268000         WHEN SQLCODE = -913                                      26800000
268100             PERFORM 9900-SOFT-ABORT                              26810000
268200         WHEN SQLCODE = -305                                      26820000
268300              CONTINUE                                            26830000
268400         WHEN SQLWARN0 NOT = SPACE                                26840000
268500         WHEN SQLCODE NOT = ZERO                                  26850000
268600              MOVE '4320-SUM-TRECDIS'                             26860000
268700                               TO DP013-PARAGRAPH                 26870000
268800              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  26880000
268900                               TO DP013-MESSAGE-TEXT (1)          26890000
269000              MOVE SQLCA       TO DP013-SQLCA                     26900000
269100              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             26910000
269200              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        26920000
269300              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        26930000
269400              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           26940000
269500              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            26950000
269600              STRING ' PO = '                                     26960000
269700                     PV-DISP-PO-NBR                               26970000
269800                     ' RECV ='                                    26980000
269900                     PV-DISP-REC-SEQ-NBR                          26990000
270000                     ' OPER = '                                   27000000
270100                     PV-DISP-OPER-UNT-ID                          27010000
270200                     ' FCLTY = '                                  27020000
270300                     PV-DISP-FCLTY-ID                             27030000
270400                     ' STORE ='                                   27040000
270500                     PV-DISP-STR-NBR     DELIMITED BY SIZE        27050000
270600                              INTO DP013-MESSAGE-TEXT (2)         27060000
270700              MOVE SQLCA        TO DP013-SQLCA                    27070000
270800              MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)       27080000
270900              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)       27090000
271000              SET DP013-DB2-ABEND                                 27100000
271100                               TO TRUE                            27110000
271200              PERFORM DP013-0000-PROCESS-ABEND                    27120000
271300     END-EVALUATE.                                                27130000
271400/                                                                 27140000
271500 4330-SUM-TRECDIS-DRIVER.                                         27150000
271600                                                                  27160000
271700     MOVE ZERO                 TO  PV-LNE-AP-VERIFY-ITM-QTY.      27170000
271800     MOVE ZERO                 TO  PV-LNE-VERIFY-ITM-QTY.         27180000
271900     MOVE ZERO                 TO  PV-LNE-EXPTED-ITM-QTY.         27190000
272000                                                                  27200000
272100     EXEC SQL                                                     27210000
272200          SELECT                                                  27220000
272300                 SUM(AP_VERIFY_ITM_QTY)                           27230000
272400                ,SUM(VERIFY_ITM_QTY)                              27240000
272500                ,SUM(EXPTED_ITM_QTY)                              27250000
272600          INTO                                                    27260000
272700                :PV-LNE-AP-VERIFY-ITM-QTY :PV-NULL-IND            27270000
272800               ,:PV-LNE-VERIFY-ITM-QTY :PV-NULL-IND               27280000
272900               ,:PV-LNE-EXPTED-ITM-QTY :PV-NULL-IND               27290000
273000          FROM                                                    27300000
273100                 TRECDIS                                          27310000
273200          WHERE                                                   27320000
273300                ORD_NBR          =  :DK-PO-NBR                    27330000
273400           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             27340000
273500           AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR               27350000
273600           AND  FCLTY_ID         =  :DK-FCLTY-ID                  27360000
273700           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               27370000
273800           AND  STR_NBR          =  :DK-STR-NBR                   27380000
274000     END-EXEC.                                                    27400000
274100                                                                  27410000
274200     EVALUATE TRUE                                                27420000
274300         WHEN SQLCODE = ZERO                                      27430000
274400         WHEN SQLCODE = +100                                      27440000
274500              CONTINUE                                            27450000
274600         WHEN SQLCODE = -904                                      27460000
274700         WHEN SQLCODE = -911                                      27470000
274800         WHEN SQLCODE = -913                                      27480000
274900             PERFORM 9900-SOFT-ABORT                              27490000
275000         WHEN SQLCODE = -305                                      27500000
275100              CONTINUE                                            27510000
275200         WHEN SQLWARN0 NOT = SPACE                                27520000
275300         WHEN SQLCODE NOT = ZERO                                  27530000
275400              MOVE '4330-SUM-TRECDIS'                             27540000
275500                               TO DP013-PARAGRAPH                 27550000
275600              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  27560000
275700                               TO DP013-MESSAGE-TEXT (1)          27570000
275800              MOVE SQLCA       TO DP013-SQLCA                     27580000
275900              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             27590000
276000              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        27600000
276100              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           27610000
276200              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        27620000
276300              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            27630000
276400              STRING ' PO = '                                     27640000
276500                     PV-DISP-PO-NBR                               27650000
276600                     ' OPER = '                                   27660000
276700                     PV-DISP-OPER-UNT-ID                          27670000
276800                     ' FCLTY = '                                  27680000
276900                     PV-DISP-FCLTY-ID                             27690000
277000                     ' RECV ='                                    27700000
277100                     PV-DISP-REC-SEQ-NBR                          27710000
277200                     ' PACK ='                                    27720000
277300                     PV-DISP-PREPK-ID    DELIMITED BY SIZE        27730000
277400                              INTO DP013-MESSAGE-TEXT (2)         27740000
277500              MOVE SQLCA        TO DP013-SQLCA                    27750000
277600              MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)       27760000
277700              SET DP013-DB2-ABEND                                 27770000
277800                               TO TRUE                            27780000
277900              PERFORM DP013-0000-PROCESS-ABEND                    27790000
278000     END-EVALUATE.                                                27800000
278100/                                                                 27810000
278200 4340-SELECT-DRIVER-RATIO.                                        27820000
278300                                                                  27830000
278400     EXEC SQL                                                     27840000
278500          SELECT                                                  27850000
278600                B.ORD_LNE_NBR                                     27860000
278700             ,  B.PREPK_RATO_QTY                                  27870000
278800             ,  D.PK_SKU_NBR                                      27880000
278900          INTO                                                    27890000
279000                :RECITM-ORD-LNE-NBR                               27900000
279100             ,  :RECITM-PREPK-RATO-QTY                            27910000
279200             ,  :POPRPK-PK-SKU-NBR                                27920000
279300          FROM    TRECEIV  A                                      27930000
279400              ,   TRECITM  B                                      27940000
279500              ,   TPURITM  C                                      27950000
279600              ,   TPOPRPK  D                                      27960000
279700              ,   TRECDIS  E                                      27970000
279800          WHERE A.ORD_NBR          =  :DK-PO-NBR                  27980000
279900           AND  A.ORD_NBR          =  B.ORD_NBR                   27990000
280000           AND  A.ORD_NBR          =  C.PO_NBR                    28000000
280100           AND  A.ORD_NBR          =  D.PO_NBR                    28010000
280200           AND  A.ORD_NBR          =  E.ORD_NBR                   28020000
280300           AND  A.VER_STATUS_CDE   =  'A'                         28030000
280400           AND  B.VER_STATUS_CDE   =  'A'                         28040000
280500           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             28050000
280600           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               28060000
280700           AND  A.OPER_UNT_ID      =  E.OPER_UNT_ID               28070000
280800           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                28080000
280900           AND  A.FCLTY_ID         =  B.FCLTY_ID                  28090000
281000           AND  A.FCLTY_ID         =  E.FCLTY_ID                  28100000
281100           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             28110000
281200           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               28120000
281300           AND  A.REC_SEQ_NBR      =  E.REC_SEQ_NBR               28130000
281400           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            28140000
281500           AND  B.ORD_LNE_NBR      =  E.ORD_LNE_NBR               28150000
281600           AND  B.PO_VER_NBR       =  C.VER_NBR                   28160000
281700           AND  B.PREPK_DRV_LNE_CDE = 'A'                         28170000
281800           AND  B.PREPK_ID         = :DK-PREPK-ID                 28180000
281900           AND  B.PREPK_ID         =  D.PO_PREPK_ID               28190000
282000           AND  E.STR_NBR          = :DK-STR-NBR                  28200000
282100     END-EXEC.                                                    28210000
282200                                                                  28220000
282300     EVALUATE TRUE                                                28230000
282400         WHEN SQLCODE = ZERO                                      28240000
282500         WHEN SQLCODE = -904                                      28250000
282600         WHEN SQLCODE = -913                                      28260000
282700             CONTINUE                                             28270000
282800         WHEN SQLCODE = +100                                      28280000
282900             SET PS-NO-DRIVER-INFO TO TRUE                        28290000
283000         WHEN SQLWARN0 NOT = SPACES                               28300000
283100         WHEN SQLCODE < ZERO                                      28310000
283200         WHEN SQLCODE > ZERO                                      28320000
283300             MOVE '4340-SELECT-DRIVER-RATIO'                      28330000
283400                               TO DP013-PARAGRAPH                 28340000
283500             MOVE 'SELECT DRIVER RATIO '                          28350000
283600                               TO DP013-MESSAGE-TEXT (1)          28360000
283700             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              28370000
283800             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         28380000
283900             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         28390000
284000             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            28400000
284100             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            28410000
284200             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             28420000
284300             STRING ' PO = '                                      28430000
284400                    PV-DISP-PO-NBR                                28440000
284500                    ' OPER = '                                    28450000
284600                    PV-DISP-OPER-UNT-ID                           28460000
284700                    ' FCLTY = '                                   28470000
284800                    PV-DISP-FCLTY-ID                              28480000
284900                    ' RECV ='                                     28490000
285000                    PV-DISP-REC-SEQ-NBR                           28500000
285100                    ' PACK ='                                     28510000
285200                    PV-DISP-PREPK-ID                              28520000
285300                    ' STORE ='                                    28530000
285400                    PV-DISP-STR-NBR     DELIMITED BY SIZE         28540000
285500                             INTO DP013-MESSAGE-TEXT (2)          28550000
285600             MOVE SQLCA        TO DP013-SQLCA                     28560000
285700             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        28570000
285800             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        28580000
285900             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)        28590000
286000             MOVE 'TPOPRPK '   TO DP013-DB2-TABLE-NAME (4)        28600000
286100             SET DP013-DB2-ABEND                                  28610000
286200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28620000
286300             PERFORM DP013-0000-PROCESS-ABEND                     28630000
286400     END-EVALUATE.                                                28640000
286500*                                                                 28650000
286600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28660000
286700         MOVE '4340-SELECT-DRIVER-RATIO' TO DP013-PARAGRAPH       28670000
286800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING ON SELECT'     28680000
286900                                   TO DP013-MESSAGE-TEXT (1)      28690000
287000         MOVE ASC-PO-NBR           TO PV-DISP-PO-NBR              28700000
287100         MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID         28710000
287200         MOVE ASC-FCLTY-ID         TO PV-DISP-FCLTY-ID            28720000
287300         MOVE ASC-REC-SEQ-NBR      TO PV-DISP-REC-SEQ-NBR         28730000
287400         MOVE DK-PREPK-ID          TO PV-DISP-PREPK-ID            28740000
287500         STRING ' PO = '                                          28750000
287600                PV-DISP-PO-NBR                                    28760000
287700                ' OPER = '                                        28770000
287800                PV-DISP-OPER-UNT-ID                               28780000
287900                ' FCLTY = '                                       28790000
288000                PV-DISP-FCLTY-ID                                  28800000
288100                ' RECV ='                                         28810000
288200                PV-DISP-REC-SEQ-NBR                               28820000
288300                ' PACK ='                                         28830000
288400                PV-DISP-PREPK-ID    DELIMITED BY SIZE             28840000
288500                         INTO DP013-MESSAGE-TEXT (2)              28850000
288600         MOVE SQLCA                TO DP013-SQLCA                 28860000
288700         MOVE 'TRECEIV '           TO DP013-DB2-TABLE-NAME (1)    28870000
288800         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (2)    28880000
288900         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (3)    28890000
289000         SET DP013-DB2-ABEND                                      28900000
289100             DP013-XCTL-DISPLAY-RESTART                           28910000
289200                                   TO TRUE                        28920000
289300         PERFORM DP013-0000-PROCESS-ABEND                         28930000
289400     END-IF.                                                      28940000
289500                                                                  28950000
289600                                                                  28960000
289700 4350-SELECT-PRE-PACK-ID.                                         28970000
289800                                                                  28980000
289900     MOVE ASC-PO-LNE-NBR        TO DK-HOLD-LNE-NBR.               28990000
290000                                                                  29000000
290100     EXEC SQL                                                     29010000
290200          SELECT DISTINCT                                         29020000
290300                A.PREPK_ID                                        29030000
290400          INTO  :RECITM-PREPK-ID                                  29040000
290500          FROM    TRECITM A                                       29050000
290600          WHERE A.ORD_NBR          =  :DK-PO-NBR                  29060000
290700           AND  A.VER_STATUS_CDE   =  'A'                         29070000
290800           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             29080000
290900           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                29090000
291000           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             29100000
291100           AND  A.ORD_LNE_NBR      =  :DK-HOLD-LNE-NBR            29110000
291200     END-EXEC.                                                    29120000
291300                                                                  29130000
291400     EVALUATE TRUE                                                29140000
291500         WHEN SQLCODE = ZERO                                      29150000
291600             MOVE RECITM-PREPK-ID   TO DK-PREPK-ID                29160000
291700         WHEN SQLCODE = -904                                      29170000
291800         WHEN SQLCODE = -913                                      29180000
291900             CONTINUE                                             29190000
292000         WHEN SQLWARN0 NOT = SPACES                               29200000
292100         WHEN SQLCODE < ZERO                                      29210000
292200         WHEN SQLCODE > ZERO                                      29220000
292300             MOVE '4350-SELECT-PRE-PACK-ID'                       29230000
292400                               TO DP013-PARAGRAPH                 29240000
292500             MOVE 'SELECT PRE-PACK ID '                           29250000
292600                               TO DP013-MESSAGE-TEXT (1)          29260000
292700             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              29270000
292800             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         29280000
292900             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            29290000
293000             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         29300000
293100             MOVE DK-HOLD-LNE-NBR  TO PV-DISP-LNE-NBR             29310000
293200             STRING ' PO = '                                      29320000
293300                    PV-DISP-PO-NBR                                29330000
293400                    ' RECV ='                                     29340000
293500                    PV-DISP-REC-SEQ-NBR                           29350000
293600                    ' OPER = '                                    29360000
293700                    PV-DISP-OPER-UNT-ID                           29370000
293800                    ' FCLTY = '                                   29380000
293900                    PV-DISP-FCLTY-ID                              29390000
294000                    ' LINE = '                                    29400000
294100                    PV-DISP-LNE-NBR                               29410000
294200                                        DELIMITED BY SIZE         29420000
294300                             INTO DP013-MESSAGE-TEXT (2)          29430000
294400             MOVE SQLCA        TO DP013-SQLCA                     29440000
294500             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)        29450000
294600             SET DP013-DB2-ABEND                                  29460000
294700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29470000
294800             PERFORM DP013-0000-PROCESS-ABEND                     29480000
294900     END-EVALUATE.                                                29490000
295000*                                                                 29500000
295100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29510000
295200         MOVE '4350-SELECT-PRE-PACK-ID' TO DP013-PARAGRAPH        29520000
295300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING ON SELECT'     29530000
295400                                   TO DP013-MESSAGE-TEXT (1)      29540000
295500         MOVE ASC-PO-NBR           TO PV-DISP-PO-NBR              29550000
295600         MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID         29560000
295700         MOVE ASC-FCLTY-ID         TO PV-DISP-FCLTY-ID            29570000
295800         MOVE ASC-REC-SEQ-NBR      TO PV-DISP-REC-SEQ-NBR         29580000
295900         STRING ' PO = '                                          29590000
296000                PV-DISP-PO-NBR                                    29600000
296100                ' OPER = '                                        29610000
296200                PV-DISP-OPER-UNT-ID                               29620000
296300                ' FCLTY = '                                       29630000
296400                PV-DISP-FCLTY-ID                                  29640000
296500                ' RECV ='                                         29650000
296600                PV-DISP-REC-SEQ-NBR                               29660000
296700                                    DELIMITED BY SIZE             29670000
296800                         INTO DP013-MESSAGE-TEXT (2)              29680000
296900         MOVE SQLCA                TO DP013-SQLCA                 29690000
297000         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    29700000
297100         SET DP013-DB2-ABEND                                      29710000
297200             DP013-XCTL-DISPLAY-RESTART                           29720000
297300                                   TO TRUE                        29730000
297400         PERFORM DP013-0000-PROCESS-ABEND                         29740000
297500     END-IF.                                                      29750000
297600                                                                  29760000
297700 4360-CALL-RCKUT128.                                              29770000
297800     INITIALIZE RC074-FIELDS.                                     29780000
297900     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               29790000
298000     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  29800000
298100     MOVE ASC-PO-NBR          TO RC074-PO-NBR.                    29810000
298200     MOVE ASC-REC-SEQ-NBR     TO RC074-RCVR-SEQ-NBR.              29820000
298300     MOVE RECITM-PREPK-ID     TO RC074-PACK-ID.                   29830000
298400     MOVE ASC-STR-NBR         TO RC074-STR-NBR.                   29840000
298500     MOVE ASC-AUTO-VE-SW      TO RC074-AUTO-VE-SW.                29850000
298600     SET RC074-PACK-QTY-YES   TO TRUE.                            29860000
298700                                                                  29870000
298800     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 29880000
298900                                         RC074-COMMAREA           29890000
298910                                         RC074-FIELDS.            29891000
298920                                                                  29892000
298930     EVALUATE TRUE                                                29893000
298940         WHEN RC074-SUCCESSFUL                                    29894000
298950             CONTINUE                                             29895000
298960         WHEN OTHER                                               29896000
298970             MOVE '4360-CALL-RCKUT128'                            29897000
298980                                 TO DP013-PARAGRAPH               29898000
298990             STRING                                               29899000
299000                  'UNSUCCESSFUL CALL TO RCKUT128 '                29900000
299001                  'SUCCESS-IND = '                                29900100
299002                  RC074-SUCCESS-IND                               29900200
299003                               DELIMITED BY SIZE                  29900300
299004                               INTO DP013-MESSAGE-TEXT (1)        29900400
299005             MOVE RC074-CRA-RET-MSG                               29900500
299006                                 TO DP013-MESSAGE-TEXT (2)        29900600
299007             MOVE RC074-SQLCA    TO DP013-SQLCA                   29900700
299008             SET DP013-DB2-ABEND                                  29900800
299009                 DP013-XCTL-DISPLAY-RESTART                       29900900
299010                                 TO TRUE                          29901000
299011             PERFORM DP013-0000-PROCESS-ABEND                     29901100
299012     END-EVALUATE.                                                29901200
299013                                                                  29901300
299014 4380-SELECT-ODD-UNITS-DRIVER.                                    29901400
299015                                                                  29901500
299016     MOVE 0               TO PV-ODD-DC-VERIFY-ODU-PK-QTY          29901600
299017                             PV-ODD-AP-VERIFY-ODU-PK-QTY.         29901700
299018                                                                  29901800
299019     EXEC SQL                                                     29901900
299020          SELECT                                                  29902000
299030                 SUM(DC_VRFY_ODU_QTY)                             29903000
299040             ,   SUM(AP_VRFY_ODU_QTY)                             29904000
299050          INTO                                                    29905000
299060                :PV-ODD-DC-VERIFY-ODU-PK-QTY :PV-NULL-IND         29906000
299070             ,  :PV-ODD-AP-VERIFY-ODU-PK-QTY :PV-NULL-IND         29907000
299080          FROM                                                    29908000
299090                 RCT_VRFD_ODD_UNT                                 29909000
299100          WHERE                                                   29910000
299200                PO_NBR           =  :DK-PO-NBR                    29920000
299300           AND  PO_LNE_NBR       =  :DK-PO-DRIVER-LNE             29930000
299400           AND  RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               29940000
299500           AND  STR_NBR          =  :DK-STR-NBR                   29950000
299600     END-EXEC.                                                    29960000
299700                                                                  29970000
299800     EVALUATE TRUE                                                29980000
299900         WHEN SQLCODE = ZERO                                      29990000
300000         WHEN SQLCODE = +100                                      30000000
300100              CONTINUE                                            30010000
300200         WHEN SQLCODE = -904                                      30020000
300300         WHEN SQLCODE = -911                                      30030000
300400         WHEN SQLCODE = -913                                      30040000
300500             PERFORM 9900-SOFT-ABORT                              30050000
300600         WHEN SQLCODE = -305                                      30060000
300700              CONTINUE                                            30070000
300800         WHEN SQLWARN0 NOT = SPACE                                30080000
300900         WHEN SQLCODE NOT = ZERO                                  30090000
301000              MOVE '4380-SELECT-ODD-UNITS-DRIVER'                 30100000
301100                               TO DP013-PARAGRAPH                 30110000
301200              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  30120000
301300                               TO DP013-MESSAGE-TEXT (1)          30130000
301400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             30140000
301500              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        30150000
301600              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            30160000
301700              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            30170000
301800              STRING ' PO = '                                     30180000
301900                     PV-DISP-PO-NBR                               30190000
302000                     ' RECV ='                                    30200000
302100                     PV-DISP-REC-SEQ-NBR                          30210000
302200                     ' LINE = '                                   30220000
302300                     PV-DISP-LNE-NBR                              30230000
302400                     ' STR = '                                    30240000
302500                     PV-DISP-STR-NBR                              30250000
302600                                         DELIMITED BY SIZE        30260000
302700                              INTO DP013-MESSAGE-TEXT (2)         30270000
302800              MOVE SQLCA        TO DP013-SQLCA                    30280000
302900              MOVE 'RCT00009'   TO DP013-DB2-TABLE-NAME (1)       30290000
303000              MOVE SQLCA       TO DP013-SQLCA                     30300000
303100              SET DP013-DB2-ABEND                                 30310000
303200                               TO TRUE                            30320000
303300              PERFORM DP013-0000-PROCESS-ABEND                    30330000
303400     END-EVALUATE.                                                30340000
303500                                                                  30350000
303600 4390-SELECT-ODD-UNITS.                                           30360000
303700                                                                  30370000
303800     MOVE 0               TO PV-ODD-DC-VERIFY-ODU-QTY             30380000
303900                             PV-ODD-AP-VERIFY-ODU-QTY.            30390000
304000                                                                  30400000
304100     EXEC SQL                                                     30410000
304200          SELECT                                                  30420000
304300                 SUM(A.DC_VRFY_ODU_QTY)                           30430000
304400             ,   SUM(A.AP_VRFY_ODU_QTY)                           30440000
304500          INTO                                                    30450000
304600                :PV-ODD-DC-VERIFY-ODU-QTY :PV-NULL-IND            30460000
304700             ,  :PV-ODD-AP-VERIFY-ODU-QTY :PV-NULL-IND            30470000
304800          FROM                                                    30480000
304900                 RCT_VRFD_ODD_UNT A                               30490000
305000              ,  TRECITM  B                                       30500000
305100          WHERE                                                   30510000
305200                A.PO_NBR           =  :DK-PO-NBR                  30520000
305300           AND  A.PO_NBR           =  B.ORD_NBR                   30530000
305400           AND  A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR             30540000
305500           AND  A.RCVR_SEQ_NBR     =  B.REC_SEQ_NBR               30550000
305600           AND  A.STR_NBR          =  :DK-STR-NBR                 30560000
305601           AND  A.PO_LNE_NBR       =  B.ORD_LNE_NBR               30560100
305602           AND  B.PREPK_ID         =  :DK-PREPK-ID                30560200
305603     END-EXEC.                                                    30560300
305604                                                                  30560400
305605     EVALUATE TRUE                                                30560500
305606         WHEN SQLCODE = ZERO                                      30560600
305607         WHEN SQLCODE = +100                                      30560700
305608              CONTINUE                                            30560800
305609         WHEN SQLCODE = -904                                      30560900
305610         WHEN SQLCODE = -911                                      30561000
305611         WHEN SQLCODE = -913                                      30561100
305612             PERFORM 9900-SOFT-ABORT                              30561200
305613         WHEN SQLCODE = -305                                      30561300
305614              CONTINUE                                            30561400
305615         WHEN SQLWARN0 NOT = SPACE                                30561500
305616         WHEN SQLCODE NOT = ZERO                                  30561600
305617              MOVE '4380-SELECT-ODD-UNITS-DRIVER'                 30561700
305618                               TO DP013-PARAGRAPH                 30561800
305619              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  30561900
305620                               TO DP013-MESSAGE-TEXT (1)          30562000
305621              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             30562100
305622              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        30562200
305623              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            30562300
305624              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            30562400
305625              STRING ' PO = '                                     30562500
305626                     PV-DISP-PO-NBR                               30562600
305627                     ' RECV ='                                    30562700
305628                     PV-DISP-REC-SEQ-NBR                          30562800
305629                     ' LINE = '                                   30562900
305630                     PV-DISP-LNE-NBR                              30563000
305631                     ' STR = '                                    30563100
305632                     PV-DISP-STR-NBR                              30563200
305633                                         DELIMITED BY SIZE        30563300
305634                              INTO DP013-MESSAGE-TEXT (2)         30563400
305635              MOVE SQLCA        TO DP013-SQLCA                    30563500
305636              MOVE 'RCT00009'   TO DP013-DB2-TABLE-NAME (1)       30563600
305637              MOVE SQLCA       TO DP013-SQLCA                     30563700
305638              SET DP013-DB2-ABEND                                 30563800
305639                               TO TRUE                            30563900
305640              PERFORM DP013-0000-PROCESS-ABEND                    30564000
305641     END-EVALUATE.                                                30564100
305642 EJECT                                                            30564200
305643*----------------------------------------------------------------*30564300
305644* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *30564400
305645*----------------------------------------------------------------*30564500
305646                                                                  30564600
305647 4400-MOVE-COMMAREA-TO-SCREEN.                                    30564700
305648     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             30564800
305649         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          30564900
305650         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          30565000
305660             MOVE +1    TO ASC-BLK-SUB                            30566000
305670             PERFORM 5100-WRITE-TEMP-STORAGE                      30567000
305680             ADD +1     TO ASC-BLK-SUB                            30568000
305690             PERFORM 5100-WRITE-TEMP-STORAGE                      30569000
305700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             30570000
305800                 GIVING PV-BLOCK-NUMBER                           30580000
305900                 REMAINDER PV-REMAINDER                           30590000
306000             IF  PV-REMAINDER > ZERO                              30600000
306100                 ADD +1 TO PV-BLOCK-NUMBER                        30610000
306200             END-IF                                               30620000
306300             MOVE +1    TO ASC-BLK-SUB                            30630000
306400             PERFORM 4410-READ-TEMP-STORAGE                       30640000
306500             ADD +1     TO ASC-BLK-SUB                            30650000
306600                           PV-BLOCK-NUMBER                        30660000
306700             PERFORM 4410-READ-TEMP-STORAGE                       30670000
306800     END-IF.                                                      30680000
306900     MOVE +1            TO ASC-BLK-SUB.                           30690000
307000     COMPUTE ASC-ITEM-SUB =                                       30700000
307100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              30710000
307200         + PC-ITEMS-PER-PANEL).                                   30720000
307300*                                                                 30730000
307400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30740000
307500         ADD +1         TO ASC-BLK-SUB                            30750000
307600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30760000
307700     END-IF.                                                      30770000
307800*                                                                 30780000
307900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30790000
308000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30800000
308100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        30810000
308200     PERFORM 4420-FORMAT-LIST-LINES                               30820000
308300         VARYING PV-SUB                                           30830000
308400         FROM PC-ITEMS-PER-PANEL BY -1                            30840000
308500         UNTIL PV-SUB < +1.                                       30850000
308600*                                                                 30860000
308700     COMPUTE ASC-ITEMS-DISPLAYED =                                30870000
308800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          30880000
308900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    30890000
309000                                      ASTRTITO.                   30900000
309100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    30910000
309200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    30920000
309300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30930000
309400                                   TO ASELITO.                    30940000
309500*                                                                 30950000
309600     IF  DP020-MSG-NUMBER-X = SPACE                               30960000
309700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  30970000
309800*            --- MORE ITEMS TO DISPLAY ----                       30980000
309900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            30990000
310000             SET DP020-MSG-INFORMATIONAL TO TRUE                  31000000
310100         END-IF                                                   31010000
310200     END-IF.                                                      31020000
310300*                                                                 31030000
310400*    IF ASC-ALL-VFY-SRC = 'MANUAL'                                31040000
310500*        MOVE 'MANUAL'           TO ATYPE1O                       31050000
310600*        MOVE SPACES             TO ATYPE2O                       31060000
310700*    ELSE                                                         31070000
310800*        IF ASC-ALL-VFY-SRC = 'P2L'                               31080000
310900*            MOVE '  P2L   '     TO ATYPE1O                       31090000
311000*            MOVE SPACES         TO ATYPE2O                       31100000
311100*        ELSE                                                     31110000
311200*           IF ASC-ALL-VFY-SRC = 'CASE'                           31120000
311300*               MOVE '  CASE  '   TO ATYPE1O                      31130000
311400*               MOVE SPACES       TO ATYPE2O                      31140000
311500*           ELSE                                                  31150000
311600*              IF ASC-ALL-VFY-SRC = 'P2L/CASE'                    31160000
311700*                  MOVE '  P2L   '    TO ATYPE1O                  31170000
311800*                  MOVE '  CASE  '    TO ATYPE2O                  31180000
311900*              END-IF                                             31190000
312000*           END-IF                                                31200000
312100*        END-IF                                                   31210000
312200*     END-IF.                                                     31220000
312300                                                                  31230000
312400*    MOVE ASC-SOURCE-TYPE          TO ASRCTYPO.                   31240000
312500     MOVE ASC-PO-NBR               TO APOO.                       31250000
312600     MOVE ASC-REC-SEQ-NBR          TO ARCVRO.                     31260000
312700     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     31270000
312800     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    31280000
312900     MOVE ASC-FCLTY-NME            TO ANAMEO.                     31290000
313000     MOVE ASC-STR-NBR              TO PV-STR-NBR-Z.               31300000
313100     MOVE PV-STR-NBR-Z             TO ASTOREO.                    31310000
313200     MOVE ASC-DEPT-NBR             TO ADEPTO.                     31320000
313300     MOVE ASC-RECEIV-STATUS-CDE    TO ASTATO.                     31330000
313400     MOVE ASC-RECEIV-VRFY-INFO     TO ADTETKO.                    31340000
313500     MOVE ASC-TOT-PKSLIP-PACKS     TO APCKSLPO.                   31350000
313600     MOVE ASC-TOT-ODD-UNITS        TO AODDO.                      31360000
313700     MOVE ASC-TOT-ACTUAL-PACKS     TO AACTPCKO.                   31370000
313800     MOVE ASC-HDR-TOT-ACT-UNTS     TO ATACTLPO.                   31380000
313900     MOVE ASC-TOT-VERFYD-PACKS     TO AVRFPCKO.                   31390000
314000     MOVE ASC-HDR-TOT-VERFYD-UNTS  TO ATVERFO.                    31400000
314100*----------------------------------------------------------------*31410000
314200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *31420000
314300*----------------------------------------------------------------*31430000
314400                                                                  31440000
314500 4410-READ-TEMP-STORAGE.                                          31450000
314600                                                                  31460000
314700     EXEC CICS                                                    31470000
314800         READQ TS                                                 31480000
314900             QUEUE (ASC-LIST-QUEUE-NAME)                          31490000
315000             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31500000
315100             ITEM  (PV-BLOCK-NUMBER)                              31510000
315200             RESP  (PV-CICS-RESP)                                 31520000
315300     END-EXEC.                                                    31530000
315400                                                                  31540000
315500     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       31550000
315600       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     31560000
315700         CONTINUE                                                 31570000
315800     ELSE                                                         31580000
315900         SET DP013-CICS-ABEND     TO TRUE                         31590000
316000         SET DP013-NO-ROLLBACK    TO TRUE                         31600000
316100         MOVE '4410-READ-TEMP-STORAGE'                            31610000
316200                                  TO DP013-PARAGRAPH              31620000
316300         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      31630000
316400                                  TO DP013-MESSAGE-TEXT(1)        31640000
316500         PERFORM DP013-0000-PROCESS-ABEND                         31650000
316600     END-IF.                                                      31660000
316700                                                                  31670000
316800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             31680000
316900*                                                                 31690000
317000     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         31700000
317100         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               31710000
317200     END-IF.                                                      31720000
317300 EJECT                                                            31730000
317400*----------------------------------------------------------------*31740000
317500*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *31750000
317600*----------------------------------------------------------------*31760000
317700                                                                  31770000
317800 4420-FORMAT-LIST-LINES.                                          31780000
317900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      31790000
318000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                31800000
318100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           31810000
318200                                    MR-UPDATE-PACKSA (PV-SUB)     31820000
318300         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           31830000
318400                                    MR-UPDATE-PACKSH (PV-SUB)     31840000
318500         MOVE SPACE              TO MR-SELECTI (PV-SUB)           31850000
318600                                    MR-ACTION (PV-SUB)            31860000
318700                                    MR-UPDATE-PACKS-X (PV-SUB)    31870000
318800                                    MR-PACK-SKU-X (PV-SUB)        31880000
318900                                    MR-PACKSLIP-PACKS-X (PV-SUB)  31890000
319000                                    MR-ACTUAL-PACKS-X (PV-SUB)    31900000
319100                                    MR-VRFYD-PACKS-X (PV-SUB)     31910000
319200                                    MR-ODD-UNITS-X (PV-SUB)       31920000
319300***                                 MR-SOURCE (PV-SUB)            31930000
319400***                                 MR-P2L-PKSLIP-X (PV-SUB)      31940000
319500***                                 MR-P2L-ACTUAL-X (PV-SUB)      31950000
319600***                                 MR-CASE-PKSLIP-X (PV-SUB)     31960000
319700***                                 MR-CASE-ACTUAL-X (PV-SUB)     31970000
319800                                    MR-VERIFY-MSG (PV-SUB)        31980000
319900     ELSE                                                         31990000
320000         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32000000
320100                                                   > SPACE        32010000
320200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32020000
320300                                 TO MR-SELECTI (PV-SUB)           32030000
320400         ELSE                                                     32040000
320500             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32050000
320600                                 TO MR-SELECTI (PV-SUB)           32060000
320700         END-IF                                                   32070000
320800*                                                                 32080000
320900         IF  DP030-SET-CURSOR-TRAILER                             32090000
321000             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)32100000
321100                 > SPACE)                                         32110000
321200               OR (PV-SUB = 1))                                   32120000
321300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               32130000
321400                MOVE -1          TO MR-SELECTL (PV-SUB)           32140000
321500             END-IF                                               32150000
321600         END-IF                                                   32160000
321700*                                                                 32170000
321800         IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)          32180000
321900             MOVE ASC-UPDATE-PACKS-N (ASC-BLK-SUB ASC-ITEM-SUB)   32190000
322000                                   TO PV-DISPLAY-ZERO             32200000
322100             MOVE PV-DISPLAY-ZERO  TO MR-UPDATE-PACKS-X (PV-SUB)  32210000
322200             MOVE DP015-UNP-ALP-NOR-MDT                           32220000
322300                                   TO MR-UPDATE-PACKSA (PV-SUB)   32230000
322400         ELSE                                                     32240000
322500             MOVE ASC-UPDATE-PACKS-N (ASC-BLK-SUB ASC-ITEM-SUB)   32250000
322600                                   TO PV-DISPLAY-NO-ZERO          32260000
322700             MOVE PV-DISPLAY-NO-ZERO                              32270000
322800                                   TO MR-UPDATE-PACKS-X (PV-SUB)  32280000
322900         END-IF                                                   32290000
323000*                                                                 32300000
323100         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           32310000
323200             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           32320000
323300                                 TO MR-ACTION (PV-SUB)            32330000
323400             IF ASC-RECEIV-STATUS-CDE = 'VE' AND                  32340000
323500                ASC-RECEIV-ML-POST-TMST NOT = PC-DB2-DEFAULT-TMST 32350000
323600                   AND                                            32360000
323700                ASC-NOT-POST-VERIFIED-RECEIPT                     32370000
323800                 MOVE DP015-ASK-DRK-OFF                           32380000
323900                                 TO MR-UPDATE-PACKSA (PV-SUB)     32390000
324000                 MOVE DP015-HL-OFF                                32400000
324100                                 TO MR-UPDATE-PACKSH (PV-SUB)     32410000
324200             END-IF                                               32420000
324300             MOVE ASC-PACK-SKU (ASC-BLK-SUB ASC-ITEM-SUB)         32430000
324400                                 TO MR-PACK-SKU (PV-SUB)          32440000
324500             MOVE ASC-PACKSLIP-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)   32450000
324600                                 TO MR-PACKSLIP-PACKS (PV-SUB)    32460000
324700             MOVE ASC-ACTUAL-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)     32470000
324800                                 TO MR-ACTUAL-PACKS (PV-SUB)      32480000
324900             IF ASC-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'VE'    32490000
325000                 MOVE ASC-VRFYD-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)  32500000
325100                                     TO MR-VRFYD-PACKS (PV-SUB)   32510000
325200             ELSE                                                 32520000
325300                 MOVE SPACES         TO MR-VRFYD-PACKS-X (PV-SUB) 32530000
325400             END-IF                                               32540000
325500             MOVE ASC-ODD-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        32550000
325600                                 TO MR-ODD-UNITS (PV-SUB)         32560000
325700             IF ASC-STAT-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'VE'    32570000
325800                  PERFORM 4422-CREATE-VE-MSG                      32580000
325900             ELSE                                                 32590000
326000                  PERFORM 4423-CREATE-NVE-MSG                     32600000
326100             END-IF                                               32610000
326200                                                                  32620000
326300         END-IF                                                   32630000
326400         IF ASC-AUTO-VE-YES                                       32640000
326500             MOVE DP015-ASK-DRK-OFF TO MR-UPDATE-PACKSA (PV-SUB)  32650000
326600         END-IF                                                   32660000
326700     END-IF.                                                      32670000
326800     SUBTRACT +1 FROM ASC-ITEM-SUB                                32680000
326900     IF  ASC-ITEM-SUB < + 1                                       32690000
327000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  32700000
327100         MOVE +1                 TO ASC-BLK-SUB                   32710000
327200     END-IF.                                                      32720000
327300                                                                  32730000
327400 4422-CREATE-VE-MSG.                                              32740000
327500******************************************************************32750000
327600** CREATE THE VARIABLE MESSAGE LINE FOR VERIFIED LINES          **32760000
327700******************************************************************32770000
327800     EVALUATE ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)               32780000
327900        WHEN 'P2L'                                                32790000
328000            MOVE ASC-VRFYD-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)       32800000
328100                                  TO PV-V2-P2L-UNITS              32810000
328200            MOVE PV-V2-MSG TO MR-VERIFY-MSG (PV-SUB)              32820000
328300        WHEN 'CASE'                                               32830000
328400            MOVE ASC-VRFYD-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)       32840000
328500                                  TO PV-V3-CASE-UNITS             32850000
328600            MOVE PV-V3-MSG TO MR-VERIFY-MSG (PV-SUB)              32860000
328700        WHEN 'P2L/CASE'                                           32870000
328800            MOVE 0 TO PV-V1-P2L-UNITS                             32880000
328900                      PV-V1-CASE-UNITS                            32890000
329000            SET ASC-MORE-RECDVS    TO TRUE                        32900000
329100            MOVE ASC-DRIVER-LNE  (ASC-BLK-SUB ASC-ITEM-SUB)       32910000
329200                     TO DK-PO-DRIVER-LNE                          32920000
329300            MOVE ASC-STR-NBR       TO DK-STR-NBR                  32930000
329400            PERFORM 7070-OPEN-TRECDVS                             32940000
329500            PERFORM 4425-PROCESS-TRECDVS                          32950000
329600                   UNTIL ASC-NO-MORE-RECDVS                       32960000
329700            PERFORM 7080-CLOSE-TRECDVS                            32970000
329800        WHEN OTHER                                                32980000
329900            MOVE ASC-VRFYD-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)       32990000
330000                                  TO PV-V4-MANUAL-UNITS           33000000
330100            MOVE PV-V4-MSG TO MR-VERIFY-MSG (PV-SUB)              33010000
330200     END-EVALUATE.                                                33020000
330300******************************************************************33030000
330400** CREATE THE VARIABLE MESSAGE LINE FOR NON VERIFIED LINES      **33040000
330500******************************************************************33050000
330600 4423-CREATE-NVE-MSG.                                             33060000
330700     MOVE ASC-DRIVER-LNE  (ASC-BLK-SUB ASC-ITEM-SUB)              33070000
330800                             TO DK-PO-DRIVER-LNE.                 33080000
330900     PERFORM 7060-GET-TDISTDT.                                    33090000
331000     IF SQLCODE = 0                                               33100000
331100        IF DISTHD-TOT-CART-CNT > 0                                33110000
331200            IF (DISTDT-P2L-SPLT-UNT-QTY > 0 AND                   33120000
331300               (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR                   33130000
331400               DISTDT-INPK-SPLT-UNT-QTY > 0))                     33140000
331500                                                                  33150000
331600                IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND                33160000
331700                   ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) > 033170000
331800                    COMPUTE PV-CASE-PACKS =                       33180000
331900                      DISTDT-P2L-SPLT-UNT-QTY /                   33190000
332000                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33200000
332100                ELSE                                              33210000
332200                    MOVE 0               TO PV-CASE-PACKS         33220000
332300                END-IF                                            33230000
332400                MOVE PV-CASE-PACKS           TO                   33240000
332500                    PV-NV1-P2L-UNITS                              33250000
332600                IF DISTDT-FCSE-SPLT-UNT-QTY > 0 AND               33260000
332700                   ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) > 033270000
332800                    COMPUTE PV-CASE-PACKS =                       33280000
332900                      DISTDT-FCSE-SPLT-UNT-QTY /                  33290000
333000                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33300000
333100                ELSE                                              33310000
333200                    MOVE 0               TO PV-CASE-PACKS         33320000
333300                END-IF                                            33330000
333400                MOVE PV-CASE-PACKS            TO                  33340000
333500                    PV-NV1-CASE-UNITS                             33350000
333600                MOVE PV-NV1-MSG TO MR-VERIFY-MSG (PV-SUB)         33360000
333700            ELSE                                                  33370000
333800                IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND                33380000
333900                   DISTDT-FCSE-SPLT-UNT-QTY = 0 AND               33390000
334000                   DISTDT-INPK-SPLT-UNT-QTY = 0                   33400000
334100                    IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND            33410000
334200                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33420000
334300                                            > 0                   33430000
334400                        COMPUTE PV-CASE-PACKS =                   33440000
334500                      DISTDT-P2L-SPLT-UNT-QTY /                   33450000
334600                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33460000
334700                    ELSE                                          33470000
334800                        MOVE 0           TO PV-CASE-PACKS         33480000
334900                    END-IF                                        33490000
335000                    MOVE PV-CASE-PACKS           TO               33500000
335100                       PV-NV2-P2L-UNITS                           33510000
335200                    MOVE PV-NV2-MSG TO MR-VERIFY-MSG (PV-SUB)     33520000
335300               ELSE                                               33530000
335400                  IF (DISTDT-P2L-SPLT-UNT-QTY = 0 AND             33540000
335500                     (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR             33550000
335600                     DISTDT-INPK-SPLT-UNT-QTY > 0))               33560000
335700                    IF DISTDT-FCSE-SPLT-UNT-QTY > 0 AND           33570000
335800                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33580000
335900                                         > 0                      33590000
336000                        COMPUTE PV-CASE-PACKS =                   33600000
336100                          DISTDT-FCSE-SPLT-UNT-QTY /              33610000
336200                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33620000
336300                    ELSE                                          33630000
336400                        MOVE 0           TO PV-CASE-PACKS         33640000
336500                    END-IF                                        33650000
336600                    MOVE PV-CASE-PACKS            TO              33660000
336700                          PV-NV3-CASE-UNITS                       33670000
336800                    MOVE PV-NV3-MSG TO MR-VERIFY-MSG (PV-SUB)     33680000
336900                  END-IF                                          33690000
337000               END-IF                                             33700000
337100            END-IF                                                33710000
337200        END-IF                                                    33720000
337300     END-IF.                                                      33730000
337400     IF (SQLCODE = +100 OR                                        33740000
337500        (SQLCODE = 0 AND DISTHD-TOT-CART-CNT = 0) OR              33750000
337600        (SQLCODE = 0 AND DISTDT-P2L-SPLT-UNT-QTY = 0 AND          33760000
337700                     DISTDT-FCSE-SPLT-UNT-QTY = 0 AND             33770000
337800                     DISTDT-INPK-SPLT-UNT-QTY = 0))               33780000
337900        MOVE ASC-ACTUAL-PACKS (ASC-BLK-SUB ASC-ITEM-SUB)          33790000
338000                              TO PV-NV4-MANUAL-UNITS              33800000
338100          MOVE PV-NV4-MSG TO MR-VERIFY-MSG (PV-SUB)               33810000
338200     END-IF.                                                      33820000
338300                                                                  33830000
338400                                                                  33840000
338500 4425-PROCESS-TRECDVS.                                            33850000
338600                                                                  33860000
338700         SET ASC-MORE-RECDVS TO TRUE.                             33870000
338800         PERFORM 7075-FETCH-RECDVS.                               33880000
338900                                                                  33890000
339000         IF ASC-NO-MORE-RECDVS                                    33900000
339100             MOVE PV-V1-MSG TO MR-VERIFY-MSG (PV-SUB)             33910000
339200         ELSE                                                     33920000
339300            IF RECDVS-VRFY-SRC-CDE = 'CP'                         33930000
339400                IF RECDVS-VRFY-ITM-QTY > 0 AND                    33940000
339500                   ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) > 033950000
339600                    COMPUTE PV-CASE-PACKS =                       33960000
339700                      RECDVS-VRFY-ITM-QTY /                       33970000
339800                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 33980000
339900                ELSE                                              33990000
340000                    MOVE 0               TO PV-CASE-PACKS         34000000
340100                END-IF                                            34010000
340200                MOVE PV-CASE-PACKS       TO PV-V1-CASE-UNITS      34020000
340300            ELSE                                                  34030000
340400                IF RECDVS-VRFY-SRC-CDE = 'P2'                     34040000
340500                    IF RECDVS-VRFY-ITM-QTY > 0 AND                34050000
340600                       ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)34060000
340700                                       > 0                        34070000
340800                        COMPUTE PV-CASE-PACKS =                   34080000
340900                          RECDVS-VRFY-ITM-QTY /                   34090000
341000                      ASC-DRIVER-RATIO (ASC-BLK-SUB ASC-ITEM-SUB) 34100000
341100                    ELSE                                          34110000
341200                        MOVE 0               TO PV-CASE-PACKS     34120000
341300                    END-IF                                        34130000
341400                    MOVE PV-CASE-PACKS      TO PV-V1-P2L-UNITS    34140000
341500                END-IF                                            34150000
341600            END-IF                                                34160000
341700         END-IF.                                                  34170000
341800**                                                                34180000
341900**       IF ASC-NO-MORE-RECDVS                                    34190000
342000**           IF PV-RECDVS-COUNT = 0                               34200000
342100**              MOVE 'MANUAL' TO MR-SOURCE (PV-SUB)               34210000
342200**                           ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)34220000
342300**              MOVE ASC-P2L-PKSLIP                               34230000
342400**                               (ASC-BLK-SUB ASC-ITEM-SUB)       34240000
342500**                             TO MR-P2L-PKSLIP (PV-SUB)          34250000
342600**              MOVE ASC-P2L-ACTUAL (ASC-BLK-SUB ASC-ITEM-SUB)    34260000
342700**                             TO MR-P2L-ACTUAL (PV-SUB)          34270000
342800**           END-IF                                               34280000
342900**       ELSE                                                     34290000
343000**          MOVE 'P2L/CASE' TO MR-SOURCE (PV-SUB)                 34300000
343100**          IF RECDVS-VRFY-SRC-CDE = 'CP'                         34310000
343200**              MOVE RECDVS-EXPTED-ITM-QTY                        34320000
343300**                TO MR-CASE-PKSLIP (PV-SUB)                      34330000
343400**              IF ASC-ACTL-CONFIRMED (ASC-BLK-SUB ASC-ITEM-SUB)  34340000
343500**                 MOVE RECDVS-VRFY-ITM-QTY                       34350000
343600**                   TO MR-CASE-ACTUAL (PV-SUB)                   34360000
343700**              ELSE                                              34370000
343800**                 MOVE 0 TO MR-CASE-ACTUAL (PV-SUB)              34380000
343900**              END-IF                                            34390000
344000**          ELSE                                                  34400000
344100**              MOVE RECDVS-EXPTED-ITM-QTY                        34410000
344200**                TO MR-P2L-PKSLIP (PV-SUB)                       34420000
344300**              IF ASC-ACTL-CONFIRMED (ASC-BLK-SUB ASC-ITEM-SUB)  34430000
344400**                 MOVE RECDVS-VRFY-ITM-QTY                       34440000
344500**                 TO MR-P2L-ACTUAL (PV-SUB)                      34450000
344600**              ELSE                                              34460000
344700**                 MOVE 0 TO MR-P2L-ACTUAL (PV-SUB)               34470000
344800**              END-IF                                            34480000
344900**          END-IF                                                34490000
345000**       END-IF.                                                  34500000
345100                                                                  34510000
345200******************************************************************34520000
345300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **34530000
345400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **34540000
345500** ISSUE A WARNING.                                             **34550000
345600******************************************************************34560000
345700 4430-CHECK-FOR-BEGIN-AND-END.                                    34570000
345800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34580000
345900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34590000
346000*            -- NO END-OF-RANGE SPECFIED ---                      34600000
346100             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34610000
346200             SET DP020-MSG-WARNING TO TRUE                        34620000
346300             PERFORM 4431-POSITION-AT-WARNING                     34630000
346400         END-IF                                                   34640000
346500     ELSE                                                         34650000
346600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34660000
346700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34670000
346800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34680000
346900             SET DP020-MSG-WARNING TO TRUE                        34690000
347000             PERFORM 4431-POSITION-AT-WARNING                     34700000
347100         END-IF                                                   34710000
347200     END-IF.                                                      34720000
347300******************************************************************34730000
347400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **34740000
347500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **34750000
347600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **34760000
347700** POSITION THE CURSOR THERE.                                   **34770000
347800******************************************************************34780000
347900 4431-POSITION-AT-WARNING.                                        34790000
348000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34800000
348100                    - PV-TOP-ITEM + 1.                            34810000
348200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34820000
348300         CONTINUE                                                 34830000
348400     ELSE                                                         34840000
348500         SET DP030-SET-CURSOR-APPL-1                              34850000
348600                                   TO TRUE                        34860000
348700         MOVE -1                   TO MR-SELECTL (PV-SUB)         34870000
348800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34880000
348900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34890000
349000     END-IF.                                                      34900000
349100*                                                                 34910000
349200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34920000
349300                    - PV-TOP-ITEM + 1.                            34930000
349400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34940000
349500         CONTINUE                                                 34950000
349600     ELSE                                                         34960000
349700         SET DP030-SET-CURSOR-APPL-1                              34970000
349800                                   TO TRUE                        34980000
349900         MOVE -1                   TO MR-SELECTL (PV-SUB)         34990000
350000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         35000000
350100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         35010000
350200     END-IF.                                                      35020000
350300                                                                  35030000
350400 EJECT                                                            35040000
350500*----------------------------------------------------------------*35050000
350600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *35060000
350700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *35070000
350800* FOR THE SELECTED ITEMS QUEUE.                                  *35080000
350900*                                                                *35090000
351000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *35100000
351100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35110000
351200* THE ARRAY IS FULL.                                             *35120000
351300*----------------------------------------------------------------*35130000
351400                                                                  35140000
351500 5000-PREPARE-SEL-QUEUE.                                          35150000
351600                                                                  35160000
351700     MOVE +1                   TO  ASC-BLK-SUB.                   35170000
351800     PERFORM 5100-WRITE-TEMP-STORAGE.                             35180000
351900     ADD +1                    TO  ASC-BLK-SUB.                   35190000
352000     PERFORM 5100-WRITE-TEMP-STORAGE.                             35200000
352100                                                                  35210000
352200     PERFORM 6010-DELETE-SEL-QUEUE.                               35220000
352300                                                                  35230000
352400     EVALUATE TRUE                                                35240000
352500****    F14 - TO RECEIVER PACK LIST                               35250000
352600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              35260000
352700             INITIALIZE RC800-INTER-APPL-COMMAREA                 35270000
352800             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    35280000
352900                                 TO RC800-NUMBER-OF-SELECTED-ITEMS35290000
353000             MOVE ASC-PO-NBR     TO RC800-REC-NBR-N               35300000
353100             MOVE ASC-REC-SEQ-NBR                                 35310000
353200                                 TO RC800-REC-SEQ-NBR-N           35320000
353300             MOVE ASC-OPER-UNT-ID                                 35330000
353400                                 TO RC800-OPER-UNIT-ID            35340000
353500             MOVE ASC-FCLTY-ID   TO RC800-FACILITY-ID             35350000
353600             MOVE ASC-SEL-QUEUE-NAME-OUT TO RC800-SEL-QUEUE-NAME  35360000
353700             SET ASC-UPDATE-TSQ        TO  TRUE                   35370000
353800                                                                  35380000
353900             SET RC801-IDX             TO  1                      35390000
354000             MOVE ZERO                 TO RC800-NUMBER-OF-TS-ITEMS35400000
354100             INITIALIZE RC801-SELECTED-ITEM-ARRAY                 35410000
354200                                                                  35420000
354300             PERFORM 5210-FILL-SEL-QUEUE-RECORD2                  35430000
354400                     VARYING PV-ITEM                              35440000
354500                     FROM 1 BY 1                                  35450000
354600                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 35460000
354700                                                                  35470000
354800             IF  RC801-IDX > 1                                    35480000
354900                 PERFORM 5215-WRITE-SEL-QUEUE2                    35490000
355000                 ADD +1                TO RC800-NUMBER-OF-TS-ITEMS35500000
355100             END-IF                                               35510000
355200****    F15 - UPDATE                                              35520000
355300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              35530000
355400         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    35540000
355500             IF ASC-STOP-VERIFY                                   35550000
355600               MOVE PC-TSYMSG-03233  TO                           35560000
355700                               DP020-MSG-NUMBER                   35570000
355800               SET DP020-MSG-FATAL                                35580000
355900                   PS-ERROR      TO  TRUE                         35590000
355910             ELSE                                                 35591000
355920               SET ASC-DONT-CONFIRM-UPDATE TO TRUE                35592000
355930               PERFORM 5230-PROCESS-UPDATES                       35593000
355940                       VARYING PV-ITEM                            35594000
355950                       FROM 1 BY 1                                35595000
355960                   UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN35596000
355970                                                                  35597000
355980               MOVE PC-TSYMSG-00059                               35598000
355990                                   TO DP020-MSG-NUMBER            35599000
356000               SET DP020-MSG-INFORMATIONAL                        35600000
356100                                   TO TRUE                        35610000
356200***            PERFORM 9000-UPDATE-SELECTION-QUEUE                35620000
356300                                                                  35630000
356400               INITIALIZE ASC-BLOCK-ENTRIES (1)                   35640000
356500                          ASC-BLOCK-ENTRIES (2)                   35650000
356600               MOVE +1             TO ASC-BLK-SUB                 35660000
356700                                                                  35670000
356800               MOVE ZERO           TO ASC-ITEM-SUB                35680000
356900                                      ASC-NUMBER-OF-SELECTED-ITEMS35690000
357000                                      ASC-START-OF-SELECTED-RANGE 35700000
357100                                      ASC-END-OF-SELECTED-RANGE   35710000
357200                                      ASC-ITEM-AT-TOP-OF-PANEL    35720000
357300                                                                  35730000
357400               PERFORM 4410-READ-TEMP-STORAGE                     35740000
357500               PERFORM 3200-RESET-ATTRIBUTES                      35750000
357600               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               35760000
357700             END-IF                                               35770000
357800                                                                  35780000
357900                                                                  35790000
358000****    F18 - TO NOTIF/TRBL DC LIST                               35800000
358100         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              35810000
358200             INITIALIZE TM001-INTER-APPL-COMMAREA                 35820000
358300             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    35830000
358400                                 TO TM001-NUMBER-OF-SELECTED-ITEMS35840000
358500             SET ASC-UPDATE-TSQ        TO  TRUE                   35850000
358600             SET TM002-IDX             TO  1                      35860000
358700             MOVE ZERO                 TO TM001-NUMBER-OF-TS-ITEMS35870000
358800             INITIALIZE TM002-SELECTED-ITEM-ARRAY                 35880000
358900             MOVE ASC-SEL-QUEUE-NAME-OUT TO TM001-SEL-QUEUE-NAME  35890000
359000             PERFORM 5220-FILL-SEL-QUEUE-RECORD3                  35900000
359100                     VARYING PV-ITEM                              35910000
359200                     FROM 1 BY 1                                  35920000
359300                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 35930000
359400                                                                  35940000
359500             IF  TM002-IDX > 1                                    35950000
359600                 PERFORM 5225-WRITE-SEL-QUEUE3                    35960000
359700                 ADD +1                TO TM001-NUMBER-OF-TS-ITEMS35970000
359800             END-IF                                               35980000
359900****    F23 - TO STORE VERIFY ADJUST BY PACK                      35990000
360000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              36000000
360100             MOVE ASC-SEL-QUEUE-NAME-OUT TO RC036-SEL-QUEUE-NAME  36010000
360200             MOVE ASC-TRB-QUEUE-NAME-IN                           36020000
360300                                       TO RC036-TRB-QUEUE-NAME    36030000
360400             MOVE ASC-OPER-UNT-ID      TO RC036-OPER-UNT-ID       36040000
360500             MOVE ASC-FCLTY-ID         TO RC036-FCLTY-ID          36050000
360600             MOVE ASC-FCLTY-NME        TO RC036-FCLTY-NME         36060000
360700             MOVE ASC-PO-NBR           TO RC036-PO-NBR            36070000
360800             MOVE ASC-REC-SEQ-NBR      TO RC036-REC-SEQ-NBR       36080000
360900             SET ASC-UPDATE-TSQ        TO  TRUE                   36090000
361000                                                                  36100000
361100             SET RC037-IDX             TO  1                      36110000
361200             MOVE ZERO                 TO RC036-NUMBER-OF-TS-ITEMS36120000
361300             INITIALIZE RC037-SELECTED-ITEM-ARRAY                 36130000
361400                                                                  36140000
361500             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   36150000
361600                     VARYING PV-ITEM                              36160000
361700                     FROM 1 BY 1                                  36170000
361800                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 36180000
361900                                                                  36190000
362000             IF  RC037-IDX > 1                                    36200000
362100                 PERFORM 5205-WRITE-SEL-QUEUE                     36210000
362200                 ADD +1                TO RC036-NUMBER-OF-TS-ITEMS36220000
362300             END-IF                                               36230000
362400                                                                  36240000
362500     END-EVALUATE.                                                36250000
362600                                                                  36260000
362700 EJECT                                                            36270000
362800*----------------------------------------------------------------*36280000
362900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *36290000
363000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *36300000
363100*----------------------------------------------------------------*36310000
363200                                                                  36320000
363300 5100-WRITE-TEMP-STORAGE.                                         36330000
363400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     36340000
363500                                   TO PV-LIST-ITEM-NUMBER.        36350000
363600     COMPUTE PV-BLOCK-NUMBER =                                    36360000
363700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36370000
363800                                                                  36380000
363900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             36390000
364000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             36400000
364100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      36410000
364200             PERFORM 5105-REWRITE-ASC-LISTQ                       36420000
364300         END-IF                                                   36430000
364400     ELSE                                                         36440000
364500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       36450000
364600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            36460000
364700         PERFORM 5110-WRITE-ASC-LISTQ                             36470000
364800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   36480000
364900     END-IF.                                                      36490000
365000                                                                  36500000
365100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             36510000
365200******************************************************************36520000
365300** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **36530000
365400** SPECIFIC COMMAREA.                                           **36540000
365500******************************************************************36550000
365600 5105-REWRITE-ASC-LISTQ.                                          36560000
365700     EXEC CICS                                                    36570000
365800         WRITEQ TS                                                36580000
365900             QUEUE (ASC-LIST-QUEUE-NAME)                          36590000
366000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36600000
366100             ITEM  (PV-BLOCK-NUMBER)                              36610000
366200             REWRITE                                              36620000
366300             RESP  (PV-CICS-RESP)                                 36630000
366400     END-EXEC.                                                    36640000
366500                                                                  36650000
366600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           36660000
366700         CONTINUE                                                 36670000
366800     ELSE                                                         36680000
366900         SET DP013-CICS-ABEND            TO TRUE                  36690000
367000         SET DP013-NO-ROLLBACK           TO TRUE                  36700000
367100         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       36710000
367200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     36720000
367300                                         TO DP013-MESSAGE-TEXT(1) 36730000
367400         PERFORM DP013-0000-PROCESS-ABEND                         36740000
367500     END-IF.                                                      36750000
367600                                                                  36760000
367700******************************************************************36770000
367800** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **36780000
367900** SPECIFIC COMMAREA.                                           **36790000
368000******************************************************************36800000
368100 5110-WRITE-ASC-LISTQ.                                            36810000
368200     EXEC CICS                                                    36820000
368300         WRITEQ TS                                                36830000
368400             QUEUE (ASC-LIST-QUEUE-NAME)                          36840000
368500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36850000
368600             ITEM  (PV-BLOCK-NUMBER)                              36860000
368700             RESP  (PV-CICS-RESP)                                 36870000
368800     END-EXEC.                                                    36880000
368900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      36890000
369000         SET DP013-CICS-ABEND      TO TRUE                        36900000
369100         SET DP013-NO-ROLLBACK     TO TRUE                        36910000
369200         MOVE '5110-WRITE-ASC-LISTQ'                              36920000
369300                                   TO DP013-PARAGRAPH             36930000
369400         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           36940000
369500                                   TO DP013-MESSAGE-TEXT(1)       36950000
369600         PERFORM DP013-0000-PROCESS-ABEND                         36960000
369700     END-IF.                                                      36970000
369800 EJECT                                                            36980000
369900*----------------------------------------------------------------*36990000
370000* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *37000000
370100* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *37010000
370200*----------------------------------------------------------------*37020000
370300                                                                  37030000
370400 5200-FILL-SEL-QUEUE-RECORD.                                      37040000
370500                                                                  37050000
370600     PERFORM 6112-READ-LIST-QUEUE.                                37060000
370700                                                                  37070000
370800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37080000
370900         PERFORM                                                  37090000
371000         VARYING LQW-IDX                                          37100000
371100         FROM 1 BY 1                                              37110000
371200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37120000
371300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37130000
371400                                                                  37140000
371500             IF  LQW-SELECT (LQW-IDX)                             37150000
371600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              37160000
371700                                   TO RC037-ITEM (RC037-IDX)      37170000
371800                 MOVE ASC-OPER-UNT-ID                             37180000
371900                                 TO RC037-OPER-UNT-ID (RC037-IDX) 37190000
372000                 MOVE ASC-FCLTY-ID                                37200000
372100                                 TO RC037-FCLTY-ID (RC037-IDX)    37210000
372200                 MOVE ASC-PO-NBR                                  37220000
372300                                 TO RC037-PO-NBR (RC037-IDX)      37230000
372400                 MOVE ASC-REC-SEQ-NBR                             37240000
372500                                 TO RC037-REC-SEQ-NBR (RC037-IDX) 37250000
372600                 MOVE ASC-STR-NBR  TO RC037-STR-NBR (RC037-IDX)   37260000
372700                 MOVE LQW-LINE-PACK-ID (LQW-IDX)                  37270000
372800                                   TO RC037-PACK-ID (RC037-IDX)   37280000
372900                 MOVE SPACE        TO RC037-ACTION-SW (RC037-IDX) 37290000
373000                 SET RC037-IDX UP BY 1                            37300000
373100                 IF  RC037-IDX > RC037-MAX-ITEMS                  37310000
373200                     PERFORM 5205-WRITE-SEL-QUEUE                 37320000
373300                     ADD +1        TO RC036-NUMBER-OF-TS-ITEMS    37330000
373400                     INITIALIZE RC037-SELECTED-ITEM-ARRAY         37340000
373500                     SET RC037-IDX TO  1                          37350000
373600                 END-IF                                           37360000
373700             END-IF                                               37370000
373800         END-PERFORM                                              37380000
373900     END-IF.                                                      37390000
374000                                                                  37400000
374100*----------------------------------------------------------------*37410000
374200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37420000
374300*----------------------------------------------------------------*37430000
374400                                                                  37440000
374500 5205-WRITE-SEL-QUEUE.                                            37450000
374600                                                                  37460000
374700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37470000
374800                                   TO RC037-SELECTED-ITEMS.       37480000
374900                                                                  37490000
375000     EXEC CICS                                                    37500000
375100          WRITEQ TS                                               37510000
375200              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      37520000
375300              FROM  (RC037-DC-SELECT-RECORD)                      37530000
375400              ITEM  (PV-SEL-QUEUE-ITEM)                           37540000
375500              RESP  (PV-CICS-RESP)                                37550000
375600     END-EXEC.                                                    37560000
375700                                                                  37570000
375800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37580000
375900         CONTINUE                                                 37590000
376000     ELSE                                                         37600000
376100         SET DP013-CICS-ABEND      TO TRUE                        37610000
376200         SET DP013-NO-ROLLBACK     TO TRUE                        37620000
376300         MOVE '5205-WRITE-SEL-QUEUE'                              37630000
376400                                   TO DP013-PARAGRAPH             37640000
376500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          37650000
376600                                   TO DP013-MESSAGE-TEXT(1)       37660000
376700         PERFORM DP013-0000-PROCESS-ABEND                         37670000
376800     END-IF.                                                      37680000
376900                                                                  37690000
377000 5210-FILL-SEL-QUEUE-RECORD2.                                     37700000
377100                                                                  37710000
377200     PERFORM 6112-READ-LIST-QUEUE.                                37720000
377300                                                                  37730000
377400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       37740000
377500         PERFORM                                                  37750000
377600         VARYING LQW-IDX                                          37760000
377700         FROM 1 BY 1                                              37770000
377800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            37780000
377900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          37790000
378000                                                                  37800000
378100             IF  LQW-SELECT (LQW-IDX)                             37810000
378200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              37820000
378300                                   TO RC801-ITEM (RC801-IDX)      37830000
378400                 MOVE LQW-PACK-ID (LQW-IDX)                       37840000
378500                                   TO RC801-PACK-ID  (RC801-IDX)  37850000
378600                 MOVE SPACE        TO RC801-ACTION-SW (RC801-IDX) 37860000
378700                 SET RC801-IDX UP BY 1                            37870000
378800                 IF  RC801-IDX > RC801-MAX-ITEMS                  37880000
378900                     PERFORM 5215-WRITE-SEL-QUEUE2                37890000
379000                     ADD +1        TO RC036-NUMBER-OF-TS-ITEMS    37900000
379100                     INITIALIZE RC801-SELECTED-ITEM-ARRAY         37910000
379200                     SET RC801-IDX TO  1                          37920000
379300                 END-IF                                           37930000
379400             END-IF                                               37940000
379500         END-PERFORM                                              37950000
379600     END-IF.                                                      37960000
379700                                                                  37970000
379800*----------------------------------------------------------------*37980000
379900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37990000
380000*----------------------------------------------------------------*38000000
380100                                                                  38010000
380200 5215-WRITE-SEL-QUEUE2.                                           38020000
380300                                                                  38030000
380400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38040000
380500                                   TO RC801-SELECTED-ITEMS.       38050000
380600                                                                  38060000
380700     EXEC CICS                                                    38070000
380800          WRITEQ TS                                               38080000
380900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      38090000
381000              FROM  (RC801-PREPACK-SELECT-RECORD)                 38100000
381100              ITEM  (PV-SEL-QUEUE-ITEM)                           38110000
381200              RESP  (PV-CICS-RESP)                                38120000
381300     END-EXEC.                                                    38130000
381400                                                                  38140000
381500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38150000
381600         CONTINUE                                                 38160000
381700     ELSE                                                         38170000
381800         SET DP013-CICS-ABEND      TO TRUE                        38180000
381900         SET DP013-NO-ROLLBACK     TO TRUE                        38190000
382000         MOVE '5215-WRITE-SEL-QUEUE2'                             38200000
382100                                   TO DP013-PARAGRAPH             38210000
382200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          38220000
382300                                   TO DP013-MESSAGE-TEXT(1)       38230000
382400         PERFORM DP013-0000-PROCESS-ABEND                         38240000
382500     END-IF.                                                      38250000
382600                                                                  38260000
382700                                                                  38270000
382800 5220-FILL-SEL-QUEUE-RECORD3.                                     38280000
382900                                                                  38290000
383000     PERFORM 6112-READ-LIST-QUEUE.                                38300000
383100                                                                  38310000
383200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38320000
383300         PERFORM                                                  38330000
383400         VARYING LQW-IDX                                          38340000
383500         FROM 1 BY 1                                              38350000
383600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38360000
383700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38370000
383800                                                                  38380000
383900             IF  LQW-SELECT (LQW-IDX)                             38390000
384000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              38400000
384100                                   TO TM002-ITEM (TM002-IDX)      38410000
384200                 MOVE ASC-OPER-UNT-ID                             38420000
384300                                 TO TM002-OPER-UNT-ID (TM002-IDX) 38430000
384400                 MOVE ASC-FCLTY-ID                                38440000
384500                                 TO TM002-FCLTY-ID (TM002-IDX)    38450000
384600                 MOVE ASC-PO-NBR                                  38460000
384700                                 TO TM002-PO-NBR (TM002-IDX)      38470000
384800                 MOVE ASC-REC-SEQ-NBR                             38480000
384900                                 TO TM002-RCVR-SEQ (TM002-IDX)    38490000
385000                 MOVE SPACE        TO TM002-ACTION-SW (TM002-IDX) 38500000
385100                 SET TM002-IDX UP BY 1                            38510000
385200                 IF  TM002-IDX > TM002-MAX-ITEMS                  38520000
385300                     PERFORM 5225-WRITE-SEL-QUEUE3                38530000
385400                     ADD +1        TO TM001-NUMBER-OF-TS-ITEMS    38540000
385500                     INITIALIZE TM002-SELECTED-ITEM-ARRAY         38550000
385600                     SET TM002-IDX TO  1                          38560000
385700                 END-IF                                           38570000
385800             END-IF                                               38580000
385900         END-PERFORM                                              38590000
386000     END-IF.                                                      38600000
386100                                                                  38610000
386200*----------------------------------------------------------------*38620000
386300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *38630000
386400*----------------------------------------------------------------*38640000
386500                                                                  38650000
386600 5225-WRITE-SEL-QUEUE3.                                           38660000
386700                                                                  38670000
386800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38680000
386900                                   TO TM002-SELECTED-ITEMS.       38690000
387000                                                                  38700000
387100     EXEC CICS                                                    38710000
387200          WRITEQ TS                                               38720000
387300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      38730000
387400              FROM  (TM002-MESSAGE-SEL-REC)                       38740000
387500              ITEM  (PV-SEL-QUEUE-ITEM)                           38750000
387600              RESP  (PV-CICS-RESP)                                38760000
387700     END-EXEC.                                                    38770000
387800                                                                  38780000
387900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38790000
388000         CONTINUE                                                 38800000
388100     ELSE                                                         38810000
388200         SET DP013-CICS-ABEND      TO TRUE                        38820000
388300         SET DP013-NO-ROLLBACK     TO TRUE                        38830000
388400         MOVE '5215-WRITE-SEL-QUEUE2'                             38840000
388500                                   TO DP013-PARAGRAPH             38850000
388600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          38860000
388700                                   TO DP013-MESSAGE-TEXT(1)       38870000
388800         PERFORM DP013-0000-PROCESS-ABEND                         38880000
388900     END-IF.                                                      38890000
389000                                                                  38900000
389100 5230-PROCESS-UPDATES.                                            38910000
389200                                                                  38920000
389300     PERFORM 6112-READ-LIST-QUEUE.                                38930000
389400                                                                  38940000
389500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38950000
389600         PERFORM                                                  38960000
389700         VARYING LQW-IDX                                          38970000
389800         FROM 1 BY 1                                              38980000
389900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38990000
390000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          39000000
390100                                                                  39010000
390200             IF  LQW-SELECT (LQW-IDX)                             39020000
390300                 IF  LQW-UPDATE-PACKS-N (LQW-IDX) > 0             39030000
390400                 OR  LQW-SEL-ZERO-SW (LQW-IDX)                    39040000
390500                     MOVE LQW-UPDATE-PACKS-N (LQW-IDX) TO         39050000
390600                                         PV-UPDATE-PACK-AMT       39060000
390700                                         PV-UPDATE-PACK           39070000
390800                     MOVE LQW-ACTUAL-PACKS (LQW-IDX) TO           39080000
390900                                         PV-ORIG-PACK-ACT         39090000
391000                     MOVE LQW-VRFYD-PACKS (LQW-IDX) TO            39100000
391100                                         PV-ORIG-PACK-VRF         39110000
391200                     MOVE LQW-LINE-PACK-ID (LQW-IDX)  TO          39120000
391300                                         DK-UPDATE-PACK-ID        39130000
391400                     PERFORM 5240-UPDATE-PACK                     39140000
391500                     SET PS-UPDATE-QUEUE  TO TRUE                 39150000
391600                     SET LQW-DESELECT (LQW-IDX) TO   TRUE         39160000
391700                     MOVE PC-UPD      TO LQW-ACTION (LQW-IDX)     39170000
391800                     MOVE LQW-SELECTED-SW (LQW-IDX)               39180000
391900                               TO LQW-TEMP-SELECTED-SW (LQW-IDX)  39190000
392000                     MOVE SPACES    TO LQW-UPDATE-PACKS (LQW-IDX) 39200000
392100                 END-IF                                           39210000
392200             END-IF                                               39220000
392300         END-PERFORM                                              39230000
392400     END-IF.                                                      39240000
392500                                                                  39250000
392600     IF PS-UPDATE-QUEUE                                           39260000
392700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39270000
392800         PERFORM 6111-WRITE-LIST-QUEUE                            39280000
392900     END-IF.                                                      39290000
393000                                                                  39300000
393100 5240-UPDATE-PACK.                                                39310000
393200                                                                  39320000
393300     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 39330000
393310     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    39331000
393320     MOVE ASC-PO-NBR           TO DK-PO-NBR.                      39332000
393330     MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.                 39333000
393340     MOVE ASC-STR-NBR          TO DK-STR-NBR.                     39334000
393350     PERFORM 5250-OPEN-CURSOR.                                    39335000
393360     PERFORM 5260-FETCH-CURSOR UNTIL PS-EOC-PAC-CSR.              39336000
393370     PERFORM 5270-CLOSE-CURSOR.                                   39337000
393380                                                                  39338000
393390 5250-OPEN-CURSOR.                                                39339000
393400                                                                  39340000
393500     EXEC SQL                                                     39350000
393600          OPEN PACK-CURSOR                                        39360000
393700     END-EXEC.                                                    39370000
393800                                                                  39380000
393900     EVALUATE TRUE                                                39390000
394000         WHEN SQLCODE = ZERO                                      39400000
394100             SET PS-NOT-EOC-PAC-CSR TO TRUE                       39410000
394200         WHEN SQLWARN0 NOT = SPACES                               39420000
394300         WHEN SQLCODE < ZERO                                      39430000
394400         WHEN SQLCODE > ZERO                                      39440000
394500             MOVE '5250-OPEN-CURSOR'                              39450000
394600                               TO DP013-PARAGRAPH                 39460000
394700             MOVE 'OPEN PACK CURSOR - '                           39470000
394800                               TO DP013-MESSAGE-TEXT (1)          39480000
394900             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              39490000
395000             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         39500000
395100             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            39510000
395200             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         39520000
395300             MOVE DK-UPDATE-PACK-ID TO PV-DISP-PREPK-ID           39530000
395400             STRING ' PO = '                                      39540000
395500                    PV-DISP-PO-NBR                                39550000
395600                    ' RECV ='                                     39560000
395700                    PV-DISP-REC-SEQ-NBR                           39570000
395800                    ' OPER = '                                    39580000
395900                    PV-DISP-OPER-UNT-ID                           39590000
396000                    ' FCLTY = '                                   39600000
396100                    PV-DISP-FCLTY-ID                              39610000
396200                    ' PACK ='                                     39620000
396300                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         39630000
396400                             INTO DP013-MESSAGE-TEXT (2)          39640000
396500             MOVE SQLCA        TO DP013-SQLCA                     39650000
396600             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        39660000
396700             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        39670000
396800             SET DP013-DB2-ABEND                                  39680000
396900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39690000
397000             PERFORM DP013-0000-PROCESS-ABEND                     39700000
397100     END-EVALUATE.                                                39710000
397200                                                                  39720000
397300 5260-FETCH-CURSOR.                                               39730000
397400                                                                  39740000
397500     EXEC SQL                                                     39750000
397600          FETCH PACK-CURSOR                                       39760000
397700          INTO  :PV-REC-TYPE                                      39770000
397800              , :RECDIS-ORD-LNE-NBR                               39780000
397900              , :RECDIS-VERIFY-ITM-QTY                            39790000
398000              , :RECDIS-AP-VERIFY-ITM-QTY                         39800000
398100              , :RECITM-PREPK-RATO-QTY                            39810000
398200              , :RECITM-STATUS-CDE                                39820000
398300              , :RECITM-PREPK-DRV-LNE-CDE                         39830000
398400     END-EXEC.                                                    39840000
398500                                                                  39850000
398600     EVALUATE TRUE                                                39860000
398700         WHEN SQLCODE = ZERO                                      39870000
398800             PERFORM 5280-UPDATE-RECDIS                           39880000
398900             IF  RECITM-PREPK-DRV-LNE-CDE = 'A'                   39890000
399000             AND RECITM-STATUS-CDE = 'VE'                         39900000
399100                 MOVE RECDIS-ORD-LNE-NBR TO DK-DRIVER-LNE-NBR     39910000
399200                 MOVE  ASC-PO-NBR        TO PC241-PO-NBR          39920000
399300                 MOVE  DK-DRIVER-LNE-NBR TO PC241-PO-LNE-NBR      39930000
399400                 MOVE  ASC-REC-SEQ-NBR   TO PC241-REC-SEQ-NBR     39940000
399500                 MOVE  ASC-OPER-UNT-ID   TO PC241-OPER-UNT-ID     39950000
399600                 MOVE  ASC-FCLTY-ID      TO PC241-FCLTY-ID        39960000
399700                 MOVE  ASC-STR-NBR       TO PC241-STR-NBR         39970000
399800                 MOVE  PV-UPDATE-PACK-DIF TO PC241-STR-ADJ-QTY    39980000
399900                 ADD   1                  TO PV-VRFY-ITEM         39990000
400000                 PERFORM 6150-WRITE-VRFY-ADJ-QUEUE                40000000
400100             END-IF                                               40010000
400200             IF  PS-TRECDIS-UPDATE-DONE                           40020000
400300             AND RECITM-STATUS-CDE = 'VE'                         40030000
400400                 PERFORM 8500-PROCESS-UNITS-WORK                  40040000
400500             END-IF                                               40050000
400600             MOVE RECDIS-ORD-LNE-NBR       TO DK-LNE-NBR          40060000
400700             PERFORM 7020-SELECT-PURITM-DATA                      40070000
400800             IF PV-PURITM-UNT-QTY GREATER THAN ZERO               40080000
400900                 IF RECITM-STATUS-CDE = 'VE'                      40090000
400910                     PERFORM 5800-CHECK-PO-STATUS                 40091000
400920                 END-IF                                           40092000
400930             END-IF                                               40093000
400940         WHEN SQLCODE = +100                                      40094000
400950             SET PS-EOC-PAC-CSR TO TRUE                           40095000
400960         WHEN SQLWARN0 NOT = SPACES                               40096000
400970         WHEN SQLCODE < ZERO                                      40097000
400980         WHEN SQLCODE > ZERO                                      40098000
400990             MOVE '5260-FETCH-CURSOR'                             40099000
401000                               TO DP013-PARAGRAPH                 40100000
401100             MOVE 'FETCH PACK CURSOR - '                          40110000
401200                               TO DP013-MESSAGE-TEXT (1)          40120000
401300             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              40130000
401400             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         40140000
401500             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            40150000
401600             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         40160000
401700             MOVE DK-UPDATE-PACK-ID TO PV-DISP-PREPK-ID           40170000
401800             STRING ' PO = '                                      40180000
401900                    PV-DISP-PO-NBR                                40190000
402000                    ' RECV ='                                     40200000
402100                    PV-DISP-REC-SEQ-NBR                           40210000
402200                    ' OPER = '                                    40220000
402300                    PV-DISP-OPER-UNT-ID                           40230000
402400                    ' FCLTY = '                                   40240000
402500                    PV-DISP-FCLTY-ID                              40250000
402600                    ' PACK ='                                     40260000
402700                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         40270000
402800                             INTO DP013-MESSAGE-TEXT (2)          40280000
402900             MOVE SQLCA        TO DP013-SQLCA                     40290000
403000             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        40300000
403100             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        40310000
403200             SET DP013-DB2-ABEND                                  40320000
403300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40330000
403400             PERFORM DP013-0000-PROCESS-ABEND                     40340000
403500     END-EVALUATE.                                                40350000
403600                                                                  40360000
403700 5270-CLOSE-CURSOR.                                               40370000
403800                                                                  40380000
403900     EXEC SQL                                                     40390000
404000          CLOSE PACK-CURSOR                                       40400000
404100     END-EXEC.                                                    40410000
404200                                                                  40420000
404300     EVALUATE TRUE                                                40430000
404400         WHEN SQLCODE = ZERO                                      40440000
404500             CONTINUE                                             40450000
404600         WHEN SQLWARN0 NOT = SPACES                               40460000
404700         WHEN SQLCODE < ZERO                                      40470000
404800         WHEN SQLCODE > ZERO                                      40480000
404900             MOVE '5270-CLOSE-CURSOR'                             40490000
405000                               TO DP013-PARAGRAPH                 40500000
405100             MOVE 'CLOSE PACK CURSOR - '                          40510000
405200                               TO DP013-MESSAGE-TEXT (1)          40520000
405300             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              40530000
405400             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         40540000
405500             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            40550000
405600             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         40560000
405700             MOVE DK-UPDATE-PACK-ID TO PV-DISP-PREPK-ID           40570000
405800             STRING ' PO = '                                      40580000
405900                    PV-DISP-PO-NBR                                40590000
406000                    ' RECV ='                                     40600000
406100                    PV-DISP-REC-SEQ-NBR                           40610000
406200                    ' OPER = '                                    40620000
406300                    PV-DISP-OPER-UNT-ID                           40630000
406400                    ' FCLTY = '                                   40640000
406500                    PV-DISP-FCLTY-ID                              40650000
406600                    ' PACK ='                                     40660000
406700                    PV-DISP-PREPK-ID    DELIMITED BY SIZE         40670000
406800                             INTO DP013-MESSAGE-TEXT (2)          40680000
406900             MOVE SQLCA        TO DP013-SQLCA                     40690000
407000             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)        40700000
407100             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        40710000
407200             SET DP013-DB2-ABEND                                  40720000
407300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40730000
407400             PERFORM DP013-0000-PROCESS-ABEND                     40740000
407500     END-EVALUATE.                                                40750000
407600                                                                  40760000
407700 5280-UPDATE-RECDIS.                                              40770000
407800                                                                  40780000
407900     MOVE RECDIS-ORD-LNE-NBR       TO DK-PO-DRIVER-LNE.           40790000
408000     IF ASC-POST-VERIFIED-RECEIPT                                 40800000
408100         PERFORM 5350-PROCESS-TROUBLE                             40810000
408200     END-IF.                                                      40820000
408300     PERFORM 4380-SELECT-ODD-UNITS-DRIVER.                        40830000
408400     IF  RECITM-STATUS-CDE = 'VE'                                 40840000
408500         COMPUTE PV-LINE-QTY =                                    40850000
408600            (RECITM-PREPK-RATO-QTY * PV-UPDATE-PACK-AMT)          40860000
408700                             + PV-ODD-AP-VERIFY-ODU-PK-QTY        40870000
408800     ELSE                                                         40880000
408900         COMPUTE PV-LINE-QTY =                                    40890000
409000            (RECITM-PREPK-RATO-QTY * PV-UPDATE-PACK-AMT)          40900000
409100                             + PV-ODD-DC-VERIFY-ODU-PK-QTY        40910000
409200     END-IF.                                                      40920000
409300*    IF RECITM-PREPK-DRV-LNE-CDE = 'A'                            40930000
409400     COMPUTE PV-SAVE-ITM-QTY =                                    40940000
409500             PV-LINE-QTY - RECDIS-VERIFY-ITM-QTY.                 40950000
409600     COMPUTE PV-SUM-ITM-QTY =                                     40960000
409700             PV-SAVE-ITM-QTY + PV-SUM-ITM-QTY.                    40970000
409710     IF RECITM-PREPK-RATO-QTY > 0                                 40971000
409720         IF  RECITM-STATUS-CDE = 'VE'                             40972000
409730             COMPUTE PV-UPDATE-PACK-DIF =                         40973000
409740                     PV-UPDATE-PACK - PV-ORIG-PACK-VRF            40974000
409750         ELSE                                                     40975000
409760             COMPUTE PV-UPDATE-PACK-DIF =                         40976000
409770                     PV-UPDATE-PACK - PV-ORIG-PACK-ACT            40977000
409780         END-IF                                                   40978000
409790     ELSE                                                         40979000
409800         MOVE 0          TO PV-UPDATE-PACK-DIF                    40980000
409900     END-IF.                                                      40990000
410000                                                                  41000000
410100     IF  RECITM-PREPK-DRV-LNE-CDE = 'A'                           41010000
410200         COMPUTE ASC-TOT-ACTUAL-PACKS =                           41020000
410300                 ASC-TOT-ACTUAL-PACKS + PV-UPDATE-PACK-DIF        41030000
410400         COMPUTE LQW-ACTUAL-PACKS (LQW-IDX) =                     41040000
410500                 LQW-ACTUAL-PACKS (LQW-IDX) +                     41050000
410600                 PV-UPDATE-PACK-DIF                               41060000
410700         MOVE LQW-ACTUAL-PACKS (LQW-IDX) TO                       41070000
410800              ASC-ACTUAL-PACKS                                    41080000
410900              (ASC-BLK-SUB ASC-ITEM-SUB)                          41090000
411000     END-IF.                                                      41100000
411100                                                                  41110000
411200     COMPUTE ASC-HDR-TOT-ACT-UNTS =                               41120000
411300             ASC-HDR-TOT-ACT-UNTS + PV-SAVE-ITM-QTY.              41130000
411400     IF  RECITM-STATUS-CDE = 'VE'                                 41140000
411500     AND RECITM-PREPK-DRV-LNE-CDE = 'A'                           41150000
411600         COMPUTE ASC-TOT-VERFYD-PACKS =                           41160000
411700                 ASC-TOT-VERFYD-PACKS + PV-UPDATE-PACK-DIF        41170000
411800         COMPUTE LQW-VRFYD-PACKS (LQW-IDX) =                      41180000
411900                 LQW-VRFYD-PACKS (LQW-IDX) +                      41190000
412000                 PV-UPDATE-PACK-DIF                               41200000
412100         MOVE LQW-VRFYD-PACKS (LQW-IDX) TO                        41210000
412200              ASC-VRFYD-PACKS                                     41220000
412300              (ASC-BLK-SUB ASC-ITEM-SUB)                          41230000
412400         COMPUTE ASC-HDR-TOT-VERFYD-UNTS =                        41240000
412500                 ASC-HDR-TOT-VERFYD-UNTS + PV-SAVE-ITM-QTY        41250000
412600     ELSE                                                         41260000
412700         COMPUTE ASC-HDR-TOT-VERFYD-UNTS =                        41270000
412800                 ASC-HDR-TOT-VERFYD-UNTS + PV-SAVE-ITM-QTY        41280000
412900     END-IF.                                                      41290000
413000                                                                  41300000
413100     IF ASC-POST-VERIFIED-RECEIPT                                 41310000
413200         CONTINUE                                                 41320000
413300     ELSE                                                         41330000
413400         MOVE PV-LINE-QTY          TO  RECDIS-VERIFY-ITM-QTY      41340000
413500     END-IF.                                                      41350000
413600     COMPUTE ASC-HDR-TOT-ACT-UNTS =                               41360000
413700             ASC-HDR-TOT-ACT-UNTS + PV-LINE-QTY                   41370000
413800                                                                  41380000
413900     IF RECITM-STATUS-CDE = 'VE'                                  41390000
414000         MOVE PV-LINE-QTY      TO  RECDIS-AP-VERIFY-ITM-QTY       41400000
414100     END-IF.                                                      41410000
414200                                                                  41420000
414300     IF PV-REC-TYPE = 'B'                                         41430000
414400         PERFORM 5285-INSERT-TRECDIS                              41440000
414500     END-IF.                                                      41450000
414600                                                                  41460000
414700     PERFORM 5290-UPD-RECDIS-AUDIT-BEFORE.                        41470000
414800                                                                  41480000
414900     EXEC SQL                                                     41490000
415000          UPDATE TRECDIS                                          41500000
415100          SET    VERIFY_ITM_QTY      =  :RECDIS-VERIFY-ITM-QTY    41510000
415200             ,   AP_VERIFY_ITM_QTY   =  :RECDIS-AP-VERIFY-ITM-QTY 41520000
415300          WHERE                                                   41530000
415400                 ORD_NBR          =  :DK-PO-NBR                   41540000
415500          AND    ORD_LNE_NBR      =  :RECDIS-ORD-LNE-NBR          41550000
415600          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              41560000
415700          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              41570000
415800          AND    FCLTY_ID         =  :DK-FCLTY-ID                 41580000
415900          AND    STR_NBR          =  :DK-STR-NBR                  41590000
416000     END-EXEC.                                                    41600000
416100                                                                  41610000
416200     EVALUATE TRUE                                                41620000
416300         WHEN SQLCODE = ZERO                                      41630000
416400             SET PS-TRECDIS-UPDATE-DONE TO TRUE                   41640000
416500         WHEN SQLCODE = +100                                      41650000
416600              CONTINUE                                            41660000
416700         WHEN SQLCODE = -904                                      41670000
416800         WHEN SQLCODE = -911                                      41680000
416900         WHEN SQLCODE = -913                                      41690000
417000              SET PS-UPDATES-DONE TO TRUE                         41700000
417100              PERFORM 9900-SOFT-ABORT                             41710000
417200         WHEN SQLWARN0 NOT = SPACE                                41720000
417300         WHEN SQLCODE NOT = ZERO                                  41730000
417400              MOVE '5280-UPDATE-RECDIS'                           41740000
417500                               TO DP013-PARAGRAPH                 41750000
417600              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            41760000
417700                               TO DP013-MESSAGE-TEXT (1)          41770000
417800              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             41780000
417900              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        41790000
418000              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           41800000
418100              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        41810000
418200              MOVE RECDIS-ORD-LNE-NBR                             41820000
418300                                    TO PV-DISP-LNE-NBR            41830000
418400              STRING ' PO = '                                     41840000
418500                     PV-DISP-PO-NBR                               41850000
418600                     ' RECV ='                                    41860000
418700                     PV-DISP-REC-SEQ-NBR                          41870000
418800                     ' OPER = '                                   41880000
418900                     PV-DISP-OPER-UNT-ID                          41890000
419000                     ' FCLTY = '                                  41900000
419100                     PV-DISP-FCLTY-ID                             41910000
419200                     ' LINE = '                                   41920000
419300                     PV-DISP-LNE-NBR                              41930000
419400                                         DELIMITED BY SIZE        41940000
419500                              INTO DP013-MESSAGE-TEXT (2)         41950000
419600              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        41960000
419700              MOVE SQLCA       TO DP013-SQLCA                     41970000
419800              SET DP013-DB2-ABEND                                 41980000
419900                               TO TRUE                            41990000
420000              PERFORM DP013-0000-PROCESS-ABEND                    42000000
420100     END-EVALUATE.                                                42010000
420200                                                                  42020000
420300     IF ASC-POST-VERIFIED-RECEIPT AND                             42030000
420400        PS-TRECDIS-UPDATE-DONE                                    42040000
420500         PERFORM 5515-ADD-TO-RECD-AUDIT-AFTER                     42050000
420600     END-IF.                                                      42060000
420700                                                                  42070000
420800 5285-INSERT-TRECDIS.                                             42080000
420900     EXEC SQL INSERT                                              42090000
420910          INTO TRECDIS                                            42091000
420920                (ORD_NBR                                          42092000
420930            ,    ORD_LNE_NBR                                      42093000
420940            ,    REC_SEQ_NBR                                      42094000
420950            ,    OPER_UNT_ID                                      42095000
420960            ,    FCLTY_ID                                         42096000
420970            ,    CRE_TMST                                         42097000
420980            ,    CRE_UID                                          42098000
420990            ,    VER_STATUS_CDE                                   42099000
420991            ,    EXPTED_ITM_QTY                                   42099100
420992            ,    VERIFY_ITM_QTY                                   42099200
420993            ,    AP_VERIFY_ITM_QTY                                42099300
420994            ,    PLAN_ITM_QTY                                     42099400
420995            ,    AP_PRC_DTE                                       42099500
420996            ,    STR_NBR                                          42099600
420997            ,    STR_FCLTY_ID)                                    42099700
420998          VALUES                                                  42099800
420999                (:DK-PO-NBR                                       42099900
421000            ,    :RECDIS-ORD-LNE-NBR                              42100000
421001            ,    :DK-REC-SEQ-NBR                                  42100100
421002            ,    :DK-OPER-UNT-ID                                  42100200
421003            ,    :DK-FCLTY-ID                                     42100300
421004            ,    CURRENT TIMESTAMP                                42100400
421005            ,    'RCKCS820'                                       42100500
421006            ,    'A'                                              42100600
421007            ,    0                                                42100700
421008            ,    0                                                42100800
421009            ,    0                                                42100900
421010            ,    0                                                42101000
421011            ,    '9999-09-09'                                     42101100
421012            ,    :DK-STR-NBR                                      42101200
421013            ,    1  )                                             42101300
421014     END-EXEC.                                                    42101400
421015                                                                  42101500
421016     EVALUATE TRUE                                                42101600
421017         WHEN SQLCODE = ZERO                                      42101700
421018             CONTINUE                                             42101800
421019         WHEN SQLCODE = +100                                      42101900
421020              CONTINUE                                            42102000
421021         WHEN SQLCODE = -904                                      42102100
421022         WHEN SQLCODE = -911                                      42102200
421023         WHEN SQLCODE = -913                                      42102300
421024              SET PS-UPDATES-DONE TO TRUE                         42102400
421025              PERFORM 9900-SOFT-ABORT                             42102500
421026         WHEN SQLWARN0 NOT = SPACE                                42102600
421027         WHEN SQLCODE NOT = ZERO                                  42102700
421028              MOVE '5285-INSERT-TRECDIS'                          42102800
421029                               TO DP013-PARAGRAPH                 42102900
421030              MOVE 'INSERT RECEIPT DISTRIBUTION TABLE'            42103000
421031                               TO DP013-MESSAGE-TEXT (1)          42103100
421032              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             42103200
421033              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        42103300
421034              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           42103400
421035              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        42103500
421036              MOVE RECDIS-ORD-LNE-NBR                             42103600
421037                                    TO PV-DISP-LNE-NBR            42103700
421038              STRING ' PO = '                                     42103800
421039                     PV-DISP-PO-NBR                               42103900
421040                     ' RECV ='                                    42104000
421041                     PV-DISP-REC-SEQ-NBR                          42104100
421042                     ' OPER = '                                   42104200
421043                     PV-DISP-OPER-UNT-ID                          42104300
421044                     ' FCLTY = '                                  42104400
421045                     PV-DISP-FCLTY-ID                             42104500
421046                     ' LINE = '                                   42104600
421047                     PV-DISP-LNE-NBR                              42104700
421048                                         DELIMITED BY SIZE        42104800
421049                              INTO DP013-MESSAGE-TEXT (2)         42104900
421050              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        42105000
421051              MOVE SQLCA       TO DP013-SQLCA                     42105100
421052              SET DP013-DB2-ABEND                                 42105200
421053                               TO TRUE                            42105300
421054              PERFORM DP013-0000-PROCESS-ABEND                    42105400
421055     END-EVALUATE.                                                42105500
421056                                                                  42105600
421057 5290-UPD-RECDIS-AUDIT-BEFORE.                                    42105700
421058                                                                  42105800
421059     EXEC SQL                                                     42105900
421060          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           42106000
421070     END-EXEC.                                                    42107000
421080     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       42108000
421090     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          42109000
421100     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         42110000
421200     MOVE DK-PO-NBR                TO RC031-PO-NBR.               42120000
421300     MOVE RECDIS-ORD-LNE-NBR                                      42130000
421400                                   TO RC031-PO-LNE-NBR.           42140000
421500     MOVE DK-REC-SEQ-NBR                                          42150000
421600                                   TO RC031-REC-SEQ-NBR.          42160000
421700     MOVE DK-OPER-UNT-ID           TO RC031-OPER-UNT-ID.          42170000
421800     MOVE DK-FCLTY-ID              TO RC031-FCLTY-ID.             42180000
421900     MOVE DK-STR-NBR               TO RC031-STR-NBR.              42190000
422000     MOVE DP020-USERID             TO RC031-UPD-UID.              42200000
422100     IF ASC-POST-VERIFIED-RECEIPT                                 42210000
422200         MOVE PC-POST-VERIFY-PGM-NAME  TO RC031-UPD-PGM-ID        42220000
422300     ELSE                                                         42230000
422400         MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID        42240000
422500     END-IF.                                                      42250000
422600     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             42260000
422700     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            42270000
422800     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          42280000
422900     EXEC CICS                                                    42290000
423000         LINK PROGRAM  (PC-AUDIT-RTN)                             42300000
423100              COMMAREA (RC031-FIELDS)                             42310000
423200              LENGTH   (PC-AUDIT-RTN-LENGTH)                      42320000
423300     END-EXEC.                                                    42330000
423400     EVALUATE TRUE                                                42340000
423500         WHEN RC031-CALL-SUCCESSFUL                               42350000
423600             CONTINUE                                             42360000
423700                                                                  42370000
423800         WHEN OTHER                                               42380000
423900              MOVE '5290-UPD-RECDIS-AUDIT-BEFORE'                 42390000
424000                                    TO DP013-PARAGRAPH            42400000
424100              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               42410000
424200                                TO DP013-MESSAGE-TEXT (1)         42420000
424300              MOVE RC031-RETURN-DESC                              42430000
424400                                TO DP013-MESSAGE-TEXT (2)         42440000
424500              MOVE RC031-SQLCA      TO DP013-SQLCA                42450000
424600              SET DP013-DB2-ABEND                                 42460000
424700                  DP013-XCTL-DISPLAY-RESTART                      42470000
424800                                    TO TRUE                       42480000
424900              PERFORM DP013-0000-PROCESS-ABEND                    42490000
425000     END-EVALUATE.                                                42500000
425100                                                                  42510000
425200 5300-GET-TRECEIV-STATUS.                                         42520000
425300                                                                  42530000
425400     EXEC SQL                                                     42540000
425500          SELECT                                                  42550000
425600             ML_POST_TMST                                         42560000
425700           , FS_POST_TMST                                         42570000
425800           , STATUS_CDE                                           42580000
425900           , VERFYD_TMST                                          42590000
426000           , VRFD_USR_ID                                          42600000
426100        INTO                                                      42610000
426200             :RECEIV-ML-POST-TMST                                 42620000
426300           , :RECEIV-FS-POST-TMST                                 42630000
426400           , :RECEIV-STATUS-CDE                                   42640000
426500           , :RECEIV-VERFYD-TMST                                  42650000
426600           , :RECEIV-VRFD-USR-ID                                  42660000
426700          FROM  TRECEIV                                           42670000
426800          WHERE                                                   42680000
426900                 ORD_NBR          =  :DK-PO-NBR                   42690000
427000          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              42700000
427100          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              42710000
427200          AND    FCLTY_ID         =  :DK-FCLTY-ID                 42720000
427300          AND    VER_STATUS_CDE   =  'A'                          42730000
427400     END-EXEC.                                                    42740000
427500                                                                  42750000
427600     EVALUATE TRUE                                                42760000
427700         WHEN SQLCODE = ZERO                                      42770000
427800           IF RECEIV-STATUS-CDE = 'VE'                            42780000
427900              MOVE  RECEIV-VERFYD-TMST TO PV-WORK-TIMESTAMP       42790000
428000              MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR         42800000
428100              MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH        42810000
428200              MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY          42820000
428300              MOVE  '/'                TO PV-SLASH-1              42830000
428400              MOVE  '/'                TO PV-SLASH-2              42840000
428500              MOVE  PV-WORK-HH         TO PV-DISPLAY-HH           42850000
428600              MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM           42860000
428700              MOVE  ':'                TO PV-COLON-1              42870000
428800              MOVE  '('                TO PV-LEFT-PAREN           42880000
428900              MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE            42890000
429000              MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME            42900000
429100              MOVE  ' - '              TO PV-SEPARATOR            42910000
429200              MOVE  RECEIV-VRFD-USR-ID TO PV-VRFY-USERID          42920000
429300              MOVE  ')'                TO PV-RIGHT-PAREN          42930000
429400              MOVE  PV-RECEIV-VRFY-INFO                           42940000
429500                                       TO ASC-RECEIV-VRFY-INFO    42950000
429600           ELSE                                                   42960000
429700                 MOVE SPACES       TO ASC-RECEIV-VRFY-INFO        42970000
429800           END-IF                                                 42980000
429900         WHEN SQLCODE = -904                                      42990000
430000         WHEN SQLCODE = -911                                      43000000
430100         WHEN SQLCODE = -913                                      43010000
430200              PERFORM 9900-SOFT-ABORT                             43020000
430300         WHEN SQLWARN0 NOT = SPACE                                43030000
430400         WHEN SQLCODE NOT = ZERO                                  43040000
430500              MOVE '5300-GET-TRECEIV-STATUS'                      43050000
430600                               TO DP013-PARAGRAPH                 43060000
430700              MOVE 'SELECT TRECEIV'                               43070000
430800                               TO DP013-MESSAGE-TEXT (1)          43080000
430900              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             43090000
431000              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        43100000
431100              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        43110000
431200              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           43120000
431300              STRING ' PO = '                                     43130000
431400                     PV-DISP-PO-NBR                               43140000
431500                     ' RECV ='                                    43150000
431600                     PV-DISP-REC-SEQ-NBR                          43160000
431700                     ' OPER = '                                   43170000
431800                     PV-DISP-OPER-UNT-ID                          43180000
431900                     ' FCLTY = '                                  43190000
432000                     PV-DISP-FCLTY-ID                             43200000
432100                                         DELIMITED BY SIZE        43210000
432200                              INTO DP013-MESSAGE-TEXT (2)         43220000
432300              MOVE SQLCA        TO DP013-SQLCA                    43230000
432400              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)       43240000
432500              MOVE SQLCA       TO DP013-SQLCA                     43250000
432600              SET DP013-DB2-ABEND                                 43260000
432700                               TO TRUE                            43270000
432800              PERFORM DP013-0000-PROCESS-ABEND                    43280000
432900     END-EVALUATE.                                                43290000
433000                                                                  43300000
433100 5350-PROCESS-TROUBLE.                                            43310000
433200     PERFORM 5360-LOOK-FOR-TROUBLE.                               43320000
433300     IF ASC-NO-TRBL-EXISTS                                        43330000
433400          PERFORM 5380-CREATE-TROUBLE-ROW                         43340000
433500          PERFORM 5390-UPDATE-TRB-QUEUE                           43350000
433600     END-IF.                                                      43360000
433700     PERFORM 9600-WRITE-TRB-QUEUE.                                43370000
433800     SET ASC-NO-TSQ-UPDATE                                        43380000
433801         TO TRUE.                                                 43380100
433802                                                                  43380200
433803                                                                  43380300
433804 5360-LOOK-FOR-TROUBLE.                                           43380400
433805      PERFORM 9500-READ-TRB-QUEUE.                                43380500
433806      IF TM003-CYC-ADJ-NBR = 0                                    43380600
433807           SET ASC-NO-TRBL-EXISTS TO TRUE                         43380700
433808      ELSE                                                        43380800
433809          SET LINE-INDEX TO 1                                     43380900
433810          SET PS-NOT-EOT-TRB-TABLE TO TRUE                        43381000
433811          PERFORM 5370-SEARCH-TRB-TABLE                           43381100
433812             UNTIL PS-EOT-TRB-TABLE                               43381200
433813      END-IF.                                                     43381300
433814                                                                  43381400
433815                                                                  43381500
433816 5370-SEARCH-TRB-TABLE.                                           43381600
433817      IF TM003-TBL-LNE-NBR (LINE-INDEX) = DK-PO-DRIVER-LNE        43381700
433818           AND TM003-TBL-LNE-UPDATED (LINE-INDEX)                 43381800
433819                 SET ASC-TRBL-EXISTS TO TRUE                      43381900
433820                 MOVE TM003-CYC-ADJ-NBR TO PV-CYC-ADJ-NBR         43382000
433821                                           PV-CYC-ADJ-BEF         43382100
433822                 MOVE TM003-TBL-NOTIF-NBR (LINE-INDEX) TO         43382200
433823                                     PV-NOTIF-NBR                 43382300
433824                                     PV-NOTIF-BEF                 43382400
433825                 SET PS-EOT-TRB-TABLE TO TRUE                     43382500
433826       ELSE                                                       43382600
433827           IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                  43382700
433828               SET ASC-NO-TRBL-EXISTS TO TRUE                     43382800
433829               SET PS-EOT-TRB-TABLE TO TRUE                       43382900
433830     END-IF.                                                      43383000
433831     SET LINE-INDEX UP BY 1.                                      43383100
433832                                                                  43383200
433833                                                                  43383300
433834                                                                  43383400
433835 5380-CREATE-TROUBLE-ROW.                                         43383500
433836     INITIALIZE TM500-FIELDS.                                     43383600
433837     SET TM500-ADD-DETAILS                                        43383700
433838         TM500-CREATE-MANUAL       TO  TRUE.                      43383800
433839                                                                  43383900
433840     MOVE 0                        TO  TM500-NOTIF-NBR.           43384000
433841     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         43384100
433842     MOVE ASC-FCLTY-ID             TO  TM500-FCLTY-ID.            43384200
433843                                                                  43384300
433844     MOVE ASC-PO-NBR               TO  TM500-PO-NBR.              43384400
433845                                                                  43384500
433846     SET TM500-LINE-LEVEL          TO  TRUE.                      43384600
433847     MOVE DK-PO-DRIVER-LNE         TO  TM500-PO-LNE-NBR.          43384700
433848                                                                  43384800
433849     MOVE ASC-REC-SEQ-NBR          TO  TM500-REC-SEQ-NBR.         43384900
433850     MOVE TM003-TRBL-RSN-CDE       TO  TM500-TRBL-RSN-CDE.        43385000
433851                                                                  43385100
433852     MOVE DP020-USERID             TO  TM500-CRE-UID              43385200
433853                                       TM500-NOTIF-UID.           43385300
433854                                                                  43385400
433855     IF  TM003-FREEFORM-TEXT = SPACES                             43385500
433856         MOVE '.' TO TM500-FREEFORM-TEXT                          43385600
433857     ELSE                                                         43385700
433858         MOVE TM003-FREEFORM-TEXT  TO  TM500-FREEFORM-TEXT.       43385800
433859                                                                  43385900
433860     PERFORM 5410-LINK-TO-UPDATE.                                 43386000
433861     IF TM500-CALL-SUCCESSFUL         OR                          43386100
433862         TM500-TPURCHS-SELECT-NOT-FND OR                          43386200
433863         TM500-TTRBNTF-UPDATE-NOT-FND OR                          43386300
433864         TM500-DIDNT-ALLOC-DUE-TO-TRBL                            43386400
433865             CONTINUE                                             43386500
433866     ELSE                                                         43386600
433867         IF  TM500-DUPLICATE-TROUBLE                              43386700
433868             SET DP020-MSG-FATAL                                  43386800
433869                 PS-ERROR          TO  TRUE                       43386900
433870             MOVE PC-TRBL-ALREADY-EXISTS-MSG                      43387000
433871                                   TO  DP020-MSG-MESSAGE          43387100
433872         ELSE                                                     43387200
433873             SET PS-ERROR                                         43387300
433874                 DP020-MSG-FATAL           TO  TRUE               43387400
433875             STRING 'NNNNN-E-'                                    43387500
433876                    TM500-RETURN-MSG                              43387600
433877                    '-'                                           43387700
433878                    TM500-RETURN-CODE                             43387800
433879                    ', SQLCODE='                                  43387900
433880                    TM500-SQLCODE DELIMITED BY SIZE               43388000
433881                                 INTO  DP020-MSG-MESSAGE          43388100
433882         END-IF                                                   43388200
433883     END-IF.                                                      43388300
433884                                                                  43388400
433885 5390-UPDATE-TRB-QUEUE.                                           43388500
433886     SET TM003-UPDATE TO TRUE.                                    43388600
433887     IF TM003-CYC-ADJ-NBR = 0                                     43388700
433888         MOVE TM500-NOTIF-NBR TO TM003-CYC-ADJ-NBR                43388800
433889                                     PV-CYC-ADJ-NBR               43388900
433890         MOVE  0                 TO PV-CYC-ADJ-BEF                43389000
433891         MOVE  0                 TO PV-NOTIF-BEF                  43389100
433892     ELSE                                                         43389200
433893         MOVE TM003-CYC-ADJ-NBR TO                                43389300
433894                                     PV-CYC-ADJ-NBR               43389400
433895     END-IF.                                                      43389500
433896     SET LINE-INDEX TO 1.                                         43389600
433897     SET PS-TABLE-NOT-LOADED TO TRUE.                             43389700
433898     PERFORM 5400-LOAD-QUEUE-TBL                                  43389800
433899        UNTIL PS-TABLE-LOADED.                                    43389900
433900                                                                  43390000
433901 5400-LOAD-QUEUE-TBL.                                             43390100
433902     IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                        43390200
433903        MOVE TM500-PO-LNE-NBR TO TM003-TBL-LNE-NBR (LINE-INDEX)   43390300
433904        MOVE TM500-NOTIF-NBR TO TM003-TBL-NOTIF-NBR (LINE-INDEX)  43390400
433905                                PV-NOTIF-NBR                      43390500
433906        SET TM003-TBL-LNE-UPDATED (LINE-INDEX) TO TRUE            43390600
433907        SET PS-TABLE-LOADED TO TRUE                               43390700
433908     ELSE                                                         43390800
433909        SET LINE-INDEX UP BY 1                                    43390900
433910     END-IF.                                                      43391000
433911                                                                  43391100
433912 5410-LINK-TO-UPDATE.                                             43391200
433913                                                                  43391300
433914     EXEC CICS LINK                                               43391400
433915          PROGRAM (PC-TMKCS520)                                   43391500
433916          COMMAREA(TM500-FIELDS)                                  43391600
433917          RESP    (PV-CICS-RESP)                                  43391700
433918     END-EXEC.                                                    43391800
433919                                                                  43391900
433920     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   43392000
433921         SET DP013-LOGIC-ABEND                                    43392100
433922             DP013-NO-ROLLBACK     TO TRUE                        43392200
433923         MOVE '5410-LINK-TO-UPDATE'                               43392300
433924                                   TO DP013-PARAGRAPH             43392400
433925         MOVE 'ATTEMPTING TO LINK TO CENTRAL PROCESSING'          43392500
433926                                   TO DP013-MESSAGE-TEXT (1)      43392600
433927         PERFORM DP013-0000-PROCESS-ABEND                         43392700
433928     END-IF.                                                      43392800
433929                                                                  43392900
433930                                                                  43393000
433931 5460-SELECT-TDISTHD.                                             43393100
433932                                                                  43393200
433933     EXEC SQL                                                     43393300
433934          SELECT                                                  43393400
433935                TOT_CART_CNT,                                     43393500
433936                FCSE_CART_CNT,                                    43393600
433937                P2L_CART_CNT,                                     43393700
433938                INPK_CART_CNT,                                    43393800
433939                VRFD_TMST                                         43393900
433940          INTO                                                    43394000
433950                :DISTHD-TOT-CART-CNT,                             43395000
433960                :DISTHD-FCSE-CART-CNT,                            43396000
433970                :DISTHD-P2L-CART-CNT,                             43397000
433980                :DISTHD-INPK-CART-CNT,                            43398000
433990                :DISTHD-VRFD-TMST                                 43399000
434000          FROM                                                    43400000
434100                TDISTHD                                           43410000
434200          WHERE                                                   43420000
434300                ORD_NBR          =  :DK-PO-NBR                    43430000
434400          AND   ORD_LNE_NBR      =  :DK-HOLD-LNE-NBR              43440000
434500          AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               43450000
434600     END-EXEC.                                                    43460000
434700                                                                  43470000
434800     EVALUATE TRUE                                                43480000
434900         WHEN SQLCODE = ZERO                                      43490000
435000              SET PS-TDISTHD-FOUND TO TRUE                        43500000
435100         WHEN SQLCODE = +100                                      43510000
435200              SET PS-NO-TDISTHD-FOUND TO TRUE                     43520000
435300         WHEN SQLCODE = -904                                      43530000
435400         WHEN SQLCODE = -911                                      43540000
435500         WHEN SQLCODE = -913                                      43550000
435600             PERFORM 9900-SOFT-ABORT                              43560000
435700         WHEN SQLWARN0 NOT = SPACE                                43570000
435800         WHEN SQLCODE NOT = ZERO                                  43580000
435900              MOVE '5460-SELECT-TDISTHD'                          43590000
436000                               TO DP013-PARAGRAPH                 43600000
436100              MOVE 'GET TDISTHD ROW'                              43610000
436200                               TO DP013-MESSAGE-TEXT (1)          43620000
436300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             43630000
436400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        43640000
436500              MOVE DK-HOLD-LNE-NBR  TO PV-DISP-LNE-NBR            43650000
436600              STRING ' PO = '                                     43660000
436700                     PV-DISP-PO-NBR                               43670000
436800                     ' RECV ='                                    43680000
436900                     PV-DISP-REC-SEQ-NBR                          43690000
437000                     ' LINE = '                                   43700000
437100                     PV-DISP-LNE-NBR                              43710000
437200                                         DELIMITED BY SIZE        43720000
437300                              INTO DP013-MESSAGE-TEXT (2)         43730000
437400              MOVE SQLCA        TO DP013-SQLCA                    43740000
437500              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        43750000
437600              MOVE SQLCA       TO DP013-SQLCA                     43760000
437700              SET DP013-DB2-ABEND                                 43770000
437800                               TO TRUE                            43780000
437900              PERFORM DP013-0000-PROCESS-ABEND                    43790000
438000     END-EVALUATE.                                                43800000
438100                                                                  43810000
438200 5515-ADD-TO-RECD-AUDIT-AFTER.                                    43820000
438300                                                                  43830000
438400     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       43840000
438500     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          43850000
438600     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         43860000
438700     MOVE DK-PO-NBR                TO RC031-PO-NBR.               43870000
438800     MOVE RECDIS-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           43880000
438900     MOVE DK-REC-SEQ-NBR           TO RC031-REC-SEQ-NBR.          43890000
439000     MOVE DK-OPER-UNT-ID           TO RC031-OPER-UNT-ID.          43900000
439100     MOVE DK-FCLTY-ID              TO RC031-FCLTY-ID.             43910000
439200     MOVE DK-STR-NBR               TO RC031-STR-NBR.              43920000
439300     MOVE DP020-USERID             TO RC031-UPD-UID.              43930000
439400     IF ASC-POST-VERIFIED-RECEIPT                                 43940000
439500         MOVE PC-POST-VERIFY-PGM-NAME  TO RC031-UPD-PGM-ID        43950000
439600     ELSE                                                         43960000
439700         MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID        43970000
439800     END-IF.                                                      43980000
439900     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             43990000
440000     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            44000000
440100     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          44010000
440200     EXEC CICS                                                    44020000
440300         LINK PROGRAM  (PC-AUDIT-RTN)                             44030000
440400              COMMAREA (RC031-FIELDS)                             44040000
440500              LENGTH   (PC-AUDIT-RTN-LENGTH)                      44050000
440600     END-EXEC.                                                    44060000
440700     EVALUATE TRUE                                                44070000
440800         WHEN RC031-CALL-SUCCESSFUL                               44080000
440900             CONTINUE                                             44090000
441000                                                                  44100000
441100         WHEN OTHER                                               44110000
441200              MOVE '5515-ADD-TO-RECD-AUDIT-AFTER'                 44120000
441300                                    TO DP013-PARAGRAPH            44130000
441400              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               44140000
441500                                TO DP013-MESSAGE-TEXT (1)         44150000
441600              MOVE RC031-RETURN-DESC                              44160000
441700                                TO DP013-MESSAGE-TEXT (2)         44170000
441800              MOVE RC031-SQLCA      TO DP013-SQLCA                44180000
441900              SET DP013-DB2-ABEND                                 44190000
442000                  DP013-XCTL-DISPLAY-RESTART                      44200000
442100                                    TO TRUE                       44210000
442200              PERFORM DP013-0000-PROCESS-ABEND                    44220000
442300     END-EVALUATE.                                                44230000
442400                                                                  44240000
442500                                                                  44250000
442600 5800-CHECK-PO-STATUS.                                            44260000
442700                                                                  44270000
442800     PERFORM 7000-GET-PO-INFO.                                    44280000
442810     PERFORM 7220-GET-RECDIS-QTY.                                 44281000
442820                                                                  44282000
442830     IF (PV-PURITM-UNT-QTY GREATER PV-RECDIS-AP-VERIFY-ITM-QTY    44283000
442840     AND PV-PURITM-STATUS-CDE EQUAL 'CM')                         44284000
442850         MOVE 'AC'                TO  PV-PURITM-STATUS-CDE        44285000
442860         PERFORM 5830-UPDATE-PURITM-STATUS                        44286000
442870         IF  PV-PURCHS-STATUS-CDE EQUAL 'CM'                      44287000
442880             MOVE 'AC'            TO  PV-PURCHS-STATUS-CDE        44288000
442890***          PERFORM 5850-UPDATE-PURCHS-STATUS                    44289000
442891         END-IF                                                   44289100
442892     ELSE                                                         44289200
442893         IF (PV-PURITM-UNT-QTY NOT > PV-RECDIS-AP-VERIFY-ITM-QTY  44289300
442894         AND PV-PURITM-STATUS-CDE NOT EQUAL 'CM')                 44289400
442895             MOVE 'CM'            TO  PV-PURITM-STATUS-CDE        44289500
442896             PERFORM 5830-UPDATE-PURITM-STATUS                    44289600
442897             IF  PV-PURCHS-STATUS-CDE NOT EQUAL 'CM'              44289700
442898                 MOVE 'CM'        TO  PV-PURCHS-STATUS-CDE        44289800
442899***              PERFORM 5850-UPDATE-PURCHS-STATUS                44289900
442900             END-IF                                               44290000
442901         END-IF                                                   44290100
442902     END-IF.                                                      44290200
442903                                                                  44290300
442904 5830-UPDATE-PURITM-STATUS.                                       44290400
442905                                                                  44290500
442906     PERFORM 7500-GET-PURITM.                                     44290600
442907     IF  SQLCODE EQUAL ZERO                                       44290700
442908     AND PURITM-STATUS-CDE NOT = 'RV'                             44290800
442909         IF PV-PURITM-STATUS-CDE = 'AC'                           44290900
442910             MOVE ASC-DEPT-NBR      TO PV-DEPT-NBR-X              44291000
442911             MOVE PV-DEPT-NBR       TO PV-DEPT-NBR-KEY            44291100
442912             SET PS-NO-RMS-PO       TO TRUE                       44291200
442913*** CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO      44291300
442914*** VERSION THE TPURITM ROWS; WE JUST WANT TO UPDATE THE ROW.     44291400
442915             PERFORM 7650-CHECK-FOR-RMS-PO                        44291500
442916             IF PV-DB2-COUNT > ZERO                               44291600
442917                 SET PS-RMS-PO      TO TRUE                       44291700
442918                 PERFORM 7530-ONLY-UPDATE-PURITM                  44291800
442919             ELSE                                                 44291900
442920                 PERFORM 7510-UPDATE-PURITM                       44292000
442921                 ADD 1              TO  PURITM-VER-NBR            44292100
442922                 PERFORM 7520-INSERT-PURITM                       44292200
442923             END-IF                                               44292300
442924          ELSE                                                    44292400
442925             PERFORM 7530-ONLY-UPDATE-PURITM                      44292500
442926          END-IF                                                  44292600
442927     END-IF.                                                      44292700
442928                                                                  44292800
442929 5850-UPDATE-PURCHS-STATUS.                                       44292900
442930                                                                  44293000
442931     IF  PV-PURCHS-STATUS-CDE EQUAL 'CM'                          44293100
442932         PERFORM 7600-COUNT-PO-LINE-ROWS                          44293200
442933         IF  PV-DB2-COUNT EQUAL ZERO                              44293300
442934             IF  PS-RMS-PO                                        44293400
442935                 CONTINUE                                         44293500
442936             ELSE                                                 44293600
442937                 IF  PS-CHECKED-FOR-RMS-PO                        44293700
442938                     PERFORM 7610-GET-TPURCHS-STATUS              44293800
442939                     PERFORM 7620-ONLY-UPDATE-PURCHS-STATUS       44293900
442940                 ELSE                                             44294000
442941                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           44294100
442942                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         44294200
442943                     SET PS-NO-RMS-PO  TO TRUE                    44294300
442944                     PERFORM 7650-CHECK-FOR-RMS-PO                44294400
442945                     IF  PV-DB2-COUNT = ZERO                      44294500
442946                         PERFORM 7610-GET-TPURCHS-STATUS          44294600
442947                         PERFORM 7620-ONLY-UPDATE-PURCHS-STATUS   44294700
442948                     END-IF                                       44294800
442949                 END-IF                                           44294900
442950             END-IF                                               44295000
442951         ELSE                                                     44295100
442952             IF  PS-RMS-PO                                        44295200
442953                 CONTINUE                                         44295300
442954             ELSE                                                 44295400
442955                 IF  PS-CHECKED-FOR-RMS-PO                        44295500
442956                     MOVE 'AC'         TO  PV-PURCHS-STATUS-CDE   44295600
442957                 ELSE                                             44295700
442958                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           44295800
442959                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         44295900
442960                     SET PS-NO-RMS-PO  TO TRUE                    44296000
442961                     PERFORM 7650-CHECK-FOR-RMS-PO                44296100
442962                     IF  PV-DB2-COUNT = ZERO                      44296200
442963                         MOVE 'AC'     TO  PV-PURCHS-STATUS-CDE   44296300
442964                     END-IF                                       44296400
442965                 END-IF                                           44296500
442966             END-IF                                               44296600
442967         END-IF                                                   44296700
442968     ELSE                                                         44296800
442969         IF  PS-RMS-PO                                            44296900
442970             CONTINUE                                             44297000
442971         ELSE                                                     44297100
442972             IF  PS-CHECKED-FOR-RMS-PO                            44297200
442973                 PERFORM 7610-GET-TPURCHS-STATUS                  44297300
442974                 PERFORM 7630-UPDATE-PURCHS-STATUS                44297400
442975                 ADD 1            TO  PURCHS-VER-NBR              44297500
442976                 PERFORM 7640-INSERT-PURCHS                       44297600
442977             ELSE                                                 44297700
442978                 MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X               44297800
442979                 MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY             44297900
442980                 SET PS-NO-RMS-PO  TO TRUE                        44298000
442981                 PERFORM 7650-CHECK-FOR-RMS-PO                    44298100
442982                 IF  PV-DB2-COUNT = ZERO                          44298200
442983                     PERFORM 7610-GET-TPURCHS-STATUS              44298300
442984                     PERFORM 7630-UPDATE-PURCHS-STATUS            44298400
442985                     ADD 1         TO  PURCHS-VER-NBR             44298500
442986                     PERFORM 7640-INSERT-PURCHS                   44298600
442987                 END-IF                                           44298700
442988             END-IF                                               44298800
442989         END-IF                                                   44298900
442990     END-IF.                                                      44299000
442991                                                                  44299100
442992******************************************************************44299200
442993** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **44299300
442994** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **44299400
442995** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **44299500
442996** THE USER.                                                    **44299600
442997******************************************************************44299700
442998 6000-REFRESH-PANEL-FROM-TEMP.                                    44299800
442999     IF  ASC-UPDATE-TSQ                                           44299900
443000         SET ASC-NO-TSQ-UPDATE TO TRUE                            44300000
443100         MOVE ZERO                 TO PV-SAVE-ITEM                44310000
443200                                      PV-SEL-QUEUE-ITEM           44320000
443300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        44330000
443400                                   TO PV-HOLD-SELECTED-ITEMS      44340000
443500         MOVE +1                   TO PV-ITEMS-PROCESSED          44350000
443600         PERFORM 6100-UPDATE-TSQ                                  44360000
443700             UNTIL PV-ITEMS-PROCESSED >                           44370000
443800                                     PV-HOLD-SELECTED-ITEMS       44380000
443900         PERFORM 6010-DELETE-SEL-QUEUE                            44390000
444000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         44400000
444100                    ASC-BLOCK-ENTRIES (2)                         44410000
444200     END-IF.                                                      44420000
444300                                                                  44430000
444400*----------------------------------------------------------------*44440000
444500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *44450000
444600*----------------------------------------------------------------*44460000
444700 6010-DELETE-SEL-QUEUE.                                           44470000
444800                                                                  44480000
444900     EXEC CICS                                                    44490000
445000         DELETEQ TS                                               44500000
445100             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       44510000
445200             RESP  (PV-CICS-RESP)                                 44520000
445300     END-EXEC.                                                    44530000
445400*                                                                 44540000
445500     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      44550000
445600        (PV-CICS-RESP = DFHRESP(QIDERR)))                         44560000
445700         CONTINUE                                                 44570000
445800     ELSE                                                         44580000
445900         SET DP013-CICS-ABEND TO TRUE                             44590000
446000         SET DP013-NO-ROLLBACK TO TRUE                            44600000
446100         MOVE '6010-DELETE-SEL-QUEUE'                             44610000
446200                        TO DP013-PARAGRAPH                        44620000
446300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         44630000
446400                        TO DP013-MESSAGE-TEXT (1)                 44640000
446500         PERFORM DP013-0000-PROCESS-ABEND                         44650000
446600     END-IF.                                                      44660000
446700                                                                  44670000
446800*----------------------------------------------------------------*44680000
446900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *44690000
447000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *44700000
447100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *44710000
447200*    THE TEMP QUEUE.                                             *44720000
447300*----------------------------------------------------------------*44730000
447400                                                                  44740000
447500 6100-UPDATE-TSQ.                                                 44750000
447600                                                                  44760000
447700     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             44770000
447800     PERFORM 6105-READ-SEL-QUEUE.                                 44780000
447900                                                                  44790000
448000     EVALUATE TRUE                                                44800000
448100         WHEN ASC-RETURNING-FROM-RCVG                             44810000
448200             PERFORM                                              44820000
448300                 VARYING RC801-IDX                                44830000
448400                 FROM 1 BY 1                                      44840000
448500                 UNTIL ((PV-ITEMS-PROCESSED >                     44850000
448600                                      PV-HOLD-SELECTED-ITEMS)     44860000
448700                 OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))     44870000
448800                 IF  RC801-ACTION-SW (RC801-IDX) > SPACE          44880000
448900                     PERFORM 6110-PROCESS-ITEMS                   44890000
449000                 END-IF                                           44900000
449100                 ADD +1                TO PV-ITEMS-PROCESSED      44910000
449200             END-PERFORM                                          44920000
449300         WHEN ASC-RETURNING-FROM-TRBL                             44930000
449400             PERFORM                                              44940000
449500                 VARYING TM002-IDX                                44950000
449600                 FROM 1 BY 1                                      44960000
449700                 UNTIL ((PV-ITEMS-PROCESSED >                     44970000
449800                                      PV-HOLD-SELECTED-ITEMS)     44980000
449900                 OR (TM002-IDX GREATER THAN TM002-MAX-ITEMS))     44990000
450000                 IF  TM002-ACTION-SW (TM002-IDX) > SPACE          45000000
450100                     PERFORM 6110-PROCESS-ITEMS                   45010000
450200                 END-IF                                           45020000
450300                 ADD +1                TO PV-ITEMS-PROCESSED      45030000
450400             END-PERFORM                                          45040000
450500         WHEN ASC-RETURNING-FROM-STR-PACK                         45050000
450600             PERFORM                                              45060000
450700                 VARYING RC037-IDX                                45070000
450800                 FROM 1 BY 1                                      45080000
450900                 UNTIL ((PV-ITEMS-PROCESSED >                     45090000
451000                                      PV-HOLD-SELECTED-ITEMS)     45100000
451100                 OR (RC037-IDX GREATER THAN RC037-MAX-ITEMS))     45110000
451200                 IF  RC037-ACTION-SW (RC037-IDX) > SPACE          45120000
451300                     PERFORM 6110-PROCESS-ITEMS                   45130000
451400                 END-IF                                           45140000
451500                 ADD +1                TO PV-ITEMS-PROCESSED      45150000
451600             END-PERFORM                                          45160000
451700     END-EVALUATE.                                                45170000
451800                                                                  45180000
451900     PERFORM 6111-WRITE-LIST-QUEUE.                               45190000
452000*----------------------------------------------------------------*45200000
452100*    READ THE LIST QUEUE RECORD.                                 *45210000
452200*----------------------------------------------------------------*45220000
452300                                                                  45230000
452400 6105-READ-SEL-QUEUE.                                             45240000
452500                                                                  45250000
452600     EVALUATE TRUE                                                45260000
452700         WHEN ASC-RETURNING-FROM-RCVG                             45270000
452800             EXEC CICS                                            45280000
452900                  READQ TS                                        45290000
453000                      QUEUE (ASC-SEL-QUEUE-NAME-OUT)              45300000
453100                      INTO  (RC801-PREPACK-SELECT-RECORD)         45310000
453200                      ITEM  (PV-SEL-QUEUE-ITEM)                   45320000
453300                      RESP  (PV-CICS-RESP)                        45330000
453400             END-EXEC                                             45340000
453500         WHEN ASC-RETURNING-FROM-TRBL                             45350000
453600             EXEC CICS                                            45360000
453700                  READQ TS                                        45370000
453800                      QUEUE (ASC-SEL-QUEUE-NAME-OUT)              45380000
453900                      INTO  (TM002-MESSAGE-SEL-REC)               45390000
454000                      ITEM  (PV-SEL-QUEUE-ITEM)                   45400000
454100                      RESP  (PV-CICS-RESP)                        45410000
454200             END-EXEC                                             45420000
454300         WHEN ASC-RETURNING-FROM-STR-PACK                         45430000
454400             EXEC CICS                                            45440000
454500                  READQ TS                                        45450000
454600                      QUEUE (ASC-SEL-QUEUE-NAME-OUT)              45460000
454700                      INTO  (RC037-DC-SELECT-RECORD)              45470000
454800                      ITEM  (PV-SEL-QUEUE-ITEM)                   45480000
454900                      RESP  (PV-CICS-RESP)                        45490000
455000             END-EXEC                                             45500000
455100     END-EVALUATE.                                                45510000
455200                                                                  45520000
455300*                                                                 45530000
455400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          45540000
455500         CONTINUE                                                 45550000
455600     ELSE                                                         45560000
455700         SET DP013-CICS-ABEND      TO  TRUE                       45570000
455800         SET DP013-NO-ROLLBACK     TO  TRUE                       45580000
455900         MOVE '6105-READ-SEL-QUEUE'                               45590000
456000                                   TO  DP013-PARAGRAPH            45600000
456100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           45610000
456200                                   TO  DP013-MESSAGE-TEXT(1)      45620000
456300         PERFORM DP013-0000-PROCESS-ABEND                         45630000
456400     END-IF.                                                      45640000
456500 EJECT                                                            45650000
456600*----------------------------------------------------------------*45660000
456700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*45670000
456800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*45680000
456900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *45690000
457000*----------------------------------------------------------------*45700000
457100                                                                  45710000
457200 6110-PROCESS-ITEMS.                                              45720000
457300                                                                  45730000
457400     EVALUATE TRUE                                                45740000
457500         WHEN ASC-RETURNING-FROM-RCVG                             45750000
457600             COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC801-IDX) - 1)  45760000
457700                             / PC-ITEMS-PER-PANEL)                45770000
457800         WHEN ASC-RETURNING-FROM-TRBL                             45780000
457900             COMPUTE PV-ITEM = 1 + ((TM002-ITEM (TM002-IDX) - 1)  45790000
458000                             / PC-ITEMS-PER-PANEL)                45800000
458100         WHEN ASC-RETURNING-FROM-STR-PACK                         45810000
458200             COMPUTE PV-ITEM = 1 + ((RC037-ITEM (RC037-IDX) - 1)  45820000
458300                             / PC-ITEMS-PER-PANEL)                45830000
458400     END-EVALUATE.                                                45840000
458500                                                                  45850000
458600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           45860000
458700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          45870000
458800             PERFORM 6111-WRITE-LIST-QUEUE                        45880000
458900         END-IF                                                   45890000
459000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    45900000
459100                                                                  45910000
459200         PERFORM 6112-READ-LIST-QUEUE                             45920000
459300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               45930000
459400             CONTINUE                                             45940000
459500         END-IF                                                   45950000
459600     END-IF.                                                      45960000
459700                                                                  45970000
459800     EVALUATE TRUE                                                45980000
459900         WHEN ASC-RETURNING-FROM-RCVG                             45990000
460000             COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX)             46000000
460100                            - LQW-LIST-ITEM-NUMBER (1)) + 1       46010000
460200         WHEN ASC-RETURNING-FROM-TRBL                             46020000
460300             COMPUTE PV-SUB = (TM002-ITEM (TM002-IDX)             46030000
460400                            - LQW-LIST-ITEM-NUMBER (1)) + 1       46040000
460500         WHEN ASC-RETURNING-FROM-STR-PACK                         46050000
460600             COMPUTE PV-SUB = (RC037-ITEM (RC037-IDX)             46060000
460700                            - LQW-LIST-ITEM-NUMBER (1)) + 1       46070000
460800     END-EVALUATE.                                                46080000
460900                                                                  46090000
461000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         46100000
461100     MOVE LQW-SELECTED-SW (PV-SUB)                                46110000
461200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  46120000
461300     EVALUATE TRUE                                                46130000
461400         WHEN ASC-RETURNING-FROM-RCVG                             46140000
461500             EVALUATE TRUE                                        46150000
461600                 WHEN RC801-INQ (RC801-IDX)                       46160000
461700                      MOVE PC-INQ      TO LQW-ACTION (PV-SUB)     46170000
461800                                                                  46180000
461900                 WHEN RC801-UPD (RC801-IDX)                       46190000
462000                      MOVE PC-UPD      TO LQW-ACTION (PV-SUB)     46200000
462100                                                                  46210000
462200                 WHEN RC801-DEL (RC801-IDX)                       46220000
462300                      MOVE PC-DEL      TO LQW-ACTION (PV-SUB)     46230000
462400                                                                  46240000
462500                 WHEN RC801-ERR (RC801-IDX)                       46250000
462600                      MOVE PC-ERR      TO LQW-ACTION (PV-SUB)     46260000
462700             END-EVALUATE                                         46270000
462800         WHEN ASC-RETURNING-FROM-TRBL                             46280000
462900             EVALUATE TRUE                                        46290000
463000                 WHEN TM002-INQ (TM002-IDX)                       46300000
463100                      MOVE PC-INQ      TO LQW-ACTION (PV-SUB)     46310000
463200                                                                  46320000
463300                 WHEN TM002-UPD (TM002-IDX)                       46330000
463400                      MOVE PC-UPD      TO LQW-ACTION (PV-SUB)     46340000
463500                                                                  46350000
463600                 WHEN TM002-DEL (TM002-IDX)                       46360000
463700                      MOVE PC-DEL      TO LQW-ACTION (PV-SUB)     46370000
463800                                                                  46380000
463900                 WHEN TM002-ERR (TM002-IDX)                       46390000
464000                      MOVE PC-ERR      TO LQW-ACTION (PV-SUB)     46400000
464100             END-EVALUATE                                         46410000
464200         WHEN ASC-RETURNING-FROM-STR-PACK                         46420000
464300             EVALUATE TRUE                                        46430000
464400                 WHEN RC037-INQ (RC037-IDX)                       46440000
464500                      MOVE PC-INQ      TO LQW-ACTION (PV-SUB)     46450000
464600                                                                  46460000
464700                 WHEN RC037-UPD (RC037-IDX)                       46470000
464800                      MOVE PC-UPD      TO LQW-ACTION (PV-SUB)     46480000
464900                                                                  46490000
465000                 WHEN RC037-DEL (RC037-IDX)                       46500000
465100                      MOVE PC-DEL      TO LQW-ACTION (PV-SUB)     46510000
465200                                                                  46520000
465300                 WHEN RC037-ERR (RC037-IDX)                       46530000
465400                      MOVE PC-ERR      TO LQW-ACTION (PV-SUB)     46540000
465500             END-EVALUATE                                         46550000
465600     END-EVALUATE.                                                46560000
465700                                                                  46570000
465800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                46580000
465900                                                                  46590000
466000*----------------------------------------------------------------*46600000
466100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *46610000
466200*----------------------------------------------------------------*46620000
466300                                                                  46630000
466400 6111-WRITE-LIST-QUEUE.                                           46640000
466500                                                                  46650000
466600     EXEC CICS                                                    46660000
466700         WRITEQ TS                                                46670000
466800             QUEUE (ASC-LIST-QUEUE-NAME)                          46680000
466900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     46690000
467000             ITEM  (PV-SAVE-ITEM)                                 46700000
467100             REWRITE                                              46710000
467200             RESP  (PV-CICS-RESP)                                 46720000
467300     END-EXEC.                                                    46730000
467400*                                                                 46740000
467500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          46750000
467600         CONTINUE                                                 46760000
467700     ELSE                                                         46770000
467800         SET DP013-CICS-ABEND  TO  TRUE                           46780000
467900         SET DP013-NO-ROLLBACK TO  TRUE                           46790000
468000         MOVE '6111-WRITE-LIST-QUEUE'                             46800000
468100                               TO  DP013-PARAGRAPH                46810000
468200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  46820000
468300                               TO  DP013-MESSAGE-TEXT(1)          46830000
468400         PERFORM DP013-0000-PROCESS-ABEND                         46840000
468500     END-IF.                                                      46850000
468600                                                                  46860000
468700 EJECT                                                            46870000
468800*----------------------------------------------------------------*46880000
468900*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*46890000
469000*----------------------------------------------------------------*46900000
469100                                                                  46910000
469200 6112-READ-LIST-QUEUE.                                            46920000
469300                                                                  46930000
469400     EXEC CICS                                                    46940000
469500         READQ TS                                                 46950000
469600             QUEUE (ASC-LIST-QUEUE-NAME)                          46960000
469700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     46970000
469800             ITEM  (PV-ITEM)                                      46980000
469900             RESP  (PV-CICS-RESP)                                 46990000
470000     END-EXEC.                                                    47000000
470100*                                                                 47010000
470200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47020000
470300         CONTINUE                                                 47030000
470400     ELSE                                                         47040000
470500         SET DP013-CICS-ABEND        TO TRUE                      47050000
470600         SET DP013-NO-ROLLBACK       TO TRUE                      47060000
470700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           47070000
470800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    47080000
470900                                     TO DP013-MESSAGE-TEXT(1)     47090000
471000         PERFORM DP013-0000-PROCESS-ABEND                         47100000
471100     END-IF.                                                      47110000
471200                                                                  47120000
471300******************************************************************47130000
471400* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *47140000
471500******************************************************************47150000
471600 6150-WRITE-VRFY-ADJ-QUEUE.                                       47160000
471700                                                                  47170000
471800     EXEC CICS WRITEQ TS                                          47180000
471900               QUEUE (ASC-VRFY-ADJ-QUEUE-NAME)                    47190000
472000               FROM  (PC241-FIELDS)                               47200000
472100               ITEM  (PV-VRFY-ITEM)                               47210000
472200               RESP  (PV-CICS-RESP)                               47220000
472300     END-EXEC.                                                    47230000
472400                                                                  47240000
472500     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       47250000
472600         SET DP013-CICS-ABEND                                     47260000
472700             DP013-NO-ROLLBACK   TO TRUE                          47270000
472800         MOVE '6150-WRITE-VRFY-ADJ-QUEUE'                         47280000
472900                                 TO DP013-PARAGRAPH               47290000
473000         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE'        47300000
473100                                 TO DP013-MESSAGE-TEXT(1)         47310000
473200         PERFORM DP013-0000-PROCESS-ABEND                         47320000
473300     END-IF.                                                      47330000
473400                                                                  47340000
473500 7000-GET-PO-INFO.                                                47350000
473600                                                                  47360000
473700     EXEC SQL                                                     47370000
473800          SELECT A.DEPT_NBR                                       47380000
473900               , A.STATUS_CDE                                     47390000
474000            INTO :PURCHS-DEPT-NBR                                 47400000
474100               , :PV-PURCHS-STATUS-CDE                            47410000
474200            FROM TPURCHS A                                        47420000
474210           WHERE A.VER_STATUS_CDE     = 'A'                       47421000
474220             AND A.PO_NBR             = :DK-PO-NBR                47422000
474230     END-EXEC                                                     47423000
474240                                                                  47424000
474250     EVALUATE TRUE                                                47425000
474260         WHEN SQLCODE = ZERO                                      47426000
474270             CONTINUE                                             47427000
474280         WHEN SQLCODE = +100                                      47428000
474290            MOVE  SPACES TO PURCHS-DEPT-NBR                       47429000
474300                            PV-PURCHS-STATUS-CDE                  47430000
474301         WHEN SQLCODE = -904                                      47430100
474302         WHEN SQLCODE = -911                                      47430200
474303         WHEN SQLCODE = -913                                      47430300
474304             PERFORM 9900-SOFT-ABORT                              47430400
474305         WHEN SQLWARN0 NOT = SPACES                               47430500
474306         WHEN SQLCODE      NOT = ZERO                             47430600
474307             MOVE '7000-GET-PO-INFO'                              47430700
474308                             TO DP013-PARAGRAPH                   47430800
474309             MOVE 'UNSUCCESSFUL SELECT OF DEPT, STATUS'           47430900
474310                             TO DP013-MESSAGE-TEXT (1)            47431000
474311             MOVE SQLCA         TO DP013-SQLCA                    47431100
474312             MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)           47431200
474313             MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                   47431300
474314             MOVE SQLCA       TO DP013-SQLCA                      47431400
474315             STRING ' PO = '                                      47431500
474316                    PV-DISP-PO-NBR                                47431600
474317                                        DELIMITED BY SIZE         47431700
474318                             INTO DP013-MESSAGE-TEXT (2)          47431800
474319             SET DP013-DB2-ABEND                                  47431900
474320                  DP013-XCTL-DISPLAY-RESTART                      47432000
474321                             TO TRUE                              47432100
474322             PERFORM DP013-0000-PROCESS-ABEND                     47432200
474323     END-EVALUATE.                                                47432300
474324                                                                  47432400
474325                                                                  47432500
474326 7020-SELECT-PURITM-DATA.                                         47432600
474327                                                                  47432700
474328     EXEC SQL                                                     47432800
474329           SELECT PO_LNE_NBR                                      47432900
474330                , STATUS_CDE                                      47433000
474331                , UNT_QTY                                         47433100
474332             INTO :PURITM-PO-LNE-NBR                              47433200
474333                , :PV-PURITM-STATUS-CDE                           47433300
474334                , :PV-PURITM-UNT-QTY                              47433400
474335             FROM TPURITM                                         47433500
474336            WHERE PO_NBR         = :DK-PO-NBR                     47433600
474337              AND APP_PO_LNE_NBR = :DK-LNE-NBR                    47433700
474338              AND VER_STATUS_CDE = 'A'                            47433800
474339     END-EXEC.                                                    47433900
474340                                                                  47434000
474341     EVALUATE TRUE                                                47434100
474342         WHEN SQLCODE = ZERO                                      47434200
474343              CONTINUE                                            47434300
474344         WHEN SQLCODE = -904                                      47434400
474345         WHEN SQLCODE = -911                                      47434500
474346         WHEN SQLCODE = -913                                      47434600
474347             PERFORM 9900-SOFT-ABORT                              47434700
474348         WHEN SQLWARN0 NOT = SPACE                                47434800
474349         WHEN SQLCODE NOT = ZERO                                  47434900
474350              MOVE '7020-SELECT-PURITM-DATA'                      47435000
474351                               TO DP013-PARAGRAPH                 47435100
474352              MOVE 'SELECT TPURITM DATA'                          47435200
474353                               TO DP013-MESSAGE-TEXT (1)          47435300
474354              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        47435400
474355              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  47435500
474356              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 47435600
474357              MOVE SQLCA       TO DP013-SQLCA                     47435700
474358              STRING ' PO = '                                     47435800
474359                     PV-DISP-PO-NBR                               47435900
474360                     ' LINE ='                                    47436000
474361                     PV-DISP-LNE-NBR                              47436100
474362                                         DELIMITED BY SIZE        47436200
474363                              INTO DP013-MESSAGE-TEXT (2)         47436300
474364              SET DP013-DB2-ABEND                                 47436400
474365                               TO TRUE                            47436500
474366              PERFORM DP013-0000-PROCESS-ABEND                    47436600
474367     END-EVALUATE.                                                47436700
474368                                                                  47436800
474369 7055-GET-TDISTHD.                                                47436900
474370                                                                  47437000
474380     SET ASC-ACTL-NOT-CONFIRMED                                   47438000
474390                     (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE.          47439000
474400                                                                  47440000
474500     MOVE ASC-PO-NBR                TO DK-PO-NBR.                 47450000
474600     MOVE ASC-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.            47460000
474700                                                                  47470000
474800     EXEC SQL                                                     47480000
474900          SELECT                                                  47490000
475000                   FCSE_CNFRMN_TMST                               47500000
475100            INTO                                                  47510000
475200                  :DISTHD-FCSE-CNFRMN-TMST                        47520000
475300            FROM                                                  47530000
475400                  TDISTHD                                         47540000
475500            WHERE                                                 47550000
475600                  ORD_NBR          = :DK-PO-NBR                   47560000
475700              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              47570000
475800              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            47580000
475900     END-EXEC.                                                    47590000
476000                                                                  47600000
476100     EVALUATE TRUE                                                47610000
476200         WHEN SQLCODE = ZERO                                      47620000
476300              IF  DISTHD-FCSE-CNFRMN-TMST = PC-DB2-DEFAULT-TMST   47630000
476400                  CONTINUE                                        47640000
476500              ELSE                                                47650000
476600                  SET ASC-ACTL-CONFIRMED                          47660000
476700                             (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE   47670000
476800              END-IF                                              47680000
476900         WHEN SQLCODE = +100                                      47690000
477000              CONTINUE                                            47700000
477100         WHEN SQLCODE = -904                                      47710000
477200         WHEN SQLCODE = -911                                      47720000
477300         WHEN SQLCODE = -913                                      47730000
477400             PERFORM 9900-SOFT-ABORT                              47740000
477500         WHEN SQLWARN0 NOT = SPACES                               47750000
477600         WHEN SQLCODE  NOT = ZERO                                 47760000
477700             MOVE '7055-GET-TDISTHD'                              47770000
477800                                 TO DP013-PARAGRAPH               47780000
477900             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                47790000
478000                                 TO DP013-MESSAGE-TEXT (1)        47800000
478100             MOVE SQLCA         TO DP013-SQLCA                    47810000
478200             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              47820000
478300             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         47830000
478400             MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR             47840000
478500             STRING ' PO = '                                      47850000
478600                    PV-DISP-PO-NBR                                47860000
478700                    ' RECV ='                                     47870000
478800                    PV-DISP-REC-SEQ-NBR                           47880000
478900                    ' LINE = '                                    47890000
479000                    PV-DISP-LNE-NBR                               47900000
479100                                        DELIMITED BY SIZE         47910000
479200                             INTO DP013-MESSAGE-TEXT (2)          47920000
479300             MOVE SQLCA        TO DP013-SQLCA                     47930000
479400             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       47940000
479500             SET DP013-DB2-ABEND                                  47950000
479600                 DP013-XCTL-DISPLAY-RESTART                       47960000
479700                                 TO TRUE                          47970000
479800                                                                  47980000
479900             PERFORM DP013-0000-PROCESS-ABEND                     47990000
480000     END-EVALUATE.                                                48000000
480100                                                                  48010000
480200 7060-GET-TDISTDT.                                                48020000
480300                                                                  48030000
480400                                                                  48040000
480500     MOVE ASC-PO-NBR             TO  DK-PO-NBR.                   48050000
480600     MOVE ASC-REC-SEQ-NBR        TO  DK-REC-SEQ-NBR.              48060000
480700     MOVE ASC-STR-NBR            TO  DK-STR-NBR.                  48070000
480800                                                                  48080000
480900     EXEC SQL                                                     48090000
481000          SELECT                                                  48100000
481100                  A.TOT_CART_CNT                                  48110000
481200                , B.P2L_SPLT_UNT_QTY                              48120000
481300                , B.FCSE_SPLT_UNT_QTY                             48130000
481400                , B.INPK_SPLT_UNT_QTY                             48140000
481500            INTO                                                  48150000
481600                  :DISTHD-TOT-CART-CNT                            48160000
481700                , :DISTDT-P2L-SPLT-UNT-QTY                        48170000
481800                , :DISTDT-FCSE-SPLT-UNT-QTY                       48180000
481900                , :DISTDT-INPK-SPLT-UNT-QTY                       48190000
482000            FROM                                                  48200000
482100                  TDISTHD A                                       48210000
482200               ,  TDISTDT B                                       48220000
482300            WHERE                                                 48230000
482400                  A.ORD_NBR          = :DK-PO-NBR                 48240000
482500              AND A.ORD_NBR          = B.ORD_NBR                  48250000
482600              AND A.ORD_LNE_NBR      = :DK-PO-DRIVER-LNE          48260000
482700              AND A.ORD_LNE_NBR      = B.ORD_LNE_NBR              48270000
482800              AND A.RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR            48280000
482900              AND A.RCVR_SEQ_NBR     = B.RCVR_SEQ_NBR             48290000
483000              AND B.STR_NBR          = :DK-STR-NBR                48300000
483100     END-EXEC.                                                    48310000
483200                                                                  48320000
483300     EVALUATE TRUE                                                48330000
483400         WHEN SQLCODE = ZERO                                      48340000
483500         WHEN SQLCODE = +100                                      48350000
483600              CONTINUE                                            48360000
483700         WHEN SQLCODE = -904                                      48370000
483800         WHEN SQLCODE = -911                                      48380000
483900         WHEN SQLCODE = -913                                      48390000
484000             PERFORM 9900-SOFT-ABORT                              48400000
484100         WHEN SQLWARN0 NOT = SPACES                               48410000
484200         WHEN SQLCODE  NOT = ZERO                                 48420000
484300             MOVE '7060-GET-TDISTDT'                              48430000
484400                                 TO DP013-PARAGRAPH               48440000
484500             MOVE 'UNSUCCESSFUL SELECT OF TDISTDT'                48450000
484600                                 TO DP013-MESSAGE-TEXT (1)        48460000
484700             MOVE SQLCA         TO DP013-SQLCA                    48470000
484800             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              48480000
484900             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         48490000
485000             MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR             48500000
485100             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             48510000
485200             STRING ' PO = '                                      48520000
485300                    PV-DISP-PO-NBR                                48530000
485400                    ' RECV ='                                     48540000
485500                    PV-DISP-REC-SEQ-NBR                           48550000
485600                    ' LINE = '                                    48560000
485700                    PV-DISP-LNE-NBR                               48570000
485800                    ' STR = '                                     48580000
485900                    PV-DISP-STR-NBR                               48590000
486000                                        DELIMITED BY SIZE         48600000
486100                             INTO DP013-MESSAGE-TEXT (2)          48610000
486200             MOVE SQLCA        TO DP013-SQLCA                     48620000
486300             MOVE 'TDISTDT'     TO DP013-DB2-TABLE-NAME (1)       48630000
486400             SET DP013-DB2-ABEND                                  48640000
486500                 DP013-XCTL-DISPLAY-RESTART                       48650000
486600                                 TO TRUE                          48660000
486700                                                                  48670000
486800             PERFORM DP013-0000-PROCESS-ABEND                     48680000
486900     END-EVALUATE.                                                48690000
487000                                                                  48700000
487100 7070-OPEN-TRECDVS.                                               48710000
487200                                                                  48720000
487300     MOVE ASC-PO-NBR             TO  DK-PO-NBR.                   48730000
487400     MOVE ASC-REC-SEQ-NBR        TO  DK-REC-SEQ-NBR.              48740000
487500                                                                  48750000
487600     EXEC SQL                                                     48760000
487700          OPEN RECDVS-CURSOR                                      48770000
487800     END-EXEC                                                     48780000
487900                                                                  48790000
488000     EVALUATE TRUE                                                48800000
488100         WHEN SQLCODE = ZERO                                      48810000
488200              CONTINUE                                            48820000
488300         WHEN SQLCODE = -904                                      48830000
488400         WHEN SQLCODE = -911                                      48840000
488500         WHEN SQLCODE = -913                                      48850000
488600             PERFORM 9900-SOFT-ABORT                              48860000
488700         WHEN SQLWARN0 NOT = SPACES                               48870000
488800         WHEN SQLCODE      NOT = ZERO                             48880000
488900              MOVE '7070-OPEN-TRECDVS'                            48890000
489000                             TO DP013-PARAGRAPH                   48900000
489100              MOVE 'UNSUCCESSFUL RECDVS CURSOR OPEN'              48910000
489200                             TO DP013-MESSAGE-TEXT (1)            48920000
489300              MOVE SQLCA         TO DP013-SQLCA                   48930000
489400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             48940000
489500              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        48950000
489600              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            48960000
489700              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            48970000
489800              STRING ' PO = '                                     48980000
489900                     PV-DISP-PO-NBR                               48990000
490000                     ' RECV ='                                    49000000
490100                     PV-DISP-REC-SEQ-NBR                          49010000
490200                     ' LINE = '                                   49020000
490300                     PV-DISP-LNE-NBR                              49030000
490400                     ' STR = '                                    49040000
490500                     PV-DISP-STR-NBR                              49050000
490600                                         DELIMITED BY SIZE        49060000
490700                              INTO DP013-MESSAGE-TEXT (2)         49070000
490800              MOVE SQLCA        TO DP013-SQLCA                    49080000
490900              MOVE 'TRECDVS' TO DP013-DB2-TABLE-NAME (1)          49090000
491000              SET DP013-XCTL-DISPLAY-RESTART                      49100000
491100                  DP013-DB2-ABEND                                 49110000
491200                             TO TRUE                              49120000
491300                                                                  49130000
491400              PERFORM DP013-0000-PROCESS-ABEND                    49140000
491500     END-EVALUATE.                                                49150000
491600/                                                                 49160000
491700 7075-FETCH-RECDVS.                                               49170000
491800                                                                  49180000
491900     EXEC SQL                                                     49190000
492000           FETCH RECDVS-CURSOR                                    49200000
492100            INTO :RECDVS-VRFY-SRC-CDE                             49210000
492200                ,:RECDVS-EXPTED-ITM-QTY                           49220000
492300                ,:RECDVS-VRFY-ITM-QTY                             49230000
492400     END-EXEC.                                                    49240000
492500                                                                  49250000
492600     EVALUATE TRUE                                                49260000
492700         WHEN SQLCODE = ZERO                                      49270000
492800             ADD 1 TO PV-RECDVS-COUNT                             49280000
492900         WHEN SQLCODE = +100                                      49290000
493000             SET ASC-NO-MORE-RECDVS  TO TRUE                      49300000
493100         WHEN SQLCODE = -904                                      49310000
493200         WHEN SQLCODE = -911                                      49320000
493300         WHEN SQLCODE = -913                                      49330000
493400             PERFORM 9900-SOFT-ABORT                              49340000
493500         WHEN SQLWARN0 NOT = SPACES                               49350000
493600         WHEN SQLCODE  NOT = ZERO                                 49360000
493700              MOVE '7075-FETCH-RECDVS'                            49370000
493800                                 TO DP013-PARAGRAPH               49380000
493900              MOVE 'UNSUCCESSFUL FETCH OF RECDVS CURSOR'          49390000
494000                                 TO DP013-MESSAGE-TEXT (1)        49400000
494100              MOVE SQLCA         TO DP013-SQLCA                   49410000
494200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             49420000
494300              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        49430000
494400              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            49440000
494500              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            49450000
494600              STRING ' PO = '                                     49460000
494700                     PV-DISP-PO-NBR                               49470000
494800                     ' RECV ='                                    49480000
494900                     PV-DISP-REC-SEQ-NBR                          49490000
495000                     ' LINE = '                                   49500000
495100                     PV-DISP-LNE-NBR                              49510000
495200                     ' STR = '                                    49520000
495300                     PV-DISP-STR-NBR                              49530000
495400                                         DELIMITED BY SIZE        49540000
495500                              INTO DP013-MESSAGE-TEXT (2)         49550000
495600              MOVE SQLCA        TO DP013-SQLCA                    49560000
495700              MOVE 'TRECDVS' TO DP013-DB2-TABLE-NAME (1)          49570000
495800              SET DP013-DB2-ABEND                                 49580000
495900                  DP013-XCTL-DISPLAY-RESTART                      49590000
496000                                 TO TRUE                          49600000
496100                                                                  49610000
496200              PERFORM DP013-0000-PROCESS-ABEND                    49620000
496300     END-EVALUATE.                                                49630000
496400/                                                                 49640000
496500 7080-CLOSE-TRECDVS.                                              49650000
496600                                                                  49660000
496700     EXEC SQL                                                     49670000
496800          CLOSE RECDVS-CURSOR                                     49680000
496900     END-EXEC.                                                    49690000
497000                                                                  49700000
497100     EVALUATE TRUE                                                49710000
497200         WHEN SQLCODE = ZERO                                      49720000
497300              CONTINUE                                            49730000
497400         WHEN SQLCODE = -904                                      49740000
497500         WHEN SQLCODE = -911                                      49750000
497600         WHEN SQLCODE = -913                                      49760000
497700             PERFORM 9900-SOFT-ABORT                              49770000
497800         WHEN SQLWARN0 NOT = SPACES                               49780000
497900         WHEN SQLCODE  NOT = ZERO                                 49790000
498000              MOVE '7080-CLOSE-TRECDVS'                           49800000
498100                                 TO DP013-PARAGRAPH               49810000
498200              MOVE 'UNSUCCESSFUL RECDVS CURSOR CLOSE'             49820000
498300                                 TO DP013-MESSAGE-TEXT (1)        49830000
498400              MOVE SQLCA         TO DP013-SQLCA                   49840000
498500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             49850000
498600              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        49860000
498700              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            49870000
498800              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            49880000
498900              STRING ' PO = '                                     49890000
499000                     PV-DISP-PO-NBR                               49900000
499100                     ' RECV ='                                    49910000
499200                     PV-DISP-REC-SEQ-NBR                          49920000
499300                     ' LINE = '                                   49930000
499400                     PV-DISP-LNE-NBR                              49940000
499500                     ' STR = '                                    49950000
499600                     PV-DISP-STR-NBR                              49960000
499700                                         DELIMITED BY SIZE        49970000
499800                              INTO DP013-MESSAGE-TEXT (2)         49980000
499900              MOVE SQLCA        TO DP013-SQLCA                    49990000
500000              MOVE 'TRECDVS' TO DP013-DB2-TABLE-NAME (1)          50000000
500100              SET DP013-DB2-ABEND                                 50010000
500200                  DP013-XCTL-DISPLAY-RESTART                      50020000
500300                                 TO TRUE                          50030000
500400                                                                  50040000
500500              PERFORM DP013-0000-PROCESS-ABEND                    50050000
500600     END-EVALUATE.                                                50060000
500700                                                                  50070000
500800                                                                  50080000
500900 7090-COUNT-SMOOTHED-CTNS.                                        50090000
501000                                                                  50100000
501100     MOVE ZERO                   TO PV-DB2-COUNT.                 50110000
501200     MOVE ASC-STR-NBR            TO DK-STR-NBR.                   50120000
501300     MOVE ASC-PO-NBR             TO DK-PO-NBR.                    50130000
501400     MOVE ASC-REC-SEQ-NBR        TO DK-REC-SEQ-NBR.               50140000
501500                                                                  50150000
501600     EXEC SQL                                                     50160000
501700         SELECT COUNT(DISTINCT(UPC.SHIPT_UNT_ID))                 50170000
501800         INTO :PV-DB2-COUNT                                       50180000
501900         FROM SUT_OTBND_UPC UPC                                   50190000
502000            , SUT_OTBND_CART UNT                                  50200000
502100         WHERE UPC.TRN_NBR              = :DK-PO-NBR              50210000
502200          AND  UPC.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR         50220000
502300          AND  UPC.SHIPT_UNT_ID         =  UNT.SHIPT_UNT_ID       50230000
502400          AND  UNT.DEST_LOC_NBR         =  :DK-STR-NBR            50240000
502500          AND  UNT.CART_SRC_CDE         =  'SMO'                  50250000
502600          AND  UNT.ACTV_IND             =  'Y'                    50260000
502700     END-EXEC.                                                    50270000
502800                                                                  50280000
502900     EVALUATE TRUE                                                50290000
503000         WHEN SQLCODE = ZERO                                      50300000
503100         WHEN SQLCODE = +100                                      50310000
503200             CONTINUE                                             50320000
503300         WHEN SQLCODE = -904                                      50330000
503400         WHEN SQLCODE = -913                                      50340000
503500         WHEN SQLCODE = -911                                      50350000
503600             PERFORM 9900-SOFT-ABORT                              50360000
503700         WHEN SQLWARN0 NOT = SPACES                               50370000
503800         WHEN SQLCODE < ZERO                                      50380000
503900         WHEN SQLCODE > ZERO                                      50390000
504000             MOVE '7090-COUNT-SMOOTHED-CTNS'                      50400000
504100                               TO DP013-PARAGRAPH                 50410000
504200             MOVE 'COUNT SMOOTHED CARTONS FOR PO/RCVR/STR'        50420000
504300                               TO DP013-MESSAGE-TEXT (1)          50430000
504400             MOVE ASC-PO-NBR             TO PV-DISP-PO-NBR        50440000
504500             MOVE ASC-REC-SEQ-NBR        TO PV-DISP-REC-SEQ-NBR   50450000
504600             STRING 'STR '                                        50460000
504700                    ASC-STR-NBR                                   50470000
504800                    ' PO '                                        50480000
504900                    PV-DISP-PO-NBR                                50490000
505000                    ' REC '                                       50500000
505100                    PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE         50510000
505200                             INTO DP013-MESSAGE-TEXT (2)          50520000
505300             MOVE SQLCA        TO DP013-SQLCA                     50530000
505400             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        50540000
505500             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        50550000
505600             SET DP013-DB2-ABEND                                  50560000
505700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50570000
505800             PERFORM DP013-0000-PROCESS-ABEND                     50580000
505900     END-EVALUATE.                                                50590000
506000                                                                  50600000
506100                                                                  50610000
506110 7220-GET-RECDIS-QTY.                                             50611000
506120                                                                  50612000
506130     EXEC SQL                                                     50613000
506140          SELECT                                                  50614000
506150                 SUM(C.AP_VERIFY_ITM_QTY)                         50615000
506160           INTO                                                   50616000
506170                 :PV-RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND        50617000
506180           FROM                                                   50618000
506190                 TRECEIV A                                        50619000
506191               , TRECITM B                                        50619100
506192               , TRECDIS C                                        50619200
506193           WHERE                                                  50619300
506194                 A.ORD_NBR         =  :DK-PO-NBR                  50619400
506195            AND  A.ORD_NBR         =  B.ORD_NBR                   50619500
506196            AND  A.ORD_NBR         =  C.ORD_NBR                   50619600
506197            AND  B.ORD_LNE_NBR     =  :DK-LNE-NBR                 50619700
506198            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               50619800
506199            AND  A.VER_STATUS_CDE  =  'A'                         50619900
506200            AND  B.VER_STATUS_CDE  =  'A'                         50620000
506202            AND  B.STATUS_CDE      =  'VE'                        50620200
506203            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               50620300
506204            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               50620400
506205     END-EXEC.                                                    50620500
506206                                                                  50620600
506207     EVALUATE TRUE                                                50620700
506208         WHEN SQLCODE = ZERO                                      50620800
506209         WHEN SQLCODE = +100                                      50620900
506210              CONTINUE                                            50621000
506211         WHEN SQLCODE = -904                                      50621100
506212         WHEN SQLCODE = -911                                      50621200
506213         WHEN SQLCODE = -913                                      50621300
506214             PERFORM 9900-SOFT-ABORT                              50621400
506215         WHEN SQLWARN0 NOT = SPACE                                50621500
506216         WHEN SQLCODE NOT = ZERO                                  50621600
506217              MOVE '7220-GET-RECDIS-QTY'                          50621700
506218                               TO DP013-PARAGRAPH                 50621800
506219              MOVE 'SUM RECDIS VERIFY QUANTITY'                   50621900
506220                               TO DP013-MESSAGE-TEXT (1)          50622000
506221              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        50622100
506222              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50622200
506223              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 50622300
506224              MOVE SQLCA       TO DP013-SQLCA                     50622400
506225              STRING ' PO = '                                     50622500
506226                     PV-DISP-PO-NBR                               50622600
506227                     ' LINE ='                                    50622700
506228                     PV-DISP-LNE-NBR                              50622800
506229                                         DELIMITED BY SIZE        50622900
506230                              INTO DP013-MESSAGE-TEXT (2)         50623000
506231              SET DP013-DB2-ABEND                                 50623100
506232                               TO TRUE                            50623200
506233              PERFORM DP013-0000-PROCESS-ABEND                    50623300
506234     END-EVALUATE.                                                50623400
506235                                                                  50623500
506236 7500-GET-PURITM.                                                 50623600
506237                                                                  50623700
506238     EXEC SQL                                                     50623800
506239          SELECT                                                  50623900
506240                  PO_NBR                                          50624000
506241                , VER_NBR                                         50624100
506242                , PO_LNE_NBR                                      50624200
506243                , VER_STATUS_CDE                                  50624300
506244                , SKU_SEQ_NBR                                     50624400
506245                , CL_NBR                                          50624500
506246                , VEND_STYL_NAME                                  50624600
506247                , COLOR_DESC                                      50624700
506248                , SIZE_DESC                                       50624800
506249                , UM_IND                                          50624900
506250                , UNT_QTY                                         50625000
506251                , UNT_RTL_PR_AMT                                  50625100
506252                , UNT_COST_AMT                                    50625200
506253                , TOT_VAL_COST_AMT                                50625300
506254                , TOT_VAL_RTL_AMT                                 50625400
506255                , MU_PCT                                          50625500
506256                , CRE_TMST                                        50625600
506257                , LAST_UPD_TMST                                   50625700
506258                , ITM_NBR                                         50625800
506259                , SKU_DESC                                        50625900
506260                , COLOR_CDE                                       50626000
506261                , SIZE_CDE                                        50626100
506262                , AD_EVNT_DTE                                     50626200
506263                , STATUS_CDE                                      50626300
506264                , CRE_BY_UID                                      50626400
506265                , LAST_UPD_BY_UID                                 50626500
506266                , GP_RTL_AMT                                      50626600
506267                , GP_QTY                                          50626700
506268                , APP_PO_LNE_NBR                                  50626800
506269                , PIC_ITM_IND                                     50626900
506270                , PIC_PG_NBR                                      50627000
506271                , PRD_1ST_COST_AMT                                50627100
506272                , PO_PREPK_ID                                     50627200
506273                , PREPK_RATO_QTY                                  50627300
506274                , SHIP_TO_TMP_DC_IND                              50627400
506275                , RMS_PO_SKU_NBR                                  50627500
506276                , CNCLD_UNT_QTY                                   50627600
506277           INTO                                                   50627700
506278                  :PURITM-PO-NBR                                  50627800
506279                , :PURITM-VER-NBR                                 50627900
506280                , :PURITM-PO-LNE-NBR                              50628000
506281                , :PURITM-VER-STATUS-CDE                          50628100
506282                , :PURITM-SKU-SEQ-NBR                             50628200
506283                , :PURITM-CL-NBR                                  50628300
506284                , :PURITM-VEND-STYL-NAME                          50628400
506285                , :PURITM-COLOR-DESC                              50628500
506286                , :PURITM-SIZE-DESC                               50628600
506287                , :PURITM-UM-IND                                  50628700
506288                , :PURITM-UNT-QTY                                 50628800
506289                , :PURITM-UNT-RTL-PR-AMT                          50628900
506290                , :PURITM-UNT-COST-AMT                            50629000
506291                , :PURITM-TOT-VAL-COST-AMT                        50629100
506292                , :PURITM-TOT-VAL-RTL-AMT                         50629200
506293                , :PURITM-MU-PCT                                  50629300
506294                , :PURITM-CRE-TMST                                50629400
506295                , :PURITM-LAST-UPD-TMST                           50629500
506296                , :PURITM-ITM-NBR                                 50629600
506297                , :PURITM-SKU-DESC                                50629700
506298                , :PURITM-COLOR-CDE                               50629800
506299                , :PURITM-SIZE-CDE                                50629900
506300                , :PURITM-AD-EVNT-DTE                             50630000
506301                , :PURITM-STATUS-CDE                              50630100
506302                , :PURITM-CRE-BY-UID                              50630200
506303                , :PURITM-LAST-UPD-BY-UID                         50630300
506304                , :PURITM-GP-RTL-AMT                              50630400
506305                , :PURITM-GP-QTY                                  50630500
506306                , :PURITM-APP-PO-LNE-NBR                          50630600
506307                , :PURITM-PIC-ITM-IND                             50630700
506308                , :PURITM-PIC-PG-NBR                              50630800
506309                , :PURITM-PRD-1ST-COST-AMT                        50630900
506310                , :PURITM-PO-PREPK-ID                             50631000
506311                , :PURITM-PREPK-RATO-QTY                          50631100
506312                , :PURITM-SHIP-TO-TMP-DC-IND                      50631200
506313                , :PURITM-RMS-PO-SKU-NBR                          50631300
506314                , :PURITM-CNCLD-UNT-QTY                           50631400
506315           FROM                                                   50631500
506316                  TPURITM                                         50631600
506317          WHERE                                                   50631700
506318                  PO_NBR             =  :DK-PO-NBR                50631800
506319           AND    APP_PO_LNE_NBR     =  :DK-LNE-NBR               50631900
506320           AND    VER_STATUS_CDE     =  'A'                       50632000
506321     END-EXEC.                                                    50632100
506322                                                                  50632200
506323     EVALUATE TRUE                                                50632300
506324         WHEN SQLCODE = ZERO                                      50632400
506325         WHEN SQLCODE = +100                                      50632500
506326              CONTINUE                                            50632600
506327         WHEN SQLCODE = -904                                      50632700
506328         WHEN SQLCODE = -911                                      50632800
506329         WHEN SQLCODE = -913                                      50632900
506330             PERFORM 9900-SOFT-ABORT                              50633000
506331         WHEN SQLWARN0 NOT = SPACE                                50633100
506332         WHEN SQLCODE NOT = ZERO                                  50633200
506333              MOVE '7500-GET-PURITM'                              50633300
506334                               TO DP013-PARAGRAPH                 50633400
506335              MOVE 'SUM RECDIS VERIFY QUANTITY'                   50633500
506336                               TO DP013-MESSAGE-TEXT (1)          50633600
506337              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50633700
506338              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50633800
506339              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 50633900
506340              STRING ' PO = '                                     50634000
506341                     PV-DISP-PO-NBR                               50634100
506342                     ' LINE ='                                    50634200
506343                     PV-DISP-LNE-NBR                              50634300
506344                                         DELIMITED BY SIZE        50634400
506345                              INTO DP013-MESSAGE-TEXT (2)         50634500
506346              MOVE SQLCA       TO DP013-SQLCA                     50634600
506347              SET DP013-DB2-ABEND                                 50634700
506348                               TO TRUE                            50634800
506349              PERFORM DP013-0000-PROCESS-ABEND                    50634900
506350     END-EVALUATE.                                                50635000
506351/                                                                 50635100
506352 7510-UPDATE-PURITM.                                              50635200
506353                                                                  50635300
506354     EXEC SQL                                                     50635400
506355          UPDATE                                                  50635500
506356                 TPURITM                                          50635600
506357          SET    VER_STATUS_CDE   =  'I'                          50635700
506358          WHERE                                                   50635800
506359                 PO_NBR           =  :DK-PO-NBR                   50635900
506360          AND    APP_PO_LNE_NBR   =  :DK-LNE-NBR                  50636000
506361          AND    VER_STATUS_CDE   =  'A'                          50636100
506362     END-EXEC.                                                    50636200
506363                                                                  50636300
506364     EVALUATE TRUE                                                50636400
506365         WHEN SQLCODE = ZERO                                      50636500
506366              CONTINUE                                            50636600
506367         WHEN SQLCODE = -904                                      50636700
506368         WHEN SQLCODE = -911                                      50636800
506369         WHEN SQLCODE = -913                                      50636900
506370             SET PS-UPDATES-DONE TO TRUE                          50637000
506371             PERFORM 9900-SOFT-ABORT                              50637100
506372         WHEN SQLWARN0 NOT = SPACE                                50637200
506373         WHEN SQLCODE NOT = ZERO                                  50637300
506374              MOVE '7510-UPDATE-PURITM'                           50637400
506375                               TO DP013-PARAGRAPH                 50637500
506376              MOVE 'SET CURRENT ROW TO INACTIVE'                  50637600
506377                               TO DP013-MESSAGE-TEXT (1)          50637700
506378              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50637800
506379              MOVE SQLCA       TO DP013-SQLCA                     50637900
506380              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50638000
506381              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 50638100
506382              STRING ' PO = '                                     50638200
506383                     PV-DISP-PO-NBR                               50638300
506384                     ' LINE ='                                    50638400
506385                     PV-DISP-LNE-NBR                              50638500
506386                                         DELIMITED BY SIZE        50638600
506387                              INTO DP013-MESSAGE-TEXT (2)         50638700
506388              SET DP013-DB2-ABEND                                 50638800
506389                               TO TRUE                            50638900
506390              PERFORM DP013-0000-PROCESS-ABEND                    50639000
506391     END-EVALUATE.                                                50639100
506392/                                                                 50639200
506393 7520-INSERT-PURITM.                                              50639300
506394                                                                  50639400
506395     EXEC SQL                                                     50639500
506396          INSERT                                                  50639600
506397           INTO   TPURITM                                         50639700
506398                 (PO_NBR                                          50639800
506399                , VER_NBR                                         50639900
506400                , PO_LNE_NBR                                      50640000
506401                , VER_STATUS_CDE                                  50640100
506402                , SKU_SEQ_NBR                                     50640200
506403                , CL_NBR                                          50640300
506404                , VEND_STYL_NAME                                  50640400
506405                , COLOR_DESC                                      50640500
506406                , SIZE_DESC                                       50640600
506407                , UM_IND                                          50640700
506408                , UNT_QTY                                         50640800
506409                , UNT_RTL_PR_AMT                                  50640900
506410                , UNT_COST_AMT                                    50641000
506411                , TOT_VAL_COST_AMT                                50641100
506412                , TOT_VAL_RTL_AMT                                 50641200
506413                , MU_PCT                                          50641300
506414                , CRE_TMST                                        50641400
506415                , LAST_UPD_TMST                                   50641500
506416                , ITM_NBR                                         50641600
506417                , SKU_DESC                                        50641700
506418                , COLOR_CDE                                       50641800
506419                , SIZE_CDE                                        50641900
506420                , AD_EVNT_DTE                                     50642000
506421                , STATUS_CDE                                      50642100
506422                , CRE_BY_UID                                      50642200
506423                , LAST_UPD_BY_UID                                 50642300
506424                , GP_RTL_AMT                                      50642400
506425                , GP_QTY                                          50642500
506426                , APP_PO_LNE_NBR                                  50642600
506427                , PIC_ITM_IND                                     50642700
506428                , PIC_PG_NBR                                      50642800
506429                , PRD_1ST_COST_AMT                                50642900
506430                , STAT_TMST                                       50643000
506431                , PO_PREPK_ID                                     50643100
506432                , PREPK_RATO_QTY                                  50643200
506433                , SHIP_TO_TMP_DC_IND                              50643300
506434                , RMS_PO_SKU_NBR                                  50643400
506435                , CNCLD_UNT_QTY                                   50643500
506436                  )                                               50643600
506437          VALUES                                                  50643700
506438                 (:PURITM-PO-NBR                                  50643800
506439                , :PURITM-VER-NBR                                 50643900
506440                , :PURITM-PO-LNE-NBR                              50644000
506441                , 'A'                                             50644100
506442                , :PURITM-SKU-SEQ-NBR                             50644200
506443                , :PURITM-CL-NBR                                  50644300
506444                , :PURITM-VEND-STYL-NAME                          50644400
506445                , :PURITM-COLOR-DESC                              50644500
506446                , :PURITM-SIZE-DESC                               50644600
506447                , :PURITM-UM-IND                                  50644700
506448                , :PURITM-UNT-QTY                                 50644800
506449                , :PURITM-UNT-RTL-PR-AMT                          50644900
506450                , :PURITM-UNT-COST-AMT                            50645000
506451                , :PURITM-TOT-VAL-COST-AMT                        50645100
506452                , :PURITM-TOT-VAL-RTL-AMT                         50645200
506453                , :PURITM-MU-PCT                                  50645300
506454                , :PURITM-CRE-TMST                                50645400
506455                ,  CURRENT TIMESTAMP                              50645500
506456                , :PURITM-ITM-NBR                                 50645600
506457                , :PURITM-SKU-DESC                                50645700
506458                , :PURITM-COLOR-CDE                               50645800
506459                , :PURITM-SIZE-CDE                                50645900
506460                , :PURITM-AD-EVNT-DTE                             50646000
506461                , :PV-PURITM-STATUS-CDE                           50646100
506462                , :PURITM-CRE-BY-UID                              50646200
506463                , :DP020-USERID                                   50646300
506464                , :PURITM-GP-RTL-AMT                              50646400
506465                , :PURITM-GP-QTY                                  50646500
506466                , :PURITM-APP-PO-LNE-NBR                          50646600
506467                , :PURITM-PIC-ITM-IND                             50646700
506468                , :PURITM-PIC-PG-NBR                              50646800
506469                , :PURITM-PRD-1ST-COST-AMT                        50646900
506470                , CURRENT TIMESTAMP                               50647000
506471                , :PURITM-PO-PREPK-ID                             50647100
506472                , :PURITM-PREPK-RATO-QTY                          50647200
506473                , :PURITM-SHIP-TO-TMP-DC-IND                      50647300
506474                , :PURITM-RMS-PO-SKU-NBR                          50647400
506475                , :PURITM-CNCLD-UNT-QTY                           50647500
506476                  )                                               50647600
506477     END-EXEC.                                                    50647700
506478                                                                  50647800
506479     EVALUATE TRUE                                                50647900
506480         WHEN SQLCODE = ZERO                                      50648000
506481              CONTINUE                                            50648100
506482         WHEN SQLCODE = -904                                      50648200
506483         WHEN SQLCODE = -911                                      50648300
506484         WHEN SQLCODE = -913                                      50648400
506485             SET PS-UPDATES-DONE TO TRUE                          50648500
506486             PERFORM 9900-SOFT-ABORT                              50648600
506487         WHEN SQLWARN0 NOT = SPACE                                50648700
506488         WHEN SQLCODE NOT = ZERO                                  50648800
506489              MOVE '7520-INSERT-PURITM'                           50648900
506490                               TO DP013-PARAGRAPH                 50649000
506491              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              50649100
506492                               TO DP013-MESSAGE-TEXT (1)          50649200
506493              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50649300
506494              MOVE SQLCA       TO DP013-SQLCA                     50649400
506495              MOVE PURITM-PO-NBR     TO PV-DISP-PO-NBR            50649500
506496              MOVE PURITM-PO-LNE-NBR TO PV-DISP-LNE-NBR           50649600
506497              STRING ' PO = '                                     50649700
506498                     PV-DISP-PO-NBR                               50649800
506499                     ' LINE ='                                    50649900
506500                     PV-DISP-LNE-NBR                              50650000
506501                                         DELIMITED BY SIZE        50650100
506502                              INTO DP013-MESSAGE-TEXT (2)         50650200
506503              SET DP013-DB2-ABEND                                 50650300
506504                               TO TRUE                            50650400
506505              PERFORM DP013-0000-PROCESS-ABEND                    50650500
506506     END-EVALUATE.                                                50650600
506507/                                                                 50650700
506508 7530-ONLY-UPDATE-PURITM.                                         50650800
506509                                                                  50650900
506510     EXEC SQL                                                     50651000
506511          UPDATE                                                  50651100
506512                 TPURITM                                          50651200
506513          SET    STATUS_CDE       =  :PV-PURITM-STATUS-CDE        50651300
506514               , STAT_TMST        =  CURRENT TIMESTAMP            50651400
506515          WHERE                                                   50651500
506516                 PO_NBR           =  :DK-PO-NBR                   50651600
506517          AND    APP_PO_LNE_NBR   =  :DK-LNE-NBR                  50651700
506518          AND    VER_STATUS_CDE   =  'A'                          50651800
506519     END-EXEC.                                                    50651900
506520                                                                  50652000
506521     EVALUATE TRUE                                                50652100
506522         WHEN SQLCODE = ZERO                                      50652200
506523              CONTINUE                                            50652300
506524         WHEN SQLCODE = -904                                      50652400
506525         WHEN SQLCODE = -911                                      50652500
506526         WHEN SQLCODE = -913                                      50652600
506527             SET PS-UPDATES-DONE TO TRUE                          50652700
506528             PERFORM 9900-SOFT-ABORT                              50652800
506529         WHEN SQLWARN0 NOT = SPACE                                50652900
506530         WHEN SQLCODE NOT = ZERO                                  50653000
506531              MOVE '7530-ONLY-UPDATE-PURITM'                      50653100
506532                               TO DP013-PARAGRAPH                 50653200
506533              MOVE 'SET CURRENT ROW TO INACTIVE'                  50653300
506534                               TO DP013-MESSAGE-TEXT (1)          50653400
506535              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50653500
506536              MOVE SQLCA       TO DP013-SQLCA                     50653600
506537              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50653700
506538              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 50653800
506539              STRING ' PO = '                                     50653900
506540                     PV-DISP-PO-NBR                               50654000
506541                     ' LINE ='                                    50654100
506542                     PV-DISP-LNE-NBR                              50654200
506543                                         DELIMITED BY SIZE        50654300
506544                              INTO DP013-MESSAGE-TEXT (2)         50654400
506545              SET DP013-DB2-ABEND                                 50654500
506546                               TO TRUE                            50654600
506547              PERFORM DP013-0000-PROCESS-ABEND                    50654700
506548     END-EVALUATE.                                                50654800
506549                                                                  50654900
506550 7600-COUNT-PO-LINE-ROWS.                                         50655000
506551                                                                  50655100
506552     MOVE ZERO            TO  PV-DB2-COUNT.                       50655200
506553     EXEC SQL                                                     50655300
506554          SELECT                                                  50655400
506555                COUNT(*)                                          50655500
506556          INTO                                                    50655600
506557                :PV-DB2-COUNT :PV-NULL-IND                        50655700
506558          FROM                                                    50655800
506559                TPURITM                                           50655900
506560          WHERE                                                   50656000
506561                PO_NBR             =  :DK-PO-NBR                  50656100
506562          AND   VER_STATUS_CDE     =  'A'                         50656200
506563          AND  (STATUS_CDE        ^=  'CM'                        50656300
506564           AND  STATUS_CDE        ^=  'CB'                        50656400
506565           AND  STATUS_CDE        ^=  'CA')                       50656500
506566     END-EXEC.                                                    50656600
506567                                                                  50656700
506568     EVALUATE TRUE                                                50656800
506569         WHEN SQLCODE = ZERO                                      50656900
506570         WHEN SQLCODE = +100                                      50657000
506571              CONTINUE                                            50657100
506572         WHEN SQLCODE = -904                                      50657200
506573         WHEN SQLCODE = -911                                      50657300
506574         WHEN SQLCODE = -913                                      50657400
506575             PERFORM 9900-SOFT-ABORT                              50657500
506576         WHEN SQLWARN0 NOT = SPACE                                50657600
506577         WHEN SQLCODE NOT = ZERO                                  50657700
506578              MOVE '7600-COUNT-PO-LINE-ROWS'                      50657800
506579                               TO DP013-PARAGRAPH                 50657900
506580              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 50658000
506581                               TO DP013-MESSAGE-TEXT (1)          50658100
506582              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50658200
506583              MOVE SQLCA       TO DP013-SQLCA                     50658300
506584              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50658400
506585              STRING ' PO = '                                     50658500
506586                     PV-DISP-PO-NBR                               50658600
506587                                         DELIMITED BY SIZE        50658700
506588                              INTO DP013-MESSAGE-TEXT (2)         50658800
506589              SET DP013-DB2-ABEND                                 50658900
506590                               TO TRUE                            50659000
506591              PERFORM DP013-0000-PROCESS-ABEND                    50659100
506592     END-EVALUATE.                                                50659200
506593/                                                                 50659300
506594 7610-GET-TPURCHS-STATUS.                                         50659400
506595                                                                  50659500
506596     EXEC SQL                                                     50659600
506597          SELECT                                                  50659700
506598                  PO_NBR                                          50659800
506599                , VER_NBR                                         50659900
506600                , VER_STATUS_CDE                                  50660000
506601                , PO_TYP_CDE                                      50660100
506602                , PO_CATEG_CDE                                    50660200
506603                , EDI_IND                                         50660300
506604                , TOT_UNT_QTY                                     50660400
506605                , TOT_VAL_COST_AMT                                50660500
506606                , TOT_VAL_RTL_AMT                                 50660600
506607                , TOT_MU_PCT                                      50660700
506608                , TOT_SKUS_QTY                                    50660800
506609                , IMPRT_AGNT_PO_NBR                               50660900
506610                , IMPRT_ORD_OFF_NAME                              50661000
506611                , IMPRT_VEND_NAME                                 50661100
506612                , IMPRT_FCTRY_NAME                                50661200
506613                , IMPRT_CNTRY_NAME                                50661300
506614                , VEND_CNTRY_NAME                                 50661400
506615                , NEW_STR_PO_IND                                  50661500
506616                , IMPRT_PO_IND                                    50661600
506617                , IMPRT_AGNT_PO_IND                               50661700
506618                , STATUS_TMST                                     50661800
506619                , LAST_UPD_TMST                                   50661900
506620                , EDI_REXMIT_IND                                  50662000
506621                , EDI_REXMIT_TMST                                 50662100
506622                , DIR_STR_IND                                     50662200
506623                , LAST_UPD_BY_UID                                 50662300
506624                , APP_BY_UID                                      50662400
506625                , OTB_PER_NBR                                     50662500
506626                , DEPT_NBR                                        50662600
506627                , ENT_ID                                          50662700
506628                , STATUS_CDE                                      50662800
506629                , CRE_BY_UID                                      50662900
506630                , REJ_CT                                          50663000
506631                , REJ_UID                                         50663100
506632                , ORD_DTE                                         50663200
506633                , REVISION_CT                                     50663300
506634                , ADR_SEQ_NBR                                     50663400
506635                , DEST_KNOWN_IND                                  50663500
506636                , RLSE_IND                                        50663600
506637                , RLSE_DTE                                        50663700
506638                , PLCMNT_CNTRY_CDE                                50663800
506639                , PROD_CNTRY_CDE                                  50663900
506640                , UNT_PER_CBMT_QTY                                50664000
506641                , CRE_TMST                                        50664100
506642                , PRG_LAST_ACTVY_DTE                              50664200
506643                , PKGNG_CDE                                       50664300
506644                , SEASET_YR                                       50664400
506645                , SEASET_SHRT_NM                                  50664500
506646                , QTA_CTG_CDE                                     50664600
506647                , PO_IN_RMS_IND                                   50664700
506648                , RMS_PO_UPD_TMST                                 50664800
506649                , DUP_SKU_IND                                     50664900
506650                , ORIG_PKGNG_CDE                                  50665000
506651           INTO                                                   50665100
506652                 :PURCHS-PO-NBR                                   50665200
506653                ,:PURCHS-VER-NBR                                  50665300
506654                ,:PURCHS-VER-STATUS-CDE                           50665400
506655                ,:PURCHS-PO-TYP-CDE                               50665500
506656                ,:PURCHS-PO-CATEG-CDE                             50665600
506657                ,:PURCHS-EDI-IND                                  50665700
506658                ,:PURCHS-TOT-UNT-QTY                              50665800
506659                ,:PURCHS-TOT-VAL-COST-AMT                         50665900
506660                ,:PURCHS-TOT-VAL-RTL-AMT                          50666000
506661                ,:PURCHS-TOT-MU-PCT                               50666100
506662                ,:PURCHS-TOT-SKUS-QTY                             50666200
506663                ,:PURCHS-IMPRT-AGNT-PO-NBR                        50666300
506664                ,:PURCHS-IMPRT-ORD-OFF-NAME                       50666400
506665                ,:PURCHS-IMPRT-VEND-NAME                          50666500
506666                ,:PURCHS-IMPRT-FCTRY-NAME                         50666600
506667                ,:PURCHS-IMPRT-CNTRY-NAME                         50666700
506668                ,:PURCHS-VEND-CNTRY-NAME                          50666800
506669                ,:PURCHS-NEW-STR-PO-IND                           50666900
506670                ,:PURCHS-IMPRT-PO-IND                             50667000
506671                ,:PURCHS-IMPRT-AGNT-PO-IND                        50667100
506672                ,:PURCHS-STATUS-TMST                              50667200
506673                ,:PURCHS-LAST-UPD-TMST                            50667300
506674                ,:PURCHS-EDI-REXMIT-IND                           50667400
506675                ,:PURCHS-EDI-REXMIT-TMST                          50667500
506676                ,:PURCHS-DIR-STR-IND                              50667600
506677                ,:PURCHS-LAST-UPD-BY-UID                          50667700
506678                ,:PURCHS-APP-BY-UID                               50667800
506679                ,:PURCHS-OTB-PER-NBR                              50667900
506680                ,:PURCHS-DEPT-NBR                                 50668000
506681                ,:PURCHS-ENT-ID                                   50668100
506682                ,:PURCHS-STATUS-CDE                               50668200
506683                ,:PURCHS-CRE-BY-UID                               50668300
506684                ,:PURCHS-REJ-CT                                   50668400
506685                ,:PURCHS-REJ-UID                                  50668500
506686                ,:PURCHS-ORD-DTE                                  50668600
506687                ,:PURCHS-REVISION-CT                              50668700
506688                ,:PURCHS-ADR-SEQ-NBR                              50668800
506689                ,:PURCHS-DEST-KNOWN-IND                           50668900
506690                ,:PURCHS-RLSE-IND                                 50669000
506691                ,:PURCHS-RLSE-DTE                                 50669100
506692                ,:PURCHS-PLCMNT-CNTRY-CDE                         50669200
506693                ,:PURCHS-PROD-CNTRY-CDE                           50669300
506694                ,:PURCHS-UNT-PER-CBMT-QTY                         50669400
506695                ,:PURCHS-CRE-TMST                                 50669500
506696                ,:PURCHS-PRG-LAST-ACTVY-DTE                       50669600
506697                ,:PURCHS-PKGNG-CDE                                50669700
506698                ,:PURCHS-SEASET-YR                                50669800
506699                ,:PURCHS-SEASET-SHRT-NM                           50669900
506700                ,:PURCHS-QTA-CTG-CDE                              50670000
506701                ,:PURCHS-PO-IN-RMS-IND                            50670100
506702                ,:PURCHS-RMS-PO-UPD-TMST                          50670200
506703                ,:PURCHS-DUP-SKU-IND                              50670300
506704                ,:PURCHS-ORIG-PKGNG-CDE                           50670400
506705          FROM                                                    50670500
506706                 TPURCHS                                          50670600
506707          WHERE                                                   50670700
506708                PO_NBR             =  :DK-PO-NBR                  50670800
506709          AND   VER_STATUS_CDE     =  'A'                         50670900
506710     END-EXEC.                                                    50671000
506711                                                                  50671100
506712     EVALUATE TRUE                                                50671200
506713         WHEN SQLCODE = ZERO                                      50671300
506714         WHEN SQLCODE = +100                                      50671400
506715              CONTINUE                                            50671500
506716         WHEN SQLCODE = -904                                      50671600
506717         WHEN SQLCODE = -911                                      50671700
506718         WHEN SQLCODE = -913                                      50671800
506719             PERFORM 9900-SOFT-ABORT                              50671900
506720         WHEN SQLWARN0 NOT = SPACE                                50672000
506721         WHEN SQLCODE NOT = ZERO                                  50672100
506722              MOVE '7610-GET-TPURCHS-STATUS'                      50672200
506723                               TO DP013-PARAGRAPH                 50672300
506724              MOVE 'GET THE PURCHASE HEADER'                      50672400
506725                               TO DP013-MESSAGE-TEXT (1)          50672500
506726              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        50672600
506727              MOVE SQLCA       TO DP013-SQLCA                     50672700
506728              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50672800
506729              STRING ' PO = '                                     50672900
506730                     PV-DISP-PO-NBR                               50673000
506731                                         DELIMITED BY SIZE        50673100
506732                              INTO DP013-MESSAGE-TEXT (2)         50673200
506733              SET DP013-DB2-ABEND                                 50673300
506734                               TO TRUE                            50673400
506735              PERFORM DP013-0000-PROCESS-ABEND                    50673500
506736     END-EVALUATE.                                                50673600
506737/                                                                 50673700
506738 7620-ONLY-UPDATE-PURCHS-STATUS.                                  50673800
506739                                                                  50673900
506740     EXEC SQL                                                     50674000
506741          UPDATE                                                  50674100
506742                TPURCHS                                           50674200
506743           SET                                                    50674300
506744                VER_STATUS_CDE     =  'A'                         50674400
506745              , STATUS_TMST        =  (CURRENT TIMESTAMP)         50674500
506746              , LAST_UPD_TMST      =  (CURRENT TIMESTAMP)         50674600
506747              , STATUS_CDE         =  :PV-PURCHS-STATUS-CDE       50674700
506748          WHERE                                                   50674800
506749                PO_NBR             =  :DK-PO-NBR                  50674900
506750          AND   VER_STATUS_CDE     =  'A'                         50675000
506751     END-EXEC.                                                    50675100
506752                                                                  50675200
506753     EVALUATE TRUE                                                50675300
506754         WHEN SQLCODE = ZERO                                      50675400
506755         WHEN SQLCODE = +100                                      50675500
506756              CONTINUE                                            50675600
506757         WHEN SQLCODE = -904                                      50675700
506758         WHEN SQLCODE = -911                                      50675800
506759         WHEN SQLCODE = -913                                      50675900
506760             SET PS-UPDATES-DONE TO TRUE                          50676000
506761             PERFORM 9900-SOFT-ABORT                              50676100
506762         WHEN SQLWARN0 NOT = SPACE                                50676200
506763         WHEN SQLCODE NOT = ZERO                                  50676300
506764              MOVE '7620-ONLY-UPDATE-PURCHS-STATUS'               50676400
506765                               TO DP013-PARAGRAPH                 50676500
506766              MOVE 'UPDATE THE PURCHASE HEADER'                   50676600
506767                               TO DP013-MESSAGE-TEXT (1)          50676700
506768              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        50676800
506769              MOVE SQLCA       TO DP013-SQLCA                     50676900
506770              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50677000
506771              STRING ' PO = '                                     50677100
506772                     PV-DISP-PO-NBR                               50677200
506773                                         DELIMITED BY SIZE        50677300
506774                              INTO DP013-MESSAGE-TEXT (2)         50677400
506775              SET DP013-DB2-ABEND                                 50677500
506776                               TO TRUE                            50677600
506777              PERFORM DP013-0000-PROCESS-ABEND                    50677700
506778     END-EVALUATE.                                                50677800
506779/                                                                 50677900
506780 7630-UPDATE-PURCHS-STATUS.                                       50678000
506781                                                                  50678100
506782     EXEC SQL                                                     50678200
506783          UPDATE                                                  50678300
506784                TPURCHS                                           50678400
506785           SET                                                    50678500
506786                VER_STATUS_CDE     =  'I'                         50678600
506787          WHERE                                                   50678700
506788                PO_NBR             =  :DK-PO-NBR                  50678800
506789          AND   VER_STATUS_CDE     =  'A'                         50678900
506790     END-EXEC.                                                    50679000
506791                                                                  50679100
506792     EVALUATE TRUE                                                50679200
506793         WHEN SQLCODE = ZERO                                      50679300
506794         WHEN SQLCODE = +100                                      50679400
506795              CONTINUE                                            50679500
506796         WHEN SQLCODE = -904                                      50679600
506797         WHEN SQLCODE = -911                                      50679700
506798         WHEN SQLCODE = -913                                      50679800
506799             SET PS-UPDATES-DONE TO TRUE                          50679900
506800             PERFORM 9900-SOFT-ABORT                              50680000
506801         WHEN SQLWARN0 NOT = SPACE                                50680100
506802         WHEN SQLCODE NOT = ZERO                                  50680200
506803              MOVE '7630-UPDATE-PURCHS-STATUS'                    50680300
506804                               TO DP013-PARAGRAPH                 50680400
506805              MOVE 'UPDATE PURCHS STATUS'                         50680500
506806                               TO DP013-MESSAGE-TEXT (1)          50680600
506807              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        50680700
506808              MOVE SQLCA       TO DP013-SQLCA                     50680800
506809              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50680900
506810              STRING ' PO = '                                     50681000
506811                     PV-DISP-PO-NBR                               50681100
506812                                         DELIMITED BY SIZE        50681200
506813                              INTO DP013-MESSAGE-TEXT (2)         50681300
506814              SET DP013-DB2-ABEND                                 50681400
506815                               TO TRUE                            50681500
506816              PERFORM DP013-0000-PROCESS-ABEND                    50681600
506817     END-EVALUATE.                                                50681700
506818/                                                                 50681800
506819 7640-INSERT-PURCHS.                                              50681900
506820                                                                  50682000
506821     EXEC SQL                                                     50682100
506822          INSERT                                                  50682200
506823           INTO   TPURCHS                                         50682300
506824                 (PO_NBR                                          50682400
506825                , VER_NBR                                         50682500
506826                , VER_STATUS_CDE                                  50682600
506827                , PO_TYP_CDE                                      50682700
506828                , PO_CATEG_CDE                                    50682800
506829                , EDI_IND                                         50682900
506830                , TOT_UNT_QTY                                     50683000
506831                , TOT_VAL_COST_AMT                                50683100
506832                , TOT_VAL_RTL_AMT                                 50683200
506833                , TOT_MU_PCT                                      50683300
506834                , TOT_SKUS_QTY                                    50683400
506835                , IMPRT_AGNT_PO_NBR                               50683500
506836                , IMPRT_ORD_OFF_NAME                              50683600
506837                , IMPRT_VEND_NAME                                 50683700
506838                , IMPRT_FCTRY_NAME                                50683800
506839                , IMPRT_CNTRY_NAME                                50683900
506840                , VEND_CNTRY_NAME                                 50684000
506841                , NEW_STR_PO_IND                                  50684100
506842                , IMPRT_PO_IND                                    50684200
506843                , IMPRT_AGNT_PO_IND                               50684300
506844                , STATUS_TMST                                     50684400
506845                , LAST_UPD_TMST                                   50684500
506846                , EDI_REXMIT_IND                                  50684600
506847                , EDI_REXMIT_TMST                                 50684700
506848                , DIR_STR_IND                                     50684800
506849                , LAST_UPD_BY_UID                                 50684900
506850                , APP_BY_UID                                      50685000
506851                , OTB_PER_NBR                                     50685100
506852                , DEPT_NBR                                        50685200
506853                , ENT_ID                                          50685300
506854                , STATUS_CDE                                      50685400
506855                , CRE_BY_UID                                      50685500
506856                , REJ_CT                                          50685600
506857                , REJ_UID                                         50685700
506858                , ORD_DTE                                         50685800
506859                , REVISION_CT                                     50685900
506860                , ADR_SEQ_NBR                                     50686000
506861                , DEST_KNOWN_IND                                  50686100
506862                , RLSE_IND                                        50686200
506863                , RLSE_DTE                                        50686300
506864                , PLCMNT_CNTRY_CDE                                50686400
506865                , PROD_CNTRY_CDE                                  50686500
506866                , UNT_PER_CBMT_QTY                                50686600
506867                , CRE_TMST                                        50686700
506868                , PRG_LAST_ACTVY_DTE                              50686800
506869                , PKGNG_CDE                                       50686900
506870                , SEASET_YR                                       50687000
506871                , SEASET_SHRT_NM                                  50687100
506872                , QTA_CTG_CDE                                     50687200
506873                , PO_IN_RMS_IND                                   50687300
506874                , RMS_PO_UPD_TMST                                 50687400
506875                , DUP_SKU_IND                                     50687500
506876                , ORIG_PKGNG_CDE                                  50687600
506877                 )                                                50687700
506878         VALUES                                                   50687800
506879                (:PURCHS-PO-NBR                                   50687900
506880                ,:PURCHS-VER-NBR                                  50688000
506881                ,'A'                                              50688100
506882                ,:PURCHS-PO-TYP-CDE                               50688200
506883                ,:PURCHS-PO-CATEG-CDE                             50688300
506884                ,:PURCHS-EDI-IND                                  50688400
506885                ,:PURCHS-TOT-UNT-QTY                              50688500
506886                ,:PURCHS-TOT-VAL-COST-AMT                         50688600
506887                ,:PURCHS-TOT-VAL-RTL-AMT                          50688700
506888                ,:PURCHS-TOT-MU-PCT                               50688800
506889                ,:PURCHS-TOT-SKUS-QTY                             50688900
506890                ,:PURCHS-IMPRT-AGNT-PO-NBR                        50689000
506891                ,:PURCHS-IMPRT-ORD-OFF-NAME                       50689100
506892                ,:PURCHS-IMPRT-VEND-NAME                          50689200
506893                ,:PURCHS-IMPRT-FCTRY-NAME                         50689300
506894                ,:PURCHS-IMPRT-CNTRY-NAME                         50689400
506895                ,:PURCHS-VEND-CNTRY-NAME                          50689500
506896                ,:PURCHS-NEW-STR-PO-IND                           50689600
506897                ,:PURCHS-IMPRT-PO-IND                             50689700
506898                ,:PURCHS-IMPRT-AGNT-PO-IND                        50689800
506899                , CURRENT TIMESTAMP                               50689900
506900                , CURRENT TIMESTAMP                               50690000
506901                ,:PURCHS-EDI-REXMIT-IND                           50690100
506902                ,:PURCHS-EDI-REXMIT-TMST                          50690200
506903                ,:PURCHS-DIR-STR-IND                              50690300
506904                ,:DP020-USERID                                    50690400
506905                ,:PURCHS-APP-BY-UID                               50690500
506906                ,:PURCHS-OTB-PER-NBR                              50690600
506907                ,:PURCHS-DEPT-NBR                                 50690700
506908                ,:PURCHS-ENT-ID                                   50690800
506909                ,:PV-PURCHS-STATUS-CDE                            50690900
506910                ,:PURCHS-CRE-BY-UID                               50691000
506911                ,:PURCHS-REJ-CT                                   50691100
506912                ,:PURCHS-REJ-UID                                  50691200
506913                ,:PURCHS-ORD-DTE                                  50691300
506914                ,:PURCHS-REVISION-CT                              50691400
506915                ,:PURCHS-ADR-SEQ-NBR                              50691500
506916                ,:PURCHS-DEST-KNOWN-IND                           50691600
506917                ,:PURCHS-RLSE-IND                                 50691700
506918                ,:PURCHS-RLSE-DTE                                 50691800
506919                ,:PURCHS-PLCMNT-CNTRY-CDE                         50691900
506920                ,:PURCHS-PROD-CNTRY-CDE                           50692000
506921                ,:PURCHS-UNT-PER-CBMT-QTY                         50692100
506922                ,:PURCHS-CRE-TMST                                 50692200
506923                ,:PURCHS-PRG-LAST-ACTVY-DTE                       50692300
506924                ,:PURCHS-PKGNG-CDE                                50692400
506925                ,:PURCHS-SEASET-YR                                50692500
506926                ,:PURCHS-SEASET-SHRT-NM                           50692600
506927                ,:PURCHS-QTA-CTG-CDE                              50692700
506928                ,:PURCHS-PO-IN-RMS-IND                            50692800
506929                ,:PURCHS-RMS-PO-UPD-TMST                          50692900
506930                ,:PURCHS-DUP-SKU-IND                              50693000
506931                ,:PURCHS-ORIG-PKGNG-CDE                           50693100
506932                 )                                                50693200
506933     END-EXEC.                                                    50693300
506934                                                                  50693400
506935     EVALUATE TRUE                                                50693500
506936         WHEN SQLCODE = ZERO                                      50693600
506937              CONTINUE                                            50693700
506938         WHEN SQLCODE = -904                                      50693800
506939         WHEN SQLCODE = -911                                      50693900
506940         WHEN SQLCODE = -913                                      50694000
506941             SET PS-UPDATES-DONE TO TRUE                          50694100
506942             PERFORM 9900-SOFT-ABORT                              50694200
506943         WHEN SQLWARN0 NOT = SPACE                                50694300
506944         WHEN SQLCODE NOT = ZERO                                  50694400
506945              MOVE '7640-INSERT-PURCHS'                           50694500
506946                               TO DP013-PARAGRAPH                 50694600
506947              MOVE 'INSERT PURCHASE HEADER'                       50694700
506948                               TO DP013-MESSAGE-TEXT (1)          50694800
506949              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        50694900
506950              MOVE SQLCA       TO DP013-SQLCA                     50695000
506951              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  50695100
506952              STRING ' PO = '                                     50695200
506953                     PV-DISP-PO-NBR                               50695300
506954                                         DELIMITED BY SIZE        50695400
506955                              INTO DP013-MESSAGE-TEXT (2)         50695500
506956              SET DP013-DB2-ABEND                                 50695600
506957                               TO TRUE                            50695700
506958              PERFORM DP013-0000-PROCESS-ABEND                    50695800
506959     END-EVALUATE.                                                50695900
506960                                                                  50696000
506961*----------------------------------------------------------------*50696100
506962*    CHECK TO SEE IF THIS DEPARTMENT HAS BEEN CONVERTED TO RMS.  *50696200
506963*    IF IT HAS, THE COUNT RETURNED FROM THIS FUNCTION WILL BE    *50696300
506964*    GREATER THAN ZERO AND WE CAN UPDATE TPURITM AND TPURCHS     *50696400
506965*    CORRECTLY.                                                  *50696500
506966*----------------------------------------------------------------*50696600
506967 7650-CHECK-FOR-RMS-PO.                                           50696700
506968                                                                  50696800
506969     INITIALIZE PV-DB2-COUNT.                                     50696900
506970                                                                  50697000
506971     EXEC SQL                                                     50697100
506972          SELECT                                                  50697200
506973                  COUNT(*)                                        50697300
506974           INTO                                                   50697400
506975                  :PV-DB2-COUNT :PV-NULL-IND                      50697500
506976           FROM                                                   50697600
506977                  POT_RMS_RLOUT_CTL                               50697700
506978          WHERE                                                   50697800
506979                  DEPT_NBR            = :PV-DEPT-NBR-KEY          50697900
506980           AND    PO_ENTR_IN_RMS_DTE <=  CURRENT_DATE             50698000
506981     END-EXEC.                                                    50698100
506982                                                                  50698200
506983     EVALUATE TRUE                                                50698300
506984         WHEN SQLCODE = ZERO                                      50698400
506985         WHEN SQLCODE = +100                                      50698500
506986              SET PS-CHECKED-FOR-RMS-PO                           50698600
506987                               TO TRUE                            50698700
506988         WHEN SQLWARN0 NOT = SPACE                                50698800
506989         WHEN SQLCODE = -904                                      50698900
506990         WHEN SQLCODE = -911                                      50699000
506991         WHEN SQLCODE = -913                                      50699100
506992              PERFORM 9900-SOFT-ABORT                             50699200
506993         WHEN SQLCODE NOT = ZERO                                  50699300
506994              MOVE '7650-CHECK-FOR-RMS-PO'                        50699400
506995                               TO DP013-PARAGRAPH                 50699500
506996              MOVE 'CHECK IF DEPT NBR CONVERTED FOR RMS'          50699600
506997                               TO DP013-MESSAGE-TEXT (1)          50699700
506998              STRING 'DEPARTMENT NUMBER: ' DELIMITED BY SIZE      50699800
506999                     PV-DEPT-NBR-X         DELIMITED BY SIZE      50699900
507000                             INTO DP013-MESSAGE-TEXT (2)          50700000
507001              MOVE 'POT_RMS_RLOUT_CTL'                            50700100
507002                               TO DP013-DB2-TABLE-NAME (1)        50700200
507003              MOVE SQLCA       TO DP013-SQLCA                     50700300
507004              SET DP013-DB2-ABEND                                 50700400
507005                               TO TRUE                            50700500
507006              PERFORM DP013-0000-PROCESS-ABEND                    50700600
507007     END-EVALUATE.                                                50700700
507008******************************************************************50700800
507009* THIS PARAGRAPH WILL CONTROL THE PROCESSING ASSOCIATED TO THE   *50700900
507010* UNITS WORKED ROUTINE.                                           50701000
507011******************************************************************50701100
507012 8500-PROCESS-UNITS-WORK.                                         50701200
507013                                                                  50701300
507014     PERFORM 8600-RECEIV-PURITM-JOIN.                             50701400
507015                                                                  50701500
507016     PERFORM 8800-UNITS-WORK-ROUTINE.                             50701600
507017                                                                  50701700
507018/                                                                 50701800
507019******************************************************************50701900
507020*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *50702000
507030*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *50703000
507040*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *50704000
507050*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *50705000
507060*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *50706000
507070*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *50707000
507080*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *50708000
507090*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *50709000
507100******************************************************************50710000
507200 8600-RECEIV-PURITM-JOIN.                                         50720000
507300                                                                  50730000
507400     EXEC SQL                                                     50740000
507500     SELECT A.CURR_OPER_UNT_ID,                                   50750000
507600            C.UNT_RTL_PR_AMT,                                     50760000
507700            D.LOC_TYP_CDE                                         50770000
507800         INTO :PV-CURR-OPER-UNT-ID                                50780000
507900         ,    :PURITM-UNT-RTL-PR-AMT                              50790000
508000         ,    :PV-XLT00010-TYPE-CODE                              50800000
508100         FROM                                                     50810000
508200             TRECEIV A                                            50820000
508300         ,   TRECITM B                                            50830000
508400         ,   TPURITM C                                            50840000
508500         ,   XLT_LOC D                                            50850000
508600         WHERE A.ORD_NBR          = :DK-PO-NBR                    50860000
508700           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               50870000
508800           AND B.ORD_NBR          = A.ORD_NBR                     50880000
508900           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 50890000
509000           AND B.ORD_LNE_NBR      = :RECDIS-ORD-LNE-NBR           50900000
509100           AND C.PO_NBR           = B.ORD_NBR                     50910000
509200           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 50920000
509300           AND C.VER_NBR          = B.PO_VER_NBR                  50930000
509400           AND D.LOC_NBR          = A.CURR_OPER_UNT_ID            50940000
509500     END-EXEC.                                                    50950000
509600*                                                                 50960000
509700     EVALUATE TRUE                                                50970000
509800         WHEN SQLCODE = ZERO                                      50980000
509900             CONTINUE                                             50990000
510000         WHEN SQLCODE = -904                                      51000000
510100         WHEN SQLCODE = -911                                      51010000
510200         WHEN SQLCODE = -913                                      51020000
510300             PERFORM 9900-SOFT-ABORT                              51030000
510400                                                                  51040000
510500         WHEN SQLWARN0 NOT = SPACES                               51050000
510600         WHEN SQLCODE < ZERO                                      51060000
510700         WHEN SQLCODE > ZERO                                      51070000
510800             MOVE '8600-RECEIV-PURITM-JOIN'                       51080000
510900                                  TO DP013-PARAGRAPH              51090000
511000             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 51100000
511100                                  TO DP013-MESSAGE-TEXT (1)       51110000
511200             MOVE DK-PO-NBR              TO PV-DISP-PO-NBR        51120000
511300             MOVE DK-REC-SEQ-NBR         TO PV-DISP-REC-SEQ-NBR   51130000
511400             MOVE DK-DRIVER-LNE-NBR      TO PV-DISP-LNE-NBR       51140000
511500             STRING 'PO '                                         51150000
511600                    PV-DISP-PO-NBR                                51160000
511700                    ' REC '                                       51170000
511800                    PV-DISP-REC-SEQ-NBR                           51180000
511900                    ' LINE '                                      51190000
512000                    PV-DISP-LNE-NBR     DELIMITED BY SIZE         51200000
512100                             INTO DP013-MESSAGE-TEXT (2)          51210000
512200             MOVE SQLCA      TO DP013-SQLCA                       51220000
512300             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          51230000
512400             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (2)          51240000
512500             MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (3)          51250000
512600             SET DP013-DB2-ABEND                                  51260000
512700                 DP013-NO-ROLLBACK                                51270000
512800                                  TO TRUE                         51280000
512900             PERFORM DP013-0000-PROCESS-ABEND                     51290000
513000     END-EVALUATE.                                                51300000
513100                                                                  51310000
513200******************************************************************51320000
513300* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *51330000
513400* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *51340000
513500* THE RESULTS RETURNED FROM THE ROUTINE.                         *51350000
513600******************************************************************51360000
513700 8800-UNITS-WORK-ROUTINE.                                         51370000
513800                                                                  51380000
513900     INITIALIZE PC238-COMM-AREA.                                  51390000
514000                                                                  51400000
514100     EXEC SQL                                                     51410000
514200         SET :PV-TMST =  CURRENT_TIMESTAMP                        51420000
514300     END-EXEC                                                     51430000
514400                                                                  51440000
514500     MOVE PV-TMST                 TO PC238-WRKD-TMST.             51450000
514600                                                                  51460000
514700     MOVE PV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.      51470000
514800     MOVE DK-PO-NBR               TO PC238-PO-NBR.                51480000
514900     MOVE DK-REC-SEQ-NBR          TO PC238-RCVR-SEQ-NBR.          51490000
515000     MOVE RECDIS-ORD-LNE-NBR      TO PC238-PO-LNE-NBR.            51500000
515100                                                                  51510000
515200     IF RECITM-PREPK-DRV-LNE-CDE = 'A'                            51520000
515300        SET  PC238-DRIVE-LINE        TO TRUE                      51530000
515400     ELSE                                                         51540000
515500        MOVE SPACE  TO PC238-VRFY-ADJ-DRIVE-LNE                   51550000
515600     END-IF.                                                      51560000
515700                                                                  51570000
515800     IF  PV-XLT00010-TYPE-DC                                      51580000
515900         SET PC238-DIRECT-STORE-NO TO TRUE                        51590000
516000     ELSE                                                         51600000
516100         SET PC238-DIRECT-STORE-YES TO TRUE                       51610000
516200     END-IF.                                                      51620000
516300                                                                  51630000
516400     MOVE PV-SAVE-ITM-QTY         TO PC238-WRKD-UNT-QTY.          51640000
516500     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        51650000
516600     IF ASC-POST-VERIFIED-RECEIPT                                 51660000
516700         SET  PC238-TRANS-POST-VRFY-ADJ TO TRUE                   51670000
516800     ELSE                                                         51680000
516900         SET  PC238-TRANS-VERIFY-ADJ  TO TRUE                     51690000
517000     END-IF.                                                      51700000
517100     SET  PC238-MANUAL-VERIFY     TO TRUE.                        51710000
517200     SET  PC238-ODD-UNIT-NO       TO TRUE.                        51720000
517300     MOVE ASC-VRFY-ADJ-QUEUE-NAME TO PC238-VRFY-ADJ-QUEUE-NAME.   51730000
517400     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       51740000
517500                                                                  51750000
517600************************************************                  51760000
517700*                                                                 51770000
517800*    MOVE PC238-PO-NBR       TO PV-DISP-PO-NBR.                   51780000
517900*    MOVE PC238-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ-NBR.              51790000
518000*    MOVE PC238-PO-LNE-NBR   TO PV-DISP-LNE-NBR.                  51800000
518100*    MOVE PC238-WRKD-OPER-UNT-ID                                  51810000
518200*                            TO PV-DISP-OPER-UNT-ID.              51820000
518300*    STRING ' RCKCS820 - '      DELIMITED BY SIZE                 51830000
518400*           ' CALLING PCKCS756 WITH KEY INFO - '                  51840000
518500*                               DELIMITED BY SIZE                 51850000
518600*           PV-DISP-PO-NBR      DELIMITED BY SIZE                 51860000
518700*           ' - '               DELIMITED BY SIZE                 51870000
518800*           PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE                 51880000
518900*           ' - '               DELIMITED BY SIZE                 51890000
519000*           PV-DISP-LNE-NBR     DELIMITED BY SIZE                 51900000
519100*           ' - '               DELIMITED BY SIZE                 51910000
519200*           PV-DISP-OPER-UNT-ID DELIMITED BY SIZE                 51920000
519300*                        INTO PV-CICS-MSG-AREA.                   51930000
519400*    MOVE LENGTH OF PV-CICS-MSG-AREA                              51940000
519500*                          TO PV-COMMAREA-LENGTH.                 51950000
519600*    PERFORM 9700-WRITE-TO-CICS-LOG.                              51960000
519700*                                                                 51970000
519800************************************************                  51980000
519900                                                                  51990000
520000     MOVE LENGTH OF PC238-COMM-AREA                               52000000
520100                                  TO PV-COMMAREA-LENGTH.          52010000
520200                                                                  52020000
520300     EXEC CICS                                                    52030000
520400         LINK PROGRAM  (PC-PCKCS756)                              52040000
520500              COMMAREA (PC238-COMM-AREA)                          52050000
520600              LENGTH   (PV-COMMAREA-LENGTH)                       52060000
520700              RESP     (PV-CICS-RESP)                             52070000
520800     END-EXEC.                                                    52080000
520900                                                                  52090000
521000************************************************                  52100000
521100*                                                                 52110000
521200*    MOVE PC238-PO-NBR       TO PV-DISP-PO-NBR.                   52120000
521300*    MOVE PC238-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ-NBR.              52130000
521400*    MOVE PC238-PO-LNE-NBR   TO PV-DISP-LNE-NBR.                  52140000
521500*    MOVE PC238-WRKD-OPER-UNT-ID                                  52150000
521600*                            TO PV-DISP-OPER-UNT-ID.              52160000
521700*    STRING ' RCKCS820 - '      DELIMITED BY SIZE                 52170000
521800*           ' RETURN FROM PCKCS756 - '                            52180000
521900*                               DELIMITED BY SIZE                 52190000
522000*           PV-DISP-PO-NBR      DELIMITED BY SIZE                 52200000
522100*           ' - '               DELIMITED BY SIZE                 52210000
522200*           PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE                 52220000
522300*           ' - '               DELIMITED BY SIZE                 52230000
522400*           PV-DISP-LNE-NBR     DELIMITED BY SIZE                 52240000
522500*           ' - '               DELIMITED BY SIZE                 52250000
522600*           PC238-MOD-SUCCESS-CDE                                 52260000
522700*                               DELIMITED BY SIZE                 52270000
522800*           ' - '               DELIMITED BY SIZE                 52280000
522900*           PC238-UNSUCCESSFUL-CDE                                52290000
523000*                               DELIMITED BY SIZE                 52300000
523100*                        INTO PV-CICS-MSG-AREA.                   52310000
523200*    MOVE LENGTH OF PV-CICS-MSG-AREA                              52320000
523300*                          TO PV-COMMAREA-LENGTH.                 52330000
523400*    PERFORM 9700-WRITE-TO-CICS-LOG.                              52340000
523500*                                                                 52350000
523600************************************************                  52360000
523700                                                                  52370000
523800     EVALUATE TRUE                                                52380000
523900         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     52390000
524000              IF  PC238-MOD-UNSUCCESSFUL                          52400000
524100                  PERFORM 8810-MOD-UNSUCCESSFUL                   52410000
524200              END-IF                                              52420000
524300         WHEN OTHER                                               52430000
524400              MOVE PC238-PO-NBR       TO PV-DISP-PO-NBR           52440000
524500              MOVE PC238-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ-NBR      52450000
524600              MOVE PC238-PO-LNE-NBR   TO PV-DISP-LNE-NBR          52460000
524700              MOVE PC238-WRKD-OPER-UNT-ID                         52470000
524800                                      TO PV-DISP-OPER-UNT-ID      52480000
524900              MOVE PC238-BAD-SQL-CDE  TO PV-DISP-SQL-CODE         52490000
525000              MOVE PV-CICS-RESP       TO PV-DISP-CICS-RESP        52500000
525100              SET PS-UNITS-WORKED-ERROR  TO TRUE                  52510000
525200              STRING ' RCKCS820 - '      DELIMITED BY SIZE        52520000
525300                     ' 8800-UNITS-WORK-ROUTINE '                  52530000
525400                                         DELIMITED BY SIZE        52540000
525500                     ' BAD CALL TO UNITS WORKED MODULE '          52550000
525600                                         DELIMITED BY SIZE        52560000
525700                     ' - CICS RESP '                              52570000
525800                                         DELIMITED BY SIZE        52580000
525900                     PV-DISP-CICS-RESP                            52590000
526000                                         DELIMITED BY SIZE        52600000
526100                                      INTO PV-CICS-MSG-AREA       52610000
526200              MOVE LENGTH OF PV-CICS-MSG-AREA                     52620000
526300                                        TO PV-COMMAREA-LENGTH     52630000
526400              PERFORM 9700-WRITE-TO-CICS-LOG                      52640000
526500              MOVE SPACES TO PV-CICS-MSG-AREA                     52650000
526600              STRING ' RCKCS820 - '      DELIMITED BY SIZE        52660000
526700                     ' 8800-UNITS-WORK-ROUTINE '                  52670000
526800                                         DELIMITED BY SIZE        52680000
526900                     ' KEY INFO - '      DELIMITED BY SIZE        52690000
527000                     PV-DISP-PO-NBR      DELIMITED BY SIZE        52700000
527100                     ' - '               DELIMITED BY SIZE        52710000
527200                     PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE        52720000
527300                     ' - '               DELIMITED BY SIZE        52730000
527400                     PV-DISP-LNE-NBR     DELIMITED BY SIZE        52740000
527500                                  INTO PV-CICS-MSG-AREA           52750000
527600              MOVE LENGTH OF PV-CICS-MSG-AREA                     52760000
527700                                    TO PV-COMMAREA-LENGTH         52770000
527800              PERFORM 9700-WRITE-TO-CICS-LOG                      52780000
527900              PERFORM 9900-SOFT-ABORT                             52790000
528000     END-EVALUATE.                                                52800000
528100                                                                  52810000
528200******************************************************************52820000
528300* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *52830000
528400* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *52840000
528500* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *52850000
528600* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *52860000
528700******************************************************************52870000
528800 8810-MOD-UNSUCCESSFUL.                                           52880000
528900                                                                  52890000
529000     MOVE PC238-PO-NBR              TO PV-DISP-PO-NBR.            52900000
529100     MOVE PC238-RCVR-SEQ-NBR        TO PV-DISP-REC-SEQ-NBR.       52910000
529200     MOVE PC238-PO-LNE-NBR          TO PV-DISP-LNE-NBR.           52920000
529300     MOVE PC238-WRKD-OPER-UNT-ID    TO PV-DISP-OPER-UNT-ID.       52930000
529400     MOVE PC238-BAD-SQL-CDE         TO PV-DISP-SQL-CODE.          52940000
529500     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      52950000
529600     SET  PS-UPDATES-DONE           TO TRUE.                      52960000
529700                                                                  52970000
529800     IF  PC238-MOD-BAD-TMST                                       52980000
529900         STRING ' RCKCS820 - '      DELIMITED BY SIZE             52990000
530000                ' 8800-UNITS-WORK-ROUTINE '                       53000000
530100                                    DELIMITED BY SIZE             53010000
530200                ' BAD TIMESTAMP '   DELIMITED BY SIZE             53020000
530300                PC238-WRKD-TMST     DELIMITED BY SIZE             53030000
530400                             INTO PV-CICS-MSG-AREA                53040000
530500         MOVE LENGTH OF PV-CICS-MSG-AREA                          53050000
530600                               TO PV-COMMAREA-LENGTH              53060000
530700         PERFORM 9700-WRITE-TO-CICS-LOG                           53070000
530800         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53080000
530900                ' 8800-UNITS-WORK-ROUTINE '                       53090000
531000                                    DELIMITED BY SIZE             53100000
531100                ' KEY INFO - '      DELIMITED BY SIZE             53110000
531200                PV-DISP-PO-NBR      DELIMITED BY SIZE             53120000
531300                ' - '               DELIMITED BY SIZE             53130000
531400                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             53140000
531500                ' - '               DELIMITED BY SIZE             53150000
531600                PV-DISP-LNE-NBR     DELIMITED BY SIZE             53160000
531700                             INTO PV-CICS-MSG-AREA                53170000
531800         MOVE LENGTH OF PV-CICS-MSG-AREA                          53180000
531900                               TO PV-COMMAREA-LENGTH              53190000
532000         PERFORM 9700-WRITE-TO-CICS-LOG                           53200000
532100         PERFORM 9900-SOFT-ABORT                                  53210000
532200     ELSE                                                         53220000
532300     IF  PC238-MOD-BAD-OPER                                       53230000
532400         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53240000
532500                ' 8800-UNITS-WORK-ROUTINE '                       53250000
532600                                    DELIMITED BY SIZE             53260000
532700                ' BAD OPER UNIT '   DELIMITED BY SIZE             53270000
532800                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             53280000
532900                             INTO PV-CICS-MSG-AREA                53290000
533000         MOVE LENGTH OF PV-CICS-MSG-AREA                          53300000
533100                               TO PV-COMMAREA-LENGTH              53310000
533200         PERFORM 9700-WRITE-TO-CICS-LOG                           53320000
533300         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53330000
533400                ' 8800-UNITS-WORK-ROUTINE '                       53340000
533500                                    DELIMITED BY SIZE             53350000
533600                ' KEY INFO - '      DELIMITED BY SIZE             53360000
533700                PV-DISP-PO-NBR      DELIMITED BY SIZE             53370000
533800                ' - '               DELIMITED BY SIZE             53380000
533900                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             53390000
534000                ' - '               DELIMITED BY SIZE             53400000
534100                PV-DISP-LNE-NBR     DELIMITED BY SIZE             53410000
534200                             INTO PV-CICS-MSG-AREA                53420000
534300         MOVE LENGTH OF PV-CICS-MSG-AREA                          53430000
534400                               TO PV-COMMAREA-LENGTH              53440000
534500         PERFORM 9700-WRITE-TO-CICS-LOG                           53450000
534600         PERFORM 9900-SOFT-ABORT                                  53460000
534700     ELSE                                                         53470000
534800     IF  PC238-MOD-BAD-TRANS-TYPE                                 53480000
534900         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53490000
535000                ' 8800-UNITS-WORK-ROUTINE '                       53500000
535100                                    DELIMITED BY SIZE             53510000
535200                ' BAD TRAN TYPE '   DELIMITED BY SIZE             53520000
535300                PC238-TRANS-TYPE-CDE                              53530000
535400                                    DELIMITED BY SIZE             53540000
535500                             INTO PV-CICS-MSG-AREA                53550000
535600         MOVE LENGTH OF PV-CICS-MSG-AREA                          53560000
535700                               TO PV-COMMAREA-LENGTH              53570000
535800         PERFORM 9700-WRITE-TO-CICS-LOG                           53580000
535900         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53590000
536000                ' 8800-UNITS-WORK-ROUTINE '                       53600000
536100                                    DELIMITED BY SIZE             53610000
536200                ' KEY INFO - '      DELIMITED BY SIZE             53620000
536300                PV-DISP-PO-NBR      DELIMITED BY SIZE             53630000
536400                ' - '               DELIMITED BY SIZE             53640000
536500                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             53650000
536600                ' - '               DELIMITED BY SIZE             53660000
536700                PV-DISP-LNE-NBR     DELIMITED BY SIZE             53670000
536800                             INTO PV-CICS-MSG-AREA                53680000
536900         MOVE LENGTH OF PV-CICS-MSG-AREA                          53690000
537000                               TO PV-COMMAREA-LENGTH              53700000
537100         PERFORM 9700-WRITE-TO-CICS-LOG                           53710000
537200         PERFORM 9900-SOFT-ABORT                                  53720000
537300     ELSE                                                         53730000
537400     IF  PC238-MOD-BAD-PO                                         53740000
537500         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53750000
537600                ' 8800-UNITS-WORK-ROUTINE '                       53760000
537700                                    DELIMITED BY SIZE             53770000
537800                ' BAD PO NUMBER '   DELIMITED BY SIZE             53780000
537900                PV-DISP-PO-NBR      DELIMITED BY SIZE             53790000
538000                             INTO PV-CICS-MSG-AREA                53800000
538100         MOVE LENGTH OF PV-CICS-MSG-AREA                          53810000
538200                               TO PV-COMMAREA-LENGTH              53820000
538300         PERFORM 9700-WRITE-TO-CICS-LOG                           53830000
538400         STRING ' RCKCS820 - '      DELIMITED BY SIZE             53840000
538500                ' 8800-UNITS-WORK-ROUTINE '                       53850000
538600                                    DELIMITED BY SIZE             53860000
538700                ' KEY INFO - '      DELIMITED BY SIZE             53870000
538800                PV-DISP-PO-NBR      DELIMITED BY SIZE             53880000
538900                ' - '               DELIMITED BY SIZE             53890000
539000                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             53900000
539100                ' - '               DELIMITED BY SIZE             53910000
539200                PV-DISP-LNE-NBR     DELIMITED BY SIZE             53920000
539300                             INTO PV-CICS-MSG-AREA                53930000
539400         MOVE LENGTH OF PV-CICS-MSG-AREA                          53940000
539500                               TO PV-COMMAREA-LENGTH              53950000
539600         PERFORM 9700-WRITE-TO-CICS-LOG                           53960000
539700         PERFORM 9900-SOFT-ABORT                                  53970000
539800     ELSE                                                         53980000
539900     IF  PC238-MOD-BAD-RCVR                                       53990000
540000         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54000000
540100                ' 8800-UNITS-WORK-ROUTINE '                       54010000
540200                                    DELIMITED BY SIZE             54020000
540300                ' BAD RCVR NBR  '   DELIMITED BY SIZE             54030000
540400                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             54040000
540500                             INTO PV-CICS-MSG-AREA                54050000
540600         MOVE LENGTH OF PV-CICS-MSG-AREA                          54060000
540700                               TO PV-COMMAREA-LENGTH              54070000
540800         PERFORM 9700-WRITE-TO-CICS-LOG                           54080000
540900         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54090000
541000                ' 8800-UNITS-WORK-ROUTINE '                       54100000
541100                                    DELIMITED BY SIZE             54110000
541200                ' KEY INFO - '      DELIMITED BY SIZE             54120000
541300                PV-DISP-PO-NBR      DELIMITED BY SIZE             54130000
541400                ' - '               DELIMITED BY SIZE             54140000
541500                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             54150000
541600                ' - '               DELIMITED BY SIZE             54160000
541700                PV-DISP-LNE-NBR     DELIMITED BY SIZE             54170000
541800                             INTO PV-CICS-MSG-AREA                54180000
541900         MOVE LENGTH OF PV-CICS-MSG-AREA                          54190000
542000                               TO PV-COMMAREA-LENGTH              54200000
542100         PERFORM 9700-WRITE-TO-CICS-LOG                           54210000
542200         PERFORM 9900-SOFT-ABORT                                  54220000
542300     ELSE                                                         54230000
542400     IF  PC238-MOD-BAD-LINE                                       54240000
542500         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54250000
542600                ' 8800-UNITS-WORK-ROUTINE '                       54260000
542700                                    DELIMITED BY SIZE             54270000
542800                ' BAD LINE NBR  '   DELIMITED BY SIZE             54280000
542900                PV-DISP-LNE-NBR     DELIMITED BY SIZE             54290000
543000                             INTO PV-CICS-MSG-AREA                54300000
543100         MOVE LENGTH OF PV-CICS-MSG-AREA                          54310000
543200                               TO PV-COMMAREA-LENGTH              54320000
543300         PERFORM 9700-WRITE-TO-CICS-LOG                           54330000
543400         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54340000
543500                ' 8800-UNITS-WORK-ROUTINE '                       54350000
543600                                    DELIMITED BY SIZE             54360000
543700                ' KEY INFO - '      DELIMITED BY SIZE             54370000
543800                PV-DISP-PO-NBR      DELIMITED BY SIZE             54380000
543900                ' - '               DELIMITED BY SIZE             54390000
544000                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             54400000
544100                ' - '               DELIMITED BY SIZE             54410000
544200                PV-DISP-LNE-NBR     DELIMITED BY SIZE             54420000
544300                             INTO PV-CICS-MSG-AREA                54430000
544400         MOVE LENGTH OF PV-CICS-MSG-AREA                          54440000
544500                               TO PV-COMMAREA-LENGTH              54450000
544600         PERFORM 9700-WRITE-TO-CICS-LOG                           54460000
544700         PERFORM 9900-SOFT-ABORT                                  54470000
544800     ELSE                                                         54480000
544900     IF  PC238-MOD-BAD-NO-SHIFT                                   54490000
545000         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54500000
545100                ' 8800-UNITS-WORK-ROUTINE '                       54510000
545200                                    DELIMITED BY SIZE             54520000
545300                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             54530000
545400                PC238-WRKD-TMST     DELIMITED BY SIZE             54540000
545500                ' FOR OPER '        DELIMITED BY SIZE             54550000
545600                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             54560000
545700                             INTO PV-CICS-MSG-AREA                54570000
545800         MOVE LENGTH OF PV-CICS-MSG-AREA                          54580000
545900                               TO PV-COMMAREA-LENGTH              54590000
546000         PERFORM 9700-WRITE-TO-CICS-LOG                           54600000
546100         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54610000
546200                ' 8800-UNITS-WORK-ROUTINE '                       54620000
546300                                    DELIMITED BY SIZE             54630000
546400                ' KEY INFO - '      DELIMITED BY SIZE             54640000
546500                PV-DISP-PO-NBR      DELIMITED BY SIZE             54650000
546600                ' - '               DELIMITED BY SIZE             54660000
546700                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             54670000
546800                ' - '               DELIMITED BY SIZE             54680000
546900                PV-DISP-LNE-NBR     DELIMITED BY SIZE             54690000
547000                             INTO PV-CICS-MSG-AREA                54700000
547100         MOVE LENGTH OF PV-CICS-MSG-AREA                          54710000
547200                               TO PV-COMMAREA-LENGTH              54720000
547300         PERFORM 9700-WRITE-TO-CICS-LOG                           54730000
547400         PERFORM 9900-SOFT-ABORT                                  54740000
547500     ELSE                                                         54750000
547600         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54760000
547700                ' 8800-UNITS-WORK-ROUTINE '                       54770000
547800                                    DELIMITED BY SIZE             54780000
547900                ' DB ERROR - SQL CODE '                           54790000
548000                                    DELIMITED BY SIZE             54800000
548100                PV-DISP-SQL-CODE DELIMITED BY SIZE                54810000
548200                ' FUNC: '           DELIMITED BY SIZE             54820000
548300                PC238-BAD-TABLE-FUNCTION                          54830000
548400                                    DELIMITED BY SIZE             54840000
548500                ' TABLE: '          DELIMITED BY SIZE             54850000
548600                PC238-BAD-TABLE-NAME                              54860000
548700                                    DELIMITED BY SIZE             54870000
548800                             INTO PV-CICS-MSG-AREA                54880000
548900         MOVE LENGTH OF PV-CICS-MSG-AREA                          54890000
549000                               TO PV-COMMAREA-LENGTH              54900000
549100         PERFORM 9700-WRITE-TO-CICS-LOG                           54910000
549200         STRING ' RCKCS820 - '      DELIMITED BY SIZE             54920000
549300                ' 8800-UNITS-WORK-ROUTINE '                       54930000
549400                                    DELIMITED BY SIZE             54940000
549500                ' KEY INFO - '      DELIMITED BY SIZE             54950000
549600                PV-DISP-PO-NBR      DELIMITED BY SIZE             54960000
549700                ' - '               DELIMITED BY SIZE             54970000
549800                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             54980000
549900                ' - '               DELIMITED BY SIZE             54990000
550000                PV-DISP-LNE-NBR     DELIMITED BY SIZE             55000000
550100                             INTO PV-CICS-MSG-AREA                55010000
550200         MOVE LENGTH OF PV-CICS-MSG-AREA                          55020000
550300                               TO PV-COMMAREA-LENGTH              55030000
550400         PERFORM 9700-WRITE-TO-CICS-LOG                           55040000
550500         PERFORM 9900-SOFT-ABORT                                  55050000
550600     END-IF                                                       55060000
550700     END-IF                                                       55070000
550800     END-IF                                                       55080000
550900     END-IF                                                       55090000
551000     END-IF                                                       55100000
551100     END-IF                                                       55110000
551200     END-IF.                                                      55120000
551300                                                                  55130000
551400                                                                  55140000
551500******************************************************************55150000
551600* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *55160000
551700* OBJECT WAS UPDATED.                                            *55170000
551800******************************************************************55180000
551900 9000-UPDATE-SELECTION-QUEUE.                                     55190000
552000                                                                  55200000
552100     PERFORM 9100-READ-SEL-QUEUE                                  55210000
552200                                                                  55220000
552300     SET RC037-UPD (ASC-SEL-SUB) TO TRUE                          55230000
552400     PERFORM 9200-REWRITE-SEL-QUEUE.                              55240000
552500                                                                  55250000
552600*----------------------------------------------------------------*55260000
552700* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *55270000
552800*----------------------------------------------------------------*55280000
552900 9100-READ-SEL-QUEUE.                                             55290000
553000     EXEC CICS                                                    55300000
553100         READQ TS                                                 55310000
553200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        55320000
553300             INTO  (RC037-DC-SELECT-RECORD)                       55330000
553400             ITEM  (ASC-SEL-ITEM)                                 55340000
553500             RESP  (PV-CICS-RESP)                                 55350000
553600     END-EXEC.                                                    55360000
553700                                                                  55370000
553800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       55380000
553900         CONTINUE                                                 55390000
554000     ELSE                                                         55400000
554100         SET DP013-LOGIC-ABEND                                    55410000
554200             DP013-NO-ROLLBACK     TO TRUE                        55420000
554300         MOVE '9100-READ-SEL-QUEUE'                               55430000
554400                                   TO DP013-PARAGRAPH             55440000
554500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   55450000
554600                                   TO DP013-MESSAGE-TEXT (1)      55460000
554700         PERFORM DP013-0000-PROCESS-ABEND                         55470000
554800     END-IF.                                                      55480000
554900                                                                  55490000
555000                                                                  55500000
555100*----------------------------------------------------------------*55510000
555200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *55520000
555300*----------------------------------------------------------------*55530000
555400 9200-REWRITE-SEL-QUEUE.                                          55540000
555500     EXEC CICS                                                    55550000
555600          WRITEQ TS                                               55560000
555700              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      55570000
555800              FROM   (RC037-DC-SELECT-RECORD)                     55580000
555900              ITEM   (ASC-SEL-ITEM)                               55590000
556000              RESP   (PV-CICS-RESP)                               55600000
556100              REWRITE                                             55610000
556200     END-EXEC.                                                    55620000
556300                                                                  55630000
556400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           55640000
556500         CONTINUE                                                 55650000
556600     ELSE                                                         55660000
556700         SET DP013-CICS-ABEND                                     55670000
556800             DP013-NO-ROLLBACK     TO TRUE                        55680000
556900         MOVE '9200-REWRITE-SEL-QUEUE'                            55690000
557000                                   TO DP013-PARAGRAPH             55700000
557100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   55710000
557200                                   TO DP013-MESSAGE-TEXT (1)      55720000
557300         PERFORM DP013-0000-PROCESS-ABEND                         55730000
557400     END-IF.                                                      55740000
557500                                                                  55750000
557600******************************************************************55760000
557700* READ AN ITEM FROM THE INPUT TROUBLE RECORD                     *55770000
557800* TEMP STORAGE QUEUE.                                            *55780000
557900******************************************************************55790000
558000 9500-READ-TRB-QUEUE.                                             55800000
558100                                                                  55810000
558200     EXEC CICS                                                    55820000
558300         READQ TS                                                 55830000
558400             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        55840000
558500             INTO  (TM003-TRB-QUEUE-WORK-AREA)                    55850000
558600             ITEM  (PC-01-COMP)                                   55860000
558700             RESP  (PV-CICS-RESP)                                 55870000
558800     END-EXEC.                                                    55880000
558810                                                                  55881000
558820     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        55882000
558830         CONTINUE                                                 55883000
558840     ELSE                                                         55884000
558850         SET DP013-LOGIC-ABEND                                    55885000
558860             DP013-NO-ROLLBACK   TO TRUE                          55886000
558870         MOVE '9500-READ-TRB-QUEUE'                               55887000
558880                                 TO DP013-PARAGRAPH               55888000
558890         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    55889000
558900                                 TO DP013-MESSAGE-TEXT (1)        55890000
558901         MOVE ASC-TRB-QUEUE-NAME-IN                               55890100
558902                                 TO DP013-MESSAGE-TEXT (2)        55890200
558903         PERFORM DP013-0000-PROCESS-ABEND                         55890300
558904     END-IF.                                                      55890400
558905                                                                  55890500
558906 9600-WRITE-TRB-QUEUE.                                            55890600
558907                                                                  55890700
558908*  RCKCS277 WRITES ONLY 1 QUEUE RECORD SO THE ITEM NUMBER         55890800
558909*  WILL ALWAYS EQUAL 1.                                           55890900
558910     EXEC CICS WRITEQ TS                                          55891000
558911             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        55891100
558912             FROM  (TM003-TRB-QUEUE-WORK-AREA)                    55891200
558913             ITEM  (PC-01-COMP)                                   55891300
558914             RESP  (PV-CICS-RESP)                                 55891400
558915             REWRITE                                              55891500
558916     END-EXEC.                                                    55891600
558917                                                                  55891700
558918     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       55891800
558919         SET DP013-CICS-ABEND                                     55891900
558920             DP013-NO-ROLLBACK   TO TRUE                          55892000
558921         MOVE '9600-WRITE-TRB-QUEUE'                              55892100
558922                                 TO DP013-PARAGRAPH               55892200
558923         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'55892300
558924                                 TO DP013-MESSAGE-TEXT(1)         55892400
558925         PERFORM DP013-0000-PROCESS-ABEND                         55892500
558926     END-IF.                                                      55892600
558927                                                                  55892700
558928/                                                                 55892800
558929 9700-WRITE-TO-CICS-LOG.                                          55892900
558930                                                                  55893000
558940     EXEC CICS                                                    55894000
558950          WRITEQ TD                                               55895000
558960          QUEUE  ('CSSL')                                         55896000
558970          FROM  (PV-CICS-MSG-AREA)                                55897000
558980          LENGTH  (PV-COMMAREA-LENGTH)                            55898000
558990          RESP  (PV-CICS-RESP)                                    55899000
559000     END-EXEC.                                                    55900000
559100                                                                  55910000
559200     MOVE SPACES TO PV-CICS-MSG-AREA.                             55920000
559300******************************************************************55930000
559400*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *55940000
559500*    AND THE ERROR SWITCHES.                                     *55950000
559600******************************************************************55960000
559700 9900-SOFT-ABORT.                                                 55970000
559800     SET PS-ERROR         TO TRUE.                                55980000
559900     SET DP020-MSG-FATAL  TO TRUE.                                55990000
560000     IF SQLCODE = -913                                            56000000
560100         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 56010000
560200     END-IF.                                                      56020000
560300     IF  PS-UNITS-WORKED-ERROR                                    56030000
560400         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 56040000
560500     END-IF.                                                      56050000
560600                                                                  56060000
560700     PERFORM 9901-BACKUP.                                         56070000
560800     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          56080000
560900     PERFORM 0001-CALL-CICS-ARCH-API.                             56090000
561000                                                                  56100000
561100 9901-BACKUP.                                                     56110000
561200     EXEC CICS SYNCPOINT                                          56120000
561300          ROLLBACK                                                56130000
561400     END-EXEC.                                                    56140000
561500                                                                  56150000
561600*----------------------------------------------------------------*56160000
561700*    ABEND PROCESSOR MODULE                                      *56170000
561800*----------------------------------------------------------------*56180000
561900                                                                  56190000
562000     COPY DPPD013.                                                56200000
