000100 IDENTIFICATION DIVISION.                                         00010000
000200*---------------------------------------------------------------  00020000
000300 PROGRAM-ID.    SAKUT011.                                         00030012
000400 AUTHOR.        GAYLE HAUPT.                                      00040000
000500 DATE-WRITTEN.  MAY, 2004.                                        00050000
000600                                                                  00060000
000700*---------------------------------------------------------------  00070000
000800* THIS PROGRAM CREATES A DAILY DEPOSITORY EXTRACT FOR USE         00080000
000900* IN THE CHESAPEAKE (T-RECS) AUTOMATED BANK RECONCILIATION        00090000
001000* PROCESS.  THE OUTPUT FILE LAYOUT WAS PROVIDED BY T-RECS.        00100000
001100*                                                                 00110000
001200* THE EXTRACT WILL CONTAIN CASH, CHECK AND COIN/CURRENCY          00120000
001300* DEPOSITS AS REPORTED ON FROM THE CASH OFFICE APPLICATION.       00130000
001400* THIS PROGRAM IS A COMBINATION OF SAKUT004 AND SAKUT005.         00140000
001500* SAKUT004 PRODUCES A MONTHLY CASH AND CHECK DEPOSIT FILE;        00150000
001600* SAKUT005 PRODUCES A MONTHLY COIN/CURRENCY DELIVERY FILE.        00160000
001700*                                                                 00170000
001800* THE FILE CONTAINS DEPOSIT INFORMATION BY DATE BY STORE.         00180000
001900* EACH STORE MAY HAVE UP TO THREE RECORDS IN THE FILE:            00190000
002000* ONE FOR A SUMMARY OF CASH DEPOSITS (00 TRAN TYPE),              00200000
002100* ONE FOR CHECK DEPOSITS (01 TRAN TYPE) AND ONE FOR               00210000
002200* CASH/CURRENCY DELIVERIES (02 TRAN TYPE).   POSITIVE             00220000
002300* CASH/CHECK DEPOSIT AMOUNTS ARE FLAGGED AS A DEBIT;              00230000
002400* NEGATIVE CASH/CHECK DEPOSIT AMOUNTS ARE FLAGGED AS A            00240000
002500* CREDIT.   POSITIVE COIN/CURRENCY DELIVERIES ARE FLAGGED         00250000
002600* AS A CREDIT; NEGATIVE COIN/CURRENCY DELIVERIES ARE              00260000
002700* FLAGGED AS A DEBIT.                                             00270000
002800*                                                                 00280000
002900* AS THE FILE IS CREATED USING CASH OFFICE DATA, THERE MAY        00290000
003000* BE A DIFFERENCE OF SEVERAL DAYS BETWEEN THE SALES DATE AND      00300000
003100* THE FILE CREATION (POST) DATE.  THIS TIME LAG ALLOWS THE        00310000
003200* CASH OFFICE PERSONNEL TIME TO BALANCE AND THE SALES             00320000
003300* AUDITORS TIME TO VERIFY THE RESULTS.                            00330000
003400*                                                                 00340000
003500* AN EMAIL FILE IS ALSO CREATED CONTAINING THE SALES DATE         00350000
003600* FOR WHICH THE DEPOSIT FILE WAS CREATED.                         00360000
003700*---------------------------------------------------------------  00370000
003800*---------------------------------------------------------------  00380000
003900* HISTORY LOG:                                                    00390000
004000*                                                                 00400000
004100* DATE: 04/25/07                                                  00410000
004200* WR/IR#: WR32511                                                 00420000
004300* PROGRAMMER: JIM HUNTER                                          00430000
004400* DESCRIPTION: READ THE SOLUTRAN STORE FILE.  IF THE CHECK        00440000
004500*              RECORD IS FOR A STORE FOUND ON THE SOLUTRAN FILE   00450000
004600*              AND THE DP-TRAN-TYP = '01', SET THE                00460000
004700*              DP-REFERENCE-4 (NEW) FIELD TO 'BOC'.               00470000
004000*                                                                 00471015
004100* DATE: 06/05/23                                                  00472016
004200* WR/IR#: CHG0288970                                              00473015
004300* PROGRAMMER: JEAN KURK                                           00474015
004400* DESCRIPTION: REMOVE SOLUTRAN LOGIC (COPYBOOK CRRD083)           00475017
004800*---------------------------------------------------------------  00480000
004900 ENVIRONMENT DIVISION.                                            00490000
005000*---------------------------------------------------------------  00500000
005100 CONFIGURATION SECTION.                                           00510000
005200 SOURCE-COMPUTER. IBM-3090.                                       00520000
005300 OBJECT-COMPUTER. IBM-3090.                                       00530000
005400                                                                  00540000
005500 INPUT-OUTPUT SECTION.                                            00550000
005600                                                                  00560000
005700 FILE-CONTROL.                                                    00570000
005800                                                                  00580000
005900     SELECT POS-DATE-CARD-FILE                                    00590000
006000       ASSIGN TO INPUT01.                                         00600000
006100                                                                  00610000
006200*    SELECT SOLUTRAN-STORE-FILE                                   00620018
006300*      ASSIGN TO INPUT02.                                         00630018
006400                                                                  00640000
006500     SELECT DAILY-DEPOSITORY-FILE1                                00650000
006600       ASSIGN TO OUT01.                                           00660000
006700                                                                  00670000
006800     SELECT DAILY-DEPOSITORY-FILE2                                00680000
006900       ASSIGN TO OUT02.                                           00690000
007000                                                                  00700000
007100     SELECT EMAIL-FILE                                            00710000
007200       ASSIGN TO OUT03.                                           00720000
007300                                                                  00730000
007400*---------------------------------------------------------------  00740000
007500 DATA DIVISION.                                                   00750000
007600*---------------------------------------------------------------  00760000
007700 FILE SECTION.                                                    00770000
007800                                                                  00780000
007900 FD  POS-DATE-CARD-FILE                                           00790000
008000     RECORDING MODE IS F                                          00800000
008100     BLOCK CONTAINS 0 CHARACTERS                                  00810000
008200     LABEL RECORDS ARE STANDARD.                                  00820000
008300                                                                  00830000
008400 01  POS-DATE-CARD-REC             PIC X(080).                    00840000
008500                                                                  00850000
008600*FD  SOLUTRAN-STORE-FILE                                          00860018
008700*    RECORDING MODE IS F                                          00870018
008800*    BLOCK CONTAINS 0 RECORDS                                     00880018
008900*    LABEL RECORDS ARE STANDARD.                                  00890018
009000*                                                                 00900018
009100*01  SOLUTRAN-STORE-RECORD         PIC X(80).                     00910018
009200                                                                  00920000
009300 FD  DAILY-DEPOSITORY-FILE1                                       00930000
009400     RECORDING MODE IS F                                          00940000
009500     BLOCK CONTAINS 0 CHARACTERS                                  00950000
009600     LABEL RECORDS ARE STANDARD.                                  00960000
009700                                                                  00970000
009800 01  DAILY-DEPOSITORY-REC1         PIC X(775).                    00980000
009900                                                                  00990000
010000 FD  DAILY-DEPOSITORY-FILE2                                       01000000
010100     RECORDING MODE IS F                                          01010000
010200     BLOCK CONTAINS 0 CHARACTERS                                  01020000
010300     LABEL RECORDS ARE STANDARD.                                  01030000
010400                                                                  01040000
010500 01  DAILY-DEPOSITORY-REC2         PIC X(775).                    01050000
010600                                                                  01060000
010700 FD  EMAIL-FILE                                                   01070000
010800     RECORDING MODE IS F                                          01080000
010900     LABEL RECORDS ARE STANDARD                                   01090000
011000     BLOCK CONTAINS 0 RECORDS.                                    01100000
011100                                                                  01110000
011200 01  EMAIL-RECORD                PIC X(80).                       01120000
011300                                                                  01130000
011400 WORKING-STORAGE SECTION.                                         01140000
011500*---------------------------------------------------------------  01150000
011600*  KOHLS DATE ROUTINE                                             01160000
011700*---------------------------------------------------------------  01170000
011800     COPY DPWS500.                                                01180000
011900*---------------------------------------------------------------  01190000
012000 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01200000
012100                                                  COMP SYNC.      01210000
012200     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01220000
012300     88  AC-DB2-ERROR                             VALUE +4013.    01230000
012400     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    01240000
012500                                                                  01250000
012600*---------------------------------------------------------------  01260000
012700* RECORD LAYOUT FOR INPUT DATE CARD                               01270000
012800*---------------------------------------------------------------  01280000
012900 01  CC-CONTROL-DATE.                                             01290000
013000     05  CC-DATE-1                     PIC  X(10) VALUE SPACE.    01300000
013100     05  FILLER                        PIC  X(01) VALUE SPACE.    01310000
013200     05  CC-DATE-2                     PIC  X(10) VALUE SPACE.    01320000
013300     05  FILLER                        PIC  X(59) VALUE SPACE.    01330000
013400                                                                  01340000
013500*---------------------------------------------------------------* 01350000
013600*  LAYOUT FOR INPUT STORE FILE                                    01360000
013700*---------------------------------------------------------------* 01370000
013800*    COPY CRRD083.                                                01380017
013900                                                                  01390000
014000*---------------------------------------------------------------  01400000
014100* PC- PROGRAM CONSTANTS                                           01410000
014200*---------------------------------------------------------------  01420000
014300 01  PC-PROGRAM-CONSTANTS.                                        01430000
014400     05  PC-CURRENT-PROGRAM-NAME       PIC  X(08) VALUE           01440000
014500                                                    'SAKUT011'.   01450012
014600     05  PC-CASH-VARIANCE              PIC  X(16) VALUE           01460000
014700                                            'CASH VARIANCE   '.   01470000
014800     05  PC-CHECK-VARIANCE             PIC  X(16) VALUE           01480000
014900                                            'CHECK VARIANCE  '.   01490000
015000     05  PC-COIN-CURR-VARIANCE         PIC  X(16) VALUE           01500000
015100                                            'COIN-CURR VAR   '.   01510000
015200     05  PC-CASH-TRAN-TYPE             PIC  X(02) VALUE '00'.     01520000
015300     05  PC-CHECK-TRAN-TYPE            PIC  X(02) VALUE '01'.     01530000
015400     05  PC-COIN-CURR-TRAN-TYPE        PIC  X(02) VALUE '02'.     01540000
015500     05  PC-DEBIT                      PIC  X(01) VALUE 'D'.      01550000
015600     05  PC-CREDIT                     PIC  X(01) VALUE 'C'.      01560000
015700     05  PC-D                          PIC  X(01) VALUE 'D'.      01570000
015800                                                                  01580000
015900*---------------------------------------------------------------  01590000
016000* PS- PROGRAM SWITCHES                                            01600000
016100*---------------------------------------------------------------  01610000
016200 01  PS-PROGRAM-SWITCHES.                                         01620000
016300     05  PS-END-OF-CARD-FILE-SW        PIC  X(01) VALUE 'N'.      01630000
016400         88  PS-END-OF-CARD-FILE-Y                VALUE 'Y'.      01640000
016500*    05  PS-END-OF-STORE-FILE-SW       PIC  X(01) VALUE 'N'.      01650018
016600*        88  PS-NOT-END-OF-STORE-FILE             VALUE 'N'.      01660018
016700*        88  PS-END-OF-STORE-FILE                 VALUE 'Y'.      01670018
016800     05  PS-END-OF-DEP-CSR-SW          PIC  X(01) VALUE 'N'.      01680000
016900         88  PS-END-OF-DEP-CSR-Y                  VALUE 'Y'.      01690000
017000         88  PS-END-OF-DEP-CSR-N                  VALUE 'N'.      01700000
017100     05  PS-COIN-CURR-SW               PIC  X(01) VALUE 'N'.      01710000
017200         88  PS-COIN-CURR-Y                       VALUE 'Y'.      01720000
017300         88  PS-COIN-CURR-N                       VALUE 'N'.      01730000
017400*    05  PS-STORE-SW                   PIC  X(01) VALUE 'N'.      01740018
017500*        88  PS-ALL-STORES                        VALUE 'Y'.      01750018
017600*        88  PS-NOT-ALL-STORES                    VALUE 'N'.      01760018
017700                                                                  01770000
017800*---------------------------------------------------------------  01780000
017900* DAILY DEPOSIT EXTRACT RECORD LAYOUT                             01790000
018000*---------------------------------------------------------------  01800000
018100 01  DP-DAILY-DEPOSIT-REC.                                        01810000
018200     05  DP-RECORD-TYPE                PIC  X(01) VALUE 'D'.      01820000
018300     05  DP-IMPORT-ACCT-ID             PIC  X(04) VALUE SPACE.    01830000
018400* THE FILLER BELOW IS THE REMAINDER OF THE IMPORT-ACCT-ID         01840000
018500* FIELD; THE FIELD IS 35 CHARACTERS IN LENGTH, BUT ONLY THE       01850000
018600* FIRST FOUR CHARACTERS ARE USED FOR THE STORE NUMBER.            01860000
018700     05  FILLER                        PIC  X(31) VALUE SPACE.    01870000
018800     05  DP-POST-DATE                  PIC  X(08) VALUE SPACE.    01880000
018900     05  DP-EFFECTIVE-DATE             PIC  X(08) VALUE SPACE.    01890000
019000     05  DP-TRAN-TYPE                  PIC  X(02) VALUE SPACE.    01900000
019100     05  DP-DEBIT-CREDIT-IND           PIC  X(01) VALUE SPACE.    01910000
019200     05  DP-DEPOSIT-AMOUNT             PIC  9(18)V9(5)            01920000
019300                                                  VALUE ZERO.     01930000
019400     05  DP-REFERENCE-1                PIC  X(04) VALUE SPACE.    01940000
019500* THE FIRST FILLER BELOW IS THE REMAINDER OF THE REFERENCE-1      01950000
019600* FIELD; THE FIELD IS 35 CHARACTERS IN LENGTH, BUT ONLY THE       01960000
019700* FIRST FOUR CHARACTERS ARE USED FOR THE STORE NUMBER.            01970000
019800     05  FILLER                        PIC  X(31) VALUE SPACE.    01980000
019900     05  DP-EFFECTIVE-DATE-2           PIC  X(08) VALUE SPACE.    01990000
020000     05  FILLER                        PIC  X(24) VALUE SPACE.    02000000
020100* DP-REFERENCE-4 WAS ADDED TO CONTAIN 'BOC' FOR STORES            02010000
020200* CONVERTED TO SOLUTRAN.                                          02020000
020300     05  DP-REFERENCE-4                PIC  X(3)  VALUE SPACE.    02030000
020400     05  FILLER                        PIC  X(13) VALUE SPACE.    02040000
020500     05  DP-REFERENCE-5                PIC  X(16) VALUE SPACE.    02050000
020600     05  FILLER                        PIC  X(598) VALUE SPACE.   02060000
020700                                                                  02070000
020800*---------------------------------------------------------------  02080000
020900* EMAIL RECORD LAYOUT                                             02090000
021000*---------------------------------------------------------------  02100000
021100 01  EM-EMAIL-LINE1.                                              02110000
021200     05  FILLER                        PIC  X(37) VALUE           02120000
021300         'TRECS DEPOSIT FILE WAS CREATED FOR:  '.                 02130000
021400     05  EM-LINE1-DATE                 PIC  X(10) VALUE SPACE.    02140000
021500     05  FILLER                        PIC  X(01) VALUE SPACE.    02150000
021600     05  EM-LINE1-DATE-2               PIC  X(10) VALUE SPACE.    02160000
021700     05  FILLER                        PIC  X(22) VALUE SPACE.    02170000
021800                                                                  02180000
021900*---------------------------------------------------------------  02190000
022000* PV- PROGRAM WORKING VARIABLES                                   02200000
022100*---------------------------------------------------------------  02210000
022200 01  PV-PROGRAM-VARIABLES.                                        02220000
022300     05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    02230000
022400     05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    02240000
022500     05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    02250000
022600     05  PV-DB2-OPERATION              PIC  X(30) VALUE SPACE.    02260000
022700     05  PV-DB2-CTG-CDE                PIC  X(03) VALUE SPACE.    02270000
022800     05  PV-DEP-CSR-CNT                PIC S9(07) VALUE ZERO.     02280000
022900*    05  PV-NUMERIC-STORE              PIC  9(04) VALUE ZEROES.   02290018
023000*    05  PV-STORE-SUB                  PIC  9(04) VALUE ZEROES.   02300018
023200     05  PV-TSAADDP-CSR-CNT            PIC  9(07) VALUE ZERO.     02310000
023300     05  PV-TSAADSU-CNT                PIC  9(07) VALUE ZERO.     02320000
023400     05  PV-COUNT-DEP-RECS             PIC  9(07) VALUE ZERO.     02330000
JG         05  PV-CHECK-DEP-COUNT       PIC S9(09)   VALUE ZERO         02331114
JG                                                   COMP.              02331214
JG         05  PV-PREVIOUS-STR-NBR           PIC  S9(4) COMP            02333014
JG                                                      VALUE ZERO.     02340014
023900*01  PV-HOLD-ROLLOUT-STORES.                                      02350018
023910*    05  PV-HOLD-STORES OCCURS 9999 TIMES.                        02360018
023920*        10  PV-HOLD-STR              PIC 9(04)    VALUE ZEROES.  02370018
023930*        10  PV-HOLD-EFFECT-DTE       PIC X(10)    VALUE SPACES.  02380018
023960                                                                  02390000
024010 01  PV-DATE-FIELDS.                                              02400000
024100     05  PV-DATE                       PIC  X(10) VALUE SPACE.    02410000
024200     05  PV-SLS-DTE-ISO-2              PIC  X(10) VALUE SPACE.    02420000
024300     05  PV-SLS-DTE-ISO                PIC  X(10) VALUE SPACE.    02430000
024400     05  PV-SLS-DTE-CCYYMMDD-2         PIC  X(08) VALUE SPACE.    02440000
024500     05  PV-SLS-DTE-CCYYMMDD           PIC  X(08) VALUE SPACE.    02450000
024600                                                                  02460000
024700     05  PV-CPU-DTE-CCYYMMDD.                                     02470000
024800         10  PV-CPU-DTE-CC             PIC  X(02) VALUE '20'.     02480000
024900         10  PV-CPU-DTE-YYMMDD         PIC  X(06) VALUE SPACE.    02490000
025000                                                                  02500000
025100*---------------------------------------------------------------  02510000
025200*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            02520000
025300*---------------------------------------------------------------  02530000
025400     COPY DPWS004.                                                02540000
025500                                                                  02550000
025600*---------------------------------------------------------------  02560000
025700*  DB2 COMMUNICATION AREA.                                        02570000
025800*---------------------------------------------------------------  02580000
025900     EXEC SQL                                                     02590000
026000          INCLUDE SQLCA                                           02600000
026100     END-EXEC.                                                    02610000
026200                                                                  02620000
026300*---------------------------------------------------------------  02630000
026400*  DB2 TABLE TSAADDP - CASH OFFICE DEPOSIT TABLE                  02640000
026500*---------------------------------------------------------------  02650000
026600     EXEC SQL                                                     02660000
026700          INCLUDE TSAADDP                                         02670000
026800     END-EXEC.                                                    02680000
026900                                                                  02690000
027000*---------------------------------------------------------------  02700000
027100*  DB2 TABLE TSAADSU - CASH OFFICE DATA TABLE                     02710000
027200*---------------------------------------------------------------  02720000
027300     EXEC SQL                                                     02730000
027400          INCLUDE TSAADSU                                         02740000
027500     END-EXEC.                                                    02750000
027600                                                                  02760000
027700*---------------------------------------------------------------  02770000
027800*  CURSOR FOR FETCHING DEPOSITS FROM TSAADDP                      02780000
027900*  ONLY GET DATA FOR THOSE STORES THAT HAVE STM <> 0.             02790000
028000*  IF THEY DO NOT HAVE SALES ON A GIVEN DAY, THEY SHOULD NOT      02800000
028100*  HAVE A DEPOSIT.   THIS WOULD REPRESENT A HOLIDAY.              02810000
028200*  THE ADJUSTED AMT (ADJ_AMT) IS USED BECAUSE THIS IS THE AUDITED 02820000
028300*  AMOUNT.                                                        02830000
028400*---------------------------------------------------------------  02840000
028500     EXEC SQL                                                     02850000
028600         DECLARE DEPOSIT-CURSOR CURSOR                            02860000
028700         FOR SELECT DDP.SLS_DTE                                   02870000
028800                   ,DDP.STR_NBR                                   02880000
028900                   ,DDP.TNDR_TYP_CDE                              02890000
029000                   ,DDP.STRT_TMST                                 02900000
029100                   ,DDP.TNDR_AMT                                  02910000
029200         FROM       TSAADDP DDP                                   02920000
029300         WHERE      DDP.SLS_DTE     IN(:PV-SLS-DTE-ISO,           02930000
029400                                       :PV-SLS-DTE-ISO-2)         02940000
029500*        AND  EXISTS                                              02950000
029600*            (SELECT 1                                            02960000
029700*             FROM   TSAADSU DSU                                  02970000
029800*             WHERE  DSU.SLS_DTE      = DDP.SLS_DTE               02980000
029900*             AND    DSU.STR_NBR      = DDP.STR_NBR               02990000
030000*             AND    DSU.SUM_CTG_CDE IN ('STM','TMR')             03000000
030100*             AND    DSU.ADJ_AMT     ^= 0)                        03010000
030200         ORDER BY DDP.SLS_DTE, DDP.STR_NBR, DDP.STRT_TMST         03020000
030300         WITH UR                                                  03030000
030400     END-EXEC.                                                    03040000
030500                                                                  03050000
030600*---------------------------------------------------------------  03060000
030700 PROCEDURE DIVISION.                                              03070000
030800*---------------------------------------------------------------  03080000
030900 0000-MAINLINE.                                                   03090000
031000                                                                  03100000
031100     PERFORM 1000-INITIALIZE.                                     03110000
031200                                                                  03120000
031300     PERFORM 3000-PROCESS-DEPOSIT-DATA                            03130000
031400       UNTIL PS-END-OF-DEP-CSR-Y.                                 03140000
031500                                                                  03150000
031600     PERFORM 9000-END-OF-JOB-ROUTINE.                             03160000
031700                                                                  03170000
031800     STOP RUN.                                                    03180000
031900                                                                  03190000
032000*0000-EXIT.                                                       03200000
032100                                                                  03210000
032200*---------------------------------------------------------------  03220000
032300* 1000-INITIALIZE.                                                03230000
032400*     OPENS UP FILES, READ IN DATE CONTROL CARD, INITIALIZES      03240000
032500*     RECORDS, INITIALIZES CONSTANT VARIABLES, OPENS THE          03250000
032600*     DEPOSIT-CURSOR.                                             03260000
032700*---------------------------------------------------------------  03270000
032800 1000-INITIALIZE.                                                 03280000
032900                                                                  03290000
033000     OPEN INPUT POS-DATE-CARD-FILE                                03300000
033100*         INPUT SOLUTRAN-STORE-FILE                               03310018
033200          OUTPUT DAILY-DEPOSITORY-FILE1                           03320000
033300          OUTPUT DAILY-DEPOSITORY-FILE2                           03330000
033400          OUTPUT EMAIL-FILE.                                      03340000
033500                                                                  03350000
033600     READ POS-DATE-CARD-FILE INTO CC-CONTROL-DATE                 03360000
033700        AT END                                                    03370000
033800           SET PS-END-OF-CARD-FILE-Y TO TRUE.                     03380000
033900                                                                  03390000
034000     CLOSE POS-DATE-CARD-FILE.                                    03400000
034100                                                                  03410000
034200     IF PS-END-OF-CARD-FILE-Y                                     03420000
034300         MOVE '1000-INITIALIZE'    TO PV-PARAGRAPH-NAME           03430000
034400         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  03440000
034500         SET AC-CONTROL-CARD-ERROR TO TRUE                        03450000
034600         PERFORM 9999-ABEND                                       03460000
034700     END-IF.                                                      03470000
034800                                                                  03480000
034900     DISPLAY PC-CURRENT-PROGRAM-NAME                              03490000
035000             ' - CONTROL CARD = (' CC-CONTROL-DATE  ')'.          03500000
035100                                                                  03510000
035200     MOVE CC-DATE-1                   TO PV-DATE.                 03520000
035300     PERFORM 1100-VERIFY-INPUT-DATE.                              03530000
035400     MOVE DPG55-DB2-ISO-DATE-FMT      TO PV-SLS-DTE-ISO.          03540000
035500     MOVE DPG55-DB2-ISO-DATE          TO PV-SLS-DTE-CCYYMMDD.     03550000
035600                                                                  03560000
035700     IF CC-DATE-2                      = SPACE                    03570000
035800        MOVE DPG55-DB2-ISO-DATE-FMT   TO PV-SLS-DTE-ISO-2         03580000
035900        MOVE DPG55-DB2-ISO-DATE       TO PV-SLS-DTE-CCYYMMDD-2    03590000
036000     ELSE                                                         03600000
036100        MOVE CC-DATE-2                TO PV-DATE                  03610000
036200        PERFORM 1100-VERIFY-INPUT-DATE                            03620000
036300        MOVE DPG55-DB2-ISO-DATE-FMT   TO PV-SLS-DTE-ISO-2         03630000
036400        MOVE DPG55-DB2-ISO-DATE       TO PV-SLS-DTE-CCYYMMDD-2    03640000
036500     END-IF.                                                      03650000
036600                                                                  03660000
036700*    PERFORM 1500-READ-SOLUTRAN-STORE-FILE.                       03670018
036800                                                                  03680000
036900*    PERFORM 1200-PROCESS-SOLUTRAN-FILE                           03690018
037000*       UNTIL PS-END-OF-STORE-FILE.                               03700018
037100                                                                  03710000
037200     INITIALIZE DP-DAILY-DEPOSIT-REC.                             03720000
037300                                                                  03730000
037400     PERFORM 2000-OPEN-DEP-CURSOR.                                03740000
037500                                                                  03750000
037600     PERFORM 2100-FETCH-DEP-CURSOR.                               03760000
037700                                                                  03770000
037800*1000-EXIT.                                                       03780000
037900                                                                  03790000
038000*---------------------------------------------------------------  03800000
038100* 1100-VERIFY-INPUT-DATE                                          03810000
038200*     CALL KOHLS CALENDAR ROUTINE:                                03820000
038300*         PASS: CONTROL CARD POS DATE (CCYY-MM-DD FORMAT).        03830000
038400*---------------------------------------------------------------  03840000
038500                                                                  03850000
038600 1100-VERIFY-INPUT-DATE.                                          03860000
038700                                                                  03870000
038800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03880000
038900                                                                  03890000
039000     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   03900000
039100     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   03910000
039200     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   03920000
039300     MOVE PV-DATE                      TO DPG52-DB2-ISO-DATE-FMT. 03930000
039400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03940000
039500                                             DPG54 DPG55 DPG56.   03950000
039600     EVALUATE TRUE                                                03960000
039700         WHEN DPG54-SEVERE-ERROR                                  03970000
039800         WHEN DPG54-DATE-INVALID                                  03980000
039900             MOVE '1115-CONVERT-INPUT-DATE'                       03990000
040000                                   TO PV-PARAGRAPH-NAME           04000000
040100             MOVE 'ERROR CONVERTING INPUT CARD DATE'              04010000
040200                                   TO PV-OPERATION-MSG-1          04020000
040300             SET AC-CALENDAR-ROUTINE-ERROR                        04030000
040400                                   TO TRUE                        04040000
040500             MOVE DPG54-ERROR-MESSAGE                             04050000
040600                                   TO PV-OPERATION-MSG-2          04060000
040700             PERFORM 9999-ABEND                                   04070000
040800     END-EVALUATE.                                                04080000
040900                                                                  04090000
041000     ACCEPT PV-CPU-DTE-YYMMDD    FROM DATE.                       04100000
041100                                                                  04110000
041200*1100-EXIT.                                                       04120000
041300                                                                  04130000
041400******************************************************************04140000
041500* PROCESS THE SOLUTRAN STORE FILE.                                04150000
041600******************************************************************04160000
041700*1200-PROCESS-SOLUTRAN-FILE.                                      04170018
041800*                                                                 04180018
041900*    PERFORM 1600-MOVE-STORES.                                    04190018
042200*                                                                 04200018
042300*    IF PS-END-OF-STORE-FILE                                      04210018
042400*        CONTINUE                                                 04220018
042500*    ELSE                                                         04230018
042600*        PERFORM 1500-READ-SOLUTRAN-STORE-FILE                    04240018
042700*    END-IF.                                                      04250018
042710                                                                  04260000
042800******************************************************************04270000
042900* READ STORE FILE INTO A WORKING STORAGE TABLE.                   04280000
043000******************************************************************04290000
043100*1500-READ-SOLUTRAN-STORE-FILE.                                   04300018
043200*                                                                 04310018
043300*    READ SOLUTRAN-STORE-FILE INTO SA083-SOLUTRAN-STORE-RECORD    04320018
043400*       AT END                                                    04330018
043500*          SET PS-END-OF-STORE-FILE TO TRUE.                      04340018
043600                                                                  04350000
043700******************************************************************04360000
043800* EDIT THE DB2 DATE TO MAKE SURE THAT IT IS VALID.                04370000
043900******************************************************************04380000
044000*1600-MOVE-STORES.                                                04390018
044010                                                                  04400000
044200*    IF SA083-STR-NBR = 'ALL'                                     04410018
044300*        SET PS-ALL-STORES                                        04420018
044400*            PS-END-OF-STORE-FILE TO TRUE                         04430018
044600*    ELSE                                                         04440018
044700*        MOVE SA083-STR-NBR TO PV-STORE-SUB                       04450018
044800*        MOVE SA083-STR-NBR TO PV-HOLD-STR(PV-STORE-SUB)          04460018
044810*        MOVE SA083-EFFECT-DTE TO PV-HOLD-EFFECT-DTE(PV-STORE-SUB)04470018
044900*    END-IF.                                                      04480018
045000                                                                  04490000
045100*---------------------------------------------------------------  04500000
045200* 2000-OPEN-DEP-CURSOR                                            04510000
045300*    OPEN THE DEPOSIT CURSOR AND CHECK FOR ERRORS.                04520000
045400*---------------------------------------------------------------  04530000
045500                                                                  04540000
045600 2000-OPEN-DEP-CURSOR.                                            04550000
045700                                                                  04560000
045800     EXEC SQL                                                     04570000
045900          OPEN DEPOSIT-CURSOR                                     04580000
046000     END-EXEC.                                                    04590000
046100                                                                  04600000
046200     EVALUATE TRUE                                                04610000
046300         WHEN SQLCODE = ZERO                                      04620000
046400              CONTINUE                                            04630000
046500         WHEN SQLWARN0 NOT EQUAL SPACE                            04640000
046600         WHEN SQLCODE NOT EQUAL ZERO                              04650000
046700             MOVE '2000-OPEN-DEP-CURSOR'                          04660000
046800                                 TO PV-PARAGRAPH-NAME             04670000
046900             MOVE 'ERROR ON OPEN OF DEPOSIT-CURSOR'               04680000
047000                                 TO PV-DB2-OPERATION              04690000
047100             PERFORM 9800-SQL-ABEND                               04700000
047200     END-EVALUATE.                                                04710000
047300                                                                  04720000
047400*2000-EXIT.                                                       04730000
047500                                                                  04740000
047600*---------------------------------------------------------------  04750000
047700* 2100-FETCH-DEP-CURSOR                                           04760000
047800*    FETCH THE DEPOSIT CURSOR AND CHECK FOR ERRORS.               04770000
047900*---------------------------------------------------------------  04780000
048000                                                                  04790000
048100 2100-FETCH-DEP-CURSOR.                                           04800000
048200                                                                  04810000
048300     EXEC SQL                                                     04820000
048400          FETCH DEPOSIT-CURSOR                                    04830000
048500           INTO :SAADDP-SLS-DTE                                   04840000
048600               ,:SAADDP-STR-NBR                                   04850000
048700               ,:SAADDP-TNDR-TYP-CDE                              04860000
048800               ,:SAADDP-STRT-TMST                                 04870000
048900               ,:SAADDP-TNDR-AMT                                  04880000
049000     END-EXEC.                                                    04890000
049100                                                                  04900000
049200     EVALUATE TRUE                                                04910000
049300         WHEN SQLCODE = ZERO                                      04920000
049400             SET PS-END-OF-DEP-CSR-N  TO TRUE                     04930000
049500             ADD +1                   TO PV-TSAADDP-CSR-CNT       04940000
049600         WHEN SQLCODE = +100                                      04950000
049700             SET PS-END-OF-DEP-CSR-Y  TO TRUE                     04960000
049800         WHEN SQLWARN0 NOT EQUAL SPACE                            04970000
049900         WHEN SQLCODE NOT EQUAL ZERO                              04980000
050000             MOVE '2100-FETCH-DEP-CURSOR'                         04990000
050100                                      TO PV-PARAGRAPH-NAME        05000000
050200             MOVE SQLCODE             TO PV-DB2-OPERATION         05010000
050300             MOVE SAADDP-TNDR-TYP-CDE TO PV-DB2-CTG-CDE           05020000
050400             PERFORM 9800-SQL-ABEND                               05030000
050500     END-EVALUATE.                                                05040000
050600                                                                  05050000
050700*2100-EXIT.                                                       05060000
050800                                                                  05070000
050900*-------------------------------------------------------------    05080000
051000* 2200-CLOSE-DEP-CURSOR.                                          05090000
051100*     CLOSE THE DEPOSIT CURSOR.                                   05100000
051200*-------------------------------------------------------------    05110000
051300 2200-CLOSE-DEP-CURSOR.                                           05120000
051400                                                                  05130000
051500           EXEC SQL                                               05140000
051600              CLOSE DEPOSIT-CURSOR                                05150000
051700           END-EXEC                                               05160000
051800                                                                  05170000
051900     EVALUATE TRUE                                                05180000
052000         WHEN SQLCODE = ZERO                                      05190000
052100             CONTINUE                                             05200000
052200         WHEN SQLWARN0 NOT EQUAL SPACE                            05210000
052300         WHEN SQLCODE NOT EQUAL ZERO                              05220000
052400             MOVE '2200-CLOSE-DEP-CURSOR'                         05230000
052500                                   TO PV-PARAGRAPH-NAME           05240000
052600             MOVE 'ERROR ON CLOSE OF DEPOSIT CURSOR'              05250000
052700                                   TO PV-DB2-OPERATION            05260000
052800             PERFORM 9800-SQL-ABEND                               05270000
052900     END-EVALUATE.                                                05280000
053000                                                                  05290000
053100*2200-EXIT.                                                       05300000
053200                                                                  05310000
053300*---------------------------------------------------------------  05320000
053400* 3000-PROCESS-DEPOSIT-DATA                                       05330000
053500*    PROCESS DEPOSIT DATA FROM INITIAL FETCH                      05340000
053600*    PERFORM A PARAGRAPH THAT DETERMINES IF THE STORE IS LOCKED   05350000
053700*    PERFORM A PARAGRAPH THAT PROCESSES COIN/CURRENCY DATA        05360000
053800*    PERFORM A PARAGRAPH THAT WRITES THE DATA TO THE OUTPUT FILE  05370000
053900*    FETCH ANOTHER RECORD                                         05380000
054000*---------------------------------------------------------------  05390000
054100                                                                  05400000
054200 3000-PROCESS-DEPOSIT-DATA.                                       05410000
054300                                                                  05420000
054400     MOVE PC-D                        TO DP-RECORD-TYPE           05430000
054500     MOVE SAADDP-STR-NBR              TO DP-IMPORT-ACCT-ID        05440000
054600     MOVE PV-CPU-DTE-CCYYMMDD         TO DP-POST-DATE             05450000
054700     MOVE SAADDP-TNDR-AMT             TO DP-DEPOSIT-AMOUNT        05460000
054800     MOVE SAADDP-STR-NBR              TO DP-REFERENCE-1           05470000
054900                                                                  05480000
055000     IF SAADDP-TNDR-AMT                > 0                        05490000
055100        MOVE PC-DEBIT                 TO DP-DEBIT-CREDIT-IND      05500000
055200     ELSE                                                         05510000
055300        MOVE PC-CREDIT                TO DP-DEBIT-CREDIT-IND      05520000
055400     END-IF                                                       05530000
                                                                        05530105
JG         IF PV-PREVIOUS-STR-NBR NOT EQUAL SAADDP-STR-NBR              05531014
JG             PERFORM 3010-CHECK-FOR-CHECK-DEPOSITS                    05540014
JG             MOVE SAADDP-STR-NBR TO PV-PREVIOUS-STR-NBR               05540114
JG         END-IF                                                       05541014
                                                                        05542005
055600     EVALUATE TRUE                                                05550000
055700         WHEN SAADDP-TNDR-TYP-CDE      = '00'                     05560000
055800             MOVE PC-CASH-TRAN-TYPE   TO DP-TRAN-TYPE             05570000
055900             MOVE PC-CASH-VARIANCE    TO DP-REFERENCE-5           05580000
056000             PERFORM 4000-WRITE-DEP-RECORD                        05590000
JG                 IF PV-CHECK-DEP-COUNT = 0                            05591014
JG                     PERFORM 3300-PROCESS-COIN-CURR-DEP               05592014
JG                 END-IF                                               05593014
056100            WHEN SAADDP-TNDR-TYP-CDE      = '01'                  05600000
056200                MOVE PC-CHECK-TRAN-TYPE  TO DP-TRAN-TYPE          05610000
056300                MOVE PC-CHECK-VARIANCE   TO DP-REFERENCE-5        05620000
056400                PERFORM 4000-WRITE-DEP-RECORD                     05630000
056500                PERFORM 3300-PROCESS-COIN-CURR-DEP                05640000
056600     END-EVALUATE.                                                05650000
056700                                                                  05660000
056800     PERFORM 2100-FETCH-DEP-CURSOR.                               05670000
056900                                                                  05680000
057000*3000-EXIT.                                                       05690000
057100                                                                  05700000
JG     3010-CHECK-FOR-CHECK-DEPOSITS.                                   05700114
JG         MOVE ZEROS TO PV-CHECK-DEP-COUNT.                            05700514
JG         EXEC SQL                                                     05701014
JG             SELECT COUNT(*)                                          05703014
JG               INTO :PV-CHECK-DEP-COUNT                               05703114
JG             FROM       TSAADDP DDP1                                  05708014
JG             WHERE DDP1.SLS_DTE = :SAADDP-SLS-DTE                     05709014
JG               AND DDP1.STR_NBR = :SAADDP-STR-NBR                     05709214
JG               AND DDP1.TNDR_TYP_CDE = '01'                           05709314
JG             WITH UR                                                  05710014
JG         END-EXEC.                                                    05710114
JG         EVALUATE TRUE                                                05710214
JG            WHEN SQLCODE = ZERO                                       05710314
JG                CONTINUE                                              05710414
JG            WHEN SQLCODE = +100                                       05710714
JG                CONTINUE                                              05710914
JG            WHEN SQLWARN0 NOT EQUAL SPACE                             05711014
JG            WHEN SQLCODE NOT EQUAL ZERO                               05711114
JG                MOVE '3400-GET-COIN-CURR-DEP'                         05711214
JG                                         TO PV-PARAGRAPH-NAME         05711314
JG                MOVE SQLCODE             TO PV-DB2-OPERATION          05711414
JG                MOVE 'CUD'               TO PV-DB2-CTG-CDE            05711514
JG                PERFORM 9800-SQL-ABEND                                05711614
JG         END-EVALUATE.                                                05711714
                                                                        05711804
057200*---------------------------------------------------------------  05712000
057300* 3300-PROCESS-COIN-CURR-DEP                                      05720000
057400*    DETERMINE IF A COIN/CURRENCY DEPOSIT EXISTS FOR HOLD STORE   05730000
057500*    PERFORM A PARAGRAPH THAT SELECTS COIN/CURRENCY DATA          05740000
057600*    PERFORM A PARAGRAPH THAT WRITES THE DATA TO THE OUTPUT FILE  05750000
057700*---------------------------------------------------------------  05760000
057800                                                                  05770000
057900 3300-PROCESS-COIN-CURR-DEP.                                      05780000
058000                                                                  05790000
058100     PERFORM 3400-GET-COIN-CURR-DEP.                              05800000
058200                                                                  05810000
058300     IF PS-COIN-CURR-Y                                            05820000
058400        MOVE PC-D                     TO DP-RECORD-TYPE           05830000
058500        MOVE SAADDP-STR-NBR           TO DP-IMPORT-ACCT-ID        05840000
058600        MOVE PV-CPU-DTE-CCYYMMDD      TO DP-POST-DATE             05850000
058700        MOVE PC-COIN-CURR-TRAN-TYPE   TO DP-TRAN-TYPE             05860000
058800                                                                  05870000
058900        IF SAADSU-ADJ-AMT              > 0                        05880000
059000           MOVE PC-CREDIT             TO DP-DEBIT-CREDIT-IND      05890000
059100        ELSE                                                      05900000
059200           MOVE PC-DEBIT              TO DP-DEBIT-CREDIT-IND      05910000
059300        END-IF                                                    05920000
059400                                                                  05930000
059500        MOVE SAADSU-ADJ-AMT           TO DP-DEPOSIT-AMOUNT        05940000
059600        MOVE PC-COIN-CURR-VARIANCE    TO DP-REFERENCE-5           05950000
059700        MOVE SAADDP-STR-NBR           TO DP-REFERENCE-1           05960000
059800        SET PS-COIN-CURR-N            TO TRUE                     05970000
059900        PERFORM 4000-WRITE-DEP-RECORD                             05980000
060000     END-IF.                                                      05990000
060100                                                                  06000000
060200*3300-EXIT.                                                       06010000
060300                                                                  06020000
060400*---------------------------------------------------------------  06030000
060500* 3400-GET-COIN-CURR-DEP                                          06040000
060600*    SELECT THE COIN AND CURRENCY (CUD) DEPOSIT FROM TSAADSU,     06050000
060700*    IF AVAILABLE.                                                06060000
060800*---------------------------------------------------------------  06070000
060900                                                                  06080000
061000 3400-GET-COIN-CURR-DEP.                                          06090000
061100                                                                  06100000
061200     EXEC SQL                                                     06110000
061300         SELECT  ADJ_AMT                                          06120000
061400           INTO :SAADSU-ADJ-AMT                                   06130000
061500           FROM  TSAADSU                                          06140000
061600           WHERE SLS_DTE      = :SAADDP-SLS-DTE                   06150000
061700             AND STR_NBR      = :SAADDP-STR-NBR                   06160000
061800             AND SUM_CTG_CDE  = 'CUD'                             06170000
061900             AND ADJ_AMT     ^= 0                                 06180000
062000            WITH UR                                               06190000
062100     END-EXEC.                                                    06200000
062200                                                                  06210000
062300     EVALUATE TRUE                                                06220000
062400        WHEN SQLCODE = ZERO                                       06230000
062500            SET PS-COIN-CURR-Y       TO TRUE                      06240000
062600            ADD +1                   TO PV-TSAADSU-CNT            06250000
062700        WHEN SQLCODE = +100                                       06260000
062800            SET PS-COIN-CURR-N       TO TRUE                      06270000
062900        WHEN SQLWARN0 NOT EQUAL SPACE                             06280000
063000        WHEN SQLCODE NOT EQUAL ZERO                               06290000
063100            MOVE '3400-GET-COIN-CURR-DEP'                         06300000
063200                                     TO PV-PARAGRAPH-NAME         06310000
063300            MOVE SQLCODE             TO PV-DB2-OPERATION          06320000
063400            MOVE 'CUD'               TO PV-DB2-CTG-CDE            06330000
063500            PERFORM 9800-SQL-ABEND                                06340000
063600     END-EVALUATE.                                                06350000
063700                                                                  06360000
063800*3400-EXIT.                                                       06370000
063900                                                                  06380000
064000*----------------------------------------------------------       06390000
064100* 4000-WRITE-DEP-RECORD.                                          06400000
064200*     WRITES THE DEPOSIT RECORD TO THE FILE.                      06410000
064300*----------------------------------------------------------       06420000
064400 4000-WRITE-DEP-RECORD.                                           06430000
064500                                                                  06440000
064600     IF DP-TRAN-TYPE = '01'                                       06450000
064700       IF  DP-IMPORT-ACCT-ID NUMERIC                              06460000
064800*        MOVE DP-IMPORT-ACCT-ID TO PV-NUMERIC-STORE               06470018
064900*        IF PS-ALL-STORES OR                                      06480018
065000*          (PV-NUMERIC-STORE = PV-HOLD-STR (PV-NUMERIC-STORE) AND 06490018
065120*           SAADDP-SLS-DTE >=                                     06500018
065130*                     PV-HOLD-EFFECT-DTE(PV-NUMERIC-STORE))       06510018
065200*                MOVE 'BOC'     TO DP-REFERENCE-4                 06520018
065300*            ELSE                                                 06530018
065400*                MOVE SPACES    TO DP-REFERENCE-4                 06540018
065500*            END-IF                                               06550018
065200          MOVE 'BOC'     TO DP-REFERENCE-4                        06551018
065600       ELSE                                                       06560018
065700          MOVE SPACES        TO DP-REFERENCE-4                    06570018
065800       END-IF                                                     06580018
065900     ELSE                                                         06590000
066000         MOVE SPACES            TO DP-REFERENCE-4                 06600000
066100     END-IF.                                                      06610000
066200                                                                  06620000
066300     IF SAADDP-SLS-DTE     = CC-DATE-1                            06630000
066400        MOVE PV-SLS-DTE-CCYYMMDD      TO DP-EFFECTIVE-DATE        06640000
066500                                         DP-EFFECTIVE-DATE-2      06650000
066600        WRITE DAILY-DEPOSITORY-REC1                               06660000
066700            FROM DP-DAILY-DEPOSIT-REC                             06670000
066800     ELSE                                                         06680000
066900        MOVE PV-SLS-DTE-CCYYMMDD-2    TO DP-EFFECTIVE-DATE        06690000
067000                                         DP-EFFECTIVE-DATE-2      06700000
067100        WRITE DAILY-DEPOSITORY-REC2                               06710000
067200            FROM DP-DAILY-DEPOSIT-REC                             06720000
067300     END-IF.                                                      06730000
067400                                                                  06740000
067500     INITIALIZE DP-DAILY-DEPOSIT-REC.                             06750000
067600                                                                  06760000
067700     ADD 1                            TO PV-COUNT-DEP-RECS.       06770000
067800                                                                  06780000
067900*4000-EXIT.                                                       06790000
068000                                                                  06800000
068100*----------------------------------------------------------       06810000
068200* 9000-END-OF-JOB-ROUTINE.                                        06820000
068300*     CLOSES ALL FILES, CURSORS, AND DISPLAYS CURSOR COUNTS.      06830000
068400*----------------------------------------------------------       06840000
068500 9000-END-OF-JOB-ROUTINE.                                         06850000
068600                                                                  06860000
068700     PERFORM 2200-CLOSE-DEP-CURSOR.                               06870000
068800                                                                  06880000
068900     MOVE PV-SLS-DTE-ISO              TO EM-LINE1-DATE.           06890000
069000                                                                  06900000
069100     IF PV-SLS-DTE-ISO EQUAL PV-SLS-DTE-ISO-2                     06910000
069200        MOVE SPACE                    TO EM-LINE1-DATE-2          06920000
069300     ELSE                                                         06930000
069400        MOVE PV-SLS-DTE-ISO-2         TO EM-LINE1-DATE-2          06940000
069500     END-IF.                                                      06950000
069600                                                                  06960000
069700     WRITE EMAIL-RECORD             FROM EM-EMAIL-LINE1.          06970000
069800                                                                  06980000
069900*    CLOSE SOLUTRAN-STORE-FILE                                    06990018
069900     CLOSE                                                        06991018
070000           DAILY-DEPOSITORY-FILE1                                 07000000
070100           DAILY-DEPOSITORY-FILE2                                 07010000
070200           EMAIL-FILE.                                            07020000
070300                                                                  07030000
070400     DISPLAY '****************************************'.          07040000
070500     DISPLAY '*************** SAKUT011 ***************'.          07050012
070600     DISPLAY '****************************************'.          07060000
070700     DISPLAY '# OF TSAADDP ITEMS FETCHED: ' PV-TSAADDP-CSR-CNT.   07070000
070800     DISPLAY '# OF TSAADSU ITEMS FETCHED: ' PV-TSAADSU-CNT.       07080000
070900     DISPLAY '# OF RECORDS WRITTEN:       ' PV-COUNT-DEP-RECS.    07090000
071000     DISPLAY '****************************************'.          07100000
071100     DISPLAY '****************************************'.          07110000
071200     DISPLAY '****************************************'.          07120000
071300                                                                  07130000
071400*9000-EXIT.                                                       07140000
071500                                                                  07150000
071600*---------------------------------------------------------------- 07160000
071700* 9800-SQL-ABEND                                                  07170000
071800*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS 07180000
071900*---------------------------------------------------------------- 07190000
072000 9800-SQL-ABEND.                                                  07200000
072100     DISPLAY '** ABEND     **'.                                   07210000
072200     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07220000
072300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              07230000
072400     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               07240000
072500     DISPLAY '** SALES DTE ** = ' SAADDP-SLS-DTE.                 07250000
072600     DISPLAY '** STORE NBR ** = ' SAADDP-STR-NBR.                 07260000
072700     DISPLAY '** CTG CDE   ** = ' PV-DB2-CTG-CDE.                 07270000
072800                                                                  07280000
072900     COPY DPPD004.                                                07290000
073000     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         07300000
073100                                                                  07310000
073200*9800-EXIT.                                                       07320000
073300                                                                  07330000
073400*---------------------------------------------------------------  07340000
073500* 9999-ABEND                                                      07350000
073600*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  07360000
073700*---------------------------------------------------------------  07370000
073800 9999-ABEND.                                                      07380000
073900     DISPLAY '** ABEND           **'.                             07390000
074000     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  07400000
074100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        07410000
074200     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       07420000
074300     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       07430000
074400     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         07440000
074500                                                                  07450000
074600*9999-EXIT.                                                       07460000
