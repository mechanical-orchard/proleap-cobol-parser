000100******************************************************************00010017
000200 IDENTIFICATION DIVISION.                                         00020017
000300******************************************************************00030017
000400                                                                  00040017
000500 PROGRAM-ID.             PCKCS012.                                00050017
000600 AUTHOR.                 WILLIAM B. BURT.                         00060017
000700 INSTALLATION.           KOHLS.                                   00070017
000800 DATE-WRITTEN            JUNE, 1994.                              00080017
000900 DATE-COMPILED.                                                   00090017
001000                                                                  00100017
001100******************************************************************00110017
001200* THIS PROGRAM WILL READ A PURCHASE ORDER NUMBER PASSED FROM THE  00120017
001300* ONLINE AND GENERATE A PURCHASE ORDER PRINT.                     00130017
001400* IT IS CALLED FROM THE "PRE-TICKET REQUEST" OPTION ON THE        00140017
001500* TICKETING MENU.                                                 00150017
001600******************************************************************00160017
      * DATE  11/05/2014, CHERI PARMLEY                                *00170023
      *   CHG0094517 EXPANDED ORD-NBR FROM 7 TO 8 DIGITS               *00180023
      *----------------------------------------------------------------*00190023
001800******************************************************************00200017
001900 ENVIRONMENT DIVISION.                                            00210017
002000******************************************************************00220017
002100                                                                  00230017
002200******************************************************************00240017
002300 DATA DIVISION.                                                   00250017
002400******************************************************************00260017
002500                                                                  00270017
002600******************************************************************00280017
002700 WORKING-STORAGE SECTION.                                         00290017
002800******************************************************************00300017
002900                                                                  00310017
003000*                                                                 00320017
003100*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00330017
003200*                                                                 00340017
003300     COPY DPWS013.                                                00350017
003400                                                                  00360017
003500*                                                                 00370017
003600*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            00380017
003700*                                                                 00390017
003800     COPY DRRD001O.                                               00400017
003900                                                                  00410017
004000*                                                                 00420017
004100*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        00430017
004200*                                                                 00440017
004300     COPY DRRD002O.                                               00450017
004400                                                                  00460017
004500*                                                                 00470017
004600*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 00480017
004700*                                                                 00490017
004800     COPY DPWS024.                                                00500017
004900                                                                  00510017
005000*                                                                 00520017
005100*  WORKING STORAGE AREA FOR PAYMENT TERMS                         00530017
005200*                                                                 00540017
005300     COPY POWS020.                                                00550017
005310                                                                  00560021
005320*                                                                 00570021
005330*  COPYBOOK FOR LOGISTICS DOMAIN LOCATION MASTER MODULE           00580021
005340*                                                                 00590021
005350     COPY XLWS071.                                                00600021
005400                                                                  00610017
005500*                                                                 00620017
005600*  WORKING STORAGE AREA FOR PRINTER CONTROL MODULE (DPKCS060)     00630017
005700*                                                                 00640017
005800     COPY DPWS072.                                                00650017
005900                                                                  00660017
006000*                                                                 00670017
006100*  WORKING STORAGE AREA WITH STANDARD PRINTER CONTROL COMMANDS    00680017
006200*                                                                 00690017
006300     COPY DSWS004.                                                00700017
006400                                                                  00710017
006500******************************************************************00720017
006600*  WORKING STORAGE AREA FOR COUNTRY AND STATE RETRIEVAL           00730017
006700******************************************************************00740017
006800     COPY DPWS410.                                                00750017
006900*                                                                 00760017
007000*  COMMUNICATIONS AREA FOR DB2                                    00770017
007100*                                                                 00780017
007200     EXEC SQL                                                     00790017
007300          INCLUDE SQLCA                                           00800017
007400     END-EXEC.                                                    00810017
007500                                                                  00820017
007600*                                                                 00830017
007700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00840017
007800*  HEADER TABLE                                                   00850017
007900*                                                                 00860017
008000     EXEC SQL                                                     00870017
008100          INCLUDE TPURCHS                                         00880017
008200     END-EXEC.                                                    00890017
008300                                                                  00900017
008400*                                                                 00910017
008500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     00920017
008600*  ITEM TABLE                                                     00930017
008700*                                                                 00940017
008800     EXEC SQL                                                     00950017
008900          INCLUDE TPURITM                                         00960017
009000     END-EXEC.                                                    00970017
009100                                                                  00980017
009200*                                                                 00990017
009300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01000017
009400*  PLANNED SHIPMENT TABLE                                         01010017
009500*                                                                 01020017
009600     EXEC SQL                                                     01030017
009700          INCLUDE TPLNSHP                                         01040017
009800     END-EXEC.                                                    01050017
009900                                                                  01060017
010000*                                                                 01070017
010100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01080017
010200*  AGREEMENT TABLE                                                01090017
010300*                                                                 01100017
010400     EXEC SQL                                                     01110017
010500          INCLUDE TPOAGMT                                         01120017
010600     END-EXEC.                                                    01130017
010700                                                                  01140017
010800*                                                                 01150017
010900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01160017
011000*  INSTRUCTION TABLE                                              01170017
011100*                                                                 01180017
011200     EXEC SQL                                                     01190017
011300          INCLUDE TPOINST                                         01200017
011400     END-EXEC.                                                    01210017
011500                                                                  01220017
011600*                                                                 01230017
011700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INSTRUCTION CODE   01240017
011800*  TABLE                                                          01250017
011900*                                                                 01260017
012000     EXEC SQL                                                     01270017
012100          INCLUDE TINSTCD                                         01280017
012200     END-EXEC.                                                    01290017
012300                                                                  01300017
012400*                                                                 01310017
012500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECIPENT CODE TABLE01320017
012600*                                                                 01330017
012700     EXEC SQL                                                     01340017
012800          INCLUDE TINRCCD                                         01350017
012900     END-EXEC.                                                    01360017
013000                                                                  01370017
013100*                                                                 01380017
013200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ALLOCATION PLAN    01390017
013300*  TABLE                                                          01400017
013400*                                                                 01410017
013500     EXEC SQL                                                     01420017
013600          INCLUDE TALLPLN                                         01430017
013700     END-EXEC.                                                    01440017
013800                                                                  01450017
013900*                                                                 01460017
014000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE EXTERNAL           01470017
014100*  ENTERPRISE NAME TABLE                                          01480017
014200*                                                                 01490017
014300     EXEC SQL                                                     01500017
014400          INCLUDE TENTNME                                         01510017
014500     END-EXEC.                                                    01520017
014600                                                                  01530017
014700*                                                                 01540017
014800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPISE LOCATION 01550017
014900*  TABLE                                                          01560017
015000*                                                                 01570017
015100     EXEC SQL                                                     01580017
015200          INCLUDE TBUSLOC                                         01590017
015300     END-EXEC.                                                    01600017
015400                                                                  01610017
015500*                                                                 01620017
015600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VENDOR PAYMENT     01630017
015700*  TERM TABLE                                                     01640017
015800*                                                                 01650017
015900     EXEC SQL                                                     01660017
016000          INCLUDE TPAYTRM                                         01670017
016100     END-EXEC.                                                    01680017
016900                                                                  01690017
017000*                                                                 01700017
017100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORKER             01710017
017200*  IDENTIFICATION TABLE                                           01720017
017300*                                                                 01730017
017400     EXEC SQL                                                     01740017
017500          INCLUDE TWORKER                                         01750017
017600     END-EXEC.                                                    01760017
017700                                                                  01770017
017800*                                                                 01780017
017900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MERCHANDISE AREA   01790017
018000*  TABLE                                                          01800017
018100*                                                                 01810017
018200     EXEC SQL                                                     01820017
018300          INCLUDE TMDSEAR                                         01830017
018400     END-EXEC.                                                    01840017
018500                                                                  01850017
018600*                                                                 01860017
018700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RESPONSIBILITY     01870017
018800*  AREA TABLE                                                     01880017
018900*                                                                 01890017
019000     EXEC SQL                                                     01900017
019100          INCLUDE TRSPBAR                                         01910017
019200     END-EXEC.                                                    01920017
019300                                                                  01930017
019400 01  CA-COMMAREA.                                                 01940017
      *CLP 11/05/14                                                     01950023
019500         10  CA-ORD-NBR-X                PIC X(08)  VALUE SPACE.  01960023
019600         10  CA-ORD-NBR  REDEFINES  CA-ORD-NBR-X                  01970017
019700                                         PIC 9(08).               01980023
019800     05  CA-PRTR-ID                      PIC X(08)  VALUE SPACE.  01990017
019900     05  CA-PRTR-AUTO-CUTTER-IND                                  02000017
020000                                         PIC X(01)  VALUE SPACE.  02010017
020100     05  CA-PRTR-PRTR-BRCDE-IND                                   02020017
020200                                         PIC X(01)  VALUE SPACE.  02030017
020300     05  CA-PRTR-PRTR-CNTL-IND           PIC X(01)  VALUE SPACE.  02040017
020400     05  CA-PRINT-PACKAGE-IND            PIC X(01)  VALUE SPACE.  02050017
020500         88 CA-NOT-FROM-PRINT-PACKAGE               VALUE 'N'.    02060017
020600                                                                  02070017
020700*                                                                 02080017
020800 01  DK-DB2-KEYS.                                                 02090017
020900     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  02100017
021000                                                     COMP.        02110017
021100*                                                                 02120017
021200 01  PS-PROGRAM-SWITCHES.                                         02130017
021300     05  PS-EOF-INST-CSR-SW              PIC  X(01)  VALUE 'N'.   02140017
021400         88  PS-EOF-INST-CSR                         VALUE 'Y'.   02150017
021500         88  PS-NOT-EOF-INST-CSR                     VALUE 'N'.   02160017
021600     05  PS-EOF-PO-LINE-CSR-SW           PIC  X(01)  VALUE 'N'.   02170017
021700         88  PS-EOF-PO-LINE-CSR                      VALUE 'Y'.   02180017
021800         88  PS-NOT-EOF-PO-LINE-CSR                  VALUE 'N'.   02190017
021900     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'N'.   02200017
022000         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   02210017
022100         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   02220017
022200     05  PS-DRS-INITIALIZED-SW           PIC  X(01)  VALUE 'N'.   02230017
022300         88  PS-DRS-INITIALIZED                      VALUE 'Y'.   02240017
022400         88  PS-DRS-NOT-INITIALIZED                  VALUE 'N'.   02250017
022500                                                                  02260017
022600 01  PC-PROGRAM-CONSTANTS.                                        02270017
022700     05  PC-ABEND-MESSAGE             PIC  X(131) VALUE           02280017
022800          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    02290017
022900     05  PC-CURRENT-PGM-NME           PIC  X(08)  VALUE           02300017
023000         'PCKCS012'.                                              02310017
023100     05  PC-DPKCS060                  PIC  X(08)  VALUE           02320017
023200         'DPKCS060'.                                              02330017
023300     05  PC-TOP-OF-PAGE               PIC  X(01)  VALUE '1'.      02340017
023400     05  PC-SINGLE-SPACE              PIC  X(01)  VALUE ' '.      02350017
023500     05  PC-DOUBLE-SPACE              PIC  X(01)  VALUE '0'.      02360017
023600     05  PC-TRIPLE-SPACE              PIC  X(01)  VALUE '-'.      02370017
023700     05  PC-PUT                       PIC  X(03)  VALUE 'PUT'.    02380017
023800     05  PC-INIT                      PIC  X(04)  VALUE 'INIT'.   02390017
023900     05  PC-TERM                      PIC  X(04)  VALUE 'TERM'.   02400017
024000     05  PC-INIT-DATE                 PIC  X(10) VALUE            02410017
024100                                                     '0001-01-01'.02420017
024200     05  PC-01                        PIC  X(02)  VALUE '01'.     02430017
024300     05  PC-STORE-QTY                 PIC  X(21) VALUE            02440017
024400         ' --STORE-- QUANTITY  '.                                 02450017
024500     05  PC-SHIP-INST-ATT             PIC  X(31) VALUE            02460017
024600         'REFER TO SHIPPING INSTRUCTIONS '.                       02470017
024700     05  PC-SHIP-INST-FOLL            PIC  X(31) VALUE            02480017
024800         'SHIPPING INSTRUCTIONS TO FOLLOW'.                       02490017
024900     05  PC-MONTH-ABBR-TABLE.                                     02500017
025000         10  FILLER                   PIC  X(03) VALUE 'JAN'.     02510017
025100         10  FILLER                   PIC  X(03) VALUE 'FEB'.     02520017
025200         10  FILLER                   PIC  X(03) VALUE 'MAR'.     02530017
025300         10  FILLER                   PIC  X(03) VALUE 'APR'.     02540017
025400         10  FILLER                   PIC  X(03) VALUE 'MAY'.     02550017
025500         10  FILLER                   PIC  X(03) VALUE 'JUN'.     02560017
025600         10  FILLER                   PIC  X(03) VALUE 'JUL'.     02570017
025700         10  FILLER                   PIC  X(03) VALUE 'AUG'.     02580017
025800         10  FILLER                   PIC  X(03) VALUE 'SEP'.     02590017
025900         10  FILLER                   PIC  X(03) VALUE 'OCT'.     02600017
026000         10  FILLER                   PIC  X(03) VALUE 'NOV'.     02610017
026100         10  FILLER                   PIC  X(03) VALUE 'DEC'.     02620017
026200     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    02630017
026300         10  PC-MONTH-ABBR OCCURS 12 TIMES                        02640017
026400                                      PIC  X(03).                 02650017
026500     05  PC-DPKUT410                  PIC  X(08) VALUE 'DPKUT410'.02660017
026600                                                                  02670017
026700 01  PV-PROGRAM-VARIABLES.                                        02680017
026800     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  02690017
026900                                                     COMP SYNC.   02700017
027000     05  PV-DRS-ABEND-DISPLAY-LINE1.                              02710017
027100         10  FILLER                      PIC  X(14)  VALUE        02720017
027200             'DRRB ID = DRRB'.                                    02730017
027300         10  FILLER                      PIC  X(02)  VALUE SPACE. 02740017
027400         10  FILLER                      PIC  X(12)  VALUE        02750017
027500             'DRRB FUNC = '.                                      02760017
027600         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 02770017
027700         10  FILLER                      PIC  X(02)  VALUE SPACE. 02780017
027800         10  FILLER                      PIC  X(11)  VALUE        02790017
027900             'DRRB RID = '.                                       02800017
028000         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 02810017
028100         10  FILLER                      PIC  X(02)  VALUE SPACE. 02820017
028200         10  FILLER                      PIC  X(15)  VALUE        02830017
028300             'DRRB OPTIONS = '.                                   02840017
028400         10  PV-DRS-DRRB-OPTIONS         PIC  X(04)  VALUE SPACE. 02850017
028500     05  PV-DRS-ABEND-DISPLAY-LINE2.                              02860017
028600         10  FILLER                      PIC  X(11)  VALUE        02870017
028700             'DRRB RC1 = '.                                       02880017
028800         10  PV-DRS-DRRB-RC1             PIC  9(04)  VALUE ZEROS. 02890017
028900         10  FILLER                      PIC  X(02)  VALUE SPACE. 02900017
029000         10  FILLER                      PIC  X(11)  VALUE        02910017
029100             'DRRB RC2 = '.                                       02920017
029200         10  PV-DRS-DRRB-RC2             PIC  9(04)  VALUE ZEROS. 02930017
029300         10  FILLER                      PIC  X(02)  VALUE SPACE. 02940017
029400         10  FILLER                      PIC  X(18)  VALUE        02950017
029500             'DRRB ATTR-ERROR = '.                                02960017
029600         10  PV-DRS-ATTR-ERROR           PIC  9(04)  VALUE ZEROS. 02970017
029700         10  FILLER                      PIC  X(02)  VALUE SPACE. 02980017
029800         10  FILLER                      PIC  X(12)  VALUE        02990017
029900             'DRRB DRDC = '.                                      03000017
030000         10  PV-DRS-DRRB-DRDC            PIC  9(08)  VALUE ZEROS. 03010017
030100         10  FILLER                      PIC  X(02)  VALUE SPACE. 03020017
030200         10  FILLER                      PIC  X(13)  VALUE        03030017
030300             'DRRB LINES = '.                                     03040017
030400         10  PV-DRS-DRRB-LINES           PIC  9(08)  VALUE ZEROS. 03050017
030500     05  PV-ABEND-PARAGRAPH           PIC  X(30) VALUE SPACE.     03060017
030600     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         03070017
030700                                                 COMP.            03080017
030800     05  PV-NULL-IND                  PIC S9(04) VALUE +0         03090017
030900                                                 COMP.            03100017
031000     05  PV-PAGE-CNT                  PIC S9(07) VALUE  0         03110017
031100                                                 COMP-3.          03120017
031200     05  PV-QUOTIENT                  PIC S9(04) VALUE +0         03130017
031300                                                 COMP.            03140017
031400     05  PV-REMAINDER                 PIC S9(04) VALUE +0         03150017
031500                                                 COMP.            03160017
031600     05  PV-LINE-CNT                  PIC S9(03) VALUE +0.        03170017
031700     05  PV-TEMP-LINE-CNT             PIC S9(03) VALUE +0.        03180017
031800     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         03190017
031900                                                 COMP-3.          03200017
032000     05  PV-DATE-BREAK.                                           03210017
032100         10  PV-DB-CC                 PIC  X(02).                 03220017
032200         10  PV-DB-YY                 PIC  X(02).                 03230017
032300         10  FILLER                   PIC  X(01).                 03240017
032400         10  PV-DB-MM                 PIC  X(02).                 03250017
032500         10  FILLER                   PIC  X(01).                 03260017
032600         10  PV-DB-DD                 PIC  X(02).                 03270017
032700     05  PV-DATE-BREAK-SLASH.                                     03280017
032800         10  PV-DBS-MM                PIC  X(02).                 03290017
032900         10  FILLER                   PIC  X(01) VALUE '/'.       03300017
033000         10  PV-DBS-DD                PIC  X(02).                 03310017
033100         10  FILLER                   PIC  X(01) VALUE '/'.       03320017
033200         10  PV-DBS-YY                PIC  X(02).                 03330017
033300     05  PV-OTB-PER-BREAK             PIC  X(06).                 03340017
033400     05  FILLER REDEFINES PV-OTB-PER-BREAK.                       03350017
033500         10  PV-OTBP-CCYY             PIC  X(04).                 03360017
033600         10  PV-OTBP-MM               PIC  X(02).                 03370017
033700         10  PV-OTBP-MM-N REDEFINES PV-OTBP-MM                    03380017
033800                                      PIC  9(02).                 03390017
033900     05  PV-EDIT-DISC-PCT             PIC  ZZ.                    03400017
034000     05  PV-NUM-DISC-PCT              PIC  9(02) VALUE ZERO.      03410017
034100     05  PV-EDIT-DISC-DAYS            PIC  ZZZ.                   03420017
034200     05  PV-EDIT-DUE-DAYS             PIC  ZZZ.                   03430017
034300     05  PV-EDIT-PAYT-TERM-ID         PIC  ZZ9.                   03440017
034400     05  PV-EDIT-ZIP-CODE             PIC  X(10).                 03450021
034500     05  PV-EDIT-ZIP-CODE-BREAK REDEFINES PV-EDIT-ZIP-CODE.       03460017
034600         10  PV-EZCB-1-5              PIC  X(05).                 03470017
034700         10  PV-EZCB-6-9              PIC  X(04).                 03480021
034710         10  FILLER                   PIC  X(01).                 03490021
034800     05  PV-ZIP-CODE-DISPLAY.                                     03500017
034900         10  PV-ZCD-1-5               PIC  X(05).                 03510017
035000         10  FILLER                   PIC  X(01) VALUE '-'.       03520017
035100         10  PV-ZCD-6-9               PIC  X(04).                 03530017
035200     05  PV-EDIT-MU-PCT               PIC  ZZZ.99.                03540017
035300     05  PV-DOL-FORM-9                PIC  $$,$$$.99.             03550017
035400     05  PV-DOL-FORM-11               PIC  $$$$,$$$.99.           03560017
035500     05  PV-DOL-FORM-13               PIC  $$,$$$,$$$.99.         03570017
035600     05  PV-PCT-HOLD                  PIC  9(04)V9(04).           03580017
035700     05  PV-RECIP-CDE-HOLD            PIC  X(02).                 03590017
035800     05  PV-PO-LINE-NBR               PIC S9(03) COMP-3.          03600017
035900     05  PV-ALLOC-CNT                 PIC S9(09) COMP-3.          03610017
036000     05  PV-GRP-PRICE.                                            03620017
036100         10  PV-GP-QTY                PIC  ZZZ.                   03630017
036200         10  FILLER                   PIC  X(01) VALUE '/'.       03640017
036300         10  PV-GP-AMT                PIC  $$$$$$.99.             03650017
036400     05  PV-SUB                       PIC S9(04) COMP VALUE +0.   03660017
036500     05  ASC-PAYT-TERM-ID-DESC        PIC X(28)     VALUE SPACE.  03670017
036600     05  PV-CURRENT-DATE-X.                                       03680017
036700         10  PV-CURRENT-CENTURY-YEAR  PIC  9(04)  VALUE ZEROS.    03690017
036800         10  FILLER                   PIC  X(01)  VALUE '-'.      03700017
036900         10  PV-CURRENT-MONTH         PIC  9(02)  VALUE ZEROS.    03710017
037000         10  FILLER                   PIC  X(01)  VALUE '-'.      03720017
037100         10  PV-CURRENT-DAY           PIC  9(02)  VALUE ZEROS.    03730017
037200     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            03740017
037300                                      PIC  X(10).                 03750017
037400     05  PV-CITY                      PIC  X(15).                 03760017
037500     05  PV-STATE-PROV                PIC  X(30).                 03770017
037600     05  PV-COUNTRY                   PIC  X(30).                 03780017
037700     05  PV-DPKUT410-COMMAREA         PIC  X(01)   VALUE SPACES.  03790017
037800                                                                  03800017
037900******************************************************************03810017
038000*  PURCHASE ORDER REPORT PRINT LINES                              03820017
038100******************************************************************03830017
038200                                                                  03840017
038300 01  HL1-HEADING-LINE-1.                                          03850017
038400     05  FILLER                          PIC  X(03)  VALUE SPACE. 03860017
038500     05  HL1-RUN-DATE.                                            03870017
038600         10  HL1-RUN-MONTH               PIC  9(02)  VALUE ZERO.  03880017
038700         10  FILLER                      PIC  X(01)  VALUE '/'.   03890017
038800         10  HL1-RUN-DAY                 PIC  9(02)  VALUE ZERO.  03900017
038900         10  FILLER                      PIC  X(01)  VALUE '/'.   03910017
039000         10  HL1-RUN-YEAR                PIC  9(02)  VALUE ZERO.  03920017
039100     05  FILLER                          PIC  X(02)  VALUE SPACE. 03930017
039200     05  HL1-RUN-TIME.                                            03940017
039300         10  HL1-RUN-HOUR                PIC  9(02)  VALUE ZERO.  03950017
039400         10  FILLER                      PIC  X(01)  VALUE ':'.   03960017
039500         10  HL1-RUN-MINUTE              PIC  9(02)  VALUE ZERO.  03970017
039600     05  FILLER                          PIC  X(27)  VALUE SPACE. 03980017
039700     05  FILLER                          PIC  X(45)  VALUE        03990017
039800         'K O H L S   D E P A R T M E N T   S T O R E S'.         04000017
039900     05  FILLER                          PIC  X(20)  VALUE SPACE. 04010017
040000     05  HL1-PGM-NME                     PIC  X(08)  VALUE SPACE. 04020017
040100     05  FILLER                          PIC  X(01)  VALUE '-'.   04030017
040200     05  HL1-RPT-NBR                     PIC  9(01)  VALUE ZERO.  04040017
040300     05  FILLER                          PIC  X(02)  VALUE SPACE. 04050017
040400     05  FILLER                          PIC  X(04)  VALUE 'PAGE'.04060017
040500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04070017
040600     05  HL1-PG-NBR                      PIC ZZZZ9   VALUE ZERO.  04080017
040700                                                                  04090017
040800 01  HL2-HEADING-LINE-2.                                          04100017
040900     05  FILLER                          PIC  X(44)  VALUE SPACE. 04110017
041000     05  FILLER                          PIC  X(47)  VALUE        04120017
041100         'P U R C H A S E   O R D E R   -   D C   C O P Y'.       04130017
041200     05  FILLER                          PIC  X(41)  VALUE SPACE. 04140017
041300                                                                  04150017
041400 01  HL3-HEADING-LINE-3.                                          04160017
041500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04170017
041600     05  FILLER                          PIC  X(11)  VALUE        04180017
041700         'PO NBR...: '.                                           04190017
041800     05  HL3-PO-NBR                      PIC  X(08)  VALUE SPACE. 04200017
041900     05  FILLER                          PIC  X(25)  VALUE SPACE. 04210017
042000     05  FILLER                          PIC  X(16)  VALUE        04220017
042100         'MARKUP.........:'.                                      04230017
042200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04240017
042300     05  HL3-MU-PCT                      PIC  X(06)  VALUE SPACE. 04250017
042400     05  FILLER                          PIC  X(02)  VALUE ' %'.  04260017
042500     05  FILLER                          PIC  X(23)  VALUE SPACE. 04270017
042600     05  FILLER                          PIC  X(25)  VALUE        04280017
042700         'DO NOT SHIP BEFORE......:'.                             04290017
042800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04300017
042900     05  HL3-DNSB-MONTH                  PIC  X(02)  VALUE SPACE. 04310017
043000     05  FILLER                          PIC  X(01)  VALUE '/'.   04320017
043100     05  HL3-DNSB-DAY                    PIC  X(02)  VALUE SPACE. 04330017
043200     05  FILLER                          PIC  X(01)  VALUE '/'.   04340017
043300     05  HL3-DNSB-YEAR                   PIC  X(02)  VALUE SPACE. 04350017
043400     05  FILLER                          PIC  X(05)  VALUE SPACE. 04360017
043500                                                                  04370017
043600 01  HL4-HEADING-LINE-4.                                          04380017
043700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04390017
043800     05  FILLER                          PIC  X(10)  VALUE        04400017
043900         'ORDER DTE:'.                                            04410017
044000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04420017
044100     05  HL4-ORD-DTE                     PIC  X(08)  VALUE SPACE. 04430017
044200     05  FILLER                          PIC  X(25)  VALUE SPACE. 04440017
044300     05  FILLER                          PIC  X(17)  VALUE        04450017
044400         'COST...........:'.                                      04460017
044500     05  FILLER                          PIC  X(01)  VALUE SPACE. 04470017
044600     05  HL4-COST                        PIC  $$,$$$,$$$.99.      04480017
044700     05  FILLER                          PIC  X(17)  VALUE SPACE. 04490017
044800     05  FILLER                          PIC  X(25)  VALUE        04500017
044900         'CANCEL IF NOT SHIPPED BY:'.                             04510017
045000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04520017
045100     05  HL4-CNSB-MONTH                  PIC  X(02)  VALUE SPACE. 04530017
045200     05  FILLER                          PIC  X(01)  VALUE '/'.   04540017
045300     05  HL4-CNSB-DAY                    PIC  X(02)  VALUE SPACE. 04550017
045400     05  FILLER                          PIC  X(01)  VALUE '/'.   04560017
045500     05  HL4-CNSB-YEAR                   PIC  X(02)  VALUE SPACE. 04570017
045600     05  FILLER                          PIC  X(05)  VALUE SPACE. 04580017
045700                                                                  04590017
045800 01  HL5-HEADING-LINE-5.                                          04600017
045900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04610017
046000     05  FILLER                          PIC  X(10)  VALUE        04620017
046100         'DEPT.....:'.                                            04630017
046200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04640017
046300     05  HL5-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 04650017
046400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04660017
046500     05  HL5-DEPT-DESC                   PIC  X(25)  VALUE SPACE. 04670017
046600     05  FILLER                          PIC  X(04)  VALUE SPACE. 04680017
046700     05  FILLER                          PIC  X(17)  VALUE        04690017
046800         'RETAIL.........:'.                                      04700017
046900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04710017
047000     05  HL5-RTL                         PIC  $$,$$$,$$$.99.      04720017
047100     05  FILLER                          PIC  X(17)  VALUE SPACE. 04730017
047200     05  FILLER                          PIC  X(25)  VALUE        04740017
047300         'OTB PERIOD..............:'.                             04750017
047400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04760017
047500     05  HL5-OTBP-MONTH                  PIC  X(03)  VALUE SPACE. 04770017
047600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04780017
047700     05  HL5-OTBP-YEAR                   PIC  X(04)  VALUE SPACE. 04790017
047800     05  FILLER                          PIC  X(05)  VALUE SPACE. 04800017
047900                                                                  04810017
048000 01  HL6-HEADING-LINE-6.                                          04820017
048100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04830017
048200     05  FILLER                          PIC  X(10)  VALUE        04840017
048300         'VENDOR...:'.                                            04850017
048400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04860017
048500     05  HL6-VEND-NME                    PIC  X(30)  VALUE SPACE. 04870017
048600     05  FILLER                          PIC  X(03)  VALUE SPACE. 04880017
048700     05  FILLER                          PIC  X(16)  VALUE        04890017
048800         'UNITS..........:'.                                      04900017
048900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04910017
049000     05  HL6-UNITS                       PIC  Z,ZZZ,ZZZ.          04920017
049100     05  FILLER                          PIC  X(61)  VALUE SPACE. 04930017
049200                                                                  04940017
049300 01  HL7-HEADING-LINE-7.                                          04950017
049400     05  FILLER                          PIC  X(12)  VALUE SPACE. 04960017
049500     05  HL7-VEND-ADR-1                  PIC  X(30)  VALUE SPACE. 04970017
049600     05  FILLER                          PIC  X(03)  VALUE SPACE. 04980017
049700     05  FILLER                          PIC  X(17)  VALUE        04990017
049800         'PAYMENT TERM...: '.                                     05000017
049900     05  HL7-PAYT-TERM                   PIC  X(28)  VALUE SPACE. 05010017
050000     05  FILLER                          PIC  X(03)  VALUE SPACE. 05020017
050100     05  FILLER                          PIC  X(14)  VALUE        05030017
050200         'EDI..........:'.                                        05040017
050300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05050017
050400     05  HL7-EDI-IND                     PIC  X(03)  VALUE SPACE. 05060017
050500     05  FILLER                          PIC  X(21)  VALUE SPACE. 05070017
050600                                                                  05080017
050700 01  HL8-HEADING-LINE-8.                                          05090017
050800     05  FILLER                          PIC  X(12)  VALUE SPACE. 05100017
050900     05  HL8-VEND-ADR-2                  PIC  X(30)  VALUE SPACE. 05110017
051000     05  FILLER                          PIC  X(03)  VALUE SPACE. 05120017
051100     05  FILLER                          PIC  X(17)  VALUE        05130017
051200         'EXTENDED DATING: '.                                     05140017
051300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05150017
051400     05  HL8-EXTENDED-DTE                PIC  ZZZ.                05160017
051500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05170017
051600     05  FILLER                          PIC  X(04)  VALUE        05180017
051700         'DAYS'.                                                  05190017
051800     05  FILLER                          PIC  X(22)  VALUE SPACE. 05200017
051900     05  FILLER                          PIC  X(14)  VALUE        05210017
052000         'NEW STORE....:'.                                        05220017
052100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05230017
052200     05  HL8-NEW-STR-IND                 PIC  X(03)  VALUE SPACE. 05240017
052300     05  FILLER                          PIC  X(21)  VALUE SPACE. 05250017
052400                                                                  05260017
052500 01  HL9-HEADING-LINE-9.                                          05270017
052600     05  FILLER                          PIC  X(12)  VALUE SPACE. 05280017
052700     05  HL9-VEND-ADR-3                  PIC  X(30)  VALUE SPACE. 05290017
052800     05  FILLER                          PIC  X(03)  VALUE SPACE. 05300017
052900     05  FILLER                          PIC  X(17)  VALUE        05310017
053000         'VENDOR DISCOUNT: '.                                     05320017
053100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05330017
053200     05  HL9-VEND-DISC-AMT               PIC  $$$$$$.99.          05340017
053300     05  FILLER                          PIC  X(02)  VALUE SPACE. 05350017
053400     05  HL9-VEND-DISC-PCT               PIC  ZZ.99.              05360017
053500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05370017
053600     05  FILLER                          PIC  X(01)  VALUE '%'.   05380017
053700     05  FILLER                          PIC  X(12)  VALUE SPACE. 05390017
053800     05  FILLER                          PIC  X(14)  VALUE        05400017
053900         'PRETICKETING.:'.                                        05410017
054000     05  FILLER                          PIC  X(01)  VALUE SPACE. 05420017
054100     05  HL9-PRE-TKT-IND                 PIC  X(03)  VALUE SPACE. 05430017
054200     05  FILLER                          PIC  X(21)  VALUE SPACE. 05440017
054300                                                                  05450017
054400 01  HL10-HEADING-LINE-10.                                        05460017
054500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05470017
054600     05  FILLER                          PIC  X(10)  VALUE        05480017
054700         'SHIP TO..:'.                                            05490017
054800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05500017
054900     05  HL10-SHIP-TO-NME                PIC  X(30)  VALUE SPACE. 05510017
055000     05  FILLER                          PIC  X(03)  VALUE SPACE. 05520017
055100     05  FILLER                          PIC  X(16)  VALUE        05530017
055200         'FOB POINT......:'.                                      05540017
055300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05550017
055400     05  HL10-FOB-PT                     PIC  X(20)  VALUE SPACE. 05560017
055500     05  FILLER                          PIC  X(11)  VALUE SPACE. 05570017
055600     05  FILLER                          PIC  X(14)  VALUE        05580017
055700         'PACK BY STORE:'.                                        05590017
055800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05600017
055900     05  HL10-PACK-BY-STR-IND            PIC  X(03)  VALUE SPACE. 05610017
056000     05  FILLER                          PIC  X(21)  VALUE SPACE. 05620017
056100                                                                  05630017
056200 01  HL11-HEADING-LINE-11.                                        05640017
056300     05  FILLER                          PIC  X(12)  VALUE SPACE. 05650017
056400     05  HL11-SHIP-TO-ADR-1              PIC  X(30)  VALUE SPACE. 05660017
056500     05  FILLER                          PIC  X(03)  VALUE SPACE. 05670017
056600     05  FILLER                          PIC  X(16)  VALUE        05680017
056700         'PAYS FREIGHT...:'.                                      05690017
056800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05700017
056900     05  HL11-PAYS-FRGT                  PIC  X(10)  VALUE SPACE. 05710017
057000     05  FILLER                          PIC  X(21)  VALUE SPACE. 05720017
057100     05  FILLER                          PIC  X(14)  VALUE        05730017
057200         'CREATED BY...:'.                                        05740017
057300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05750017
057400     05  HL11-CREATED-BY                 PIC  X(20)  VALUE SPACE. 05760017
057500     05  FILLER                          PIC  X(04)  VALUE SPACE. 05770017
057600                                                                  05780017
057700 01  HL12-HEADING-LINE-12.                                        05790017
057800     05  FILLER                          PIC  X(12)  VALUE SPACE. 05800017
057900     05  HL12-SHIP-TO-ADR-2              PIC  X(30)  VALUE SPACE. 05810017
058000     05  FILLER                          PIC  X(03)  VALUE SPACE. 05820017
058100     05  FILLER                          PIC  X(16)  VALUE        05830017
058200         'AD MERCHANDISE.:'.                                      05840017
058300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05850017
058400     05  HL12-AD-MDSE-IND                PIC  X(03)  VALUE SPACE. 05860017
058500     05  FILLER                          PIC  X(01)  VALUE SPACE. 05870017
058600     05  FILLER                          PIC  X(08)  VALUE        05880017
058700         'AD DATE:'.                                              05890017
058800     05  FILLER                          PIC  X(01)  VALUE SPACE. 05900017
058900     05  HL12-AD-DTE                     PIC  X(08)  VALUE SPACE. 05910017
059000     05  FILLER                          PIC  X(10)  VALUE SPACE. 05920017
059100     05  FILLER                          PIC  X(14)  VALUE        05930017
059200         'BUYER........:'.                                        05940017
059300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05950017
059400     05  HL12-BYR                        PIC  X(20)  VALUE SPACE. 05960017
059500     05  FILLER                          PIC  X(04)  VALUE SPACE. 05970017
059600                                                                  05980017
059700 01  HL13-HEADING-LINE-13.                                        05990017
059800     05  FILLER                          PIC  X(12)  VALUE SPACE. 06000017
059900     05  HL13-SHIP-TO-ADR-3              PIC  X(30)  VALUE SPACE. 06010017
060000     05  FILLER                          PIC  X(03)  VALUE SPACE. 06020017
060100     05  FILLER                          PIC  X(16)  VALUE        06030017
060200         'PRINTER ID.....:'.                                      06040017
060300     05  FILLER                          PIC  X(01)  VALUE SPACE. 06050017
060400     05  HL13-PRTR-ID                    PIC  X(08)  VALUE SPACE. 06060017
060500     05  FILLER                          PIC  X(27)  VALUE SPACE. 06070017
060600     05  FILLER                          PIC  X(14)  VALUE        06080017
060700         'APPROVED BY..:'.                                        06090017
060800     05  FILLER                          PIC  X(01)  VALUE SPACE. 06100017
060900     05  HL13-APPROVED-BY                PIC  X(20)  VALUE SPACE. 06110017
061000                                                                  06120017
061100 01  HL14-HEADING-LINE-14.                                        06130017
061200     05  FILLER                          PIC  X(01)  VALUE SPACE. 06140017
061300     05  FILLER                          PIC  X(13)  VALUE        06150017
061400         'INSTRUCTIONS:'.                                         06160017
061500     05  FILLER                          PIC X(118)  VALUE SPACE. 06170017
061600                                                                  06180017
061700 01  HL15-HEADING-LINE-15.                                        06190017
061800     05  HL15-INSTR-DESC                 PIC X(131)  VALUE SPACE. 06200017
061900     05  FILLER                          PIC  X(01)  VALUE SPACE. 06210017
062000*                                                                 06220017
062100 01  INSTR-RECIP-LINE.                                            06230017
062200     05  FILLER                          PIC  X(13)  VALUE        06240017
062300         '  RECIPIENT: '.                                         06250017
062400     05  INSTR-RECIP                     PIC  X(15)  VALUE SPACE. 06260017
062500     05  FILLER                          PIC X(104)  VALUE SPACE. 06270017
062600*                                                                 06280017
062700 01  ST-SYSTEM-TIME-DATE-AREA.                                    06290017
062800     05  ST-ABSTIME                      PIC S9(16)  VALUE +0     06300017
062900                                                     COMP SYNC.   06310017
063000     05  ST-SYSTEM-TIME.                                          06320017
063100         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 06330017
063200         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 06340017
063300             15  ST-SYSTEM-HOUR          PIC  X(02).              06350017
063400             15  FILLER                  PIC  X(01).              06360017
063500             15  ST-SYSTEM-MINUTE        PIC  X(02).              06370017
063600             15  FILLER                  PIC  X(01).              06380017
063700             15  ST-SYSTEM-SECOND        PIC  X(02).              06390017
063800     05  SD-SYSTEM-DATE.                                          06400017
063900         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 06410017
064000         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 06420017
064100             15  SD-SYSTEM-MONTH         PIC  X(02).              06430017
064200             15  FILLER                  PIC  X(01).              06440017
064300             15  SD-SYSTEM-DAY           PIC  X(02).              06450017
064400             15  FILLER                  PIC  X(01).              06460017
064500             15  SD-SYSTEM-YEAR          PIC  X(02).              06470017
064600         10  FILLER                      PIC  X(02)  VALUE SPACE. 06480017
064700     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       06490017
064800         10  FILLER                      PIC  X(06).              06500017
064900         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              06510017
065000     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     06520017
065100                                                     COMP.        06530017
065200*                                                                 06540017
065300 01  SKU-LINE-1.                                                  06550017
065400     05  SL1-SKU-NBR                  PIC  9999.                  06560017
065500     05  FILLER                       PIC  X(06) VALUE ' SKU: '.  06570017
065600     05  SL1-DEPT                     PIC  X(03).                 06580017
065700     05  FILLER                       PIC  X(01) VALUE SPACE.     06590017
065800     05  SL1-CLASS                    PIC  X(02).                 06600017
065900     05  FILLER                       PIC  X(01) VALUE SPACE.     06610017
066000     05  SL1-SKU                      PIC  X(03).                 06620017
066100     05  FILLER                       PIC  X(07) VALUE            06630017
066200         ' STYL: '.                                               06640017
066300     05  SL1-STYLE                    PIC  X(15).                 06650017
066400     05  FILLER                       PIC  X(07) VALUE            06660017
066500         ' DESC: '.                                               06670017
066600     05  SL1-DESC                     PIC  X(25).                 06680017
066700     05  FILLER                       PIC  X(06) VALUE            06690017
066800         ' QTY: '.                                                06700017
066900     05  SL1-QTY                      PIC  ZZZ,ZZZ.               06710017
067000     05  FILLER                       PIC  X(07) VALUE            06720017
067100         ' COST: '.                                               06730017
067200     05  SL1-COST                     PIC  $$,$$$.999.            06740017
067300     05  FILLER                       PIC  X(13) VALUE            06750017
067400         ' TOTAL COST: '.                                         06760017
067500     05  SL1-TOT-COST                 PIC  $$$$,$$$.99.           06770017
067600                                                                  06780017
067700 01  SKU-LINE-2.                                                  06790017
067800     05  FILLER                       PIC  X(07) VALUE            06800017
067900         'COLOR: '.                                               06810017
068000     05  SL2-COLOR                    PIC  X(15).                 06820017
068100     05  FILLER                       PIC  X(09) VALUE            06830017
068200         '   SIZE: '.                                             06840017
068300     05  SL2-SIZE                     PIC  X(15).                 06850017
068400     05  FILLER                       PIC  X(12) VALUE            06860017
068500         '   AD DATE: '.                                          06870017
068600     05  SL2-AD-DATE                  PIC  X(08).                 06880017
068700     05  FILLER                       PIC  X(09) VALUE            06890017
068800         '  GROUP: '.                                             06900017
068900     05  SL2-GRP-PRICE                PIC  X(13).                 06910017
069000     05  FILLER                       PIC  X(06) VALUE            06920017
069100         ' RTL: '.                                                06930017
069200     05  SL2-RTL-COST                 PIC  X(10).                 06940017
069300     05  FILLER                       PIC  X(13) VALUE            06950017
069400         '  TOTAL RTL: '.                                         06960017
069500     05  SL2-TOT-RTL-COST             PIC  X(11).                 06970017
069600                                                                  06980017
069700 01  LINE-CANCEL-LINE.                                            06990017
069800     05  FILLER                       PIC  X(39) VALUE            07000017
069900         '   *** THIS LINE HAS BEEN CANCELLED ***'.               07010017
070000     05  FILLER                       PIC  X(111) VALUE SPACE.    07020017
070100                                                                  07030017
070200 01  END-REPORT-LINE.                                             07040017
070300     05  FILLER                       PIC  X(64) VALUE SPACE.     07050017
070400     05  FILLER                       PIC  X(21) VALUE            07060017
070500         'END OF PURCHASE ORDER'.                                 07070017
070600     05  FILLER                       PIC  X(65) VALUE SPACE.     07080017
070700                                                                  07090017
070800 01  NOT-APPROVED-LINE.                                           07100017
070900     05  FILLER                       PIC  X(48) VALUE            07110017
071000         '***** PURCHASE ORDER HAS NOT BEEN APPROVED *****'.      07120017
071100     05  FILLER                       PIC  X(74) VALUE SPACE.     07130017
071200                                                                  07140017
071300 01  CANCELLED-LINE.                                              07150017
071400     05  FILLER                       PIC  X(45) VALUE            07160017
071500         '***** PURCHASE ORDER HAS BEEN CANCELLED *****'.         07170017
071600     05  FILLER                       PIC  X(77) VALUE SPACE.     07180017
071700                                                                  07190017
071800 01  REVISED-LINE.                                                07200017
071900     05  FILLER                       PIC  X(43) VALUE            07210017
072000         '***** PURCHASE ORDER HAS BEEN REVISED *****'.           07220017
072100     05  FILLER                       PIC  X(79) VALUE SPACE.     07230017
072200                                                                  07240017
072300******************************************************************07250017
072400*  CURSOR FOR INSTRUCTIONS                                        07260017
072500******************************************************************07270017
072600     EXEC SQL                                                     07280017
072700         DECLARE INST-CSR CURSOR FOR                              07290017
072800         SELECT B.INSTR_DESC,                                     07300017
072900                B.INSTR_NBR,                                      07310017
073000                C.RECIP_CDE,                                      07320017
073100                C.RECIP_DESC                                      07330017
073200         FROM   TPOINST A,                                        07340017
073300                TINSTCD B,                                        07350017
073400                TINRCCD C                                         07360017
073500         WHERE A.PO_NBR = :DK-ORD-NBR                             07370017
073600           AND A.RECIP_CDE LIKE :POINST-RECIP-CDE                 07380017
073700           AND B.INSTR_NBR = A.INSTR_NBR                          07390017
073800           AND C.RECIP_CDE = A.RECIP_CDE                          07400017
073900         ORDER BY RECIP_CDE, INSTR_NBR                            07410017
074000     END-EXEC.                                                    07420017
074100******************************************************************07430017
074200*  CURSOR FOR PO LINE ITEMS NOT APPROVED                          07440017
074300******************************************************************07450017
074400     EXEC SQL                                                     07460017
074500         DECLARE PO-LINE-CSR CURSOR FOR                           07470017
074600         SELECT CL_NBR,                                           07480017
074700                SKU_SEQ_NBR,                                      07490017
074800                VEND_STYL_NAME,                                   07500017
074900                SKU_DESC,                                         07510017
075000                UNT_QTY,                                          07520017
075100                UNT_COST_AMT,                                     07530017
075200                TOT_VAL_COST_AMT,                                 07540017
075300                COLOR_DESC,                                       07550017
075400                SIZE_DESC,                                        07560017
075500                AD_EVNT_DTE,                                      07570017
075600                GP_QTY,                                           07580017
075700                GP_RTL_AMT,                                       07590017
075800                UNT_RTL_PR_AMT,                                   07600017
075900                TOT_VAL_RTL_AMT,                                  07610017
076000                PO_LNE_NBR,                                       07620017
076100                STATUS_CDE                                        07630017
076200         FROM   TPURITM                                           07640017
076300         WHERE  PO_NBR = :DK-ORD-NBR                              07650017
076400           AND  VER_STATUS_CDE = 'A'                              07660017
076500         ORDER BY PO_LNE_NBR                                      07670017
076600     END-EXEC.                                                    07680017
076700******************************************************************07690017
076800*  CURSOR FOR PO LINE ITEMS APPROVED                              07700017
076900******************************************************************07710017
077000     EXEC SQL                                                     07720017
077100         DECLARE APP-PO-LINE-CSR CURSOR FOR                       07730017
077200         SELECT CL_NBR,                                           07740017
077300                SKU_SEQ_NBR,                                      07750017
077400                VEND_STYL_NAME,                                   07760017
077500                SKU_DESC,                                         07770017
077600                UNT_QTY,                                          07780017
077700                UNT_COST_AMT,                                     07790017
077800                TOT_VAL_COST_AMT,                                 07800017
077900                COLOR_DESC,                                       07810017
078000                SIZE_DESC,                                        07820017
078100                AD_EVNT_DTE,                                      07830017
078200                GP_QTY,                                           07840017
078300                GP_RTL_AMT,                                       07850017
078400                UNT_RTL_PR_AMT,                                   07860017
078500                TOT_VAL_RTL_AMT,                                  07870017
078600                PO_LNE_NBR,                                       07880017
078700                APP_PO_LNE_NBR,                                   07890017
078800                STATUS_CDE                                        07900017
078900         FROM   TPURITM                                           07910017
079000         WHERE  PO_NBR = :DK-ORD-NBR                              07920017
079100           AND  VER_STATUS_CDE = 'A'                              07930017
079200         ORDER BY APP_PO_LNE_NBR                                  07940017
079300     END-EXEC.                                                    07950017
079400                                                                  07960017
079500******************************************************************07970017
079600 LINKAGE SECTION.                                                 07980017
079700******************************************************************07990017
079800 01  DFHCOMMAREA                   PIC X(11).                     08000017
079900                                                                  08010017
080000******************************************************************08020017
080100 PROCEDURE DIVISION.                                              08030017
080200******************************************************************08040017
080300                                                                  08050017
080400******************************************************************08060017
080500*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   08070017
080600******************************************************************08080017
080700 0000-PROGRAM-MAINLINE.                                           08090017
080800                                                                  08100017
080900     PERFORM 1000-INITIALIZE.                                     08110017
081000     PERFORM 2000-PROCESS-REPORT.                                 08120017
081100                                                                  08130017
081200*    IF THE PRINTER HAS AUTO CUTTING, SEND THE CUT COMMAND        08140017
081300     IF  CA-PRTR-AUTO-CUTTER-IND = 'Y'                            08150017
081400     AND CA-NOT-FROM-PRINT-PACKAGE                                08160017
081500         MOVE PC-PUT                     TO DRS01-DRRB-FUNC       08170017
081600         MOVE DS004-PLC-CUT-FORM         TO DRS01-COMM-DATA       08180017
081700         MOVE SPACES                     TO DRS01-COMM-CTL        08190017
081800         PERFORM 8000-LINK-TO-DRS                                 08200017
081900     END-IF                                                       08210017
082000                                                                  08220017
082100*    TERMINATE THE DRS SESSION                                    08230017
082200     MOVE PC-TERM TO DRS01-DRRB-FUNC.                             08240017
082300     PERFORM 8000-LINK-TO-DRS.                                    08250017
082400                                                                  08260017
082500     GOBACK.                                                      08270017
082600                                                                  08280017
082700******************************************************************08290017
082800*  OPENS THE FILES  READ INPUT FILE, INITS HEADER FIELDS          08300017
082900******************************************************************08310017
083000 1000-INITIALIZE.                                                 08320017
083100     PERFORM 1100-RETRIEVE-STORED-DATA.                           08330017
083200     PERFORM 8100-FORMAT-TIME.                                    08340017
083300                                                                  08350017
083400     MOVE SD-SYSTEM-MONTH     TO  HL1-RUN-MONTH.                  08360017
083500     MOVE SD-SYSTEM-DAY       TO  HL1-RUN-DAY.                    08370017
083600     MOVE SD-SYSTEM-YEAR      TO  HL1-RUN-YEAR.                   08380017
083700     MOVE ST-SYSTEM-HOUR      TO  HL1-RUN-HOUR.                   08390017
083800     MOVE ST-SYSTEM-MINUTE    TO  HL1-RUN-MINUTE.                 08400017
083900     MOVE PC-CURRENT-PGM-NME  TO  HL1-PGM-NME.                    08410017
084000     MOVE 1                   TO  HL1-RPT-NBR.                    08420017
084100                                                                  08430017
084200     IF CA-PRTR-ID = 'XXXXXXXX'                                   08440017
084300         MOVE 'R'     TO DRS02-DRIB-CLASS                         08450017
084400         MOVE 'N'     TO DRS02-DRIB-HOLD                          08460017
084500         MOVE 'LOCAL' TO DRS02-DRIB-DEST                          08470017
084600     ELSE                                                         08480017
084700         MOVE 'A'            TO DRS02-DRIB-CLASS                  08490017
084800         MOVE 'N'            TO DRS02-DRIB-HOLD                   08500017
084900         MOVE CA-PRTR-ID TO DRS02-DRIB-DEST                       08510017
085000     END-IF.                                                      08520017
085100                                                                  08530017
085200     MOVE PC-INIT           TO DRS01-DRRB-FUNC.                   08540017
085300     MOVE DRS02-DRIB-HEADER TO DRS01-COMM-DRIB-HDR.               08550017
085400     MOVE DRS02-DRIB-ATTRIB TO DRS01-COMM-DRIB-AT1.               08560017
085500     PERFORM 8000-LINK-TO-DRS.                                    08570017
085600     SET PS-DRS-INITIALIZED TO TRUE.                              08580017
085700                                                                  08590017
085800     IF CA-PRTR-PRTR-CNTL-IND = 'P'                               08600017
085900     AND CA-NOT-FROM-PRINT-PACKAGE                                08610017
086000         PERFORM 1200-LOAD-FORM-TO-DRS                            08620017
086100     END-IF.                                                      08630017
086200     MOVE PC-PUT             TO  DRS01-DRRB-FUNC.                 08640017
086300                                                                  08650017
086400*                                                                 08660017
086500 1100-RETRIEVE-STORED-DATA.                                       08670017
086600     EXEC CICS                                                    08680017
086700         RETRIEVE                                                 08690017
086800             INTO  (CA-COMMAREA)                                  08700017
086900             RESP  (PV-CICS-RESPONSE)                             08710017
087000     END-EXEC.                                                    08720017
087100                                                                  08730017
087200     EVALUATE TRUE                                                08740017
087300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08750017
087400             MOVE CA-ORD-NBR  TO  DK-ORD-NBR                      08760017
087500         WHEN OTHER                                               08770017
087600             MOVE '1100-RETRIEVE-STORED-DATA'                     08780017
087700                 TO DP013-PARAGRAPH                               08790017
087800             MOVE 'UNABLE TO RETRIEVE DATA'                       08800017
087900                 TO DP013-MESSAGE-TEXT (1)                        08810017
088000             SET DP013-CICS-ABEND  TO TRUE                        08820017
088100             SET DP013-NO-ROLLBACK TO TRUE                        08830017
088200             PERFORM 9999-WRITE-CICS-LOG-MSG                      08840017
088300     END-EVALUATE.                                                08850017
088400                                                                  08860017
088500                                                                  08870017
088600***************************************************************   08880017
088700**  1200-LOAD-FORM-TO-DRS. -- CALL THE PRINT-PACKAGE PRINTER **   08890017
088800**  CONTROL MODULE TO GET THE FORM FOR SEND TO THE PRINTER.  **   08900017
088900**  THIS PARAGRAPH IS EXECUTED ONLY IF THE PRINTER ACCEPTS   **   08910017
089000**  PRINTER CONTROL COMMANDS                                 **   08920017
089100***************************************************************   08930017
089200 1200-LOAD-FORM-TO-DRS.                                           08940017
089300     INITIALIZE DP072-COMM-AREA.                                  08950017
089400     MOVE CA-PRTR-ID                 TO DP072-PRINTER-ID.         08960017
089500     MOVE PC-CURRENT-PGM-NME         TO DP072-RPT-PGM-NME.        08970017
089600     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     08980017
089700     SET DP072-SELECT TO TRUE.                                    08990017
089800                                                                  09000017
089900     PERFORM 1201-LINK-DPKCS060.                                  09010017
090000                                                                  09020017
090100     MOVE DP072-PRTR-TRACK-NBR       TO DS004-PLC-LF-FORM-NBR.    09030017
090200     MOVE DS004-PES-8LPI             TO DS004-PLC-LF-LPI.         09040017
090300     MOVE PC-PUT                     TO DRS01-DRRB-FUNC.          09050017
090400     MOVE DS004-PLC-LOAD-FORM        TO DRS01-COMM-DATA.          09060017
090500     PERFORM 8000-LINK-TO-DRS.                                    09070017
090600                                                                  09080017
090700 1201-LINK-DPKCS060.                                              09090017
090800***************************************************************   09100017
090900**  1101-LINK-DPKCS060 -- LINK TO THE PRINT-PACKACGE PRINTER **   09110017
091000**  CONTROL MODULE (DPKCS060)                                **   09120017
091100***************************************************************   09130017
091200     EXEC CICS                                                    09140017
091300         LINK PROGRAM  (PC-DPKCS060)                              09150017
091400              COMMAREA (DP072-COMM-AREA)                          09160017
091500              RESP     (PV-CICS-RESPONSE)                         09170017
091600     END-EXEC.                                                    09180017
091700                                                                  09190017
091800     EVALUATE TRUE                                                09200017
091900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09210017
092000             CONTINUE                                             09220017
092100         WHEN OTHER                                               09230017
092200               MOVE '1101-LINK-DPKCS060'                          09240017
092300                                    TO DP013-PARAGRAPH            09250017
092400               MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT (1)    09260017
092500               MOVE SQLCA           TO DP013-SQLCA                09270017
092600               SET DP013-LINK-RETURN                              09280017
092700                   DP013-CICS-ABEND                               09290017
092800                   DP013-NO-ROLLBACK TO TRUE                      09300017
092900               PERFORM 9999-WRITE-CICS-LOG-MSG                    09310017
093000     END-EVALUATE.                                                09320017
093100                                                                  09330017
093200                                                                  09340017
093300******************************************************************09350017
093400*  CONTROLS REPORT PROCESSING                                     09360017
093500******************************************************************09370017
093600 2000-PROCESS-REPORT.                                             09380017
093700     MOVE +1                       TO PV-PAGE-CNT.                09390017
093800     MOVE PV-PAGE-CNT              TO HL1-PG-NBR.                 09400017
093900     MOVE +0                       TO PV-LINE-CNT.                09410017
094000                                                                  09420017
094100     PERFORM 2100-PROCESS-HEADER.                                 09430017
094200     PERFORM 2200-PROCESS-INSTRUCTION.                            09440017
094300     PERFORM 2300-PROCESS-SKUS.                                   09450017
094400                                                                  09460017
094500     IF PV-LINE-CNT > +57                                         09470017
094600         ADD +1                    TO PV-PAGE-CNT                 09480017
094700         MOVE PV-PAGE-CNT          TO HL1-PG-NBR                  09490017
094800         MOVE +0                   TO PV-LINE-CNT                 09500017
094900                                                                  09510017
095000         MOVE HL1-HEADING-LINE-1   TO  DRS01-COMM-DATA            09520017
095100         MOVE PC-TOP-OF-PAGE       TO  DRS01-COMM-CTL             09530017
095200         PERFORM 8000-LINK-TO-DRS                                 09540017
095300                                                                  09550017
095400         MOVE HL2-HEADING-LINE-2   TO  DRS01-COMM-DATA            09560017
095500         MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL             09570017
095600         PERFORM 8000-LINK-TO-DRS                                 09580017
095700                                                                  09590017
095800         MOVE +2                   TO PV-LINE-CNT                 09600017
095900     END-IF.                                                      09610017
096000                                                                  09620017
096100     MOVE END-REPORT-LINE          TO  DRS01-COMM-DATA.           09630017
096200     MOVE PC-TRIPLE-SPACE          TO  DRS01-COMM-CTL.            09640017
096300     PERFORM 8000-LINK-TO-DRS.                                    09650017
096400                                                                  09660017
096500******************************************************************09670017
096600*  CONTROLS HEADER PROCESSING                                     09680017
096700******************************************************************09690017
096800 2100-PROCESS-HEADER.                                             09700017
096900                                                                  09710017
097000     PERFORM 2101-GET-TPURCHS.                                    09720017
097100     MOVE '01'                     TO ENTNME-TYPE-CDE.            09730017
097200     PERFORM 2102-GET-TENTNME.                                    09740017
097300     MOVE ENTNME-ENT-NAME-DESC     TO HL6-VEND-NME.               09750017
097400     PERFORM 2103-GET-TBUSLOC.                                    09760017
097500     PERFORM 2104-GET-TPLNSHP.                                    09770017
097600     IF PURCHS-DEST-KNOWN-IND = 'Y'                               09780017
097700         PERFORM 2196-COUNT-TALLPLNS                              09790017
097800         IF PV-DB2-COUNT > 1                                      09800017
097900             MOVE SPACE            TO HL11-SHIP-TO-ADR-1          09810017
098000                                      HL12-SHIP-TO-ADR-2          09820017
098100                                      HL13-SHIP-TO-ADR-3          09830017
098200             MOVE PC-SHIP-INST-ATT TO HL11-SHIP-TO-ADR-1          09840017
098300         ELSE                                                     09850017
098400             IF PV-DB2-COUNT = 0                                  09860017
098500                 MOVE SPACE        TO HL11-SHIP-TO-ADR-1          09870017
098600                                      HL12-SHIP-TO-ADR-2          09880017
098700                                      HL13-SHIP-TO-ADR-3          09890017
098800             ELSE                                                 09900017
098900                 PERFORM 2197-GET-SHIP-DEST                       09910017
099000                 PERFORM 2105-GET-LOC-INFO                        09920021
099100             END-IF                                               09930017
099200         END-IF                                                   09940017
099300     ELSE                                                         09950017
099400         MOVE SPACE                TO HL11-SHIP-TO-ADR-1          09960017
099500                                      HL12-SHIP-TO-ADR-2          09970017
099600                                      HL13-SHIP-TO-ADR-3          09980017
099700         MOVE PC-SHIP-INST-FOLL    TO HL11-SHIP-TO-ADR-1          09990017
099800     END-IF.                                                      10000017
099900     PERFORM 2106-GET-TPOAGMT-2.                                  10010017
100000     MOVE '1'                      TO POAGMT-TYP-CDE.             10020017
100100     PERFORM 2107-GET-TPOAGMT-4.                                  10030017
100200     IF SQLCODE = +0                                              10040017
100300         MOVE 'YES'                TO HL9-PRE-TKT-IND             10050017
100400     ELSE                                                         10060017
100500         MOVE 'NO '                TO HL9-PRE-TKT-IND             10070017
100600     END-IF.                                                      10080017
100700     MOVE '4'                      TO POAGMT-TYP-CDE.             10090017
100800     PERFORM 2107-GET-TPOAGMT-4.                                  10100017
100900     IF SQLCODE = +0                                              10110017
101000         MOVE 'YES'                TO HL10-PACK-BY-STR-IND        10120017
101100     ELSE                                                         10130017
101200         MOVE 'NO '                TO HL10-PACK-BY-STR-IND        10140017
101300     END-IF.                                                      10150017
101400     PERFORM 2110-GET-TMDSEAR.                                    10160017
101500     PERFORM 2111-GET-BUYER.                                      10170017
101600     MOVE PURCHS-CRE-BY-UID        TO WORKER-UID-NBR.             10180017
101700     PERFORM 2108-GET-TWORKER.                                    10190017
101800     IF SQLCODE = +0 OR -811                                      10200017
101900         MOVE 20                   TO DP024-FLNAME-LENGTH         10210017
102000         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 10220017
102100         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 10230017
102200         PERFORM DP024-0000-FORMAT-NAME                           10240017
102300         MOVE DP024-FLNAME         TO HL11-CREATED-BY             10250017
102400     ELSE                                                         10260017
102500         IF PURCHS-PO-TYP-CDE = 'MS'                              10270017
102600             MOVE 'MODEL STOCK'    TO HL11-CREATED-BY             10280017
102700         ELSE                                                     10290017
102800         IF PURCHS-PO-TYP-CDE = 'VN'                              10300017
181356         OR PURCHS-PO-TYP-CDE = 'VE'                              10310029
102900             MOVE 'VENDOR GENERATED' TO HL11-CREATED-BY           10320017
103000         ELSE                                                     10330017
103100         IF (PURCHS-PO-TYP-CDE = 'IN'                             10340028
181356         OR  PURCHS-PO-TYP-CDE = 'RE')                            10350029
103101                             OR                                   10360020
103110                     (PURCHS-PO-TYP-CDE = 'EC' AND                10370020
103120                           PURCHS-CRE-BY-UID = 'INFOREM')         10380020
103200             MOVE 'INFOREM     '   TO HL11-CREATED-BY             10390017
103300         ELSE                                                     10400017
103400             MOVE SPACE            TO HL11-CREATED-BY             10410017
103500         END-IF                                                   10420027
103600         END-IF                                                   10430017
103700         END-IF                                                   10440017
103800     END-IF.                                                      10450017
103900     MOVE PURCHS-APP-BY-UID        TO WORKER-UID-NBR.             10460017
104000     PERFORM 2108-GET-TWORKER.                                    10470017
104100     IF SQLCODE = +0 OR -811                                      10480017
104200         MOVE 20                   TO DP024-FLNAME-LENGTH         10490017
104300         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 10500017
104400         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 10510017
104500         PERFORM DP024-0000-FORMAT-NAME                           10520017
104600         MOVE DP024-FLNAME         TO HL13-APPROVED-BY            10530017
104700     ELSE                                                         10540017
104800         IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                      10550017
104900             PERFORM 2112-GET-DMM                                 10560017
105000         ELSE                                                     10570017
105100             MOVE SPACE            TO HL13-APPROVED-BY            10580017
105200         END-IF                                                   10590017
105300     END-IF.                                                      10600017
105400     PERFORM 2109-GET-TPURITM.                                    10610017
105500                                                                  10620017
105600     MOVE HL1-HEADING-LINE-1   TO  DRS01-COMM-DATA.               10630017
105700     MOVE PC-TOP-OF-PAGE       TO  DRS01-COMM-CTL.                10640017
105800     PERFORM 8000-LINK-TO-DRS.                                    10650017
105900                                                                  10660017
106000     MOVE HL2-HEADING-LINE-2   TO  DRS01-COMM-DATA.               10670017
106100     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10680017
106200     PERFORM 8000-LINK-TO-DRS.                                    10690017
106300                                                                  10700017
106400     MOVE HL3-HEADING-LINE-3   TO  DRS01-COMM-DATA.               10710017
106500     MOVE PC-DOUBLE-SPACE      TO  DRS01-COMM-CTL.                10720017
106600     PERFORM 8000-LINK-TO-DRS.                                    10730017
106700                                                                  10740017
106800     MOVE HL4-HEADING-LINE-4   TO  DRS01-COMM-DATA.               10750017
106900     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10760017
107000     PERFORM 8000-LINK-TO-DRS.                                    10770017
107100                                                                  10780017
107200     MOVE HL5-HEADING-LINE-5   TO  DRS01-COMM-DATA.               10790017
107300     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10800017
107400     PERFORM 8000-LINK-TO-DRS.                                    10810017
107500                                                                  10820017
107600     MOVE HL6-HEADING-LINE-6   TO  DRS01-COMM-DATA.               10830017
107700     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10840017
107800     PERFORM 8000-LINK-TO-DRS.                                    10850017
107900                                                                  10860017
108000     MOVE HL7-HEADING-LINE-7   TO  DRS01-COMM-DATA.               10870017
108100     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10880017
108200     PERFORM 8000-LINK-TO-DRS.                                    10890017
108300                                                                  10900017
108400     MOVE HL8-HEADING-LINE-8   TO  DRS01-COMM-DATA.               10910017
108500     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10920017
108600     PERFORM 8000-LINK-TO-DRS.                                    10930017
108700                                                                  10940017
108800     MOVE HL9-HEADING-LINE-9   TO  DRS01-COMM-DATA.               10950017
108900     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                10960017
109000     PERFORM 8000-LINK-TO-DRS.                                    10970017
109100                                                                  10980017
109200     MOVE HL10-HEADING-LINE-10 TO  DRS01-COMM-DATA.               10990017
109300     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                11000017
109400     PERFORM 8000-LINK-TO-DRS.                                    11010017
109500                                                                  11020017
109600     MOVE HL11-HEADING-LINE-11 TO  DRS01-COMM-DATA.               11030017
109700     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                11040017
109800     PERFORM 8000-LINK-TO-DRS.                                    11050017
109900                                                                  11060017
110000     MOVE HL12-HEADING-LINE-12 TO  DRS01-COMM-DATA.               11070017
110100     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                11080017
110200     PERFORM 8000-LINK-TO-DRS.                                    11090017
110300                                                                  11100017
110400     MOVE CA-PRTR-ID           TO  HL13-PRTR-ID.                  11110017
110500     MOVE HL13-HEADING-LINE-13 TO  DRS01-COMM-DATA.               11120017
110600     MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL.                11130017
110700     PERFORM 8000-LINK-TO-DRS.                                    11140017
110800                                                                  11150017
110900     MOVE +14                      TO PV-LINE-CNT.                11160017
111000*                                                                 11170017
111100******************************************************************11180017
111200*  RETRIEVES AND FORMATS PO DATA ON TPURCHS                       11190017
111300******************************************************************11200017
111400 2101-GET-TPURCHS.                                                11210017
111500                                                                  11220017
111600     EXEC SQL                                                     11230017
111700         SELECT ORD_DTE,                                          11240017
111800                PO_TYP_CDE,                                       11250017
111900                STATUS_CDE,                                       11260017
112000                ENT_ID,                                           11270017
112100                TOT_MU_PCT,                                       11280017
112200                TOT_VAL_COST_AMT,                                 11290017
112300                TOT_VAL_RTL_AMT,                                  11300017
112400                TOT_UNT_QTY,                                      11310017
112500                OTB_PER_NBR,                                      11320017
112600                EDI_IND,                                          11330017
112700                NEW_STR_PO_IND,                                   11340017
112800                CRE_BY_UID,                                       11350017
112900                APP_BY_UID,                                       11360017
113000                DEPT_NBR,                                         11370017
113100                ADR_SEQ_NBR,                                      11380017
113200                REVISION_CT,                                      11390017
113300                DEST_KNOWN_IND                                    11400017
113400         INTO  :PURCHS-ORD-DTE,                                   11410017
113500               :PURCHS-PO-TYP-CDE,                                11420017
113600               :PURCHS-STATUS-CDE,                                11430017
113700               :PURCHS-ENT-ID,                                    11440017
113800               :PURCHS-TOT-MU-PCT,                                11450017
113900               :PURCHS-TOT-VAL-COST-AMT,                          11460017
114000               :PURCHS-TOT-VAL-RTL-AMT,                           11470017
114100               :PURCHS-TOT-UNT-QTY,                               11480017
114200               :PURCHS-OTB-PER-NBR,                               11490017
114300               :PURCHS-EDI-IND,                                   11500017
114400               :PURCHS-NEW-STR-PO-IND,                            11510017
114500               :PURCHS-CRE-BY-UID,                                11520017
114600               :PURCHS-APP-BY-UID,                                11530017
114700               :PURCHS-DEPT-NBR,                                  11540017
114800               :PURCHS-ADR-SEQ-NBR,                               11550017
114900               :PURCHS-REVISION-CT,                               11560017
115000               :PURCHS-DEST-KNOWN-IND                             11570017
115100         FROM TPURCHS                                             11580017
115200         WHERE PO_NBR         = :DK-ORD-NBR                       11590017
115300           AND VER_STATUS_CDE = 'A'                               11600017
115400           AND PO_CATEG_CDE   = 'MR'                              11610017
115500     END-EXEC.                                                    11620017
115600                                                                  11630017
115700     EVALUATE TRUE                                                11640017
115800         WHEN SQLCODE = +0                                        11650017
115900             CONTINUE                                             11660017
116000         WHEN SQLWARN NOT = SPACE                                 11670017
116100         WHEN SQLCODE NOT = +0                                    11680017
116200             MOVE '2101-GET-TPURCHS'                              11690017
116300                 TO DP013-PARAGRAPH                               11700017
116400             MOVE 'OPEN THE STR_NBR_CSR'                          11710017
116500                 TO DP013-MESSAGE-TEXT (1)                        11720017
116600             MOVE SQLCA            TO DP013-SQLCA                 11730017
116700             MOVE 'TPURCHS'        TO DP013-DB2-TABLE-NAME (1)    11740021
116800             SET DP013-DB2-ABEND   TO TRUE                        11750017
116900             SET DP013-NO-ROLLBACK TO TRUE                        11760017
117000             PERFORM 9999-WRITE-CICS-LOG-MSG                      11770017
117100     END-EVALUATE.                                                11780017
117200                                                                  11790017
117300     MOVE CA-ORD-NBR               TO HL3-PO-NBR.                 11800017
117400     MOVE PURCHS-DEPT-NBR          TO HL5-DEPT-NBR.               11810017
117500     IF PURCHS-ORD-DTE = PC-INIT-DATE                             11820017
117600         MOVE SPACE                TO HL4-ORD-DTE                 11830017
117700     ELSE                                                         11840017
117800         MOVE PURCHS-ORD-DTE       TO PV-DATE-BREAK               11850017
117900         MOVE PV-DB-MM             TO PV-DBS-MM                   11860017
118000         MOVE PV-DB-DD             TO PV-DBS-DD                   11870017
118100         MOVE PV-DB-YY             TO PV-DBS-YY                   11880017
118200         MOVE PV-DATE-BREAK-SLASH  TO HL4-ORD-DTE                 11890017
118300     END-IF.                                                      11900017
118400*    IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              11910017
118500*        MOVE SPACE                TO HL3-MU-PCT                  11920017
118600*    ELSE                                                         11930017
118700         MOVE PURCHS-TOT-MU-PCT    TO PV-EDIT-MU-PCT              11940017
118800         MOVE PV-EDIT-MU-PCT       TO HL3-MU-PCT                  11950017
118900*    END-IF.                                                      11960017
119000     MOVE PURCHS-TOT-VAL-COST-AMT  TO HL4-COST.                   11970017
119100*    IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              11980017
119200*        MOVE SPACE                TO HL5-RTL                     11990017
119300*    ELSE                                                         12000017
119400         MOVE PURCHS-TOT-VAL-RTL-AMT                              12010017
119500                                   TO PV-DOL-FORM-13              12020017
119600         MOVE PV-DOL-FORM-13       TO HL5-RTL                     12030017
119700*    END-IF.                                                      12040017
119800     MOVE PURCHS-TOT-UNT-QTY       TO HL6-UNITS.                  12050017
119900     MOVE PURCHS-OTB-PER-NBR       TO PV-OTB-PER-BREAK.           12060017
120000     MOVE PC-MONTH-ABBR (PV-OTBP-MM-N)                            12070017
120100                                   TO HL5-OTBP-MONTH.             12080017
120200     MOVE PV-OTBP-CCYY             TO HL5-OTBP-YEAR.              12090017
120300     IF PURCHS-EDI-IND = 'Y'                                      12100017
120400         MOVE 'YES'                TO HL7-EDI-IND                 12110017
120500     ELSE                                                         12120017
120600         MOVE 'NO '                TO HL7-EDI-IND                 12130017
120700     END-IF.                                                      12140017
120800     IF PURCHS-NEW-STR-PO-IND = 'Y'                               12150017
120900         MOVE 'YES'                TO HL8-NEW-STR-IND             12160017
121000     ELSE                                                         12170017
121100         MOVE 'NO '                TO HL8-NEW-STR-IND             12180017
121200     END-IF.                                                      12190017
121300                                                                  12200017
121400******************************************************************12210017
121500*  RETRIEVES AND FORMATS PO DATA ON TENTNME                       12220017
121600******************************************************************12230017
121700 2102-GET-TENTNME.                                                12240017
121800                                                                  12250017
121900     EXEC SQL                                                     12260017
122000         SELECT ENT_NAME_DESC                                     12270017
122100         INTO  :ENTNME-ENT-NAME-DESC                              12280017
122200         FROM TENTNME                                             12290017
122300         WHERE ENT_ID = :PURCHS-ENT-ID                            12300017
122400           AND TYPE_CDE = :ENTNME-TYPE-CDE                        12310017
122500     END-EXEC.                                                    12320017
122600                                                                  12330017
122700     EVALUATE TRUE                                                12340017
122800         WHEN SQLCODE = +0                                        12350017
122900         WHEN SQLCODE = +100                                      12360017
123000             CONTINUE                                             12370017
123100         WHEN SQLWARN NOT = SPACE                                 12380017
123200         WHEN SQLCODE NOT = +0                                    12390017
123300             MOVE '2102-GET-TENTNME'                              12400017
123400                                   TO PV-ABEND-PARAGRAPH          12410017
123500             PERFORM 9999-WRITE-CICS-LOG-MSG                      12420017
123600     END-EVALUATE.                                                12430017
123700                                                                  12440017
123800     IF SQLCODE = +100                                            12450017
123900         MOVE SPACE TO ENTNME-ENT-NAME-DESC                       12460017
124000     END-IF.                                                      12470017
124100                                                                  12480017
124200                                                                  12490017
124300******************************************************************12500017
124400*  RETRIEVES AND FORMATS PO DATA ON TBUSLOC                       12510017
124500******************************************************************12520017
124600 2103-GET-TBUSLOC.                                                12530017
124700                                                                  12540017
124800     EXEC SQL                                                     12550017
124900         SELECT ADDRESS_LINE1_DESC,                               12560017
125000                ADDRESS_LINE2_DESC,                               12570017
125100                ATTENTION_TO_TXT,                                 12580017
125200                CITY_NAME,                                        12590017
125400                ZIP_CDE,                                          12600017
125500                ST_PROV_CDE,                                      12610017
125600                CNTRY_CDE                                         12620017
125900         INTO  :BUSLOC-ADDRESS-LINE1-DESC,                        12630017
126000               :BUSLOC-ADDRESS-LINE2-DESC,                        12640017
126100               :BUSLOC-ATTENTION-TO-TXT,                          12650017
126200               :BUSLOC-CITY-NAME,                                 12660017
126400               :BUSLOC-ZIP-CDE,                                   12670017
126500               :BUSLOC-ST-PROV-CDE,                               12680017
126600               :BUSLOC-CNTRY-CDE                                  12690017
126900         FROM TBUSLOC                                             12700017
127000         WHERE ENT_ID = :PURCHS-ENT-ID                            12710017
127100           AND FUNCTION_ID = 2                                    12720017
127200           AND SEQ_NBR = :PURCHS-ADR-SEQ-NBR                      12730017
127300     END-EXEC.                                                    12740017
127400                                                                  12750017
127500     EVALUATE TRUE                                                12760017
127600         WHEN SQLCODE = +0                                        12770017
127700         WHEN SQLCODE = +100                                      12780017
127800             CONTINUE                                             12790017
127900         WHEN SQLWARN NOT = SPACE                                 12800017
128000         WHEN SQLCODE NOT = +0                                    12810017
128100             MOVE '2103-GET-TBUSLOC'                              12820017
128200                                   TO PV-ABEND-PARAGRAPH          12830017
128300             PERFORM 9999-WRITE-CICS-LOG-MSG                      12840017
128400     END-EVALUATE.                                                12850017
128500                                                                  12860017
128600     IF SQLCODE = +100                                            12870017
128700         MOVE SPACE                TO HL7-VEND-ADR-1              12880017
128800                                      HL8-VEND-ADR-2              12890017
128900                                      HL9-VEND-ADR-3              12900017
129000     ELSE                                                         12910017
129100         MOVE BUSLOC-CITY-NAME    TO PV-CITY                      12920017
129200         IF BUSLOC-CNTRY-CDE = 'US ' OR SPACES                    12930017
129300             MOVE SPACES             TO PV-COUNTRY                12940017
129400                                        PV-STATE-PROV             12950017
129500             MOVE BUSLOC-ST-PROV-CDE TO PV-STATE-PROV             12960017
129600         ELSE                                                     12970017
129700             PERFORM 2150-RETRIEVE-PROV-COUNTRY                   12980017
129800         END-IF                                                   12990017
129900         MOVE BUSLOC-ADDRESS-LINE1-DESC                           13000017
130000                                   TO HL7-VEND-ADR-1              13010017
130100         IF BUSLOC-ADDRESS-LINE2-DESC > SPACE                     13020017
130200             MOVE BUSLOC-ADDRESS-LINE2-DESC                       13030017
130300                                   TO HL8-VEND-ADR-2              13040017
130400             INITIALIZE HL9-VEND-ADR-3                            13050017
130500             STRING PV-CITY             DELIMITED BY '  '         13060017
130600                    ', '                DELIMITED BY SIZE         13070017
130700                    PV-STATE-PROV       DELIMITED BY '  '         13080017
130800                    '  '                DELIMITED BY SIZE         13090017
131300                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         13100017
131400                    '  '                DELIMITED BY SIZE         13110017
131600                    PV-COUNTRY          DELIMITED BY '  '         13120017
131700                                 INTO HL9-VEND-ADR-3              13130017
131800         ELSE                                                     13140017
131900             INITIALIZE HL8-VEND-ADR-2                            13150017
132000             STRING PV-CITY             DELIMITED BY '  '         13160017
132100                    ', '                DELIMITED BY SIZE         13170017
132200                    PV-STATE-PROV       DELIMITED BY '  '         13180017
132300                    '  '                DELIMITED BY SIZE         13190017
132800                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         13200017
132900                    '  '                DELIMITED BY SIZE         13210017
133100                    PV-COUNTRY          DELIMITED BY '  '         13220017
133200                                 INTO HL8-VEND-ADR-2              13230017
133300             MOVE BUSLOC-ATTENTION-TO-TXT                         13240017
133400                                   TO HL9-VEND-ADR-3              13250017
133500         END-IF                                                   13260017
133600     END-IF.                                                      13270017
133700                                                                  13280017
133800                                                                  13290017
133900******************************************************************13300017
134000*  RETRIEVES AND FORMATS PO DATA ON TPLNSHP                       13310017
134100******************************************************************13320017
134200 2104-GET-TPLNSHP.                                                13330017
134300                                                                  13340017
134400     EXEC SQL                                                     13350017
134500         SELECT FOB_POINT_TXT,                                    13360017
134600                FRGT_PAYT_CDE,                                    13370017
134700                DONT_SHIP_BEF_DTE,                                13380017
134800                CAN_IFNOT_SHIP_DTE,                               13390017
134900                EXT_CAN_DTE                                       13400017
135000         INTO  :PLNSHP-FOB-POINT-TXT,                             13410017
135100               :PLNSHP-FRGT-PAYT-CDE,                             13420017
135200               :PLNSHP-DONT-SHIP-BEF-DTE,                         13430017
135300               :PLNSHP-CAN-IFNOT-SHIP-DTE,                        13440017
135400               :PLNSHP-EXT-CAN-DTE                                13450017
135500         FROM TPLNSHP                                             13460017
135600         WHERE PO_NBR = :DK-ORD-NBR                               13470017
135700           AND VER_STATUS_CDE = 'A'                               13480017
135800     END-EXEC.                                                    13490017
135900                                                                  13500017
136000     EVALUATE TRUE                                                13510017
136100         WHEN SQLCODE = +0                                        13520017
136200             CONTINUE                                             13530017
136300         WHEN SQLWARN NOT = SPACE                                 13540017
136400         WHEN SQLCODE NOT = +0                                    13550017
136500             MOVE '2104-GET-TPLNSHP'                              13560017
136600                                   TO PV-ABEND-PARAGRAPH          13570017
136700             PERFORM 9999-WRITE-CICS-LOG-MSG                      13580017
136800     END-EVALUATE.                                                13590017
136900                                                                  13600017
137000     MOVE PLNSHP-FOB-POINT-TXT     TO HL10-FOB-PT.                13610017
137100     IF PLNSHP-FRGT-PAYT-CDE = 'V'                                13620017
137200         MOVE '04' TO ENTNME-TYPE-CDE                             13630017
137300         PERFORM 2102-GET-TENTNME                                 13640017
137400         MOVE ENTNME-ENT-NAME-DESC TO HL11-PAYS-FRGT              13650017
137500     ELSE                                                         13660017
137600         IF PLNSHP-FRGT-PAYT-CDE = 'B'                            13670017
137700             MOVE 'BOTH'           TO HL11-PAYS-FRGT              13680017
137800         ELSE                                                     13690017
137900             MOVE 'KOHLS'          TO HL11-PAYS-FRGT              13700017
138000         END-IF                                                   13710017
138100     END-IF.                                                      13720017
138200     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DATE-BREAK.              13730017
138300     MOVE PV-DB-MM                 TO HL3-DNSB-MONTH.             13740017
138400     MOVE PV-DB-DD                 TO HL3-DNSB-DAY.               13750017
138500     MOVE PV-DB-YY                 TO HL3-DNSB-YEAR.              13760017
138600     IF PLNSHP-CAN-IFNOT-SHIP-DTE > PLNSHP-EXT-CAN-DTE            13770017
138700         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                           13780017
138800                                   TO PV-DATE-BREAK               13790017
138900         MOVE PV-DB-MM             TO HL4-CNSB-MONTH              13800017
139000         MOVE PV-DB-DD             TO HL4-CNSB-DAY                13810017
139100         MOVE PV-DB-YY             TO HL4-CNSB-YEAR               13820017
139200     ELSE                                                         13830017
139300         MOVE PLNSHP-EXT-CAN-DTE                                  13840017
139400                                   TO PV-DATE-BREAK               13850017
139500         MOVE PV-DB-MM             TO HL4-CNSB-MONTH              13860017
139600         MOVE PV-DB-DD             TO HL4-CNSB-DAY                13870017
139700         MOVE PV-DB-YY             TO HL4-CNSB-YEAR               13880017
139800     END-IF.                                                      13890017
139900                                                                  13900017
140000                                                                  13910017
140100******************************************************************13920017
140200*  RETRIEVES AND FORMATS SHIP TO DATA FROM THE LOGISTICS DOMAIN   13930021
140210*  LOCATION MASTER DATA MODULE (XLKUT071)                         13940021
140300******************************************************************13950017
140400 2105-GET-LOC-INFO.                                               13960021
140500                                                                  13970017
140510     INITIALIZE XL071-COMMAREA-REC.                               13980021
140520     MOVE ALLPLN-DEST-NBR        TO XL071-LOCATION-NUMBER.        13990021
140530                                                                  14000021
140540     CALL XL071-LOCATION-MODULE USING                             14010021
140550                                    DFHEIBLK                      14020021
140560                                    XL071-COMMAREA                14030021
140570                                    XL071-COMMAREA-REC.           14040021
140580     EVALUATE TRUE                                                14050021
140590         WHEN XL071-NO-ERRORS                                     14060021
140591              MOVE XL071-LOC-NM         TO HL10-SHIP-TO-NME       14070021
140592              MOVE XL071-LNE-1-ADDR     TO HL11-SHIP-TO-ADR-1     14080021
140595              MOVE XL071-ZIP-10-CDE     TO PV-EDIT-ZIP-CODE       14090021
140596              MOVE PV-EZCB-1-5          TO PV-ZCD-1-5             14100021
140597              MOVE PV-EZCB-6-9          TO PV-ZCD-6-9             14110021
140598              IF XL071-LNE-2-ADDR > SPACE                         14120021
140600                  MOVE XL071-LNE-2-ADDR TO HL12-SHIP-TO-ADR-2     14130021
140601                  STRING XL071-CTY-NM           DELIMITED BY '  ' 14140021
140602                         ', '                   DELIMITED BY SIZE 14150021
140603                         XL071-ST-CDE           DELIMITED BY '  ' 14160021
140604                         '  '                   DELIMITED BY SIZE 14170021
140605                         PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE 14180021
140606                                      INTO HL13-SHIP-TO-ADR-3     14190021
140607              ELSE                                                14200021
140608                  STRING XL071-CTY-NM           DELIMITED BY '  ' 14210021
140609                         ', '                   DELIMITED BY SIZE 14220021
140610                         XL071-ST-CDE           DELIMITED BY '  ' 14230021
140611                         '  '                   DELIMITED BY SIZE 14240021
140612                         PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE 14250021
140613                                      INTO HL12-SHIP-TO-ADR-2     14260021
140614                  MOVE SPACE            TO HL13-SHIP-TO-ADR-3     14270021
   607              END-IF                                              14280022
140621         WHEN XL071-LOC-NOT-FOUND                                 14290021
140625              MOVE SPACE                TO HL10-SHIP-TO-NME       14300021
140626                                           HL11-SHIP-TO-ADR-1     14310021
140627                                           HL12-SHIP-TO-ADR-2     14320021
140628                                           HL13-SHIP-TO-ADR-3     14330021
140629         WHEN XL071-BAD-DB2-RETURN                                14340021
140631              MOVE '2105-GET-LOC-INFO'  TO DP013-PARAGRAPH        14350021
140633              MOVE 'CALL XLKUT071'      TO DP013-MESSAGE-TEXT (1) 14360021
140634              STRING 'XLKUT071 TABLE '    DELIMITED BY SIZE       14370021
140635                     'WAS: '              DELIMITED BY SIZE       14380021
140636                     XL071-DB2-TABLE      DELIMITED BY SIZE       14390021
140637                                      INTO DP013-MESSAGE-TEXT (2) 14400021
140638              STRING 'SQL CODE WAS: '     DELIMITED BY SIZE       14410021
140640                     XL071-SQLCODE        DELIMITED BY SIZE       14420021
140641                                      INTO DP013-MESSAGE-TEXT (2) 14430021
140642              MOVE XL071-SQLCA         TO DP013-SQLCA             14440021
140643              MOVE 'LOCATION TABLES'   TO DP013-DB2-TABLE-NAME (1)14450021
140647              PERFORM 9999-WRITE-CICS-LOG-MSG                     14460021
140648     END-EVALUATE.                                                14470021
146700                                                                  14480017
146800                                                                  14490017
146900******************************************************************14500017
147000*  RETRIEVES AND FORMATS PO DATA ON PAYMENT TPOAGMT               14510017
147100******************************************************************14520017
147200 2106-GET-TPOAGMT-2.                                              14530017
147300                                                                  14540017
147400     EXEC SQL                                                     14550017
147500         SELECT PAYT_TERM_ID,                                     14560017
147600                DISC_PAY_DAY_QTY,                                 14570017
147700                DISC_DOL_AMT,                                     14580017
147800                DISC_PCT                                          14590017
147900         INTO  :POAGMT-PAYT-TERM-ID,                              14600017
148000               :POAGMT-DISC-PAY-DAY-QTY,                          14610017
148100               :POAGMT-DISC-DOL-AMT,                              14620017
148200               :POAGMT-DISC-PCT                                   14630017
148300         FROM TPOAGMT                                             14640017
148400         WHERE PO_NBR = :DK-ORD-NBR                               14650017
148500           AND VER_STATUS_CDE = 'A'                               14660017
148600           AND AGRMT_TYP_ID = '2'                                 14670017
148700     END-EXEC.                                                    14680017
148800                                                                  14690017
148900     EVALUATE TRUE                                                14700017
149000         WHEN SQLCODE = +0                                        14710017
149100             CONTINUE                                             14720017
149200         WHEN SQLWARN NOT = SPACE                                 14730017
149300         WHEN SQLCODE NOT = +0                                    14740017
149400             MOVE '2106-GET-TPOAGMT-2'                            14750017
149500                                   TO PV-ABEND-PARAGRAPH          14760017
149600             PERFORM 9999-WRITE-CICS-LOG-MSG                      14770017
149700     END-EVALUATE.                                                14780017
149800                                                                  14790017
149900     MOVE POAGMT-DISC-PAY-DAY-QTY  TO HL8-EXTENDED-DTE.           14800017
150000     MOVE POAGMT-DISC-DOL-AMT      TO HL9-VEND-DISC-AMT.          14810017
150100     COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100.                 14820017
150200     MOVE PV-PCT-HOLD              TO HL9-VEND-DISC-PCT.          14830017
150300     PERFORM 2198-GET-TPAYTRM.                                    14840017
150400     IF SQLCODE = +0                                              14850017
150500         PERFORM 2199-FORMAT-PAYMENT-TERM                         14860017
150600     ELSE                                                         14870017
150700         MOVE SPACE                TO HL7-PAYT-TERM               14880017
150800     END-IF.                                                      14890017
150900                                                                  14900017
151000                                                                  14910017
151100******************************************************************14920017
151200*  RETRIEVES TPOAGMT TO CHECK FOR EXISTENCE                       14930017
151300******************************************************************14940017
151400 2107-GET-TPOAGMT-4.                                              14950017
151500                                                                  14960017
151600     EXEC SQL                                                     14970017
151700         SELECT TYP_CDE                                           14980017
151800         INTO  :POAGMT-TYP-CDE                                    14990017
151900         FROM TPOAGMT                                             15000017
152000         WHERE PO_NBR = :DK-ORD-NBR                               15010017
152100           AND VER_STATUS_CDE = 'A'                               15020017
152200           AND AGRMT_TYP_ID = '4'                                 15030017
152300           AND TYP_CDE = :POAGMT-TYP-CDE                          15040017
152400     END-EXEC.                                                    15050017
152500                                                                  15060017
152600     EVALUATE TRUE                                                15070017
152700         WHEN SQLCODE = +0                                        15080017
152800         WHEN SQLCODE = +100                                      15090017
152900             CONTINUE                                             15100017
153000         WHEN SQLWARN NOT = SPACE                                 15110017
153100         WHEN SQLCODE NOT = +0                                    15120017
153200             MOVE '2107-GET-TPOAGMT-4'                            15130017
153300                                   TO PV-ABEND-PARAGRAPH          15140017
153400             PERFORM 9999-WRITE-CICS-LOG-MSG                      15150017
153500     END-EVALUATE.                                                15160017
153600                                                                  15170017
153700                                                                  15180017
153800******************************************************************15190017
153900*  RETRIEVES NAMES FROM TWORKER                                   15200017
154000******************************************************************15210017
154100 2108-GET-TWORKER.                                                15220017
154200                                                                  15230017
154300     EXEC SQL                                                     15240017
154400         SELECT LAST_NAME,                                        15250017
154500                FIR_NAME                                          15260017
154600         INTO  :WORKER-LAST-NAME,                                 15270017
154700               :WORKER-FIR-NAME                                   15280017
154800         FROM TWORKER                                             15290017
154900         WHERE UID_NBR = :WORKER-UID-NBR                          15300017
155000     END-EXEC.                                                    15310017
155100                                                                  15320017
155200     EVALUATE TRUE                                                15330017
155300         WHEN SQLCODE = +0                                        15340017
155400         WHEN SQLCODE = +100                                      15350017
155500         WHEN SQLCODE = -811                                      15360017
155600             CONTINUE                                             15370017
155700         WHEN SQLWARN NOT = SPACE                                 15380017
155800         WHEN SQLCODE NOT = +0                                    15390017
155900             MOVE '2108-GET-TWORKER'                              15400017
156000                                   TO PV-ABEND-PARAGRAPH          15410017
156100             PERFORM 9999-WRITE-CICS-LOG-MSG                      15420017
156200     END-EVALUATE.                                                15430017
156300                                                                  15440017
156400     IF SQLCODE = +100                                            15450017
156500         MOVE SPACE                TO WORKER-LAST-NAME            15460017
156600                                      WORKER-FIR-NAME             15470017
156700     END-IF.                                                      15480017
156800                                                                  15490017
156900                                                                  15500017
157000******************************************************************15510017
157100*  RETRIEVES ANY AD MERCHANDISE FROM TPURITM                      15520017
157200******************************************************************15530017
157300 2109-GET-TPURITM.                                                15540017
157400                                                                  15550017
157500     EXEC SQL                                                     15560017
157600         SELECT MIN(AD_EVNT_DTE)                                  15570017
157700         INTO  :PURITM-AD-EVNT-DTE:PV-NULL-IND                    15580017
157800         FROM TPURITM                                             15590017
157900         WHERE PO_NBR  = :DK-ORD-NBR                              15600017
158000           AND VER_STATUS_CDE = 'A'                               15610017
158100           AND AD_EVNT_DTE > :PC-INIT-DATE                        15620017
158200           AND STATUS_CDE ^= 'CA'                                 15630017
158300     END-EXEC.                                                    15640017
158400                                                                  15650017
158500     EVALUATE TRUE                                                15660017
158600         WHEN SQLCODE = +0                                        15670017
158700         WHEN SQLCODE = +100                                      15680017
158800             CONTINUE                                             15690017
158900         WHEN SQLWARN NOT = SPACE                                 15700017
159000         WHEN SQLCODE NOT = +0                                    15710017
159100             MOVE '2109-GET-TPURITM'                              15720017
159200                                   TO PV-ABEND-PARAGRAPH          15730017
159300             PERFORM 9999-WRITE-CICS-LOG-MSG                      15740017
159400     END-EVALUATE.                                                15750017
159500                                                                  15760017
159600     IF SQLCODE = +100 OR                                         15770017
159700        PV-NULL-IND < +0                                          15780017
159800         MOVE 'NO '                TO HL12-AD-MDSE-IND            15790017
159900         MOVE SPACE                TO HL12-AD-DTE                 15800017
160000     ELSE                                                         15810017
160100         MOVE 'YES'                TO HL12-AD-MDSE-IND            15820017
160200         MOVE PURITM-AD-EVNT-DTE   TO PV-DATE-BREAK               15830017
160300         MOVE PV-DB-MM             TO PV-DBS-MM                   15840017
160400         MOVE PV-DB-DD             TO PV-DBS-DD                   15850017
160500         MOVE PV-DB-YY             TO PV-DBS-YY                   15860017
160600         MOVE PV-DATE-BREAK-SLASH  TO HL12-AD-DTE                 15870017
160700     END-IF.                                                      15880017
160800                                                                  15890017
160900                                                                  15900017
161000******************************************************************15910017
161100*  GET DEPARTMENT NAME FROM TMDSEAR                               15920017
161200******************************************************************15930017
161300 2110-GET-TMDSEAR.                                                15940017
161400                                                                  15950017
161500     EXEC SQL                                                     15960017
161600         SELECT MDSEAR_DESC                                       15970017
161700               ,MDSEAR_DKEY                                       15980017
161800               ,GMA_NBR                                           15990017
161900               ,DMA_NBR                                           16000017
162000         INTO  :MDSEAR-DESC                                       16010017
162100              ,:MDSEAR-DKEY                                       16020017
162200              ,:MDSEAR-GMA-NBR                                    16030017
162300              ,:MDSEAR-DMA-NBR                                    16040017
162400         FROM TMDSEAR                                             16050017
162500         WHERE OPERCO_NBR = '03'                                  16060017
162600           AND DEPT_NBR = :PURCHS-DEPT-NBR                        16070017
162700           AND MDSELV_CDE = 'DPT'                                 16080017
162800           AND STRT_DTE <= CURRENT DATE                           16090017
162900           AND END_DTE >= CURRENT DATE                            16100017
163000     END-EXEC.                                                    16110017
163100                                                                  16120017
163200     EVALUATE TRUE                                                16130017
163300         WHEN SQLCODE = +0                                        16140017
163400         WHEN SQLCODE = +100                                      16150017
163500             CONTINUE                                             16160017
163600         WHEN SQLWARN NOT = SPACE                                 16170017
163700         WHEN SQLCODE NOT = +0                                    16180017
163800             MOVE '2110-GET-TMDSEAR'                              16190017
163900                                   TO PV-ABEND-PARAGRAPH          16200017
164000             PERFORM 9999-WRITE-CICS-LOG-MSG                      16210017
164100     END-EVALUATE.                                                16220017
164200                                                                  16230017
164300     IF SQLCODE = +100                                            16240017
164400         MOVE SPACE                TO HL5-DEPT-DESC               16250017
164500     ELSE                                                         16260017
164600         MOVE MDSEAR-DESC          TO HL5-DEPT-DESC               16270017
164700     END-IF.                                                      16280017
164800                                                                  16290017
164900                                                                  16300017
165000******************************************************************16310017
165100*  GET BUYER NAME FROM TRSPBAR                                    16320017
165200******************************************************************16330017
165300 2111-GET-BUYER.                                                  16340017
165400                                                                  16350017
165500     EXEC SQL                                                     16360017
165600         SELECT WORKER_LAST_NAME                                  16370017
165700               ,WORKER_FIR_NAME                                   16380017
165800         INTO  :RSPBAR-WORKER-LAST-NAME                           16390017
165900              ,:RSPBAR-WORKER-FIR-NAME                            16400017
166000         FROM TRSPBAR                                             16410017
166100         WHERE MDSEAR_DKEY = :MDSEAR-DKEY                         16420017
166200           AND RSPLVL_CDE = 'BYR'                                 16430017
166300           AND WORKER_STRT_DTE <= CURRENT DATE                    16440017
166400           AND WORKER_END_DTE >= CURRENT DATE                     16450017
166500     END-EXEC.                                                    16460017
166600                                                                  16470017
166700     EVALUATE TRUE                                                16480017
166800         WHEN SQLCODE = +0                                        16490017
166900         WHEN SQLCODE = +100                                      16500017
167000             CONTINUE                                             16510017
167100         WHEN SQLWARN NOT = SPACE                                 16520017
167200         WHEN SQLCODE NOT = +0                                    16530017
167300             MOVE '2111-GET-BUYER'                                16540017
167400                                   TO PV-ABEND-PARAGRAPH          16550017
167500             PERFORM 9999-WRITE-CICS-LOG-MSG                      16560017
167600     END-EVALUATE.                                                16570017
167700                                                                  16580017
167800     IF SQLCODE = +100                                            16590017
167900         MOVE SPACE                TO HL12-BYR                    16600017
168000     ELSE                                                         16610017
168100         MOVE 20                   TO DP024-FLNAME-LENGTH         16620017
168200         MOVE RSPBAR-WORKER-LAST-NAME                             16630017
168300                                   TO DP024-LNAME                 16640017
168400         MOVE RSPBAR-WORKER-FIR-NAME                              16650017
168500                                   TO DP024-FNAME                 16660017
168600         PERFORM DP024-0000-FORMAT-NAME                           16670017
168700         MOVE DP024-FLNAME         TO HL12-BYR                    16680017
168800     END-IF.                                                      16690017
168900                                                                  16700017
169000                                                                  16710017
169100******************************************************************16720017
169200*  RETRIEVES NAME OF DMM                                          16730017
169300******************************************************************16740017
169400 2112-GET-DMM.                                                    16750017
169500                                                                  16760017
169600     EXEC SQL                                                     16770017
169700         SELECT DISTINCT B.WORKER_LAST_NAME,                      16780017
169800                         B.WORKER_FIR_NAME                        16790017
169900         INTO  :RSPBAR-WORKER-LAST-NAME,                          16800017
170000               :RSPBAR-WORKER-FIR-NAME                            16810017
170100         FROM TMDSEAR A,                                          16820017
170200              TRSPBAR B                                           16830017
170300         WHERE A.OPERCO_NBR  = '03'                               16840017
170400           AND A.GMA_NBR     = :MDSEAR-GMA-NBR                    16850017
170500           AND A.DMA_NBR     = :MDSEAR-DMA-NBR                    16860017
170600           AND MDSELV_CDE    = 'DMA'                              16870017
170700           AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                      16880017
170800           AND B.RSPLVL_CDE  = 'DMM'                              16890017
170900           AND B.WORKER_STRT_DTE < CURRENT DATE                   16900017
171000           AND B.WORKER_END_DTE  > CURRENT DATE                   16910017
171100     END-EXEC.                                                    16920017
171200                                                                  16930017
171300     EVALUATE TRUE                                                16940017
171400         WHEN SQLCODE = +0                                        16950017
171500         WHEN SQLCODE = +100                                      16960017
171600             CONTINUE                                             16970017
171700         WHEN SQLWARN NOT = SPACE                                 16980017
171800         WHEN SQLCODE NOT = +0                                    16990017
171900             MOVE '2112-GET-DMM    '                              17000017
172000                                   TO PV-ABEND-PARAGRAPH          17010017
172100             PERFORM 9999-WRITE-CICS-LOG-MSG                      17020017
172200     END-EVALUATE.                                                17030017
172300                                                                  17040017
172400     IF SQLCODE = +100                                            17050017
172500         MOVE SPACE                TO HL13-APPROVED-BY            17060017
172600     ELSE                                                         17070017
172700         MOVE 20                   TO DP024-FLNAME-LENGTH         17080017
172800         MOVE RSPBAR-WORKER-LAST-NAME                             17090017
172900                                   TO DP024-LNAME                 17100017
173000         MOVE RSPBAR-WORKER-FIR-NAME                              17110017
173100                                   TO DP024-FNAME                 17120017
173200         PERFORM DP024-0000-FORMAT-NAME                           17130017
173300         MOVE DP024-FLNAME         TO HL13-APPROVED-BY            17140017
173400     END-IF.                                                      17150017
173500                                                                  17160017
173600******************************************************************17170017
173700*  RETRIEVE THE COUNTRY AND PROVINCE FROM THE PEOPLESOFT TABLES   17180017
173800******************************************************************17190017
173900 2150-RETRIEVE-PROV-COUNTRY.                                      17200017
174000                                                                  17210017
174100     MOVE BUSLOC-ST-PROV-CDE     TO DP410-STATE-CODE.             17220017
174200     MOVE BUSLOC-CNTRY-CDE       TO DP410-COUNTRY-CODE.           17230017
174300                                                                  17240017
174400     CALL PC-DPKUT410 USING DFHEIBLK                              17250017
174500                            PV-DPKUT410-COMMAREA                  17260017
174600                            DP410-ST-PROV-CNTRY-ROUTINE.          17270017
174700                                                                  17280017
174800     EVALUATE TRUE                                                17290017
174900                                                                  17300017
175000         WHEN  DP410-DB2-ERROR                                    17310017
175100             DISPLAY 'STATE/PROV = ' DP410-STATE-CODE             17320017
175200             DISPLAY 'COUNTRY = ' DP410-COUNTRY-CODE              17330017
175300             MOVE '2150-RETRIEVE-PROV-COUNTRY'                    17340017
175400                                   TO PV-ABEND-PARAGRAPH          17350017
175500             PERFORM 9999-WRITE-CICS-LOG-MSG                      17360017
175600                                                                  17370017
175601         WHEN  DP410-DEADLOCK-BYPASS-ROUTINE                      17380018
175602             MOVE DP410-STATE-CODE TO PV-STATE-PROV               17390018
175603             MOVE DP410-COUNTRY-CODE TO PV-COUNTRY                17400018
175610                                                                  17410018
175700         WHEN  OTHER                                              17420017
175800             MOVE SPACES             TO PV-STATE-PROV             17430017
175900                                        PV-COUNTRY                17440017
176000             MOVE DP410-STATE-NAME   TO PV-STATE-PROV             17450017
176100             MOVE DP410-COUNTRY-NAME TO PV-COUNTRY                17460017
176200     END-EVALUATE.                                                17470017
176300                                                                  17480017
176400******************************************************************17490017
176500*  COUNTS TALLPLANS                                               17500017
176600******************************************************************17510017
176700 2196-COUNT-TALLPLNS.                                             17520017
176800                                                                  17530017
176900     INITIALIZE PV-DB2-COUNT.                                     17540017
177000     EXEC SQL                                                     17550017
177100          SELECT COUNT(DISTINCT(DEST_NBR))                        17560017
177200          INTO :PV-DB2-COUNT                                      17570017
177300          FROM TALLPLN                                            17580017
177400          WHERE PO_NBR = :DK-ORD-NBR                              17590017
177500     END-EXEC.                                                    17600017
177600                                                                  17610017
177700     EVALUATE TRUE                                                17620017
177800         WHEN SQLCODE = +0                                        17630017
177900         WHEN SQLCODE = +100                                      17640017
178000              CONTINUE                                            17650017
178100                                                                  17660017
178200         WHEN SQLWARN0 NOT = SPACE                                17670017
178300         WHEN SQLCODE < +0                                        17680017
178400         WHEN SQLCODE > +0                                        17690017
178500             MOVE '2196-COUNT-TALLPLN'                            17700017
178600                                   TO PV-ABEND-PARAGRAPH          17710017
178700             PERFORM 9999-WRITE-CICS-LOG-MSG                      17720017
178800     END-EVALUATE.                                                17730017
178900                                                                  17740017
179000                                                                  17750017
179100******************************************************************17760017
179200*  GET DEST NUMBER                                                17770017
179300******************************************************************17780017
179400 2197-GET-SHIP-DEST.                                              17790017
179500                                                                  17800017
179600     INITIALIZE PV-DB2-COUNT.                                     17810017
179700     EXEC SQL                                                     17820017
179800          SELECT DISTINCT(DEST_NBR)                               17830017
179900          INTO :ALLPLN-DEST-NBR                                   17840017
180000          FROM TALLPLN                                            17850017
180100          WHERE PO_NBR = :DK-ORD-NBR                              17860017
180200     END-EXEC.                                                    17870017
180300                                                                  17880017
180400     EVALUATE TRUE                                                17890017
180500         WHEN SQLCODE = +0                                        17900017
180600              CONTINUE                                            17910017
180700         WHEN SQLWARN0 NOT = SPACE                                17920017
180800         WHEN SQLCODE < +0                                        17930017
180900         WHEN SQLCODE > +0                                        17940017
181000             MOVE '2197-GET-SHIP-DEST'                            17950017
181100                                   TO PV-ABEND-PARAGRAPH          17960017
181200             PERFORM 9999-WRITE-CICS-LOG-MSG                      17970017
181300     END-EVALUATE.                                                17980017
181400                                                                  17990017
181500                                                                  18000017
181600******************************************************************18010017
181700*  GETS TPAYTRM DATA                                              18020017
181800******************************************************************18030017
181900 2198-GET-TPAYTRM.                                                18040017
182000                                                                  18050017
182100     EXEC SQL                                                     18060017
182200         SELECT DISCOUNT_DAYS_QTY,                                18070017
182300                DISCOUNT_PCT,                                     18080017
182400                DUE_DAY_QTY,                                      18090017
182500                DUE_DAY_FR_DTE_TXT,                               18100017
182600                OTHER_TXT                                         18110017
182700         INTO  :PAYTRM-DISCOUNT-DAYS-QTY,                         18120017
182800               :PAYTRM-DISCOUNT-PCT,                              18130017
182900               :PAYTRM-DUE-DAY-QTY,                               18140017
183000               :PAYTRM-DUE-DAY-FR-DTE-TXT,                        18150017
183100               :PAYTRM-OTHER-TXT                                  18160017
183200         FROM TPAYTRM                                             18170017
183300         WHERE PAY_TERM_ID = :POAGMT-PAYT-TERM-ID                 18180017
183400     END-EXEC.                                                    18190017
183500                                                                  18200017
183600     EVALUATE TRUE                                                18210017
183700         WHEN SQLCODE = +0                                        18220017
183800         WHEN SQLCODE = +100                                      18230017
183900             CONTINUE                                             18240017
184000         WHEN SQLWARN NOT = SPACE                                 18250017
184100         WHEN SQLCODE NOT = +0                                    18260017
184200             MOVE '2198-GET-TPAYTRM'                              18270017
184300                                   TO PV-ABEND-PARAGRAPH          18280017
184400             PERFORM 9999-WRITE-CICS-LOG-MSG                      18290017
184500     END-EVALUATE.                                                18300017
184600                                                                  18310017
184700                                                                  18320017
184800******************************************************************18330017
184900*  FORMATS PAYMENT TERM                                           18340017
185000******************************************************************18350017
185100 2199-FORMAT-PAYMENT-TERM.                                        18360017
185200                                                                  18370017
185300     MOVE POAGMT-PAYT-TERM-ID      TO PV-EDIT-PAYT-TERM-ID.       18380017
185400     COPY POPD001.                                                18390017
185500     MOVE ASC-PAYT-TERM-ID-DESC  TO HL7-PAYT-TERM.                18400017
185600                                                                  18410017
185700******************************************************************18420017
185800*  CONTROLS INSTRUCTION PROCESSING                                18430017
185900******************************************************************18440017
186000 2200-PROCESS-INSTRUCTION.                                        18450017
186100                                                                  18460017
186200     MOVE HL14-HEADING-LINE-14     TO  DRS01-COMM-DATA.           18470017
186300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            18480017
186400     PERFORM 8000-LINK-TO-DRS.                                    18490017
186500     ADD +2                        TO  PV-LINE-CNT.               18500017
186600                                                                  18510017
186700     IF HL4-ORD-DTE = SPACE                                       18520017
186800         MOVE NOT-APPROVED-LINE    TO  DRS01-COMM-DATA            18530017
186900         MOVE PC-DOUBLE-SPACE      TO  DRS01-COMM-CTL             18540017
187000         PERFORM 8000-LINK-TO-DRS                                 18550017
187100         ADD +2                    TO  PV-LINE-CNT                18560017
187200     END-IF.                                                      18570017
187300                                                                  18580017
187400     IF PURCHS-STATUS-CDE = 'CA'                                  18590017
187500         MOVE CANCELLED-LINE       TO  DRS01-COMM-DATA            18600017
187600         MOVE PC-DOUBLE-SPACE      TO  DRS01-COMM-CTL             18610017
187700         PERFORM 8000-LINK-TO-DRS                                 18620017
187800         ADD +2                    TO PV-LINE-CNT                 18630017
187900     END-IF.                                                      18640017
188000                                                                  18650017
188100     IF PURCHS-REVISION-CT > 0                                    18660017
188200         MOVE REVISED-LINE         TO  DRS01-COMM-DATA            18670017
188300         MOVE PC-DOUBLE-SPACE      TO  DRS01-COMM-CTL             18680017
188400         PERFORM 8000-LINK-TO-DRS                                 18690017
188500         ADD +2                    TO PV-LINE-CNT                 18700017
188600     END-IF.                                                      18710017
188700                                                                  18720017
188800     MOVE 'DC'                     TO POINST-RECIP-CDE            18730017
188900                                      PV-RECIP-CDE-HOLD.          18740017
189000                                                                  18750017
189100     SET PS-NOT-EOF-INST-CSR       TO TRUE.                       18760017
189200     PERFORM 2210-OPEN-INST-CSR.                                  18770017
189300     PERFORM 2220-PROCESS-INST-CSR                                18780017
189400         UNTIL PS-EOF-INST-CSR.                                   18790017
189500     PERFORM 2230-CLOSE-INST-CSR.                                 18800017
189600                                                                  18810017
189700                                                                  18820017
189800******************************************************************18830017
189900*  OPENS INSTRUCTION CODE CSR                                     18840017
190000******************************************************************18850017
190100 2210-OPEN-INST-CSR.                                              18860017
190200                                                                  18870017
190300     EXEC SQL                                                     18880017
190400         OPEN INST-CSR                                            18890017
190500     END-EXEC.                                                    18900017
190600                                                                  18910017
190700     EVALUATE TRUE                                                18920017
190800         WHEN SQLCODE = +0                                        18930017
190900             CONTINUE                                             18940017
191000         WHEN SQLWARN NOT = SPACE                                 18950017
191100         WHEN SQLCODE NOT = +0                                    18960017
191200             MOVE '2210-OPEN-INST-CSR'                            18970017
191300                                   TO PV-ABEND-PARAGRAPH          18980017
191400             PERFORM 9999-WRITE-CICS-LOG-MSG                      18990017
191500     END-EVALUATE.                                                19000017
191600                                                                  19010017
191700                                                                  19020017
191800******************************************************************19030017
191900*  FETCHS INSTRUCTION CSR AND PRINTS                              19040017
192000******************************************************************19050017
192100 2220-PROCESS-INST-CSR.                                           19060017
192200                                                                  19070017
192300     EXEC SQL                                                     19080017
192400         FETCH INST-CSR                                           19090017
192500         INTO  :INSTCD-INSTR-DESC,                                19100017
192600               :INSTCD-INSTR-NBR,                                 19110017
192700               :INRCCD-RECIP-CDE,                                 19120017
192800               :INRCCD-RECIP-DESC                                 19130017
192900     END-EXEC.                                                    19140017
193000                                                                  19150017
193100     EVALUATE TRUE                                                19160017
193200         WHEN SQLCODE = +0                                        19170017
193300         WHEN SQLCODE = +100                                      19180017
193400             CONTINUE                                             19190017
193500         WHEN SQLWARN NOT = SPACE                                 19200017
193600         WHEN SQLCODE NOT = +0                                    19210017
193700             MOVE '2220-PROCESS-INST-CSR'                         19220017
193800                                   TO PV-ABEND-PARAGRAPH          19230017
193900             PERFORM 9999-WRITE-CICS-LOG-MSG                      19240017
194000     END-EVALUATE.                                                19250017
194100                                                                  19260017
194200     IF SQLCODE = +100                                            19270017
194300         SET PS-EOF-INST-CSR       TO TRUE                        19280017
194400     ELSE                                                         19290017
194500         IF PV-LINE-CNT > +58                                     19300017
194600             ADD +1                TO PV-PAGE-CNT                 19310017
194700             MOVE PV-PAGE-CNT      TO HL1-PG-NBR                  19320017
194800             MOVE +0               TO PV-LINE-CNT                 19330017
194900                                                                  19340017
195000             MOVE HL1-HEADING-LINE-1   TO  DRS01-COMM-DATA        19350017
195100             MOVE PC-TOP-OF-PAGE       TO  DRS01-COMM-CTL         19360017
195200             PERFORM 8000-LINK-TO-DRS                             19370017
195300                                                                  19380017
195400             MOVE HL2-HEADING-LINE-2   TO  DRS01-COMM-DATA        19390017
195500             MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL         19400017
195600             PERFORM 8000-LINK-TO-DRS                             19410017
195700                                                                  19420017
195800             MOVE HL14-HEADING-LINE-14 TO  DRS01-COMM-DATA        19430017
195900             MOVE PC-DOUBLE-SPACE      TO  DRS01-COMM-CTL         19440017
196000             PERFORM 8000-LINK-TO-DRS                             19450017
196100             MOVE +5               TO PV-LINE-CNT                 19460017
196200         END-IF                                                   19470017
196300                                                                  19480017
196400         IF INRCCD-RECIP-CDE = PV-RECIP-CDE-HOLD                  19490017
196500             CONTINUE                                             19500017
196600         ELSE                                                     19510017
196700             MOVE INRCCD-RECIP-DESC                               19520017
196800                                   TO INSTR-RECIP                 19530017
196900             MOVE INSTR-RECIP-LINE TO DRS01-COMM-DATA             19540017
197000             MOVE PC-SINGLE-SPACE  TO DRS01-COMM-CTL              19550017
197100             PERFORM 8000-LINK-TO-DRS                             19560017
197200             MOVE INRCCD-RECIP-CDE TO PV-RECIP-CDE-HOLD           19570017
197300             ADD +1                TO PV-LINE-CNT                 19580017
197400         END-IF                                                   19590017
197500                                                                  19600017
197600         MOVE INSTCD-INSTR-DESC    TO HL15-INSTR-DESC             19610017
197700         MOVE HL15-HEADING-LINE-15 TO DRS01-COMM-DATA             19620017
197800         MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              19630017
197900         PERFORM 8000-LINK-TO-DRS                                 19640017
198000         ADD +1                    TO PV-LINE-CNT                 19650017
198100     END-IF.                                                      19660017
198200                                                                  19670017
198300                                                                  19680017
198400******************************************************************19690017
198500*  CLOSES INSTRUCTION CODE CSR                                    19700017
198600******************************************************************19710017
198700 2230-CLOSE-INST-CSR.                                             19720017
198800                                                                  19730017
198900     EXEC SQL                                                     19740017
199000         CLOSE INST-CSR                                           19750017
199100     END-EXEC.                                                    19760017
199200                                                                  19770017
199300     EVALUATE TRUE                                                19780017
199400         WHEN SQLCODE = +0                                        19790017
199500             CONTINUE                                             19800017
199600         WHEN SQLWARN NOT = SPACE                                 19810017
199700         WHEN SQLCODE NOT = +0                                    19820017
199800             MOVE '2230-CLOSE-INST-CSR'                           19830017
199900                                   TO PV-ABEND-PARAGRAPH          19840017
200000             PERFORM 9999-WRITE-CICS-LOG-MSG                      19850017
200100     END-EVALUATE.                                                19860017
200200                                                                  19870017
200300                                                                  19880017
200400******************************************************************19890017
200500*  CONTROLS SKUS PROCESSING                                       19900017
200600******************************************************************19910017
200700 2300-PROCESS-SKUS.                                               19920017
200800                                                                  19930017
200900     MOVE 0                        TO PV-PO-LINE-NBR.             19940017
201000     SET PS-NOT-EOF-PO-LINE-CSR    TO TRUE.                       19950017
201100     PERFORM 2310-OPEN-PO-LINE-CSR.                               19960017
201200     PERFORM 2320-PROCESS-PO-LINE-CSR                             19970017
201300         UNTIL PS-EOF-PO-LINE-CSR.                                19980017
201400     PERFORM 2330-CLOSE-PO-LINE-CSR.                              19990017
201500                                                                  20000017
201600                                                                  20010017
201700******************************************************************20020017
201800*  OPENS PO LINE CSR                                              20030017
201900******************************************************************20040017
202000 2310-OPEN-PO-LINE-CSR.                                           20050017
202100                                                                  20060017
202200     IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ' OR 'RS' OR 'WK'  20070017
202300         EXEC SQL                                                 20080017
202400             OPEN PO-LINE-CSR                                     20090017
202500         END-EXEC                                                 20100017
202600     ELSE                                                         20110017
202700         EXEC SQL                                                 20120017
202800             OPEN APP-PO-LINE-CSR                                 20130017
202900         END-EXEC                                                 20140017
203000     END-IF.                                                      20150017
203100                                                                  20160017
203200     EVALUATE TRUE                                                20170017
203300         WHEN SQLCODE = +0                                        20180017
203400             CONTINUE                                             20190017
203500         WHEN SQLWARN NOT = SPACE                                 20200017
203600         WHEN SQLCODE NOT = +0                                    20210017
203700             MOVE '2310-OPEN-PO-LINE-CSR'                         20220017
203800                                   TO PV-ABEND-PARAGRAPH          20230017
203900             PERFORM 9999-WRITE-CICS-LOG-MSG                      20240017
204000     END-EVALUATE.                                                20250017
204100                                                                  20260017
204200                                                                  20270017
204300******************************************************************20280017
204400*  FETCHS PO LINE CSR AND PRINTS                                  20290017
204500******************************************************************20300017
204600 2320-PROCESS-PO-LINE-CSR.                                        20310017
204700                                                                  20320017
204800     IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ' OR 'RS' OR 'WK'  20330017
204900         EXEC SQL                                                 20340017
205000             FETCH PO-LINE-CSR                                    20350017
205100             INTO :PURITM-CL-NBR,                                 20360017
205200                  :PURITM-SKU-SEQ-NBR,                            20370017
205300                  :PURITM-VEND-STYL-NAME,                         20380017
205400                  :PURITM-SKU-DESC,                               20390017
205500                  :PURITM-UNT-QTY,                                20400017
205600                  :PURITM-UNT-COST-AMT,                           20410017
205700                  :PURITM-TOT-VAL-COST-AMT,                       20420017
205800                  :PURITM-COLOR-DESC,                             20430017
205900                  :PURITM-SIZE-DESC,                              20440017
206000                  :PURITM-AD-EVNT-DTE,                            20450017
206100                  :PURITM-GP-QTY,                                 20460017
206200                  :PURITM-GP-RTL-AMT,                             20470017
206300                  :PURITM-UNT-RTL-PR-AMT,                         20480017
206400                  :PURITM-TOT-VAL-RTL-AMT,                        20490017
206500                  :PURITM-PO-LNE-NBR,                             20500017
206600                  :PURITM-STATUS-CDE                              20510017
206700         END-EXEC                                                 20520017
206800     ELSE                                                         20530017
206900         EXEC SQL                                                 20540017
207000             FETCH APP-PO-LINE-CSR                                20550017
207100             INTO :PURITM-CL-NBR,                                 20560017
207200                  :PURITM-SKU-SEQ-NBR,                            20570017
207300                  :PURITM-VEND-STYL-NAME,                         20580017
207400                  :PURITM-SKU-DESC,                               20590017
207500                  :PURITM-UNT-QTY,                                20600017
207600                  :PURITM-UNT-COST-AMT,                           20610017
207700                  :PURITM-TOT-VAL-COST-AMT,                       20620017
207800                  :PURITM-COLOR-DESC,                             20630017
207900                  :PURITM-SIZE-DESC,                              20640017
208000                  :PURITM-AD-EVNT-DTE,                            20650017
208100                  :PURITM-GP-QTY,                                 20660017
208200                  :PURITM-GP-RTL-AMT,                             20670017
208300                  :PURITM-UNT-RTL-PR-AMT,                         20680017
208400                  :PURITM-TOT-VAL-RTL-AMT,                        20690017
208500                  :PURITM-PO-LNE-NBR,                             20700017
208600                  :PURITM-APP-PO-LNE-NBR,                         20710017
208700                  :PURITM-STATUS-CDE                              20720017
208800         END-EXEC                                                 20730017
208900     END-IF.                                                      20740017
209000                                                                  20750017
209100     EVALUATE TRUE                                                20760017
209200         WHEN SQLCODE = +0                                        20770017
209300         WHEN SQLCODE = +100                                      20780017
209400             CONTINUE                                             20790017
209500         WHEN SQLWARN NOT = SPACE                                 20800017
209600         WHEN SQLCODE NOT = +0                                    20810017
209700             MOVE '2320-PROCESS-PO-LINE-CSR'                      20820017
209800                                   TO PV-ABEND-PARAGRAPH          20830017
209900             PERFORM 9999-WRITE-CICS-LOG-MSG                      20840017
210000     END-EVALUATE.                                                20850017
210100                                                                  20860017
210200     IF SQLCODE = +100                                            20870017
210300         SET PS-EOF-PO-LINE-CSR    TO TRUE                        20880017
210400     ELSE                                                         20890017
210500         MOVE +0                   TO PV-ALLOC-CNT                20900017
210600         IF PURITM-STATUS-CDE = 'CA'                              20910017
210700             COMPUTE PV-TEMP-LINE-CNT = PV-LINE-CNT + 5           20920017
210800         ELSE                                                     20930017
210900             COMPUTE PV-TEMP-LINE-CNT = PV-LINE-CNT + 3           20940017
211000         END-IF                                                   20950017
211100                                                                  20960017
211200         IF PV-TEMP-LINE-CNT > +60                                20970017
211300             ADD +1                TO PV-PAGE-CNT                 20980017
211400             MOVE PV-PAGE-CNT      TO HL1-PG-NBR                  20990017
211500             MOVE +0               TO PV-LINE-CNT                 21000017
211600                                                                  21010017
211700             MOVE HL1-HEADING-LINE-1                              21020017
211800                                   TO DRS01-COMM-DATA             21030017
211900             MOVE PC-TOP-OF-PAGE   TO DRS01-COMM-CTL              21040017
212000             PERFORM 8000-LINK-TO-DRS                             21050017
212100                                                                  21060017
212200             MOVE HL2-HEADING-LINE-2                              21070017
212300                                   TO DRS01-COMM-DATA             21080017
212400             MOVE PC-SINGLE-SPACE  TO DRS01-COMM-CTL              21090017
212500             PERFORM 8000-LINK-TO-DRS                             21100017
212600             MOVE +2               TO PV-LINE-CNT                 21110017
212700         END-IF                                                   21120017
212800                                                                  21130017
212900         IF PURCHS-STATUS-CDE =                                   21140017
213000                             'FE' OR 'PA' OR 'RJ' OR 'RS' OR 'WK' 21150017
213100             ADD +1                TO PV-PO-LINE-NBR              21160017
213200             MOVE PV-PO-LINE-NBR   TO SL1-SKU-NBR                 21170017
213300         ELSE                                                     21180017
213400             MOVE PURITM-APP-PO-LNE-NBR                           21190017
213500                                   TO SL1-SKU-NBR                 21200017
213600         END-IF                                                   21210017
213700                                                                  21220017
213800         MOVE PURCHS-DEPT-NBR      TO SL1-DEPT                    21230017
213900         MOVE PURITM-CL-NBR        TO SL1-CLASS                   21240017
214000         MOVE PURITM-SKU-SEQ-NBR   TO SL1-SKU                     21250017
214100         MOVE PURITM-VEND-STYL-NAME                               21260017
214200                                   TO SL1-STYLE                   21270017
214300         MOVE PURITM-SKU-DESC      TO SL1-DESC                    21280017
214400         MOVE PURITM-UNT-QTY       TO SL1-QTY                     21290017
214500         MOVE PURITM-UNT-COST-AMT  TO SL1-COST                    21300017
214600         MOVE PURITM-TOT-VAL-COST-AMT                             21310017
214700                                   TO SL1-TOT-COST                21320017
214800         MOVE PURITM-COLOR-DESC    TO SL2-COLOR                   21330017
214900         MOVE PURITM-SIZE-DESC     TO SL2-SIZE                    21340017
215000         IF PURITM-AD-EVNT-DTE = PC-INIT-DATE                     21350017
215100             MOVE SPACE            TO SL2-AD-DATE                 21360017
215200         ELSE                                                     21370017
215300             MOVE PURITM-AD-EVNT-DTE                              21380017
215400                                   TO PV-DATE-BREAK               21390017
215500             MOVE PV-DB-MM         TO PV-DBS-MM                   21400017
215600             MOVE PV-DB-DD         TO PV-DBS-DD                   21410017
215700             MOVE PV-DB-YY         TO PV-DBS-YY                   21420017
215800             MOVE PV-DATE-BREAK-SLASH                             21430017
215900                                   TO SL2-AD-DATE                 21440017
216000         END-IF                                                   21450017
216100*        IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'          21460017
216200*            MOVE SPACE            TO SL2-GRP-PRICE               21470017
216300*        ELSE                                                     21480017
216400             IF PURITM-GP-QTY > +1                                21490017
216500                 MOVE PURITM-GP-QTY                               21500017
216600                                   TO PV-GP-QTY                   21510017
216700                 MOVE PURITM-GP-RTL-AMT                           21520017
216800                                   TO PV-GP-AMT                   21530017
216900                 MOVE PV-GRP-PRICE TO SL2-GRP-PRICE               21540017
217000             ELSE                                                 21550017
217100                 MOVE SPACE        TO SL2-GRP-PRICE               21560017
217200             END-IF                                               21570017
217300*        END-IF                                                   21580017
217400*        IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'          21590017
217500*            MOVE SPACE            TO SL2-RTL-COST                21600017
217600*            MOVE SPACE            TO SL2-TOT-RTL-COST            21610017
217700*        ELSE                                                     21620017
217800             MOVE PURITM-UNT-RTL-PR-AMT                           21630017
217900                                   TO PV-DOL-FORM-9               21640017
218000             MOVE PV-DOL-FORM-9    TO SL2-RTL-COST                21650017
218100             MOVE PURITM-TOT-VAL-RTL-AMT                          21660017
218200                                   TO PV-DOL-FORM-11              21670017
218300             MOVE PV-DOL-FORM-11   TO SL2-TOT-RTL-COST            21680017
218400*        END-IF                                                   21690017
218500                                                                  21700017
218600         MOVE SKU-LINE-1           TO  DRS01-COMM-DATA            21710017
218700         MOVE PC-DOUBLE-SPACE      TO  DRS01-COMM-CTL             21720017
218800         PERFORM 8000-LINK-TO-DRS                                 21730017
218900                                                                  21740017
219000         MOVE SKU-LINE-2           TO  DRS01-COMM-DATA            21750017
219100         MOVE PC-SINGLE-SPACE      TO  DRS01-COMM-CTL             21760017
219200         PERFORM 8000-LINK-TO-DRS                                 21770017
219300                                                                  21780017
219400         ADD +3                    TO PV-LINE-CNT                 21790017
219500                                                                  21800017
219600         IF PURITM-STATUS-CDE = 'CA'                              21810017
219700             MOVE LINE-CANCEL-LINE TO  DRS01-COMM-DATA            21820017
219800             MOVE PC-DOUBLE-SPACE  TO  DRS01-COMM-CTL             21830017
219900             PERFORM 8000-LINK-TO-DRS                             21840017
220000                                                                  21850017
220100             ADD +2                TO PV-LINE-CNT                 21860017
220200         END-IF                                                   21870017
220300     END-IF.                                                      21880017
220400                                                                  21890017
220500******************************************************************21900017
220600*  CLOSES PO LINE CSR                                             21910017
220700******************************************************************21920017
220800 2330-CLOSE-PO-LINE-CSR.                                          21930017
220900                                                                  21940017
221000     IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ' OR 'RS' OR 'WK'  21950017
221100         EXEC SQL                                                 21960017
221200             CLOSE PO-LINE-CSR                                    21970017
221300         END-EXEC                                                 21980017
221400     ELSE                                                         21990017
221500         EXEC SQL                                                 22000017
221600             CLOSE APP-PO-LINE-CSR                                22010017
221700         END-EXEC                                                 22020017
221800     END-IF.                                                      22030017
221900                                                                  22040017
222000     EVALUATE TRUE                                                22050017
222100         WHEN SQLCODE = +0                                        22060017
222200             CONTINUE                                             22070017
222300         WHEN SQLWARN NOT = SPACE                                 22080017
222400         WHEN SQLCODE NOT = +0                                    22090017
222500             MOVE '2330-CLOSE-PO-LINE-CSR'                        22100017
222600                                   TO PV-ABEND-PARAGRAPH          22110017
222700             PERFORM 9999-WRITE-CICS-LOG-MSG                      22120017
222800     END-EVALUATE.                                                22130017
222900*                                                                 22140017
223000******************************************************************22150017
223100* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     22160017
223200******************************************************************22170017
223300 8000-LINK-TO-DRS.                                                22180017
223400                                                                  22190017
223500     EXEC CICS                                                    22200017
223600         LINK                                                     22210017
223700             PROGRAM   ('DRS1INTC')                               22220017
223800             COMMAREA  (DRS01-COMMAREA)                           22230017
223900     END-EXEC.                                                    22240017
224000                                                                  22250017
224100     EVALUATE TRUE                                                22260017
224200         WHEN DRS01-DRRB-RC = ZERO                                22270017
224300             CONTINUE                                             22280017
224400         WHEN OTHER                                               22290017
224500             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        22300017
224600             SET DP013-OTHER-ABEND      TO TRUE                   22310017
224700             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       22320017
224800             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        22330017
224900             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    22340017
225000             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC1        22350017
225100             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      22360017
225200             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       22370017
225300             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      22380017
225400             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      22390017
225500                 TO DP013-MESSAGE-TEXT (1)                        22400017
225600             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      22410017
225700                 TO DP013-MESSAGE-TEXT (2)                        22420017
225800             PERFORM 9999-WRITE-CICS-LOG-MSG                      22430017
225900     END-EVALUATE.                                                22440017
226000*                                                                 22450017
226100 8100-FORMAT-TIME.                                                22460017
226200     EXEC CICS                                                    22470017
226300         ASKTIME ABSTIME (ST-ABSTIME)                             22480017
226400     END-EXEC.                                                    22490017
226500                                                                  22500017
226600     EXEC CICS                                                    22510017
226700         FORMATTIME ABSTIME  (ST-ABSTIME)                         22520017
226800                    MMDDYY   (SD-MMDDYY-FORMAT)                   22530017
226900                    DATESEP                                       22540017
227000                    TIME     (ST-HHMMSS-FORMAT)                   22550017
227100                    TIMESEP                                       22560017
227200     END-EXEC.                                                    22570017
227300                                                                  22580017
227400     EXEC CICS                                                    22590017
227500         FORMATTIME ABSTIME  (ST-ABSTIME)                         22600017
227600                       YEAR  (SD-YYYY-FORMAT)                     22610017
227700     END-EXEC.                                                    22620017
227800                                                                  22630017
227900     MOVE SD-YYYY-FORMAT  TO  PV-CURRENT-CENTURY-YEAR.            22640017
228000     MOVE SD-SYSTEM-MONTH TO  PV-CURRENT-MONTH.                   22650017
228100     MOVE SD-SYSTEM-DAY   TO  PV-CURRENT-DAY.                     22660017
228200                                                                  22670017
228300                                                                  22680017
228400*----------------------------------------------------------------*22690017
228500*    NAME REFORMATOR MODULE                                      *22700017
228600*----------------------------------------------------------------*22710017
228700                                                                  22720017
228800 9999-WRITE-CICS-LOG-MSG.                                         22730017
228900     IF PS-DRS-NOT-INITIALIZED                                    22740017
229000         MOVE 'A'                TO DRS02-DRIB-CLASS              22750017
229100         MOVE 'N'                TO DRS02-DRIB-HOLD               22760017
229200         MOVE CA-PRTR-ID         TO DRS02-DRIB-DEST               22770017
229300         MOVE PC-INIT            TO DRS01-DRRB-FUNC               22780017
229400         MOVE DRS02-DRIB-HEADER  TO DRS01-COMM-DRIB-HDR           22790017
229500         MOVE DRS02-DRIB-ATTRIB  TO DRS01-COMM-DRIB-AT1           22800017
229600         PERFORM 8000-LINK-TO-DRS                                 22810017
229700     END-IF.                                                      22820017
229800     MOVE PC-CURRENT-PGM-NME       TO DP013-PROGRAM.              22830017
229900     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             22840017
230000                                                                  22850017
230100     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         22860017
230200                                                                  22870017
230300     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           22880017
230400     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             22890017
230500     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            22900017
230600     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            22910017
230700     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          22920017
230800                                                                  22930017
230900     MOVE PC-CURRENT-PGM-NME         TO  HL1-PGM-NME.             22940017
231000     MOVE 1                          TO  HL1-RPT-NBR.             22950017
231100     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         22960017
231200     IF PS-TOP-OF-PAGE-SET                                        22970017
231300         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           22980017
231400     ELSE                                                         22990017
231500         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           23000017
231600     END-IF.                                                      23010017
231700     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          23020017
231800     PERFORM 8000-LINK-TO-DRS.                                    23030017
231900                                                                  23040017
232000     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         23050017
232100     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          23060017
232200     PERFORM 8000-LINK-TO-DRS.                                    23070017
232300                                                                  23080017
232400     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         23090017
232500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23100017
232600     PERFORM 8000-LINK-TO-DRS.                                    23110017
232700                                                                  23120017
232800     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         23130017
232900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23140017
233000     PERFORM 8000-LINK-TO-DRS.                                    23150017
233100                                                                  23160017
233200     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         23170017
233300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23180017
233400     PERFORM 8000-LINK-TO-DRS.                                    23190017
233500                                                                  23200017
233600     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         23210017
233700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23220017
233800     PERFORM 8000-LINK-TO-DRS.                                    23230017
233900                                                                  23240017
234000     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         23250017
234100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23260017
234200     PERFORM 8000-LINK-TO-DRS.                                    23270017
234300                                                                  23280017
234400     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         23290017
234500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23300017
234600     PERFORM 8000-LINK-TO-DRS.                                    23310017
234700                                                                  23320017
234800     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         23330017
234900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23340017
235000     PERFORM 8000-LINK-TO-DRS.                                    23350017
235100                                                                  23360017
235200     MOVE HL10-HEADING-LINE-10       TO  DRS01-COMM-DATA.         23370017
235300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23380017
235400     PERFORM 8000-LINK-TO-DRS.                                    23390017
235500                                                                  23400017
235600     MOVE HL11-HEADING-LINE-11       TO  DRS01-COMM-DATA.         23410017
235700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23420017
235800     PERFORM 8000-LINK-TO-DRS.                                    23430017
235900                                                                  23440017
236000     MOVE HL12-HEADING-LINE-12       TO  DRS01-COMM-DATA.         23450017
236100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23460017
236200     PERFORM 8000-LINK-TO-DRS.                                    23470017
236300                                                                  23480017
236400     MOVE CA-PRTR-ID                 TO  HL13-PRTR-ID.            23490017
236500     MOVE HL13-HEADING-LINE-13       TO  DRS01-COMM-DATA.         23500017
236600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          23510017
236700     PERFORM 8000-LINK-TO-DRS.                                    23520017
236800                                                                  23530017
236900     MOVE HL14-HEADING-LINE-14       TO  DRS01-COMM-DATA.         23540017
237000     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          23550017
237100     PERFORM 8000-LINK-TO-DRS.                                    23560017
237200                                                                  23570017
237300     MOVE PC-ABEND-MESSAGE         TO  DRS01-COMM-DATA.           23580017
237400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23590017
237500     PERFORM 8000-LINK-TO-DRS.                                    23600017
237600                                                                  23610017
237700     MOVE DP013-PARAGRAPH          TO  DRS01-COMM-DATA.           23620017
237800     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23630017
237900     PERFORM 8000-LINK-TO-DRS.                                    23640017
238000     MOVE DP013-MESSAGE-TEXT (1)   TO  DRS01-COMM-DATA.           23650017
238100     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23660017
238200     PERFORM 8000-LINK-TO-DRS.                                    23670017
238300     MOVE DP013-MESSAGE-TEXT (2)   TO  DRS01-COMM-DATA.           23680017
238400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23690017
238500     PERFORM 8000-LINK-TO-DRS.                                    23700017
238600     MOVE DP013-MESSAGE-TEXT (3)   TO  DRS01-COMM-DATA.           23710017
238700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23720017
238800     PERFORM 8000-LINK-TO-DRS.                                    23730017
238900     MOVE DP013-DB2-TABLE-NAME (1) TO  DRS01-COMM-DATA.           23740017
239000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23750017
239100     PERFORM 8000-LINK-TO-DRS.                                    23760017
239200     MOVE DP013-DB2-TABLE-NAME (2) TO  DRS01-COMM-DATA.           23770017
239300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23780017
239400     PERFORM 8000-LINK-TO-DRS.                                    23790017
239500     MOVE DP013-DB2-TABLE-NAME (3) TO  DRS01-COMM-DATA.           23800017
239600     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            23810017
239700     PERFORM 8000-LINK-TO-DRS.                                    23820017
239800     MOVE PC-TERM TO DRS01-DRRB-FUNC.                             23830017
239900     PERFORM 8000-LINK-TO-DRS.                                    23840017
240000                                                                  23850017
240100     INITIALIZE DP013-SRC-TASK-NUMBER                             23860017
240200                DP013-STACK.                                      23870017
240300     SET DP013-LINK-RETURN         TO TRUE.                       23880017
240400                                                                  23890017
240500     EXEC CICS                                                    23900017
240600         XCTL                                                     23910017
240700             PROGRAM   (DP013-NAME)                               23920017
240800             COMMAREA  (DP013-PARAMETERS)                         23930017
240900             LENGTH    (DP013-LENGTH)                             23940017
241000     END-EXEC.                                                    23950017
241100     EXEC CICS                                                    23960017
241200         RETURN                                                   23970017
241300     END-EXEC.                                                    23980017
241400     COPY DPPD024.                                                23990017
