000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    SUKUT986.                                         00050001
000600 AUTHOR.        TOM BOYD                                          00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   JULY 2002.                                        00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200* THIS PROGRAM WILL CREATE A FILE OF RECORDS WHICH WILL BE USED   00120003
001300* TO PRODUCE A UCC-128 ARCHIVE REPORT.  ALL RECORDS WITH MATCHING 00130019
001310* PO NUMBERS ON THE REQUEST FILE WILL BE WRITTEN TO AN OUTPUT FILE00131019
001320* WHICH WILL BE USED BY ANOTHER PROGRAM AND EVENTUALLY PRODUCE A  00132039
001330* UCC-128 ARCHIEVE REPORT.                                        00133019
001350******************************************************************00135001
001360                                                                  00136001
001370******************************************************************00137001
001380 ENVIRONMENT DIVISION.                                            00138001
001390******************************************************************00139001
001400                                                                  00140001
001500 CONFIGURATION SECTION.                                           00150001
001600                                                                  00160001
001700 SOURCE-COMPUTER.        IBM-3090.                                00170001
001800 OBJECT-COMPUTER.        IBM-3090.                                00180001
001900                                                                  00190001
002000 INPUT-OUTPUT SECTION.                                            00200001
002100                                                                  00210001
002200 FILE-CONTROL.                                                    00220001
002300                                                                  00230001
002400     SELECT ARC-INPUT-FILE                                        00240001
002500         ASSIGN TO INP01.                                         00250040
002501                                                                  00250101
002510     SELECT REQ-INPUT-FILE                                        00251001
002520         ASSIGN TO INP02.                                         00252040
002600                                                                  00260001
002700     SELECT OUTPUT-FILE                                           00270001
002800         ASSIGN TO OUT1.                                          00280004
002900                                                                  00290001
003000******************************************************************00300001
003100 DATA DIVISION.                                                   00310001
003200******************************************************************00320001
003300                                                                  00330001
003400 FILE SECTION.                                                    00340001
003500                                                                  00350001
003600 FD  ARC-INPUT-FILE                                               00360001
003700     RECORDING MODE IS F                                          00370001
003800     LABEL RECORDS ARE STANDARD                                   00380001
004000     BLOCK CONTAINS 0 RECORDS                                     00400001
004100     DATA RECORD IS ARC-INPUT-RECORD.                             00410001
004200                                                                  00420001
004300 01  ARC-INPUT-RECORD              PIC  X(118).                   00430026
004400                                                                  00440013
004410 FD  REQ-INPUT-FILE                                               00441001
004420     RECORDING MODE IS F                                          00442001
004430     LABEL RECORDS ARE STANDARD                                   00443001
004450     BLOCK CONTAINS 0 RECORDS                                     00445001
004460     DATA RECORD IS REQ-INPUT-RECORD.                             00446001
004470                                                                  00447001
004480 01  REQ-INPUT-RECORD              PIC  X(69).                    00448040
004490                                                                  00449013
004500 FD  OUTPUT-FILE                                                  00450001
004510     RECORDING MODE IS F                                          00451001
004520     LABEL RECORDS ARE STANDARD                                   00452001
004540     BLOCK CONTAINS 0 RECORDS                                     00454001
004541     DATA RECORD IS OUTPUT-RECORD.                                00454101
004542                                                                  00454201
004543 01  OUTPUT-RECORD             PIC  X(118).                       00454327
004544                                                                  00454401
004545******************************************************************00454501
004546 WORKING-STORAGE SECTION.                                         00454601
004547******************************************************************00454701
004548 01  PS-PROGRAM-SWITCHES.                                         00454801
004549     05  PS-EOF-REQ-SW                PIC X(01)  VALUE 'N'.       00454901
004550         88  PS-EOF-REQ                          VALUE 'Y'.       00455001
004560         88  PS-NOT-EOF-REQ                      VALUE 'N'.       00456001
004561     05  PS-EOF-ARC-SW                PIC X(01)  VALUE 'N'.       00456101
004562         88  PS-EOF-ARC                          VALUE 'Y'.       00456201
004563         88  PS-NOT-EOF-ARC                      VALUE 'N'.       00456301
004564     05  PS-NEXT-REQ-PO-SW            PIC X(01)  VALUE 'N'.       00456404
004565         88  PS-NEXT-REQ-PO                      VALUE 'Y'.       00456504
004566         88  PS-SAME-REQ-PO                      VALUE 'N'.       00456604
004900                                                                  00490001
005000 01  PC-PROGRAM-CONSTANTS.                                        00500001
005100     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT986'.00510003
005271                                                                  00527101
005275 01  PV-PROGRAM-VARIABLES.                                        00527514
005276     05  PV-RECORDS-READ-REQ          PIC 9(09)     VALUE ZERO.   00527614
005277     05  PV-RECORDS-READ-ARC          PIC 9(09)     VALUE ZERO.   00527714
005278     05  PV-RECORDS-WRITTEN           PIC 9(09)     VALUE ZERO.   00527814
005279     05  PV-REQUESTED-PO              PIC 9(09)     VALUE ZERO.   00527914
005280     05  PV-CURRENT-PO                PIC 9(09)     VALUE ZERO.   00528014
005345/                                                                 00534519
005360******************************************************************00536001
005370*  COPYBOOK ARCHIVE RECORD LAYOUT                                 00537001
005380******************************************************************00538001
005390     COPY SURD020.                                                00539039
005400/                                                                 00540019
005730******************************************************************00573001
005740*  REQUEST FILE LAYOUT.                                           00574001
005750******************************************************************00575001
005760     COPY SURD039.                                                00576039
005770/                                                                 00577019
007699******************************************************************00769901
007700 PROCEDURE DIVISION.                                              00770001
007800******************************************************************00780001
007900                                                                  00790001
008000 0000-PROGRAM-MAINLINE.                                           00800001
008100                                                                  00810001
008200     DISPLAY 'START OF PROGRAM SUKUT986'.                         00820001
008300     DISPLAY ' '.                                                 00830001
008400                                                                  00840001
008500     OPEN INPUT  ARC-INPUT-FILE                                   00850001
008510          INPUT  REQ-INPUT-FILE                                   00851001
008600          OUTPUT OUTPUT-FILE                                      00860001
008700                                                                  00870001
008800     PERFORM 1000-READ-REQ-INPUT-FILE.                            00880001
008801                                                                  00880139
008802     IF PS-NOT-EOF-REQ                                            00880239
008810        PERFORM 1100-READ-ARC-INPUT-FILE                          00881039
008900     END-IF                                                       00890039
009000                                                                  00900039
009200     PERFORM 2000-PROCESS-REQUESTS                                00920004
009300        UNTIL PS-EOF-REQ.                                         00930004
009500                                                                  00950001
009600     CLOSE REQ-INPUT-FILE                                         00960001
009610           ARC-INPUT-FILE                                         00961001
009700           OUTPUT-FILE                                            00970001
009701                                                                  00970118
009710     DISPLAY '**** PROGRAM SUMMARY ****'.                         00971018
009800     DISPLAY 'REQUEST RECORDS READ: '   PV-RECORDS-READ-REQ.      00980018
009801     DISPLAY 'ARCHIEVE RECORDS READ: '  PV-RECORDS-READ-ARC.      00980118
009810     DISPLAY 'RECORDS WRITTEN: '        PV-RECORDS-WRITTEN.       00981018
009820     DISPLAY '**** END OF PROGRAM ****'.                          00982018
009830                                                                  00983018
009900     GOBACK.                                                      00990039
010000/                                                                 01000001
010100******************************************************************01010001
010200* READS RECORD FROM THE INPUT FILE                                01020001
010300******************************************************************01030001
010400 1000-READ-REQ-INPUT-FILE.                                        01040001
010500                                                                  01050001
010700     INITIALIZE SU039-REQUEST-RECORD                              01070001
010800                                                                  01080001
010900     READ REQ-INPUT-FILE                                          01090001
011000          INTO SU039-REQUEST-RECORD                               01100001
011100            AT END                                                01110001
011200               SET PS-EOF-REQ       TO TRUE                       01120001
011300*              DISPLAY '*** EOF REQUEST FILE ***'                 01130038
011400            NOT AT END                                            01140001
011500               SET PS-NOT-EOF-REQ   TO TRUE                       01150001
011600               ADD +1 TO PV-RECORDS-READ-REQ                      01160001
011610               MOVE SU039-PO-NBR    TO PV-REQUESTED-PO            01161005
011630                                                                  01163028
011700     END-READ.                                                    01170001
011800/                                                                 01180001
011810******************************************************************01181001
011820* READS RECORD FROM THE INPUT FILE                                01182001
011830******************************************************************01183001
011840 1100-READ-ARC-INPUT-FILE.                                        01184001
011861                                                                  01186112
011870     INITIALIZE SU020-VEND-ARCHIVE-RECORD                         01187001
011880                                                                  01188001
011890     READ ARC-INPUT-FILE                                          01189001
011891          INTO SU020-VEND-ARCHIVE-RECORD                          01189101
011892            AT END                                                01189201
011893               SET PS-EOF-ARC       TO TRUE                       01189301
011894                                                                  01189401
011895            NOT AT END                                            01189501
011896               SET PS-NOT-EOF-ARC   TO TRUE                       01189601
011897               ADD +1 TO PV-RECORDS-READ-ARC                      01189701
011898               MOVE SU020-PO-NBR    TO PV-CURRENT-PO              01189805
011899     END-READ.                                                    01189901
011900/                                                                 01190001
011910******************************************************************01191001
012000* WILL PROCESS THROUGH THE ARCHIEVE FILE LOOKING FOR MATCHING PO *01200019
012100******************************************************************01210001
012200 2000-PROCESS-REQUESTS.                                           01220004
012221     IF (PV-REQUESTED-PO > PV-CURRENT-PO)                         01222105
012222        OR (PV-REQUESTED-PO = PV-CURRENT-PO)                      01222205
012223           PERFORM 3000-PROCESS-THROUGH-ARC-PO                    01222305
012231     END-IF.                                                      01223104
012232                                                                  01223206
012300     IF NOT PS-EOF-REQ                                            01230006
012400        PERFORM 1000-READ-REQ-INPUT-FILE                          01240011
012500     END-IF.                                                      01250006
014200/                                                                 01420001
014300******************************************************************01430001
014400* WILL CONTINUE TO PROCESS THROUGH ARCHIVE FILE UNTIL THE        *01440043
014410* REQUESTED BY PO IS LESS THAN THE CURRENT LOCATION IN THE       *01441019
014420* ARCHIVE FILE                                                   *01442043
014500******************************************************************01450001
014600 3000-PROCESS-THROUGH-ARC-PO.                                     01460005
014620     PERFORM 3500-GET-NEXT-CURRENT-PO                             01462005
014700       UNTIL PV-REQUESTED-PO < PV-CURRENT-PO                      01470037
014710          OR PS-EOF-ARC.                                          01471037
014900/                                                                 01490001
018939******************************************************************01893901
018940* IF THE REQUESTED BY AND CURRENT PO MATCH THE RECORD IS WRITTEN *01894019
018941* THE NEXT RECORD FROM THE ARCHIEVE FILE IS THEN READ.           *01894119
018942******************************************************************01894201
018943 3500-GET-NEXT-CURRENT-PO.                                        01894305
018946     IF PV-REQUESTED-PO EQUAL PV-CURRENT-PO                       01894635
018959        PERFORM 9000-WRITE-OUTPUT-RECORD                          01895917
018965     END-IF.                                                      01896515
018966                                                                  01896615
018967     IF NOT PS-EOF-ARC                                            01896715
018968        PERFORM 1100-READ-ARC-INPUT-FILE                          01896815
018969     END-IF.                                                      01896915
018970                                                                  01897015
018972/                                                                 01897205
019006******************************************************************01900614
019007* WRITES THE RECEIVER-EXT-RECORD TO THE OUTPUT FILE              *01900714
019008******************************************************************01900814
019009 9000-WRITE-OUTPUT-RECORD.                                        01900914
019010     IF SU020-TSHPUNT OR SU020-TSHUUPC                            01901043
019012         WRITE OUTPUT-RECORD                                      01901243
019013            FROM SU020-VEND-ARCHIVE-RECORD                        01901344
019014            ADD  1  TO  PV-RECORDS-WRITTEN                        01901444
019015     END-IF.                                                      01901543
019016                                                                  01901644
019017     INITIALIZE SU020-VEND-ARCHIVE-RECORD.                        01901714
019020                                                                  01902014
019100/                                                                 01910014
