000100 IDENTIFICATION DIVISION.                                         00030001
000200 PROGRAM-ID.             PCKUT064.                                00040001
000300 AUTHOR.                 DEANNA BRANTNER.                         00050001
000400 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060001
000500 DATE-WRITTEN            APRIL, 2006.                             00070001
000600 DATE-COMPILED.                                                   00080001
000700******************************************************************00090001
000800* THIS PROGRAM WILL BE USED TO RETRIEVE INTR-UPC-ID FROM XLT_SKU. 00100009
000900* CALLING PROGRAMS WILL PASS PO AND LINE.  IF THERE IS A CENTRAL  00110015
000900* STOCK ORDER, THEN TCEPLIT WILL BE USED TO GET ITM_NBR ELSE IT   00111015
000900* WILL COME FROM TPURITM AND THEN USE XLT_SKU TO GET INTR_UPC_ID. 00112015
001000******************************************************************00120001
001100 ENVIRONMENT DIVISION.                                            00130001
001200 DATA DIVISION.                                                   00140001
001300 WORKING-STORAGE SECTION.                                         00150001
003400*----------------------------------------------------------------*00360001
003500* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00370001
003600*----------------------------------------------------------------*00380001
003700     COPY PCWS064.                                                00390001
003800                                                                  00400001
005000*----------------------------------------------------------------*00520001
005100*  PROGRAM SWITCHES                                              *00530001
005200*----------------------------------------------------------------*00540001
005300 01  PS-PROGRAM-SWITCHES.                                         00550001
005400     05  PS-ITM-NBR-FOUND-SW             PIC  X(01)  VALUE 'N'.   00560001
005500         88  PS-ITM-NBR-FOUND                        VALUE 'Y'.   00570001
005600         88  PS-ITM-NBR-NOT-FOUND                    VALUE 'N'.   00580001
005700     05  PS-INTR-UPC-ID-FOUND            PIC  X(01)  VALUE 'N'.   00590001
005800         88  PS-INTR-UPC-ID-FOUND                    VALUE 'Y'.   00600001
005900         88  PS-INTR-UPC-ID-NOT-FOUND                VALUE 'N'.   00610001
006300     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   00650001
006400         88  PS-ERROR                                VALUE 'Y'.   00660001
006500         88  PS-NO-ERROR                             VALUE 'N'.   00670001
                                                                        00680001
007900*----------------------------------------------------------------*00810001
008000*  PROGRAM VARIABLES                                             *00820001
008100*----------------------------------------------------------------*00830001
008200 01  PV-PROGRAM-VARIABLES.                                        00840001
008600     05  PV-DISPLAY-PO                   PIC  9(09).              00880001
008700     05  PV-DISPLAY-RCVR                 PIC  9(04).              00890001
008800     05  PV-DISPLAY-LINE                 PIC  9(04).              00900001
008900     05  PV-DISPLAY-ITM-NBR              PIC  9(15).              00910001
009000     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 00920001
009200     05  PV-SQL-RETURN-CD                PIC  999-.               00940001
011000     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         01120001
011100                                                     VALUE ZERO.  01130001
011200     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  01140001
011300                                                     COMP SYNC.   01150001
012300 01  PV-TRACE.                                                    01250001
012400     05  FILLER                          PIC X(03) VALUE ' T='.   01260001
012500     05  PV-EIBTASKN                     PIC Z(06)9.              01270001
012600     05  PV-PARA                         PIC X(70).               01280001
012700                                                                  01290001
009100******************************************************************01291009
009200* DCLGEN FOR XLT_SKU                                              01292009
003600*----------------------------------------------------------------*01293009
013000     EXEC SQL                                                     01293110
009400         INCLUDE XLT00003                                         01294010
013200     END-EXEC.                                                    01294110
003800                                                                  01295009
003600*----------------------------------------------------------------*01296015
012900*    TPURITM TABLE                                                01310009
003600*----------------------------------------------------------------*01311015
013000     EXEC SQL                                                     01320001
013100          INCLUDE TPURITM                                         01330009
013200     END-EXEC.                                                    01340001
013300                                                                  01350001
003600*----------------------------------------------------------------*01360016
012900*    TCEPLIT TABLE                                                01370016
003600*----------------------------------------------------------------*01380016
013000     EXEC SQL                                                     01390016
013100          INCLUDE TCEPLIT                                         01400016
013200     END-EXEC.                                                    01410016
013300                                                                  01420016
021200*----------------------------------------------------------------*02140001
021300*  COMMUNICATIONS AREA FOR DB2                                   *02150001
021400*----------------------------------------------------------------*02160001
021500     EXEC SQL                                                     02170001
021600         INCLUDE SQLCA                                            02180001
021700     END-EXEC.                                                    02190001
021800                                                                  02200001
021400*----------------------------------------------------------------*02210015
025700 LINKAGE SECTION.                                                 02590001
025800 01  LINK-PARMS                         PIC X(400).               02600005
025900*******************************************************           02610001
026000 PROCEDURE DIVISION USING LINK-PARMS.                             02620001
026100*******************************************************           02630001
026200 0000-PROGRAM-MAINLINE.                                           02640001
026300                                                                  02650001
026400     SET PS-ITM-NBR-NOT-FOUND                                     02660001
026500         PS-INTR-UPC-ID-NOT-FOUND TO TRUE.                        02670001
027200     INITIALIZE                        PC064-COMMAREA-REC         02740002
028500                                       PV-DISPLAY-PO              02870001
028600                                       PV-DISPLAY-RCVR            02880001
028700                                       PV-DISPLAY-LINE            02890001
028800                                       PV-DISPLAY-ITM-NBR         02900001
029200                                       PV-COMMAREA-LENGTH         02940001
029300                                       PV-CICS-RESP               02950001
030100     MOVE LINK-PARMS               TO  PC064-COMMAREA-REC.        03030002
030200                                                                  03040001
030200     IF PC064-TRN-TYP-CDE = 'CS'                                  03041015
030300         MOVE  PC064-ORD-NBR           TO  CEPLIT-CNSTK-REQ-PL-NBR03041115
030300         MOVE  PC064-ORD-LNE-NBR       TO  CEPLIT-PL-LNE-NBR      03041215
030700         PERFORM 1000-GET-TCEPLIT                                 03042015
030200     ELSE                                                         03043015
030300         MOVE  PC064-ORD-NBR           TO  PURITM-PO-NBR          03050015
030300         MOVE  PC064-ORD-LNE-NBR       TO  PURITM-APP-PO-LNE-NBR  03060020
030700         PERFORM 2000-GET-PURITM                                  03090015
030200     END-IF.                                                      03091015
030800                                                                  03100001
030900     IF PS-NO-ERROR                                               03110001
031000         PERFORM 3000-GET-INTR-UPC                                03120015
031300     END-IF                                                       03150001
040000                                                                  04020001
030900     IF PS-NO-ERROR                                               04021002
031000         MOVE XLT00003-INTR-UPC-ID    TO PC064-INTR-UPC-ID        04022112
031300     END-IF                                                       04023002
040000                                                                  04024002
040100     MOVE SQLCA              TO PC064-SQLCA                       04030004
040200     MOVE PC064-COMMAREA-REC TO LINK-PARMS                        04040004
040300                                                                  04050001
040400     GOBACK.                                                      04060001
040500                                                                  04070001
040700*-----------------------------------------------------------------04090001
040800* USE PO/LINE TO RETRIEVE ITM-NBR FROM TCEPLIT.                   04100015
040900*-----------------------------------------------------------------04110001
       1000-GET-TCEPLIT.                                                04121016
041100     MOVE ' 1000-GET-TCEPLIT' TO PV-PARA.                         04130015
041200                                                                  04140001
041300     EXEC SQL                                                     04150001
041400          SELECT  ITM_NBR                                         04160002
042400            INTO :CEPLIT-ITM-NBR                                  04260015
043100            FROM  TCEPLIT                                         04330015
043200           WHERE  CNSTK_REQ_PL_NBR =  :CEPLIT-CNSTK-REQ-PL-NBR    04340018
043200             AND  PL_LNE_NBR       =  :CEPLIT-PL-LNE-NBR          04341018
043300     END-EXEC.                                                    04350001
043400                                                                  04360001
043500     EVALUATE TRUE                                                04370001
043600         WHEN SQLCODE = ZERO                                      04380001
030900             MOVE CEPLIT-ITM-NBR  TO PC064-ITM-NBR                04380117
030900             SET PS-NO-ERROR TO TRUE                              04381002
045500         WHEN SQLCODE = +100                                      04570001
046000             SET PS-ERROR                                         04580004
046100                 PC064-INTR-UPC-ERROR TO TRUE                     04590004
046200             MOVE  PC064-ORD-NBR      TO  PV-DISPLAY-PO           04591004
046200             MOVE  PC064-ORD-LNE-NBR  TO  PV-DISPLAY-LINE         04592015
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      04593004
046400                                          PV-SQL-RETURN-CD        04594004
046500              STRING  ' PCKUT064-1000-'                           04595019
046700                      ' PO NBR = '                                04595115
046600                      PV-DISPLAY-PO                               04596004
046700                      ' LINE NBR = '                              04596115
046600                      PV-DISPLAY-LINE                             04598015
046700                      '  CALLED BY-'                              04599004
046800                      PC064-CALLING-PGM-NME                       04599104
046900                      '  SQLCODE='                                04599204
047000                      PV-DISPLAY-SQLCODE                          04599304
047100                      ' TASK= ' PV-EIBTASKN                       04599404
047200                      DELIMITED BY SIZE                           04599504
047300                                      INTO PC064-CRA-RET-MSG      04599604
047400             MOVE '1000-'               TO PC064-CRA-REQ-ID       04599719
047500             PERFORM 9998-RETURN                                  04599804
045800         WHEN SQLWARN0 NOT = SPACES                               04600001
045900         WHEN SQLCODE NOT EQUAL ZERO                              04610001
046000             SET PS-ERROR                                         04620001
046100                 PC064-INVALID-SQL    TO TRUE                     04630002
046200             MOVE  PC064-ORD-NBR      TO  PV-DISPLAY-PO           04640003
046200             MOVE  PC064-ORD-LNE-NBR  TO  PV-DISPLAY-LINE         04641015
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      04650001
046400                                          PV-SQL-RETURN-CD        04660001
046500              STRING  ' PCKUT064-1000-'                           04670019
046700                      ' PO NBR = '                                04671015
046600                      PV-DISPLAY-PO                               04672015
046700                      ' LINE NBR = '                              04673015
046600                      PV-DISPLAY-LINE                             04674015
046700                      '  CALLED BY-'                              04690001
046800                      PC064-CALLING-PGM-NME                       04700002
046900                      '  SQLCODE='                                04710001
047000                      PV-DISPLAY-SQLCODE                          04720001
047100                      ' TASK= ' PV-EIBTASKN                       04730001
047200                      DELIMITED BY SIZE                           04740001
047300                                      INTO PC064-CRA-RET-MSG      04750002
047400             MOVE '1000-'               TO PC064-CRA-REQ-ID       04760019
047500             PERFORM 9998-RETURN                                  04770001
047600     END-EVALUATE.                                                04780001
047700                                                                  04790001
040700*-----------------------------------------------------------------04791015
040800* USE PO/LINE TO RETRIEVE ITM-NBR FROM TPURITM.                   04792015
040900*-----------------------------------------------------------------04793015
       2000-GET-PURITM.                                                 04794015
041100     MOVE ' 2000-GET-PURITM ' TO PV-PARA.                         04795015
041200                                                                  04796015
041300     EXEC SQL                                                     04797015
041400          SELECT  ITM_NBR                                         04798015
042400            INTO :PURITM-ITM-NBR                                  04799015
043100            FROM  TPURITM                                         04799115
043200           WHERE  PO_NBR         =  :PURITM-PO-NBR                04799215
043200             AND  APP_PO_LNE_NBR =  :PURITM-APP-PO-LNE-NBR        04799320
043200             AND  VER_STATUS_CDE =  'A'                           04799415
043300     END-EXEC.                                                    04799620
043400                                                                  04799720
043500     EVALUATE TRUE                                                04799820
043600         WHEN SQLCODE = ZERO                                      04799920
030900             MOVE PURITM-ITM-NBR  TO PC064-ITM-NBR                04800020
030900             SET PS-NO-ERROR TO TRUE                              04800120
045500         WHEN SQLCODE = +100                                      04800220
046000             SET PS-ERROR                                         04800320
046100                 PC064-INTR-UPC-ERROR TO TRUE                     04800420
046200             MOVE  PC064-ORD-NBR      TO  PV-DISPLAY-PO           04800520
046200             MOVE  PC064-ORD-LNE-NBR  TO  PV-DISPLAY-LINE         04800620
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      04800720
046400                                          PV-SQL-RETURN-CD        04800820
046500              STRING  ' PCKUT064-2000-'                           04800920
046700                      ' PO NBR = '                                04801020
046600                      PV-DISPLAY-PO                               04801120
046700                      ' LINE NBR = '                              04801220
046600                      PV-DISPLAY-LINE                             04801320
046700                      '  CALLED BY-'                              04801420
046800                      PC064-CALLING-PGM-NME                       04801520
046900                      '  SQLCODE='                                04801620
047000                      PV-DISPLAY-SQLCODE                          04801720
047100                      ' TASK= ' PV-EIBTASKN                       04801820
047200                      DELIMITED BY SIZE                           04801920
047300                                      INTO PC064-CRA-RET-MSG      04802020
047400             MOVE '2000-'               TO PC064-CRA-REQ-ID       04802120
047500             PERFORM 9998-RETURN                                  04802220
045800         WHEN SQLWARN0 NOT = SPACES                               04802320
045900         WHEN SQLCODE NOT EQUAL ZERO                              04802420
046000             SET PS-ERROR                                         04802520
046100                 PC064-INVALID-SQL    TO TRUE                     04802620
046200             MOVE  PC064-ORD-NBR      TO  PV-DISPLAY-PO           04802720
046200             MOVE  PC064-ORD-LNE-NBR  TO  PV-DISPLAY-LINE         04802820
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      04802920
046400                                          PV-SQL-RETURN-CD        04803020
046500              STRING  ' PCKUT064-2000-'                           04803120
046700                      ' PO NBR = '                                04803220
046600                      PV-DISPLAY-PO                               04803320
046700                      ' LINE NBR = '                              04803420
046600                      PV-DISPLAY-LINE                             04803520
046700                      '  CALLED BY-'                              04803620
046800                      PC064-CALLING-PGM-NME                       04803720
046900                      '  SQLCODE='                                04803820
047000                      PV-DISPLAY-SQLCODE                          04803920
047100                      ' TASK= ' PV-EIBTASKN                       04804020
047200                      DELIMITED BY SIZE                           04804120
047300                                      INTO PC064-CRA-RET-MSG      04804220
047400             MOVE '2000-'               TO PC064-CRA-REQ-ID       04804320
047500             PERFORM 9998-RETURN                                  04804420
047600     END-EVALUATE.                                                04804520
047700                                                                  04804620
040700*-----------------------------------------------------------------04805015
040800* USE ITM-NBR TO RETRIEVE INTR-UPC-ID FROM XLT_SKU.               04810002
040900*-----------------------------------------------------------------04820002
       3000-GET-INTR-UPC.                                               04831015
041100     MOVE ' 3000-GET-INTR-UPC ' TO PV-PARA.                       04840015
041200                                                                  04850002
054700     INITIALIZE DCLXLT00003.                                      04851009
054800                                                                  04852006
055300     MOVE PC064-ITM-NBR       TO XLT00003-ITM-NBR.                04857017
055400                                                                  04858006
015621     EXEC SQL                                                     04859009
015622         SELECT DISTINCT INTR_UPC_ID                              04859109
015624           INTO :XLT00003-INTR-UPC-ID                             04859209
015625           FROM XLT_SKU                                           04859309
015630          WHERE ITM_NBR  =  :XLT00003-ITM-NBR                     04859409
015640     END-EXEC.                                                    04859509
015650                                                                  04859609
055900     EVALUATE TRUE                                                04860006
056000        WHEN SQLCODE = +0                                         04860106
030900             SET PS-NO-ERROR TO TRUE                              04860206
056100             MOVE XLT00003-INTR-UPC-ID    TO PC064-INTR-UPC-ID    04860309
056400        WHEN SQLCODE = +100                                       04860406
056500             DISPLAY 'NO SKU NBR FOR ITM NBR = '                  04860506
056600                     XLT00003-ITM-NBR                             04860609
046000             SET PS-ERROR                                         04860706
046100                 PC064-INTR-UPC-ERROR TO TRUE                     04860806
046200             MOVE  PC064-ORD-NBR      TO  PV-DISPLAY-PO           04860906
046200             MOVE  PC064-ORD-LNE-NBR  TO  PV-DISPLAY-LINE         04861015
055300             MOVE  PURITM-ITM-NBR     TO  PV-DISPLAY-ITM-NBR      04861109
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      04861206
046400                                          PV-SQL-RETURN-CD        04861306
046500              STRING  ' PCKUT064-3000-'                           04861415
046700                      ' PO NBR = '                                04861515
046600                      PV-DISPLAY-PO                               04861615
046700                      ' LINE NBR = '                              04861715
046600                      PV-DISPLAY-LINE                             04861815
046700                      ' ITEM NBR = '                              04861915
046600                      PV-DISPLAY-ITM-NBR                          04862306
046700                      '  CALLED BY-'                              04862406
046800                      PC064-CALLING-PGM-NME                       04862506
046900                      '  SQLCODE='                                04862606
047000                      PV-DISPLAY-SQLCODE                          04862706
047100                      ' TASK= ' PV-EIBTASKN                       04862806
047200                      DELIMITED BY SIZE                           04862906
047300                                      INTO PC064-CRA-RET-MSG      04863006
047400             MOVE '3000-'               TO PC064-CRA-REQ-ID       04863115
047500             PERFORM 9998-RETURN                                  04864006
045800         WHEN SQLWARN0 NOT = SPACES                               05001002
045900         WHEN SQLCODE NOT EQUAL ZERO                              05010002
046000             SET PS-ERROR                                         05020002
046100                 PC064-INVALID-SQL    TO TRUE                     05030002
046200             MOVE  PC064-ORD-NBR      TO  PV-DISPLAY-PO           05031003
046200             MOVE  PC064-ORD-LNE-NBR  TO  PV-DISPLAY-LINE         05032015
055300             MOVE  PURITM-ITM-NBR     TO  PV-DISPLAY-ITM-NBR      05033009
046300             MOVE  SQLCODE            TO  PV-DISPLAY-SQLCODE      05050002
046400                                          PV-SQL-RETURN-CD        05060002
046500              STRING  ' PCKUT064-3000-'                           05070015
046700                      ' PO NBR = '                                05071015
046600                      PV-DISPLAY-PO                               05072015
046700                      ' LINE NBR = '                              05073015
046600                      PV-DISPLAY-LINE                             05074015
046700                      ' ITEM NBR = '                              05075015
046600                      PV-DISPLAY-ITM-NBR                          05083006
046700                      '  CALLED BY-'                              05090002
046800                      PC064-CALLING-PGM-NME                       05100002
046900                      '  SQLCODE='                                05110002
047000                      PV-DISPLAY-SQLCODE                          05120002
047100                      ' TASK= ' PV-EIBTASKN                       05130002
047200                      DELIMITED BY SIZE                           05140002
047300                                      INTO PC064-CRA-RET-MSG      05150002
047400             MOVE '3000-'               TO PC064-CRA-REQ-ID       05160015
047500             PERFORM 9998-RETURN                                  05170002
047600     END-EVALUATE.                                                05180002
047700                                                                  05190002
221200*-----------------------------------------------------------------22180001
221300*  RETURN TO CALLING PROGRAM                                      22190001
221400*-----------------------------------------------------------------22200001
221500 9998-RETURN.                                                     22210001
221600                                                                  22220001
221700     MOVE SQLCA                         TO PC064-SQLCA            22230002
221800     MOVE PC064-COMMAREA-REC            TO LINK-PARMS.            22240002
221900                                                                  22250001
