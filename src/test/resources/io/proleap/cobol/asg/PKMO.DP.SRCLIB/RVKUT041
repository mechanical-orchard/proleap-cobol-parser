000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   RVKUT041.                                          00050000
000600 AUTHOR.       GERMAN BANDA.                                      00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. FEBRUARY 2023.                                     00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200*  RTV - INMAR FILES: VERIFY THAT POSITIVE RECEIPTS FILES ARE NOT 00120005
001300*            EMPTY. FOR ANY EMPTY FILES WRITE LOCATION AND ERROR  00130005
001400*            MESSAGE TO ERROR FILE.  ANY ERRORS WILL BE EMAILED   00140005
001410*            TO SUPPORT TEAM                                      00141005
001500*----------------------------------------------------------------*00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700*----------------------------------------------------------------*00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
002000                                                                  00200000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
003400     SELECT RTV-HDR-FILE-561      ASSIGN TO INP01.                00340003
003500     SELECT RTV-HDR-FILE-566      ASSIGN TO INP02.                00350003
003600     SELECT RTV-HDR-FILE-582      ASSIGN TO INP03.                00360003
003601     SELECT RTV-HDR-FILE-629      ASSIGN TO INP04.                00360103
003602     SELECT RTV-HDR-FILE-635      ASSIGN TO INP05.                00360203
003603     SELECT RTV-HDR-FILE-811      ASSIGN TO INP06.                00360303
003604     SELECT RTV-ERROR-MESSG-FILE  ASSIGN TO OUT01.                00360400
003605                                                                  00360500
003606*----------------------------------------------------------------*00360600
003607 DATA DIVISION.                                                   00360700
003608*----------------------------------------------------------------*00360800
003609                                                                  00360900
003610 FILE SECTION.                                                    00361000
003611                                                                  00361100
003618                                                                  00361800
003619 FD  RTV-HDR-FILE-561                                             00361900
003620     RECORDING MODE IS F                                          00362000
003630     LABEL RECORDS ARE STANDARD                                   00363000
003640     BLOCK CONTAINS 0 RECORDS.                                    00364000
003650                                                                  00365000
003660 01  RTV-HDR-RECORD-561               PIC X(150).                 00366000
003670                                                                  00367000
003803                                                                  00380300
003804 FD  RTV-HDR-FILE-566                                             00380400
003805     RECORDING MODE IS F                                          00380500
003806     LABEL RECORDS ARE STANDARD                                   00380600
003807     BLOCK CONTAINS 0 RECORDS.                                    00380700
003808                                                                  00380800
003809 01  RTV-HDR-RECORD-566               PIC X(150).                 00380900
003817                                                                  00381700
003818 FD  RTV-HDR-FILE-582                                             00381800
003819     RECORDING MODE IS F                                          00381900
003820     LABEL RECORDS ARE STANDARD                                   00382000
003821     BLOCK CONTAINS 0 RECORDS.                                    00382100
003822                                                                  00382200
003823 01  RTV-HDR-RECORD-582               PIC X(150).                 00382300
003824                                                                  00382400
003832 FD  RTV-HDR-FILE-629                                             00383200
003833     RECORDING MODE IS F                                          00383300
003834     LABEL RECORDS ARE STANDARD                                   00383400
003835     BLOCK CONTAINS 0 RECORDS.                                    00383500
003836                                                                  00383600
003837 01  RTV-HDR-RECORD-629               PIC X(150).                 00383700
003845                                                                  00384500
003846 FD  RTV-HDR-FILE-635                                             00384600
003847     RECORDING MODE IS F                                          00384700
003848     LABEL RECORDS ARE STANDARD                                   00384800
003849     BLOCK CONTAINS 0 RECORDS.                                    00384900
003850                                                                  00385000
003851 01  RTV-HDR-RECORD-635               PIC X(150).                 00385100
003859                                                                  00385900
003860 FD  RTV-HDR-FILE-811                                             00386000
003861     RECORDING MODE IS F                                          00386100
003862     LABEL RECORDS ARE STANDARD                                   00386200
003863     BLOCK CONTAINS 0 RECORDS.                                    00386300
003864                                                                  00386400
003865 01  RTV-HDR-RECORD-811               PIC X(150).                 00386500
003866                                                                  00386600
003867 FD  RTV-ERROR-MESSG-FILE                                         00386700
003868     RECORDING MODE IS F                                          00386800
003869     LABEL RECORDS ARE STANDARD                                   00386900
003870     BLOCK CONTAINS 0 RECORDS.                                    00387000
003871                                                                  00387100
003872 01  RTV-ERROR-RECORD                 PIC X(80).                  00387200
003873                                                                  00387300
003874*----------------------------------------------------------------*00387400
003875 WORKING-STORAGE SECTION.                                         00387500
003876*----------------------------------------------------------------*00387600
003884*----------------------------------------------------------------*00388400
003885* INPUT LAYOUT - RV060-TPR-DETAIL-RECORD                          00388500
003886*----------------------------------------------------------------*00388600
003887                                                                  00388700
003888     COPY RVRD060.                                                00388800
003889                                                                  00388900
003890***  PROGRAM ACCUMULATORS                                         00389000
003891                                                                  00389100
003892 01  PA-PROGRAM-ACCUMULATORS.                                     00389200
003893     05  PA-TOTALS.                                               00389300
003894         10 PA-TOT-CTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 00389400
003895         10 PA-TOT-HDR-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 00389500
003896         10 PA-TOT-DTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 00389600
003897                                                                  00389700
003898***  PROGRAM SWITCHES                                             00389800
003899 01  PS-PROGRAM-SWITCHES.                                         00389900
003900     05  PS-END-OF-DTL-INPUT-SW        PIC  X(01)    VALUE 'N'.   00390000
004000         88  PS-END-OF-DTL-INPUT-YES                 VALUE 'Y'.   00400000
004100         88  PS-END-OF-DTL-INPUT-NO                  VALUE 'N'.   00410000
004200     05  PS-END-OF-HDR-INPUT-SW        PIC  X(01)    VALUE 'N'.   00420000
004300         88  PS-END-OF-HDR-INPUT-YES                 VALUE 'Y'.   00430000
004400         88  PS-END-OF-HDR-INPUT-NO                  VALUE 'N'.   00440000
004410     05  PS-HEADER-WRITE-SW            PIC  X(01)    VALUE 'N'.   00441000
004420         88  PS-HEADER-WRITE-YES                     VALUE 'Y'.   00442000
004430         88  PS-HEADER-WRITE-NO                      VALUE 'N'.   00443000
004431     05  PS-PROCESS-561-SW             PIC  X(01)    VALUE 'N'.   00443100
004432         88  PS-PROCESS-561                          VALUE 'Y'.   00443200
004433         88  PS-PROCESS-561-NO                       VALUE 'N'.   00443300
004434     05  PS-PROCESS-566-SW             PIC  X(01)    VALUE 'N'.   00443400
004435         88  PS-PROCESS-566                          VALUE 'Y'.   00443500
004436         88  PS-PROCESS-566-NO                       VALUE 'N'.   00443600
004437     05  PS-PROCESS-582-SW             PIC  X(01)    VALUE 'N'.   00443700
004438         88  PS-PROCESS-582                          VALUE 'Y'.   00443800
004439         88  PS-PROCESS-582-NO                       VALUE 'N'.   00443900
004440     05  PS-PROCESS-629-SW             PIC  X(01)    VALUE 'N'.   00444000
004450         88  PS-PROCESS-629                          VALUE 'Y'.   00445000
004460         88  PS-PROCESS-629-NO                       VALUE 'N'.   00446000
004470     05  PS-PROCESS-635-SW             PIC  X(01)    VALUE 'N'.   00447000
004480         88  PS-PROCESS-635                          VALUE 'Y'.   00448000
004490         88  PS-PROCESS-635-NO                       VALUE 'N'.   00449000
004491     05  PS-PROCESS-811-SW             PIC  X(01)    VALUE 'N'.   00449100
004492         88  PS-PROCESS-811                          VALUE 'Y'.   00449200
004493         88  PS-PROCESS-811-NO                       VALUE 'N'.   00449300
004494                                                                  00449400
004495 01  PV-MSG-HDR-RECORD                   PIC X(80) VALUE SPACES.  00449500
004496 01  PV-MSG-RECORD                       PIC X(80) VALUE SPACES.  00449600
004497 01  PV-PROGRAM-VARIABLES.                                        00449700
004498     05  PV-MESSAGE-LINE-1               PIC  X(150) VALUE        00449800
004499             '***** NO RECORDS ON HDR AND DTL FILE *********'.    00449900
004500***  PROGRAM CONSTANTS                                            00450000
004600 01  PC-PROGRAM-CONSTANTS.                                        00460000
004700     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'RVKUT041'. 00470000
004800     05  PC-PROCESSING-HEADER        PIC X(42)  VALUE             00480004
004900                    'INMAR POSITIVE RECEIPTS PROCESSING ERRORS '. 00490004
004901     05  PC-LOCATION-561             PIC X(35)  VALUE             00490100
004902                    'LOCATION 561 - MODESTO            '.         00490200
004903     05  PC-LOCATION-566             PIC X(35)  VALUE             00490300
004904                    'LOCATION 566 - BREINIGSVILLE      '.         00490400
004905     05  PC-LOCATION-582             PIC X(35)  VALUE             00490500
004906                    'LOCATION 582 - INDIANAPOLIS       '.         00490600
004907     05  PC-LOCATION-629             PIC X(35)  VALUE             00490700
004908                    'LOCATION 629 - STOCKBRIDGE        '.         00490800
004909     05  PC-LOCATION-635             PIC X(35)  VALUE             00490900
004910                    'LOCATION 635 - ARLINGTON          '.         00491000
004911     05  PC-LOCATION-811             PIC X(35)  VALUE             00491100
004912                    'LOCATION 811 - FINDLAY            '.         00491200
004913     05  PC-HEADER-OR-DETAIL         PIC X(35)  VALUE             00491304
004914            '** EMPTY POSITVE RECEIPTS FILE**  '.                 00491404
004915*----------------------------------------------------------------*00491500
004916 LINKAGE SECTION.                                                 00491600
004917*----------------------------------------------------------------*00491700
004918                                                                  00491800
004919*----------------------------------------------------------------*00491900
004920 PROCEDURE DIVISION.                                              00492000
004921*----------------------------------------------------------------*00492100
004922                                                                  00492200
004923*----------------------------------------------------------------*00492300
004924*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *00492400
004925*----------------------------------------------------------------*00492500
004926                                                                  00492600
004927 0000-PROGRAM-MAINLINE.                                           00492700
004928                                                                  00492800
004929     DISPLAY '************ START OF RVKUT041 ***************'     00492900
004930                                                                  00493000
004931     PERFORM 1000-INITIALIZE THRU 1000-EXIT.                      00493100
004932*----------------------------------------------------------------*00493200
004933*   PROCESS AND WRITE ANY ERRORS LOCATION BY LOCATION            *00493305
004934*----------------------------------------------------------------*00493400
004935     SET PS-PROCESS-561 TO TRUE                                   00493500
004937     PERFORM 3100-READ-RTV-HDR-FILE-561.                          00493700
004938     PERFORM 4000-RTV-FILE-CHECK                                  00493800
004939     SET PS-PROCESS-561-NO TO TRUE                                00493900
004940                                                                  00494000
004941     SET PS-PROCESS-566 TO TRUE                                   00494100
004943     PERFORM 3200-READ-RTV-HDR-FILE-566.                          00494300
004944     PERFORM 4000-RTV-FILE-CHECK                                  00494400
004945     SET PS-PROCESS-566-NO TO TRUE                                00494500
004946                                                                  00494600
004947     SET PS-PROCESS-582 TO TRUE                                   00494700
004949     PERFORM 3300-READ-RTV-HDR-FILE-582.                          00494900
004950     PERFORM 4000-RTV-FILE-CHECK                                  00495000
004960     SET PS-PROCESS-582-NO TO TRUE                                00496000
004970                                                                  00497000
004980     SET PS-PROCESS-629 TO TRUE                                   00498000
005000     PERFORM 3400-READ-RTV-HDR-FILE-629.                          00500000
005100     PERFORM 4000-RTV-FILE-CHECK                                  00510000
005200     SET PS-PROCESS-629-NO TO TRUE                                00520000
005300                                                                  00530000
005400     SET PS-PROCESS-635 TO TRUE                                   00540000
005600     PERFORM 3500-READ-RTV-HDR-FILE-635.                          00560000
005700     PERFORM 4000-RTV-FILE-CHECK                                  00570000
005800     SET PS-PROCESS-635-NO TO TRUE                                00580000
005900                                                                  00590000
006000     SET PS-PROCESS-811 TO TRUE                                   00600000
006200     PERFORM 3600-READ-RTV-HDR-FILE-811.                          00620000
006300     PERFORM 4000-RTV-FILE-CHECK                                  00630000
006400     SET PS-PROCESS-811-NO TO TRUE                                00640000
006500                                                                  00650000
006510                                                                  00651000
006750     PERFORM 8000-EOJ-ROUTINE.                                    00675000
006760                                                                  00676000
006780                                                                  00678000
006790     GOBACK.                                                      00679000
006800                                                                  00680000
006900*----------------------------------------------------------------*00690000
007000*    INITIALIZE VARIABLES.                                        00700000
007100*    OPEN FILES.                                                  00710000
007200*    DO A PRIME READ FOR THE DTL                                  00720000
007300*----------------------------------------------------------------*00730000
007301                                                                  00730100
007302 1000-INITIALIZE.                                                 00730200
007303                                                                  00730300
007310     OPEN INPUT RTV-HDR-FILE-561                                  00731002
007320                RTV-HDR-FILE-566                                  00732000
007321                RTV-HDR-FILE-582                                  00732100
007322                RTV-HDR-FILE-629                                  00732200
007323                RTV-HDR-FILE-635                                  00732300
007324                RTV-HDR-FILE-811                                  00732400
007325        OUTPUT  RTV-ERROR-MESSG-FILE.                             00732500
007326                                                                  00732600
007327                                                                  00732700
007328 1000-EXIT.                                                       00732800
007329     EXIT.                                                        00732900
007330                                                                  00733000
007895*----------------------------------------------------------------*00789500
007896*    READ THE RTV HEADER FILE MODESTO - LOC 561                   00789600
007897*----------------------------------------------------------------*00789700
007898                                                                  00789800
007899 3100-READ-RTV-HDR-FILE-561.                                      00789900
007900                                                                  00790000
007901     READ RTV-HDR-FILE-561 INTO RV060-TPR-DETAIL-RECORD           00790100
007902         AT END                                                   00790200
007903             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00790300
007904     END-READ.                                                    00790400
007905                                                                  00790500
007906     IF PS-END-OF-HDR-INPUT-NO                                    00790600
007907        ADD 1 TO PA-TOT-HDR-RECS-READ                             00790700
007908     END-IF.                                                      00790800
007909                                                                  00790900
007910*----------------------------------------------------------------*00791000
007911*    READ THE RTV HEADER FILE BREINIGSVILLE - LOC 566             00791100
007912*----------------------------------------------------------------*00791200
007913                                                                  00791300
007914 3200-READ-RTV-HDR-FILE-566.                                      00791400
007915                                                                  00791500
007916     READ RTV-HDR-FILE-566 INTO RV060-TPR-DETAIL-RECORD           00791600
007917         AT END                                                   00791700
007918             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00791800
007919     END-READ.                                                    00791900
007920                                                                  00792000
007930     IF PS-END-OF-HDR-INPUT-NO                                    00793000
007940        ADD 1 TO PA-TOT-HDR-RECS-READ                             00794000
007950     END-IF.                                                      00795000
007960                                                                  00796000
007970*----------------------------------------------------------------*00797000
007980*    READ THE RTV HEADER FILE INDIANAPOLIS - LOC 582              00798000
007990*----------------------------------------------------------------*00799000
007991                                                                  00799100
007992 3300-READ-RTV-HDR-FILE-582.                                      00799200
007993                                                                  00799300
007994     READ RTV-HDR-FILE-582 INTO RV060-TPR-DETAIL-RECORD           00799400
007995         AT END                                                   00799500
007996             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00799600
007997     END-READ.                                                    00799700
007998                                                                  00799800
007999     IF PS-END-OF-HDR-INPUT-NO                                    00799900
008000        ADD 1 TO PA-TOT-HDR-RECS-READ                             00800000
008001     END-IF.                                                      00800100
008002                                                                  00800200
008003*----------------------------------------------------------------*00800300
008004*    READ THE RTV HEADER FILE STOCKBRIDGE LOC 629                 00800400
008005*----------------------------------------------------------------*00800500
008006                                                                  00800600
008007 3400-READ-RTV-HDR-FILE-629.                                      00800700
008008                                                                  00800800
008009     READ RTV-HDR-FILE-629 INTO RV060-TPR-DETAIL-RECORD           00800900
008010         AT END                                                   00801000
008011             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00801100
008012     END-READ.                                                    00801200
008013                                                                  00801300
008014     IF PS-END-OF-HDR-INPUT-NO                                    00801400
008015        ADD 1 TO PA-TOT-HDR-RECS-READ                             00801500
008016     END-IF.                                                      00801600
008017                                                                  00801700
008018*----------------------------------------------------------------*00801800
008019*    READ THE RTV HEADER FILE ARLINGTON - LOC 635                 00801900
008020*----------------------------------------------------------------*00802000
008021                                                                  00802100
008022 3500-READ-RTV-HDR-FILE-635.                                      00802200
008023                                                                  00802300
008024     READ RTV-HDR-FILE-635 INTO RV060-TPR-DETAIL-RECORD           00802400
008025         AT END                                                   00802500
008026             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00802600
008027     END-READ.                                                    00802700
008028                                                                  00802800
008029     IF PS-END-OF-HDR-INPUT-NO                                    00802900
008030        ADD 1 TO PA-TOT-HDR-RECS-READ                             00803000
008031     END-IF.                                                      00803100
008032                                                                  00803200
008033*----------------------------------------------------------------*00803300
008034*    READ THE RTV HEADER FILE FINDALY 811                         00803400
008035*----------------------------------------------------------------*00803500
008036                                                                  00803600
008037 3600-READ-RTV-HDR-FILE-811.                                      00803700
008038                                                                  00803800
008039     READ RTV-HDR-FILE-811 INTO RV060-TPR-DETAIL-RECORD           00803900
008040         AT END                                                   00804000
008041             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00804100
008042     END-READ.                                                    00804200
008043                                                                  00804300
008044     IF PS-END-OF-HDR-INPUT-NO                                    00804400
008045        ADD 1 TO PA-TOT-HDR-RECS-READ                             00804500
008046     END-IF.                                                      00804600
008047                                                                  00804700
008048                                                                  00804800
008049 4000-RTV-FILE-CHECK.                                             00804900
008050     DISPLAY '4000-RTV-FILE-CHECK'                                00805000
008060     MOVE PC-PROCESSING-HEADER TO PV-MSG-HDR-RECORD               00806000
008070     INITIALIZE PV-MSG-RECORD                                     00807000
008080     EVALUATE TRUE                                                00808000
008090       WHEN PS-PROCESS-561                                        00809000
008100         MOVE  PC-LOCATION-561  TO PV-MSG-RECORD                  00810000
008110       WHEN PS-PROCESS-566                                        00811000
008120         MOVE  PC-LOCATION-566  TO PV-MSG-RECORD                  00812000
008130       WHEN PS-PROCESS-582                                        00813000
008140         MOVE  PC-LOCATION-582  TO PV-MSG-RECORD                  00814000
008141       WHEN PS-PROCESS-629                                        00814100
008142         MOVE  PC-LOCATION-629  TO PV-MSG-RECORD                  00814200
008143       WHEN PS-PROCESS-635                                        00814300
008144         MOVE  PC-LOCATION-635  TO PV-MSG-RECORD                  00814400
008145       WHEN PS-PROCESS-811                                        00814500
008146         MOVE  PC-LOCATION-811  TO PV-MSG-RECORD                  00814600
008147     END-EVALUATE.                                                00814700
008148                                                                  00814800
008149     IF PS-END-OF-HDR-INPUT-YES                                   00814900
008151         IF PS-HEADER-WRITE-NO                                    00815100
008152            WRITE RTV-ERROR-RECORD  FROM PV-MSG-HDR-RECORD        00815200
008153            INITIALIZE PV-MSG-HDR-RECORD                          00815300
008154            WRITE RTV-ERROR-RECORD  FROM PV-MSG-HDR-RECORD        00815400
008155            SET PS-HEADER-WRITE-YES TO TRUE                       00815500
008156         END-IF                                                   00815600
008157         PERFORM 7000-WRITE-EXTRACT-RECORD                        00815700
008158                                                                  00815800
008159         INITIALIZE PV-MSG-RECORD                                 00815900
008160         MOVE PC-HEADER-OR-DETAIL TO PV-MSG-RECORD                00816000
008161         PERFORM 7000-WRITE-EXTRACT-RECORD                        00816100
008162         INITIALIZE PV-MSG-RECORD                                 00816200
008163         PERFORM 7000-WRITE-EXTRACT-RECORD                        00816300
008164     END-IF.                                                      00816400
008165                                                                  00816500
008204     PERFORM 5500-RESET-INDICATORS.                               00820400
008206*                                                                *00820600
008272*----------------------------------------------------------------*00827200
008273 5500-RESET-INDICATORS.                                           00827300
008274      DISPLAY  '5500-RESET-INDICATORS'                            00827400
008275      SET PS-END-OF-DTL-INPUT-NO                                  00827500
008276          PS-END-OF-HDR-INPUT-NO  TO TRUE.                        00827600
008277      MOVE +0   TO PA-TOT-CTL-RECS-READ                           00827700
008278                   PA-TOT-HDR-RECS-READ                           00827800
008279                   PA-TOT-DTL-RECS-READ.                          00827900
008280************************************************************      00828000
008281 7000-WRITE-EXTRACT-RECORD.                                       00828100
008282     WRITE RTV-ERROR-RECORD                                       00828200
008283           FROM PV-MSG-RECORD.                                    00828300
008284*                                                                 00828400
008285*----------------------------------------------------------------*00828500
008286*    DISPLAY SUMMARY STATS AND VERIFY CONTROL RECORD COUNTS       00828600
008287*----------------------------------------------------------------*00828700
008288                                                                  00828800
008289 8000-EOJ-ROUTINE.                                                00828900
008290                                                                  00829000
008291     CLOSE RTV-HDR-FILE-561                                       00829105
008292           RTV-HDR-FILE-566                                       00829205
008293           RTV-HDR-FILE-582                                       00829305
008294           RTV-HDR-FILE-629                                       00829405
008295           RTV-HDR-FILE-635                                       00829505
008296           RTV-HDR-FILE-811                                       00829605
008297           RTV-ERROR-MESSG-FILE.                                  00829705
008298                                                                  00829805
008299     DISPLAY '************  END OF RVKUT041  ***************'.    00829905
011700                                                                  01170000
011701                                                                  01170100
011702*----------------------------------------------------------------*01170200
011703*                       END OF PROGRAM                            01170300
011704*----------------------------------------------------------------*01170400
