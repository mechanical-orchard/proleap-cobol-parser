000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SVKUT066.                                00050000
000600 AUTHOR.                 BARB SCHULTZ.                            00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            JULY 2005.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  CORP RECEIVED AMOUNT FROM LP SCANNED STORED VALUE CARD EXTRACT*00120024
001400******************************************************************00130000
001900                                                                  00140000
002000******************************************************************00150000
002100 ENVIRONMENT DIVISION.                                            00160000
002200******************************************************************00170000
002300                                                                  00180000
002400 CONFIGURATION SECTION.                                           00190000
002500                                                                  00200000
002600 SOURCE-COMPUTER.        IBM-3090.                                00210000
002700 OBJECT-COMPUTER.        IBM-3090.                                00220000
002800                                                                  00230000
002900 INPUT-OUTPUT SECTION.                                            00240000
003000                                                                  00250000
003100 FILE-CONTROL.                                                    00260000
003200     SELECT DATE-CARD-FILE                                        00270000
003300         ASSIGN TO INP01.                                         00280000
003400                                                                  00290000
004100     SELECT CORP-RCVD-FILE                                        00300000
004200         ASSIGN TO OUT01.                                         00310000
004300                                                                  00320000
004400******************************************************************00330000
004500 DATA DIVISION.                                                   00340000
004600******************************************************************00350000
004700                                                                  00360000
004800 FILE SECTION.                                                    00370000
004900                                                                  00380000
005000 FD  DATE-CARD-FILE                                               00390000
005100     RECORDING MODE IS F                                          00400000
005200     BLOCK CONTAINS 0 RECORDS                                     00410000
005300     LABEL RECORDS ARE STANDARD.                                  00420000
005400                                                                  00430000
005500 01  DATE-CARD-RECORD                       PIC X(80).            00440000
005600                                                                  00450000
006400 FD  CORP-RCVD-FILE                                               00460002
006500     RECORDING MODE IS F                                          00470000
006600     BLOCK CONTAINS 0 RECORDS                                     00480000
006700     LABEL RECORDS ARE STANDARD.                                  00490000
006800                                                                  00500000
006900 01  CORP-RCVD-RECORD                       PIC X(60).            00510006
007000                                                                  00520000
007800******************************************************************00530000
007900 WORKING-STORAGE SECTION.                                         00540000
008000******************************************************************00550000
011100                                                                  00560000
019800                                                                  01070000
019900 01  PC-PROGRAM-CONSTANTS.                                        01080000
020000     05  PC-PROGRAM-NAME              PIC  X(08)  VALUE           01090000
020100                                                    'SVKUT066'.   01100000
020800                                                                  01130000
020900 01  PS-PROGRAM-SWITCHES.                                         01140000
021000     05  PS-END-OF-CURSOR-SW          PIC X(01)   VALUE 'N'.      01150001
021100         88  PS-END-OF-CURSOR                     VALUE 'Y'.      01160000
021400     05  PS-END-OF-CARD-FILE-SW       PIC X(01)   VALUE 'N'.      01170000
021500         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01180000
022400                                                                  01190000
022500 01  PV-PROGRAM-VARIABLES.                                        01200000
023400     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACE.    01210000
023500     05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACE.    01220000
025620     05  PV-F-DATE-CCYY-MM-DD         PIC  X(10)  VALUE SPACES.   01290000
025620     05  PV-T-DATE-CCYY-MM-DD         PIC  X(10)  VALUE SPACES.   01300000
039668     05  PV-AUTH-AMT                  PIC S9(7)V99 VALUE ZEROES   01301013
024201                                                  COMP-3.         01310013
076866     05  PV-FROM-DTE                  PIC  9(8)   VALUE ZEROES.   01330018
076866     05  PV-TO-DTE                    PIC  9(8)   VALUE ZEROES.   01340018
025300******************************************************************01440000
025400* RECORD LAYOUT FOR INPUT DATE CARD                               01450000
025500******************************************************************01460000
025610 01  CC-CONTROL-CARD.                                             01470000
025620     05  CC-FROM-DATE-CCYY-MM-DD.                                 01480000
025630         10  CC-FROM-DATE-CC          PIC  X(02)   VALUE SPACES.  01490000
025640         10  CC-FROM-DATE-YY          PIC  X(02)   VALUE SPACES.  01500000
025650         10  FILLER                   PIC  X(01)   VALUE SPACES.  01510000
025660         10  CC-FROM-DATE-MM          PIC  X(02)   VALUE SPACES.  01520000
025670         10  FILLER                   PIC  X(01)   VALUE SPACES.  01530000
025680         10  CC-FROM-DATE-DD          PIC  X(02)   VALUE SPACES.  01540000
025670     05  FILLER                       PIC  X(01)   VALUE SPACES.  01550000
025620     05  CC-TO-DATE-CCYY-MM-DD.                                   01560000
025630         10  CC-TO-DATE-CC            PIC  X(02)   VALUE SPACES.  01570000
025640         10  CC-TO-DATE-YY            PIC  X(02)   VALUE SPACES.  01580000
025650         10  FILLER                   PIC  X(01)   VALUE SPACES.  01590000
025660         10  CC-TO-DATE-MM            PIC  X(02)   VALUE SPACES.  01600000
025670         10  FILLER                   PIC  X(01)   VALUE SPACES.  01610000
025680         10  CC-TO-DATE-DD            PIC  X(02)   VALUE SPACES.  01620000
025690      05  FILLER                      PIC  X(59)   VALUE SPACES.  01630000
025691                                                                  01640000
026000 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       01650000
026100                                                 COMP SYNC.       01660000
026200     88  AC-CONTROL-CARD-ERROR                   VALUE +4003.     01670000
026201     88  AC-SQL-ERROR                            VALUE +4013.     01680000
026202     88  AC-DATE-ERROR                           VALUE +4019.     01690000
026300                                                                  01700000
026000     COPY SVRD056.                                                01710001
028410                                                                  01880000
029000******************************************************************01940000
029100* DATE ROUTINE COPY MEMBERS                                       01950002
029200******************************************************************01960000
029300     COPY DPWS500.                                                01970002
029400                                                                  01980000
029000******************************************************************01981002
029100*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            01982002
029200******************************************************************01983002
029300     COPY DPWS004.                                                01984002
029400                                                                  01985002
029000******************************************************************01990000
029100*  DB2 TABLE SVT_CRD_PROD                                         02000004
029200******************************************************************02010000
029300     EXEC SQL                                                     02020000
029400           INCLUDE SVT00000                                       02030004
029500     END-EXEC.                                                    02040000
029600                                                                  02050000
029000******************************************************************02051004
029100*  DB2 TABLE SVT_KOHLS_CRD_TXN                                    02052004
029200******************************************************************02053004
029300     EXEC SQL                                                     02054004
029400           INCLUDE SVT00002                                       02055004
029500     END-EXEC.                                                    02056004
029600                                                                  02057004
048100******************************************************************02060000
048200*    DB2 AREA FOR SVT_KOHLS_CRD_ACCT                             *02070000
048400******************************************************************02090000
048500     EXEC SQL                                                     02100000
048600         INCLUDE SVT00001                                         02110000
048700     END-EXEC.                                                    02120000
048800                                                                  02130000
029500******************************************************************02140000
029600*  DB2 COMMUNICATION AREA.                                        02150000
029700******************************************************************02160000
029800     EXEC SQL                                                     02170000
029900           INCLUDE SQLCA                                          02180000
030000     END-EXEC.                                                    02190000
030100***************************************************************** 02200000
030100*    CURSOR TO CORP RECEIVED CARDS                                02210000
030100***************************************************************** 02220000
030100     EXEC SQL                                                     02230000
030100       DECLARE CORP-CSR CURSOR FOR                                02240000
               SELECT A.CRD_NBR                                         02250001
                    , A.CRD_CLO_DTE                                     02251001
                    , A.CLO_USR_ID                                      02260000
                    , A.CRD_TYP_CDE                                     02270000
                    , B.CRD_STK_TYP_ID                                  02272011
               FROM SVT_KOHLS_CRD_ACCT  A                               02280000
                  , SVT_CRD_PROD        B                               02291011
               WHERE A.CRD_PROD_YR   = B.CRD_PROD_YR                    02301011
                 AND A.SHIPT_REQ_NBR = B.SHIPT_REQ_NBR                  02302011
                 AND CRD_CLO_DTE BETWEEN :PV-F-DATE-CCYY-MM-DD          02310008
                                     AND :PV-T-DATE-CCYY-MM-DD          02320010
                 AND CRD_STAT_CDE   = 'HQ'                              02330008
030100           WITH UR                                                02340000
030100       END-EXEC.                                                  02350000
030100                                                                  02360000
030200******************************************************************02380000
030300 PROCEDURE DIVISION.                                              02390000
030400******************************************************************02400000
030500 0000-PROGRAM-MAINLINE.                                           02410000
030600                                                                  02420000
030900     PERFORM 1000-INITIALIZE.                                     02430000
031000                                                                  02440000
031100     PERFORM 2000-PROCESS-REPORT-FILE                             02450000
031200       UNTIL PS-END-OF-CURSOR.                                    02460000
031300                                                                  02470000
041000     PERFORM 4600-CLOSE-CORP-CSR.                                 02490000
032900     PERFORM 9000-EOJ-ROUTINE.                                    02500000
033000                                                                  02510000
033100     STOP RUN.                                                    02520000
033200                                                                  02530000
033300******************************************************************02540000
033400*  1000-INITIALIZE                                                02550000
033500******************************************************************02560000
033600 1000-INITIALIZE.                                                 02570000
033700                                                                  02580000
033800     OPEN INPUT  DATE-CARD-FILE                                   02590000
034100          OUTPUT CORP-RCVD-FILE.                                  02600000
034160                                                                  02610000
035300     INITIALIZE SV056-DETAIL-TRANS.                               02740007
039598     PERFORM 1400-PROCESS-CONTROL-CARD.                           02750000
035300                                                                  02760000
076856     INITIALIZE DPG51 DPG52 DPG53                                 02761023
076857                DPG54 DPG55 DPG56.                                02762023
076858                                                                  02763023
039602     MOVE CC-FROM-DATE-CCYY-MM-DD   TO PV-F-DATE-CCYY-MM-DD.      02770017
039602     MOVE PV-F-DATE-CCYY-MM-DD      TO DPG52-LK-DATE-INPUT.       02770219
035300     PERFORM 9975-DATE-ROUTINE.                                   02771017
076866     MOVE DPG55-DB2-ISO-DATE-N      TO PV-FROM-DTE.               02771118
035300                                                                  02772017
039602     MOVE CC-TO-DATE-CCYY-MM-DD     TO PV-T-DATE-CCYY-MM-DD.      02780017
039602     MOVE PV-T-DATE-CCYY-MM-DD      TO DPG52-LK-DATE-INPUT.       02781017
035300     PERFORM 9975-DATE-ROUTINE.                                   02790017
076866     MOVE DPG55-DB2-ISO-DATE-N      TO PV-TO-DTE.                 02791118
035300     IF PV-FROM-DTE < PV-TO-DTE                                   02792017
035300         CONTINUE                                                 02793017
035300     ELSE                                                         02794017
039633         MOVE '1000-INITIALIZE'  TO PV-PARAGRAPH-NAME             02794117
039634         MOVE 'CONTROL CARD DATES ARE NOT CORRECT '               02794317
039634                       TO PV-OPERATION-MSG-1                      02794417
039635         SET AC-CONTROL-CARD-ERROR TO TRUE                        02794517
076900         PERFORM 9999-ABEND                                       02795017
076900     END-IF.                                                      02796017
035300                                                                  02800017
039602     PERFORM 4400-OPEN-CORP-CURSOR.                               02820000
039602     PERFORM 4500-FETCH-CORP-CURSOR.                              02830000
039602                                                                  02840000
039623***************************************************************** 02850000
039624* 1400-PROCESS-CONTROL-CARD                                       02860000
039625* READ DATE CONTROL CARD FOR FISCAL MONTH-END DATE.               02870000
039626* CALL DATE ROUTINE TO GET MAX FISCAL PERIOD.                     02880000
039627***************************************************************** 02890000
039628 1400-PROCESS-CONTROL-CARD.                                       02900000
039629                                                                  02910000
039630     PERFORM 1410-READ-DATE-CARD-FILE.                            02920000
039631                                                                  02930000
039632     IF PS-END-OF-CARD-FILE                                       02940000
039633         MOVE '1400-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   02950000
039634         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  02960000
039635         SET AC-CONTROL-CARD-ERROR TO TRUE                        02970000
039636         PERFORM 9999-ABEND                                       02980000
039637     END-IF.                                                      02990000
039638                                                                  03000000
039647     DISPLAY 'SVKUT066 CONTROL CARD DATE: '                       03150000
039648                          CC-CONTROL-CARD.                        03160000
039649                                                                  03170000
039650******************************************************************03180000
039651* 1410-READ-DATE-CARD-FILE                                        03190000
039652******************************************************************03200000
039653 1410-READ-DATE-CARD-FILE.                                        03210000
039654                                                                  03220000
039655     READ DATE-CARD-FILE INTO CC-CONTROL-CARD                     03230000
039656       AT END                                                     03240000
039657           SET PS-END-OF-CARD-FILE TO TRUE.                       03250000
039658                                                                  03260000
039660******************************************************************03270000
039662* 2000-PROCESS-REPORT-FILE                                       *03280000
039664******************************************************************03290000
039666 2000-PROCESS-REPORT-FILE.                                        03300000
039658                                                                  03300112
039668     PERFORM 2100-SELECT-SUM-ACTIVITY.                            03301011
039658                                                                  03302012
039668     MOVE SVT00001-CRD-NBR        TO SV056-CRD-NBR.               03310007
039668     MOVE SVT00001-CRD-TYP-CDE    TO SV056-CRD-TYP-CDE.           03311007
039668     MOVE SVT00000-CRD-STK-TYP-ID TO SV056-CRD-STK-TYP-ID.        03312007
039668     MOVE SVT00001-CRD-CLO-DTE    TO SV056-CRD-CLO-DTE.           03313007
039668     MOVE SVT00001-CLO-USR-ID     TO SV056-CLO-USR-ID.            03314007
039668     MOVE PV-AUTH-AMT             TO SV056-APP-AUTH-AMT.          03315011
039668                                                                  03316001
039668     WRITE CORP-RCVD-RECORD FROM SV056-DETAIL-TRANS.              03317007
039668                                                                  03318001
039602     PERFORM 4500-FETCH-CORP-CURSOR.                              03520000
039668                                                                  03530000
041000******************************************************************03810000
041000* 2100-SELECT-SUM-ACTIVITY                                       *03820016
041000*   ADDS UP ALL THE TRANSACTION AMOUNTS                          *03830016
041000* - SQLCODE = -305, ERROR:  THE NULL VALUE CANNOT BE ASSIGNED    *03831016
041000*   TO OUTPUT HOST VARIABLE NUMBER 001 BECAUSE NO INDICATOR      *03832016
041000*   VARIABLE IS SPECIFIED                                        *03833016
041000**  - THIS ERROR MEANS THAT NONE OF THE ROWS QUALIFIED FOR       *03840016
041000**    THE SUM AND A NULL VALUE WAS RETURNED.  IF A NULL          *03841016
041000**    INDICATOR VARIABLE WAS PLACED NEXT TO THE HOST VARIABLE    *03842016
041000**    THE SQLCODE WOULD HAVE BEEN A ZERO.                        *03843016
041000******************************************************************03844016
041000******************************************************************03845016
041000 2100-SELECT-SUM-ACTIVITY.                                        03850011
039668     MOVE SVT00001-CRD-NBR        TO SVT00002-CRD-NBR.            03850114
                                                                        03850211
039668     EXEC SQL                                                     03850311
               SELECT SUM(APP_AUTH_AMT)                                 03850611
                 INTO :PV-AUTH-AMT                                      03850711
               FROM SVT_KOHLS_CRD_TXN                                   03850811
               WHERE CRD_NBR         = :SVT00002-CRD-NBR                03851111
030100         WITH UR                                                  03851711
030100     END-EXEC.                                                    03851911
                                                                        03852011
030100     EVALUATE TRUE                                                03852111
030100         WHEN SQLCODE = +0                                        03852211
030100             CONTINUE                                             03852311
030100         WHEN SQLCODE = +100                                      03852411
030100             MOVE +0 TO PV-AUTH-AMT                               03852515
030100                        SVT00002-CRD-NBR                          03852615
030100         WHEN SQLCODE = -305                                      03852716
030100             MOVE +0 TO PV-AUTH-AMT                               03852816
030100                        SVT00002-CRD-NBR                          03852916
030100         WHEN OTHER                                               03853016
030100             MOVE '2100-SELECT-SUM-ACTIVITY      '                03853116
030100                               TO PV-PARAGRAPH-NAME               03853216
030100             PERFORM 9985-SQL-ABEND                               03853324
030100     END-EVALUATE.                                                03853416
030100                                                                  03853516
041000******************************************************************03853616
041000*     4400-OPEN-CORP-CURSOR.                                     *03853716
041000*     OPENS THE CORP RECEIVED CURSOR                             *03853816
041000******************************************************************03854011
041000 4400-OPEN-CORP-CURSOR.                                           03855011
041000                                                                  03860000
041000     EXEC SQL                                                     03870000
041000         OPEN CORP-CSR                                            03880000
041000     END-EXEC.                                                    03890000
041000                                                                  03900000
041000     EVALUATE TRUE                                                03910000
041000         WHEN SQLCODE NOT = 0                                     03920000
041000             DISPLAY ' '                                          03930000
041000             DISPLAY '** ABEND     **' SQLCODE                    03940000
041000             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        03950000
041000             DISPLAY '** PARAGRAPH **  = 4400-OPEN-CORP-CURSOR'   03960000
041000             DISPLAY '** OPEN CURSOR TO '                         03970000
041000             DISPLAY '** SVT_KOHLS_CRD_ACCT TABLE '               03980024
041000             DISPLAY '** TO FIND THE ISSUE DATE'                  03990000
041000             PERFORM 9985-SQL-ABEND                               04000024
041000     END-EVALUATE.                                                04010000
041000                                                                  04020000
041000******************************************************************04030000
041000*     4500-FETCH-CORP-CURSOR.                                    *04040000
041000*     FETCHES THE CORP RECEIVED CURSOR                           *04050000
041000******************************************************************04060000
039602 4500-FETCH-CORP-CURSOR.                                          04070000
041000                                                                  04080000
041100     EXEC SQL                                                     04090000
041100         FETCH CORP-CSR                                           04100000
041100           INTO :SVT00001-CRD-NBR                                 04110001
041100              , :SVT00001-CRD-CLO-DTE                             04111001
                    , :SVT00001-CLO-USR-ID                              04120000
                    , :SVT00001-CRD-TYP-CDE                             04121000
                    , :SVT00000-CRD-STK-TYP-ID                          04132000
041100     END-EXEC.                                                    04140000
041100                                                                  04150000
041100     EVALUATE TRUE                                                04160000
041100     WHEN SQLCODE = +0                                            04170000
041100         CONTINUE                                                 04180000
041100     WHEN SQLCODE = +100                                          04190000
021100         SET PS-END-OF-CURSOR TO TRUE                             04200000
041100     WHEN OTHER                                                   04210000
041100         DISPLAY '** ABEND     **'                                04220000
041100         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04230000
041100         DISPLAY '** PARAGRAPH **  = 4500-FETCH-CORP-CSR'         04240000
041100         DISPLAY '** FETCH RECORD FROM '                          04250000
041100         DISPLAY '** SVT_KOHLS_CRD_ACCT TABLE'                    04260024
041100         PERFORM 9985-SQL-ABEND                                   04270024
041100     END-EVALUATE.                                                04280000
041100                                                                  04290000
041100***************************************************************** 04300000
041100*    CLOSE CORP CURSOR                                            04310000
041100***************************************************************** 04320000
041000 4600-CLOSE-CORP-CSR.                                             04330000
041100                                                                  04340000
041100     EXEC SQL                                                     04350000
041100        CLOSE CORP-CSR                                            04360000
041100     END-EXEC.                                                    04370000
041100                                                                  04380000
041100     EVALUATE TRUE                                                04390000
041100         WHEN SQLCODE NOT = 0                                     04400000
041100             DISPLAY '** ABEND     **'                            04410000
041100             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        04420000
041100             DISPLAY '** CLOSE CURSOR FOR ISSUE DATE'             04430000
041100             DISPLAY '** PARAGRAPH **  = 4600-CLOSE-CORP-CSR'     04431017
041100             PERFORM 9985-SQL-ABEND                               04440024
041100     END-EVALUATE.                                                04450000
041100                                                                  04460000
039699******************************************************************04664000
039700* 9000-EOJ-ROUTINE.                                              *04665000
039800******************************************************************04666000
039900 9000-EOJ-ROUTINE.                                                04667000
040000                                                                  04668000
040100     CLOSE DATE-CARD-FILE                                         04669000
040300           CORP-RCVD-FILE.                                        04670004
040500                                                                  04680000
076848******************************************************************04690000
076849*     9975-DATE-ROUTINE.                                         *04700000
076850* ==> PROCESSES:                                                 *04710000
076851*     -VALIDATES THE DATE INPUT ON THE CONTROL FILE              *04720000
076852* ==> PERFORMED FROM: B100-INITIALIZE                            *04730000
076853******************************************************************04740000
076854 9975-DATE-ROUTINE.                                               04750000
076855                                                                  04760000
076859     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     04800000
076860                                                                  04810000
076862     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      04830000
076863                                                                  04840000
076864     CALL DP500-KOHLS-CALENDAR-ROUTINE                            04850000
076865       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 04860000
076866                                                                  04870000
076867     EVALUATE TRUE                                                04880000
076868         WHEN DPG54-SEVERE-ERROR                                  04890000
076869         WHEN DPG54-DATE-INVALID                                  04900000
023400             MOVE '9975-DATE-ROUTINE' TO PV-PARAGRAPH-NAME        04901020
023400             MOVE DPG54-ERROR-MESSAGE TO PV-OPERATION-MSG-1       04902020
076870             SET AC-DATE-ERROR TO TRUE                            04910000
076871             PERFORM 9999-ABEND                                   04920000
076872     END-EVALUATE.                                                04930000
                                                                        04950018
076880***************************************************************** 04980500
076900*     -PERFORMS ABEND PROCESSING FOR SQL ERRORS.                  04980600
077000***************************************************************** 04980700
077100 9985-SQL-ABEND.                                                  04980824
077200                                                                  04980900
077300     DISPLAY '9985-SQL-ABEND'.                                    04981024
077400     DISPLAY '**  ABEND     **'.                                  04982000
077500     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               04983000
077600     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             04984000
077600     DISPLAY '**  SQLCODE   ** = ' SQLCODE.                       04985000
077600******************************************************************04986000
077600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *04987000
077600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *04988000
077600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *04989000
077600* FORMAT.                                                        *04990000
077600******************************************************************05000000
077600                                                                  05010000
077600     COPY DPPD004.                                                05020000
077600                                                                  05030000
077600     MOVE +4013 TO AC-ABEND-CODE.                                 05040000
077600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05050000
077600                                                                  05060000
076880******************************************************************05070000
076900* 9999-ABEND - PERFORMS A NON-SQL-ABEND                           05080000
077000******************************************************************05090000
077100 9999-ABEND.                                                      05100000
077200     DISPLAY '** ABEND           **'.                             05110000
077300     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          05120000
077400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        05130000
077500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       05140000
077600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05150000
