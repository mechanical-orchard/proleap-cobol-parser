000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000210*-----------------------*                                         00021099
000220 PROGRAM-ID.    SUKCS775.                                         00022099
000230 AUTHOR.        CHRISTINE TWIEHAUS.                               00023099
000240 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00024099
000250 DATE-WRITTEN.  NOVEMBER 2008.                                    00025099
000260 DATE-COMPILED.                                                   00026099
000270*----------------------------------------------------------------*00027099
000280*    DIRECTIVE HISTORY CRIT SPEC SCREEN                          *00028099
000290*                                                                *00029099
000300*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00030099
000400*    SUBSEQUENT PROGRAMS.  FROM THIS SCREEN THE USER CAN PRESS:  *00040099
000500*    F17 TO DISPLAY A LIST OF DIRECTIVES                         *00050099
000600*    F23 TO DISPLAY A DIRECTIVE CARTON HISTORIES                 *00060099
000700*----------------------------------------------------------------*00070099
001500*    CHANGES                                                     *00072099
      *    MADE BY: CHERI PARMLEY                                      *00073099
      *    DATE:    09/24/2014                                         *00074099
      *                                                                *00075099
      *    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00076099
      *    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/24/2014      *00077099
000700*----------------------------------------------------------------*00077199
      *    MADE BY: DAN HINTZ                                          *00078199
      *    DATE:    12/15/2014                                         *00078299
      *                                                                *00078399
      *    CHANGES IN PROGRAM TO SET THE DEFAULT DATE RANGE BEGIN AND  *00078499
      *    DATE RANGE END VALUES WHEN THE SCREEN COMES UP.  DATE RANGE *00078599
      *    END VALUE WILL BE SET TO THE CURRENT DATE AND TIME.  DATE   *00078699
      *    RANGE BEGIN VALUE WILL BE SET BY SUBTRACTING THE PARM VALUE *00078799
      *    (12 HOURS IN THIS CASE) FROM THE CURRENT DATE AND TIME.     *00078899
      *    THESE CHANGES ARE TAGGED WITH *DANH 12/15/2014.             *00078999
      *                                                                *00079099
001600*----------------------------------------------------------------*00079199
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00079399
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00079499
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00079599
001130*                                                                 00079699
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00079799
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00079899
263968*---------------------------------------------------------------* 00079999
000800 ENVIRONMENT DIVISION.                                            00080099
000900 DATA DIVISION.                                                   00090099
001000                                                                  00100099
001100 WORKING-STORAGE SECTION.                                         00110099
001200                                                                  00120099
001300 01  DK-DB2-KEYS.                                                 00130099
001400     05  DK-OPER-UNIT              PIC S9(4) COMP.                00140099
001500*    05  DK-PO-NUMBER              PIC X(09)       VALUE SPACES.  00150099
001600     05  DK-PO-NUMBER              PIC S9(9) COMP  VALUE ZERO.    00160099
001700*    05  DK-RCVR-NUMBER            PIC X(03)       VALUE SPACES.  00170099
001800     05  DK-RCVR-NUMBER            PIC S9(9) COMP  VALUE ZERO.    00180099
001801*    05  DK-LINE-NUMBER            PIC X(04)       VALUE SPACES.  00180199
001802     05  DK-LINE-NUMBER            PIC S9(4) COMP  VALUE ZERO.    00180299
001803     05  DK-AUDIT-NUMBER           PIC S9(9) COMP  VALUE ZERO.    00180399
001804     05  DK-CART-ID                PIC X(22)       VALUE SPACES.  00180499
001805     05  DK-CART-ID-PACKED         PIC S9(18) COMP-3.             00180599
001806     05  DK-PACK-ID                PIC S9(4) COMP  VALUE +0.      00180699
001807     05  DK-CASI                   PIC X(01)       VALUE SPACES.  00180799
001808     05  DK-SETCODE                PIC X(05)       VALUE SPACES.  00180899
           05  DK-DIRCODE                PIC X(05)       VALUE SPACES.  00180999
001809                                                                  00181099
001810 01  PV-PROGRAM-VARIABLES.                                        00181199
001820     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       00182099
001830                                   COMP SYNC.                     00183099
001840                                                                  00184099
001850     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0     00185099
001860                                                    COMP SYNC.    00186099
001850*DANH 12/15/2014                                                  00186199
001850     05  PV-HRS-PRIOR-DISPLAY          PIC  ZZZ9.                 00186299
001870                                                                  00187099
001880     05 PV-DEFAULT-BEG-TIMESTAMP.                                 00188099
001890         10 PV-DEFAULT-BEG-DATE        PIC  X(10).                00189099
001900         10 FILLER                     PIC  X(01)    VALUE '-'.   00190099
002000         10 PV-DEFAULT-BEG-TIME        PIC  X(08)    VALUE        00200099
002100                                                     '00:00:00'.  00210099
002200     05 PV-DEFAULT-END-TIMESTAMP.                                 00220099
002300         10 PV-DEFAULT-END-DATE        PIC  X(10).                00230099
002400         10 FILLER                     PIC  X(01)    VALUE '-'.   00240099
002500         10 PV-DEFAULT-END-TIME        PIC  X(08)    VALUE        00250099
002600                                                     '23:59:59'.  00260099
002700     05 PV-CURRENT-TIMESTAMP           PIC  X(26).                00270099
002701     05 PV-CURRENT-TIMESTAMP-PARM      PIC  X(26).                00270199
002710     05 PV-CURRENT-DB2-DATE-1DAY       PIC  X(10).                00271099
002800     05 PV-CURRENT-DB2-DATE            PIC  X(10).                00280099
002900     05 PV-CURR-DATE.                                             00290099
003000         10 PV-CURRENT-DB2-CCYY.                                  00300099
003100            15 PV-CURRENT-DB2-CC       PIC  9(02)    VALUE 0.     00310099
003200            15 PV-CURRENT-DB2-YY       PIC  9(02)    VALUE 0.     00320099
003300         10 FILLER                     PIC  X(01)    VALUE '-'.   00330099
003400         10 PV-CURRENT-DB2-MM          PIC  9(02)    VALUE 0.     00340099
003500         10 FILLER                     PIC  X(01)    VALUE '-'.   00350099
003600         10 PV-CURRENT-DB2-DD          PIC  9(02)    VALUE 0.     00360099
003700         10 FILLER                     PIC  X(01)    VALUE '-'.   00370099
003710     05 PV-END-DATE.                                              00371099
003720         10 PV-END-DATE-CCYY.                                     00372099
003730            15 PV-END-DATE-CC          PIC  9(02)    VALUE 0.     00373099
003740            15 PV-END0-DATE-YY         PIC  9(02)    VALUE 0.     00374099
003750         10 FILLER                     PIC  X(01)    VALUE '-'.   00375099
003760         10 PV-END-DB2-MM              PIC  9(02)    VALUE 0.     00376099
003770         10 FILLER                     PIC  X(01)    VALUE '-'.   00377099
003780         10 PV-END-DB2-DD              PIC  9(02)    VALUE 0.     00378099
003790         10 FILLER                     PIC  X(01)    VALUE '-'.   00379099
003800     05 PV-CURRENT-DATE.                                          00380099
003900         10 PV-CURRENT-CCYY.                                      00390099
004000            15 PV-CURRENT-CC           PIC  9(02)    VALUE 0.     00400099
004100            15 PV-CURRENT-YY           PIC  9(02)    VALUE 0.     00410099
004200         10 PV-CURRENT-MM              PIC  9(02)    VALUE 0.     00420099
004300         10 PV-CURRENT-DD              PIC  9(02)    VALUE 0.     00430099
004400     05 PV-CURRENT-CCYYMMDD-DATE.                                 00440099
004500         10 PV-CURRENT-CCYYMMDD-CC     PIC  9(02)    VALUE 0.     00450099
004600         10 PV-CURRENT-CCYYMMDD-YY     PIC  9(02)    VALUE 0.     00460099
004700         10 FILLER                     PIC  X(01)    VALUE '-'.   00470099
004800         10 PV-CURRENT-YYMMDD-MM       PIC  9(02)    VALUE 0.     00480099
004900         10 FILLER                     PIC  X(01)    VALUE '-'.   00490099
005000         10 PV-CURRENT-YYMMDD-DD       PIC  9(02)    VALUE 0.     00500099
005100         10 FILLER                     PIC  X(01)    VALUE '-'.   00510099
005200                                                                  00520099
005300     05  PV-TO-DATE-HOLD.                                         00530099
005400         10 PV-TO-DATE-HOLD-CCYYMMDD.                             00540099
005500             15  PV-TO-CCYY        PIC  9(04)  VALUE ZEROES.      00550099
005700             15  PV-TO-MM          PIC  9(02)  VALUE ZEROES.      00570099
005800             15  PV-TO-DD          PIC  9(02)  VALUE ZEROES.      00580099
005900         10  PV-TO-HH              PIC  9(02)  VALUE ZEROES.      00590099
006000         10  PV-TO-MN              PIC  9(02)  VALUE ZEROES.      00600099
006100         10  PV-TO-SS              PIC  9(02)  VALUE ZEROES.      00610099
006200                                                                  00620099
006300     05  PV-FROM-DATE-HOLD.                                       00630099
006400         10 PV-FROM-DATE-HOLD-CCYYMMDD.                           00640099
006500             15  PV-FROM-CCYY      PIC  9(04)  VALUE ZEROES.      00650099
006700             15  PV-FROM-MM        PIC  9(02)  VALUE ZEROES.      00670099
006800             15  PV-FROM-DD        PIC  9(02)  VALUE ZEROES.      00680099
006900         10  PV-FROM-HH            PIC  9(02)  VALUE ZEROES.      00690099
007000         10  PV-FROM-MN            PIC  9(02)  VALUE ZEROES.      00700099
007100         10  PV-FROM-SS            PIC  9(02)  VALUE ZEROES.      00710099
007101                                                                  00710199
007102     05  PV-DAYS-DIFF              PIC S9(07)  VALUE ZEROES.      00710299
007103     05  PV-DAYS-HRS-CONV          PIC S9(07)  VALUE ZEROES.      00710399
007104     05  PV-HOURS-DIFF             PIC S9(07)  VALUE ZEROES.      00710499
007105     05  PV-FROM-JULIAN            PIC  9(07)  VALUE ZEROES.      00710599
007106     05  PV-TO-JULIAN              PIC  9(07)  VALUE ZEROES.      00710699
007107                                                                  00710799
007108     05  PV-TO-TMST-CALC.                                         00710899
007109         10  PV-CALC-TO-CCYY       PIC  9(04)  VALUE ZEROES.      00710999
007110         10  PV-CALC-TO-DASH-1     PIC  X(01)  VALUE SPACE.       00711099
007111         10  PV-CALC-TO-MM         PIC  9(02)  VALUE ZEROES.      00711199
007112         10  PV-CALC-TO-DASH-2     PIC  X(01)  VALUE SPACE.       00711299
007113         10  PV-CALC-TO-DD         PIC  9(02)  VALUE ZEROES.      00711399
007114         10  PV-CALC-TO-DASH-3     PIC  X(01)  VALUE SPACE.       00711499
007115         10  PV-CALC-TO-HH         PIC  9(02)  VALUE ZEROES.      00711599
007116         10  PV-CALC-TO-DECM-1     PIC  X(01)  VALUE SPACE.       00711699
007117         10  PV-CALC-TO-MN         PIC  9(02)  VALUE ZEROES.      00711799
007118         10  PV-CALC-TO-DECM-2     PIC  X(01)  VALUE SPACE.       00711899
007119         10  PV-CALC-TO-SS         PIC  9(02)  VALUE ZEROES.      00711999
007120         10  PV-CALC-TO-DECM-3     PIC  X(01)  VALUE SPACE.       00712099
007121         10  PV-CALC-TO-MS         PIC  9(06)  VALUE ZEROES.      00712199
007122                                                                  00712299
007123     05  PV-FROM-TMST-CALC.                                       00712399
007124         10  PV-CALC-FR-CCYY       PIC  9(04)  VALUE ZEROES.      00712499
007125         10  PV-CALC-FR-DASH-1     PIC  X(01)  VALUE SPACE.       00712599
007126         10  PV-CALC-FR-MM         PIC  9(02)  VALUE ZEROES.      00712699
007127         10  PV-CALC-FR-DASH-2     PIC  X(01)  VALUE SPACE.       00712799
007128         10  PV-CALC-FR-DD         PIC  9(02)  VALUE ZEROES.      00712899
007129         10  PV-CALC-FR-DASH-3     PIC  X(01)  VALUE SPACE.       00712999
007130         10  PV-CALC-FR-HH         PIC  9(02)  VALUE ZEROES.      00713099
007131         10  PV-CALC-FR-DECM-1     PIC  X(01)  VALUE SPACE.       00713199
007132         10  PV-CALC-FR-MN         PIC  9(02)  VALUE ZEROES.      00713299
007133         10  PV-CALC-FR-DECM-2     PIC  X(01)  VALUE SPACE.       00713399
007134         10  PV-CALC-FR-SS         PIC  9(02)  VALUE ZEROES.      00713499
007135         10  PV-CALC-FR-DECM-3     PIC  X(01)  VALUE SPACE.       00713599
007136         10  PV-CALC-FR-MS         PIC  9(06)  VALUE ZEROES.      00713699
007137                                                                  00713799
007138 01  PC-PROGRAM-CONSTANTS.                                        00713899
007139     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SUK775'.   00713999
007140     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM775'.  00714099
007141     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS775'. 00714199
007142     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE  'DPKUT100'. 00714299
007143     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE  'SUKCS775'. 00714399
007144     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE  'DPKUT500'. 00714499
007145     05  PC-01                     PIC  X(02)  VALUE  '01'.       00714599
007146     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       00714699
007147     05  PC-A                      PIC  X(01)  VALUE  'A'.        00714799
007148     05  PC-D                      PIC  X(01)  VALUE  'D'.        00714899
007149     05  PC-N                      PIC  X(01)  VALUE  'N'.        00714999
007150     05  PC-U                      PIC  X(01)  VALUE  'U'.        00715099
007151     05  PC-Y                      PIC  X(01)  VALUE  'Y'.        00715199
007152     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3.           00715299
007153     05  PC-MULTIPLE-SKU-PPK       PIC  X(21)  VALUE              00715399
007154         'M - MULTI SKU PREPACK'.                                 00715499
007155     05  PC-SINGLE-SKU-PPK         PIC  X(22)  VALUE              00715599
007156         'S - SINGLE SKU PREPACK'.                                00715699
007157     05  PC-INNER-PPK              PIC  X(17)  VALUE              00715799
007158         'I - INNER PREPACK'.                                     00715899
007159     05  PC-BULK-PPK               PIC  X(13)  VALUE              00715999
007160         'B - BULK PACK'.                                         00716099
007161     05  PC-CASEPACK               PIC  X(12)  VALUE              00716199
007162         'C - CASEPACK'.                                          00716299
007163     05  PC-PBS                    PIC  X(13)  VALUE              00716399
007164         'PACK BY STORE'.                                         00716499
007165                                                                  00716599
007166                                                                  00716699
007167                                                                  00716799
007168*                                                                 00716899
007169 01  PS-PROGRAM-SWITCHES.                                         00716999
007170     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00717099
007171         88  PS-ERROR                          VALUE  'Y'.        00717199
007172         88  PS-NO-ERROR                       VALUE  'N'.        00717299
007173     05  PS-PACK-ID-EXISTS-SW      PIC  X(01)  VALUE  'N'.        00717399
007174         88  PS-PACK-ID-EXISTS                 VALUE  'Y'.        00717499
007175         88  PS-PACK-ID-DOESNTSAVEST           VALUE  'N'.        00717599
007176     05  PS-LINE-NO-EXISTS-SW      PIC  X(01)  VALUE  'N'.        00717699
007177         88  PS-LINE-NO-EXISTS                 VALUE  'Y'.        00717799
007178         88  PS-LINE-NO-DOESNT-EXIST           VALUE  'N'.        00717899
007179     05  PS-VALID-SELECT-CRIT-SW   PIC  X(01)  VALUE  'N'.        00717999
007180         88  PS-VALID-SELECT-CRIT-YES          VALUE  'Y'.        00718099
007181         88  PS-VALID-SELECT-CRIT-NO           VALUE  'N'.        00718199
007182                                                                  00718299
007183     05  PS-PKGNG-CD                 PIC  X(01).                  00718399
007184         88  PS-PRE-PACK-ORDER            VALUE 'I', 'M'.         00718499
007185         88  PS-INNER-PREPK                    VALUE 'I'.         00718599
007186         88  PS-MULTI-SKU-PREPK                VALUE 'M'.         00718699
007187         88  PS-SINGLE-SKU-PREPK               VALUE 'S'.         00718799
007188         88  PS-CASEPACK                       VALUE 'C'.         00718899
007189         88  PS-BULK-PACK                      VALUE 'B'.         00718999
007190         88  PS-PBS                            VALUE ' '.         00719099
007191                                                                  00719199
007192*----------------------------------------------------------------*00719299
007193*  SYSTEM MESSAGES                                               *00719399
007194*----------------------------------------------------------------*00719499
007195*   00005 - INVALID VALUE                                         00719599
007196*   00007 - REQUIRED ENTRY                                        00719699
007197*   00008 - MUST BE NUMERIC                                       00719799
007198*   00009 - INVALID DATE/TIME                                     00719899
007199*   01298 - RECEIVER NOT FOUND                                    00719999
007200*   01729 - LINE NUMBER DOES NOT EXIST FOR PO/RCVR                00720099
007201*   02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION    00720199
007202*   02698 - FROM FROM DATE NOT BEFORE END DATE                    00720299
007203*   02918 - AUDIT NUMBER NOT FOUND                                00720399
007204*   03638 - PRE-PACK DOES NOT EXIST FOR PO/RCVR                   00720499
007205*   03640 - RECEIVER TYPE IS PRE-PACK ENTER PO/RCVR OR PO/RCVR/LNE00720599
007206*   03641 - RECEIVER TYPE IS PACK-BY-STORE, PLEASE ENTER PO/RCVR  00720699
007207*   03642 - RECEIVER TYPE IS BULKCASE ENTER PO/RCVR OR PO/RCVR/LNE00720799
007208*   03649 - SET CODE NAME NOT FOUND                               00720899
007209*   03651 - MUST SUPPLY VALID CRITERIA CONBINATIONS TO CONTINUE   00720999
007210*   03652 - CASI CODE INVALID MUST BE Q, U, %, OR R               00721099
007211*   03658 - CARTON ID NOT FOUND                                   00721199
007212*   03659 - PO NOT FOUND                                          00721299
007213*   03670 - PO NOT FOUND                                          00721399
      *   03720 - DIRECTIVE REASON CODE NOT FOUND                       00721499
007214*----------------------------------------------------------------*00721599
007215 01  PC-TSYMSG-NUMBERS.                                           00721699
007216     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00721799
007217     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00721899
007218     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00721999
007220     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          00722099
007300     05  PC-TSYMSG-01298       PIC  9(05)  VALUE  01298.          00730001
007400     05  PC-TSYMSG-01729       PIC  9(05)  VALUE  01729.          00740001
007500     05  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.          00750001
007600     05  PC-TSYMSG-02698       PIC  9(05)  VALUE  02698.          00760001
007610     05  PC-TSYMSG-02918       PIC  9(05)  VALUE  02918.          00761099
007700     05  PC-TSYMSG-03638       PIC  9(05)  VALUE  03638.          00770001
007701     05  PC-TSYMSG-03640       PIC  9(05)  VALUE  03640.          00770199
007702     05  PC-TSYMSG-03641       PIC  9(05)  VALUE  03641.          00770201
007703     05  PC-TSYMSG-03642       PIC  9(05)  VALUE  03642.          00770301
007704     05  PC-TSYMSG-03649       PIC  9(05)  VALUE  03649.          00770401
007705     05  PC-TSYMSG-03651       PIC  9(05)  VALUE  03651.          00770501
007706     05  PC-TSYMSG-03652       PIC  9(05)  VALUE  03652.          00770601
007707     05  PC-TSYMSG-03658       PIC  9(05)  VALUE  03658.          00770701
007708     05  PC-TSYMSG-03659       PIC  9(05)  VALUE  03659.          00770801
007709     05  PC-TSYMSG-03670       PIC  9(05)  VALUE  03670.          00770999
007709     05  PC-TSYMSG-03720       PIC  9(05)  VALUE  03720.          00771099
007800*                                                                 00780001
007900 01  PM-PROGRAM-MESSAGES.                                         00790001
008000     05  PM-ABEND-INFO-A.                                         00800001
008100         10  FILLER                PIC X(15)   VALUE              00810001
008200                                   'DP020-SRC-AID: '.             00820001
008300         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00830001
008400         10  FILLER                PIC X(19)   VALUE              00840001
008500                                   '. DP020-FK-ACTION: '.         00850001
008600         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00860001
008700         10  FILLER                PIC X(22)   VALUE              00870001
008800                                   '. DP020-FK-DISPN-IND: '.      00880001
008900         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00890001
009000         10  FILLER                PIC X(01)   VALUE '.'.         00900001
009100         10  FILLER                PIC X(19)   VALUE SPACE.       00910001
009200                                                                  00920001
009300*----------------------------------------------------------------*00930001
009400*    MAP LAYOUT                                                  *00940001
009500*----------------------------------------------------------------*00950001
009600     COPY SUKM775.                                                00960001
010200                                                                  01020001
010201*----------------------------------------------------------------*01020199
010202*    CALENDAR ROUTINE                                            *01020201
010203*----------------------------------------------------------------*01020301
010204     COPY DPWS500.                                                01020401
010205                                                                  01020501
010206*----------------------------------------------------------------*01020601
010207*    ATTRIBUTE SETTINGS COPYBOOK.                                *01020701
010208*----------------------------------------------------------------*01020801
010209     COPY DPWS015.                                                01020901
010210                                                                  01021001
010300*----------------------------------------------------------------*01030001
010400*    FUNCTION KEYS COPYBOOK                                      *01040001
010500*----------------------------------------------------------------*01050001
010600     COPY DPWS016.                                                01060001
010700                                                                  01070001
010800******************************************************************01080001
010900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01090001
011000** SUB-ROUTINE (DPKUT100).                                      **01100001
011100******************************************************************01110001
011200     COPY DPWS010I.                                               01120001
011300                                                                  01130001
011400******************************************************************01140001
011600** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **01160099
011700******************************************************************01170001
011800     COPY DPWS030.                                                01180001
011800     COPY DPWS930.                                                01181099
011900                                                                  01190001
012000***************************************************************** 01200001
012100*    STANDARD COMMAREA.                                           01210001
012200***************************************************************** 01220001
012300     COPY DPWS020.                                                01230001
012500                                                                  01250001
012501     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01250199
012502                                                                  01250201
012600***************************************************************** 01260001
012700*    INTER-APPLICATION COMMAREA.                                  01270001
012800***************************************************************** 01280001
012900*        10  INTER-APPL-COMM-AREA PIC X(3065).                    01290001
012910         10  INTER-APPL-COMM-AREA PIC X(200).                     01291099
013000     COPY SUWS100.                                                01300003
013100                                                                  01310001
013200***************************************************************** 01320001
013300*    SPECIFIC COMMAREA FOR SUKCS775.                              01330001
013400***************************************************************** 01340001
013500         10  ASC-SPECIFIC-COMMAREA.                               01350003
013700             15  ASC-OPER-UNIT           PIC  X(04).              01370003
013710             15  ASC-OPER-UNIT-N   REDEFINES ASC-OPER-UNIT        01371003
013720                                             PIC  9(04).          01372003
      *CLP 09/24/2014                                                   01373099
013800             15  ASC-PO-NUMBER               PIC  X(08).          01380099
013801             15  ASC-PO-NUMBER-N   REDEFINES ASC-PO-NUMBER        01380199
013802                                             PIC  9(08).          01380299
013803             15  ASC-PO-NUMBER-9   REDEFINES ASC-PO-NUMBER-N.     01380303
013804                 20  ASC-PO-NUMBER-8         PIC  X(08).          01380499
013900             15  ASC-OPER-UNIT-NAME          PIC  X(25).          01390003
013901             15  ASC-FUNCTION                PIC  X(01).          01390103
013910             15  ASC-RCVR-NUMBER             PIC  X(04).          01391003
014000             15  ASC-RCVR-NUMBER-N REDEFINES ASC-RCVR-NUMBER      01400003
014100                                             PIC  9(04).          01410003
014200             15  ASC-PACK-TYPE               PIC  X(14).          01420003
015200             15  ASC-LINE-NO                 PIC  X(04).          01520003
015201             15  ASC-LINE-NO-N     REDEFINES ASC-LINE-NO          01520199
015202                                             PIC  9(04).          01520203
015300             15  ASC-PACK-ID                 PIC  X(04).          01530003
015301             15  ASC-PACK-ID-N     REDEFINES ASC-PACK-ID          01530199
015302                                             PIC  9(04).          01530203
015400             15  ASC-AUDIT-NUMBER            PIC  X(09).          01540003
015401             15  ASC-AUDIT-NUMBER-N REDEFINES ASC-AUDIT-NUMBER    01540199
015402                                             PIC  9(09).          01540203
015500             15  ASC-CART-ID                 PIC  X(22).          01550003
015501             15  ASC-CART-ID-N REDEFINES ASC-CART-ID.             01550199
015502                 20  ASC-CART-ID-P           PIC  9(18).          01550203
015503                 20  FILLER                  PIC  9(04).          01550303
015600             15  ASC-CASI                    PIC  X(01).          01560003
                   15  ASC-DIRCODE                 PIC  X(03).          01561099
015700             15  ASC-SETCODE                 PIC  X(05).          01570003
015800             15  ASC-SET-YEAR                PIC  X(04).          01580003
015801             15  ASC-DATE-START.                                  01580199
015802                 20  ASC-START-CCYY      PIC  X(04).              01580299
015804                 20  ASC-START-HYP1      PIC  X(01).              01580499
015805                 20  ASC-START-MM        PIC  X(02).              01580599
015806                 20  ASC-START-MM-R REDEFINES ASC-START-MM.       01580699
015807                     25  ASC-START-MM-NUM  PIC 9(02).             01580799
015808                 20  ASC-START-HYP2      PIC  X(01).              01580899
015809                 20  ASC-START-DD        PIC  X(02).              01580999
015810                 20  ASC-START-DD-R REDEFINES ASC-START-DD.       01581099
015811                     25  ASC-START-DD-NUM  PIC 9(02).             01581199
015812                 20  ASC-START-SPACE     PIC  X(01).              01581299
015813                 20  ASC-START-HH        PIC  X(02).              01581399
015814                 20  ASC-START-HH-R REDEFINES ASC-START-HH.       01581499
015815                     25  ASC-START-HH-NUM  PIC 9(02).             01581599
015816                 20  ASC-START-COL1      PIC  X(01).              01581699
015817                 20  ASC-START-MN        PIC  X(02).              01581799
015818                 20  ASC-START-MN-R REDEFINES ASC-START-MN.       01581899
015819                     25  ASC-START-MN-NUM  PIC 9(02).             01581999
015820                 20  ASC-START-COL2      PIC  X(01).              01582099
015821                 20  ASC-START-SS        PIC  X(02).              01582199
015822                 20  ASC-START-SS-R REDEFINES ASC-START-SS.       01582299
015823                     25  ASC-START-SS-NUM  PIC 9(02).             01582399
015824             15  ASC-DATE-END.                                    01582499
015825                 20  ASC-END-CCYY        PIC  X(04).              01582599
015826                 20  ASC-END-HYP1        PIC  X(01).              01582699
015827                 20  ASC-END-MM          PIC  X(02).              01582799
015828                 20  ASC-END-MM-R REDEFINES ASC-END-MM.           01582899
015829                     25  ASC-END-MM-NUM  PIC 9(02).               01582999
015830                 20  ASC-END-HYP2        PIC  X(01).              01583099
015831                 20  ASC-END-DD          PIC  X(02).              01583199
015832                 20  ASC-END-DD-R REDEFINES ASC-END-DD.           01583299
015833                     25  ASC-END-DD-NUM  PIC 9(02).               01583399
015834                 20  ASC-END-SPACE       PIC  X(01).              01583499
015835                 20  ASC-END-HH          PIC  X(02).              01583599
015836                 20  ASC-END-HH-R REDEFINES ASC-END-HH.           01583699
015837                     25  ASC-END-HH-NUM  PIC 9(02).               01583799
015838                 20  ASC-END-COL1        PIC  X(01).              01583899
015839                 20  ASC-END-MN          PIC  X(02).              01583999
015840                 20  ASC-END-MN-R REDEFINES ASC-END-MN.           01584099
015841                     25  ASC-END-MN-NUM  PIC 9(02).               01584199
015842                 20  ASC-END-COL2        PIC  X(01).              01584299
015843                 20  ASC-END-SS          PIC  X(02).              01584399
015850                 20  ASC-END-SS-R REDEFINES ASC-END-SS.           01585099
015860                     25  ASC-END-SS-NUM  PIC 9(02).               01586099
016160             15  ASC-CURSOR-SW           PIC  X(03).              01616099
016170                 88  ASC-NO-CURSOR                   VALUE 'Z  '. 01617099
016180                 88  ASC-OPER-UNIT-PO-C1             VALUE 'PO1'. 01618099
016190                 88  ASC-OPER-UNIT-PO-R-C1           VALUE 'RV1'. 01619099
016200                 88  ASC-OPER-UNIT-PO-R-LINE-C1      VALUE 'LN1'. 01620099
016300                 88  ASC-OPER-UNIT-PO-R-PACK-C1      VALUE 'PK1'. 01630099
016400                 88  ASC-AUDIT-CONTROL-NO-C1         VALUE 'AU1'. 01640099
016500                 88  ASC-CARTON-ID-C1                VALUE 'CA1'. 01650099
016600                 88  ASC-OPER-UNIT-DATE-C1           VALUE 'DT1'. 01660099
016700                 88  ASC-OPER-UNIT-CASI-DATE-C1      VALUE 'CS1'. 01670099
016701                 88  ASC-OPER-UNIT-SETCODE-YR-C1     VALUE 'SC1'. 01670199
                       88  ASC-DIRECTIVE-RSN-CODE-C1       VALUE 'DC1'. 01670299
016702             15  FILLER                      PIC  X(58).          01670303
016703                                                                  01670401
016704*----------------------------------------------------------------*01670501
016705*    ABEND PROCESSING COPYBOOK.                                  *01670601
016706*----------------------------------------------------------------*01670701
016707     COPY DPWS013.                                                01670801
016708                                                                  01670901
016709*----------------------------------------------------------------*01671001
016800*    DB2 TABLE FOR TRECEIV - RC-RECEIVER - LRECL = 206            01680004
016900*----------------------------------------------------------------*01690004
017000     EXEC SQL                                                     01700004
017100          INCLUDE TRECEIV                                         01710004
017200     END-EXEC.                                                    01720004
017210                                                                  01721004
017211*----------------------------------------------------------------*01721199
017212*    DB2 TABLE FOR TRECITM - RC-RECEIPT ITEM LRECL = 300          01721204
017213*----------------------------------------------------------------*01721304
017214     EXEC SQL                                                     01721404
017215          INCLUDE TRECITM                                         01721504
017216     END-EXEC.                                                    01721604
017217                                                                  01721704
017218*----------------------------------------------------------------*01721801
017219*    DB2 TABLE FOR TSEASET - PO-SEASONAL SET LRECL = 92           01721904
017220*----------------------------------------------------------------*01722004
017221     EXEC SQL                                                     01722104
017222          INCLUDE TSEASET                                         01722204
017223     END-EXEC.                                                    01722304
017224                                                                  01722404
017300*---------------------------------------------------------------**01730001
017400*    SUT_CART_DIRV_TRKG - SU - CARTON DIRECTIVE TRACKING        * 01740001
017500*                         LRECL=165                             **01750001
017600*---------------------------------------------------------------* 01760001
017700     EXEC SQL                                                     01770004
017800          INCLUDE SUT00102                                        01780001
017900     END-EXEC.                                                    01790001
018000                                                                  01800001
018001*---------------------------------------------------------------**01800199
018002*    DB2 DCLGEN FOR THE PO AUDIT REQUEST TABLE(SUT_PO_AUD_REQ)  * 01800201
018003*                         LRECL=165                             **01800301
018004*---------------------------------------------------------------* 01800401
018005     EXEC SQL                                                     01800504
018006          INCLUDE SUT00015                                        01800601
018007     END-EXEC.                                                    01800701
018008                                                                  01800801
018009*---------------------------------------------------------------**01800901
018010*    PO-PURCHASE TABLE                                            01801001
018011*                         LRECL=390                             **01801101
018012*---------------------------------------------------------------* 01801201
018013     EXEC SQL                                                     01801304
018014          INCLUDE TPURCHS                                         01801401
018015     END-EXEC.                                                    01801501
018016                                                                  01801601
018017*---------------------------------------------------------------**01801701
018018*    SU-SHIPPING UNIT AUDIT                                       01801801
018019*                         LRECL=64                              **01801901
018020*---------------------------------------------------------------* 01802001
018021     EXEC SQL                                                     01802104
018022          INCLUDE TSUNAUD                                         01802201
018023     END-EXEC.                                                    01802301
018024                                                                  01802401
018025                                                                  01802501
018026*---------------------------------------------------------------**01802699
018027*    PARM TABLE                                                   01802799
018029*---------------------------------------------------------------* 01802999
018030     EXEC SQL                                                     01803099
018031          INCLUDE TKRPRPM                                         01803199
018032     END-EXEC.                                                    01803299
018033                                                                  01803399
      *-------------------------------------------------------          01803499
      *    COMMUNICATION AREAS FOR REASON CODE TABLE                    01803599
      *-------------------------------------------------------          01803699
           EXEC SQL                                                     01803799
               INCLUDE SUT00101                                         01803899
           END-EXEC.                                                    01803999
018034                                                                  01804099
018035*-------------------------------------------------------          01804199
018036*    COMMAREA USED TO CALL XLKUT071                               01804299
018037*-------------------------------------------------------          01804399
018038     COPY XLWS071.                                                01804499
018040                                                                  01805001
018500*----------------------------------------------------------------*01850001
018600*  COMMUNICATION AREAS FOR DB2                                    01860001
018700*----------------------------------------------------------------*01870001
018800     EXEC SQL                                                     01880001
018900         INCLUDE SQLCA                                            01890001
019000     END-EXEC.                                                    01900001
019100                                                                  01910001
019200*----------------------------------------------------------------*01920001
019300 LINKAGE SECTION.                                                 01930001
019400                                                                  01940001
019500 01  DFHCOMMAREA.                                                 01950001
019600     05  FILLER                         OCCURS  1 TO 4072 TIMES   01960001
019700                                        DEPENDING ON EIBCALEN.    01970001
019800         10  FILLER                     PIC X.                    01980001
019900                                                                  01990001
020000                                                                  02000001
020100 PROCEDURE DIVISION.                                              02010001
020200***************************************************************** 02020001
020300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02030001
020400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02040001
020500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02050001
020600**                                                             ** 02060001
020700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02070001
020800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02080001
020900***************************************************************** 02090001
021000 0000-MAIN-MODULE.                                                02100001
021100     INITIALIZE DP030-CICS-API-FIELDS.                            02110001
021200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02120001
021300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02130001
021400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02140001
021500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02150001
021600     MOVE LENGTH OF SUK775I        TO DP030-MAP-LENGTH (1).       02160001
021700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02170001
021800     PERFORM 0001-CALL-CICS-ARCH-API.                             02180001
021900*                                                                 02190001
022000     PERFORM 1000-CONTROL-PROCESSING                              02200001
022100*                                                                 02210001
022200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02220001
022300     PERFORM 0001-CALL-CICS-ARCH-API.                             02230001
022400                                                                  02240001
022500*---------------------------------------------------------------- 02250001
022600 0001-CALL-CICS-ARCH-API.                                         02260001
022700*    CALL 'DPKCS030' USING DFHEIBLK                               02270099
022700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02271099
022800                           DFHCOMMAREA                            02280001
022900                           DP030-CICS-API-FIELDS                  02290001
023000                           DP020-STANDARD-COMMAREA                02300001
023100                           SUK775I.                               02310001
023200*                                                                 02320001
023300     IF  DP030-RC-CALL-SUCCESSFUL                                 02330001
023400         CONTINUE                                                 02340001
023500     ELSE                                                         02350001
023600         SET DP013-NO-ROLLBACK                                    02360001
023700             DP013-XCTL-DISPLAY-RESTART                           02370001
023800             DP013-CICS-ABEND      TO TRUE                        02380001
023900         MOVE 'BEFORE 0000-MAIN-MODULE'                           02390001
024000                                   TO DP013-PARAGRAPH             02400001
024100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX02410099
024200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      02420099
024100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02421099
024200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02422099
024300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      02430001
024400         PERFORM DP013-0000-PROCESS-ABEND                         02440001
024500     END-IF.                                                      02450001
024600                                                                  02460001
024700*----------------------------------------------------------------*02470001
024800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02480001
024900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02490001
025000*----------------------------------------------------------------*02500001
025100 1000-CONTROL-PROCESSING.                                         02510001
025200                                                                  02520001
025300     EVALUATE TRUE                                                02530001
025400         WHEN DP020-NEXT-ACT-INITIAL                              02540001
025500             INITIALIZE ASC-SPECIFIC-COMMAREA                     02550001
025501             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNIT             02550199
025502                                                                  02550201
025800             PERFORM 4000-BUILD-INITIAL-PANEL                     02580001
025900             PERFORM 3200-RESET-ATTRIBUTES                        02590001
026000                                                                  02600001
026100         WHEN DP020-NEXT-ACT-RETURN                               02610001
026200             INITIALIZE ASC-SPECIFIC-COMMAREA                     02620099
026201             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNIT             02620199
026202             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02620201
026203                                                                  02620301
001850*DANH 12/15/2014                                                  02620499
026204             PERFORM 3065-CALC-BETWEEN-DATES                      02620599
026204             PERFORM 2001-GET-DATES                               02620699
026300             PERFORM 3200-RESET-ATTRIBUTES                        02630001
026400                                                                  02640001
026500         WHEN DP020-NEXT-ACT-READ-MAP                             02650001
026510*            MOVE DP020-LOCATION-NBR TO ASC-OPER-UNIT             02651099
026600             PERFORM 2000-FKEY-PROCESSING                         02660001
026700                                                                  02670001
026800         WHEN OTHER                                               02680001
026900             SET DP013-LOGIC-ABEND                                02690001
027000                 DP013-NO-ROLLBACK TO TRUE                        02700001
027100             MOVE 'SUKCS775 - 1000-CONTROL-PROCESSING'            02710001
027200                                   TO  DP013-PARAGRAPH            02720001
027300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02730001
027400                                   TO  DP013-MESSAGE-TEXT(1)      02740001
027500             MOVE DP020-NEXT-APPL-ACTIVITY                        02750001
027600                                   TO DP013-MESSAGE-TEXT(2)       02760001
027700             PERFORM DP013-0000-PROCESS-ABEND                     02770001
027800     END-EVALUATE.                                                02780001
027900                                                                  02790001
028000*----------------------------------------------------------------*02800001
028100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02810001
028200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02820001
028300* EDITS.                                                         *02830001
028400*----------------------------------------------------------------*02840001
028500 2000-FKEY-PROCESSING.                                            02850001
028600                                                                  02860001
028700     EVALUATE TRUE                                                02870001
028800                                                                  02880001
028900         WHEN DP020-SRC-AID = DP016-CLEAR                         02890001
031400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03140001
031401             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03140199
031402             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03140201
031403                                                                  03140301
031404*F5-REFRESH                                                       03140401
031405         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03140501
031406             INITIALIZE ASC-SPECIFIC-COMMAREA                     03140601
031407             MOVE SPACES      TO APORDERO                         03140701
031408                                 ARCVSEQO                         03140803
031409                                 ALINENOO                         03140903
031410                                 APACKIDO                         03141003
031411                                 ARCVPTYO                         03141103
031412                                 AAUDNUMO                         03141203
031413                                 ACARTIDO                         03141303
031414                                 AOCASIO                          03141403
                                       ADIRCDEO                         03141599
031415                                 ASETCDEO                         03141603
031416                                 ARCVPTYO                         03141703
031417             MOVE DP020-LOCATION-NBR TO ASC-OPER-UNIT             03141899
001850*DANH 12/15/2014                                                  03141999
031418             PERFORM 3065-CALC-BETWEEN-DATES                      03142099
031418             PERFORM 2001-GET-DATES                               03142199
031419             MOVE PV-DEFAULT-BEG-TIMESTAMP TO ADRBYRO             03142299
031421**           MOVE PV-DEFAULT-END-TIMESTAMP TO ADRENDO             03142399
031422                                                                  03142499
031423             PERFORM 4000-BUILD-INITIAL-PANEL                     03142599
031424             PERFORM 3200-RESET-ATTRIBUTES                        03142699
031425                                                                  03142799
031426         WHEN OTHER                                               03142899
031492                                                                  03149201
031493             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03149301
031500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03150001
031600             IF  PS-NO-ERROR                                      03160001
031700                 SET DP030-CONTINUE-GO TO TRUE                    03170001
031800                 PERFORM 2100-CHECK-FUNCTION-KEY                  03180001
031900                 IF  PS-ERROR                                     03190001
032000                     SET DP030-OVERRIDE-GO TO TRUE                03200001
032100                 END-IF                                           03210001
032200             ELSE                                                 03220001
032300                 SET DP030-OVERRIDE-GO TO TRUE                    03230001
032400             END-IF                                               03240001
032500     END-EVALUATE.                                                03250001
032600                                                                  03260001
032700******************************************************************03270001
033000** G E T    C U R R E N T   D A T E   AND   Y E S T E R D A Y   **03300001
033010*  POPULATING ADRBYRO AND ADRENDO                                 03301099
033100******************************************************************03310001
033200 2001-GET-DATES.                                                  03320001
033300                                                                  03330099
001850*DANH 12/15/2014                                                  03340099
033710     EXEC SQL                                                     03371099
033720        SET :PV-CURRENT-TIMESTAMP      = CURRENT TIMESTAMP        03372099
033730           ,:PV-CURRENT-TIMESTAMP-PARM = CURRENT TIMESTAMP        03373099
033731                                         - :KRPRPM-FUNC-QTY HOURS 03373199
033740     END-EXEC                                                     03374099
033800                                                                  03380099
033900     EVALUATE TRUE                                                03390099
034000         WHEN SQLCODE = ZERO                                      03400099
034001           MOVE PV-CURRENT-TIMESTAMP-PARM TO  ASC-DATE-START      03400299
034002           MOVE PV-CURRENT-TIMESTAMP      TO  ASC-DATE-END        03400399
034008                                                                  03400899
034009           MOVE ASC-START-CCYY           TO ADRBYRO               03400999
034010           MOVE ASC-START-MM             TO ADRBMTO               03401099
034011           MOVE ASC-START-DD             TO ADATFDYO              03401199
034012           MOVE ASC-START-HH             TO ADATFHHO              03401299
034013           MOVE ASC-START-MN             TO ADATFMMO              03401399
034014                                                                  03401499
034015           MOVE ASC-END-CCYY             TO ADRENDO               03401599
034016           MOVE ASC-END-MM               TO ADREMTO               03401699
034017           MOVE ASC-END-DD               TO ADATEDYO              03401799
034018           MOVE ASC-END-HH               TO ADATEHHO              03401899
034019           MOVE ASC-END-MN               TO ADATEMMO              03401999
037500                                                                  03750099
037600         WHEN OTHER                                               03760099
058600                MOVE '2001-GET-DATES'                             05860001
058700                                          TO DP013-PARAGRAPH      05870001
058800                MOVE 'SELECT CURRENT/YESTERDAY DATE'              05880001
058900                                    TO DP013-MESSAGE-TEXT (1)     05890001
059000                MOVE SQLCA          TO DP013-SQLCA                05900001
059100                MOVE 'SET CURRENT'  TO DP013-DB2-TABLE-NAME (1)   05910001
059200                SET DP013-DB2-ABEND                               05920001
059300                    DP013-XCTL-DISPLAY-RESTART TO TRUE            05930001
059400                PERFORM DP013-0000-PROCESS-ABEND                  05940001
059500     END-EVALUATE.                                                05950099
059501                                                                  05950199
059502******************************************************************05950201
059503** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **05950301
059504** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **05950401
059505** FROM THE CICS ARCHITECTURE API.                              **05950501
059506******************************************************************05950601
059507 2100-CHECK-FUNCTION-KEY.                                         05950701
059508     EVALUATE TRUE                                                05950801
059509                                                                  05950901
059510         WHEN DP020-SRC-AID = DP016-ENTER                         05951001
059511           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   05951101
059512                                                                  05951201
059513*F17 RCVRLIST ----> GOES TO SUKCS772 TO DIRECTIVE LIST SCREEN     05951301
059514         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05951401
059515                                                                  05951599
059516             IF (ASC-OPER-UNIT     NOT = SPACES) AND              05951699
059517                (ASC-RCVR-NUMBER       = SPACES) AND              05951799
059518                (ASC-PO-NUMBER     NOT = SPACES) AND              05951803
059519                (ASC-LINE-NO           = SPACES) AND              05951999
059520                (ASC-PACK-ID           = SPACES) AND              05952099
059530                (ASC-AUDIT-NUMBER      = SPACES) AND              05953099
059540                (ASC-CART-ID           = SPACES) AND              05954099
059550                (ASC-CASI              = SPACES) AND              05955099
                      (ASC-DIRCODE           = SPACES) AND              05955199
059560                (ASC-SETCODE           = SPACES) AND              05956099
059570                (ASC-SET-YEAR          = SPACES)                  05957099
059580                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05958099
059590                 MOVE 'PO1'            TO ASC-CURSOR-SW           05959099
059600             ELSE                                                 05960099
059601             IF (ASC-OPER-UNIT     NOT = SPACES) AND              05960199
059602                (ASC-PO-NUMBER     NOT = SPACES) AND              05960203
059603                (ASC-RCVR-NUMBER   NOT = SPACES) AND              05960399
059604                (ASC-LINE-NO           = SPACES) AND              05960499
059605                (ASC-PACK-ID           = SPACES) AND              05960599
059606                (ASC-AUDIT-NUMBER      = SPACES) AND              05960699
059607                (ASC-CART-ID           = SPACES) AND              05960799
059608                (ASC-CASI              = SPACES) AND              05960899
                      (ASC-DIRCODE           = SPACES) AND              05960999
059609                (ASC-SETCODE           = SPACES) AND              05961099
059610                (ASC-SET-YEAR          = SPACES)                  05961199
059620                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05962099
059630                 MOVE 'RV1'            TO ASC-CURSOR-SW           05963099
059640             ELSE                                                 05964099
059641             IF (ASC-OPER-UNIT     NOT = SPACES) AND              05964199
059642                (ASC-PO-NUMBER     NOT = SPACES) AND              05964203
059643                (ASC-RCVR-NUMBER   NOT = SPACES) AND              05964399
059644                (ASC-LINE-NO       NOT = SPACES) AND              05964499
059645                (ASC-PACK-ID           = SPACES) AND              05964599
059646                (ASC-AUDIT-NUMBER      = SPACES) AND              05964699
059647                (ASC-CART-ID           = SPACES) AND              05964799
059648                (ASC-CASI              = SPACES) AND              05964899
                      (ASC-DIRCODE           = SPACES) AND              05964999
059649                (ASC-SETCODE           = SPACES) AND              05965099
059650                (ASC-SET-YEAR          = SPACES)                  05965199
059660                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05966099
059670                 MOVE 'LN1'            TO ASC-CURSOR-SW           05967099
059680             ELSE                                                 05968099
059681             IF (ASC-OPER-UNIT     NOT = SPACES) AND              05968199
059682                (ASC-PO-NUMBER     NOT = SPACES) AND              05968203
059683                (ASC-RCVR-NUMBER   NOT = SPACES) AND              05968399
059684                (ASC-LINE-NO           = SPACES) AND              05968499
059685                (ASC-PACK-ID       NOT = SPACES) AND              05968599
059686                (ASC-AUDIT-NUMBER      = SPACES) AND              05968699
059687                (ASC-CART-ID           = SPACES) AND              05968799
059688                (ASC-CASI              = SPACES) AND              05968899
                      (ASC-DIRCODE           = SPACES) AND              05968999
059689                (ASC-SETCODE           = SPACES) AND              05969099
059690                (ASC-SET-YEAR          = SPACES)                  05969199
059700                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05970099
059800                 MOVE 'PK1'            TO ASC-CURSOR-SW           05980099
059801             ELSE                                                 05980199
059802             IF (ASC-PO-NUMBER         = SPACES) AND              05980203
059803                (ASC-RCVR-NUMBER       = SPACES) AND              05980399
059804                (ASC-LINE-NO           = SPACES) AND              05980499
059805                (ASC-PACK-ID           = SPACES) AND              05980599
059806                (ASC-AUDIT-NUMBER  NOT = SPACES) AND              05980699
059807                (ASC-CART-ID           = SPACES) AND              05980799
059808                (ASC-CASI              = SPACES) AND              05980899
                      (ASC-DIRCODE           = SPACES) AND              05980999
059809                (ASC-SETCODE           = SPACES) AND              05981099
059810                (ASC-SET-YEAR          = SPACES)                  05981199
059820                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05982099
059830                 MOVE 'AU1'            TO ASC-CURSOR-SW           05983099
059831             ELSE                                                 05983199
059832             IF (ASC-PO-NUMBER         = SPACES) AND              05983203
059833                (ASC-RCVR-NUMBER       = SPACES) AND              05983399
059834                (ASC-LINE-NO           = SPACES) AND              05983499
059835                (ASC-PACK-ID           = SPACES) AND              05983599
059836                (ASC-AUDIT-NUMBER      = SPACES) AND              05983699
059837                (ASC-CART-ID       NOT = SPACES) AND              05983799
059838                (ASC-CASI              = SPACES) AND              05983899
                      (ASC-DIRCODE           = SPACES) AND              05983999
059839                (ASC-SETCODE           = SPACES) AND              05984099
059840                (ASC-SET-YEAR          = SPACES)                  05984199
059850                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05985099
059860                 MOVE 'CA1'            TO ASC-CURSOR-SW           05986099
059870             ELSE                                                 05987099
059871             IF (ASC-OPER-UNIT     NOT = SPACES) AND              05987199
059872                (ASC-PO-NUMBER         = SPACES) AND              05987203
059873                (ASC-RCVR-NUMBER       = SPACES) AND              05987399
059874                (ASC-LINE-NO           = SPACES) AND              05987499
059875                (ASC-PACK-ID           = SPACES) AND              05987599
059876                (ASC-AUDIT-NUMBER      = SPACES) AND              05987699
059877                (ASC-CART-ID           = SPACES) AND              05987799
059878                (ASC-CASI          NOT = SPACES) AND              05987899
                      (ASC-DIRCODE           = SPACES) AND              05987999
059879                (ASC-SETCODE           = SPACES) AND              05988099
059880                (ASC-SET-YEAR          = SPACES)                  05988199
059890                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             05989099
059900                 MOVE 'CS1'            TO ASC-CURSOR-SW           05990099
060000             ELSE                                                 06000099
060001             IF (ASC-OPER-UNIT     NOT = SPACES) AND              06000199
060002                (ASC-PO-NUMBER         = SPACES) AND              06000203
060003                (ASC-RCVR-NUMBER       = SPACES) AND              06000399
060004                (ASC-LINE-NO           = SPACES) AND              06000499
060005                (ASC-PACK-ID           = SPACES) AND              06000599
060006                (ASC-AUDIT-NUMBER      = SPACES) AND              06000699
060007                (ASC-CART-ID           = SPACES) AND              06000799
060008                (ASC-CASI              = SPACES) AND              06000899
                      (ASC-DIRCODE           = SPACES) AND              06000999
060009                (ASC-SETCODE       NOT = SPACES) AND              06001099
060010                (ASC-SET-YEAR      NOT = SPACES)                  06001199
060020                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             06002099
060030                 MOVE 'SC1'            TO ASC-CURSOR-SW           06003099
060040             ELSE                                                 06004099
060041             IF (ASC-OPER-UNIT     NOT = SPACES) AND              06004199
060042                (ASC-PO-NUMBER         = SPACES) AND              06004203
060043                (ASC-RCVR-NUMBER       = SPACES) AND              06004399
060044                (ASC-LINE-NO           = SPACES) AND              06004499
060045                (ASC-PACK-ID           = SPACES) AND              06004599
060046                (ASC-AUDIT-NUMBER      = SPACES) AND              06004699
060047                (ASC-CART-ID           = SPACES) AND              06004799
060048                (ASC-CASI              = SPACES) AND              06004899
                      (ASC-DIRCODE           = SPACES) AND              06004999
060049                (ASC-SETCODE           = SPACES) AND              06005099
060050                (ASC-SET-YEAR          = SPACES)                  06005199
060060                 SET PS-VALID-SELECT-CRIT-YES TO TRUE             06006099
060070                 MOVE 'DT1'            TO ASC-CURSOR-SW           06007099
060080             ELSE                                                 06008099
                   IF (ASC-OPER-UNIT     NOT = SPACES) AND              06008199
                      (ASC-PO-NUMBER         = SPACES) AND              06008299
                      (ASC-RCVR-NUMBER       = SPACES) AND              06008399
                      (ASC-LINE-NO           = SPACES) AND              06008499
                      (ASC-PACK-ID           = SPACES) AND              06008599
                      (ASC-AUDIT-NUMBER      = SPACES) AND              06008699
                      (ASC-CART-ID           = SPACES) AND              06008799
                      (ASC-CASI              = SPACES) AND              06008899
                      (ASC-DIRCODE       NOT = SPACES) AND              06008999
                      (ASC-SETCODE           = SPACES) AND              06009099
                      (ASC-SET-YEAR          = SPACES)                  06009199
                       SET PS-VALID-SELECT-CRIT-YES TO TRUE             06009299
                       MOVE 'DC1'            TO ASC-CURSOR-SW           06009399
                   ELSE                                                 06009499
060090                 SET PS-VALID-SELECT-CRIT-NO  TO TRUE             06009599
                   END-IF                                               06009699
060100             END-IF                                               06010099
060200             END-IF                                               06020099
060300             END-IF                                               06030099
060400             END-IF                                               06040099
060500             END-IF                                               06050099
060600             END-IF                                               06060099
060700             END-IF                                               06070099
060800             END-IF                                               06080099
060900             END-IF                                               06090099
061000                                                                  06100099
061001             IF PS-VALID-SELECT-CRIT-NO                           06100199
061002                 SET PS-ERROR                                     06100201
061003                     DP020-MSG-FATAL         TO TRUE              06100301
061004                 MOVE PC-TSYMSG-03651        TO DP020-MSG-NUMBER  06100401
061005                                                                  06100599
061006                 IF  ASC-PO-NUMBER     NOT = SPACES               06100603
061007                     MOVE DP015-UNP-ALP-BRT-OFF  TO APORDERA      06100701
061008                     MOVE DP015-RED              TO APORDERC      06100801
061009                     MOVE DP015-REVERSE          TO APORDERH      06100901
061010                     MOVE -1                     TO APORDERL      06101001
061020                 END-IF                                           06102099
061021                 IF  ASC-RCVR-NUMBER   NOT = SPACES               06102199
061022                     MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVSEQA      06102201
061023                     MOVE DP015-RED              TO ARCVSEQC      06102301
061024                     MOVE DP015-REVERSE          TO ARCVSEQH      06102401
061025                     MOVE -1                     TO ARCVSEQL      06102501
061026                 END-IF                                           06102699
061027                 IF  ASC-LINE-NO       NOT = SPACES               06102799
061028                     MOVE DP015-UNP-ALP-BRT-OFF  TO ALINENOA      06102801
061029                     MOVE DP015-RED              TO ALINENOC      06102901
061030                     MOVE DP015-REVERSE          TO ALINENOH      06103001
061040                     MOVE -1                     TO ALINENOL      06104001
061050                 END-IF                                           06105099
061051                 IF  ASC-PACK-ID       NOT = SPACES               06105199
061052                     MOVE DP015-UNP-ALP-BRT-OFF  TO APACKIDA      06105201
061053                     MOVE DP015-RED              TO APACKIDC      06105301
061054                     MOVE DP015-REVERSE          TO APACKIDH      06105401
061055                     MOVE -1                     TO APACKIDL      06105501
061056                 END-IF                                           06105699
061057                 IF  ASC-AUDIT-NUMBER  NOT = SPACES               06105799
061058                     MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDNUMA      06105801
061059                     MOVE DP015-RED              TO AAUDNUMC      06105901
061060                     MOVE DP015-REVERSE          TO AAUDNUMH      06106001
061070                     MOVE -1                     TO AAUDNUML      06107001
061080                 END-IF                                           06108099
061081                 IF  ASC-CART-ID       NOT = SPACES               06108199
061082                     MOVE DP015-UNP-ALP-BRT-OFF  TO ACARTIDA      06108201
061083                     MOVE DP015-RED              TO ACARTIDC      06108301
061084                     MOVE DP015-REVERSE          TO ACARTIDH      06108401
061085                     MOVE -1                     TO ACARTIDL      06108501
061086                 END-IF                                           06108699
061087                 IF  ASC-CASI          NOT = SPACES               06108799
061088                     MOVE DP015-UNP-ALP-BRT-OFF  TO AOCASIA       06108801
061089                     MOVE DP015-RED              TO AOCASIC       06108901
061090                     MOVE DP015-REVERSE          TO AOCASIH       06109001
061100                     MOVE -1                     TO AOCASIL       06110001
061200                 END-IF                                           06120099
                       IF  ASC-DIRCODE       NOT = SPACES               06120199
                           MOVE DP015-UNP-ALP-BRT-OFF  TO ADIRCDEA      06120299
                           MOVE DP015-RED              TO ADIRCDEC      06120399
                           MOVE DP015-REVERSE          TO ADIRCDEH      06120499
                           MOVE -1                     TO ADIRCDEL      06120599
                       END-IF                                           06120699
061201                 IF  ASC-SETCODE       NOT = SPACES               06120799
061202                     MOVE DP015-UNP-ALP-BRT-OFF  TO ASETCDEA      06120801
061203                     MOVE DP015-RED              TO ASETCDEC      06120901
061204                     MOVE DP015-REVERSE          TO ASETCDEH      06121001
061205                     MOVE -1                     TO ASETCDEL      06121101
061206                 END-IF                                           06121299
061207                 IF  ASC-SET-YEAR      NOT = SPACES               06121399
061208                     MOVE DP015-UNP-ALP-BRT-OFF  TO ASETYRA       06121401
061209                     MOVE DP015-RED              TO ASETYRC       06121501
061210                     MOVE DP015-REVERSE          TO ASETYRH       06121601
061220*                    MOVE -1                     TO ASETYRL       06122001
061221                 END-IF                                           06122199
061222                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06122201
061223                 SET PS-ERROR                                     06122301
061224                     DP020-MSG-FATAL         TO TRUE              06122401
061225             ELSE                                                 06122501
061226                 PERFORM 2110-PREPARE-INTER-APPL-COMM             06122601
061227             END-IF                                               06122701
061228             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06122801
071733                                                                  06123099
071734* F18 - (DIRCDLST) (LOCAL-FUNC-03)                                06123199
071735         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06123299
071736               MOVE SPACE TO ASC-FUNCTION                         06123399
071737               INITIALIZE SU100-INTER-APPL-COMMAREA               06123499
071733                                                                  06123599
061230*F23 HISTORY  ----> GOES TO SUKCS773 TO LIST DOORS                06123601
061231         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06123701
061232             IF  ASC-CART-ID     = SPACES                         06123803
061233                 SET PS-ERROR                                     06123901
061234                     DP020-MSG-FATAL         TO TRUE              06124001
061235                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  06124101
061236                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACARTIDA          06124201
061237                 MOVE DP015-RED              TO ACARTIDC          06124399
061238                 MOVE DP015-REVERSE          TO ACARTIDH          06124401
061239                 MOVE -1                     TO ACARTIDL          06124501
061240                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06124601
061241                 MOVE SPACES                 TO ACARTIDO          06124703
061242             ELSE                                                 06124801
061243                 PERFORM 2110-PREPARE-INTER-APPL-COMM             06124901
061244             END-IF                                               06125001
061245             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06125101
061246     END-EVALUATE.                                                06125201
061247                                                                  06125301
061248******************************************************************06125401
061249** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06125501
061250** INTER-APPLICATION COMMAREA.                                  **06125601
061251******************************************************************06125701
061252 2110-PREPARE-INTER-APPL-COMM.                                    06125801
061253                                                                  06125901
061254     INITIALIZE SU100-INTER-APPL-COMMAREA.                        06126003
061255                                                                  06126101
061256     MOVE ASC-FUNCTION             TO SU100-FUNCTION.             06126203
061257     MOVE ASC-OPER-UNIT            TO SU100-OPER-UNIT.            06126303
061258     MOVE ASC-PO-NUMBER            TO SU100-PO-NUMBER.            06126403
061259     MOVE ASC-OPER-UNIT-NAME       TO SU100-OPER-NAME.            06126503
061260     MOVE ASC-RCVR-NUMBER          TO SU100-RCVR-SEQ-NO.          06126603
061261     MOVE ASC-PACK-TYPE            TO SU100-RCVR-PACK-TYPE.       06126703
061262     MOVE ASC-LINE-NO              TO SU100-LINE-NO.              06126803
061263     MOVE ASC-PACK-ID              TO SU100-PACK-ID.              06126903
061264     MOVE ASC-AUDIT-NUMBER         TO SU100-AUDIT-NUMBER.         06127003
061265     MOVE ASC-CART-ID              TO SU100-CARTON-ID.            06127103
061266     MOVE ASC-CASI                 TO SU100-ORIG-CASI.            06127203
           MOVE ASC-DIRCODE              TO SU100-DIRCODE.              06127399
061267     MOVE ASC-SETCODE              TO SU100-SETCODE.              06127403
061268     MOVE ASC-SET-YEAR             TO SU100-YEAR.                 06127503
061269     MOVE ASC-DATE-START           TO SU100-DATE-RANGE-BEGIN.     06127603
061270     MOVE ASC-DATE-END             TO SU100-DATE-RANGE-END.       06127703
061271     MOVE ASC-CURSOR-SW            TO SU100-CURSOR-SW.            06127803
061272                                                                  06127901
061273*----------------------------------------------------------------*06128001
061274* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06128101
061275* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06128201
061276* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06128301
061277*----------------------------------------------------------------*06128401
061278 2200-MOVE-SCREEN-TO-COMMAREA.                                    06128501
061279*OPER UNT ID                                                      06128601
061280     IF  AOPRUNTL > ZERO                                          06128701
061281         MOVE AOPRUNTI      TO ASC-OPER-UNIT                      06128803
061282     ELSE                                                         06128901
061283         IF AOPRUNTF = DP015-ERASE-EOF                            06129001
061284            MOVE ZEROS      TO ASC-OPER-UNIT                      06129103
061285         END-IF                                                   06129201
061286     END-IF.                                                      06129301
061287*                                                                 06129401
061288*                                                                 06129501
061289*OPER UNIT NAME                                                   06129601
061290     IF  AOPRNMEL > ZERO                                          06129701
061291         MOVE AOPRNMEI      TO ASC-OPER-UNIT-NAME                 06129803
061292     ELSE                                                         06129901
061293         IF AOPRNMEF = DP015-ERASE-EOF                            06130001
061294            MOVE SPACES     TO ASC-OPER-UNIT-NAME                 06130103
061295         END-IF                                                   06130201
061296     END-IF.                                                      06130301
061297*                                                                 06130401
061298*                                                                 06130501
061299*PURCHASE ORDER                                                   06130601
061300     IF  APORDERL > ZERO                                          06130701
061301         MOVE APORDERI      TO ASC-PO-NUMBER                      06130803
061302     ELSE                                                         06130901
061303         IF APORDERF = DP015-ERASE-EOF                            06131001
061304            MOVE SPACES     TO ASC-PO-NUMBER                      06131103
061305         END-IF                                                   06131201
061306     END-IF.                                                      06131301
061307*                                                                 06131401
061308*                                                                 06131501
061309*RECEIVER SEQ NBR                                                 06131601
061310     IF  ARCVSEQL > ZERO                                          06131701
061311         MOVE ARCVSEQI      TO ASC-RCVR-NUMBER                    06131803
061312     ELSE                                                         06131901
061313         IF ARCVSEQF = DP015-ERASE-EOF                            06132001
061314            MOVE SPACES     TO ASC-RCVR-NUMBER                    06132103
061315         END-IF                                                   06132201
061316     END-IF.                                                      06132301
061317*                                                                 06132401
061318*                                                                 06132501
061319*RCVR PACK TYPE                                                   06132601
061320     IF  ARCVPTYL > ZERO                                          06132701
061321         MOVE ARCVPTYI      TO ASC-PACK-TYPE                      06132803
061322     ELSE                                                         06132901
061323         IF ARCVPTYF = DP015-ERASE-EOF                            06133001
061324            MOVE SPACES     TO ASC-PACK-TYPE                      06133103
061325         END-IF                                                   06133201
061326     END-IF.                                                      06133301
061327*                                                                 06133401
061328*                                                                 06133501
061329*LINE NUMBER                                                      06133601
061330     IF  ALINENOL > ZERO                                          06133703
061331         MOVE ALINENOI             TO ASC-LINE-NO                 06133803
061332     ELSE                                                         06133901
061333         IF ALINENOF = DP015-ERASE-EOF                            06134003
061334            MOVE SPACES            TO ASC-LINE-NO                 06134103
061335         END-IF                                                   06134201
061336     END-IF.                                                      06134301
061337                                                                  06134401
061338*                                                                 06134501
061339*                                                                 06134601
061340*PACK ID                                                          06134701
061341     IF  APACKIDL > ZERO                                          06134803
061342         MOVE APACKIDI             TO ASC-PACK-ID                 06134903
061343     ELSE                                                         06135001
061344         IF APACKIDF = DP015-ERASE-EOF                            06135103
061345            MOVE SPACES            TO ASC-PACK-ID                 06135203
061346         END-IF                                                   06135301
061347     END-IF.                                                      06135401
061348                                                                  06135501
061349*                                                                 06135601
061350*                                                                 06135701
061351*AUDIT NUMBER                                                     06135801
061352     IF  AAUDNUML > ZERO                                          06135903
061353         MOVE AAUDNUMI             TO ASC-AUDIT-NUMBER            06136003
061354     ELSE                                                         06136101
061355         IF AAUDNUMF = DP015-ERASE-EOF                            06136203
061356            MOVE SPACES            TO ASC-AUDIT-NUMBER            06136303
061357         END-IF                                                   06136401
061358     END-IF.                                                      06136501
061359                                                                  06136601
061360*                                                                 06136701
061361*                                                                 06136801
061362*CARTON ID                                                        06136901
061363     IF  ACARTIDL > ZERO                                          06137003
061364         MOVE ACARTIDI             TO ASC-CART-ID                 06137103
061365     ELSE                                                         06137201
061366         IF ACARTIDF = DP015-ERASE-EOF                            06137303
061367            MOVE SPACES            TO ASC-CART-ID                 06137403
061368         END-IF                                                   06137501
061369     END-IF.                                                      06137601
061370                                                                  06137701
061371*                                                                 06137801
061372*                                                                 06137901
061373*CASI                                                             06138001
061374     IF  AOCASIL > ZERO                                           06138103
061375         MOVE AOCASII              TO ASC-CASI                    06138203
061376     ELSE                                                         06138301
061377         IF AOCASIF = DP015-ERASE-EOF                             06138403
061378            MOVE SPACES            TO ASC-CASI                    06138503
061379         END-IF                                                   06138601
061380     END-IF.                                                      06138701
061381                                                                  06138801
061382*                                                                 06138901
061383*                                                                 06139001
      *DIRCODE                                                          06139199
           IF  ADIRCDEL > ZERO                                          06139299
               MOVE ADIRCDEI           TO ASC-DIRCODE                   06139399
           ELSE                                                         06139499
               IF ADIRCDEF = DP015-ERASE-EOF                            06139599
                  MOVE SPACES          TO ASC-DIRCODE                   06139699
               END-IF                                                   06139799
           END-IF.                                                      06139899
      *                                                                 06139999
      *                                                                 06140099
061384*SETCODE                                                          06140101
061385     IF  ASETCDEL > ZERO                                          06140203
061386         MOVE ASETCDEI           TO ASC-SETCODE                   06140303
061387     ELSE                                                         06140401
061388         IF ASETCDEF = DP015-ERASE-EOF                            06140503
061389            MOVE SPACES          TO ASC-SETCODE                   06140603
061390         END-IF                                                   06140701
061391     END-IF.                                                      06140801
061392*                                                                 06140901
061393*                                                                 06141001
061394*SET YEAR                                                         06141101
061395     IF  ASETYRL > ZERO                                           06141203
061396         MOVE ASETYRI           TO ASC-SET-YEAR                   06141303
061397     ELSE                                                         06141401
061398         IF ASETYRF = DP015-ERASE-EOF                             06141503
061399            MOVE SPACES         TO ASC-SET-YEAR                   06141603
061400         END-IF                                                   06141701
061401     END-IF.                                                      06141801
061402                                                                  06141901
061403*                                                                 06142001
061404*                                                                 06142101
061405*DATE RANGE BEGIN                                                 06142201
061406     IF  ADRBYRL > ZERO                                           06142399
061407         MOVE ADRBYRI                 TO ASC-START-CCYY           06142499
061409     ELSE                                                         06142501
061410         IF ADRBYRF        = DP015-ERASE-EOF                      06142699
061420            MOVE SPACE     TO ASC-START-CCYY                      06142799
061423         END-IF                                                   06142801
061424     END-IF.                                                      06142901
061425                                                                  06143099
061426     IF  ADRBMTL > ZERO                                           06143199
061427         MOVE ADRBMTI                 TO ASC-START-MM             06143299
061428     ELSE                                                         06143399
061429         IF ADRBMTF        = DP015-ERASE-EOF                      06143499
061430            MOVE SPACE     TO ASC-START-MM                        06143599
061431         END-IF                                                   06143699
061432     END-IF.                                                      06143799
061433                                                                  06143899
061434     IF  ADATFDYL > ZERO                                          06143999
061435         MOVE ADATFDYI                TO ASC-START-DD             06144099
061436     ELSE                                                         06144199
061437         IF ADATFDYF       = DP015-ERASE-EOF                      06144299
061438            MOVE SPACE     TO ASC-START-DD                        06144399
061439         END-IF                                                   06144499
061440     END-IF.                                                      06144599
061441                                                                  06144699
061442     IF  ADATFHHL > ZERO                                          06144799
061443         MOVE ADATFHHI                TO ASC-START-HH             06144899
061444     ELSE                                                         06144999
061445         IF ADATFHHF       = DP015-ERASE-EOF                      06145099
061446            MOVE SPACE     TO ASC-START-HH                        06145199
061447         END-IF                                                   06145299
061448     END-IF.                                                      06145399
061449                                                                  06145499
061450     IF  ADATFMML > ZERO                                          06145599
061451         MOVE ADATFMMI                TO ASC-START-MN             06145699
061452     ELSE                                                         06145799
061453         IF ADATFMMF       = DP015-ERASE-EOF                      06145899
061454            MOVE SPACE     TO ASC-START-MN                        06145999
061455         END-IF                                                   06146099
061456     END-IF.                                                      06146199
061457                                                                  06146299
061458*                                                                 06146399
061459*                                                                 06146499
061460*DATE RANGE END                                                   06146599
061461     IF  ADRENDL > ZERO                                           06146699
061462         MOVE ADRENDI                TO ASC-END-CCYY              06146799
061463     ELSE                                                         06146899
061464         IF ADRENDF       = DP015-ERASE-EOF                       06146999
061465            MOVE SPACE     TO ASC-END-CCYY                        06147099
061466         END-IF                                                   06147199
061467     END-IF.                                                      06147299
061468                                                                  06147399
061469     IF  ADREMTL > ZERO                                           06147499
061470         MOVE ADREMTI                TO ASC-END-MM                06147599
061471     ELSE                                                         06147699
061472         IF ADREMTF        = DP015-ERASE-EOF                      06147799
061473            MOVE SPACE     TO ASC-END-MM                          06147899
061474         END-IF                                                   06147999
061475     END-IF.                                                      06148099
061476                                                                  06148199
061477     IF  ADATEDYL > ZERO                                          06148299
061478         MOVE ADATEDYI               TO ASC-END-DD                06148399
061479     ELSE                                                         06148499
061480         IF ADATEDYF       = DP015-ERASE-EOF                      06148599
061481            MOVE SPACE     TO ASC-END-DD                          06148699
061482         END-IF                                                   06148799
061483     END-IF.                                                      06148899
061484                                                                  06148999
061492                                                                  06149299
061493     IF  ADATEHHL > ZERO                                          06149399
061494         MOVE ADATEHHI               TO ASC-END-HH                06149499
061495     ELSE                                                         06149599
061496         IF ADATEHHF       = DP015-ERASE-EOF                      06149699
061497            MOVE SPACE     TO ASC-END-HH                          06149799
061498         END-IF                                                   06149899
061499     END-IF.                                                      06149999
061500                                                                  06150099
061501     IF  ADATEMML > ZERO                                          06150199
061502         MOVE ADATEMMI               TO ASC-END-MN                06150299
061503     ELSE                                                         06150399
061504         IF ADATEMMF       = DP015-ERASE-EOF                      06150499
061505            MOVE SPACE     TO ASC-END-MN                          06150599
061506         END-IF                                                   06150699
061507     END-IF.                                                      06150799
061508                                                                  06150899
061512                                                                  06151299
061513******************************************************************06151399
061514* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *06151499
061515* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *06151599
061516* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE     *06151699
061517* DONE IN THE DESTINATION PROGRAM, NOT HERE.                     *06151799
061518******************************************************************06151899
061519 3000-EDIT-DATA-IN-COMMAREA.                                      06151999
061520     PERFORM 3200-RESET-ATTRIBUTES.                               06152099
061521     MOVE +0                     TO APORDERL.                     06152199
061522                                                                  06152299
061523*****                EDIT OPER UNIT                           ****06152399
061524*                                                                *06152499
061525*EDIT OPER UNIT ID TO MAKE SURE NUMERIC                           06152599
061526     IF  ASC-OPER-UNIT               NOT = SPACES                 06152699
061527         MOVE ASC-OPER-UNIT             TO DP010I-UNEDITED-FIELD  06152799
061528         MOVE LENGTH OF ASC-OPER-UNIT   TO DP010I-MAXIMUM-DIGITS  06152899
061529         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06152999
061530         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06153099
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06153299
263968              USING DP010I-NUMERIC-EDIT-AREA                      06153399
061532         IF  DP010I-ERROR-DETECTED                                06153499
061533             SET PS-ERROR                                         06153599
061534                 DP020-MSG-FATAL         TO TRUE                  06153699
061535             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06153799
061536             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA              06153899
061537             MOVE DP015-RED              TO AOPRUNTC              06153999
061538             MOVE DP015-REVERSE          TO AOPRUNTH              06154099
061539             MOVE -1                     TO AOPRUNTL              06154199
061540             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06154299
061541             MOVE SPACES                 TO ARCVSEQO              06154399
061542         ELSE                                                     06154499
061543             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNIT-N         06154599
061544             MOVE ASC-OPER-UNIT        TO AOPRUNTO                06154699
061545*OPER UNIT IS NUMERIC - FIND NAME                                 06154799
061546             PERFORM 3010-VALIDATE-OPER-UNIT                      06154899
061547             IF PS-ERROR                                          06154999
061548                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06155099
061549             END-IF                                               06155199
061550         END-IF                                                   06155299
061551     ELSE                                                         06155399
061552*OPER UNIT = SPACES, IT MUST BE ENTERED.                          06155499
061553         SET PS-ERROR                                             06155599
061554             DP020-MSG-FATAL         TO TRUE                      06155699
061555         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          06155799
061556         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA                  06155899
061557         MOVE DP015-RED              TO AOPRUNTC                  06155999
061558         MOVE DP015-REVERSE          TO AOPRUNTH                  06156099
061559         MOVE -1                     TO AOPRUNTL                  06156199
061560         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06156299
061561         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     06156399
061562     END-IF.                                                      06156499
061563                                                                  06156599
061564                                                                  06156699
061565*****                EDIT PO NUMBER                           ****06156799
061566*                                                                *06156899
061567*PO NUMBER MUST BE NUMERIC                                        06156999
061568     IF  ASC-PO-NUMBER               NOT = SPACES                 06157099
061569         MOVE ASC-PO-NUMBER             TO DP010I-UNEDITED-FIELD  06157199
061570         MOVE LENGTH OF ASC-PO-NUMBER   TO DP010I-MAXIMUM-DIGITS  06157299
061571         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06157399
061572         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06157499
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06157699
263968              USING DP010I-NUMERIC-EDIT-AREA                      06157799
061574         IF  DP010I-ERROR-DETECTED                                06157899
061575             SET PS-ERROR                                         06157999
061576                 DP020-MSG-FATAL         TO TRUE                  06158099
061577             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06158199
061578             MOVE DP015-UNP-ALP-BRT-OFF  TO APORDERA              06158299
061579             MOVE DP015-RED              TO APORDERC              06158399
061580             MOVE DP015-REVERSE          TO APORDERH              06158499
061581             MOVE -1                     TO APORDERL              06158599
061582             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06158699
061583*            MOVE SPACES                 TO APORDERO              06158799
061584             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06158899
061585         ELSE                                                     06158999
061586             MOVE DP010I-NUMERIC-FIELD TO ASC-PO-NUMBER-N         06159099
      *CLP 09/24/2104                                                   06159199
061587             MOVE ASC-PO-NUMBER-8      TO APORDERO                06159299
061588         END-IF                                                   06159399
061589         IF PS-ERROR                                              06159499
061590             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06159599
061591         ELSE                                                     06159699
061592*****          PO IS NUMERIC - NOW LOOK IT UP                 ****06159799
061593*****               ON TRECEIV                                ****06159899
061594*                                                                *06159999
061595             PERFORM 3021-VALIDATE-PO                             06160099
061596*            IF PS-ERROR                                          06160199
061597*                MOVE +0                     TO APORDERL          06160299
061598*            END-IF                                               06160399
061599         END-IF                                                   06160499
061600     END-IF.                                                      06160599
061601                                                                  06160699
061602*****                EDIT RECEIVER SEQ NUMBER                 ****06160799
061603*                                                                *06160899
061604*RECEIVER PACK NUMBER MUST BE NUMERIC                             06160999
061605     IF  ASC-RCVR-NUMBER             NOT = SPACES                 06161099
061606         MOVE ASC-RCVR-NUMBER           TO DP010I-UNEDITED-FIELD  06161199
061607         MOVE LENGTH OF ASC-RCVR-NUMBER TO DP010I-MAXIMUM-DIGITS  06161299
061608         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06161399
061609         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06161499
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06161699
263968              USING DP010I-NUMERIC-EDIT-AREA                      06161799
061611         IF  DP010I-ERROR-DETECTED                                06161899
061612             SET PS-ERROR                                         06161999
061613                 DP020-MSG-FATAL         TO TRUE                  06162099
061614             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06162199
061615             MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVSEQA              06162299
061616             MOVE DP015-RED              TO ARCVSEQC              06162399
061617             MOVE DP015-REVERSE          TO ARCVSEQH              06162499
061618             MOVE -1                     TO ARCVSEQL              06162599
061619             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06162699
061620             MOVE SPACES                 TO ARCVSEQO              06162799
061621         ELSE                                                     06162899
061622             MOVE DP010I-NUMERIC-FIELD TO ASC-RCVR-NUMBER-N       06162999
061623             MOVE ASC-RCVR-NUMBER      TO ARCVSEQO                06163099
061624         END-IF                                                   06163199
061625         IF PS-ERROR                                              06163299
061626             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06163399
061627         END-IF                                                   06163499
061628     END-IF.                                                      06163599
061629                                                                  06163699
061630*****          GOOD PO NUMBER AND RECEIVER NUMBER             ****06163799
061631*****               GET RECEIVER PACK TYPE                    ****06163899
061632*                                                                *06163999
061633     IF (ASC-RCVR-NUMBER             NOT = SPACES) AND            06164099
061634         PS-NO-ERROR                                              06164199
061635         PERFORM 3020-GET-RCVR-PACK-TYPE.                         06164299
061636                                                                  06164399
061637*****                EDIT LINE NUMBER                         ****06164499
061638*                                                                *06164599
061639*LINE NUMBER MUST BE NUMERIC                                      06164699
061640     IF  ASC-LINE-NO                 NOT = SPACES                 06164799
061641         MOVE ASC-LINE-NO               TO DP010I-UNEDITED-FIELD  06164899
061642         MOVE LENGTH OF ASC-LINE-NO     TO DP010I-MAXIMUM-DIGITS  06164999
061643         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06165099
061644         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06165199
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06165399
263968              USING DP010I-NUMERIC-EDIT-AREA                      06165499
061646         IF  DP010I-ERROR-DETECTED                                06165599
061647             SET PS-ERROR                                         06165699
061648                 DP020-MSG-FATAL         TO TRUE                  06165799
061649             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06165899
061650             MOVE DP015-UNP-ALP-BRT-OFF  TO ALINENOA              06165999
061651             MOVE DP015-RED              TO ALINENOC              06166099
061652             MOVE DP015-REVERSE          TO ALINENOH              06166199
061653             MOVE -1                     TO ALINENOL              06166299
061654             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06166399
061655             MOVE SPACES                 TO ALINENOO              06166499
061656             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06166599
061657         ELSE                                                     06166699
061658             MOVE DP010I-NUMERIC-FIELD TO ASC-LINE-NO-N           06166799
061659             MOVE ASC-LINE-NO          TO ALINENOO                06166899
061660         END-IF                                                   06166999
061661         IF PS-ERROR                                              06167099
061662             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06167199
061663         END-IF                                                   06167299
061664     END-IF.                                                      06167399
061665                                                                  06167499
061666*****   GOOD PO NUMBER AND RECEIVER NUMBER AND LINE NUMBER    ****06167599
061667*VALIDATE LINE NUMBER                                             06167699
061668     IF (ASC-LINE-NO                 NOT = SPACES)   AND          06167799
061669        (ASC-PO-NUMBER               NOT = SPACES)   AND          06167899
061670        (ASC-RCVR-NUMBER             NOT = SPACES)   AND          06167999
061671         PS-NO-ERROR                                              06168099
061672          PERFORM 3030-VALIDATE-LINE-NO                           06168199
061673     END-IF.                                                      06168299
061674                                                                  06168399
061675*VALID LINE NO BUT PREPACK/PDS REQUESTS SHOULD NOT USE LINE NO   *06168499
061676     IF (ASC-LINE-NO                 NOT = SPACES)   AND          06168599
061677        (ASC-PO-NUMBER               NOT = SPACES)   AND          06168699
061678        (ASC-RCVR-NUMBER             NOT = SPACES)   AND          06168799
061679         PS-NO-ERROR                                              06168899
061680         IF PS-PRE-PACK-ORDER                                     06168999
061681             SET PS-ERROR                                         06169099
061682                    DP020-MSG-FATAL         TO TRUE               06169199
061683             MOVE PC-TSYMSG-03641        TO DP020-MSG-NUMBER      06169299
061684             MOVE SQLCA                  TO DP013-SQLCA           06169399
061685             MOVE DP015-UNP-ALP-BRT-OFF  TO ALINENOA              06169499
061686             MOVE DP015-RED              TO ALINENOC              06169599
061687             MOVE DP015-REVERSE          TO ALINENOH              06169699
061688             MOVE -1                     TO ALINENOL              06169799
061689             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06169899
061690         ELSE                                                     06169999
061691             IF PS-PBS                                            06170099
061692             SET PS-ERROR                                         06170199
061693                    DP020-MSG-FATAL         TO TRUE               06170299
061694             MOVE PC-TSYMSG-03640        TO DP020-MSG-NUMBER      06170399
061695             MOVE SQLCA                  TO DP013-SQLCA           06170499
061696             MOVE DP015-UNP-ALP-BRT-OFF  TO ALINENOA              06170599
061697             MOVE DP015-RED              TO ALINENOC              06170699
061698             MOVE DP015-REVERSE          TO ALINENOH              06170799
061699             MOVE -1                     TO ALINENOL              06170899
061700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06170999
061701             END-IF                                               06171099
061702         END-IF                                                   06171199
061703     END-IF.                                                      06171299
061704                                                                  06171399
061705*****                   EDIT PACK ID                          ****06171499
061706*                                                                *06171599
061707*PACK ID MUST BE NUMERIC                                          06171699
061708     IF  ASC-PACK-ID                 NOT = SPACES                 06171799
061709         MOVE ASC-PACK-ID               TO DP010I-UNEDITED-FIELD  06171899
061710         MOVE LENGTH OF ASC-PACK-ID     TO DP010I-MAXIMUM-DIGITS  06171999
061711         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06172099
061712         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06172199
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06172399
263968              USING DP010I-NUMERIC-EDIT-AREA                      06172499
061714         IF  DP010I-ERROR-DETECTED                                06172599
061715             SET PS-ERROR                                         06172699
061716                 DP020-MSG-FATAL         TO TRUE                  06172799
061717             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06172899
061718             MOVE DP015-UNP-ALP-BRT-OFF  TO APACKIDA              06172999
061719             MOVE DP015-RED              TO APACKIDC              06173099
061720             MOVE DP015-REVERSE          TO APACKIDH              06173199
061721             MOVE -1                     TO APACKIDL              06173299
061722             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06173399
061723             MOVE SPACES                 TO APACKIDO              06173499
061724         ELSE                                                     06173599
061725             MOVE DP010I-NUMERIC-FIELD TO ASC-PACK-ID-N           06173699
061726             MOVE ASC-PACK-ID          TO APACKIDO                06173799
061727         END-IF                                                   06173899
061728         IF PS-ERROR                                              06173999
061729             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06174099
061730         END-IF                                                   06174199
061731     END-IF.                                                      06174299
061732                                                                  06174399
061733*PACK ID IS NUMERIC, NOW VALIDATE IT                              06174499
061734     IF (ASC-PACK-ID                 NOT = SPACES)   AND          06174599
061735        (ASC-PO-NUMBER               NOT = SPACES)   AND          06174699
061736        (ASC-RCVR-NUMBER             NOT = SPACES)   AND          06174799
061737         PS-NO-ERROR                                              06174899
061738          PERFORM 3040-VALIDATE-PACK-ID                           06174999
061739     END-IF.                                                      06175099
061740                                                                  06175199
061741*VALID PACK ID BUT PREPACK/PDS REQUESTS SHOULD NOT USE PACK ID   *06175299
061742     IF (ASC-PACK-ID                 NOT = SPACES)   AND          06175399
061743        (ASC-PO-NUMBER               NOT = SPACES)   AND          06175499
061744        (ASC-RCVR-NUMBER             NOT = SPACES)   AND          06175599
061745         PS-NO-ERROR                                              06175699
061746         IF PS-PRE-PACK-ORDER                                     06175799
061747             SET PS-ERROR                                         06175899
061748                    DP020-MSG-FATAL         TO TRUE               06175999
061749             MOVE PC-TSYMSG-03642        TO DP020-MSG-NUMBER      06176099
061750             MOVE SQLCA                  TO DP013-SQLCA           06176199
061751             MOVE DP015-UNP-ALP-BRT-OFF  TO APACKIDA              06176299
061752             MOVE DP015-RED              TO APACKIDC              06176399
061753             MOVE DP015-REVERSE          TO APACKIDH              06176499
061754             MOVE -1                     TO APACKIDL              06176599
061755             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06176699
061756         ELSE                                                     06176799
061757             IF PS-PBS                                            06176899
061758               SET PS-ERROR                                       06176999
061759                      DP020-MSG-FATAL         TO TRUE             06177099
061760               MOVE PC-TSYMSG-03640        TO DP020-MSG-NUMBER    06177199
061761               MOVE SQLCA                  TO DP013-SQLCA         06177299
061762               MOVE DP015-UNP-ALP-BRT-OFF  TO APACKIDA            06177399
061763               MOVE DP015-RED              TO APACKIDC            06177499
061764               MOVE DP015-REVERSE          TO APACKIDH            06177599
061765               MOVE -1                     TO APACKIDL            06177699
061766               SET DP030-SET-CURSOR-APPL-1 TO TRUE                06177799
061767             END-IF                                               06177899
061768         END-IF                                                   06177999
061769     END-IF.                                                      06178099
061770                                                                  06178199
061771*****                   EDIT AUDIT NUMBER                     ****06178299
061772*                                                                *06178399
061773*AUDIT NUMBER MUST BE NUMERIC                                     06178499
061774     IF  ASC-AUDIT-NUMBER               NOT = SPACES              06178599
061775         MOVE ASC-AUDIT-NUMBER          TO DP010I-UNEDITED-FIELD  06178699
061776         MOVE LENGTH OF ASC-AUDIT-NUMBER TO DP010I-MAXIMUM-DIGITS 06178799
061777         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06178899
061778         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06178999
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06179199
263968              USING DP010I-NUMERIC-EDIT-AREA                      06179299
061780         IF  DP010I-ERROR-DETECTED                                06179399
061781             SET PS-ERROR                                         06179499
061782                 DP020-MSG-FATAL         TO TRUE                  06179599
061783             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06179699
061784             MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDNUMA              06179799
061785             MOVE DP015-RED              TO AAUDNUMC              06179899
061786             MOVE DP015-REVERSE          TO AAUDNUMH              06179999
061787             MOVE -1                     TO AAUDNUML              06180099
061788             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06180199
061789             MOVE SPACES                 TO AAUDNUMO              06180299
061790         ELSE                                                     06180399
061791             MOVE DP010I-NUMERIC-FIELD TO ASC-AUDIT-NUMBER-N      06180499
061792             MOVE ASC-AUDIT-NUMBER     TO AAUDNUMO                06180599
061793         END-IF                                                   06180699
061794         IF PS-ERROR                                              06180799
061795             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06180899
061796         END-IF                                                   06180999
061797     END-IF.                                                      06181099
061798                                                                  06181199
061799*AUDIT NUMBER IS NUMERIC, NOW VALIDATE IT                         06181299
061800     IF (ASC-AUDIT-NUMBER            NOT = SPACES)   AND          06181399
061801         PS-NO-ERROR                                              06181499
061802          PERFORM 3050-VALIDATE-AUDIT-NUMBER                      06181599
061803     END-IF.                                                      06181699
061804                                                                  06181799
061805*****                EDIT CARTON ID                           ****06181899
061806*                                                                *06181999
061807*CART ID MUST BE ON SUT_CNVYR_DIRV_RSN                            06182099
061808     IF  ASC-CART-ID                 NOT = SPACES                 06182199
061809         PERFORM 3070-VALIDATE-CART-ID                            06182299
061810     END-IF.                                                      06182399
061811                                                                  06182499
061812*****                EDIT CASI CODE                           ****06182599
061813*CASI CODE MUST BE Q, U, % OR R                                   06182699
061814     IF (ASC-CASI                    NOT = SPACES)                06182799
061815         IF ASC-CASI = ('Q' OR 'U' OR '%' OR 'R')                 06182899
061816             CONTINUE                                             06182999
061817         ELSE                                                     06183099
061818             SET PS-ERROR                                         06183199
061819                    DP020-MSG-FATAL         TO TRUE               06183299
061820             MOVE PC-TSYMSG-03652        TO DP020-MSG-NUMBER      06183399
061821             MOVE SQLCA                  TO DP013-SQLCA           06183499
061822             MOVE DP015-UNP-ALP-BRT-OFF  TO AOCASIA               06183599
061823             MOVE DP015-RED              TO AOCASIC               06183699
061824             MOVE DP015-REVERSE          TO AOCASIH               06183799
061825             MOVE -1                     TO AOCASIL               06183899
061826             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06183999
061827         END-IF                                                   06184099
061828     END-IF.                                                      06184199
      *****             EDIT DIRECTIVE REASON CODE                  ****06184299
      *                                                                 06184399
      *REASON CODE MUST BE IN TABLE SUT_CNVYR_DIRV_RSN                  06184499
           IF (ASC-DIRCODE             NOT = SPACES)                    06184599
               PERFORM 3055-VALIDATE-DIRECTIVE-CODE                     06184699
           END-IF.                                                      06184799
061829                                                                  06184899
061830*****                   EDIT SET CODE                         ****06184999
061831*                                                                 06185099
061832*IF SET CODE IS ENTERED, VALIDATE IT WITH SET YEAR                06185199
061833     IF (ASC-SETCODE             NOT = SPACES) AND                06185299
061834        (ASC-SET-YEAR                = SPACES)                    06185399
061835         SET PS-ERROR                                             06185499
061836             DP020-MSG-FATAL         TO TRUE                      06185599
061837         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          06185699
061838         MOVE SQLCA                  TO DP013-SQLCA               06185799
061839         MOVE DP015-UNP-ALP-BRT-OFF  TO ASETYRA                   06185899
061840         MOVE DP015-RED              TO ASETYRC                   06185999
061841         MOVE DP015-REVERSE          TO ASETYRH                   06186099
061842         MOVE -1                     TO ASETYRL                   06186199
061843         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06186299
061844     ELSE                                                         06186399
061845       IF (ASC-SETCODE                 = SPACES) AND              06186499
061846          (ASC-SET-YEAR            NOT = SPACES)                  06186599
061847           SET PS-ERROR                                           06186699
061848               DP020-MSG-FATAL         TO TRUE                    06186799
061849           MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER        06186899
061850           MOVE SQLCA                  TO DP013-SQLCA             06186999
061851             MOVE DP015-UNP-ALP-BRT-OFF  TO ASETYRA               06187099
061852           MOVE DP015-RED              TO ASETCDEC                06187199
061853           MOVE DP015-REVERSE          TO ASETCDEH                06187299
061854           MOVE -1                     TO ASETCDEL                06187399
061855           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    06187499
061856       ELSE                                                       06187599
061857         IF (ASC-SETCODE             NOT = SPACES) AND            06187699
061858            (ASC-SET-YEAR            NOT = SPACES)                06187799
061859               PERFORM 3060-VALIDATE-SET-CODE                     06187899
061860         END-IF                                                   06187999
061861       END-IF                                                     06188099
061862     END-IF.                                                      06188199
061863                                                                  06188299
061864*****                   EDIT DATE RANGES                      ****06188399
061865*                                                                 06188499
061866*EDIT START MONTH                                                 06188599
061867*                                                                 06188699
061868*START MONTH MUST BE NUMERIC                                      06188799
061869     IF  ASC-START-MM                 NOT = SPACES                06188899
061870         MOVE ASC-START-MM              TO DP010I-UNEDITED-FIELD  06188999
061871         MOVE LENGTH OF ASC-START-MM    TO DP010I-MAXIMUM-DIGITS  06189099
061872         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06189199
061873         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06189299
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06189499
263968              USING DP010I-NUMERIC-EDIT-AREA                      06189599
061875         IF  DP010I-ERROR-DETECTED                                06189699
061876             SET PS-ERROR                                         06189799
061877                 DP020-MSG-FATAL         TO TRUE                  06189899
061878             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06189999
061879             MOVE DP015-UNP-ALP-BRT-OFF  TO ADRBMTA               06190099
061880             MOVE DP015-RED              TO ADRBMTC               06190199
061881             MOVE DP015-REVERSE          TO ADRBMTH               06190299
061882             MOVE -1                     TO ADRBMTL               06190399
061883             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06190499
061884         ELSE                                                     06190599
061885             MOVE DP010I-NUMERIC-FIELD TO ASC-START-MM-NUM        06190699
061886             MOVE ASC-START-MM         TO ADRBMTO                 06190799
061887         END-IF                                                   06190899
061888     END-IF.                                                      06190999
061889*                                                                 06191099
061890*EDIT START DAY                                                   06191199
061891*                                                                 06191299
061892*START DAY MUST BE NUMERIC                                        06191399
061893     IF  ASC-START-DD                 NOT = SPACES                06191499
061894         MOVE ASC-START-DD              TO DP010I-UNEDITED-FIELD  06191599
061895         MOVE LENGTH OF ASC-START-DD    TO DP010I-MAXIMUM-DIGITS  06191699
061896         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06191799
061897         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06191899
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06192099
263968              USING DP010I-NUMERIC-EDIT-AREA                      06192199
061899         IF  DP010I-ERROR-DETECTED                                06192299
061900             SET PS-ERROR                                         06192399
061901                 DP020-MSG-FATAL         TO TRUE                  06192499
061902             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06192599
061903             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATFDYA              06192699
061904             MOVE DP015-RED              TO ADATFDYC              06192799
061905             MOVE DP015-REVERSE          TO ADATFDYH              06192899
061906             MOVE -1                     TO ADATFDYL              06192999
061907             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06193099
061908         ELSE                                                     06193199
061909             MOVE DP010I-NUMERIC-FIELD TO ASC-START-DD-NUM        06193299
061910             MOVE ASC-START-DD         TO ADATFDYO                06193399
061911         END-IF                                                   06193499
061912     END-IF.                                                      06193599
061913*                                                                 06193699
061914*EDIT START TIME                                                  06193799
061915*                                                                 06193899
061916*START TIME MUST BE NUMERIC                                       06193999
061917     IF  ASC-START-HH                 NOT = SPACES                06194099
061918         MOVE ASC-START-HH              TO DP010I-UNEDITED-FIELD  06194199
061919         MOVE LENGTH OF ASC-START-HH    TO DP010I-MAXIMUM-DIGITS  06194299
061920         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06194399
061921         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06194499
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06194699
263968              USING DP010I-NUMERIC-EDIT-AREA                      06194799
061923         IF  DP010I-ERROR-DETECTED                                06194899
061924             SET PS-ERROR                                         06194999
061925                 DP020-MSG-FATAL         TO TRUE                  06195099
061926             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06195199
061927             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATFHHA              06195299
061928             MOVE DP015-RED              TO ADATFHHC              06195399
061929             MOVE DP015-REVERSE          TO ADATFHHH              06195499
061930             MOVE -1                     TO ADATFHHL              06195599
061931             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06195699
061932         ELSE                                                     06195799
061933             MOVE DP010I-NUMERIC-FIELD TO ASC-START-HH-NUM        06195899
061934             MOVE ASC-START-HH         TO ADATFHHO                06195999
061935         END-IF                                                   06196099
061936     END-IF.                                                      06196199
061937     IF  ASC-START-MN                 NOT = SPACES                06196299
061938         MOVE ASC-START-MN              TO DP010I-UNEDITED-FIELD  06196399
061939         MOVE LENGTH OF ASC-START-MN    TO DP010I-MAXIMUM-DIGITS  06196499
061940         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06196599
061941         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06196699
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06196899
263968              USING DP010I-NUMERIC-EDIT-AREA                      06196999
061943         IF  DP010I-ERROR-DETECTED                                06197099
061944             SET PS-ERROR                                         06197199
061945                 DP020-MSG-FATAL         TO TRUE                  06197299
061946             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06197399
061947             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATFMMA              06197499
061948             MOVE DP015-RED              TO ADATFMMC              06197599
061949             MOVE DP015-REVERSE          TO ADATFMMH              06197699
061950             MOVE -1                     TO ADATFMML              06197799
061951             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06197899
061952         ELSE                                                     06197999
061953             MOVE DP010I-NUMERIC-FIELD TO ASC-START-MN-NUM        06198099
061954             MOVE ASC-START-MN         TO ADATFMMO                06198199
061955         END-IF                                                   06198299
061956     END-IF.                                                      06198399
061957     IF  ASC-START-SS                 NOT = SPACES                06198499
061958         MOVE ASC-START-SS              TO DP010I-UNEDITED-FIELD  06198599
061959         MOVE LENGTH OF ASC-START-SS    TO DP010I-MAXIMUM-DIGITS  06198699
061960         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06198799
061961         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06198899
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06199099
263968              USING DP010I-NUMERIC-EDIT-AREA                      06199199
061963         IF  DP010I-ERROR-DETECTED                                06199299
061964             SET PS-ERROR                                         06199399
061965                 DP020-MSG-FATAL         TO TRUE                  06199499
061966             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06199599
061967             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06199699
061968         ELSE                                                     06199799
061969             MOVE DP010I-NUMERIC-FIELD TO ASC-START-SS-NUM        06199899
061970         END-IF                                                   06199999
061971     END-IF.                                                      06200099
061972     IF  DP010I-ERROR-DETECTED                                    06200199
061973         SET PS-ERROR                                             06200299
061974             DP020-MSG-FATAL         TO TRUE                      06200399
061975         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          06200499
061976         MOVE DP015-UNP-NUM-BRT-OFF  TO ADRBYRA                   06200599
061977         MOVE DP015-RED              TO ADRBYRC                   06200699
061978         MOVE DP015-REVERSE          TO ADRBYRH                   06200799
061979         MOVE -1                     TO ADRBYRL                   06200899
061980         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06200999
061981         MOVE SPACES                 TO ADRBYRO                   06201099
061982         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     06201199
061983     ELSE                                                         06201299
061984         IF (ASC-START-HH                 > '23') OR              06201399
061985            (ASC-START-MN                 > '59')                 06201499
061986             SET PS-ERROR                                         06201599
061987                 DP020-MSG-FATAL         TO TRUE                  06201699
061988             MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER      06201799
061989             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATFHHA              06201899
061990                                            ADATFMMA              06201999
061991             MOVE DP015-RED              TO ADATFHHC              06202099
061992                                            ADATFMMC              06202199
061993             MOVE DP015-REVERSE          TO ADATFHHH              06202299
061994                                            ADATFMMH              06202399
061995             MOVE -1                     TO ADATFHHL              06202499
061996             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06202599
061997             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06202699
061998*            MOVE DP010I-NUMERIC-FIELD   TO ASC-DATE-START        06202799
061999*            MOVE ASC-DATE-START         TO ADRBYRO               06202899
062000*                                           PV-FROM-DATE-HOLD     06202999
062001*            MOVE ASC-START-HH           TO ADATFHHO              06203099
062002*            MOVE ASC-START-MN           TO ADATFMMO              06203199
062003*                                           PV-FROM-HH            06203299
062004*                                           PV-FROM-MN            06203399
062005     END-IF.                                                      06203499
062006                                                                  06203599
062007*EDIT END TIME                                                    06203699
062008*                                                                 06203799
062009*START MONTH MUST BE NUMERIC                                      06203899
062010     IF  ASC-END-MM                   NOT = SPACES                06203999
062011         MOVE ASC-END-MM                TO DP010I-UNEDITED-FIELD  06204099
062012         MOVE LENGTH OF ASC-END-MM      TO DP010I-MAXIMUM-DIGITS  06204199
062013         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06204299
062014         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06204399
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06204599
263968              USING DP010I-NUMERIC-EDIT-AREA                      06204699
062016         IF  DP010I-ERROR-DETECTED                                06204799
062017             SET PS-ERROR                                         06204899
062018                 DP020-MSG-FATAL         TO TRUE                  06204999
062019             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06205099
062020             MOVE DP015-UNP-ALP-BRT-OFF  TO ADREMTA               06205199
062021             MOVE DP015-RED              TO ADREMTC               06205299
062022             MOVE DP015-REVERSE          TO ADREMTH               06205399
062023             MOVE -1                     TO ADREMTL               06205499
062024             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06205599
062025         ELSE                                                     06205699
062026             MOVE DP010I-NUMERIC-FIELD TO ASC-END-MM-NUM          06205799
062027             MOVE ASC-END-MM           TO ADREMTO                 06205899
062028         END-IF                                                   06205999
062029     END-IF.                                                      06206099
062030*                                                                 06206199
062031*EDIT END DAY                                                     06206299
062032*                                                                 06206399
062033* END  DAY MUST BE NUMERIC                                        06206499
062034     IF  ASC-END-DD                   NOT = SPACES                06206599
062035         MOVE ASC-END-DD                TO DP010I-UNEDITED-FIELD  06206699
062036         MOVE LENGTH OF ASC-END-DD      TO DP010I-MAXIMUM-DIGITS  06206799
062037         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06206899
062038         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06206999
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06207199
263968              USING DP010I-NUMERIC-EDIT-AREA                      06207299
062040         IF  DP010I-ERROR-DETECTED                                06207399
062041             SET PS-ERROR                                         06207499
062042                 DP020-MSG-FATAL         TO TRUE                  06207599
062043             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06207699
062044             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATEDYA              06207799
062045             MOVE DP015-RED              TO ADATEDYC              06207899
062046             MOVE DP015-REVERSE          TO ADATEDYH              06207999
062047             MOVE -1                     TO ADATEDYL              06208099
062048             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06208199
062049         ELSE                                                     06208299
062050             MOVE DP010I-NUMERIC-FIELD TO ASC-END-DD-NUM          06208399
062051             MOVE ASC-END-DD           TO ADATEDYO                06208499
062052         END-IF                                                   06208599
062053     END-IF.                                                      06208699
062054*                                                                 06208799
062055*                                                                 06208899
062056*END TIME MUST BE NUMERIC                                         06208999
062057     IF  ASC-END-HH                 NOT = SPACES                  06209099
062058         MOVE ASC-END-HH              TO DP010I-UNEDITED-FIELD    06209199
062059         MOVE LENGTH OF ASC-END-HH    TO DP010I-MAXIMUM-DIGITS    06209299
062060         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06209399
062061         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06209499
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06209699
263968              USING DP010I-NUMERIC-EDIT-AREA                      06209799
062063         IF  DP010I-ERROR-DETECTED                                06209899
062064             SET PS-ERROR                                         06209999
062065                 DP020-MSG-FATAL         TO TRUE                  06210099
062066             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06210199
062067             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATEHHA              06210299
062068             MOVE DP015-RED              TO ADATEHHC              06210399
062069             MOVE DP015-REVERSE          TO ADATEHHH              06210499
062070             MOVE -1                     TO ADATEHHL              06210599
062071             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06210699
062072         ELSE                                                     06210799
062073             MOVE DP010I-NUMERIC-FIELD TO ASC-END-HH-NUM          06210899
062074             MOVE ASC-END-HH         TO ADATEHHO                  06210999
062075         END-IF                                                   06211099
062076     END-IF.                                                      06211199
062077     IF  ASC-END-MN                 NOT = SPACES                  06211299
062078         MOVE ASC-END-MN              TO DP010I-UNEDITED-FIELD    06211399
062079         MOVE LENGTH OF ASC-END-MN    TO DP010I-MAXIMUM-DIGITS    06211499
062080         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06211599
062081         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06211699
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06211899
263968              USING DP010I-NUMERIC-EDIT-AREA                      06211999
062083         IF  DP010I-ERROR-DETECTED                                06212099
062084             SET PS-ERROR                                         06212199
062085                 DP020-MSG-FATAL         TO TRUE                  06212299
062086             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06212399
062087             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATEMMA              06212499
062088             MOVE DP015-RED              TO ADATEMMC              06212599
062089             MOVE DP015-REVERSE          TO ADATEMMH              06212699
062090             MOVE -1                     TO ADATEMML              06212799
062091             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06212899
062092         ELSE                                                     06212999
062093             MOVE DP010I-NUMERIC-FIELD TO ASC-END-MN-NUM          06213099
062094             MOVE ASC-END-MN         TO ADATEMMO                  06213199
062095         END-IF                                                   06213299
062096     END-IF.                                                      06213399
062097     IF  ASC-END-SS                 NOT = SPACES                  06213499
062098         MOVE ASC-END-SS              TO DP010I-UNEDITED-FIELD    06213599
062099         MOVE LENGTH OF ASC-END-SS    TO DP010I-MAXIMUM-DIGITS    06213699
062100         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS06213799
062101         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06213899
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06214099
263968              USING DP010I-NUMERIC-EDIT-AREA                      06214199
062103         IF  DP010I-ERROR-DETECTED                                06214299
062104             SET PS-ERROR                                         06214399
062105                 DP020-MSG-FATAL         TO TRUE                  06214499
062106             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06214599
062107             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06214699
062108         ELSE                                                     06214799
062109             MOVE DP010I-NUMERIC-FIELD TO ASC-END-SS-NUM          06214899
062110         END-IF                                                   06214999
062111     END-IF.                                                      06215099
062112     IF  DP010I-ERROR-DETECTED                                    06215199
062113         SET PS-ERROR                                             06215299
062114             DP020-MSG-FATAL         TO TRUE                      06215399
062115         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          06215499
062116         MOVE DP015-UNP-NUM-BRT-OFF  TO ADRENDA                   06215599
062117         MOVE DP015-RED              TO ADRENDC                   06215699
062118         MOVE DP015-REVERSE          TO ADRENDH                   06215799
062119         MOVE -1                     TO ADRENDL                   06215899
062120         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06215999
062121         MOVE SPACES                 TO ADRENDO                   06216099
062122         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     06216199
062123     ELSE                                                         06216299
062124         IF (ASC-END-HH                 > '23') OR                06216399
062125            (ASC-END-MN                 > '59')                   06216499
062126             SET PS-ERROR                                         06216599
062127                 DP020-MSG-FATAL         TO TRUE                  06216699
062128             MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER      06216799
062129             MOVE DP015-UNP-ALP-BRT-OFF  TO ADATEHHA              06216899
062130                                            ADATEMMA              06216999
062131             MOVE DP015-RED              TO ADATEHHC              06217099
062132                                            ADATEMMC              06217199
062133             MOVE DP015-REVERSE          TO ADATEHHH              06217299
062134                                            ADATEMMH              06217399
062135             MOVE -1                     TO ADATEHHL              06217499
062136             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06217599
062137             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06217699
062138     END-IF.                                                      06217799
062139                                                                  06217899
062140                                                                  06217999
062141*TTIMESTAMP EDIT                                                  06218099
062142     IF  PS-ERROR                                                 06218199
062143         NEXT SENTENCE                                            06218299
062144     ELSE                                                         06218399
062145       IF (ASC-START-CCYY         NOT = PV-FROM-CCYY) OR          06218499
062146          (ASC-START-MM           NOT = PV-FROM-MM) OR            06218503
062147          (ASC-START-DD           NOT = PV-FROM-DD) OR            06218603
062148          (ASC-START-HH           NOT = PV-FROM-HH) OR            06218703
062149          (ASC-START-MN           NOT = PV-FROM-MN) OR            06218803
062150          (ASC-START-SS           NOT = PV-FROM-SS)               06218903
062151           PERFORM 3001-VALIDATE-DATES                            06219003
062152       ELSE                                                       06219199
062153         IF (ASC-END-CCYY           NOT = PV-TO-CCYY) OR          06219299
062154            (ASC-END-MM             NOT = PV-TO-MM) OR            06219303
062155            (ASC-END-DD             NOT = PV-TO-DD) OR            06219403
062156            (ASC-END-HH             NOT = PV-TO-HH) OR            06219503
062157            (ASC-END-MN             NOT = PV-TO-MN) OR            06219603
062158            (ASC-END-SS             NOT = PV-TO-SS)               06219703
062159             PERFORM 3001-VALIDATE-DATES                          06219803
062160         END-IF                                                   06219999
062161       END-IF                                                     06220099
062162     END-IF.                                                      06220199
062163                                                                  06220299
062164     IF PS-NO-ERROR                                               06220301
062165             MOVE -1                     TO APORDERL              06220401
062166     END-IF.                                                      06220599
062167                                                                  06220601
062168******************************************************************06220701
062169** LOOK UP OPER UNIT NAME USING XLKUT071                        **06220801
062170******************************************************************06220901
062171 3001-VALIDATE-DATES.                                             06221001
062172                                                                  06221199
062173     MOVE  ASC-START-MM  TO  PV-FROM-MM.                          06221299
062174     MOVE  ASC-START-DD  TO  PV-FROM-DD.                          06221399
062175     MOVE  ASC-START-CCYY  TO  PV-FROM-CCYY.                      06221499
062176     MOVE  ASC-START-HH  TO  PV-FROM-HH.                          06221599
062177     MOVE  ASC-START-MN  TO  PV-FROM-MN.                          06221699
062178     MOVE  ASC-START-SS  TO  PV-FROM-SS.                          06221799
062179                                                                  06221899
062180     MOVE  ASC-END-MM    TO  PV-TO-MM.                            06221999
062181     MOVE  ASC-END-DD    TO  PV-TO-DD.                            06222099
062182     MOVE  ASC-END-CCYY  TO  PV-TO-CCYY.                          06222199
062190     MOVE  ASC-END-HH    TO  PV-TO-HH.                            06222299
062200     MOVE  ASC-END-MN    TO  PV-TO-MN.                            06223099
062300     MOVE  ASC-END-SS    TO  PV-TO-SS.                            06230099
062400                                                                  06240099
062500     INITIALIZE DPG51 DPG52 DPG53                                 06250099
062600                DPG54 DPG55 DPG56.                                06260099
062700     SET  DPG51-ACTUAL-CALENDAR-ONLY                              06270099
062800          DPG51-DO-NOT-INCR-DECR-DATE                             06280099
062900                                TO TRUE.                          06290099
063000*            'CCYYMMDD'                                           06300099
063100     SET  DPG52-LK-DTE-ISO           TO TRUE.                     06310099
063200     MOVE PV-FROM-DATE-HOLD-CCYYMMDD TO DPG52-LK-DATE-INPUT.      06320099
063300     CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53              06330099
063400                                   DPG54 DPG55 DPG56.             06340099
063520                                                                  06352099
063600     IF (DPG54-DATE-INVALID  OR                                   06360099
063700         DPG54-SEVERE-ERROR)                                      06370099
063800         SET PS-ERROR                                             06380099
063900             DP020-MSG-FATAL       TO TRUE                        06390099
064000         MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER            06400099
064100         MOVE DP015-UNP-NUM-BRT-OFF                               06410099
064200                                   TO ADRBYRA                     06420099
064201                                      ADRBMTA                     06420199
064220                                      ADATFDYA                    06422099
064230                                      ADATFHHA                    06423099
064240                                      ADATFMMA                    06424099
064300         MOVE DP015-RED            TO ADRBYRC                     06430099
064310                                      ADRBMTC                     06431099
064320                                      ADATFDYC                    06432099
064330                                      ADATFHHC                    06433099
064340                                      ADATFMMC                    06434099
064400         MOVE DP015-REVERSE        TO ADRBYRH                     06440099
064410                                      ADRBMTH                     06441099
064420                                      ADATFDYH                    06442099
064430                                      ADATFHHH                    06443099
064440                                      ADATFMMH                    06444099
064500         MOVE -1                   TO ADRBYRL                     06450099
064600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06460099
064610     ELSE                                                         06461099
001850*DANH 12/15/2014                                                  06461199
064620         MOVE DPG55-JULIAN-DATE-CCYYDDD  TO  PV-FROM-JULIAN       06462099
064700     END-IF.                                                      06470099
064800                                                                  06480099
064900     IF  PS-NO-ERROR                                              06490099
065000         INITIALIZE DPG51 DPG52 DPG53                             06500099
065100                    DPG54 DPG55 DPG56                             06510099
065200         SET  DPG51-ACTUAL-CALENDAR-ONLY                          06520099
065300              DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                 06530099
065400*                'CCYYMMDD'                                       06540099
065500         SET  DPG52-LK-DTE-ISO      TO TRUE                       06550099
065600         MOVE PV-TO-DATE-HOLD-CCYYMMDD  TO DPG52-LK-DATE-INPUT    06560099
065700         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          06570099
065800                                       DPG54 DPG55 DPG56          06580099
065900         IF (DPG54-DATE-INVALID                                   06590099
066000         OR  DPG54-SEVERE-ERROR)                                  06600099
066100             SET PS-ERROR                                         06610099
066200                 DP020-MSG-FATAL       TO TRUE                    06620099
066300             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        06630099
066400             MOVE DP015-UNP-NUM-BRT-OFF                           06640099
066401                                       TO ADRENDA                 06640199
066402                                          ADREMTA                 06640299
066520                                          ADATEDYA                06652099
066530                                          ADATEHHA                06653099
066540                                          ADATEMMA                06654099
066600             MOVE DP015-RED            TO ADRENDC                 06660099
066610                                          ADREMTC                 06661099
066620                                          ADATEDYC                06662099
066630                                          ADATEHHC                06663099
066640                                          ADATEMMC                06664099
066700             MOVE DP015-REVERSE        TO ADRENDH                 06670099
066710                                          ADREMTH                 06671099
066720                                          ADATEDYH                06672099
066730                                          ADATEHHH                06673099
066740                                          ADATEMMH                06674099
066800             MOVE -1                   TO ADRENDL                 06680099
066900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06690099
067010         ELSE                                                     06691099
001850*DANH 12/15/2014                                                  06691199
067020             MOVE DPG55-JULIAN-DATE-CCYYDDD                       06692099
                                             TO  PV-TO-JULIAN           06693099
067000         END-IF                                                   06700099
067100     END-IF.                                                      06710099
067200                                                                  06720099
067300     IF  PS-ERROR                                                 06730099
067400         CONTINUE                                                 06740099
067500     ELSE                                                         06750099
067600         IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD               06760099
067700             CONTINUE                                             06770099
067800         ELSE                                                     06780099
067900*DATE RANGE IS INVALID                                            06790099
068000             SET PS-ERROR                                         06800099
068100             DP020-MSG-FATAL             TO TRUE                  06810099
068200             MOVE PC-TSYMSG-02698        TO DP020-MSG-NUMBER      06820099
068300             MOVE DP015-UNP-NUM-BRT-OFF  TO ADRBYRA               06830099
068301                                            ADRBMTA               06830199
068302                                            ADATFDYA              06830299
068303                                            ADATFHHA              06830399
068304                                            ADATFMMA              06830499
068308                                            ADRENDA               06830899
068309                                            ADREMTA               06830999
068420                                            ADATEDYA              06842099
068430                                            ADATEHHA              06843099
068440                                            ADATEMMA              06844099
068500             MOVE DP015-RED              TO ADRBYRC               06850099
068520                                            ADRBMTC               06852099
068530                                            ADATFDYC              06853099
068540                                            ADATFHHC              06854099
068550                                            ADATFMMC              06855099
068570                                            ADREMTC               06857099
068580                                            ADATEDYC              06858099
068590                                            ADATEHHC              06859099
068591                                            ADATEMMC              06859199
068600                                            ADRENDC               06860099
068700             MOVE DP015-REVERSE          TO ADRBYRH               06870099
068800                                            ADRENDH               06880099
068820                                            ADRBMTH               06882099
068830                                            ADATFDYH              06883099
068840                                            ADATFHHH              06884099
068850                                            ADATFMMH              06885099
068870                                            ADREMTH               06887099
068880                                            ADATEDYH              06888099
068890                                            ADATEHHH              06889099
068891                                            ADATEMMH              06889199
068900             MOVE -1                     TO ADRBYRL               06890099
069000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06900099
069100         END-IF                                                   06910099
069200     END-IF.                                                      06920099
069201                                                                  06920199
069202*                                                                 06920299
069203*** DMH 3/18/10 - BEGIN                                           06920399
069204*** IF ONLY DATE RANGE HAS BEEN SELECTED - NEED TO LIMIT THE      06920499
069205*** TIME FRAME - PARM DRVHRS HAS THE HOURS LIMIT                  06920599
069206*** FORMAT OF THE PARM IS HHMMSS.0 BASED ON TIMESTAMP SUBTRCT     06920699
069207*** RESULTS CREATED BY DB2.  12 HOURS - 120000.0                  06920799
069208                                                                  06920899
069209     IF  PS-ERROR                                                 06920999
069210         CONTINUE                                                 06921099
069211     ELSE                                                         06921199
069212     IF  ASC-PO-NUMBER-N     > ZERO   OR                          06921299
069213         ASC-CART-ID         > SPACE  OR                          06921399
069214         ASC-AUDIT-NUMBER-N  > ZERO   OR                          06921499
069215         ASC-CASI            > SPACE  OR                          06921599
069216         ASC-SETCODE         > SPACE  OR                          06921699
069217         ASC-SET-YEAR        > SPACE                              06921799
069218         CONTINUE                                                 06921899
069219     ELSE                                                         06921999
069220         IF  ASC-START-CCYY  =  ASC-END-CCYY  AND                 06922099
069221             ASC-START-MM    =  ASC-END-MM    AND                 06922199
069222             ASC-START-DD    =  ASC-END-DD                        06922299
069223             MOVE  ZEROES  TO  PV-DAYS-DIFF                       06922399
069224         ELSE                                                     06922499
069226             SUBTRACT  PV-FROM-JULIAN                             06922699
069227                 FROM  PV-TO-JULIAN                               06922799
069228               GIVING  PV-DAYS-DIFF                               06922899
069229         END-IF                                                   06922999
069230                                                                  06923099
069233         SUBTRACT PV-FROM-HH   FROM   PV-TO-HH                    06923399
069234           GIVING PV-HOURS-DIFF                                   06923499
069235         IF  PV-HOURS-DIFF  <   0                                 06923599
069236             ADD  24   TO  PV-HOURS-DIFF                          06923699
069237             SUBTRACT  1  FROM PV-DAYS-DIFF                       06923799
069238         END-IF                                                   06923899
069260                                                                  06926099
069261         IF  PV-DAYS-DIFF > 0                                     06926199
069262             MULTIPLY PV-DAYS-DIFF  BY  24                        06926299
069263               GIVING PV-DAYS-HRS-CONV                            06926399
069264         ELSE                                                     06926499
069265             MOVE  ZEROES  TO  PV-DAYS-HRS-CONV                   06926599
069266         END-IF                                                   06926699
069267                                                                  06926799
069268         ADD  PV-DAYS-HRS-CONV  TO  PV-HOURS-DIFF                 06926899
069269                                                                  06926999
069270         PERFORM 3065-CALC-BETWEEN-DATES                          06927099
069271                                                                  06927199
069273         IF  PV-HOURS-DIFF  >  KRPRPM-FUNC-QTY                    06927399
069274             SET PS-ERROR                                         06927499
069275             DP020-MSG-FATAL             TO TRUE                  06927599
069276             MOVE PC-TSYMSG-03670        TO DP020-MSG-NUMBER      06927699
001850*DANH 12/15/2014                                                  06927799
069277             MOVE KRPRPM-FUNC-QTY        TO PV-HRS-PRIOR-DISPLAY  06927899
069277             MOVE PV-HRS-PRIOR-DISPLAY   TO DP020-MSG-TEXT        06927999
069278             MOVE DP015-UNP-NUM-BRT-OFF  TO ADRBYRA               06928199
069279                                            ADRBMTA               06928299
069280                                            ADATFDYA              06928399
069281                                            ADATFHHA              06928499
069282                                            ADATFMMA              06928599
069283                                            ADRENDA               06928699
069284                                            ADREMTA               06928799
069292                                            ADATEDYA              06929299
069293                                            ADATEHHA              06929399
069294                                            ADATEMMA              06929499
069295             MOVE DP015-RED              TO ADRBYRC               06929599
069296                                            ADRBMTC               06929699
069297                                            ADATFDYC              06929799
069298                                            ADATFHHC              06929899
069299                                            ADATFMMC              06929999
069300                                            ADREMTC               06930099
069301                                            ADATEDYC              06930199
069302                                            ADATEHHC              06930299
069303                                            ADATEMMC              06930399
069304                                            ADRENDC               06930499
069305             MOVE DP015-REVERSE          TO ADRBYRH               06930599
069306                                            ADRENDH               06930699
069307                                            ADRBMTH               06930799
069308                                            ADATFDYH              06930899
069309                                            ADATFHHH              06930999
069310                                            ADATFMMH              06931099
069311                                            ADREMTH               06931199
069312                                            ADATEDYH              06931299
069313                                            ADATEHHH              06931399
069314                                            ADATEMMH              06931499
069315             MOVE -1                     TO ADRBYRL               06931599
069316             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06931699
069317         END-IF                                                   06931799
069318     END-IF                                                       06931899
069319     END-IF.                                                      06931999
069320*** DMH 3/18/10 - END                                             06932099
069321                                                                  06932199
069322******************************************************************06932299
069323** LOOK UP OPER UNIT NAME USING XLKUT071                        **06932399
069324******************************************************************06932499
069325 3010-VALIDATE-OPER-UNIT.                                         06932599
069326     INITIALIZE XL071-COMMAREA.                                   06932699
069327     MOVE ASC-OPER-UNIT   TO XL071-LOCATION-NUMBER.               06932799
069328                                                                  06932899
069329     CALL XL071-LOCATION-MODULE USING                             06932999
069330                                DFHEIBLK                          06933099
069331                                XL071-COMMAREA                    06933199
069332                                XL071-COMMAREA-REC.               06933299
069333                                                                  06933399
069334     EVALUATE TRUE                                                06933499
069335         WHEN XL071-NO-ERRORS                                     06933599
069336         WHEN XL071-DC-ASGMT-NOT-FND                              06933699
069337              MOVE XL071-LOC-NM TO ASC-OPER-UNIT-NAME             06933799
069338              IF XL071-LOC-TYP-CDE = PC-DC                        06933899
069340                 CONTINUE                                         06934099
069400              ELSE                                                06940099
069500                 SET PS-ERROR                                     06950099
069600                     DP020-MSG-FATAL         TO TRUE              06960099
069700                 MOVE PC-TSYMSG-02572        TO DP020-MSG-NUMBER  06970099
069800                 MOVE DP015-RED              TO AOPRUNTC          06980099
069900                 MOVE DP015-REVERSE          TO AOPRUNTH          06990099
070000                 MOVE -1                     TO AOPRUNTL          07000099
070100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07010099
070200                 MOVE SPACES                 TO AOPRNMEO          07020099
070300              END-IF                                              07030099
070400                                                                  07040099
070500         WHEN XL071-LOC-NOT-FOUND                                 07050099
070600              MOVE 'NAME NOT FOUND'   TO ASC-OPER-UNIT-NAME       07060099
070700              SET PS-ERROR                                        07070099
070800                  DP020-MSG-FATAL         TO TRUE                 07080099
070900              MOVE PC-TSYMSG-02572        TO DP020-MSG-NUMBER     07090099
071000              MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA             07100099
071100              MOVE DP015-RED              TO AOPRUNTC             07110099
071200              MOVE DP015-REVERSE          TO AOPRUNTH             07120099
071300              MOVE -1                     TO AOPRUNTL             07130099
071400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 07140099
071500              MOVE SPACES                 TO AOPRNMEO             07150099
071600                                                                  07160099
071700         WHEN OTHER                                               07170099
071800              MOVE '3010-VALIDATE-OPER-UNIT'                      07180099
071900                                  TO DP013-PARAGRAPH              07190099
072000              STRING 'SELECT STORE NUMBER - '                     07200099
072100                      XL071-LOCATION-NUMBER                       07210099
072200                     ' - BAD RETURN CODE FROM XLKUT071 - '        07220099
072300                      XL071-RETURN-CODE                           07230099
072400                      DELIMITED BY SIZE                           07240099
072500                      INTO DP013-MESSAGE-TEXT (1)                 07250099
072600              STRING 'SQLCODE - '                                 07260099
072700                      XL071-SQLCODE                               07270099
072800                     ' - '                                        07280099
072900                      XL071-DB2-TABLE                             07290099
073000                      DELIMITED BY SIZE                           07300099
073100                      INTO DP013-MESSAGE-TEXT (2)                 07310099
073200              MOVE XL071-SQLCA     TO DP013-SQLCA                 07320099
073300              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    07330099
073400              MOVE XL071-SQLCODE TO SQLCODE                       07340099
073500              SET DP013-DB2-ABEND                                 07350099
073600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07360099
073700              PERFORM DP013-0000-PROCESS-ABEND                    07370099
073800                                                                  07380099
073900     END-EVALUATE.                                                07390099
074000                                                                  07400099
074001                                                                  07400199
074002******************************************************************07400201
074003** LOOK UP RCVR PACK TYPE WITH PO NUMBER AND RECEIVER NUMBER    **07400301
074004******************************************************************07400401
074005 3020-GET-RCVR-PACK-TYPE.                                         07400501
074006     MOVE  ASC-PO-NUMBER   TO  DK-PO-NUMBER.                      07400699
074007     MOVE  ASC-RCVR-NUMBER TO  DK-RCVR-NUMBER.                    07400799
074008                                                                  07400801
074009        EXEC SQL                                                  07400901
074010            SELECT  PACK_BY_ST_IND                                07401099
074020                   ,PKGNG_CDE                                     07402099
074030              INTO :RECEIV-PACK-BY-ST-IND                         07403099
074040                  ,:RECEIV-PKGNG-CDE                              07404099
074050              FROM  TRECEIV                                       07405099
074060             WHERE  ORD_NBR      = :DK-PO-NUMBER                  07406099
074070               AND  REC_SEQ_NBR  = :DK-RCVR-NUMBER                07407099
074071               WITH UR                                            07407199
074072        END-EXEC                                                  07407201
074073                                                                  07407301
074074        EVALUATE TRUE                                             07407401
074075            WHEN SQLCODE = +0                                     07407501
074076                MOVE RECEIV-PACK-BY-ST-IND TO PS-PKGNG-CD         07407601
074077                IF RECEIV-PACK-BY-ST-IND = 'Y'                    07407701
074078                    MOVE PC-PBS                  TO ASC-PACK-TYPE 07407899
074079                    MOVE ' '               TO PS-PKGNG-CD         07407901
074080                ELSE                                              07408099
074081                 EVALUATE RECEIV-PKGNG-CDE                        07408101
074082                    WHEN 'M'                                      07408203
074083                        MOVE PC-MULTIPLE-SKU-PPK TO ASC-PACK-TYPE 07408399
074084                    WHEN 'S'                                      07408403
074085                        MOVE PC-SINGLE-SKU-PPK   TO ASC-PACK-TYPE 07408599
074086                    WHEN 'I'                                      07408603
074087                        MOVE PC-INNER-PPK        TO ASC-PACK-TYPE 07408799
074088                    WHEN 'B'                                      07408803
074089                        MOVE PC-BULK-PPK         TO ASC-PACK-TYPE 07408999
074090                    WHEN 'C'                                      07409003
074091                        MOVE PC-CASEPACK         TO ASC-PACK-TYPE 07409199
074092                 END-EVALUATE                                     07409201
074093                END-IF                                            07409399
074094                MOVE ASC-PACK-TYPE        TO ARCVPTYO             07409403
074095                                                                  07409501
074096            WHEN SQLCODE = +100                                   07409601
074097                SET PS-ERROR                                      07409701
074098                    DP020-MSG-FATAL         TO TRUE               07409801
074099                MOVE PC-TSYMSG-01298        TO DP020-MSG-NUMBER   07409901
074100                MOVE SQLCA                  TO DP013-SQLCA        07410001
074101*               MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVPTYA           07410103
074102                MOVE DP015-UNP-ALP-BRT-OFF  TO APORDERA           07410203
074103                                               ARCVSEQA           07410303
074104                MOVE DP015-RED              TO ARCVPTYC           07410403
074105                                               APORDERC           07410503
074106                                               ARCVSEQC           07410603
074107*               MOVE DP015-REVERSE          TO ARCVPTYH           07410703
074108                MOVE DP015-REVERSE          TO APORDERH           07410899
074109                                               ARCVSEQH           07410999
074110*               MOVE -1                     TO ARCVPTYL           07411003
074120                MOVE -1                     TO APORDERL           07412099
074130                                               ARCVSEQL           07413099
074140                MOVE SPACES                 TO ASC-PACK-TYPE      07414099
074141                                               ARCVPTYO           07414199
074142                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07414201
074143            WHEN SQLWARN0 NOT = SPACES                            07414301
074144            WHEN SQLCODE < +0                                     07414401
074145            WHEN SQLCODE > +0                                     07414501
074146                MOVE '3020-GET-RCVR-PACK-TYPE'                    07414601
074147                                          TO DP013-PARAGRAPH      07414701
074148                MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)       07414801
074149                SET DP013-DB2-ABEND                               07414901
074150                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07415001
074151                PERFORM DP013-0000-PROCESS-ABEND                  07415101
074152        END-EVALUATE.                                             07415201
074153                                                                  07415301
074154******************************************************************07415401
074155** LOOK UP PO WITH OPER ID                                      **07415501
074156******************************************************************07415601
074157 3021-VALIDATE-PO.                                                07415701
074158     MOVE  ASC-PO-NUMBER   TO  DK-PO-NUMBER.                      07415899
074159     MOVE  ASC-OPER-UNIT   TO  DK-OPER-UNIT.                      07415999
074160                                                                  07416001
074170        EXEC SQL                                                  07417001
074180            SELECT  ORD_NBR                                       07418099
074190              INTO :RECEIV-ORD-NBR                                07419099
074200              FROM  TRECEIV                                       07420099
074300             WHERE  ORD_NBR      = :DK-PO-NUMBER                  07430099
074400               AND  OPER_UNT_ID  = :DK-OPER-UNIT                  07440099
074401               WITH UR                                            07440199
074402        END-EXEC                                                  07440201
074403                                                                  07440301
074404        EVALUATE TRUE                                             07440401
074405            WHEN SQLCODE = +0                                     07440501
074406            WHEN SQLCODE = -811                                   07440601
074407                CONTINUE                                          07440701
074408            WHEN SQLCODE = +100                                   07440801
074409                SET PS-ERROR                                      07440901
074410                    DP020-MSG-FATAL         TO TRUE               07441001
074411                MOVE PC-TSYMSG-03659        TO DP020-MSG-NUMBER   07441101
074412                MOVE SQLCA                  TO DP013-SQLCA        07441201
074413                MOVE DP015-UNP-ALP-BRT-OFF  TO APORDERA           07441303
074414                MOVE DP015-RED              TO APORDERC           07441403
074415                MOVE DP015-REVERSE          TO APORDERH           07441599
074416                MOVE -1                     TO APORDERL           07441699
074417**              MOVE SPACES                 TO ASC-PO-NUMBER      07441799
074418                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07441801
074419            WHEN SQLWARN0 NOT = SPACES                            07441901
074420            WHEN SQLCODE < +0                                     07442001
074421            WHEN SQLCODE > +0                                     07442101
074422                MOVE '3021-VALIDATE-PO'                           07442201
074423                                          TO DP013-PARAGRAPH      07442301
074424                MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)       07442401
074425                SET DP013-DB2-ABEND                               07442501
074426                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07442601
074427                PERFORM DP013-0000-PROCESS-ABEND                  07442701
074428        END-EVALUATE.                                             07442801
074429                                                                  07442901
075115                                                                  07511501
075116******************************************************************07511699
075117** LOOK UP LINE NUMBER ON TRECITM                               **07511701
075118******************************************************************07511801
075119 3030-VALIDATE-LINE-NO.                                           07511901
075120                                                                  07512001
075130     MOVE  ASC-PO-NUMBER   TO DK-PO-NUMBER.                       07513099
075140     MOVE  ASC-RCVR-NUMBER TO DK-RCVR-NUMBER.                     07514099
075141     MOVE  ASC-LINE-NO     TO DK-LINE-NUMBER.                     07514199
075142                                                                  07514201
075143        EXEC SQL                                                  07514301
075144            SELECT  ORD_NBR                                       07514499
075145                   ,REC_SEQ_NBR                                   07514599
075146                   ,ORD_LNE_NBR                                   07514699
075147              INTO :RECITM-ORD-NBR                                07514799
075148                  ,:RECITM-REC-SEQ-NBR                            07514899
075149                  ,:RECITM-ORD-LNE-NBR                            07514999
075150              FROM  TRECITM                                       07515099
075160             WHERE  ORD_NBR        = :DK-PO-NUMBER                07516099
075170               AND  REC_SEQ_NBR    = :DK-RCVR-NUMBER              07517099
075180               AND  ORD_LNE_NBR    = :DK-LINE-NUMBER              07518099
075190               AND  VER_STATUS_CDE = 'A'                          07519099
075191             WITH UR                                              07519199
075192        END-EXEC                                                  07519201
075193                                                                  07519301
075194        EVALUATE TRUE                                             07519401
075195            WHEN SQLCODE = +0                                     07519501
075196                CONTINUE                                          07519601
075197                                                                  07519701
075198            WHEN SQLCODE = +100                                   07519801
075199                SET PS-ERROR                                      07519901
075200                    DP020-MSG-FATAL         TO TRUE               07520001
075201                MOVE PC-TSYMSG-01729        TO DP020-MSG-NUMBER   07520101
075202                MOVE SQLCA                  TO DP013-SQLCA        07520201
075203                MOVE DP015-UNP-ALP-BRT-OFF  TO ALINENOA           07520303
075204                MOVE DP015-RED              TO ALINENOC           07520403
075205                MOVE DP015-REVERSE          TO ALINENOH           07520503
075206                MOVE -1                     TO ALINENOL           07520603
075207                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07520701
075208            WHEN SQLWARN0 NOT = SPACES                            07520801
075209            WHEN SQLCODE < +0                                     07520901
075210            WHEN SQLCODE > +0                                     07521001
075211                MOVE '3030-VALIDATE-LINE-NO'                      07521101
075212                                          TO DP013-PARAGRAPH      07521201
075213                MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME (1)       07521301
075214                SET DP013-DB2-ABEND                               07521401
075215                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07521501
075216                PERFORM DP013-0000-PROCESS-ABEND                  07521601
075217        END-EVALUATE.                                             07521701
075218                                                                  07521801
075219******************************************************************07521901
075220** LOOK UP LINE NUMBER ON TRECITM                               **07522001
075221******************************************************************07522101
075222 3040-VALIDATE-PACK-ID.                                           07522201
075223                                                                  07522301
075224     MOVE  ASC-PO-NUMBER   TO DK-PO-NUMBER.                       07522499
075225     MOVE  ASC-RCVR-NUMBER TO DK-RCVR-NUMBER.                     07522599
075226     MOVE  ASC-PACK-ID     TO DK-PACK-ID.                         07522699
075227                                                                  07522701
075228        EXEC SQL                                                  07522801
075229            SELECT  ORD_NBR                                       07522999
075230                   ,REC_SEQ_NBR                                   07523099
075240                   ,PREPK_ID                                      07524099
075250              INTO :RECITM-ORD-NBR                                07525099
075260                  ,:RECITM-REC-SEQ-NBR                            07526099
075270                  ,:RECITM-PREPK-ID                               07527099
075280              FROM  TRECITM                                       07528099
075290             WHERE  ORD_NBR        = :DK-PO-NUMBER                07529099
075300               AND  REC_SEQ_NBR    = :DK-RCVR-NUMBER              07530099
075400               AND  PREPK_ID       = :DK-PACK-ID                  07540099
075500               AND  VER_STATUS_CDE = 'A'                          07550099
075501             WITH UR                                              07550199
075502        END-EXEC                                                  07550201
075503                                                                  07550301
075504        EVALUATE TRUE                                             07550401
075505            WHEN SQLCODE = +0                                     07550501
075506            WHEN SQLCODE = -811                                   07550601
075507                CONTINUE                                          07550701
075508                                                                  07550801
075509            WHEN SQLCODE = +100                                   07550901
075510                SET PS-ERROR                                      07551001
075511                    DP020-MSG-FATAL         TO TRUE               07551101
075512                MOVE PC-TSYMSG-03638        TO DP020-MSG-NUMBER   07551201
075513                MOVE SQLCA                  TO DP013-SQLCA        07551301
075514                MOVE DP015-UNP-ALP-BRT-OFF  TO APACKIDA           07551403
075515                MOVE DP015-RED              TO APACKIDC           07551503
075516                MOVE DP015-REVERSE          TO APACKIDH           07551603
075517                MOVE -1                     TO APACKIDL           07551703
075518                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07551801
075519            WHEN SQLWARN0 NOT = SPACES                            07551901
075520            WHEN SQLCODE < +0                                     07552001
075521            WHEN SQLCODE > +0                                     07552101
075522                MOVE '3040-VALIDATE-PACK-ID'                      07552201
075523                                          TO DP013-PARAGRAPH      07552301
075524                MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME (1)       07552401
075525                SET DP013-DB2-ABEND                               07552501
075526                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07552601
075527                PERFORM DP013-0000-PROCESS-ABEND                  07552701
075528        END-EVALUATE.                                             07552801
075529                                                                  07552901
075530******************************************************************07553001
075531** LOOK UP AUDIT NUMBER ON SUT_PO_AUD_REQ                       **07553101
075532******************************************************************07553201
075533 3050-VALIDATE-AUDIT-NUMBER.                                      07553301
075534                                                                  07553401
075535     MOVE  ASC-AUDIT-NUMBER TO DK-AUDIT-NUMBER.                   07553599
075536     MOVE  ASC-OPER-UNIT    TO DK-OPER-UNIT.                      07553699
075537                                                                  07553701
075538        EXEC SQL                                                  07553801
075539            SELECT  AUD_CNTL_NBR                                  07553999
075540              INTO :SUT00102-AUD-CNTL-NBR                         07554099
075550              FROM  SUT_CART_DIRV_TRKG                            07555099
075560             WHERE  AUD_CNTL_NBR   = :DK-AUDIT-NUMBER             07556099
075570               AND  OPER_UNT_ID    = :DK-OPER-UNIT                07557099
075571             ORDER BY AUD_CNTL_NBR                                07557199
075572             FETCH FIRST ROW ONLY                                 07557299
075574             WITH UR                                              07557499
075575        END-EXEC                                                  07557501
075576                                                                  07557601
075577        EVALUATE TRUE                                             07557701
075578            WHEN SQLCODE = +0                                     07557801
075579                CONTINUE                                          07557901
075580                                                                  07558001
075581            WHEN SQLCODE = +100                                   07558101
075582                SET PS-ERROR                                      07558201
075583                    DP020-MSG-FATAL         TO TRUE               07558301
075584                MOVE PC-TSYMSG-02918        TO DP020-MSG-NUMBER   07558401
075585                MOVE SQLCA                  TO DP013-SQLCA        07558501
075586                MOVE DP015-UNP-ALP-BRT-OFF  TO AAUDNUMA           07558603
075587                MOVE DP015-RED              TO AAUDNUMC           07558703
075588                MOVE DP015-REVERSE          TO AAUDNUMH           07558803
075589                MOVE -1                     TO AAUDNUML           07558903
075590                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07559001
075591            WHEN SQLWARN0 NOT = SPACES                            07559101
075592            WHEN SQLCODE < +0                                     07559201
075593            WHEN SQLCODE > +0                                     07559301
075594                MOVE '3050-VALIDATE-AUDIT-NUMBER'                 07559401
075595                                       TO DP013-PARAGRAPH         07559501
075596                MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME (1)07559601
075597                SET DP013-DB2-ABEND                               07559701
075598                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07559801
075599                PERFORM DP013-0000-PROCESS-ABEND                  07559901
075600        END-EVALUATE.                                             07560001
075601                                                                  07560101
      ******************************************************************07560299
      ** LOOK UP DIRECTIVE REASON CODE IN TABLE SUT_CNVYR_DIRV_RSN    **07560399
      ******************************************************************07560499
       3055-VALIDATE-DIRECTIVE-CODE.                                    07560599
                                                                        07560699
              EXEC SQL                                                  07560799
                  SELECT  DIRV_RSN_CDE                                  07560899
                    INTO :SUT00101-DIRV-RSN-CDE                         07560999
                    FROM  SUT_CNVYR_DIRV_RSN                            07561099
                   WHERE  DIRV_RSN_CDE = :ASC-DIRCODE                   07561199
                   WITH UR                                              07561299
              END-EXEC                                                  07561399
                                                                        07561499
              EVALUATE TRUE                                             07561599
                  WHEN SQLCODE = +0                                     07561699
                      CONTINUE                                          07561799
                  WHEN SQLCODE = +100                                   07561999
                      SET PS-ERROR                                      07562099
                          DP020-MSG-FATAL         TO TRUE               07562199
                      MOVE PC-TSYMSG-03720        TO DP020-MSG-NUMBER   07562299
                      MOVE SQLCA                  TO DP013-SQLCA        07562399
                      MOVE DP015-UNP-ALP-BRT-OFF  TO ADIRCDEA           07562499
                      MOVE DP015-RED              TO ADIRCDEC           07562699
                      MOVE DP015-REVERSE          TO ADIRCDEH           07562899
                      MOVE -1                     TO ADIRCDEL           07563099
                      SET DP030-SET-CURSOR-APPL-1 TO TRUE               07563299
                  WHEN SQLWARN0 NOT = SPACES                            07563399
                  WHEN SQLCODE < +0                                     07563499
                  WHEN SQLCODE > +0                                     07563599
                      MOVE '3055-VALIDATE-DIRECTIVE-CODE'               07563699
                                             TO DP013-PARAGRAPH         07563799
                      MOVE 'SUT_CNVYR_DIRV_RSN'                         07563899
                                             TO DP013-DB2-TABLE-NAME (1)07563999
                      SET DP013-DB2-ABEND                               07564099
                          DP013-XCTL-DISPLAY-RESTART TO TRUE            07564199
                      PERFORM DP013-0000-PROCESS-ABEND                  07564299
              END-EVALUATE.                                             07564399
                                                                        07564499
075602******************************************************************07564501
075603** LOOK UP SET CODE/SET YEAR ON TSEASET                         **07564601
075604******************************************************************07564701
075605 3060-VALIDATE-SET-CODE.                                          07564801
075606                                                                  07564901
075607        EXEC SQL                                                  07565001
075608            SELECT  SEASET_SHRT_NM                                07565199
075609              INTO :SUT00102-SEASET-SHRT-NM                       07565299
075610              FROM  TSEASET                                       07565399
075611             WHERE  SEASET_SHRT_NM = :ASC-SETCODE                 07565499
075612               AND  SEASET_YR      = :ASC-SET-YEAR                07565599
075613             WITH UR                                              07565699
075614        END-EXEC                                                  07565701
075615                                                                  07565801
075616        EVALUATE TRUE                                             07565901
075617            WHEN SQLCODE = +0                                     07566001
075618                CONTINUE                                          07566101
075619                                                                  07566201
075620            WHEN SQLCODE = +100                                   07566301
075621                SET PS-ERROR                                      07566401
075622                    DP020-MSG-FATAL         TO TRUE               07566501
075623                MOVE PC-TSYMSG-03649        TO DP020-MSG-NUMBER   07566601
075624                MOVE SQLCA                  TO DP013-SQLCA        07566701
075625                MOVE DP015-UNP-ALP-BRT-OFF  TO ASETCDEA           07566803
075626                                               ASETYRA            07566903
075627                MOVE DP015-RED              TO ASETCDEC           07567003
075628                                               ASETYRC            07567103
075629                MOVE DP015-REVERSE          TO ASETCDEH           07567203
075630                                               ASETYRH            07567303
075631                MOVE -1                     TO ASETCDEL           07567403
075632                                               ASETYRL            07567503
075633                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07567601
075634            WHEN SQLWARN0 NOT = SPACES                            07567701
075635            WHEN SQLCODE < +0                                     07567801
075636            WHEN SQLCODE > +0                                     07567901
075637                MOVE '3060-VALIDATE-SET-CODE'                     07568001
075638                                       TO DP013-PARAGRAPH         07568101
075639                MOVE 'TSEASET'         TO DP013-DB2-TABLE-NAME (1)07568201
075640                SET DP013-DB2-ABEND                               07568301
075641                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07568401
075642                PERFORM DP013-0000-PROCESS-ABEND                  07568501
075643        END-EVALUATE.                                             07568601
075644                                                                  07568701
075645******************************************************************07568899
075646** CALCULATE BETWEEN FROM AND TO DATES                          **07568999
075647******************************************************************07569099
075648 3065-CALC-BETWEEN-DATES.                                         07569199
075649                                                                  07569299
075665        EXEC SQL                                                  07569399
075666            SELECT FUNC_QTY                                       07569499
075670              INTO :KRPRPM-FUNC-QTY                               07569599
075672              FROM  TKRPRPM                                       07569699
075673             WHERE  LOC_ID            =  90                       07569799
075674               AND  SYS_PRC_FUNC_CDE  = 'DRVHRS'                  07569899
075675               AND  INTFC_SYS_CDE     = 'KHL'                     07569999
075676               AND  FUNC_PRC_STAT_CDE = 'AC'                      07570099
075677             WITH UR                                              07570199
075678        END-EXEC.                                                 07570299
075679                                                                  07570399
075680        EVALUATE TRUE                                             07570499
075681            WHEN SQLCODE = +0                                     07570599
075682                CONTINUE                                          07570699
075683                                                                  07570799
075684            WHEN SQLWARN0 NOT = SPACES                            07570899
075685            WHEN SQLCODE < +0                                     07570999
075686            WHEN SQLCODE > +0                                     07571099
075687                MOVE '3065-CALC-BETWEEN-DATES'                    07571199
075688                                       TO DP013-PARAGRAPH         07571299
075689                MOVE 'TKRPRPM'         TO DP013-DB2-TABLE-NAME (1)07571399
075690                SET DP013-DB2-ABEND                               07571499
075691                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07571599
075692                PERFORM DP013-0000-PROCESS-ABEND                  07571699
075693        END-EVALUATE.                                             07571799
075694                                                                  07571899
075695******************************************************************07571999
075696** LOOK UP CART ID ON SUT_DIRV_TRKG -  BRCDE_NBR                **07572099
075697******************************************************************07572199
075698 3070-VALIDATE-CART-ID.                                           07572299
075699                                                                  07572399
075700     MOVE ASC-CART-ID     TO DK-CART-ID.                          07572499
075701     MOVE ASC-CART-ID-P   TO DK-CART-ID-PACKED.                   07572599
075702     MOVE ASC-OPER-UNIT   TO DK-OPER-UNIT.                        07572699
075703                                                                  07572799
075704        EXEC SQL                                                  07572899
075705            SELECT  BRCDE_NBR                                     07572999
075706                   ,SHIPT_UNT_ID                                  07573099
075707              INTO :SUT00102-BRCDE-NBR                            07573199
075710                  ,:SUT00102-SHIPT-UNT-ID                         07574099
075800              FROM  SUT_CART_DIRV_TRKG                            07580099
075900             WHERE  OPER_UNT_ID    = :DK-OPER-UNIT                07590099
076000               AND  BRCDE_NBR      = :DK-CART-ID                  07600099
076300             ORDER BY BRCDE_NBR                                   07630099
076301             FETCH FIRST ROW ONLY                                 07630199
076302             WITH UR                                              07630299
076303        END-EXEC                                                  07630301
076304                                                                  07630401
076305        EVALUATE TRUE                                             07630501
076306            WHEN SQLCODE = +0                                     07630601
076308                CONTINUE                                          07630801
076309                                                                  07630901
076310            WHEN SQLCODE = +100                                   07631001
076311                 PERFORM 3075-VALIDATE-CART-ID-2                  07631199
076312                                                                  07631299
076319            WHEN SQLWARN0 NOT = SPACES                            07631901
076320            WHEN SQLCODE < +0                                     07632001
076321            WHEN SQLCODE > +0                                     07632101
076322                MOVE '3070-VALIDATE-CART-ID'                      07632201
076323                                       TO DP013-PARAGRAPH         07632301
076324                MOVE 'SUT_CART_DIRV_TRKG'                         07632401
076325                                       TO DP013-DB2-TABLE-NAME (1)07632501
076326                MOVE DK-CART-ID        TO DP013-MESSAGE-TEXT (1)  07632699
076328                SET DP013-DB2-ABEND                               07632801
076329                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07632901
076330                PERFORM DP013-0000-PROCESS-ABEND                  07633001
076331        END-EVALUATE.                                             07633101
076332                                                                  07633201
076333                                                                  07633399
076334******************************************************************07633499
076335** LOOK UP CART ID ON SUT_DIRV_TRKG - BY SHIPT_UNT_ID           **07633599
076336******************************************************************07633699
076337 3075-VALIDATE-CART-ID-2.                                         07633799
076338                                                                  07633899
076343        EXEC SQL                                                  07634399
076344            SELECT  BRCDE_NBR                                     07634499
076345                   ,SHIPT_UNT_ID                                  07634599
076346              INTO :SUT00102-BRCDE-NBR                            07634699
076347                  ,:SUT00102-SHIPT-UNT-ID                         07634799
076348              FROM  SUT_CART_DIRV_TRKG                            07634899
076349             WHERE  OPER_UNT_ID    = :DK-OPER-UNIT                07634999
076350               AND  SHIPT_UNT_ID   = :DK-CART-ID-PACKED           07635099
076352             ORDER BY SHIPT_UNT_ID                                07635299
076353             FETCH FIRST ROW ONLY                                 07635399
076354             WITH UR                                              07635499
076355        END-EXEC                                                  07635599
076356                                                                  07635699
076357        EVALUATE TRUE                                             07635799
076358            WHEN SQLCODE = +0                                     07635899
076360                CONTINUE                                          07636099
076361                                                                  07636199
076362            WHEN SQLCODE = +100                                   07636299
076363                SET PS-ERROR                                      07636399
076364                    DP020-MSG-FATAL         TO TRUE               07636499
076365                MOVE PC-TSYMSG-03658        TO DP020-MSG-NUMBER   07636599
076366                MOVE SQLCA                  TO DP013-SQLCA        07636699
076367                MOVE DP015-UNP-ALP-BRT-OFF  TO ACARTIDA           07636799
076368                MOVE DP015-RED              TO ACARTIDC           07636899
076369                MOVE DP015-REVERSE          TO ACARTIDH           07636999
076370                MOVE -1                     TO ACARTIDL           07637099
076371                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07637199
076372            WHEN SQLWARN0 NOT = SPACES                            07637299
076373            WHEN SQLCODE < +0                                     07637399
076374            WHEN SQLCODE > +0                                     07637499
076375                MOVE '3070-VALIDATE-CART-ID'                      07637599
076376                                       TO DP013-PARAGRAPH         07637699
076377                MOVE 'SUT_CART_DIRV_TRKG'                         07637799
076378                                       TO DP013-DB2-TABLE-NAME (1)07637899
076379                MOVE DK-CART-ID        TO DP013-MESSAGE-TEXT (1)  07637999
076380                SET DP013-DB2-ABEND                               07638099
076381                    DP013-XCTL-DISPLAY-RESTART TO TRUE            07638199
076382                PERFORM DP013-0000-PROCESS-ABEND                  07638299
076383        END-EVALUATE.                                             07638399
076384                                                                  07638499
076385******************************************************************07638599
076386** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **07638699
076387** MAP.                                                         **07638799
076388******************************************************************07638899
076389 3200-RESET-ATTRIBUTES.                                           07638999
076390     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       07639099
076391     MOVE DP015-ASK-NOR-OFF        TO AOPRUNTA.                   07639199
076392     MOVE DP015-BLUE               TO ARCVPTYC.                   07639299
076393     MOVE -1                       TO APORDERL.                   07639399
076394     MOVE DP015-GREEN              TO AOPRUNTC                    07639499
076395                                      APORDERC                    07639599
076396                                      ARCVSEQC                    07639699
076397                                      ALINENOC                    07639799
076398                                      APACKIDC                    07639899
076399                                      AAUDNUMC                    07639999
076400                                      ACARTIDC                    07640099
076500                                      AOCASIC                     07650099
                                            ADIRCDEC                    07651099
076600                                      ASETCDEC                    07660099
076700                                      ASETYRC                     07670099
076800                                      ADRBYRC                     07680099
076810                                      ADRBMTC                     07681099
076820                                      ADATFDYC                    07682099
076830                                      ADATFHHC                    07683099
076840                                      ADATFMMC                    07684099
076901                                      ADREMTC                     07690199
076902                                      ADATEDYC                    07690299
076903                                      ADATEHHC                    07690399
076904                                      ADATEMMC                    07690499
076910                                      ADRENDC.                    07691099
077000     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPRUNTA                    07700099
077100                                      APORDERA                    07710099
077200                                      ARCVSEQA                    07720099
077300                                      ALINENOA                    07730099
077400                                      APACKIDA                    07740099
077500*                                     ARCVPTYA                    07750099
077600                                      AAUDNUMA                    07760099
077700                                      ACARTIDA                    07770099
077800                                      AOCASIA                     07780099
                                            ADIRCDEA                    07781099
077900                                      ASETCDEA                    07790099
078000                                      ASETYRA.                    07800099
078210                                                                  07821099
078220     MOVE DP015-UNP-NUM-NOR-OFF    TO ADRBYRA                     07822099
078221                                      ADRBMTA                     07822199
078222                                      ADATFDYA                    07822299
078223                                      ADATFHHA                    07822399
078224                                      ADATFMMA                    07822499
078228                                      ADRENDA                     07822899
078229                                      ADREMTA                     07822999
078230                                      ADATEDYA                    07823099
078231                                      ADATEHHA                    07823199
078232                                      ADATEMMA.                   07823299
078240                                                                  07824099
078300     MOVE DP015-UNDERLINE          TO AOPRUNTH                    07830099
078400                                      APORDERH                    07840099
078500                                      ARCVSEQH                    07850099
078600                                      ALINENOH                    07860099
078700                                      APACKIDH                    07870099
078800                                      AAUDNUMH                    07880099
078900                                      ACARTIDH                    07890099
079000                                      AOCASIH                     07900099
                                            ADIRCDEH                    07901099
079100                                      ASETCDEH                    07910099
079200                                      ASETYRH                     07920099
079300                                      ADRBYRH                     07930099
079301                                      ADRBMTH                     07930199
079302                                      ADATFDYH                    07930299
079303                                      ADATFHHH                    07930399
079304                                      ADATFMMH                    07930499
079305                                      ADREMTH                     07930599
079306                                      ADATEDYH                    07930699
079307                                      ADATEHHH                    07930799
079308                                      ADATEMMH                    07930899
079309                                      ADRENDH.                    07930999
079310*----------------------------------------------------------------*07931099
079311*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *07931199
079312*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *07931299
079313*  IT HERE.                                                      *07931399
079314*----------------------------------------------------------------*07931499
079315 4000-BUILD-INITIAL-PANEL.                                        07931599
079316                                                                  07931699
079317     PERFORM 4100-GET-OPER-UNIT-NAME.                             07931799
001850*DANH 12/15/2014                                                  07931899
079318     PERFORM 3065-CALC-BETWEEN-DATES.                             07931999
079318     PERFORM 2001-GET-DATES.                                      07932099
079319                                                                  07932199
079320                                                                  07932299
079321     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       07932399
079322                                                                  07932499
079323     MOVE ASC-OPER-UNIT            TO AOPRUNTO.                   07932599
079324     MOVE ASC-OPER-UNIT-NAME       TO AOPRNMEO.                   07932699
079341                                                                  07934199
079342****************************************************************  07934299
079343*    GET STORE INFORMATION.                                    *  07934399
079344****************************************************************  07934499
079345                                                                  07934599
079346 4100-GET-OPER-UNIT-NAME.                                         07934699
079347                                                                  07934799
079348     INITIALIZE XL071-COMMAREA.                                   07934899
079349     MOVE ASC-OPER-UNIT TO XL071-LOCATION-NUMBER.                 07934999
079350                                                                  07935099
079351     CALL XL071-LOCATION-MODULE USING                             07935199
079352                                DFHEIBLK                          07935299
079353                                XL071-COMMAREA                    07935399
079354                                XL071-COMMAREA-REC.               07935499
079355                                                                  07935599
079356     EVALUATE TRUE                                                07935699
079357         WHEN XL071-NO-ERRORS                                     07935799
079358         WHEN XL071-DC-ASGMT-NOT-FND                              07935899
079359              MOVE XL071-LOC-NM TO ASC-OPER-UNIT-NAME             07935999
079360                                                                  07936099
079361         WHEN XL071-LOC-NOT-FOUND                                 07936199
079362              MOVE 'STORE NAME NOT FOUND' TO ASC-OPER-UNIT-NAME   07936299
079363                                                                  07936399
079364         WHEN OTHER                                               07936499
079365              MOVE '4000-BUILD-INITIAL-PANEL'                     07936599
079366                                  TO DP013-PARAGRAPH              07936699
079367              STRING 'SELECT STORE NUMBER - '                     07936799
079368                      XL071-LOCATION-NUMBER                       07936899
079369                     ' - BAD RETURN CODE FROM XLKUT071 - '        07936999
079370                      XL071-RETURN-CODE                           07937099
079371                      DELIMITED BY SIZE                           07937199
079372                      INTO DP013-MESSAGE-TEXT (1)                 07937299
079373              STRING 'SQLCODE - '                                 07937399
079374                      XL071-SQLCODE                               07937499
079375                     ' - '                                        07937599
079376                      XL071-DB2-TABLE                             07937699
079377                      DELIMITED BY SIZE                           07937799
079378                      INTO DP013-MESSAGE-TEXT (2)                 07937899
079379              MOVE XL071-SQLCA     TO DP013-SQLCA                 07937999
079380              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    07938099
079381              MOVE XL071-SQLCODE TO SQLCODE                       07938199
079382              SET DP013-DB2-ABEND                                 07938299
079383                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07938399
079384              PERFORM DP013-0000-PROCESS-ABEND                    07938499
079385                                                                  07938599
079386     END-EVALUATE.                                                07938699
079387                                                                  07938799
079388*----------------------------------------------------------------*07938899
079389*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *07938999
079390*----------------------------------------------------------------*07939099
079391 4400-MOVE-COMMAREA-TO-SCREEN.                                    07939199
079392     MOVE ASC-OPER-UNIT            TO AOPRUNTO.                   07939299
      *CLP 09/24/2014                                                   07939399
079393     MOVE ASC-PO-NUMBER-8          TO APORDERO.                   07939499
079394     MOVE ASC-OPER-UNIT-NAME       TO AOPRNMEO.                   07939599
079395     MOVE ASC-RCVR-NUMBER          TO ARCVSEQO.                   07939699
079396     MOVE ASC-PACK-TYPE            TO ARCVPTYO.                   07939799
079397     MOVE ASC-LINE-NO              TO ALINENOO.                   07939899
079398     MOVE ASC-PACK-ID              TO APACKIDO.                   07939999
079399     MOVE ASC-PACK-TYPE            TO ARCVPTYO.                   07940099
079400     MOVE ASC-AUDIT-NUMBER         TO AAUDNUMO.                   07940199
079401     MOVE ASC-CART-ID              TO ACARTIDO.                   07940299
079402     MOVE ASC-CASI                 TO AOCASIO.                    07940399
           MOVE ASC-DIRCODE              TO ADIRCDEO.                   07940499
079403     MOVE ASC-SETCODE              TO ASETCDEO.                   07940599
079404     MOVE ASC-SET-YEAR             TO ASETYRO.                    07940699
079406     MOVE ASC-START-CCYY           TO ADRBYRO.                    07940799
079408     MOVE ASC-START-MM             TO ADRBMTO.                    07940899
079410     MOVE ASC-START-DD             TO ADATFDYO.                   07941099
079412     MOVE ASC-START-HH             TO ADATFHHO.                   07941299
079414     MOVE ASC-START-MN             TO ADATFMMO.                   07941499
079417     MOVE ASC-DATE-END             TO ADRENDO                     07941799
079418                                                                  07941899
079419     MOVE  ASC-END-CCYY            TO  ADRENDO.                   07941999
079421     MOVE  ASC-END-MM              TO  ADREMTO.                   07942199
079423     MOVE  ASC-END-DD              TO  ADATEDYO.                  07942399
079425     MOVE  ASC-END-HH              TO  ADATEHHO.                  07942599
079427     MOVE  ASC-END-MN              TO  ADATEMMO.                  07942799
079428                                                                  07942899
079429*----------------------------------------------------------------*07942999
079430*    ABEND PROCESSOR MODULE                                      *07943099
079431*----------------------------------------------------------------*07943199
079440                                                                  07944099
079500     COPY DPPD013.                                                07950099
