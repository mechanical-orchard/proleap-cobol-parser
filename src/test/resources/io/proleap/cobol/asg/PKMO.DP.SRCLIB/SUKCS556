000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    SUKCS556.                                         00040099
000500 AUTHOR.        LYNN MCADAMS.                                     00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  AUGUST, 2000.                                     00070099
000800 DATE-COMPILED.                                                   00080099
000900*----------------------------------------------------------------*00090099
001000*    S556 - PO REPORT REQUEST SCREEN.                            *00100099
001100*                                                                *00110099
001200*    THIS PROGRAM ALLOWS THE USER TO REQUEST ONE OR MORE         *00120099
001300*    CHECK-IN REPORTS.  THIS CAN BE DONE BY ENTERING AN 'S' OR   *00130099
001400*    'X' FOR ALL REPORTS OR BY ENTERING AN 'S' OR 'X' FOR        *00140099
001500*    SELECTING SPECIFIC REPORTS, THEN PRESSING F18-PRINT WHICH   *00150099
001600*    WILL SUBMIT A BATCH JOB TO CREATE THE REQUESTED REPORTS BY  *00160099
001700*    PO.                                                         *00170099
001800*                                                                *00180099
001900*    THIS SCREEN IS ACCESSED FROM THE PO/RECEIVER CHECK-IN       *00190099
002000*    STATUS SCREEN (SULPORCV).                                   *00200099
002100*                                                                *00210099
002100*                                                                *00210199
001130*    CHANGES:                                                     00211099
001110*            01/09/2023    BY JEAN KURK       WR: CHG0278099      00212099
001120*            CHANGE CALL OF DPKCS030 TO BE DYNAMIC                00213099
002200*----------------------------------------------------------------*00220099
002300                                                                  00230099
002400                                                                  00240099
002500 ENVIRONMENT DIVISION.                                            00250099
002600                                                                  00260099
002700 DATA DIVISION.                                                   00270099
002800                                                                  00280099
002900 WORKING-STORAGE SECTION.                                         00290099
003000                                                                  00300099
003100                                                                  00310099
003200 01  PV-PROGRAM-VARIABLES.                                        00320099
003300                                                                  00330099
003400     05  PV-QUEUE-ITEM-NBR        PIC S9(9) COMP-3 VALUE ZEROES.  00340099
003500                                                                  00350099
003600* DB2 TIMESTAMP FORMAT = CCYY-MM-DD-HH.MM.SS.999999               00360099
003700     05 PV-DB2-CURRENT-TMST       PIC  X(26).                     00370099
003800     05 FILLER REDEFINES PV-DB2-CURRENT-TMST.                     00380099
003900         10 PV-DB2-CURRENT-DATE   PIC  X(10).                     00390099
004000         10 PV-DB2-CURRENT-TIME   PIC  X(16).                     00400099
004100                                                                  00410099
004200     05  PV-SYSTEM-ID.                                            00420099
004300         10  FILLER                      PIC  X(04) VALUE SPACE.  00430099
004400         10  PV-REGION-IND               PIC  X(01).              00440099
004500             88  PV-TEST-CICS                 VALUE 'T'.          00450099
004600             88  PV-QA-CICS                   VALUE 'Q'.          00460099
004700             88  PV-PROD-CICS                 VALUE 'P'.          00470099
004800             88  PV-LEARN-CICS                VALUE 'L'.          00480099
004900         10  FILLER                      PIC X(03)  VALUE SPACE.  00490099
005000*    05  PV-PRINTER-DESTINATION          PIC X(08)  VALUE SPACE.  00500099
005100     05  PV-LEAVE-SYSTEM-MESSAGE         PIC X(160) VALUE SPACE.  00510099
005200     05  PV-JOB-DESCRIPTION              PIC X(13)  VALUE SPACE.  00520099
005300     05  PV-JOB-PROC                     PIC X(07)  VALUE SPACE.  00530099
005400     05  PV-JOB-NAME                     PIC X(07)  VALUE SPACE.  00540099
005500*                                                                 00550099
005600     05  PV-LOCATION.                                             00560099
005700         10  FILLER                      PIC X(01)  VALUE '0'.    00570099
005800         10  PV-DP020-LOCATION           PIC X(03)  VALUE '000'.  00580099
005900     05  PV-LOCATION-N REDEFINES PV-LOCATION                      00590099
006000                                         PIC 9(04).               00600099
006100     05  PV-REMAINDER                    PIC S9(04) VALUE +0      00610099
006200                                                    COMP SYNC.    00620099
006300     05  PV-SUB                          PIC S9(04) VALUE +0      00630099
006400                                                    COMP SYNC.    00640099
006500     05  PV-ITEM-SUB                     PIC S9(04) VALUE +0      00650099
006600                                                    COMP SYNC.    00660099
006700     05  PV-ITEM                         PIC S9(04) VALUE +0      00670099
006800                                                    COMP SYNC.    00680099
006900     05  PV-ITEM-IN-USE                  PIC S9(09) VALUE +0      00690099
007000                                                    COMP-3.       00700099
007100     05  PV-TOP-ITEM                     PIC S9(09) VALUE +0      00710099
007200                                                    COMP-3.       00720099
007300     05  PV-BOTTOM-ITEM                  PIC S9(09) VALUE +0      00730099
007400                                                    COMP-3.       00740099
007500     05  PV-BLOCK-NUMBER                 PIC S9(04) VALUE +0      00750099
007600                                                    COMP SYNC.    00760099
007700     05  PV-CICS-RESP                    PIC S9(04) VALUE +0      00770099
007800                                                    COMP SYNC.    00780099
007900     05  PV-CICS-RESPONSE                PIC S9(08) VALUE ZERO    00790099
008000                                                    COMP SYNC.    00800099
008100*                                                                 00810099
008200     05  PV-SUB1                         PIC S9(4)  COMP SYNC.    00820099
008300     05  PV-SUB2                         PIC S9(4)  COMP SYNC.    00830099
008400                                                                  00840099
008500     05  PV-SEL-TERM-ID                  PIC  X(04).              00850099
008600     05  PV-SEL-TASK-NUMBER              PIC  9(05).              00860099
008700     05  PV-SEL-SEQ                      PIC  9(01).              00870099
008800*                                                                 00880099
008900     05  PV-INPUT-FIELD                  PIC X(18).               00890099
009000     05  FILLER REDEFINES PV-INPUT-FIELD.                         00900099
009100         10  PV-INPUT-BYTES OCCURS 18 TIMES.                      00910099
009200             15  PV-IN-BYTE              PIC X(01).               00920099
009300                                                                  00930099
009400     05  PV-OUTPUT-FIELD                 PIC X(18).               00940099
009500     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        00950099
009600         10  PV-OUTPUT-BYTE OCCURS 18 TIMES.                      00960099
009700             15  PV-OUT-BYTE             PIC X(01).               00970099
009800*                                                                 00980099
009900     05  PV-SEL-QUEUE-ITEM               PIC S9(04) VALUE +0      00990099
010000                                                    COMP SYNC.    01000099
010100     05  PV-SAVE-ITEM                    PIC S9(04) VALUE +0      01010099
010200                                                    COMP SYNC.    01020099
010300     05  PV-HOLD-SELECTED-ITEMS          PIC S9(09) VALUE +0      01030099
010400                                                    COMP-3.       01040099
010500     05  PV-ORIGINAL-BLOCK               PIC S9(04) VALUE +0      01050099
010600                                                    COMP SYNC.    01060099
010700     05  PV-ITEMS-HOLD                   PIC S9(03) COMP-3.       01070099
010800     05  PV-ITEMS-DIFF                   PIC S9(03) COMP-3.       01080099
010900     05  PV-ITEMS-PROCESSED              PIC S9(09) VALUE +0      01090099
011000                                                    COMP-3.       01100099
011100     05  PV-HIGHEST-BLOCK-WRITTEN        PIC S9(04) VALUE +0      01110099
011200                                                    COMP SYNC.    01120099
011300     05  PV-LIST-ITEM-NUMBER             PIC S9(04) VALUE +0      01130099
011400                                                    COMP SYNC.    01140099
011500     05  PV-FIRST-BLOCK-IN-ARRAY         PIC S9(04) VALUE +0      01150099
011600                                                    COMP SYNC.    01160099
011700     05  PV-NEXT-BLOCK-IN-ARRAY          PIC S9(04) VALUE +0      01170099
011800                                                    COMP SYNC.    01180099
011900     05  PV-PREV-BLOCK-IN-ARRAY          PIC S9(04) VALUE +0      01190099
012000                                                    COMP SYNC.    01200099
012100     05  PV-FIRST-BLOCK-IN-RANGE         PIC S9(04) VALUE +0      01210099
012200                                                    COMP SYNC.    01220099
012300     05  PV-LAST-BLOCK-IN-RANGE          PIC S9(04) VALUE +0      01230099
012400                                                    COMP SYNC.    01240099
012500     05  PV-START-OF-SELECTED-RANGE      PIC S9(04) VALUE +0      01250099
012600                                                    COMP SYNC.    01260099
012700     05  PV-END-OF-SELECTED-RANGE        PIC S9(04) VALUE +0      01270099
012800                                                    COMP SYNC.    01280099
012900     05  PV-RETRY-COUNTER                PIC S9(04) VALUE +0      01290099
013000                                                    COMP SYNC.    01300099
013100******************************************************************01310099
013200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01320099
013300**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01330099
013400**  APPLICATION-SPECIFIC COMMAREA.                              **01340099
013500******************************************************************01350099
013600                                                                  01360099
013700                                                                  01370099
013800 01  PC-PROGRAM-CONSTANTS.                                        01380099
013900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SUK556'.   01390099
014000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM556 '. 01400099
014100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS556'. 01410099
014200     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE  'DPKCS060'. 01420099
014300*                                                                 01430099
014400     05  PC-REPORT-PGM             PIC  X(08)  VALUE  'SUKRP016'. 01440099
014500     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE   0001.      01450099
014600     05  PC-Y                      PIC  X(01)  VALUE  'Y'.        01460099
014700     05  PC-01                     PIC  X(02)  VALUE  '01'.       01470099
014800     05  PC-03                     PIC  X(02)  VALUE  '03'.       01480099
014900     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       01490099
015000     05  PC-INQ                    PIC  X(03)  VALUE  'INQ'.      01500099
015100     05  PC-UPD                    PIC  X(03)  VALUE  'UPD'.      01510099
015200     05  PC-DEL                    PIC  X(03)  VALUE  'DEL'.      01520099
015300     05  PC-ERR                    PIC  X(03)  VALUE  'ERR'.      01530099
015400     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE   1.         01540099
015500     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE   2.         01550099
015600     05  PC-PRINT-QUEUE-SEQ        PIC  9(01)  VALUE   3.         01560099
015700     05  PC-LIST-FORMAT            PIC  X(01)  VALUE  '1'.        01570099
015800     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE  +1          01580099
015900                                               COMP SYNC.         01590099
016000     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE  +2          01600099
016100                                               COMP SYNC.         01610099
016200     05  PC-MAX-ITEMS              PIC S9(09)  VALUE              01620099
016300                                               +1000000           01630099
016400                                               COMP-3.            01640099
016500     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE  +5          01650099
016600                                               COMP SYNC.         01660099
016700     05  PC-MAX-RETRIES            PIC S9(03)  VALUE   3          01670099
016800                                               COMP-3.            01680099
016900     05  PC-LEAVE-SYSTEM-LENGTH    PIC S9(04)  VALUE +160         01690099
017000                                               COMP SYNC.         01700099
017100     05  PC-STATUS-REPORT-DESC     PIC  X(13)  VALUE              01710099
017200         'STATUS REPORT'.                                         01720099
017300     05  PC-STATUS-REPORT-PROC     PIC  X(07)  VALUE              01730099
017400         'SUK9001'.                                               01740099
017500     05  PC-STATUS-REPORT-JOB      PIC  X(07)  VALUE              01750099
017600         'SUK900 '.                                               01760099
017700*----------------------------------------------------------------*01770099
017800*  SYSTEM MESSAGES FROM TSYMSG TABLE                             *01780099
017900*----------------------------------------------------------------*01790099
018000 01  PC-TSYMSG-AREA.                                              01800099
018100*  INVALID VALUE                                                  01810099
018200     05  PC-TSYMSG-00005             PIC 9(5) VALUE 00005.        01820099
018300*  REQUIRED ENTRY                                                 01830099
018400     05  PC-TSYMSG-00007             PIC 9(5) VALUE 00007.        01840099
018500*  MUST BE NUMERIC                                                01850099
018600     05  PC-TSYMSG-00008             PIC 9(5) VALUE 00008.        01860099
018700*  BOTTOM OF LIST                                                 01870099
018800     05  PC-TSYMSG-00070             PIC 9(5) VALUE 00070.        01880099
018900*  REPORT REQUEST SUCCESSFULLY SUBMITTED                          01890099
019000     05  PC-TSYMSG-00458             PIC 9(5) VALUE 00458.        01900099
019100*  INVALID PRINTER DESTINATION                                    01910099
019200     05  PC-TSYMSG-00746             PIC 9(5) VALUE 00746.        01920099
019300*  PRINTER ID MUST BE ENTERED FOR THIS SELECTION                  01930099
019400     05  PC-TSYMSG-01563             PIC 9(5) VALUE 01563.        01940099
019500*  REPORT(S) MUST BE SENT TO INFOPAC OR TO A PRINTER              01950099
019600     05  PC-TSYMSG-01736             PIC 9(5) VALUE 01736.        01960099
019700*  REPORTS MUST BE SENT TO INFOPAC OR A PRINTER - NOT BOTH        01970099
019800     05  PC-TSYMSG-01737             PIC 9(5) VALUE 01737.        01980099
019900*  ONE OR BOTH OF THE STATUS REPORTS MUST BE SELECTED             01990099
020000     05  PC-TSYMSG-01738             PIC 9(5) VALUE 01738.        02000099
020100*                                                                 02010099
020200     05  PC-TSYMSG-02433             PIC 9(5) VALUE 02433.        02020099
020300*  SELECT ALL REPTS OR INDIV RPTS                                 02030099
020400     05  PC-TSYMSG-02535             PIC 9(5) VALUE 02535.        02040099
020500*                                                                 02050099
020600     05  PC-MAX-RETRIES              PIC S9(03)  VALUE 3          02060099
020700                                                 COMP-3.          02070099
020800*                                                                 02080099
020900 01  PS-PROGRAM-SWITCHES.                                         02090099
021000     05  PS-ERROR-SW                 PIC  X(01)  VALUE  'N'.      02100099
021100         88  PS-ERROR                            VALUE  'Y'.      02110099
021200         88  PS-NO-ERROR                         VALUE  'N'.      02120099
021300     05  PS-LIST-END-SW              PIC  X(01)  VALUE  'N'.      02130099
021400         88  PS-LIST-END                         VALUE  'Y'.      02140099
021500         88  PS-NO-LIST-END                      VALUE  'N'.      02150099
021600     05  PS-EDIT-ERROR-IND           PIC X(1)    VALUE 'N'.       02160099
021700         88  PS-NO-EDIT-ERROR                    VALUE 'N'.       02170099
021800         88  PS-EDIT-ERROR                       VALUE 'Y'.       02180099
021900     05  PS-COMMAREA-SW              PIC  X(01)  VALUE  'N'.      02190099
022000         88  PS-COMMAREA-VALID                   VALUE  'Y'.      02200099
022100         88  PS-COMMAREA-NOT-VALID               VALUE  'N'.      02210099
022200     05  PS-ALL-RPTS-CHKD-SW         PIC  X(01)  VALUE  'N'.      02220099
022300         88  PS-ALL-RPTS-CHKD                    VALUE  'Y'.      02230099
022400         88  PS-ALL-RPTS-NOT-CHKD                VALUE  'N'.      02240099
022500     05  PS-STATS-RPT-CHKD-SW        PIC  X(01)  VALUE  'N'.      02250099
022600         88  PS-STATS-RPT-CHKD                   VALUE  'Y'.      02260099
022700         88  PS-STATS-RPT-NOT-CHKD               VALUE  'N'.      02270099
022800     05  PS-PO-STR-RPT-CHKD-SW       PIC  X(01)  VALUE  'N'.      02280099
022900         88  PS-PO-STR-RPT-CHKD                  VALUE  'Y'.      02290099
023000         88  PS-PO-STR-RPT-NOT-CHKD              VALUE  'N'.      02300099
023100     05  PS-CRTNS-RPT-CHKD-SW        PIC  X(01)  VALUE  'N'.      02310099
023200         88  PS-CRTNS-RPT-CHKD                   VALUE  'Y'.      02320099
023300         88  PS-CRTNS-RPT-NOT-CHKD               VALUE  'N'.      02330099
023400     05  PS-FR-ASTRY-RPT-CHKD-SW     PIC  X(01)  VALUE  'N'.      02340099
023500         88  PS-FR-ASTRY-RPT-CHKD                VALUE  'Y'.      02350099
023600         88  PS-FR-ASTRY-RPT-NOT-CHKD            VALUE  'N'.      02360099
023700     05  PS-MISDIRECT-RPT-CHKD-SW    PIC  X(01)  VALUE  'N'.      02370099
023800         88  PS-MISDIRECT-RPT-CHKD               VALUE  'Y'.      02380099
023900         88  PS-MISDIRECT-RPT-NOT-CHKD           VALUE  'N'.      02390099
024000     05  PS-DUP-SCAN-RPT-CHKD-SW     PIC  X(01)  VALUE  'N'.      02400099
024100         88  PS-DUP-SCAN-RPT-CHKD                VALUE  'Y'.      02410099
024200         88  PS-DUP-SCAN-RPT-NOT-CHKD            VALUE  'N'.      02420099
024300     05  PS-SCAN-NT-FND-RPT-CHKD-SW  PIC  X(01)  VALUE  'N'.      02430099
024400         88  PS-SCAN-NT-FND-RPT-CHKD             VALUE  'Y'.      02440099
024500         88  PS-SCAN-NT-FND-RPT-NOT-CHKD         VALUE  'N'.      02450099
024600     05  PS-UNUSED-LBLS-RPT-CHKD-SW  PIC  X(01)  VALUE  'N'.      02460099
024700         88  PS-UNUSED-LBLS-RPT-CHKD             VALUE  'Y'.      02470099
024800         88  PS-UNUSED-LBLS-RPT-NOT-CHKD         VALUE  'N'.      02480099
024900     05  PS-ABEND-IND                PIC X(01)   VALUE 'N'.       02490099
025000         88  PS-NO-ABEND-IN-PROGRESS             VALUE 'N'.       02500099
025100         88  PS-ABEND-IN-PROGRESS                VALUE 'Y'.       02510099
025200     05  PS-INTERNAL-READER-ENQ-DEQ-IND                           02520099
025300                                     PIC X(01)   VALUE 'D'.       02530099
025400         88  PS-INTERNAL-READER-ENQUEUED         VALUE 'E'.       02540099
025500         88  PS-INTERNAL-READER-DEQUEUED         VALUE 'D'.       02550099
025600                                                                  02560099
025700 01  SE-SYSTEM-ERROR-MESSAGE.                                     02570099
025800     05  FILLER                      PIC X(43)   VALUE            02580099
025900         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.           02590099
026000     05  FILLER                      PIC X(33)   VALUE            02600099
026100         'PROGRAM RFKCS215       EIBRESP = '.                     02610099
026200     05  SE-CICS-RESPONSE            PIC 9(4)    VALUE ZERO.      02620099
026300     05  FILLER                      PIC X(5)    VALUE SPACE.     02630099
026400     05  FILLER                      PIC X(14)   VALUE            02640099
026500         'ATTEMPTING TO '.                                        02650099
026600     05  SE-ATTEMPTED-ACTION         PIC X(61)   VALUE SPACE.     02660099
026700                                                                  02670099
026800 01  PM-PROGRAM-MESSAGES.                                         02680099
026900     05  PM-ABEND-INFO-A.                                         02690099
027000         10  FILLER                  PIC X(15)   VALUE            02700099
027100                                     'DP020-SRC-AID: '.           02710099
027200         10  PM-A-SRC-AID            PIC X(02)   VALUE  SPACE.    02720099
027300         10  FILLER                  PIC X(19)   VALUE            02730099
027400                                     '. DP020-FK-ACTION: '.       02740099
027500         10  PM-A-FK-ACTION          PIC X(01)   VALUE  SPACE.    02750099
027600         10  FILLER                  PIC X(22)   VALUE            02760099
027700                                     '. DP020-FK-DISPN-IND: '.    02770099
027800         10  PM-A-FK-DISPN           PIC X(01)   VALUE  SPACE.    02780099
027900         10  FILLER                  PIC X(01)   VALUE '.'.       02790099
028000         10  FILLER                  PIC X(19)   VALUE SPACE.     02800099
028100                                                                  02810099
028200******************************************************************02820099
028300*  JCL LINES FOR REQUESTING THE COMPLETION/EXCEPTION REPORTS      02830099
028400******************************************************************02840099
028500                                                                  02850099
028600 01  JL-JCL-LINE-AREA.                                            02860099
028700     05  JL-JCL-LINE-1           PIC X(80).                       02870099
028800     05  JL-JOB-LINE-PROD.                                        02880099
028900         10  FILLER              PIC X(21)    VALUE               02890099
029000             '//SUK900   JOB KOHLS,'.                             02900099
029100         10  FILLER              PIC X(1)     VALUE QUOTE.        02910099
029200         10  FILLER              PIC X(13)    VALUE               02920099
029300             'REPORTS PRINT'.                                     02930099
029400         10  FILLER              PIC X(1)     VALUE QUOTE.        02940099
029500         10  FILLER              PIC X(19)    VALUE               02950099
029600             ',MSGCLASS=P,CLASS=Q'.                               02960099
029700         10  FILLER              PIC X(16)    VALUE SPACE.        02970099
029800     05  JL-JOB-LINE-TEST.                                        02980099
029900         10  FILLER              PIC X(02)    VALUE               02990099
030000             '//'.                                                03000099
030100         10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACE.        03010099
030200         10  FILLER              PIC X(01)    VALUE               03020099
030300             'Q'.                                                 03030099
030400         10  FILLER              PIC X(11)    VALUE               03040099
030500             ' JOB KOHLS,'.                                       03050099
030600         10  FILLER              PIC X(1)     VALUE QUOTE.        03060099
030700         10  FILLER              PIC X(13)    VALUE               03070099
030800             'REPORTS PRINT'.                                     03080099
030900         10  FILLER              PIC X(1)     VALUE QUOTE.        03090099
031000         10  FILLER              PIC X(19)    VALUE               03100099
031100             ',MSGCLASS=X,CLASS=E'.                               03110099
031200         10  FILLER              PIC X(18)    VALUE SPACE.        03120099
031300     05  JL-JCL-LINE-3.                                           03130099
031400         10  FILLER              PIC X(13)    VALUE               03140099
031500             '/*JOBPARM K=0'.                                     03150099
031600         10  FILLER              PIC X(67)    VALUE SPACE.        03160099
031700     05  JL-JCL-LINE-4-PROD.                                      03170099
031800         10  FILLER              PIC X(39)    VALUE               03180099
031900             '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.           03190099
032000         10  FILLER              PIC X(41)    VALUE SPACE.        03200099
032100     05  JL-JCL-LINE-4-TEST.                                      03210099
032200         10  FILLER              PIC X(39)    VALUE               03220099
032300             '//JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR'.           03230099
032400         10  FILLER              PIC X(41)    VALUE SPACE.        03240099
032500     05  JL-JCL-LINE-4-QA.                                        03250099
032600         10  FILLER              PIC X(39)    VALUE               03260099
032700             '//JOBLIB   DD DSN=QKMO.LOADLIB,DISP=SHR'.           03270099
032800         10  FILLER              PIC X(41)    VALUE SPACE.        03280099
032900     05  JL-JCL-LINE-4-LRN.                                       03290099
033000         10  FILLER              PIC X(39)    VALUE               03300099
033100             '//JOBLIB   DD DSN=LKMO.LOADLIB,DISP=SHR'.           03310099
033200         10  FILLER              PIC X(41)    VALUE SPACE.        03320099
033700     05  JL-JCL-LINE-12.                                          03370099
033800         10  FILLER              PIC X(17)    VALUE               03380099
033900             '//PS020    EXEC '.                                  03390099
034000         10  JL-LINE-12-PROC     PIC X(06)    VALUE               03400099
034100             'SUK900'.                                            03410099
034200         10  JL-LINE-12-PROC-T   PIC X(01)    VALUE SPACE.        03420099
034300         10  JL-LINE-12-PROC-T2  PIC X(01)    VALUE SPACE.        03430099
034400         10  FILLER              PIC X(56)    VALUE SPACE.        03440099
034500     05  JL-JCL-LINE-13.                                          03450099
034600         10  FILLER              PIC  X(34)  VALUE                03460099
034700             '//JOBOUT01 OUTPUT FORMS=STD,FCB=8S'.                03470099
034800         10  FILLER              PIC  X(17)  VALUE                03480099
034900             ',CLASS=A,COPIES=1'.                                 03490099
035000         10  FILLER              PIC  X(06)  VALUE                03500099
035100             ',DEST='.                                            03510099
035200         10  JL-LINE-13-PRINTER  PIC  X(08)  VALUE SPACE.         03520099
035300         10  FILLER              PIC  X(16)  VALUE SPACE.         03530099
035400*    05  JL-JCL-LINE-AUTO-SCHD.                                   03540099
035500*        10  FILLER              PIC X(40)  VALUE                 03550099
035600*            '//$AUTO    EXEC PGM=$A,COND=(0,LE),PARM='.          03560099
035700*        10  FILLER              PIC X(01)  VALUE QUOTE.          03570099
035800*        10  FILLER              PIC X(01)  VALUE '>'.            03580099
035900*        10  FILLER              PIC X(01)  VALUE QUOTE.          03590099
036000*        10  FILLER              PIC X(37)  VALUE SPACE.          03600099
036100*BUILD TRIP CONTROL CARD-SUCC005                                  03610099
036200     05  JL-JCL-LINE-14.                                          03620099
036300         10  FILLER              PIC X(18)    VALUE               03630099
036400             '//S010.SYSUT1 DD *'.                                03640099
036500         10  FILLER              PIC X(62)    VALUE SPACE.        03650099
036600     05  JL-JCL-LINE-15.                                          03660099
036700         10  JL-LINE-15-MANIFEST PIC X(09).                       03670099
036800         10  FILLER              PIC X(01)    VALUE SPACE.        03680099
036900         10  JL-LINE-15-USER-ID  PIC X(08).                       03690099
037000         10  FILLER              PIC X(01)    VALUE SPACE.        03700099
037100         10  JL-LINE-15-TIMESTMP PIC X(26).                       03710099
037200         10  FILLER              PIC X(36)    VALUE SPACE.        03720099
037300*BUILD PRINTER CONTROL CARD-SUCC006                               03730099
037400     05  JL-JCL-LINE-16.                                          03740099
037500         10  FILLER              PIC X(18)    VALUE               03750099
037600             '//S035.SYSUT1 DD *'.                                03760099
037700         10  FILLER              PIC X(62)    VALUE SPACE.        03770099
037800     05  JL-JCL-LINE-17.                                          03780099
037900         10  JL-LINE-17-PRINTER  PIC X(08)    VALUE SPACE.        03790099
038000         10  JL-LINE-17-PRTR-IND PIC X(01)    VALUE SPACE.        03800099
038100         10  JL-LINE-17-TRACK-NBR                                 03810099
038200                                 PIC  9(1)    VALUE 0.            03820099
038300         10  FILLER              PIC X(01)    VALUE SPACE.        03830099
038400         10  JL-LINE-17-CUT-RPT  PIC X(01)    VALUE SPACE.        03840099
038500         10  JL-LINE-17-USER-ID  PIC X(08)    VALUE SPACE.        03850099
038600         10  JL-LINE-17-STAT-RPT PIC X(01)    VALUE SPACE.        03860099
038700         10  JL-LINE-17-CRTN-RPT PIC X(01)    VALUE SPACE.        03870099
038800         10  JL-LINE-17-MSDR-RPT PIC X(01)    VALUE SPACE.        03880099
038900         10  JL-LINE-17-FREE-RPT PIC X(01)    VALUE SPACE.        03890099
039000         10  JL-LINE-17-DUPL-RPT PIC X(01)    VALUE SPACE.        03900099
039100         10  JL-LINE-17-WRKS-RPT PIC X(01)    VALUE SPACE.        03910099
039200         10  JL-LINE-17-SCAN-RPT PIC X(01)    VALUE SPACE.        03920099
039300         10  JL-LINE-17-ULBL-RPT PIC X(01)    VALUE SPACE.        03930099
039400         10  FILLER              PIC X(01)    VALUE SPACE.        03940099
039500         10  JL-LINE-17-ALL-PO-IND                                03950099
039600                                 PIC X(01)    VALUE SPACE.        03960099
039700         10  FILLER              PIC X(50)    VALUE SPACE.        03970099
039800     05  JL-JCL-LINE-EOF.                                         03980099
039900         10  FILLER              PIC X(5)     VALUE '/*EOF'.      03990099
040000         10  FILLER              PIC X(75)    VALUE SPACE.        04000099
040100                                                                  04010099
040200 01  TD-TRANSIENT-DATA-AREA.                                      04020099
040300     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       04030099
040400     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            04040099
040500                                 COMP SYNC.                       04050099
040600     05  TD-JCL-LINE             PIC X(80)    VALUE SPACE.        04060099
040700     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           04070099
040800                                 COMP SYNC.                       04080099
040900                                                                  04090099
041000*---------------------------------------------------------------* 04100099
041100*  RECORD LAYOUT FOR THE LIST INPUT                             * 04110099
041200*---------------------------------------------------------------* 04120099
041300     COPY SUWS004.                                                04130099
041400                                                                  04140099
041500*----------------------------------------------------------------*04150099
041600*    MAP LAYOUT                                                  *04160099
041700*----------------------------------------------------------------*04170099
041800                                                                  04180099
041900     COPY SUKM556.                                                04190099
042000     EJECT                                                        04200099
042100                                                                  04210099
042200*----------------------------------------------------------------*04220099
042300*  SENDING/RECEIVING AREA FOR THE                                *04230099
042400*  PRINTER VALIDATION ROUTINE (DPKCS060)                         *04240099
042500*----------------------------------------------------------------*04250099
042600     COPY DPWS072.                                                04260099
042700                                                                  04270099
042800*----------------------------------------------------------------*04280099
042900*    ATTRIBUTE SETTINGS COPYBOOK.                                *04290099
043000*----------------------------------------------------------------*04300099
043100                                                                  04310099
043200     COPY DPWS015.                                                04320099
043300                                                                  04330099
043400*----------------------------------------------------------------*04340099
043500*    FUNCTION KEYS COPYBOOK                                      *04350099
043600*----------------------------------------------------------------*04360099
043700                                                                  04370099
043800     COPY DPWS016.                                                04380099
043900 EJECT                                                            04390099
044000******************************************************************04400099
044100** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **04410099
044200** SUB-ROUTINE (DPKUT100).                                      **04420099
044300******************************************************************04430099
044400     COPY DPWS010I.                                               04440099
044500 EJECT                                                            04450099
044600******************************************************************04460099
044700** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **04470099
044900******************************************************************04490099
045000     COPY DPWS030.                                                04500099
045000     COPY DPWS930.                                                04501099
045100 EJECT                                                            04510099
045200***************************************************************** 04520099
045300*    STANDARD COMMAREA.                                           04530099
045400***************************************************************** 04540099
045500                                                                  04550099
045600     COPY DPWS020.                                                04560099
045700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04570099
045800                                                                  04580099
045900*---------------------------------------------------------------* 04590099
046000* INTER-APPLICATION COMMAREA.                                   * 04600099
046100*   SUWS003 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM      * 04610099
046200*             THE LIST SCREEN.                                  * 04620099
046300*---------------------------------------------------------------* 04630099
046400         10  INTER-APPL-COMM-AREA       PIC X(200).               04640099
046500     COPY SUWS003.                                                04650099
046600                                                                  04660099
046700***************************************************************** 04670099
046800*    SPECIFIC COMMMAREA FOR DSKCS601.                             04680099
046900***************************************************************** 04690099
047000         10  ASC-SPECIFIC-COMMAREA.                               04700099
047100             15  ASC-LIST-KEYS.                                   04710099
047200                 20  ASC-PRTR-DEST                   PIC  X(08).  04720099
047300                 20  ASC-USER-ID                     PIC  X(08).  04730099
047400                 20  ASC-RQST-TMST                   PIC  X(26).  04740099
047500                 20  ASC-OPER-UNT-ID                 PIC S9(04)   04750099
047600                                                           COMP.  04760099
047700                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   04770099
047800                                                           COMP.  04780099
047900                 20  ASC-FCLTY-ID                    PIC S9(04)   04790099
048000                                                           COMP.  04800099
048100                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   04810099
048200                                                           COMP.  04820099
048300                 20  ASC-FCLTY-NME                   PIC  X(25).  04830099
048400                 20  ASC-SCAC-ID                     PIC  X(04).  04840099
048500                 20  ASC-VEH-NBR                     PIC  X(10).  04850099
048600                 20  ASC-TRIP-ID                     PIC S9(09)   04860099
048700                                                           COMP.  04870099
048800                 20  ASC-ALL-PO-IND                  PIC  X(01).  04880099
048900                     88  ASC-ALL-PO-NBRS             VALUE 'Y'.   04890099
049000                     88  ASC-NOT-ALL-PO-NBRS         VALUE 'N'.   04900099
049100             15  ASC-SEL-QUEUE-NAME-ORIG.                         04910099
049200                 20  ASC-SEL-TERM-ID-ORIG     PIC  X(04).         04920099
049300                 20  ASC-SEL-TASK-NUMBER-ORIG PIC S9(05) COMP-3.  04930099
049400                 20  ASC-SEL-SEQ-ORIG         PIC  9(01).         04940099
049500                                                                  04950099
049600             15  ASC-ALL-RPTS                PIC  X(01).          04960099
049700             15  ASC-STS-RPT                 PIC  X(01).          04970099
049800             15  ASC-PO-RPT                  PIC  X(01).          04980099
049900             15  ASC-NOT-RCVD-RPT            PIC  X(01).          04990099
050000             15  ASC-FR-ASTY-RPT             PIC  X(01).          05000099
050100             15  ASC-MISDIR-RPT              PIC  X(01).          05010099
050200             15  ASC-DUP-SCAN-RPT            PIC  X(01).          05020099
050300             15  ASC-NOT-FND-RPT             PIC  X(01).          05030099
050400             15  ASC-UNUSED-LBLS-RPT         PIC  X(01).          05040099
050500                                                                  05050099
050600             15  ASC-BLK-SUB                 PIC S9(04)           05060099
050700                                                  COMP            05070099
050800                                                  SYNC.           05080099
050900             15  ASC-PRT-QUEUE-NAME.                              05090099
051000                 20  ASC-PRT-TERM-ID          PIC  X(04).         05100099
051100                 20  ASC-PRT-TASK-NUMBER      PIC S9(05) COMP-3.  05110099
051200                 20  ASC-PRT-SEQ              PIC  9(01).         05120099
051300             15  ASC-ITEM-SUB                PIC S9(04)           05130099
051400                                                  COMP            05140099
051500                                                  SYNC.           05150099
051600             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05160099
051700                                                          COMP-3. 05170099
051800             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05180099
051900                                                          COMP-3. 05190099
052000             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05200099
052100                                                          COMP-3. 05210099
052200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05220099
052300                                                          COMP-3. 05230099
052400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05240099
052500                                                          COMP-3. 05250099
052600             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05260099
052700                                                          COMP    05270099
052800                                                          SYNC.   05280099
052900             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05290099
053000                                                          COMP-3. 05300099
053100             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05310099
053200                                                          COMP-3. 05320099
053300             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05330099
053400                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05340099
053500                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05350099
053600             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05360099
053700                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05370099
053800                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05380099
053900             15  ASC-LIST-QUEUE-NAME.                             05390099
054000                 20  ASC-LIST-TERM-ID                PIC  X(04).  05400099
054100                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05410099
054200                                                          COMP-3. 05420099
054300                 20  ASC-LIST-SEQ                    PIC  9(01).  05430099
054400             15  ASC-SEL-QUEUE-NAME.                              05440099
054500                 20  ASC-SEL-TERM-ID          PIC  X(04).         05450099
054600                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05460099
054700                 20  ASC-SEL-SEQ              PIC  9(01).         05470099
054800             15  ASC-SEL-QUEUE-NAME-IN.                           05480099
054900                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05490099
055000                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05500099
055100                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05510099
055200             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05520099
055300                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05530099
055400             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05540099
055500             15  ASC-START-ITEM-REQUEST.                          05550099
055600                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05560099
055700             15  ASC-SEL-SUB                  PIC  S9(4) COMP.    05570099
055800             15  ASC-SEL-ITEM                 PIC  S9(4) COMP.    05580099
055900             15  ASC-PO-NBR                   PIC  S9(9) COMP.    05590099
056000             15  ASC-FIRST-PASS-SW            PIC   X(1).         05600099
056100                 88  ASC-FIRST-PASS                     VALUE 'Y'.05610099
056200                 88  ASC-NOT-FIRST-PASS                 VALUE 'N'.05620099
056300                                                                  05630099
056400     EJECT                                                        05640099
056500                                                                  05650099
056600*----------------------------------------------------------------*05660099
056700*    ABEND PROCESSING COPYBOOK.                                  *05670099
056800*----------------------------------------------------------------*05680099
056900                                                                  05690099
057000     COPY DPWS013.                                                05700099
057100                                                                  05710099
057200*----------------------------------------------------------------*05720099
057300*    DB2 AREA FOR EXTERNAL ENTITY TABLE                          *05730099
057400*----------------------------------------------------------------*05740099
057500                                                                  05750099
057600     EXEC SQL                                                     05760099
057700          INCLUDE TEXTENT                                         05770099
057800     END-EXEC.                                                    05780099
057900                                                                  05790099
059600*----------------------------------------------------------------*05960099
059700*    DB2 AREA FOR TRIP TABLE                                     *05970099
059800*----------------------------------------------------------------*05980099
059900                                                                  05990099
060000     EXEC SQL                                                     06000099
060100          INCLUDE TVHTRIP                                         06010099
060200     END-EXEC.                                                    06020099
060300                                                                  06030099
060400*----------------------------------------------------------------*06040099
060500*    DB2 AREA FOR TRIP STATUS TABLE                              *06050099
060600*----------------------------------------------------------------*06060099
060700                                                                  06070099
060800     EXEC SQL                                                     06080099
060900          INCLUDE TTRIPST                                         06090099
061000     END-EXEC.                                                    06100099
061100                                                                  06110099
061200*----------------------------------------------------------------*06120099
061300*    DB2 AREA FOR SHIP UNIT TABLE                                *06130099
061400*----------------------------------------------------------------*06140099
061500                                                                  06150099
061600     EXEC SQL                                                     06160099
061700          INCLUDE TSHPUNT                                         06170099
061800     END-EXEC.                                                    06180099
061900                                                                  06190099
062000*----------------------------------------------------------------*06200099
062100*    DB2 AREA FOR VEHICLE TABLE                                  *06210099
062200*----------------------------------------------------------------*06220099
062300                                                                  06230099
062400     EXEC SQL                                                     06240099
062500          INCLUDE TVEHICL                                         06250099
062600     END-EXEC.                                                    06260099
063400*----------------------------------------------------------------*06340099
063500*    DB2 AREA FOR RECEIV   TABLE                                  06350099
063600*----------------------------------------------------------------*06360099
063700                                                                  06370099
063800     EXEC SQL                                                     06380099
063900          INCLUDE TRECEIV                                         06390099
064000     END-EXEC.                                                    06400099
064100******************************************************************06410099
064200*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SU REPORT REQUEST  06420099
064300*  TABLE                                                          06430099
064400******************************************************************06440099
064500     EXEC SQL                                                     06450099
064600          INCLUDE TSURPRQ                                         06460099
064700     END-EXEC.                                                    06470099
064800                                                                  06480099
064900*----------------------------------------------------------------*06490099
065000                                                                  06500099
065100*  COMMUNICATION AREAS FOR DB2                                    06510099
065200*                                                                 06520099
065300     EXEC SQL                                                     06530099
065400         INCLUDE SQLCA                                            06540099
065500     END-EXEC.                                                    06550099
065600*----------------------------------------------------------------*06560099
065700                                                                  06570099
065800 EJECT                                                            06580099
065900 LINKAGE SECTION.                                                 06590099
066000                                                                  06600099
066100 01  DFHCOMMAREA.                                                 06610099
066200     05  FILLER                         OCCURS  1 TO 4072 TIMES   06620099
066300                                        DEPENDING ON EIBCALEN.    06630099
066400         10  FILLER                     PIC X.                    06640099
066500                                                                  06650099
066600                                                                  06660099
066700 PROCEDURE DIVISION.                                              06670099
066800***************************************************************** 06680099
066900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 06690099
067000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 06700099
067100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 06710099
067200**                                                             ** 06720099
067300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 06730099
067400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 06740099
067500***************************************************************** 06750099
067600 0000-MAIN-MODULE.                                                06760099
067700     INITIALIZE DP030-CICS-API-FIELDS.                            06770099
067800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06780099
067900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06790099
068000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06800099
068100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06810099
068200     MOVE LENGTH OF SUK556I        TO DP030-MAP-LENGTH (1).       06820099
068300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06830099
068400     PERFORM 0001-CALL-CICS-ARCH-API.                             06840099
068500                                                                  06850099
068600     PERFORM 1000-CONTROL-PROCESSING                              06860099
068700                                                                  06870099
068800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06880099
068900     PERFORM 0001-CALL-CICS-ARCH-API.                             06890099
069000*                                                                 06900099
069100*                                                                 06910099
069200 0001-CALL-CICS-ARCH-API.                                         06920099
069300                                                                  06930099
069400*    CALL 'DPKCS030' USING DFHEIBLK                               06940099
069400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06941099
069500                           DFHCOMMAREA                            06950099
069600                           DP030-CICS-API-FIELDS                  06960099
069700                           DP020-STANDARD-COMMAREA                06970099
069800                           SUK556I.                               06980099
069900                                                                  06990099
070000     IF  DP030-RC-CALL-SUCCESSFUL                                 07000099
070100         CONTINUE                                                 07010099
070200     ELSE                                                         07020099
070300         SET DP013-NO-ROLLBACK                                    07030099
070400             DP013-XCTL-DISPLAY-RESTART                           07040099
070500             DP013-CICS-ABEND      TO TRUE                        07050099
070600         MOVE '0001-CALL-CICS-ARCH-API'                           07060099
070700                                   TO DP013-PARAGRAPH             07070099
070800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07080099
070900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07090099
070800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN CODE O07091099
070900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07092099
071000         MOVE DP030-RETURN-CODE                                   07100099
071100                                   TO DP013-MESSAGE-TEXT (3)      07110099
071200         PERFORM DP013-0000-PROCESS-ABEND                         07120099
071300     END-IF.                                                      07130099
071400*                                                                 07140099
071500*                                                                 07150099
071600*----------------------------------------------------------------*07160099
071700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *07170099
071800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *07180099
071900*----------------------------------------------------------------*07190099
072000                                                                  07200099
072100 1000-CONTROL-PROCESSING.                                         07210099
072200     EVALUATE TRUE                                                07220099
072300         WHEN DP020-NEXT-ACT-INITIAL                              07230099
072400             INITIALIZE ASC-SPECIFIC-COMMAREA                     07240099
072500             MOVE EIBTRMID         TO ASC-PRT-TERM-ID             07250099
072600             MOVE DP020-SRC-TASK-NUMBER                           07260099
072700                                   TO ASC-PRT-TASK-NUMBER         07270099
072800             MOVE PC-PRINT-QUEUE-SEQ                              07280099
072900                                   TO ASC-PRT-SEQ                 07290099
073000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07300099
073100                                                                  07310099
073200             IF  PS-COMMAREA-NOT-VALID                            07320099
073300                 SET DP020-NEXT-ACT-APPL-ERROR                    07330099
073400                                   TO TRUE                        07340099
073500             ELSE                                                 07350099
073600                 PERFORM 4000-BUILD-INITIAL-PANEL                 07360099
073700                 PERFORM 3200-RESET-ATTRIBUTES                    07370099
073800             END-IF                                               07380099
073900                                                                  07390099
074000         WHEN DP020-NEXT-ACT-READ-MAP                             07400099
074100             PERFORM 2000-PROCESS-PANEL                           07410099
074200                                                                  07420099
074300                                                                  07430099
074400         WHEN DP020-NEXT-ACT-RETURN                               07440099
074500*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07450099
074600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07460099
074700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07470099
074800             MOVE -1                TO APRTIDL                    07480099
074900                                                                  07490099
075000         WHEN OTHER                                               07500099
075100             SET DP013-LOGIC-ABEND TO TRUE                        07510099
075200             SET DP013-NO-ROLLBACK TO TRUE                        07520099
075300             MOVE '1000-CONTROL-PROCESSING'                       07530099
075400                                   TO  DP013-PARAGRAPH            07540099
075500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07550099
075600                                   TO  DP013-MESSAGE-TEXT(1)      07560099
075700             PERFORM DP013-0000-PROCESS-ABEND                     07570099
075800     END-EVALUATE.                                                07580099
075900*                                                                 07590099
076000*                                                                 07600099
076100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07610099
076200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07620099
076300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07630099
076400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07640099
076500 1100-PROCESS-INTER-APPL-COMM.                                    07650099
076600                                                                  07660099
076700******COMING FROM SUKCS552 PO-RECEIVER SCREEN.                    07670099
076800                                                                  07680099
076900     SET PS-COMMAREA-VALID          TO TRUE.                      07690099
077000                                                                  07700099
077100     IF DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT                07710099
077200        MOVE SU003-OPER-UNT-ID     TO ASC-OPER-UNT-ID             07720099
077300        MOVE SU003-FCLTY-ID        TO ASC-FCLTY-ID                07730099
077400        MOVE SU003-FCLTY-NME       TO ASC-FCLTY-NME               07740099
077500        MOVE SU003-SCAC-CDE        TO ASC-SCAC-ID                 07750099
077600        MOVE SU003-TRLR-NBR        TO ASC-VEH-NBR                 07760099
077700        MOVE SU003-TRIP-ID         TO ASC-TRIP-ID                 07770099
077800        MOVE SU003-PO-NBR          TO ASC-PO-NBR                  07780099
077900        MOVE SU003-ALL-PO-IND      TO ASC-ALL-PO-IND              07790099
078000                                                                  07800099
078100        SET ASC-USE-SELECTION-QUEUE   TO TRUE                     07810099
078200        MOVE SU003-NUMBER-OF-TS-ITEMS                             07820099
078300                            TO ASC-NUMBER-OF-TS-ITEMS             07830099
078400        MOVE SU003-SEL-QUEUE-NAME                                 07840099
078500                            TO ASC-SEL-QUEUE-NAME                 07850099
078600*       IF ASC-ALL-PO-IND = 'Y'                                   07860099
078700*           PERFORM 1140-UPDATE-ALL-PO                            07870099
078800*             UNTIL ASC-SEL-ITEM >= ASC-NUMBER-OF-TS-ITEMS        07880099
078900*       ELSE                                                      07890099
079000*           PERFORM 1130-GET-NEXT-RECORD                          07900099
079100*             UNTIL ASC-SEL-ITEM >= ASC-NUMBER-OF-TS-ITEMS        07910099
079200*       END-IF                                                    07920099
079300        SET  ASC-FIRST-PASS  TO  TRUE                             07930099
079400     END-IF.                                                      07940099
079500 EJECT                                                            07950099
079600                                                                  07960099
079700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07970099
079800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07980099
079900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07990099
080000 1130-GET-NEXT-RECORD.                                            08000099
080100                                                                  08010099
080200     ADD  +1                      TO ASC-SEL-SUB.                 08020099
080300     ADD  +1                      TO PV-ITEM-SUB.                 08030099
080400*DMH                                                              08040099
080500     ADD +1                       TO ASC-SEL-ITEM.                08050099
080600                                                                  08060099
080700     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            08070099
080800         ADD +1                   TO ASC-SEL-ITEM                 08080099
080900         MOVE +1                  TO ASC-SEL-SUB                  08090099
081000     END-IF.                                                      08100099
081100                                                                  08110099
081200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 08120099
081300         PERFORM 9100-READ-SEL-QUEUE                              08130099
081400         PERFORM UNTIL                                            08140099
081500                 PV-ITEM-SUB  >  SU004-SELECTED-ITEMS             08150099
081600****             PV-QUEUE-ITEM-NBR = SU004-SELECTED-ITEMS         08160099
081700                     IF  ASC-SEL-SUB > SU004-MAX-ITEMS            08170099
081800                         ADD +1        TO ASC-SEL-ITEM            08180099
081900                         MOVE +1       TO ASC-SEL-SUB             08190099
082000                         PERFORM 9100-READ-SEL-QUEUE              08200099
082100                     END-IF                                       08210099
082200                     IF  SU004-ITEM (ASC-SEL-SUB) > ZERO          08220099
082300                         MOVE SU004-PO-NBR  (ASC-SEL-SUB)         08230099
082400                              TO ASC-PO-NBR                       08240099
082500                         SET  SU004-INQ (ASC-SEL-SUB)             08250099
082600                              TO TRUE                             08260099
082700                         PERFORM 7510-INSERT-PO-NBRS              08270099
082800                         PERFORM 9200-REWRITE-SEL-QUEUE           08280099
082900                     END-IF                                       08290099
083000                     ADD +1  TO ASC-SEL-SUB                       08300099
083100                     ADD +1  TO PV-ITEM-SUB                       08310099
083200         END-PERFORM                                              08320099
083300     END-IF.                                                      08330099
083400/                                                                 08340099
083500*                                                                 08350099
083600                                                                  08360099
083700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08370099
083800*    UPDATE ALL ENTRIES IN LIST QUEUE IF ALL PO'S WERE REQUESTED *08380099
083900* THE ARCHITECTURE ALLOWS FOR SU004-MAX-ITEMS = 20                08390099
084000* IF  ASC-SEL-SUB > SU004-MAX-ITEMS ADDED TO RESET THE            08400099
084100* ASC-SEL-SUB AND BYPASS THE ARCH.                                08410099
084200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08420099
084300 1140-UPDATE-ALL-PO.                                              08430099
084400                                                                  08440099
084500     ADD  +1                      TO ASC-SEL-SUB.                 08450099
084600*DMH                                                              08460099
084700     ADD +1                       TO ASC-SEL-ITEM.                08470099
084800                                                                  08480099
084900     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            08490099
085000         ADD +1                   TO ASC-SEL-ITEM                 08500099
085100         MOVE +1                  TO ASC-SEL-SUB                  08510099
085200     END-IF.                                                      08520099
085300                                                                  08530099
085400     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 08540099
085500         PERFORM 9100-READ-SEL-QUEUE                              08550099
085600         PERFORM UNTIL                                            08560099
085700                 ASC-SEL-SUB  >  SU004-SELECTED-ITEMS  OR         08570099
085800                 PV-QUEUE-ITEM-NBR = SU004-SELECTED-ITEMS         08580099
085900                     IF  ASC-SEL-SUB > SU004-MAX-ITEMS            08590099
086000                         ADD +1        TO ASC-SEL-ITEM            08600099
086100                         MOVE +1       TO ASC-SEL-SUB             08610099
086200                         PERFORM 9100-READ-SEL-QUEUE              08620099
086300                     END-IF                                       08630099
086400                     IF  SU004-ITEM (ASC-SEL-SUB) > ZERO          08640099
086500                         MOVE SU004-ITEM (ASC-SEL-SUB)            08650099
086600                           TO PV-QUEUE-ITEM-NBR                   08660099
086700                         MOVE SU004-PO-NBR  (ASC-SEL-SUB)         08670099
086800                              TO ASC-PO-NBR                       08680099
086900                         SET  SU004-INQ (ASC-SEL-SUB)             08690099
087000                              TO TRUE                             08700099
087100                         PERFORM 9200-REWRITE-SEL-QUEUE           08710099
087200                         ADD +1  TO ASC-SEL-SUB                   08720099
087300                     END-IF                                       08730099
087400         END-PERFORM                                              08740099
087500     END-IF.                                                      08750099
087600/                                                                 08760099
087700*                                                                 08770099
087800*                                                                 08780099
087900*----------------------------------------------------------------*08790099
088000* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*08800099
088100* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*08810099
088200* EDITS.                                                         *08820099
088300*----------------------------------------------------------------*08830099
088400                                                                  08840099
088500 2000-PROCESS-PANEL.                                              08850099
088600                                                                  08860099
088700     EVALUATE TRUE                                                08870099
088800                                                                  08880099
088900         WHEN DP020-SRC-AID = DP016-CLEAR                         08890099
089000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08900099
089100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08910099
089200                                                                  08920099
089300         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     08930099
089400             PERFORM 4000-BUILD-INITIAL-PANEL                     08940099
089500             PERFORM 3200-RESET-ATTRIBUTES                        08950099
089600                                                                  08960099
089700         WHEN OTHER                                               08970099
089800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08980099
089900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08990099
090000             IF  PS-NO-EDIT-ERROR                                 09000099
090100                 SET DP030-CONTINUE-GO TO TRUE                    09010099
090200                 MOVE -1               TO APRTIDL                 09020099
090300                 PERFORM 2100-CHECK-FUNCTION-KEY                  09030099
090400             ELSE                                                 09040099
090500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09050099
090600                 SET DP030-OVERRIDE-GO TO TRUE                    09060099
090700             END-IF                                               09070099
090800     END-EVALUATE.                                                09080099
090900                                                                  09090099
091000******************************************************************09100099
091100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **09110099
091200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **09120099
091300** FROM THE CICS ARCHITECTURE API.                              **09130099
091400******************************************************************09140099
091500 2100-CHECK-FUNCTION-KEY.                                         09150099
091600     EVALUATE TRUE                                                09160099
091700******************************************************************09170099
091800*F18 PRINT                                                        09180099
091900*    PRESSING F18-PRINT WILL SUBMIT A BATCH JOB TO CREATE         09190099
092000*    REQUESTED CHECK-IN REPORTS BY PO.                            09200099
092100******************************************************************09210099
092200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09220099
092300             IF  ASC-FIRST-PASS                                   09230099
092400                 MOVE  ZEROES  TO  ASC-SEL-ITEM                   09240099
092500                 SET  ASC-NOT-FIRST-PASS TO TRUE                  09250099
092600             END-IF                                               09260099
092700             PERFORM 5000-PREPARE-SEL-QUEUE                       09270099
092800                     WITH TEST AFTER                              09280099
092900                     VARYING ASC-SEL-SUB FROM 1 BY 1              09290099
093000                       UNTIL ASC-SEL-SUB = ASC-NUMBER-OF-TS-ITEMS 09300099
093100                                                                  09310099
093200             IF ASC-ALL-PO-IND = 'Y'                              09320099
093300*PERFORM ROUTINE THAT SUBMITS JOB FOR ALL PO'S UNDER 1 TRIP ID    09330099
093400                    PERFORM 7000-GET-REGION-ID                    09340099
093500                    PERFORM 7100-GET-CURRENT-TIMESTAMP            09350099
093600                    PERFORM 7500-INSERT-TRIP-ID                   09360099
093700                    MOVE 0 TO      ASC-SEL-SUB                    09370099
093800                    PERFORM 1140-UPDATE-ALL-PO                    09380099
093900                      UNTIL ASC-SEL-ITEM >= ASC-NUMBER-OF-TS-ITEMS09390099
094000                    PERFORM 9000-SUBMIT-JOB                       09400099
094100             ELSE                                                 09410099
094200*PERFORM ROUTINE THAT SUBMITS JOB FOR SPECIFIC PO'S               09420099
094300                    PERFORM 7000-GET-REGION-ID                    09430099
094400                    PERFORM 7100-GET-CURRENT-TIMESTAMP            09440099
094500                    MOVE 0 TO      ASC-SEL-SUB                    09450099
094600                                   PV-ITEM-SUB                    09460099
094601*GB 10/15/01 BEG                                                  09460199
094610                                   ASC-SEL-ITEM                   09461099
094620*GB 10/15/01 END                                                  09462099
094700                    PERFORM 1130-GET-NEXT-RECORD                  09470099
094800                      UNTIL ASC-SEL-SUB >= ASC-NUMBER-OF-TS-ITEMS 09480099
094900                    PERFORM 9000-SUBMIT-JOB                       09490099
095000             END-IF                                               09500099
095100                                                                  09510099
095200         WHEN DP020-SRC-AID = DP016-ENTER                         09520099
095300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09530099
095400     END-EVALUATE.                                                09540099
095500                                                                  09550099
095600                                                                  09560099
095700******************************************************************09570099
095800** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **09580099
095900** INTER-APPLICATION COMMAREA.                                  **09590099
096000*----------------------------------------------------------------*09600099
096100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*09610099
096200* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *09620099
096300* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *09630099
096400*----------------------------------------------------------------*09640099
096500                                                                  09650099
096600 2200-MOVE-SCREEN-TO-COMMAREA.                                    09660099
096700                                                                  09670099
096800*PRINTER ID                                                       09680099
096900                                                                  09690099
097000     IF  APRTIDL > ZERO                                           09700099
097100         MOVE APRTIDI          TO ASC-PRTR-DEST                   09710099
097200*        MOVE ASC-PRTR-DEST    TO PV-PRINTER-DESTINATION          09720099
097300     ELSE                                                         09730099
097400         IF  APRTIDF = DP015-ERASE-EOF                            09740099
097500             MOVE SPACE     TO ASC-PRTR-DEST                      09750099
097600*            MOVE SPACE     TO PV-PRINTER-DESTINATION             09760099
097700         END-IF                                                   09770099
097800     END-IF.                                                      09780099
097900                                                                  09790099
098000*ALL CHECK-IN REPORTS                                             09800099
098100     IF  ALLRPTL > ZERO                                           09810099
098200         MOVE ALLRPTI              TO ASC-ALL-RPTS                09820099
098300     ELSE                                                         09830099
098400         IF  ALLRPTF = DP015-ERASE-EOF                            09840099
098500             MOVE SPACE            TO ASC-ALL-RPTS                09850099
098600         END-IF                                                   09860099
098700     END-IF.                                                      09870099
098800                                                                  09880099
098900*STATS RPT                                                        09890099
099000     IF  ASTRPTL > ZERO                                           09900099
099100         MOVE ASTRPTI              TO ASC-STS-RPT                 09910099
099200     ELSE                                                         09920099
099300         IF  ASTRPTF = DP015-ERASE-EOF                            09930099
099400             MOVE SPACE            TO ASC-STS-RPT                 09940099
099500         END-IF                                                   09950099
099600     END-IF.                                                      09960099
099700                                                                  09970099
099800*PO/STR UNT ADJ                                                   09980099
099900     IF  APORPTL > ZERO                                           09990099
100000         MOVE APORPTI              TO ASC-PO-RPT                  10000099
100100     ELSE                                                         10010099
100200         IF  APORPTF = DP015-ERASE-EOF                            10020099
100300             MOVE SPACE            TO ASC-PO-RPT                  10030099
100400         END-IF                                                   10040099
100500     END-IF.                                                      10050099
100600                                                                  10060099
100700*CRTNS NOT RCVD                                                   10070099
100800     IF  ANRRPTL > ZERO                                           10080099
100900         MOVE ANRRPTI              TO ASC-NOT-RCVD-RPT            10090099
101000     ELSE                                                         10100099
101100         IF  ANRRPTF = DP015-ERASE-EOF                            10110099
101200             MOVE SPACE            TO ASC-NOT-RCVD-RPT            10120099
101300         END-IF                                                   10130099
101400     END-IF.                                                      10140099
101500                                                                  10150099
101600*FREE ASTRAY                                                      10160099
101700     IF  AFARPTL > ZERO                                           10170099
101800         MOVE AFARPTI              TO ASC-FR-ASTY-RPT             10180099
101900     ELSE                                                         10190099
102000         IF  AFARPTF = DP015-ERASE-EOF                            10200099
102100             MOVE SPACE            TO ASC-FR-ASTY-RPT             10210099
102200         END-IF                                                   10220099
102300     END-IF.                                                      10230099
102400                                                                  10240099
102500*MISDIRECT RPT                                                    10250099
102600     IF  AMDRPTL > ZERO                                           10260099
102700         MOVE AMDRPTI              TO ASC-MISDIR-RPT              10270099
102800     ELSE                                                         10280099
102900         IF  AMDRPTF = DP015-ERASE-EOF                            10290099
103000             MOVE SPACE            TO ASC-MISDIR-RPT              10300099
103100         END-IF                                                   10310099
103200     END-IF.                                                      10320099
103300                                                                  10330099
103400*DUPLICATE SCAN                                                   10340099
103500     IF  ADSRPTL > ZERO                                           10350099
103600         MOVE ADSRPTI              TO ASC-DUP-SCAN-RPT            10360099
103700     ELSE                                                         10370099
103800         IF  ADSRPTF = DP015-ERASE-EOF                            10380099
103900             MOVE SPACE            TO ASC-DUP-SCAN-RPT            10390099
104000         END-IF                                                   10400099
104100     END-IF.                                                      10410099
104200                                                                  10420099
104300*SCAN NOT FOUND                                                   10430099
104400     IF  ANFRPTL > ZERO                                           10440099
104500         MOVE ANFRPTI              TO ASC-NOT-FND-RPT             10450099
104600     ELSE                                                         10460099
104700         IF  ANFRPTF = DP015-ERASE-EOF                            10470099
104800             MOVE SPACE            TO ASC-NOT-FND-RPT             10480099
104900         END-IF                                                   10490099
105000     END-IF.                                                      10500099
105100                                                                  10510099
105200*UNUSED LABELS                                                    10520099
105300     IF  AULRPTL > ZERO                                           10530099
105400         MOVE AULRPTI              TO ASC-UNUSED-LBLS-RPT         10540099
105500     ELSE                                                         10550099
105600         IF  AULRPTF = DP015-ERASE-EOF                            10560099
105700             MOVE SPACE            TO ASC-UNUSED-LBLS-RPT         10570099
105800         END-IF                                                   10580099
105900     END-IF.                                                      10590099
106000                                                                  10600099
106100*----------------------------------------------------------------*10610099
106200* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *10620099
106300* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *10630099
106400* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*10640099
106500* IN THE DESTINATION PROGRAM, NOT HERE.                          *10650099
106600*----------------------------------------------------------------*10660099
106700                                                                  10670099
106800 3000-EDIT-DATA-IN-COMMAREA.                                      10680099
106900     PERFORM 3200-RESET-ATTRIBUTES.                               10690099
107000                                                                  10700099
107100*-----------------------------------------------------------------10710099
107200* VALIDATE PRINTER - PRINTER DEST MUST BE ENTERED                 10720099
107300*-----------------------------------------------------------------10730099
107400     IF   ASC-PRTR-DEST > SPACE                                   10740099
107500          PERFORM 3600-VALIDATE-PRINTER                           10750099
107600              IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'          10760099
107700                 CONTINUE                                         10770099
107800              ELSE                                                10780099
107900                 SET PS-EDIT-ERROR                                10790099
108000                     DP020-MSG-FATAL                              10800099
108100                                  TO TRUE                         10810099
108200                 MOVE PC-TSYMSG-02433                             10820099
108300                                  TO DP020-MSG-NUMBER             10830099
108400                     MOVE DP015-UNP-ALP-BRT-MDT                   10840099
108500                                  TO APRTIDA                      10850099
108600                 MOVE DP015-RED   TO APRTIDC                      10860099
108700                 MOVE DP015-REVERSE                               10870099
108800                                  TO APRTIDH                      10880099
108900                 MOVE -1          TO APRTIDL                      10890099
109000                 MOVE SPACE       TO ASC-PRTR-DEST                10900099
109100                 SET DP030-SET-CURSOR-APPL-1                      10910099
109200                                  TO TRUE                         10920099
109300              END-IF                                              10930099
109400     ELSE                                                         10940099
109500             SET PS-EDIT-ERROR                                    10950099
109600                 DP020-MSG-FATAL                                  10960099
109700                              TO TRUE                             10970099
109800             MOVE PC-TSYMSG-01563                                 10980099
109900                              TO DP020-MSG-NUMBER                 10990099
110000                 MOVE DP015-UNP-ALP-BRT-MDT                       11000099
110100                              TO APRTIDA                          11010099
110200             MOVE DP015-RED   TO APRTIDC                          11020099
110300             MOVE DP015-REVERSE                                   11030099
110400                              TO APRTIDH                          11040099
110500             MOVE -1          TO APRTIDL                          11050099
110600             MOVE SPACE       TO ASC-PRTR-DEST                    11060099
110700             SET DP030-SET-CURSOR-APPL-1                          11070099
110800                              TO TRUE                             11080099
110900     END-IF.                                                      11090099
111000                                                                  11100099
111100                                                                  11110099
111200*-----------------------------------------------------------------11120099
111300*** VALIDATE ALL CHECK-IN REPORTS - IF SELECTED MUST BE 'X' OR 'S'11130099
111400*-----------------------------------------------------------------11140099
111500     IF  ASC-ALL-RPTS    > SPACE                                  11150099
111600         IF (ASC-ALL-RPTS EQUAL 'X') OR                           11160099
111700            (ASC-ALL-RPTS EQUAL 'S')                              11170099
111800             CONTINUE                                             11180099
111900         ELSE                                                     11190099
112000             SET PS-EDIT-ERROR                                    11200099
112100                 DP020-MSG-FATAL   TO TRUE                        11210099
112200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11220099
112300             MOVE DP015-UNP-ALP-BRT-MDT                           11230099
112400                                   TO ALLRPTA                     11240099
112500             MOVE DP015-RED        TO ALLRPTC                     11250099
112600             MOVE DP015-REVERSE    TO ALLRPTH                     11260099
112700             MOVE -1               TO ALLRPTL                     11270099
112800**           MOVE SPACE            TO ASC-ALL-RPTS                11280099
112900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11290099
113000         END-IF                                                   11300099
113100     END-IF.                                                      11310099
113200*                                                                 11320099
113300*-----------------------------------------------------------------11330099
113400*** VALIDATE STATS RPT - IF SELECTED MUST BE 'X' OR 'S'           11340099
113500*-----------------------------------------------------------------11350099
113600     IF  ASC-STS-RPT     > SPACE                                  11360099
113700         IF (ASC-STS-RPT  EQUAL 'X') OR                           11370099
113800            (ASC-STS-RPT  EQUAL 'S')                              11380099
113900             CONTINUE                                             11390099
114000         ELSE                                                     11400099
114100             SET PS-EDIT-ERROR                                    11410099
114200                 DP020-MSG-FATAL   TO TRUE                        11420099
114300             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11430099
114400             MOVE DP015-UNP-ALP-BRT-MDT                           11440099
114500                                   TO ASTRPTA                     11450099
114600             MOVE DP015-RED        TO ASTRPTC                     11460099
114700             MOVE DP015-REVERSE    TO ASTRPTH                     11470099
114800             MOVE -1               TO ASTRPTL                     11480099
114900**           MOVE SPACE            TO ASC-STS-RPT                 11490099
115000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11500099
115100         END-IF                                                   11510099
115200     END-IF.                                                      11520099
115300*                                                                 11530099
115400*-----------------------------------------------------------------11540099
115500*** VALIDATE PO/STR UNT ADJ - IF SELECTED MUST BE 'X' OR 'S'      11550099
115600*-----------------------------------------------------------------11560099
115700     IF  ASC-PO-RPT    > SPACE                                    11570099
115800         IF (ASC-PO-RPT EQUAL 'X') OR                             11580099
115900            (ASC-PO-RPT EQUAL 'S')                                11590099
116000             CONTINUE                                             11600099
116100         ELSE                                                     11610099
116200             SET PS-EDIT-ERROR                                    11620099
116300                 DP020-MSG-FATAL   TO TRUE                        11630099
116400             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11640099
116500             MOVE DP015-UNP-ALP-BRT-MDT                           11650099
116600                                   TO APORPTA                     11660099
116700             MOVE DP015-RED        TO APORPTC                     11670099
116800             MOVE DP015-REVERSE    TO APORPTH                     11680099
116900             MOVE -1               TO APORPTL                     11690099
117000**           MOVE SPACE            TO ASC-PO-RPT                  11700099
117100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11710099
117200         END-IF                                                   11720099
117300     END-IF.                                                      11730099
117400*                                                                 11740099
117500*-----------------------------------------------------------------11750099
117600*** VALIDATE CRTNS NOT RCVD - IF SELECTED MUST BE 'X' OR 'S'      11760099
117700*-----------------------------------------------------------------11770099
117800     IF  ASC-NOT-RCVD-RPT > SPACE                                 11780099
117900         IF (ASC-NOT-RCVD-RPT EQUAL 'X') OR                       11790099
118000            (ASC-NOT-RCVD-RPT EQUAL 'S')                          11800099
118100             CONTINUE                                             11810099
118200         ELSE                                                     11820099
118300             SET PS-EDIT-ERROR                                    11830099
118400                 DP020-MSG-FATAL   TO TRUE                        11840099
118500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            11850099
118600             MOVE DP015-UNP-ALP-BRT-MDT                           11860099
118700                                   TO ANRRPTA                     11870099
118800             MOVE DP015-RED        TO ANRRPTC                     11880099
118900             MOVE DP015-REVERSE    TO ANRRPTH                     11890099
119000             MOVE -1               TO ANRRPTL                     11900099
119100**           MOVE SPACE            TO ASC-NOT-RCVD-RPT            11910099
119200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11920099
119300         END-IF                                                   11930099
119400     END-IF.                                                      11940099
119500*                                                                 11950099
119600*-----------------------------------------------------------------11960099
119700*** VALIDATE FREE ASTRAY - IF SELECTED MUST BE 'X' OR 'S'         11970099
119800*-----------------------------------------------------------------11980099
119900     IF  ASC-FR-ASTY-RPT  > SPACE                                 11990099
120000         IF (ASC-FR-ASTY-RPT  EQUAL 'X') OR                       12000099
120100            (ASC-FR-ASTY-RPT  EQUAL 'S')                          12010099
120200             CONTINUE                                             12020099
120300         ELSE                                                     12030099
120400             SET PS-EDIT-ERROR                                    12040099
120500                 DP020-MSG-FATAL   TO TRUE                        12050099
120600             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12060099
120700             MOVE DP015-UNP-ALP-BRT-MDT                           12070099
120800                                   TO AFARPTA                     12080099
120900             MOVE DP015-RED        TO AFARPTC                     12090099
121000             MOVE DP015-REVERSE    TO AFARPTH                     12100099
121100             MOVE -1               TO AFARPTL                     12110099
121200*            MOVE SPACE            TO ASC-FR-ASTY-RPT             12120099
121300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12130099
121400         END-IF                                                   12140099
121500     END-IF.                                                      12150099
121600*                                                                 12160099
121700*-----------------------------------------------------------------12170099
121800*** VALIDATE MISDIRECT RPT - IF SELECTED MUST BE 'X' OR 'S'       12180099
121900*-----------------------------------------------------------------12190099
122000     IF  ASC-MISDIR-RPT   > SPACE                                 12200099
122100         IF (ASC-MISDIR-RPT   EQUAL 'X') OR                       12210099
122200            (ASC-MISDIR-RPT   EQUAL 'S')                          12220099
122300             CONTINUE                                             12230099
122400         ELSE                                                     12240099
122500             SET PS-EDIT-ERROR                                    12250099
122600                 DP020-MSG-FATAL   TO TRUE                        12260099
122700             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12270099
122800             MOVE DP015-UNP-ALP-BRT-MDT                           12280099
122900                                   TO AMDRPTA                     12290099
123000             MOVE DP015-RED        TO AMDRPTC                     12300099
123100             MOVE DP015-REVERSE    TO AMDRPTH                     12310099
123200             MOVE -1               TO AMDRPTL                     12320099
123300*            MOVE SPACE            TO ASC-MISDIR-RPT              12330099
123400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12340099
123500         END-IF                                                   12350099
123600     END-IF.                                                      12360099
123700*                                                                 12370099
123800*-----------------------------------------------------------------12380099
123900*** VALIDATE DUPLICATE SCAN - IF SELECTED MUST BE 'X' OR 'S'      12390099
124000*-----------------------------------------------------------------12400099
124100     IF  ASC-DUP-SCAN-RPT > SPACE                                 12410099
124200         IF (ASC-DUP-SCAN-RPT EQUAL 'X') OR                       12420099
124300            (ASC-DUP-SCAN-RPT EQUAL 'S')                          12430099
124400             CONTINUE                                             12440099
124500         ELSE                                                     12450099
124600             SET PS-EDIT-ERROR                                    12460099
124700                 DP020-MSG-FATAL   TO TRUE                        12470099
124800             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12480099
124900             MOVE DP015-UNP-ALP-BRT-MDT                           12490099
125000                                   TO ADSRPTA                     12500099
125100             MOVE DP015-RED        TO ADSRPTC                     12510099
125200             MOVE DP015-REVERSE    TO ADSRPTH                     12520099
125300             MOVE -1               TO ADSRPTL                     12530099
125400*            MOVE SPACE            TO ASC-DUP-SCAN-RPT            12540099
125500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12550099
125600         END-IF                                                   12560099
125700     END-IF.                                                      12570099
125800*                                                                 12580099
125900*-----------------------------------------------------------------12590099
126000*** VALIDATE SCAN NOT FOUND - IF SELECTED MUST BE 'X' OR 'S'      12600099
126100*-----------------------------------------------------------------12610099
126200     IF  ASC-NOT-FND-RPT  > SPACE                                 12620099
126300         IF (ASC-NOT-FND-RPT  EQUAL 'X') OR                       12630099
126400            (ASC-NOT-FND-RPT  EQUAL 'S')                          12640099
126500             CONTINUE                                             12650099
126600         ELSE                                                     12660099
126700             SET PS-EDIT-ERROR                                    12670099
126800                 DP020-MSG-FATAL   TO TRUE                        12680099
126900             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12690099
127000             MOVE DP015-UNP-ALP-BRT-MDT                           12700099
127100                                   TO ANFRPTA                     12710099
127200             MOVE DP015-RED        TO ANFRPTC                     12720099
127300             MOVE DP015-REVERSE    TO ANFRPTH                     12730099
127400             MOVE -1               TO ANFRPTL                     12740099
127500*            MOVE SPACE            TO ASC-NOT-FND-RPT             12750099
127600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12760099
127700         END-IF                                                   12770099
127800     END-IF.                                                      12780099
127900*                                                                 12790099
128000*-----------------------------------------------------------------12800099
128100*** VALIDATE UNUSED LABELS - IF SELECTED MUST BE 'X' OR 'S'       12810099
128200*-----------------------------------------------------------------12820099
128300     IF  ASC-UNUSED-LBLS-RPT > SPACE                              12830099
128400         IF (ASC-UNUSED-LBLS-RPT  EQUAL 'X') OR                   12840099
128500            (ASC-UNUSED-LBLS-RPT  EQUAL 'S')                      12850099
128600             CONTINUE                                             12860099
128700         ELSE                                                     12870099
128800             SET PS-EDIT-ERROR                                    12880099
128900                 DP020-MSG-FATAL   TO TRUE                        12890099
129000             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            12900099
129100             MOVE DP015-UNP-ALP-BRT-MDT                           12910099
129200                                   TO AULRPTA                     12920099
129300             MOVE DP015-RED        TO AULRPTC                     12930099
129400             MOVE DP015-REVERSE    TO AULRPTH                     12940099
129500             MOVE -1               TO AULRPTL                     12950099
129600*            MOVE SPACE            TO ASC-UNUSED-LBLS-RPT         12960099
129700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12970099
129800         END-IF                                                   12980099
129900     END-IF.                                                      12990099
130000                                                                  13000099
130100     IF    ((ASC-ALL-RPTS        = 'X'  OR                        13010099
130200             ASC-ALL-RPTS        = 'S') AND                       13020099
130300            (ASC-STS-RPT         = 'X'   OR                       13030099
130400             ASC-STS-RPT         = 'S'   OR                       13040099
130500             ASC-PO-RPT          = 'X'   OR                       13050099
130600             ASC-PO-RPT          = 'S'   OR                       13060099
130700             ASC-NOT-RCVD-RPT    = 'X'   OR                       13070099
130800             ASC-NOT-RCVD-RPT    = 'S'   OR                       13080099
130900             ASC-FR-ASTY-RPT     = 'X'   OR                       13090099
131000             ASC-FR-ASTY-RPT     = 'S'   OR                       13100099
131100             ASC-MISDIR-RPT      = 'X'   OR                       13110099
131200             ASC-MISDIR-RPT      = 'S'   OR                       13120099
131300             ASC-DUP-SCAN-RPT    = 'X'   OR                       13130099
131400             ASC-DUP-SCAN-RPT    = 'S'   OR                       13140099
131500             ASC-NOT-FND-RPT     = 'X'   OR                       13150099
131600             ASC-NOT-FND-RPT     = 'S'   OR                       13160099
131700             ASC-UNUSED-LBLS-RPT = 'X'   OR                       13170099
131800             ASC-UNUSED-LBLS-RPT = 'S'))                          13180099
131900                                                                  13190099
132000             SET PS-EDIT-ERROR                                    13200099
132100                 DP020-MSG-FATAL   TO TRUE                        13210099
132200             MOVE PC-TSYMSG-02535  TO DP020-MSG-NUMBER            13220099
132300             MOVE DP015-UNP-ALP-BRT-MDT                           13230099
132400                                   TO ALLRPTA                     13240099
132500             MOVE DP015-RED        TO ALLRPTC                     13250099
132600             MOVE DP015-REVERSE    TO ALLRPTH                     13260099
132700             MOVE -1               TO ALLRPTL                     13270099
132800*            MOVE SPACE            TO ASC-ALL-RPTS                13280099
132900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13290099
133000     END-IF.                                                      13300099
133100                                                                  13310099
133110     IF      ASC-ALL-RPTS        = SPACES AND                     13311099
133140             ASC-STS-RPT         = SPACES AND                     13314099
133150             ASC-PO-RPT          = SPACES AND                     13315099
133180             ASC-NOT-RCVD-RPT    = SPACES AND                     13318099
133190             ASC-FR-ASTY-RPT     = SPACES AND                     13319099
133193             ASC-MISDIR-RPT      = SPACES AND                     13319399
133194             ASC-DUP-SCAN-RPT    = SPACES AND                     13319499
133197             ASC-NOT-FND-RPT     = SPACES AND                     13319799
133199             ASC-UNUSED-LBLS-RPT = SPACES                         13319999
133200                                                                  13320099
133201             SET PS-EDIT-ERROR                                    13320199
133202                 DP020-MSG-FATAL   TO TRUE                        13320299
133203             MOVE PC-TSYMSG-02535  TO DP020-MSG-NUMBER            13320399
133204             MOVE DP015-UNP-ALP-BRT-MDT                           13320499
133205                                   TO ALLRPTA                     13320599
133206             MOVE DP015-RED        TO ALLRPTC                     13320699
133207             MOVE DP015-REVERSE    TO ALLRPTH                     13320799
133208             MOVE -1               TO ALLRPTL                     13320899
133210             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13321099
133211     END-IF.                                                      13321199
133212                                                                  13321299
133220                                                                  13322099
133300     MOVE ASC-SPECIFIC-COMMAREA TO INTER-APPL-COMM-AREA           13330099
133400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                         13340099
133500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         13350099
133600                                                                  13360099
133700******************************************************************13370099
133800** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **13380099
133900** MAP.                                                         **13390099
134000******************************************************************13400099
134100 3200-RESET-ATTRIBUTES.                                           13410099
134200     MOVE DP015-UNP-ALP-NOR-OFF    TO APRTIDA                     13420099
134300                                      ALLRPTA                     13430099
134400                                      ASTRPTA                     13440099
134500                                      APORPTA                     13450099
134600                                      ANRRPTA                     13460099
134700                                      AFARPTA                     13470099
134800                                      AMDRPTA                     13480099
134900                                      ADSRPTA                     13490099
135000                                      ANFRPTA                     13500099
135100                                      AULRPTA.                    13510099
135200     MOVE DP015-UNDERLINE          TO APRTIDH                     13520099
135300                                      ALLRPTH                     13530099
135400                                      ASTRPTH                     13540099
135500                                      APORPTH                     13550099
135600                                      ANRRPTH                     13560099
135700                                      AFARPTH                     13570099
135800                                      AMDRPTH                     13580099
135900                                      ADSRPTH                     13590099
136000                                      ANFRPTH                     13600099
136100                                      AULRPTH.                    13610099
136200     MOVE DP015-GREEN              TO APRTIDC                     13620099
136300                                      ALLRPTC                     13630099
136400                                      ASTRPTC                     13640099
136500                                      APORPTC                     13650099
136600                                      ANRRPTC                     13660099
136700                                      AFARPTC                     13670099
136800                                      AMDRPTC                     13680099
136900                                      ADSRPTC                     13690099
137000                                      ANFRPTC                     13700099
137100                                      AULRPTC.                    13710099
137200     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         13720099
137300                                                                  13730099
137400                                                                  13740099
137500*----------------------------------------------------------------*13750099
137600* 3600-VALIDATE-PRINTER                                          *13760099
137700* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *13770099
137800*----------------------------------------------------------------*13780099
137900 3600-VALIDATE-PRINTER.                                           13790099
138000                                                                  13800099
138100     MOVE ASC-PRTR-DEST              TO DP072-PRINTER-ID.         13810099
138200     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        13820099
138300     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     13830099
138400     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 13840099
138500     MOVE ASC-OPER-UNT-ID            TO DP072-OPER-UNT-ID.        13850099
138600     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     13860099
138700                                        DP072-FCLTY-ID.           13870099
138800     SET DP072-VALIDATE              TO TRUE.                     13880099
138900                                                                  13890099
139000     EXEC CICS                                                    13900099
139100          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  13910099
139200               COMMAREA (DP072-COMM-AREA)                         13920099
139300               RESP     (PV-CICS-RESPONSE)                        13930099
139400     END-EXEC                                                     13940099
139500                                                                  13950099
139600     EVALUATE TRUE                                                13960099
139700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13970099
139800              CONTINUE                                            13980099
139900         WHEN OTHER                                               13990099
140000              MOVE '3600-VALIDATE-PRINTER'                        14000099
140100                                    TO DP013-PARAGRAPH            14010099
140200              MOVE PV-CICS-RESPONSE                               14020099
140300                                 TO DP013-MESSAGE-TEXT(1)         14030099
140400              SET DP013-LINK-RETURN                               14040099
140500                  DP013-CICS-ABEND                                14050099
140600                  DP013-NO-ROLLBACK TO TRUE                       14060099
140700              PERFORM DP013-0000-PROCESS-ABEND                    14070099
140800     END-EVALUATE.                                                14080099
140900*                                                                 14090099
141000*----------------------------------------------------------------*14100099
141100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *14110099
141200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *14120099
141300*  IT HERE.                                                      *14130099
141400*----------------------------------------------------------------*14140099
141500 4000-BUILD-INITIAL-PANEL.                                        14150099
141600                                                                  14160099
141700     MOVE -1                       TO APRTIDL.                    14170099
141800     MOVE +0                    TO ASC-ITEM-SUB                   14180099
141900                                   ASC-NUMBER-OF-SELECTED-ITEMS.  14190099
142000                                                                  14200099
142100     MOVE ASC-PRTR-DEST            TO APRTIDO.                    14210099
142200     MOVE ASC-ALL-RPTS             TO ALLRPTO.                    14220099
142300     MOVE ASC-STS-RPT              TO ASTRPTO.                    14230099
142400     MOVE ASC-PO-RPT               TO APORPTO.                    14240099
142500     MOVE ASC-NOT-RCVD-RPT         TO ANRRPTO.                    14250099
142600     MOVE ASC-FR-ASTY-RPT          TO AFARPTO.                    14260099
142700     MOVE ASC-MISDIR-RPT           TO AMDRPTO.                    14270099
142800     MOVE ASC-DUP-SCAN-RPT         TO ADSRPTO.                    14280099
142900     MOVE ASC-NOT-FND-RPT          TO ANFRPTO.                    14290099
143000     MOVE ASC-UNUSED-LBLS-RPT      TO AULRPTO.                    14300099
143100*                                                                 14310099
143200*                                                                 14320099
143300*----------------------------------------------------------------*14330099
143400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *14340099
143500*----------------------------------------------------------------*14350099
143600 4400-MOVE-COMMAREA-TO-SCREEN.                                    14360099
143700     MOVE ASC-ALL-RPTS             TO ALLRPTO.                    14370099
143800     MOVE ASC-STS-RPT              TO ASTRPTO.                    14380099
143900     MOVE ASC-PO-RPT               TO APORPTO.                    14390099
144000     MOVE ASC-NOT-RCVD-RPT         TO ANRRPTO.                    14400099
144100     MOVE ASC-FR-ASTY-RPT          TO AFARPTO.                    14410099
144200     MOVE ASC-MISDIR-RPT           TO AMDRPTO.                    14420099
144300     MOVE ASC-DUP-SCAN-RPT         TO ADSRPTO.                    14430099
144400     MOVE ASC-NOT-FND-RPT          TO ANFRPTO.                    14440099
144500     MOVE ASC-UNUSED-LBLS-RPT      TO AULRPTO.                    14450099
144600                                                                  14460099
144700 EJECT                                                            14470099
144800                                                                  14480099
144900*----------------------------------------------------------------*14490099
145000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *14500099
145100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *14510099
145200* FOR THE SELECTED ITEMS QUEUE.                                  *14520099
145300*                                                                *14530099
145400* DETERMINE WHICH COPYBOOK WILL BE USED TO PREPARE THE SELECTION *14540099
145500* QUEUE BASED ON THE FUNCTION SELECTED (FUCN02 AND FUNC03 GO TO  *14550099
145600* RC LISTS WHICH USE A DIFFERENT COPYBOOK                        *14560099
145700*                                                                *14570099
145800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *14580099
145900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *14590099
146000* THE ARRAY IS FULL.                                             *14600099
146100*----------------------------------------------------------------*14610099
146200                                                                  14620099
146300 5000-PREPARE-SEL-QUEUE.                                          14630099
146400                                                                  14640099
146500     MOVE ASC-SEL-QUEUE-NAME     TO  SU003-SEL-QUEUE-NAME.        14650099
146600                                                                  14660099
146700     SET ASC-UPDATE-TSQ        TO  TRUE.                          14670099
146800     SET SU003-UPDATE-TSQ      TO  TRUE.                          14680099
146900                                                                  14690099
147000     SET SU004-IDX         TO  1.                                 14700099
147100     INITIALIZE SU004-SELECTED-ITEM-ARRAY.                        14710099
147200                                                                  14720099
147300******************************************************************14730099
147400** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **14740099
147500** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **14750099
147600** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **14760099
147700** THE USER.                                                    **14770099
147800******************************************************************14780099
147900 6000-REFRESH-PANEL-FROM-TEMP.                                    14790099
148000     IF  ASC-UPDATE-TSQ                                           14800099
148100         SET ASC-NO-TSQ-UPDATE TO TRUE                            14810099
148200         MOVE ZERO                 TO PV-SAVE-ITEM                14820099
148300                                      PV-SEL-QUEUE-ITEM           14830099
148400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        14840099
148500                                   TO PV-HOLD-SELECTED-ITEMS      14850099
148600         MOVE +1                   TO PV-ITEMS-PROCESSED          14860099
148700         PERFORM 6100-UPDATE-TSQ                                  14870099
148800             UNTIL PV-ITEMS-PROCESSED >                           14880099
148900                                     PV-HOLD-SELECTED-ITEMS       14890099
149000*DMH     PERFORM 6010-DELETE-SEL-QUEUE                            14900099
149100     END-IF.                                                      14910099
149200*----------------------------------------------------------------*14920099
149300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *14930099
149400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *14940099
149500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *14950099
149600*    THE TEMP QUEUE.                                             *14960099
149700*----------------------------------------------------------------*14970099
149800 6100-UPDATE-TSQ.                                                 14980099
149900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             14990099
150000     PERFORM 6105-READ-SEL-QUEUE.                                 15000099
150100     PERFORM                                                      15010099
150200         VARYING SU004-IDX                                        15020099
150300         FROM 1 BY 1                                              15030099
150400         UNTIL ((PV-ITEMS-PROCESSED >                             15040099
150500                              PV-HOLD-SELECTED-ITEMS)             15050099
150600         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             15060099
150700         ADD +1                TO PV-ITEMS-PROCESSED              15070099
150800     END-PERFORM.                                                 15080099
150900*                                                                 15090099
151000*                                                                 15100099
151100*----------------------------------------------------------------*15110099
151200*    READ THE SELECT QUEUE RECORD.                               *15120099
151300*----------------------------------------------------------------*15130099
151400 6105-READ-SEL-QUEUE.                                             15140099
151500     EXEC CICS                                                    15150099
151600          READQ TS                                                15160099
151700              QUEUE (ASC-SEL-QUEUE-NAME)                          15170099
151800              INTO  (SU004-DC-SELECT-RECORD)                      15180099
151900              ITEM  (PV-SEL-QUEUE-ITEM)                           15190099
152000              RESP  (PV-CICS-RESP)                                15200099
152100     END-EXEC.                                                    15210099
152200                                                                  15220099
152300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          15230099
152400         CONTINUE                                                 15240099
152500     ELSE                                                         15250099
152600         SET DP013-CICS-ABEND      TO  TRUE                       15260099
152700         SET DP013-NO-ROLLBACK     TO  TRUE                       15270099
152800         MOVE '6105-READ-SEL-QUEUE'                               15280099
152900                                   TO  DP013-PARAGRAPH            15290099
153000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           15300099
153100                                   TO  DP013-MESSAGE-TEXT(1)      15310099
153200                                                                  15320099
153300         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              15330099
153400         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          15340099
153500         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  15350099
153600         STRING ' QUEUE 1 TERM ID-'     DELIMITED BY SIZE         15360099
153700                 PV-SEL-TERM-ID       DELIMITED BY SIZE           15370099
153800                ' QUEUE TASK-'        DELIMITED BY SIZE           15380099
153900                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           15390099
154000                ' QUEUE SEQ-'         DELIMITED BY SIZE           15400099
154100                 PV-SEL-SEQ           DELIMITED BY SIZE           15410099
154200                                 INTO  DP013-MESSAGE-TEXT(2)      15420099
154300         MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID         15430099
154400         MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER     15440099
154500         MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ             15450099
154600         STRING ' QUEUE 2 TERM ID-'     DELIMITED BY SIZE         15460099
154700                 PV-SEL-TERM-ID       DELIMITED BY SIZE           15470099
154800                ' QUEUE TASK-'        DELIMITED BY SIZE           15480099
154900                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           15490099
155000                ' QUEUE SEQ-'         DELIMITED BY SIZE           15500099
155100                 PV-SEL-SEQ           DELIMITED BY SIZE           15510099
155200                                 INTO  DP013-MESSAGE-TEXT(3)      15520099
155300         PERFORM DP013-0000-PROCESS-ABEND                         15530099
155400     END-IF.                                                      15540099
155500 EJECT                                                            15550099
155600*                                                                 15560099
155700*                                                                 15570099
155800*                                                                 15580099
155900 7000-GET-REGION-ID.                                              15590099
156000        EXEC CICS ASSIGN                                          15600099
156100        APPLID(PV-SYSTEM-ID)                                      15610099
156200        END-EXEC.                                                 15620099
156300                                                                  15630099
156400*----------------------------------------------------------------*15640099
156500*  GETS CURRENT DB2 TIMESTAMP.                                    15650099
156600*----------------------------------------------------------------*15660099
156700 7100-GET-CURRENT-TIMESTAMP.                                      15670099
156800         EXEC SQL                                                 15680099
156900             SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP         15690099
157000         END-EXEC.                                                15700099
157100                                                                  15710099
157200*----------------------------------------------------------------*15720099
157300*  INSERTS TRIP ID INTO TSURPRQ TABLE.                            15730099
157400*----------------------------------------------------------------*15740099
157500 7500-INSERT-TRIP-ID.                                             15750099
157600                                                                  15760099
157700     MOVE DP020-USERID               TO ASC-USER-ID.              15770099
157800     MOVE ASC-USER-ID                TO SURPRQ-WRKR-USR-ID.       15780099
157900     MOVE ASC-TRIP-ID                TO SURPRQ-TRIP-ID.           15790099
158000     MOVE ASC-PO-NBR                 TO SURPRQ-PO-NBR.            15800099
158100     MOVE PV-DB2-CURRENT-TMST        TO SURPRQ-RQST-TMST.         15810099
158200     MOVE ASC-ALL-PO-IND             TO SURPRQ-ALL-PO-IND.        15820099
158300                                                                  15830099
158400     EXEC SQL                                                     15840099
158500         INSERT INTO TSURPRQ                                      15850099
158600               (WRKR_USR_ID                                       15860099
158700              , TRIP_ID                                           15870099
158800              , PO_NBR                                            15880099
158900              , RQST_TMST                                         15890099
159000              , ALL_PO_IND                                        15900099
159100               )                                                  15910099
159200         VALUES (:SURPRQ-WRKR-USR-ID                              15920099
159300               , :SURPRQ-TRIP-ID                                  15930099
159400               , :SURPRQ-PO-NBR                                   15940099
159500               , :SURPRQ-RQST-TMST                                15950099
159600               , :SURPRQ-ALL-PO-IND                               15960099
159700                )                                                 15970099
159800     END-EXEC.                                                    15980099
159900                                                                  15990099
160000     EVALUATE TRUE                                                16000099
160100         WHEN SQLCODE = ZERO                                      16010099
160200             MOVE SURPRQ-WRKR-USR-ID TO ASC-USER-ID               16020099
160300             MOVE SURPRQ-TRIP-ID     TO ASC-TRIP-ID               16030099
160400             MOVE SURPRQ-PO-NBR      TO ASC-PO-NBR                16040099
160500             MOVE SURPRQ-RQST-TMST   TO ASC-RQST-TMST             16050099
160600             MOVE SURPRQ-ALL-PO-IND  TO ASC-ALL-PO-IND            16060099
160700             CONTINUE                                             16070099
160800         WHEN SQLWARN0 NOT = SPACE                                16080099
160900         WHEN SQLCODE NOT EQUAL ZERO                              16090099
161000             MOVE '7500-INSERT-TSURPRQ'                           16100099
161100                             TO DP013-PARAGRAPH                   16110099
161200             MOVE 'SUKCS556 - INSERT SU TRIP ID'                  16120099
161300                             TO DP013-MESSAGE-TEXT(1)             16130099
161400             MOVE SURPRQ-TRIP-ID                                  16140099
161500                             TO DP013-MESSAGE-TEXT(2)             16150099
161600             MOVE SQLCA      TO DP013-SQLCA                       16160099
161700             MOVE 'TSURPRQ'  TO DP013-DB2-TABLE-NAME(1)           16170099
161800             SET DP013-DB2-ABEND                                  16180099
161900                             TO TRUE                              16190099
162000             SET DP013-ROLLBACK                                   16200099
162100                             TO TRUE                              16210099
162200             SET DP013-XCTL-DISPLAY-RESTART                       16220099
162300                             TO TRUE                              16230099
162400             PERFORM DP013-0000-PROCESS-ABEND                     16240099
162500     END-EVALUATE.                                                16250099
162600                                                                  16260099
162700*----------------------------------------------------------------*16270099
162800*  INSERTS PO NUMBER(S) SELECTED INTO TSURPRQ TABLE.              16280099
162900*----------------------------------------------------------------*16290099
163000 7510-INSERT-PO-NBRS.                                             16300099
163100                                                                  16310099
163200     MOVE DP020-USERID               TO ASC-USER-ID.              16320099
163300     MOVE ASC-USER-ID                TO SURPRQ-WRKR-USR-ID.       16330099
163400     MOVE ASC-TRIP-ID                TO SURPRQ-TRIP-ID.           16340099
163500     MOVE ASC-PO-NBR                 TO SURPRQ-PO-NBR.            16350099
163600     MOVE PV-DB2-CURRENT-TMST        TO SURPRQ-RQST-TMST.         16360099
163700     MOVE ASC-ALL-PO-IND             TO SURPRQ-ALL-PO-IND.        16370099
163800                                                                  16380099
163900     EXEC SQL                                                     16390099
164000         INSERT INTO TSURPRQ                                      16400099
164100               (WRKR_USR_ID                                       16410099
164200              , TRIP_ID                                           16420099
164300              , PO_NBR                                            16430099
164400              , RQST_TMST                                         16440099
164500              , ALL_PO_IND                                        16450099
164600               )                                                  16460099
164700         VALUES (:SURPRQ-WRKR-USR-ID                              16470099
164800               , :SURPRQ-TRIP-ID                                  16480099
164900               , :SURPRQ-PO-NBR                                   16490099
165000               , :SURPRQ-RQST-TMST                                16500099
165100               , :SURPRQ-ALL-PO-IND                               16510099
165200                )                                                 16520099
165300     END-EXEC.                                                    16530099
165400                                                                  16540099
165500     EVALUATE TRUE                                                16550099
165600         WHEN SQLCODE = ZERO                                      16560099
165700         WHEN SQLCODE = -803                                      16570099
165800             MOVE SURPRQ-WRKR-USR-ID TO ASC-USER-ID               16580099
165900             MOVE SURPRQ-TRIP-ID     TO ASC-TRIP-ID               16590099
166000             MOVE SURPRQ-PO-NBR      TO ASC-PO-NBR                16600099
166100             MOVE SURPRQ-RQST-TMST   TO ASC-RQST-TMST             16610099
166200             MOVE SURPRQ-ALL-PO-IND  TO ASC-ALL-PO-IND            16620099
166300         WHEN SQLWARN0 NOT = SPACE                                16630099
166400         WHEN SQLCODE NOT EQUAL ZERO                              16640099
166500             MOVE '7510-INSERT-PO-NBRS'                           16650099
166600                             TO DP013-PARAGRAPH                   16660099
166700             MOVE 'SUKCS556 - INSERT SU PO NBRS'                  16670099
166800                             TO DP013-MESSAGE-TEXT(1)             16680099
166900             MOVE SURPRQ-PO-NBR                                   16690099
167000                             TO DP013-MESSAGE-TEXT(2)             16700099
167100             MOVE SQLCA      TO DP013-SQLCA                       16710099
167200             MOVE 'TSURPRQ'  TO DP013-DB2-TABLE-NAME(1)           16720099
167300             SET DP013-DB2-ABEND                                  16730099
167400                             TO TRUE                              16740099
167500             SET DP013-ROLLBACK                                   16750099
167600                             TO TRUE                              16760099
167700             SET DP013-XCTL-DISPLAY-RESTART                       16770099
167800                             TO TRUE                              16780099
167900             PERFORM DP013-0000-PROCESS-ABEND                     16790099
168000     END-EVALUATE.                                                16800099
168100                                                                  16810099
168200                                                                  16820099
168300*----------------------------------------------------------------*16830099
168400 9000-SUBMIT-JOB.                                                 16840099
168500                                                                  16850099
168600     MOVE  PC-STATUS-REPORT-DESC TO PV-JOB-DESCRIPTION.           16860099
168700     MOVE  PC-STATUS-REPORT-PROC TO PV-JOB-PROC.                  16870099
168800     MOVE  PC-STATUS-REPORT-JOB  TO PV-JOB-NAME.                  16880099
168900                                                                  16890099
169000     PERFORM 9010-ENQUEUE-INTERNAL-READER.                        16900099
169100                                                                  16910099
169200     MOVE '*9000-SUBMIT-JOB            *' TO DP013-PARAGRAPH      16920099
169300                                                                  16930099
169400     IF PV-PROD-CICS                                              16940099
169500        MOVE '1'               TO JL-LINE-12-PROC-T               16950099
169600        MOVE ' '               TO JL-LINE-12-PROC-T2              16960099
169700        MOVE JL-JOB-LINE-PROD  TO JL-JCL-LINE-1                   16970099
169800        MOVE JL-JCL-LINE-1     TO TD-JCL-LINE                     16980099
169900        PERFORM 9020-WRITE-TD-LINE                                16990099
170000        MOVE JL-JCL-LINE-3     TO TD-JCL-LINE                     17000099
170100        PERFORM 9020-WRITE-TD-LINE                                17010099
170200*       MOVE PV-PRINTER-DESTINATION TO JL-LINE-13-PRINTER         17020099
170300        MOVE ASC-PRTR-DEST          TO JL-LINE-13-PRINTER         17030099
170400        MOVE JL-JCL-LINE-13 TO TD-JCL-LINE                        17040099
170500        PERFORM 9020-WRITE-TD-LINE                                17050099
170600        MOVE JL-JCL-LINE-4-PROD TO TD-JCL-LINE                    17060099
170700        PERFORM 9020-WRITE-TD-LINE                                17070099
171000     ELSE                                                         17100099
171100        IF PV-TEST-CICS                                           17110099
171200           MOVE '1'               TO JL-LINE-12-PROC-T            17120099
171300           MOVE 'T'               TO JL-LINE-12-PROC-T2           17130099
171400           MOVE DP020-USERID      TO  JL-TEST-JOB-NAME            17140099
171500           MOVE JL-JOB-LINE-TEST  TO  JL-JCL-LINE-1               17150099
171600           MOVE JL-JCL-LINE-1     TO TD-JCL-LINE                  17160099
171700           PERFORM 9020-WRITE-TD-LINE                             17170099
171800*          MOVE PV-PRINTER-DESTINATION TO JL-LINE-13-PRINTER      17180099
171900           MOVE ASC-PRTR-DEST          TO JL-LINE-13-PRINTER      17190099
172000           MOVE JL-JCL-LINE-13 TO TD-JCL-LINE                     17200099
172100           PERFORM 9020-WRITE-TD-LINE                             17210099
172200           MOVE JL-JCL-LINE-4-TEST TO TD-JCL-LINE                 17220099
172300           PERFORM 9020-WRITE-TD-LINE                             17230099
172400        ELSE                                                      17240099
172500           IF PV-QA-CICS                                          17250099
172600              MOVE '1'               TO JL-LINE-12-PROC-T         17260099
172700              MOVE 'Q'               TO JL-LINE-12-PROC-T2        17270099
172800*             MOVE JL-JOB-LINE-PROD  TO JL-JCL-LINE-1             17280099
172900*             MOVE JL-JCL-LINE-1     TO TD-JCL-LINE               17290099
173000              MOVE DP020-USERID      TO  JL-TEST-JOB-NAME         17300099
173100              MOVE JL-JOB-LINE-TEST  TO  JL-JCL-LINE-1            17310099
173200              MOVE JL-JCL-LINE-1     TO TD-JCL-LINE               17320099
173300              PERFORM 9020-WRITE-TD-LINE                          17330099
173400*             MOVE PV-PRINTER-DESTINATION TO JL-LINE-13-PRINTER   17340099
173500              MOVE ASC-PRTR-DEST          TO JL-LINE-13-PRINTER   17350099
173600              MOVE JL-JCL-LINE-13    TO TD-JCL-LINE               17360099
173700              PERFORM 9020-WRITE-TD-LINE                          17370099
173800              MOVE JL-JCL-LINE-4-QA  TO TD-JCL-LINE               17380099
173900              PERFORM 9020-WRITE-TD-LINE                          17390099
173910           ELSE                                                   17391099
173920              IF PV-LEARN-CICS                                    17392099
173930                 MOVE '1'               TO JL-LINE-12-PROC-T      17393099
173940                 MOVE 'L'               TO JL-LINE-12-PROC-T2     17394099
173950*                MOVE JL-JOB-LINE-PROD  TO JL-JCL-LINE-1          17395099
173960*                MOVE JL-JCL-LINE-1     TO TD-JCL-LINE            17396099
173970                 MOVE DP020-USERID      TO  JL-TEST-JOB-NAME      17397099
173980                 MOVE JL-JOB-LINE-TEST  TO  JL-JCL-LINE-1         17398099
173990                 MOVE JL-JCL-LINE-1     TO TD-JCL-LINE            17399099
173991                 PERFORM 9020-WRITE-TD-LINE                       17399199
173992*                MOVE PV-PRINTER-DESTINATION TO JL-LINE-13-PRINTER17399299
173993                 MOVE ASC-PRTR-DEST          TO JL-LINE-13-PRINTER17399399
173994                 MOVE JL-JCL-LINE-13    TO TD-JCL-LINE            17399499
173995                 PERFORM 9020-WRITE-TD-LINE                       17399599
173996                 MOVE JL-JCL-LINE-4-QA  TO TD-JCL-LINE            17399699
173997                 PERFORM 9020-WRITE-TD-LINE                       17399799
173998              END-IF                                              17399899
174000           END-IF                                                 17400099
174100        END-IF                                                    17410099
174200     END-IF.                                                      17420099
174300                                                                  17430099
174400     MOVE JL-JCL-LINE-12 TO TD-JCL-LINE.                          17440099
174500     PERFORM 9020-WRITE-TD-LINE.                                  17450099
174600                                                                  17460099
174700     MOVE JL-JCL-LINE-14 TO TD-JCL-LINE.                          17470099
174800     PERFORM 9020-WRITE-TD-LINE.                                  17480099
174900                                                                  17490099
175000     MOVE ASC-TRIP-ID            TO JL-LINE-15-MANIFEST.          17500099
175100     MOVE DP020-USERID           TO JL-LINE-15-USER-ID.           17510099
175200*    MOVE SURPRQ-RQST-TMST       TO JL-LINE-15-TIMESTMP.          17520099
175300     MOVE ASC-RQST-TMST          TO JL-LINE-15-TIMESTMP.          17530099
175400     MOVE JL-JCL-LINE-15 TO TD-JCL-LINE.                          17540099
175500     PERFORM 9020-WRITE-TD-LINE.                                  17550099
175600                                                                  17560099
175700     MOVE JL-JCL-LINE-16 TO TD-JCL-LINE.                          17570099
175800     PERFORM 9020-WRITE-TD-LINE.                                  17580099
175900                                                                  17590099
176000*    MOVE PV-PRINTER-DESTINATION TO JL-LINE-17-PRINTER.           17600099
176100     MOVE ASC-PRTR-DEST          TO JL-LINE-17-PRINTER.           17610099
176200     MOVE DP072-PRTR-PRTR-CNTL-IND                                17620099
176300                                 TO JL-LINE-17-PRTR-IND.          17630099
176400     MOVE DP072-PRTR-TRACK-NBR   TO JL-LINE-17-TRACK-NBR.         17640099
176500     MOVE DP020-USERID           TO JL-LINE-17-USER-ID.           17650099
176600                                                                  17660099
176700     EVALUATE TRUE                                                17670099
176800       WHEN ASC-ALL-RPTS > SPACE                                  17680099
176900          MOVE PC-Y              TO JL-LINE-17-STAT-RPT           17690099
177000                                    JL-LINE-17-CRTN-RPT           17700099
177100                                    JL-LINE-17-FREE-RPT           17710099
177200                                    JL-LINE-17-MSDR-RPT           17720099
177300                                    JL-LINE-17-DUPL-RPT           17730099
177400                                    JL-LINE-17-WRKS-RPT           17740099
177500                                    JL-LINE-17-SCAN-RPT           17750099
177600                                    JL-LINE-17-ULBL-RPT           17760099
177700       WHEN OTHER                                                 17770099
177800          IF ASC-STS-RPT > SPACE                                  17780099
177900             MOVE PC-Y              TO JL-LINE-17-STAT-RPT        17790099
178000          ELSE                                                    17800099
178100             MOVE SPACE             TO JL-LINE-17-STAT-RPT        17810099
178200          END-IF                                                  17820099
178300                                                                  17830099
178400          IF ASC-NOT-RCVD-RPT > SPACE                             17840099
178500             MOVE PC-Y              TO JL-LINE-17-CRTN-RPT        17850099
178600          ELSE                                                    17860099
178700             MOVE SPACE             TO JL-LINE-17-CRTN-RPT        17870099
178800          END-IF                                                  17880099
178900                                                                  17890099
179000          IF ASC-FR-ASTY-RPT > SPACE                              17900099
179100             MOVE PC-Y              TO JL-LINE-17-FREE-RPT        17910099
179200          ELSE                                                    17920099
179300             MOVE SPACE             TO JL-LINE-17-FREE-RPT        17930099
179400          END-IF                                                  17940099
179500                                                                  17950099
179600          IF ASC-MISDIR-RPT > SPACE                               17960099
179700             MOVE PC-Y              TO JL-LINE-17-MSDR-RPT        17970099
179800          ELSE                                                    17980099
179900             MOVE SPACE             TO JL-LINE-17-MSDR-RPT        17990099
180000          END-IF                                                  18000099
180100                                                                  18010099
180200          IF ASC-DUP-SCAN-RPT > SPACE                             18020099
180300             MOVE PC-Y              TO JL-LINE-17-DUPL-RPT        18030099
180400          ELSE                                                    18040099
180500             MOVE SPACE             TO JL-LINE-17-DUPL-RPT        18050099
180600          END-IF                                                  18060099
180700                                                                  18070099
180800          IF ASC-PO-RPT  > SPACE                                  18080099
180900             MOVE PC-Y              TO JL-LINE-17-WRKS-RPT        18090099
181000          ELSE                                                    18100099
181100             MOVE SPACE             TO JL-LINE-17-WRKS-RPT        18110099
181200          END-IF                                                  18120099
181300                                                                  18130099
181400          IF ASC-NOT-FND-RPT > SPACE                              18140099
181500             MOVE PC-Y              TO JL-LINE-17-SCAN-RPT        18150099
181600          ELSE                                                    18160099
181700             MOVE SPACE             TO JL-LINE-17-SCAN-RPT        18170099
181800          END-IF                                                  18180099
181900                                                                  18190099
182000          IF ASC-UNUSED-LBLS-RPT > SPACE                          18200099
182100             MOVE PC-Y              TO JL-LINE-17-ULBL-RPT        18210099
182200          ELSE                                                    18220099
182300             MOVE SPACE             TO JL-LINE-17-ULBL-RPT        18230099
182400          END-IF                                                  18240099
182500     END-EVALUATE.                                                18250099
182600                                                                  18260099
182700     MOVE ASC-ALL-PO-IND         TO JL-LINE-17-ALL-PO-IND.        18270099
182800     MOVE JL-JCL-LINE-17 TO TD-JCL-LINE.                          18280099
182900     PERFORM 9020-WRITE-TD-LINE.                                  18290099
183000                                                                  18300099
183100*    MOVE JL-JCL-LINE-AUTO-SCHD TO TD-JCL-LINE.                   18310099
183200*    PERFORM 9020-WRITE-TD-LINE.                                  18320099
183300                                                                  18330099
183400     MOVE JL-JCL-LINE-EOF TO TD-JCL-LINE.                         18340099
183500     PERFORM 9020-WRITE-TD-LINE.                                  18350099
183600                                                                  18360099
183700     PERFORM 9030-DEQUEUE-INTERNAL-READER.                        18370099
183800                                                                  18380099
183900     MOVE PC-TSYMSG-00458 TO DP020-MSG-NUMBER.                    18390099
184000                                                                  18400099
184100     SET DP020-MSG-INFORMATIONAL TO TRUE.                         18410099
184200                                                                  18420099
184300******************************************************************18430099
184400*  ENQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *18440099
184500*  THIS WILL PREVENT INTERLEAVING OF JCL SUBMITTED CONCURRENTLY  *18450099
184600*  BY MULTIPLE USERS.  IF THE QUEUE IS BUSY, THIS PROGRAM WILL   *18460099
184700*  WAIT TO ENQUEUE IT, BY NOT SPECIFICALLY HANDLING THE QBUSY    *18470099
184800*  CONDITION.  IF ANY OTHER ERRORS OCCUR, DELETE THE TEMPORARY   *18480099
184900*  STORAGE QUEUE (TO PREVENT OLD REQUEST INFORMATION FROM        *18490099
185000*  ACCIDENTALLY APPEARING ON A FUTURE REQUEST), FORMAT AND       *18500099
185100*  DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE CICS.          *18510099
185200******************************************************************18520099
185300                                                                  18530099
185400 9010-ENQUEUE-INTERNAL-READER.                                    18540099
185500     MOVE '*9010-ENQUEUE-INTERNAL-READER.   *' TO DP013-PARAGRAPH 18550099
185600     EXEC CICS                                                    18560099
185700         ENQ                                                      18570099
185800             RESOURCE(TD-QUEUE-NAME)                              18580099
185900             LENGTH(TD-QUEUE-NAME-LENGTH)                         18590099
186000             RESP(PV-CICS-RESPONSE)                               18600099
186100     END-EXEC.                                                    18610099
186200                                                                  18620099
186300     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    18630099
186400         SET PS-ABEND-IN-PROGRESS TO TRUE                         18640099
186500         STRING 'ENQUEUE '            DELIMITED BY SIZE           18650099
186600                TD-QUEUE-NAME         DELIMITED BY SIZE           18660099
186700                ' (INTERNAL READER)'  DELIMITED BY SIZE           18670099
186800             INTO SE-ATTEMPTED-ACTION                             18680099
186900         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                18690099
187000         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  18700099
187100         PERFORM 9900-LEAVE-SYSTEM                                18710099
187200     END-IF.                                                      18720099
187300                                                                  18730099
187400     SET PS-INTERNAL-READER-ENQUEUED TO TRUE.                     18740099
187500     EJECT                                                        18750099
187600                                                                  18760099
187700******************************************************************18770099
187800*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL *18780099
187900*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE    *18790099
188000*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *18800099
188100*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *18810099
188200*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *18820099
188300*  CICS.                                                         *18830099
188400******************************************************************18840099
188500                                                                  18850099
188600 9020-WRITE-TD-LINE.                                              18860099
188700     MOVE '*9020-WRITE-TD-LINE.             *' TO DP013-PARAGRAPH 18870099
188800     EXEC CICS                                                    18880099
188900         WRITEQ TD                                                18890099
189000             QUEUE(TD-QUEUE-NAME)                                 18900099
189100             FROM(TD-JCL-LINE)                                    18910099
189200             LENGTH(TD-JCL-LINE-LENGTH)                           18920099
189300             RESP(PV-CICS-RESPONSE)                               18930099
189400     END-EXEC.                                                    18940099
189500                                                                  18950099
189600     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    18960099
189700         SET PS-ABEND-IN-PROGRESS TO TRUE                         18970099
189800         STRING 'WRITE TO TRANSIENT DATA QUEUE '                  18980099
189900                                                DELIMITED BY SIZE 18990099
190000                TD-QUEUE-NAME                   DELIMITED BY SIZE 19000099
190100                ' (INTERNAL READER)'            DELIMITED BY SIZE 19010099
190200             INTO SE-ATTEMPTED-ACTION                             19020099
190300         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                19030099
190400         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  19040099
190500         PERFORM 9030-DEQUEUE-INTERNAL-READER                     19050099
190600         PERFORM 9900-LEAVE-SYSTEM                                19060099
190700     END-IF.                                                      19070099
190800     EJECT                                                        19080099
190900                                                                  19090099
191000******************************************************************19100099
191100*  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *19110099
191200*  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     *19120099
191300*  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  *19130099
191400*  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   *19140099
191500*  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      *19150099
191600*  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  *19160099
191700*  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL *19170099
191800*  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    *19180099
191900*  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   *19190099
192000*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *19200099
192100*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *19210099
192200*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *19220099
192300*  CICS.                                                         *19230099
192400******************************************************************19240099
192500                                                                  19250099
192600 9030-DEQUEUE-INTERNAL-READER.                                    19260099
192700     SET PS-INTERNAL-READER-DEQUEUED TO TRUE.                     19270099
192800                                                                  19280099
192900     EXEC CICS                                                    19290099
193000         DEQ                                                      19300099
193100             RESOURCE(TD-QUEUE-NAME)                              19310099
193200             LENGTH(TD-QUEUE-NAME-LENGTH)                         19320099
193300             RESP(PV-CICS-RESPONSE)                               19330099
193400     END-EXEC.                                                    19340099
193500                                                                  19350099
193600     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    19360099
193700         IF PS-NO-ABEND-IN-PROGRESS                               19370099
193800             SET PS-ABEND-IN-PROGRESS TO TRUE                     19380099
193900             STRING 'DEQUEUE '            DELIMITED BY SIZE       19390099
194000                    TD-QUEUE-NAME         DELIMITED BY SIZE       19400099
194100                    ' (INTERNAL READER)'  DELIMITED BY SIZE       19410099
194200                 INTO SE-ATTEMPTED-ACTION                         19420099
194300             MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE            19430099
194400             MOVE SE-SYSTEM-ERROR-MESSAGE TO                      19440099
194500                       PV-LEAVE-SYSTEM-MESSAGE                    19450099
194600             PERFORM 9900-LEAVE-SYSTEM                            19460099
194700         END-IF                                                   19470099
194800     END-IF.                                                      19480099
194900     EJECT                                                        19490099
195000                                                                  19500099
195100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 19510099
195200* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *19520099
195300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 19530099
195400 9100-READ-SEL-QUEUE.                                             19540099
195500                                                                  19550099
195600     EXEC CICS                                                    19560099
195700         READQ TS                                                 19570099
195800             QUEUE (ASC-SEL-QUEUE-NAME)                           19580099
195900             INTO  (SU004-DC-SELECT-RECORD)                       19590099
196000             ITEM  (ASC-SEL-ITEM)                                 19600099
196100             RESP  (PV-CICS-RESP)                                 19610099
196200     END-EXEC.                                                    19620099
196300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        19630099
196400         CONTINUE                                                 19640099
196500     ELSE                                                         19650099
196600         SET DP013-LOGIC-ABEND                                    19660099
196700             DP013-NO-ROLLBACK   TO   TRUE                        19670099
196800         MOVE '9100-READ-SEL-QUEUE'                               19680099
196900                                 TO   DP013-PARAGRAPH             19690099
197000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   19700099
197100                                 TO   DP013-MESSAGE-TEXT (1)      19710099
197200         PERFORM DP013-0000-PROCESS-ABEND                         19720099
197300     END-IF.                                                      19730099
197400                                                                  19740099
197500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19750099
197600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *19760099
197700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 19770099
197800 9200-REWRITE-SEL-QUEUE.                                          19780099
197900                                                                  19790099
198000     EXEC CICS                                                    19800099
198100          WRITEQ TS                                               19810099
198200              QUEUE  (ASC-SEL-QUEUE-NAME)                         19820099
198300              FROM   (SU004-DC-SELECT-RECORD)                     19830099
198400              ITEM   (ASC-SEL-ITEM)                               19840099
198500              RESP   (PV-CICS-RESP)                               19850099
198600              REWRITE                                             19860099
198700     END-EXEC.                                                    19870099
198800                                                                  19880099
198900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   19890099
199000         SET DP013-CICS-ABEND                                     19900099
199100             DP013-NO-ROLLBACK     TO TRUE                        19910099
199200         MOVE '9200-REWRITE-SEL-QUEUE'                            19920099
199300                                   TO DP013-PARAGRAPH             19930099
199400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   19940099
199500                                   TO DP013-MESSAGE-TEXT (1)      19950099
199600         PERFORM DP013-0000-PROCESS-ABEND                         19960099
199700     END-IF.                                                      19970099
199800                                                                  19980099
199900******************************************************************19990099
200000*  EXIT THE SHIPT UNIT REPORT REQUEST SYSTEM, DISPLAYING A       *20000099
200100*  REASON FOR THE PROGRAM ABEND.                                 *20010099
200200******************************************************************20020099
200300                                                                  20030099
200400 9900-LEAVE-SYSTEM.                                               20040099
200500     EXEC CICS                                                    20050099
200600         SEND                                                     20060099
200700             FROM(PV-LEAVE-SYSTEM-MESSAGE)                        20070099
200800             LENGTH(PC-LEAVE-SYSTEM-LENGTH)                       20080099
200900             ERASE                                                20090099
201000     END-EXEC.                                                    20100099
201100                                                                  20110099
201200     EXEC CICS                                                    20120099
201300         RETURN                                                   20130099
201400     END-EXEC.                                                    20140099
201500     EJECT                                                        20150099
201600                                                                  20160099
201700*----------------------------------------------------------------*20170099
201800*    ABEND PROCESSOR MODULE                                      *20180099
201900*----------------------------------------------------------------*20190099
202000                                                                  20200099
202100     COPY DPPD013.                                                20210099
