000100 IDENTIFICATION DIVISION.                                         00010043
000200                                                                  00020043
000300 PROGRAM-ID.             PCKRP009.                                00030043
000400 AUTHOR.                 DENISE HAHN.                             00040043
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050043
000600 DATE-WRITTEN            APRIL, 1998.                             00060043
000700                                                                  00070043
000800*----------------------------------------------------------------*00080043
000900*                                                                *00090043
001000*  THIS PROGRAM CREATES THE PACK-TO-LIGHT DOWNLOAD STATUS REPORT *00100043
001100*  BY STORE ZONE.                                                *00110043
001200*                                                                *00120043
001300*  THE INPUT FILE SHOULD BE SORTED IN THE FOLLOWING SEQUENCE:    *00130043
001400*      -STORE ZONE, RECEIPT DATE, PO #, RECORD SEQUENCE, LINE #  *00140043
001500*----------------------------------------------------------------*00150043
001600* PUT TEMPORARY FIX IN TO WRITE HEADING TO INFOPAC IF PRINTER IS *00160044
001700* SELECTED - PITS # 190510  BY DENISE HAHN                       *00170044
001800*----------------------------------------------------------------*00180044
001900* REMOVED TEMPORARY FIX TO WRITE HEADING TO INFOPAC.  CHANGED    *00190045
002000* PROGRAM PCKRP010 TO END WITH RETURN CODE = +1.  JCL WILL NOT   *00200045
002100* RUN INFOPACK STEPS WITH THIS CONDITION CODE.                   *00210045
002200*----------------------------------------------------------------*00220045
002300                                                                  00230043
002400                                                                  00240043
002500 ENVIRONMENT DIVISION.                                            00250043
002600 INPUT-OUTPUT SECTION.                                            00260043
002700                                                                  00270043
002800 FILE-CONTROL.                                                    00280043
002900                                                                  00290043
003000     SELECT INPUT-FILE        ASSIGN TO INP01.                    00300043
003100                                                                  00310043
003200     SELECT REPORT-FILE-1     ASSIGN TO RPT01.                    00320043
003300                                                                  00330043
003400     SELECT REPORT-FILE-2     ASSIGN TO RPT02.                    00340043
003500                                                                  00350043
003600                                                                  00360043
003700 DATA DIVISION.                                                   00370043
003800                                                                  00380043
003900 FILE SECTION.                                                    00390043
004000 FD  INPUT-FILE                                                   00400043
004100     RECORDING MODE IS F                                          00410043
004200     LABEL RECORDS ARE STANDARD                                   00420043
004300     BLOCK CONTAINS 0 RECORDS.                                    00430043
004400 01  INPUT-RECORD                     PIC X(150).                 00440043
004500                                                                  00450043
004600                                                                  00460043
004700 FD  REPORT-FILE-1                                                00470043
004800     RECORDING MODE IS F                                          00480043
004900     BLOCK CONTAINS 0 RECORDS                                     00490043
005000     LABEL RECORDS ARE OMITTED.                                   00500043
005100 01  REPORT-RECORD-1                  PIC  X(132).                00510043
005200                                                                  00520043
005300                                                                  00530043
005400 FD  REPORT-FILE-2                                                00540043
005500     RECORDING MODE IS F                                          00550043
005600     BLOCK CONTAINS 0 RECORDS                                     00560043
005700     LABEL RECORDS ARE OMITTED.                                   00570043
005800 01  REPORT-RECORD-2                  PIC  X(132).                00580043
005900                                                                  00590043
006000                                                                  00600043
006100 WORKING-STORAGE SECTION.                                         00610043
006200                                                                  00620043
006300 01  CC-CONTROL-CARD-PARAMETERS.                                  00630043
006400     05  CC-USER-ID                   PIC X(07)      VALUE SPACES.00640043
006500     05  FILLER                       PIC X(01)      VALUE SPACE. 00650043
006600     05  CC-DC-NUMBER                 PIC 9(04)      VALUE ZEROES.00660043
006700     05  FILLER                       PIC X(01)      VALUE SPACE. 00670043
006800     05  CC-REPORT-REQUEST-1          PIC X(01)      VALUE 'N'.   00680043
006900         88  CC-REPORT-BY-STORE-ZONE                 VALUE 'S'.   00690043
007000         88  CC-RPT-STORE-ZONE-SUMMRY                VALUE 'X'.   00700043
007100     05  CC-REPORT-REQUEST-2          PIC X(01)      VALUE 'N'.   00710043
007200         88  CC-REPORT-BY-P2L-MODULE                 VALUE 'S'.   00720043
007300         88  CC-RPT-P2L-MODULE-SUMMRY                VALUE 'X'.   00730043
007400     05  CC-TO-INFOPAC-OR-PRINTER     PIC X(01)      VALUE SPACE. 00740043
007500         88  CC-TO-INFOPAC                           VALUE 'I'.   00750043
007600         88  CC-TO-PRINTER                           VALUE 'P'.   00760043
007700     05  CC-PRINTER-ID                PIC X(08)      VALUE SPACES.00770043
007800     05  CC-PRTR-CNTL-IND             PIC X(01)      VALUE SPACES.00780043
007900     05  CC-TRACK-NBR                 PIC 9(01)      VALUE ZEROES.00790043
008000     05  FILLER                       PIC X(54)      VALUE SPACES.00800043
008100                                                                  00810043
008200                                                                  00820043
008300 01  PS-SWITCHES.                                                 00830043
008400     05  PS-INPUT-EOF-SW               PIC  X(01)    VALUE 'N'.   00840043
008500         88  PS-INPUT-EOF                            VALUE 'Y'.   00850043
008600         88  PS-INPUT-NOT-EOF                        VALUE 'N'.   00860043
008700     05  PS-NO-DETAIL-SW               PIC  X(01)    VALUE 'N'.   00870043
008800         88  PS-NO-DETAIL                            VALUE 'Y'.   00880043
008900     05  PS-SUMMARY-TABLE-SW           PIC  X(01)    VALUE 'N'.   00890043
009000         88  SUMMARY-TABLE-EOF                       VALUE 'Y'.   00900043
009100                                                                  00910043
009200 01  CD-CPU-DATE.                                                 00920043
009300     03  CD-YEAR                       PIC  9(02)    VALUE ZERO.  00930043
009400     03  CD-MONTH                      PIC  9(02)    VALUE ZERO.  00940043
009500     03  CD-DAY                        PIC  9(02)    VALUE ZERO.  00950043
009600                                                                  00960043
009700 01  CT-CPU-TIME.                                                 00970043
009800     03  CT-HOUR                       PIC  9(02)    VALUE ZERO.  00980043
009900     03  CT-MINUTE                     PIC  9(02)    VALUE ZERO.  00990043
010000     03  FILLER                        PIC  9(04)    VALUE ZERO.  01000043
010100                                                                  01010043
010200 01  PV-ABEND-FIELDS.                                             01020043
010300     05  PV-RECORD-COUNT              PIC  9(9)  VALUE ZERO.      01030043
010400                                                                  01040043
010500     05  PV-SQLCODE                   PIC  9(9)  VALUE ZERO.      01050043
010600     05  PV-ABEND-CODE                PIC S9(4)  VALUE +0         01060043
010700                                                 COMP SYNC.       01070043
010800     05  PV-ABEND-PROGRAM             PIC  X(8)  VALUE 'PCKRP009'.01080043
010900     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01090043
011000     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01100043
011100     05  PV-ABEND-STRUCTURE-1         PIC  X(8)  VALUE SPACES.    01110043
011200     05  PV-ABEND-STRUCTURE-2         PIC  X(8)  VALUE SPACES.    01120043
011300     05  PV-ABEND-STRUCTURE-3         PIC  X(8)  VALUE SPACES.    01130043
011400     05  PV-DB2-OPERATION-MSG-1       PIC  X(79) VALUE SPACES.    01140043
011500     05  PV-DB2-OPERATION-MSG-2       PIC  X(79) VALUE SPACES.    01150043
011600     05  PV-DB2-OPERATION-MSG-3       PIC  X(79) VALUE SPACES.    01160043
011700     05  PV-DB2-OPERATION-MSG-4       PIC  X(79) VALUE SPACES.    01170043
011800     05  PV-PARAGRAPH-NAME            PIC  X(50) VALUE SPACES.    01180043
011900     05  PV-ERROR-MESSAGE-1           PIC  X(60) VALUE SPACES.    01190043
012000     05  PV-ERROR-MESSAGE-2           PIC  X(60) VALUE SPACES.    01200043
012100                                                                  01210043
012200 01  PC-PROGRAM-CONSTANTS.                                        01220043
012300     05  PC-DESCRIPTION-1             PIC  X(14)    VALUE         01230043
012400             'DATE TOTAL    '.                                    01240043
012500     05  PC-DESCRIPTION-2             PIC  X(14)    VALUE         01250043
012600             'ZONE TOTAL    '.                                    01260043
012700     05  PC-DESCRIPTION-3             PIC  X(14)    VALUE         01270043
012800             'DC TOTAL      '.                                    01280043
012900     05  PC-DESCRIPTION-4             PIC  X(08)    VALUE         01290043
013000             'DC TOTAL'.                                          01300043
013100                                                                  01310043
013200     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)    VALUE         01320043
013300                                          'PCKRP009'.             01330043
013400                                                                  01340043
013500     05  PC-1                         PIC 9(01)     VALUE 1.      01350043
013600     05  PC-TABLE-MAX                 PIC S9(05)    VALUE +150.   01360043
013700     05  PC-ACTUAL-TABLE-ENTRIES      PIC S9(05)    VALUE ZEROES. 01370043
013800     05  PC-LINE-LIMIT                PIC S9(04)    VALUE +60     01380043
013900                                                    COMP SYNC.    01390043
014000                                                                  01400043
014100 01  PV-PROGRAM-VARIABLES.                                        01410043
014200     05  PV-LINE-COUNT                PIC S9(04)    VALUE +0      01420043
014300                                                    COMP SYNC.    01430043
014400     05  PV-PAGE-COUNT                PIC S9(04)    VALUE ZERO.   01440043
014500     05  PV-TIMESTAMP                 PIC X(26).                  01450052
014600                                                                  01460043
014700  01  PV-ACCUMULATOR-FIELDS.                                      01470043
014800*-------------------------------------------------                01480043
014900*  NUMBER OF CARTONS - DETAIL REPORT                              01490043
015000*-------------------------------------------------                01500043
015100     05  PV-PO-RECEIVERS-CRTNS        PIC  9(05)   VALUE ZEROES.  01510043
015200     05  PV-DATE-CRTNS                PIC  9(05)   VALUE ZEROES.  01520043
015300     05  PV-ZONE-CRTNS                PIC  9(05)   VALUE ZEROES.  01530043
015400     05  PV-DC-CRTNS                  PIC  9(05)   VALUE ZEROES.  01540043
015500*-------------------------------------------------                01550043
015600*  NUMBER OF UNITS - DETAIL REPORT                                01560043
015700*-------------------------------------------------                01570043
015800     05  PV-PO-RECEIVERS-UNITS        PIC  9(05)   VALUE ZEROES.  01580043
015900     05  PV-DATE-UNITS                PIC  9(05)   VALUE ZEROES.  01590043
016000     05  PV-ZONE-UNITS                PIC  9(05)   VALUE ZEROES.  01600043
016100     05  PV-DC-UNITS                  PIC  9(05)   VALUE ZEROES.  01610043
016200*-------------------------------------------------                01620043
016300*  NUMBER OF PO-RECEIVER LINES - SUMMARY REPORT                   01630043
016400*-------------------------------------------------                01640043
016500     05  PV-ZONE-TOTAL-LINES          PIC  9(06)   VALUE ZEROES.  01650043
016600     05  PV-ZONE-ARRIVED-LINES        PIC  9(06)   VALUE ZEROES.  01660043
016700     05  PV-ZONE-ENROUTE-LINES        PIC  9(06)   VALUE ZEROES.  01670043
016800*-------------------------------------------------                01680043
016900*  NUMBER OF CARTONS - SUMMARY REPORT                             01690043
017000*-------------------------------------------------                01700043
017100     05  PV-ZONE-TOTAL-CRTNS          PIC  9(06)   VALUE ZEROES.  01710043
017200     05  PV-ZONE-ARRIVED-CRTNS        PIC  9(06)   VALUE ZEROES.  01720043
017300     05  PV-ZONE-ENROUTE-CRTNS        PIC  9(06)   VALUE ZEROES.  01730043
017400*-------------------------------------------------                01740043
017500*  NUMBER OF UNITS - SUMMARY-REPORT                               01750043
017600*-------------------------------------------------                01760043
017700     05  PV-ZONE-TOTAL-UNITS          PIC  9(07)   VALUE ZEROES.  01770043
017800     05  PV-ZONE-ARRIVED-UNITS        PIC  9(07)   VALUE ZEROES.  01780043
017900     05  PV-ZONE-ENROUTE-UNITS        PIC  9(07)   VALUE ZEROES.  01790043
018000*-------------------------------------------------                01800043
018100*  NUMBER OF PO-RECEIVER LINES - FINAL TOTALS                     01810043
018200*-------------------------------------------------                01820043
018300     05  PV-FINAL-TOTAL-LINES         PIC  9(06)   VALUE ZEROES.  01830043
018400     05  PV-FINAL-ARRIVED-LINES       PIC  9(06)   VALUE ZEROES.  01840043
018500     05  PV-FINAL-ENROUTE-LINES       PIC  9(06)   VALUE ZEROES.  01850043
018600*-------------------------------------------------                01860043
018700*  NUMBER OF CARTONS - FINAL TOTALS                               01870043
018800*-------------------------------------------------                01880043
018900     05  PV-FINAL-TOTAL-CRTNS         PIC  9(06)   VALUE ZEROES.  01890043
019000     05  PV-FINAL-ARRIVED-CRTNS       PIC  9(06)   VALUE ZEROES.  01900043
019100     05  PV-FINAL-ENROUTE-CRTNS       PIC  9(06)   VALUE ZEROES.  01910043
019200*-------------------------------------------------                01920043
019300*  NUMBER OF UNITS - FINAL TOTALS                                 01930043
019400*-------------------------------------------------                01940043
019500     05  PV-FINAL-TOTAL-UNITS         PIC  9(07)   VALUE ZEROES.  01950043
019600     05  PV-FINAL-ARRIVED-UNITS       PIC  9(07)   VALUE ZEROES.  01960043
019700     05  PV-FINAL-ENROUTE-UNITS       PIC  9(07)   VALUE ZEROES.  01970043
019800                                                                  01980043
019900  01  PV-HOLD-FIELDS.                                             01990043
020000     05  PV-HOLD-CC-DC-NUMBER        PIC S9(04)     VALUE ZEROES  02000043
020100                                                    COMP.         02010043
020200     05  PV-HOLD-DC-NAME             PIC  X(25)     VALUE SPACES. 02020043
020300     05  PV-HOLD-STORE-ZONE          PIC  X(05)     VALUE SPACES. 02030043
020400     05  PV-HOLD-RECEIPT             PIC  X(10)     VALUE SPACES. 02040043
020500     05  PV-HOLD-RECEIPT-DATE        PIC  X(10)     VALUE SPACES. 02050043
020600         88  TRAILER-ENROUTE             VALUE '09-09-9999'.      02060043
020700     05  PV-HOLD-PO-NMBR             PIC  9(08)     COMP.         02070043
020800     05  PV-HOLD-REC-SEQ-NBR         PIC  X(04)     VALUE SPACES. 02080043
020900     05  PV-HOLD-LINE-LOC            PIC  X(05)     VALUE SPACES. 02090043
021000     05  PV-HOLD-VENDOR-NAME         PIC  X(30)     VALUE SPACES. 02100043
021100     05  PV-HOLD-DEPT-NUMBER         PIC  X(03)     VALUE SPACES. 02110043
021200     05  PV-HOLD-SCAC                PIC  X(04)     VALUE SPACES. 02120043
021300     05  PV-HOLD-TRAILER             PIC  X(10)     VALUE SPACES. 02130043
021400                                                                  02140043
021500     05  PV-PREV-STORE-ZONE          PIC  X(05)     VALUE SPACES. 02150043
021600     05  PV-PREV-PO-NMBR             PIC  9(08)     COMP.         02160043
021700     05  PV-PREV-REC-SEQ-NBR         PIC  X(04)     VALUE SPACES. 02170043
021800     05  PV-PREV-RECEIPT-DATE        PIC  X(10)     VALUE SPACES. 02180043
021900                                                                  02190043
022000                                                                  02200043
022100  01  SPT-SUMMARY-PAGE-TABLE.                                     02210043
022200      05  FILLER  OCCURS 150 TIMES                                02220043
022300                  INDEXED BY SPT-INDEX.                           02230043
022400          10  SPT-STORE-ZONE         PIC X(05)      VALUE SPACES. 02240043
022500          10  SPT-ARRIVED-LINES      PIC 9(06)      VALUE ZEROES. 02250043
022600          10  SPT-ENROUTE-LINES      PIC 9(06)      VALUE ZEROES. 02260043
022700          10  SPT-TOTAL-LINES        PIC 9(06)      VALUE ZEROES. 02270043
022800          10  SPT-ARRIVED-CRTNS      PIC 9(06)      VALUE ZEROES. 02280043
022900          10  SPT-ARRIVED-UNITS      PIC 9(07)      VALUE ZEROES. 02290043
023000          10  SPT-ENROUTE-CRTNS      PIC 9(06)      VALUE ZEROES. 02300043
023100          10  SPT-ENROUTE-UNITS      PIC 9(07)      VALUE ZEROES. 02310043
023200          10  SPT-TOTAL-CRTNS        PIC 9(06)      VALUE ZEROES. 02320043
023300          10  SPT-TOTAL-UNITS        PIC 9(07)      VALUE ZEROES. 02330043
023400                                                                  02340043
023500                                                                  02350043
023600 01  HL1-HEADING-LINE-1.                                          02360043
023700     05  FILLER                      PIC  X(02)    VALUE SPACES.  02370043
023800     05  FILLER                      PIC  X(15)    VALUE          02380043
023900     'REQUESTED BY:  '.                                           02390043
024000     05  HL1-USER-ID                 PIC  X(08)    VALUE SPACES.  02400043
024100     05  FILLER                      PIC  X(19)    VALUE SPACES.  02410043
024200     05  FILLER                      PIC  X(43)    VALUE          02420043
024300     'PACK-TO-LIGHT DOWNLOAD STATUS BY STORE ZONE'.               02430043
024400     05  FILLER                      PIC  X(46)    VALUE SPACES.  02440043
024500                                                                  02450043
024600 01  HL2-HEADING-LINE-2.                                          02460043
024700     05  FILLER                      PIC  X(02)    VALUE SPACES.  02470043
024800     05  FILLER                      PIC  X(05)    VALUE          02480043
024900         'DC:  '.                                                 02490043
025000     05  HL2-DC-NUMBER               PIC  ZZZZ     VALUE ZEROES.  02500043
025100     05  FILLER                      PIC  X(03)    VALUE ' - '.   02510043
025200     05  HL2-DC-NAME                 PIC  X(25)    VALUE SPACES.  02520043
025300     05  FILLER                      PIC  X(93)    VALUE SPACES.  02530043
025400                                                                  02540043
025500 01  HL3-HEADING-LINE-3.                                          02550043
025600     05  FILLER                      PIC  X(01)    VALUE SPACES.  02560043
025700     05  FILLER                      PIC  X(05)    VALUE          02570043
025800         'STORE'.                                                 02580043
025900     05  FILLER                      PIC  X(05)    VALUE SPACES.  02590043
026000     05  FILLER                      PIC  X(07)    VALUE          02600043
026100         'RECEIPT'.                                               02610043
026200     05  FILLER                      PIC  X(20)    VALUE SPACES.  02620043
026300     05  FILLER                      PIC  X(04)    VALUE          02630043
026400         'LINE'.                                                  02640043
026500     05  FILLER                      PIC  X(31)    VALUE SPACES.  02650043
026600     05  FILLER                      PIC  X(04)    VALUE          02660043
026700         'DEPT'.                                                  02670043
026800     05  FILLER                      PIC  X(23)    VALUE SPACES.  02680043
026900     05  FILLER                      PIC  X(18)    VALUE          02690043
027000         '--- DOWNLOADED ---'.                                    02700043
027100     05  FILLER                      PIC  X(16)    VALUE SPACES.  02710043
027200                                                                  02720043
027300 01  HL4-HEADING-LINE-4.                                          02730043
027400     05  FILLER                      PIC  X(02)    VALUE SPACES.  02740043
027500     05  FILLER                      PIC  X(04)    VALUE          02750043
027600         'ZONE'.                                                  02760043
027700     05  FILLER                      PIC  X(06)    VALUE SPACES.  02770043
027800     05  FILLER                      PIC  X(04)    VALUE          02780043
027900         'DATE'.                                                  02790043
028000     05  FILLER                      PIC  X(07)    VALUE SPACES.  02800043
028100     05  FILLER                      PIC  X(11)    VALUE          02810043
028200         'PO/RECEIVER'.                                           02820043
028300     05  FILLER                      PIC  X(05)    VALUE SPACES.  02830043
028400     05  FILLER                      PIC  X(03)    VALUE          02840043
028500         'LOC'.                                                   02850043
028600     05  FILLER                      PIC  X(03)    VALUE SPACES.  02860043
028700     05  FILLER                      PIC  X(11)    VALUE          02870043
028800         'VENDOR NAME'.                                           02880043
028900     05  FILLER                      PIC  X(17)    VALUE SPACES.  02890043
029000     05  FILLER                      PIC  X(03)    VALUE          02900043
029100         'NUM'.                                                   02910043
029200     05  FILLER                      PIC  X(04)    VALUE SPACES.  02920043
029300     05  FILLER                      PIC  X(14)    VALUE          02930043
029400         'SCAC / TRAILER'.                                        02940043
029500     05  FILLER                      PIC  X(07)    VALUE SPACES.  02950043
029600     05  FILLER                      PIC  X(05)    VALUE          02960043
029700         'CRTNS'.                                                 02970043
029800     05  FILLER                      PIC  X(06)    VALUE SPACES.  02980043
029900     05  FILLER                      PIC  X(05)    VALUE          02990043
030000         'UNITS'.                                                 03000043
030100     05  FILLER                      PIC  X(15)    VALUE SPACES.  03010043
030200                                                                  03020043
030300 01  HSL3-HEADING-SUMMARY-LINE-3.                                 03030043
030400     05  FILLER                      PIC  X(03)    VALUE SPACES.  03040043
030500     05  FILLER                      PIC  X(27)    VALUE          03050043
030600         'RECAP SUMMARY BY STORE ZONE'.                           03060043
030700     05  FILLER                      PIC  X(102)   VALUE SPACES.  03070043
030800                                                                  03080043
030900 01  HSL4-HEADING-SUMMARY-LINE-4.                                 03090043
031000     05  FILLER                      PIC  X(57)    VALUE SPACES.  03100043
031100     05  FILLER                      PIC  X(19)    VALUE          03110043
031200         '-------------------'.                                   03120043
031300     05  FILLER                      PIC  X(29)    VALUE          03130043
031400         ' DOWNLOADED TO PACK-TO-LIGHT '.                         03140043
031500     05  FILLER                      PIC  X(19)    VALUE          03150043
031600         '-------------------'.                                   03160043
031700     05  FILLER                      PIC  X(08)    VALUE SPACES.  03170043
031800                                                                  03180043
031900 01  HSL5-HEADING-SUMMARY-LINE-5.                                 03190043
032000     05  FILLER                      PIC  X(11)    VALUE SPACES.  03200043
032100     05  FILLER                      PIC  X(05)    VALUE          03210043
032200         'STORE'.                                                 03220043
032300     05  FILLER                      PIC  X(05)    VALUE SPACES.  03230043
032400     05  FILLER                      PIC  X(31)    VALUE          03240043
032500         '--NUMBER OF PO/RECEIVER LINES--'.                       03250043
032600     05  FILLER                      PIC  X(05)    VALUE SPACES.  03260043
032700     05  FILLER                      PIC  X(19)    VALUE          03270043
032800         '------ARRIVED------'.                                   03280043
032900     05  FILLER                      PIC  X(05)    VALUE SPACES.  03290043
033000     05  FILLER                      PIC  X(19)    VALUE          03300043
033100         '------ENROUTE------'.                                   03310043
033200     05  FILLER                      PIC  X(06)    VALUE SPACES.  03320043
033300     05  FILLER                      PIC  X(18)    VALUE          03330043
033400         '------TOTAL-------'.                                    03340043
033500     05  FILLER                      PIC  X(08)    VALUE SPACES.  03350043
033600                                                                  03360043
033700 01  HSL6-HEADING-SUMMARY-LINE-6.                                 03370043
033800     05  FILLER                      PIC  X(12)    VALUE SPACES.  03380043
033900     05  FILLER                      PIC  X(04)    VALUE          03390043
034000         'ZONE'.                                                  03400043
034100     05  FILLER                      PIC  X(05)    VALUE SPACES.  03410043
034200     05  FILLER                      PIC  X(07)    VALUE          03420043
034300         'ARRIVED'.                                               03430043
034400     05  FILLER                      PIC  X(05)    VALUE SPACES.  03440043
034500     05  FILLER                      PIC  X(07)    VALUE          03450043
034600         'ENROUTE'.                                               03460043
034700     05  FILLER                      PIC  X(07)    VALUE SPACES.  03470043
034800     05  FILLER                      PIC  X(05)    VALUE          03480043
034900         'TOTAL'.                                                 03490043
035000     05  FILLER                      PIC  X(07)    VALUE SPACES.  03500043
035100     05  FILLER                      PIC  X(16)    VALUE          03510043
035200         'CTNS       UNITS'.                                      03520043
035300     05  FILLER                      PIC  X(08)    VALUE SPACES.  03530043
035400     05  FILLER                      PIC  X(16)    VALUE          03540043
035500         'CTNS       UNITS'.                                      03550043
035600     05  FILLER                      PIC  X(07)    VALUE SPACES.  03560043
035700     05  FILLER                      PIC  X(16)    VALUE          03570043
035800         'CTNS       UNITS'.                                      03580043
035900     05  FILLER                      PIC  X(09)    VALUE SPACES.  03590043
036000                                                                  03600043
036100 01  DL1-DETAIL-LINE-1.                                           03610043
036200     05  FILLER                      PIC  X(01)    VALUE SPACES.  03620043
036300     05  DL1-STORE-ZONE              PIC  X(05)    VALUE SPACES.  03630043
036400     05  FILLER                      PIC  X(03)    VALUE SPACE.   03640043
036500     05  DL1-RECEIPT-DATE            PIC  X(10)    VALUE SPACES.  03650043
036600     05  FILLER                      PIC  X(03)    VALUE SPACES.  03660043
036700     05  DL1-PO-NUMBER               PIC  9(08)    VALUE ZEROES.  03670043
036800     05  FILLER                      PIC  X(01)    VALUE '-'.     03680043
036900     05  DL1-PO-SEQ-NBR              PIC  9(04)    VALUE ZEROES.  03690043
037000     05  FILLER                      PIC  X(02)    VALUE SPACES.  03700043
037100     05  DL1-LINE-LOC                PIC  X(05)    VALUE SPACES.  03710043
037200     05  FILLER                      PIC  X(03)    VALUE SPACES.  03720043
037300     05  DL1-VENDOR-NAME             PIC  X(25)    VALUE SPACES.  03730043
037400     05  FILLER                      PIC  X(03)    VALUE SPACES.  03740043
037500     05  DL1-DEPT-NBR                PIC  ZZZ9     VALUE ZEROES.  03750043
037600     05  FILLER                      PIC  X(03)    VALUE SPACES.  03760043
037700     05  DL1-SCAC                    PIC  X(04)    VALUE SPACES.  03770043
037800     05  FILLER                      PIC  X(03)    VALUE ' - '.   03780043
037900     05  DL1-TRAILER                 PIC  X(10)    VALUE SPACES.  03790043
038000     05  FILLER                      PIC  X(03)    VALUE SPACES.  03800043
038100     05  DL1-CARTONS                 PIC  ZZ,ZZ9   VALUE ZEROES.  03810043
038200     05  FILLER                      PIC  X(05)    VALUE SPACES.  03820043
038300     05  DL1-UNITS                   PIC  ZZZ,ZZ9  VALUE ZEROES.  03830043
038400     05  FILLER                      PIC  X(15)    VALUE SPACES.  03840043
038500                                                                  03850043
038600 01  TL1-TOTAL-LINE-1.                                            03860043
038700     05  FILLER                     PIC  X(85)     VALUE SPACES.  03870043
038800     05  TL1-TOT-DESCRIPTION        PIC  X(14)     VALUE SPACES.  03880043
038900     05  TL1-TOT-CARTONS            PIC  ZZZ,ZZ9   VALUE ZEROES.  03890043
039000     05  FILLER                     PIC  X(03)     VALUE SPACES.  03900043
039100     05  TL1-TOT-UNITS              PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03910043
039200     05  FILLER                     PIC  X(16)     VALUE SPACES.  03920043
039300                                                                  03930043
039400 01  SL1-SUMMARY-LINE-1.                                          03940043
039500     05  FILLER                      PIC  X(11)     VALUE SPACES. 03950043
039600     05  SL1-STORE-ZONE              PIC  X(05)     VALUE SPACES. 03960043
039700     05  FILLER                      PIC  X(05)     VALUE SPACE.  03970043
039800     05  SL1-PO-RCVR-LINES-ARRIVED   PIC  ZZZ,ZZ9   VALUE ZEROES. 03980043
039900     05  FILLER                      PIC  X(05)     VALUE SPACES. 03990043
040000     05  SL1-PO-RCVR-LINES-ENROUTE   PIC  ZZZ,ZZ9   VALUE ZEROES. 04000043
040100     05  FILLER                      PIC  X(05)     VALUE SPACES. 04010043
040200     05  SL1-PO-RCVR-LINES-TOTAL     PIC  ZZZ,ZZ9   VALUE ZEROES. 04020043
040300     05  FILLER                      PIC  X(05)     VALUE SPACES. 04030043
040400     05  SL1-TO-P2L-ARRIVED-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04040043
040500     05  FILLER                      PIC  X(03)     VALUE SPACES. 04050043
040600     05  SL1-TO-P2L-ARRIVED-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04060043
040700     05  FILLER                      PIC  X(05)     VALUE SPACES. 04070043
040800     05  SL1-TO-P2L-ENROUTE-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04080043
040900     05  FILLER                      PIC  X(03)     VALUE SPACES. 04090043
041000     05  SL1-TO-P2L-ENROUTE-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04100043
041100     05  FILLER                      PIC  X(05)     VALUE SPACES. 04110043
041200     05  SL1-TO-P2L-TOTAL-CTNS       PIC  ZZZ,ZZ9   VALUE ZEROES. 04120043
041300     05  FILLER                      PIC  X(03)     VALUE SPACES. 04130043
041400     05  SL1-TO-P2L-TOTAL-UNITS      PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04140043
041500     05  FILLER                      PIC  X(08)     VALUE SPACES. 04150043
041600                                                                  04160043
041700 01  SL2-SUMMARY-LINE-2.                                          04170043
041800     05  FILLER                      PIC  X(08)     VALUE SPACES. 04180043
041900     05  SL2-TOTAL-DESCRIPTION       PIC  X(08)     VALUE SPACES. 04190043
042000     05  FILLER                      PIC  X(05)     VALUE SPACE.  04200043
042100     05  SL2-PO-RCVR-LINES-ARRIVED   PIC  ZZZ,ZZ9   VALUE ZEROES. 04210043
042200     05  FILLER                      PIC  X(05)     VALUE SPACES. 04220043
042300     05  SL2-PO-RCVR-LINES-ENROUTE   PIC  ZZZ,ZZ9   VALUE ZEROES. 04230043
042400     05  FILLER                      PIC  X(05)     VALUE SPACES. 04240043
042500     05  SL2-PO-RCVR-LINES-TOTAL     PIC  ZZZ,ZZ9   VALUE ZEROES. 04250043
042600     05  FILLER                      PIC  X(05)     VALUE SPACES. 04260043
042700     05  SL2-TO-P2L-ARRIVED-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04270043
042800     05  FILLER                      PIC  X(03)     VALUE SPACES. 04280043
042900     05  SL2-TO-P2L-ARRIVED-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04290043
043000     05  FILLER                      PIC  X(05)     VALUE SPACES. 04300043
043100     05  SL2-TO-P2L-ENROUTE-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04310043
043200     05  FILLER                      PIC  X(03)     VALUE SPACES. 04320043
043300     05  SL2-TO-P2L-ENROUTE-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04330043
043400     05  FILLER                      PIC  X(05)     VALUE SPACES. 04340043
043500     05  SL2-TO-P2L-TOTAL-CTNS       PIC  ZZZ,ZZ9   VALUE ZEROES. 04350043
043600     05  FILLER                      PIC  X(03)     VALUE SPACES. 04360043
043700     05  SL2-TO-P2L-TOTAL-UNITS      PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04370043
043800     05  FILLER                      PIC  X(08)     VALUE SPACES. 04380043
043900                                                                  04390043
044000 01  PR-PRINT-FINAL.                                              04400043
044100     05  FILLER                      PIC X(02)  VALUE SPACES.     04410043
044200     05  FILLER                      PIC X(19)  VALUE             04420043
044300         '** END OF REPORT **'.                                   04430043
044400     05  FILLER                      PIC X(111) VALUE SPACES.     04440043
044500                                                                  04450043
044600 01  PR-PRINT-NO-DETAIL.                                          04460043
044700     05  FILLER                      PIC X(02)  VALUE SPACES.     04470043
044800     05  FILLER                      PIC X(29)  VALUE             04480043
044900         '*** NO DETAILS TO REPORT ***'.                          04490043
045000     05  FILLER                      PIC X(101) VALUE SPACES.     04500043
045100                                                                  04510046
045200 01  EL1-ERROR-LINE-1.                                            04520046
045300     05  FILLER                      PIC  X(02)     VALUE SPACES. 04530046
045400     05  FILLER                      PIC  X(48)     VALUE         04540046
045500         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04550046
045600     05  FILLER                      PIC  X(49)     VALUE         04560046
045700         'CREATING THIS REPORT.  YOUR REQUEST COULD NOT BE '.     04570046
045800     05  FILLER                      PIC  X(33)     VALUE         04580046
045900         'COMPLETED.                       '.                     04590046
046000                                                                  04600046
046100 01  EL2-ERROR-LINE-2.                                            04610046
046200     05  FILLER                      PIC  X(02)     VALUE SPACES. 04620046
046300     05  FILLER                      PIC  X(50)     VALUE         04630046
046400         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.              '.    04640046
046500     05  FILLER                      PIC  X(81)     VALUE SPACES. 04650046
046600                                                                  04660046
046700 01  EL3-ERROR-LINE-3.                                            04670046
046800     05  FILLER                      PIC  X(02)     VALUE SPACES. 04680046
046900     05  FILLER                      PIC  X(50)     VALUE         04690046
047000         'YOUR REQUEST WAS AS FOLLOWS:                      '.    04700046
047100     05  FILLER                      PIC  X(81)     VALUE SPACES. 04710046
047200                                                                  04720046
047300 01  EL4-ERROR-LINE-4.                                            04730046
047400     05  FILLER                      PIC  X(07)     VALUE SPACES. 04740046
047500     05  FILLER                      PIC  X(30)     VALUE         04750046
047600         'CREATE THE STATUS REPORT BY:  '.                        04760046
047700     05  FILLER                      PIC  X(95)     VALUE SPACES. 04770046
047800                                                                  04780046
047900 01  EL5-ERROR-LINE-5.                                            04790046
048000     05  FILLER                      PIC  X(12)     VALUE SPACES. 04800046
048100     05  FILLER                      PIC  X(25)     VALUE         04810046
048200         'STORE ZONE:              '.                             04820046
048300     05  EL5-STORE-ZONE              PIC  X(01)     VALUE SPACES. 04830046
048400     05  FILLER                      PIC  X(35)     VALUE         04840046
048500         '     (S=ENTIRE RPT, X=SUMMARY ONLY)'.                   04850046
048600     05  FILLER                      PIC  X(59)     VALUE SPACES. 04860046
048700                                                                  04870046
048800 01  EL6-ERROR-LINE-6.                                            04880046
048900     05  FILLER                      PIC  X(12)     VALUE SPACES. 04890046
049000     05  FILLER                      PIC  X(25)     VALUE         04900046
049100         'PACK-TO-LIGHT MODULE:    '.                             04910046
049200     05  EL6-P2L-MODULE              PIC  X(01)     VALUE SPACES. 04920046
049300     05  FILLER                      PIC  X(35)     VALUE         04930046
049400         '     (S=ENTIRE RPT, X=SUMMARY ONLY)'.                   04940046
049500     05  FILLER                      PIC  X(59)     VALUE SPACES. 04950046
049600                                                                  04960046
049700 01  EL7-ERROR-LINE-7.                                            04970046
049800     05  FILLER                      PIC  X(07)     VALUE SPACES. 04980046
049900     05  FILLER                      PIC  X(30)     VALUE         04990046
050000         'PRINT REPORT TO:              '.                        05000046
050100     05  FILLER                      PIC  X(95)     VALUE SPACES. 05010046
050200                                                                  05020046
050300 01  EL8-ERROR-LINE-8.                                            05030046
050400     05  FILLER                      PIC  X(12)     VALUE SPACES. 05040046
050500     05  FILLER                      PIC  X(25)     VALUE         05050046
050600         'INFOPAC (Y/N):           '.                             05060046
050700     05  EL8-INFOPAC                 PIC  X(01)     VALUE SPACES. 05070046
050800     05  FILLER                      PIC  X(94)     VALUE SPACES. 05080046
050900                                                                  05090046
051000 01  EL9-ERROR-LINE-9.                                            05100046
051100     05  FILLER                      PIC  X(12)     VALUE SPACES. 05110046
051200     05  FILLER                      PIC  X(25)     VALUE         05120046
051300         'REMOTE PRINTER ID:       '.                             05130046
051400     05  EL9-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05140046
051500     05  FILLER                      PIC  X(86)     VALUE SPACES. 05150046
051600                                                                  05160046
051700                                                                  05170046
051800                                                                  05180043
051900*-----------------------------------------------------------------05190043
052000* COPYBOOK WITH PRINTEK/CODE V PRINTER CODES                      05200043
052100*-----------------------------------------------------------------05210043
052200     COPY DSWS004.                                                05220043
052300                                                                  05230043
052400*---------------------------------------------------------------* 05240043
052500*  COPYBOOK FOR DB2 ERROR MESSAGE BUILDING                      * 05250043
052600*---------------------------------------------------------------* 05260043
052700     COPY DPWS004.                                                05270043
052800                                                                  05280043
052900*---------------------------------------------------------------* 05290043
053000*    DB2 AREA FOR COMMUNICATIONS                                * 05300043
053100*---------------------------------------------------------------* 05310043
053200     EXEC SQL                                                     05320043
053300          INCLUDE SQLCA                                           05330043
053400     END-EXEC.                                                    05340043
053500                                                                  05350043
053600*---------------------------------------------------------------* 05360043
053700*    DB2 AREA FOR CR-STORE TABLE                                * 05370043
053800*---------------------------------------------------------------* 05380043
053900                                                                  05390043
054000*---------------------------------------------------------------* 05400043
054100*  COPYBOOK USED FOR INPUT FILE                                 * 05410043
054200*---------------------------------------------------------------* 05420043
054300     COPY PCRD004.                                                05430043
054400/                                                                 05440051
054500*    LOCATION MODULE                                              05450051
054600     COPY XLWS071.                                                05460051
054700/                                                                 05470051
054800*---------------------------------------------------------------* 05480043
054900*  COPYBOOK USED FOR OUTPUT REPORT (132 POS)                    * 05490043
055000*---------------------------------------------------------------* 05500043
055100     COPY DPWS132O.                                               05510043
055200                                                                  05520043
055300***************************************************************** 05530043
055400 PROCEDURE DIVISION.                                              05540043
055500*---------------------------------------------------------------* 05550043
055600*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 05560043
055700* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * 05570043
055800* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM    * 05580043
055900* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                    * 05590043
056000*---------------------------------------------------------------* 05600043
056100                                                                  05610043
056200     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN                 05620043
056300                                                                  05630043
056400     MOVE CC-DC-NUMBER  TO  PV-HOLD-CC-DC-NUMBER.                 05640043
056500                                                                  05650043
056600     IF CC-REPORT-BY-STORE-ZONE OR CC-RPT-STORE-ZONE-SUMMRY       05660043
056700         PERFORM 1000-INITIALIZE.                                 05670047
056800                                                                  05680043
056900     GOBACK.                                                      05690043
057000                                                                  05700043
057100 1000-INITIALIZE.                                                 05710043
057200*---------------------------------------------------------------* 05720043
057300*  PROGRAM INITIALIZATION                                       * 05730043
057400*    -- OPEN INPUT AND OUTPUT FILES.                            * 05740043
057500*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 05750043
057600*       THE REPORT HEADINGS.                                    * 05760043
057700*---------------------------------------------------------------* 05770043
057800     EXEC SQL                                                     05780052
057900         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                    05790052
058000     END-EXEC                                                     05800052
058100                                                                  05810054
058200     OPEN  INPUT INPUT-FILE.                                      05820043
058300                                                                  05830043
058400     IF  CC-TO-INFOPAC                                            05840043
058500         OPEN OUTPUT REPORT-FILE-1                                05850043
058600     ELSE                                                         05860043
058700         OPEN OUTPUT REPORT-FILE-2.                               05870044
058800                                                                  05880043
058900     ACCEPT CD-CPU-DATE FROM DATE.                                05890043
059000     ACCEPT CT-CPU-TIME FROM TIME.                                05900043
059100                                                                  05910043
059200     PERFORM 7000-READ-INPUT-FILE.                                05920043
059300                                                                  05930043
059400     IF  PC004-ERROR-RECORD                                       05940046
059500         PERFORM 1010-PROCESS-ERROR                               05950046
059600     ELSE                                                         05960046
059700         PERFORM 1020-PROCESS-REPORT                              05970046
059800         PERFORM 1500-PROCESS-FILE                                05980046
059900     END-IF.                                                      05990046
060000                                                                  06000043
060100                                                                  06010046
060200 1010-PROCESS-ERROR.                                              06020046
060300                                                                  06030046
060400     PERFORM 1100-GET-DC-NAME.                                    06040046
060500     PERFORM 1200-INITIALIZE-HEADINGS.                            06050046
060600                                                                  06060046
060700     IF CC-PRTR-CNTL-IND = 'P'                                    06070046
060800        MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR      06080046
060900        MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI           06090046
061000                                                                  06100046
061100        WRITE REPORT-RECORD-2                                     06110046
061200         FROM DS004-PLC-LOAD-FORM                                 06120046
061300              AFTER ADVANCING 1 LINE                              06130046
061400        END-IF.                                                   06140046
061500                                                                  06150046
061600     IF  CC-REPORT-BY-STORE-ZONE                                  06160046
061700         PERFORM 6000-PRINT-RPT-HEADING                           06170046
061800     ELSE                                                         06180048
061900     IF  CC-RPT-STORE-ZONE-SUMMRY                                 06190048
062000         PERFORM 5700-SUMMARY-HEADING                             06200049
062100     END-IF.                                                      06210046
062200                                                                  06220046
062300     PERFORM 6900-PRINT-ERROR-INFO.                               06230046
062400     PERFORM 6600-PRINT-END-OF-REPORT.                            06240046
062500                                                                  06250046
062600                                                                  06260046
062700 1020-PROCESS-REPORT.                                             06270046
062800                                                                  06280046
062900     MOVE PC004-ORD-NBR          TO  PV-HOLD-PO-NMBR.             06290046
063000     MOVE PC004-REC-SEQ-NBR      TO  PV-HOLD-REC-SEQ-NBR.         06300046
063100     MOVE PC004-REC-DATE         TO  PV-HOLD-RECEIPT-DATE.        06310046
063200     MOVE PC004-STR-ZONE-ID      TO  PV-HOLD-STORE-ZONE.          06320046
063300     MOVE PC004-LNE-LOC-CDE      TO  PV-HOLD-LINE-LOC.            06330046
063400     MOVE PC004-VNDR-NME         TO  PV-HOLD-VENDOR-NAME.         06340046
063500     MOVE PC004-DEPT-NBR         TO  PV-HOLD-DEPT-NUMBER.         06350046
063600     MOVE PC004-SCAC-ID          TO  PV-HOLD-SCAC.                06360046
063700     MOVE PC004-VEH-NBR          TO  PV-HOLD-TRAILER.             06370046
063800                                                                  06380046
063900                                                                  06390046
064000     INITIALIZE SPT-SUMMARY-PAGE-TABLE.                           06400046
064100     SET SPT-INDEX TO 1.                                          06410052
064200                                                                  06420046
064300     PERFORM 1100-GET-DC-NAME.                                    06430046
064400     IF XL071-NO-ERRORS                                           06440051
064500         MOVE XL071-LOC-NM    TO PV-HOLD-DC-NAME                  06450051
064600     ELSE                                                         06460051
064700         MOVE SPACES          TO PV-HOLD-DC-NAME                  06470051
064800     END-IF                                                       06480051
064900                                                                  06490051
065000     PERFORM 1200-INITIALIZE-HEADINGS.                            06500046
065100                                                                  06510046
065200     IF CC-PRTR-CNTL-IND = 'P'                                    06520046
065300        MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR      06530046
065400        MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI           06540046
065500                                                                  06550046
065600        WRITE REPORT-RECORD-2                                     06560046
065700         FROM DS004-PLC-LOAD-FORM                                 06570046
065800              AFTER ADVANCING 1 LINE                              06580046
065900        END-IF.                                                   06590046
066000                                                                  06600046
066100     IF  CC-REPORT-BY-STORE-ZONE                                  06610046
066200         PERFORM 6000-PRINT-RPT-HEADING                           06620046
066300     END-IF.                                                      06630046
066400                                                                  06640046
066500 1100-GET-DC-NAME.                                                06650043
066600                                                                  06660051
066700     INITIALIZE XL071-COMMAREA-REC.                               06670051
066800     MOVE PV-HOLD-CC-DC-NUMBER TO XL071-LOCATION-NUMBER           06680051
066900                                                                  06690051
067000     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06700051
067100                                                                  06710051
067200     EVALUATE TRUE                                                06720051
067300     WHEN XL071-NO-ERRORS                                         06730051
067400     WHEN XL071-LOC-NOT-FOUND                                     06740051
067500     WHEN XL071-DC-ASGMT-NOT-FND                                  06750051
067600         CONTINUE                                                 06760051
067700     WHEN XL071-BAD-DB2-RETURN                                    06770051
067800         MOVE XL071-SQLCA             TO SQLCA                    06780051
067900         MOVE '1100-GET-DC-NAME'      TO PV-ABEND-PARAGRAPH       06790053
068000         MOVE 'CALL XLKUT067 LOCATION MODULE'                     06800051
068100                                      TO PV-ABEND-OPERATION       06810053
068200         MOVE SQLCODE                 TO PV-SQLCODE               06820053
068300         MOVE XL071-DB2-TABLE         TO PV-ABEND-STRUCTURE-1     06830053
068400         PERFORM 9900-DB2-ABEND                                   06840051
068500     END-EVALUATE.                                                06850051
068600/                                                                 06860051
068700 1200-INITIALIZE-HEADINGS.                                        06870043
068800*---------------------------------------------------------------* 06880043
068900*  INITIALIZE REPORT HEADINGS                                   * 06890043
069000*---------------------------------------------------------------* 06900043
069100     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              06910043
069200     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             06920043
069300     MOVE CD-DAY                 TO DP132O-RUN-DAY.               06930043
069400     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              06940043
069500     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            06950043
069600     MOVE 'PCKRP009'             TO DP132O-PROGRAM-NAME.          06960043
069700     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         06970043
069800     MOVE CC-USER-ID             TO HL1-USER-ID.                  06980043
069900     MOVE CC-DC-NUMBER           TO HL2-DC-NUMBER.                06990043
070000     MOVE XL071-LOC-NM           TO HL2-DC-NAME.                  07000052
070100                                                                  07010043
070200                                                                  07020043
070300 1500-PROCESS-FILE.                                               07030043
070400     IF  PS-INPUT-EOF                                             07040043
070500         PERFORM 6800-NO-REPORT-DETAIL                            07050043
070600         SET PS-NO-DETAIL  TO  TRUE                               07060043
070700     ELSE                                                         07070043
070800         PERFORM 2000-MAIN-PROCESS                                07080043
070900           UNTIL  PS-INPUT-EOF.                                   07090043
071000                                                                  07100043
071100     IF  PS-NO-DETAIL                                             07110043
071200         NEXT SENTENCE                                            07120043
071300     ELSE                                                         07130043
071400         IF  CC-RPT-STORE-ZONE-SUMMRY                             07140043
071500             PERFORM 4200-STORE-ZONE-TOTALS                       07150043
071600             PERFORM 5500-PRINT-SUMMARY-PAGE                      07160043
071700         ELSE                                                     07170043
071800             PERFORM 4000-PURCH-ORD-TOTALS                        07180043
071900             PERFORM 4100-DATE-TOTALS                             07190043
072000             PERFORM 4200-STORE-ZONE-TOTALS                       07200043
072100             PERFORM 4300-DC-TOTALS                               07210043
072200             PERFORM 5500-PRINT-SUMMARY-PAGE                      07220043
072300             PERFORM 6600-PRINT-END-OF-REPORT                     07230043
072400         END-IF                                                   07240043
072500     END-IF.                                                      07250043
072600                                                                  07260043
072700     PERFORM 9000-END-PROCESS.                                    07270043
072800                                                                  07280043
072900                                                                  07290043
073000 2000-MAIN-PROCESS.                                               07300043
073100                                                                  07310043
073200      ADD  1  TO  PV-RECORD-COUNT.                                07320043
073300                                                                  07330043
073400*---------------------------------------------------------------* 07340043
073500*  IF NEW STORE ZONE - PRINT PO/DATE/STORE ZONE TOTALS          * 07350043
073600*---------------------------------------------------------------* 07360043
073700     IF  PC004-STR-ZONE-ID  =  PV-HOLD-STORE-ZONE                 07370043
073800         CONTINUE                                                 07380043
073900     ELSE                                                         07390043
074000         PERFORM 4000-PURCH-ORD-TOTALS                            07400043
074100         PERFORM 4100-DATE-TOTALS                                 07410043
074200         PERFORM 4200-STORE-ZONE-TOTALS                           07420043
074300             MOVE PC004-ORD-NBR      TO  PV-HOLD-PO-NMBR          07430043
074400             MOVE PC004-REC-SEQ-NBR  TO  PV-HOLD-REC-SEQ-NBR      07440043
074500             MOVE PC004-REC-DATE     TO  PV-HOLD-RECEIPT-DATE     07450043
074600             MOVE PC004-STR-ZONE-ID  TO  PV-HOLD-STORE-ZONE       07460043
074700             MOVE PC004-LNE-LOC-CDE  TO  PV-HOLD-LINE-LOC         07470043
074800             MOVE PC004-VNDR-NME     TO  PV-HOLD-VENDOR-NAME      07480043
074900             MOVE PC004-DEPT-NBR     TO  PV-HOLD-DEPT-NUMBER      07490043
075000             MOVE PC004-SCAC-ID      TO  PV-HOLD-SCAC             07500043
075100             MOVE PC004-VEH-NBR      TO  PV-HOLD-TRAILER.         07510043
075200                                                                  07520043
075300*---------------------------------------------------------------* 07530043
075400*  IF NEW RECEIPT DATE - PRINT PO/DATE TOTALS                   * 07540043
075500*---------------------------------------------------------------* 07550043
075600     IF  PC004-REC-DATE  =  PV-HOLD-RECEIPT-DATE                  07560043
075700         CONTINUE                                                 07570043
075800     ELSE                                                         07580043
075900         PERFORM 4000-PURCH-ORD-TOTALS                            07590043
076000         PERFORM 4100-DATE-TOTALS                                 07600043
076100             MOVE PC004-ORD-NBR      TO  PV-HOLD-PO-NMBR          07610043
076200             MOVE PC004-REC-SEQ-NBR  TO  PV-HOLD-REC-SEQ-NBR      07620043
076300             MOVE PC004-REC-DATE     TO  PV-HOLD-RECEIPT-DATE     07630043
076400             MOVE PC004-LNE-LOC-CDE  TO  PV-HOLD-LINE-LOC         07640043
076500             MOVE PC004-VNDR-NME     TO  PV-HOLD-VENDOR-NAME      07650043
076600             MOVE PC004-DEPT-NBR     TO  PV-HOLD-DEPT-NUMBER      07660043
076700             MOVE PC004-SCAC-ID      TO  PV-HOLD-SCAC             07670043
076800             MOVE PC004-VEH-NBR      TO  PV-HOLD-TRAILER.         07680043
076900                                                                  07690043
077000*---------------------------------------------------------------* 07700043
077100*  IF NEW PO NUMBER OR NEW SEQUENCE NUMBER - PRINT PO TOTALS    * 07710043
077200*---------------------------------------------------------------* 07720043
077300     IF  PC004-ORD-NBR      =  PV-HOLD-PO-NMBR  AND               07730043
077400         PC004-REC-SEQ-NBR  =  PV-HOLD-REC-SEQ-NBR                07740043
077500         CONTINUE                                                 07750043
077600     ELSE                                                         07760043
077700         PERFORM 4000-PURCH-ORD-TOTALS                            07770043
077800             MOVE PC004-ORD-NBR      TO  PV-HOLD-PO-NMBR          07780043
077900             MOVE PC004-REC-SEQ-NBR  TO  PV-HOLD-REC-SEQ-NBR      07790043
078000             MOVE PC004-LNE-LOC-CDE  TO  PV-HOLD-LINE-LOC         07800043
078100             MOVE PC004-VNDR-NME     TO  PV-HOLD-VENDOR-NAME      07810043
078200             MOVE PC004-DEPT-NBR     TO  PV-HOLD-DEPT-NUMBER      07820043
078300             MOVE PC004-SCAC-ID      TO  PV-HOLD-SCAC             07830043
078400             MOVE PC004-VEH-NBR      TO  PV-HOLD-TRAILER.         07840043
078500                                                                  07850043
078600*----------------------------------------------------------------*07860043
078700* ACCUMULATE PURCHASE ORDER INFORMATION.                         *07870043
078800*       -STORE ZONE, RECEIPT DATE, PURCHASE ORDER LEVEL          *07880043
078900*            -NUMBER OF CARTONS (ZONE/DATE/PO)                   *07890043
079000*            -NUMBER OF UNITS   (ZONE/DATA/PO)                   *07900043
079100*       -SUMMARY - BY STORE ZONE                                 *07910043
079200*            -NUMBER OF PO/RECEIVER LINES (ARRIVED/ENROUTE/TOTAL)*07920043
079300*            -NUMBER OF CARTONS & UNITS (ARRIVED)                *07930043
079400*            -NUMBER OF CARTONS & UNITS (ENROUTE)                *07940043
079500*            -NUMBER OF CARTONS & UNITS (TOTAL)                  *07950043
079600*       -FINAL TOTAL - BY DC                                     *07960043
079700*            -NUMBER OF PO/RECEIVER LINES (ARRIVED/ENROUTE/TOTAL)*07970043
079800*            -NUMBER OF CARTONS & UNITS (ARRIVED)                *07980043
079900*            -NUMBER OF CARTONS & UNITS (ENROUTE)                *07990043
080000*            -NUMBER OF CARTONS & UNITS (TOTAL)                  *08000043
080100*----------------------------------------------------------------*08010043
080200                                                                  08020043
080300     ADD  PC004-P2L-CART-CNT     TO  PV-PO-RECEIVERS-CRTNS.       08030043
080400     ADD  PC004-P2L-UNIT-QTY     TO  PV-PO-RECEIVERS-UNITS.       08040043
080500     ADD  PC004-P2L-CART-CNT     TO  PV-DATE-CRTNS.               08050043
080600     ADD  PC004-P2L-UNIT-QTY     TO  PV-DATE-UNITS.               08060043
080700     ADD  PC004-P2L-CART-CNT     TO  PV-ZONE-CRTNS.               08070043
080800     ADD  PC004-P2L-UNIT-QTY     TO  PV-ZONE-UNITS.               08080043
080900     ADD  PC004-P2L-CART-CNT     TO  PV-DC-CRTNS.                 08090043
081000     ADD  PC004-P2L-UNIT-QTY     TO  PV-DC-UNITS.                 08100043
081100                                                                  08110043
081200     ADD  PC004-P2L-CART-CNT     TO  PV-ZONE-TOTAL-CRTNS          08120043
081300     ADD  PC004-P2L-UNIT-QTY     TO  PV-ZONE-TOTAL-UNITS          08130043
081400     ADD  1                      TO  PV-ZONE-TOTAL-LINES          08140043
081500     ADD  PC004-P2L-CART-CNT     TO  PV-FINAL-TOTAL-CRTNS         08150043
081600     ADD  PC004-P2L-UNIT-QTY     TO  PV-FINAL-TOTAL-UNITS         08160043
081700     ADD  1                      TO  PV-FINAL-TOTAL-LINES         08170043
081800                                                                  08180043
081900     IF  TRAILER-ENROUTE                                          08190043
082000         ADD  PC004-P2L-CART-CNT TO  PV-ZONE-ENROUTE-CRTNS        08200043
082100         ADD  PC004-P2L-UNIT-QTY TO  PV-ZONE-ENROUTE-UNITS        08210043
082200         ADD  1                  TO  PV-ZONE-ENROUTE-LINES        08220043
082300         ADD  PC004-P2L-CART-CNT TO  PV-FINAL-ENROUTE-CRTNS       08230043
082400         ADD  PC004-P2L-UNIT-QTY TO  PV-FINAL-ENROUTE-UNITS       08240043
082500         ADD  1                  TO  PV-FINAL-ENROUTE-LINES       08250043
082600     ELSE                                                         08260043
082700         ADD  PC004-P2L-CART-CNT TO  PV-ZONE-ARRIVED-CRTNS        08270043
082800         ADD  PC004-P2L-UNIT-QTY TO  PV-ZONE-ARRIVED-UNITS        08280043
082900         ADD  1                  TO  PV-ZONE-ARRIVED-LINES        08290043
083000         ADD  PC004-P2L-CART-CNT TO  PV-FINAL-ARRIVED-CRTNS       08300043
083100         ADD  PC004-P2L-UNIT-QTY TO  PV-FINAL-ARRIVED-UNITS       08310043
083200         ADD  1                  TO  PV-FINAL-ARRIVED-LINES.      08320043
083300                                                                  08330043
083400     MOVE PC004-ORD-NBR          TO  PV-HOLD-PO-NMBR.             08340043
083500     MOVE PC004-REC-SEQ-NBR      TO  PV-HOLD-REC-SEQ-NBR.         08350043
083600     MOVE PC004-REC-DATE         TO  PV-HOLD-RECEIPT-DATE.        08360043
083700     MOVE PC004-STR-ZONE-ID      TO  PV-HOLD-STORE-ZONE.          08370043
083800     MOVE PC004-LNE-LOC-CDE      TO  PV-HOLD-LINE-LOC.            08380043
083900     MOVE PC004-VNDR-NME         TO  PV-HOLD-VENDOR-NAME.         08390043
084000     MOVE PC004-DEPT-NBR         TO  PV-HOLD-DEPT-NUMBER.         08400043
084100     MOVE PC004-SCAC-ID          TO  PV-HOLD-SCAC.                08410043
084200     MOVE PC004-VEH-NBR          TO  PV-HOLD-TRAILER.             08420043
084300                                                                  08430043
084400     PERFORM 7000-READ-INPUT-FILE.                                08440043
084500                                                                  08450043
084600                                                                  08460043
084700 4000-PURCH-ORD-TOTALS.                                           08470043
084800*---------------------------------------------------------------* 08480043
084900*  PRINT PURCHASE ORDER TOTALS                                  * 08490043
085000*---------------------------------------------------------------* 08500043
085100                                                                  08510043
085200         IF  PV-HOLD-STORE-ZONE  =     PV-PREV-STORE-ZONE         08520043
085300             MOVE  SPACES              TO DL1-STORE-ZONE          08530043
085400         ELSE                                                     08540043
085500             MOVE PV-HOLD-STORE-ZONE   TO DL1-STORE-ZONE          08550043
085600             MOVE PV-HOLD-STORE-ZONE   TO PV-PREV-STORE-ZONE.     08560043
085700                                                                  08570043
085800         IF  TRAILER-ENROUTE                                      08580043
085900             MOVE 'ENROUTE   '         TO PV-HOLD-RECEIPT         08590043
086000         ELSE                                                     08600043
086100             MOVE PV-HOLD-RECEIPT-DATE TO PV-HOLD-RECEIPT.        08610043
086200                                                                  08620043
086300         IF  PV-HOLD-RECEIPT-DATE  =   PV-PREV-RECEIPT-DATE       08630043
086400             MOVE  SPACES              TO DL1-RECEIPT-DATE        08640043
086500         ELSE                                                     08650043
086600             MOVE PV-HOLD-RECEIPT      TO DL1-RECEIPT-DATE        08660043
086700             MOVE PV-HOLD-RECEIPT-DATE TO PV-PREV-RECEIPT-DATE.   08670043
086800                                                                  08680043
086900         MOVE  PV-HOLD-PO-NMBR         TO DL1-PO-NUMBER.          08690043
087000         MOVE  PV-HOLD-REC-SEQ-NBR     TO DL1-PO-SEQ-NBR.         08700043
087100         MOVE  PV-HOLD-LINE-LOC        TO DL1-LINE-LOC.           08710043
087200         MOVE  PV-HOLD-VENDOR-NAME     TO DL1-VENDOR-NAME.        08720043
087300         MOVE  PV-HOLD-DEPT-NUMBER     TO DL1-DEPT-NBR.           08730043
087400         MOVE  PV-HOLD-SCAC            TO DL1-SCAC.               08740043
087500         MOVE  PV-HOLD-TRAILER         TO DL1-TRAILER.            08750043
087600         MOVE  PV-PO-RECEIVERS-CRTNS   TO DL1-CARTONS.            08760043
087700         MOVE  PV-PO-RECEIVERS-UNITS   TO DL1-UNITS.              08770043
087800                                                                  08780043
087900     IF  CC-REPORT-BY-STORE-ZONE                                  08790043
088000         PERFORM 6200-PRINT-PURCH-ORD-TOTALS                      08800043
088100     END-IF                                                       08810043
088200                                                                  08820043
088300         MOVE  ZEROES                TO PV-PO-RECEIVERS-CRTNS     08830043
088400                                        PV-PO-RECEIVERS-UNITS.    08840043
088500                                                                  08850043
088600                                                                  08860043
088700 4100-DATE-TOTALS.                                                08870043
088800*---------------------------------------------------------------* 08880043
088900*  PRINT DATE TOTALS                                            * 08890043
089000*---------------------------------------------------------------* 08900043
089100                                                                  08910043
089200         MOVE  PC-DESCRIPTION-1      TO TL1-TOT-DESCRIPTION.      08920043
089300         MOVE  PV-DATE-CRTNS         TO TL1-TOT-CARTONS.          08930043
089400         MOVE  PV-DATE-UNITS         TO TL1-TOT-UNITS.            08940043
089500                                                                  08950043
089600         IF CC-REPORT-BY-STORE-ZONE                               08960043
089700             PERFORM 6400-PRINT-TOTALS                            08970043
089800         END-IF                                                   08980043
089900                                                                  08990043
090000         MOVE  ZEROES                TO PV-DATE-CRTNS             09000043
090100                                        PV-DATE-UNITS.            09010043
090200                                                                  09020043
090300                                                                  09030043
090400 4200-STORE-ZONE-TOTALS.                                          09040043
090500*---------------------------------------------------------------* 09050043
090600*  PRINT STORE-ZONE TOTALS                                      * 09060043
090700*---------------------------------------------------------------* 09070043
090800                                                                  09080043
090900         MOVE  PC-DESCRIPTION-2      TO TL1-TOT-DESCRIPTION.      09090043
091000         MOVE  PV-ZONE-CRTNS         TO TL1-TOT-CARTONS.          09100043
091100         MOVE  PV-ZONE-UNITS         TO TL1-TOT-UNITS.            09110043
091200                                                                  09120043
091300     IF  CC-REPORT-BY-STORE-ZONE                                  09130043
091400         PERFORM 6450-PRINT-TOTALS                                09140043
091500     END-IF.                                                      09150043
091600                                                                  09160043
091700         PERFORM 5000-BUILD-SUMMARY-TABLE.                        09170043
091800                                                                  09180043
091900         MOVE  ZEROES                TO PV-ZONE-CRTNS             09190043
092000                                        PV-ZONE-UNITS             09200043
092100                                        PV-ZONE-ARRIVED-LINES     09210043
092200                                        PV-ZONE-ENROUTE-LINES     09220043
092300                                        PV-ZONE-TOTAL-LINES       09230043
092400                                        PV-ZONE-ARRIVED-CRTNS     09240043
092500                                        PV-ZONE-ARRIVED-UNITS     09250043
092600                                        PV-ZONE-ENROUTE-CRTNS     09260043
092700                                        PV-ZONE-ENROUTE-UNITS     09270043
092800                                        PV-ZONE-TOTAL-CRTNS       09280043
092900                                        PV-ZONE-TOTAL-UNITS.      09290043
093000                                                                  09300043
093100         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE.    09310043
093200         MOVE  ZEROES                 TO PV-PREV-PO-NMBR.         09320043
093300                                                                  09330043
093400                                                                  09340043
093500 4300-DC-TOTALS.                                                  09350043
093600*---------------------------------------------------------------* 09360043
093700*  PRINT DC TOTALS                                              * 09370043
093800*---------------------------------------------------------------* 09380043
093900                                                                  09390043
094000         MOVE  PC-DESCRIPTION-3      TO TL1-TOT-DESCRIPTION.      09400043
094100         MOVE  PV-DC-CRTNS           TO TL1-TOT-CARTONS.          09410043
094200         MOVE  PV-DC-UNITS           TO TL1-TOT-UNITS.            09420043
094300                                                                  09430043
094400     IF  CC-REPORT-BY-STORE-ZONE                                  09440043
094500         PERFORM 6450-PRINT-TOTALS                                09450043
094600     END-IF.                                                      09460043
094700                                                                  09470043
094800         MOVE  ZEROES                TO PV-DC-CRTNS               09480043
094900                                        PV-DC-UNITS.              09490043
095000                                                                  09500043
095100                                                                  09510043
095200 5000-BUILD-SUMMARY-TABLE.                                        09520043
095300*---------------------------------------------------------------* 09530043
095400*  BUILD SUMMARY TABLE ENTRY                                    * 09540043
095500*---------------------------------------------------------------* 09550043
095600                                                                  09560043
095700                                                                  09570043
095800     IF  SPT-INDEX GREATER THAN PC-TABLE-MAX                      09580043
095900         MOVE '5000-BUILD-SUMMARY-TABLE'  TO  PV-PARAGRAPH-NAME   09590043
096000         SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX               09600043
096100         MOVE 'SUMMARY TABLE EXCEEDS MAXIMUM TABLE ENTRIES OF 150'09610043
096200                         TO PV-ERROR-MESSAGE-1                    09620043
096300         MOVE 'MAXIMUM TABLE SIZE NEEDS TO BE INCREASED'          09630043
096400                         TO PV-ERROR-MESSAGE-2                    09640043
096500         PERFORM 9200-ABEND.                                      09650043
096600                                                                  09660043
096700     MOVE PV-HOLD-STORE-ZONE     TO  SPT-STORE-ZONE(SPT-INDEX).   09670043
096800     MOVE PV-ZONE-ARRIVED-LINES  TO  SPT-ARRIVED-LINES(SPT-INDEX).09680043
096900     MOVE PV-ZONE-ENROUTE-LINES  TO  SPT-ENROUTE-LINES(SPT-INDEX).09690043
097000     MOVE PV-ZONE-TOTAL-LINES    TO  SPT-TOTAL-LINES(SPT-INDEX).  09700043
097100     MOVE PV-ZONE-ARRIVED-CRTNS  TO  SPT-ARRIVED-CRTNS(SPT-INDEX).09710043
097200     MOVE PV-ZONE-ARRIVED-UNITS  TO  SPT-ARRIVED-UNITS(SPT-INDEX).09720043
097300     MOVE PV-ZONE-ENROUTE-CRTNS  TO  SPT-ENROUTE-CRTNS(SPT-INDEX).09730043
097400     MOVE PV-ZONE-ENROUTE-UNITS  TO  SPT-ENROUTE-UNITS(SPT-INDEX).09740043
097500     MOVE PV-ZONE-TOTAL-CRTNS    TO  SPT-TOTAL-CRTNS(SPT-INDEX).  09750043
097600     MOVE PV-ZONE-TOTAL-UNITS    TO  SPT-TOTAL-UNITS(SPT-INDEX).  09760043
097700                                                                  09770043
097800     SET SPT-INDEX UP BY +1.                                      09780055
097900                                                                  09790043
098000 5500-PRINT-SUMMARY-PAGE.                                         09800043
098100*---------------------------------------------------------------* 09810043
098200*  PRINT SUMMARY PAGE FROM TABLE                                * 09820043
098300*---------------------------------------------------------------* 09830043
098400*---------------------------------------------------------------* 09840044
098500                                                                  09850043
098600     PERFORM 5700-SUMMARY-HEADING.                                09860043
098700                                                                  09870044
098800     SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX                   09880043
098900                                                                  09890056
099000*    THIS IS A WIDGET TO FIX THE INDEX SO THAT IT POINTS TO       09900056
099100*    THE LAST VALID LINE IN THE REPORT.                           09910056
099200     SUBTRACT 1 FROM PC-ACTUAL-TABLE-ENTRIES                      09920056
099300                                                                  09930043
099400     PERFORM 5600-SUMMARY-DETAIL                                  09940043
099500             VARYING SPT-INDEX FROM 1 BY 1                        09950043
099600             UNTIL SUMMARY-TABLE-EOF.                             09960043
099700                                                                  09970043
099800     INITIALIZE SL2-SUMMARY-LINE-2.                               09980043
099900                                                                  09990043
100000     MOVE PC-DESCRIPTION-4           TO SL2-TOTAL-DESCRIPTION.    10000043
100100     MOVE PV-FINAL-ARRIVED-LINES     TO SL2-PO-RCVR-LINES-ARRIVED.10010043
100200     MOVE PV-FINAL-ENROUTE-LINES     TO SL2-PO-RCVR-LINES-ENROUTE.10020043
100300     MOVE PV-FINAL-TOTAL-LINES       TO SL2-PO-RCVR-LINES-TOTAL.  10030043
100400     MOVE PV-FINAL-ARRIVED-CRTNS     TO SL2-TO-P2L-ARRIVED-CTNS.  10040043
100500     MOVE PV-FINAL-ARRIVED-UNITS     TO SL2-TO-P2L-ARRIVED-UNITS. 10050043
100600     MOVE PV-FINAL-ENROUTE-CRTNS     TO SL2-TO-P2L-ENROUTE-CTNS.  10060043
100700     MOVE PV-FINAL-ENROUTE-UNITS     TO SL2-TO-P2L-ENROUTE-UNITS. 10070043
100800     MOVE PV-FINAL-TOTAL-CRTNS       TO SL2-TO-P2L-TOTAL-CTNS.    10080043
100900     MOVE PV-FINAL-TOTAL-UNITS       TO SL2-TO-P2L-TOTAL-UNITS.   10090043
101000                                                                  10100043
101100     PERFORM 5900-PRINT-SUMMARY-FINAL.                            10110043
101200                                                                  10120043
101300                                                                  10130043
101400 5600-SUMMARY-DETAIL.                                             10140043
101500                                                                  10150043
101600     INITIALIZE SL1-SUMMARY-LINE-1.                               10160043
101700                                                                  10170043
101800     MOVE SPT-STORE-ZONE(SPT-INDEX)  TO SL1-STORE-ZONE.           10180043
101900     MOVE SPT-ARRIVED-LINES(SPT-INDEX)                            10190043
102000                                     TO SL1-PO-RCVR-LINES-ARRIVED.10200043
102100     MOVE SPT-ENROUTE-LINES(SPT-INDEX)                            10210043
102200                                     TO SL1-PO-RCVR-LINES-ENROUTE.10220043
102300     MOVE SPT-TOTAL-LINES(SPT-INDEX)                              10230043
102400                                     TO SL1-PO-RCVR-LINES-TOTAL.  10240043
102500     MOVE SPT-ARRIVED-CRTNS(SPT-INDEX)                            10250043
102600                                     TO SL1-TO-P2L-ARRIVED-CTNS.  10260043
102700     MOVE SPT-ARRIVED-UNITS(SPT-INDEX)                            10270043
102800                                     TO SL1-TO-P2L-ARRIVED-UNITS. 10280043
102900     MOVE SPT-ENROUTE-CRTNS(SPT-INDEX)                            10290043
103000                                     TO SL1-TO-P2L-ENROUTE-CTNS.  10300043
103100     MOVE SPT-ENROUTE-UNITS(SPT-INDEX)                            10310043
103200                                     TO SL1-TO-P2L-ENROUTE-UNITS. 10320043
103300     MOVE SPT-TOTAL-CRTNS(SPT-INDEX)                              10330043
103400                                     TO SL1-TO-P2L-TOTAL-CTNS.    10340043
103500     MOVE SPT-TOTAL-UNITS(SPT-INDEX)                              10350043
103600                                     TO SL1-TO-P2L-TOTAL-UNITS.   10360043
103700                                                                  10370043
103800     PERFORM 5800-PRINT-SUMMARY-DETAIL.                           10380043
103900                                                                  10390043
104000     IF SPT-INDEX  =  PC-ACTUAL-TABLE-ENTRIES                     10400043
104100        SET SUMMARY-TABLE-EOF TO TRUE.                            10410043
104200                                                                  10420043
104300                                                                  10430043
104400 5700-SUMMARY-HEADING.                                            10440043
104500*---------------------------------------------------------------* 10450043
104600*  SUMMARY HEADING ROUTINE.                                     * 10460043
104700*---------------------------------------------------------------* 10470043
104800     ADD 1                       TO PV-PAGE-COUNT.                10480043
104900     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           10490043
105000                                                                  10500043
105100     MOVE 12                     TO PV-LINE-COUNT.                10510043
105200                                                                  10520043
105300     IF  CC-TO-INFOPAC                                            10530043
105400         WRITE REPORT-RECORD-1                                    10540043
105500           FROM DP132O-STANDRD-HEADER-132-COLS                    10550043
105600             AFTER ADVANCING PAGE                                 10560043
105700     ELSE                                                         10570043
105800         WRITE REPORT-RECORD-2                                    10580043
105900           FROM DP132O-STANDRD-HEADER-132-COLS                    10590043
106000             AFTER ADVANCING PAGE.                                10600043
106100                                                                  10610043
106200     IF  CC-TO-INFOPAC                                            10620043
106300         WRITE REPORT-RECORD-1                                    10630043
106400           FROM HL1-HEADING-LINE-1                                10640043
106500             AFTER ADVANCING 2 LINES                              10650043
106600     ELSE                                                         10660043
106700         WRITE REPORT-RECORD-2                                    10670043
106800           FROM HL1-HEADING-LINE-1                                10680043
106900             AFTER ADVANCING 2 LINES.                             10690043
107000                                                                  10700043
107100     IF  CC-TO-INFOPAC                                            10710043
107200         WRITE REPORT-RECORD-1                                    10720043
107300           FROM HL2-HEADING-LINE-2                                10730043
107400             AFTER ADVANCING 2 LINES                              10740043
107500     ELSE                                                         10750043
107600         WRITE REPORT-RECORD-2                                    10760043
107700           FROM HL2-HEADING-LINE-2                                10770043
107800             AFTER ADVANCING 2 LINES.                             10780043
107900                                                                  10790043
108000     IF  CC-TO-INFOPAC                                            10800043
108100         WRITE REPORT-RECORD-1                                    10810043
108200           FROM HSL3-HEADING-SUMMARY-LINE-3                       10820043
108300             AFTER ADVANCING 2 LINES                              10830043
108400     ELSE                                                         10840043
108500         WRITE REPORT-RECORD-2                                    10850043
108600           FROM HSL3-HEADING-SUMMARY-LINE-3                       10860043
108700             AFTER ADVANCING 2 LINES.                             10870043
108800                                                                  10880043
108900     IF  CC-TO-INFOPAC                                            10890043
109000         WRITE REPORT-RECORD-1                                    10900043
109100           FROM HSL4-HEADING-SUMMARY-LINE-4                       10910043
109200             AFTER ADVANCING 2 LINES                              10920043
109300     ELSE                                                         10930043
109400         WRITE REPORT-RECORD-2                                    10940043
109500           FROM HSL4-HEADING-SUMMARY-LINE-4                       10950043
109600             AFTER ADVANCING 2 LINES.                             10960043
109700                                                                  10970043
109800     IF  CC-TO-INFOPAC                                            10980043
109900         WRITE REPORT-RECORD-1                                    10990043
110000           FROM HSL5-HEADING-SUMMARY-LINE-5                       11000043
110100             AFTER ADVANCING 1 LINES                              11010043
110200     ELSE                                                         11020043
110300         WRITE REPORT-RECORD-2                                    11030043
110400           FROM HSL5-HEADING-SUMMARY-LINE-5                       11040043
110500             AFTER ADVANCING 1 LINES.                             11050043
110600                                                                  11060043
110700     IF  CC-TO-INFOPAC                                            11070043
110800         WRITE REPORT-RECORD-1                                    11080043
110900           FROM HSL6-HEADING-SUMMARY-LINE-6                       11090043
111000             AFTER ADVANCING 1 LINES                              11100043
111100     ELSE                                                         11110043
111200         WRITE REPORT-RECORD-2                                    11120043
111300           FROM HSL6-HEADING-SUMMARY-LINE-6                       11130043
111400             AFTER ADVANCING 1 LINES.                             11140043
111500                                                                  11150043
111600     IF  CC-TO-INFOPAC                                            11160043
111700         MOVE  SPACES  TO  REPORT-RECORD-1                        11170043
111800         WRITE REPORT-RECORD-1                                    11180043
111900             AFTER ADVANCING 1 LINES                              11190043
112000     ELSE                                                         11200043
112100         MOVE  SPACES  TO  REPORT-RECORD-2                        11210043
112200         WRITE REPORT-RECORD-2                                    11220043
112300             AFTER ADVANCING 1 LINES.                             11230043
112400                                                                  11240043
112500                                                                  11250043
112600 5800-PRINT-SUMMARY-DETAIL.                                       11260043
112700*---------------------------------------------------------------* 11270043
112800*  PRINT SUMMARY PAGE DETAIL LINE                               * 11280043
112900*---------------------------------------------------------------* 11290043
113000                                                                  11300043
113100     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            11310043
113200         PERFORM 5700-SUMMARY-HEADING                             11320043
113300         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     11330043
113400         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       11340043
113500         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          11350043
113600     END-IF.                                                      11360043
113700                                                                  11370043
113800     IF  CC-TO-INFOPAC                                            11380043
113900         WRITE REPORT-RECORD-1                                    11390043
114000           FROM SL1-SUMMARY-LINE-1                                11400043
114100             AFTER ADVANCING 1 LINES                              11410043
114200     ELSE                                                         11420043
114300         WRITE REPORT-RECORD-2                                    11430043
114400           FROM SL1-SUMMARY-LINE-1                                11440043
114500             AFTER ADVANCING 1 LINES.                             11450043
114600                                                                  11460043
114700     ADD 1                       TO PV-LINE-COUNT.                11470043
114800                                                                  11480043
114900     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            11490043
115000         PERFORM 5700-SUMMARY-HEADING                             11500043
115100         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     11510043
115200         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       11520043
115300         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          11530043
115400     END-IF.                                                      11540043
115500                                                                  11550043
115600                                                                  11560043
115700 5900-PRINT-SUMMARY-FINAL.                                        11570043
115800*---------------------------------------------------------------* 11580043
115900*  PRINT SUMMARY PAGE DETAIL LINE                               * 11590043
116000*---------------------------------------------------------------* 11600043
116100                                                                  11610043
116200     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            11620043
116300         PERFORM 5700-SUMMARY-HEADING                             11630043
116400         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     11640043
116500         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       11650043
116600         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          11660043
116700     END-IF.                                                      11670043
116800                                                                  11680043
116900     IF  CC-TO-INFOPAC                                            11690043
117000         WRITE REPORT-RECORD-1                                    11700043
117100           FROM SL2-SUMMARY-LINE-2                                11710043
117200             AFTER ADVANCING 2 LINES                              11720043
117300     ELSE                                                         11730043
117400         WRITE REPORT-RECORD-2                                    11740043
117500           FROM SL2-SUMMARY-LINE-2                                11750043
117600             AFTER ADVANCING 2 LINES.                             11760043
117700                                                                  11770043
117800     ADD 1                       TO PV-LINE-COUNT.                11780043
117900                                                                  11790043
118000     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            11800043
118100         PERFORM 5700-SUMMARY-HEADING                             11810043
118200         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     11820043
118300         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       11830043
118400         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          11840043
118500     END-IF.                                                      11850043
118600                                                                  11860043
118700                                                                  11870043
118800 6000-PRINT-RPT-HEADING.                                          11880043
118900*---------------------------------------------------------------* 11890043
119000*  HEADING ROUTINE.                                             * 11900043
119100*---------------------------------------------------------------* 11910043
119200     ADD 1                       TO PV-PAGE-COUNT.                11920043
119300     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           11930043
119400                                                                  11940043
119500     MOVE 9                      TO PV-LINE-COUNT.                11950043
119600                                                                  11960043
119700     IF  CC-TO-INFOPAC                                            11970043
119800         WRITE REPORT-RECORD-1                                    11980043
119900           FROM DP132O-STANDRD-HEADER-132-COLS                    11990043
120000             AFTER ADVANCING PAGE                                 12000043
120100     ELSE                                                         12010043
120200         WRITE REPORT-RECORD-2                                    12020043
120300           FROM DP132O-STANDRD-HEADER-132-COLS                    12030043
120400             AFTER ADVANCING PAGE.                                12040043
120500                                                                  12050043
120600     IF  CC-TO-INFOPAC                                            12060043
120700         WRITE REPORT-RECORD-1                                    12070043
120800           FROM HL1-HEADING-LINE-1                                12080043
120900             AFTER ADVANCING 2 LINES                              12090043
121000     ELSE                                                         12100043
121100         WRITE REPORT-RECORD-2                                    12110043
121200           FROM HL1-HEADING-LINE-1                                12120043
121300             AFTER ADVANCING 2 LINES.                             12130043
121400                                                                  12140043
121500     IF  CC-TO-INFOPAC                                            12150043
121600         WRITE REPORT-RECORD-1                                    12160043
121700           FROM HL2-HEADING-LINE-2                                12170043
121800             AFTER ADVANCING 2 LINES                              12180043
121900     ELSE                                                         12190043
122000         WRITE REPORT-RECORD-2                                    12200043
122100           FROM HL2-HEADING-LINE-2                                12210043
122200             AFTER ADVANCING 2 LINES.                             12220043
122300                                                                  12230043
122400     IF  CC-TO-INFOPAC                                            12240043
122500         WRITE REPORT-RECORD-1                                    12250043
122600           FROM HL3-HEADING-LINE-3                                12260043
122700             AFTER ADVANCING 2 LINES                              12270043
122800     ELSE                                                         12280043
122900         WRITE REPORT-RECORD-2                                    12290043
123000           FROM HL3-HEADING-LINE-3                                12300043
123100             AFTER ADVANCING 2 LINES.                             12310043
123200                                                                  12320043
123300     IF  CC-TO-INFOPAC                                            12330043
123400         WRITE REPORT-RECORD-1                                    12340043
123500           FROM HL4-HEADING-LINE-4                                12350043
123600             AFTER ADVANCING 1 LINES                              12360043
123700     ELSE                                                         12370043
123800         WRITE REPORT-RECORD-2                                    12380043
123900           FROM HL4-HEADING-LINE-4                                12390043
124000             AFTER ADVANCING 1 LINES.                             12400043
124100                                                                  12410043
124200     IF  CC-TO-INFOPAC                                            12420043
124300         MOVE  SPACES  TO  REPORT-RECORD-1                        12430043
124400         WRITE REPORT-RECORD-1                                    12440043
124500             AFTER ADVANCING 1 LINES                              12450043
124600     ELSE                                                         12460043
124700         MOVE  SPACES  TO  REPORT-RECORD-2                        12470043
124800         WRITE REPORT-RECORD-2                                    12480043
124900             AFTER ADVANCING 1 LINES.                             12490043
125000                                                                  12500043
125100                                                                  12510043
125200 6200-PRINT-PURCH-ORD-TOTALS.                                     12520043
125300*---------------------------------------------------------------* 12530043
125400*  PRINT PURCHASE ORDER TOTALS.                                 * 12540043
125500*---------------------------------------------------------------* 12550043
125600                                                                  12560043
125700     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            12570043
125800         PERFORM 6000-PRINT-RPT-HEADING                           12580043
125900         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     12590043
126000         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       12600043
126100         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          12610043
126200     END-IF.                                                      12620043
126300                                                                  12630043
126400     IF  CC-TO-INFOPAC                                            12640043
126500         WRITE REPORT-RECORD-1                                    12650043
126600           FROM DL1-DETAIL-LINE-1                                 12660043
126700             AFTER ADVANCING 1 LINES                              12670043
126800     ELSE                                                         12680043
126900         WRITE REPORT-RECORD-2                                    12690043
127000           FROM DL1-DETAIL-LINE-1                                 12700043
127100             AFTER ADVANCING 1 LINES.                             12710043
127200                                                                  12720043
127300     ADD 1                       TO PV-LINE-COUNT.                12730043
127400                                                                  12740043
127500     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            12750043
127600         PERFORM 6000-PRINT-RPT-HEADING                           12760043
127700         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     12770043
127800         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       12780043
127900         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          12790043
128000     END-IF.                                                      12800043
128100                                                                  12810043
128200                                                                  12820043
128300 6400-PRINT-TOTALS.                                               12830043
128400*---------------------------------------------------------------* 12840043
128500*  PRINT TOTALS                                                 * 12850043
128600*---------------------------------------------------------------* 12860043
128700                                                                  12870043
128800     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            12880043
128900         PERFORM 6000-PRINT-RPT-HEADING                           12890043
129000         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     12900043
129100         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       12910043
129200         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          12920043
129300     ELSE                                                         12930043
129400     IF  CC-TO-INFOPAC                                            12940043
129500         MOVE  SPACES            TO REPORT-RECORD-1               12950043
129600         WRITE REPORT-RECORD-1                                    12960043
129700             AFTER ADVANCING 1 LINES                              12970043
129800         ADD 1                   TO PV-LINE-COUNT                 12980043
129900     ELSE                                                         12990043
130000     IF  CC-TO-PRINTER                                            13000043
130100         MOVE  SPACES            TO REPORT-RECORD-2               13010043
130200         WRITE REPORT-RECORD-2                                    13020043
130300             AFTER ADVANCING 1 LINES                              13030043
130400         ADD 1                   TO PV-LINE-COUNT.                13040043
130500                                                                  13050043
130600     IF  CC-TO-INFOPAC                                            13060043
130700         WRITE REPORT-RECORD-1                                    13070043
130800           FROM TL1-TOTAL-LINE-1                                  13080043
130900             AFTER ADVANCING 1 LINES                              13090043
131000     ELSE                                                         13100043
131100         WRITE REPORT-RECORD-2                                    13110043
131200           FROM TL1-TOTAL-LINE-1                                  13120043
131300             AFTER ADVANCING 1 LINES.                             13130043
131400                                                                  13140043
131500     ADD 1                       TO PV-LINE-COUNT.                13150043
131600                                                                  13160043
131700     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            13170043
131800         PERFORM 6000-PRINT-RPT-HEADING                           13180043
131900         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     13190043
132000         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       13200043
132100         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          13210043
132200     ELSE                                                         13220043
132300     IF  CC-TO-INFOPAC                                            13230043
132400         MOVE  SPACES            TO REPORT-RECORD-1               13240043
132500         WRITE REPORT-RECORD-1                                    13250043
132600             AFTER ADVANCING 1 LINES                              13260043
132700         ADD 1                   TO PV-LINE-COUNT                 13270043
132800     ELSE                                                         13280043
132900     IF  CC-TO-PRINTER                                            13290043
133000         MOVE  SPACES            TO REPORT-RECORD-2               13300043
133100         WRITE REPORT-RECORD-2                                    13310043
133200             AFTER ADVANCING 1 LINES                              13320043
133300         ADD 1                   TO PV-LINE-COUNT.                13330043
133400                                                                  13340043
133500                                                                  13350043
133600 6450-PRINT-TOTALS.                                               13360043
133700*---------------------------------------------------------------* 13370043
133800*  PRINT TOTALS                                                 * 13380043
133900*---------------------------------------------------------------* 13390043
134000                                                                  13400043
134100     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            13410043
134200         PERFORM 6000-PRINT-RPT-HEADING                           13420043
134300         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     13430043
134400         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       13440043
134500         MOVE  ZEROES                 TO PV-PREV-PO-NMBR.         13450043
134600                                                                  13460043
134700     IF  CC-TO-INFOPAC                                            13470043
134800         WRITE REPORT-RECORD-1                                    13480043
134900           FROM TL1-TOTAL-LINE-1                                  13490043
135000             AFTER ADVANCING 1 LINES                              13500043
135100     ELSE                                                         13510043
135200         WRITE REPORT-RECORD-2                                    13520043
135300           FROM TL1-TOTAL-LINE-1                                  13530043
135400             AFTER ADVANCING 1 LINES.                             13540043
135500                                                                  13550043
135600     ADD 1                       TO PV-LINE-COUNT.                13560043
135700                                                                  13570043
135800     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            13580043
135900         PERFORM 6000-PRINT-RPT-HEADING                           13590043
136000         MOVE  SPACES                 TO PV-PREV-RECEIPT-DATE     13600043
136100         MOVE  SPACES                 TO PV-PREV-STORE-ZONE       13610043
136200         MOVE  ZEROES                 TO PV-PREV-PO-NMBR          13620043
136300     ELSE                                                         13630043
136400     IF  CC-TO-INFOPAC                                            13640043
136500         MOVE  SPACES            TO REPORT-RECORD-1               13650043
136600         WRITE REPORT-RECORD-1                                    13660043
136700             AFTER ADVANCING 1 LINES                              13670043
136800         ADD 1                   TO PV-LINE-COUNT                 13680043
136900     ELSE                                                         13690043
137000     IF  CC-TO-PRINTER                                            13700043
137100         MOVE  SPACES            TO REPORT-RECORD-2               13710043
137200         WRITE REPORT-RECORD-2                                    13720043
137300             AFTER ADVANCING 1 LINES                              13730043
137400         ADD 1                   TO PV-LINE-COUNT.                13740043
137500                                                                  13750043
137600                                                                  13760043
137700 6600-PRINT-END-OF-REPORT.                                        13770043
137800*---------------------------------------------------------------* 13780043
137900*  PRINT END OF REPORT BANNER                                   * 13790043
138000*---------------------------------------------------------------* 13800043
138100                                                                  13810043
138200     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            13820043
138300         PERFORM 6000-PRINT-RPT-HEADING                           13830043
138400     END-IF.                                                      13840043
138500                                                                  13850043
138600     IF  CC-TO-INFOPAC                                            13860043
138700         WRITE REPORT-RECORD-1                                    13870043
138800           FROM PR-PRINT-FINAL                                    13880043
138900             AFTER ADVANCING 2 LINES                              13890043
139000     ELSE                                                         13900043
139100         WRITE REPORT-RECORD-2                                    13910043
139200           FROM PR-PRINT-FINAL                                    13920043
139300             AFTER ADVANCING 2 LINES.                             13930043
139400                                                                  13940043
139500     ADD 2                       TO PV-LINE-COUNT.                13950043
139600                                                                  13960043
139700*-----------------------------------------------------------------13970043
139800*     IF THIS IS A PRINTEK PRINTER 'AND' 2ND REPORT IS NOT STATED 13980043
139900*     ON CONTROL CARD, SEND A CUT COMMAND                         13990043
140000*-----------------------------------------------------------------14000043
140100     IF CC-PRTR-CNTL-IND = 'P'  AND                               14010043
140200        NOT CC-REPORT-BY-P2L-MODULE                               14020043
140300            WRITE REPORT-RECORD-2                                 14030043
140400             FROM DS004-PLC-CUT-FORM                              14040043
140500                 AFTER ADVANCING 1 LINE                           14050043
140600     END-IF.                                                      14060043
140700                                                                  14070043
140800 6800-NO-REPORT-DETAIL.                                           14080043
140900*---------------------------------------------------------------* 14090043
141000*  PRINT "NO DETAIL REPORT' BANNER                              * 14100043
141100*---------------------------------------------------------------* 14110043
141200                                                                  14120043
141300     IF  CC-TO-INFOPAC                                            14130043
141400         WRITE REPORT-RECORD-1                                    14140043
141500           FROM PR-PRINT-NO-DETAIL                                14150043
141600             AFTER ADVANCING 2 LINES                              14160043
141700     ELSE                                                         14170043
141800         WRITE REPORT-RECORD-2                                    14180043
141900           FROM PR-PRINT-NO-DETAIL                                14190043
142000             AFTER ADVANCING 2 LINES.                             14200043
142100                                                                  14210043
142200     ADD 2                       TO PV-LINE-COUNT.                14220043
142300                                                                  14230043
142400*-----------------------------------------------------------------14240043
142500*     IF THIS IS A PRINTEK PRINTER 'AND' 2ND REPORT IS NOT STATED 14250043
142600*     ON CONTROL CARD, SEND A CUT COMMAND                         14260043
142700*-----------------------------------------------------------------14270043
142800     IF CC-PRTR-CNTL-IND = 'P'  AND                               14280043
142900        NOT CC-REPORT-BY-P2L-MODULE                               14290043
143000            WRITE REPORT-RECORD-2                                 14300043
143100             FROM DS004-PLC-CUT-FORM                              14310043
143200                 AFTER ADVANCING 1 LINE                           14320043
143300     END-IF.                                                      14330043
143400                                                                  14340043
143500                                                                  14350046
143600*---------------------------------------------------------------* 14360046
143700*  PRINT ERROR INFORMATION                                      * 14370046
143800*---------------------------------------------------------------* 14380046
143900 6900-PRINT-ERROR-INFO.                                           14390046
144000                                                                  14400046
144100     MOVE  CC-REPORT-REQUEST-1       TO  EL5-STORE-ZONE.          14410046
144200     MOVE  CC-REPORT-REQUEST-2       TO  EL6-P2L-MODULE.          14420046
144300                                                                  14430050
144400     IF  CC-TO-INFOPAC-OR-PRINTER  = 'I'                          14440050
144500         MOVE  'Y'                   TO  EL8-INFOPAC              14450050
144600     ELSE                                                         14460050
144700         MOVE  'N'                   TO  EL8-INFOPAC              14470050
144800     END-IF.                                                      14480050
144900                                                                  14490050
145000     MOVE  CC-PRINTER-ID             TO  EL9-PRINTER-ID.          14500050
145100                                                                  14510050
145200     IF  CC-TO-INFOPAC                                            14520050
145300         WRITE REPORT-RECORD-1                                    14530050
145400           FROM EL1-ERROR-LINE-1                                  14540050
145500             AFTER ADVANCING 2 LINES                              14550050
145600         WRITE REPORT-RECORD-1                                    14560050
145700           FROM EL2-ERROR-LINE-2                                  14570050
145800             AFTER ADVANCING 2 LINES                              14580050
145900         WRITE REPORT-RECORD-1                                    14590050
146000           FROM EL3-ERROR-LINE-3                                  14600050
146100             AFTER ADVANCING 2 LINES                              14610050
146200         WRITE REPORT-RECORD-1                                    14620050
146300           FROM EL4-ERROR-LINE-4                                  14630050
146400             AFTER ADVANCING 2 LINES                              14640050
146500         WRITE REPORT-RECORD-1                                    14650050
146600           FROM EL5-ERROR-LINE-5                                  14660050
146700             AFTER ADVANCING 2 LINES                              14670050
146800         WRITE REPORT-RECORD-1                                    14680050
146900           FROM EL6-ERROR-LINE-6                                  14690050
147000             AFTER ADVANCING 1 LINES                              14700050
147100         WRITE REPORT-RECORD-1                                    14710050
147200           FROM EL7-ERROR-LINE-7                                  14720050
147300             AFTER ADVANCING 2 LINES                              14730050
147400         WRITE REPORT-RECORD-1                                    14740050
147500           FROM EL8-ERROR-LINE-8                                  14750050
147600             AFTER ADVANCING 2 LINES                              14760050
147700         WRITE REPORT-RECORD-1                                    14770050
147800           FROM EL9-ERROR-LINE-9                                  14780050
147900             AFTER ADVANCING 1 LINES                              14790050
148000     ELSE                                                         14800050
148100         WRITE REPORT-RECORD-2                                    14810050
148200           FROM EL1-ERROR-LINE-1                                  14820050
148300             AFTER ADVANCING 2 LINES                              14830050
148400         WRITE REPORT-RECORD-2                                    14840050
148500           FROM EL2-ERROR-LINE-2                                  14850050
148600             AFTER ADVANCING 2 LINES                              14860050
148700         WRITE REPORT-RECORD-2                                    14870050
148800           FROM EL3-ERROR-LINE-3                                  14880050
148900             AFTER ADVANCING 2 LINES                              14890050
149000         WRITE REPORT-RECORD-2                                    14900050
149100           FROM EL4-ERROR-LINE-4                                  14910050
149200             AFTER ADVANCING 2 LINES                              14920050
149300         WRITE REPORT-RECORD-2                                    14930050
149400           FROM EL5-ERROR-LINE-5                                  14940050
149500             AFTER ADVANCING 2 LINES                              14950050
149600         WRITE REPORT-RECORD-2                                    14960050
149700           FROM EL6-ERROR-LINE-6                                  14970050
149800             AFTER ADVANCING 1 LINES                              14980050
149900         WRITE REPORT-RECORD-2                                    14990050
150000           FROM EL7-ERROR-LINE-7                                  15000050
150100             AFTER ADVANCING 2 LINES                              15010050
150200         WRITE REPORT-RECORD-2                                    15020050
150300           FROM EL8-ERROR-LINE-8                                  15030050
150400             AFTER ADVANCING 2 LINES                              15040050
150500         WRITE REPORT-RECORD-2                                    15050050
150600           FROM EL9-ERROR-LINE-9                                  15060050
150700             AFTER ADVANCING 1 LINES                              15070050
150800     END-IF.                                                      15080050
150900                                                                  15090046
151000                                                                  15100046
151100 7000-READ-INPUT-FILE.                                            15110043
151200*---------------------------------------------------------------* 15120043
151300*  READ INPUT FILE                                              * 15130043
151400*---------------------------------------------------------------* 15140043
151500                                                                  15150043
151600      READ INPUT-FILE INTO PC004-P2L-EXT-RECORD                   15160043
151700          AT END                                                  15170043
151800             SET PS-INPUT-EOF TO TRUE.                            15180043
151900                                                                  15190043
152000      IF  PS-INPUT-EOF                                            15200043
152100          NEXT SENTENCE                                           15210043
152200      ELSE                                                        15220043
152300      IF  PC004-CURRENT-OPER  =  CC-DC-NUMBER                     15230043
152400          NEXT SENTENCE                                           15240043
152500      ELSE                                                        15250043
152600          GO TO 7000-READ-INPUT-FILE.                             15260043
152700                                                                  15270043
152800                                                                  15280043
152900 9000-END-PROCESS.                                                15290043
153000*---------------------------------------------------------------* 15300043
153100*  CLOSE FILES.                                                   15310043
153200*---------------------------------------------------------------* 15320043
153300                                                                  15330043
153400     DISPLAY '*------------------------------*'.                  15340043
153500     DISPLAY '*     PROGRAM - PCKRP009       *'.                  15350043
153600     DISPLAY '*------------------------------*'.                  15360043
153700     DISPLAY '* PV-RECORD-COUNT  - ' PV-RECORD-COUNT.             15370043
153800     DISPLAY '*------------------------------*'.                  15380043
153900                                                                  15390043
154000     CLOSE INPUT-FILE                                             15400043
154100                                                                  15410043
154200     IF  CC-TO-INFOPAC                                            15420043
154300         CLOSE  REPORT-FILE-1                                     15430043
154400     ELSE                                                         15440043
154500         CLOSE  REPORT-FILE-2.                                    15450044
154600                                                                  15460043
154700                                                                  15470043
154800 9200-ABEND.                                                      15480043
154900***************************************************************** 15490043
155000*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       15500043
155100***************************************************************** 15510043
155200     DISPLAY '***************************'.                       15520043
155300     DISPLAY '**       ABEND           **'.                       15530043
155400     DISPLAY '**  IN PROGRAM PCKRP009  **'.                       15540043
155500     DISPLAY '***************************'.                       15550043
155600     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        15560043
155700     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       15570043
155800     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       15580043
155900     DISPLAY '** # TABLE ENTRIES ** = ' PC-ACTUAL-TABLE-ENTRIES.  15590043
156000     DISPLAY '** STORE ZONE      ** = ' PV-HOLD-STORE-ZONE.       15600043
156100                                                                  15610043
156200     MOVE +4014                  TO PV-ABEND-CODE.                15620043
156300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         15630043
156400                                                                  15640043
156500                                                                  15650043
156600 9900-DB2-ABEND.                                                  15660043
156700*---------------------------------------------------------------* 15670043
156800*  DB2-ABEND-PROCESSING                                           15680043
156900*---------------------------------------------------------------* 15690043
157000                                                                  15700043
157100     DISPLAY '*** DB2 ERROR '.                                    15710043
157200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       15720043
157300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 15730043
157400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               15740043
157500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               15750043
157600     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MSG-1.           15760043
157700     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-2.           15770043
157800     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-3.           15780043
157900     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             15790043
158000                                                                  15800043
158100     COPY DPPD004.                                                15810043
158200                                                                  15820043
158300     MOVE +4013                  TO PV-ABEND-CODE.                15830043
158400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         15840043
158500                                                                  15850043
158600****************************************************************  15860043
