000100 IDENTIFICATION DIVISION.                                         05/17/95
000200 PROGRAM-ID.    TRKCS143.                                         TRKCS143
000300 AUTHOR.        TOM RUSKA. G&R.                                      LV001
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          TRKCS143
000500 DATE-WRITTEN.  06-09-93.                                         TRKCS143
000600 DATE-COMPILED.                                                   TRKCS143
000700                                                                  TRKCS143
000800*---------------------------------------------------------------* TRKCS143
000900*    Y143 - TRAFFIC FREIGHT BILL LIST                           * TRKCS143
001000*                                                               * TRKCS143
001100*    THIS PROGRAM GENERATES A LIST OF FREIGHT BILLS BASED ON    * TRKCS143
001200*    CRITERIA PASSED FROM THE CRITERIA SPEC SCREEN. THE         * TRKCS143
001300*    APPROPRIATE PROGRAM IS INVOKED WHEN THE OPERATOR SELECTS   * TRKCS143
001400*    ONE OR MORE ITEMS AND PRESSES A FUNCTION KEY.              * TRKCS143
001500*                                                               * TRKCS143
001600*---------------------------------------------------------------* TRKCS143
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001700                                                                  TRKCS143
001800/                                                                 TRKCS143
001900 ENVIRONMENT DIVISION.                                            TRKCS143
002000                                                                  TRKCS143
002100 DATA DIVISION.                                                   TRKCS143
002200                                                                  TRKCS143
002300 WORKING-STORAGE SECTION.                                         TRKCS143
002400                                                                  TRKCS143
002500 01  DK-DB2-KEYS.                                                 TRKCS143
002600     05  DK-PO-NBR                      PIC  S9(09) COMP.         TRKCS143
002700     05  DK-ARRIVAL-DTE-BEG             PIC  X(10).               TRKCS143
002800     05  DK-ARRIVAL-DTE-END             PIC  X(10).               TRKCS143
002900                                                                  TRKCS143
003000 01  DN-DB2-NULL-INDICATORS.                                      TRKCS143
003100     05  DN-VEND-SHIP-DTE               PIC S9(04) VALUE +0       TRKCS143
003200                                                    COMP.         TRKCS143
003300     05  DN-CARR-SHIP-DTE               PIC S9(04) VALUE +0       TRKCS143
003400                                                    COMP.         TRKCS143
003500     05  DN-VEH-NBR                     PIC S9(04) VALUE +0       TRKCS143
003600                                                    COMP.         TRKCS143
003700                                                                  TRKCS143
003800 01  PC-PROGRAM-CONSTANTS.                                        TRKCS143
003900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         TRKCS143
004000                                                    'TR143A  '.   TRKCS143
004100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         TRKCS143
004200                                                    'TRKM143 '.   TRKCS143
004300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         TRKCS143
004400                                                    'TRKCS143'.   TRKCS143
004410     05  PC-DPKCS060                    PIC  X(08)  VALUE                 
004420                                                    'DPKCS060'.   TRKCS143
004500     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      TRKCS143
004600     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      TRKCS143
004700     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    TRKCS143
004800     05  PC-OP-CO-NBR                   PIC  X(02)  VALUE '03'.   TRKCS143
004900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     TRKCS143
005000                                                    COMP SYNC.    TRKCS143
005100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      TRKCS143
005200                                                    COMP SYNC.    TRKCS143
005300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         TRKCS143
005400                                                    +1000000      TRKCS143
005500                                                    COMP-3.       TRKCS143
005600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      TRKCS143
005700                                                    COMP SYNC.    TRKCS143
005800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      TRKCS143
005900                                                    COMP-3.       TRKCS143
005910     05  PC-ONE                         PIC  X(02)  VALUE  '01'.          
006000     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    TRKCS143
006100     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  TRKCS143
006200     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  TRKCS143
006300     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  TRKCS143
006400     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  TRKCS143
006500     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  TRKCS143
006600                                                                  TRKCS143
006700     05  PC-TSYMSG-NUMBERS.                                       TRKCS143
006800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  TRKCS143
006900         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  TRKCS143
007000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  TRKCS143
007100         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  TRKCS143
007200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  TRKCS143
007300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  TRKCS143
007400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  TRKCS143
007500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  TRKCS143
007600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  TRKCS143
007700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  TRKCS143
007800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  TRKCS143
007900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  TRKCS143
008000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  TRKCS143
008100         10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  TRKCS143
008200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  TRKCS143
008300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  TRKCS143
008400         10  PC-TSYMSG-00461            PIC  9(05)  VALUE 00461.  TRKCS143
008410         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.          
008500                                                                  TRKCS143
008600 01  PS-PROGRAM-SWITCHES.                                         TRKCS143
008700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    TRKCS143
008800         88  PS-NO-ERROR                            VALUE 'Y'.    TRKCS143
008900         88  PS-ERROR                               VALUE 'N'.    TRKCS143
009000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    TRKCS143
009100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    TRKCS143
009200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    TRKCS143
009300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    TRKCS143
009400         88  PS-DONE                                VALUE 'Y'.    TRKCS143
009500         88  PS-NOT-DONE                            VALUE 'N'.    TRKCS143
009600                                                                  TRKCS143
009700 01  PV-PROGRAM-VARIABLES.                                        TRKCS143
009800     05  PV-SUB                         PIC S9(04)  VALUE +0      TRKCS143
009900                                                    COMP SYNC.    TRKCS143
010000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      TRKCS143
010100                                                    COMP SYNC.    TRKCS143
010200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      TRKCS143
010300                                                    COMP-3.       TRKCS143
010400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      TRKCS143
010500                                                    COMP-3.       TRKCS143
010600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      TRKCS143
010700                                                    COMP-3.       TRKCS143
010800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      TRKCS143
010900                                                    COMP-3.       TRKCS143
011000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      TRKCS143
011100                                                    COMP-3.       TRKCS143
011200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      TRKCS143
011300                                                    COMP-3.       TRKCS143
011400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      TRKCS143
011500                                                    COMP-3.       TRKCS143
011600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      TRKCS143
011700                                                    COMP SYNC.    TRKCS143
011800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      TRKCS143
011900                                                    COMP SYNC.    TRKCS143
012000     05  PV-ITEM                        PIC S9(04)  VALUE +0      TRKCS143
012100                                                    COMP SYNC.    TRKCS143
012200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      TRKCS143
012300                                                    COMP SYNC.    TRKCS143
012400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      TRKCS143
012500                                                    COMP SYNC.    TRKCS143
012600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      TRKCS143
012700                                                    COMP SYNC.    TRKCS143
012800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      TRKCS143
012900                                                    COMP SYNC.    TRKCS143
013000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      TRKCS143
013100                                                    COMP SYNC.    TRKCS143
013200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      TRKCS143
013300                                                    COMP SYNC.    TRKCS143
013400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      TRKCS143
013500                                                    COMP SYNC.    TRKCS143
013600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      TRKCS143
013700                                                    COMP SYNC.    TRKCS143
013800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      TRKCS143
013900                                                    COMP SYNC.    TRKCS143
014000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      TRKCS143
014100                                                    COMP SYNC.    TRKCS143
014200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      TRKCS143
014300                                                    COMP SYNC.    TRKCS143
014400     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      TRKCS143
014500                                                    COMP SYNC.    TRKCS143
014600     05  PV-DB2-HOST-DATE               PIC X(10).                TRKCS143
014700     05  PV-DB2-DATE.                                             TRKCS143
014800         10  PV-DB2-DATE-CC           PIC X(02)  VALUE SPACES.    TRKCS143
014900         10  PV-DB2-DATE-YY           PIC X(02)  VALUE SPACES.    TRKCS143
015000         10  FILLER                   PIC X(01)  VALUE '-'.       TRKCS143
015100         10  PV-DB2-DATE-MM           PIC X(02)  VALUE SPACES.    TRKCS143
015200         10  FILLER                   PIC X(01)  VALUE '-'.       TRKCS143
015300         10  PV-DB2-DATE-DD           PIC X(02)  VALUE SPACES.    TRKCS143
015400     05  PV-EDIT-DATE.                                            TRKCS143
015500         10  PV-EDIT-DATE-MM          PIC X(02)  VALUE SPACES.    TRKCS143
015600         10  FILLER                   PIC X(01)  VALUE '/'.       TRKCS143
015700         10  PV-EDIT-DATE-DD          PIC X(02)  VALUE SPACES.    TRKCS143
015800         10  FILLER                   PIC X(01)  VALUE '/'.       TRKCS143
015900         10  PV-EDIT-DATE-YY          PIC X(02)  VALUE SPACES.    TRKCS143
016000     05  PV-VENDOR-NBR                PIC 9(03)  VALUE ZEROES.    TRKCS143
016100                                                                  TRKCS143
016200 01  PV-TRKCS141-COMMAREA.                                        TRKCS143
016300     05  PV-CA-OWNER-SCAC-ID          PIC X(04).                  TRKCS143
016400     05  PV-CA-PRO-NBR                PIC X(22).                  TRKCS143
016500     05  PV-CA-PRINTER                PIC X(08).                  TRKCS143
016600                                                                  TRKCS143
016700*---------------------------------------------------------------* TRKCS143
016800*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * TRKCS143
016900*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * TRKCS143
017000*   APPLICATION-SPECIFIC COMMAREA.                              * TRKCS143
017100*---------------------------------------------------------------* TRKCS143
017200 01  LQW-LIST-QUEUE-WORK-AREA.                                    TRKCS143
017300     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  TRKCS143
017400     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           TRKCS143
017500                                        INDEXED BY LQW-IDX.       TRKCS143
017600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       TRKCS143
017700         10  LQW-TEMP-SELECTED-SW       PIC X(01).                TRKCS143
017800         10  LQW-SELECTED-SW            PIC X(01).                TRKCS143
017900             88  LQW-SELECT                         VALUE 'S'.    TRKCS143
018000             88  LQW-DESELECT                       VALUE ' '.    TRKCS143
018100         10  LQW-ACTION                 PIC X(03).                TRKCS143
018200         10  LQW-REC-SEQ-NBR            PIC 9(04).                TRKCS143
018300         10  LQW-PRO-NBR                PIC X(22).                TRKCS143
018400         10  LQW-OWNER-SCAC-ID          PIC X(04).                TRKCS143
018500         10  LQW-VEH-NBR                PIC X(10).                TRKCS143
018600         10  LQW-CARR-SHIP-DTE          PIC X(08).                TRKCS143
018700         10  LQW-VEND-SHIP-DTE          PIC X(08).                TRKCS143
018800         10  LQW-ARRIVAL-DTE            PIC X(08).                TRKCS143
018900                                                                  TRKCS143
019000/                                                                 TRKCS143
019100*---------------------------------------------------------------* TRKCS143
019200*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * TRKCS143
019300*---------------------------------------------------------------* TRKCS143
019400                                                                  TRKCS143
019500     COPY TRWS015.                                                TRKCS143
019600                                                                  TRKCS143
019700/                                                                 TRKCS143
019800*---------------------------------------------------------------* TRKCS143
019900*    MAP LAYOUT                                                 * TRKCS143
020000*---------------------------------------------------------------* TRKCS143
020100                                                                  TRKCS143
020200     COPY TRKM143.                                                TRKCS143
020300                                                                  TRKCS143
020400 01  MR-OCCURS-LAYOUT                   REDEFINES  TR143AO.       TRKCS143
020500     05  FILLER                         PIC X(48).                TRKCS143
020600                                                                  TRKCS143
020700     05  MR-PRINTRL                     PIC S9(04) COMP.          TRKCS143
020800     05  MR-PRINTRA                     PIC X(01).                TRKCS143
020900     05  MR-PRINTRC                     PIC X(01).                TRKCS143
021000     05  MR-PRINTRH                     PIC X(01).                TRKCS143
021100     05  MR-PRINTER-ID                  PIC X(08).                TRKCS143
021200                                                                  TRKCS143
021300     05  MR-PONBRL                      PIC S9(04) COMP.          TRKCS143
021400     05  MR-PONBRA                      PIC X(01).                TRKCS143
021500     05  MR-PONBRC                      PIC X(01).                TRKCS143
021600     05  MR-PONBRH                      PIC X(01).                TRKCS143
021600** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  TRKCS143
021700     05  MR-PO-NBR                      PIC X(08).                TRKCS143
021800                                                                  TRKCS143
021900     05  MR-RCPTBL                      PIC S9(04) COMP.          TRKCS143
022000     05  MR-RCPTBA                      PIC X(01).                TRKCS143
022100     05  MR-RCPTBC                      PIC X(01).                TRKCS143
022200     05  MR-RCPTBH                      PIC X(01).                TRKCS143
022300     05  MR-ARRIVAL-DTE-BEG             PIC X(08).                TRKCS143
022400                                                                  TRKCS143
022500     05  MR-RCPTEL                      PIC S9(04) COMP.          TRKCS143
022600     05  MR-RCPTEA                      PIC X(01).                TRKCS143
022700     05  MR-RCPTEC                      PIC X(01).                TRKCS143
022800     05  MR-RCPTEH                      PIC X(01).                TRKCS143
022900     05  MR-ARRIVAL-DTE-END             PIC X(08).                TRKCS143
023000                                                                  TRKCS143
023100     05  MR-VNAMEL                      PIC S9(04) COMP.          TRKCS143
023200     05  MR-VNAMEA                      PIC X(01).                TRKCS143
023300     05  MR-VNAMEC                      PIC X(01).                TRKCS143
023400     05  MR-VNAMEH                      PIC X(01).                TRKCS143
023500     05  MR-ENT-NAME-DESC               PIC X(25).                TRKCS143
023600                                                                  TRKCS143
023700     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          TRKCS143
023800         10  MR-SELECTL                 PIC S9(04) COMP.          TRKCS143
023900         10  MR-SELECTA                 PIC X(01).                TRKCS143
024000         10  MR-SELECTC                 PIC X(01).                TRKCS143
024100         10  MR-SELECTH                 PIC X(01).                TRKCS143
024200         10  MR-SELECT                  PIC X(01).                TRKCS143
024300                                                                  TRKCS143
024400         10  MR-ACTIONL                 PIC S9(04) COMP.          TRKCS143
024500         10  MR-ACTIONA                 PIC X(01).                TRKCS143
024600         10  MR-ACTIONC                 PIC X(01).                TRKCS143
024700         10  MR-ACTIONH                 PIC X(01).                TRKCS143
024800         10  MR-ACTION                  PIC X(03).                TRKCS143
024900                                                                  TRKCS143
025000         10  MR-REC-SEQ-NBRL            PIC S9(04) COMP.          TRKCS143
025100         10  MR-REC-SEQ-NBRA            PIC X(01).                TRKCS143
025200         10  MR-REC-SEQ-NBRC            PIC X(01).                TRKCS143
025300         10  MR-REC-SEQ-NBRH            PIC X(01).                TRKCS143
025400         10  MR-REC-SEQ-NBR             PIC X(04).                TRKCS143
025500                                                                  TRKCS143
025600         10  MR-PRO-NBRL                PIC S9(04) COMP.          TRKCS143
025700         10  MR-PRO-NBRA                PIC X(01).                TRKCS143
025800         10  MR-PRO-NBRC                PIC X(01).                TRKCS143
025900         10  MR-PRO-NBRH                PIC X(01).                TRKCS143
026000         10  MR-PRO-NBR                 PIC X(16).                TRKCS143
026100                                                                  TRKCS143
026200         10  MR-SCACL                   PIC S9(04) COMP.          TRKCS143
026300         10  MR-SCACA                   PIC X(01).                TRKCS143
026400         10  MR-SCACC                   PIC X(01).                TRKCS143
026500         10  MR-SCACH                   PIC X(01).                TRKCS143
026600         10  MR-OWNER-SCAC-ID           PIC X(04).                TRKCS143
026700                                                                  TRKCS143
026800         10  MR-VEH-NBRL                PIC S9(04) COMP.          TRKCS143
026900         10  MR-VEH-NBRA                PIC X(01).                TRKCS143
027000         10  MR-VEH-NBRC                PIC X(01).                TRKCS143
027100         10  MR-VEH-NBRH                PIC X(01).                TRKCS143
027200         10  MR-VEH-NBR                 PIC X(10).                TRKCS143
027300                                                                  TRKCS143
027400         10  MR-CARR-SHIP-DTEL          PIC S9(04) COMP.          TRKCS143
027500         10  MR-CARR-SHIP-DTEA          PIC X(01).                TRKCS143
027600         10  MR-CARR-SHIP-DTEC          PIC X(01).                TRKCS143
027700         10  MR-CARR-SHIP-DTEH          PIC X(01).                TRKCS143
027800         10  MR-CARR-SHIP-DTE           PIC X(08).                TRKCS143
027900                                                                  TRKCS143
028000         10  MR-VEND-SHIP-DTEL          PIC S9(04) COMP.          TRKCS143
028100         10  MR-VEND-SHIP-DTEA          PIC X(01).                TRKCS143
028200         10  MR-VEND-SHIP-DTEC          PIC X(01).                TRKCS143
028300         10  MR-VEND-SHIP-DTEH          PIC X(01).                TRKCS143
028400         10  MR-VEND-SHIP-DTE           PIC X(08).                TRKCS143
028500                                                                  TRKCS143
028600         10  MR-ARRIVAL-DTEL            PIC S9(04) COMP.          TRKCS143
028700         10  MR-ARRIVAL-DTEA            PIC X(01).                TRKCS143
028800         10  MR-ARRIVAL-DTEC            PIC X(01).                TRKCS143
028900         10  MR-ARRIVAL-DTEH            PIC X(01).                TRKCS143
029000         10  MR-ARRIVAL-DTE             PIC X(08).                TRKCS143
029100                                                                  TRKCS143
029200/                                                                 TRKCS143
029300*---------------------------------------------------------------* TRKCS143
029400*    ATTRIBUTE SETTINGS COPYBOOK.                               * TRKCS143
029500*---------------------------------------------------------------* TRKCS143
029600                                                                  TRKCS143
029700     COPY DPWS015.                                                TRKCS143
029800                                                                  TRKCS143
029900*---------------------------------------------------------------* TRKCS143
030000*    FUNCTION KEYS COPYBOOK.                                    * TRKCS143
030100*---------------------------------------------------------------* TRKCS143
030200                                                                  TRKCS143
030300     COPY DPWS016.                                                TRKCS143
030400                                                                  TRKCS143
030410*----------------------------------------------------------------*        
030420*    COMMAREA COPYBOOK TO LINK TO DPKCS060 - PRINT DEST VALIDATION        
030430*----------------------------------------------------------------*        
030440                                                                          
030450     COPY DPWS072.                                                        
030460                                                                          
030500*---------------------------------------------------------------* TRKCS143
030600*    NUMERIC EDIT LAYOUT.                                       * TRKCS143
030700*---------------------------------------------------------------* TRKCS143
030800                                                                  TRKCS143
030900     COPY DPWS010I.                                               TRKCS143
031000                                                                  TRKCS143
031100/                                                                 TRKCS143
031200*---------------------------------------------------------------* TRKCS143
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * TRKCS143
031400*---------------------------------------------------------------* TRKCS143
031500                                                                  TRKCS143
031600     COPY DPWS030.                                                TRKCS143
CICS       COPY DPWS930.                                                TRKCS143
031800/                                                                 TRKCS143
031900*---------------------------------------------------------------* TRKCS143
032000*    STANDARD COMMAREA.                                         * TRKCS143
032100*---------------------------------------------------------------* TRKCS143
032200                                                                  TRKCS143
032300     COPY DPWS020.                                                TRKCS143
032400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                TRKCS143
032500                                                                  TRKCS143
032600*---------------------------------------------------------------* TRKCS143
032700* INTER-APPLICATION COMMAREA.                                   * TRKCS143
032800*---------------------------------------------------------------* TRKCS143
032900                                                                  TRKCS143
033000         10  INTER-APPL-COMM-AREA       PIC X(200).               TRKCS143
033100     COPY TRWS013.                                                TRKCS143
033200     COPY TRWS014.                                                TRKCS143
033300*---------------------------------------------------------------* TRKCS143
033400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * TRKCS143
033500*---------------------------------------------------------------* TRKCS143
033600         10  ASC-SPECIFIC-COMMAREA.                               TRKCS143
033700             15  ASC-LIST-KEYS.                                   TRKCS143
033800                 20  ASC-KEY-PO-NBR          PIC S9(09) COMP.     TRKCS143
033900                 20  ASC-KEY-ARRIVAL-DTE-BEG PIC X(10).           TRKCS143
034000                 20  ASC-KEY-ARRIVAL-DTE-END PIC X(10).           TRKCS143
034100             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           TRKCS143
034200                 20  ASC-BLOCK-MODIFIED-SW                        TRKCS143
034300                                        PIC X(01).                TRKCS143
034400                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     TRKCS143
034500                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     TRKCS143
034600                                                                  TRKCS143
034700                 20  ASC-ITEM-ARRAY.                              TRKCS143
034800                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        TRKCS143
034900                         30  ASC-LIST-ITEM-NUMBER                 TRKCS143
035000                                        PIC S9(09) COMP-3.        TRKCS143
035100                         30  ASC-TEMP-SELECTED-SW                 TRKCS143
035200                                        PIC X(01).                TRKCS143
035300                             88  ASC-VALID-SELECT  VALUE ' '      TRKCS143
035400                                                         'S'      TRKCS143
035500                                                         'B'      TRKCS143
035600                                                         'E'.     TRKCS143
035700                             88  ASC-TEMP-NO-SELECT               TRKCS143
035800                                                   VALUE ' '.     TRKCS143
035900                             88  ASC-TEMP-SELECT   VALUE 'S'.     TRKCS143
036000                             88  ASC-TEMP-BEGIN    VALUE 'B'.     TRKCS143
036100                             88  ASC-TEMP-END      VALUE 'E'.     TRKCS143
036200                         30  ASC-SELECTED-SW                      TRKCS143
036300                                        PIC X(01).                TRKCS143
036400                             88  ASC-NO-SELECT     VALUE ' '.     TRKCS143
036500                             88  ASC-SELECT        VALUE 'S'.     TRKCS143
036600                             88  ASC-BEGIN         VALUE 'B'.     TRKCS143
036700                             88  ASC-END           VALUE 'E'.     TRKCS143
036800                         30  ASC-ACTION        PIC X(03).         TRKCS143
036900                         30  ASC-REC-SEQ-NBR   PIC 9(04).         TRKCS143
037000                         30  ASC-PRO-NBR       PIC X(22).         TRKCS143
037100                         30  ASC-OWNER-SCAC-ID PIC X(04).         TRKCS143
037200                         30  ASC-VEH-NBR       PIC X(10).         TRKCS143
037300                         30  ASC-CARR-SHIP-DTE PIC X(08).         TRKCS143
037400                         30  ASC-VEND-SHIP-DTE PIC X(08).         TRKCS143
037500                         30  ASC-ARRIVAL-DTE   PIC X(08).         TRKCS143
037600                                                                  TRKCS143
037700             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     TRKCS143
037800             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     TRKCS143
037900             15  ASC-NUMBER-OF-ITEMS-READ                         TRKCS143
038000                                        PIC S9(09) COMP-3.        TRKCS143
038100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     TRKCS143
038200                                        PIC S9(09) COMP-3.        TRKCS143
038300             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        TRKCS143
038400             15  ASC-ITEM-AT-TOP-OF-PANEL                         TRKCS143
038500                                        PIC S9(09) COMP-3.        TRKCS143
038600             15  ASC-ITEM-AT-BOT-OF-PANEL                         TRKCS143
038700                                        PIC S9(09) COMP-3.        TRKCS143
038800             15  ASC-HIGHEST-BLOCK-WRITTEN                        TRKCS143
038900                                        PIC S9(04) COMP SYNC.     TRKCS143
039000             15  ASC-START-OF-SELECTED-RANGE                      TRKCS143
039100                                        PIC S9(09) COMP-3.        TRKCS143
039200             15  ASC-END-OF-SELECTED-RANGE                        TRKCS143
039300                                        PIC S9(09) COMP-3.        TRKCS143
039400             15  ASC-ITEMS-LEFT-INDICATOR                         TRKCS143
039500                                        PIC X(01).                TRKCS143
039600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     TRKCS143
039700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     TRKCS143
039800             15  ASC-TEMP-QUEUE-UPDATE-SW                         TRKCS143
039900                                        PIC X(01).                TRKCS143
040000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     TRKCS143
040100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     TRKCS143
040200             15  ASC-LIST-QUEUE-NAME.                             TRKCS143
040300                 20  ASC-LIST-TERM-ID   PIC X(04).                TRKCS143
040400                 20  ASC-LIST-TASK-NUMBER                         TRKCS143
040500                                        PIC S9(05) COMP-3.        TRKCS143
040600                 20  ASC-LIST-SEQ       PIC 9(01).                TRKCS143
040700             15  ASC-SEL-QUEUE-NAME.                              TRKCS143
040800                 20  ASC-SEL-TERM-ID    PIC X(04).                TRKCS143
040900                 20  ASC-SEL-TASK-NUMBER                          TRKCS143
041000                                        PIC S9(05) COMP-3.        TRKCS143
041100                 20  ASC-SEL-SEQ        PIC 9(01).                TRKCS143
041200                                                                  TRKCS143
041300             15  ASC-CURSOR-SW          PIC X(01).                TRKCS143
041400                 88  ASC-NO-CURSOR                 VALUE 'Z'.     TRKCS143
041500                 88  ASC-TYPE-CURSOR               VALUE 'S'.     TRKCS143
041600                 88  ASC-LOC-CURSOR                VALUE 'N'.     TRKCS143
041700                 88  ASC-DESC-CURSOR               VALUE 'T'.     TRKCS143
041800             15  ASC-START-ITEM-REQUEST.                          TRKCS143
041900                 20  ASC-START-ITEM-REQUEST-N                     TRKCS143
042000                                        PIC 9(07).                TRKCS143
021600** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  TRKCS143
042100             15  ASC-PO-NBR             PIC 9(08).                TRKCS143
042200             15  ASC-ARRIVAL-DTE-BEG    PIC X(10).                TRKCS143
042300             15  ASC-ARRIVAL-DTE-END    PIC X(10).                TRKCS143
042400             15  ASC-ENT-NAME-DESC      PIC X(25).                TRKCS143
042500             15  ASC-PRINTER-ID-X.                                TRKCS143
042600                 20  ASC-PRINTER-ID          PIC  9(08).          TRKCS143
042700                 20  FILLER REDEFINES ASC-PRINTER-ID.             TRKCS143
042800                     25  ASC-PRINTER-ID-1-1  PIC  X(01).          TRKCS143
042900                     25  ASC-PRINTER-ID-2-8  PIC  X(07).          TRKCS143
043000                     25  ASC-PRINTER-ID-2-8-N REDEFINES           TRKCS143
043100                         ASC-PRINTER-ID-2-8  PIC  9(07).          TRKCS143
043200/                                                                 TRKCS143
043300*---------------------------------------------------------------* TRKCS143
043400*    ABEND PROCESSING COPYBOOK.                                 * TRKCS143
043500*---------------------------------------------------------------* TRKCS143
043600                                                                  TRKCS143
043700     COPY DPWS013.                                                TRKCS143
043800                                                                  TRKCS143
043900/                                                                 TRKCS143
044000*---------------------------------------------------------------* TRKCS143
044100*    DB2 AREA FOR THE SHIPMENT TABLE                            * TRKCS143
044200*---------------------------------------------------------------* TRKCS143
044300     EXEC SQL                                                     TRKCS143
044400          INCLUDE TSHIPMT                                         TRKCS143
044500     END-EXEC.                                                    TRKCS143
044600                                                                  TRKCS143
044700/                                                                 TRKCS143
044800*---------------------------------------------------------------* TRKCS143
044900*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * TRKCS143
045000*---------------------------------------------------------------* TRKCS143
045100     EXEC SQL                                                     TRKCS143
045200          INCLUDE TVHTRIP                                         TRKCS143
045300     END-EXEC.                                                    TRKCS143
045400                                                                  TRKCS143
045500/                                                                 TRKCS143
045600*---------------------------------------------------------------* TRKCS143
045700*    DB2 AREA FOR THE RECEIVER TABLE                            * TRKCS143
045800*---------------------------------------------------------------* TRKCS143
045900     EXEC SQL                                                     TRKCS143
046000          INCLUDE TRECEIV                                         TRKCS143
046100     END-EXEC.                                                    TRKCS143
046200                                                                  TRKCS143
046300/                                                                 TRKCS143
046400*---------------------------------------------------------------* TRKCS143
046500*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * TRKCS143
046600*---------------------------------------------------------------* TRKCS143
046700     EXEC SQL                                                     TRKCS143
046800          INCLUDE TPURCHS                                         TRKCS143
046900     END-EXEC.                                                    TRKCS143
047000                                                                  TRKCS143
047100/                                                                 TRKCS143
047200*---------------------------------------------------------------* TRKCS143
047300*    DB2 AREA FOR THE SHIPMENT PO TABLE                         * TRKCS143
047400*---------------------------------------------------------------* TRKCS143
047500     EXEC SQL                                                     TRKCS143
047600          INCLUDE TSHPTPO                                         TRKCS143
047700     END-EXEC.                                                    TRKCS143
047800                                                                  TRKCS143
047900/                                                                 TRKCS143
048000*---------------------------------------------------------------* TRKCS143
048100*    DB2 AREA FOR THE EXTERNAL ENTERPRISE TABLE                 * TRKCS143
048200*---------------------------------------------------------------* TRKCS143
048300     EXEC SQL                                                     TRKCS143
048400          INCLUDE TEXTENT                                         TRKCS143
048500     END-EXEC.                                                    TRKCS143
048600                                                                  TRKCS143
048700/                                                                 TRKCS143
048800*---------------------------------------------------------------* TRKCS143
048900*    DB2 AREA FOR THE EXTERNAL ENTERPRISE NAME TABLE            * TRKCS143
049000*---------------------------------------------------------------* TRKCS143
049100     EXEC SQL                                                     TRKCS143
049200          INCLUDE TENTNME                                         TRKCS143
049300     END-EXEC.                                                    TRKCS143
049400                                                                  TRKCS143
049500/                                                                 TRKCS143
049600*---------------------------------------------------------------* TRKCS143
049700*    DB2 AREA FOR COMMUNICATIONS                                * TRKCS143
049800*---------------------------------------------------------------* TRKCS143
049900     EXEC SQL                                                     TRKCS143
050000          INCLUDE SQLCA                                           TRKCS143
050100     END-EXEC.                                                    TRKCS143
050200                                                                  TRKCS143
050300/                                                                 TRKCS143
050400*---------------------------------------------------------------* TRKCS143
050500*  CURSOR TO SELECT FREIGHT BILLS                               * TRKCS143
050600*---------------------------------------------------------------* TRKCS143
050700                                                                  TRKCS143
050800     EXEC SQL                                                     TRKCS143
050900         DECLARE RECEIVER-CSR CURSOR FOR                          TRKCS143
051000             SELECT  DISTINCT                                     TRKCS143
051100                     A.REC_SEQ_NBR                                TRKCS143
051200                    ,DATE(A.REC_TMST)                             TRKCS143
051300                    ,B.OWNER_SCAC_ID                              TRKCS143
051400                    ,B.VEH_NBR                                    TRKCS143
051500                    ,B.OWNR_SCAC_SHIP_DTE                         TRKCS143
051700                    ,D.PRO_NBR                                    TRKCS143
051800                    ,D.VEND_SHIP_DTE                              TRKCS143
051900                    ,F.ENT_NAME_DESC                              TRKCS143
052000               FROM TRECEIV A                                     TRKCS143
052100                   ,TVHTRIP B                                     TRKCS143
052200                   ,TSHPTPO C                                     TRKCS143
052300                   ,TSHIPMT D                                     TRKCS143
052400                   ,TPURCHS E                                     TRKCS143
052500                   ,TENTNME F                                     TRKCS143
052600              WHERE C.PO_NBR         = :DK-PO-NBR                 TRKCS143
052700                AND DATE(A.REC_TMST) BETWEEN :DK-ARRIVAL-DTE-BEG  TRKCS143
052800                                         AND :DK-ARRIVAL-DTE-END  TRKCS143
052900                AND F.TYPE_CDE       = '01'                       TRKCS143
053000                AND A.VER_STATUS_CDE = 'A'                        TRKCS143
053100                AND A.ORD_NBR      = C.PO_NBR                     TRKCS143
053200                AND A.REC_SEQ_NBR  = C.REC_SEQ_NBR                TRKCS143
053300                AND C.SHIPT_ID     = D.SHIPT_ID                   TRKCS143
053400                AND D.TRIP_ID      = B.TRIP_ID                    TRKCS143
053500                AND C.PO_NBR       = E.PO_NBR                     TRKCS143
053600                AND E.ENT_ID       = F.ENT_ID                     TRKCS143
053700           ORDER BY A.REC_SEQ_NBR                                 TRKCS143
053800     END-EXEC.                                                    TRKCS143
053900                                                                  TRKCS143
054000/                                                                 TRKCS143
054100 LINKAGE SECTION.                                                 TRKCS143
054200                                                                  TRKCS143
054300 01  DFHCOMMAREA.                                                 TRKCS143
054400     05  FILLER                         OCCURS  1 TO 4072 TIMES   TRKCS143
054500                                        DEPENDING ON EIBCALEN.    TRKCS143
054600         10  FILLER                     PIC X.                    TRKCS143
054700                                                                  TRKCS143
054800/                                                                 TRKCS143
054900 PROCEDURE DIVISION.                                              TRKCS143
055000*---------------------------------------------------------------* TRKCS143
055100*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * TRKCS143
055200*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * TRKCS143
055300*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * TRKCS143
055400*---------------------------------------------------------------* TRKCS143
055500 0000-MAIN-MODULE.                                                TRKCS143
055600                                                                  TRKCS143
055700     INITIALIZE DP030-CICS-API-FIELDS.                            TRKCS143
055800                                                                  TRKCS143
055900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       TRKCS143
056000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          TRKCS143
056100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         TRKCS143
056200                                                                  TRKCS143
056300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       TRKCS143
056400                                                                  TRKCS143
056500     MOVE LENGTH OF TR143AI        TO DP030-MAP-LENGTH (1).       TRKCS143
056600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     TRKCS143
056700                                                                  TRKCS143
056800     PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS143
056900     PERFORM 1000-CONTROL-PROCESSING                              TRKCS143
057000                                                                  TRKCS143
057100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     TRKCS143
057200     PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS143
057300                                                                  TRKCS143
057400*---------------------------------------------------------------* TRKCS143
057500*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * TRKCS143
057600*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * TRKCS143
057700*---------------------------------------------------------------* TRKCS143
057800 0001-CALL-CICS-ARCH-API.                                         TRKCS143
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
058000                                    DFHCOMMAREA                           
058100                                    DP030-CICS-API-FIELDS                 
058200                                    DP020-STANDARD-COMMAREA               
058300                                    TR143AI.                              
058400                                                                          
058500     IF  DP030-RC-CALL-SUCCESSFUL                                 TRKCS143
058600         CONTINUE                                                 TRKCS143
058700     ELSE                                                         TRKCS143
058800         SET DP013-NO-ROLLBACK                                    TRKCS143
058900             DP013-XCTL-DISPLAY-RESTART                           TRKCS143
059000             DP013-CICS-ABEND      TO TRUE                        TRKCS143
059100         MOVE '0001-CALL-CICS-ARCH-API'                           TRKCS143
059200                                   TO DP013-PARAGRAPH             TRKCS143
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE OTRKCS143
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      TRKCS143
059500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      TRKCS143
059600         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
059700     END-IF.                                                      TRKCS143
059800                                                                  TRKCS143
059900*----------------------------------------------------------------*TRKCS143
060000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *TRKCS143
060100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *TRKCS143
060200*                                                                *TRKCS143
060300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *TRKCS143
060400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *TRKCS143
060500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *TRKCS143
060600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *TRKCS143
060700*----------------------------------------------------------------*TRKCS143
060800                                                                  TRKCS143
060900 1000-CONTROL-PROCESSING.                                         TRKCS143
061000                                                                  TRKCS143
061100     EVALUATE TRUE                                                TRKCS143
061200         WHEN DP020-NEXT-ACT-INITIAL                              TRKCS143
061300             INITIALIZE ASC-SPECIFIC-COMMAREA                     TRKCS143
061400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            TRKCS143
061500                                      ASC-SEL-TERM-ID             TRKCS143
061600             MOVE DP020-SRC-TASK-NUMBER                           TRKCS143
061700                                   TO ASC-LIST-TASK-NUMBER        TRKCS143
061800                                      ASC-SEL-TASK-NUMBER         TRKCS143
061900             MOVE PC-LIST-QUEUE-SEQ                               TRKCS143
062000                                   TO ASC-LIST-SEQ                TRKCS143
062100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 TRKCS143
062200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 TRKCS143
062300                                                                  TRKCS143
062400***-----$TEMPLATE NOTE$-------------------------------------------TRKCS143
062500*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,TRKCS143
062600*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  TRKCS143
062700*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.TRKCS143
062800***---------------------------------------------------------------TRKCS143
062900             IF  PS-COMMAREA-NOT-VALID                            TRKCS143
063000                 SET DP020-NEXT-ACT-APPL-ERROR                    TRKCS143
063100                                   TO TRUE                        TRKCS143
063200             ELSE                                                 TRKCS143
063300                 PERFORM 4000-BUILD-INITIAL-PANEL                 TRKCS143
063400             END-IF                                               TRKCS143
063500                                                                  TRKCS143
063600         WHEN DP020-NEXT-ACT-READ-MAP                             TRKCS143
063700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        TRKCS143
063800                                   TO PV-TOP-ITEM                 TRKCS143
063900             PERFORM 2000-PROCESS-PANEL                           TRKCS143
064000                                                                  TRKCS143
064100         WHEN DP020-NEXT-ACT-RETURN                               TRKCS143
064200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        TRKCS143
064300                                   TO PV-TOP-ITEM                 TRKCS143
064400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS143
064500             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 TRKCS143
064600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
064700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   TRKCS143
064800                                                                  TRKCS143
064900         WHEN OTHER                                               TRKCS143
065000             SET DP013-LOGIC-ABEND TO TRUE                        TRKCS143
065100             SET DP013-NO-ROLLBACK TO TRUE                        TRKCS143
065200             MOVE '1000-CONTROL-PROCESSING'                       TRKCS143
065300                                   TO DP013-PARAGRAPH             TRKCS143
065400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    TRKCS143
065500                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
065600             PERFORM DP013-0000-PROCESS-ABEND                     TRKCS143
065700     END-EVALUATE.                                                TRKCS143
065800                                                                  TRKCS143
065900/                                                                 TRKCS143
066000*----------------------------------------------------------------*TRKCS143
066100* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *TRKCS143
066200*----------------------------------------------------------------*TRKCS143
066300                                                                  TRKCS143
066400 1100-PROCESS-INTER-APPL-COMM.                                    TRKCS143
066500                                                                  TRKCS143
066600     SET PS-COMMAREA-VALID         TO TRUE.                       TRKCS143
066700     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     TRKCS143
066800                                                                  TRKCS143
066900     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          TRKCS143
067000         IF  TR013-PO-NBR = ZEROES                                TRKCS143
067100             MOVE PC-TSYMSG-00461  TO DP020-MSG-NUMBER            TRKCS143
067200             SET DP020-MSG-FATAL                                  TRKCS143
067300                 DP020-NEXT-ACT-APPL-ERROR                        TRKCS143
067400                 PS-COMMAREA-NOT-VALID                            TRKCS143
067500                                   TO TRUE                        TRKCS143
067600         ELSE                                                     TRKCS143
067700             MOVE TR013-PO-NBR     TO DK-PO-NBR                   TRKCS143
067800                                      ASC-KEY-PO-NBR              TRKCS143
067900             MOVE TR013-ARRIVAL-DTE-BEG                           TRKCS143
068000                                   TO ASC-ARRIVAL-DTE-BEG         TRKCS143
068100                                      DK-ARRIVAL-DTE-BEG          TRKCS143
068200                                      ASC-KEY-ARRIVAL-DTE-BEG     TRKCS143
068300             MOVE TR013-ARRIVAL-DTE-END                           TRKCS143
068400                                   TO ASC-ARRIVAL-DTE-END         TRKCS143
068500                                      DK-ARRIVAL-DTE-END          TRKCS143
068600                                      ASC-KEY-ARRIVAL-DTE-END     TRKCS143
068610             MOVE TR013-PRINTER-ID                                        
068620                              TO ASC-PRINTER-ID-X                         
068700         END-IF                                                   TRKCS143
068800     END-IF.                                                      TRKCS143
068900                                                                  TRKCS143
069000/                                                                 TRKCS143
069100*----------------------------------------------------------------*TRKCS143
069200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *TRKCS143
069300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *TRKCS143
069400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *TRKCS143
069500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *TRKCS143
069600* FUNCTION KEYS CAN GET THIS FAR.                                *TRKCS143
069700*----------------------------------------------------------------*TRKCS143
069800                                                                  TRKCS143
069900 2000-PROCESS-PANEL.                                              TRKCS143
070000     EVALUATE TRUE                                                TRKCS143
070100         WHEN DP020-SRC-AID = DP016-CLEAR                         TRKCS143
070200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS143
070300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   TRKCS143
070400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
070500                                                                  TRKCS143
070600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    TRKCS143
070700             MOVE ASC-KEY-PO-NBR          TO DK-PO-NBR            TRKCS143
070800             MOVE ASC-KEY-ARRIVAL-DTE-BEG TO DK-ARRIVAL-DTE-BEG   TRKCS143
070900             MOVE ASC-KEY-ARRIVAL-DTE-END TO DK-ARRIVAL-DTE-END   TRKCS143
071000             MOVE SPACES                  TO ASC-PRINTER-ID-X     TRKCS143
071100             PERFORM 2050-DELETE-LIST-QUEUE                       TRKCS143
071200             PERFORM 4000-BUILD-INITIAL-PANEL                     TRKCS143
071300                                                                  TRKCS143
071400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    TRKCS143
071500             PERFORM 2140-DESELECT-ALL-ITEMS                      TRKCS143
071600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
071700                                                                  TRKCS143
071800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  TRKCS143
071900             PERFORM 2150-SELECT-ALL-ITEMS                        TRKCS143
072000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
072100                                                                  TRKCS143
072200         WHEN OTHER                                               TRKCS143
072300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 TRKCS143
072400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   TRKCS143
072500             IF  PS-NO-ERROR                                      TRKCS143
072600                 SET DP030-CONTINUE-GO TO TRUE                    TRKCS143
072700                 PERFORM 2100-CHECK-FUNCTION-KEY                  TRKCS143
072800             ELSE                                                 TRKCS143
072900                 SET DP030-OVERRIDE-GO TO TRUE                    TRKCS143
073000             END-IF                                               TRKCS143
073100     END-EVALUATE.                                                TRKCS143
073200                                                                  TRKCS143
073300/                                                                 TRKCS143
073400*----------------------------------------------------------------*TRKCS143
073500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *TRKCS143
073600*----------------------------------------------------------------*TRKCS143
073700 2050-DELETE-LIST-QUEUE.                                          TRKCS143
073800                                                                  TRKCS143
073900     EXEC CICS                                                    TRKCS143
074000         DELETEQ TS                                               TRKCS143
074100           QUEUE (ASC-LIST-QUEUE-NAME)                            TRKCS143
074200            RESP (PV-CICS-RESP)                                   TRKCS143
074300     END-EXEC.                                                    TRKCS143
074400                                                                  TRKCS143
074500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       TRKCS143
074600        (PV-CICS-RESP = DFHRESP(QIDERR))                          TRKCS143
074700         CONTINUE                                                 TRKCS143
074800     ELSE                                                         TRKCS143
074900         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
075000         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
075100                                                                  TRKCS143
075200         MOVE '2050-DELETE-LIST-QUEUE'                            TRKCS143
075300                                   TO DP013-PARAGRAPH             TRKCS143
075400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    TRKCS143
075500                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
075600         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
075700     END-IF.                                                      TRKCS143
075800                                                                  TRKCS143
075900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  TRKCS143
076000                                                                  TRKCS143
076100/                                                                 TRKCS143
076200*----------------------------------------------------------------*TRKCS143
076300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*TRKCS143
076400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *TRKCS143
076500* CICS ARCHITECTURE API.                                         *TRKCS143
076600*----------------------------------------------------------------*TRKCS143
076700 2100-CHECK-FUNCTION-KEY.                                         TRKCS143
076800                                                                  TRKCS143
076900     EVALUATE TRUE                                                TRKCS143
077000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              TRKCS143
077100             IF  ASC-NUMBER-OF-SELECTED-ITEMS = 1                 TRKCS143
077200                 PERFORM 7000-FORMAT-COMMAREA                     TRKCS143
077300                 PERFORM 7100-START-TRANID-Y141                   TRKCS143
077400                 MOVE PC-TSYMSG-00098                             TRKCS143
077500                                TO DP020-MSG-NUMBER               TRKCS143
077600                 SET DP030-OVERRIDE-GO                            TRKCS143
077700                     DP020-MSG-INFORMATIONAL                      TRKCS143
077800                                TO TRUE                           TRKCS143
077900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             TRKCS143
078000             ELSE                                                 TRKCS143
078100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > 1                 TRKCS143
078200                 SET DP030-OVERRIDE-GO                            TRKCS143
078300                                   TO TRUE                        TRKCS143
078400                 MOVE PC-TSYMSG-00047                             TRKCS143
078500                                   TO DP020-MSG-NUMBER            TRKCS143
078600                 SET DP020-MSG-WARNING                            TRKCS143
078700                                   TO TRUE                        TRKCS143
078800             ELSE                                                 TRKCS143
078900             IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO              TRKCS143
079000                 SET DP030-OVERRIDE-GO                            TRKCS143
079100                                   TO TRUE                        TRKCS143
079200                 MOVE PC-TSYMSG-00057                             TRKCS143
079300                                   TO DP020-MSG-NUMBER            TRKCS143
079400                 SET DP020-MSG-WARNING                            TRKCS143
079500                                   TO TRUE                        TRKCS143
079600             END-IF                                               TRKCS143
079700             END-IF                                               TRKCS143
079800             END-IF                                               TRKCS143
079900                                                                  TRKCS143
080000         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  TRKCS143
080100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              TRKCS143
080200                 INITIALIZE TR014-INTER-APPL-COMMAREA             TRKCS143
080300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                TRKCS143
080400                                TO TR014-NUMBER-OF-SELECTED-ITEMS TRKCS143
080500                 PERFORM 5000-PREPARE-SEL-QUEUE                   TRKCS143
080600             ELSE                                                 TRKCS143
080700                 SET DP030-OVERRIDE-GO                            TRKCS143
080800                                   TO TRUE                        TRKCS143
080900                 MOVE PC-TSYMSG-00057                             TRKCS143
081000                                   TO DP020-MSG-NUMBER            TRKCS143
081100                 SET DP020-MSG-WARNING                            TRKCS143
081200                                   TO TRUE                        TRKCS143
081300             END-IF                                               TRKCS143
081400                                                                  TRKCS143
081500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  TRKCS143
081600             MOVE +1               TO PV-TOP-ITEM                 TRKCS143
081700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
081800             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS143
081900                                                                  TRKCS143
082000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   TRKCS143
082100             PERFORM 2110-BROWSE-BACKWARD                         TRKCS143
082200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
082300             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS143
082400                                                                  TRKCS143
082500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   TRKCS143
082600             PERFORM 2120-BROWSE-FORWARD                          TRKCS143
082700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS143
082800             PERFORM 3200-RESET-ATTRIBUTES                        TRKCS143
082900                                                                  TRKCS143
083000         WHEN DP020-SRC-AID = DP016-ENTER                         TRKCS143
083100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   TRKCS143
083200             IF  PS-ERROR                                         TRKCS143
083300                 CONTINUE                                         TRKCS143
083400             ELSE                                                 TRKCS143
083500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             TRKCS143
083600             END-IF                                               TRKCS143
083700                                                                  TRKCS143
083800         WHEN OTHER                                               TRKCS143
083900             SET DP013-NO-ROLLBACK                                TRKCS143
084000                 DP013-XCTL-DISPLAY-RESTART                       TRKCS143
084100                 DP013-CICS-ABEND  TO TRUE                        TRKCS143
084200             MOVE '2100-CHECK-FUNCTION-KEY'                       TRKCS143
084300                                   TO DP013-PARAGRAPH             TRKCS143
084400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      TRKCS143
084500                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
084600             PERFORM DP013-0000-PROCESS-ABEND                     TRKCS143
084700     END-EVALUATE.                                                TRKCS143
084800                                                                  TRKCS143
084900/                                                                 TRKCS143
085000*----------------------------------------------------------------*TRKCS143
085100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *TRKCS143
085200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *TRKCS143
085300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *TRKCS143
085400*    MESSAGE.                                                    *TRKCS143
085500*----------------------------------------------------------------*TRKCS143
085600                                                                  TRKCS143
085700 2110-BROWSE-BACKWARD.                                            TRKCS143
085800                                                                  TRKCS143
085900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    TRKCS143
086000         GIVING PV-TOP-ITEM.                                      TRKCS143
086100                                                                  TRKCS143
086200     IF  ((PV-TOP-ITEM < +1)                                      TRKCS143
086300       OR (PV-TOP-ITEM = +1))                                     TRKCS143
086400         MOVE +1                   TO PV-TOP-ITEM                 TRKCS143
086500*        -- TOP OF LIST --                                        TRKCS143
086600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            TRKCS143
086700         SET DP020-MSG-INFORMATIONAL                              TRKCS143
086800                                   TO TRUE                        TRKCS143
086900     END-IF.                                                      TRKCS143
087000                                                                  TRKCS143
087100/                                                                 TRKCS143
087200*----------------------------------------------------------------*TRKCS143
087300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *TRKCS143
087400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *TRKCS143
087500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *TRKCS143
087600*----------------------------------------------------------------*TRKCS143
087700                                                                  TRKCS143
087800 2120-BROWSE-FORWARD.                                             TRKCS143
087900                                                                  TRKCS143
088000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              TRKCS143
088100         GIVING PV-TOP-ITEM.                                      TRKCS143
088200                                                                  TRKCS143
088300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   TRKCS143
088400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            TRKCS143
088500                                   TO PV-TOP-ITEM                 TRKCS143
088600*        -- BOTTOM OF LIST --                                     TRKCS143
088700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            TRKCS143
088800         SET DP020-MSG-INFORMATIONAL                              TRKCS143
088900                                   TO TRUE                        TRKCS143
089000     ELSE                                                         TRKCS143
089100         COMPUTE PV-BOTTOM-ITEM =                                 TRKCS143
089200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 TRKCS143
089300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            TRKCS143
089400*            -- BOTTOM OF LIST --                                 TRKCS143
089500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            TRKCS143
089600             SET DP020-MSG-INFORMATIONAL                          TRKCS143
089700                                   TO TRUE                        TRKCS143
089800         END-IF                                                   TRKCS143
089900     END-IF.                                                      TRKCS143
090000                                                                  TRKCS143
090100/                                                                 TRKCS143
090200*----------------------------------------------------------------*TRKCS143
090300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *TRKCS143
090400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *TRKCS143
090500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *TRKCS143
090600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *TRKCS143
090700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *TRKCS143
090800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *TRKCS143
090900*----------------------------------------------------------------*TRKCS143
091000                                                                  TRKCS143
091100 2130-CHECK-FOR-JUMP-BROWSE.                                      TRKCS143
091200                                                                  TRKCS143
091300     SET PS-NO-ERROR               TO TRUE.                       TRKCS143
091400     IF (ASC-START-ITEM-REQUEST = SPACE)                          TRKCS143
091500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            TRKCS143
091600                                   TO PV-TOP-ITEM                 TRKCS143
091700     ELSE                                                         TRKCS143
091800         MOVE ASC-START-ITEM-REQUEST                              TRKCS143
091900                                   TO DP010I-UNEDITED-FIELD       TRKCS143
092000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       TRKCS143
092100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     TRKCS143
092200         SET DP010I-NEGATIVE-NOT-ALLOWED                          TRKCS143
092300                                   TO TRUE                        TRKCS143
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263697              USING DP010I-NUMERIC-EDIT-AREA                              
092500                                                                  TRKCS143
092600         IF  NOT DP010I-ERROR-DETECTED                            TRKCS143
092700             MOVE DP010I-NUMERIC-FIELD                            TRKCS143
092800                                   TO ASC-START-ITEM-REQUEST-N    TRKCS143
092900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  TRKCS143
093000                 IF  ASC-START-ITEM-REQUEST-N >                   TRKCS143
093100                                          ASC-NUMBER-OF-ITEMS-READTRKCS143
093200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         TRKCS143
093300                     COMPUTE PV-TOP-ITEM =                        TRKCS143
093400                             ASC-NUMBER-OF-ITEMS-READ             TRKCS143
093500                             - PC-ITEMS-PER-PANEL + 1             TRKCS143
093600                     IF  PV-TOP-ITEM < +1                         TRKCS143
093700                         MOVE +1   TO PV-TOP-ITEM                 TRKCS143
093800                         MOVE PC-TSYMSG-00070                     TRKCS143
093900                                   TO DP020-MSG-NUMBER            TRKCS143
094000                         SET DP020-MSG-INFORMATIONAL              TRKCS143
094100                                   TO TRUE                        TRKCS143
094200                     END-IF                                       TRKCS143
094300                 ELSE                                             TRKCS143
094400                     MOVE ASC-START-ITEM-REQUEST-N                TRKCS143
094500                                   TO PV-TOP-ITEM                 TRKCS143
094600                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      TRKCS143
094700                     COMPUTE PV-BOTTOM-ITEM =                     TRKCS143
094800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     TRKCS143
094900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READTRKCS143
095000*                        -- BOTTOM OF LIST --                     TRKCS143
095100                         MOVE PC-TSYMSG-00070                     TRKCS143
095200                                   TO DP020-MSG-NUMBER            TRKCS143
095300                         SET DP020-MSG-INFORMATIONAL              TRKCS143
095400                                   TO TRUE                        TRKCS143
095500                     END-IF                                       TRKCS143
095600                 END-IF                                           TRKCS143
095700             ELSE                                                 TRKCS143
095800*                --- VALUE OUT OF RANGE ----                      TRKCS143
095900                 MOVE PC-TSYMSG-00101                             TRKCS143
096000                                   TO DP020-MSG-NUMBER            TRKCS143
096100                 MOVE -1           TO ASTRTITL                    TRKCS143
096200                 SET DP030-SET-CURSOR-APPL-1                      TRKCS143
096300                                   TO TRUE                        TRKCS143
096400                 MOVE DP015-REVERSE                               TRKCS143
096500                                   TO ASTRTITH                    TRKCS143
096600                 MOVE DP015-RED    TO ASTRTITC                    TRKCS143
096700                 MOVE DP015-UNP-NUM-BRT-MDT                       TRKCS143
096800                                   TO ASTRTITA                    TRKCS143
096900                 SET DP020-MSG-FATAL                              TRKCS143
097000                                   TO TRUE                        TRKCS143
097100                 SET PS-ERROR      TO TRUE                        TRKCS143
097200             END-IF                                               TRKCS143
097300                                                                  TRKCS143
097400         ELSE                                                     TRKCS143
097500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            TRKCS143
097600             MOVE -1               TO ASTRTITL                    TRKCS143
097700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  TRKCS143
097800             MOVE DP015-REVERSE    TO ASTRTITH                    TRKCS143
097900             MOVE DP015-RED        TO ASTRTITC                    TRKCS143
098000             MOVE DP015-UNP-NUM-BRT-MDT                           TRKCS143
098100                                   TO ASTRTITA                    TRKCS143
098200             SET DP020-MSG-FATAL   TO TRUE                        TRKCS143
098300             SET PS-ERROR          TO TRUE                        TRKCS143
098400         END-IF                                                   TRKCS143
098500     END-IF.                                                      TRKCS143
098600                                                                  TRKCS143
098700/                                                                 TRKCS143
098800*----------------------------------------------------------------*TRKCS143
098900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *TRKCS143
099000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *TRKCS143
099100*----------------------------------------------------------------*TRKCS143
099200 2140-DESELECT-ALL-ITEMS.                                         TRKCS143
099300                                                                  TRKCS143
099400     MOVE +1                       TO ASC-BLK-SUB.                TRKCS143
099500                                                                  TRKCS143
099600     PERFORM 2141-CLEAR-SELECTED-INDS                             TRKCS143
099700         VARYING ASC-ITEM-SUB                                     TRKCS143
099800         FROM 1 BY 1                                              TRKCS143
099900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 TRKCS143
100000                                                                  TRKCS143
100100     ADD +1                        TO ASC-BLK-SUB.                TRKCS143
100200                                                                  TRKCS143
100300     PERFORM 2141-CLEAR-SELECTED-INDS                             TRKCS143
100400         VARYING ASC-ITEM-SUB                                     TRKCS143
100500         FROM 1 BY 1                                              TRKCS143
100600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 TRKCS143
100700                                                                  TRKCS143
100800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               TRKCS143
100900                                   TO PV-LIST-ITEM-NUMBER.        TRKCS143
101000                                                                  TRKCS143
101100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            TRKCS143
101200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    TRKCS143
101300                                                                  TRKCS143
101400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     TRKCS143
101500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      TRKCS143
101600         MOVE +1                   TO ASC-BLK-SUB                 TRKCS143
101700                                                                  TRKCS143
101800         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS143
101900                                                                  TRKCS143
102000         MOVE +1                   TO PV-BLOCK-NUMBER             TRKCS143
102100                                                                  TRKCS143
102200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         TRKCS143
102300             PV-FIRST-BLOCK-IN-ARRAY - 1                          TRKCS143
102400                                                                  TRKCS143
102500         PERFORM                                                  TRKCS143
102600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       TRKCS143
102700                                                                  TRKCS143
102800             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
102900                                                                  TRKCS143
103000             PERFORM 2141-CLEAR-SELECTED-INDS                     TRKCS143
103100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 TRKCS143
103200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          TRKCS143
103300                                                                  TRKCS143
103400             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
103500                                                                  TRKCS143
103600             ADD +1                TO PV-BLOCK-NUMBER             TRKCS143
103700                                                                  TRKCS143
103800         END-PERFORM                                              TRKCS143
103900                                                                  TRKCS143
104000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         TRKCS143
104100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     TRKCS143
104200                                                                  TRKCS143
104300         PERFORM                                                  TRKCS143
104400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       TRKCS143
104500                   ASC-HIGHEST-BLOCK-WRITTEN                      TRKCS143
104600                                                                  TRKCS143
104700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          TRKCS143
104800                                   TO PV-BLOCK-NUMBER             TRKCS143
104900                                                                  TRKCS143
105000             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
105100                                                                  TRKCS143
105200             PERFORM 2141-CLEAR-SELECTED-INDS                     TRKCS143
105300                 VARYING ASC-ITEM-SUB                             TRKCS143
105400                 FROM 1 BY 1                                      TRKCS143
105500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          TRKCS143
105600                                                                  TRKCS143
105700             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
105800                                                                  TRKCS143
105900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      TRKCS143
106000                                                                  TRKCS143
106100         END-PERFORM                                              TRKCS143
106200                                                                  TRKCS143
106300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             TRKCS143
106400                                   TO PV-BLOCK-NUMBER             TRKCS143
106500                                                                  TRKCS143
106600         PERFORM 4410-READ-TEMP-STORAGE                           TRKCS143
106700     END-IF.                                                      TRKCS143
106800                                                                  TRKCS143
106900                                                                  TRKCS143
107000     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMSTRKCS143
107100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.TRKCS143
107200     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  TRKCS143
107300                                                                  TRKCS143
107400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        TRKCS143
107500                                                                  TRKCS143
107600/                                                                 TRKCS143
107700*----------------------------------------------------------------*TRKCS143
107800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *TRKCS143
107900*----------------------------------------------------------------*TRKCS143
108000                                                                  TRKCS143
108100 2141-CLEAR-SELECTED-INDS.                                        TRKCS143
108200                                                                  TRKCS143
108300     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
108400             NOT EQUAL ZERO                                       TRKCS143
108500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
108600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
108700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS143
108800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  TRKCS143
108900                                   TO TRUE                        TRKCS143
109000         END-IF                                                   TRKCS143
109100     END-IF.                                                      TRKCS143
109200                                                                  TRKCS143
109300/                                                                 TRKCS143
109400*----------------------------------------------------------------*TRKCS143
109500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *TRKCS143
109600*  FOR ALL ITEMS.                                                *TRKCS143
109700*----------------------------------------------------------------*TRKCS143
109800                                                                  TRKCS143
109900 2150-SELECT-ALL-ITEMS.                                           TRKCS143
110000                                                                  TRKCS143
110100     MOVE +1                       TO ASC-BLK-SUB.                TRKCS143
110200                                                                  TRKCS143
110300     PERFORM 2151-SET-SELECTED-INDS                               TRKCS143
110400         VARYING ASC-ITEM-SUB                                     TRKCS143
110500         FROM 1 BY 1                                              TRKCS143
110600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 TRKCS143
110700                                                                  TRKCS143
110800     ADD +1                        TO ASC-BLK-SUB.                TRKCS143
110900                                                                  TRKCS143
111000     PERFORM 2151-SET-SELECTED-INDS                               TRKCS143
111100         VARYING ASC-ITEM-SUB                                     TRKCS143
111200         FROM 1 BY 1                                              TRKCS143
111300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 TRKCS143
111400                                                                  TRKCS143
111500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               TRKCS143
111600                                   TO PV-LIST-ITEM-NUMBER.        TRKCS143
111700                                                                  TRKCS143
111800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            TRKCS143
111900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    TRKCS143
112000                                                                  TRKCS143
112100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     TRKCS143
112200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    TRKCS143
112300         MOVE +1                   TO ASC-BLK-SUB                 TRKCS143
112400                                                                  TRKCS143
112500         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS143
112600                                                                  TRKCS143
112700         MOVE +1                   TO PV-BLOCK-NUMBER             TRKCS143
112800                                                                  TRKCS143
112900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         TRKCS143
113000             PV-FIRST-BLOCK-IN-ARRAY - 1                          TRKCS143
113100                                                                  TRKCS143
113200         PERFORM                                                  TRKCS143
113300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       TRKCS143
113400                                                                  TRKCS143
113500             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
113600                                                                  TRKCS143
113700             PERFORM 2151-SET-SELECTED-INDS                       TRKCS143
113800                 VARYING ASC-ITEM-SUB                             TRKCS143
113900                 FROM 1 BY 1                                      TRKCS143
114000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          TRKCS143
114100                                                                  TRKCS143
114200             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
114300                                                                  TRKCS143
114400             ADD +1                TO PV-BLOCK-NUMBER             TRKCS143
114500         END-PERFORM                                              TRKCS143
114600                                                                  TRKCS143
114700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         TRKCS143
114800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     TRKCS143
114900                                                                  TRKCS143
115000         PERFORM                                                  TRKCS143
115100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       TRKCS143
115200                   ASC-HIGHEST-BLOCK-WRITTEN                      TRKCS143
115300                                                                  TRKCS143
115400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          TRKCS143
115500                                   TO PV-BLOCK-NUMBER             TRKCS143
115600                                                                  TRKCS143
115700             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
115800                                                                  TRKCS143
115900             PERFORM 2151-SET-SELECTED-INDS                       TRKCS143
116000                 VARYING ASC-ITEM-SUB                             TRKCS143
116100                 FROM 1 BY 1                                      TRKCS143
116200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          TRKCS143
116300                                                                  TRKCS143
116400             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
116500                                                                  TRKCS143
116600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      TRKCS143
116700         END-PERFORM                                              TRKCS143
116800                                                                  TRKCS143
116900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             TRKCS143
117000                                   TO PV-BLOCK-NUMBER             TRKCS143
117100                                                                  TRKCS143
117200         PERFORM 4410-READ-TEMP-STORAGE                           TRKCS143
117300     END-IF.                                                      TRKCS143
117400                                                                  TRKCS143
117500                                                                  TRKCS143
117600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             TRKCS143
117700          ASC-NUMBER-OF-SELECTED-ITEMS.                           TRKCS143
117800                                                                  TRKCS143
117900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        TRKCS143
118000                                                                  TRKCS143
118100/                                                                 TRKCS143
118200*----------------------------------------------------------------*TRKCS143
118300*    MARK EACH ITEM AS BEING SELECTED.                           *TRKCS143
118400*----------------------------------------------------------------*TRKCS143
118500                                                                  TRKCS143
118600 2151-SET-SELECTED-INDS.                                          TRKCS143
118700                                                                  TRKCS143
118800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           TRKCS143
118900             NOT EQUAL ZERO                                       TRKCS143
119000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             TRKCS143
119100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             TRKCS143
119200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        TRKCS143
119300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  TRKCS143
119400                                   TO TRUE                        TRKCS143
119500         END-IF                                                   TRKCS143
119600     END-IF.                                                      TRKCS143
119700                                                                  TRKCS143
119800*----------------------------------------------------------------*TRKCS143
119900*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *TRKCS143
120000*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *TRKCS143
120100*----------------------------------------------------------------*TRKCS143
120200 2200-MOVE-SCREEN-TO-COMMAREA.                                    TRKCS143
120300                                                                  TRKCS143
120400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             TRKCS143
120500     MOVE +1                       TO PV-SUB.                     TRKCS143
120600                                                                  TRKCS143
120700     PERFORM 3100-SET-SUBSCRIPTS.                                 TRKCS143
120800                                                                  TRKCS143
120900     IF  ASTRTITL > ZERO                                          TRKCS143
121000         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      TRKCS143
121100     ELSE                                                         TRKCS143
121200         IF  ASTRTITF = DP015-ERASE-EOF                           TRKCS143
121300             INITIALIZE ASC-START-ITEM-REQUEST                    TRKCS143
121400         END-IF                                                   TRKCS143
121500     END-IF.                                                      TRKCS143
121600                                                                  TRKCS143
121700     IF APRINTRL > ZERO                                           TRKCS143
121800         MOVE APRINTRI             TO ASC-PRINTER-ID-X            TRKCS143
121900     ELSE                                                         TRKCS143
122000         IF APRINTRF = DP015-ERASE-EOF                            TRKCS143
122100             MOVE SPACE            TO ASC-PRINTER-ID-X            TRKCS143
122200         END-IF                                                   TRKCS143
122300     END-IF.                                                      TRKCS143
122400                                                                  TRKCS143
122500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          TRKCS143
122600         VARYING PV-SUB                                           TRKCS143
122700         FROM 1 BY 1                                              TRKCS143
122800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      TRKCS143
122900                                                                  TRKCS143
123000/                                                                 TRKCS143
123100*----------------------------------------------------------------*TRKCS143
123200*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *TRKCS143
123300*----------------------------------------------------------------*TRKCS143
123400 2210-MOVE-LINES-TO-COMMAREA.                                     TRKCS143
123500                                                                  TRKCS143
123600     IF  MR-SELECTL (PV-SUB) > ZERO                               TRKCS143
123700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     TRKCS143
123800                                   TO TRUE                        TRKCS143
123900         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        TRKCS143
124000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      TRKCS143
124100     ELSE                                                         TRKCS143
124200         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                TRKCS143
124300             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         TRKCS143
124400             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        TRKCS143
124500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      TRKCS143
124600         END-IF                                                   TRKCS143
124700     END-IF.                                                      TRKCS143
124800                                                                  TRKCS143
124900     ADD +1                        TO ASC-ITEM-SUB.               TRKCS143
125000                                                                  TRKCS143
125100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        TRKCS143
125200         ADD +1                    TO ASC-BLK-SUB                 TRKCS143
125300         MOVE +1                   TO ASC-ITEM-SUB                TRKCS143
125400     END-IF.                                                      TRKCS143
125500                                                                  TRKCS143
125600/                                                                 TRKCS143
125700*----------------------------------------------------------------*TRKCS143
125800*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *TRKCS143
125900*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *TRKCS143
126000*----------------------------------------------------------------*TRKCS143
126100 3000-EDIT-DATA-IN-COMMAREA.                                      TRKCS143
126200                                                                  TRKCS143
126300     SET PS-NO-ERROR               TO TRUE.                       TRKCS143
126400                                                                  TRKCS143
126500     PERFORM 3200-RESET-ATTRIBUTES.                               TRKCS143
126600                                                                  TRKCS143
126700     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    TRKCS143
126800         IF ASC-PRINTER-ID-X = SPACES OR ZEROES                   TRKCS143
126900             SET PS-ERROR                                         TRKCS143
127000                 DP020-MSG-FATAL TO TRUE                          TRKCS143
127100             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             TRKCS143
127200             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS143
127300                                 TO APRINTRA                      TRKCS143
127400             MOVE DP015-RED      TO APRINTRC                      TRKCS143
127500             MOVE DP015-REVERSE  TO APRINTRH                      TRKCS143
127600             MOVE -1             TO APRINTRL                      TRKCS143
127700             SET DP030-SET-CURSOR-APPL-1                          TRKCS143
127800                                 TO TRUE                          TRKCS143
127900         END-IF                                                   TRKCS143
128000         IF  ASC-PRINTER-ID-X = 'XXXXXXXX'                        TRKCS143
128100             CONTINUE                                             TRKCS143
128200         ELSE                                                     TRKCS143
128300             IF  ASC-PRINTER-ID-1-1 = 'U'                         TRKCS143
128400                 PERFORM 3210-EDIT-PRINTER-ID                     TRKCS143
128500             ELSE                                                 TRKCS143
128600                 SET PS-ERROR                                     TRKCS143
128700                     DP020-MSG-FATAL TO TRUE                      TRKCS143
128800                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         TRKCS143
128900                 MOVE DP015-UNP-ALP-BRT-OFF                       TRKCS143
129000                                    TO APRINTRA                   TRKCS143
129100                 MOVE DP015-RED     TO APRINTRC                   TRKCS143
129200                 MOVE DP015-REVERSE TO APRINTRH                   TRKCS143
129300                 MOVE -1            TO APRINTRL                   TRKCS143
129400                 SET DP030-SET-CURSOR-APPL-1                      TRKCS143
129500                                    TO TRUE                       TRKCS143
129600             END-IF                                               TRKCS143
129700         END-IF                                                   TRKCS143
129800     END-IF.                                                      TRKCS143
129900                                                                  TRKCS143
130000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     TRKCS143
130100**                                                                TRKCS143
130200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              TRKCS143
130300* EDITTING IS DONE FROM THE BOTTOM UP.                            TRKCS143
130400**                                                                TRKCS143
130500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       TRKCS143
130600         ASC-ITEMS-DISPLAYED - 1.                                 TRKCS143
130700                                                                  TRKCS143
130800     PERFORM 3100-SET-SUBSCRIPTS.                                 TRKCS143
130900     PERFORM 3300-EDIT-SELECTIONS                                 TRKCS143
131000         VARYING PV-SUB                                           TRKCS143
131100         FROM PV-SUB BY -1                                        TRKCS143
131200         UNTIL PV-SUB < +1                                        TRKCS143
131300                                                                  TRKCS143
131400     IF  PS-NO-ERROR                                              TRKCS143
131500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        TRKCS143
131600     END-IF.                                                      TRKCS143
131700                                                                  TRKCS143
131800     IF  ((PS-NO-ERROR)                                           TRKCS143
131900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   TRKCS143
132000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    TRKCS143
132100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  TRKCS143
132200     END-IF.                                                      TRKCS143
132300                                                                  TRKCS143
132400/                                                                 TRKCS143
132500*----------------------------------------------------------------*TRKCS143
132600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *TRKCS143
132700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*TRKCS143
132800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *TRKCS143
132900*                                                                *TRKCS143
133000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *TRKCS143
133100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *TRKCS143
133200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *TRKCS143
133300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *TRKCS143
133400*----------------------------------------------------------------*TRKCS143
133500                                                                  TRKCS143
133600 3100-SET-SUBSCRIPTS.                                             TRKCS143
133700                                                                  TRKCS143
133800     COMPUTE ASC-ITEM-SUB =                                       TRKCS143
133900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        TRKCS143
134000                                                                  TRKCS143
134100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         TRKCS143
134200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            TRKCS143
134300                                                                  TRKCS143
134400         MOVE PC-MAX-BLOCKS-IN-ARRAY                              TRKCS143
134500                                   TO ASC-BLK-SUB                 TRKCS143
134600     ELSE                                                         TRKCS143
134700         MOVE +1                   TO ASC-BLK-SUB                 TRKCS143
134800     END-IF.                                                      TRKCS143
134900                                                                  TRKCS143
135000*----------------------------------------------------------------*TRKCS143
135100*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *TRKCS143
135200*----------------------------------------------------------------*TRKCS143
135300                                                                  TRKCS143
135400 3200-RESET-ATTRIBUTES.                                           TRKCS143
135500                                                                  TRKCS143
135600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    TRKCS143
135700                                      APRINTRA.                   TRKCS143
135800     MOVE DP015-GREEN              TO ASTRTITC                    TRKCS143
135900                                      APRINTRC.                   TRKCS143
136000     MOVE DP015-UNDERLINE          TO ASTRTITH                    TRKCS143
136100                                      APRINTRH.                   TRKCS143
136200                                                                  TRKCS143
136300     IF DP020-NEXT-ACT-RETURN                                     TRKCS143
136400     OR DP020-NEXT-ACT-READ-MAP                                   TRKCS143
136500        PERFORM                                                   TRKCS143
136600            VARYING PV-SUB                                        TRKCS143
136700            FROM 1 BY 1                                           TRKCS143
136800            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    TRKCS143
136900            MOVE DP015-UNP-ALP-NOR-OFF                            TRKCS143
137000                                      TO MR-SELECTA (PV-SUB)      TRKCS143
137100            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      TRKCS143
137200            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      TRKCS143
137300        END-PERFORM                                               TRKCS143
137400     ELSE                                                         TRKCS143
137500        PERFORM                                                   TRKCS143
137600            VARYING PV-SUB                                        TRKCS143
137700            FROM 1 BY 1                                           TRKCS143
137800            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     TRKCS143
137900            MOVE DP015-UNP-ALP-NOR-OFF                            TRKCS143
138000                                      TO MR-SELECTA (PV-SUB)      TRKCS143
138100            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      TRKCS143
138200            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      TRKCS143
138300        END-PERFORM                                               TRKCS143
138400     END-IF.                                                      TRKCS143
138500                                                                  TRKCS143
138600/                                                                 TRKCS143
138700*----------------------------------------------------------------*TRKCS143
138800*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *TRKCS143
138900*----------------------------------------------------------------*TRKCS143
138910*                                                                         
139000 3210-EDIT-PRINTER-ID.                                            TRKCS143
139010                                                                          
139020*            VALIDATE USING DPKCS060                                      
139030             MOVE ASC-PRINTER-ID-X                                        
139040                                     TO DP072-PRINTER-ID                  
139050             MOVE 'TRKCS141'         TO DP072-RPT-PGM-NME                 
139060             MOVE PC-ONE             TO DP072-RPT-PGM-TYP-ID              
139070             MOVE DP020-OPER-UNT-ID  TO DP072-ORIGIN-OPER-UNT-ID          
139080             MOVE DP020-OPER-UNT-ID  TO DP072-OPER-UNT-ID                 
139090             MOVE  1                 TO DP072-ORIGIN-FCLTY-ID             
139091             MOVE  1                 TO DP072-FCLTY-ID                    
139092             SET DP072-VALIDATE     TO TRUE                               
139093                                                                          
139094             EXEC CICS                                                    
139095                 LINK PROGRAM  (PC-DPKCS060)                              
139096                      COMMAREA (DP072-COMM-AREA)                          
139097                      RESP     (PV-CICS-RESP)                             
139098             END-EXEC                                                     
139099                                                                          
139100             EVALUATE TRUE                                                
139101                 WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     
139102                     CONTINUE                                             
139103                 WHEN OTHER                                               
139104                       MOVE '3210-EDIT-PRINTER-ID'                        
139105                                            TO DP013-PARAGRAPH            
139106                       MOVE PV-CICS-RESP                                  
139107                            TO DP013-MESSAGE-TEXT(1)                      
139108                       MOVE SQLCA           TO DP013-SQLCA                
139109                       SET DP013-LINK-RETURN                              
139110                           DP013-CICS-ABEND                               
139111                           DP013-NO-ROLLBACK TO TRUE                      
139112                       PERFORM DP013-0000-PROCESS-ABEND                   
139113             END-EVALUATE                                                 
139114                                                                          
139115             IF  DP072-PRTR-PRTR-TRK-STAT-CDE = 'A'                       
139116                 MOVE ASC-PRINTER-ID-X   TO APRINTRO                      
139117             ELSE                                                         
139118                 SET PS-ERROR                                             
139119                     DP020-MSG-FATAL                                      
139120                                  TO TRUE                                 
139121                 MOVE PC-TSYMSG-00746                                     
139122                                  TO DP020-MSG-NUMBER                     
139123                 MOVE DP015-UNP-ALP-BRT-MDT                               
139124                                  TO APRINTRA                             
139125                 MOVE DP015-RED   TO APRINTRC                             
139126                 MOVE DP015-REVERSE                                       
139127                                  TO APRINTRH                             
139128                 MOVE -1          TO APRINTRL                             
139129                 SET DP030-SET-CURSOR-APPL-1                              
139130                                  TO TRUE                                 
139131             END-IF.                                                      
139132                                                                          
139133                                                                          
139140                                                                  TRKCS143
139200*    MOVE ASC-PRINTER-ID-2-8     TO DP010I-UNEDITED-FIELD.        TRKCS143
139300*    MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        TRKCS143
139400*    MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      TRKCS143
139500*                                                                 TRKCS143
139600*    SET DP010I-NEGATIVE-NOT-ALLOWED                              TRKCS143
139700*                                TO TRUE.                         TRKCS143
139800*                                                                 TRKCS143
263697*    CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263697*         USING DP010I-NUMERIC-EDIT-AREA.                                 
140000*                                                                 TRKCS143
140100*    IF DP010I-ERROR-DETECTED                                     TRKCS143
140200*        SET PS-ERROR                                             TRKCS143
140300*            DP020-MSG-FATAL     TO TRUE                          TRKCS143
140400*        MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              TRKCS143
140500*        MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS143
140600*                                TO APRINTRA                      TRKCS143
140700*        MOVE DP015-RED          TO APRINTRC                      TRKCS143
140800*        MOVE DP015-REVERSE      TO APRINTRH                      TRKCS143
140900*        MOVE -1                 TO APRINTRL                      TRKCS143
141000*        SET DP030-SET-CURSOR-APPL-1                              TRKCS143
141100*                                TO TRUE                          TRKCS143
141200*    ELSE                                                         TRKCS143
141300*        MOVE ASC-PRINTER-ID-X   TO APRINTRO                      TRKCS143
141400*    END-IF.                                                      TRKCS143
141500                                                                  TRKCS143
141600/                                                                 TRKCS143
141700*----------------------------------------------------------------*TRKCS143
141800*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *TRKCS143
141900*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *TRKCS143
142000*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *TRKCS143
142100*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *TRKCS143
142200*----------------------------------------------------------------*TRKCS143
142300 3300-EDIT-SELECTIONS.                                            TRKCS143
142400                                                                  TRKCS143
142500     EVALUATE TRUE                                                TRKCS143
142600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     TRKCS143
142700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         TRKCS143
142800                 CONTINUE                                         TRKCS143
142900                                                                  TRKCS143
143000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         TRKCS143
143100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        TRKCS143
143200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMSTRKCS143
143300                 MOVE ASC-TEMP-SELECTED-SW                        TRKCS143
143400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
143500                                   TO ASC-SELECTED-SW             TRKCS143
143600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
143700             END-IF                                               TRKCS143
143800                                                                  TRKCS143
143900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     TRKCS143
144000                 = SPACE                                          TRKCS143
144100             EVALUATE TRUE                                        TRKCS143
144200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       TRKCS143
144300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMSTRKCS143
144400                     MOVE SPACE    TO ASC-SELECTED-SW             TRKCS143
144500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
144600                                                                  TRKCS143
144700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        TRKCS143
144800                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE TRKCS143
144900                     MOVE SPACE    TO ASC-SELECTED-SW             TRKCS143
145000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
145100                                                                  TRKCS143
145200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
145300                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   TRKCS143
145400                     MOVE SPACE    TO ASC-SELECTED-SW             TRKCS143
145500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
145600             END-EVALUATE                                         TRKCS143
145700                                                                  TRKCS143
145800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           TRKCS143
145900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            TRKCS143
146000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    TRKCS143
146100             END-IF                                               TRKCS143
146200             PERFORM 3310-EDIT-RANGE                              TRKCS143
146300                                                                  TRKCS143
146400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             TRKCS143
146500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            TRKCS143
146600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    TRKCS143
146700             END-IF                                               TRKCS143
146800             PERFORM 3310-EDIT-RANGE                              TRKCS143
146900                                                                  TRKCS143
147000         WHEN OTHER                                               TRKCS143
147100             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            TRKCS143
147200             SET DP020-MSG-FATAL   TO TRUE                        TRKCS143
147300             MOVE -1               TO MR-SELECTL (PV-SUB)         TRKCS143
147400             SET DP030-SET-CURSOR-APPL-1                          TRKCS143
147500                                   TO TRUE                        TRKCS143
147600             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         TRKCS143
147700             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         TRKCS143
147800             SET PS-ERROR          TO TRUE                        TRKCS143
147900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            TRKCS143
148000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     TRKCS143
148100                 MOVE SPACE        TO ASC-SELECTED-SW             TRKCS143
148200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
148300             END-IF                                               TRKCS143
148400     END-EVALUATE.                                                TRKCS143
148500                                                                  TRKCS143
148600     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             TRKCS143
148700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               TRKCS143
148800                                                                  TRKCS143
148900     IF  ASC-ITEM-SUB < 1                                         TRKCS143
149000         SUBTRACT +1 FROM ASC-BLK-SUB                             TRKCS143
149100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                TRKCS143
149200     END-IF.                                                      TRKCS143
149300                                                                  TRKCS143
149400*----------------------------------------------------------------*TRKCS143
149500*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *TRKCS143
149600*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *TRKCS143
149700*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *TRKCS143
149800*  THE ENDING.                                                   *TRKCS143
149900*----------------------------------------------------------------*TRKCS143
150000 3310-EDIT-RANGE.                                                 TRKCS143
150100                                                                  TRKCS143
150200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                TRKCS143
150300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   TRKCS143
150400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)TRKCS143
150500                                   TO ASC-SELECTED-SW             TRKCS143
150600                                        (ASC-BLK-SUB ASC-ITEM-SUB)TRKCS143
150700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE TRKCS143
150800         ELSE                                                     TRKCS143
150900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     TRKCS143
151000                 CONTINUE                                         TRKCS143
151100             ELSE                                                 TRKCS143
151200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        TRKCS143
151300                 MOVE PC-TSYMSG-00054                             TRKCS143
151400                                   TO DP020-MSG-NUMBER            TRKCS143
151500                 SET DP020-MSG-FATAL                              TRKCS143
151600                                   TO TRUE                        TRKCS143
151700                 MOVE -1           TO MR-SELECTL (PV-SUB)         TRKCS143
151800                 SET DP030-SET-CURSOR-APPL-1                      TRKCS143
151900                                   TO TRUE                        TRKCS143
152000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         TRKCS143
152100                 MOVE DP015-UNDERLINE                             TRKCS143
152200                                   TO MR-SELECTH (PV-SUB)         TRKCS143
152300                 SET PS-ERROR      TO TRUE                        TRKCS143
152400             END-IF                                               TRKCS143
152500         END-IF                                                   TRKCS143
152600     ELSE                                                         TRKCS143
152700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     TRKCS143
152800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
152900                                   TO ASC-SELECTED-SW             TRKCS143
153000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   TRKCS143
153100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   TRKCS143
153200         ELSE                                                     TRKCS143
153300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       TRKCS143
153400                 CONTINUE                                         TRKCS143
153500             ELSE                                                 TRKCS143
153600*                -- ONLY ONE END-OF-RANGE ALLOWED --              TRKCS143
153700                 MOVE PC-TSYMSG-00055                             TRKCS143
153800                                   TO DP020-MSG-NUMBER            TRKCS143
153900                 SET DP020-MSG-FATAL                              TRKCS143
154000                                   TO TRUE                        TRKCS143
154100                 MOVE -1           TO MR-SELECTL (PV-SUB)         TRKCS143
154200                 SET DP030-SET-CURSOR-APPL-1                      TRKCS143
154300                                   TO TRUE                        TRKCS143
154400                 SET PS-ERROR      TO TRUE                        TRKCS143
154500             END-IF                                               TRKCS143
154600         END-IF                                                   TRKCS143
154700     END-IF.                                                      TRKCS143
154800                                                                  TRKCS143
154900*----------------------------------------------------------------*TRKCS143
155000*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *TRKCS143
155100*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *TRKCS143
155200*----------------------------------------------------------------*TRKCS143
155300 3400-CHECK-RANGE-SEQUENCE.                                       TRKCS143
155400                                                                  TRKCS143
155500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       TRKCS143
155600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      TRKCS143
155700       AND  ASC-START-OF-SELECTED-RANGE >                         TRKCS143
155800                                         ASC-END-OF-SELECTED-RANGETRKCS143
155900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                TRKCS143
156000         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            TRKCS143
156100         SET DP020-MSG-FATAL       TO TRUE                        TRKCS143
156200         SET PS-ERROR              TO TRUE                        TRKCS143
156300         PERFORM 3410-POSITION-AT-ERROR                           TRKCS143
156400     END-IF.                                                      TRKCS143
156500                                                                  TRKCS143
156600*----------------------------------------------------------------*TRKCS143
156700*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *TRKCS143
156800*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *TRKCS143
156900*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *TRKCS143
157000*----------------------------------------------------------------*TRKCS143
157100 3410-POSITION-AT-ERROR.                                          TRKCS143
157200                                                                  TRKCS143
157300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       TRKCS143
157400                                                                  TRKCS143
157500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 TRKCS143
157600                    - PV-TOP-ITEM + 1.                            TRKCS143
157700                                                                  TRKCS143
157800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      TRKCS143
157900         CONTINUE                                                 TRKCS143
158000     ELSE                                                         TRKCS143
158100         MOVE -1                   TO MR-SELECTL (PV-SUB)         TRKCS143
158200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         TRKCS143
158300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         TRKCS143
158400     END-IF.                                                      TRKCS143
158500                                                                  TRKCS143
158600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   TRKCS143
158700                    - PV-TOP-ITEM + 1.                            TRKCS143
158800                                                                  TRKCS143
158900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      TRKCS143
159000         CONTINUE                                                 TRKCS143
159100     ELSE                                                         TRKCS143
159200         MOVE -1                   TO MR-SELECTL (PV-SUB)         TRKCS143
159300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         TRKCS143
159400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         TRKCS143
159500     END-IF.                                                      TRKCS143
159600                                                                  TRKCS143
159700/                                                                 TRKCS143
159800*----------------------------------------------------------------*TRKCS143
159900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *TRKCS143
160000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *TRKCS143
160100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *TRKCS143
160200*----------------------------------------------------------------*TRKCS143
160300                                                                  TRKCS143
160400 3500-MARK-RANGE-AS-SELECTED.                                     TRKCS143
160500                                                                  TRKCS143
160600     MOVE +1                       TO ASC-BLK-SUB.                TRKCS143
160700                                                                  TRKCS143
160800     PERFORM 3510-MARK-SELECTED-INDS                              TRKCS143
160900         VARYING ASC-ITEM-SUB                                     TRKCS143
161000         FROM 1 BY 1                                              TRKCS143
161100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 TRKCS143
161200                                                                  TRKCS143
161300     ADD +1                        TO ASC-BLK-SUB.                TRKCS143
161400                                                                  TRKCS143
161500     PERFORM 3510-MARK-SELECTED-INDS                              TRKCS143
161600         VARYING ASC-ITEM-SUB                                     TRKCS143
161700         FROM 1 BY 1                                              TRKCS143
161800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 TRKCS143
161900                                                                  TRKCS143
162000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               TRKCS143
162100                                   TO PV-LIST-ITEM-NUMBER.        TRKCS143
162200                                                                  TRKCS143
162300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            TRKCS143
162400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         TRKCS143
162500               PC-ITEMS-PER-PANEL).                               TRKCS143
162600                                                                  TRKCS143
162700     MOVE ASC-START-OF-SELECTED-RANGE                             TRKCS143
162800                                   TO PV-START-OF-SELECTED-RANGE. TRKCS143
162900                                                                  TRKCS143
163000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            TRKCS143
163100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  TRKCS143
163200               PC-ITEMS-PER-PANEL).                               TRKCS143
163300                                                                  TRKCS143
163400     MOVE ASC-END-OF-SELECTED-RANGE                               TRKCS143
163500                                   TO PV-END-OF-SELECTED-RANGE.   TRKCS143
163600                                                                  TRKCS143
163700     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             TRKCS143
163800         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    TRKCS143
163900               PC-ITEMS-PER-PANEL).                               TRKCS143
164000                                                                  TRKCS143
164100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             TRKCS143
164200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             TRKCS143
164300                                                                  TRKCS143
164400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    TRKCS143
164500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        TRKCS143
164600         MOVE +1                   TO ASC-BLK-SUB                 TRKCS143
164700         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS143
164800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         TRKCS143
164900             PV-FIRST-BLOCK-IN-ARRAY - 1                          TRKCS143
165000                                                                  TRKCS143
165100         PERFORM                                                  TRKCS143
165200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      TRKCS143
165300                   PV-PREV-BLOCK-IN-ARRAY                         TRKCS143
165400             MOVE PV-FIRST-BLOCK-IN-RANGE                         TRKCS143
165500                                   TO PV-BLOCK-NUMBER             TRKCS143
165600             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
165700             PERFORM 3510-MARK-SELECTED-INDS                      TRKCS143
165800                 VARYING ASC-ITEM-SUB                             TRKCS143
165900                 FROM 1 BY 1                                      TRKCS143
166000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          TRKCS143
166100             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
166200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     TRKCS143
166300         END-PERFORM                                              TRKCS143
166400                                                                  TRKCS143
166500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         TRKCS143
166600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     TRKCS143
166700         PERFORM                                                  TRKCS143
166800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       TRKCS143
166900                   PV-LAST-BLOCK-IN-RANGE                         TRKCS143
167000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          TRKCS143
167100                                   TO PV-BLOCK-NUMBER             TRKCS143
167200             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
167300             PERFORM 3510-MARK-SELECTED-INDS                      TRKCS143
167400                 VARYING ASC-ITEM-SUB                             TRKCS143
167500                 FROM 1 BY 1                                      TRKCS143
167600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          TRKCS143
167700             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
167800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      TRKCS143
167900         END-PERFORM                                              TRKCS143
168000                                                                  TRKCS143
168100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             TRKCS143
168200                                   TO PV-BLOCK-NUMBER             TRKCS143
168300         PERFORM 4410-READ-TEMP-STORAGE                           TRKCS143
168400     END-IF.                                                      TRKCS143
168500                                                                  TRKCS143
168600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE TRKCS143
168700                                      ASC-END-OF-SELECTED-RANGE.  TRKCS143
168800                                                                  TRKCS143
168900/                                                                 TRKCS143
169000*----------------------------------------------------------------*TRKCS143
169100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *TRKCS143
169200*----------------------------------------------------------------*TRKCS143
169300                                                                  TRKCS143
169400 3510-MARK-SELECTED-INDS.                                         TRKCS143
169500                                                                  TRKCS143
169600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         TRKCS143
169700         ASC-START-OF-SELECTED-RANGE)                             TRKCS143
169800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         TRKCS143
169900         ASC-START-OF-SELECTED-RANGE)                             TRKCS143
170000                                                                  TRKCS143
170100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     TRKCS143
170200             ASC-END-OF-SELECTED-RANGE)                           TRKCS143
170300         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     TRKCS143
170400             ASC-END-OF-SELECTED-RANGE)                           TRKCS143
170500                                                                  TRKCS143
170600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
170700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   TRKCS143
170800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   TRKCS143
170900                                   TO TRUE                        TRKCS143
171000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              TRKCS143
171100                                   TO TRUE                        TRKCS143
171200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMSTRKCS143
171300             END-IF                                               TRKCS143
171400         END-IF                                                   TRKCS143
171500     END-IF.                                                      TRKCS143
171600                                                                  TRKCS143
171700/                                                                 TRKCS143
171800*----------------------------------------------------------------*TRKCS143
171900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *TRKCS143
172000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *TRKCS143
172100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *TRKCS143
172200*    DISPLAY THE PANEL TO USER.                                  *TRKCS143
172300*----------------------------------------------------------------*TRKCS143
172400                                                                  TRKCS143
172500 4000-BUILD-INITIAL-PANEL.                                        TRKCS143
172600                                                                  TRKCS143
172700     INITIALIZE ASC-BLOCK-ENTRIES (1)                             TRKCS143
172800                ASC-BLOCK-ENTRIES (2).                            TRKCS143
172900                                                                  TRKCS143
173000     MOVE +1                       TO ASC-BLK-SUB.                TRKCS143
173100                                                                  TRKCS143
173200     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       TRKCS143
173300                                                                  TRKCS143
173400     MOVE +0                       TO ASC-ITEM-SUB                TRKCS143
173500                                      ASC-NUMBER-OF-ITEMS-READ    TRKCS143
173600                                      ASC-NUMBER-OF-SELECTED-ITEMSTRKCS143
173700                                      ASC-HIGHEST-BLOCK-WRITTEN   TRKCS143
173800                                      ASC-START-OF-SELECTED-RANGE TRKCS143
173900                                      ASC-END-OF-SELECTED-RANGE   TRKCS143
174000                                      ASC-ITEM-AT-TOP-OF-PANEL.   TRKCS143
174100                                                                  TRKCS143
174200     PERFORM 4100-PREPARE-CURSOR.                                 TRKCS143
174300                                                                  TRKCS143
174400     PERFORM 4010-OPEN-CURSOR.                                    TRKCS143
174500                                                                  TRKCS143
174600     PERFORM 4300-READ-ITEMS-FROM-DB.                             TRKCS143
174700                                                                  TRKCS143
174800     PERFORM 4020-CLOSE-CURSOR.                                   TRKCS143
174900                                                                  TRKCS143
175000     MOVE +1                       TO PV-TOP-ITEM.                TRKCS143
175100                                                                  TRKCS143
175200     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          TRKCS143
175300         SET DP020-NEXT-ACT-APPL-ERROR                            TRKCS143
175400                                   TO TRUE                        TRKCS143
175500         SET DP020-MSG-FATAL       TO TRUE                        TRKCS143
175600         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            TRKCS143
175700     ELSE                                                         TRKCS143
175800         MOVE -1                   TO MR-SELECTL (1)              TRKCS143
175900         SET DP030-SET-CURSOR-APPL-1                              TRKCS143
176000                                   TO TRUE                        TRKCS143
176100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     TRKCS143
176200     END-IF.                                                      TRKCS143
176300                                                                  TRKCS143
176400/                                                                 TRKCS143
176500*----------------------------------------------------------------*TRKCS143
176600* OPEN THE RECEIVER CURSOR                                       *TRKCS143
176700*----------------------------------------------------------------*TRKCS143
176800                                                                  TRKCS143
176900 4010-OPEN-CURSOR.                                                TRKCS143
177000                                                                  TRKCS143
177100     PERFORM                                                      TRKCS143
177200         WITH TEST AFTER                                          TRKCS143
177300         VARYING PV-RETRY-COUNTER                                 TRKCS143
177400         FROM 1 BY 1                                              TRKCS143
177500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS143
177600            OR (SQLCODE = +0))                                    TRKCS143
177700                                                                  TRKCS143
177800         EXEC SQL                                                 TRKCS143
177900             OPEN RECEIVER-CSR                                    TRKCS143
178000         END-EXEC                                                 TRKCS143
178100                                                                  TRKCS143
178200         EVALUATE TRUE                                            TRKCS143
178300             WHEN SQLCODE = +0                                    TRKCS143
178400                  CONTINUE                                        TRKCS143
178500             WHEN SQLCODE = -904                                  TRKCS143
178600             WHEN SQLCODE = -913                                  TRKCS143
178700                  CONTINUE                                        TRKCS143
178800             WHEN SQLWARN0 NOT = SPACE                            TRKCS143
178900             WHEN SQLCODE  NOT = +0                               TRKCS143
179000                  MOVE '4010-OPEN-CURSOR'                         TRKCS143
179100                                   TO DP013-PARAGRAPH             TRKCS143
179200                  MOVE 'OPEN RECEIVER-CSR CURSOR'                 TRKCS143
179300                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
179400                  MOVE SQLCA       TO DP013-SQLCA                 TRKCS143
179500                  MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (1)    TRKCS143
179600                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (2)    TRKCS143
179700                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (3)    TRKCS143
179800                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (4)    TRKCS143
179900                  MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (5)    TRKCS143
180000                  SET DP013-DB2-ABEND                             TRKCS143
180100                                   TO TRUE                        TRKCS143
180200                  PERFORM DP013-0000-PROCESS-ABEND                TRKCS143
180300         END-EVALUATE                                             TRKCS143
180400     END-PERFORM.                                                 TRKCS143
180500                                                                  TRKCS143
180600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS143
180700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             TRKCS143
180800         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              TRKCS143
180900                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
181000         MOVE SQLCA                TO DP013-SQLCA                 TRKCS143
181100         SET DP013-DB2-ABEND       TO TRUE                        TRKCS143
181200         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
181300     END-IF.                                                      TRKCS143
181400                                                                  TRKCS143
181500/                                                                 TRKCS143
181600*----------------------------------------------------------------*TRKCS143
181700* CLOSE THE RECEIVER CURSOR                                      *TRKCS143
181800*----------------------------------------------------------------*TRKCS143
181900                                                                  TRKCS143
182000 4020-CLOSE-CURSOR.                                               TRKCS143
182100                                                                  TRKCS143
182200     EXEC SQL                                                     TRKCS143
182300         CLOSE RECEIVER-CSR                                       TRKCS143
182400     END-EXEC.                                                    TRKCS143
182500                                                                  TRKCS143
182600     EVALUATE TRUE                                                TRKCS143
182700         WHEN SQLCODE = +0                                        TRKCS143
182800              CONTINUE                                            TRKCS143
182900         WHEN SQLWARN0 NOT = SPACE                                TRKCS143
183000         WHEN SQLCODE  NOT = +0                                   TRKCS143
183100              MOVE '4020-CLOSE-CURSOR'                            TRKCS143
183200                                   TO DP013-PARAGRAPH             TRKCS143
183300              MOVE 'CLOSE RECEIVER-CSR CURSOR'                    TRKCS143
183400                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
183500              MOVE SQLCA           TO DP013-SQLCA                 TRKCS143
183600              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    TRKCS143
183700              MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (2)    TRKCS143
183800              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (3)    TRKCS143
183900              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (4)    TRKCS143
184000              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (5)    TRKCS143
184100              SET DP013-DB2-ABEND  TO TRUE                        TRKCS143
184200              PERFORM DP013-0000-PROCESS-ABEND                    TRKCS143
184300     END-EVALUATE.                                                TRKCS143
184400                                                                  TRKCS143
184500/                                                                 TRKCS143
184600*----------------------------------------------------------------*TRKCS143
184700*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *TRKCS143
184800*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *TRKCS143
184900*----------------------------------------------------------------*TRKCS143
185000                                                                  TRKCS143
185100 4100-PREPARE-CURSOR.                                             TRKCS143
185200                                                                  TRKCS143
185300     IF DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT           TRKCS143
185400        IF TR013-ARRIVAL-DTE-BEG > SPACES                         TRKCS143
185500           MOVE TR013-ARRIVAL-DTE-BEG TO DK-ARRIVAL-DTE-BEG       TRKCS143
185600        ELSE                                                      TRKCS143
185700           MOVE '0001-01-01'          TO DK-ARRIVAL-DTE-BEG       TRKCS143
185800        END-IF                                                    TRKCS143
185900        IF TR013-ARRIVAL-DTE-END > SPACES                         TRKCS143
186000           MOVE TR013-ARRIVAL-DTE-END TO DK-ARRIVAL-DTE-END       TRKCS143
186100        ELSE                                                      TRKCS143
186200           MOVE '9999-12-31'          TO DK-ARRIVAL-DTE-END       TRKCS143
186300        END-IF                                                    TRKCS143
186400     ELSE                                                         TRKCS143
186500        IF ASC-KEY-ARRIVAL-DTE-BEG > SPACES                       TRKCS143
186600           MOVE ASC-KEY-ARRIVAL-DTE-BEG TO DK-ARRIVAL-DTE-BEG     TRKCS143
186700        ELSE                                                      TRKCS143
186800           MOVE '0001-01-01'            TO DK-ARRIVAL-DTE-BEG     TRKCS143
186900        END-IF                                                    TRKCS143
187000        IF ASC-KEY-ARRIVAL-DTE-END > SPACES                       TRKCS143
187100           MOVE ASC-KEY-ARRIVAL-DTE-END TO DK-ARRIVAL-DTE-END     TRKCS143
187200        ELSE                                                      TRKCS143
187300           MOVE '9999-12-31'            TO DK-ARRIVAL-DTE-END     TRKCS143
187400        END-IF                                                    TRKCS143
187500     END-IF.                                                      TRKCS143
187600                                                                  TRKCS143
187700/                                                                 TRKCS143
187800*----------------------------------------------------------------*TRKCS143
187900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *TRKCS143
188000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *TRKCS143
188100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *TRKCS143
188200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *TRKCS143
188300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *TRKCS143
188400*                                                                *TRKCS143
188500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *TRKCS143
188600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *TRKCS143
188700*    UPON INITIALIZATION.                                        *TRKCS143
188800*----------------------------------------------------------------*TRKCS143
188900                                                                  TRKCS143
189000 4300-READ-ITEMS-FROM-DB.                                         TRKCS143
189100                                                                  TRKCS143
189200     PERFORM                                                      TRKCS143
189300         VARYING PV-READ-COUNT                                    TRKCS143
189400         FROM 1 BY 1                                              TRKCS143
189500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    TRKCS143
189600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         TRKCS143
189700                                                                  TRKCS143
189800         PERFORM 4310-FETCH                                       TRKCS143
189900                                                                  TRKCS143
190000         IF  ASC-ITEMS-LEFT-ON-DB                                 TRKCS143
190100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                TRKCS143
190200                 ADD +1            TO ASC-ITEM-SUB                TRKCS143
190300             ELSE                                                 TRKCS143
190400                 ADD +1            TO ASC-BLK-SUB                 TRKCS143
190500                 MOVE +1           TO ASC-ITEM-SUB                TRKCS143
190600                                                                  TRKCS143
190700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         TRKCS143
190800                     MOVE +1       TO ASC-BLK-SUB                 TRKCS143
190900                     SET ASC-BLOCK-MODIFIED (1)                   TRKCS143
191000                                   TO TRUE                        TRKCS143
191100                     PERFORM 5100-WRITE-TEMP-STORAGE              TRKCS143
191200                     MOVE ASC-BLOCK-ENTRIES                       TRKCS143
191300                               (PC-MAX-BLOCKS-IN-ARRAY)           TRKCS143
191400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) TRKCS143
191500                     ADD +1        TO ASC-BLK-SUB                 TRKCS143
191600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   TRKCS143
191700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      TRKCS143
191800                                   TO TRUE                        TRKCS143
191900                 END-IF                                           TRKCS143
192000             END-IF                                               TRKCS143
192100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    TRKCS143
192200             MOVE ASC-NUMBER-OF-ITEMS-READ                        TRKCS143
192300                                   TO ASC-LIST-ITEM-NUMBER        TRKCS143
192400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  TRKCS143
192500             MOVE ENTNME-ENT-NAME-DESC TO ASC-ENT-NAME-DESC       TRKCS143
192600             MOVE RECEIV-REC-SEQ-NBR TO ASC-REC-SEQ-NBR           TRKCS143
192700                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
192800             MOVE SHIPMT-PRO-NBR   TO ASC-PRO-NBR                 TRKCS143
192900                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
193000             MOVE VHTRIP-OWNER-SCAC-ID TO ASC-OWNER-SCAC-ID       TRKCS143
193100                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
193200             IF DN-VEH-NBR NOT = -1                               TRKCS143
193300                 MOVE VHTRIP-VEH-NBR   TO ASC-VEH-NBR             TRKCS143
193400                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
193500             END-IF                                               TRKCS143
193600             MOVE VHTRIP-OWNR-SCAC-SHIP-DTE                       TRKCS143
193700                                    TO PV-DB2-DATE                TRKCS143
193800             IF  PV-DB2-DATE = '0001-01-01'                       TRKCS143
193900                 MOVE SPACES         TO ASC-CARR-SHIP-DTE         TRKCS143
194000                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
194100             ELSE                                                 TRKCS143
194200                 MOVE PV-DB2-DATE-MM TO PV-EDIT-DATE-MM           TRKCS143
194300                 MOVE PV-DB2-DATE-DD TO PV-EDIT-DATE-DD           TRKCS143
194400                 MOVE PV-DB2-DATE-YY TO PV-EDIT-DATE-YY           TRKCS143
194500                 MOVE PV-EDIT-DATE   TO ASC-CARR-SHIP-DTE         TRKCS143
194600                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
194700             END-IF                                               TRKCS143
194800             MOVE SHIPMT-VEND-SHIP-DTE                            TRKCS143
194900                                    TO PV-DB2-DATE                TRKCS143
195000             IF  PV-DB2-DATE = '0001-01-01'                       TRKCS143
195100                 MOVE SPACES         TO ASC-VEND-SHIP-DTE         TRKCS143
195200                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
195300             ELSE                                                 TRKCS143
195400                 MOVE PV-DB2-DATE-MM TO PV-EDIT-DATE-MM           TRKCS143
195500                 MOVE PV-DB2-DATE-DD TO PV-EDIT-DATE-DD           TRKCS143
195600                 MOVE PV-DB2-DATE-YY TO PV-EDIT-DATE-YY           TRKCS143
195700                 MOVE PV-EDIT-DATE   TO ASC-VEND-SHIP-DTE         TRKCS143
195800                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
195900             END-IF                                               TRKCS143
196000             MOVE PV-DB2-HOST-DATE  TO PV-DB2-DATE                TRKCS143
196100             MOVE PV-DB2-DATE-MM    TO PV-EDIT-DATE-MM            TRKCS143
196200             MOVE PV-DB2-DATE-DD    TO PV-EDIT-DATE-DD            TRKCS143
196300             MOVE PV-DB2-DATE-YY    TO PV-EDIT-DATE-YY            TRKCS143
196400             MOVE PV-EDIT-DATE      TO ASC-ARRIVAL-DTE            TRKCS143
196500                                       (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
196600         END-IF                                                   TRKCS143
196700     END-PERFORM.                                                 TRKCS143
196800                                                                  TRKCS143
196900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          TRKCS143
197000         MOVE +1                   TO ASC-BLK-SUB                 TRKCS143
197100         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS143
197200         ADD +1                    TO ASC-BLK-SUB                 TRKCS143
197300         PERFORM 5100-WRITE-TEMP-STORAGE                          TRKCS143
197400                                                                  TRKCS143
197500         MOVE 1                    TO ASC-BLK-SUB                 TRKCS143
197600                                      PV-BLOCK-NUMBER             TRKCS143
197700         PERFORM 4410-READ-TEMP-STORAGE                           TRKCS143
197800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             TRKCS143
197900             MOVE 2                TO ASC-BLK-SUB                 TRKCS143
198000                                      PV-BLOCK-NUMBER             TRKCS143
198100             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
198200         END-IF                                                   TRKCS143
198300     END-IF.                                                      TRKCS143
198400                                                                  TRKCS143
198500/                                                                 TRKCS143
198600*----------------------------------------------------------------*TRKCS143
198700*    FETCH A RECEIVER ROW                                        *TRKCS143
198800*----------------------------------------------------------------*TRKCS143
198900                                                                  TRKCS143
199000 4310-FETCH.                                                      TRKCS143
199100                                                                  TRKCS143
199200     EXEC SQL                                                     TRKCS143
199300         FETCH RECEIVER-CSR                                       TRKCS143
199400          INTO :RECEIV-REC-SEQ-NBR                                TRKCS143
199500              ,:PV-DB2-HOST-DATE                                  TRKCS143
199600              ,:VHTRIP-OWNER-SCAC-ID                              TRKCS143
199700              ,:VHTRIP-VEH-NBR:DN-VEH-NBR                         TRKCS143
199800              ,:VHTRIP-OWNR-SCAC-SHIP-DTE                         TRKCS143
200000              ,:SHIPMT-PRO-NBR                                    TRKCS143
200100              ,:SHIPMT-VEND-SHIP-DTE                              TRKCS143
200200              ,:ENTNME-ENT-NAME-DESC                              TRKCS143
200300     END-EXEC.                                                    TRKCS143
200400                                                                  TRKCS143
200500     EVALUATE TRUE                                                TRKCS143
200600         WHEN SQLCODE = +0                                        TRKCS143
200700              CONTINUE                                            TRKCS143
200800         WHEN SQLCODE = +100                                      TRKCS143
200900              SET ASC-NO-ITEMS-LEFT-ON-DB                         TRKCS143
201000                                   TO TRUE                        TRKCS143
201100         WHEN SQLWARN0 NOT = SPACE                                TRKCS143
201200         WHEN SQLCODE < +0                                        TRKCS143
201300         WHEN SQLCODE > +0                                        TRKCS143
201400              MOVE '4310-FETCH-CURSOR'                            TRKCS143
201500                                   TO DP013-PARAGRAPH             TRKCS143
201600              MOVE 'FETCH RECEIVER CURSOR'                        TRKCS143
201700                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
201800              MOVE SQLCA           TO DP013-SQLCA                 TRKCS143
201900              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    TRKCS143
202000              MOVE 'TVHTRIP'       TO DP013-DB2-TABLE-NAME (2)    TRKCS143
202100              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (3)    TRKCS143
202200              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (4)    TRKCS143
202300              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (5)    TRKCS143
202400              SET DP013-DB2-ABEND  TO TRUE                        TRKCS143
202500              PERFORM DP013-0000-PROCESS-ABEND                    TRKCS143
202600     END-EVALUATE.                                                TRKCS143
202700                                                                  TRKCS143
202800/                                                                 TRKCS143
202900*----------------------------------------------------------------*TRKCS143
203000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *TRKCS143
203100*----------------------------------------------------------------*TRKCS143
203200                                                                  TRKCS143
203300 4400-MOVE-COMMAREA-TO-SCREEN.                                    TRKCS143
203400                                                                  TRKCS143
203500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             TRKCS143
203600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          TRKCS143
203700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          TRKCS143
203800             MOVE +1               TO ASC-BLK-SUB                 TRKCS143
203900             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
204000             ADD +1                TO ASC-BLK-SUB                 TRKCS143
204100             PERFORM 5100-WRITE-TEMP-STORAGE                      TRKCS143
204200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             TRKCS143
204300                 GIVING PV-BLOCK-NUMBER                           TRKCS143
204400                 REMAINDER PV-REMAINDER                           TRKCS143
204500             IF  PV-REMAINDER > ZERO                              TRKCS143
204600                 ADD +1            TO PV-BLOCK-NUMBER             TRKCS143
204700             END-IF                                               TRKCS143
204800             MOVE +1               TO ASC-BLK-SUB                 TRKCS143
204900             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
205000             ADD +1                TO ASC-BLK-SUB                 TRKCS143
205100                                      PV-BLOCK-NUMBER             TRKCS143
205200             PERFORM 4410-READ-TEMP-STORAGE                       TRKCS143
205300     END-IF.                                                      TRKCS143
205400                                                                  TRKCS143
205500     MOVE +1                       TO ASC-BLK-SUB.                TRKCS143
205600                                                                  TRKCS143
205700     COMPUTE ASC-ITEM-SUB =                                       TRKCS143
205800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              TRKCS143
205900         + PC-ITEMS-PER-PANEL).                                   TRKCS143
206000                                                                  TRKCS143
206100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        TRKCS143
206200         ADD +1                    TO ASC-BLK-SUB                 TRKCS143
206300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            TRKCS143
206400     END-IF.                                                      TRKCS143
206500                                                                  TRKCS143
206600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           TRKCS143
206700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                TRKCS143
206800                                                                  TRKCS143
206900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        TRKCS143
207000     PERFORM 4420-FORMAT-LIST-LINES                               TRKCS143
207100         VARYING PV-SUB                                           TRKCS143
207200         FROM PC-ITEMS-PER-PANEL BY -1                            TRKCS143
207300         UNTIL PV-SUB < +1.                                       TRKCS143
207400                                                                  TRKCS143
207500     COMPUTE ASC-ITEMS-DISPLAYED =                                TRKCS143
207600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          TRKCS143
207700                                                                  TRKCS143
207800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    TRKCS143
207900                                      ASTRTITO.                   TRKCS143
208000                                                                  TRKCS143
208100     MOVE ASC-KEY-PO-NBR           TO ASC-PO-NBR.                 TRKCS143
208200     MOVE ASC-PO-NBR               TO MR-PO-NBR.                  TRKCS143
208300                                                                  TRKCS143
208400     IF ASC-PRINTER-ID-X = '00000000'                             TRKCS143
208500        CONTINUE                                                  TRKCS143
208600     ELSE                                                         TRKCS143
208700        MOVE ASC-PRINTER-ID-X      TO MR-PRINTER-ID               TRKCS143
208800     END-IF.                                                      TRKCS143
208900                                                                  TRKCS143
209000     IF  ASC-ARRIVAL-DTE-BEG > SPACES                             TRKCS143
209100         MOVE ASC-ARRIVAL-DTE-BEG  TO PV-DB2-DATE                 TRKCS143
209200         MOVE PV-DB2-DATE-MM       TO PV-EDIT-DATE-MM             TRKCS143
209300         MOVE PV-DB2-DATE-DD       TO PV-EDIT-DATE-DD             TRKCS143
209400         MOVE PV-DB2-DATE-YY       TO PV-EDIT-DATE-YY             TRKCS143
209500         MOVE PV-EDIT-DATE         TO MR-ARRIVAL-DTE-BEG          TRKCS143
209600     END-IF.                                                      TRKCS143
209700                                                                  TRKCS143
209800     IF  ASC-ARRIVAL-DTE-END > SPACES                             TRKCS143
209900         MOVE ASC-ARRIVAL-DTE-END      TO PV-DB2-DATE             TRKCS143
210000         MOVE PV-DB2-DATE-MM           TO PV-EDIT-DATE-MM         TRKCS143
210100         MOVE PV-DB2-DATE-DD           TO PV-EDIT-DATE-DD         TRKCS143
210200         MOVE PV-DB2-DATE-YY           TO PV-EDIT-DATE-YY         TRKCS143
210300         MOVE PV-EDIT-DATE             TO MR-ARRIVAL-DTE-END      TRKCS143
210400     END-IF.                                                      TRKCS143
210500                                                                  TRKCS143
210600     MOVE ASC-ENT-NAME-DESC        TO MR-ENT-NAME-DESC.           TRKCS143
210700                                                                  TRKCS143
210800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    TRKCS143
210900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    TRKCS143
211000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            TRKCS143
211100                                   TO ASELITO.                    TRKCS143
211200                                                                  TRKCS143
211300     IF  DP020-MSG-NUMBER-X = SPACE                               TRKCS143
211400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  TRKCS143
211500*            --- MORE ITEMS TO DISPLAY ----                       TRKCS143
211600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            TRKCS143
211700             SET DP020-MSG-INFORMATIONAL                          TRKCS143
211800                                   TO TRUE                        TRKCS143
211900         END-IF                                                   TRKCS143
212000     END-IF.                                                      TRKCS143
212100                                                                  TRKCS143
212200*----------------------------------------------------------------*TRKCS143
212300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *TRKCS143
212400*----------------------------------------------------------------*TRKCS143
212500                                                                  TRKCS143
212600 4410-READ-TEMP-STORAGE.                                          TRKCS143
212700                                                                  TRKCS143
212800     EXEC CICS                                                    TRKCS143
212900         READQ TS                                                 TRKCS143
213000             QUEUE (ASC-LIST-QUEUE-NAME)                          TRKCS143
213100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS143
213200             ITEM  (PV-BLOCK-NUMBER)                              TRKCS143
213300             RESP  (PV-CICS-RESP)                                 TRKCS143
213400     END-EXEC.                                                    TRKCS143
213500                                                                  TRKCS143
213600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       TRKCS143
213700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     TRKCS143
213800         CONTINUE                                                 TRKCS143
213900     ELSE                                                         TRKCS143
214000         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
214100         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
214200         MOVE '4410-READ-TEMP-STORAGE'                            TRKCS143
214300                                   TO DP013-PARAGRAPH             TRKCS143
214400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      TRKCS143
214500                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
214600         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
214700     END-IF.                                                      TRKCS143
214800                                                                  TRKCS143
214900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      TRKCS143
215000                                   TO TRUE.                       TRKCS143
215100                                                                  TRKCS143
215200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         TRKCS143
215300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               TRKCS143
215400     END-IF.                                                      TRKCS143
215500                                                                  TRKCS143
215600/                                                                 TRKCS143
215700*----------------------------------------------------------------*TRKCS143
215800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *TRKCS143
215900*----------------------------------------------------------------*TRKCS143
216000                                                                  TRKCS143
216100 4420-FORMAT-LIST-LINES.                                          TRKCS143
216200                                                                  TRKCS143
216300     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      TRKCS143
216400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                TRKCS143
216500         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         TRKCS143
216600         MOVE SPACES               TO MR-PO-NBR                   TRKCS143
216700                                      MR-PRINTER-ID               TRKCS143
216800                                      MR-ARRIVAL-DTE-BEG          TRKCS143
216900                                      MR-ARRIVAL-DTE-END          TRKCS143
217000                                      MR-ENT-NAME-DESC            TRKCS143
217100                                      MR-SELECT  (PV-SUB)         TRKCS143
217200                                      MR-ACTION  (PV-SUB)         TRKCS143
217300                                      MR-REC-SEQ-NBR (PV-SUB)     TRKCS143
217400                                      MR-PRO-NBR (PV-SUB)         TRKCS143
217500                                      MR-OWNER-SCAC-ID (PV-SUB)   TRKCS143
217600                                      MR-VEH-NBR (PV-SUB)         TRKCS143
217700                                      MR-CARR-SHIP-DTE (PV-SUB)   TRKCS143
217800                                      MR-VEND-SHIP-DTE (PV-SUB)   TRKCS143
217900                                      MR-ARRIVAL-DTE (PV-SUB)     TRKCS143
218000     ELSE                                                         TRKCS143
218100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      TRKCS143
218200                                                   > SPACE        TRKCS143
218300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) TRKCS143
218400                                   TO MR-SELECT (PV-SUB)          TRKCS143
218500         ELSE                                                     TRKCS143
218600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      TRKCS143
218700                                   TO MR-SELECT (PV-SUB)          TRKCS143
218800         END-IF                                                   TRKCS143
218900                                                                  TRKCS143
219000         IF  DP030-SET-CURSOR-TRAILER                             TRKCS143
219100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)TRKCS143
219200                 > SPACE)                                         TRKCS143
219300               OR (PV-SUB = 1))                                   TRKCS143
219400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               TRKCS143
219500                MOVE -1            TO MR-SELECTL (PV-SUB)         TRKCS143
219600             END-IF                                               TRKCS143
219700         END-IF                                                   TRKCS143
219800                                                                  TRKCS143
219900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           TRKCS143
220000             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           TRKCS143
220100                                   TO MR-ACTION (PV-SUB)          TRKCS143
220200             MOVE ASC-REC-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      TRKCS143
220300                                   TO MR-REC-SEQ-NBR (PV-SUB)     TRKCS143
220400             MOVE ASC-PRO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
220500                                   TO MR-PRO-NBR (PV-SUB)         TRKCS143
220600             MOVE ASC-OWNER-SCAC-ID (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS143
220700                                   TO MR-OWNER-SCAC-ID (PV-SUB)   TRKCS143
220800             MOVE ASC-VEH-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          TRKCS143
220900                                   TO MR-VEH-NBR (PV-SUB)         TRKCS143
221000             MOVE ASC-CARR-SHIP-DTE (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS143
221100                                   TO MR-CARR-SHIP-DTE (PV-SUB)   TRKCS143
221200             MOVE ASC-VEND-SHIP-DTE (ASC-BLK-SUB ASC-ITEM-SUB)    TRKCS143
221300                                   TO MR-VEND-SHIP-DTE (PV-SUB)   TRKCS143
221400             MOVE ASC-ARRIVAL-DTE (ASC-BLK-SUB ASC-ITEM-SUB)      TRKCS143
221500                                   TO MR-ARRIVAL-DTE (PV-SUB)     TRKCS143
221600         END-IF                                                   TRKCS143
221700     END-IF.                                                      TRKCS143
221800                                                                  TRKCS143
221900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               TRKCS143
222000                                                                  TRKCS143
222100     IF  ASC-ITEM-SUB < + 1                                       TRKCS143
222200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                TRKCS143
222300         MOVE +1                   TO ASC-BLK-SUB                 TRKCS143
222400     END-IF.                                                      TRKCS143
222500                                                                  TRKCS143
222600*----------------------------------------------------------------*TRKCS143
222700*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *TRKCS143
222800*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *TRKCS143
222900*  ISSUE A WARNING.                                              *TRKCS143
223000*----------------------------------------------------------------*TRKCS143
223100 4430-CHECK-FOR-BEGIN-AND-END.                                    TRKCS143
223200                                                                  TRKCS143
223300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       TRKCS143
223400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     TRKCS143
223500*            -- NO END-OF-RANGE SPECFIED ---                      TRKCS143
223600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            TRKCS143
223700             SET DP020-MSG-WARNING TO TRUE                        TRKCS143
223800             PERFORM 4431-POSITION-AT-WARNING                     TRKCS143
223900         END-IF                                                   TRKCS143
224000     ELSE                                                         TRKCS143
224100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     TRKCS143
224200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                TRKCS143
224300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            TRKCS143
224400             SET DP020-MSG-WARNING TO TRUE                        TRKCS143
224500             PERFORM 4431-POSITION-AT-WARNING                     TRKCS143
224600         END-IF                                                   TRKCS143
224700     END-IF.                                                      TRKCS143
224800                                                                  TRKCS143
224900*----------------------------------------------------------------*TRKCS143
225000*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *TRKCS143
225100*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *TRKCS143
225200*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *TRKCS143
225300*  POSITION THE CURSOR THERE.                                    *TRKCS143
225400*----------------------------------------------------------------*TRKCS143
225500 4431-POSITION-AT-WARNING.                                        TRKCS143
225600                                                                  TRKCS143
225700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 TRKCS143
225800                    - PV-TOP-ITEM + 1.                            TRKCS143
225900                                                                  TRKCS143
226000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      TRKCS143
226100         CONTINUE                                                 TRKCS143
226200     ELSE                                                         TRKCS143
226300         SET DP030-SET-CURSOR-APPL-1                              TRKCS143
226400                                   TO TRUE                        TRKCS143
226500         MOVE -1                   TO MR-SELECTL (PV-SUB)         TRKCS143
226600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         TRKCS143
226700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         TRKCS143
226800     END-IF.                                                      TRKCS143
226900                                                                  TRKCS143
227000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   TRKCS143
227100                    - PV-TOP-ITEM + 1.                            TRKCS143
227200                                                                  TRKCS143
227300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      TRKCS143
227400         CONTINUE                                                 TRKCS143
227500     ELSE                                                         TRKCS143
227600         SET DP030-SET-CURSOR-APPL-1                              TRKCS143
227700                                   TO TRUE                        TRKCS143
227800         MOVE -1                   TO MR-SELECTL (PV-SUB)         TRKCS143
227900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         TRKCS143
228000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         TRKCS143
228100     END-IF.                                                      TRKCS143
228200                                                                  TRKCS143
228300/                                                                 TRKCS143
228400*----------------------------------------------------------------*TRKCS143
228500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *TRKCS143
228600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *TRKCS143
228700* FOR THE SELECTED ITEMS QUEUE.                                  *TRKCS143
228800*                                                                *TRKCS143
228900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *TRKCS143
229000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *TRKCS143
229100* THE ARRAY IS FULL.                                             *TRKCS143
229200*----------------------------------------------------------------*TRKCS143
229300                                                                  TRKCS143
229400 5000-PREPARE-SEL-QUEUE.                                          TRKCS143
229500                                                                  TRKCS143
229600     MOVE +1                       TO ASC-BLK-SUB.                TRKCS143
229700     PERFORM 5100-WRITE-TEMP-STORAGE.                             TRKCS143
229800     ADD +1                        TO ASC-BLK-SUB.                TRKCS143
229900     PERFORM 5100-WRITE-TEMP-STORAGE.                             TRKCS143
230000                                                                  TRKCS143
230100     MOVE ASC-SEL-QUEUE-NAME       TO TR014-SEL-QUEUE-NAME.       TRKCS143
230200     PERFORM 6010-DELETE-SEL-QUEUE.                               TRKCS143
230300                                                                  TRKCS143
230400     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      TRKCS143
230500         SET ASC-UPDATE-TSQ        TO TRUE                        TRKCS143
230600     END-IF.                                                      TRKCS143
230700                                                                  TRKCS143
230800     SET TR015-IDX                 TO 1.                          TRKCS143
230900     MOVE ZERO                     TO TR014-NUMBER-OF-TS-ITEMS.   TRKCS143
231000     INITIALIZE TR015-SELECTED-ITEM-ARRAY.                        TRKCS143
231100                                                                  TRKCS143
231200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           TRKCS143
231300             VARYING PV-ITEM                                      TRKCS143
231400             FROM 1 BY 1                                          TRKCS143
231500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     TRKCS143
231600                                                                  TRKCS143
231700     IF  TR015-IDX > 1                                            TRKCS143
231800         PERFORM 5205-WRITE-SEL-QUEUE                             TRKCS143
231900         ADD +1                    TO TR014-NUMBER-OF-TS-ITEMS    TRKCS143
232000     END-IF.                                                      TRKCS143
232100                                                                  TRKCS143
232200/                                                                 TRKCS143
232300*----------------------------------------------------------------*TRKCS143
232400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *TRKCS143
232500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *TRKCS143
232600*----------------------------------------------------------------*TRKCS143
232700                                                                  TRKCS143
232800 5100-WRITE-TEMP-STORAGE.                                         TRKCS143
232900                                                                  TRKCS143
233000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     TRKCS143
233100                                   TO PV-LIST-ITEM-NUMBER.        TRKCS143
233200     COMPUTE PV-BLOCK-NUMBER =                                    TRKCS143
233300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    TRKCS143
233400                                                                  TRKCS143
233500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             TRKCS143
233600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             TRKCS143
233700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      TRKCS143
233800             PERFORM 5105-REWRITE-ASC-LISTQ                       TRKCS143
233900         END-IF                                                   TRKCS143
234000     ELSE                                                         TRKCS143
234100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       TRKCS143
234200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            TRKCS143
234300         PERFORM 5110-WRITE-ASC-LISTQ                             TRKCS143
234400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   TRKCS143
234500     END-IF.                                                      TRKCS143
234600                                                                  TRKCS143
234700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      TRKCS143
234800                                   TO TRUE.                       TRKCS143
234900                                                                  TRKCS143
235000/                                                                 TRKCS143
235100*----------------------------------------------------------------*TRKCS143
235200*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *TRKCS143
235300*  SPECIFIC COMMAREA.                                            *TRKCS143
235400*----------------------------------------------------------------*TRKCS143
235500 5105-REWRITE-ASC-LISTQ.                                          TRKCS143
235600                                                                  TRKCS143
235700     EXEC CICS                                                    TRKCS143
235800         WRITEQ TS                                                TRKCS143
235900             QUEUE (ASC-LIST-QUEUE-NAME)                          TRKCS143
236000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS143
236100             ITEM  (PV-BLOCK-NUMBER)                              TRKCS143
236200             REWRITE                                              TRKCS143
236300             RESP  (PV-CICS-RESP)                                 TRKCS143
236400     END-EXEC.                                                    TRKCS143
236500                                                                  TRKCS143
236600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           TRKCS143
236700         CONTINUE                                                 TRKCS143
236800     ELSE                                                         TRKCS143
236900         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
237000         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
237100         MOVE '5105-REWRITE-ASC-LISTQ'                            TRKCS143
237200                                   TO DP013-PARAGRAPH             TRKCS143
237300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     TRKCS143
237400                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
237500         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
237600     END-IF.                                                      TRKCS143
237700                                                                  TRKCS143
237800/                                                                 TRKCS143
237900*----------------------------------------------------------------*TRKCS143
238000*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *TRKCS143
238100*  SPECIFIC COMMAREA.                                            *TRKCS143
238200*----------------------------------------------------------------*TRKCS143
238300 5110-WRITE-ASC-LISTQ.                                            TRKCS143
238400                                                                  TRKCS143
238500     EXEC CICS                                                    TRKCS143
238600         WRITEQ TS                                                TRKCS143
238700             QUEUE (ASC-LIST-QUEUE-NAME)                          TRKCS143
238800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               TRKCS143
238900             ITEM  (PV-BLOCK-NUMBER)                              TRKCS143
239000             RESP  (PV-CICS-RESP)                                 TRKCS143
239100     END-EXEC.                                                    TRKCS143
239200                                                                  TRKCS143
239300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      TRKCS143
239400         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
239500         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
239600         MOVE '5110-WRITE-ASC-LISTQ'                              TRKCS143
239700                                   TO DP013-PARAGRAPH             TRKCS143
239800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           TRKCS143
239900                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
240000         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
240100     END-IF.                                                      TRKCS143
240200                                                                  TRKCS143
240300/                                                                 TRKCS143
240400*----------------------------------------------------------------*TRKCS143
240500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *TRKCS143
240600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *TRKCS143
240700*----------------------------------------------------------------*TRKCS143
240800                                                                  TRKCS143
240900 5200-FILL-SEL-QUEUE-RECORD.                                      TRKCS143
241000                                                                  TRKCS143
241100     PERFORM 6112-READ-LIST-QUEUE.                                TRKCS143
241200                                                                  TRKCS143
241300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       TRKCS143
241400         PERFORM                                                  TRKCS143
241500         VARYING LQW-IDX                                          TRKCS143
241600         FROM 1 BY 1                                              TRKCS143
241700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            TRKCS143
241800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          TRKCS143
241900                                                                  TRKCS143
242000             IF  LQW-SELECT (LQW-IDX)                             TRKCS143
242100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              TRKCS143
242200                                   TO TR015-ITEM (TR015-IDX)      TRKCS143
242300                 MOVE LQW-PRO-NBR (LQW-IDX)                       TRKCS143
242400                                   TO TR015-PRO-NBR (TR015-IDX)   TRKCS143
242500                 MOVE LQW-OWNER-SCAC-ID (LQW-IDX)                 TRKCS143
242600                                TO TR015-OWNER-SCAC-ID (TR015-IDX)TRKCS143
242700                 MOVE SPACE        TO TR015-ACTION-SW (TR015-IDX) TRKCS143
242800                 SET TR015-IDX UP BY 1                            TRKCS143
242900                 IF  TR015-IDX > TR015-MAX-ITEMS                  TRKCS143
243000                     PERFORM 5205-WRITE-SEL-QUEUE                 TRKCS143
243100                     ADD +1        TO TR014-NUMBER-OF-TS-ITEMS    TRKCS143
243200                     INITIALIZE TR015-SELECTED-ITEM-ARRAY         TRKCS143
243300                     SET TR015-IDX TO 1                           TRKCS143
243400                 END-IF                                           TRKCS143
243500             END-IF                                               TRKCS143
243600         END-PERFORM                                              TRKCS143
243700     END-IF.                                                      TRKCS143
243800                                                                  TRKCS143
243900/                                                                 TRKCS143
244000*----------------------------------------------------------------*TRKCS143
244100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *TRKCS143
244200*----------------------------------------------------------------*TRKCS143
244300                                                                  TRKCS143
244400 5205-WRITE-SEL-QUEUE.                                            TRKCS143
244500                                                                  TRKCS143
244600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            TRKCS143
244700                                   TO TR015-SELECTED-ITEMS.       TRKCS143
244800                                                                  TRKCS143
244900     EXEC CICS                                                    TRKCS143
245000          WRITEQ TS                                               TRKCS143
245100              QUEUE (ASC-SEL-QUEUE-NAME)                          TRKCS143
245200              FROM  (TR015-TS-SEL-REC)                            TRKCS143
245300              ITEM  (PV-SEL-QUEUE-ITEM)                           TRKCS143
245400              RESP  (PV-CICS-RESP)                                TRKCS143
245500     END-EXEC.                                                    TRKCS143
245600                                                                  TRKCS143
245700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          TRKCS143
245800         CONTINUE                                                 TRKCS143
245900     ELSE                                                         TRKCS143
246000         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
246100         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
246200         MOVE '5205-WRITE-SEL-QUEUE'                              TRKCS143
246300                                   TO DP013-PARAGRAPH             TRKCS143
246400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          TRKCS143
246500                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
246600         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
246700     END-IF.                                                      TRKCS143
246800                                                                  TRKCS143
246900/                                                                 TRKCS143
247000*----------------------------------------------------------------*TRKCS143
247100*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *TRKCS143
247200*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *TRKCS143
247300*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *TRKCS143
247400*  THE USER.                                                     *TRKCS143
247500*----------------------------------------------------------------*TRKCS143
247600 6000-REFRESH-PANEL-FROM-TEMP.                                    TRKCS143
247700                                                                  TRKCS143
247800     IF  ASC-UPDATE-TSQ                                           TRKCS143
247900         SET ASC-NO-TSQ-UPDATE     TO TRUE                        TRKCS143
248000         MOVE ZERO                 TO PV-SAVE-ITEM                TRKCS143
248100                                      PV-SEL-QUEUE-ITEM           TRKCS143
248200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        TRKCS143
248300                                   TO PV-HOLD-SELECTED-ITEMS      TRKCS143
248400         PERFORM 6100-UPDATE-TSQ                                  TRKCS143
248500             UNTIL PV-ITEMS-PROCESSED >                           TRKCS143
248600                                     ASC-NUMBER-OF-SELECTED-ITEMS TRKCS143
248700         PERFORM 6010-DELETE-SEL-QUEUE                            TRKCS143
248800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         TRKCS143
248900                    ASC-BLOCK-ENTRIES (2)                         TRKCS143
249000     END-IF.                                                      TRKCS143
249100                                                                  TRKCS143
249200/                                                                 TRKCS143
249300*----------------------------------------------------------------*TRKCS143
249400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *TRKCS143
249500*----------------------------------------------------------------*TRKCS143
249600 6010-DELETE-SEL-QUEUE.                                           TRKCS143
249700                                                                  TRKCS143
249800     EXEC CICS                                                    TRKCS143
249900         DELETEQ TS                                               TRKCS143
250000             QUEUE (ASC-SEL-QUEUE-NAME)                           TRKCS143
250100             RESP  (PV-CICS-RESP)                                 TRKCS143
250200     END-EXEC.                                                    TRKCS143
250300                                                                  TRKCS143
250400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      TRKCS143
250500         (PV-CICS-RESP = DFHRESP(QIDERR)))                        TRKCS143
250600         CONTINUE                                                 TRKCS143
250700     ELSE                                                         TRKCS143
250800         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
250900         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
251000         MOVE '6010-DELETE-SEL-QUEUE'                             TRKCS143
251100                                   TO DP013-PARAGRAPH             TRKCS143
251200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         TRKCS143
251300                                   TO DP013-MESSAGE-TEXT (1)      TRKCS143
251400         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
251500     END-IF.                                                      TRKCS143
251600                                                                  TRKCS143
251700/                                                                 TRKCS143
251800*----------------------------------------------------------------*TRKCS143
251900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *TRKCS143
252000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *TRKCS143
252100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *TRKCS143
252200*    THE TEMP QUEUE.                                             *TRKCS143
252300*----------------------------------------------------------------*TRKCS143
252400                                                                  TRKCS143
252500 6100-UPDATE-TSQ.                                                 TRKCS143
252600                                                                  TRKCS143
252700     ADD 1                         TO PV-SEL-QUEUE-ITEM.          TRKCS143
252800     PERFORM 6105-READ-SEL-QUEUE.                                 TRKCS143
252900                                                                  TRKCS143
253000     PERFORM                                                      TRKCS143
253100         VARYING TR015-IDX                                        TRKCS143
253200         FROM 1 BY 1                                              TRKCS143
253300         UNTIL ((PV-ITEMS-PROCESSED >                             TRKCS143
253400                              PV-HOLD-SELECTED-ITEMS)             TRKCS143
253500         OR (TR015-IDX GREATER THAN TR015-MAX-ITEMS))             TRKCS143
253600         IF  TR015-ACTION-SW (TR015-IDX) > SPACE                  TRKCS143
253700             PERFORM 6110-PROCESS-ITEMS                           TRKCS143
253800         END-IF                                                   TRKCS143
253900         ADD +1                    TO PV-ITEMS-PROCESSED          TRKCS143
254000     END-PERFORM.                                                 TRKCS143
254100                                                                  TRKCS143
254200     PERFORM 6111-WRITE-LIST-QUEUE.                               TRKCS143
254300                                                                  TRKCS143
254400/                                                                 TRKCS143
254500*----------------------------------------------------------------*TRKCS143
254600*    READ THE LIST QUEUE RECORD.                                 *TRKCS143
254700*----------------------------------------------------------------*TRKCS143
254800                                                                  TRKCS143
254900 6105-READ-SEL-QUEUE.                                             TRKCS143
255000                                                                  TRKCS143
255100     EXEC CICS                                                    TRKCS143
255200          READQ TS                                                TRKCS143
255300              QUEUE (ASC-SEL-QUEUE-NAME)                          TRKCS143
255400              INTO  (TR015-TS-SEL-REC)                            TRKCS143
255500              ITEM  (PV-SEL-QUEUE-ITEM)                           TRKCS143
255600              RESP  (PV-CICS-RESP)                                TRKCS143
255700     END-EXEC.                                                    TRKCS143
255800                                                                  TRKCS143
255900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          TRKCS143
256000         CONTINUE                                                 TRKCS143
256100     ELSE                                                         TRKCS143
256200         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
256300         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
256400         MOVE '6105-READ-SEL-QUEUE'                               TRKCS143
256500                                   TO DP013-PARAGRAPH             TRKCS143
256600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           TRKCS143
256700                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
256800         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
256900     END-IF.                                                      TRKCS143
257000                                                                  TRKCS143
257100/                                                                 TRKCS143
257200*----------------------------------------------------------------*TRKCS143
257300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*TRKCS143
257400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*TRKCS143
257500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *TRKCS143
257600*----------------------------------------------------------------*TRKCS143
257700                                                                  TRKCS143
257800 6110-PROCESS-ITEMS.                                              TRKCS143
257900                                                                  TRKCS143
258000     COMPUTE PV-ITEM = 1 + ((TR015-ITEM (TR015-IDX) - 1)          TRKCS143
258100                     / PC-ITEMS-PER-PANEL).                       TRKCS143
258200                                                                  TRKCS143
258300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           TRKCS143
258400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          TRKCS143
258500             PERFORM 6111-WRITE-LIST-QUEUE                        TRKCS143
258600         END-IF                                                   TRKCS143
258700         MOVE PV-ITEM              TO PV-SAVE-ITEM                TRKCS143
258800                                                                  TRKCS143
258900         PERFORM 6112-READ-LIST-QUEUE                             TRKCS143
259000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               TRKCS143
259100             CONTINUE                                             TRKCS143
259200         END-IF                                                   TRKCS143
259300     END-IF.                                                      TRKCS143
259400                                                                  TRKCS143
259500     COMPUTE PV-SUB = (TR015-ITEM (TR015-IDX)                     TRKCS143
259600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              TRKCS143
259700                                                                  TRKCS143
259800     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       TRKCS143
259900     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        TRKCS143
260000                                     (PV-SUB).                    TRKCS143
260100     EVALUATE TRUE                                                TRKCS143
260200         WHEN TR015-INQ (TR015-IDX)                               TRKCS143
260300              MOVE PC-INQ          TO LQW-ACTION (PV-SUB)         TRKCS143
260400                                                                  TRKCS143
260500         WHEN TR015-UPD (TR015-IDX)                               TRKCS143
260600              MOVE PC-UPD          TO LQW-ACTION (PV-SUB)         TRKCS143
260700                                                                  TRKCS143
260800         WHEN TR015-DEL (TR015-IDX)                               TRKCS143
260900              MOVE PC-DEL          TO LQW-ACTION (PV-SUB)         TRKCS143
261000                                                                  TRKCS143
261100         WHEN TR015-ERR (TR015-IDX)                               TRKCS143
261200              MOVE PC-ERR          TO LQW-ACTION (PV-SUB)         TRKCS143
261300     END-EVALUATE.                                                TRKCS143
261400                                                                  TRKCS143
261500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                TRKCS143
261600                                                                  TRKCS143
261700/                                                                 TRKCS143
261800*----------------------------------------------------------------*TRKCS143
261900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *TRKCS143
262000*----------------------------------------------------------------*TRKCS143
262100                                                                  TRKCS143
262200 6111-WRITE-LIST-QUEUE.                                           TRKCS143
262300                                                                  TRKCS143
262400     EXEC CICS                                                    TRKCS143
262500         WRITEQ TS                                                TRKCS143
262600             QUEUE (ASC-LIST-QUEUE-NAME)                          TRKCS143
262700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     TRKCS143
262800             ITEM  (PV-SAVE-ITEM)                                 TRKCS143
262900             REWRITE                                              TRKCS143
263000             RESP  (PV-CICS-RESP)                                 TRKCS143
263100     END-EXEC.                                                    TRKCS143
263200                                                                  TRKCS143
263300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          TRKCS143
263400         CONTINUE                                                 TRKCS143
263500     ELSE                                                         TRKCS143
263600         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
263700         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
263800         MOVE '6111-WRITE-LIST-QUEUE'                             TRKCS143
263900                                   TO DP013-PARAGRAPH             TRKCS143
264000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  TRKCS143
264100                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
264200         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
264300     END-IF.                                                      TRKCS143
264400                                                                  TRKCS143
264500/                                                                 TRKCS143
264600*----------------------------------------------------------------*TRKCS143
264700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*TRKCS143
264800*----------------------------------------------------------------*TRKCS143
264900                                                                  TRKCS143
265000 6112-READ-LIST-QUEUE.                                            TRKCS143
265100                                                                  TRKCS143
265200     EXEC CICS                                                    TRKCS143
265300         READQ TS                                                 TRKCS143
265400             QUEUE (ASC-LIST-QUEUE-NAME)                          TRKCS143
265500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     TRKCS143
265600             ITEM  (PV-ITEM)                                      TRKCS143
265700             RESP  (PV-CICS-RESP)                                 TRKCS143
265800     END-EXEC.                                                    TRKCS143
265900                                                                  TRKCS143
266000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          TRKCS143
266100         CONTINUE                                                 TRKCS143
266200     ELSE                                                         TRKCS143
266300         SET DP013-CICS-ABEND      TO TRUE                        TRKCS143
266400         SET DP013-NO-ROLLBACK     TO TRUE                        TRKCS143
266500         MOVE '6112-READ-LIST-QUEUE'                              TRKCS143
266600                                   TO DP013-PARAGRAPH             TRKCS143
266700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    TRKCS143
266800                                   TO DP013-MESSAGE-TEXT(1)       TRKCS143
266900         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS143
267000     END-IF.                                                      TRKCS143
267100                                                                  TRKCS143
267200/                                                                 TRKCS143
267300*----------------------------------------------------------------*TRKCS143
267400*    START TRANID FOR TRKCS141 (PRINT FREIGHT BILL RECEIVER LIST)*TRKCS143
267500*----------------------------------------------------------------*TRKCS143
267600 7000-FORMAT-COMMAREA.                                            TRKCS143
267700                                                                  TRKCS143
267800     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            TRKCS143
267900        MOVE 1                   TO PV-BLOCK-NUMBER               TRKCS143
268000     ELSE                                                         TRKCS143
268100        MOVE 2                   TO PV-BLOCK-NUMBER               TRKCS143
268200     END-IF.                                                      TRKCS143
268300                                                                  TRKCS143
268400     PERFORM VARYING PV-SUB FROM 1 BY 1                           TRKCS143
268500             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    TRKCS143
268600         IF ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'       TRKCS143
268700            MOVE ASC-OWNER-SCAC-ID(PV-BLOCK-NUMBER PV-SUB)        TRKCS143
268800                                 TO PV-CA-OWNER-SCAC-ID           TRKCS143
268900            MOVE ASC-PRO-NBR (PV-BLOCK-NUMBER PV-SUB)             TRKCS143
269000                                 TO PV-CA-PRO-NBR                 TRKCS143
269100            COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1               TRKCS143
269200         END-IF                                                   TRKCS143
269300     END-PERFORM.                                                 TRKCS143
269400                                                                  TRKCS143
269500     MOVE ASC-PRINTER-ID-X       TO PV-CA-PRINTER.                TRKCS143
269600                                                                  TRKCS143
269700/                                                                 TRKCS143
269800*----------------------------------------------------------------*TRKCS143
269900*    START TRANID FOR TRKCS141 (PRINT FREIGHT BILL RECEIVER LIST)*TRKCS143
270000*----------------------------------------------------------------*TRKCS143
270100 7100-START-TRANID-Y141.                                          TRKCS143
270200                                                                  TRKCS143
270300     EXEC CICS                                                    TRKCS143
270400          START TRANSID ('Y141')                                  TRKCS143
270500                FROM    (PV-TRKCS141-COMMAREA)                    TRKCS143
270600                LENGTH  (34)                                      TRKCS143
270700     END-EXEC.                                                    TRKCS143
270800                                                                  TRKCS143
270900/                                                                 TRKCS143
271000*----------------------------------------------------------------*TRKCS143
271100*    ABEND PROCESSOR MODULE                                      *TRKCS143
271200*----------------------------------------------------------------*TRKCS143
271300                                                                  TRKCS143
271400     COPY DPPD013.                                                TRKCS143
