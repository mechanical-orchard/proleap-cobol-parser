000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             ARKUT059.                                00050000
000600 AUTHOR.                 KATHY PRIESTER.                          00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           SEPTEMBER 2003.                          00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM CREATES THE VERIFICATION REPORTS FOR THE KOHLS    00120000
001300*  CHARGE EXTRACT FROM COSA.                                      00130000
001400******************************************************************00140000
002100******************************************************************00141000
P9696 *  02/17/2014 COGNIZANT                                          *00142000
P9696 *  CHANGED THE RECORD LENGTH OF INPUT AND OUTPUT FILE TO 311.    *00143000
P9696 *  SINCE THE COPYBOOK ARRD001 IS MODIFIED AND ADDED WITH         *00143100
P9696 *  ADDITIONAL FIELDS.                                            *00144000
P9696 ******************************************************************00145000
P1043 *  06/15/2015 ACCENTURE                                           00146000
P1043 *  CHG0118696                                                     00147000
P1043 *  ADDED BIN NUMBER FIELD IN A PROGRAM TO HANDLE 12 AS WELL AS 18*00148000
P1043 *  DIGIT ACCOUNT NUMBER.                                         *00149000
P9696 ******************************************************************00149100
CFEES *  02/08/2017 BARB SCHULTZ                                       *00149200
CFEES *  CHG0160001                                                    *00149300
CFEES *  INCREASED INPUT FILE TO 385, ADDED 1 TO THE FEE ITEM.         *00149400
001500******************************************************************00150000
SHIP  *  04/18/2019 BARB SCHULTZ                                       *00151000
SHIP  *  CHG0220426                                                    *00152000
SHIP  *  RECOMPILED THE PROGRAM TO BRING IN THE NEW FIELDS FOR SETTLE  *00153000
SHIP  *  BY SHIP.                                                      *00153100
001500******************************************************************00153200
071221*  07/12/2021 DAN PAYNTER                                        *00153400
071221*  CHG0257249                                                    *00153500
071221*  GENERATION OF AUTO-ADJUSTMENT FOR IMBALANCE BETWEEN SUMMARY OF*00153600
071221*  TRANSACTION DETAILS AND THE REPORTED TENDER AMOUNT.           *00153700
071221*  ARK01020 OOB TRANSACTIONS WILL BE AUTO ADJUSTED TO MATCH THE  *00153800
071221*  TENDER AMOUNT FIELD WITH A 'RCPT TO STMT SYS ADJ' ENTRY.      *00153900
071221******************************************************************00154000
050222*  03/01/2022 DAN PAYNTER                                        *00155000
050222*  CHG0268732                                                    *00156000
050222*  REMOVE REFERENCES TO GIFT CARD DEPT NUMBERS                   *00157000
050222******************************************************************00158000
001600 ENVIRONMENT DIVISION.                                            00160000
001700******************************************************************00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
002000                                                                  00200000
002100 SOURCE-COMPUTER.    IBM-3090.                                    00210000
002200 OBJECT-COMPUTER.    IBM-3090.                                    00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT POS-DATE-CARD-FILE                                    00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT AR-TRANSACTION-FILE                                   00310000
003200         ASSIGN TO INP02.                                         00320000
003300                                                                  00330000
003400     SELECT CHARGE-DETAIL-RPT-FILE                                00340000
003500         ASSIGN TO RPT01.                                         00350000
003600                                                                  00360000
003700     SELECT AUDIT-RPT-FILE                                        00370000
003800         ASSIGN TO RPT02.                                         00380000
003900                                                                  00390000
004000     SELECT STORE-TOTALS-RPT-FILE                                 00400000
004100         ASSIGN TO RPT03.                                         00410000
004200                                                                  00420000
004300     SELECT OUT-OF-BAL-RPT-FILE                                   00430000
004400         ASSIGN TO RPT04.                                         00440000
004500                                                                  00450000
004600     SELECT ACCOUNTS-RECEIVABLE-FILE                              00460000
004700         ASSIGN TO OUT01.                                         00470000
004800                                                                  00480000
004900******************************************************************00490000
005000 DATA DIVISION.                                                   00500000
005100******************************************************************00510000
005200                                                                  00520000
005300 FILE SECTION.                                                    00530000
005400                                                                  00540000
005500 FD  POS-DATE-CARD-FILE                                           00550000
005600     RECORDING MODE IS F                                          00560000
005700     BLOCK CONTAINS 0 RECORDS                                     00570000
005800     LABEL RECORDS ARE STANDARD.                                  00580000
005900                                                                  00590000
006000 01  POS-DATE-CARD-RECORD            PIC X(80).                   00600000
006100                                                                  00610000
006200 FD  AR-TRANSACTION-FILE                                          00620000
006300     RECORDING MODE IS F                                          00630000
006400     LABEL RECORDS ARE STANDARD                                   00640000
006500     BLOCK CONTAINS 0 RECORDS                                     00650000
CFEES      RECORD CONTAINS 385 CHARACTERS                               00660000
006700     DATA RECORD IS AR-TRANSACTION-RECORD.                        00670000
006800                                                                  00680000
CFEES  01  AR-TRANSACTION-RECORD           PIC X(385).                  00690000
007000                                                                  00700000
007100 FD  CHARGE-DETAIL-RPT-FILE                                       00710000
007200     RECORDING MODE IS F                                          00720000
007300     LABEL RECORDS ARE STANDARD                                   00730000
007400     BLOCK CONTAINS 0 RECORDS                                     00740000
007500     RECORD CONTAINS 132 CHARACTERS                               00750000
007600     DATA RECORD IS CD-CHARGE-DETAIL-RPT-RECORD.                  00760000
007700                                                                  00770000
007800 01  CD-CHARGE-DETAIL-RPT-RECORD     PIC X(132).                  00780000
007900                                                                  00790000
008000 FD  AUDIT-RPT-FILE                                               00800000
008100     RECORDING MODE IS F                                          00810000
008200     LABEL RECORDS ARE STANDARD                                   00820000
008300     BLOCK CONTAINS 0 RECORDS                                     00830000
008400     RECORD CONTAINS 132 CHARACTERS                               00840000
008500     DATA RECORD IS AR-AUDIT-RPT-RECORD.                          00850000
008600                                                                  00860000
008700 01  AR-AUDIT-RPT-RECORD             PIC X(132).                  00870000
008800                                                                  00880000
008900 FD  STORE-TOTALS-RPT-FILE                                        00890000
009000     RECORDING MODE IS F                                          00900000
009100     LABEL RECORDS ARE STANDARD                                   00910000
009200     BLOCK CONTAINS 0 RECORDS                                     00920000
009300     RECORD CONTAINS 132 CHARACTERS                               00930000
009400     DATA RECORD IS ST-STORE-TOTALS-RPT-RECORD.                   00940000
009500                                                                  00950000
009600 01  ST-STORE-TOTALS-RPT-RECORD      PIC X(132).                  00960000
009700                                                                  00970000
009800 FD  OUT-OF-BAL-RPT-FILE                                          00980000
009900     RECORDING MODE IS F                                          00990000
010000     LABEL RECORDS ARE STANDARD                                   01000000
010100     BLOCK CONTAINS 0 RECORDS                                     01010000
010200     RECORD CONTAINS 132 CHARACTERS                               01020000
010300     DATA RECORD IS OUT-OF-BAL-RPT-RECORD.                        01030000
010400                                                                  01040000
010500 01  OUT-OF-BAL-RPT-RECORD           PIC X(132).                  01050000
010600                                                                  01060000
010700 FD  ACCOUNTS-RECEIVABLE-FILE                                     01070000
010800     RECORDING MODE IS F                                          01080000
010900     LABEL RECORDS ARE STANDARD                                   01090000
011000     BLOCK CONTAINS 0 RECORDS                                     01100000
CFEES      RECORD CONTAINS 385 CHARACTERS                               01110000
011200     DATA RECORD IS AR-ACCOUNTS-RECEIVABLE-RECORD.                01120000
011300                                                                  01130000
CFEES  01  AR-ACCOUNTS-RECEIVABLE-RECORD   PIC X(385).                  01140000
011500                                                                  01150000
011600 WORKING-STORAGE SECTION.                                         01160000
011700                                                                  01170000
011800******************************************************************01180000
011900* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    01190000
012000******************************************************************01200000
012100 01  CC-CONTROL-CARD.                                             01210000
012200     05  CC-CONTROL-CARD-DISPLAY.                                 01220000
012300         10  CC-CONTROL-NAME     PIC X(14)    VALUE               01230000
012400                                              'P.O.S. DATE = '.   01240000
012500         10  CC-POS-DATE-MMDDYY.                                  01250000
012600             15  CC-POS-DATE-MM  PIC 9(2)     VALUE ZERO.         01260000
012700             15  CC-POS-DATE-DD  PIC 9(2)     VALUE ZERO.         01270000
012800             15  CC-POS-DATE-YY  PIC 9(2)     VALUE ZERO.         01280000
012900     05  FILLER                  PIC X(60)    VALUE SPACE.        01290000
013000                                                                  01300000
013100 01  PV-POS-CCYY-MM-DD.                                           01310000
013200     05  PV-POS-CC               PIC X(02).                       01320000
013300     05  PV-POS-YY               PIC X(02).                       01330000
013400     05  FILLER                  PIC X(01).                       01340000
013500     05  PV-POS-MM               PIC X(02).                       01350000
013600     05  FILLER                  PIC X(01).                       01360000
013700     05  PV-POS-DD               PIC X(02).                       01370000
013800                                                                  01380000
013900 01  PV-RUN-DATE-MMDDYY.                                          01390000
014000     05  PV-RUN-DATE-MM          PIC X(02)    VALUE SPACE.        01400000
014100     05  FILLER                  PIC X(01)    VALUE '/'.          01410000
014200     05  PV-RUN-DATE-DD          PIC X(02)    VALUE SPACE.        01420000
014300     05  FILLER                  PIC X(01)    VALUE '/'.          01430000
014400     05  PV-RUN-DATE-YY          PIC X(02)    VALUE SPACE.        01440000
014500                                                                  01450000
014600 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01460000
014700                                                  COMP SYNC.      01470000
014800     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01480000
014900     88  AC-DB2-ERROR                             VALUE +4013.    01490000
015000                                                                  01500000
015100 01  ABEND-CODE                  PIC S9(4)    VALUE ZERO          01510000
015200                                 COMP SYNC.                       01520000
015300                                                                  01530000
015400 01  PS-PROGRAM-SWITCHES.                                         01540000
015500     05  PS-END-OF-TRANS-FILE-SW       PIC X(01)  VALUE 'N'.      01550000
015600         88  PS-END-OF-TRANS-FILE                 VALUE 'Y'.      01560000
015700         88  PS-NOT-END-OF-TRANS-FILE             VALUE 'N'.      01570000
015800     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      01580000
015900         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01590000
016000         88  PS-NOT-END-OF-CARD-FILE              VALUE 'N'.      01600000
016100     05  PS-PAYMENT-SW                 PIC X(01)  VALUE 'N'.      01610000
016200         88  PS-PAYMENT-YES                       VALUE 'Y'.      01620000
016300         88  PS-PAYMENT-NO                        VALUE 'N'.      01630000
071221     05  PS-AR-OOB-TRAN-SW             PIC X(01)  VALUE 'N'.      01631000
071221         88  PS-AR-OOB-TRAN-YES                   VALUE 'Y'.      01632000
071221         88  PS-AR-OOB-TRAN-NO                    VALUE 'N'.      01633000
071221     05  PS-AR-OOB-TRAN-ADJSTD-WS      PIC X(01)  VALUE 'N'.      01634000
071221         88  PS-AR-OOB-TRAN-ADJSTD-YES            VALUE 'Y'.      01635000
071221         88  PS-AR-OOB-TRAN-ADJSTD-NO             VALUE 'N'.      01636000
071221     05  PS-AR-TRAN-KEY-STORED-SW      PIC X(01)  VALUE 'N'.      01637000
071221         88  PS-AR-TRAN-KEY-STORED-YES            VALUE 'Y'.      01638000
071221         88  PS-AR-TRAN-KEY-STORED-NO             VALUE 'N'.      01639000
016400                                                                  01640000
016500 01  PC-PROGRAM-CONSTANTS.                                        01650000
016600     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'ARKUT059'.   01660000
016700     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +63           01671000
016800                                 COMP SYNC.                       01680000
016900     05  PC-TOTAL-TYPE-FINAL     PIC X(4)     VALUE '****'.       01690000
017000     05  PC-TOTAL-TYPE-STORE     PIC X(4)     VALUE '*** '.       01700000
017100     05  PC-TOTAL-TYPE-REGISTER  PIC X(4)     VALUE '**  '.       01710000
017200     05  PC-TOTAL-TYPE-TRANSACTION                                01720000
017300                                 PIC X(4)     VALUE '*   '.       01730000
017400     05  PC-POS-USERID           PIC X(7)     VALUE 'P.O.S. '.    01740000
017500     05  PC-MAINT-USERID         PIC X(7)     VALUE 'S.A.   '.    01750000
017800     05  PC-PAYMENT-TRAN-TYPE-CDE                                 01780000
017900                                 PIC X(02)    VALUE '30'.         01790000
018000     05  PC-KEYED-SRC-CDE        PIC X(02)    VALUE '00'.         01800000
071221     05  PC-MAX-CREDIT-ADJ       PIC S9(9)    VALUE +9999999.     01801000
018100                                                                  01810000
018200 01  PV-PROGRAM-VARIABLES.                                        01820000
018300     05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACE.        01830000
018400     05  PV-DB2-OPERATION        PIC X(40)    VALUE SPACE.        01840000
018500     05  PV-OPERATION-MSG-1      PIC X(40)    VALUE SPACE.        01850000
018600     05  PV-OPERATION-MSG-2      PIC X(40)    VALUE SPACE.        01860000
018700     05  PV-PAGE-COUNT-RPT1      PIC S9(5)    VALUE ZERO          01870000
018800                                 COMP-3.                          01880000
018900     05  PV-PAGE-COUNT-RPT2      PIC S9(5)    VALUE ZERO          01890000
019000                                 COMP-3.                          01900000
019100     05  PV-PAGE-COUNT-RPT3      PIC S9(5)    VALUE ZERO          01910000
019200                                 COMP-3.                          01920000
019300     05  PV-PAGE-COUNT-RPT4      PIC S9(5)    VALUE ZERO          01930000
019400                                 COMP-3.                          01940000
019500     05  PV-LINE-COUNT-RPT1      PIC S9(4)    VALUE +64           01950000
019600                                 COMP SYNC.                       01960000
019700     05  PV-LINE-COUNT-RPT2      PIC S9(4)    VALUE +64           01970000
019800                                 COMP SYNC.                       01980000
019900     05  PV-LINE-COUNT-RPT3      PIC S9(4)    VALUE +64           01990000
020000                                 COMP SYNC.                       02000000
020100     05  PV-LINE-COUNT-RPT4      PIC S9(4)    VALUE +64           02010000
020200                                 COMP SYNC.                       02020000
020300     05  PV-ADVANCE-COUNT-RPT1   PIC S9(4)    VALUE ZERO          02030000
020400                                 COMP SYNC.                       02040000
020500         88  PV-SINGLE-SPACE-RPT1             VALUE +1.           02050000
020600         88  PV-DOUBLE-SPACE-RPT1             VALUE +2.           02060000
020700         88  PV-TRIPLE-SPACE-RPT1             VALUE +3.           02070000
020800     05  PV-ADVANCE-COUNT-RPT2   PIC S9(4)    VALUE ZERO          02080000
020900                                 COMP SYNC.                       02090000
021000         88  PV-SINGLE-SPACE-RPT2             VALUE +1.           02100000
021100         88  PV-DOUBLE-SPACE-RPT2             VALUE +2.           02110000
021200         88  PV-TRIPLE-SPACE-RPT2             VALUE +3.           02120000
021300         88  PV-QUADRUPLE-SPACE-RPT2          VALUE +4.           02130000
021400     05  PV-ADVANCE-COUNT-RPT3   PIC S9(4)    VALUE ZERO          02140000
021500                                 COMP SYNC.                       02150000
021600         88  PV-SINGLE-SPACE-RPT3             VALUE +1.           02160000
021700         88  PV-DOUBLE-SPACE-RPT3             VALUE +2.           02170000
021800         88  PV-TRIPLE-SPACE-RPT3             VALUE +3.           02180000
021900     05  PV-WORK-AMOUNT          PIC S9(7)V99 VALUE ZERO          02190000
022000                                 COMP-3.                          02200000
022100     05  PV-NEW-FRONT-RPT1       PIC X(2)     VALUE SPACES.       02210000
022200     05  PV-NEW-FRONT-RPT2       PIC X(2)     VALUE SPACES.       02220000
022300     05  PV-NEW-FRONT-RPT3       PIC X(2)     VALUE SPACES.       02230000
022400     05  PV-NEW-FRONT-RPT4       PIC X(2)     VALUE SPACES.       02240000
022500     05  PV-SAVE-STR-NBR         PIC  9(04)   VALUE ZERO.         02250000
022600     05  PV-SAVE-RGST-ID         PIC  9(04)   VALUE ZERO.         02260000
022700     05  PV-SAVE-TRN-NBR         PIC  9(04)   VALUE ZERO.         02270000
022800     05  PV-SAVE-LEVEL-OF-ISSUE  PIC  X(02)   VALUE SPACE.        02280000
022900     05  PV-SAVE-AUTH-NUMBER     PIC  X(06)   VALUE SPACE.        02290000
023000     05  PV-SAVE-STRT-TM         PIC  X(08)   VALUE SPACE.        02300000
023100     05  PV-SAVE-ASSOC-ID        PIC S9(09)   COMP VALUE ZERO.    02310000
023200     05  PV-SAVE-SLS-CORR-SEQ-NBR                                 02320000
023300                                 PIC  S9(4)   COMP VALUE ZERO.    02330000
023400     05  PV-SAVE-TNDR-SEQ-NBR    PIC  S9(4)   COMP VALUE ZERO.    02340000
023500     05  PV-SAVE-PARTN-NBR       PIC  S9(4)   COMP VALUE ZERO.    02350000
EMPCSH     05  PV-SAVE-PAYMENT-IND     PIC  X(01)   VALUE SPACE.        02351000
EMPCSH     05  PV-SAVE-TRAN-SOURCE     PIC  X(01)   VALUE SPACE.        02352000
023600     05  PV-STR-NBR              PIC  9(04)   VALUE ZERO.         02360000
023700     05  PV-RGST-ID              PIC  9(04)   VALUE ZERO.         02370000
023800     05  PV-TRN-NBR              PIC  9(04)   VALUE ZERO.         02380000
023900     05  PV-STRT-TM              PIC  X(08)   VALUE SPACE.        02390000
024000     05  PV-SLS-CORR-SEQ-NBR     PIC  S9(4)   COMP VALUE ZERO.    02400000
024100     05  PV-TNDR-SEQ-NBR         PIC  S9(4)   COMP VALUE ZERO.    02410000
024200     05  PV-PARTN-NBR            PIC  S9(4)   COMP VALUE ZERO.    02420000
024300     05  PV-SAVE-DATE            PIC  X(08)   VALUE '00/00/00'.   02430000
024400     05  PV-VAR-AMT              PIC S9(9)V9(2) COMP-3 VALUE ZERO.02440000
024500     05  PV-TNDR-AMT             PIC S9(7)V9(2) COMP-3 VALUE ZERO.02450000
024600     05  PV-LINE-NUMBER          PIC S9(3)    VALUE ZERO.         02460000
024700     05  PV-PRINT-RECORD         PIC  X(132)  VALUE SPACES.       02470000
024800                                                                  02480000
071221 01  AR-INHERIT-VARIABLES.                                        02480100
071221     05  AV-TRANSACTION-SOURCE     PIC X(1) VALUE SPACE.          02480200
071221     05  AV-ACCOUNT-NUMBER         PIC 9(12) VALUE ZERO.          02480300
071221     05  AV-TRANSACTION-CODE       PIC X(3) VALUE SPACES.         02480400
071221     05  AV-TRANSACTION-DATE       PIC 9(6) VALUE ZERO.           02480500
071221     05  AV-STORE-NUMBER           PIC X(4) VALUE SPACES.         02480600
071221     05  AV-TERMINAL-NUMBER        PIC X(4) VALUE SPACES.         02480700
071221     05  AV-TRANSACTION-NUMBER     PIC X(4) VALUE SPACES.         02480800
071221     05  AV-TRN-STAT-CDE           PIC X(1) VALUE SPACE.          02480900
071221     05  AV-SUBMITTED-BY-USERID    PIC X(7) VALUE SPACE.          02481000
071221     05  AV-AUTH-NUMBER            PIC X(6) VALUE SPACES.         02481100
071221     05  AV-REG-OPERATOR-ID        PIC 9(9) VALUE ZEROES.         02481200
071221     05  AV-PARTITION-NUMBER       PIC S9(04) COMP VALUE ZEROES.  02481300
071221     05  AV-START-TIME             PIC X(08) VALUE SPACE.         02481400
071221     05  AV-SLS-CORR-SEQ-NUM       PIC S9(04) COMP VALUE ZEROS.   02481500
071221     05  AV-SHIP-ADDR-ZIP          PIC X(05) VALUE SPACES.        02481600
071221     05  AV-SHIP-GEO-CODE          PIC X(02) VALUE SPACES.        02481700
071221     05  AV-ORD-NBR                PIC X(40) VALUE SPACES.        02481800
071221     05  AV-ORDER-DATE-CCYY        PIC X(04) VALUE SPACES.        02481900
071221     05  AV-ORDER-DATE-MM          PIC X(02) VALUE SPACES.        02482000
071221     05  AV-ORDER-DATE-DD          PIC X(02) VALUE SPACES.        02482100
071221     05  AV-POS-CPBL-LVL-NBR       PIC S9(04) COMP VALUE ZEROS.   02482200
071221     05  AV-TRN-DTE                PIC X(06) VALUE SPACES.        02482300
071221     05  AV-ORG-STR-NBR            PIC 9(04) VALUE ZEROES.        02482400
071221     05  AV-OMNI-CHL-FLMT-IND      PIC X(03) VALUE SPACES.        02482500
071221     05  AV-AUTH-REF-NBR           PIC X(45) VALUE SPACES.        02482600
071221     05  AV-TNDR-SEQ-NBR           PIC S9(04) COMP VALUE ZEROS.   02482700
071221     05  AV-SCANNED-KEYED-IND      PIC X(1) VALUE SPACE.          02482800
071221     05  AV-CRS-EMPLOYEE-CODE      PIC X(1) VALUE SPACE.          02482900
071221     05  AV-LNE-ITM-SEQ-NBR        PIC S9(04) COMP VALUE ZEROS.   02483000
071221     05  AV-LINE-NUMBER            PIC X(3).                      02483100
071221     05  FILLER  REDEFINES  AV-LINE-NUMBER.                       02483200
071221         10  AV-LINE-NUMBER-9      PIC 9(03).                     02483300
071221                                                                  02483400
071221 01  AR-TRANKEY-VARIABLES.                                        02483500
071221     05  AV-PARTN-NBR              PIC S9(4) USAGE COMP.          02483600
071221     05  AV-STR-NBR                PIC S9(4) USAGE COMP.          02483700
071221     05  AV-RGST-ID                PIC S9(4) USAGE COMP.          02483800
071221     05  AV-TRN-NBR                PIC S9(4) USAGE COMP.          02483900
071221     05  AV-STRT-TM                PIC X(8).                      02484000
071221     05  AV-SLS-CORR-SEQ-NBR       PIC S9(4) USAGE COMP.          02484100
071221     05  AV-TNDR-AMT               PIC S9(7)V9(2) COMP-3          02484200
071221                                   VALUE ZEROES.                  02484300
071221     05  AV-TRANSACTION-AMT        PIC S9(9)V9(2) COMP-3          02484400
071221                                   VALUE ZEROES.                  02484500
071221     05  AV-VAR-AMT                PIC S9(7)V9(2) COMP-3          02484600
071221                                   VALUE ZEROES.                  02489500
071221                                                                  02489600
071221 01  AR-DISPLAY-VARIABLES.                                        02489700
071221     05  AV-DISP-PARTN-NBR         PIC 9(3).                      02489800
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02489900
071221     05  AV-DISP-STR-NBR           PIC 9(4).                      02490000
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02490100
071221     05  AV-DISP-RGST-ID           PIC 9(2).                      02490200
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02490300
071221     05  AV-DISP-TRN-NBR           PIC 9(4).                      02490400
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02490500
071221     05  AV-DISP-STRT-TM           PIC X(8).                      02490600
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02490700
071221     05  AV-DISP-SLS-CORR-SEQ-NBR  PIC 9(2).                      02490800
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02490900
071221     05  AV-DISP-TNDR-AMT          PIC -(9).99.                   02491000
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02491100
071221     05  AV-DISP-TRANSACTION-AMT   PIC -(9).99.                   02491200
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02491300
071221     05  AV-DISP-VAR-AMT           PIC -(9).99.                   02491400
071221     05  FILLER                    PIC X(1) VALUE SPACE.          02491500
071221     05  AV-PARAGRAPH              PIC X(15).                     02491600
071221                                                                  02491700
071221 01  AV-ARRAY-VARIABLES.                                          02491800
071221     05  AV-MSG-IDX-TOT            PIC S9(04)  VALUE ZEROS        02491900
071221                                               COMP SYNC.         02492000
071221     05  AR-TIME-HHMM              PIC 9(04)    VALUE ZERO.       02492100
071221     05  FILLER  REDEFINES  AR-TIME-HHMM.                         02492200
071221         10  AR-TIME-HH            PIC 9(02).                     02492300
071221         10  AR-TIME-MM            PIC 9(02).                     02492400
071221     05  AR-LINE-NUMBER            PIC 9(3) VALUE ZERO.           02492500
071221                                                                  02492600
071221 01  AR-VARIABLES.                                                02492700
071221     05  AR-SAVE-AR-TRANSACTION-RECORD PIC X(385) VALUE SPACES.   02492800
071221     05  AR-SAVE-AR-CURR-TRAN-RECORD PIC X(385) VALUE SPACES.     02492900
071221     05  AR-TRAN-COUNT             PIC S9(9) COMP-3 VALUE ZEROES. 02493000
071221     05  AR-BACKUP-STORE           PIC X(4) VALUE SPACES.         02493200
071221     05  AR-BACKUP-ORG-STR         PIC 9(4) VALUE ZEROES.         02493300
071221     05  AR-BACKUP-ACCOUNT-NBR     PIC 9(12) VALUE ZEROES.        02493400
071221                                                                  02493500
071221 01  AR-OUTPUT-ARRAY.                                             02493600
071221     05  AR-OUTPUT-LINE            OCCURS 5000 TIMES              02493700
071221                                   INDEXED BY AR-MSG-IDX          02493800
071221                                   PIC  X(385).                   02493900
024900 01  PA-PROGRAM-ACCUMULATORS.                                     02494000
025000     05  PA-TRANSACTION-COUNT            PIC S9(9)      COMP-3    02500000
025100                                             VALUE ZERO.          02510000
025200     05  PA-TRANSACTION-AMOUNT           PIC S9(9)V9(2) COMP-3    02520000
025300                                             VALUE ZERO.          02530000
025400     05  PA-TRANSACTION-PAYMENTS-AMOUNT  PIC S9(9)V9(2) COMP-3    02540000
025500                                             VALUE ZERO.          02550000
025600     05  PA-REGISTER-SALES-AMOUNT        PIC S9(9)V9(2) COMP-3    02560000
025700                                             VALUE ZERO.          02570000
025800     05  PA-REGISTER-RETURNS-AMOUNT      PIC S9(9)V9(2) COMP-3    02580000
025900                                             VALUE ZERO.          02590000
026000     05  PA-REGISTER-PAYMENTS-AMOUNT     PIC S9(9)V9(2) COMP-3    02600000
026100                                             VALUE ZERO.          02610000
026200     05  PA-STORE-SALES-AMOUNT           PIC S9(9)V9(2) COMP-3    02620000
026300                                             VALUE ZERO.          02630000
026400     05  PA-STORE-RETURNS-AMOUNT         PIC S9(9)V9(2) COMP-3    02640000
026500                                             VALUE ZERO.          02650000
026600     05  PA-STORE-PAYMENTS-AMOUNT        PIC S9(9)V9(2) COMP-3    02660000
026700                                             VALUE ZERO.          02670000
026800     05  PA-CORP-SALES-AMOUNT            PIC S9(9)V9(2) COMP-3    02680000
026900                                             VALUE ZERO.          02690000
027000     05  PA-CORP-RETURNS-AMOUNT          PIC S9(9)V9(2) COMP-3    02700000
027100                                             VALUE ZERO.          02710000
027200     05  PA-CORP-PAYMENTS-AMOUNT         PIC S9(9)V9(2) COMP-3    02720000
027300                                             VALUE ZERO.          02730000
027400 01  CD-CURRENT-DATE.                                             02740000
027500     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         02750000
027600     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         02760000
027700     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         02770000
027800                                                                  02780000
027900 01  CT-CURRENT-TIME.                                             02790000
028000     05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.         02800000
028100     05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.         02810000
028200     05  FILLER                  PIC 9(4)     VALUE ZERO.         02820000
028300                                                                  02830000
028400 01  FA-FORMATTED-ACCOUNT-NUMBER.                                 02840000
P1043      05  FA-BIN-NUMBER           PIC X(6)     VALUE SPACES.       02841000
028500     05  FA-ACCOUNT-NUMBER-1-3   PIC X(3)     VALUE SPACES.       02850000
028700     05  FA-ACCOUNT-NUMBER-4-7   PIC X(4)     VALUE SPACES.       02870000
028900     05  FA-ACCOUNT-NUMBER-8-10  PIC X(3)     VALUE SPACES.       02890000
029000                                                                  02900000
029100 01  TI1-TOTAL-IDENTIFIERS-RPT-1.                                 02910000
029200     05  TI1-TRANSACTION-ID.                                      02920000
029300         10  FILLER              PIC X(23)    VALUE               02930000
029400             '  TRANSACTION TOTAL    '.                           02940000
029500     05  TI1-REGISTER-ID.                                         02950000
029600         10  FILLER              PIC X(9)                         02960000
029600                                 VALUE 'REGISTER '.               02961000
029700         10  TI1-REGISTER-NUMBER PIC X(4).                        02970000
029800         10  FILLER              PIC X(10)    VALUE ' TOTAL    '. 02980000
029900     05  TI1-STORE-ID.                                            02990000
030000         10  FILLER              PIC X(9)                         03000000
030000                                 VALUE '   STORE '.               03001000
030100         10  TI1-STORE-NUMBER    PIC X(4).                        03010000
030200         10  FILLER              PIC X(10)     VALUE ' TOTAL    '.03020000
030300     05  TI1-FINAL-ID.                                            03030000
030400         10  FILLER              PIC X(20)    VALUE               03040000
030500             '        FINAL TOTAL '.                              03050000
030600                                                                  03060000
030700 01  HL2-HEADING-LINE-2-RPT-1.                                    03070000
030800     05  HL2-STORE-NMBR          PIC X(04)    VALUE '0000'.       03080000
030900     05  FILLER                  PIC X(37)    VALUE SPACES.       03090000
031000     05  FILLER                  PIC X(43)    VALUE               03100000
031100         'DETAIL LISTING OF KOHLS CHARGE BATCHES FOR '.           03110000
031200     05  HL2-POS-DATE-1          PIC 99/99/99 VALUE ZERO.         03120000
031300     05  FILLER                  PIC X(40)    VALUE SPACES.       03130000
031400                                                                  03140000
031500 01  HL3-HEADING-LINE-3-RPT-1.                                    03150000
031600     05  FILLER                  PIC X(10)    VALUE 'STORE'.      03160000
031700     05  FILLER                  PIC X(10)    VALUE 'TERM'.       03170000
031800     05  FILLER                  PIC X(12)    VALUE 'TRANS'.      03180000
031900     05  FILLER                  PIC X(09)    VALUE 'LINE'.       03190000
032000     05  FILLER                  PIC X(10)    VALUE 'OPERATOR'.   03200000
032100     05  FILLER                  PIC X(6)     VALUE 'TRANS'.      03210000
032200     05  FILLER                  PIC X(10)    VALUE 'EMPLOYEE'.   03220000
032300     05  FILLER                  PIC X(14)   VALUE 'ACCOUNT'.     03230000
032400     05  FILLER                  PIC X(6)    VALUE 'LEVEL'.       03240000
032500     05  FILLER                  PIC X(45)    VALUE 'DEPT-'.      03250000
032600                                                                  03260000
032700 01  HL4-HEADING-LINE-4-RPT-1.                                    03270000
032800     05  FILLER                  PIC X(9)     VALUE 'NUMBER'.     03280000
032900     05  FILLER                  PIC X(11)    VALUE 'NUMBER'.     03290000
033000     05  FILLER                  PIC X(11)    VALUE 'NUMBER'.     03300000
033100     05  FILLER                  PIC X(13)    VALUE 'NUMBER'.     03310000
033200     05  FILLER                  PIC X(7)     VALUE 'ID'.         03320000
033300     05  FILLER                  PIC X(8)     VALUE 'CODE'.       03330000
033400     05  FILLER                  PIC X(9)     VALUE 'CODE'.       03340000
033500     05  FILLER                  PIC X(13)   VALUE 'NUMBER'.      03350000
033600     05  FILLER                  PIC X(6)    VALUE 'ISSUE'.       03360000
033700     05  FILLER                  PIC X(9)     VALUE 'CLASS'.      03370000
033800     05  FILLER                  PIC X(6)     VALUE 'QTY'.        03380000
033900     05  FILLER                  PIC X(19)    VALUE               03390000
034000         'SALE/RETURN'.                                           03400000
034100     05  FILLER                  PIC X(13)   VALUE 'PAYMENT'.     03410000
034200                                                                  03420000
034300 01  DL1-DETAIL-LINE-RPT-1.                                       03430000
034400     05  FILLER                  PIC X(1)     VALUE SPACES.       03440000
034500     05  DL1-STORE-NUMBER        PIC X(4)     VALUE SPACES.       03450000
034600     05  FILLER                  PIC X(5)     VALUE SPACES.       03460000
034700     05  DL1-REGISTER-NUMBER     PIC X(4)     VALUE SPACES.       03470000
034800     05  FILLER                  PIC X(7)     VALUE SPACES.       03480000
034900     05  DL1-TRANSACTION-NUMBER  PIC X(4)     VALUE SPACES.       03490000
035000     05  FILLER                  PIC X(8)     VALUE SPACES.       03500000
035100     05  DL1-LINE-NUMBER         PIC X(3)     VALUE SPACES.       03510000
035200     05  FILLER                  PIC X(4)     VALUE SPACES.       03520000
035300     05  DL1-ASSOC-ID            PIC 9(9)     VALUE ZERO.         03530000
035400     05  FILLER                  PIC X(3)     VALUE SPACES.       03540000
035500     05  DL1-TRANSACTION-CODE    PIC X(3)     VALUE SPACES.       03550000
035600     05  FILLER                  PIC X(6)     VALUE SPACES.       03560000
035700     05  DL1-EMPLOYEE-CODE       PIC X(1)     VALUE SPACES.       03570000
035800     05  FILLER                  PIC X(3)     VALUE SPACES.       03580000
035900     05  DL1-ACCOUNT-NUMBER      PIC X(16)    VALUE SPACES.       03590000
036000     05  FILLER                  PIC X(1)     VALUE SPACES.       03600000
036100     05  DL1-LEVEL-OF-ISSUE      PIC X(2)     VALUE SPACES.       03610000
036200     05  FILLER                  PIC X(3)     VALUE SPACES.       03620000
036300     05  DL1-DEPARTMENT-CLASS    PIC X(6)     VALUE SPACES.       03630000
036400         88  DL1-SALES-TAX-ITEM               VALUE 'TAX   '.     03640000
036500         88  DL1-OTHER-TENDER                 VALUE 'TND   '.     03650000
036600     05  FILLER                  REDEFINES DL1-DEPARTMENT-CLASS.  03660000
036700         10  DL1-DEPARTMENT      PIC X(3).                        03670000
036800         10  DL1-DEPARTMENT-CLASS-DASH                            03680000
036900                                 PIC X(1).                        03690000
037000         10  DL1-CLASS           PIC X(2).                        03700000
037100     05  FILLER                  PIC X(3)     VALUE SPACES.       03710000
037200     05  DL1-QUANTITY-X          PIC X(2)     VALUE SPACES.       03720000
037300     05  DL1-QUANTITY            REDEFINES DL1-QUANTITY-X         03730000
037400                                 PIC 9(2).                        03740000
037500*    05  FILLER                  PIC X(2)     VALUE SPACES.       03750000
037600     05  DL1-SALES-AMOUNT        PIC Z,ZZZ,ZZZ.99-                03760000
037700                                              VALUE ZERO.         03770000
037800     05  FILLER                  PIC X(2)     VALUE SPACES.       03780000
037900     05  DL1-PAYMENT-AMOUNT      PIC Z,ZZZ,ZZZ.99-                03790000
038000                                              VALUE ZERO.         03800000
038100     05  FILLER                  PIC X(6)     VALUE SPACES.       03810000
038200                                                                  03820000
038300 01  TL1-TOTAL-LINE-RPT-1.                                        03830000
038400     05  FILLER                  PIC X(74)    VALUE SPACES.       03840000
038500     05  TL1-TOTAL-TYPE-ID       PIC X(20)    VALUE SPACES.       03850000
038600     05  FILLER                  PIC X(2)     VALUE SPACES.       03860000
038700     05  TL1-SALES-AMOUNT        PIC ZZZ,ZZZ,ZZZ.99-              03870000
038800                                              VALUE ZERO.         03880000
038900     05  TL1-PAYMENT-AMOUNT      PIC ZZZ,ZZZ,ZZZ.99-              03890000
039000                                              VALUE ZERO.         03900000
039100     05  FILLER                  PIC X(2)     VALUE SPACES.       03910000
039200     05  TL1-TOTAL-TYPE          PIC X(4)     VALUE SPACES.       03920000
039300                                                                  03930000
039400 01  HL2-HEADING-LINE-2-RPT-2.                                    03940000
039500     05  FILLER                  PIC X(47)    VALUE SPACES.       03950000
039600     05  FILLER                  PIC X(30)    VALUE               03960000
039700         'DAILY KOHLS CHARGE AUDIT FOR '.                         03970000
039800     05  HL2-POS-DATE-2          PIC 99/99/99 VALUE ZERO.         03980000
039900     05  FILLER                  PIC X(47)    VALUE SPACES.       03990000
040000                                                                  04000000
040100 01  HL3-HEADING-LINE-3-RPT-2.                                    04010000
040200     05  FILLER                  PIC  X(39)    VALUE SPACE.       04020000
040300     05  FILLER                  PIC  X(04)    VALUE 'AUTH'.      04030000
040400     05  FILLER                  PIC  X(89)    VALUE SPACE.       04040000
040500                                                                  04050000
040600 01  HL4-HEADING-LINE-4-RPT-2.                                    04060000
040700     05  FILLER                      PIC  X(05)    VALUE SPACE.   04070000
040800     05  FILLER                      PIC  X(05)    VALUE 'REG #'. 04080000
040900     05  FILLER                      PIC  X(04)    VALUE SPACE.   04090000
041000     05  FILLER                      PIC  X(07)    VALUE          04100000
041100                                                   'TRANS #'.     04110000
041200     05  FILLER                      PIC  X(04)    VALUE SPACE.   04120000
041300     05  FILLER                      PIC  X(08)    VALUE          04130000
041400                                                   'ASSOC ID'.    04140000
041500     05  FILLER                      PIC  X(04)    VALUE SPACE.   04150000
041600     05  FILLER                      PIC  X(06)    VALUE          04160000
041700                                                   'NUMBER'.      04170000
041800     05  FILLER                      PIC  X(14)    VALUE SPACE.   04180000
041900     05  FILLER                      PIC  X(06)    VALUE          04190000
042000                                                   'ACCT #'.      04200000
042100     05  FILLER                      PIC  X(20)    VALUE SPACE.   04210000
042200     05  FILLER                      PIC  X(05)    VALUE          04220000
042300                                                   'SALES'.       04230000
042400     05  FILLER                      PIC  X(12)    VALUE SPACE.   04240000
042500     05  FILLER                      PIC  X(07)    VALUE          04250000
042600                                                   'RETURNS'.     04260000
042700     05  FILLER                      PIC  X(12)    VALUE SPACE.   04270000
042800     05  FILLER                      PIC  X(08)    VALUE          04280000
042900                                                   'PAYMENTS'.    04290000
043000     05  FILLER                      PIC  X(05)    VALUE SPACE.   04300000
043100                                                                  04310000
043200 01  HL5-HEADING-LINE-5-RPT-2.                                    04320000
043300     05  FILLER                  PIC  X(59)    VALUE ALL '-'.     04330000
043400     05  FILLER                  PIC  X(09)    VALUE              04340000
043500                                      ' STORE # '.                04350000
043600     05  HL3-STORE               PIC  Z999.                       04360000
043700     05  FILLER                  PIC  X(01)    VALUE SPACE.       04370000
043800     05  FILLER                  PIC  X(59)    VALUE ALL '-'.     04380000
043900                                                                  04390000
044000 01  DL2-DETAIL-LINE-RPT-2.                                       04400000
044100     05  FILLER                      PIC  X(05)    VALUE SPACE.   04410000
044200     05  DL2-REGISTER-NUMBER         PIC  9(04)    VALUE ZERO.    04420000
044300     05  FILLER                      PIC  X(06)    VALUE SPACE.   04430000
044400     05  DL2-TRANSACTION-NUMBER      PIC  9(04)    VALUE ZERO.    04440000
044500     05  FILLER                      PIC  X(04)    VALUE SPACE.   04450000
044600     05  DL2-ASSOC-ID                PIC  9(09)    VALUE ZERO.    04460000
044700     05  FILLER                      PIC  X(05)    VALUE SPACE.   04470000
044800     05  DL2-AUTH-NUMBER             PIC  X(06)    VALUE SPACE.   04480000
044900     05  FILLER                      PIC  X(08)    VALUE SPACE.   04490000
045000     05  DL2-ACCOUNT-NUMBER          PIC  X(16)    VALUE SPACE.   04500000
045100     05  FILLER                      PIC  X(01)    VALUE SPACE.   04510000
045200     05  DL2-LEVEL-OF-ISSUE          PIC  X(02)    VALUE SPACE.   04520000
045300     05  FILLER                      PIC  X(10)    VALUE SPACE.   04530000
045400     05  DL2-SALES-AMOUNT            PIC  ZZ,ZZ9.99-              04540000
045500                                                   VALUE ZERO.    04550000
045600     05  FILLER                      PIC  X(09)    VALUE SPACE.   04560000
045700     05  DL2-RETURNS-AMOUNT          PIC  ZZ,ZZ9.99-              04570000
045800                                                   VALUE ZERO.    04580000
045900     05  FILLER                      PIC  X(10)    VALUE SPACE.   04590000
046000     05  DL2-PAYMENTS-AMOUNT         PIC  ZZ,ZZ9.99-              04600000
046100                                                   VALUE ZERO.    04610000
046200     05  FILLER                      PIC  X(03)    VALUE SPACE.   04620000
046300                                                                  04630000
046400 01  RTL2-REGISTER-TOTAL-LINE-RPT-2.                              04640000
046500     05  FILLER                      PIC  X(05)    VALUE SPACE.   04650000
046600     05  FILLER                      PIC  X(03)    VALUE '***'.   04660000
046700     05  FILLER                      PIC  X(10)    VALUE          04670000
046800                                                   ' REGISTER '.  04680000
046900     05  RTL2-REGISTER-NUMBER        PIC  9(04)    VALUE ZERO.    04690000
047000     05  FILLER                      PIC  X(07)    VALUE          04700000
047100                                                   ' TOTAL '.     04710000
047200     05  FILLER                      PIC  X(03)    VALUE '***'.   04720000
047300     05  FILLER                      PIC  X(47)    VALUE SPACE.   04730000
047400     05  RTL2-REGISTER-SALES-AMOUNT  PIC  ZZZ,ZZ9.99-             04740000
047500                                                   VALUE ZERO.    04750000
047600     05  FILLER                      PIC  X(08)    VALUE SPACE.   04760000
047700     05  RTL2-REGISTER-RETURNS-AMOUNT PIC ZZZ,ZZ9.99-             04770000
047800                                                   VALUE ZERO.    04780000
047900     05  FILLER                      PIC  X(09)    VALUE SPACE.   04790000
048000     05  RTL2-REGISTER-PAYMENTS-AMOUNT                            04800000
048100                                     PIC  ZZZ,ZZ9.99-             04810000
048200                                                   VALUE ZERO.    04820000
048300     05  FILLER                      PIC  X(03)    VALUE SPACE.   04830000
048400                                                                  04840000
048500 01  STL2-STORE-TOTAL-LINE-RPT-2.                                 04850000
048600     05  FILLER                      PIC  X(05)    VALUE SPACE.   04860000
048700     05  FILLER                      PIC  X(03)    VALUE '***'.   04870000
048800     05  FILLER                      PIC  X(07)    VALUE          04880000
048900                                                   ' STORE '.     04890000
049000     05  STL2-STORE-NUMBER           PIC  9(04)    VALUE ZERO.    04900000
049100     05  FILLER                      PIC  X(07)    VALUE          04910000
049200                                                   ' TOTAL '.     04920000
049300     05  FILLER                      PIC  X(03)    VALUE '***'.   04930000
049400     05  FILLER                      PIC  X(50)    VALUE SPACE.   04940000
049500     05  STL2-STORE-SALES-AMOUNT     PIC  ZZZ,ZZ9.99-             04950000
049600                                                   VALUE ZERO.    04960000
049700     05  FILLER                      PIC  X(08)    VALUE SPACE.   04970000
049800     05  STL2-STORE-RETURNS-AMOUNT   PIC     ZZZ,ZZ9.99-          04980000
049900                                                   VALUE ZERO.    04990000
050000     05  FILLER                      PIC  X(09)    VALUE SPACE.   05000000
050100     05  STL2-STORE-PAYMENTS-AMOUNT                               05010000
050200                                     PIC  ZZZ,ZZ9.99-             05020000
050300                                                   VALUE ZERO.    05030000
050400     05  FILLER                      PIC  X(03)    VALUE SPACE.   05040000
050500                                                                  05050000
050600 01  CTL2-CORP-TOTAL-LINE-RPT-2.                                  05060000
050700     05  FILLER                      PIC  X(05)    VALUE SPACE.   05070000
050800     05  FILLER                      PIC  X(03)    VALUE '***'.   05080000
050900     05  FILLER                      PIC  X(11)    VALUE          05090000
051000                                                 ' CORPORATE '.   05100000
051100     05  FILLER                      PIC  X(07)    VALUE          05110000
051200                                                   ' TOTAL '.     05120000
051300     05  FILLER                      PIC  X(03)    VALUE '***'.   05130000
051400     05  FILLER                      PIC  X(45)    VALUE SPACE.   05140000
051500     05  CTL2-CORP-SALES-AMOUNT      PIC  ZZZ,ZZZ,ZZ9.99-         05150000
051600                                                   VALUE ZERO.    05160000
051700     05  FILLER                      PIC  X(04)    VALUE SPACE.   05170000
051800     05  CTL2-CORP-RETURNS-AMOUNT    PIC  ZZZ,ZZZ,ZZ9.99-         05180000
051900                                                   VALUE ZERO.    05190000
052000     05  FILLER                      PIC  X(05)    VALUE SPACE.   05200000
052100     05  CTL2-CORP-PAYMENTS-AMOUNT                                05210000
052200                                     PIC  ZZZ,ZZZ,ZZ9.99-         05220000
052300                                                   VALUE ZERO.    05230000
052400     05  FILLER                      PIC  X(04)    VALUE SPACE.   05240000
052500                                                                  05250000
052600 01  HL2-HEADING-LINE-2-RPT-3.                                    05260000
052700     05  FILLER                  PIC X(48)    VALUE SPACES.       05270000
052800     05  FILLER                  PIC X(30)    VALUE               05280000
052900         'KOHLS CHARGE STORE TOTALS FOR '.                        05290000
053000     05  HL2-POS-DATE-3          PIC 99/99/99 VALUE ZERO.         05300000
053100     05  FILLER                  PIC X(46)    VALUE SPACES.       05310000
053200                                                                  05320000
053300 01  HL3-HEADING-LINE-3-RPT-3.                                    05330000
053400     05  FILLER                  PIC X(06)    VALUE SPACE.        05340000
053500     05  FILLER                  PIC X(05)    VALUE 'STORE'.      05350000
053600     05  FILLER                  PIC X(15)    VALUE SPACE.        05360000
053700     05  FILLER                  PIC X(05)    VALUE 'SALES'.      05370000
053800     05  FILLER                  PIC X(20)    VALUE SPACE.        05380000
053900     05  FILLER                  PIC X(07)    VALUE 'RETURNS'.    05390000
054000     05  FILLER                  PIC X(18)    VALUE SPACE.        05400000
054100     05  FILLER                  PIC X(10)    VALUE 'NET AMOUNT'. 05410000
054200     05  FILLER                  PIC X(21)    VALUE SPACE.        05420000
054300     05  FILLER                  PIC X(08)    VALUE 'PAYMENTS'.   05430000
054400     05  FILLER                  PIC X(17)    VALUE SPACE.        05440000
054500                                                                  05450000
054600 01  STL3-STORE-TOTAL-LINE-RPT-3.                                 05460000
054700     05  FILLER                  PIC X(07)    VALUE SPACE.        05470000
054800     05  STL3-STORE-NUMBER       PIC 9(04)    VALUE ZERO.         05480000
054900     05  FILLER                  PIC X(06)    VALUE SPACE.        05490000
055000     05  STL3-STORE-SALES-AMOUNT PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05500000
055100     05  FILLER                  PIC X(12)    VALUE SPACE.        05510000
055200     05  STL3-STORE-RETURNS-AMOUNT                                05520000
055300                                 PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05530000
055400     05  FILLER                  PIC X(13)    VALUE SPACE.        05540000
055500     05  STL3-STORE-NET-AMOUNT   PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05550000
055600     05  FILLER                  PIC X(14)    VALUE SPACE.        05560000
055700     05  STL3-STORE-PAYMENTS-AMOUNT                               05570000
055800                                 PIC ZZZ,ZZZ,ZZ9.99-.             05580000
055900     05  FILLER                  PIC X(16)    VALUE SPACE.        05590000
056000                                                                  05600000
056100 01  CTL3-CORP-TOTAL-LINE-RPT-3.                                  05610000
056200     05  FILLER                  PIC X(02)    VALUE '**'.         05620000
056300     05  FILLER                  PIC X(12)    VALUE               05630000
056400                                              ' CORP TOTAL '.     05640000
056500     05  FILLER                  PIC X(02)    VALUE '**'.         05650000
056600     05  FILLER                  PIC X(01)    VALUE SPACE.        05660000
056700     05  CTL3-CORP-SALES-AMOUNT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05670000
056800     05  FILLER                  PIC X(12)    VALUE SPACE.        05680000
056900     05  CTL3-CORP-RETURNS-AMOUNT                                 05690000
057000                                 PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05700000
057100     05  FILLER                  PIC X(13)    VALUE SPACE.        05710000
057200     05  CTL3-CORP-NET-AMOUNT    PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05720000
057300     05  FILLER                  PIC X(14)    VALUE SPACE.        05730000
057400     05  CTL3-CORP-PAYMENTS-AMOUNT                                05740000
057500                                 PIC ZZZ,ZZZ,ZZ9.99-.             05750000
057600     05  FILLER                  PIC X(16)    VALUE SPACE.        05760000
057700                                                                  05770000
057800******************************************************************05780000
057900* RECORD LAYOUTS FOR OUT OF BALANCE REPORT.                      *05790000
058000******************************************************************05800000
058100 01  RH4-HEAD1.                                                   05810000
058200     05  FILLER                    PIC X(02)  VALUE SPACES.       05820000
058300     05  FILLER                    PIC X(32)  VALUE SPACES.       05830000
058400     05  FILLER                    PIC X(55)  VALUE               05840000
058500     'KOHLS CHARGE TRANSACTIONS OUT OF BALANCE WITH COSA FOR '.   05850000
058600     05  RH4-PROCESS-DATE          PIC X(08).                     05860000
058700     05  FILLER                    PIC X(35)  VALUE SPACES.       05870000
058800                                                                  05880000
058900 01  RH4-HEAD2.                                                   05890000
059000     05  FILLER        PIC X(01)  VALUE SPACES.                   05900000
059100     05  FILLER        PIC X(04)  VALUE ' STR'.                   05910000
059200     05  FILLER        PIC X(02)  VALUE SPACES.                   05920000
059300     05  FILLER        PIC X(08)  VALUE ' SALES  '.               05930000
059400     05  FILLER        PIC X(01)  VALUE SPACES.                   05940000
059500     05  FILLER        PIC X(04)  VALUE 'RGST'.                   05950000
059600     05  FILLER        PIC X(01)  VALUE SPACES.                   05960000
059700     05  FILLER        PIC X(04)  VALUE ' TRN'.                   05970000
059800     05  FILLER        PIC X(01)  VALUE SPACES.                   05980000
059900     05  FILLER        PIC X(08)  VALUE '   START'.               05990000
060000     05  FILLER        PIC X(01)  VALUE SPACES.                   06000000
060100     05  FILLER        PIC X(05)  VALUE ' CORR'.                  06010000
060200     05  FILLER        PIC X(03)  VALUE SPACES.                   06020000
060300     05  FILLER        PIC X(14)  VALUE '      TENDER'.           06030000
060400     05  FILLER        PIC X(01)  VALUE SPACES.                   06040000
060500     05  FILLER        PIC X(14)  VALUE 'KOHLS CHARGE'.           06050000
060600     05  FILLER        PIC X(01)  VALUE SPACES.                   06060000
060700     05  FILLER        PIC X(14)  VALUE '    VARIANCE'.           06070000
071221     05  FILLER        PIC X(01)  VALUE SPACES.                   06071000
071221     05  FILLER        PIC X(04)  VALUE 'AUTO'.                   06080000
071221     05  FILLER        PIC X(42)  VALUE SPACES.                   06081000
060900                                                                  06090000
061000 01  RH4-HEAD3.                                                   06100000
061100     05  FILLER        PIC X(01)  VALUE SPACES.                   06110000
061200     05  FILLER        PIC X(04)  VALUE ' NBR'.                   06120000
061300     05  FILLER        PIC X(02)  VALUE SPACES.                   06130000
061400     05  FILLER        PIC X(08)  VALUE '  DATE  '.               06140000
061500     05  FILLER        PIC X(01)  VALUE SPACES.                   06150000
061600     05  FILLER        PIC X(04)  VALUE '  ID'.                   06160000
061700     05  FILLER        PIC X(01)  VALUE SPACES.                   06170000
061800     05  FILLER        PIC X(04)  VALUE ' NBR'.                   06180000
061900     05  FILLER        PIC X(01)  VALUE SPACES.                   06190000
062000     05  FILLER        PIC X(08)  VALUE '    TIME'.               06200000
062100     05  FILLER        PIC X(01)  VALUE SPACES.                   06210000
062200     05  FILLER        PIC X(05)  VALUE 'SEQ #'.                  06220000
062300     05  FILLER        PIC X(01)  VALUE SPACES.                   06230000
062400     05  FILLER        PIC X(14)  VALUE '        AMOUNT'.         06240000
062500     05  FILLER        PIC X(01)  VALUE SPACES.                   06250000
062600     05  FILLER        PIC X(14)  VALUE '        AMOUNT'.         06260000
062700     05  FILLER        PIC X(01)  VALUE SPACES.                   06270000
062800     05  FILLER        PIC X(14)  VALUE '        AMOUNT'.         06280000
071221     05  FILLER        PIC X(01)  VALUE SPACES.                   06290000
071221     05  FILLER        PIC X(06)  VALUE 'ADJUST'.                 06290100
071221     05  FILLER        PIC X(01)  VALUE SPACES.                   06290200
071221     05  FILLER        PIC X(40)  VALUE 'COMMENT'.                06301000
063100                                                                  06310000
063200 01  RD4-DETAIL-LINE.                                             06320000
063300     05  FILLER               PIC X(01)  VALUE SPACES.            06330000
063400     05  RD4-STR-NBR          PIC ZZZ9.                           06340000
063500     05  FILLER               PIC X(02)  VALUE SPACES.            06350000
063600     05  RD4-SLS-DTE          PIC X(08).                          06360000
063700     05  FILLER               PIC X(01)  VALUE SPACES.            06370000
063800     05  RD4-RGST-ID          PIC ZZZ9.                           06380000
063900     05  FILLER               PIC X(01)  VALUE SPACES.            06390000
064000     05  RD4-TRN-NBR          PIC ZZZ9.                           06400000
064100     05  FILLER               PIC X(01)  VALUE SPACES.            06410000
064200     05  RD4-STRT-TM          PIC X(08).                          06420000
064300     05  FILLER               PIC X(01)  VALUE SPACES.            06430000
064400     05  FILLER               PIC X(01)  VALUE SPACES.            06440000
064500     05  RD4-SLS-CORR-SEQ-NBR PIC ---9.                           06450000
064600     05  FILLER               PIC X(01)  VALUE SPACES.            06460000
064700     05  RD4-TEPTND-TNDR-AMT  PIC ---,---,--9.99.                 06470000
064800     05  FILLER               PIC X(01)  VALUE SPACES.            06480000
064900     05  RD4-AR001-TNDR-AMT   PIC ---,---,--9.99.                 06490000
065000     05  FILLER               PIC X(01)  VALUE SPACES.            06500000
065100     05  RD4-VAR-AMT          PIC ---,---,--9.99.                 06510000
071221     05  FILLER               PIC X(04)  VALUE SPACES.            06520000
071221     05  RD4-ADJ-IND          PIC X(01).                          06520100
071221     05  FILLER               PIC X(03)  VALUE SPACES.            06521000
071221     05  RD4-COMMENT          PIC X(18)  VALUE SPACES.            06530000
065400         88 RD4-LATE-VOID-COMMENT VALUE 'LATE VOID REVERSAL'.     06540000
065500         88 RD4-NO-COMMENT        VALUE SPACES.                   06550000
065600 01  RF4-FOOT1.                                                   06560000
065700     05  FILLER                    PIC X(02)  VALUE SPACES.       06570000
065800     05  FILLER                    PIC X(53)  VALUE SPACES.       06580000
065900     05  FILLER                    PIC X(23)  VALUE               06590000
066000     '**** END OF REPORT ****'.                                   06600000
066100     05  FILLER                    PIC X(54)  VALUE SPACES.       06610000
066200     EJECT                                                        06620000
066300                                                                  06630000
066400***************************************************************** 06640000
066500*  ACCOUNTS RECEIVABLE TRANSACTION FILE RECORD LAYOUT             06650000
066600***************************************************************** 06660000
066700     COPY ARRD001.                                                06670000
066800                                                                  06696600
066900***************************************************************** 06697000
067000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 06700000
067100***************************************************************** 06710000
067200     COPY DPWS132O.                                               06720000
067300                                                                  06732000
067400******************************************************************06740000
067500*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             06750000
067600******************************************************************06760000
067700     COPY DPWS500.                                                06770000
067800                                                                  06933200
067900******************************************************************06933300
068000*  WORKING STORAGE AREA FOR DB2 ERROR DISPLAY.                    06933400
068100******************************************************************06933500
068200     COPY DPWS004.                                                06933600
068300                                                                  06935700
068400******************************************************************06935800
068500* SALES AUDIT TRANSACTION TABLE                                  *06935900
068600******************************************************************06936000
068700     EXEC SQL                                                     06936100
068800         INCLUDE TEPTRN                                           06936200
068900     END-EXEC.                                                    06951400
069000                                                                  06951500
069100******************************************************************06951600
069200* SALES AUDIT TENDER TABLE                                       *06951700
069300******************************************************************06951800
069400     EXEC SQL                                                     06951900
069500         INCLUDE TEPTND                                           06952000
069600     END-EXEC.                                                    06961000
069700                                                                  06970000
069800******************************************************************06980000
069900*  DB2 AREA FOR COMMUNICATIONS                                    06990000
070000******************************************************************07000000
070100     EXEC SQL                                                     07010000
070200         INCLUDE SQLCA                                            07020000
070300     END-EXEC.                                                    07030000
070400                                                                  07040000
070500******************************************************************07050000
070600 PROCEDURE DIVISION.                                              07060000
070700******************************************************************07070000
070800 0000-MAINLINE.                                                   07080000
070900                                                                  07090000
071000     PERFORM 1000-INITIALIZE.                                     07100000
071100                                                                  07110000
071200     PERFORM 2000-PROCESS-DATA                                    07120000
071300         UNTIL PS-END-OF-TRANS-FILE.                              07130000
071400                                                                  07140000
071500     PERFORM 6000-FINAL-BREAK.                                    07150000
071600                                                                  07160000
071700     PERFORM 9000-EOJ-ROUTINE.                                    07170000
071800                                                                  07180000
071900     GOBACK.                                                      07190000
072000                                                                  07200000
072100******************************************************************07210000
072200*  SET UP FOR PROGRAM PROCESSING BY OPENING ALL FILES, FILLING   *07220000
072300*  THE FIELDS OF THE STANDARD REPORT HEADER, INITIALIZING        *07230000
072400*  NECESSARY VARIABLES, AND READING THE FIRST PROCESSABLE RECORD *07240000
072500*  FROM THE P.O.S. KOHL'S CHARGE FILE.                           *07250000
072600*  CHARGE FILE.                                                  *07260000
072700******************************************************************07270000
072800 1000-INITIALIZE.                                                 07280000
072900                                                                  07290000
073000     OPEN INPUT  POS-DATE-CARD-FILE                               07300000
073100                 AR-TRANSACTION-FILE                              07310000
073200          OUTPUT CHARGE-DETAIL-RPT-FILE                           07320000
073300                 AUDIT-RPT-FILE                                   07330000
073400                 STORE-TOTALS-RPT-FILE                            07340000
073500                 OUT-OF-BAL-RPT-FILE                              07350000
073600                 ACCOUNTS-RECEIVABLE-FILE.                        07360000
071221                                                                  07360100
071221     INITIALIZE AR-OUTPUT-ARRAY.                                  07361000
071221     SET AR-MSG-IDX TO +1.                                        07362000
073700                                                                  07370000
073800     ACCEPT CD-CURRENT-DATE FROM DATE.                            07380000
073900     MOVE   CD-CURRENT-YEAR   TO DP132O-RUN-YEAR.                 07390000
074000     MOVE   CD-CURRENT-MONTH  TO DP132O-RUN-MONTH.                07400000
074100     MOVE   CD-CURRENT-DAY    TO DP132O-RUN-DAY.                  07410000
074200                                                                  07420000
074300     ACCEPT CT-CURRENT-TIME FROM TIME.                            07430000
074400     MOVE   CT-CURRENT-HOUR   TO DP132O-RUN-HOUR.                 07440000
074500     MOVE   CT-CURRENT-MINUTE TO DP132O-RUN-MINUTE.               07450000
074600     MOVE   PC-CURRENT-PROGRAM-NAME                               07460000
074700                              TO DP132O-PROGRAM-NAME.             07470000
074800                                                                  07480000
074900     READ POS-DATE-CARD-FILE INTO CC-CONTROL-CARD                 07490000
075000        AT END                                                    07500000
075100           SET PS-END-OF-CARD-FILE TO TRUE.                       07510000
075200                                                                  07520000
075300     DISPLAY 'ARKUT059 CONTROL CARD: ' CC-CONTROL-CARD.           07530000
075400                                                                  07540000
075500     CLOSE POS-DATE-CARD-FILE.                                    07550000
075600                                                                  07560000
075700     IF PS-END-OF-CARD-FILE                                       07570000
075800        DISPLAY '** ABEND ** ' PC-CURRENT-PROGRAM-NAME            07580000
075900        DISPLAY 'DATE CONTROL CARD EMPTY'                         07590000
076000        SET AC-CONTROL-CARD-ERROR TO TRUE                         07600000
076100        CALL 'ILBOABN0' USING ABEND-CODE                          07610000
076200     END-IF.                                                      07620000
076300                                                                  07630000
076400     PERFORM 1500-CONVERT-INPUT-DATE.                             07640000
076500                                                                  07650000
076600     PERFORM 2100-READ-AR-FILE.                                   07660000
076700                                                                  07670000
076800     MOVE AR001-PARTITION-NUMBER   TO PV-SAVE-PARTN-NBR           07680000
076900                                      PV-PARTN-NBR.               07690000
077000     MOVE AR001-STORE-NUMBER       TO PV-SAVE-STR-NBR             07700000
077100                                      PV-STR-NBR.                 07710000
077200     MOVE AR001-TERMINAL-NUMBER    TO PV-SAVE-RGST-ID             07720000
077300                                      PV-RGST-ID.                 07730000
077400     MOVE AR001-TRANSACTION-NUMBER TO PV-SAVE-TRN-NBR             07740000
077500                                      PV-TRN-NBR.                 07750000
077600     MOVE AR001-START-TIME         TO PV-SAVE-STRT-TM             07760000
077700                                      PV-STRT-TM.                 07770000
077800     MOVE AR001-SLS-CORR-SEQ-NBR   TO PV-SAVE-SLS-CORR-SEQ-NBR    07780000
077900                                      PV-SLS-CORR-SEQ-NBR.        07790000
078000     MOVE AR001-TNDR-SEQ-NBR       TO PV-SAVE-TNDR-SEQ-NBR.       07800000
085000     MOVE AR001-TRANSACTION-SOURCE TO PV-SAVE-TRAN-SOURCE.        07802000
078100                                                                  07810000
078200******************************************************************07820000
078300*     CALL KOHLS CALENDAR ROUTINE:                                07830000
078400*         PASS: CONTROL CARD POS DATE (MMDDYY FORMAT).            07840000
078500*       RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT). 07850000
078600******************************************************************07860000
078700 1500-CONVERT-INPUT-DATE.                                         07870000
078800                                                                  07880000
078900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              07890000
079000                                                                  07900000
079100     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   07910000
079200     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   07920000
079300     SET  DPG52-LK-DTE-GREG            TO TRUE.                   07930000
079400     MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    07940000
079500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07950000
079600                                             DPG54 DPG55 DPG56.   07960000
079700     EVALUATE TRUE                                                07970000
079800         WHEN DPG54-SEVERE-ERROR                                  07980000
079900            DISPLAY '** ABEND ** ' PC-CURRENT-PROGRAM-NAME        07990000
080000            DISPLAY 'DATE CONTROL CARD INVALID'                   08000000
080100            SET AC-CONTROL-CARD-ERROR TO TRUE                     08010000
080200            CALL 'ILBOABN0' USING ABEND-CODE                      08020000
080300     END-EVALUATE.                                                08030000
080400                                                                  08040000
080500     DISPLAY 'EXECUTION DATE USED = ' DPG55-DB2-ISO-DATE-FMT.     08050000
080600                                                                  08060000
080700     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD       08070000
080800     MOVE PV-POS-MM                    TO PV-RUN-DATE-MM.         08080000
080900     MOVE PV-POS-DD                    TO PV-RUN-DATE-DD.         08090000
081000     MOVE PV-POS-YY                    TO PV-RUN-DATE-YY.         08100000
081100     MOVE PV-RUN-DATE-MMDDYY           TO HL2-POS-DATE-1          08110000
081200                                          HL2-POS-DATE-2          08120000
081300                                          HL2-POS-DATE-3          08130000
081400                                          RH4-PROCESS-DATE.       08140000
081500                                                                  08150000
081600******************************************************************08160000
081700*  PERFORMS THE PARAGRAPHS THAT CONTROL THE CURSORS THAT DRIVE   *08170000
081800*  THE PROGRAM.                                                  *08180000
081900******************************************************************08190000
082000 2000-PROCESS-DATA.                                               08200000
082100                                                                  08210000
082200     EVALUATE TRUE                                                08220000
082300         WHEN AR001-STORE-NUMBER NOT EQUAL PV-SAVE-STR-NBR        08230000
082400             PERFORM 5000-STORE-BREAK                             08240000
082500             MOVE AR001-STORE-NUMBER TO PV-SAVE-STR-NBR           08250000
082600                                                                  08260000
082700         WHEN AR001-TERMINAL-NUMBER NOT EQUAL PV-SAVE-RGST-ID     08270000
082800             PERFORM 4000-REGISTER-BREAK                          08280000
082900                                                                  08290000
083000         WHEN AR001-TRANSACTION-NUMBER NOT EQUAL PV-SAVE-TRN-NBR  08300000
083100         WHEN AR001-START-TIME     NOT EQUAL PV-SAVE-STRT-TM      08310000
083200         WHEN AR001-TNDR-SEQ-NBR NOT EQUAL PV-SAVE-TNDR-SEQ-NBR   08320000
083300             PERFORM 3000-TRANSACTION-BREAK                       08330000
083400                                                                  08340000
083500     END-EVALUATE.                                                08350000
083600                                                                  08360000
083700     MOVE AR001-PARTITION-NUMBER   TO PV-SAVE-PARTN-NBR.          08370000
083800     MOVE AR001-STORE-NUMBER       TO PV-SAVE-STR-NBR.            08380000
083900     MOVE AR001-TERMINAL-NUMBER    TO PV-SAVE-RGST-ID.            08390000
084000     MOVE AR001-TRANSACTION-NUMBER TO PV-SAVE-TRN-NBR.            08400000
084100     MOVE AR001-START-TIME         TO PV-SAVE-STRT-TM.            08410000
084200     MOVE AR001-SLS-CORR-SEQ-NBR   TO PV-SAVE-SLS-CORR-SEQ-NBR.   08420000
084300     MOVE AR001-TNDR-SEQ-NBR       TO PV-SAVE-TNDR-SEQ-NBR.       08430000
084400     MOVE AR001-AUTH-NUMBER        TO PV-SAVE-AUTH-NUMBER.        08440000
084500     MOVE AR001-REG-OPERATOR-ID    TO PV-SAVE-ASSOC-ID.           08450000
084600     MOVE AR001-ACCOUNT-LEVEL-OF-ISSUE                            08460000
084700                                   TO PV-SAVE-LEVEL-OF-ISSUE.     08470000
084800     MOVE AR001-TRANSACTION-MONTH  TO PV-SAVE-DATE (1:2).         08480000
084900     MOVE AR001-TRANSACTION-DAY    TO PV-SAVE-DATE (4:2).         08490000
085000     MOVE AR001-TRANSACTION-YEAR   TO PV-SAVE-DATE (7:2).         08500000
EMPCSH     MOVE AR001-PAYMENT-IND        TO PV-SAVE-PAYMENT-IND.        08501000
EMPCSH     MOVE AR001-TRANSACTION-SOURCE TO PV-SAVE-TRAN-SOURCE.        08502000
085100                                                                  08510000
085200     IF AR001-PAYMENT-IND = 'Y'                                   08520000
085300         SET PS-PAYMENT-YES TO TRUE                               08530000
085400     ELSE                                                         08540000
085500         SET PS-PAYMENT-NO TO TRUE                                08550000
085600     END-IF.                                                      08560000
085700                                                                  08570000
085800     PERFORM 2750-PROCESS-OUTPUT-FILE.                            08580000
085900     PERFORM 2500-PREPARE-DETAIL-RPT-LINE.                        08590000
086000                                                                  08600000
086100     PERFORM 2100-READ-AR-FILE.                                   08610000
086200                                                                  08620000
086300******************************************************************08630000
086400*  READ A RECORD FROM THE AR EXTRACT FILE CREATED BY ARKUT058.   *08640000
086500******************************************************************08650000
086600 2100-READ-AR-FILE.                                               08660000
086700                                                                  08670000
086800     READ AR-TRANSACTION-FILE                                     08680000
086900         INTO AR001-AR-TRANSACTION-RECORD                         08690000
087000         AT END                                                   08700000
087100             SET PS-END-OF-TRANS-FILE TO TRUE                     08710000
087200     END-READ.                                                    08720000
087300                                                                  08730000
087400     IF PS-NOT-END-OF-TRANS-FILE                                  08740000
087500         ADD +1 TO PA-TRANSACTION-COUNT                           08750000
087600     END-IF.                                                      08760000
087700                                                                  08770000
087800***************************************************************** 08780000
087900*  PREPARE A DETAIL LINE FOR PRINTING ON THE REPORT               08790000
088000***************************************************************** 08800000
088100 2500-PREPARE-DETAIL-RPT-LINE.                                    08810000
088200                                                                  08820000
088300     INITIALIZE DL1-DETAIL-LINE-RPT-1 PV-WORK-AMOUNT.             08830000
088400     MOVE AR001-STORE-NUMBER       TO DL1-STORE-NUMBER.           08840000
088500     MOVE AR001-TERMINAL-NUMBER    TO DL1-REGISTER-NUMBER.        08850000
088600     MOVE AR001-TRANSACTION-NUMBER TO DL1-TRANSACTION-NUMBER.     08860000
088700     MOVE AR001-LINE-NUMBER        TO DL1-LINE-NUMBER.            08870000
088800     MOVE AR001-REG-OPERATOR-ID    TO DL1-ASSOC-ID.               08880000
088900     MOVE AR001-TRANSACTION-CODE   TO DL1-TRANSACTION-CODE.       08890000
089000     MOVE AR001-CRS-EMPLOYEE-CODE  TO DL1-EMPLOYEE-CODE.          08900000
                                                                        08911000
P1043      MOVE AR001-BIN-NUMBER           TO FA-BIN-NUMBER.            08950000
           MOVE AR001-ACCOUNT-NUMBER (1:3) TO FA-ACCOUNT-NUMBER-1-3.    08951000
           MOVE AR001-ACCOUNT-NUMBER (4:4) TO FA-ACCOUNT-NUMBER-4-7.    08952000
           MOVE AR001-ACCOUNT-NUMBER (8:3) TO FA-ACCOUNT-NUMBER-8-10.   08953000
089600     MOVE FA-FORMATTED-ACCOUNT-NUMBER                             08960000
089700                                     TO DL1-ACCOUNT-NUMBER.       08970000
089800     MOVE AR001-ACCOUNT-LEVEL-OF-ISSUE                            08980000
089900                                   TO DL1-LEVEL-OF-ISSUE.         08990000
090000     EVALUATE TRUE                                                09000000
090100        WHEN AR001-POS-CHARGE                                     09010000
090200            MOVE '-'              TO DL1-DEPARTMENT-CLASS-DASH    09020000
EMPCSH            IF AR001-EMP-DISC-SRC-CDE  = 'S'                      09030000
EMPCSH                ADD  AR001-TRANSACTION-AMOUNT                     09031000
EMPCSH                 TO PV-WORK-AMOUNT                                09032000
EMPCSH            ELSE                                                  09033000
EMPCSH                ADD  AR001-TRANSACTION-AMOUNT AR001-EMP-DISC-AMT  09033100
EMPCSH                 TO PV-WORK-AMOUNT                                09033200
EMPCSH            END-IF                                                09034000
090400            MOVE PV-WORK-AMOUNT    TO DL1-SALES-AMOUNT            09040000
090500            ADD PV-WORK-AMOUNT     TO PA-TRANSACTION-AMOUNT       09050000
090600        WHEN AR001-PAYMENT                                        09060000
090700            COMPUTE PV-WORK-AMOUNT =                              09070000
090800                    AR001-TRANSACTION-AMOUNT * -1                 09080000
090900            END-COMPUTE                                           09090000
091000            MOVE PV-WORK-AMOUNT TO DL1-PAYMENT-AMOUNT             09100000
091100            ADD PV-WORK-AMOUNT  TO PA-TRANSACTION-PAYMENTS-AMOUNT 09110000
091200        WHEN AR001-PAYMENT-IND = 'Y'                              09120000
091300            MOVE AR001-TRANSACTION-AMOUNT TO PV-WORK-AMOUNT       09130000
091400            MOVE PV-WORK-AMOUNT TO DL1-PAYMENT-AMOUNT             09140000
091500            ADD PV-WORK-AMOUNT  TO PA-TRANSACTION-PAYMENTS-AMOUNT 09150000
091600        WHEN OTHER                                                09160000
EMPCSH            MOVE '-'              TO DL1-DEPARTMENT-CLASS-DASH    09170000
EMPCSH            COMPUTE PV-WORK-AMOUNT =                              09170100
EMPCSH                    AR001-TRANSACTION-AMOUNT * -1                 09170200
EMPCSH            END-COMPUTE                                           09170300
EMPCSH            IF AR001-EMP-DISC-SRC-CDE  NOT EQUAL TO 'S'           09171000
EMPCSH                    ADD AR001-EMP-DISC-AMT TO PV-WORK-AMOUNT      09191000
EMPCSH            END-IF                                                09200000
092100            MOVE PV-WORK-AMOUNT    TO DL1-SALES-AMOUNT            09210000
092200            ADD PV-WORK-AMOUNT     TO PA-TRANSACTION-AMOUNT       09220000
092300     END-EVALUATE.                                                09230000
092400                                                                  09240000
092500     MOVE AR001-ITEM-DEPARTMENT TO DL1-DEPARTMENT.                09250000
092600     MOVE AR001-ITEM-CLASS      TO DL1-CLASS.                     09260000
092700                                                                  09270000
092800     EVALUATE TRUE                                                09280000
092900         WHEN AR001-SALES-TAX-ITEM                                09290000
093000             MOVE SPACES            TO DL1-QUANTITY-X             09300000
093100             SET DL1-SALES-TAX-ITEM TO TRUE                       09310000
093200                                                                  09320000
093300         WHEN AR001-OTHER-TENDER                                  09330000
093400             MOVE SPACES            TO DL1-QUANTITY-X             09340000
093500             SET DL1-OTHER-TENDER   TO TRUE                       09350000
093600                                                                  09360000
093700         WHEN AR001-PAYMENT                                       09370000
093800         WHEN AR001-PAYMENT-IND = 'Y'                             09380000
093900             MOVE SPACES            TO DL1-QUANTITY-X             09390000
094000                                                                  09400000
094100         WHEN AR001-GIFT-WRAP-ITEM                                09411000
094200         WHEN AR001-SHIPPING-ITEM                                 09420000
CFEES          WHEN AR001-FEE-ITEM                                      09421000
094300             MOVE 1                 TO DL1-QUANTITY               09430000
094400                                                                  09440000
094500         WHEN AR001-TLCD-ITEM                                     09450000
094600             MOVE ZERO              TO DL1-QUANTITY               09460000
094700                                                                  09471000
094800         WHEN OTHER                                               09480000
094900             MOVE AR001-UNITS-SOLD  TO DL1-QUANTITY               09490000
095000     END-EVALUATE.                                                09500000
095100                                                                  09510000
095200     MOVE DL1-DETAIL-LINE-RPT-1    TO PV-PRINT-RECORD.            09520000
095300                                                                  09530000
095400     PERFORM 8000-PRINT-DETAIL-RPT-LINE.                          09540000
095500                                                                  09550000
095600     SET PV-SINGLE-SPACE-RPT1      TO TRUE.                       09560000
095700                                                                  09570000
095800******************************************************************09580000
095900*  2750-PROCESS-OUTPUT-FILE.                                      09590000
096000*     WRITE OUTPUT FILE                                           09600000
096100******************************************************************09610000
096200 2750-PROCESS-OUTPUT-FILE.                                        09620000
096300                                                                  09630000
096400     IF PV-SAVE-PARTN-NBR        = PV-PARTN-NBR AND               09640000
096500        PV-SAVE-STR-NBR          = PV-STR-NBR   AND               09650000
096600        PV-SAVE-RGST-ID          = PV-RGST-ID   AND               09660000
096700        PV-SAVE-TRN-NBR          = PV-TRN-NBR   AND               09670000
096800        PV-SAVE-STRT-TM          = PV-STRT-TM   AND               09680000
096900        PV-SAVE-SLS-CORR-SEQ-NBR = PV-SLS-CORR-SEQ-NBR AND        09690000
097000        PV-SAVE-TNDR-SEQ-NBR     = PV-TNDR-SEQ-NBR                09700000
097100         ADD +1                 TO PV-LINE-NUMBER                 09710000
097200     ELSE                                                         09720000
097300         MOVE +1                TO PV-LINE-NUMBER                 09730000
097400         MOVE PV-SAVE-PARTN-NBR        TO PV-PARTN-NBR            09740000
097500         MOVE PV-SAVE-STR-NBR          TO PV-STR-NBR              09750000
097600         MOVE PV-SAVE-RGST-ID          TO PV-RGST-ID              09760000
097700         MOVE PV-SAVE-TRN-NBR          TO PV-TRN-NBR              09770000
097800         MOVE PV-SAVE-STRT-TM          TO PV-STRT-TM              09780000
097900         MOVE PV-SAVE-SLS-CORR-SEQ-NBR TO PV-SLS-CORR-SEQ-NBR     09790000
098000         MOVE PV-SAVE-TNDR-SEQ-NBR     TO PV-TNDR-SEQ-NBR         09800000
098100     END-IF.                                                      09810000
098200                                                                  09820000
098300     MOVE PV-LINE-NUMBER               TO AR001-LINE-NUMBER.      09830000
071221* BACKUP DATA TO ARRAY INSTEAD OF WRITING OUT DIRECTLY IN ORDER   09830100
071221* TO BE ABLE TO KNOW WHETHER THE TRANSACTION IS OUT OF BALANCE    09830200
071221* PRIOR TO WRITING OUT ANY OF THE RECORDS BECAUSE THE ADJUSTMENT  09830300
071221* RECORD NEEDS TO BE INSERTED AFTER THE MERCHANDISE RECORDS       09830400
071221     MOVE AR001-AR-TRANSACTION-RECORD                             09831000
071221                                    TO AR-OUTPUT-LINE(AR-MSG-IDX).09832000
071221     SET AR-MSG-IDX UP BY +1.                                     09833000
071221*    WRITE AR-ACCOUNTS-RECEIVABLE-RECORD FROM                     09840000
071221*          AR001-AR-TRANSACTION-RECORD.                           09850000
098600                                                                  09860000
071221******************************************************************09860100
071221*  2800-CHECK-FOR-ADJ-INSERT.                                     09860200
071221*     CHECK IF THIS IS THE RIGHT SPOT TO INSERT THE ADJUSTMENT    09860300
071221*     RECORD OR NOT.  AFTER ITEMS, BEFORE EVERYTHING ELSE.        09860400
071221******************************************************************09860600
071221 2800-CHECK-FOR-ADJ-INSERT.                                       09860700
071221      IF AR001-SALES-TAX-ITEM OR                                  09860900
071221         AR001-OTHER-TENDER   OR                                  09861000
071221         AR001-TLCD-ITEM      OR                                  09861200
071221         AR001-FEE-ITEM                                           09861700
071221          PERFORM 2850-INSERT-ADJ-RECORD                          09861900
071221      ELSE                                                        09862000
071221          MOVE AR001-LNE-ITM-SEQ-NBR  TO AV-LNE-ITM-SEQ-NBR       09862100
071221          MOVE AR001-LINE-NUMBER      TO AV-LINE-NUMBER           09862200
071221          MOVE AV-LINE-NUMBER-9       TO AR-LINE-NUMBER           09862300
071221      END-IF.                                                     09862400
071221                                                                  09862500
071221******************************************************************09862600
071221*  2825-STORE-AR-TRAN-FIELDS.                                     09862700
071221*     STORE OFF THE KEY TRANSACTION FIELDS FOR LATER USE ON THE   09862800
071221*     ADJUSTMENT.                                                 09862900
071221******************************************************************09863000
071221 2825-STORE-AR-TRAN-FIELDS.                                       09863100
071221     INITIALIZE AR-INHERIT-VARIABLES.                             09863300
071221     MOVE AR001-TRANSACTION-SOURCE  TO AV-TRANSACTION-SOURCE.     09863500
071221     MOVE AR001-ACCOUNT-NUMBER      TO AV-ACCOUNT-NUMBER.         09863600
071221     MOVE AR001-TRANSACTION-CODE    TO AV-TRANSACTION-CODE.       09863700
071221     MOVE AR001-TRANSACTION-DATE    TO AV-TRANSACTION-DATE.       09863800
071221     MOVE AR001-STORE-NUMBER        TO AV-STORE-NUMBER.           09863900
071221     MOVE AR001-TERMINAL-NUMBER     TO AV-TERMINAL-NUMBER.        09864000
071221     MOVE AR001-TRANSACTION-NUMBER  TO AV-TRANSACTION-NUMBER.     09864100
071221     MOVE AR001-TRN-STAT-CDE        TO AV-TRN-STAT-CDE.           09864200
071221     MOVE AR001-SUBMITTED-BY-USERID TO AV-SUBMITTED-BY-USERID.    09864300
071221     MOVE AR001-AUTH-NUMBER         TO AV-AUTH-NUMBER.            09864400
071221     MOVE AR001-REG-OPERATOR-ID     TO AV-REG-OPERATOR-ID.        09864500
071221     MOVE AR001-PARTITION-NUMBER    TO AV-PARTITION-NUMBER.       09864600
071221     MOVE AR001-START-TIME          TO AV-START-TIME.             09864700
071221     MOVE AR001-SLS-CORR-SEQ-NBR    TO AV-SLS-CORR-SEQ-NUM.       09864800
071221     MOVE AR001-SHIP-ADDR-ZIP       TO AV-SHIP-ADDR-ZIP.          09864900
071221     MOVE AR001-SHIP-GEO-CODE       TO AV-SHIP-GEO-CODE.          09865000
071221     MOVE AR001-ORD-NBR             TO AV-ORD-NBR.                09865100
071221     MOVE AR001-ORDER-DATE-CCYY     TO AV-ORDER-DATE-CCYY.        09865200
071221     MOVE AR001-ORDER-DATE-MM       TO AV-ORDER-DATE-MM.          09865300
071221     MOVE AR001-ORDER-DATE-DD       TO AV-ORDER-DATE-DD.          09865400
071221     MOVE AR001-POS-CPBL-LVL-NBR    TO AV-POS-CPBL-LVL-NBR.       09865500
071221     MOVE AR001-TRN-DTE             TO AV-TRN-DTE.                09865600
071221     MOVE AR001-ORG-STR-NBR         TO AV-ORG-STR-NBR.            09865700
071221     MOVE AR001-OMNI-CHL-FLMT-IND   TO AV-OMNI-CHL-FLMT-IND.      09865800
071221     MOVE AR001-AUTH-REF-NBR        TO AV-AUTH-REF-NBR.           09865900
071221     MOVE AR001-TNDR-SEQ-NBR        TO AV-TNDR-SEQ-NBR.           09866000
071221     MOVE AR001-SCANNED-KEYED-IND   TO AV-SCANNED-KEYED-IND.      09866100
071221     MOVE AR001-CRS-EMPLOYEE-CODE   TO AV-CRS-EMPLOYEE-CODE.      09866200
071221                                                                  09866300
071221******************************************************************09866400
071221*  2850-INSERT-ADJ-RECORD.                                        09866500
071221*     INSERT A CREDIT ADJUSTMENT RECORD INTO THE OUTPUT FILE      09866600
071221*     RIGHT AFTER THE TLD ENTRIES AND RIGHT BEFORE THE TAX        09866700
071221*     RECORD IS WRITTEN OUT.                                      09866800
071221******************************************************************09866900
071221 2850-INSERT-ADJ-RECORD.                                          09867000
071221                                                                  09867200
071221     MOVE AR001-AR-TRANSACTION-RECORD                             09867300
071221                                  TO AR-SAVE-AR-CURR-TRAN-RECORD. 09867400
071221     SET PS-AR-OOB-TRAN-ADJSTD-YES TO TRUE.                       09867500
071221     INITIALIZE AR001-AR-TRANSACTION-RECORD.                      09867600
071221     SET AR001-ADJ-ITEM TO TRUE.                                  09867700
071221     MOVE AV-TRANSACTION-SOURCE   TO AR001-TRANSACTION-SOURCE.    09867800
071221     MOVE AV-ACCOUNT-NUMBER       TO AR001-ACCOUNT-NUMBER.        09867900
071221     MOVE AV-TRANSACTION-CODE     TO AR001-TRANSACTION-CODE.      09868000
071221     MOVE AV-TRANSACTION-DATE     TO AR001-TRANSACTION-DATE.      09868100
071221     MOVE AV-STORE-NUMBER         TO AR001-STORE-NUMBER.          09868200
071221     MOVE AV-TERMINAL-NUMBER      TO AR001-TERMINAL-NUMBER.       09868300
071221     MOVE AV-TRANSACTION-NUMBER   TO AR001-TRANSACTION-NUMBER.    09868400
071221     MOVE AV-TRN-STAT-CDE         TO AR001-TRN-STAT-CDE.          09868500
071221     MOVE AV-SUBMITTED-BY-USERID  TO AR001-SUBMITTED-BY-USERID.   09868600
071221     MOVE AV-AUTH-NUMBER          TO AR001-AUTH-NUMBER.           09868700
071221     MOVE AV-REG-OPERATOR-ID      TO AR001-REG-OPERATOR-ID.       09868800
071221     MOVE AV-PARTITION-NUMBER     TO AR001-PARTITION-NUMBER.      09868900
071221     MOVE AV-START-TIME           TO AR001-START-TIME.            09869000
071221     MOVE AV-SLS-CORR-SEQ-NUM     TO AR001-SLS-CORR-SEQ-NBR.      09869100
071221     MOVE AV-SHIP-ADDR-ZIP        TO AR001-SHIP-ADDR-ZIP.         09869200
071221     MOVE AV-SHIP-GEO-CODE        TO AR001-SHIP-GEO-CODE.         09869300
071221     MOVE AV-ORD-NBR              TO AR001-ORD-NBR.               09869400
071221     MOVE AV-ORDER-DATE-CCYY      TO AR001-ORDER-DATE-CCYY.       09869500
071221     MOVE AV-ORDER-DATE-MM        TO AR001-ORDER-DATE-MM.         09869600
071221     MOVE AV-ORDER-DATE-DD        TO AR001-ORDER-DATE-DD.         09869700
071221     MOVE AV-POS-CPBL-LVL-NBR     TO AR001-POS-CPBL-LVL-NBR.      09869800
071221     MOVE AV-TRN-DTE              TO AR001-TRN-DTE.               09869900
071221     MOVE AV-ORG-STR-NBR          TO AR001-ORG-STR-NBR.           09870000
071221     MOVE AV-OMNI-CHL-FLMT-IND    TO AR001-OMNI-CHL-FLMT-IND.     09870100
071221     MOVE AV-AUTH-REF-NBR         TO AR001-AUTH-REF-NBR.          09870200
071221     MOVE AV-TNDR-SEQ-NBR         TO AR001-TNDR-SEQ-NBR.          09870300
071221     MOVE AV-SCANNED-KEYED-IND    TO AR001-SCANNED-KEYED-IND.     09870400
071221     MOVE AV-CRS-EMPLOYEE-CODE    TO AR001-CRS-EMPLOYEE-CODE.     09870500
071221     MOVE SPACES                  TO AR001-BOGO-PROMO-CDE         09870600
071221                                     AR001-TIER-MKDN-IND          09870700
071221                                     AR001-ASSOC-ID               09870800
071221                                     AR001-ASSOC-CASH             09870900
071221                                     AR001-RCPT-TX-TOT-CDE        09871000
071221                                     AR001-TNDR-TYP-CDE           09871100
071221                                     AR001-EMP-DISC-SRC-CDE       09871200
071221                                     AR001-TRN-GP-CDE             09871300
071221                                     AR001-SHIP-ADDR-ST           09871400
071221                                     AR001-BIN-NUMBER             09871500
071221                                     AR001-FEE-DESC               09871600
071221                                     AR001-PRD-CDE                09871700
071221                                     AR001-PAR-SHP-IND.           09871800
071221     MOVE ZEROES                  TO AR001-UNITS-SOLD             09871900
071221                                     AR001-REFERRAL-TYPE          09872000
071221                                     AR001-EMP-DISC-AMT           09872100
071221                                     AR001-EMPL-DISC-TRN-AMT      09872200
071221                                     AR001-TLD-PCT                09872300
071221                                     AR001-SBJCT-TO-TX-AMT        09872400
071221                                     AR001-RET-AMT                09872500
071221                                     AR001-TAX-RATE-PCT           09872600
071221                                     AR001-TAX-AMOUNT             09872700
071221                                     AR001-RET-AMT                09872800
071221                                     AR001-BOGO-SEQ-NBR           09872900
071221                                     AR001-MULT-CLR-SEQ-NBR       09873000
071221                                     AR001-TOT-SHP-NBR            09873100
071221                                     AR001-RCPT-SEQ-NBR           09873200
071221                                     AR001-TAX-THRESH-AMOUNT      09873300
071221                                     AR001-TAX-RATE-BELOW-THRESH. 09873400
071221     MOVE 'S'                     TO AR001-FULFILLMENT-TYPE.      09873500
071221     MOVE 'N'                     TO AR001-TAXABLE-IND.           09873600
071221     MOVE 'D'                     TO AR001-TLD-TYPE.              09873700
071221     MOVE AV-LNE-ITM-SEQ-NBR      TO AR001-LNE-ITM-SEQ-NBR.       09873800
071221     ADD +1 TO AR-LINE-NUMBER.                                    09874100
071221     MOVE AR-LINE-NUMBER          TO AV-LINE-NUMBER-9.            09874200
071221     MOVE AV-LINE-NUMBER          TO AR001-LINE-NUMBER.           09874300
071221     MOVE 00000000                TO AR001-MERCHANDISE-ID         09874500
071221                                     AR001-SKU-NBR.               09874600
071221     MOVE 'N'                     TO AR001-GIFT-RCPT-CDE.         09874700
071221     IF AR001-POS-CHARGE                                          09874900
071221         COMPUTE AV-VAR-AMT =                                     09875000
071221                 AV-VAR-AMT * -1                                  09875100
071221         END-COMPUTE                                              09875200
071221     END-IF.                                                      09875300
071221     MOVE AV-VAR-AMT              TO AR001-TRANSACTION-AMOUNT     09875400
071221                                     AR001-NET-CHARGED-AMOUNT.    09875500
071221     MOVE AV-START-TIME (1:2)     TO AR-TIME-HH.                  09875600
071221     MOVE AV-START-TIME (4:2)     TO AR-TIME-MM.                  09875700
071221     MOVE AR-TIME-HHMM            TO AR001-TRANSACTION-TIME.      09875800
071221     MOVE AR001-STORE-NUMBER      TO AR-BACKUP-STORE.             09876200
071221     MOVE AR001-ORG-STR-NBR       TO AR-BACKUP-ORG-STR.           09876300
071221     MOVE AR001-ACCOUNT-NUMBER    TO AR-BACKUP-ACCOUNT-NBR.       09876400
071221     WRITE AR-ACCOUNTS-RECEIVABLE-RECORD FROM                     09876500
071221                                      AR001-AR-TRANSACTION-RECORD.09876600
071221     MOVE AR-BACKUP-STORE         TO AR001-STORE-NUMBER.          09876700
071221     MOVE AR-BACKUP-ORG-STR       TO AR001-ORG-STR-NBR.           09876800
071221     MOVE AR-BACKUP-ACCOUNT-NBR   TO AR001-ACCOUNT-NUMBER.        09876900
071221     MOVE AR-SAVE-AR-CURR-TRAN-RECORD                             09877000
071221                                  TO AR001-AR-TRANSACTION-RECORD. 09877100
071221                                                                  09878000
071221***************************************************************   09880000
071221*  2900-WRITE-PREV-TRANSACTION.                                   09893400
071221*     WRITE OUTPUT FILE                                           09893500
071221******************************************************************09893600
071221 2900-WRITE-PREV-TRANSACTION.                                     09893700
071221                                                                  09893900
071221     IF PS-AR-OOB-TRAN-YES                                        09894000
071221         SET PS-AR-OOB-TRAN-ADJSTD-NO TO TRUE                     09894100
071221         ADD +1 TO AR-TRAN-COUNT                                  09894200
071221     END-IF.                                                      09895400
071221     MOVE AR001-AR-TRANSACTION-RECORD                             09895800
071221                             TO AR-SAVE-AR-TRANSACTION-RECORD.    09895900
071221                                                                  09896000
071221     MOVE ZERO               TO AR-LINE-NUMBER.                   09896100
071221     SET PS-AR-TRAN-KEY-STORED-NO TO TRUE.                        09896200
071221     SET AV-MSG-IDX-TOT      TO AR-MSG-IDX.                       09896400
071221     PERFORM                                                      09896600
071221         VARYING AR-MSG-IDX                                       09896700
071221         FROM 1 BY 1                                              09896800
071221         UNTIL AR-MSG-IDX > (AV-MSG-IDX-TOT - 1)                  09896900
071221            MOVE AR-OUTPUT-LINE(AR-MSG-IDX)                       09897000
071221                             TO AR001-AR-TRANSACTION-RECORD       09897100
071221            IF AR-TRAN-COUNT < PC-MAX-CREDIT-ADJ                  09897400
071221               IF PS-AR-OOB-TRAN-YES                              09897500
071221                  IF PS-AR-TRAN-KEY-STORED-NO                     09897700
071221                      PERFORM 2825-STORE-AR-TRAN-FIELDS           09897900
071221                      SET PS-AR-TRAN-KEY-STORED-YES TO TRUE       09898000
071221                  END-IF                                          09898100
071221                  IF PS-AR-OOB-TRAN-ADJSTD-NO                     09898200
071221                      PERFORM 2800-CHECK-FOR-ADJ-INSERT           09898400
071221                  END-IF                                          09898500
071221                  IF PS-AR-OOB-TRAN-ADJSTD-YES                    09898600
071221                      ADD +1 TO AR-LINE-NUMBER                    09898800
071221                      MOVE AR-LINE-NUMBER TO AV-LINE-NUMBER-9     09898900
071221                      MOVE AV-LINE-NUMBER TO AR001-LINE-NUMBER    09899000
071221                  END-IF                                          09899100
071221               END-IF                                             09899200
071221            END-IF                                                09900100
071221            WRITE AR-ACCOUNTS-RECEIVABLE-RECORD FROM              09900200
071221                  AR001-AR-TRANSACTION-RECORD                     09900300
071221     END-PERFORM.                                                 09900400
071221     IF PS-AR-OOB-TRAN-YES AND                                    09900500
071221        PS-AR-OOB-TRAN-ADJSTD-NO                                  09900600
071221         PERFORM 2850-INSERT-ADJ-RECORD                           09900800
071221     END-IF.                                                      09900900
071221     MOVE AR-SAVE-AR-TRANSACTION-RECORD                           09901300
071221                             TO AR001-AR-TRANSACTION-RECORD.      09901400
071221     INITIALIZE AR-OUTPUT-ARRAY.                                  09901500
071221     SET AR-MSG-IDX TO +1.                                        09901600
071221     SET PS-AR-OOB-TRAN-NO TO TRUE.                               09901700
071221                                                                  09901900
098700******************************************************************09903200
098800*  PROCESS THE TRANSACTION BREAK                                  09903300
098900******************************************************************09903400
099000 3000-TRANSACTION-BREAK.                                          09903500
099100                                                                  09910000
099200     PERFORM 3100-PREPARE-AUDIT-RPT-LINE.                         09920000
099300                                                                  09930000
099400***** WHEN THE TRANSACTION TOTAL ON THE AR TRANSACTION FILE DOES  09940000
099500***** NOT MATCH THE TENDER AMOUNT ON TEPTND, WRITE AN OUT OF      09950000
099600***** BALANCE REPORT LINE FOR THE TRANSACTION.                    09960000
099700                                                                  09970000
EMPCSH     IF PV-SAVE-PAYMENT-IND NOT EQUAL 'Y' OR                      09980000
EMPCSH        PV-SAVE-TRAN-SOURCE = 'L'                                 09981000
099900         PERFORM 3200-GET-TNDR-AMT                                09990000
100000         IF EPTND-TNDR-AMT NOT EQUAL PA-TRANSACTION-AMOUNT        10000000
100100             PERFORM 3300-WRITE-OUT-OF-BAL                        10010000
100200         END-IF                                                   10020000
100300     END-IF.                                                      10030000
100400                                                                  10040000
071221*    WRITE OUT THE PREVIOUS TRANSACTION FROM ARRAY HERE           10041000
071221     PERFORM 2900-WRITE-PREV-TRANSACTION.                         10044000
071221                                                                  10045000
100500     INITIALIZE TL1-TOTAL-LINE-RPT-1.                             10050000
100600     MOVE TI1-TRANSACTION-ID       TO TL1-TOTAL-TYPE-ID.          10060000
100700     MOVE PC-TOTAL-TYPE-TRANSACTION                               10070000
100800                                   TO TL1-TOTAL-TYPE.             10080000
100900     MOVE PA-TRANSACTION-AMOUNT    TO TL1-SALES-AMOUNT.           10090000
101000     MOVE PA-TRANSACTION-PAYMENTS-AMOUNT                          10100000
101100                                   TO TL1-PAYMENT-AMOUNT.         10110000
101200                                                                  10120000
101300     MOVE TL1-TOTAL-LINE-RPT-1     TO PV-PRINT-RECORD.            10130000
101400     PERFORM 8000-PRINT-DETAIL-RPT-LINE.                          10140000
101500     SET PV-DOUBLE-SPACE-RPT1 TO TRUE.                            10150000
101600                                                                  10160000
101700     IF PA-TRANSACTION-AMOUNT      >= 0                           10170000
101800         COMPUTE PA-REGISTER-SALES-AMOUNT                         10180000
101900                                   = PA-TRANSACTION-AMOUNT        10190000
102000                                   + PA-REGISTER-SALES-AMOUNT     10200000
102100     ELSE                                                         10210000
102200         COMPUTE PA-REGISTER-RETURNS-AMOUNT                       10220000
102300                                   = PA-TRANSACTION-AMOUNT        10230000
102400                                   + PA-REGISTER-RETURNS-AMOUNT   10240000
102500     END-IF.                                                      10250000
102600                                                                  10260000
102700     ADD PA-TRANSACTION-PAYMENTS-AMOUNT                           10270000
102800                                   TO PA-REGISTER-PAYMENTS-AMOUNT.10280000
102900     INITIALIZE PA-TRANSACTION-AMOUNT                             10290000
103000                PA-TRANSACTION-PAYMENTS-AMOUNT.                   10300000
103100                                                                  10310000
103200****************************************************************  10320000
103300*  PREPARE A LINE FOR THE AUDIT REPORT                            10330000
103400***************************************************************** 10340000
103500 3100-PREPARE-AUDIT-RPT-LINE.                                     10350000
103600                                                                  10360000
103700     INITIALIZE DL2-DETAIL-LINE-RPT-2.                            10370000
103800     MOVE PV-SAVE-RGST-ID          TO DL2-REGISTER-NUMBER.        10380000
103900     MOVE PV-SAVE-TRN-NBR          TO DL2-TRANSACTION-NUMBER.     10390000
104000     MOVE FA-FORMATTED-ACCOUNT-NUMBER                             10400000
104100                                   TO DL2-ACCOUNT-NUMBER.         10410000
104200     MOVE PV-SAVE-LEVEL-OF-ISSUE   TO DL2-LEVEL-OF-ISSUE.         10420000
104300     MOVE PV-SAVE-AUTH-NUMBER      TO DL2-AUTH-NUMBER.            10430000
104400     MOVE PV-SAVE-ASSOC-ID         TO DL2-ASSOC-ID.               10440000
104500                                                                  10450000
104600     IF PS-PAYMENT-YES                                            10460000
104700         MOVE PA-TRANSACTION-PAYMENTS-AMOUNT                      10470000
104800                                   TO DL2-PAYMENTS-AMOUNT         10480000
104900     ELSE                                                         10490000
105000         IF PA-TRANSACTION-AMOUNT  >= ZERO                        10500000
105100             MOVE PA-TRANSACTION-AMOUNT                           10510000
105200                                   TO DL2-SALES-AMOUNT            10520000
105300         ELSE                                                     10530000
105400             MOVE PA-TRANSACTION-AMOUNT                           10540000
105500                                   TO DL2-RETURNS-AMOUNT          10550000
105600         END-IF                                                   10560000
105700     END-IF.                                                      10570000
105800                                                                  10580000
105900     MOVE DL2-DETAIL-LINE-RPT-2    TO PV-PRINT-RECORD.            10590000
106000     PERFORM 8100-PRINT-AUDIT-RPT-LINE.                           10600000
106100     SET PV-SINGLE-SPACE-RPT2      TO TRUE.                       10610000
106200                                                                  10620000
106300****************************************************************  10630000
106400*  GET THE KOHL'S CHARGE TENDER AMOUNT FROM TEPTND FOR THIS    *  10640000
106500*  TRANSACTION.                                                *  10650000
106600****************************************************************  10660000
106700 3200-GET-TNDR-AMT.                                               10670000
106800                                                                  10680000
106900     MOVE PV-SAVE-PARTN-NBR         TO EPTND-PARTN-NBR.           10690000
107000     MOVE PV-SAVE-STR-NBR           TO EPTND-STR-NBR.             10700000
107100     MOVE PV-SAVE-RGST-ID           TO EPTND-RGST-ID.             10710000
107200     MOVE PV-SAVE-TRN-NBR           TO EPTND-TRN-NBR.             10720000
107300     MOVE PV-SAVE-STRT-TM           TO EPTND-STRT-TM.             10730000
107400     MOVE PV-SAVE-SLS-CORR-SEQ-NBR  TO EPTND-SLS-CORR-SEQ-NBR.    10740000
107500     MOVE PV-SAVE-TNDR-SEQ-NBR      TO EPTND-TNDR-SEQ-NBR.        10750000
107600                                                                  10760000
107700     EXEC SQL                                                     10770000
107800         SELECT TNDR_AMT                                          10780000
107900           INTO :EPTND-TNDR-AMT                                   10790000
108000           FROM TEPTND                                            10800000
108100          WHERE PARTN_NBR        =  :EPTND-PARTN-NBR              10810000
108200            AND STR_NBR          =  :EPTND-STR-NBR                10820000
108300            AND RGST_ID          =  :EPTND-RGST-ID                10830000
108400            AND TRN_NBR          =  :EPTND-TRN-NBR                10840000
108500            AND STRT_TM          =  :EPTND-STRT-TM                10850000
108600            AND SLS_CORR_SEQ_NBR =  :EPTND-SLS-CORR-SEQ-NBR       10860000
108700            AND TNDR_SEQ_NBR     =  :EPTND-TNDR-SEQ-NBR           10870000
108800            WITH UR                                               10880000
108900     END-EXEC.                                                    10890000
109000                                                                  10900000
109100     EVALUATE SQLCODE                                             10910000
109200         WHEN ZERO                                                10920000
109300             CONTINUE                                             10930000
109400         WHEN OTHER                                               10940000
109500             DISPLAY 'PARTN - ' EPTND-PARTN-NBR                   10950000
109600             DISPLAY 'STORE - ' EPTND-STR-NBR                     10960000
109700             DISPLAY 'RGST  - ' EPTND-RGST-ID                     10970000
109800             DISPLAY 'TRN   - ' EPTND-TRN-NBR                     10980000
109900                                                                  10990000
110000             MOVE '3200-GET-TNDR-AMT'                             11000000
110100                                   TO PV-PARAGRAPH-NAME           11010000
110200             MOVE 'ERROR ON SELECTING FROM TEPTND'                11020000
110300                                   TO PV-DB2-OPERATION            11030000
110400             PERFORM 9200-SQL-ABEND                               11040000
110500     END-EVALUATE.                                                11050000
110600                                                                  11060000
110700****************************************************************  11070000
110800*  FORMAT A REPORT LINE FOR THE OUT OF BALANCE REPORT.         *  11080000
110900*  IF THE CURRENT PAGE IS FULL OF LINES, PERFORM THE PAGE      *  11090000
111000*  BREAK ROUTINE.  GET THE VOID ABORT CODE FROM TEPTRN.  IF IT *  11100000
111100*  INDICATES THAT THE TRANSACTION WAS VOID, PUT A COMMENT ON   *  11110000
111200*  THE DETAIL LINE.                                            *  11120000
111300****************************************************************  11130000
111400 3300-WRITE-OUT-OF-BAL.                                           11140000
111500                                                                  11150000
111600     MOVE EPTND-TNDR-AMT           TO PV-TNDR-AMT.                11160000
111700     COMPUTE PV-VAR-AMT =                                         11170000
111800             PA-TRANSACTION-AMOUNT - EPTND-TNDR-AMT               11180000
111900     END-COMPUTE.                                                 11190000
112000                                                                  11200000
112100     PERFORM 3310-GET-VOID-ABRT-CDE.                              11210000
112200                                                                  11220000
112300     EVALUATE EPTRN-VOID-ABRT-CDE                                 11230000
112400         WHEN 'N'                                                 11240000
112500             SET RD4-NO-COMMENT TO TRUE                           11250000
112600         WHEN 'V'                                                 11260000
112700             SET RD4-LATE-VOID-COMMENT TO TRUE                    11270000
112800             COMPUTE PV-VAR-AMT =                                 11280000
112900                     (PA-TRANSACTION-AMOUNT * -1) -               11290000
113000                     EPTND-TNDR-AMT                               11300000
113100             END-COMPUTE                                          11310000
113200             COMPUTE PV-TNDR-AMT = EPTND-TNDR-AMT * -1            11320000
113300         WHEN OTHER                                               11330000
113400             SET RD4-NO-COMMENT TO TRUE                           11340000
113500     END-EVALUATE.                                                11350000
113600                                                                  11360000
071221     SET PS-AR-OOB-TRAN-YES TO TRUE.                              11361000
071221     MOVE PV-SAVE-PARTN-NBR        TO AV-PARTN-NBR.               11370000
071221     MOVE PV-SAVE-STR-NBR          TO AV-STR-NBR.                 11380000
071221     MOVE PV-SAVE-RGST-ID          TO AV-RGST-ID.                 11390000
071221     MOVE PV-SAVE-TRN-NBR          TO AV-TRN-NBR.                 11400000
071221     MOVE PV-SAVE-STRT-TM          TO AV-STRT-TM.                 11410000
071221     MOVE PV-SAVE-SLS-CORR-SEQ-NBR TO AV-SLS-CORR-SEQ-NBR.        11420000
071221     MOVE PV-TNDR-AMT              TO AV-TNDR-AMT.                11420100
071221     MOVE PA-TRANSACTION-AMOUNT    TO AV-TRANSACTION-AMT.         11420200
071221     MOVE PV-VAR-AMT               TO AV-VAR-AMT.                 11420300
071221                                                                  11420600
113700     MOVE PV-SAVE-STR-NBR          TO RD4-STR-NBR.                11421000
113800     MOVE PV-SAVE-DATE             TO RD4-SLS-DTE.                11422000
113900     MOVE PV-SAVE-RGST-ID          TO RD4-RGST-ID.                11423000
114000     MOVE PV-SAVE-TRN-NBR          TO RD4-TRN-NBR.                11424000
114100     MOVE PV-SAVE-STRT-TM          TO RD4-STRT-TM.                11425000
114200     MOVE PV-SAVE-SLS-CORR-SEQ-NBR TO RD4-SLS-CORR-SEQ-NBR.       11426000
114300     MOVE PV-TNDR-AMT              TO RD4-TEPTND-TNDR-AMT.        11430000
114400     MOVE PA-TRANSACTION-AMOUNT    TO RD4-AR001-TNDR-AMT.         11440000
114500     MOVE PV-VAR-AMT               TO RD4-VAR-AMT.                11450000
071221     IF PS-AR-OOB-TRAN-YES AND                                    11451000
071221        AR-TRAN-COUNT < PC-MAX-CREDIT-ADJ                         11452000
071221         MOVE 'Y'                  TO RD4-ADJ-IND                 11452100
071221     ELSE                                                         11453000
071221         MOVE 'N'                  TO RD4-ADJ-IND                 11453100
071221         SET PS-AR-OOB-TRAN-NO TO TRUE                            11453200
071221     END-IF.                                                      11454000
114600                                                                  11460000
114700     ADD  1                        TO PV-LINE-COUNT-RPT4.         11470000
114800                                                                  11480000
114900     IF PV-LINE-COUNT-RPT4         > PC-PAGE-SIZE                 11490000
115000         PERFORM 3400-PRINT-RPT4-HEADINGS                         11500000
115100     END-IF.                                                      11510000
115200                                                                  11520000
115300     WRITE OUT-OF-BAL-RPT-RECORD                                  11530000
115400         FROM RD4-DETAIL-LINE                                     11540000
115500         AFTER ADVANCING 1 LINE                                   11550000
115600     END-WRITE.                                                   11560000
115700                                                                  11570000
115800****************************************************************  11580000
115900*  GET THE VOID ABORT CODE FOR THE TRANSACTION FROM TEPTRN.    *  11590000
116000****************************************************************  11600000
116100 3310-GET-VOID-ABRT-CDE.                                          11610000
116200                                                                  11620000
116300     MOVE PV-SAVE-PARTN-NBR         TO EPTRN-PARTN-NBR.           11630000
116400     MOVE PV-SAVE-STR-NBR           TO EPTRN-STR-NBR.             11640000
116500     MOVE PV-SAVE-RGST-ID           TO EPTRN-RGST-ID.             11650000
116600     MOVE PV-SAVE-TRN-NBR           TO EPTRN-TRN-NBR.             11660000
116700     MOVE PV-SAVE-STRT-TM           TO EPTRN-STRT-TM.             11670000
116800     MOVE PV-SAVE-SLS-CORR-SEQ-NBR  TO EPTRN-SLS-CORR-SEQ-NBR.    11680000
116900                                                                  11690000
117000     EXEC SQL                                                     11700000
117100         SELECT VOID_ABRT_CDE                                     11710000
117200           INTO :EPTRN-VOID-ABRT-CDE                              11720000
117300           FROM TEPTRN                                            11730000
117400          WHERE PARTN_NBR        =  :EPTRN-PARTN-NBR              11740000
117500            AND STR_NBR          =  :EPTRN-STR-NBR                11750000
117600            AND RGST_ID          =  :EPTRN-RGST-ID                11760000
117700            AND TRN_NBR          =  :EPTRN-TRN-NBR                11770000
117800            AND STRT_TM          =  :EPTRN-STRT-TM                11780000
117900            AND SLS_CORR_SEQ_NBR =  :EPTRN-SLS-CORR-SEQ-NBR       11790000
118000            WITH UR                                               11800000
118100     END-EXEC.                                                    11810000
118200                                                                  11820000
118300     EVALUATE SQLCODE                                             11830000
118400         WHEN ZERO                                                11840000
118500             CONTINUE                                             11850000
118600         WHEN OTHER                                               11860000
118700             MOVE '3310-GET-VOID-ABRT-CDE'                        11870000
118800                                   TO PV-PARAGRAPH-NAME           11880000
118900             MOVE 'ERROR ON SELECTING FROM TEPTRN'                11890000
119000                                   TO PV-DB2-OPERATION            11900000
119100             PERFORM 9200-SQL-ABEND                               11910000
119200     END-EVALUATE.                                                11920000
119300                                                                  11930000
119400******************************************************************11940000
119500*  PRINT REPORT HEADINGS FOR THE OUT OF BALANCE REPORT.          *11950000
119600******************************************************************11960000
119700 3400-PRINT-RPT4-HEADINGS.                                        11970000
119800                                                                  11980000
119900     ADD  1                   TO PV-PAGE-COUNT-RPT4.              11990000
120000                                                                  12000000
120100     MOVE 4                   TO DP132O-REPORT-NUMBER.            12010000
120200     MOVE PV-SAVE-STR-NBR     TO HL2-STORE-NMBR.                  12020000
120300     MOVE PV-PAGE-COUNT-RPT4  TO DP132O-PAGE-NUMBER.              12030000
120400     MOVE PV-NEW-FRONT-RPT4   TO DP132O-LASER-NEW-PAGE-INDICATR.  12040000
120500                                                                  12050000
120600     WRITE OUT-OF-BAL-RPT-RECORD                                  12060000
120700         FROM DP132O-STANDRD-HEADER-132-COLS                      12070000
120800         AFTER ADVANCING PAGE                                     12080000
120900     END-WRITE.                                                   12090000
121000                                                                  12100000
121100     WRITE OUT-OF-BAL-RPT-RECORD                                  12110000
121200         FROM RH4-HEAD1                                           12120000
121300         AFTER ADVANCING 1 LINE                                   12130000
121400     END-WRITE.                                                   12140000
121500                                                                  12150000
121600     WRITE OUT-OF-BAL-RPT-RECORD                                  12160000
121700         FROM RH4-HEAD2                                           12170000
121800         AFTER ADVANCING 2 LINE                                   12180000
121900     END-WRITE.                                                   12190000
122000                                                                  12200000
122100     WRITE OUT-OF-BAL-RPT-RECORD                                  12210000
122200         FROM RH4-HEAD3                                           12220000
122300         AFTER ADVANCING 1 LINE                                   12230000
122400     END-WRITE.                                                   12240000
122500                                                                  12250000
122600     MOVE SPACES TO OUT-OF-BAL-RPT-RECORD.                        12260000
122700                                                                  12270000
122800     WRITE OUT-OF-BAL-RPT-RECORD                                  12280000
122900         AFTER ADVANCING 1 LINE                                   12290000
123000     END-WRITE.                                                   12300000
123100                                                                  12310000
123200     MOVE 5 TO PV-LINE-COUNT-RPT4.                                12320000
123300                                                                  12330000
123400******************************************************************12340000
123500*  PROCESS THE REGISTER BREAK                                     12350000
123600******************************************************************12360000
123700 4000-REGISTER-BREAK.                                             12370000
123800                                                                  12380000
123900     PERFORM 3000-TRANSACTION-BREAK.                              12390000
124000                                                                  12400000
124100     INITIALIZE TL1-TOTAL-LINE-RPT-1.                             12410000
124200     MOVE PV-SAVE-RGST-ID          TO TI1-REGISTER-NUMBER         12420000
124300                                      RTL2-REGISTER-NUMBER.       12430000
124400     MOVE TI1-REGISTER-ID          TO TL1-TOTAL-TYPE-ID.          12440000
124500     MOVE PC-TOTAL-TYPE-REGISTER                                  12450000
124600                                   TO TL1-TOTAL-TYPE.             12460000
124700     MOVE PA-REGISTER-SALES-AMOUNT TO RTL2-REGISTER-SALES-AMOUNT. 12470000
124800     MOVE PA-REGISTER-RETURNS-AMOUNT                              12480000
124900                              TO RTL2-REGISTER-RETURNS-AMOUNT.    12490000
125000     MOVE PA-REGISTER-PAYMENTS-AMOUNT                             12500000
125100                              TO RTL2-REGISTER-PAYMENTS-AMOUNT.   12510000
125200     COMPUTE PA-STORE-SALES-AMOUNT = PA-STORE-SALES-AMOUNT        12520000
125300                                   + PA-REGISTER-SALES-AMOUNT.    12530000
125400     COMPUTE PA-STORE-RETURNS-AMOUNT                              12540000
125500                                   = PA-STORE-RETURNS-AMOUNT      12550000
125600                                   + PA-REGISTER-RETURNS-AMOUNT.  12560000
125700     COMPUTE PA-STORE-PAYMENTS-AMOUNT                             12570000
125800                                   = PA-STORE-PAYMENTS-AMOUNT     12580000
125900                                   + PA-REGISTER-PAYMENTS-AMOUNT. 12590000
126000     COMPUTE PA-REGISTER-SALES-AMOUNT                             12600000
126100                                   = PA-REGISTER-SALES-AMOUNT     12610000
126200                                   + PA-REGISTER-RETURNS-AMOUNT.  12620000
126300     MOVE PA-REGISTER-SALES-AMOUNT TO TL1-SALES-AMOUNT.           12630000
126400     MOVE PA-REGISTER-PAYMENTS-AMOUNT                             12640000
126500                                   TO TL1-PAYMENT-AMOUNT.         12650000
126600                                                                  12660000
126700     MOVE TL1-TOTAL-LINE-RPT-1     TO PV-PRINT-RECORD.            12670000
126800     PERFORM 8000-PRINT-DETAIL-RPT-LINE.                          12680000
126900     SET PV-DOUBLE-SPACE-RPT1      TO TRUE.                       12690000
127000     MOVE RTL2-REGISTER-TOTAL-LINE-RPT-2                          12700000
127100                                   TO PV-PRINT-RECORD.            12710000
127200     PERFORM 8100-PRINT-AUDIT-RPT-LINE.                           12720000
127300     SET PV-DOUBLE-SPACE-RPT2      TO TRUE.                       12730000
127400     INITIALIZE PA-REGISTER-SALES-AMOUNT                          12740000
127500                PA-REGISTER-RETURNS-AMOUNT                        12750000
127600                PA-REGISTER-PAYMENTS-AMOUNT.                      12760000
127700                                                                  12770000
127800******************************************************************12780000
127900*  PROCESS THE STORE BREAK                                        12790000
128000******************************************************************12800000
128100 5000-STORE-BREAK.                                                12810000
128200                                                                  12820000
128300     PERFORM 4000-REGISTER-BREAK.                                 12830000
128400     INITIALIZE TL1-TOTAL-LINE-RPT-1.                             12840000
128500     MOVE PV-SAVE-STR-NBR          TO TI1-STORE-NUMBER            12850000
128600                                      STL2-STORE-NUMBER           12860000
128700                                      STL3-STORE-NUMBER.          12870000
128800     MOVE TI1-STORE-ID             TO TL1-TOTAL-TYPE-ID.          12880000
128900     MOVE PC-TOTAL-TYPE-STORE                                     12890000
129000                                   TO TL1-TOTAL-TYPE.             12900000
129100     MOVE PA-STORE-SALES-AMOUNT    TO STL2-STORE-SALES-AMOUNT     12910000
129200                                      STL3-STORE-SALES-AMOUNT.    12920000
129300     MOVE PA-STORE-RETURNS-AMOUNT  TO STL2-STORE-RETURNS-AMOUNT   12930000
129400                                      STL3-STORE-RETURNS-AMOUNT.  12940000
129500     MOVE PA-STORE-PAYMENTS-AMOUNT TO STL2-STORE-PAYMENTS-AMOUNT  12950000
129600                                      STL3-STORE-PAYMENTS-AMOUNT. 12960000
129700                                                                  12970000
129800     COMPUTE PA-CORP-SALES-AMOUNT  = PA-CORP-SALES-AMOUNT         12980000
129900                                   + PA-STORE-SALES-AMOUNT.       12990000
130000     COMPUTE PA-CORP-RETURNS-AMOUNT                               13000000
130100                                   = PA-CORP-RETURNS-AMOUNT       13010000
130200                                   + PA-STORE-RETURNS-AMOUNT.     13020000
130300     COMPUTE PA-CORP-PAYMENTS-AMOUNT                              13030000
130400                                   = PA-CORP-PAYMENTS-AMOUNT      13040000
130500                                   + PA-STORE-PAYMENTS-AMOUNT.    13050000
130600     COMPUTE PA-STORE-SALES-AMOUNT                                13060000
130700                                   = PA-STORE-SALES-AMOUNT        13070000
130800                                   + PA-STORE-RETURNS-AMOUNT.     13080000
130900     MOVE PA-STORE-SALES-AMOUNT    TO STL3-STORE-NET-AMOUNT.      13090000
131000     MOVE PA-STORE-SALES-AMOUNT    TO TL1-SALES-AMOUNT.           13100000
131100     MOVE PA-STORE-PAYMENTS-AMOUNT TO TL1-PAYMENT-AMOUNT.         13110000
131200                                                                  13120000
131300     MOVE TL1-TOTAL-LINE-RPT-1     TO PV-PRINT-RECORD.            13130000
131400     PERFORM 8000-PRINT-DETAIL-RPT-LINE.                          13140000
131500     SET PV-DOUBLE-SPACE-RPT1      TO TRUE.                       13150000
131600     MOVE STL2-STORE-TOTAL-LINE-RPT-2                             13160000
131700                                   TO PV-PRINT-RECORD.            13170000
131800     PERFORM 8100-PRINT-AUDIT-RPT-LINE.                           13180000
131900     SET PV-DOUBLE-SPACE-RPT2      TO TRUE.                       13190000
132000     MOVE STL3-STORE-TOTAL-LINE-RPT-3                             13200000
132100                                   TO PV-PRINT-RECORD.            13210000
132200     PERFORM 8200-PRINT-STORE-TOTALS-RPT-LN.                      13220000
132300     SET PV-SINGLE-SPACE-RPT3      TO TRUE.                       13230000
132400     MOVE +64                      TO PV-LINE-COUNT-RPT1          13240000
132500                                      PV-LINE-COUNT-RPT2.         13250000
132600     INITIALIZE PA-STORE-SALES-AMOUNT                             13260000
132700                PA-STORE-RETURNS-AMOUNT                           13270000
132800                PA-STORE-PAYMENTS-AMOUNT.                         13280000
132900                                                                  13290000
071221******************************************************************13290100
071221*  DISPLAY ARK OOB TRANSACTIONS WHEN TESTING                      13290200
071221******************************************************************13290300
071221  5000-DISPLAY-ARK-OOB-TRAN.                                      13291000
071221         MOVE AV-PARTN-NBR        TO AV-DISP-PARTN-NBR.           13292000
071221         MOVE AV-STR-NBR          TO AV-DISP-STR-NBR.             13293000
071221         MOVE AV-RGST-ID          TO AV-DISP-RGST-ID.             13294000
071221         MOVE AV-TRN-NBR          TO AV-DISP-TRN-NBR.             13295000
071221         MOVE AV-STRT-TM          TO AV-DISP-STRT-TM.             13296000
071221         MOVE AV-SLS-CORR-SEQ-NBR TO AV-DISP-SLS-CORR-SEQ-NBR.    13297000
071221         MOVE AV-TNDR-AMT         TO AV-DISP-TNDR-AMT.            13298000
071221         MOVE AV-TRANSACTION-AMT  TO AV-DISP-TRANSACTION-AMT.     13299000
071221         MOVE AV-VAR-AMT          TO AV-DISP-VAR-AMT.             13299100
071221         DISPLAY 'ARK OOB TRAN: ',AR-DISPLAY-VARIABLES.           13299200
071221                                                                  13299300
133000******************************************************************13321000
133100*  PROCESS THE FINAL REPORT BREAK                                 13322000
133200******************************************************************13323000
133300 6000-FINAL-BREAK.                                                13330000
133400                                                                  13340000
133500     IF PA-TRANSACTION-COUNT > ZERO                               13350000
133600         PERFORM 5000-STORE-BREAK                                 13360000
133700     END-IF.                                                      13370000
133800                                                                  13380000
133900     INITIALIZE TL1-TOTAL-LINE-RPT-1.                             13390000
134000     MOVE TI1-FINAL-ID             TO TL1-TOTAL-TYPE-ID.          13400000
134100     MOVE PC-TOTAL-TYPE-FINAL      TO TL1-TOTAL-TYPE.             13410000
134200     MOVE PA-CORP-SALES-AMOUNT     TO CTL2-CORP-SALES-AMOUNT      13420000
134300                                      CTL3-CORP-SALES-AMOUNT.     13430000
134400     MOVE PA-CORP-RETURNS-AMOUNT   TO CTL2-CORP-RETURNS-AMOUNT    13440000
134500                                      CTL3-CORP-RETURNS-AMOUNT.   13450000
134600     MOVE PA-CORP-PAYMENTS-AMOUNT  TO CTL2-CORP-PAYMENTS-AMOUNT   13460000
134700                                      CTL3-CORP-PAYMENTS-AMOUNT.  13470000
134800     COMPUTE PA-CORP-SALES-AMOUNT  = PA-CORP-SALES-AMOUNT         13480000
134900                                   + PA-CORP-RETURNS-AMOUNT.      13490000
135000     MOVE PA-CORP-SALES-AMOUNT     TO CTL3-CORP-NET-AMOUNT        13500000
135100     MOVE PA-CORP-SALES-AMOUNT     TO TL1-SALES-AMOUNT.           13510000
135200     MOVE PA-CORP-PAYMENTS-AMOUNT  TO TL1-PAYMENT-AMOUNT.         13520000
135300     MOVE TL1-TOTAL-LINE-RPT-1     TO PV-PRINT-RECORD.            13530000
135400     PERFORM 8000-PRINT-DETAIL-RPT-LINE.                          13540000
135500     SET PV-DOUBLE-SPACE-RPT1 TO TRUE.                            13550000
135600     MOVE CTL2-CORP-TOTAL-LINE-RPT-2                              13560000
135700                                   TO PV-PRINT-RECORD.            13570000
135800     PERFORM 8100-PRINT-AUDIT-RPT-LINE.                           13580000
135900     MOVE CTL3-CORP-TOTAL-LINE-RPT-3                              13590000
136000                                   TO PV-PRINT-RECORD.            13600000
136100     PERFORM 8200-PRINT-STORE-TOTALS-RPT-LN.                      13610000
136200                                                                  13620000
136300     ADD  2                        TO PV-LINE-COUNT-RPT4.         13630000
136400                                                                  13640000
136500     IF PV-LINE-COUNT-RPT4         > PC-PAGE-SIZE                 13650000
136600         PERFORM 3400-PRINT-RPT4-HEADINGS                         13660000
136700     END-IF.                                                      13670000
136800                                                                  13680000
136900     WRITE OUT-OF-BAL-RPT-RECORD                                  13690000
137000         FROM RF4-FOOT1                                           13700000
137100         AFTER ADVANCING 2 LINE                                   13710000
137200     END-WRITE.                                                   13720000
137300                                                                  13730000
137400******************************************************************13740000
137500*  PRINT A LINE ON THE DETAIL REPORT                              13750000
137600******************************************************************13760000
137700 8000-PRINT-DETAIL-RPT-LINE.                                      13770000
137800                                                                  13780000
137900     ADD PV-ADVANCE-COUNT-RPT1 TO PV-LINE-COUNT-RPT1.             13790000
138000                                                                  13800000
138100     IF PV-LINE-COUNT-RPT1         > PC-PAGE-SIZE                 13810000
138200         PERFORM 8300-PRINT-DETAIL-HEADINGS                       13820000
138300         ADD PV-ADVANCE-COUNT-RPT1 TO PV-LINE-COUNT-RPT1          13830000
138400     END-IF.                                                      13840000
138500                                                                  13850000
138600     WRITE CD-CHARGE-DETAIL-RPT-RECORD                            13860000
138700         FROM PV-PRINT-RECORD                                     13870000
138800         AFTER ADVANCING PV-ADVANCE-COUNT-RPT1.                   13880000
138900                                                                  13890000
139000******************************************************************13900000
139100*  PRINT A LINE ON THE AUDIT REPORT                               13910000
139200******************************************************************13920000
139300 8100-PRINT-AUDIT-RPT-LINE.                                       13930000
139400                                                                  13940000
139500     ADD PV-ADVANCE-COUNT-RPT2 TO PV-LINE-COUNT-RPT2.             13950000
139600                                                                  13960000
139700     IF PV-LINE-COUNT-RPT2 > PC-PAGE-SIZE                         13970000
139800         PERFORM 8400-PRINT-AUDIT-HEADINGS                        13980000
139900         ADD PV-ADVANCE-COUNT-RPT2 TO PV-LINE-COUNT-RPT2          13990000
140000     END-IF.                                                      14000000
140100                                                                  14010000
140200     WRITE AR-AUDIT-RPT-RECORD                                    14020000
140300         FROM PV-PRINT-RECORD                                     14030000
140400         AFTER ADVANCING PV-ADVANCE-COUNT-RPT2.                   14040000
140500                                                                  14050000
140600******************************************************************14060000
140700*  PRINT A LINE ON THE STORE TOTALS REPORT                        14070000
140800******************************************************************14080000
140900 8200-PRINT-STORE-TOTALS-RPT-LN.                                  14090000
141000                                                                  14100000
141100     ADD PV-ADVANCE-COUNT-RPT3 TO PV-LINE-COUNT-RPT3.             14110000
141200                                                                  14120000
141300     IF PV-LINE-COUNT-RPT3 > PC-PAGE-SIZE                         14130000
141400         PERFORM 8500-PRINT-STORE-TOTAL-HDGS                      14140000
141500         ADD PV-ADVANCE-COUNT-RPT3 TO PV-LINE-COUNT-RPT3          14150000
141600     END-IF.                                                      14160000
141700                                                                  14170000
141800     WRITE ST-STORE-TOTALS-RPT-RECORD                             14180000
141900         FROM PV-PRINT-RECORD                                     14190000
142000         AFTER ADVANCING PV-ADVANCE-COUNT-RPT3.                   14200000
142100                                                                  14210000
142200******************************************************************14220000
142300*  PRINT HEADING LINES ON THE CHARGE DETAIL REPORT AT EACH PAGE  *14230000
142400*  BREAK.  UPDATE THE PAGE NUMBER.                               *14240000
142500******************************************************************14250000
142600 8300-PRINT-DETAIL-HEADINGS.                                      14260000
142700                                                                  14270000
142800     MOVE 1 TO DP132O-REPORT-NUMBER.                              14280000
142900     ADD 1 TO PV-PAGE-COUNT-RPT1.                                 14290000
143000     MOVE PV-SAVE-STR-NBR          TO HL2-STORE-NMBR.             14300000
143100     MOVE PV-PAGE-COUNT-RPT1       TO DP132O-PAGE-NUMBER.         14310000
143200     MOVE PV-NEW-FRONT-RPT1     TO DP132O-LASER-NEW-PAGE-INDICATR.14320000
143300     WRITE CD-CHARGE-DETAIL-RPT-RECORD                            14330000
143400         FROM DP132O-STANDRD-HEADER-132-COLS                      14340000
143500         AFTER ADVANCING PAGE.                                    14350000
143600     INITIALIZE PV-NEW-FRONT-RPT1.                                14360000
143700     WRITE CD-CHARGE-DETAIL-RPT-RECORD                            14370000
143800         FROM HL2-HEADING-LINE-2-RPT-1                            14380000
143900         AFTER ADVANCING 2 LINES.                                 14390000
144000     WRITE CD-CHARGE-DETAIL-RPT-RECORD                            14400000
144100         FROM HL3-HEADING-LINE-3-RPT-1                            14410000
144200         AFTER ADVANCING 2 LINES.                                 14420000
144300     WRITE CD-CHARGE-DETAIL-RPT-RECORD                            14430000
144400         FROM HL4-HEADING-LINE-4-RPT-1                            14440000
144500         AFTER ADVANCING 1 LINE.                                  14450000
144600     SET PV-DOUBLE-SPACE-RPT1      TO TRUE.                       14460000
144700     MOVE 6                        TO PV-LINE-COUNT-RPT1.         14470000
144800                                                                  14480000
144900******************************************************************14490000
145000*  PRINT HEADING LINES ON THE BATCH SUMMARY REPORT AT EACH PAGE  *14500000
145100*  BREAK.  UPDATE THE PAGE NUMBER.                               *14510000
145200******************************************************************14520000
145300 8400-PRINT-AUDIT-HEADINGS.                                       14530000
145400                                                                  14540000
145500     MOVE 2                        TO DP132O-REPORT-NUMBER.       14550000
145600     ADD 1                         TO PV-PAGE-COUNT-RPT2.         14560000
145700     MOVE PV-PAGE-COUNT-RPT2       TO DP132O-PAGE-NUMBER.         14570000
145800     MOVE PV-NEW-FRONT-RPT2     TO DP132O-LASER-NEW-PAGE-INDICATR.14580000
145900     MOVE PV-SAVE-STR-NBR          TO HL3-STORE.                  14590000
146000     WRITE AR-AUDIT-RPT-RECORD                                    14600000
146100         FROM DP132O-STANDRD-HEADER-132-COLS                      14610000
146200         AFTER ADVANCING PAGE.                                    14620000
146300     INITIALIZE PV-NEW-FRONT-RPT2.                                14630000
146400     WRITE AR-AUDIT-RPT-RECORD                                    14640000
146500         FROM HL2-HEADING-LINE-2-RPT-2                            14650000
146600         AFTER ADVANCING 1 LINES.                                 14660000
146700     WRITE AR-AUDIT-RPT-RECORD                                    14670000
146800         FROM HL3-HEADING-LINE-3-RPT-2                            14680000
146900         AFTER ADVANCING 2 LINES.                                 14690000
147000     WRITE AR-AUDIT-RPT-RECORD                                    14700000
147100         FROM HL4-HEADING-LINE-4-RPT-2                            14710000
147200         AFTER ADVANCING 1 LINE.                                  14720000
147300     WRITE AR-AUDIT-RPT-RECORD                                    14730000
147400         FROM HL5-HEADING-LINE-5-RPT-2                            14740000
147500         AFTER ADVANCING 2 LINES.                                 14750000
147600     SET PV-DOUBLE-SPACE-RPT2 TO TRUE.                            14760000
147700     MOVE 6 TO PV-LINE-COUNT-RPT2.                                14770000
147800                                                                  14780000
147900******************************************************************14790000
148000*  PRINT HEADING LINES ON THE STORE SUMMARY REPORT AT EACH PAGE  *14800000
148100*  BREAK.  UPDATE THE PAGE NUMBER.                               *14810000
148200******************************************************************14820000
148300 8500-PRINT-STORE-TOTAL-HDGS.                                     14830000
148400                                                                  14840000
148500     MOVE 3 TO DP132O-REPORT-NUMBER.                              14850000
148600     ADD 1 TO PV-PAGE-COUNT-RPT3.                                 14860000
148700     MOVE PV-PAGE-COUNT-RPT3 TO DP132O-PAGE-NUMBER.               14870000
148800     MOVE PV-NEW-FRONT-RPT3 TO DP132O-LASER-NEW-PAGE-INDICATR.    14880000
148900     WRITE ST-STORE-TOTALS-RPT-RECORD                             14890000
149000         FROM DP132O-STANDRD-HEADER-132-COLS                      14900000
149100         AFTER ADVANCING PAGE.                                    14910000
149200     INITIALIZE PV-NEW-FRONT-RPT3.                                14920000
149300     WRITE ST-STORE-TOTALS-RPT-RECORD                             14930000
149400         FROM HL2-HEADING-LINE-2-RPT-3                            14940000
149500         AFTER ADVANCING 1 LINE.                                  14950000
149600     WRITE ST-STORE-TOTALS-RPT-RECORD                             14960000
149700         FROM HL3-HEADING-LINE-3-RPT-3                            14970000
149800         AFTER ADVANCING 2 LINES.                                 14980000
149900     SET PV-DOUBLE-SPACE-RPT3 TO TRUE.                            14990000
150000     MOVE 5 TO PV-LINE-COUNT-RPT3.                                15000000
150100                                                                  15010000
150200******************************************************************15020000
150300*  CLOSE ALL FILES.                                              *15030000
150400******************************************************************15040000
150500 9000-EOJ-ROUTINE.                                                15050000
150600                                                                  15060000
150700     DISPLAY '***** NUMBER OF AR TRANSACTIONS READ: '             15070000
150800             PA-TRANSACTION-COUNT.                                15080000
150900                                                                  15090000
151000     CLOSE AR-TRANSACTION-FILE                                    15100000
151100           CHARGE-DETAIL-RPT-FILE                                 15110000
151200           AUDIT-RPT-FILE                                         15120000
151300           STORE-TOTALS-RPT-FILE                                  15130000
151400           OUT-OF-BAL-RPT-FILE                                    15140000
151500           ACCOUNTS-RECEIVABLE-FILE.                              15150000
151600                                                                  15160000
151700******************************************************************15170000
151800* 9200-SQL-ABEND                                                  15180000
151900*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.15190000
152000******************************************************************15200000
152100 9200-SQL-ABEND.                                                  15210000
152200                                                                  15220000
152300     DISPLAY '** ABEND        **'.                                15230000
152400     DISPLAY '** PROGRAM      ** = ' PC-CURRENT-PROGRAM-NAME.     15240000
152500     DISPLAY '** PARAGRAPH    ** = ' PV-PARAGRAPH-NAME.           15250000
152600     DISPLAY '** OPERATION    ** = ' PV-DB2-OPERATION.            15260000
152700                                                                  15270000
152800******************************************************************15280000
152900* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     15290000
153000* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      15300000
153100******************************************************************15310000
153200     COPY DPPD004.                                                15320000
153300                                                                  15330000
153400     SET AC-DB2-ERROR TO TRUE.                                    15340000
153500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         15350000
153600                                                                  15360000
