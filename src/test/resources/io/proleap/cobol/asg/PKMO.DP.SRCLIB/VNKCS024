000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.      VNKCS024.                                       00050000
000600 AUTHOR.          MIKE BESKE.                                     00060000
000700 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00070000
000800 DATE-WRITTEN.    FEBRUARY 2001.                                  00080000
000900                                                                  00090000
001000***************************************************************** 00100000
001100*    COBOL II WITH MQ SERIES                                      00110000
001200******************************************************************00120000
001300* THIS PROGRAM                                                    00130000
001400*                                                                 00140000
001500******************************************************************00150000
001600* CHANGES MADE:                                                   00160000
001700*                                                                 00170000
001800* DATE  05/27/2003                                                00180000
001900*     CHANGE MADE: VENDOR MULTI PRE-PACK USAGE PROJECT.  CHANGE   00190000
002000*     WORKING STORAGE FIELDS RELATING TO MQ MESSAGE LENGTHS TO    00200000
002100*     MATCH NEW MESSAGE LENGTHS IN COPYBOOK VNRD003.  ADD CHECK   00210000
002200*     FOR VN007-PO-PREPK-CDE TO CONDITION IN PARAGRAPH B300.      00220000
002300*     MOVE VN007-ENT-ID AND VN007-PO-PREPK-CDE TO VNRD003 COPYBK  00230000
002400*     FIELDS IN PARAGRAPHS C100 AND C200.  MOVE VN007-ENT-ID TO   00240000
002500*     VNRD003 COPYBOOK FIELD IN PARAGRAPHS C350, C450, AND C500.  00250000
002600*     MADE BY: KEVIN CATLIN            WR/IR #: WR24663           00260000
002700*                                                                 00270000
002800* DATE  08/26/2003                                                00280000
002900*     CHANGE MADE: CHANGE QUEUE MANAGER NAME TO THE NEW SERVER,   00290000
003000*     ISWMQ04P.                                                   00300000
003100*     MADE BY: KEVIN CATLIN            WR/IR #: WR25644           00310000
003200*                                                                 00320000
003300* DATE  11/05/2003                                                00330000
003400*     CHANGE MADE: INCREASED THE LENGTHS OF THE NEW VENDOR        00340000
003500*     AND VENDOR MESSAGE LENGTHS TO ACCOMANDATE THE               00350000
003600*     4 NEW FIELDS ADDED TO THOSE MEAASGES: GVRNG-IND,            00360000
003700*     GVRNG-ENT-ID, CART-LBL-IND, CART-LBL-EFF-DTE. ADDED         00370000
003800*     CODE TO MOVE THESE 4 FIELDS FROM VNWS007 TO THEIR           00380000
003900*     CORRESPONDING FIELDS ON VNRD003.                            00390000
004000*     MADE BY: MIKE BESKE              WR/IR #: WR25358           00400000
004100*                                                                 00410000
004200* DATE  11/04/2004                                                00420000
004300*     CHANGE MADE: INCREASED THE LENGTHS OF THE EDI RECORDS TO    00430000
004400*     ACCOMODATE 6 NEW EDI FIELDS THAT NEED TO BE BRIDGED TO RMS: 00440000
004500*        EDI-POCHG-IND                                            00450000
004600*        EDI-PO-PROD-IND                                          00460000
004700*        EDI-PO-TEST-IND                                          00470000
004800*        EDI-POCHG-PROD-IND                                       00480000
004900*        EDI-POCHG-TEST-IND                                       00490000
005000*        EDI-VNDR-TYPE-IND                                        00500000
005100*     ADDED CHECK FOR VN007-EDI-POCHG-IND TO CONDITION IN         00510000
005200*     PARAGRAPH B300-PROCESS-DATA.                                00520000
005300*     ADDED CODE TO MOVE THE NEW FIELDS FROM VNWS007 TO VNRD003.  00530000
005400*     MADE BY: SUE PARI                WR/IR #: WR27805           00540000
005500*                                                                 00550000
005600* DATE  02/04/2005                                                00560000
005700*     CHANGE MADE: ADDED LOGIC TO PROCESS NEW MESSAGES FOR        00570000
005800*     VENDOR CAPABILITIES AND RELATIONSHIPS.                      00580000
005900*     MADE BY: JACK KRAMER             WR/IR #: WR25278           00590000
006000*                                                                 00600000
006100* DATE  07/13/2005                                                00610000
006200*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.      00620000
006300*     ADDED THE FIELD VN003-COOP-DISC TO COPYBOOK VNRD003 AND     00630000
006400*     INCREASED THE LENGTH OF NEW-VENDOR-MSG, DEPARTMENT-MSG, AND 00640000
006500*     MSGBUFFER ACCORDINGLY.  ALSO ADDED THE FIELD                00650000
006600*     VN007-COOP-DISC-PCT TO THE COPYBOOK VNWWS007.  INCLUDED     00660000
006700*     LOGIC IN PARAGRAPHS C100- AND C450- TO POPULATE THE         00670000
006800*     VN003-COOP-DISC OUTPUT FIELD FROM VN007-COOP-DISC-PCT.      00680000
006900*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651           00690000
007000*                                                                 00700000
007100* DATE  07/25/2005                                                00710000
007200*     CHANGE MADE: OFF-INVOICE CO-OP ADVERTISING ALLOWANCES.      00720000
007300*     RECOMPILE TO INDICATE THAT PROGRAM IS 'MQ' IN MOVE TO       00730000
007400*     PRODUCTION.                                                 00740000
007500*     MADE BY: KRYSTEN LEARY           WR/IR #: WR28651           00750000
007600*                                                                 00760000
007700* DATE  03/21/2006                                                00770000
007800*     CHANGE MADE: ADDED CODE TO PROCESS THE NEW FIELDS FOR       00780000
007900*     PROFITASST/ADCOOP ALLOWANCE PERCENT AND TABLE/TOWER         00790000
008000*     DATING DAYS COMING FROM THE NEW INCENTIVES ON THE TVNDAGR.  00800000
008100*     THIS INCREASED THE OVERALL LENGTH OF THE DEPARTMENT AND     00810000
008200*     NEW VENDOR MESSAGES BY 10 BYTES (VNRD003).                  00820000
008300*     MADE BY: MIKE BESKE              WR/IR #: WR30028           00830000
008400*                                                                 00840000
008500* DATE  04/05/2006                                                00850000
008600*     CHANGE MADE: ADDED CODE TO PROCESS THE NEW FIELDS FOR       00860000
008700*     BRIDAL ALLOWANCE PERCENT COMING FROM THE NEW INCENTIVES     00870000
008800*     ON THE TVNDAGR.                                             00880000
008900*     THIS INCREASED THE OVERALL LENGTH OF THE DEPARTMENT AND     00890000
009000*     NEW VENDOR MESSAGES BY 5 BYTES (VNRD003).                   00900000
009100*     MADE BY: MIKE BESKE              WR/IR #: WR30028           00910000
009200*                                                                 00920000
009300* DATE  05/01/2014                                                00930000
009400*     CHANGE MADE: CHANGE QMGR FOR RMS13.                         00940001
009500*     MADE BY: JOHN SELWITSCHKA        WR/IR #: CHG0081355        00950001
009600*                                                                 00960001
009700* DATE  10/08/2018                                                00970001
009800*     CHANGE MADE: MAINFRAME REFACTORING - CALL WSV_PRVDR_QUE TO  00980001
009900*                  GET MQ PARMS FOR REFACTORED CODE.              00990001
010000*                  ALSO HAD TO ADD COPYBOOKS DPWS013, DPWS020     01000001
010100*                  AND ISWS002 BECAUSE DB2 WAS ADDED TO THE       01010001
010200*                  PROGRAM.                                       01020001
010300*     MADE BY: BARB SCHULTZ            WR/IR #: CHG0209972        01030001
010400*                                                                 01040001
010500* DATE  02/20/2019                                                01050001
010600*     CHANGE MADE: MAINFRAME REFACTORING - CHANGE                 01060001
010700*                  MQPMO-SYNCPOINT TO MQPMO-NO-SYNCPOINT.         01070001
010800*                  THE REFACTORED CODE WILL NOT WORK IF           01080001
010900*                  MQPMO-SYNCPOINT IS USED AND EXPLICIT COMMITS   01090001
011000*                  ARE NOT PERFORMED.                             01100001
011100*     MADE BY: JIM HUNTER              WR/IR #: CHG0218056        01110001
011200*                                                                 01120001
011300* DATE  03/20/2019                                                01130001
011400*     CHANGE MADE: MAINFRAME REFACTORING - TEAM HAS REQUESTED     01140001
011500*                  THAT WE BACK OUT PREVIOUS MONTH'S CHANGE       01150001
011600*                  BECAUSE IT COULD CAUSE PROBLEMS IN FUTURE.     01160001
011700*                  SET MQPMO-SYNCPOINT INSTEAD OF                 01170001
011800*                  MQPMO-NO-SYNCPOINT.                            01180001
011900*     MADE BY: JIM HUNTER              WR/IR #: CHG0220045        01190001
012000*                                                                 01200001
012100******************************************************************01210000
012200                                                                  01220000
012300******************************************************************01230000
012400 ENVIRONMENT DIVISION.                                            01240000
012500******************************************************************01250000
012600                                                                  01260000
012700 CONFIGURATION SECTION.                                           01270000
012800                                                                  01280000
012900 SOURCE-COMPUTER.        IBM-3090.                                01290000
013000 OBJECT-COMPUTER.        IMB-3090.                                01300000
013100                                                                  01310000
013200*INPUT-OUTPUT SECTION.                                            01320000
013300                                                                  01330000
013400*FILE-CONTROL.                                                    01340000
013500                                                                  01350000
013600******************************************************************01360000
013700 DATA DIVISION.                                                   01370000
013800******************************************************************01380000
013900                                                                  01390000
014000*FILE SECTION.                                                    01400000
014100                                                                  01410000
014200                                                                  01420000
014300 WORKING-STORAGE SECTION.                                         01430000
014400                                                                  01440000
014500*                                                                 01450000
014600*  OUTPUT SEGMENT COPYBOOK                                        01460000
014700*                                                                 01470000
014800     COPY VNRD003.                                                01480000
014900                                                                  01490000
015000     COPY DPWS013.                                                01500000
015100                                                                  01510000
015200     COPY DPWS020.                                                01520000
015300                                                                  01530000
015400*    API CONTROL BLOCKS                                           01540000
015500                                                                  01550000
015600 01  MQM-OBJECT-DESCRIPTOR.                                       01560000
015700     COPY CMQODV.                                                 01570000
015800 01  MQM-MESSAGE-DESCRIPTOR.                                      01580000
015900     COPY CMQMDV.                                                 01590000
016000 01  MQM-GET-MESSAGE-OPTIONS.                                     01600000
016100     COPY CMQGMOV.                                                01610000
016200 01  MQM-PUT-MESSAGE-OPTIONS.                                     01620000
016300     COPY CMQPMOV.                                                01630000
016400                                                                  01640000
016500*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   01650000
016600*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          01660000
016700                                                                  01670000
016800 01  MQM-CONSTANTS.                                               01680000
016900     COPY CMQV.                                                   01690000
017000*                                                                 01700000
017100     COPY ISWS002.                                                01710000
017200                                                                  01720000
017300 01  MQ-WORKING-STORAGE.                                          01730000
017400     05  WS-MQCONN               PIC X(8)  VALUE 'CSQCCONN'.      01740000
017500     05  WS-MQOPEN               PIC X(8)  VALUE 'CSQCOPEN'.      01750000
017600     05  WS-MQGET                PIC X(8)  VALUE 'CSQCGET '.      01760000
017700     05  WS-MQPUT                PIC X(8)  VALUE 'CSQCPUT '.      01770000
017800     05  WS-MQCMIT               PIC X(8)  VALUE 'CSQCCOMM'.      01780000
017900     05  WS-MQBACK               PIC X(8)  VALUE 'CSQCBACK'.      01790000
018000     05  WS-MQCLOSE              PIC X(8)  VALUE 'CSQCCLOS'.      01800000
018100     05  WS-MQDISC               PIC X(8)  VALUE 'CSQCDISC'.      01810000
018200     05  WS-MQCHECK              PIC X(8)  VALUE 'MQR2C   '.      01820000
018300                                                                  01830000
018400 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         01840000
018500                                              COMP SYNC.          01850000
018600     88  AC-MQ-ERROR                          VALUE +4020.        01860000
018700                                                                  01870000
018800 01  PS-PROGRAM-SWITCHES.                                         01880000
018900     05  PS-END-OF-DATA-SW         PIC X(01)  VALUE 'N'.          01890000
019000         88  PS-END-OF-DATA                   VALUE 'Y'.          01900000
019100     05  PS-NO-ADDRESSES-LEFT-SW   PIC X(01)  VALUE 'N'.          01910000
019200         88  PS-NO-ADDRESSES-LEFT             VALUE 'Y'.          01920000
019300     05  PS-NO-DEPARTMENTS-LEFT-SW PIC X(01)  VALUE 'N'.          01930000
019400         88  PS-NO-DEPARTMENTS-LEFT           VALUE 'Y'.          01940000
019500     05  PS-MQPUT-SUCCESSFUL-SW    PIC X(01)  VALUE SPACES.       01950000
019600         88  PS-MQPUT-SUCCESSFUL              VALUE 'Y'.          01960000
019700     05  PS-NEW-VENDOR-SW          PIC X(01)  VALUE 'N'.          01970000
019800         88  PS-NOT-NEW-VENDOR                VALUE 'N'.          01980000
019900         88  PS-NEW-VENDOR                    VALUE 'Y'.          01990000
020000     05  PS-NEW-PARTNER-SW         PIC X(01)  VALUE 'N'.          02000000
020100         88  PS-NOT-NEW-PARTNER               VALUE 'N'.          02010000
020200         88  PS-NEW-PARTNER                   VALUE 'Y'.          02020000
020300                                                                  02030000
020400 01  PC-PROGRAM-CONSTANTS.                                        02040000
020500     05  PC-PGM-NAME             PIC X(8)     VALUE 'VNKCS024'.   02050000
020600     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'VNKCS024'.   02060000
020700     05  PC-MAX-RETRIES          PIC S9(04)   VALUE 10 COMP.      02070000
020800     05  PC-NEW-VENDOR           PIC X(10) VALUE 'NEW VENDOR'.    02080000
020900     05  PC-VENDOR               PIC X(10) VALUE 'VENDOR'.        02090000
021000     05  PC-ADDRESS              PIC X(10) VALUE 'ADDRESS'.       02100000
021100     05  PC-DEPT                 PIC X(10) VALUE 'DEPT'.          02110000
021200     05  PC-EDI                  PIC X(10) VALUE 'EDI'.           02120000
021300     05  PC-PARTNER              PIC X(10) VALUE 'PARTNER'.       02130000
021400     05  PC-LONGNAME             PIC X(10) VALUE 'LONGNAME'.      02140000
021500     05  PC-NEW-VENDOR-LENGTH    PIC S9(9) BINARY VALUE +437.     02150000
021600     05  PC-VENDOR-LENGTH        PIC S9(9) BINARY VALUE +85.      02160000
021700     05  PC-ADDRESS-LENGTH       PIC S9(9) BINARY VALUE +291.     02170000
021800     05  PC-DEPT-LENGTH          PIC S9(9) BINARY VALUE +103.     02180000
021900     05  PC-EDI-LENGTH           PIC S9(9) BINARY VALUE +36.      02190000
022000     05  PC-CPBLTY-LENGTH        PIC S9(9) BINARY VALUE +32.      02200000
022100     05  PC-RLTNSHP-LENGTH       PIC S9(9) BINARY VALUE +40.      02210000
022200     05  PC-PARTNER-LENGTH       PIC S9(9) BINARY VALUE +437.     02220000
022300     05  PC-LONGNAME-LENGTH      PIC S9(9) BINARY VALUE +279.     02230000
022400     05  PC-QNAME                PIC X(48) VALUE                  02240000
022500                               'RS.SUPPLIER.PARTNER.LOAD.Q'.      02250000
022600     05  PC-QMGR-NAME            PIC X(48)   VALUE SPACES.        02260000
022700**********************************                     QKSP       02270000
022800*        88  PC-PROD-QMGR-NAME                VALUE 'ISWMQ04P'.   02280000
022900*        88  PC-PROD-QMGR-NAME                VALUE 'ISWMQ189P'.  02290000
023000**********************************                     QKST       02300000
023100*        88  PC-TEST-QMGR-NAME                VALUE 'ISWMQ04T'.   02310000
023200*        88  PC-TEST-QMGR-NAME                VALUE 'ISWMQ78T'.   02320000
023300**8      88  PC-TEST-QMGR-NAME                VALUE 'QKST    '.   02330000
023400**********************************                     QKSQ       02340000
023500*        88  PC-QA-QMGR-NAME                  VALUE 'ISWMQ04Q'.   02350000
023600*        88  PC-QA-QMGR-NAME                  VALUE 'ISWMQ77Q'.   02360000
023700                                                                  02370000
023800*    05  PC-SYS-ID               PIC X(04).                       02380000
023900*        88  PC-PV-KOHLS-TEST-SYSTEM       VALUE 'CIT1'.          02390000
024000*        88  PC-PV-KOHLS-ACC-TEST-SYSTEM   VALUE 'CIQA',          02400000
024100*                                                'CIQT',          02410000
024200*                                                'CILA',          02420000
024300*                                                'CILT'.          02430000
024400*        88  PC-PV-KOHLS-QA-SYSTEM         VALUE 'CIQA',          02440000
024500*                                                'CIQT'.          02450000
024600*        88  PC-PV-KOHLS-LEARNING-SYSTEM   VALUE 'CILA',          02460000
024700*                                                'CILT'.          02470000
024800*        88  PC-PV-KOHLS-PROD-SYSTEM       VALUE 'CIPS',          02480000
024900*                                                'CIP1',          02490000
025000*                                                'CIP3',          02500000
025100*                                                'CIP4',          02510000
025200*                                                'CIP6'.          02520000
025300                                                                  02530000
025400 01  PV-PROGRAM-VARIABLES.                                        02540000
025500     05  PV-CURRENT-SYSID            PIC X(4)  VALUE SPACES.      02550000
025600     05  PV-MQGET-COUNTER            PIC S9(9) BINARY VALUE 0.    02560000
025700     05  PV-MQPUT-COUNTER            PIC S9(9) BINARY VALUE 0.    02570000
025800     05  PV-MQPUT-RETRY-COUNTER      PIC S9(4)  VALUE ZERO COMP.  02580000
025900     05  PV-MQGET-RETRY-COUNTER      PIC S9(4)  VALUE ZERO COMP.  02590000
026000     05  PV-PARAGRAPH                PIC X(48) VALUE SPACES.      02600000
026100     05  PV-ERROR.                                                02610000
026200         10  PV-ERROR-LITERAL        PIC X(14) VALUE SPACES.      02620000
026300         10  PV-ERROR-VARIABLE       PIC X(34) VALUE SPACES.      02630000
026400     05  PV-ERROR-MESSAGE            PIC X(48) VALUE SPACES.      02640000
026500     05  PV-ERROR-MESSAGE2           PIC X(48) VALUE SPACES.      02650000
026600     05  PV-OUT-MSGLENGTH           PIC S9(9) BINARY VALUE ZERO.  02660000
026700     05  PV-DATA-LENGTH             PIC S9(9) BINARY.             02670000
026800     05  PV-MSG-LENGTH              PIC S9(9) BINARY.             02680000
026900     05  PV-NBR-OF-MSGS-CREATED     PIC  9(9)     VALUE 0.        02690000
027000     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        02700000
027100     05  PV-GQ-HANDLE            PIC S9(9) BINARY VALUE 0.        02710000
027200     05  PV-PQ-HANDLE            PIC S9(9) BINARY VALUE 0.        02720000
027300     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                02730000
027400     05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                02740000
027500     05  PV-REASON               PIC S9(9) BINARY.                02750000
027600     05  PV-REASON-NONBIN        PIC S9(9).                       02760000
027700     05  PV-MQ-REASON-TEXT       PIC X(30) VALUE SPACES.          02770000
027800     05  PV-SAVE-COMPLETION-CODE PIC S9(9) BINARY.                02780000
027900     05  PV-SAVE-REASON          PIC S9(9) BINARY.                02790000
028000     05  PV-SAVE-PARAGRAPH       PIC X(48) VALUE SPACES.          02800000
028100     05  PV-CON-REASON           PIC S9(9) BINARY.                02810000
028200     05  PV-SAVE-CORRELID        PIC X(24) VALUE SPACES.          02820000
028300     05  PV-SEGMENT-TYPE         PIC X(10) VALUE SPACES.          02830000
028400         88  PV-NEW-VENDOR-SEGMENT         VALUE 'NEW VENDOR'.    02840000
028500         88  PV-VENDOR-SEGMENT             VALUE 'VENDOR'.        02850000
028600         88  PV-ADDRESS-SEGMENT            VALUE 'ADDRESS'.       02860000
028700         88  PV-DEPARTMENT-SEGMENT         VALUE 'DEPARTMENT'.    02870000
028800         88  PV-EDI-SEGMENT                VALUE 'EDI'.           02880000
028900         88  PV-CPBLTY-SEGMENT             VALUE 'CPBLTY'.        02890000
029000         88  PV-RLTNSHP-SEGMENT            VALUE 'RLTNSHP'.       02900000
029100         88  PV-PARTNER-SEGMENT            VALUE 'PARTNER'.       02910000
029200         88  PV-LONGNAME-SEGMENT           VALUE 'LONGNAME'.      02920000
029300         88  PV-COMMIT-SEGMENT             VALUE 'COMMIT'.        02930000
029400         88  PV-VALID-SEGMENT              VALUE 'NEW VENDOR'     02940000
029500                                               , 'VENDOR'         02950000
029600                                               , 'ADDRESS'        02960000
029700                                               , 'DEPARTMENT'     02970000
029800                                               , 'EDI'            02980000
029900                                               , 'CPBLTY'         02990000
030000                                               , 'RLTNSHP'        03000000
030100                                               , 'PARTNER'        03010000
030200                                               , 'LONGNAME'.      03020000
030300     05  PV-DISC-FIELD.                                           03030000
030400         10  FILLER                   PIC X(1)  VALUE '.'.        03040000
030500         10  PV-DISC-DECIMALS         PIC V9(4) VALUE ZEROES.     03050000
030600     05  PV-DEPT-FIELD.                                           03060000
030700         10  FILLER                   PIC X(1)  VALUE '0'.        03070000
030800         10  PV-DEPT-CHAR3            PIC X(3)  VALUE SPACES.     03080000
030801                                                                  03080101
030810     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         03081001
030820                                                 COMP SYNC.       03082001
030830     05  PV-CICS-MSG-AREA             PIC  X(80) VALUE SPACES.    03083001
030840     05  PV-COMMAREA-LENGTH           PIC S9(04) VALUE +0         03084001
030850                                                 COMP SYNC.       03085001
030900                                                                  03090001
030901 01  PV-DISPLAY-VARIABLES.                                        03090101
030910     05  PV-DISP-VND-NBR              PIC X(09) VALUE SPACES.     03091001
030920     05  PV-DISP-PRIM-TYP-CDE         PIC X(01) VALUE SPACES.     03092001
030930     05  PV-DISP-PRTNR-TYP-CDE        PIC X(02) VALUE SPACES.     03093001
030950     05  PV-DISP-STATUS-CDE           PIC X(01) VALUE SPACES.     03095001
030960     05  PV-DISP-ENT-NAME-DESC        PIC X(30) VALUE SPACES.     03096001
030970     05  PV-DISP-SCAC-CDE             PIC X(04) VALUE SPACES.     03097001
030980     05  PV-DISP-LINE-OF-CR-AMT       PIC 9(13) VALUE ZEROES.     03098003
030991     05  PV-DISP-ENT-ID               PIC 9(08) VALUE ZEROES.     03099102
030992     05  PV-DISP-PO-PREPK-CDE         PIC X(01) VALUE SPACES.     03099201
031000*************************************************************     03100000
031100*    DB2 VIEW DECLARATION - WSV_PRVDR_QUE                         03110000
031200*************************************************************     03120000
031300                                                                  03130000
031400     EXEC SQL                                                     03140000
031500          INCLUDE WSV00005                                        03150000
031600     END-EXEC.                                                    03160000
031700                                                                  03170000
031800                                                                  03180000
031900     EXEC SQL                                                     03190000
032000         INCLUDE SQLCA                                            03200000
032100     END-EXEC.                                                    03210000
032200                                                                  03220000
032300 LINKAGE SECTION.                                                 03230000
032400                                                                  03240000
032500 01 DFHCOMMAREA.                                                  03250000
032600     COPY VNWS007.                                                03260000
032700                                                                  03270000
032800******************************************************************03280000
032900 PROCEDURE DIVISION.                                              03290000
033000******************************************************************03300000
033100                                                                  03310000
033200 0000-MAINLINE.                                                   03320000
033300                                                                  03330000
033400     PERFORM B100-MQ-SETUP.                                       03340000
033500                                                                  03350000
033600     PERFORM B300-PROCESS-DATA.                                   03360000
033700                                                                  03370000
033800     PERFORM Y200-CLOSE-MQ-QUEUE.                                 03380000
033900                                                                  03390000
034000     EXEC CICS                                                    03400000
034100      RETURN                                                      03410000
034200     END-EXEC.                                                    03420000
034300                                                                  03430000
034400/                                                                 03440000
034500 B100-MQ-SETUP.                                                   03450000
034600* ------------------------------------------------------------- * 03460000
034700*    CONNECT TO THE QUEUE MANAGER                                 03470000
034800* ------------------------------------------------------------- * 03480000
034900*                                                                 03490000
035000*    EXEC CICS                                                    03500000
035100*     ASSIGN SYSID (PV-CURRENT-SYSID)                             03510000
035200*    END-EXEC.                                                    03520000
035300*                                                                 03530000
035400*    MOVE PV-CURRENT-SYSID TO PC-SYS-ID.                          03540000
035500*                                                                 03550000
035600*    IF PC-PV-KOHLS-PROD-SYSTEM                                   03560000
035700*        SET PC-PROD-QMGR-NAME     TO TRUE                        03570000
035800*    ELSE                                                         03580000
035900*         IF PC-PV-KOHLS-QA-SYSTEM                                03590000
036000*             SET PC-QA-QMGR-NAME  TO TRUE                        03600000
036100*         ELSE                                                    03610000
036200*             SET PC-TEST-QMGR-NAME                               03620000
036300*                                  TO TRUE                        03630000
036400*         END-IF                                                  03640000
036500*    END-IF.                                                      03650000
036600*                                                                 03660000
036700*SELECT  QUEUE MANAGER AND QUEUE NAME                             03670000
036800                                                                  03680000
036900       INITIALIZE DCLWSV00005.                                    03690000
037000       MOVE 'QUEUE'       TO WSV00005-APPL-FUNC-DESC.             03700000
037100       MOVE 'VNSUPLOAD'   TO WSV00005-INTGRTN-TYP-CDE.            03710000
037200                                                                  03720000
037300       EXEC SQL                                                   03730000
037400           SELECT                                                 03740000
037500                 LCL_QUE_MGR                                      03750000
037600                ,RMT_QUE_MGR                                      03760000
037700                ,QUE_NM                                           03770000
037800           INTO                                                   03780000
037900                :WSV00005-LCL-QUE-MGR                             03790000
038000               ,:WSV00005-RMT-QUE-MGR                             03800000
038100               ,:WSV00005-QUE-NM                                  03810000
038200           FROM  WSV_PRVDR_QUE                                    03820000
038300          WHERE  APPL_FUNC_DESC  = :WSV00005-APPL-FUNC-DESC       03830000
038400            AND  INTGRTN_TYP_CDE = :WSV00005-INTGRTN-TYP-CDE      03840000
038500       END-EXEC.                                                  03850000
038600                                                                  03860000
038700       EVALUATE TRUE                                              03870000
038800           WHEN SQLCODE = +0                                      03880000
038900              INITIALIZE PC-QMGR-NAME                             03890000
039000              MOVE WSV00005-RMT-QUE-MGR-TEXT  TO PC-QMGR-NAME     03900000
039100              INITIALIZE PC-QNAME                                 03910000
039200              MOVE WSV00005-QUE-NM-TEXT       TO PC-QNAME         03920000
039300              DISPLAY 'VNKCS024 PC-QMGR-NAME = ' PC-QMGR-NAME     03930000
039400              DISPLAY 'VNKCS024 PC-NAME      = ' PC-QNAME         03940000
039500           WHEN SQLCODE = +100                                    03950000
039600           WHEN SQLWARN0 NOT = SPACES                             03960000
039700           WHEN SQLCODE  NOT = ZERO                               03970000
039800              MOVE 'B100-MQ-SETUP'                                03980000
039900                               TO DP013-PARAGRAPH                 03990000
040000              MOVE 'SELECT QUEUE NAME FROM WSV-PRVDR-QUE'         04000000
040100                               TO DP013-MESSAGE-TEXT (1)          04010000
040200              MOVE SQLCA       TO DP013-SQLCA                     04020000
040300              SET DP013-DB2-ABEND                                 04030000
040400                               TO TRUE                            04040000
040500              PERFORM DP013-0000-PROCESS-ABEND                    04050000
040600       END-EVALUATE.                                              04060000
040700                                                                  04070000
040800* ------------------------------------------------------------- * 04080000
040900*    OPEN THE UNIX SUPPLIER/PARTNER LOAD QUEUE FOR OUTPUT         04090000
041000* ------------------------------------------------------------- * 04100000
041100                                                                  04110000
041200     COMPUTE PV-OPEN-OPTIONS = MQOO-OUTPUT +                      04120000
041300                               MQOO-FAIL-IF-QUIESCING.            04130000
041400     MOVE PC-QNAME                       TO MQOD-OBJECTNAME.      04140000
041500     MOVE PC-QMGR-NAME                   TO MQOD-OBJECTQMGRNAME.  04150000
041600                                                                  04160000
041700                                                                  04170000
041800     CALL WS-MQOPEN USING PV-HCONN                                04180000
041900                          MQM-OBJECT-DESCRIPTOR                   04190000
042000                          PV-OPEN-OPTIONS                         04200000
042100                          PV-PQ-HANDLE                            04210000
042200                          PV-COMPLETION-CODE                      04220000
042300                          PV-REASON.                              04230000
042400*                                                                 04240000
042500*                                                                 04250000
042600*    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    04260000
042700*    AND EXIT.                                                    04270000
042800*                                                                 04280000
042900     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        04290000
043000        MOVE 'B100-MQ-SETUP - OPEN ERROR ' TO PV-PARAGRAPH        04300000
043100        MOVE PV-PARAGRAPH            TO PV-SAVE-PARAGRAPH         04310000
043200        MOVE PV-COMPLETION-CODE      TO PV-SAVE-COMPLETION-CODE   04320000
043300        MOVE PV-REASON               TO PV-SAVE-REASON            04330000
043400        MOVE PV-SAVE-PARAGRAPH       TO PV-PARAGRAPH              04340000
043500        MOVE PV-SAVE-COMPLETION-CODE TO PV-COMPLETION-CODE        04350000
043600        MOVE PV-SAVE-REASON          TO PV-REASON                 04360000
043700        PERFORM Z900-DISPLAY-MQ-ERROR                             04370000
043800     END-IF.                                                      04380000
043900                                                                  04390000
044000/                                                                 04400000
044100******************************************************************04410000
044200*  PROCESS THE MESSAGE THAT WAS READ FROM THE QUEUE.             *04420000
044300******************************************************************04430000
044400 B300-PROCESS-DATA.                                               04440000
044500                                                                  04450000
044600     IF (VN007-PRIM-TYP-CDE = 'M') AND                            04460000
044700        (VN007-FUNCTION-ID (1) NOT = ZERO) AND                    04470000
044800        (VN007-DEPT-NBR (1) NOT = SPACES)                         04480000
044900        SET PS-NEW-VENDOR  TO TRUE                                04490000
045000        PERFORM C100-PROCESS-NEW-VENDOR                           04500000
045100        SET VN007-ADDR-IND TO 2                                   04510000
045200        PERFORM C300-PROCESS-ADDRESS                              04520000
045300                     UNTIL VN007-ADDR-IND > 4                     04530000
045400        SET VN007-DEPT-IND TO 2                                   04540000
045500        PERFORM C400-PROCESS-DEPARTMENT                           04550000
045600                     UNTIL VN007-DEPT-IND > 10                    04560000
045700        SET VN007-CPBL-IND TO 2                                   04570000
045800        PERFORM C600-PROCESS-CAPABILITY                           04580000
045900                     UNTIL VN007-CPBL-IND > 20                    04590000
046000        SET VN007-RLTN-IND TO 2                                   04600000
046100        PERFORM C700-PROCESS-RELATIONSHIP                         04610000
046200                     UNTIL VN007-RLTN-IND > 20                    04620000
046300     ELSE                                                         04630000
046400        SET PS-NOT-NEW-VENDOR TO TRUE                             04640000
046500     END-IF.                                                      04650000
046600                                                                  04660000
046700     IF (PS-NOT-NEW-VENDOR) AND                                   04670000
046800        (VN007-LONGNAME-DELETE-IND = SPACE) AND                   04680000
046900       ((VN007-PRIM-TYP-CDE     NOT = SPACE) OR                   04690000
047000        (VN007-PRTNR-TYP-CDE    NOT = SPACE) OR                   04700000
047100*       (VN007-VND-IN-RMS-IND   NOT = SPACE) OR                   04710000
047200        (VN007-STATUS-CDE       NOT = SPACE) OR                   04720000
047300        (VN007-ENT-NAME-DESC    NOT = SPACE) OR                   04730000
047400        (VN007-SCAC-CDE         NOT = SPACE) OR                   04740000
047500        (VN007-PO-PREPK-CDE     NOT = SPACE) OR                   04750000
047600        (VN007-LINE-OF-CR-AMT   NOT = ZERO)  OR                   04760000
047700        (VN007-PRTNR-DELETE-IND NOT = SPACE))                     04770000
047800        PERFORM C200-PROCESS-VENDOR-PARTNER                       04780000
047900     END-IF.                                                      04790000
048000                                                                  04800000
048100     IF PS-NOT-NEW-VENDOR                                         04810000
048200        SET VN007-ADDR-IND TO 1                                   04820000
048300        PERFORM C300-PROCESS-ADDRESS                              04830000
048400                     UNTIL VN007-ADDR-IND > 4                     04840000
048500        SET VN007-DEPT-IND TO 1                                   04850000
048600        PERFORM C400-PROCESS-DEPARTMENT                           04860000
048700                     UNTIL VN007-DEPT-IND > 10                    04870000
048800        SET VN007-CPBL-IND TO 1                                   04880000
048900        PERFORM C600-PROCESS-CAPABILITY                           04890000
049000                     UNTIL VN007-CPBL-IND > 20                    04900000
049100        SET VN007-RLTN-IND TO 1                                   04910000
049200        PERFORM C700-PROCESS-RELATIONSHIP                         04920000
049300                     UNTIL VN007-RLTN-IND > 20                    04930000
049400     END-IF.                                                      04940000
049500                                                                  04950000
049600     IF (PS-NOT-NEW-VENDOR) AND                                   04960000
049700        (VN007-LONGNAME NOT = SPACES) AND                         04970000
049800        (VN007-LONGNAME-DELETE-IND NOT = SPACES)                  04980000
049900        PERFORM C800-PROCESS-LONGNAME                             04990000
050000     END-IF.                                                      05000000
050100                                                                  05010000
050200     IF (VN007-EDI-PO-IND NOT = SPACES) OR                        05020000
050300        (VN007-EDI-POCHG-IND NOT = SPACES) OR                     05030000
050400        (VN007-EDI-ASN-IND NOT = SPACES)                          05040000
050500        PERFORM C500-PROCESS-EDI                                  05050000
050600     END-IF.                                                      05060000
050700/                                                                 05070000
050800******************************************************************05080000
050900*  MOVE NEW VENDOR DATA FROM INPUT TO OUTPUT FIELDS.             *05090000
051000******************************************************************05100000
051100 C100-PROCESS-NEW-VENDOR.                                         05110000
051110     DISPLAY 'C100-PROCESS-NEW-VENDOR'                            05111005
051200     MOVE 'C100-PROCESS-NEW-VENDOR - PUT ERROR' TO PV-PARAGRAPH.  05120000
051300     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       05130000
051400                VN003-NEW-VENDOR-MESSAGE                          05140000
051500                VN003-MSGBUFFER                                   05150001
051600                PV-DISPLAY-VARIABLES.                             05160001
051610                                                                  05161001
051700     SET VN003-NEW-VND-SEGMENT        TO TRUE.                    05170000
051800     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR         05180001
051810                                         PV-DISP-VND-NBR.         05181001
051900     MOVE VN007-ENT-ID                TO VN003-ENT-ID             05190001
051910                                         PV-DISP-ENT-ID.          05191001
052000     MOVE VN007-PRIM-TYP-CDE          TO VN003-VENDOR-TYPE        05200001
052010                                         PV-DISP-PRIM-TYP-CDE.    05201001
052100     MOVE VN007-PRTNR-TYP-CDE         TO VN003-PARTNER-TYPE       05210001
052110                                         PV-DISP-PRTNR-TYP-CDE.   05211001
052200     MOVE VN007-STATUS-CDE            TO VN003-VENDOR-STATUS      05220001
052210                                         PV-DISP-STATUS-CDE.      05221001
052300     MOVE VN007-ENT-NAME-DESC         TO VN003-VENDOR-NAME        05230001
052310                                         PV-DISP-ENT-NAME-DESC.   05231001
052400     MOVE VN007-SCAC-CDE              TO VN003-SCAC-CDE           05240001
052410                                         PV-DISP-SCAC-CDE.        05241001
052500     MOVE VN007-LINE-OF-CR-AMT        TO VN003-LINE-OF-CREDIT     05250001
052510                                         PV-DISP-LINE-OF-CR-AMT.  05251001
052600     MOVE VN007-PO-PREPK-CDE          TO VN003-PO-PREPK-CDE       05260001
052700                                         PV-DISP-PO-PREPK-CDE.    05270001
052710     PERFORM Z9990-WRITE-CICS.                                    05271001
052720                                                                  05272001
052800     MOVE VN007-FUNCTION-ID(1)        TO VN003-ADDR-TYP-CDE.      05280000
052900     MOVE VN007-ADDR-SEQ-NBR(1)       TO VN003-ADDR-SEQ-NBR.      05290000
053000     MOVE VN007-PRIM-ADDR-IND(1)      TO VN003-PRIMARY-ADDR-IND.  05300000
053100     MOVE VN007-CNTRY-CD(1)           TO VN003-COUNTRY.           05310000
053200     MOVE VN007-ADDR-LINE1(1)         TO VN003-ADDR-LINE1.        05320000
053300     MOVE VN007-ADDR-LINE2(1)         TO VN003-ADDR-LINE2.        05330000
053400     MOVE VN007-ADDR-LINE3(1)         TO VN003-ADDR-LINE3.        05340000
053500     MOVE VN007-CITY(1)               TO VN003-CITY.              05350000
053600     MOVE VN007-ST-PROV-CDE(1)        TO VN003-STATE-PROV.        05360000
053700     MOVE VN007-ZIP-CDE(1)            TO VN003-ZIP.               05370000
053800     MOVE VN007-EMAIL-ADD(1)          TO VN003-EMAIL.             05380000
053900     MOVE VN007-CONTACT-NAME(1)       TO VN003-CONTACT-NAME.      05390000
054000     MOVE VN007-TEL1-NBR(1)           TO VN003-TELEPHONE.         05400000
054100     MOVE VN007-FAX-NBR(1)            TO VN003-FAX.               05410000
054200                                                                  05420000
054300     MOVE VN007-DEPT-NBR(1)           TO PV-DEPT-CHAR3.           05430000
054400     MOVE PV-DEPT-FIELD               TO VN003-DEPT-NBR.          05440000
054500     MOVE VN007-VND-DEPT-STAT-CD(1)   TO VN003-DEPT-STATUS.       05450000
054600     MOVE VN007-BULK-STK-TKT-IND(1)   TO VN003-BULK-TICKETS.      05460000
054700     MOVE VN007-TKT-MKR-IND(1)        TO VN003-TICKET-MAKER.      05470000
054800     MOVE VN007-HANGER-IND(1)         TO VN003-HANGERS.           05480000
054900     MOVE VN007-PACK-BY-STR-IND(1)    TO VN003-PACK-BY-STORE.     05490000
055000     MOVE VN007-SPLIT-REQD-IND(1)     TO VN003-DC-SPLIT-REQD.     05500000
055100     MOVE VN007-SPLIT-LEADTIME-QTY(1) TO VN003-DC-SPLIT-LEADTIME. 05510000
055200     MOVE VN007-PRETKT-LEADTIME-QTY(1) TO                         05520000
055300                                      VN003-PRETICKET-LEADTIME.   05530000
055400     MOVE VN007-NSD-DISC-PCT(1)       TO PV-DISC-DECIMALS.        05540000
055500     MOVE PV-DISC-FIELD               TO VN003-NEW-STORE-DISC.    05550000
055600     MOVE VN007-NSD-EXT-DAYS-QTY(1)   TO VN003-NEW-STORE-DAYS.    05560000
055700     MOVE VN007-MOS-DISC-PCT(1)       TO PV-DISC-DECIMALS.        05570000
055800     MOVE PV-DISC-FIELD               TO VN003-MOS-DISC.          05580000
055900     MOVE VN007-TRD-DISC-PCT(1)       TO PV-DISC-DECIMALS.        05590000
056000     MOVE PV-DISC-FIELD               TO VN003-TRADE-DISC.        05600000
056100     MOVE VN007-ADV-DISC-PCT(1)       TO PV-DISC-DECIMALS.        05610000
056200     MOVE PV-DISC-FIELD               TO VN003-ADV-DISC.          05620000
056300     MOVE VN007-COOP-DISC-PCT(1)      TO PV-DISC-DECIMALS.        05630000
056400     MOVE PV-DISC-FIELD               TO VN003-COOP-DISC.         05640000
056500     MOVE VN007-PRFTASST-ADCOOP-PCT(1) TO PV-DISC-DECIMALS.       05650000
056600     MOVE PV-DISC-FIELD              TO VN003-PRFTASST-ADCOOP-ALW.05660000
056700     MOVE VN007-TBL-TWR-DAYS-QTY(1)   TO VN003-TBL-TWR-DAYS.      05670000
056800     MOVE VN007-BRDL-DISC-PCT(1)      TO PV-DISC-DECIMALS.        05680000
056900     MOVE PV-DISC-FIELD               TO VN003-BRDL-DISC.         05690000
057000     MOVE VN007-PAYT-TERM-ID(1)       TO VN003-PAYMENT-TERM-ID.   05700000
057100     MOVE VN007-FRGT-TERM-ID(1)       TO VN003-FREIGHT-TERM-ID.   05710000
057200                                                                  05720000
057300     MOVE VN007-CPBLTY-CDE(1)         TO VN003-CPBLTY-CDE.        05730000
057400     MOVE VN007-CPBLTY-INDICATOR(1)   TO VN003-CPBLTY-INDICATOR.  05740000
057500                                                                  05750000
057600     IF VN007-RLTNSHP-CDE(1) NOT = SPACES                         05760000
057700         MOVE VN007-RLTNSHP-ENT-ID(1) TO VN003-RLTNSHP-ENT-ID     05770000
057800         MOVE VN007-RLTNSHP-CDE(1)    TO VN003-RLTNSHP-CDE        05780000
057900         MOVE VN007-RLTNSHP-INDICATOR(1)                          05790000
058000                                      TO VN003-RLTNSHP-INDICATOR  05800000
058100     END-IF.                                                      05810000
058200                                                                  05820000
058300     MOVE VN003-MESSAGE-HEADER        TO VN003-NEW-VENDOR-HEADER. 05830000
058400     MOVE VN003-NEW-VENDOR-SEGMENT-DATA                           05840000
058500                                      TO VN003-NEW-VENDOR-DATA.   05850000
058600     MOVE VN003-NEW-VENDOR-MESSAGE    TO VN003-MSGBUFFER.         05860000
058700     MOVE VN003-NEW-VENDOR-MSG-LENGTH TO PV-OUT-MSGLENGTH.        05870000
058800                                                                  05880000
058810     DISPLAY 'VN003-VENDOR-SEGMENT-DATA'                          05881001
058820     DISPLAY VN003-VENDOR-SEGMENT-DATA                            05882001
058830                                                                  05883001
058900     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            05890000
059000                PV-MQPUT-RETRY-COUNTER.                           05900000
059100     PERFORM S100-PUT-MQ-MESSAGE                                  05910000
059200       UNTIL PS-MQPUT-SUCCESSFUL.                                 05920000
059300/                                                                 05930000
059400******************************************************************05940000
059500*  DETERMINE WHERE TO MOVE VENDOR DATA - VENDOR OR PARTNER FIELDS*05950000
059600*  THEN MOVE VENDOR DATA FROM INPUT TO OUTPUT FIELDS.            *05960000
059700******************************************************************05970000
059800 C200-PROCESS-VENDOR-PARTNER.                                     05980000
059900     MOVE 'C200-PROCESS-VENDOR-PARTNER - PUT ERROR'               05990000
060000                                           TO PV-PARAGRAPH.       06000000
060100     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       06010000
060200                VN003-VENDOR-MESSAGE                              06020000
060300                VN003-PARTNER-MESSAGE                             06030000
060400                VN003-MSGBUFFER.                                  06040000
060500                                                                  06050000
060600     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        06060000
060700     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            06070000
060800                                                                  06080000
060900     IF VN007-PRIM-TYP-CDE = 'E'                                  06090000
061000        SET VN003-PARTNER-SEGMENT    TO TRUE                      06100000
061100        MOVE VN007-STATUS-CDE        TO VN003-P-VENDOR-STATUS     06110000
061200        MOVE VN007-PRIM-TYP-CDE      TO VN003-P-VENDOR-TYPE       06120000
061300        MOVE VN007-PRTNR-TYP-CDE     TO VN003-P-PARTNER-TYPE      06130000
061400        MOVE VN007-SCAC-CDE          TO VN003-P-SCAC-CDE          06140000
061500        MOVE VN007-ENT-NAME-DESC     TO VN003-P-VENDOR-NAME       06150000
061600        MOVE VN007-LINE-OF-CR-AMT    TO VN003-P-LINE-OF-CREDIT    06160000
061700        MOVE VN007-PO-PREPK-CDE      TO VN003-P-PO-PREPK-CDE      06170000
061800        MOVE VN007-PRTNR-DELETE-IND  TO VN003-P-PARTNER-DELETE-IND06180000
061900        MOVE VN007-LONGNAME          TO VN003-P-LONGNAME          06190000
062000        MOVE SPACE                   TO VN003-P-FILLER            06200000
062100        MOVE VN003-MESSAGE-HEADER    TO VN003-PARTNER-HEADER      06210000
062200        MOVE VN003-PARTNER-SEGMENT-DATA                           06220000
062300                                     TO VN003-PARTNER-DATA        06230000
062400        MOVE VN003-PARTNER-MESSAGE   TO VN003-MSGBUFFER           06240000
062500        MOVE VN003-PARTNER-MSG-LENGTH                             06250000
062600                                     TO PV-OUT-MSGLENGTH          06260000
062700      ELSE                                                        06270000
062800        SET VN003-UPD-VND-SEGMENT    TO TRUE                      06280000
062900        MOVE VN007-STATUS-CDE        TO VN003-VENDOR-STATUS       06290000
063000        MOVE VN007-PRIM-TYP-CDE      TO VN003-VENDOR-TYPE         06300000
063100        MOVE VN007-PRTNR-TYP-CDE     TO VN003-PARTNER-TYPE        06310000
063200        MOVE VN007-SCAC-CDE          TO VN003-SCAC-CDE            06320000
063300        MOVE VN007-ENT-NAME-DESC     TO VN003-VENDOR-NAME         06330000
063400        MOVE VN007-LINE-OF-CR-AMT    TO VN003-LINE-OF-CREDIT      06340000
063500        MOVE VN007-PO-PREPK-CDE      TO VN003-PO-PREPK-CDE        06350000
063600        MOVE VN007-PRTNR-DELETE-IND  TO VN003-PARTNER-DELETE-IND  06360000
063700        MOVE VN003-MESSAGE-HEADER    TO VN003-VENDOR-HEADER       06370000
063800        MOVE VN003-VENDOR-SEGMENT-DATA                            06380000
063900                                     TO VN003-VENDOR-DATA         06390000
064000        MOVE VN003-VENDOR-MESSAGE    TO VN003-MSGBUFFER           06400000
064100        MOVE VN003-VENDOR-MSG-LENGTH TO PV-OUT-MSGLENGTH          06410000
064200     END-IF.                                                      06420000
064300                                                                  06430000
064400     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            06440000
064500                PV-MQPUT-RETRY-COUNTER.                           06450000
064600     PERFORM S100-PUT-MQ-MESSAGE                                  06460000
064700       UNTIL PS-MQPUT-SUCCESSFUL.                                 06470000
064800/                                                                 06480000
064900******************************************************************06490000
065000*  MOVE ADDRESS DATA FROM INPUT TO OUTPUT FIELDS.                *06500000
065100******************************************************************06510000
065200 C300-PROCESS-ADDRESS.                                            06520000
065300     IF VN007-FUNCTION-ID(VN007-ADDR-IND) NOT = ZERO              06530000
065400        PERFORM C350-MOVE-ADDRESS-FIELDS                          06540000
065500     END-IF.                                                      06550000
065600                                                                  06560000
065700     SET VN007-ADDR-IND UP BY 1.                                  06570000
065800                                                                  06580000
065900 C350-MOVE-ADDRESS-FIELDS.                                        06590000
066000     MOVE 'C350-MOVE-ADDRESS-FIELDS - PUT ERROR' TO PV-PARAGRAPH. 06600000
066100     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       06610000
066200                VN003-ADDRESS-MESSAGE                             06620000
066300                VN003-MSGBUFFER.                                  06630000
066400                                                                  06640000
066500     SET VN003-ADDRESS-SEGMENT        TO TRUE.                    06650000
066600     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        06660000
066700     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            06670000
066800                                                                  06680000
066900     MOVE VN007-FUNCTION-ID(VN007-ADDR-IND)                       06690000
067000                                      TO VN003-ADDR-TYP-CDE.      06700000
067100     MOVE VN007-ADDR-SEQ-NBR(VN007-ADDR-IND)                      06710000
067200                                      TO VN003-ADDR-SEQ-NBR.      06720000
067300     MOVE VN007-PRIM-ADDR-IND(VN007-ADDR-IND)                     06730000
067400                                      TO VN003-PRIMARY-ADDR-IND.  06740000
067500     MOVE VN007-CNTRY-CD(VN007-ADDR-IND)                          06750000
067600                                      TO VN003-COUNTRY.           06760000
067700     MOVE VN007-ADDR-LINE1(VN007-ADDR-IND)                        06770000
067800                                      TO VN003-ADDR-LINE1.        06780000
067900     MOVE VN007-ADDR-LINE2(VN007-ADDR-IND)                        06790000
068000                                      TO VN003-ADDR-LINE2.        06800000
068100     MOVE VN007-ADDR-LINE3(VN007-ADDR-IND)                        06810000
068200                                      TO VN003-ADDR-LINE3.        06820000
068300     MOVE VN007-CITY(VN007-ADDR-IND)                              06830000
068400                                      TO VN003-CITY.              06840000
068500     MOVE VN007-ST-PROV-CDE(VN007-ADDR-IND)                       06850000
068600                                      TO VN003-STATE-PROV.        06860000
068700     MOVE VN007-ZIP-CDE(VN007-ADDR-IND)                           06870000
068800                                      TO VN003-ZIP.               06880000
068900     MOVE VN007-EMAIL-ADD(VN007-ADDR-IND)                         06890000
069000                                      TO VN003-EMAIL.             06900000
069100     MOVE VN007-CONTACT-NAME(VN007-ADDR-IND)                      06910000
069200                                      TO VN003-CONTACT-NAME.      06920000
069300     MOVE VN007-TEL1-NBR(VN007-ADDR-IND)                          06930000
069400                                      TO VN003-TELEPHONE.         06940000
069500     MOVE VN007-FAX-NBR(VN007-ADDR-IND)                           06950000
069600                                      TO VN003-FAX.               06960000
069700                                                                  06970000
069800     IF VN007-ADDR-DELETE-IND(VN007-ADDR-IND) = ' '               06980000
069900        MOVE 'N'                      TO VN003-ADDRESS-DELETE-IND 06990000
070000     ELSE                                                         07000000
070100        MOVE VN007-ADDR-DELETE-IND(VN007-ADDR-IND)                07010000
070200                                      TO VN003-ADDRESS-DELETE-IND 07020000
070300     END-IF.                                                      07030000
070400                                                                  07040000
070500     MOVE VN003-MESSAGE-HEADER        TO VN003-ADDRESS-HEADER.    07050000
070600     MOVE VN003-ADDRESS-SEGMENT-DATA  TO VN003-ADDRESS-DATA.      07060000
070700     MOVE VN003-ADDRESS-MESSAGE       TO VN003-MSGBUFFER.         07070000
070800     MOVE VN003-ADDRESS-MSG-LENGTH    TO PV-OUT-MSGLENGTH.        07080000
070900                                                                  07090000
071000     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            07100000
071100                PV-MQPUT-RETRY-COUNTER.                           07110000
071200     PERFORM S100-PUT-MQ-MESSAGE                                  07120000
071300       UNTIL PS-MQPUT-SUCCESSFUL.                                 07130000
071400/                                                                 07140000
071500******************************************************************07150000
071600*  MOVE DEPARTMENT DATA FROM INPUT TO OUTPUT FIELDS.             *07160000
071700******************************************************************07170000
071800 C400-PROCESS-DEPARTMENT.                                         07180000
071900     IF VN007-DEPT-NBR(VN007-DEPT-IND) NOT = SPACES               07190000
072000        PERFORM C450-MOVE-DEPARTMENT-FIELDS                       07200000
072100     END-IF.                                                      07210000
072200                                                                  07220000
072300     SET VN007-DEPT-IND UP BY 1.                                  07230000
072400                                                                  07240000
072500 C450-MOVE-DEPARTMENT-FIELDS.                                     07250000
072600     MOVE 'C450-MOVE-DEPARTMENT-FIELDS - PUT ERROR'               07260000
072700                                      TO PV-PARAGRAPH.            07270000
072800     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       07280000
072900                VN003-DEPARTMENT-MESSAGE                          07290000
073000                VN003-MSGBUFFER.                                  07300000
073100                                                                  07310000
073200     SET VN003-DEPT-SEGMENT           TO TRUE.                    07320000
073300     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        07330000
073400     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            07340000
073500                                                                  07350000
073600     MOVE VN007-DEPT-NBR(VN007-DEPT-IND)                          07360000
073700                                      TO PV-DEPT-CHAR3.           07370000
073800     MOVE PV-DEPT-FIELD               TO VN003-DEPT-NBR.          07380000
073900     MOVE VN007-VND-DEPT-STAT-CD(VN007-DEPT-IND)                  07390000
074000                                      TO VN003-DEPT-STATUS.       07400000
074100     MOVE VN007-BULK-STK-TKT-IND(VN007-DEPT-IND)                  07410000
074200                                      TO VN003-BULK-TICKETS.      07420000
074300     MOVE VN007-TKT-MKR-IND(VN007-DEPT-IND)                       07430000
074400                                      TO VN003-TICKET-MAKER.      07440000
074500     MOVE VN007-HANGER-IND(VN007-DEPT-IND)                        07450000
074600                                      TO VN003-HANGERS.           07460000
074700     MOVE VN007-PACK-BY-STR-IND(VN007-DEPT-IND)                   07470000
074800                                      TO VN003-PACK-BY-STORE.     07480000
074900     MOVE VN007-SPLIT-REQD-IND(VN007-DEPT-IND)                    07490000
075000                                      TO VN003-DC-SPLIT-REQD.     07500000
075100     MOVE VN007-SPLIT-LEADTIME-QTY(VN007-DEPT-IND)                07510000
075200                                      TO VN003-DC-SPLIT-LEADTIME. 07520000
075300     MOVE VN007-PRETKT-LEADTIME-QTY(VN007-DEPT-IND)               07530000
075400                                   TO VN003-PRETICKET-LEADTIME.   07540000
075500     MOVE VN007-NSD-DISC-PCT(VN007-DEPT-IND)                      07550000
075600                                      TO PV-DISC-DECIMALS.        07560000
075700     MOVE PV-DISC-FIELD               TO VN003-NEW-STORE-DISC.    07570000
075800     MOVE VN007-NSD-EXT-DAYS-QTY(VN007-DEPT-IND)                  07580000
075900                                      TO VN003-NEW-STORE-DAYS.    07590000
076000     MOVE VN007-MOS-DISC-PCT(VN007-DEPT-IND)                      07600000
076100                                      TO PV-DISC-DECIMALS.        07610000
076200     MOVE PV-DISC-FIELD               TO VN003-MOS-DISC.          07620000
076300     MOVE VN007-TRD-DISC-PCT(VN007-DEPT-IND)                      07630000
076400                                      TO PV-DISC-DECIMALS.        07640000
076500     MOVE PV-DISC-FIELD               TO VN003-TRADE-DISC.        07650000
076600     MOVE VN007-ADV-DISC-PCT(VN007-DEPT-IND)                      07660000
076700                                      TO PV-DISC-DECIMALS.        07670000
076800     MOVE PV-DISC-FIELD               TO VN003-ADV-DISC.          07680000
076900     MOVE VN007-COOP-DISC-PCT(VN007-DEPT-IND)                     07690000
077000                                      TO PV-DISC-DECIMALS.        07700000
077100     MOVE PV-DISC-FIELD               TO VN003-COOP-DISC.         07710000
077200     MOVE VN007-PRFTASST-ADCOOP-PCT(VN007-DEPT-IND)               07720000
077300                                      TO PV-DISC-DECIMALS.        07730000
077400     MOVE PV-DISC-FIELD              TO VN003-PRFTASST-ADCOOP-ALW.07740000
077500     MOVE VN007-TBL-TWR-DAYS-QTY(VN007-DEPT-IND)                  07750000
077600                                      TO VN003-TBL-TWR-DAYS.      07760000
077700     MOVE VN007-BRDL-DISC-PCT(VN007-DEPT-IND)                     07770000
077800                                      TO PV-DISC-DECIMALS.        07780000
077900     MOVE PV-DISC-FIELD               TO VN003-BRDL-DISC.         07790000
078000     MOVE VN007-PAYT-TERM-ID(VN007-DEPT-IND)                      07800000
078100                                      TO VN003-PAYMENT-TERM-ID.   07810000
078200     MOVE VN007-FRGT-TERM-ID(VN007-DEPT-IND)                      07820000
078300                                      TO VN003-FREIGHT-TERM-ID.   07830000
078400                                                                  07840000
078500     MOVE VN003-MESSAGE-HEADER        TO VN003-DEPARTMENT-HEADER. 07850000
078600     MOVE VN003-DEPARTMENT-SEGMENT-DATA                           07860000
078700                                      TO VN003-DEPARTMENT-DATA.   07870000
078800     MOVE VN003-DEPARTMENT-MESSAGE    TO VN003-MSGBUFFER.         07880000
078900     MOVE VN003-DEPARTMENT-MSG-LENGTH TO PV-OUT-MSGLENGTH.        07890000
079000                                                                  07900000
079100     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            07910000
079200                PV-MQPUT-RETRY-COUNTER.                           07920000
079300     PERFORM S100-PUT-MQ-MESSAGE                                  07930000
079400       UNTIL PS-MQPUT-SUCCESSFUL.                                 07940000
079500/                                                                 07950000
079600******************************************************************07960000
079700*  MOVE EDI DATA FROM INPUT TO OUTPUT FIELDS.                    *07970000
079800******************************************************************07980000
079900 C500-PROCESS-EDI.                                                07990000
080000     MOVE 'C500-PROCESS-EDI - PUT ERROR' TO PV-PARAGRAPH.         08000000
080100     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       08010000
080200                VN003-EDI-MESSAGE                                 08020000
080300                VN003-MSGBUFFER.                                  08030000
080400                                                                  08040000
080500     SET VN003-EDI-SEGMENT            TO TRUE.                    08050000
080600     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        08060000
080700     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            08070000
080800                                                                  08080000
080900     MOVE VN007-EDI-PO-IND            TO VN003-EDI-PO-IND.        08090000
081000     MOVE VN007-EDI-ASN-IND           TO VN003-EDI-ASN-IND.       08100000
081100     MOVE VN007-EDI-POCHG-IND         TO VN003-EDI-POCHG-IND.     08110000
081200     MOVE VN007-EDI-PO-PROD-IND       TO VN003-EDI-PO-PROD-IND.   08120000
081300     MOVE VN007-EDI-PO-TEST-IND       TO VN003-EDI-PO-TEST-IND.   08130000
081400     MOVE VN007-EDI-POCHG-PROD-IND    TO VN003-EDI-POCHG-PROD-IND.08140000
081500     MOVE VN007-EDI-POCHG-TEST-IND    TO VN003-EDI-POCHG-TEST-IND.08150000
081600     MOVE VN007-EDI-VNDR-TYPE-IND     TO VN003-EDI-VNDR-TYPE-IND. 08160000
081700                                                                  08170000
081800     MOVE VN003-MESSAGE-HEADER        TO VN003-EDI-HEADER.        08180000
081900     MOVE VN003-EDI-MESSAGE           TO VN003-MSGBUFFER.         08190000
082000     MOVE VN003-EDI-MSG-LENGTH        TO PV-OUT-MSGLENGTH.        08200000
082100                                                                  08210000
082200     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            08220000
082300                PV-MQPUT-RETRY-COUNTER.                           08230000
082400     PERFORM S100-PUT-MQ-MESSAGE                                  08240000
082500       UNTIL PS-MQPUT-SUCCESSFUL.                                 08250000
082600/                                                                 08260000
082700******************************************************************08270000
082800*  MOVE CAPABILITY DATA FROM INPUT TO OUTPUT FIELDS.             *08280000
082900******************************************************************08290000
083000 C600-PROCESS-CAPABILITY.                                         08300000
083100     IF VN007-CPBLTY-CDE(VN007-CPBL-IND) NOT = SPACES             08310000
083200        PERFORM C650-MOVE-CPBLTY-FIELDS                           08320000
083300     END-IF.                                                      08330000
083400                                                                  08340000
083500     SET VN007-CPBL-IND UP BY 1.                                  08350000
083600                                                                  08360000
083700 C650-MOVE-CPBLTY-FIELDS.                                         08370000
083800     MOVE 'C650-MOVE-CPBLTY-FIELDS - PUT ERROR' TO PV-PARAGRAPH.  08380000
083900     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       08390000
084000                VN003-CPBLTY-MESSAGE                              08400000
084100                VN003-MSGBUFFER.                                  08410000
084200                                                                  08420000
084300     SET VN003-CPBLTY-SEGMENT         TO TRUE.                    08430000
084400     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        08440000
084500     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            08450000
084600                                                                  08460000
084700     MOVE VN007-CPBLTY-CDE(VN007-CPBL-IND)                        08470000
084800                                      TO VN003-CPBLTY-CDE.        08480000
084900     MOVE VN007-CPBLTY-INDICATOR(VN007-CPBL-IND)                  08490000
085000                                      TO VN003-CPBLTY-INDICATOR.  08500000
085100                                                                  08510000
085200     MOVE VN003-MESSAGE-HEADER        TO VN003-CPBLTY-HEADER.     08520000
085300     MOVE VN003-CAPABILITY-SEGMENT-DATA                           08530000
085400                                      TO VN003-CPBLTY-DATA.       08540000
085500     MOVE VN003-CPBLTY-MESSAGE        TO VN003-MSGBUFFER.         08550000
085600     MOVE VN003-CPBLTY-MSG-LENGTH     TO PV-OUT-MSGLENGTH.        08560000
085700                                                                  08570000
085800     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            08580000
085900                PV-MQPUT-RETRY-COUNTER.                           08590000
086000     PERFORM S100-PUT-MQ-MESSAGE                                  08600000
086100       UNTIL PS-MQPUT-SUCCESSFUL.                                 08610000
086200/                                                                 08620000
086300******************************************************************08630000
086400*  MOVE RELATIONSHIP DATA FROM INPUT TO OUTPUT FIELDS.           *08640000
086500******************************************************************08650000
086600 C700-PROCESS-RELATIONSHIP.                                       08660000
086700     IF VN007-RLTNSHP-CDE(VN007-RLTN-IND) NOT = SPACES            08670000
086800        PERFORM C750-MOVE-RLTNSHP-FIELDS                          08680000
086900     END-IF.                                                      08690000
087000                                                                  08700000
087100     SET VN007-RLTN-IND UP BY 1.                                  08710000
087200                                                                  08720000
087300 C750-MOVE-RLTNSHP-FIELDS.                                        08730000
087400     MOVE 'C750-MOVE-RLTNSHP-FIELDS - PUT ERROR' TO PV-PARAGRAPH. 08740000
087500     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       08750000
087600                VN003-RLTNSHP-MESSAGE                             08760000
087700                VN003-MSGBUFFER.                                  08770000
087800                                                                  08780000
087900     SET VN003-RLTNSHP-SEGMENT        TO TRUE.                    08790000
088000     MOVE VN007-VND-NBR               TO VN003-VENDOR-NBR.        08800000
088100     MOVE VN007-ENT-ID                TO VN003-ENT-ID.            08810000
088200                                                                  08820000
088300     MOVE VN007-RLTNSHP-ENT-ID(VN007-RLTN-IND)                    08830000
088400                                      TO VN003-RLTNSHP-ENT-ID.    08840000
088500     MOVE VN007-RLTNSHP-CDE(VN007-RLTN-IND)                       08850000
088600                                      TO VN003-RLTNSHP-CDE.       08860000
088700     MOVE VN007-RLTNSHP-INDICATOR(VN007-RLTN-IND)                 08870000
088800                                      TO VN003-RLTNSHP-INDICATOR. 08880000
088900                                                                  08890000
089000     MOVE VN003-MESSAGE-HEADER        TO VN003-RLTNSHP-HEADER.    08900000
089100     MOVE VN003-RELATION-SEGMENT-DATA TO VN003-RLTNSHP-DATA.      08910000
089200     MOVE VN003-RLTNSHP-MESSAGE       TO VN003-MSGBUFFER.         08920000
089300     MOVE VN003-RLTNSHP-MSG-LENGTH    TO PV-OUT-MSGLENGTH.        08930000
089400                                                                  08940000
089500     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            08950000
089600                PV-MQPUT-RETRY-COUNTER.                           08960000
089700     PERFORM S100-PUT-MQ-MESSAGE                                  08970000
089800       UNTIL PS-MQPUT-SUCCESSFUL.                                 08980000
089900/                                                                 08990000
090000******************************************************************09000000
090100*  MOVE LONGNAME DATA FROM INPUT TO OUTPUT FIELDS.               *09010000
090200******************************************************************09020000
090300 C800-PROCESS-LONGNAME.                                           09030000
090400     MOVE 'C800-PROCESS-LONGNAME - PUT ERROR' TO PV-PARAGRAPH.    09040000
090500     INITIALIZE VN003-MESSAGE-DETAIL-LAYOUT                       09050000
090600                VN003-LONGNAME-MESSAGE                            09060000
090700                VN003-MSGBUFFER.                                  09070000
090800                                                                  09080000
090900     SET VN003-LONGNAME-SEGMENT     TO TRUE.                      09090000
091000     MOVE VN007-VND-NBR             TO VN003-VENDOR-NBR.          09100000
091100     MOVE VN007-ENT-ID              TO VN003-ENT-ID.              09110000
091200                                                                  09120000
091300*    MOVE VN007-LONGNAME            TO VN003-P-LONGNAME.          09130000
091400*    MOVE VN007-LONGNAME-DELETE-IND TO VN003-LONGNAME-DELETE-IND. 09140000
091500     IF VN007-LONGNAME-DELETE-IND = 'Y'                           09150000
091600        MOVE SPACES                 TO VN003-P-LONGNAME           09160000
091700     ELSE                                                         09170000
091800        MOVE VN007-LONGNAME         TO VN003-P-LONGNAME           09180000
091900     END-IF.                                                      09190000
092000     MOVE SPACE                     TO VN003-LONGNAME-DELETE-IND. 09200000
092100                                                                  09210000
092200     MOVE VN003-MESSAGE-HEADER        TO VN003-LONGNAME-HEADER.   09220000
092300     MOVE VN003-LONGNAME-SEGMENT-DATA TO VN003-LONGNAME-DATA.     09230000
092400     MOVE VN003-LONGNAME-MESSAGE      TO VN003-MSGBUFFER.         09240000
092500     MOVE VN003-LONGNAME-MSG-LENGTH   TO PV-OUT-MSGLENGTH.        09250000
092600                                                                  09260000
092700     INITIALIZE PS-MQPUT-SUCCESSFUL-SW                            09270000
092800                PV-MQPUT-RETRY-COUNTER.                           09280000
092900     PERFORM S100-PUT-MQ-MESSAGE                                  09290000
093000       UNTIL PS-MQPUT-SUCCESSFUL.                                 09300000
093100/                                                                 09310000
093200******************************************************************09320000
093300*  COUNT THE NUMBER OF ADDRESS MESSAGES THAT WILL BE CREATED.     09330000
093400******************************************************************09340000
093500 D100-COUNT-NBR-OF-ADDR-MSGS.                                     09350000
093600     IF VN007-FUNCTION-ID(VN007-ADDR-IND) NOT = ZERO              09360000
093700        ADD 1 TO PV-NBR-OF-MSGS-CREATED                           09370000
093800     END-IF.                                                      09380000
093900                                                                  09390000
094000     SET VN007-ADDR-IND UP BY 1.                                  09400000
094100                                                                  09410000
094200/                                                                 09420000
094300******************************************************************09430000
094400*  COUNT THE NUMBER OF ADDRESS MESSAGES THAT WILL BE CREATED.     09440000
094500******************************************************************09450000
094600 D200-COUNT-NBR-OF-DEPT-MSGS.                                     09460000
094700     IF VN007-DEPT-NBR(VN007-DEPT-IND) NOT = SPACES               09470000
094800        ADD 1 TO PV-NBR-OF-MSGS-CREATED                           09480000
094900     END-IF.                                                      09490000
095000                                                                  09500000
095100     SET VN007-DEPT-IND UP BY 1.                                  09510000
095200                                                                  09520000
095300/                                                                 09530000
095400******************************************************************09540000
095500*  PUT MESSAGE ON THE VENDOR INFO TO RMS QUEUE.                   09550000
095600******************************************************************09560000
095700 S100-PUT-MQ-MESSAGE.                                             09570000
095800     MOVE PC-QMGR-NAME           TO MQOD-OBJECTQMGRNAME.          09580000
095900     MOVE PC-QNAME               TO MQOD-OBJECTNAME.              09590000
096000     MOVE MQMI-NONE              TO MQMD-MSGID.                   09600000
096100     MOVE MQCI-NONE              TO MQMD-CORRELID.                09610000
096200     MOVE MQFMT-STRING           TO MQMD-FORMAT.                  09620000
096300     MOVE MQPER-PERSISTENT       TO MQMD-PERSISTENCE.             09630000
096400     COMPUTE MQPMO-OPTIONS  = MQPMO-SYNCPOINT.                    09640000
096500*    COMPUTE MQPMO-OPTIONS  = MQPMO-NO-SYNCPOINT.                 09650000
096600*                                                                 09660000
096700     CALL WS-MQPUT USING PV-HCONN                                 09670000
096800                         PV-PQ-HANDLE                             09680000
096900                         MQM-MESSAGE-DESCRIPTOR                   09690000
097000                         MQM-PUT-MESSAGE-OPTIONS                  09700000
097100                         PV-OUT-MSGLENGTH                         09710000
097200                         VN003-MSGBUFFER                          09720000
097300                         PV-COMPLETION-CODE                       09730000
097400                         PV-REASON.                               09740000
097500                                                                  09750000
097600*        IF PUT FAILED THEN DISPLAY ERROR MESSAGE                 09760000
097700*        AND BREAK OUT OF LOOP                                    09770000
097800                                                                  09780000
097900     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        09790000
098000         ADD 1 TO PV-MQPUT-RETRY-COUNTER                          09800000
098100         IF PV-MQPUT-RETRY-COUNTER > PC-MAX-RETRIES               09810000
098200             MOVE PV-PARAGRAPH         TO PV-SAVE-PARAGRAPH       09820000
098300             MOVE PV-COMPLETION-CODE   TO PV-SAVE-COMPLETION-CODE 09830000
098400             MOVE PV-REASON            TO PV-SAVE-REASON          09840000
098500             PERFORM Y200-CLOSE-MQ-QUEUE                          09850000
098600             MOVE PV-SAVE-PARAGRAPH    TO PV-PARAGRAPH            09860000
098700             MOVE PV-SAVE-COMPLETION-CODE TO PV-COMPLETION-CODE   09870000
098800             MOVE PV-SAVE-REASON       TO PV-REASON               09880000
098900             PERFORM Z900-DISPLAY-MQ-ERROR                        09890000
099000         ELSE                                                     09900000
099100**------->   WAIT FOR 5 SECONDS AND TRY AGAIN                     09910000
099200             EXEC CICS DELAY FOR SECONDS(5)                       09920000
099300             END-EXEC                                             09930000
099400         END-IF                                                   09940000
099500     ELSE                                                         09950000
099600         SET PS-MQPUT-SUCCESSFUL TO TRUE                          09960000
099700     END-IF.                                                      09970000
099800/                                                                 09980000
099900******************************************************************09990000
100000*  CLOSE THE INPUT AND OUTPUT MESSAGE QUEUES.                     10000000
100100******************************************************************10010000
100200 Y200-CLOSE-MQ-QUEUE.                                             10020000
100300                                                                  10030000
100400     CALL WS-MQCLOSE USING PV-HCONN                               10040000
100500                           PV-PQ-HANDLE                           10050000
100600                           MQCO-NONE                              10060000
100700                           PV-COMPLETION-CODE                     10070000
100800                           PV-REASON.                             10080000
100900                                                                  10090000
101000     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        10100000
101100        MOVE 'Y200-CLOSE-MQ-QUEUE - CLOSE ERROR' TO PV-PARAGRAPH  10110000
101200        PERFORM Z900-DISPLAY-MQ-ERROR                             10120000
101300     END-IF.                                                      10130000
101400/                                                                 10140000
101500* ------------------------------------------------------------- * 10150000
101600* DISPLAY THE VALUES OF A FAILED MQ API COMMAND, AND ABEND PGM    10160000
101700* ------------------------------------------------------------- * 10170000
101800 Z900-DISPLAY-MQ-ERROR.                                           10180000
101900                                                                  10190000
102000     IF PV-COMPLETION-CODE NOT = MQCC-OK                          10200000
102100        CALL WS-MQCHECK USING PV-REASON PV-MQ-REASON-TEXT         10210000
102200     END-IF.                                                      10220000
102300                                                                  10230000
102400     SET VN007-MQ-ERROR     TO TRUE.                              10240000
102500     MOVE PC-PGM-NAME       TO VN007-PROGRAM-NAME.                10250000
102600     MOVE PV-PARAGRAPH      TO VN007-PARAGRAPH-NAME.              10260000
102700     MOVE PV-MQ-REASON-TEXT TO VN007-MESSAGE.                     10270000
102800     MOVE PV-REASON         TO PV-REASON-NONBIN.                  10280000
102900     MOVE PV-REASON-NONBIN  TO VN007-REASON-CODE.                 10290000
103000                                                                  10300000
103100     EXEC CICS                                                    10310000
103200      RETURN                                                      10320000
103300     END-EXEC.                                                    10330000
103400                                                                  10340000
103410*----------------------------------------------------------------*10341001
103420*                                                                 10342001
103430*----------------------------------------------------------------*10343001
103440 Z9990-WRITE-CICS.                                                10344001
103441         DISPLAY 'VNKCS024 ENT-ID    '     PV-DISP-ENT-ID         10344107
103442         DISPLAY 'VN003-PO-PREPK-CDE '     VN003-PO-PREPK-CDE     10344207
103443                                                                  10344307
103444         STRING  ' VNKCS024-ADD'           DELIMITED BY SIZE      10344401
103445                 ' ENT-ID-'                DELIMITED BY SIZE      10344506
103446                 PV-DISP-ENT-ID            DELIMITED BY SIZE      10344606
103447                 ' PREPK-CDE-'             DELIMITED BY SIZE      10344706
103448                 PV-DISP-PO-PREPK-CDE      DELIMITED BY SIZE      10344806
103449                 ' PRIM-TYP  '             DELIMITED BY SIZE      10344906
103450                 PV-DISP-PRIM-TYP-CDE      DELIMITED BY SIZE      10345001
103457                 ' CR-AMT-'                DELIMITED BY SIZE      10345706
103458                 PV-DISP-LINE-OF-CR-AMT    DELIMITED BY SIZE      10345801
103463                                      INTO PV-CICS-MSG-AREA       10346301
103464     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     10346401
103465                                                                  10346501
103470     EXEC CICS WRITEQ TD                                          10347001
103480                      QUEUE('CSSL')                               10348001
103490                      FROM(PV-CICS-MSG-AREA)                      10349001
103491                      LENGTH(PV-COMMAREA-LENGTH)                  10349101
103492                      RESP (PV-CICS-RESPONSE)                     10349201
103493     END-EXEC.                                                    10349301
103494                                                                  10349401
103495     MOVE SPACES TO PV-CICS-MSG-AREA.                             10349501
103500*----------------------------------------------------------------*10350000
103600*    ABEND PROCESSOR MODULE                                      *10360000
103700*----------------------------------------------------------------*10370000
103800                                                                  10380000
103900     COPY DPPD013.                                                10390000
104000                                                                  10400000
