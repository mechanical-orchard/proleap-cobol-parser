000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'LABOR MANAGEMENT - RF MESSAGE SCREEN'.                    00020000
000300                                                                  00030000
000400 PROGRAM-ID.             DLKRF456.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN            SEPTEMBER, 2000.                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100* THIS PROGRAM HAS 3 FUNCTIONS:                                   00110000
001200* 1 -  DISPLAY A FULL-SCREEN MESSAGE TO THE USER.                 00120000
001300                                                                  00130000
001400* 2 -  GRACEFULLY HANDLE A DB2 ABEND BY DISPLAYING A READABLE     00140000
001500*      MESSAGE ON THE LRT AND PRINTING DIAGNOSTICS TO THE CICS LOG00150000
001600                                                                  00160000
001700* 3 -  ALLOW USER TO CHOOSE HOW THEY WANT TO ENTER QUANTITIES.    00170000
001800*      EITHER THEY CAN SCAN EACH ITEM INDIVIDUALLY WITH A QTY     00180000
001900*      OF 1 OR SCAN THE UPC ONCE AND ENTER A MULTIPLIER QTY.      00190000
002000*      DL010-NEXT-PROGRAM IS USED TO XCTL TO THE PROGRAM USED     00200000
002100*      FOR THE DATA ENTRY.                                        00210000
002200                                                                  00220000
002300                                                                  00230000
002400******************************************************************00240000
002500                                                                  00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700 DATA DIVISION.                                                   00270000
002800                                                                  00280000
002900 WORKING-STORAGE SECTION.                                         00290000
003000                                                                  00300000
003100 01  DK-DB2-KEYS.                                                 00310000
003200     05  DK-ADJ-USR-ID                PIC  X(08) VALUE SPACES.    00320000
003300                                                                  00330000
003400 01  PV-PROGRAM-VARIABLES.                                        00340000
003500     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE ZERO      00350000
003600                                                     COMP SYNC.   00360000
003700     05  PV-TEXT-LENGTH               PIC S9(04)  VALUE ZERO      00370000
003800                                                     COMP SYNC.   00380000
003900     05  PV-MESSAGE-AREA              PIC X(19)  VALUE SPACE.     00390000
004000     05  PV-CICS-RESPONSE             PIC S9(08) VALUE ZEROS      00400000
004100                                                     COMP SYNC.   00410000
004200     05  PV-TRANSFER-PROGRAM          PIC X(08)  VALUE SPACES.    00420000
004300                                                                  00430000
004400 01  PC-PROGRAM-CONSTANTS.                                        00440000
004500     05  PC-CURRENT-TRANID            PIC X(04)  VALUE 'D456'.    00450000
004600     05  PC-UNUSED-LABEL-PGM          PIC X(08)  VALUE 'DLKRF851'.00460000
004700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'DLKRF456'.00470000
004800     05  PC-MASTER-CONTAINER-PGM      PIC X(08)  VALUE 'DLKRF864'.00480000
004900     05  PC-BARCODE-ENTRY-PGM         PIC X(08)  VALUE 'DLKRF865'.00490000
005000     05  PC-SEAL-NBRS-ENTRY-PGM       PIC X(08)  VALUE 'DLKRF866'.00500000
005100     05  PC-ADDL-SML-PGM              PIC X(08)  VALUE 'DLKRF856'.00510000
005200*    PC-NEW-LINE IS HEX '15'                                      00520000
005300     05  PC-NEW-LINE                  PIC X(01)  VALUE X'15'.     00530000
005400                                                                  00540000
005500 01  PV-TEXT.                                                     00550000
005600     05  PV-TEXT-LINE-1.                                          00560000
005700         10  FILLER              PIC X(06)   VALUE 'PGM:  '.      00570000
005800         10  PV-TEXT-HEADER      PIC X(08)   VALUE 'DLKRF871'.    00580000
005900         10  FILLER              PIC X(05)   VALUE SPACES.        00590000
006000         10  PV-NEW-LINE-1       PIC X(01)   VALUE SPACES.        00600000
006100     05  PV-TEXT-LINE-2.                                          00610000
006200         10  FILLER              PIC X(06)   VALUE 'MSG:  '.      00620000
006300         10  PV-TEXT-MSG-NBR     PIC 9(03)   VALUE ZEROES.        00630000
006400         10  FILLER              PIC X(10)   VALUE SPACES.        00640000
006500         10  PV-NEW-LINE-2       PIC X(01)   VALUE SPACES.        00650000
006600     05  PV-TEXT-LINE-3.                                          00660000
006700         10  FILLER              PIC X(06)   VALUE 'LAST: '.      00670000
006800         10  PV-TEXT-LAST-PGM    PIC X(08)   VALUE SPACES.        00680000
006900         10  FILLER              PIC X(05)   VALUE SPACES.        00690000
007000         10  PV-NEW-LINE-3       PIC X(01)   VALUE SPACES.        00700000
007100     05  PV-TEXT-LINE-4.                                          00710000
007200         10  FILLER              PIC X(06)   VALUE 'ROOT: '.      00720000
007300         10  PV-TEXT-ROOT-PGM    PIC X(08)   VALUE SPACES.        00730000
007400         10  FILLER              PIC X(05)   VALUE SPACES.        00740000
007500         10  PV-NEW-LINE-4       PIC X(01)   VALUE SPACES.        00750000
007600     05  PV-TEXT-LINE-5.                                          00760000
007700         10  FILLER              PIC X(06)   VALUE 'MENU: '.      00770000
007800         10  PV-TEXT-MENU-PGM    PIC X(08)   VALUE SPACES.        00780000
007900         10  FILLER              PIC X(05)   VALUE SPACES.        00790000
008000         10  PV-NEW-LINE-5       PIC X(01)   VALUE SPACES.        00800000
008100     05  PV-TEXT-LINE-6.                                          00810000
008200         10  FILLER              PIC X(06)   VALUE 'NEXT: '.      00820000
008300         10  PV-NEXT-MENU-PGM    PIC X(08)   VALUE SPACES.        00830000
008400         10  FILLER              PIC X(05)   VALUE SPACES.        00840000
008500         10  PV-NEW-LINE-6       PIC X(01)   VALUE SPACES.        00850000
008600     05  PV-TEXT-LINE-7.                                          00860000
008700         10  FILLER              PIC X(19)   VALUE SPACES.        00870000
008800         10  PV-NEW-LINE-7       PIC X(01)   VALUE SPACES.        00880000
008900     05  PV-TEXT-LINE-8          PIC X(20)   VALUE                00890000
009000         ' ENTER TO CONTINUE  '.                                  00900000
009100                                                                  00910000
009200/                                                                 00920000
009300     COPY DFHAID.                                                 00930000
009400     COPY DPWS013.                                                00940000
009500                                                                  00950000
009600     COPY DLKM456.                                                00960000
009700                                                                  00970000
009800                                                                  00980000
009900                                                                  00990000
010000*  COMMAREA TO/FROM HOST PROGRAM                                  01000000
010100                                                                  01010000
010200     COPY DLWS010.                                                01020000
010300                                                                  01030000
010400*  COPY BOOK CONTAINING THE SYSTEM LINE MESSAGES                  01040000
010500*    COPY PCWS034.                                                01050000
010600                                                                  01060000
010700*  FULL SCREEN MESSAGES                                           01070000
010800     COPY DLWS012.                                                01080000
010900                                                                  01090000
011000*  LINE MESSAGES                                                  01100000
011100     COPY DLWS014.                                                01110000
011200                                                                  01120000
011300* HELP SCREEN COMMAREA                                            01130000
011400     COPY PCWS192.                                                01140000
011500* HELP SCREEN WORK AREA                                           01150000
011600     COPY PCWS188.                                                01160000
011700                                                                  01170000
011800**   LAYOUT FOR TEMP-STORAGE QUEUE INFORMATION.                   01180000
011900*                                                                 01190000
012000     COPY DPWS026.                                                01200000
012100*                                                                 01210000
012200**   HEX CONVERSION ROUTINE PARAMETER LIST                        01220000
012300*                                                                 01230000
012400     COPY DPWS012.                                                01240000
012500*                                                                 01250000
012600/                                                                 01260000
012700 01  LT-LOG-LINE-TABLE.                                           01270000
012800     05  LT-LOG-LINE             OCCURS 52 TIMES                  01280000
012900                                 INDEXED BY LT-IDX.               01290000
013000         10  LT-ERROR-MESSAGE    PIC  X(79).                      01300000
013100                                                                  01310000
013200 01  PV-ABEND-STUFF.                                              01320000
013300     05  PV-LOG-LINE.                                             01330000
013400         10  FILLER              PIC  X(22)  VALUE                01340000
013500             '*** ERROR ON TERMINAL '.                            01350000
013600         10  PV-LOG-TERMINAL     PIC  X(04)  VALUE SPACE.         01360000
013700         10  FILLER              PIC  X(06)  VALUE ' ===> '.      01370000
013800         10  PV-LOG-DATA         PIC  X(79)  VALUE SPACE.         01380000
013900     05 DL1-DB2-LINE-1.                                           01390000
014000         10 FILLER               PIC  X(16)  VALUE SPACE.         01400000
014100         10 FILLER               PIC  X(47)  VALUE                01410000
014200             'THERE WAS AN ERROR ENCOUNTERED IN A DB2 COMMAND'.   01420000
014300         10 FILLER               PIC  X(16)  VALUE SPACE.         01430000
014400     05 DL2-DB2-LINE-2.                                           01440000
014500         10 FILLER               PIC  X(43)  VALUE                01450000
014600             'THE FOLLOWING DB2 TABLE(S) MAY BE INVOLVED:'.       01460000
014700         10 FILLER               PIC  X(36)  VALUE SPACE.         01470000
014800                                                                  01480000
014900     05  TS-INFO-QUEUE-NAME.                                      01490000
015000         10  TS-INFO-QUEUE-TERMINAL                               01500000
015100                                 PIC X(04)   VALUE SPACE.         01510000
015200         10  FILLER              PIC X(04)   VALUE 'INFO'.        01520000
015300                                                                  01530000
015400     05  PC-LOG-QUEUE-RESOURCE   PIC  X(04)  VALUE 'CSSL'.        01540000
015500     05  PV-NUMBER-LOG-LINES     PIC S9(04)  VALUE +0             01550000
015600                                              COMP SYNC.          01560000
015700     05  PC-LOG-QUEUE            PIC  X(04)  VALUE 'CSSL'.        01570000
015800     05  PS-LOG-OVERFLOW-SW      PIC  X(01)  VALUE 'N'.           01580000
015900         88  PS-LOG-OVERFLOW                 VALUE 'Y'.           01590000
016000     05  PC-LOGON-TRAN           PIC  X(04)  VALUE 'Z028'.        01600000
016100     05  PV-SYSID                PIC  X(04)  VALUE SPACES.        01610000
016200     05  PV-TS-ITEM              PIC S9(04)  VALUE +1             01620000
016300                                              COMP SYNC.          01630000
016400     05  PV-MSG-SUB              PIC S9(04)  VALUE +0             01640000
016500                                              COMP SYNC.          01650000
016600     05  PC-LOG-TABLE-MAX        PIC S9(04)  VALUE +52            01660000
016700                                             COMP.                01670000
016800     05  PV-STRING-POINTER       PIC S9(04)  VALUE +1             01680000
016900                                              COMP SYNC.          01690000
017000     05  PC-STRING-POINTER-MAX   PIC S9(04)  VALUE +60            01700000
017100                                             COMP.                01710000
017200 01  FDB-FORMAT-DB2-ERROR-FIELDS.                                 01720000
017300     05  FDB-MAX-MESSAGE-LINES     PIC S9(04)  VALUE +12          01730000
017400                                               COMP SYNC.         01740000
017500     05  FDB-ERROR-LINE-LENGTH     PIC S9(09)  VALUE +75          01750000
017600                                               COMP SYNC.         01760000
017700     05  FDB-FORMATTED-MESSAGE.                                   01770000
017800         10  FILLER                PIC S9(04)  VALUE +900         01780000
017900                                               COMP SYNC.         01790000
018000         10  FDB-MESSAGE-LINE      OCCURS 12 TIMES                01800000
018100                                   INDEXED BY FDB-MSG-IDX         01810000
018200                                   PIC  X(75).                    01820000
018300*                                                                 01830000
018400                                                                  01840000
018500*                                                                 01850000
018600 01  AL1-ABEND-LINE-1.                                            01860000
018700     05  FILLER                  PIC  X(12)  VALUE 'PROGRAM...: '.01870000
018800     05  AL1-PROGRAM             PIC  X(08)  VALUE SPACE.         01880000
018900     05  FILLER                  PIC  X(04)  VALUE SPACE.         01890000
019000     05  FILLER                  PIC  X(11)  VALUE 'PARAGRAPH: '. 01900000
019100     05  AL1-PARAGRAPH           PIC  X(30)  VALUE SPACE.         01910000
019200     05  FILLER                  PIC  X(14)  VALUE SPACE.         01920000
019300 01  AL2-ABEND-LINE-2.                                            01930000
019400     05  FILLER                  PIC  X(12)  VALUE 'USERID....: '.01940000
019500     05  AL2-USERID              PIC  X(08)  VALUE SPACE.         01950000
019600     05  FILLER                  PIC  X(06)  VALUE SPACE.         01960000
019700     05  FILLER                  PIC  X(09)  VALUE 'NETNAME: '.   01970000
019800     05  AL2-NETNAME             PIC  X(08)  VALUE SPACE.         01980000
019900     05  FILLER                  PIC  X(02)  VALUE SPACE.         01990000
020000     05  FILLER                  PIC  X(10)  VALUE 'LOCATION: '.  02000000
020100     05  AL2-LOCATION            PIC  X(03)  VALUE SPACE.         02010000
020200     05  FILLER                  PIC  X(21)  VALUE SPACE.         02020000
020300 01  AL3-ABEND-LINE-3.                                            02030000
020400     05  FILLER                  PIC  X(12)  VALUE                02040000
020500                                             'ABEND TYPE: '.      02050000
020600     05  AL3-ABEND-TYPE          PIC  X(01)  VALUE SPACE.         02060000
020700     05  FILLER                  PIC  X(07)  VALUE SPACE.         02070000
020800     05  FILLER                  PIC  X(15)  VALUE                02080000
020900                                             'ABEND CONTROL: '.   02090000
021000     05  AL3-ABEND-CONTROL       PIC  X(01)  VALUE SPACE.         02100000
021100     05  FILLER                  PIC  X(09)  VALUE SPACE.         02110000
021200     05  FILLER                  PIC  X(10)  VALUE                02120000
021300                                             'ROLLBACK: '.        02130000
021400     05  AL3-ROLLBACK            PIC  X(01)  VALUE SPACE.         02140000
021500     05  FILLER                  PIC  X(23)  VALUE SPACE.         02150000
021600                                                                  02160000
021700 01  AL4-ABEND-LINE-4.                                            02170000
021800     05  FILLER                  PIC  X(11)  VALUE                02180000
021900                                             'MESSAGE...:'.       02190000
022000     05  FILLER                  PIC  X(68)  VALUE SPACE.         02200000
022100*                                                                 02210000
022200*                                                                 02220000
022300**   PREFORMATTED LINES FOR THE EIB AREA                          02230000
022400*                                                                 02240000
022500 01  EL1-EIB-LINE-1.                                              02250000
022600     05  FILLER                  PIC  X(28)  VALUE                02260000
022700         'EIB INFORMATION FOLLOWS:'.                              02270000
022800     05  FILLER                  PIC  X(51)  VALUE SPACE.         02280000
022900 01  EL2-EIB-LINE-2.                                              02290000
023000     05  FILLER                  PIC  X(02)  VALUE SPACE.         02300000
023100     05  FILLER                  PIC  X(10)  VALUE 'EIBTIME.: '.  02310000
023200     05  EL2-EIBTIME             PIC  9(07)+ VALUE ZERO.          02320000
023300     05  FILLER                  PIC  X(20)  VALUE SPACE.         02330000
023400     05  FILLER                  PIC  X(10)  VALUE 'EIBDATE.: '.  02340000
023500     05  EL2-EIBDATE             PIC  9(07)+ VALUE ZERO.          02350000
023600     05  FILLER                  PIC  X(21)  VALUE SPACE.         02360000
023700 01  EL3-EIB-LINE-3.                                              02370000
023800     05  FILLER                  PIC  X(02)  VALUE SPACE.         02380000
023900     05  FILLER                  PIC  X(10)  VALUE 'EIBTRNID: '.  02390000
024000     05  EL3-EIBTRNID            PIC  X(04)  VALUE SPACE.         02400000
024100     05  FILLER                  PIC  X(24)  VALUE SPACE.         02410000
024200     05  FILLER                  PIC  X(10)  VALUE 'EIBTASKN: '.  02420000
024300     05  EL3-EIBTASKN            PIC  9(07)+ VALUE ZERO.          02430000
024400     05  FILLER                  PIC  X(21)  VALUE SPACE.         02440000
024500 01  EL4-EIB-LINE-4.                                              02450000
024600     05  FILLER                  PIC  X(02)  VALUE SPACE.         02460000
024700     05  FILLER                  PIC  X(10)  VALUE 'EIBTRMID: '.  02470000
024800     05  EL4-EIBTRMID            PIC  X(04)  VALUE SPACE.         02480000
024900     05  FILLER                  PIC  X(24)  VALUE SPACE.         02490000
025000     05  FILLER                  PIC  X(10)  VALUE 'EIBCPOSN: '.  02500000
025100     05  EL4-EIBCPOSN            PIC  9(04)+ VALUE ZERO.          02510000
025200     05  FILLER                  PIC  X(24)  VALUE SPACE.         02520000
025300 01  EL5-EIB-LINE-5.                                              02530000
025400     05  FILLER                  PIC  X(02)  VALUE SPACE.         02540000
025500     05  FILLER                  PIC  X(10)  VALUE 'EIBCALEN: '.  02550000
025600     05  EL5-EIBCALEN            PIC  9(05)  VALUE ZERO.          02560000
025700     05  FILLER                  PIC  X(23)  VALUE SPACE.         02570000
025800     05  FILLER                  PIC  X(10)  VALUE 'EIBAID..: '.  02580000
025900     05  EL5-EIBAID              PIC  X(01)  VALUE SPACE.         02590000
026000     05  FILLER                  PIC  X(02)  VALUE ' ('.          02600000
026100     05  EL5-EIBAID-DESCRIPTION  PIC  X(05)  VALUE SPACE.         02610000
026200     05  FILLER                  PIC  X(01)  VALUE ')'.           02620000
026300     05  FILLER                  PIC  X(30)  VALUE SPACE.         02630000
026400 01  EL6-EIB-LINE-6.                                              02640000
026500     05  FILLER                  PIC  X(02)  VALUE SPACE.         02650000
026600     05  FILLER                  PIC  X(12)  VALUE                02660000
026700                                             'EIBFN...: X'''.     02670000
026800     05  EL6-EIBFN-HEX           PIC  X(04)  VALUE SPACE.         02680000
026900     05  FILLER                  PIC  X(01)  VALUE ''''.          02690000
027000     05  FILLER                  PIC  X(21)  VALUE SPACE.         02700000
027100     05  FILLER                  PIC  X(11)  VALUE                02710000
027200                                             'EIBRCODE:X'''.      02720000
027300     05  EL6-EIBRCODE-HEX        PIC  X(12)  VALUE SPACE.         02730000
027400     05  FILLER                  PIC  X(01)  VALUE ''''.          02740000
027500     05  FILLER                  PIC  X(15)  VALUE SPACE.         02750000
027600 01  EL7-EIB-LINE-7.                                              02760000
027700     05  FILLER                  PIC  X(02)  VALUE SPACE.         02770000
027800     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP.: '.  02780000
027900     05  EL7-EIBRESP             PIC  9(08)  VALUE ZERO.          02790000
028000     05  FILLER                  PIC  X(02)  VALUE ' ('.          02800000
028100     05  EL7-EIBRESP-DESCRIPTION PIC  X(12)  VALUE SPACE.         02810000
028200     05  FILLER                  PIC  X(01)  VALUE ')'.           02820000
028300     05  FILLER                  PIC  X(05)  VALUE SPACE.         02830000
028400     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP2: '.  02840000
028500     05  EL7-EIBRESP2            PIC  9(08)+ VALUE ZERO.          02850000
028600     05  FILLER                  PIC  X(20)  VALUE SPACE.         02860000
028700 01  EL8-EIB-LINE-8.                                              02870000
028800     05  FILLER                  PIC  X(02)  VALUE SPACE.         02880000
028900     05  FILLER                  PIC  X(10)  VALUE 'EIBDS...: '.  02890000
029000     05  EL8-EIBDS               PIC  X(08)  VALUE SPACE.         02900000
029100     05  FILLER                  PIC  X(20)  VALUE SPACE.         02910000
029200     05  FILLER                  PIC  X(10)  VALUE 'EIBREQID: '.  02920000
029300     05  EL8-EIBREQID-HEX        PIC  X(08)  VALUE SPACE.         02930000
029400     05  FILLER                  PIC  X(21)  VALUE SPACE.         02940000
029500 01  EL9-EIB-LINE-9.                                              02950000
029600     05  FILLER                  PIC  X(02)  VALUE SPACE.         02960000
029700     05  FILLER                  PIC  X(12)  VALUE                02970000
029800                                             'EIBRSRCE: X'''.     02980000
029900     05  EL9-EIBRSRCE-HEX        PIC  X(16)  VALUE SPACE.         02990000
030000     05  FILLER                  PIC  X(01)  VALUE ''''.          03000000
030100     05  FILLER                  PIC  X(09)  VALUE SPACE.         03010000
030200     05  FILLER                  PIC  X(12)  VALUE                03020000
030300                                             'EIBEOC..: X'''.     03030000
030400     05  EL9-EIBEOC-HEX          PIC  X(02)  VALUE SPACE.         03040000
030500     05  FILLER                  PIC  X(01)  VALUE ''''.          03050000
030600     05  FILLER                  PIC  X(24)  VALUE SPACE.         03060000
030700 01  EL10-EIB-LINE-10.                                            03070000
030800     05  FILLER                  PIC  X(02)  VALUE SPACE.         03080000
030900     05  FILLER                  PIC  X(12)  VALUE                03090000
031000                                             'EIBFREE.: X'''.     03100000
031100     05  EL10-EIBFREE-HEX        PIC  X(02)  VALUE SPACE.         03110000
031200     05  FILLER                  PIC  X(01)  VALUE ''''.          03120000
031300     05  FILLER                  PIC  X(23)  VALUE SPACE.         03130000
031400     05  FILLER                  PIC  X(12)  VALUE                03140000
031500                                             'EIBRECV.: X'''.     03150000
031600     05  EL10-EIBRECV-HEX        PIC  X(02)  VALUE SPACE.         03160000
031700     05  FILLER                  PIC  X(01)  VALUE ''''.          03170000
031800     05  FILLER                  PIC  X(24)  VALUE SPACE.         03180000
031900 01  EL11-EIB-LINE-11.                                            03190000
032000     05  FILLER                  PIC  X(02)  VALUE SPACE.         03200000
032100     05  FILLER                  PIC  X(12)  VALUE                03210000
032200                                             'EIBATT..: X'''.     03220000
032300     05  EL11-EIBATT-HEX         PIC  X(02)  VALUE SPACE.         03230000
032400     05  FILLER                  PIC  X(01)  VALUE ''''.          03240000
032500     05  FILLER                  PIC  X(23)  VALUE SPACE.         03250000
032600     05  FILLER                  PIC  X(12)  VALUE                03260000
032700                                             'EIBSYNC.: X'''.     03270000
032800     05  EL11-EIBSYNC-HEX        PIC  X(02)  VALUE SPACE.         03280000
032900     05  FILLER                  PIC  X(01)  VALUE ''''.          03290000
033000     05  FILLER                  PIC  X(24)  VALUE SPACE.         03300000
033100 01  EL12-EIB-LINE-12.                                            03310000
033200     05  FILLER                  PIC  X(02)  VALUE SPACE.         03320000
033300     05  FILLER                  PIC  X(12)  VALUE                03330000
033400                                             'EIBFMH..: X'''.     03340000
033500     05  EL12-EIBFMH-HEX         PIC  X(02)  VALUE SPACE.         03350000
033600     05  FILLER                  PIC  X(01)  VALUE ''''.          03360000
033700     05  FILLER                  PIC  X(23)  VALUE SPACE.         03370000
033800     05  FILLER                  PIC  X(12)  VALUE                03380000
033900                                             'EIBCOMPL: X'''.     03390000
034000     05  EL12-EIBCOMPL-HEX       PIC  X(02)  VALUE SPACE.         03400000
034100     05  FILLER                  PIC  X(01)  VALUE ''''.          03410000
034200     05  FILLER                  PIC  X(24)  VALUE SPACE.         03420000
034300 01  EL13-EIB-LINE-13.                                            03430000
034400     05  FILLER                  PIC  X(02)  VALUE SPACE.         03440000
034500     05  FILLER                  PIC  X(12)  VALUE                03450000
034600                                             'EIBSIG..: X'''.     03460000
034700     05  EL13-EIBSIG-HEX         PIC  X(02)  VALUE SPACE.         03470000
034800     05  FILLER                  PIC  X(01)  VALUE ''''.          03480000
034900     05  FILLER                  PIC  X(23)  VALUE SPACE.         03490000
035000     05  FILLER                  PIC  X(12)  VALUE                03500000
035100                                             'EIBCONF.: X'''.     03510000
035200     05  EL13-EIBCONF-HEX        PIC  X(02)  VALUE SPACE.         03520000
035300     05  FILLER                  PIC  X(01)  VALUE ''''.          03530000
035400     05  FILLER                  PIC  X(24)  VALUE SPACE.         03540000
035500 01  EL14-EIB-LINE-14.                                            03550000
035600     05  FILLER                  PIC  X(02)  VALUE SPACE.         03560000
035700     05  FILLER                  PIC  X(12)  VALUE                03570000
035800                                             'EIBERR..: X'''.     03580000
035900     05  EL14-EIBERR-HEX         PIC  X(02)  VALUE SPACE.         03590000
036000     05  FILLER                  PIC  X(01)  VALUE ''''.          03600000
036100     05  FILLER                  PIC  X(23)  VALUE SPACE.         03610000
036200     05  FILLER                  PIC  X(12)  VALUE                03620000
036300                                             'EIBERRCD: X'''.     03630000
036400     05  EL14-EIBERRCD-HEX       PIC  X(08)  VALUE SPACE.         03640000
036500     05  FILLER                  PIC  X(01)  VALUE ''''.          03650000
036600     05  FILLER                  PIC  X(18)  VALUE SPACE.         03660000
036700 01  EL15-EIB-LINE-15.                                            03670000
036800     05  FILLER                  PIC  X(02)  VALUE SPACE.         03680000
036900     05  FILLER                  PIC  X(12)  VALUE                03690000
037000                                             'EIBSYNRB: X'''.     03700000
037100     05  EL15-EIBSYNRB-HEX       PIC  X(02)  VALUE SPACE.         03710000
037200     05  FILLER                  PIC  X(01)  VALUE ''''.          03720000
037300     05  FILLER                  PIC  X(23)  VALUE SPACE.         03730000
037400     05  FILLER                  PIC  X(12)  VALUE                03740000
037500                                             'EIBNODAT: X'''.     03750000
037600     05  EL15-EIBNODAT-HEX       PIC  X(02)  VALUE SPACE.         03760000
037700     05  FILLER                  PIC  X(01)  VALUE ''''.          03770000
037800     05  FILLER                  PIC  X(24)  VALUE SPACE.         03780000
037900*                                                                 03790000
038000*                                                                 03800000
038100**   FOLLOWING IS THE LAYOUT FOR THE EXEC INTERFACE BLOCK         03810000
038200**   USED IN PROCESSING A THE EIB AREA PASSED BY THE CALLING      03820000
038300**   PROGRAM.                                                     03830000
038400*                                                                 03840000
038500 01  EIBM-EIBLK-MASK.                                             03850000
038600     05  EIBM-TIME         PIC S9(07)  VALUE ZERO                 03860000
038700                                       COMP-3.                    03870000
038800     05  EIBM-DATE         PIC S9(07)  VALUE ZERO                 03880000
038900                                       COMP-3.                    03890000
039000     05  EIBM-TRNID        PIC  X(04)  VALUE SPACE.               03900000
039100     05  EIBM-TASKN        PIC S9(07)  VALUE ZERO                 03910000
039200                                       COMP-3.                    03920000
039300     05  EIBM-TRMID        PIC  X(04)  VALUE SPACE.               03930000
039400     05  FILLER            PIC S9(04)  VALUE ZERO                 03940000
039500                                       COMP.                      03950000
039600     05  EIBM-CPOSN        PIC S9(04)  VALUE ZERO                 03960000
039700                                       COMP.                      03970000
039800     05  EIBM-CALEN        PIC S9(04)  VALUE ZERO                 03980000
039900                                       COMP.                      03990000
040000     05  EIBM-AID          PIC  X(01)  VALUE SPACE.               04000000
040100     05  EIBM-FN           PIC  X(02)  VALUE SPACE.               04010000
040200     05  EIBM-RCODE        PIC  X(06)  VALUE SPACE.               04020000
040300     05  EIBM-DS           PIC  X(08)  VALUE SPACE.               04030000
040400     05  EIBM-REQID        PIC  X(08)  VALUE SPACE.               04040000
040500     05  EIBM-RSRCE        PIC  X(08)  VALUE SPACE.               04050000
040600     05  EIBM-SYNC         PIC  X(01)  VALUE SPACE.               04060000
040700     05  EIBM-FREE         PIC  X(01)  VALUE SPACE.               04070000
040800     05  EIBM-RECV         PIC  X(01)  VALUE SPACE.               04080000
040900     05  EIBM-SEND         PIC  X(01)  VALUE SPACE.               04090000
041000     05  EIBM-ATT          PIC  X(01)  VALUE SPACE.               04100000
041100     05  EIBM-EOC          PIC  X(01)  VALUE SPACE.               04110000
041200     05  EIBM-FMH          PIC  X(01)  VALUE SPACE.               04120000
041300     05  EIBM-COMPL        PIC  X(01)  VALUE SPACE.               04130000
041400     05  EIBM-SIG          PIC  X(01)  VALUE SPACE.               04140000
041500     05  EIBM-CONF         PIC  X(01)  VALUE SPACE.               04150000
041600     05  EIBM-ERR          PIC  X(01)  VALUE SPACE.               04160000
041700     05  EIBM-ERRCD        PIC  X(04)  VALUE SPACE.               04170000
041800     05  EIBM-SYNRB        PIC  X(01)  VALUE SPACE.               04180000
041900     05  EIBM-NODAT        PIC  X(01)  VALUE SPACE.               04190000
042000     05  EIBM-RESP         PIC S9(08)  VALUE ZERO                 04200000
042100                                       COMP.                      04210000
042200     05  EIBM-RESP2        PIC S9(08)  VALUE ZERO                 04220000
042300                                       COMP.                      04230000
042400     05  EIBM-RLDBK        PIC  X(01)  VALUE SPACE.               04240000
042500*                                                                 04250000
042600 01  AC-AID-CONVERSION-TABLE.                                     04260000
042700     05  AC-ATTENTION-ID-ENTRIES.                                 04270000
042800         10  FILLER              PIC  X(06)  VALUE ' NULL '.      04280000
042900         10  FILLER              PIC  X(06)  VALUE '''ENTER'.     04290000
043000         10  FILLER              PIC  X(06)  VALUE '_CLEAR'.      04300000
043100         10  FILLER              PIC  X(06)  VALUE 'ºCLRP '.      04310000
043200         10  FILLER              PIC  X(06)  VALUE '=PEN  '.      04320000
043300         10  FILLER              PIC  X(06)  VALUE 'WOPID '.      04330000
043400         10  FILLER              PIC  X(06)  VALUE 'XMSRE '.      04340000
043500         10  FILLER              PIC  X(06)  VALUE 'HSTRF '.      04350000
043600         10  FILLER              PIC  X(06)  VALUE '"TRIG '.      04360000
043700         10  FILLER              PIC  X(06)  VALUE '%PA1  '.      04370000
043800         10  FILLER              PIC  X(06)  VALUE '>PA2  '.      04380000
043900         10  FILLER              PIC  X(06)  VALUE ',PA3  '.      04390000
044000         10  FILLER              PIC  X(06)  VALUE '1PF1  '.      04400000
044100         10  FILLER              PIC  X(06)  VALUE '2PF2  '.      04410000
044200         10  FILLER              PIC  X(06)  VALUE '3PF3  '.      04420000
044300         10  FILLER              PIC  X(06)  VALUE '4PF4  '.      04430000
044400         10  FILLER              PIC  X(06)  VALUE '5PF5  '.      04440000
044500         10  FILLER              PIC  X(06)  VALUE '6PF6  '.      04450000
044600         10  FILLER              PIC  X(06)  VALUE '7PF7  '.      04460000
044700         10  FILLER              PIC  X(06)  VALUE '8PF8  '.      04470000
044800         10  FILLER              PIC  X(06)  VALUE '9PF9  '.      04480000
044900         10  FILLER              PIC  X(06)  VALUE ':PF10 '.      04490000
045000         10  FILLER              PIC  X(06)  VALUE '#PF11 '.      04500000
045100         10  FILLER              PIC  X(06)  VALUE '@PF12 '.      04510000
045200         10  FILLER              PIC  X(06)  VALUE 'APF13 '.      04520000
045300         10  FILLER              PIC  X(06)  VALUE 'BPF14 '.      04530000
045400         10  FILLER              PIC  X(06)  VALUE 'CPF15 '.      04540000
045500         10  FILLER              PIC  X(06)  VALUE 'DPF16 '.      04550000
045600         10  FILLER              PIC  X(06)  VALUE 'EPF17 '.      04560000
045700         10  FILLER              PIC  X(06)  VALUE 'FPF18 '.      04570000
045800         10  FILLER              PIC  X(06)  VALUE 'GPF19 '.      04580000
045900         10  FILLER              PIC  X(06)  VALUE 'HPF20 '.      04590000
046000         10  FILLER              PIC  X(06)  VALUE 'IPF21 '.      04600000
046100         10  FILLER              PIC  X(06)  VALUE '›PF22 '.      04610000
046200         10  FILLER              PIC  X(06)  VALUE '.PF23 '.      04620000
046300         10  FILLER              PIC  X(06)  VALUE '<PF24 '.      04630000
046400     05  AC-ATTENTION-ID-ENTRY   REDEFINES                        04640000
046500                                 AC-ATTENTION-ID-ENTRIES          04650000
046600                                 OCCURS 36 TIMES                  04660000
046700                                 INDEXED BY AC-AID-IDX.           04670000
046800         10  AC-EIBAID           PIC  X(01).                      04680000
046900         10  AC-AID-NAME         PIC  X(05).                      04690000
047000*                                                                 04700000
047100** EIBRESP DESCRIPTION TABLE                                      04710000
047200*                                                                 04720000
047300 01  EC-EIBRESP-CONVERSION-TABLE.                                 04730000
047400     05  EC-EIBRESP-ENTRIES.                                      04740000
047500         10  FILLER              PIC S9(08)  VALUE +00            04750000
047600                                             COMP.                04760000
047700         10  FILLER              PIC  X(12)  VALUE 'NORMAL'.      04770000
047800         10  FILLER              PIC S9(08)  VALUE +01            04780000
047900                                             COMP.                04790000
048000         10  FILLER              PIC  X(12)  VALUE 'ERROR'.       04800000
048100         10  FILLER              PIC S9(08)  VALUE +02            04810000
048200                                             COMP.                04820000
048300         10  FILLER              PIC  X(12)  VALUE 'RDATT'.       04830000
048400         10  FILLER              PIC S9(08)  VALUE +03            04840000
048500                                             COMP.                04850000
048600         10  FILLER              PIC  X(12)  VALUE 'WRBRK'.       04860000
048700         10  FILLER              PIC S9(08)  VALUE +04            04870000
048800                                             COMP.                04880000
048900         10  FILLER              PIC  X(12)  VALUE 'EOF'.         04890000
049000         10  FILLER              PIC S9(08)  VALUE +05            04900000
049100                                             COMP.                04910000
049200         10  FILLER              PIC  X(12)  VALUE 'EODS'.        04920000
049300         10  FILLER              PIC S9(08)  VALUE +06            04930000
049400                                             COMP.                04940000
049500         10  FILLER              PIC  X(12)  VALUE 'EOC'.         04950000
049600         10  FILLER              PIC S9(08)  VALUE +07            04960000
049700                                             COMP.                04970000
049800         10  FILLER              PIC  X(12)  VALUE 'INBFMH'.      04980000
049900         10  FILLER              PIC S9(08)  VALUE +08            04990000
050000                                             COMP.                05000000
050100         10  FILLER              PIC  X(12)  VALUE 'ENDINPT'.     05010000
050200         10  FILLER              PIC S9(08)  VALUE +09            05020000
050300                                             COMP.                05030000
050400         10  FILLER              PIC  X(12)  VALUE 'NONVAL'.      05040000
050500         10  FILLER              PIC S9(08)  VALUE +10            05050000
050600                                             COMP.                05060000
050700         10  FILLER              PIC  X(12)  VALUE 'NOSTART'.     05070000
050800         10  FILLER              PIC S9(08)  VALUE +11            05080000
050900                                             COMP.                05090000
051000         10  FILLER              PIC  X(12)  VALUE 'TERMIDERR'.   05100000
051100         10  FILLER              PIC S9(08)  VALUE +12            05110000
051200                                             COMP.                05120000
051300         10  FILLER              PIC  X(12)  VALUE 'DSIDERR'.     05130000
051400         10  FILLER              PIC S9(08)  VALUE +13            05140000
051500                                             COMP.                05150000
051600         10  FILLER              PIC  X(12)  VALUE 'NOTFND'.      05160000
051700         10  FILLER              PIC S9(08)  VALUE +14            05170000
051800                                             COMP.                05180000
051900         10  FILLER              PIC  X(12)  VALUE 'DUPREC'.      05190000
052000         10  FILLER              PIC S9(08)  VALUE +15            05200000
052100                                             COMP.                05210000
052200         10  FILLER              PIC  X(12)  VALUE 'DUPKEY'.      05220000
052300         10  FILLER              PIC S9(08)  VALUE +16            05230000
052400                                             COMP.                05240000
052500         10  FILLER              PIC  X(12)  VALUE 'INVREQ'.      05250000
052600         10  FILLER              PIC S9(08)  VALUE +17            05260000
052700                                             COMP.                05270000
052800         10  FILLER              PIC  X(12)  VALUE 'IOERR'.       05280000
052900         10  FILLER              PIC S9(08)  VALUE +18            05290000
053000                                             COMP.                05300000
053100         10  FILLER              PIC  X(12)  VALUE 'NOSPACE'.     05310000
053200         10  FILLER              PIC S9(08)  VALUE +19            05320000
053300                                             COMP.                05330000
053400         10  FILLER              PIC  X(12)  VALUE 'NOTOPEN'.     05340000
053500         10  FILLER              PIC S9(08)  VALUE +20            05350000
053600                                             COMP.                05360000
053700         10  FILLER              PIC  X(12)  VALUE 'ENDFILE'.     05370000
053800         10  FILLER              PIC S9(08)  VALUE +21            05380000
053900                                             COMP.                05390000
054000         10  FILLER              PIC  X(12)  VALUE 'ILLOGIC'.     05400000
054100         10  FILLER              PIC S9(08)  VALUE +22            05410000
054200                                             COMP.                05420000
054300         10  FILLER              PIC  X(12)  VALUE 'LENGERR'.     05430000
054400         10  FILLER              PIC S9(08)  VALUE +23            05440000
054500                                             COMP.                05450000
054600         10  FILLER              PIC  X(12)  VALUE 'QZERO'.       05460000
054700         10  FILLER              PIC S9(08)  VALUE +24            05470000
054800                                             COMP.                05480000
054900         10  FILLER              PIC  X(12)  VALUE 'SIGNAL'.      05490000
055000         10  FILLER              PIC S9(08)  VALUE +25            05500000
055100                                             COMP.                05510000
055200         10  FILLER              PIC  X(12)  VALUE 'QBUSY'.       05520000
055300         10  FILLER              PIC S9(08)  VALUE +26            05530000
055400                                             COMP.                05540000
055500         10  FILLER              PIC  X(12)  VALUE 'ITEMERR'.     05550000
055600         10  FILLER              PIC S9(08)  VALUE +27            05560000
055700                                             COMP.                05570000
055800         10  FILLER              PIC  X(12)  VALUE 'PGMIDERR'.    05580000
055900         10  FILLER              PIC S9(08)  VALUE +28            05590000
056000                                             COMP.                05600000
056100         10  FILLER              PIC  X(12)  VALUE 'TRANSIDERR'.  05610000
056200         10  FILLER              PIC S9(08)  VALUE +29            05620000
056300                                             COMP.                05630000
056400         10  FILLER              PIC  X(12)  VALUE 'ENDDATA'.     05640000
056500         10  FILLER              PIC S9(08)  VALUE +30            05650000
056600                                             COMP.                05660000
056700         10  FILLER              PIC  X(12)  VALUE 'INVTSREQ'.    05670000
056800         10  FILLER              PIC S9(08)  VALUE +31            05680000
056900                                             COMP.                05690000
057000         10  FILLER              PIC  X(12)  VALUE 'EXPIRED'.     05700000
057100         10  FILLER              PIC S9(08)  VALUE +32            05710000
057200                                             COMP.                05720000
057300         10  FILLER              PIC  X(12)  VALUE 'RETPAGE'.     05730000
057400         10  FILLER              PIC S9(08)  VALUE +33            05740000
057500                                             COMP.                05750000
057600         10  FILLER              PIC  X(12)  VALUE 'RTEFAIL'.     05760000
057700         10  FILLER              PIC S9(08)  VALUE +34            05770000
057800                                             COMP.                05780000
057900         10  FILLER              PIC  X(12)  VALUE 'RTESOME'.     05790000
058000         10  FILLER              PIC S9(08)  VALUE +35            05800000
058100                                             COMP.                05810000
058200         10  FILLER              PIC  X(12)  VALUE 'TSIOERR'.     05820000
058300         10  FILLER              PIC S9(08)  VALUE +36            05830000
058400                                             COMP.                05840000
058500         10  FILLER              PIC  X(12)  VALUE 'MAPFAIL'.     05850000
058600         10  FILLER              PIC S9(08)  VALUE +37            05860000
058700                                             COMP.                05870000
058800         10  FILLER              PIC  X(12)  VALUE 'INVERRTERM'.  05880000
058900         10  FILLER              PIC S9(08)  VALUE +38            05890000
059000                                             COMP.                05900000
059100         10  FILLER              PIC  X(12)  VALUE 'INVMPSZ'.     05910000
059200         10  FILLER              PIC S9(08)  VALUE +39            05920000
059300                                             COMP.                05930000
059400         10  FILLER              PIC  X(12)  VALUE 'IGREQID'.     05940000
059500         10  FILLER              PIC S9(08)  VALUE +40            05950000
059600                                             COMP.                05960000
059700         10  FILLER              PIC  X(12)  VALUE 'OVERFLOW'.    05970000
059800         10  FILLER              PIC S9(08)  VALUE +41            05980000
059900                                             COMP.                05990000
060000         10  FILLER              PIC  X(12)  VALUE 'INVLDC'.      06000000
060100         10  FILLER              PIC S9(08)  VALUE +42            06010000
060200                                             COMP.                06020000
060300         10  FILLER              PIC  X(12)  VALUE 'NOSTG'.       06030000
060400         10  FILLER              PIC S9(08)  VALUE +43            06040000
060500                                             COMP.                06050000
060600         10  FILLER              PIC  X(12)  VALUE 'JIDERR'.      06060000
060700         10  FILLER              PIC S9(08)  VALUE +44            06070000
060800                                             COMP.                06080000
060900         10  FILLER              PIC  X(12)  VALUE 'QIDERR'.      06090000
061000         10  FILLER              PIC S9(08)  VALUE +45            06100000
061100                                             COMP.                06110000
061200         10  FILLER              PIC  X(12)  VALUE 'NOJBUFSP'.    06120000
061300         10  FILLER              PIC S9(08)  VALUE +46            06130000
061400                                             COMP.                06140000
061500         10  FILLER              PIC  X(12)  VALUE 'DSSTAT'.      06150000
061600         10  FILLER              PIC S9(08)  VALUE +47            06160000
061700                                             COMP.                06170000
061800         10  FILLER              PIC  X(12)  VALUE 'SELNERR'.     06180000
061900         10  FILLER              PIC S9(08)  VALUE +48            06190000
062000                                             COMP.                06200000
062100         10  FILLER              PIC  X(12)  VALUE 'FUNCERR'.     06210000
062200         10  FILLER              PIC S9(08)  VALUE +49            06220000
062300                                             COMP.                06230000
062400         10  FILLER              PIC  X(12)  VALUE 'UNEXPIN'.     06240000
062500         10  FILLER              PIC S9(08)  VALUE +50            06250000
062600                                             COMP.                06260000
062700         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKRD'.  06270000
062800         10  FILLER              PIC S9(08)  VALUE +51            06280000
062900                                             COMP.                06290000
063000         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKWR'.  06300000
063100         10  FILLER              PIC S9(08)  VALUE +53            06310000
063200                                             COMP.                06320000
063300         10  FILLER              PIC  X(12)  VALUE 'SYSIDERR'.    06330000
063400         10  FILLER              PIC S9(08)  VALUE +54            06340000
063500                                             COMP.                06350000
063600         10  FILLER              PIC  X(12)  VALUE 'ISCINVREQ'.   06360000
063700         10  FILLER              PIC S9(08)  VALUE +55            06370000
063800                                             COMP.                06380000
063900         10  FILLER              PIC  X(12)  VALUE 'ENQBUSY'.     06390000
064000         10  FILLER              PIC S9(08)  VALUE +56            06400000
064100                                             COMP.                06410000
064200         10  FILLER              PIC  X(12)  VALUE 'ENVDEFERR'.   06420000
064300         10  FILLER              PIC S9(08)  VALUE +57            06430000
064400                                             COMP.                06440000
064500         10  FILLER              PIC  X(12)  VALUE 'IGREQCD'.     06450000
064600         10  FILLER              PIC S9(08)  VALUE +58            06460000
064700                                             COMP.                06470000
064800         10  FILLER              PIC  X(12)  VALUE 'SESSIONERR'.  06480000
064900         10  FILLER              PIC S9(08)  VALUE +59            06490000
065000                                             COMP.                06500000
065100         10  FILLER              PIC  X(12)  VALUE 'SYSBUSY'.     06510000
065200         10  FILLER              PIC S9(08)  VALUE +60            06520000
065300                                             COMP.                06530000
065400         10  FILLER              PIC  X(12)  VALUE 'SESSBUSY'.    06540000
065500         10  FILLER              PIC S9(08)  VALUE +61            06550000
065600                                             COMP.                06560000
065700         10  FILLER              PIC  X(12)  VALUE 'NOTALLOC'.    06570000
065800         10  FILLER              PIC S9(08)  VALUE +62            06580000
065900                                             COMP.                06590000
066000         10  FILLER              PIC  X(12)  VALUE 'CBIDERR'.     06600000
066100         10  FILLER              PIC S9(08)  VALUE +64            06610000
066200                                             COMP.                06620000
066300         10  FILLER              PIC  X(12)  VALUE 'INVPARTNSET '.06630000
066400         10  FILLER              PIC S9(08)  VALUE +65            06640000
066500                                             COMP.                06650000
066600         10  FILLER              PIC  X(12)  VALUE 'INVPARTN    '.06660000
066700         10  FILLER              PIC S9(08)  VALUE +66            06670000
066800                                             COMP.                06680000
066900         10  FILLER              PIC  X(12)  VALUE 'PARTNFAIL   '.06690000
067000         10  FILLER              PIC S9(08)  VALUE +70            06700000
067100                                             COMP.                06710000
067200         10  FILLER              PIC  X(12)  VALUE 'NOTAUTH'.     06720000
067300         10  FILLER              PIC S9(08)  VALUE +80            06730000
067400                                             COMP.                06740000
067500         10  FILLER              PIC  X(12)  VALUE 'NOSPOOL'.     06750000
067600         10  FILLER              PIC S9(08)  VALUE +81            06760000
067700                                             COMP.                06770000
067800         10  FILLER              PIC  X(12)  VALUE 'TERMERR'.     06780000
067900         10  FILLER              PIC S9(08)  VALUE +82            06790000
068000                                             COMP.                06800000
068100         10  FILLER              PIC  X(12)  VALUE 'ROLLEDBACK  '.06810000
068200         10  FILLER              PIC S9(08)  VALUE +83            06820000
068300                                             COMP.                06830000
068400         10  FILLER              PIC  X(12)  VALUE 'END'.         06840000
068500         10  FILLER              PIC S9(08)  VALUE +84            06850000
068600                                             COMP.                06860000
068700         10  FILLER              PIC  X(12)  VALUE 'DISABLED    '.06870000
068800         10  FILLER              PIC S9(08)  VALUE +85            06880000
068900                                             COMP.                06890000
069000         10  FILLER              PIC  X(12)  VALUE 'ALLOCERR    '.06900000
069100         10  FILLER              PIC S9(08)  VALUE +86            06910000
069200                                             COMP.                06920000
069300         10  FILLER              PIC  X(12)  VALUE 'STRELERR    '.06930000
069400         10  FILLER              PIC S9(08)  VALUE +87            06940000
069500                                             COMP.                06950000
069600         10  FILLER              PIC  X(12)  VALUE 'OPENERR'.     06960000
069700         10  FILLER              PIC S9(08)  VALUE +88            06970000
069800                                             COMP.                06980000
069900         10  FILLER              PIC  X(12)  VALUE 'SPOLBUSY    '.06990000
070000         10  FILLER              PIC S9(08)  VALUE +89            07000000
070100                                             COMP.                07010000
070200         10  FILLER              PIC  X(12)  VALUE 'SPOLERR'.     07020000
070300         10  FILLER              PIC S9(08)  VALUE +90            07030000
070400                                             COMP.                07040000
070500         10  FILLER              PIC  X(12)  VALUE 'NODEIDER    '.07050000
070600     05  EC-EIBRESP-ENTRY        REDEFINES EC-EIBRESP-ENTRIES     07060000
070700                                 OCCURS 77 TIMES                  07070000
070800                                 ASCENDING KEY EC-EIBRESP         07080000
070900                                 INDEXED BY EC-RESP-IDX.          07090000
071000         10  EC-EIBRESP          PIC S9(08)  COMP.                07100000
071100         10  EC-CONDITION-NAME   PIC  X(12).                      07110000
071200*                                                                 07120000
071300*                                                                 07130000
071400*DB2 AREA FOR USER TABLE                                          07140000
071500     EXEC SQL                                                     07150000
071600          INCLUDE TCOCNTL                                         07160000
071700     END-EXEC.                                                    07170000
071800                                                                  07180000
071900* COMMUNICATIONS AREA FOR DB2                                     07190000
072000     EXEC SQL                                                     07200000
072100         INCLUDE SQLCA                                            07210000
072200     END-EXEC.                                                    07220000
072300*                                                                 07230000
072400******************************************************************07240000
072500 LINKAGE SECTION.                                                 07250000
072600******************************************************************07260000
072700 01  DFHCOMMAREA.                                                 07270000
072800     05  FILLER                         OCCURS  1 TO 4072 TIMES   07280000
072900                                        DEPENDING ON EIBCALEN.    07290000
073000         10  FILLER                     PIC X.                    07300000
073100                                                                  07310000
073200******************************************************************07320000
073300 PROCEDURE DIVISION.                                              07330000
073400******************************************************************07340000
073500 0000-PROGRAM-MAINLINE.                                           07350000
073600     MOVE DFHCOMMAREA                TO DL010-COMMAREA            07360000
073700     MOVE LOW-VALUES                 TO DL456AI.                  07370000
073800     MOVE DL014-PRESS-ENTER-MSG      TO AMSG8O                    07380000
073900                                                                  07390000
074000     EVALUATE TRUE                                                07400000
074100         WHEN DL010-XCTL                                          07410000
074200            IF DL010-PGM-MSG-NBR = 8                              07420000
074300               MOVE DL010-MENU-PROGRAM TO DL010-LAST-PROGRAM      07430000
074400               PERFORM 2100-XCTL-TO-SELECTED-PROGRAM              07440000
074500            ELSE                                                  07450000
074600               PERFORM 2200-XCTL-TO-MAIN-MENU                     07460000
074700            END-IF                                                07470000
074800         WHEN DL010-ABEND                                         07480000
074900             PERFORM 3000-ABEND-SCREEN                            07490000
075000             PERFORM 3500-LOG-ABEND-INFO                          07500000
075100             SET DL012-UNRECOVERABLE-DB-ERROR                     07510000
075200                                      TO TRUE                     07520000
075300             MOVE DL010-TRAN-ID       TO DL012-ERROR-TRANID       07530000
075400             MOVE DL010-ERROR-NBR     TO DL012-ERROR-NBR          07540000
075500             PERFORM 1000-SETUP-SCREEN                            07550000
075600                                                                  07560000
075700             PERFORM 8400-ROLLBACK                                07570000
075800             SET DL010-XCTL           TO TRUE                     07580000
075900             PERFORM 8000-SEND-MAP                                07590000
076000             PERFORM 8200-RETURN-TRANID                           07600000
076100                                                                  07610000
076200         WHEN EIBCALEN = ZERO                                     07620000
076300         WHEN EIBAID = DFHCLEAR                                   07630000
076400         WHEN DL010-INITIALIZE-SCREEN                             07640000
076500         WHEN DL010-WAIT-FOR-CONFIRM                              07650000
076600             SET DL010-PROCESS-SCREEN  TO  TRUE                   07660000
076700             PERFORM 1000-SETUP-SCREEN                            07670000
076800                                                                  07680000
076900             PERFORM 8000-SEND-MAP                                07690000
077000             PERFORM 8200-RETURN-TRANID                           07700000
077100                                                                  07710000
077200         WHEN EIBTRNID = 'Z278'                                   07720000
077300*        GENERIC HELP SCREEN                                      07730000
077400             MOVE DFHCOMMAREA          TO PC192-COMMAREA          07740000
077500             MOVE PC192-HOST-SAVE-AREA TO DL010-COMMAREA          07750000
077600             MOVE PC192-HOST-SAVE-MAP  TO DL456AO                 07760000
077700             SET DL010-PROCESS-SCREEN  TO  TRUE                   07770000
077800             PERFORM 8000-SEND-MAP                                07780000
077900             PERFORM 8200-RETURN-TRANID                           07790000
078000                                                                  07800000
078100         WHEN EIBAID = DFHPF2                                     07810000
078200             SET DL010-UPDATE-CONFIRMED  TO TRUE                  07820000
078300             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                07830000
078400                                                                  07840000
078500         WHEN EIBAID = DFHPF3                                     07850000
078600             SET DL010-INITIALIZE-SCREEN                          07860000
078700                                        TO TRUE                   07870000
078800             PERFORM 2400-XCTL-TO-ROOT-SCREEN                     07880000
078900                                                                  07890000
079000         WHEN EIBAID = DFHENTER                                   07900000
079100             SET DL010-UPDATE-CONFIRMED                           07910000
079200                                      TO  TRUE                    07920000
079300             SET DL010-INITIALIZE-SCREEN                          07930000
079400                                      TO TRUE                     07940000
079500             EVALUATE DL010-PGM-MSG-NBR                           07950000
079600                 WHEN 1                                           07960000
079700                 WHEN 2                                           07970000
079800                 WHEN 3                                           07980000
079900                 WHEN 4                                           07990000
080000                 WHEN 5                                           08000000
080100                     PERFORM 2500-XCTL-TO-MENU-SCREEN             08010000
080200                 WHEN 6                                           08020000
080300                     PERFORM 2200-XCTL-TO-MAIN-MENU               08030000
080400                 WHEN 8                                           08040000
080500                     MOVE 'DLKRF454'  TO DL010-LAST-PROGRAM       08050000
080600                     PERFORM 2100-XCTL-TO-SELECTED-PROGRAM        08060000
080700                 WHEN OTHER                                       08070000
080800                     PERFORM 2100-XCTL-TO-SELECTED-PROGRAM        08080000
080900             END-EVALUATE                                         08090000
081000                                                                  08100000
081100                                                                  08110000
081200         WHEN EIBAID = DFHPF1                                     08120000
081300             MOVE DL010-PGM-MSG-NBR   TO PV-TEXT-MSG-NBR          08130000
081400             MOVE DL010-LAST-PROGRAM  TO PV-TEXT-LAST-PGM         08140000
081500             MOVE DL010-ROOT-PROGRAM  TO PV-TEXT-ROOT-PGM         08150000
081600             MOVE DL010-MENU-PROGRAM  TO PV-TEXT-MENU-PGM         08160000
081700             MOVE DL010-NEXT-PROGRAM  TO PV-NEXT-MENU-PGM         08170000
081800             MOVE PC-NEW-LINE         TO PV-NEW-LINE-1            08180000
081900                                         PV-NEW-LINE-2            08190000
082000                                         PV-NEW-LINE-3            08200000
082100                                         PV-NEW-LINE-4            08210000
082200                                         PV-NEW-LINE-5            08220000
082300                                         PV-NEW-LINE-6            08230000
082400                                         PV-NEW-LINE-7            08240000
082500             PERFORM 8030-SEND-TEXT                               08250000
082600             PERFORM 8200-RETURN-TRANID                           08260000
082700                                                                  08270000
082800         WHEN OTHER                                               08280000
082900              PERFORM 8020-RECEIVE-MAP                            08290000
083000             MOVE DL014-UNRECOGNIZED-PF-KEY-MSG                   08300000
083100                                      TO AMSG8O                   08310000
083200     END-EVALUATE.                                                08320000
083300                                                                  08330000
083400     PERFORM 8100-SEND-DATA-ONLY.                                 08340000
083500     PERFORM 8200-RETURN-TRANID.                                  08350000
083600                                                                  08360000
083700     GOBACK.                                                      08370000
083800****************************************************************  08380000
083900* 1000-SETUP-SCREEN                                               08390000
084000*    INITIAL SETUP OF AUDIT NUMBER AND STATUS                     08400000
084100****************************************************************  08410000
084200 1000-SETUP-SCREEN.                                               08420000
084300                                                                  08430000
084400*    MOVE APPROPRIATE MESSAGE TO THE SCREEN                       08440000
084500     SET DL012-IDX                    TO DL010-PGM-MSG-NBR.       08450000
084600                                                                  08460000
084700                                                                  08470000
084800     EVALUATE DL010-PGM-MSG-NBR                                   08480000
084900         WHEN 1                                                   08490000
085000             MOVE DL010-TRAN-ID       TO DL012-ERROR-TRANID-1     08500000
085100             MOVE DL010-ERROR-NBR     TO DL012-ERROR-NBR-1        08510000
085200         WHEN 3                                                   08520000
085300             MOVE DL010-TRAN-ID       TO DL012-ERROR-TRANID       08530000
085400             MOVE DL010-ERROR-NBR     TO DL012-ERROR-NBR          08540000
085500         WHEN 4                                                   08550000
085600             MOVE DL010-KEYED-USERID  TO DL012-USERID-1           08560000
085700         WHEN 5                                                   08570000
085800             MOVE DL010-ORIG-CALLING-PGM-NM                       08580000
085900                                  TO DL012-ORIG-CALLING-PGM-NM    08590000
086000                                                                  08600000
086100             MOVE DL010-SQL-ERROR-PARA                            08610000
086200                                  TO DL012-SQL-ERROR-PARA         08620000
086300             MOVE DL010-CALL-MOD-FAIL-NM                          08630000
086400                                  TO DL012-CALL-MOD-FAIL-NM       08640000
086500             MOVE DL010-CALL-MOD-FAIL-ERR-CDE                     08650000
086600                                  TO DL012-CALL-MOD-FAIL-ERR-CDE  08660000
086700         WHEN 7                                                   08670000
086800             MOVE DL010-OLD-DOOR-ID   TO DL012-DOOR1              08680000
086900             MOVE DL010-DOOR-ID       TO DL012-DOOR2              08690000
087000     END-EVALUATE.                                                08700000
087100                                                                  08710000
087200                                                                  08720000
087300     MOVE DL012-LINE-1 (DL012-IDX)    TO AMSG1O.                  08730000
087400     MOVE DL012-LINE-2 (DL012-IDX)    TO AMSG2O.                  08740000
087500     MOVE DL012-LINE-3 (DL012-IDX)    TO AMSG3O.                  08750000
087600     MOVE DL012-LINE-4 (DL012-IDX)    TO AMSG4O.                  08760000
087700     MOVE DL012-LINE-5 (DL012-IDX)    TO AMSG5O.                  08770000
087800     MOVE DL012-LINE-6 (DL012-IDX)    TO AMSG6O.                  08780000
087900     MOVE DL012-LINE-7 (DL012-IDX)    TO AMSG7O.                  08790000
088000     MOVE DL012-LINE-8 (DL012-IDX)    TO AMSG8O.                  08800000
088100                                                                  08810000
089000 2100-XCTL-TO-SELECTED-PROGRAM.                                   08900000
089100                                                                  08910000
089200     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH.      08920000
089300                                                                  08930000
089400     EXEC CICS                                                    08940000
089500         XCTL                                                     08950000
089600             PROGRAM   (DL010-LAST-PROGRAM)                       08960000
089700             COMMAREA  (DL010-COMMAREA)                           08970000
089800             LENGTH    (PV-COMMAREA-LENGTH)                       08980000
089900             RESP      (PV-CICS-RESPONSE)                         08990000
090000     END-EXEC.                                                    09000000
090100                                                                  09010000
090200     EVALUATE TRUE                                                09020000
090300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09030000
090400              CONTINUE                                            09040000
090500         WHEN OTHER                                               09050000
090600              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                09060000
090700                                      TO DP013-PARAGRAPH          09070000
090800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09080000
090900                                      TO DP013-MESSAGE-TEXT (1)   09090000
091000              MOVE DL010-LAST-PROGRAM TO DP013-MESSAGE-TEXT (2)   09100000
091100              SET DP013-CICS-ABEND    TO TRUE                     09110000
091200              SET DP013-NO-ROLLBACK   TO TRUE                     09120000
091300              PERFORM 9999-WRITE-CICS-LOG-MSG                     09130000
091400              MOVE DL014-TRANS-NOT-AVAILABLE-MSG                  09140000
091500                                      TO AMSG8O                   09150000
091600              SET DL010-PROCESS-SCREEN TO TRUE                    09160000
091700              PERFORM 8100-SEND-DATA-ONLY                         09170000
091800              PERFORM 8200-RETURN-TRANID                          09180000
091900     END-EVALUATE.                                                09190000
092000                                                                  09200000
092100 2200-XCTL-TO-MAIN-MENU.                                          09210000
092200                                                                  09220000
092300     EXEC CICS                                                    09230000
092400         XCTL                                                     09240000
092500             PROGRAM   ('MPKCS027')                               09250000
092600             RESP      (PV-CICS-RESPONSE)                         09260000
092700     END-EXEC.                                                    09270000
092800                                                                  09280000
092900     EVALUATE TRUE                                                09290000
093000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09300000
093100              CONTINUE                                            09310000
093200         WHEN OTHER                                               09320000
093300              MOVE '2200-XCTL-TO-MAIN-MENU'                       09330000
093400                                      TO DP013-PARAGRAPH          09340000
093500              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09350000
093600                                      TO DP013-MESSAGE-TEXT (1)   09360000
093700              MOVE 'MPKCS027'         TO DP013-MESSAGE-TEXT (2)   09370000
093800              SET DP013-CICS-ABEND    TO TRUE                     09380000
093900              SET DP013-NO-ROLLBACK   TO TRUE                     09390000
094000              PERFORM 9999-WRITE-CICS-LOG-MSG                     09400000
094100              MOVE DL014-TRANS-NOT-AVAILABLE-MSG                  09410000
094200                                      TO AMSG8O                   09420000
094300              SET DL010-PROCESS-SCREEN TO TRUE                    09430000
094400              PERFORM 8100-SEND-DATA-ONLY                         09440000
094500              PERFORM 8200-RETURN-TRANID                          09450000
094600     END-EVALUATE.                                                09460000
094700                                                                  09470000
098000 2400-XCTL-TO-ROOT-SCREEN.                                        09800000
098100                                                                  09810000
098200     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH.      09820000
098300                                                                  09830000
098400     EXEC CICS                                                    09840000
098500         XCTL                                                     09850000
098600             PROGRAM   (DL010-ROOT-PROGRAM)                       09860000
098700             COMMAREA  (DL010-COMMAREA)                           09870000
098800             LENGTH    (PV-COMMAREA-LENGTH)                       09880000
098900             RESP      (PV-CICS-RESPONSE)                         09890000
099000     END-EXEC.                                                    09900000
099100                                                                  09910000
099200     EVALUATE TRUE                                                09920000
099300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09930000
099400              CONTINUE                                            09940000
099500         WHEN OTHER                                               09950000
099600              MOVE '2400-XCTL-TO-ROOT-SCREEN'                     09960000
099700                                      TO DP013-PARAGRAPH          09970000
099800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09980000
099900                                      TO DP013-MESSAGE-TEXT (1)   09990000
100000              MOVE DL010-ROOT-PROGRAM TO DP013-MESSAGE-TEXT (2)   10000000
100100              SET DP013-CICS-ABEND    TO TRUE                     10010000
100200              SET DP013-NO-ROLLBACK   TO TRUE                     10020000
100300              PERFORM 9999-WRITE-CICS-LOG-MSG                     10030000
100400              MOVE DL014-TRANS-NOT-AVAILABLE-MSG                  10040000
100500                                      TO AMSG8O                   10050000
100600              SET DL010-PROCESS-SCREEN TO TRUE                    10060000
100700              PERFORM 8100-SEND-DATA-ONLY                         10070000
100800              PERFORM 8200-RETURN-TRANID                          10080000
100900     END-EVALUATE.                                                10090000
101000                                                                  10100000
101100 2500-XCTL-TO-MENU-SCREEN.                                        10110000
101200                                                                  10120000
101300     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH.      10130000
101400     MOVE 'DLKRF456'                  TO DL010-LAST-PROGRAM       10140000
101500                                                                  10150000
101600     EXEC CICS                                                    10160000
101700         XCTL                                                     10170000
101800             PROGRAM   (DL010-MENU-PROGRAM)                       10180000
101900             COMMAREA  (DL010-COMMAREA)                           10190000
102000             LENGTH    (PV-COMMAREA-LENGTH)                       10200000
102100             RESP      (PV-CICS-RESPONSE)                         10210000
102200     END-EXEC.                                                    10220000
102300                                                                  10230000
102400     EVALUATE TRUE                                                10240000
102500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10250000
102600              CONTINUE                                            10260000
102700         WHEN OTHER                                               10270000
102800              MOVE '2500-XCTL-TO-MENU-SCREEN'                     10280000
102900                                      TO DP013-PARAGRAPH          10290000
103000              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       10300000
103100                                      TO DP013-MESSAGE-TEXT (1)   10310000
103200              MOVE DL010-MENU-PROGRAM TO DP013-MESSAGE-TEXT (2)   10320000
103300              SET DP013-CICS-ABEND    TO TRUE                     10330000
103400              SET DP013-NO-ROLLBACK   TO TRUE                     10340000
103500              PERFORM 9999-WRITE-CICS-LOG-MSG                     10350000
103600              MOVE DL014-TRANS-NOT-AVAILABLE-MSG                  10360000
103700                                      TO AMSG8O                   10370000
103800              SET DL010-PROCESS-SCREEN TO TRUE                    10380000
103900              PERFORM 8100-SEND-DATA-ONLY                         10390000
104000              PERFORM 8200-RETURN-TRANID                          10400000
104100     END-EVALUATE.                                                10410000
104200/                                                                 10420000
104300 3000-ABEND-SCREEN.                                               10430000
104400     PERFORM 3100-FORMAT-ABEND-INFO.                              10440000
104500                                                                  10450000
104600 3100-FORMAT-ABEND-INFO.                                          10460000
104700     INITIALIZE LT-LOG-LINE-TABLE.                                10470000
104800     MOVE EIBTRMID TO PV-LOG-TERMINAL.                            10480000
104900                                                                  10490000
105000     SET LT-IDX TO 1.                                             10500000
105100     PERFORM 3200-FORMAT-DB2.                                     10510000
105200                                                                  10520000
105300     MOVE DL010-DFHEIBLK           TO EIBM-EIBLK-MASK.            10530000
105400     PERFORM 3300-FORMAT-EIB.                                     10540000
105500*                                                                 10550000
105600 3200-FORMAT-DB2.                                                 10560000
105700     MOVE DL1-DB2-LINE-1      TO LT-ERROR-MESSAGE (LT-IDX).       10570000
105800     PERFORM 3210-FORMAT-COMMON-INFO.                             10580000
105900*                                                                 10590000
106000     PERFORM 5110-SET-LINE-INDEX.                                 10600000
106100     MOVE DL2-DB2-LINE-2      TO LT-ERROR-MESSAGE (LT-IDX).       10610000
106200     PERFORM 5110-SET-LINE-INDEX.                                 10620000
106300     STRING  DL010-DB2-TABLE-NAME (1) DELIMITED BY SPACE          10630000
106400             SPACE                    DELIMITED BY SIZE           10640000
106500             DL010-DB2-TABLE-NAME (2) DELIMITED BY SPACE          10650000
106600             SPACE                    DELIMITED BY SIZE           10660000
106700             DL010-DB2-TABLE-NAME (3) DELIMITED BY SPACE          10670000
106800             SPACE                    DELIMITED BY SIZE           10680000
106900             DL010-DB2-TABLE-NAME (4) DELIMITED BY SPACE          10690000
107000     INTO    LT-ERROR-MESSAGE (LT-IDX)                            10700000
107100     POINTER PV-STRING-POINTER.                                   10710000
107200*                                                                 10720000
107300     IF  PV-STRING-POINTER > PC-STRING-POINTER-MAX                10730000
107400         IF  DL010-DB2-TABLE-NAME (5) > SPACE                     10740000
107500             PERFORM 5110-SET-LINE-INDEX                          10750000
107600             MOVE DL010-DB2-TABLE-NAME (5)                        10760000
107700                              TO LT-ERROR-MESSAGE (LT-IDX)        10770000
107800         END-IF                                                   10780000
107900     ELSE                                                         10790000
108000         STRING  SPACE                    DELIMITED BY SIZE       10800000
108100                 DL010-DB2-TABLE-NAME (5) DELIMITED BY SPACE      10810000
108200         INTO    LT-ERROR-MESSAGE (LT-IDX)                        10820000
108300         POINTER PV-STRING-POINTER                                10830000
108400     END-IF.                                                      10840000
108500     PERFORM 3210-FORMAT-SQLCA.                                   10850000
108600*                                                                 10860000
108700*                                                                 10870000
108800 3210-FORMAT-SQLCA.                                               10880000
108900*                                                                 10890000
109000**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               10900000
109100*                                                                 10910000
109200     CALL 'DSNTIAR' USING DL010-SQLCA                             10920000
109300                          FDB-FORMATTED-MESSAGE                   10930000
109400                          FDB-ERROR-LINE-LENGTH.                  10940000
109500*                                                                 10950000
109600     PERFORM                                                      10960000
109700         VARYING FDB-MSG-IDX                                      10970000
109800         FROM 1 BY 1                                              10980000
109900         UNTIL FDB-MSG-IDX > FDB-MAX-MESSAGE-LINES                10990000
110000             IF  FDB-MESSAGE-LINE (FDB-MSG-IDX) > SPACE           11000000
110100                 PERFORM 5110-SET-LINE-INDEX                      11010000
110200                 MOVE FDB-MESSAGE-LINE (FDB-MSG-IDX)              11020000
110300                                 TO LT-ERROR-MESSAGE (LT-IDX)     11030000
110400             END-IF                                               11040000
110500     END-PERFORM.                                                 11050000
110600*                                                                 11060000
110700 3210-FORMAT-COMMON-INFO.                                         11070000
110800     MOVE DL010-LAST-PROGRAM      TO AL1-PROGRAM.                 11080000
110900     MOVE DL010-PARAGRAPH         TO AL1-PARAGRAPH.               11090000
111000     SET LT-IDX UP BY 1.                                          11100000
111100     MOVE AL1-ABEND-LINE-1        TO LT-ERROR-MESSAGE (LT-IDX).   11110000
111200*                                                                 11120000
111300** EIBTRMID WILL BE LOW-VALUES FOR NON-TERMINALLY ATTACHED        11130000
111400** APPLICATIONS  SO DON'T TRY TO READ THE 'INFO' TS QUEUE.        11140000
111500*                                                                 11150000
111600     IF  EIBTRMID > SPACE                                         11160000
111700         PERFORM 3211-GET-USER-FROM-TS                            11170000
111800         MOVE DP026-USERID        TO AL2-USERID                   11180000
111900         MOVE DP026-NETNAME       TO AL2-NETNAME                  11190000
112000         MOVE DP026-LOCATION-NBR  TO AL2-LOCATION                 11200000
112100         SET LT-IDX UP BY 1                                       11210000
112200         MOVE AL2-ABEND-LINE-2    TO LT-ERROR-MESSAGE (LT-IDX)    11220000
112300     END-IF.                                                      11230000
112400*                                                                 11240000
112500     MOVE 'D'                     TO AL3-ABEND-TYPE.              11250000
112600     MOVE SPACE                   TO AL3-ABEND-CONTROL.           11260000
112700     MOVE SPACE                   TO AL3-ROLLBACK.                11270000
112800     SET LT-IDX UP BY 1.                                          11280000
112900     MOVE AL3-ABEND-LINE-3        TO LT-ERROR-MESSAGE (LT-IDX).   11290000
113000*                                                                 11300000
113100     IF  DL010-MESSAGE-TABLE = SPACE                              11310000
113200         CONTINUE                                                 11320000
113300     ELSE                                                         11330000
113400         SET LT-IDX UP BY 1                                       11340000
113500         MOVE AL4-ABEND-LINE-4    TO LT-ERROR-MESSAGE (LT-IDX)    11350000
113600         PERFORM                                                  11360000
113700             VARYING PV-MSG-SUB                                   11370000
113800             FROM 1 BY 1                                          11380000
113900             UNTIL PV-MSG-SUB > 4                                 11390000
114000                 IF  DL010-MESSAGE-TEXT (PV-MSG-SUB) > SPACE      11400000
114100                     SET LT-IDX UP BY 1                           11410000
114200                     MOVE DL010-MESSAGE-TEXT (PV-MSG-SUB)         11420000
114300                              TO LT-ERROR-MESSAGE (LT-IDX)        11430000
114400                 END-IF                                           11440000
114500         END-PERFORM                                              11450000
114600     END-IF.                                                      11460000
114700*                                                                 11470000
114800*                                                                 11480000
114900 3211-GET-USER-FROM-TS.                                           11490000
115000     MOVE EIBTRMID             TO TS-INFO-QUEUE-TERMINAL.         11500000
115100     MOVE SPACE                TO PV-SYSID.                       11510000
115200     EXEC CICS                                                    11520000
115300         INQUIRE                                                  11530000
115400             TRANSACTION  (PC-LOGON-TRAN)                         11540000
115500             REMOTESYSTEM (PV-SYSID)                              11550000
115600     END-EXEC.                                                    11560000
115700*                                                                 11570000
115800     IF  PV-SYSID = SPACE                                         11580000
115900         EXEC CICS                                                11590000
116000             READQ TS                                             11600000
116100                 QUEUE (TS-INFO-QUEUE-NAME)                       11610000
116200                 INTO  (DP026-SIGN-ON-INFO)                       11620000
116300                 ITEM  (PV-TS-ITEM)                               11630000
116400                 RESP  (PV-CICS-RESPONSE)                         11640000
116500         END-EXEC                                                 11650000
116600     ELSE                                                         11660000
116700         EXEC CICS                                                11670000
116800             READQ TS                                             11680000
116900                 QUEUE (TS-INFO-QUEUE-NAME)                       11690000
117000                 INTO  (DP026-SIGN-ON-INFO)                       11700000
117100                 ITEM  (PV-TS-ITEM)                               11710000
117200                 SYSID (PV-SYSID)                                 11720000
117300                 LENGTH(LENGTH OF DP026-SIGN-ON-INFO)             11730000
117400                 RESP  (PV-CICS-RESPONSE)                         11740000
117500         END-EXEC                                                 11750000
117600     END-IF.                                                      11760000
117700*                                                                 11770000
117800     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       11780000
117900         CONTINUE                                                 11790000
118000     ELSE                                                         11800000
118100         MOVE ALL '?'   TO DP026-USERID                           11810000
118200                           DP026-NETNAME                          11820000
118300         MOVE ZERO      TO DP026-LOCATION-NBR                     11830000
118400     END-IF.                                                      11840000
118500*                                                                 11850000
118600*                                                                 11860000
118700 3300-FORMAT-EIB.                                                 11870000
118800     PERFORM 5110-SET-LINE-INDEX.                                 11880000
118900     MOVE EL1-EIB-LINE-1  TO LT-ERROR-MESSAGE (LT-IDX).           11890000
119000*                                                                 11900000
119100     MOVE EIBM-TIME       TO EL2-EIBTIME.                         11910000
119200     MOVE EIBM-DATE       TO EL2-EIBDATE.                         11920000
119300     PERFORM 5110-SET-LINE-INDEX.                                 11930000
119400     MOVE EL2-EIB-LINE-2  TO LT-ERROR-MESSAGE (LT-IDX).           11940000
119500*                                                                 11950000
119600     MOVE EIBM-TRNID      TO EL3-EIBTRNID.                        11960000
119700     MOVE EIBM-TASKN      TO EL3-EIBTASKN.                        11970000
119800     PERFORM 5110-SET-LINE-INDEX.                                 11980000
119900     MOVE EL3-EIB-LINE-3  TO LT-ERROR-MESSAGE (LT-IDX).           11990000
120000*                                                                 12000000
120100     MOVE EIBM-TRMID      TO EL4-EIBTRMID.                        12010000
120200     MOVE EIBM-CPOSN      TO EL4-EIBCPOSN.                        12020000
120300     PERFORM 5110-SET-LINE-INDEX.                                 12030000
120400     MOVE EL4-EIB-LINE-4  TO LT-ERROR-MESSAGE (LT-IDX).           12040000
120500*                                                                 12050000
120600     MOVE EIBM-CALEN      TO EL5-EIBCALEN.                        12060000
120700     MOVE EIBM-AID        TO EL5-EIBAID.                          12070000
120800     SET AC-AID-IDX TO 1.                                         12080000
120900     SEARCH AC-ATTENTION-ID-ENTRY                                 12090000
121000         AT END                                                   12100000
121100             MOVE ALL '?'            TO EL5-EIBAID-DESCRIPTION    12110000
121200         WHEN AC-EIBAID (AC-AID-IDX) = EIBM-AID                   12120000
121300             MOVE AC-AID-NAME (AC-AID-IDX)                        12130000
121400                                     TO EL5-EIBAID-DESCRIPTION    12140000
121500     END-SEARCH.                                                  12150000
121600     PERFORM 5110-SET-LINE-INDEX.                                 12160000
121700     MOVE EL5-EIB-LINE-5  TO LT-ERROR-MESSAGE (LT-IDX).           12170000
121800*                                                                 12180000
121900     MOVE EIBM-FN                    TO DP012-CONVERSION-FIELD.   12190000
122000     MOVE LENGTH OF EIBM-FN          TO DP012-LENGTH.             12200000
122100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12210000
122200     IF  DP012-CALL-SUCCESSFUL                                    12220000
122300         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBFN-HEX             12230000
122400     ELSE                                                         12240000
122500         MOVE ALL '?'                TO EL6-EIBFN-HEX             12250000
122600     END-IF.                                                      12260000
122700     MOVE EIBM-RCODE                 TO DP012-CONVERSION-FIELD.   12270000
122800     MOVE LENGTH OF EIBM-RCODE       TO DP012-LENGTH.             12280000
122900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12290000
123000     IF  DP012-CALL-SUCCESSFUL                                    12300000
123100         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBRCODE-HEX          12310000
123200     ELSE                                                         12320000
123300         MOVE ALL '?'                TO EL6-EIBRCODE-HEX          12330000
123400     END-IF.                                                      12340000
123500     PERFORM 5110-SET-LINE-INDEX.                                 12350000
123600     MOVE EL6-EIB-LINE-6             TO LT-ERROR-MESSAGE (LT-IDX).12360000
123700*                                                                 12370000
123800     MOVE EIBM-RESP                  TO EL7-EIBRESP.              12380000
123900     SET EC-RESP-IDX TO 1.                                        12390000
124000     SEARCH EC-EIBRESP-ENTRY                                      12400000
124100         AT END                                                   12410000
124200             MOVE ALL '?'            TO EL7-EIBRESP-DESCRIPTION   12420000
124300         WHEN EC-EIBRESP (EC-RESP-IDX) = EIBM-RESP                12430000
124400             MOVE EC-CONDITION-NAME (EC-RESP-IDX)                 12440000
124500                                     TO EL7-EIBRESP-DESCRIPTION   12450000
124600     END-SEARCH.                                                  12460000
124700     MOVE EIBM-RESP2                 TO EL7-EIBRESP2.             12470000
124800     PERFORM 5110-SET-LINE-INDEX.                                 12480000
124900     MOVE EL7-EIB-LINE-7             TO LT-ERROR-MESSAGE (LT-IDX).12490000
125000*                                                                 12500000
125100     MOVE EIBM-DS                    TO EL8-EIBDS.                12510000
125200*                                                                 12520000
125300     MOVE EIBM-REQID                 TO DP012-CONVERSION-FIELD.   12530000
125400     MOVE LENGTH OF EIBM-REQID       TO DP012-LENGTH.             12540000
125500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12550000
125600     IF  DP012-CALL-SUCCESSFUL                                    12560000
125700         MOVE DP012-CONVERTED-FIELD  TO EL8-EIBREQID-HEX          12570000
125800     ELSE                                                         12580000
125900         MOVE ALL '?'                TO EL8-EIBREQID-HEX          12590000
126000     END-IF.                                                      12600000
126100     PERFORM 5110-SET-LINE-INDEX.                                 12610000
126200     MOVE EL8-EIB-LINE-8             TO LT-ERROR-MESSAGE (LT-IDX).12620000
126300*                                                                 12630000
126400     MOVE EIBM-RSRCE                 TO DP012-CONVERSION-FIELD.   12640000
126500     MOVE LENGTH OF EIBM-RSRCE       TO DP012-LENGTH.             12650000
126600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12660000
126700     IF  DP012-CALL-SUCCESSFUL                                    12670000
126800         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBRSRCE-HEX          12680000
126900     ELSE                                                         12690000
127000         MOVE ALL '?'                TO EL9-EIBRSRCE-HEX          12700000
127100     END-IF.                                                      12710000
127200*                                                                 12720000
127300     MOVE EIBM-EOC                   TO DP012-CONVERSION-FIELD.   12730000
127400     MOVE LENGTH OF EIBM-EOC         TO DP012-LENGTH.             12740000
127500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12750000
127600     IF  DP012-CALL-SUCCESSFUL                                    12760000
127700         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBEOC-HEX            12770000
127800     ELSE                                                         12780000
127900         MOVE ALL '?'                TO EL9-EIBEOC-HEX            12790000
128000     END-IF.                                                      12800000
128100     PERFORM 5110-SET-LINE-INDEX.                                 12810000
128200     MOVE EL9-EIB-LINE-9             TO LT-ERROR-MESSAGE (LT-IDX).12820000
128300*                                                                 12830000
128400     MOVE EIBM-FREE                  TO DP012-CONVERSION-FIELD.   12840000
128500     MOVE LENGTH OF EIBM-FREE        TO DP012-LENGTH.             12850000
128600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12860000
128700     IF  DP012-CALL-SUCCESSFUL                                    12870000
128800         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBFREE-HEX          12880000
128900     ELSE                                                         12890000
129000         MOVE ALL '?'                TO EL10-EIBFREE-HEX          12900000
129100     END-IF.                                                      12910000
129200     MOVE EIBM-RECV                  TO DP012-CONVERSION-FIELD.   12920000
129300     MOVE LENGTH OF EIBM-RECV        TO DP012-LENGTH.             12930000
129400     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12940000
129500     IF  DP012-CALL-SUCCESSFUL                                    12950000
129600         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBRECV-HEX          12960000
129700     ELSE                                                         12970000
129800         MOVE ALL '?'                TO EL10-EIBRECV-HEX          12980000
129900     END-IF.                                                      12990000
130000     PERFORM 5110-SET-LINE-INDEX.                                 13000000
130100     MOVE EL10-EIB-LINE-10           TO LT-ERROR-MESSAGE (LT-IDX).13010000
130200*                                                                 13020000
130300     MOVE EIBM-ATT                   TO DP012-CONVERSION-FIELD.   13030000
130400     MOVE LENGTH OF EIBM-ATT         TO DP012-LENGTH.             13040000
130500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13050000
130600     IF  DP012-CALL-SUCCESSFUL                                    13060000
130700         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBATT-HEX           13070000
130800     ELSE                                                         13080000
130900         MOVE ALL '?'                TO EL11-EIBATT-HEX           13090000
131000     END-IF.                                                      13100000
131100     MOVE EIBM-SYNC                  TO DP012-CONVERSION-FIELD.   13110000
131200     MOVE LENGTH OF EIBM-SYNC        TO DP012-LENGTH.             13120000
131300     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13130000
131400     IF  DP012-CALL-SUCCESSFUL                                    13140000
131500         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBSYNC-HEX          13150000
131600     ELSE                                                         13160000
131700         MOVE ALL '?'                TO EL11-EIBSYNC-HEX          13170000
131800     END-IF.                                                      13180000
131900     PERFORM 5110-SET-LINE-INDEX.                                 13190000
132000     MOVE EL11-EIB-LINE-11           TO LT-ERROR-MESSAGE (LT-IDX).13200000
132100*                                                                 13210000
132200     MOVE EIBM-FMH                   TO DP012-CONVERSION-FIELD.   13220000
132300     MOVE LENGTH OF EIBM-FMH         TO DP012-LENGTH.             13230000
132400     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13240000
132500     IF  DP012-CALL-SUCCESSFUL                                    13250000
132600         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBFMH-HEX           13260000
132700     ELSE                                                         13270000
132800         MOVE ALL '?'                TO EL12-EIBFMH-HEX           13280000
132900     END-IF.                                                      13290000
133000     MOVE EIBM-COMPL                 TO DP012-CONVERSION-FIELD.   13300000
133100     MOVE LENGTH OF EIBM-COMPL       TO DP012-LENGTH.             13310000
133200     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13320000
133300     IF  DP012-CALL-SUCCESSFUL                                    13330000
133400         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBCOMPL-HEX         13340000
133500     ELSE                                                         13350000
133600         MOVE ALL '?'                TO EL12-EIBCOMPL-HEX         13360000
133700     END-IF.                                                      13370000
133800     PERFORM 5110-SET-LINE-INDEX.                                 13380000
133900     MOVE EL12-EIB-LINE-12           TO LT-ERROR-MESSAGE (LT-IDX).13390000
134000*                                                                 13400000
134100     MOVE EIBM-SIG                   TO DP012-CONVERSION-FIELD.   13410000
134200     MOVE LENGTH OF EIBM-SIG         TO DP012-LENGTH.             13420000
134300     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13430000
134400     IF  DP012-CALL-SUCCESSFUL                                    13440000
134500         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBSIG-HEX           13450000
134600     ELSE                                                         13460000
134700         MOVE ALL '?'                TO EL13-EIBSIG-HEX           13470000
134800     END-IF.                                                      13480000
134900     MOVE EIBM-CONF                  TO DP012-CONVERSION-FIELD.   13490000
135000     MOVE LENGTH OF EIBM-CONF        TO DP012-LENGTH.             13500000
135100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13510000
135200     IF  DP012-CALL-SUCCESSFUL                                    13520000
135300         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBCONF-HEX          13530000
135400     ELSE                                                         13540000
135500         MOVE ALL '?'                TO EL13-EIBCONF-HEX          13550000
135600     END-IF.                                                      13560000
135700     PERFORM 5110-SET-LINE-INDEX.                                 13570000
135800     MOVE EL13-EIB-LINE-13           TO LT-ERROR-MESSAGE (LT-IDX).13580000
135900*                                                                 13590000
136000     MOVE EIBM-ERR                   TO DP012-CONVERSION-FIELD.   13600000
136100     MOVE LENGTH OF EIBM-ERR         TO DP012-LENGTH.             13610000
136200     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13620000
136300     IF  DP012-CALL-SUCCESSFUL                                    13630000
136400         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERR-HEX           13640000
136500     ELSE                                                         13650000
136600         MOVE ALL '?'                TO EL14-EIBERR-HEX           13660000
136700     END-IF.                                                      13670000
136800     MOVE EIBM-ERRCD                 TO DP012-CONVERSION-FIELD.   13680000
136900     MOVE LENGTH OF EIBM-ERRCD       TO DP012-LENGTH.             13690000
137000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13700000
137100     IF  DP012-CALL-SUCCESSFUL                                    13710000
137200         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERRCD-HEX         13720000
137300     ELSE                                                         13730000
137400         MOVE ALL '?'                TO EL14-EIBERRCD-HEX         13740000
137500     END-IF.                                                      13750000
137600     PERFORM 5110-SET-LINE-INDEX.                                 13760000
137700     MOVE EL14-EIB-LINE-14           TO LT-ERROR-MESSAGE (LT-IDX).13770000
137800*                                                                 13780000
137900     MOVE EIBM-SYNRB                 TO DP012-CONVERSION-FIELD.   13790000
138000     MOVE LENGTH OF EIBM-SYNRB       TO DP012-LENGTH.             13800000
138100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13810000
138200     IF  DP012-CALL-SUCCESSFUL                                    13820000
138300         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBSYNRB-HEX         13830000
138400     ELSE                                                         13840000
138500         MOVE ALL '?'                TO EL15-EIBSYNRB-HEX         13850000
138600     END-IF.                                                      13860000
138700     MOVE EIBM-NODAT                 TO DP012-CONVERSION-FIELD.   13870000
138800     MOVE LENGTH OF EIBM-NODAT       TO DP012-LENGTH.             13880000
138900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13890000
139000     IF  DP012-CALL-SUCCESSFUL                                    13900000
139100         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBNODAT-HEX         13910000
139200     ELSE                                                         13920000
139300         MOVE ALL '?'                TO EL15-EIBNODAT-HEX         13930000
139400     END-IF.                                                      13940000
139500     PERFORM 5110-SET-LINE-INDEX.                                 13950000
139600     MOVE EL15-EIB-LINE-15           TO LT-ERROR-MESSAGE (LT-IDX).13960000
139700*                                                                 13970000
139800*                                                                 13980000
139900 3500-LOG-ABEND-INFO.                                             13990000
140000     EXEC CICS                                                    14000000
140100         ENQ                                                      14010000
140200             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     14020000
140300     END-EXEC.                                                    14030000
140400*                                                                 14040000
140500     SET PV-NUMBER-LOG-LINES TO LT-IDX.                           14050000
140600     PERFORM                                                      14060000
140700         VARYING LT-IDX                                           14070000
140800         FROM 1 BY 1                                              14080000
140900         UNTIL LT-IDX > PV-NUMBER-LOG-LINES                       14090000
141000             MOVE LT-LOG-LINE (LT-IDX) TO PV-LOG-DATA             14100000
141100             PERFORM 3510-WRITEQ-TD                               14110000
141200     END-PERFORM.                                                 14120000
141300*                                                                 14130000
141400     EXEC CICS                                                    14140000
141500         DEQ                                                      14150000
141600             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     14160000
141700     END-EXEC.                                                    14170000
141800*    PERFORM 3520-DISPLAY-OPER-MSG.                               14180000
141900*                                                                 14190000
142000*                                                                 14200000
142100 3510-WRITEQ-TD.                                                  14210000
142200     EXEC CICS                                                    14220000
142300         WRITEQ TD                                                14230000
142400             QUEUE (PC-LOG-QUEUE)                                 14240000
142500             FROM  (PV-LOG-LINE)                                  14250000
142600             RESP  (PV-CICS-RESPONSE)                             14260000
142700     END-EXEC.                                                    14270000
142800*                                                                 14280000
142900     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       14290000
143000         CONTINUE                                                 14300000
143100     ELSE                                                         14310000
143200         EXEC CICS                                                14320000
143300             ABEND                                                14330000
143400                 ABCODE (EIBTRMID)                                14340000
143500         END-EXEC                                                 14350000
143600     END-IF.                                                      14360000
143700 5110-SET-LINE-INDEX.                                             14370000
143800     IF  LT-IDX > PC-LOG-TABLE-MAX                                14380000
143900         SET PS-LOG-OVERFLOW TO TRUE                              14390000
144000     ELSE                                                         14400000
144100         SET LT-IDX UP BY 1                                       14410000
144200     END-IF.                                                      14420000
144300*                                                                 14430000
144400*                                                                 14440000
144500 8000-SEND-MAP.                                                   14450000
144600     EXEC CICS                                                    14460000
144700         SEND                                                     14470000
144800             MAP     ('DL456A')                                   14480000
144900             MAPSET  ('DLKM456')                                  14490000
145000             ERASE                                                14500000
145100             RESP    (PV-CICS-RESPONSE)                           14510000
145200     END-EXEC.                                                    14520000
145300                                                                  14530000
145400     EVALUATE TRUE                                                14540000
145500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14550000
145600             CONTINUE                                             14560000
145700         WHEN OTHER                                               14570000
145800             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          14580000
145900             MOVE 'UNABLE TO SEND MAP'                            14590000
146000                                      TO DP013-MESSAGE-TEXT (1)   14600000
146100             SET DP013-CICS-ABEND     TO TRUE                     14610000
146200             SET DP013-NO-ROLLBACK    TO TRUE                     14620000
146300             PERFORM 9999-WRITE-CICS-LOG-MSG                      14630000
146400     END-EVALUATE.                                                14640000
146500*                                                                 14650000
146600 8020-RECEIVE-MAP.                                                14660000
146700                                                                  14670000
146800     EXEC CICS                                                    14680000
146900         RECEIVE MAP    ('DL456A')                                14690000
147000                 MAPSET ('DLKM456')                               14700000
147100                 RESP   (PV-CICS-RESPONSE)                        14710000
147200     END-EXEC.                                                    14720000
147300                                                                  14730000
147400     EVALUATE TRUE                                                14740000
147500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14750000
147600             CONTINUE                                             14760000
147700         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                14770000
147800             CONTINUE                                             14780000
147900         WHEN OTHER                                               14790000
148000             MOVE '8020-RECEIVE-MAP'  TO DP013-PARAGRAPH          14800000
148100             MOVE 'DLKRF456 - UNABLE TO RECEIVE MAP'              14810000
148200                                      TO DP013-MESSAGE-TEXT (1)   14820000
148300             SET DP013-LOGIC-ABEND    TO TRUE                     14830000
148400             SET DP013-NO-ROLLBACK    TO TRUE                     14840000
148500             PERFORM 9999-WRITE-CICS-LOG-MSG                      14850000
148600     END-EVALUATE.                                                14860000
148700                                                                  14870000
148800 8030-SEND-TEXT.                                                  14880000
148900                                                                  14890000
149000     MOVE LENGTH OF PV-TEXT TO PV-TEXT-LENGTH                     14900000
149100                                                                  14910000
149200     EXEC CICS                                                    14920000
149300         SEND TEXT                                                14930000
149400             FROM (PV-TEXT)                                       14940000
149500             LENGTH (PV-TEXT-LENGTH)                              14950000
149600             ERASE                                                14960000
149700             RESP   (PV-CICS-RESPONSE)                            14970000
149800     END-EXEC.                                                    14980000
149900                                                                  14990000
150000     EVALUATE TRUE                                                15000000
150100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15010000
150200             CONTINUE                                             15020000
150300         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                15030000
150400             CONTINUE                                             15040000
150500         WHEN OTHER                                               15050000
150600             MOVE '8030-SEND-TEXT'    TO DP013-PARAGRAPH          15060000
150700             MOVE 'DLKRF871 - UNABLE TO SEND TEXT'                15070000
150800                                      TO DP013-MESSAGE-TEXT (1)   15080000
150900             SET DP013-LOGIC-ABEND    TO TRUE                     15090000
151000             SET DP013-NO-ROLLBACK    TO TRUE                     15100000
151100             PERFORM 9999-WRITE-CICS-LOG-MSG                      15110000
151200     END-EVALUATE.                                                15120000
151300                                                                  15130000
151400 8100-SEND-DATA-ONLY.                                             15140000
151500                                                                  15150000
151600     EXEC CICS                                                    15160000
151700         SEND                                                     15170000
151800             MAP       ('DL456A')                                 15180000
151900             MAPSET    ('DLKM456')                                15190000
152000             CURSOR                                               15200000
152100             DATAONLY                                             15210000
152200             RESP      (PV-CICS-RESPONSE)                         15220000
152300     END-EXEC.                                                    15230000
152400                                                                  15240000
152500     EVALUATE TRUE                                                15250000
152600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15260000
152700             CONTINUE                                             15270000
152800         WHEN OTHER                                               15280000
152900             MOVE '8100-SEND-DATA-ONLY'                           15290000
153000                                      TO DP013-PARAGRAPH          15300000
153100             MOVE 'UNABLE TO SEND DATA'                           15310000
153200                                      TO DP013-MESSAGE-TEXT (1)   15320000
153300             SET DP013-CICS-ABEND     TO TRUE                     15330000
153400             SET DP013-NO-ROLLBACK    TO TRUE                     15340000
153500             PERFORM 9999-WRITE-CICS-LOG-MSG                      15350000
153600     END-EVALUATE.                                                15360000
153700*                                                                 15370000
153800 8200-RETURN-TRANID.                                              15380000
153900     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH.      15390000
154000                                                                  15400000
154100     EXEC CICS                                                    15410000
154200         RETURN                                                   15420000
154300             TRANSID   (PC-CURRENT-TRANID)                        15430000
154400             COMMAREA  (DL010-COMMAREA)                           15440000
154500             LENGTH    (PV-COMMAREA-LENGTH)                       15450000
154600             RESP      (PV-CICS-RESPONSE)                         15460000
154700     END-EXEC.                                                    15470000
154800                                                                  15480000
154900     EVALUATE TRUE                                                15490000
155000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15500000
155100             CONTINUE                                             15510000
155200         WHEN OTHER                                               15520000
155300             MOVE '8200-RETURN-TRANID'                            15530000
155400                                      TO DP013-PARAGRAPH          15540000
155500             MOVE 'UNABLE TO RETURN   TO TRANID'                  15550000
155600                                      TO DP013-MESSAGE-TEXT (1)   15560000
155700             SET DP013-CICS-ABEND     TO TRUE                     15570000
155800             SET DP013-NO-ROLLBACK    TO TRUE                     15580000
155900             PERFORM 9999-WRITE-CICS-LOG-MSG                      15590000
156000     END-EVALUATE.                                                15600000
156100                                                                  15610001
158600                                                                  15860001
158700 8400-ROLLBACK.                                                   15870000
158800                                                                  15880000
158900     EXEC CICS                                                    15890000
159000         SYNCPOINT                                                15900000
159100         ROLLBACK                                                 15910000
159200     END-EXEC.                                                    15920000
159300                                                                  15930000
159400*                                                                 15940000
159500 9999-WRITE-CICS-LOG-MSG.                                         15950000
159600     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           15960000
159700     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          15970000
159800     INITIALIZE DP013-SRC-TASK-NUMBER                             15980000
159900                DP013-STACK.                                      15990000
160000     SET DP013-LINK-RETURN            TO TRUE.                    16000000
160100                                                                  16010000
160200     EXEC CICS                                                    16020000
160300         LINK                                                     16030000
160400             PROGRAM   (DP013-NAME)                               16040000
160500             COMMAREA  (DP013-PARAMETERS)                         16050000
160600             LENGTH    (DP013-LENGTH)                             16060000
160700     END-EXEC.                                                    16070000
160800                                                                  16080000
160900*----------------------------------------------------------------*16090000
161000*    ABEND PROCESSOR MODULE                                      *16100000
161100*----------------------------------------------------------------*16110000
161200                                                                  16120000
161300*    COPY DPPD014.                                                16130002
161400                                                                  16140000
