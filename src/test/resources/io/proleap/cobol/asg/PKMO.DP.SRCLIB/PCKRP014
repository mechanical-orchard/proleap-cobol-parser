000100***************************************************************** 00001000
000200 IDENTIFICATION DIVISION.                                         00002000
000300***************************************************************** 00003000
000400 PROGRAM-ID.             PCKRP014.                                00005001
000500 AUTHOR.                 PATRICK BURKE.                           00006000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00007000
000700 DATE-WRITTEN.           FEBRUARY 2002.                           00008001
000800 DATE-COMPILED.                                                   00009000
000900*                                                                 00010035
001000***************************************************************** 00020000
001100*  THIS PROGRAM TAKE THE EXTRACT FILE CREATED IN PCKUT019 AND     00030000
001200*  CREATES WEEKLY, MONTHLY AND YEARLY REPORTS WHICH ARE A RECAP   00040001
001300*  OF UNITS WORKED VERSUS THE PREVIOUS YEAR.                      00050001
001400***************************************************************** 00060000
001500 ENVIRONMENT DIVISION.                                            00070000
001600***************************************************************** 00080000
001700 CONFIGURATION SECTION.                                           00090000
001800 SOURCE-COMPUTER.                        IBM-3090.                00100000
001900 OBJECT-COMPUTER.                        IBM-3090.                00110000
002000 INPUT-OUTPUT SECTION.                                            00120000
002100 FILE-CONTROL.                                                    00130000
002200                                                                  00140000
002300     SELECT EXTRACT-FILE                                          00150000
002400         ASSIGN TO INP01.                                         00160000
002500                                                                  00170000
002600     SELECT REPORT-FILE-1                                         00180000
002700         ASSIGN TO RPT01.                                         00190000
002800                                                                  00200000
002900     SELECT REPORT-FILE-2                                         00210000
003000         ASSIGN TO RPT02.                                         00220000
003100                                                                  00230000
003200***************************************************************** 00240000
003300 DATA DIVISION.                                                   00250000
003400***************************************************************** 00260000
003500 FILE SECTION.                                                    00270000
003600                                                                  00280000
003700 FD  EXTRACT-FILE                                                 00290000
003800     RECORDING MODE IS F                                          00300000
003900     LABEL RECORDS ARE STANDARD                                   00310000
004000     BLOCK CONTAINS 0 RECORDS.                                    00320000
004100 01  EXTRACT-RECORD                   PIC X(170).                 00330000
004200                                                                  00340000
004300 FD  REPORT-FILE-1                                                00350000
004400     RECORDING MODE IS F                                          00360000
004500     BLOCK CONTAINS 0 RECORDS.                                    00370000
004600 01  REPORT-RECORD-1                  PIC X(132).                 00380000
004700                                                                  00390000
004800 FD  REPORT-FILE-2                                                00400000
004900     RECORDING MODE IS F                                          00401000
005000     BLOCK CONTAINS 0 RECORDS.                                    00402000
005100 01  REPORT-RECORD-2                  PIC X(132).                 00403000
005200/                                                                 00404000
005300***************************************************************** 00405000
005400 WORKING-STORAGE SECTION.                                         00406000
005500***************************************************************** 00407000
005600*                                                                 00408000
005700**************************************************************    00409000
005800*  CONTROL CARD LAYOUT.                                           00410000
005900**************************************************************    00420000
006000     COPY PCWS239.                                                00430000
006100/                                                                 00440000
006200**************************************************************    00533400
006300 01  PS-SWITCHES.                                                 00533600
006400     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00533700
006500         88  PS-PRINT-DETAILS                   VALUE 'Y'.        00533800
006600         88  PS-NOT-PRINT-DETAILS               VALUE 'N'.        00533900
006700     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00537000
006800         88  PS-END-OF-INPUT                    VALUE 'Y'.        00538000
006900         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00539000
007000     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00540005
007100         88  PS-NEW-PAGE                        VALUE 'Y'.        00550005
007200         88  PS-SAME-PAGE                       VALUE 'N'.        00560005
007300     05  PS-OPER-ALL-SW               PIC X(01) VALUE 'N'.        00570026
007400         88  PS-OPER-ALL                        VALUE 'Y'.        00580026
007500     05  PS-PRINT-LINE-SW             PIC X(01) VALUE 'N'.        00580126
007600         88  PS-PRINT-LINE                      VALUE 'Y'.        00580226
007700     05  PS-CRSDCK-SW                 PIC X(01) VALUE 'N'.        00581005
007800         88  PS-CRSDCK-YES                      VALUE 'Y'.        00582005
007900         88  PS-CRSDCK-NO                       VALUE 'N'.        00583005
008000     05  PS-B-RECORD-SW               PIC X(01) VALUE 'N'.        00584011
008100         88  PS-END-B-RECORD                    VALUE 'Y'.        00585011
008200         88  PS-NOT-END-B-RECORD                VALUE 'N'.        00586011
008300     05  PS-D-RECORD-SW               PIC X(01) VALUE 'N'.        00587011
008400         88  PS-END-D-RECORD                    VALUE 'Y'.        00588011
008500         88  PS-NOT-END-D-RECORD                VALUE 'N'.        00589011
008600     05  PS-END-TABLE-SW              PIC X(01) VALUE 'N'.        00589129
008700         88  PS-END-TABLE                       VALUE 'Y'.        00589229
008800         88  PS-END-TABLE-NO                    VALUE 'N'.        00589329
008900     05  PS-ECOMM-SW                  PIC X(01) VALUE 'N'.        00589470
009000         88  PS-ECOMM-YES                       VALUE 'Y'.        00589570
009100         88  PS-ECOMM-NO                        VALUE 'N'.        00589670
009200     05  PS-SUMMARY-SW                PIC X(01) VALUE 'N'.        00589770
009300         88  PS-SUMMARY-YES                     VALUE 'Y'.        00589870
009400         88  PS-SUMMARY-NO                      VALUE 'N'.        00589970
009500     05  PS-CURR-PREV-SW              PIC X(01) VALUE 'N'.        00590070
009600         88  PS-CURRENT                         VALUE 'Y'.        00590170
009700         88  PS-PREVIOUS                        VALUE 'N'.        00591070
009800                                                                  00600070
009900 01  PV-DATE-RECORD.                                              00650000
010000     05  PV-LY-THIS-DAY-KY-DTE       PIC X(10).                   00660011
010100     05  PV-LY-THIS-DAY REDEFINES PV-LY-THIS-DAY-KY-DTE.          00660111
010200         10  PV-LY-YYYY              PIC X(04).                   00660211
010300         10  FILLER                  PIC X(01).                   00660311
010400         10  PV-LY-MM                PIC X(02).                   00661011
010500         10  FILLER                  PIC X(01).                   00662011
010600         10  PV-LY-DD                PIC X(02).                   00663011
010700     05  PV-CURR-WEEK-ENDING.                                     00665111
010800         10  PV-WK-END-YYYY          PIC X(04).                   00665211
010900         10  FILLER                  PIC X(01).                   00665311
011000         10  PV-WK-END-MM            PIC X(02).                   00665411
011100         10  FILLER                  PIC X(01).                   00665511
011200         10  PV-WK-END-DD            PIC X(02).                   00665611
011300                                                                  00666010
011400     05  PV-CURR-WW-YYYY.                                         00670010
011500         10  PV-CURR-WW               PIC X(02) VALUE SPACES.     00671010
011600         10  FILLER                   PIC X(01) VALUE '/'.        00671110
011700         10  PV-CURR-YYYY             PIC X(04) VALUE SPACES.     00672010
011800     05  PV-PREV-WW-YYYY.                                         00673010
011900         10  PV-PREV-WW               PIC X(02) VALUE SPACES.     00674010
012000         10  FILLER                   PIC X(01) VALUE '/'.        00675010
012100         10  PV-PREV-YYYY             PIC X(04) VALUE SPACES.     00676010
012200                                                                  00690000
012300     05  PV-KEY-DATE                 PIC X(10).                   00691011
012400     05  PV-CURR-KEY-DATE REDEFINES PV-KEY-DATE.                  00691111
012500         10  PV-KEY-YYYY             PIC X(04).                   00691211
012600         10  FILLER                  PIC X(01).                   00691311
012700         10  PV-KEY-MM               PIC X(02).                   00691411
012800         10  FILLER                  PIC X(01).                   00691511
012900         10  PV-KEY-DD               PIC X(02).                   00691611
013000                                                                  00691749
013100     05  PV-START-RPT-DATE           PIC X(10).                   00691850
013200     05  PV-END-RPT-DATE             PIC X(10).                   00691954
013300     05  PV-FROM-DATE                PIC X(10).                   00693074
013400     05  PV-TO-DATE                  PIC X(10).                   00694074
013500     05  PV-PREV-FROM-DATE           PIC X(10).                   00694176
013600     05  PV-PREV-TO-DATE             PIC X(10).                   00694276
013700                                                                  00695074
013800 01  SD-SYSTEM-DATE.                                              00700000
013900     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00710000
014000     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00720000
014100     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00730000
014200                                                                  00740000
014300 01  ST-SYSTEM-TIME.                                              00750000
014400     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00760000
014500     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00770000
014600     05  FILLER                     PIC  9(04)   VALUE ZERO.      00780000
014700                                                                  00790000
014800**************************************************************    00790129
014900 01  DC-TOTALS-TABLE.                                             00791029
015000     05  DC-TABLE OCCURS 50 TIMES INDEXED BY DC-NDX.              00792035
015100                                                                  00793035
015200         10  DC-NUMBER               PIC S9(4)  COMP.             00794029
015300         10  DC-NAME                 PIC X(25) VALUE SPACES.      00794135
015400         10  DC-CURR-UNITS           PIC S9(09) COMP.             00795029
015500         10  DC-CURR-RETAIL          PIC S9(12) COMP.             00796029
015600         10  DC-CURR-PO-RCVR         PIC S9(09) COMP.             00797029
015700         10  DC-PREV-UNITS           PIC S9(09) COMP.             00799029
015800         10  DC-PREV-RETAIL          PIC S9(12) COMP.             00799129
015900         10  DC-PREV-PO-RCVR         PIC S9(09) COMP.             00799229
016000         10  DC-DIFF-UNITS           PIC S9(09) COMP.             00799429
016100         10  DC-DIFF-RETAIL          PIC S9(12) COMP.             00799529
016200         10  DC-DIFF-PO-RCVR         PIC S9(09) COMP.             00799629
016300         10  DC-CURR-CRSDCK          PIC S9(09) COMP.             00799732
016400         10  DC-CURR-PERCENT         PIC S9(03)V99 COMP.          00799836
016500         10  DC-PREV-CRSDCK          PIC S9(09) COMP.             00799932
016600         10  DC-PREV-PERCENT         PIC S9(03)V99 COMP.          00800036
016700         10  DC-DIFF-CRSDCK          PIC S9(09) COMP.             00800132
016800         10  DC-DIFF-PERCENT         PIC S9(03)V99 COMP.          00800236
016900                                                                  00800332
017000**************************************************************    00800432
017100 01  PV-VARIABLES.                                                00801029
017200     05  PV-READ-COUNT                PIC S9(7) COMP-3            00810000
017300                                                VALUE ZERO.       00820000
017400     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            00830000
017500                                                VALUE ZERO.       00840000
017600     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00850000
017700                                                VALUE ZERO.       00860000
017800     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            00870000
017900                                                VALUE ZERO.       00880000
018000     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       00890000
018100                                                 COMP SYNC.       00900000
018200     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       00910000
018300                                                 COMP-3.          00920000
018400     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       00930000
018500                                                 COMP-3.          00940000
018600     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       00950000
018700                                                 COMP-3.          00960000
018800     05  PV-RESULT                    PIC S9(05)V99 VALUE ZERO    00970000
018900                                                 COMP-3.          00980000
019000     05  PV-DEPT                      PIC 9(03) VALUE ZEROS.      00990000
019100     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01010000
019200     05  PV-PREV-STORE-NAME           PIC X(25) VALUE SPACES.     01010136
019300     05  PV-OPER-ID                   PIC S9(04) COMP.            01030036
019400     05  PV-PREV-OPER-ID              PIC S9(04) COMP.            01040050
019500     05  PV-SAVE-OPER-ID              PIC S9(04) COMP.            01041060
019600     05  PV-DC-OPER                   PIC S9(04) COMP.            01042076
019700     05  PV-PREV-PROCESS-AREA         PIC X(06) VALUE SPACES.     01050036
019800     05  PV-PREV-PROCESS-GROUP        PIC X(06) VALUE SPACES.     01051069
019900     05  PV-UNIT-RETAIL               PIC X(14) VALUE SPACES.     01060000
020000     05  PV-OPER-DESC                 PIC X(05) VALUE SPACES.     01070000
020100     05  PV-STORE-CODE                PIC X(01) VALUE SPACES.     01071050
020200     05  PV-EXTENDED-RETAIL           PIC S9(12)V99.              01080000
020300     05  PV-EXTENDED-RETAIL-Z         PIC ZZZ,ZZZ,ZZZ.ZZ-         01090000
020400                                                 VALUE ZEROS.     01100000
020500     05  PV-UNT-WRKD-QTY              PIC S9(09) COMP.            01101074
020600                                                                  01110000
020700     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01120000
020800     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01130000
020900     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01140000
021000                                                                  01150000
021100     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01160000
021200     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01170000
021300     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01180000
021400     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01190000
021500     05  PV-DB2-YEAR                  PIC S9(08) COMP             01200000
021600                                          VALUE ZERO.             01210000
021700     05  PV-DB2-MONTH                 PIC S9(08) COMP             01220000
021800                                          VALUE ZERO.             01230000
021900     05  PV-DB2-DAY                   PIC S9(08) COMP             01240000
022000                                          VALUE ZERO.             01250000
022100     05  PV-DB2-HOUR                  PIC S9(08) COMP             01260000
022200                                          VALUE ZERO.             01270000
022300     05  PV-DB2-MINUTE                PIC S9(08) COMP             01280000
022400                                          VALUE ZERO.             01290000
022500     05  PV-DB2-SECOND                PIC S9(08) COMP             01300000
022600                                          VALUE ZERO.             01310000
022700                                                                  01320000
022800     05  PV-DIVIDEND                  PIC S9(03)V9999.            01330023
022900     05  PV-CURR-PERCENT              PIC S9(03)V99 VALUE +0      01340015
023000                                                 COMP.            01340115
023100     05  PV-PREV-PERCENT              PIC S9(03)V99 VALUE +0      01340215
023200                                                 COMP.            01340315
023300     05  PV-DIFF-PERCENT              PIC S9(03)V99 VALUE +0      01340415
023400                                                 COMP.            01340515
023500/                                                                 01340615
023600******************************************************************01341011
023700 01  PV-ECOMM-LINE.                                               01342041
023800     05  PV-CURR-ECOMM-UNITS          PIC S9(09) VALUE +0 COMP.   01350041
023900     05  PV-CURR-ECOMM-RETAIL         PIC S9(12) VALUE +0 COMP.   01360041
024000     05  PV-CURR-ECOMM-PO-RCVR        PIC S9(09) VALUE +0 COMP.   01370041
024100     05  PV-PREV-ECOMM-UNITS          PIC S9(09) VALUE +0 COMP.   01390041
024200     05  PV-PREV-ECOMM-RETAIL         PIC S9(12) VALUE +0 COMP.   01400041
024300     05  PV-PREV-ECOMM-PO-RCVR        PIC S9(09) VALUE +0 COMP.   01410041
024400     05  PV-DIFF-ECOMM-UNITS          PIC S9(09) VALUE +0 COMP.   01430041
024500     05  PV-DIFF-ECOMM-RETAIL         PIC S9(12) VALUE +0 COMP.   01430141
024600     05  PV-DIFF-ECOMM-PO-RCVR        PIC S9(09) VALUE +0 COMP.   01430241
024700     05  PV-CURR-CRSDCK-UNITS-ECOMM    PIC S9(09)V99 VALUE +0     01430979
024800                                             COMP.                01431041
024900     05  PV-CURR-CRSDCK-PERCENT-ECOMM  PIC S9(03)V99 VALUE +0     01431141
025000                                             COMP.                01431241
025100     05  PV-PREV-CRSDCK-UNITS-ECOMM    PIC S9(09)V99 VALUE +0     01431379
025200                                             COMP.                01431441
025300     05  PV-PREV-CRSDCK-PERCENT-ECOMM  PIC S9(03)V99 VALUE +0     01431541
025400                                             COMP.                01431641
025500     05  PV-DIFF-CRSDCK-UNITS-ECOMM    PIC S9(09)V99 VALUE +0     01431779
025600                                             COMP.                01431841
025700     05  PV-DIFF-CRSDCK-PERCENT-ECOMM  PIC S9(03)V99 VALUE +0     01431941
025800                                             COMP.                01432041
025900/                                                                 01432141
026000******************************************************************01432241
026100 01  PV-COMP-LINE.                                                01432341
026200     05  PV-CURR-COMP-UNITS           PIC S9(09) VALUE +0 COMP.   01432441
026300     05  PV-CURR-COMP-RETAIL          PIC S9(12) VALUE +0 COMP.   01432541
026400     05  PV-CURR-COMP-PO-RCVR         PIC S9(09) VALUE +0 COMP.   01432641
026500     05  PV-PREV-COMP-UNITS           PIC S9(09) VALUE +0 COMP.   01432741
026600     05  PV-PREV-COMP-RETAIL          PIC S9(12) VALUE +0 COMP.   01432841
026700     05  PV-PREV-COMP-PO-RCVR         PIC S9(09) VALUE +0 COMP.   01432941
026800     05  PV-DIFF-COMP-UNITS           PIC S9(09) VALUE +0 COMP.   01433041
026900     05  PV-DIFF-COMP-RETAIL          PIC S9(12) VALUE +0 COMP.   01433141
027000     05  PV-DIFF-COMP-PO-RCVR         PIC S9(09) VALUE +0 COMP.   01433241
027100/                                                                 01433341
027200******************************************************************01433441
027300 01  PV-DETAIL-LINE.                                              01433541
027400     05  PV-PROCESS-AREA              PIC X(06) VALUE SPACES.     01433605
027500     05  PV-PROCESS-GROUP             PIC X(06) VALUE SPACES.     01433769
027600                                                                  01434005
027700     05  PV-CURR-UNITS                PIC S9(09) VALUE +0 COMP.   01435005
027800     05  PV-CURR-RETAIL               PIC S9(12) VALUE +0 COMP.   01436005
027900     05  PV-CURR-PO-RCVR              PIC S9(09) VALUE +0 COMP.   01437005
028000     05  PV-PREV-UNITS                PIC S9(09) VALUE +0 COMP.   01440004
028100     05  PV-PREV-RETAIL               PIC S9(12) VALUE +0 COMP.   01460004
028200     05  PV-PREV-PO-RCVR              PIC S9(09) VALUE +0 COMP.   01470004
028300     05  PV-DIFF-UNITS                PIC S9(09) VALUE +0 COMP.   01490004
028400     05  PV-DIFF-RETAIL               PIC S9(12) VALUE +0 COMP.   01510004
028500     05  PV-DIFF-PO-RCVR              PIC S9(09) VALUE +0 COMP.   01520004
028600/                                                                 01530011
028700******************************************************************01540001
028800 01  PV-DC-TOTAL-LINE.                                            01550011
028900     05  PV-PROCESS                   PIC X(06) VALUE SPACES.     01550103
029000                                                                  01550201
029100     05  PV-CURR-DC-UNITS            PIC S9(09) VALUE +0 COMP.    01550311
029200     05  PV-CURR-DC-RETAIL           PIC S9(12) VALUE +0 COMP.    01550411
029300     05  PV-CURR-DC-PO-RCVR          PIC S9(09) VALUE +0 COMP.    01550511
029400     05  PV-PREV-DC-UNITS            PIC S9(09) VALUE +0 COMP.    01550711
029500     05  PV-PREV-DC-RETAIL           PIC S9(12) VALUE +0 COMP.    01550811
029600     05  PV-PREV-DC-PO-RCVR          PIC S9(09) VALUE +0 COMP.    01550911
029700     05  PV-DIFF-DC-UNITS            PIC S9(09) VALUE +0 COMP.    01551111
029800     05  PV-DIFF-DC-RETAIL           PIC S9(12) VALUE +0 COMP.    01551211
029900     05  PV-DIFF-DC-PO-RCVR          PIC S9(09) VALUE +0 COMP.    01551311
030000                                                                  01551401
030100******************************************************************01551505
030200 01  PV-CRSDCK-LINE.                                              01551605
030300     05  PV-CURR-CRSDCK-UNITS     PIC S9(09) VALUE +0 COMP.       01551905
030400     05  PV-PREV-CRSDCK-UNITS     PIC S9(09) VALUE +0 COMP.       01552005
030500     05  PV-DIFF-CRSDCK-UNITS     PIC S9(09) VALUE +0 COMP.       01553005
030600                                                                  01553105
030700     05  PV-CURR-CRSDCK-PERCENT   PIC S9(03)V99 VALUE +0          01553205
030800                                             COMP.                01553305
030900     05  PV-PREV-CRSDCK-PERCENT   PIC S9(03)V99 VALUE +0          01553405
031000                                             COMP.                01553505
031100     05  PV-DIFF-CRSDCK-PERCENT   PIC S9(03)V99 VALUE +0          01553605
031200                                             COMP.                01553705
031300                                                                  01553805
031400******************************************************************01553940
031500 01  PV-COMP-CRSDCK-LINE.                                         01554040
031600     05  PV-CURR-CRSDCK-UNITS-TOT     PIC S9(09) VALUE +0 COMP.   01554140
031700     05  PV-PREV-CRSDCK-UNITS-TOT     PIC S9(09) VALUE +0 COMP.   01554240
031800     05  PV-DIFF-CRSDCK-UNITS-TOT     PIC S9(09) VALUE +0 COMP.   01554340
031900                                                                  01554440
032000     05  PV-CURR-CRSDCK-UNITS-COMP    PIC S9(09) VALUE +0 COMP.   01554572
032100     05  PV-PREV-CRSDCK-UNITS-COMP    PIC S9(09) VALUE +0 COMP.   01554672
032200     05  PV-DIFF-CRSDCK-UNITS-COMP    PIC S9(09) VALUE +0 COMP.   01554772
032300                                                                  01554872
032400     05  PV-CURR-COMP-CRSDCK-PERCENT  PIC S9(03)V99 VALUE +0      01554972
032500                                             COMP.                01555072
032600     05  PV-PREV-COMP-CRSDCK-PERCENT  PIC S9(03)V99 VALUE +0      01555172
032700                                             COMP.                01555272
032800     05  PV-DIFF-COMP-CRSDCK-PERCENT  PIC S9(03)V99 VALUE +0      01555372
032900                                             COMP.                01555472
033000                                                                  01555572
033100 01  PV-ECOMM-CRSDCK-LINE.                                        01555672
033200     05  PV-CURR-ECOMM-CRSDCK-UNITS    PIC S9(09) VALUE +0 COMP.  01555772
033300     05  PV-PREV-ECOMM-CRSDCK-UNITS    PIC S9(09) VALUE +0 COMP.  01555872
033400     05  PV-DIFF-ECOMM-CRSDCK-UNITS    PIC S9(09) VALUE +0 COMP.  01555972
033500                                                                  01556072
033600     05  PV-CURR-ECOMM-CRSDCK-PERCENT  PIC S9(03)V99 VALUE +0     01556172
033700                                             COMP.                01556272
033800     05  PV-PREV-ECOMM-CRSDCK-PERCENT  PIC S9(03)V99 VALUE +0     01556372
033900                                             COMP.                01556472
034000     05  PV-DIFF-ECOMM-CRSDCK-PERCENT  PIC S9(03)V99 VALUE +0     01556572
034100                                             COMP.                01556672
034200/                                                                 01556772
034300******************************************************************01556872
034400 01  PV-FORMAT-DATE.                                              01556972
034500     05  PV-FORMAT-CCYY           PIC  X(04)   VALUE SPACES.      01557072
034600     05  FILLER                   PIC  X(01)   VALUE '/'.         01557172
034700     05  PV-FORMAT-MM             PIC  X(02)   VALUE SPACES.      01557272
034800     05  FILLER                   PIC  X(01)   VALUE '/'.         01558000
034900     05  PV-FORMAT-DD             PIC  X(02)   VALUE SPACES.      01559000
035000                                                                  01560000
035100 01  PV-ABEND-FIELDS.                                             01670000
035200     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01680000
035300                                                 COMP SYNC.       01690000
035400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'PCKRP014'.01700035
035500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01710000
035600     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    01720000
035700     05  PV-ABEND-STRUCTURE-1         PIC  X(8)  VALUE SPACES.    01730005
035800     05  PV-ABEND-STRUCTURE-2         PIC  X(8)  VALUE SPACES.    01740005
035900     05  PV-ABEND-STRUCTURE-3         PIC  X(8)  VALUE SPACES.    01750005
036000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01760000
036100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01770000
036200     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01780000
036300/                                                                 01790000
036400 01  PC-CONSTANTS.                                                01800000
036500     05  PC-PCKRP014                  PIC X(08) VALUE 'PCKRP014'. 01810001
036600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP014'. 01830001
036700     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 01840000
036800     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         01850000
036900                                                COMP-3.           01860000
037000/                                                                 01920000
037100******************************************************************01930000
037200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01940000
037300******************************************************************01950000
037400     COPY DPWS132O.                                               01960000
037500*                                                                 01970000
037600 01  HL-HEADING-LINE-1.                                           02049922
037700     05  FILLER                      PIC  X(39)  VALUE            02050022
037800      '** SPECIAL REQUESTED RUN **           '.                   02050122
037900     05  FILLER                      PIC  X(45)  VALUE            02050322
038000      'RECAP OF UNITS WORKED VERSUS PREVIOUS PERIOD'.             02050422
038100     05  FILLER                      PIC  X(36)  VALUE            02050521
038200      '                                  '.                       02050622
038300                                                                  02050721
038400 01  HL-HEADING-LINE-2A.                                          02051021
038500     05  FILLER                      PIC  X(17) VALUE             02060022
038600      '** REQUESTED BY: '.                                        02061022
038700     05  HL2A-USER-ID                PIC  X(08).                  02070055
038800     05  FILLER                      PIC  X(04)  VALUE ' ** '.    02080055
038900     05  FILLER                      PIC  X(13)  VALUE SPACES.    02090059
039000     05  FILLER                      PIC  X(28)  VALUE            02091055
039100      'CURRENT FISCAL MONTH ENDING '.                             02100055
039200     05  HL1C-MONTH-END-DATE.                                     02110055
039300         10  HL2A-MM                 PIC 99.                      02120055
039400         10  FILLER                  PIC X VALUE '/'.             02130000
039500         10  HL2A-DD                 PIC 99.                      02140055
039600         10  FILLER                  PIC X VALUE '/'.             02150000
039700         10  HL2A-YYYY               PIC 9(04).                   02160055
039800     05  FILLER                      PIC  X(47)  VALUE SPACES.    02250000
039900                                                                  02260000
040000 01  HL-HEADING-LINE-2B.                                          02270055
040100     05  FILLER                      PIC  X(17) VALUE             02280055
040200      '** REQUESTED BY: '.                                        02290055
040300     05  HL2B-USER-ID                PIC  X(08).                  02300055
040400     05  FILLER                      PIC  X(04)  VALUE ' ** '.    02301055
040500     05  FILLER                      PIC  X(13)  VALUE SPACES.    02320059
040600     05  FILLER                      PIC  X(27)  VALUE            02330055
040700      'CURRENT FISCAL WEEK ENDING '.                              02340055
040800     05  HL1C-WEEK-END-DATE.                                      02341055
040900         10  HL2B-MM                 PIC 99.                      02342055
041000         10  FILLER                  PIC X VALUE '/'.             02342155
041100         10  HL2B-DD                 PIC 99.                      02342255
041200         10  FILLER                  PIC X VALUE '/'.             02342355
041300         10  HL2B-YYYY               PIC 9(04).                   02342455
041400     05  FILLER                      PIC  X(47)  VALUE SPACES.    02342555
041500                                                                  02342655
041600 01  HL-HEADING-LINE-2C.                                          02342755
041700     05  FILLER                      PIC  X(17) VALUE             02342855
041800      '** REQUESTED BY: '.                                        02342955
041900     05  HL2C-USER-ID                PIC  X(08).                  02343055
042000     05  FILLER                      PIC  X(02)  VALUE '**'.      02343157
042100     05  FILLER                      PIC  X(10)  VALUE SPACES.    02343357
042200     05  FILLER                      PIC  X(19)  VALUE            02343455
042300      'CURRENT DATE RANGE '.                                      02343555
042400     05  HL2C-FROM-DATE.                                          02343655
042500         10  HL2C-FROM-MM            PIC 99.                      02343755
042600         10  FILLER                  PIC X VALUE '/'.             02343855
042700         10  HL2C-FROM-DD            PIC 99.                      02343955
042800         10  FILLER                  PIC X VALUE '/'.             02344055
042900         10  HL2C-FROM-YYYY          PIC 9(04).                   02344155
043000     05  FILLER                      PIC X(09)  VALUE             02344255
043100                          ' THROUGH '.                            02344355
043200     05  HL2C-TO-DATE.                                            02344455
043300         10  HL2C-TO-MM              PIC 99.                      02344555
043400         10  FILLER                  PIC X VALUE '/'.             02344655
043500         10  HL2C-TO-DD              PIC 99.                      02344755
043600         10  FILLER                  PIC X VALUE '/'.             02344855
043700         10  HL2C-TO-YYYY            PIC 9(04).                   02344955
043800     05  FILLER                      PIC  X(47)  VALUE SPACES.    02345055
043900                                                                  02345155
044000 01  HL-HEADING-LINE-2D.                                          02345255
044100     05  FILLER                      PIC  X(17) VALUE             02345355
044200      '** REQUESTED BY: '.                                        02345455
044300     05  HL2D-USER-ID                PIC  X(08).                  02345555
044400     05  FILLER                      PIC  X(04)  VALUE ' ** '.    02345655
044500     05  FILLER                      PIC  X(16)  VALUE SPACES.    02345855
044600     05  FILLER                      PIC  X(22)  VALUE            02345955
044700      'CURRENT BUSINESS DATE '.                                   02346055
044800     05  HL1D-BUSINESS-DATE.                                      02346155
044900         10  HL2D-MM                 PIC 99.                      02346255
045000         10  FILLER                  PIC X VALUE '/'.             02346355
045100         10  HL2D-DD                 PIC 99.                      02346455
045200         10  FILLER                  PIC X VALUE '/'.             02346555
045300         10  HL2D-YYYY               PIC 9(04).                   02346655
045400     05  FILLER                      PIC  X(47)  VALUE SPACES.    02346755
045500                                                                  02346855
045600 01  HL-HEADING-LINE-3A.                                          02346955
045700     05  FILLER                      PIC  X(21)  VALUE            02347055
045800            'RECEIVING LOCATION - '.                              02347155
045900     05  HL2-LOCATION.                                            02347200
046000         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     02347300
046100         10  FILLER                  PIC  X(01) VALUE SPACES.     02348000
046200         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     02349000
046300     05  FILLER                      PIC  X(57) VALUE SPACES.     02349335
046400                                                                  02349400
046500 01  HL-HEADING-LINE-3B.                                          02351055
046600     05  FILLER                      PIC  X(44)  VALUE            02360000
046700           '                                           '.         02370000
046800     05  FILLER                      PIC  X(44)  VALUE            02380000
046900           '                                           '.         02390000
047000     05  FILLER                      PIC  X(44)  VALUE            02400000
047100           '                                            '.        02410000
047200                                                                  02420000
047300 01  HL-HEADING-LINE-4A.                                          02501054
047400     05  FILLER                      PIC  X(06).                  02502052
047500     05  FILLER                      PIC  X(26)  VALUE            02503056
047600           ' --- CURRENT FISCAL MONTH '.                          02504059
047700     05  HL4A-CURR-MM-YYYY.                                       02505052
047800         10  HL4A-CURR-MM            PIC  X(02).                  02506052
047900         10  FILLER                  PIC  X(01) VALUE '/'.        02507052
048000         10  HL4A-CURR-YYYY          PIC  X(04).                  02508052
048100     05  FILLER                      PIC  X(11)  VALUE            02509052
048200           ' ------  --'.                                         02509159
048300     05  FILLER                      PIC  X(25)  VALUE            02509259
048400           '-- PREVIOUS FISCAL MONTH '.                           02509359
048500     05  HL4A-PREV-MM-YYYY.                                       02509452
048600         10  HL4A-PREV-MM            PIC  X(02).                  02509552
048700         10  FILLER                  PIC  X(01)  VALUE '/'.       02509652
048800         10  HL4A-PREV-YYYY          PIC  X(04).                  02509752
048900     05  FILLER                      PIC  X(10)  VALUE            02509852
049000           ' ----  ---'.                                          02509959
049100     05  FILLER                      PIC  X(11)  VALUE            02510059
049200           '---------- '.                                         02511059
049300     05  FILLER                      PIC  X(26)  VALUE            02512052
049400           'DIFFERENCE ---------------'.                          02513052
049500                                                                  02514052
049600 01  HL-HEADING-LINE-4B.                                          02515052
049700     05  FILLER                      PIC  X(06).                  02516052
049800     05  FILLER                      PIC  X(26)  VALUE            02517055
049900           ' ---- CURRENT FISCAL WEEK '.                          02518055
050000     05  HL4B-CURR-WW-YYYY.                                       02519052
050100         10  HL4B-CURR-WW            PIC  X(02).                  02519152
050200         10  FILLER                  PIC  X(01) VALUE '/'.        02519252
050300         10  HL4B-CURR-YYYY          PIC  X(04).                  02519352
050400     05  FILLER                      PIC  X(08)  VALUE            02519455
050500           ' ------ '.                                            02519555
050600     05  FILLER                      PIC  X(24)  VALUE            02519652
050700           ' -------- PREVIOUS WEEK '.                            02519752
050800     05  HL4B-PREV-WW-YYYY.                                       02519852
050900         10  HL4B-PREV-WW            PIC  X(02).                  02519952
051000         10  FILLER                  PIC  X(01)  VALUE '/'.       02520052
051100         10  HL4B-PREV-YYYY          PIC  X(04).                  02520152
051200     05  FILLER                      PIC  X(10)  VALUE            02520252
051300           ' -------- '.                                          02520352
051400     05  FILLER                      PIC  X(17)  VALUE            02520452
051500           ' --------------- '.                                   02520552
051600     05  FILLER                      PIC  X(26)  VALUE            02520652
051700           'DIFFERENCE ---------------'.                          02520752
051800                                                                  02520852
051900 01  HL-HEADING-LINE-4C.                                          02520954
052000     05  FILLER                      PIC  X(07).                  02521059
052100     05  FILLER                      PIC  X(13)  VALUE            02521154
052200           '- CURR RANGE '.                                       02521254
052300     05  HL4C-CURR-TO-DATE.                                       02521354
052400         10  HL4C-CURR-FROM-MM       PIC  X(02).                  02521455
052500         10  FILLER                  PIC  X(01) VALUE '/'.        02521554
052600         10  HL4C-CURR-FROM-DD       PIC  X(02).                  02521655
052700         10  FILLER                  PIC  X(01) VALUE '/'.        02521754
052800         10  HL4C-CURR-FROM-YYYY     PIC  X(04).                  02521855
052900     05  FILLER                      PIC  X(04)  VALUE            02521954
053000           ' TO '.                                                02522054
053100     05  HL4C-CURR-FROM-DATE.                                     02522154
053200         10  HL4C-CURR-TO-MM         PIC  X(02).                  02522255
053300         10  FILLER                  PIC  X(01) VALUE '/'.        02522354
053400         10  HL4C-CURR-TO-DD         PIC  X(02).                  02522455
053500         10  FILLER                  PIC  X(01) VALUE '/'.        02522554
053600         10  HL4C-CURR-TO-YYYY       PIC  X(04).                  02522655
053700     05  FILLER                      PIC  X(03)  VALUE            02522754
053800           ' - '.                                                 02522854
053900     05  FILLER                      PIC  X(14)  VALUE            02522955
054000           ' - PREV RANGE '.                                      02523054
054100     05  HL4C-PREV-TO-DATE.                                       02523154
054200         10  HL4C-PREV-FROM-MM       PIC  X(02).                  02523255
054300         10  FILLER                  PIC  X(01) VALUE '/'.        02523354
054400         10  HL4C-PREV-FROM-DD       PIC  X(02).                  02523455
054500         10  FILLER                  PIC  X(01) VALUE '/'.        02523554
054600         10  HL4C-PREV-FROM-YYYY     PIC  X(04).                  02523655
054700     05  FILLER                      PIC  X(04)  VALUE            02523754
054800           ' TO '.                                                02523854
054900     05  HL4C-PREV-FROM-DATE.                                     02523954
055000         10  HL4C-PREV-TO-MM         PIC  X(02).                  02524055
055100         10  FILLER                  PIC  X(01) VALUE '/'.        02524154
055200         10  HL4C-PREV-TO-DD         PIC  X(02).                  02524255
055300         10  FILLER                  PIC  X(01) VALUE '/'.        02524354
055400         10  HL4C-PREV-TO-YYYY       PIC  X(04).                  02524455
055500     05  FILLER                      PIC  X(03)  VALUE            02524554
055600           ' - '.                                                 02524654
055700     05  FILLER                      PIC  X(17)  VALUE            02524754
055800           ' --------------- '.                                   02524854
055900     05  FILLER                      PIC  X(26)  VALUE            02524954
056000           'DIFFERENCE ---------------'.                          02525054
056100                                                                  02525154
056200 01  HL-HEADING-LINE-4D.                                          02525254
056300     05  FILLER                      PIC  X(06).                  02525354
056400     05  FILLER                      PIC  X(25)  VALUE            02525454
056500           '-- CURRENT BUSINESS DATE '.                           02525554
056600     05  HL4D-CURR-DATE.                                          02525654
056700         10  HL4D-CURR-MM            PIC  X(02).                  02525754
056800         10  FILLER                  PIC  X(01) VALUE '/'.        02525854
056900         10  HL4D-CURR-DD            PIC  X(02).                  02525954
057000         10  FILLER                  PIC  X(01) VALUE '/'.        02526054
057100         10  HL4D-CURR-YYYY          PIC  X(04).                  02526154
057200     05  FILLER                      PIC  X(05)  VALUE            02526254
057300           ' --- '.                                               02526354
057400     05  FILLER                      PIC  X(28)  VALUE            02526454
057500           ' -- PREVIOUS BUSINESS DATE '.                         02526554
057600     05  HL4D-PREV-DATE.                                          02526654
057700         10  HL4D-PREV-MM            PIC  X(02).                  02526754
057800         10  FILLER                  PIC  X(01) VALUE '/'.        02526854
057900         10  HL4D-PREV-DD            PIC  X(02).                  02526954
058000         10  FILLER                  PIC  X(01) VALUE '/'.        02527054
058100         10  HL4D-PREV-YYYY          PIC  X(04).                  02527154
058200     05  FILLER                      PIC  X(04) VALUE             02527254
058300           ' -- '.                                                02527354
058400     05  FILLER                      PIC  X(17)  VALUE            02527454
058500           ' --------------- '.                                   02527554
058600     05  FILLER                      PIC  X(26)  VALUE            02527654
058700           'DIFFERENCE ---------------'.                          02527754
058800                                                                  02527854
058900 01  HL-HEADING-LINE-5.                                           02527954
059000     05  FILLER                      PIC  X(44)  VALUE            02528054
059100           'PROCESS  QUANTITY   RETAIL DOLLAR    PO/RCVR'.        02530003
059200     05  FILLER                      PIC  X(44)  VALUE            02540003
059300           'S     QUANTITY   RETAIL DOLLAR    PO/RCVRS  '.        02550003
059400     05  FILLER                      PIC  X(44)  VALUE            02560003
059500           '   QUANTITY    RETAIL DOLLAR    PO/RCVRS    '.        02570012
059600                                                                  02580000
059700 01  HL-HEADING-LINE-6.                                           02590000
059800     05  FILLER                      PIC  X(44)  VALUE            02600003
059900           ' AREA     WORKED        WORKED        WORKED'.        02601003
060000     05  FILLER                      PIC  X(44)  VALUE            02611003
060100           '       WORKED        WORKED        WORKED   '.        02612003
060200     05  FILLER                      PIC  X(44)  VALUE            02640000
060300           '    WORKED         WORKED        WORKED     '.        02650012
060400                                                                  02660000
060500 01  HL-HEADING-LINE-7.                                           02661003
060600     05  FILLER                      PIC  X(44)  VALUE            02662003
060700           '------ ----------- --------------- ---------'.        02663018
060800     05  FILLER                      PIC  X(44)  VALUE            02664003
060900           '--  ----------- --------------- ----------- '.        02665018
061000     05  FILLER                      PIC  X(44)  VALUE            02666003
061100           ' ------------ ---------------- ------------ '.        02667018
061200                                                                  02668003
061300 01  HL-HEADING-LINE-8.                                           02669016
061400     05  FILLER                      PIC  X(44)  VALUE            02669116
061500           '       ----------- --------------- ---------'.        02669218
061600     05  FILLER                      PIC  X(44)  VALUE            02669316
061700           '--  ----------- --------------- ----------- '.        02669418
061800     05  FILLER                      PIC  X(44)  VALUE            02669516
061900           ' ------------ ---------------- ------------ '.        02669618
062000                                                                  02669716
062100 01  DL-DETAIL-LINE-1.                                            02670000
062200     05  DL1-PROCESS-AREA             PIC X(06).                  02680005
062300     05  FILLER                       PIC X(01) VALUE SPACES.     02690000
062400     05  DL1-CURRENT-UNITS            PIC ZZZ,ZZZ,ZZ9.            02700012
062500     05  FILLER                       PIC X(01) VALUE SPACES.     02710000
062600     05  DL1-CURRENT-RETAIL           PIC ZZZ,ZZZ,ZZZ,ZZ9.        02720014
062700     05  FILLER                       PIC X(01) VALUE SPACES.     02730008
062800     05  DL1-CURRENT-PO-RCVR          PIC ZZZ,ZZZ,ZZ9.            02740012
062900     05  FILLER                       PIC X(02) VALUE SPACES.     02750000
063000     05  DL1-PREVIOUS-UNITS           PIC ZZZ,ZZZ,ZZ9.            02760012
063100     05  FILLER                       PIC X(01) VALUE SPACES.     02770000
063200     05  DL1-PREVIOUS-RETAIL          PIC ZZZ,ZZZ,ZZZ,ZZ9.        02780014
063300     05  FILLER                       PIC X(01) VALUE SPACES.     02790008
063400     05  DL1-PREVIOUS-PO-RCVR         PIC ZZZ,ZZZ,ZZ9.            02800012
063500     05  FILLER                       PIC X(02) VALUE SPACES.     02810000
063600     05  DL1-DIFFERENCE-UNITS         PIC ZZZ,ZZZ,ZZ9-.           02820018
063700     05  FILLER                       PIC X(01) VALUE SPACES.     02830003
063800     05  DL1-DIFFERENCE-RETAIL        PIC ZZZ,ZZZ,ZZZ,ZZ9-.       02840018
063900     05  FILLER                       PIC X(01) VALUE SPACES.     02850008
064000     05  DL1-DIFFERENCE-PO-RCVR       PIC ZZZ,ZZZ,ZZ9-.           02860018
064100                                                                  02930000
064200 01  TL1-DC-LINE.                                                 02940005
064300     05  FILLER                       PIC X(07) VALUE             02950008
064400         'DC TOT '.                                               02960003
064500     05  TL1-CURRENT-UNITS            PIC ZZZ,ZZZ,ZZ9.            02970012
064600     05  FILLER                       PIC X(01) VALUE SPACES.     02971003
064700     05  TL1-CURRENT-RETAIL           PIC ZZZ,ZZZ,ZZZ,ZZ9.        02972014
064800     05  FILLER                       PIC X(01) VALUE SPACES.     02973003
064900     05  TL1-CURRENT-PO-RCVR          PIC ZZZ,ZZZ,ZZ9.            02974012
065000     05  FILLER                       PIC X(02) VALUE SPACES.     02975003
065100     05  TL1-PREVIOUS-UNITS           PIC ZZZ,ZZZ,ZZ9.            02976012
065200     05  FILLER                       PIC X(01) VALUE SPACES.     02977003
065300     05  TL1-PREVIOUS-RETAIL          PIC ZZZ,ZZZ,ZZZ,ZZ9.        02978014
065400     05  FILLER                       PIC X(01) VALUE SPACES.     02979008
065500     05  TL1-PREVIOUS-PO-RCVR         PIC ZZZ,ZZZ,ZZ9.            02979112
065600     05  FILLER                       PIC X(02) VALUE SPACES.     02979203
065700     05  TL1-DIFFERENCE-UNITS         PIC ZZZ,ZZZ,ZZ9-.           02979318
065800     05  FILLER                       PIC X(01) VALUE SPACES.     02979403
065900     05  TL1-DIFFERENCE-RETAIL        PIC ZZZ,ZZZ,ZZZ,ZZ9-.       02979568
066000     05  FILLER                       PIC X(01) VALUE SPACES.     02979658
066100     05  TL1-DIFFERENCE-PO-RCVR       PIC ZZZ,ZZZ,ZZ9-.           02979718
066200                                                                  02980000
066300 01  TL2-CRSDCK-LINE.                                             02991015
066400     05  FILLER                       PIC X(07) VALUE             03000000
066500         'CRSDCK '.                                               03010003
066600     05  TL2-CURR-CRSDCK-UNITS        PIC ZZZ,ZZZ,ZZ9.            03020017
066700     05  FILLER                       PIC X(30) VALUE SPACES.     03030016
066800     05  TL2-PREV-CRSDCK-UNITS        PIC ZZZ,ZZZ,ZZ9.            03040017
066900     05  FILLER                       PIC X(30) VALUE SPACES.     03050022
067000     05  TL2-DIFF-CRSDCK-UNITS        PIC ZZZ,ZZZ,ZZ9-.           03060016
067100     05  FILLER                       PIC X(25) VALUE SPACES.     03070003
067200                                                                  03260000
067300 01  TL3-CRSDCK-PERCENT-LINE.                                     03260115
067400     05  FILLER                       PIC X(10) VALUE             03260216
067500         '         ('.                                            03260316
067600     05  TL3-CURR-CRSDCK-PERCENT      PIC ZZZ.99.                 03260415
067700     05  FILLER                       PIC X(02) VALUE '%)'.       03260516
067800     05  FILLER                       PIC X(32) VALUE SPACES.     03260616
067900     05  FILLER                       PIC X(01) VALUE '('.        03260715
068000     05  TL3-PREV-CRSDCK-PERCENT      PIC ZZZ.99.                 03260815
068100     05  FILLER                       PIC X(02) VALUE '%)'.       03260916
068200     05  FILLER                       PIC X(31) VALUE SPACES.     03261022
068300     05  FILLER                       PIC X(01) VALUE '('.        03261115
068400     05  TL3-DIFF-CRSDCK-PERCENT      PIC ZZZ.99-.                03261216
068500     05  FILLER                       PIC X(02) VALUE '%)'.       03261316
068600     05  FILLER                       PIC X(24) VALUE SPACES.     03261416
068700                                                                  03261515
068800 01  TL4-COMP-ALL-LINE.                                           03261615
068900     05  FILLER                       PIC X(07) VALUE             03262005
069000         'TOTAL  '.                                               03263005
069100     05  TL4-CURRENT-UNITS            PIC ZZZ,ZZZ,ZZ9.            03264012
069200     05  FILLER                       PIC X(01) VALUE SPACES.     03265005
069300     05  TL4-CURRENT-RETAIL           PIC ZZZ,ZZZ,ZZZ,ZZ9.        03266068
069400     05  FILLER                       PIC X(01) VALUE SPACES.     03267005
069500     05  TL4-CURRENT-PO-RCVR          PIC ZZZ,ZZZ,ZZ9.            03268012
069600     05  FILLER                       PIC X(02) VALUE SPACES.     03269005
069700     05  TL4-PREVIOUS-UNITS           PIC ZZZ,ZZZ,ZZ9.            03269112
069800     05  FILLER                       PIC X(01) VALUE SPACES.     03269205
069900     05  TL4-PREVIOUS-RETAIL          PIC ZZZ,ZZZ,ZZZ,ZZ9.        03269368
070000     05  FILLER                       PIC X(01) VALUE SPACES.     03269408
070100     05  TL4-PREVIOUS-PO-RCVR         PIC ZZZ,ZZZ,ZZ9.            03269512
070200     05  FILLER                       PIC X(02) VALUE SPACES.     03269605
070300     05  TL4-DIFFERENCE-UNITS         PIC ZZZ,ZZZ,ZZ9-.           03269764
070400     05  FILLER                       PIC X(01) VALUE SPACES.     03269805
070500     05  TL4-DIFFERENCE-RETAIL        PIC ZZZ,ZZZ,ZZZ,ZZ9-.       03269968
070600     05  FILLER                       PIC X(01) VALUE SPACES.     03270058
070700     05  TL4-DIFFERENCE-PO-RCVR       PIC ZZZ,ZZZ,ZZ9-.           03270164
070800                                                                  03270305
070900 01  ER-END-OF-REPORT-LINE.                                       03271000
071000     05  FILLER                       PIC X(19)  VALUE            03280000
071100         '** END OF REPORT **'.                                   03290000
071200     05  FILLER                       PIC X(113)  VALUE SPACES.   03300000
071300                                                                  03310000
071400 01  EP-EMPTY-REPORT-LINE.                                        03320000
071500     05  FILLER                       PIC X(34)  VALUE SPACES.    03330000
071600     05  FILLER                       PIC X(52)  VALUE            03340000
071700      '*************** EMPTY INPUT FILE *******************'.     03350000
071800     05  FILLER                       PIC X(49)  VALUE SPACES.    03360000
071900                                                                  03370000
072000 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    03380000
072100                                                                  03390000
072200 01  EL1-ERROR-LINE-1P.                                           03400000
072300     05  FILLER                      PIC  X(02)     VALUE SPACES. 03410000
072400     05  FILLER                      PIC  X(48)     VALUE         03420000
072500         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03430000
072600     05  FILLER                      PIC  X(49)     VALUE         03440000
072700         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     03450000
072800     05  FILLER                      PIC  X(33)     VALUE         03460000
072900         'COMPLETED.                       '.                     03470000
073000                                                                  03480000
073100 01  EL2-ERROR-LINE-2F.                                           03490000
073200     05  FILLER                      PIC  X(02)     VALUE SPACES. 03500000
073300     05  FILLER                      PIC  X(36)     VALUE         03510000
073400         'NONE OF YOUR REPORTS WERE CREATED.  '.                  03520000
073500     05  FILLER                      PIC  X(36)     VALUE         03530000
073600         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  03540000
073700     05  FILLER                      PIC  X(58)     VALUE SPACES. 03550000
073800                                                                  03560000
073900 01  EL3-ERROR-LINE-3.                                            03570000
074000     05  FILLER                      PIC  X(02)     VALUE SPACES. 03580000
074100     05  FILLER                      PIC  X(50)     VALUE         03590000
074200         'YOUR REQUEST WAS AS FOLLOWS:                      '.    03591000
074300     05  FILLER                      PIC  X(81)     VALUE SPACES. 03592000
074400                                                                  03593000
074500 01  EL4-ERROR-LINE-4.                                            03593100
074600     05  FILLER                      PIC  X(02)     VALUE SPACES. 03593200
074700     05  FILLER                      PIC  X(18)     VALUE         03593300
074800         'REQUESTOR       : '.                                    03593400
074900     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 03593500
075000     05  FILLER                      PIC  X(07)     VALUE SPACES. 03593600
075100     05  FILLER                      PIC  X(21)     VALUE         03593700
075200         'PRINTER DESTINATION: '.                                 03593800
075300     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 03593900
075400     05  FILLER                      PIC  X(65)     VALUE SPACES. 03594000
075500                                                                  03594100
075600 01  EL5-ERROR-LINE-5B.                                           03594200
075700     05  FILLER                      PIC  X(02)     VALUE SPACES. 03594300
075800     05  FILLER                      PIC  X(18)     VALUE         03594400
075900         'START DATE RANGE: '.                                    03594500
076000     05  EL5-START-DATE-RANGE        PIC  X(10).                  03594600
076100     05  FILLER                      PIC  X(07)     VALUE SPACES. 03594700
076200     05  FILLER                      PIC  X(21)     VALUE         03594800
076300         'END DATE RANGE     : '.                                 03594900
076400     05  EL5-END-DATE-RANGE          PIC  X(10).                  03595000
076500     05  FILLER                      PIC  X(20)     VALUE SPACES. 03595100
076600                                                                  03595235
076700 01  SL-SUMMARY-LINE-1.                                           03595335
076800     05  SL-LOCATION.                                             03595435
076900         10  SL-OPER-ID              PIC  X(04) VALUE SPACES.     03595576
077000         10  FILLER                  PIC  X(01) VALUE SPACES.     03595635
077100         10  SL-LOC-DESC             PIC  X(25) VALUE SPACES.     03595735
077200         10  FILLER                  PIC  X(102) VALUE SPACES.    03595837
077300/                                                                 03597037
077400******************************************************************03597137
077500*  COPYBOOK USED BY MBS SYSTEM                                    03597237
077600******************************************************************03597337
077700     COPY DPWS003.                                                03597437
077800*                                                                 03597537
077900******************************************************************03597637
078000*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03597737
078100******************************************************************03597837
078200     COPY DPWS024.                                                03597937
078300/                                                                 03598000
078400******************************************************************03599000
078500*  DB2 FORMATTED MESSAGE AREA                                     03600000
078600******************************************************************03610000
078700     COPY DPWS004.                                                03620000
078800/                                                                 03630000
078900******************************************************************03640000
079000* CORPORATE DATE ROUTINES                                         03650000
079100******************************************************************03660000
079200     COPY DPWS500.                                                03670000
079300/                                                                 03680000
079400******************************************************************03690000
079500*  RECORD LAYOUT FOR INPUT FILE                                   03700000
079600******************************************************************03710000
079700     COPY PCRD012.                                                03720000
079800/                                                                 03730000
079900*    LOCATION MODULE                                              04001013
080000     COPY XLWS071.                                                04002013
080100/                                                                 04000002
080200******************************************************************03740000
080300*   DB2 SQL COMMUNICATION AREA                                    03750000
080400******************************************************************03760000
080500     EXEC SQL                                                     03770000
080600         INCLUDE SQLCA                                            03780000
080700     END-EXEC.                                                    03790000
080800*                                                                 03800000
080900     COPY SQLCA2.                                                 03810000
081000*                                                                 03820000
081100/                                                                 03900009
081200****************************************************************  03910009
081300*  DATE TABLE.                                                    03920009
081400****************************************************************  03930009
081500     EXEC SQL                                                     03940009
081600         INCLUDE TDTATTR                                          03950009
081700     END-EXEC.                                                    03960009
081800/                                                                 03970009
081900****************************************************************  03971074
082000*  SUM WORKED TABLE.                                              03972074
082100****************************************************************  03973074
082200     EXEC SQL                                                     03974074
082300         INCLUDE PCT00005                                         03975074
082400     END-EXEC.                                                    03976074
082500/                                                                 03977074
082600****************************************************************  03978074
082700*  PROCESS AREA ASSIGNED TABLE.                                   03979074
082800****************************************************************  03979174
082900     EXEC SQL                                                     03979274
083000         INCLUDE PCT00003                                         03979374
083100     END-EXEC.                                                    03979474
083200/                                                                 03979574
083300******************************************************************03980000
083400 PROCEDURE DIVISION.                                              03990000
083500******************************************************************04000000
083600 0000-MAINLINE.                                                   04010000
083700                                                                  04020000
083800     ACCEPT PC239-CONTROL-CARD FROM SYSIN.                        04030000
083900     DISPLAY 'CONTROL CARD = ' PC239-CONTROL-CARD.                04040000
084000                                                                  04050000
084100     IF CC-RPT-PCKRP014                                           04060003
084200         OPEN INPUT  EXTRACT-FILE                                 04070000
084300         IF CC-ROUTE-TO-RDS                                       04080000
084400            OPEN OUTPUT REPORT-FILE-1                             04090000
084500         ELSE                                                     04100000
084600            OPEN OUTPUT REPORT-FILE-2                             04110000
084700         END-IF                                                   04120000
084800                                                                  04130000
084900         PERFORM 2100-READ-EXTRACT                                04140000
085000         PERFORM 1000-INITIALIZE                                  04141000
085100                                                                  04150000
085200         IF PC012-RCD-TYPE-ERROR                                  04160000
085300             PERFORM 7000-WRITE-ERROR-REPORT                      04170000
085400         ELSE                                                     04180000
085500             PERFORM 2500-PROCESS-B-RECORDS                       04230011
085600                 UNTIL PS-END-B-RECORD                            04230111
085700*            MOVE PV-OPER-ID          TO PV-PREV-OPER-ID          04230243
085800             PERFORM 2600-PROCESS-D-RECORDS                       04234011
085900                 UNTIL PS-END-D-RECORD                            04235011
086000             SET PS-NOT-END-D-RECORD  TO TRUE                     04236011
086100             MOVE PV-PROCESS-AREA     TO PV-PREV-PROCESS-AREA     04237015
086200             MOVE PV-PROCESS-GROUP    TO PV-PREV-PROCESS-GROUP    04237169
086300             PERFORM 8000-WRITE-MAIN-HEADINGS                     04237224
086400             PERFORM 8100-WRITE-SUB-HEADINGS                      04238024
086500             MOVE PV-OPER-ID          TO PV-PREV-OPER-ID          04238136
086600             MOVE PV-STORE-NAME       TO PV-PREV-STORE-NAME       04238236
086700             SET DC-NDX TO 1                                      04239036
086800             PERFORM 2000-PROCESS-EXTRACT                         04240000
086900                 UNTIL PS-END-OF-INPUT                            04250000
087000             PERFORM 1450-DETAIL-DIFFERENCE                       04250225
087100             PERFORM 2200-CHECK-CRSDCK                            04250425
087200             PERFORM 3000-PRINT-DETAILS                           04250525
087300             IF CC-OPER-ALL                                       04250725
087400                 PERFORM 3300-COMPANY-TOTALS                      04250827
087500             ELSE                                                 04250925
087600                 PERFORM 1460-DC-TOTAL-DIFFERENCE                 04251040
087700                 PERFORM 3100-PRINT-DC-TOTALS                     04251125
087800                 PERFORM 1100-LOAD-DC-TABLE                       04251436
087900             END-IF                                               04252025
088000             SET PS-SUMMARY-YES      TO TRUE                      04252136
088100             PERFORM 8000-WRITE-MAIN-HEADINGS                     04252236
088200             PERFORM 8100-WRITE-SUB-HEADINGS                      04252336
088300             PERFORM 1110-BUILD-SUMMARY                           04253036
088400             PERFORM 1120-SUMMARY-ALL                             04253137
088500             PERFORM 2260-ECOMM-CRSDCK                            04253241
088600             IF CC-OPER-ALL OR CC-OPER-EXTRACT-ALL                04253363
088700                 OR PS-CRSDCK-YES                                 04253463
088800                 PERFORM 1130-SUMMARY-MINUS-ECOMM                 04253563
088900             END-IF                                               04253663
089000             PERFORM 9000-EOJ                                     04261000
089100         END-IF                                                   04270000
089200      END-IF.                                                     04290000
089300                                                                  04290167
089400      IF CC-ROUTE-TO-RDS                                          04291067
089500         NEXT SENTENCE                                            04292067
089600      ELSE                                                        04293067
089700         MOVE +1 TO RETURN-CODE                                   04294067
089800      END-IF.                                                     04295067
089900                                                                  04300000
090000     GOBACK.                                                      04330000
090100                                                                  04340037
090200******************************************************************04350000
090300 1000-INITIALIZE.                                                 04360000
090400******************************************************************04370000
090500*                                                                 04380000
090600* LOAD SYSTEM DATE INTO HEADINGS                                  04390000
090700     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04400000
090800     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04410000
090900                                                                  04420000
091000     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04430000
091100     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04440000
091200     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04450000
091300     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04460000
091400     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04470000
091500                                                                  04480000
091600     MOVE PC-CURRENT-PROGRAM-NAME                                 04490000
091700                                 TO DP132O-PROGRAM-NAME.          04500000
091800     MOVE 1                      TO DP132O-REPORT-NUMBER          04510000
091900                                    DP132O-PAGE-NUMBER.           04520000
092000                                                                  04600000
092100*                                                                 04720000
092200***************************************************************** 04720129
092300* LOAD TABLE WITH DC TOTAL RECORDS (PC012-RCD-TYPE-DC-TOT-SUM).   04720229
092400* THESE RECORDS WILL BE USED IN THE CORPORATE SUMMARY PART OF THE 04720331
092500* REPORT.                                                         04720429
092600***************************************************************** 04720529
092700 1100-LOAD-DC-TABLE.                                              04720629
092800                                                                  04720729
092900     IF DC-NDX < 50                                               04721135
093000         MOVE PV-PREV-OPER-ID        TO DC-NUMBER(DC-NDX)         04721336
093100         MOVE PV-PREV-STORE-NAME     TO DC-NAME(DC-NDX)           04721636
093200         MOVE PV-CURR-DC-UNITS       TO DC-CURR-UNITS(DC-NDX)     04721836
093300         MOVE PV-CURR-DC-RETAIL      TO DC-CURR-RETAIL(DC-NDX)    04721936
093400         MOVE PV-CURR-DC-PO-RCVR     TO DC-CURR-PO-RCVR(DC-NDX)   04722036
093500         MOVE PV-PREV-DC-UNITS       TO DC-PREV-UNITS(DC-NDX)     04722136
093600         MOVE PV-PREV-DC-RETAIL      TO DC-PREV-RETAIL(DC-NDX)    04722236
093700         MOVE PV-PREV-DC-PO-RCVR     TO DC-PREV-PO-RCVR(DC-NDX)   04722336
093800         MOVE PV-DIFF-DC-UNITS       TO DC-DIFF-UNITS(DC-NDX)     04722436
093900         MOVE PV-DIFF-DC-RETAIL      TO DC-DIFF-RETAIL(DC-NDX)    04722536
094000         MOVE PV-DIFF-DC-PO-RCVR     TO DC-DIFF-PO-RCVR(DC-NDX)   04722636
094100         MOVE PV-CURR-CRSDCK-UNITS-TOT TO DC-CURR-CRSDCK(DC-NDX)  04722771
094200         MOVE PV-CURR-CRSDCK-PERCENT   TO DC-CURR-PERCENT(DC-NDX) 04722871
094300         MOVE PV-PREV-CRSDCK-UNITS-TOT TO DC-PREV-CRSDCK(DC-NDX)  04722971
094400         MOVE PV-PREV-CRSDCK-PERCENT   TO DC-PREV-PERCENT(DC-NDX) 04723071
094500         MOVE PV-DIFF-CRSDCK-UNITS-TOT TO DC-DIFF-CRSDCK(DC-NDX)  04723171
094600         MOVE PV-DIFF-CRSDCK-PERCENT   TO DC-DIFF-PERCENT(DC-NDX) 04723271
094700         SET DC-NDX UP BY 1                                       04723436
094800         PERFORM 1250-SELECT-STORE-CODE                           04723550
094900     ELSE                                                         04723636
095000         PERFORM 9400-ABEND                                       04723736
095100     END-IF.                                                      04723836
095200*                                                                 04724035
095300***************************************************************** 04724932
095400* BUILD CORPORATE SUMMARY REPORT WITH DC TOTALS.                  04725032
095500***************************************************************** 04725132
095600 1110-BUILD-SUMMARY.                                              04725235
095700*                                                                 04725337
095800     SET DC-NDX TO 1.                                             04725432
095900                                                                  04725532
096000     PERFORM                                                      04725835
096100       VARYING DC-NDX FROM 1 BY 1                                 04725935
096200       UNTIL DC-NUMBER(DC-NDX) = ZERO  OR   DC-NDX > 50           04726036
096300         MOVE DC-NUMBER(DC-NDX)       TO SL-OPER-ID               04726236
096400         MOVE DC-NAME(DC-NDX)         TO SL-LOC-DESC              04726336
096500         MOVE DC-CURR-UNITS(DC-NDX)   TO PV-CURR-DC-UNITS         04726536
096600         MOVE DC-CURR-RETAIL(DC-NDX)  TO PV-CURR-DC-RETAIL        04726636
096700         MOVE DC-CURR-PO-RCVR(DC-NDX) TO PV-CURR-DC-PO-RCVR       04726736
096800         MOVE DC-PREV-UNITS(DC-NDX)   TO PV-PREV-DC-UNITS         04726836
096900         MOVE DC-PREV-RETAIL(DC-NDX)  TO PV-PREV-DC-RETAIL        04726936
097000         MOVE DC-PREV-PO-RCVR(DC-NDX) TO PV-PREV-DC-PO-RCVR       04727036
097100         MOVE DC-DIFF-UNITS(DC-NDX)   TO PV-DIFF-DC-UNITS         04727136
097200         MOVE DC-DIFF-RETAIL(DC-NDX)  TO PV-DIFF-DC-RETAIL        04727236
097300         MOVE DC-DIFF-PO-RCVR(DC-NDX) TO PV-DIFF-DC-PO-RCVR       04727336
097400         PERFORM 3100-PRINT-DC-TOTALS                             04727436
097500         MOVE DC-CURR-CRSDCK(DC-NDX)  TO PV-CURR-CRSDCK-UNITS-TOT 04727572
097600         MOVE DC-CURR-PERCENT(DC-NDX) TO PV-CURR-CRSDCK-PERCENT   04727636
097700         MOVE DC-PREV-CRSDCK(DC-NDX)  TO PV-PREV-CRSDCK-UNITS-TOT 04727772
097800         MOVE DC-PREV-PERCENT(DC-NDX) TO PV-PREV-CRSDCK-PERCENT   04727836
097900         MOVE DC-DIFF-CRSDCK(DC-NDX)  TO PV-DIFF-CRSDCK-UNITS-TOT 04727972
098000         MOVE DC-DIFF-PERCENT(DC-NDX) TO PV-DIFF-CRSDCK-PERCENT   04728036
098100*        IF CC-OPER-ALL                                           04728473
098200*           PERFORM 3900-PRINT-BLANK-LINE                         04728573
098300         IF CC-OPER-EXTRACT-ALL                                   04728674
098400            PERFORM 3200-CRSDCK-TOTALS                            04728774
098500         ELSE                                                     04728873
098600            PERFORM 5000-CRSDCK-PROCESS                           04729074
098700         END-IF                                                   04729173
098800     END-PERFORM.                                                 04729273
098900/                                                                 04729373
099000******************************************************************04729473
099100* BUILD CORPORATE SUMMARY FOR ALL BUILDINGS.                      04729573
099200******************************************************************04729673
099300 1120-SUMMARY-ALL.                                                04729773
099400*                                                                 04729873
099500     MOVE 'FINAL FOR ALL BUILDINGS'    TO SL-LOCATION.            04729973
099600                                                                  04730073
099700     PERFORM 3300-COMPANY-TOTALS.                                 04730173
099800     IF CC-OPER-EXTRACT-ALL                                       04730276
099900         CONTINUE                                                 04730376
100000     ELSE                                                         04730476
100100         PERFORM 5100-COMP-CRSDCK-PROCESS                         04730576
100200     END-IF.                                                      04730676
100300     PERFORM 2350-COMP-CRSDCK-PERCENT.                            04730776
100400     MOVE PV-CURR-CRSDCK-UNITS-COMP  TO PV-CURR-CRSDCK-UNITS-TOT. 04730876
100500     MOVE PV-CURR-COMP-CRSDCK-PERCENT TO PV-CURR-CRSDCK-PERCENT.  04730976
100600     MOVE PV-PREV-CRSDCK-UNITS-COMP  TO PV-PREV-CRSDCK-UNITS-TOT. 04731076
100700     MOVE PV-PREV-COMP-CRSDCK-PERCENT TO PV-PREV-CRSDCK-PERCENT.  04731176
100800     MOVE PV-DIFF-CRSDCK-UNITS-COMP  TO PV-DIFF-CRSDCK-UNITS-TOT. 04731276
100900     MOVE PV-DIFF-COMP-CRSDCK-PERCENT TO PV-DIFF-CRSDCK-PERCENT.  04731376
101000     PERFORM 3200-CRSDCK-TOTALS.                                  04731577
101100/                                                                 04731976
101200***************************************************************** 04732076
101300* BUILD CORPORATE SUMMARY FOR ALL BUILDINGS EXCEPT FOR E-COMMERCE 04732176
101400***************************************************************** 04732276
101500 1130-SUMMARY-MINUS-ECOMM.                                        04732376
101600*                                                                 04732476
101700     MOVE 'FINAL FOR ALL BUILDINGS EXCEPT FOR E-COMMERCE'         04732576
101800                                            TO SL-LOCATION.       04732676
101900     IF PS-ECOMM-NO                                               04732776
102000         CONTINUE                                                 04732876
102100     ELSE                                                         04732976
102200         MOVE PV-CURR-ECOMM-UNITS    TO PV-CURR-COMP-UNITS        04733076
102300         MOVE PV-CURR-ECOMM-RETAIL   TO PV-CURR-COMP-RETAIL       04733176
102400         MOVE PV-CURR-ECOMM-PO-RCVR  TO PV-CURR-COMP-PO-RCVR      04733276
102500         MOVE PV-PREV-ECOMM-UNITS    TO PV-PREV-COMP-UNITS        04733376
102600         MOVE PV-PREV-ECOMM-RETAIL   TO PV-PREV-COMP-RETAIL       04733476
102700         MOVE PV-PREV-ECOMM-PO-RCVR  TO PV-PREV-COMP-PO-RCVR      04733576
102800         MOVE PV-DIFF-ECOMM-UNITS    TO PV-DIFF-COMP-UNITS        04733676
102900         MOVE PV-DIFF-ECOMM-RETAIL   TO PV-DIFF-COMP-RETAIL       04733776
103000         MOVE PV-DIFF-ECOMM-PO-RCVR  TO PV-DIFF-COMP-PO-RCVR      04733876
103100     END-IF.                                                      04733976
103200     PERFORM 3300-COMPANY-TOTALS.                                 04734076
103300     MOVE PV-CURR-ECOMM-CRSDCK-UNITS                              04734176
103400                                 TO PV-CURR-CRSDCK-UNITS.         04734276
103500     MOVE PV-CURR-ECOMM-CRSDCK-PERCENT                            04734376
103600                                 TO PV-CURR-CRSDCK-PERCENT.       04734476
103700     MOVE PV-PREV-ECOMM-CRSDCK-UNITS                              04734576
103800                                 TO PV-PREV-CRSDCK-UNITS.         04734676
103900     MOVE PV-PREV-ECOMM-CRSDCK-PERCENT                            04734776
104000                                 TO PV-PREV-CRSDCK-PERCENT.       04734876
104100     MOVE PV-DIFF-ECOMM-CRSDCK-UNITS                              04734976
104200                                 TO PV-DIFF-CRSDCK-UNITS.         04735076
104300     MOVE PV-DIFF-ECOMM-CRSDCK-PERCENT                            04735176
104400                                 TO PV-DIFF-CRSDCK-PERCENT.       04735276
104500*    IF CC-OPER-EXTRACT-ALL                                       04735378
104600        PERFORM 3200-CRSDCK-TOTALS.                               04735478
104700/                                                                 04735676
104800***************************************************************** 04735776
104900* SELECT CURRENT YEAR WEEK-ENDING DATE AND CURRENT WEEK NUMBER    04735876
105000* FROM TDTATTR.                                                   04735976
105100***************************************************************** 04736076
105200 1150-SELECT-CURR-DATES.                                          04736176
105300                                                                  04736276
105400         EXEC SQL                                                 04736376
105500           SELECT FSCL_WK_END_DTE,                                04736476
105600                  FSCL_WK_NBR,                                    04736576
105700                  LY_THIS_DAY_KY_DTE                              04736676
105800             INTO :DTATTR-FSCL-WK-END-DTE,                        04736776
105900                  :DTATTR-FSCL-WK-NBR,                            04736876
106000                  :DTATTR-LY-THIS-DAY-KY-DTE                      04736976
106100           FROM TDTATTR                                           04737076
106200             WHERE KY_DTE  = :PV-KEY-DATE                         04737176
106300         END-EXEC                                                 04737276
106400                                                                  04737376
106500     EVALUATE TRUE                                                04737476
106600         WHEN SQLCODE = ZERO                                      04737576
106700             MOVE DTATTR-FSCL-WK-END-DTE TO PV-CURR-WEEK-ENDING   04737676
106800             MOVE DTATTR-FSCL-WK-NBR     TO PV-CURR-WW            04737776
106900             MOVE PV-WK-END-YYYY         TO PV-CURR-YYYY          04737876
107000             MOVE DTATTR-LY-THIS-DAY-KY-DTE                       04737976
107100                                         TO PV-LY-THIS-DAY-KY-DTE 04738076
107200         WHEN SQLCODE = +100                                      04738176
107300             CONTINUE                                             04738276
107400         WHEN SQLCODE < ZERO                                      04738376
107500             DISPLAY '** ABEND - PCKRP014 **'                     04738476
107600             DISPLAY '** 1150-SELECT-CURR-DATES **'               04738576
107700             PERFORM 9200-SQL-ABEND                               04738676
107800         WHEN SQLCODE > ZERO                                      04738776
107900         WHEN SQLWARN0 NOT = SPACES                               04738876
108000             DISPLAY '** ABEND - PCKRP014 **'                     04738976
108100             DISPLAY '** 1150-SELECT-CURR-DATES **'               04739076
108200             PERFORM 9300-SQL-WARNING                             04739176
108300     END-EVALUATE.                                                04739276
108400/                                                                 04739376
108500***************************************************************** 04739476
108600* SELECT PREVIOUS YEAR DATE AND PREVIOUS WEEK NUMBER              04739576
108700* FROM TDTATTR.                                                   04739676
108800***************************************************************** 04739776
108900 1160-SELECT-PREV-DATES.                                          04739876
109000                                                                  04739976
109100         EXEC SQL                                                 04740076
109200           SELECT FSCL_WK_NBR,                                    04740176
109300                  FSCL_YR_NBR                                     04740276
109400             INTO :DTATTR-FSCL-WK-NBR,                            04740376
109500                  :DTATTR-FSCL-YR-NBR                             04740476
109600           FROM TDTATTR                                           04740576
109700             WHERE KY_DTE  = :PV-LY-THIS-DAY-KY-DTE               04740676
109800         END-EXEC                                                 04740776
109900                                                                  04740876
110000     EVALUATE TRUE                                                04740976
110100         WHEN SQLCODE = ZERO                                      04741076
110200             MOVE DTATTR-FSCL-WK-NBR   TO PV-PREV-WW              04741176
110300             MOVE DTATTR-FSCL-YR-NBR   TO PV-PREV-YYYY            04741276
110400*        WHEN SQLCODE = +100                                      04741376
110500*            CONTINUE                                             04741476
110600         WHEN SQLCODE < ZERO                                      04741576
110700             DISPLAY '** ABEND - PCKRP014 **'                     04741676
110800             DISPLAY '** 1160-SELECT-PREV-DATES **'               04741776
110900             PERFORM 9200-SQL-ABEND                               04741876
111000         WHEN SQLCODE > ZERO                                      04741976
111100         WHEN SQLWARN0 NOT = SPACES                               04742076
111200             DISPLAY '** ABEND - PCKRP014 **'                     04742176
111300             DISPLAY '** 1160-SELECT-PREV-DATES **'               04742276
111400             PERFORM 9300-SQL-WARNING                             04742376
111500     END-EVALUATE.                                                04742476
111600/                                                                 04742576
111700***************************************************************** 04742676
111800 1200-SELECT-OPER-DESC.                                           04743051
111900***************************************************************** 04750000
112000*                                                                 04760000
112100     INITIALIZE XL071-COMMAREA-REC.                               05790023
112200     MOVE PV-OPER-ID           TO XL071-LOCATION-NUMBER           05800023
112300                                                                  05810023
112400     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05820023
112500                                                                  05830023
112600     EVALUATE TRUE                                                05840023
112700     WHEN XL071-NO-ERRORS                                         05850023
112800         MOVE XL071-LOC-NM    TO PV-STORE-NAME                    05860023
112900     WHEN XL071-LOC-NOT-FOUND                                     05870023
113000     WHEN XL071-DC-ASGMT-NOT-FND                                  05880023
113100         MOVE SPACES           TO  PV-STORE-NAME                  05890023
113200     WHEN XL071-BAD-DB2-RETURN                                    05900023
113300         MOVE XL071-SQLCA             TO SQLCA                    05910023
113400         MOVE '1200-SELECT-OPER-DESC'                             05920023
113500                                TO PV-PARAGRAPH                   05930023
113600         MOVE 'SELECT'          TO PV-DB2-FUNCTION                05940023
113700         MOVE ' CALL TO XLKUT071'                                 05950023
113800                                TO PV-DB2-OPERATION-MESSAGE-1     05960023
113900         MOVE ' TABLE = XLT_LOC '                                 05970023
114000                                TO PV-DB2-OPERATION-MESSAGE-2     05980023
114100         PERFORM 9200-SQL-ABEND                                   05990023
114200     END-EVALUATE.                                                06000023
114300/                                                                 06010023
114400***************************************************************** 05020050
114500 1250-SELECT-STORE-CODE.                                          05030050
114600***************************************************************** 05040050
114700*                                                                 05050050
114800     INITIALIZE XL071-COMMAREA-REC.                               05790023
114900     MOVE PV-PREV-OPER-ID      TO XL071-LOCATION-NUMBER           05800023
115000                                                                  05810023
115100     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05820023
115200                                                                  05830023
115300     EVALUATE TRUE                                                05840023
115400     WHEN XL071-NO-ERRORS                                         05850023
115500         MOVE XL071-E-BUS-IND TO PV-STORE-CODE                    05860023
115600         SET PS-ECOMM-YES   TO TRUE                               05140170
115700         PERFORM 2250-CHECK-ECOMM                                 05141050
115800     WHEN XL071-LOC-NOT-FOUND                                     05870023
115900     WHEN XL071-DC-ASGMT-NOT-FND                                  05880023
116000         CONTINUE                                                 05890023
116100     WHEN XL071-BAD-DB2-RETURN                                    05900023
116200         MOVE XL071-SQLCA             TO SQLCA                    05910023
116300         MOVE '1250-SELECT-STORE-CODE'                            05920023
116400                                TO PV-PARAGRAPH                   05930023
116500         MOVE 'SELECT'          TO PV-DB2-FUNCTION                05940023
116600         MOVE ' CALL TO XLKUT071'                                 05950023
116700                                TO PV-DB2-OPERATION-MESSAGE-1     05960023
116800         MOVE ' TABLE = XLT_LOC '                                 05970023
116900                                TO PV-DB2-OPERATION-MESSAGE-2     05980023
117000         PERFORM 9200-SQL-ABEND                                   05990023
117100     END-EVALUATE.                                                06000023
117200/                                                                 06010023
117300******************************************************************05310000
117400*  PRINT A 'NO INPUT' REPORT LINE.                                05320000
117500******************************************************************05330000
117600 1300-NO-DETAIL-LINE.                                             05340000
117700                                                                  05350000
117800         IF CC-ROUTE-TO-RDS                                       05360000
117900             WRITE REPORT-RECORD-1                                05370000
118000               FROM EP-EMPTY-REPORT-LINE                          05380000
118100                 AFTER ADVANCING 3 LINES                          05390000
118200         ELSE                                                     05400000
118300             WRITE REPORT-RECORD-2                                05410000
118400               FROM EP-EMPTY-REPORT-LINE                          05420000
118500                 AFTER ADVANCING 3 LINES.                         05430000
118600*                                                                 05440000
118700***************************************************************** 05590000
118800* CHECK DATA PERIOD INDICATOR TO DETERMINE CURRENT OR PREVIOUS.   05591004
118900***************************************************************** 05610000
119000 1400-PROCESS-DETAILS.                                            05620004
119100*                                                                 05630000
119200     EVALUATE TRUE                                                05640000
119300        WHEN PC012-DATA-TYPE-CURRENT                              05642004
119400           MOVE PC012-UNT-WRKD-QTY       TO PV-CURR-UNITS         05643013
119500           MOVE PC012-EXTD-RTL-WRKD-AMT  TO PV-CURR-RETAIL        05644013
119600           MOVE PC012-PO-RCVR-WRKD-QTY   TO PV-CURR-PO-RCVR       05645013
119700                                                                  05646004
119800        WHEN PC012-DATA-TYPE-PREVIOUS                             05647004
119900           MOVE PC012-UNT-WRKD-QTY       TO PV-PREV-UNITS         05648013
120000           MOVE PC012-EXTD-RTL-WRKD-AMT  TO PV-PREV-RETAIL        05649013
120100           MOVE PC012-PO-RCVR-WRKD-QTY   TO PV-PREV-PO-RCVR       05649113
120200                                                                  05649204
120300     END-EVALUATE.                                                05835100
120400/                                                                 05835200
120500***************************************************************** 05835300
120600* DETERMINE DIFFERENCE BETWEEN CURRENT AND PREVIOUS FOR DETAIL.   05835405
120700***************************************************************** 05835600
120800 1450-DETAIL-DIFFERENCE.                                          05835704
120900*                                                                 05835800
121000     SUBTRACT PV-PREV-UNITS FROM PV-CURR-UNITS                    05836706
121100        GIVING PV-DIFF-UNITS.                                     05836806
121200                                                                  05836905
121300     SUBTRACT PV-PREV-RETAIL FROM PV-CURR-RETAIL                  05837006
121400        GIVING PV-DIFF-RETAIL.                                    05838006
121500                                                                  05839005
121600     SUBTRACT PV-PREV-PO-RCVR FROM PV-CURR-PO-RCVR                05840006
121700        GIVING PV-DIFF-PO-RCVR.                                   05840106
121800/                                                                 05840900
121900***************************************************************** 05841005
122000* DETERMINE DIFFERENCE BETWEEN CURRENT AND PREVIOUS FOR DC TOTAL. 05841105
122100***************************************************************** 05841205
122200 1460-DC-TOTAL-DIFFERENCE.                                        05841305
122300*                                                                 05841405
122400          SUBTRACT PV-PREV-DC-UNITS FROM PV-CURR-DC-UNITS         05841511
122500            GIVING PV-DIFF-DC-UNITS.                              05841611
122600                                                                  05841705
122700          SUBTRACT PV-PREV-DC-RETAIL FROM PV-CURR-DC-RETAIL       05841811
122800            GIVING PV-DIFF-DC-RETAIL.                             05841911
122900                                                                  05842005
123000          SUBTRACT PV-PREV-DC-PO-RCVR FROM PV-CURR-DC-PO-RCVR     05842111
123100            GIVING PV-DIFF-DC-PO-RCVR.                            05842211
123200/                                                                 05842305
123300***************************************************************** 05842427
123400* DETERMINE DIFFERENCE BETWEEN CURRENT AND PREVIOUS FOR DC TOTAL. 05842527
123500***************************************************************** 05842627
123600 1470-COMP-TOTAL-DIFFERENCE.                                      05842727
123700*                                                                 05842827
123800          SUBTRACT PV-PREV-COMP-UNITS FROM PV-CURR-COMP-UNITS     05842927
123900            GIVING PV-DIFF-COMP-UNITS.                            05843027
124000                                                                  05843127
124100          SUBTRACT PV-PREV-COMP-RETAIL FROM PV-CURR-COMP-RETAIL   05843227
124200            GIVING PV-DIFF-COMP-RETAIL.                           05843327
124300                                                                  05843427
124400          SUBTRACT PV-PREV-COMP-PO-RCVR FROM PV-CURR-COMP-PO-RCVR 05843527
124500            GIVING PV-DIFF-COMP-PO-RCVR.                          05843627
124600/                                                                 05843727
124700***************************************************************** 05843827
124800* MOVE DC TOTALS TO REPORT FIELDS.                                05843927
124900***************************************************************** 05844027
125000 1500-PROCESS-DC-TOTAL.                                           05844127
125100*                                                                 05844227
125200     EVALUATE TRUE                                                05844327
125300        WHEN PC012-DATA-TYPE-CURRENT                              05844427
125400            MOVE PC012-UNT-WRKD-QTY       TO PV-CURR-DC-UNITS     05844527
125500            MOVE PC012-EXTD-RTL-WRKD-AMT  TO PV-CURR-DC-RETAIL    05844627
125600            MOVE PC012-PO-RCVR-WRKD-QTY   TO PV-CURR-DC-PO-RCVR   05844727
125700                                                                  05844827
125800        WHEN PC012-DATA-TYPE-PREVIOUS                             05844927
125900            MOVE PC012-UNT-WRKD-QTY       TO PV-PREV-DC-UNITS     05845027
126000            MOVE PC012-EXTD-RTL-WRKD-AMT  TO PV-PREV-DC-RETAIL    05845127
126100            MOVE PC012-PO-RCVR-WRKD-QTY   TO PV-PREV-DC-PO-RCVR   05845227
126200                                                                  05845327
126300     END-EVALUATE.                                                05845427
126400/                                                                 05845527
126500***************************************************************** 05845804
126600* INITIALIZE AREA TOTALS.                                         05845904
126700***************************************************************** 05846004
126800 1550-INITIALIZE-AREA-TOTALS.                                     05846104
126900*                                                                 05846204
127000     INITIALIZE     PV-CURR-UNITS                                 05846314
127100                    PV-CURR-RETAIL                                05846414
127200                    PV-CURR-PO-RCVR                               05846514
127300                    PV-PREV-UNITS                                 05846814
127400                    PV-PREV-RETAIL                                05846914
127500                    PV-PREV-PO-RCVR                               05847014
127600                    PV-DIFF-UNITS                                 05847114
127700                    PV-DIFF-RETAIL                                05847214
127800                    PV-DIFF-PO-RCVR.                              05847314
127900/                                                                 05847405
128000***************************************************************** 05847519
128100* INITIALIZE DC TOTALS.                                           05847619
128200***************************************************************** 05847719
128300 1560-INITIALIZE-DC-TOTALS.                                       05847819
128400*                                                                 05847919
128500     INITIALIZE     PV-CURR-DC-UNITS                              05848019
128600                    PV-CURR-DC-RETAIL                             05848119
128700                    PV-CURR-DC-PO-RCVR                            05848219
128800                    PV-PREV-DC-UNITS                              05848519
128900                    PV-PREV-DC-RETAIL                             05848619
129000                    PV-PREV-DC-PO-RCVR                            05848719
129100                    PV-DIFF-DC-UNITS                              05848819
129200                    PV-DIFF-DC-RETAIL                             05848919
129300                    PV-DIFF-DC-PO-RCVR.                           05849019
129400/                                                                 05849119
129500***************************************************************** 05849240
129600* INITIALIZE CRSDCK TOTALS.                                       05849340
129700***************************************************************** 05849440
129800 1570-INITIALIZE-CRSDCK-TOTALS.                                   05849540
129900*                                                                 05849640
130000     INITIALIZE     PV-CURR-CRSDCK-UNITS-TOT                      05849772
130100                    PV-CURR-CRSDCK-PERCENT                        05849840
130200                    PV-PREV-CRSDCK-UNITS-TOT                      05850072
130300                    PV-PREV-CRSDCK-PERCENT                        05850140
130400                    PV-DIFF-CRSDCK-UNITS-TOT                      05850372
130500                    PV-DIFF-CRSDCK-PERCENT.                       05850440
130600/                                                                 05850640
130700***************************************************************** 05850747
130800* CHECK REPORT TYPE CODE. DETERMINE IF REPORT TIME PERIOD IS FOR  05850847
130900* FISCAL YEAR, FISCAL MONTH, FISCAL WEEK, DATE RANGE OR BUSINESS  05850947
131000* DATE.                                                           05851047
131100***************************************************************** 05851147
131200 1600-REPORT-TYPE-CDE.                                            05851247
131300*                                                                 05851347
131400     EVALUATE TRUE                                                05851447
131500        WHEN CC-RPT-FISCAL-MONTH                                  05852047
131600            MOVE CC-FISCAL-MONTH          TO HL4A-CURR-MM         05852154
131700                                             HL4A-PREV-MM         05852254
131800            MOVE CC-FISCAL-YYYY           TO HL4A-CURR-YYYY       05852359
131900            MOVE CC-END-RPT-DATE-RANGE    TO PV-KEY-DATE          05852451
132000            PERFORM 1160-SELECT-PREV-DATES                        05852552
132100            MOVE PV-PREV-YYYY             TO HL4A-PREV-YYYY       05852654
132200        WHEN CC-RPT-FISCAL-WEEK                                   05852952
132300            MOVE CC-FISCAL-WEEK           TO HL4B-CURR-WW         05853055
132400            MOVE PV-CURR-YYYY             TO HL4B-CURR-YYYY       05853354
132500            MOVE CC-END-RPT-DATE-RANGE    TO PV-KEY-DATE          05853455
132600            PERFORM 1160-SELECT-PREV-DATES                        05853552
132700            MOVE PV-PREV-WW               TO HL4B-PREV-WW         05853655
132800            MOVE PV-PREV-YYYY             TO HL4B-PREV-YYYY       05853754
132900        WHEN CC-RPT-DATE-RANGE                                    05853852
133000             MOVE CC-START-RPT-DATE-RANGE  TO PV-KEY-DATE         05853955
133100             MOVE PV-KEY-YYYY           TO HL4C-CURR-FROM-YYYY    05854055
133200             MOVE PV-KEY-MM             TO HL4C-CURR-FROM-MM      05854155
133300             MOVE PV-KEY-DD             TO HL4C-CURR-FROM-DD      05854255
133400           PERFORM 1150-SELECT-CURR-DATES                         05854355
133500             MOVE PV-LY-YYYY            TO HL4C-PREV-FROM-YYYY    05854455
133600             MOVE PV-LY-MM              TO HL4C-PREV-FROM-MM      05854555
133700             MOVE PV-LY-DD              TO HL4C-PREV-FROM-DD      05854655
133800                                                                  05854755
133900             MOVE CC-END-RPT-DATE-RANGE TO PV-KEY-DATE            05854855
134000             MOVE PV-KEY-YYYY           TO HL4C-CURR-TO-YYYY      05854955
134100             MOVE PV-KEY-MM             TO HL4C-CURR-TO-MM        05855055
134200             MOVE PV-KEY-DD             TO HL4C-CURR-TO-DD        05855155
134300           PERFORM 1150-SELECT-CURR-DATES                         05855355
134400             MOVE PV-LY-YYYY            TO HL4C-PREV-TO-YYYY      05855455
134500             MOVE PV-LY-MM              TO HL4C-PREV-TO-MM        05855555
134600             MOVE PV-LY-DD              TO HL4C-PREV-TO-DD        05855655
134700                                                                  05855755
134800        WHEN CC-RPT-BUS-DATE                                      05855854
134900             MOVE CC-END-RPT-DATE-RANGE TO PV-KEY-DATE            05855955
135000             MOVE PV-KEY-YYYY           TO HL4D-CURR-YYYY         05856055
135100             MOVE PV-KEY-MM             TO HL4D-CURR-MM           05856155
135200             MOVE PV-KEY-DD             TO HL4D-CURR-DD           05856255
135300          PERFORM 1150-SELECT-CURR-DATES                          05856355
135400             MOVE PV-LY-YYYY            TO HL4D-PREV-YYYY         05856455
135500             MOVE PV-LY-MM              TO HL4D-PREV-MM           05856555
135600             MOVE PV-LY-DD              TO HL4D-PREV-DD           05856655
135700                                                                  05856854
135800     END-EVALUATE.                                                05856954
135900/                                                                 05857054
136000******************************************************************05857154
136100* PROCESS DETAIL AND TOTAL RECORDS.                               05858047
136200******************************************************************05860000
136300 2000-PROCESS-EXTRACT.                                            05870028
136400*                                                                 05890000
136500     EVALUATE TRUE                                                05900000
136600       WHEN PC012-RECORD-TYPE-CDE = 'D'                           05970000
136700           PERFORM 1450-DETAIL-DIFFERENCE                         05970118
136800           PERFORM 2200-CHECK-CRSDCK                              05970318
136900           PERFORM 3000-PRINT-DETAILS                             05970418
137000           PERFORM 3100-PRINT-DC-TOTALS                           05971011
137100           PERFORM 1100-LOAD-DC-TABLE                             05971235
137200           PERFORM 1550-INITIALIZE-AREA-TOTALS                    05972019
137300           PERFORM 1560-INITIALIZE-DC-TOTALS                      05973019
137400           PERFORM 1570-INITIALIZE-CRSDCK-TOTALS                  05973140
137500           MOVE PV-OPER-ID          TO PV-PREV-OPER-ID            05973240
137600           PERFORM 2600-PROCESS-D-RECORDS                         05974011
137700               UNTIL PS-END-D-RECORD                              05975011
137800           SET PS-NOT-END-D-RECORD   TO TRUE                      05976040
137900           MOVE PV-OPER-ID           TO PV-PREV-OPER-ID           05980736
138000           MOVE PV-STORE-NAME        TO PV-PREV-STORE-NAME        05980836
138100           MOVE PV-PROCESS-AREA      TO PV-PREV-PROCESS-AREA      05980918
138200           MOVE PV-PROCESS-GROUP     TO PV-PREV-PROCESS-GROUP     05981069
138300           PERFORM 1400-PROCESS-DETAILS                           05982036
138400                                                                  05990000
138500       WHEN PC012-RECORD-TYPE-CDE = 'F'                           06031200
138600           IF PV-PROCESS-AREA  = PV-PREV-PROCESS-AREA             06031505
138700               PERFORM 1400-PROCESS-DETAILS                       06031615
138800           ELSE                                                   06031805
138900               PERFORM 1450-DETAIL-DIFFERENCE                     06031905
139000               PERFORM 2200-CHECK-CRSDCK                          06032115
139100               PERFORM 3000-PRINT-DETAILS                         06032205
139200               PERFORM 1550-INITIALIZE-AREA-TOTALS                06032314
139300               MOVE PV-PROCESS-AREA      TO PV-PREV-PROCESS-AREA  06032405
139400               MOVE PV-PROCESS-GROUP     TO PV-PREV-PROCESS-GROUP 06032569
139500               PERFORM 1400-PROCESS-DETAILS                       06032605
139600           END-IF                                                 06032705
139700                                                                  06032800
139800     END-EVALUATE.                                                06033000
139900                                                                  06034000
140000     PERFORM 2100-READ-EXTRACT.                                   06035000
140100*                                                                 06036000
140200******************************************************************06037000
140300*  READ NEXT INPUT FILE RECORD.                                   06038000
140400******************************************************************06039000
140500 2100-READ-EXTRACT.                                               06040000
140600                                                                  06050000
140700     READ EXTRACT-FILE INTO PC012-RECORD-LAYOUT                   06060000
140800        AT END                                                    06070000
140900           SET PS-END-OF-INPUT TO TRUE                            06080000
141000        NOT AT END                                                06090000
141100           ADD +1                  TO PV-READ-COUNT               06100000
141200           MOVE PC012-OPER-UNT-ID  TO PV-OPER-ID                  06110000
141300           MOVE PC012-PROCESS-AREA TO PV-PROCESS-AREA             06111005
141400           MOVE PC012-PROCESS-GROUP TO PV-PROCESS-GROUP           06112069
141500     END-READ.                                                    06130000
141600/                                                                 06140005
141700******************************************************************06141005
141800* CHECK PROCESS AREA FOR CRSDCK ENTRY, SET SWITCH AND SAVE        06142015
141900* UNITS WORKED QUANTITIES FOR TOTAL LINE.                         06142115
142000******************************************************************06143005
142100 2200-CHECK-CRSDCK.                                               06144005
142200*                                                                 06145005
142300     IF PV-PREV-PROCESS-GROUP   = 'CRSDCK'                        06145269
142400         SET PS-CRSDCK-YES     TO TRUE                            06145369
142500         MOVE PV-CURR-UNITS    TO PV-CURR-CRSDCK-UNITS            06145617
142600         ADD  PV-CURR-UNITS    TO PV-CURR-CRSDCK-UNITS-TOT        06145737
142700                                  PV-CURR-CRSDCK-UNITS-COMP       06145872
142800         MOVE PV-PREV-UNITS    TO PV-PREV-CRSDCK-UNITS            06146017
142900         ADD  PV-PREV-UNITS    TO PV-PREV-CRSDCK-UNITS-TOT        06146137
143000                                  PV-PREV-CRSDCK-UNITS-COMP       06146272
143100         MOVE PV-DIFF-UNITS    TO PV-DIFF-CRSDCK-UNITS            06146317
143200         ADD  PV-DIFF-UNITS    TO PV-DIFF-CRSDCK-UNITS-TOT        06146437
143300                                  PV-DIFF-CRSDCK-UNITS-COMP       06146572
143400     END-IF.                                                      06146615
143500/                                                                 06147005
143600******************************************************************06147140
143700* CHECK FOR E-COMMERCE TOTAL RECORD. SUBTRACT ECOMM TOTALS FROM   06147241
143800* COMPANY TOTALS TO BUILD COMPANY TOTALS EXCEPT FOR E-COMMERCE.   06147341
143900******************************************************************06147440
144000 2250-CHECK-ECOMM.                                                06147540
144100*                                                                 06147640
144200         SUBTRACT PV-CURR-DC-UNITS   FROM PV-CURR-COMP-UNITS      06147942
144300                GIVING  PV-CURR-ECOMM-UNITS                       06148041
144400         SUBTRACT PV-CURR-DC-RETAIL  FROM PV-CURR-COMP-RETAIL     06148142
144500                GIVING  PV-CURR-ECOMM-RETAIL                      06148241
144600         SUBTRACT PV-CURR-DC-PO-RCVR FROM PV-CURR-COMP-PO-RCVR    06148342
144700                GIVING  PV-CURR-ECOMM-PO-RCVR                     06148441
144800         SUBTRACT PV-PREV-DC-UNITS   FROM PV-PREV-COMP-UNITS      06148542
144900                GIVING  PV-PREV-ECOMM-UNITS                       06148641
145000         SUBTRACT PV-PREV-DC-RETAIL  FROM PV-PREV-COMP-RETAIL     06148742
145100                GIVING  PV-PREV-ECOMM-RETAIL                      06148841
145200         SUBTRACT PV-PREV-DC-PO-RCVR FROM PV-PREV-COMP-PO-RCVR    06148942
145300                GIVING  PV-PREV-ECOMM-PO-RCVR                     06149041
145400         SUBTRACT PV-DIFF-DC-UNITS   FROM PV-DIFF-COMP-UNITS      06149142
145500                GIVING  PV-DIFF-ECOMM-UNITS                       06149241
145600         SUBTRACT PV-DIFF-DC-RETAIL  FROM PV-DIFF-COMP-RETAIL     06149342
145700                GIVING  PV-DIFF-ECOMM-RETAIL                      06149441
145800         SUBTRACT PV-DIFF-DC-PO-RCVR FROM PV-DIFF-COMP-PO-RCVR    06149542
145900                GIVING  PV-DIFF-ECOMM-PO-RCVR.                    06149676
146000                                                                  06149776
146100         IF CC-OPER-EXTRACT-ALL                                   06149977
146200             MOVE PV-CURR-CRSDCK-UNITS-COMP                       06150376
146300                                   TO PV-CURR-CRSDCK-UNITS-ECOMM  06150477
146400             MOVE PV-CURR-CRSDCK-PERCENT                          06150577
146500                                   TO PV-CURR-CRSDCK-PERCENT-ECOMM06150677
146600             MOVE PV-PREV-CRSDCK-UNITS-COMP                       06150776
146700                                   TO PV-PREV-CRSDCK-UNITS-ECOMM  06150877
146800             MOVE PV-PREV-CRSDCK-PERCENT                          06150976
146900                                   TO PV-PREV-CRSDCK-PERCENT-ECOMM06151077
147000             MOVE PV-DIFF-CRSDCK-UNITS-COMP                       06151176
147100                                   TO PV-DIFF-CRSDCK-UNITS-ECOMM  06151277
147200             MOVE PV-DIFF-CRSDCK-PERCENT                          06151376
147300                                   TO PV-DIFF-CRSDCK-PERCENT-ECOMM06151477
147400         ELSE                                                     06151576
147500             PERFORM 5200-COMP-ECOMM-CRSDCK.                      06151676
147600                                                                  06151771
147700/                                                                 06151871
147800******************************************************************06151971
147900* CALCULATE CRSDCK TOTALS AND PERCENTAGES FOR COMPANY TOTALS      06152071
148000* EXCEPT FOR E-COMMERCE.                                          06152171
148100******************************************************************06152271
148200 2260-ECOMM-CRSDCK.                                               06152371
148300*                                                                 06152471
148400         SUBTRACT PV-CURR-CRSDCK-UNITS-ECOMM                      06152571
148500            FROM PV-CURR-CRSDCK-UNITS-TOT                         06152671
148600                GIVING  PV-CURR-ECOMM-CRSDCK-UNITS                06152771
148700         SUBTRACT PV-CURR-CRSDCK-PERCENT-ECOMM                    06152871
148800            FROM PV-CURR-COMP-CRSDCK-PERCENT                      06152971
148900                GIVING  PV-CURR-ECOMM-CRSDCK-PERCENT              06153071
149000         SUBTRACT PV-PREV-CRSDCK-UNITS-ECOMM                      06153171
149100            FROM PV-PREV-CRSDCK-UNITS-TOT                         06153271
149200                GIVING  PV-PREV-ECOMM-CRSDCK-UNITS                06153371
149300         SUBTRACT PV-PREV-CRSDCK-PERCENT-ECOMM                    06153471
149400            FROM PV-PREV-COMP-CRSDCK-PERCENT                      06153571
149500                GIVING  PV-PREV-ECOMM-CRSDCK-PERCENT              06153671
149600         SUBTRACT PV-PREV-CRSDCK-UNITS-ECOMM                      06153771
149700            FROM PV-DIFF-CRSDCK-UNITS-TOT                         06153871
149800                GIVING  PV-DIFF-ECOMM-CRSDCK-UNITS                06153971
149900         SUBTRACT PV-DIFF-CRSDCK-PERCENT-ECOMM                    06154071
150000            FROM PV-DIFF-COMP-CRSDCK-PERCENT                      06154171
150100                GIVING  PV-DIFF-ECOMM-CRSDCK-PERCENT.             06154271
150200/                                                                 06154371
150300******************************************************************06154471
150400* DETERMINE PERCENTAGES FOR CRSDCK TOTALS AND WRITE CRSDCK TOTAL  06154571
150500* LINE.                                                           06154671
150600******************************************************************06154771
150700 2300-CRSDCK-PERCENT.                                             06154871
150800*                                                                 06154971
150900            IF PV-CURR-DC-UNITS      > ZERO                       06155071
151000             DIVIDE PV-CURR-CRSDCK-UNITS-TOT BY PV-CURR-DC-UNITS  06155172
151100                GIVING PV-DIVIDEND ROUNDED                        06155271
151200              MULTIPLY PV-DIVIDEND BY 100                         06155371
151300                GIVING PV-CURR-CRSDCK-PERCENT                     06155471
151400*             IF PV-CURR-CRSDCK-PERCENT   = ZERO AND              06155581
151500*                PV-CURR-DC-UNITS       > ZERO                    06155681
151600*                MOVE .01      TO PV-CURR-CRSDCK-PERCENT          06155781
151700*             END-IF                                              06155881
151800            ELSE                                                  06155971
151900                  MOVE ZEROES  TO  PV-DIVIDEND                    06156071
152000                                   PV-CURR-CRSDCK-PERCENT         06156171
152100            END-IF.                                               06156271
152200                                                                  06156371
152300            IF PV-PREV-DC-UNITS      > ZERO                       06156471
152400             DIVIDE PV-PREV-CRSDCK-UNITS-TOT BY PV-PREV-DC-UNITS  06156572
152500                GIVING PV-DIVIDEND ROUNDED                        06156671
152600              MULTIPLY PV-DIVIDEND BY 100                         06156771
152700                GIVING PV-PREV-CRSDCK-PERCENT                     06156871
152800*             IF PV-PREV-CRSDCK-PERCENT   = ZERO AND              06156981
152900*                PV-PREV-DC-UNITS       > ZERO                    06157081
153000*                MOVE .01      TO PV-PREV-CRSDCK-PERCENT          06157181
153100*             END-IF                                              06157281
153200            ELSE                                                  06157371
153300                  MOVE ZEROES  TO  PV-DIVIDEND                    06157471
153400                                   PV-PREV-CRSDCK-PERCENT         06157571
153500            END-IF.                                               06157671
153600                                                                  06157771
153700            SUBTRACT PV-PREV-CRSDCK-PERCENT                       06157872
153800                     FROM PV-CURR-CRSDCK-PERCENT                  06157972
153900                GIVING PV-DIFF-CRSDCK-PERCENT.                    06158072
154000                                                                  06158172
154100/                                                                 06158972
154200******************************************************************06159072
154300* DETERMINE PERCENTAGES FOR COMPANY CRSDCK TOTALS.                06159172
154400* WRITE COMPANY CRSDCK TOTAL LINE.                                06159272
154500******************************************************************06159372
154600 2350-COMP-CRSDCK-PERCENT.                                        06159472
154700*                                                                 06159572
154800            IF PV-CURR-COMP-UNITS        > ZERO                   06159672
154900             DIVIDE PV-CURR-CRSDCK-UNITS-COMP BY                  06159772
155000                                               PV-CURR-COMP-UNITS 06159872
155100                GIVING PV-DIVIDEND ROUNDED                        06159972
155200              MULTIPLY PV-DIVIDEND BY 100                         06160072
155300                GIVING PV-CURR-COMP-CRSDCK-PERCENT                06160172
155400*             IF PV-CURR-COMP-CRSDCK-PERCENT  = ZERO AND          06160281
155500*                PV-CURR-COMP-UNITS     > ZERO                    06160381
155600*                MOVE .01      TO PV-CURR-COMP-CRSDCK-PERCENT     06160481
155700*             END-IF                                              06160581
155800            ELSE                                                  06160672
155900                  MOVE ZEROES  TO  PV-DIVIDEND                    06160772
156000                                   PV-CURR-COMP-CRSDCK-PERCENT    06160872
156100            END-IF.                                               06160972
156200                                                                  06161072
156300            IF PV-PREV-COMP-UNITS    > ZERO                       06161172
156400             DIVIDE PV-PREV-CRSDCK-UNITS-COMP BY                  06161272
156500                                               PV-PREV-COMP-UNITS 06161372
156600                GIVING PV-DIVIDEND ROUNDED                        06161472
156700              MULTIPLY PV-DIVIDEND BY 100                         06161572
156800                GIVING PV-PREV-COMP-CRSDCK-PERCENT                06161672
156900*             IF PV-PREV-COMP-CRSDCK-PERCENT  = ZERO AND          06161781
157000*                PV-PREV-COMP-UNITS       > ZERO                  06161881
157100*                MOVE .01      TO PV-PREV-COMP-CRSDCK-PERCENT     06161981
157200*             END-IF                                              06162081
157300            ELSE                                                  06162172
157400                  MOVE ZEROES  TO  PV-DIVIDEND                    06162272
157500                                   PV-PREV-COMP-CRSDCK-PERCENT    06162372
157600            END-IF.                                               06162472
157700                                                                  06162572
157800            SUBTRACT PV-PREV-COMP-CRSDCK-PERCENT                  06162672
157900                     FROM PV-CURR-COMP-CRSDCK-PERCENT             06162772
158000                GIVING PV-DIFF-COMP-CRSDCK-PERCENT.               06162872
158100                                                                  06162972
158200/                                                                 06163872
158300******************************************************************06163972
158400* PROCESS COMPANY TOTAL RECORD (PC012-RCD-TYPE-CDE = 'B')         06164072
158500* SAVE TOTALS FOR COMPANY SUMMARY PAGE.                           06164172
158600******************************************************************06164272
158700 2500-PROCESS-B-RECORDS.                                          06164372
158800*                                                                 06164472
158900     IF PC012-RCD-TYPE-COMP-TOT-SUM AND                           06164583
159000        NOT PS-END-OF-INPUT                                       06164683
159100                                                                  06164772
159200         EVALUATE TRUE                                            06164872
159300           WHEN PC012-DATA-TYPE-CURRENT                           06164972
159400             MOVE PC012-UNT-WRKD-QTY      TO PV-CURR-COMP-UNITS   06165072
159500             MOVE PC012-EXTD-RTL-WRKD-AMT TO PV-CURR-COMP-RETAIL  06165172
159600             MOVE PC012-PO-RCVR-WRKD-QTY  TO PV-CURR-COMP-PO-RCVR 06165272
159700                                                                  06165372
159800           WHEN PC012-DATA-TYPE-PREVIOUS                          06165472
159900             MOVE PC012-UNT-WRKD-QTY      TO PV-PREV-COMP-UNITS   06165572
160000             MOVE PC012-EXTD-RTL-WRKD-AMT TO PV-PREV-COMP-RETAIL  06165672
160100             MOVE PC012-PO-RCVR-WRKD-QTY  TO PV-PREV-COMP-PO-RCVR 06165772
160200         END-EVALUATE                                             06165872
160300                                                                  06165972
160400         PERFORM 1470-COMP-TOTAL-DIFFERENCE                       06166072
160500         PERFORM 2100-READ-EXTRACT                                06166172
160600     ELSE                                                         06166272
160700         SET PS-END-B-RECORD   TO TRUE                            06166372
160800     END-IF.                                                      06166472
160900/                                                                 06166572
161000******************************************************************06166672
161100* PROCESS DC TOTAL RECORD (PC012-RCD-TYPE-CDE = 'D')              06166772
161200* SAVE TOTALS FOR DC TOTAL LINE.                                  06166872
161300******************************************************************06166972
161400 2600-PROCESS-D-RECORDS.                                          06167072
161500*                                                                 06167172
161600     IF PC012-RCD-TYPE-DC-TOT-SUM AND                             06167383
161700        NOT PS-END-OF-INPUT                                       06167483
161800                                                                  06167572
161900        EVALUATE TRUE                                             06167672
162000          WHEN PC012-DATA-TYPE-CURRENT                            06167772
162100            MOVE PC012-UNT-WRKD-QTY      TO PV-CURR-DC-UNITS      06167872
162200            MOVE PC012-EXTD-RTL-WRKD-AMT TO PV-CURR-DC-RETAIL     06167972
162300            MOVE PC012-PO-RCVR-WRKD-QTY  TO PV-CURR-DC-PO-RCVR    06168072
162400            SET PS-CURRENT  TO TRUE                               06168172
162500                                                                  06168272
162600          WHEN PC012-DATA-TYPE-PREVIOUS                           06168372
162700            MOVE PC012-UNT-WRKD-QTY      TO PV-PREV-DC-UNITS      06168472
162800            MOVE PC012-EXTD-RTL-WRKD-AMT TO PV-PREV-DC-RETAIL     06168572
162900            MOVE PC012-PO-RCVR-WRKD-QTY  TO PV-PREV-DC-PO-RCVR    06168672
163000            SET PS-PREVIOUS TO TRUE                               06168772
163100            PERFORM 1460-DC-TOTAL-DIFFERENCE                      06168872
163200            IF CC-OPER-ALL                                        06168972
163300                PERFORM 1200-SELECT-OPER-DESC                     06169072
163400                MOVE PV-OPER-ID    TO  PV-PREV-OPER-ID            06169172
163500                MOVE PV-STORE-NAME TO PV-PREV-STORE-NAME          06169272
163600                PERFORM 1100-LOAD-DC-TABLE                        06169372
163700                PERFORM 1560-INITIALIZE-DC-TOTALS                 06169472
163800            END-IF                                                06169572
163900        END-EVALUATE                                              06169672
164000                                                                  06169760
164100         MOVE PV-OPER-ID    TO PV-PREV-OPER-ID                    06169863
164200         MOVE PV-STORE-NAME TO PV-PREV-STORE-NAME                 06169963
164300         PERFORM 2100-READ-EXTRACT                                06170060
164400         IF PC012-DATA-TYPE-PREVIOUS                              06170160
164500            CONTINUE                                              06170260
164600         ELSE                                                     06170360
164700            PERFORM 2700-CHECK-PREV                               06170460
164800     ELSE                                                         06170560
164900         SET PS-END-D-RECORD   TO TRUE                            06171260
165000     END-IF.                                                      06171360
165100/                                                                 06171460
165200******************************************************************06171560
165300* CHECK TO SEE IF THERE IS A TOTAL (D-RECORD) FOR PREVIOUS YEAR.  06171660
165400* IF NOT PROCESS AND LOAD TABLE.                                  06171760
165500******************************************************************06171860
165600 2700-CHECK-PREV.                                                 06171960
165700*                                                                 06172060
165800         IF PS-CURRENT                                            06172160
165900             PERFORM 1460-DC-TOTAL-DIFFERENCE                     06172260
166000             IF CC-OPER-ALL                                       06172360
166100                MOVE PV-OPER-ID       TO PV-SAVE-OPER-ID          06172462
166200                MOVE PV-PREV-OPER-ID  TO PV-OPER-ID               06172562
166300                PERFORM 1200-SELECT-OPER-DESC                     06172660
166400                MOVE PV-SAVE-OPER-ID  TO PV-OPER-ID               06172762
166500                MOVE PV-STORE-NAME TO PV-PREV-STORE-NAME          06172860
166600                PERFORM 1100-LOAD-DC-TABLE                        06172960
166700                PERFORM 1560-INITIALIZE-DC-TOTALS                 06173060
166800                SET PS-PREVIOUS   TO TRUE                         06173160
166900             END-IF                                               06173260
167000         END-IF.                                                  06173360
167100/                                                                 06173460
167200******************************************************************06173560
167300*  FILL AND PRINT DETAIL REPORT LINE.                             06173660
167400******************************************************************06174060
167500 3000-PRINT-DETAILS.                                              06180000
167600*                                                                 06190000
167700     MOVE PV-PREV-PROCESS-AREA    TO DL1-PROCESS-AREA.            06260015
167800                                                                  06261005
167900     MOVE PV-CURR-UNITS           TO DL1-CURRENT-UNITS.           06270005
168000     MOVE PV-CURR-RETAIL          TO DL1-CURRENT-RETAIL.          06280005
168100     MOVE PV-CURR-PO-RCVR         TO DL1-CURRENT-PO-RCVR.         06290005
168200     MOVE PV-PREV-UNITS           TO DL1-PREVIOUS-UNITS.          06310005
168300     MOVE PV-PREV-RETAIL          TO DL1-PREVIOUS-RETAIL.         06320005
168400     MOVE PV-PREV-PO-RCVR         TO DL1-PREVIOUS-PO-RCVR.        06330005
168500     MOVE PV-DIFF-UNITS           TO DL1-DIFFERENCE-UNITS         06350005
168600     MOVE PV-DIFF-RETAIL          TO DL1-DIFFERENCE-RETAIL.       06360005
168700     MOVE PV-DIFF-PO-RCVR         TO DL1-DIFFERENCE-PO-RCVR.      06370005
168800                                                                  06380000
168900*CHECK FOR OVERFLOW.                                              06430000
169000*    ADD 1 TO PV-LINE-COUNT.                                      06440022
169100     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06450000
169200         SET PS-NEW-PAGE TO TRUE                                  06460000
169300         PERFORM 8000-WRITE-MAIN-HEADINGS                         06470000
169400         PERFORM 8100-WRITE-SUB-HEADINGS                          06480000
169500     END-IF.                                                      06490000
169600                                                                  06500000
169700*IF NEW PAGE, DISPLAY WEEK-END DATE.                              06510000
169800     IF PS-NEW-PAGE                                               06520000
169900         SET PS-SAME-PAGE             TO TRUE                     06530000
170000     END-IF.                                                      06540000
170100                                                                  06550000
170200*WRITE DETAIL LINE.                                               06560000
170300         IF CC-ROUTE-TO-RDS                                       06570000
170400             WRITE REPORT-RECORD-1                                06580000
170500               FROM DL-DETAIL-LINE-1                              06590000
170600                 AFTER ADVANCING 1 LINES                          06600000
170700                                                                  06610000
170800             ADD 1                   TO PV-LINE-COUNT             06650016
170900         ELSE                                                     06660000
171000             WRITE REPORT-RECORD-2                                06670000
171100               FROM DL-DETAIL-LINE-1                              06680000
171200                 AFTER ADVANCING 1 LINES                          06690000
171300                                                                  06700000
171400             ADD 1                   TO PV-LINE-COUNT.            06740016
171500*                                                                 06750000
171600******************************************************************06760000
171700 3100-PRINT-DC-TOTALS.                                            06770005
171800******************************************************************06780000
171900*                                                                 06790000
172000     MOVE PV-CURR-DC-UNITS       TO TL1-CURRENT-UNITS.            06791011
172100     MOVE PV-CURR-DC-RETAIL      TO TL1-CURRENT-RETAIL.           06792011
172200     MOVE PV-CURR-DC-PO-RCVR     TO TL1-CURRENT-PO-RCVR.          06793011
172300     MOVE PV-PREV-DC-UNITS       TO TL1-PREVIOUS-UNITS.           06840011
172400     MOVE PV-PREV-DC-RETAIL      TO TL1-PREVIOUS-RETAIL.          06850011
172500     MOVE PV-PREV-DC-PO-RCVR     TO TL1-PREVIOUS-PO-RCVR.         06860011
172600     MOVE PV-DIFF-DC-UNITS       TO TL1-DIFFERENCE-UNITS          06880011
172700     MOVE PV-DIFF-DC-RETAIL      TO TL1-DIFFERENCE-RETAIL.        06890011
172800     MOVE PV-DIFF-DC-PO-RCVR     TO TL1-DIFFERENCE-PO-RCVR.       06900011
172900                                                                  06910000
173000                                                                  06940000
173100*CHECK FOR OVERFLOW.                                              06941005
173200*    ADD 1 TO PV-LINE-COUNT.                                      06942022
173300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06943036
173400         SET PS-NEW-PAGE TO TRUE                                  06944005
173500         PERFORM 8000-WRITE-MAIN-HEADINGS                         06945005
173600         PERFORM 8100-WRITE-SUB-HEADINGS                          06946005
173700     END-IF.                                                      06947005
173800                                                                  06948005
173900*IF NEW PAGE, SET SWITCH.                                         06949016
174000     IF PS-NEW-PAGE                                               06949105
174100         SET PS-SAME-PAGE             TO TRUE                     06949205
174200     END-IF.                                                      06949305
174300                                                                  06949405
174400     IF CC-ROUTE-TO-RDS                                           06950000
174500         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-8             06960016
174600             AFTER ADVANCING 1 LINE                               06970000
174700         ADD 1                   TO PV-LINE-COUNT                 06980000
174800                                                                  06981037
174900         IF PS-SUMMARY-YES                                        06990037
175000             WRITE REPORT-RECORD-1 FROM SL-SUMMARY-LINE-1         06991037
175100                 AFTER ADVANCING 1 LINE                           06992037
175200             ADD 1                   TO PV-LINE-COUNT             06993037
175300         END-IF                                                   06994037
175400                                                                  06995037
175500         WRITE REPORT-RECORD-1 FROM TL1-DC-LINE                   07000005
175600             AFTER ADVANCING 1 LINE                               07010000
175700         ADD 1                    TO PV-LINE-COUNT                07040005
175800                                                                  07050000
175900         IF PS-CRSDCK-YES AND PS-SUMMARY-NO                       07081043
176000             PERFORM 2300-CRSDCK-PERCENT                          07082016
176100             PERFORM 3200-CRSDCK-TOTALS                           07083016
176200             SET PS-CRSDCK-NO      TO TRUE                        07083116
176300         END-IF                                                   07084016
176400     ELSE                                                         07090000
176500         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-8             07100016
176600             AFTER ADVANCING 1 LINE                               07110000
176700         ADD 1                   TO PV-LINE-COUNT                 07120000
176800                                                                  07121037
176900         IF PS-SUMMARY-YES                                        07130037
177000             WRITE REPORT-RECORD-2 FROM SL-SUMMARY-LINE-1         07131037
177100                 AFTER ADVANCING 1 LINE                           07132037
177200             ADD 1                   TO PV-LINE-COUNT             07133037
177300         END-IF                                                   07134037
177400                                                                  07135037
177500         WRITE REPORT-RECORD-2 FROM TL1-DC-LINE                   07140005
177600             AFTER ADVANCING 1 LINE                               07150000
177700         ADD 1                    TO PV-LINE-COUNT                07180000
177800                                                                  07220116
177900         IF PS-CRSDCK-YES AND PS-SUMMARY-NO                       07220243
178000             PERFORM 2300-CRSDCK-PERCENT                          07220316
178100             PERFORM 3200-CRSDCK-TOTALS                           07220416
178200             SET PS-CRSDCK-NO      TO TRUE                        07220516
178300         END-IF                                                   07220616
178400     END-IF.                                                      07220716
178500                                                                  07220805
178600         SET PS-NEW-PAGE TO TRUE.                                 07221005
178700         IF PS-END-OF-INPUT                                       07221112
178800             CONTINUE                                             07221212
178900         ELSE                                                     07221312
179000             PERFORM 8000-WRITE-MAIN-HEADINGS                     07222012
179100             PERFORM 8100-WRITE-SUB-HEADINGS                      07223016
179200         END-IF.                                                  07224016
179300                                                                  07225005
179400         SET PS-SAME-PAGE             TO TRUE.                    07228005
179500*                                                                 07230000
179600******************************************************************07230135
179700 3150-PRINT-SUMMARY-LINE.                                         07230235
179800******************************************************************07230335
179900*                                                                 07230435
180000     IF CC-ROUTE-TO-RDS                                           07230535
180100         WRITE REPORT-RECORD-1 FROM SL-SUMMARY-LINE-1             07230635
180200             AFTER ADVANCING 1 LINE                               07230735
180300         ADD 1                   TO PV-LINE-COUNT                 07230835
180400                                                                  07230935
180500     ELSE                                                         07232035
180600         WRITE REPORT-RECORD-2 FROM SL-SUMMARY-LINE-1             07232135
180700             AFTER ADVANCING 1 LINE                               07232235
180800         ADD 1                   TO PV-LINE-COUNT                 07232335
180900                                                                  07232435
181000     END-IF.                                                      07233435
181100*                                                                 07233535
181200******************************************************************07233615
181300 3200-CRSDCK-TOTALS.                                              07233715
181400******************************************************************07233815
181500*                                                                 07234015
181600     MOVE PV-CURR-CRSDCK-UNITS-TOT   TO TL2-CURR-CRSDCK-UNITS.    07234172
181700     MOVE PV-CURR-CRSDCK-PERCENT     TO TL3-CURR-CRSDCK-PERCENT.  07234272
181800     MOVE PV-PREV-CRSDCK-UNITS-TOT   TO TL2-PREV-CRSDCK-UNITS.    07234472
181900     MOVE PV-PREV-CRSDCK-PERCENT     TO TL3-PREV-CRSDCK-PERCENT.  07234572
182000     MOVE PV-DIFF-CRSDCK-UNITS-TOT   TO TL2-DIFF-CRSDCK-UNITS.    07234772
182100     MOVE PV-DIFF-CRSDCK-PERCENT     TO TL3-DIFF-CRSDCK-PERCENT.  07234872
182200                                                                  07239715
182300                                                                  07239815
182400*CHECK FOR OVERFLOW.                                              07239915
182500     ADD 1 TO PV-LINE-COUNT.                                      07240015
182600     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         07240115
182700         SET PS-NEW-PAGE TO TRUE                                  07240215
182800         PERFORM 8000-WRITE-MAIN-HEADINGS                         07240315
182900         PERFORM 8100-WRITE-SUB-HEADINGS                          07240415
183000     END-IF.                                                      07240515
183100                                                                  07240615
183200*IF NEW PAGE, DISPLAY WEEK-END DATE.                              07240715
183300     IF PS-NEW-PAGE                                               07240815
183400         SET PS-SAME-PAGE             TO TRUE                     07240915
183500     END-IF.                                                      07241015
183600                                                                  07241115
183700     IF CC-ROUTE-TO-RDS                                           07241215
183800         WRITE REPORT-RECORD-1 FROM TL2-CRSDCK-LINE               07241716
183900             AFTER ADVANCING 1 LINE                               07241815
184000         ADD 1                    TO PV-LINE-COUNT                07241915
184100                                                                  07242015
184200         WRITE REPORT-RECORD-1 FROM TL3-CRSDCK-PERCENT-LINE       07242116
184300             AFTER ADVANCING 1 LINE                               07242216
184400         ADD 1                    TO PV-LINE-COUNT                07242316
184500                                                                  07242416
184600         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 07242516
184700         AFTER ADVANCING 1 LINE                                   07242616
184800         ADD 1                     TO PV-LINE-COUNT               07242716
184900     ELSE                                                         07242816
185000         WRITE REPORT-RECORD-2 FROM TL2-CRSDCK-LINE               07243316
185100             AFTER ADVANCING 1 LINE                               07243416
185200         ADD 1                    TO PV-LINE-COUNT                07243516
185300                                                                  07243616
185400         WRITE REPORT-RECORD-2 FROM TL3-CRSDCK-PERCENT-LINE       07243716
185500             AFTER ADVANCING 1 LINE                               07243816
185600         ADD 1                    TO PV-LINE-COUNT                07243916
185700                                                                  07244016
185800         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 07244116
185900         AFTER ADVANCING 1 LINE                                   07244216
186000         ADD 1                     TO PV-LINE-COUNT.              07244316
186100                                                                  07244416
186200         SET PS-SAME-PAGE          TO TRUE.                       07245274
186300*                                                                 07245316
186400******************************************************************07246016
186500 3300-COMPANY-TOTALS.                                             07250015
186600******************************************************************07260005
186700*                                                                 07270005
186800     MOVE PV-CURR-COMP-UNITS       TO TL4-CURRENT-UNITS.          07271027
186900     MOVE PV-CURR-COMP-RETAIL      TO TL4-CURRENT-RETAIL.         07271127
187000     MOVE PV-CURR-COMP-PO-RCVR     TO TL4-CURRENT-PO-RCVR.        07271227
187100     MOVE PV-PREV-COMP-UNITS       TO TL4-PREVIOUS-UNITS.         07271427
187200     MOVE PV-PREV-COMP-RETAIL      TO TL4-PREVIOUS-RETAIL.        07271527
187300     MOVE PV-PREV-COMP-PO-RCVR     TO TL4-PREVIOUS-PO-RCVR.       07271627
187400     MOVE PV-DIFF-COMP-UNITS       TO TL4-DIFFERENCE-UNITS.       07271831
187500     MOVE PV-DIFF-COMP-RETAIL      TO TL4-DIFFERENCE-RETAIL.      07271927
187600     MOVE PV-DIFF-COMP-PO-RCVR     TO TL4-DIFFERENCE-PO-RCVR.     07272027
187700                                                                  07273127
187800     IF CC-ROUTE-TO-RDS                                           07273227
187900         IF PS-SUMMARY-YES                                        07273337
188000             WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-8         07273441
188100                 AFTER ADVANCING 1 LINE                           07273541
188200             ADD 1                   TO PV-LINE-COUNT             07273641
188300             WRITE REPORT-RECORD-1 FROM SL-SUMMARY-LINE-1         07273737
188400                 AFTER ADVANCING 1 LINE                           07273837
188500             ADD 1                   TO PV-LINE-COUNT             07273937
188600         ELSE                                                     07274037
188700             WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE             07274137
188800                 AFTER ADVANCING 1 LINE                           07274237
188900             ADD 1                   TO PV-LINE-COUNT             07274337
189000         END-IF                                                   07274437
189100                                                                  07274527
189200         WRITE REPORT-RECORD-1 FROM TL4-COMP-ALL-LINE             07274627
189300             AFTER ADVANCING 1 LINE                               07274727
189400         ADD 1                    TO PV-LINE-COUNT                07274827
189500                                                                  07274927
189600         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 07275027
189700         AFTER ADVANCING 1 LINE                                   07275127
189800         ADD 1                     TO PV-LINE-COUNT               07275227
189900     ELSE                                                         07275327
190000         IF PS-SUMMARY-YES                                        07275437
190100             WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-8         07275541
190200                 AFTER ADVANCING 1 LINE                           07275641
190300             ADD 1                   TO PV-LINE-COUNT             07275741
190400             WRITE REPORT-RECORD-2 FROM SL-SUMMARY-LINE-1         07275837
190500                 AFTER ADVANCING 1 LINE                           07275937
190600             ADD 1                   TO PV-LINE-COUNT             07276037
190700         ELSE                                                     07276137
190800             WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE             07276237
190900                 AFTER ADVANCING 1 LINE                           07276337
191000             ADD 1                   TO PV-LINE-COUNT             07276437
191100         END-IF                                                   07276537
191200                                                                  07276627
191300         WRITE REPORT-RECORD-2 FROM TL4-COMP-ALL-LINE             07276727
191400             AFTER ADVANCING 1 LINE                               07276827
191500         ADD 1                    TO PV-LINE-COUNT                07276927
191600                                                                  07277027
191700         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 07277127
191800         AFTER ADVANCING 1 LINE                                   07277227
191900         ADD 1                     TO PV-LINE-COUNT.              07277327
192000*                                                                 07277427
192100******************************************************************07277566
192200 3900-PRINT-BLANK-LINE.                                           07277666
192300******************************************************************07277766
192400*                                                                 07277866
192500     IF CC-ROUTE-TO-RDS                                           07277966
192600         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 07278066
192700         AFTER ADVANCING 1 LINE                                   07278166
192800         ADD 1                     TO PV-LINE-COUNT               07278266
192900     ELSE                                                         07278366
193000         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 07278466
193100         AFTER ADVANCING 1 LINE                                   07278566
193200         ADD 1                     TO PV-LINE-COUNT.              07278666
193300*                                                                 07278766
193400******************************************************************07278873
193500* THIS SQL WILL GET COMPANY TOTALS FOR AREAS UNDER GROUP 'CRSDCK' 07278973
193600* WHEN CONTROL CARD REQUESTS THE REPORT FOR ONE DC OR BY COMPANY. 07279073
193700******************************************************************07279373
193800 4000-COMP-CRSDCK-QTY.                                            07279473
193900*                                                                 07279573
194000         EXEC SQL                                                 07279673
194100           SELECT                                                 07279773
194200                  SUM(A.UNT_WRKD_QTY)                             07279873
194300           INTO                                                   07279973
194400                  :PCT00005-UNT-WRKD-QTY                          07280073
194500           FROM    PCT_SUM_WRKD A                                 07280173
194600                 , PCT_PRC_AREA_ASSN B                            07280273
194700           WHERE  A.BUS_DTE        >=  :PV-FROM-DATE              07280373
194800             AND  A.BUS_DTE        <=  :PV-TO-DATE                07280473
194900             AND  A.PRCG_AREA_CDE   =  B.PRCG_AREA_CDE            07280573
195000             AND  A.OPER_UNT_ID     =  B.OPER_UNT_ID              07280673
195100             AND  B.PRC_AREA_GP_CDE =  'CRSDCK'                   07280773
195200                                                                  07280873
195300         END-EXEC                                                 07280973
195400                                                                  07281073
195500     EVALUATE TRUE                                                07281173
195600         WHEN SQLCODE = ZERO                                      07281273
195700             MOVE PCT00005-UNT-WRKD-QTY  TO PV-UNT-WRKD-QTY       07281373
195800         WHEN SQLCODE = +100                                      07281473
195900         WHEN SQLCODE = -305                                      07281582
196000             MOVE ZEROS    TO PV-UNT-WRKD-QTY                     07281682
196100         WHEN SQLCODE < ZERO                                      07281873
196200             DISPLAY '** ABEND - PCKRP014 **'                     07281973
196300             DISPLAY '** 4000-COMP-CRSDCK-QTY **'                 07282073
196400             PERFORM 9200-SQL-ABEND                               07282173
196500         WHEN SQLCODE > ZERO                                      07282273
196600         WHEN SQLWARN0 NOT = SPACES                               07282373
196700             DISPLAY '** ABEND - PCKRP014 **'                     07282473
196800             DISPLAY '** 4000-COMP-CRSDCK-QTY **'                 07282573
196900             PERFORM 9300-SQL-WARNING                             07282673
197000     END-EVALUATE.                                                07282773
197100/                                                                 07282873
197200******************************************************************07282973
197300* THIS SQL WILL GET DC TOTALS FOR AREAS UNDER GROUP 'CRSDCK'      07283073
197400* WHEN CONTROL CARD REQUESTS THE REPORT FOR ONE DC OR BY COMPANY. 07283173
197500******************************************************************07283273
197600 4100-DC-CRSDCK-QTY.                                              07283373
197700*                                                                 07283473
197800         EXEC SQL                                                 07283573
197900           SELECT                                                 07283673
198000                  SUM(A.UNT_WRKD_QTY)                             07283773
198100           INTO                                                   07283873
198200                  :PCT00005-UNT-WRKD-QTY                          07283973
198300           FROM    PCT_SUM_WRKD A                                 07284073
198400                 , PCT_PRC_AREA_ASSN B                            07284173
198500           WHERE  A.BUS_DTE        >=  :PV-FROM-DATE              07284273
198600             AND  A.BUS_DTE        <=  :PV-TO-DATE                07284373
198700             AND  A.OPER_UNT_ID     =  :PV-DC-OPER                07284476
198800             AND  A.PRCG_AREA_CDE   =  B.PRCG_AREA_CDE            07284573
198900             AND  A.OPER_UNT_ID     =  B.OPER_UNT_ID              07284673
199000             AND  B.PRC_AREA_GP_CDE  =  'CRSDCK'                  07284774
199100                                                                  07284873
199200         END-EXEC                                                 07284973
199300                                                                  07285073
199400     EVALUATE TRUE                                                07285173
199500         WHEN SQLCODE = ZERO                                      07285273
199600             MOVE PCT00005-UNT-WRKD-QTY  TO PV-UNT-WRKD-QTY       07285373
199700         WHEN SQLCODE = +100                                      07285473
199800         WHEN SQLCODE = -305                                      07285576
199900             MOVE ZEROS    TO PV-UNT-WRKD-QTY                     07285676
200000         WHEN SQLCODE < ZERO                                      07285775
200100             DISPLAY '** ABEND - PCKRP014 **'                     07285875
200200             DISPLAY '** 4100-DC-CRSDCK-QTY **'                   07285975
200300             PERFORM 9200-SQL-ABEND                               07286075
200400         WHEN SQLCODE > ZERO                                      07286175
200500         WHEN SQLWARN0 NOT = SPACES                               07286275
200600             DISPLAY '** ABEND - PCKRP014 **'                     07286375
200700             DISPLAY '** 4100-DC-CRSDCK-QTY **'                   07286475
200800             PERFORM 9300-SQL-WARNING                             07286575
200900     END-EVALUATE.                                                07286675
201000/                                                                 07286775
201100***************************************************************** 07290776
201200* GET LAST YEARS DATE RANGE.                                      07290876
201300***************************************************************** 07290976
201400 4200-PREV-DATE-RANGE.                                            07291076
201500                                                                  07291176
201600     MOVE CC-START-RPT-DATE-RANGE    TO PV-KEY-DATE.              07291276
201700     PERFORM 4300-SELECT-PREV-DATE.                               07291376
201800     MOVE DTATTR-LY-THIS-DAY-KY-DTE  TO PV-FROM-DATE              07291476
201900                                        PV-PREV-FROM-DATE.        07291576
202000                                                                  07291676
202100     MOVE CC-END-RPT-DATE-RANGE      TO PV-KEY-DATE.              07291776
202200     PERFORM 4300-SELECT-PREV-DATE.                               07291876
202300     MOVE DTATTR-LY-THIS-DAY-KY-DTE  TO PV-TO-DATE                07291976
202400                                        PV-PREV-TO-DATE.          07292076
202500/                                                                 07292176
202600***************************************************************** 07292276
202700* SELECT LAST YEARS DATE FROM TDTATTR.                            07292376
202800***************************************************************** 07292476
202900 4300-SELECT-PREV-DATE.                                           07292576
203000                                                                  07292676
203100         EXEC SQL                                                 07292776
203200           SELECT LY_THIS_DAY_KY_DTE                              07292876
203300             INTO :DTATTR-LY-THIS-DAY-KY-DTE                      07292976
203400           FROM TDTATTR                                           07293076
203500             WHERE KY_DTE  = :PV-KEY-DATE                         07293176
203600         END-EXEC                                                 07293276
203700                                                                  07293376
203800     EVALUATE TRUE                                                07293476
203900         WHEN SQLCODE = ZERO                                      07293576
204000         WHEN SQLCODE = +100                                      07293676
204100             CONTINUE                                             07293776
204200         WHEN SQLCODE < ZERO                                      07293876
204300             DISPLAY '** ABEND - PCKUT019 **'                     07293976
204400             DISPLAY '** 4300-SELECT-PREV-DATE **'                07294076
204500             PERFORM 9200-SQL-ABEND                               07294176
204600         WHEN SQLCODE > ZERO                                      07294276
204700         WHEN SQLWARN0 NOT = SPACES                               07294376
204800             DISPLAY '** ABEND - PCKUT019 **'                     07294476
204900             DISPLAY '** 4300-SELECT-PREV-DATE **'                07294576
205000             PERFORM 9300-SQL-WARNING                             07294676
205100     END-EVALUATE.                                                07294776
205200/                                                                 07294876
205300******************************************************************07294976
205400* GET CSRDCK TOTALS FROM TABLES FOR DC TOTAL LINES ON 'CORPORATE  07295076
205500* SUMMARY' PAGE.                                                  07295176
205600******************************************************************07295276
205700 5000-CRSDCK-PROCESS.                                             07295376
205800*                                                                 07295476
205900     MOVE CC-START-RPT-DATE-RANGE   TO PV-FROM-DATE               07295576
206000     MOVE CC-END-RPT-DATE-RANGE     TO PV-TO-DATE                 07295676
206100     MOVE SL-OPER-ID                TO PV-DC-OPER                 07295776
206200     PERFORM 4100-DC-CRSDCK-QTY                                   07295876
206300     MOVE PV-UNT-WRKD-QTY           TO PV-CURR-CRSDCK-UNITS-TOT   07295976
206400     PERFORM 4200-PREV-DATE-RANGE                                 07296076
206500     PERFORM 4100-DC-CRSDCK-QTY                                   07296176
206600     MOVE PV-UNT-WRKD-QTY           TO PV-PREV-CRSDCK-UNITS-TOT   07296276
206700                                                                  07296376
206800     SUBTRACT PV-PREV-CRSDCK-UNITS-TOT                            07296476
206900        FROM PV-CURR-CRSDCK-UNITS-TOT                             07296576
207000           GIVING PV-DIFF-CRSDCK-UNITS-TOT                        07296676
207100                                                                  07296776
207200     PERFORM 2300-CRSDCK-PERCENT.                                 07296876
207300     PERFORM 3200-CRSDCK-TOTALS.                                  07296976
207400                                                                  07297076
207500     INITIALIZE PV-CURR-CRSDCK-UNITS-TOT                          07297176
207600                 PV-CURR-CRSDCK-PERCENT                           07297276
207700                 PV-PREV-CRSDCK-UNITS-TOT                         07297376
207800                 PV-PREV-CRSDCK-PERCENT                           07297476
207900                 PV-DIFF-CRSDCK-UNITS-TOT                         07297576
208000                 PV-DIFF-CRSDCK-PERCENT.                          07297676
208100/                                                                 07297776
208200******************************************************************07297876
208300* GET CSRDCK TOTALS FROM TABLES FOR COMPANY TOTAL LINES ON        07297976
208400* 'CORPORATE SUMMARY' PAGE.                                       07298076
208500******************************************************************07298176
208600 5100-COMP-CRSDCK-PROCESS.                                        07298276
208700*                                                                 07298376
208800     MOVE CC-START-RPT-DATE-RANGE   TO PV-FROM-DATE               07298476
208900     MOVE CC-END-RPT-DATE-RANGE     TO PV-TO-DATE                 07298576
209000     PERFORM 4000-COMP-CRSDCK-QTY                                 07298676
209100     MOVE PV-UNT-WRKD-QTY           TO PV-CURR-CRSDCK-UNITS-COMP  07298776
209200     PERFORM 4200-PREV-DATE-RANGE                                 07298878
209300     MOVE PV-PREV-FROM-DATE         TO PV-FROM-DATE               07298976
209400     MOVE PV-PREV-TO-DATE           TO PV-TO-DATE                 07299076
209500     PERFORM 4000-COMP-CRSDCK-QTY                                 07299176
209600     MOVE PV-UNT-WRKD-QTY           TO PV-PREV-CRSDCK-UNITS-COMP  07299276
209700                                                                  07299376
209800     SUBTRACT PV-PREV-CRSDCK-UNITS-COMP                           07299476
209900        FROM PV-CURR-CRSDCK-UNITS-COMP                            07299576
210000           GIVING PV-DIFF-CRSDCK-UNITS-COMP.                      07299676
210100                                                                  07299776
210200/                                                                 07299876
210300******************************************************************07299976
210400* GET ECOMM CSRDCK TOTALS FROM TABLES FOR COMPANY TOTAL LINES ON  07300079
210500* 'CORPORATE SUMMARY' PAGE.                                       07300176
210600******************************************************************07300276
210700 5200-COMP-ECOMM-CRSDCK.                                          07300376
210800*                                                                 07300476
210900*    MOVE CC-START-RPT-DATE-RANGE   TO PV-FROM-DATE               07300580
211000*    MOVE CC-END-RPT-DATE-RANGE     TO PV-TO-DATE                 07300680
211100*    PERFORM 4000-COMP-CRSDCK-QTY                                 07300780
211200*    MOVE PV-UNT-WRKD-QTY           TO PV-CURR-CRSDCK-UNITS-COMP  07300880
211300*    PERFORM 4200-PREV-DATE-RANGE                                 07300980
211400*    MOVE PV-PREV-FROM-DATE         TO PV-FROM-DATE               07301080
211500*    MOVE PV-PREV-TO-DATE           TO PV-TO-DATE                 07301180
211600*    PERFORM 4000-COMP-CRSDCK-QTY                                 07301280
211700*    MOVE PV-UNT-WRKD-QTY           TO PV-PREV-CRSDCK-UNITS-COMP  07301380
211800                                                                  07301476
211900*    SUBTRACT PV-PREV-CRSDCK-UNITS-COMP                           07301580
212000*       FROM PV-CURR-CRSDCK-UNITS-COMP                            07301680
212100*          GIVING PV-DIFF-CRSDCK-UNITS-COMP.                      07301780
212200                                                                  07301876
212300/                                                                 07301976
212400******************************************************************07302076
212500*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *07302176
212600******************************************************************07302276
212700 7000-WRITE-ERROR-REPORT.                                         07302376
212800*                                                                 07302476
212900     IF CC-ROUTE-TO-RDS                                           07302576
213000         WRITE REPORT-RECORD-1                                    07302676
213100           FROM EL1-ERROR-LINE-1P                                 07302776
213200             AFTER ADVANCING 3 LINES                              07302876
213300*                                                                 07302976
213400         WRITE REPORT-RECORD-1                                    07303076
213500           FROM EL2-ERROR-LINE-2F                                 07303176
213600             AFTER ADVANCING 2 LINES                              07303276
213700*                                                                 07303376
213800         WRITE REPORT-RECORD-1                                    07303476
213900           FROM EL3-ERROR-LINE-3                                  07303576
214000             AFTER ADVANCING 2 LINES                              07303676
214100*                                                                 07303776
214200         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              07303876
214300         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                07303976
214400                                                                  07304076
214500         WRITE REPORT-RECORD-1                                    07304176
214600           FROM EL4-ERROR-LINE-4                                  07304276
214700             AFTER ADVANCING 3 LINES                              07304376
214800                                                                  07304476
214900         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    07304576
215000         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      07304676
215100                                                                  07304776
215200         WRITE REPORT-RECORD-1                                    07304876
215300           FROM EL5-ERROR-LINE-5B                                 07304976
215400             AFTER ADVANCING 2 LINES                              07305076
215500*                                                                 07305176
215600         WRITE REPORT-RECORD-1                                    07305276
215700           FROM ER-END-OF-REPORT-LINE                             07305376
215800             AFTER ADVANCING 6 LINES                              07305476
215900     ELSE                                                         07305576
216000         WRITE REPORT-RECORD-2                                    07305676
216100           FROM EL1-ERROR-LINE-1P                                 07305776
216200             AFTER ADVANCING 3 LINES                              07305876
216300*                                                                 07305976
216400         WRITE REPORT-RECORD-2                                    07306076
216500           FROM EL2-ERROR-LINE-2F                                 07306176
216600             AFTER ADVANCING 2 LINES                              07306276
216700*                                                                 07306376
216800         WRITE REPORT-RECORD-2                                    07306476
216900           FROM EL3-ERROR-LINE-3                                  07306576
217000             AFTER ADVANCING 2 LINES                              07306676
217100*                                                                 07306776
217200         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              07306876
217300         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                07306976
217400                                                                  07307076
217500         WRITE REPORT-RECORD-2                                    07307176
217600           FROM EL4-ERROR-LINE-4                                  07307276
217700             AFTER ADVANCING 3 LINES                              07307376
217800*                                                                 07307476
217900         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    07307576
218000         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      07307676
218100                                                                  07307776
218200         WRITE REPORT-RECORD-2                                    07307876
218300           FROM EL5-ERROR-LINE-5B                                 07307976
218400             AFTER ADVANCING 2 LINE                               07308076
218500*                                                                 07308176
218600         WRITE REPORT-RECORD-2                                    07308276
218700           FROM ER-END-OF-REPORT-LINE                             07308376
218800             AFTER ADVANCING 6 LINES.                             07308476
218900*                                                                 07309000
219000******************************************************************07820000
219100 8000-WRITE-MAIN-HEADINGS.                                        07830000
219200******************************************************************07840000
219300*                                                                 07850000
219400     ADD 1                         TO PV-PAGE-COUNT.              07910005
219500     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         07920005
219600     MOVE ZERO                     TO PV-LINE-COUNT.              07930005
219700                                                                  07940000
219800     IF CC-BATCH-REQUEST                                          07941055
219900        CONTINUE                                                  07942055
220000     ELSE                                                         07943055
220100         EVALUATE TRUE                                            07943155
220200             WHEN CC-RPT-FISCAL-MONTH                             07943255
220300                 MOVE CC-END-RPT-DATE-RANGE  TO PV-KEY-DATE       07943359
220400                 PERFORM 1150-SELECT-CURR-DATES                   07943455
220500                 MOVE PV-WK-END-YYYY      TO HL2A-YYYY            07943555
220600                 MOVE PV-WK-END-MM        TO HL2A-MM              07943655
220700                 MOVE PV-WK-END-DD        TO HL2A-DD              07943755
220800                 MOVE CC-USER-ID          TO HL2A-USER-ID         07944055
220900             WHEN CC-RPT-FISCAL-WEEK                              07945155
221000                 MOVE CC-END-RPT-DATE-RANGE  TO PV-KEY-DATE       07945255
221100                 PERFORM 1150-SELECT-CURR-DATES                   07945355
221200                 MOVE PV-WK-END-YYYY      TO HL2B-YYYY            07945455
221300                 MOVE PV-WK-END-MM        TO HL2B-MM              07945555
221400                 MOVE PV-WK-END-DD        TO HL2B-DD              07945655
221500                 MOVE CC-USER-ID          TO HL2B-USER-ID         07945755
221600             WHEN CC-RPT-DATE-RANGE                               07945855
221700                 MOVE CC-START-RPT-DATE-RANGE  TO PV-KEY-DATE     07945955
221800                 MOVE PV-KEY-YYYY         TO HL2C-FROM-YYYY       07946155
221900                 MOVE PV-KEY-MM           TO HL2C-FROM-MM         07946255
222000                 MOVE PV-KEY-DD           TO HL2C-FROM-DD         07946355
222100                 MOVE CC-END-RPT-DATE-RANGE  TO PV-KEY-DATE       07946455
222200                 MOVE PV-KEY-YYYY         TO HL2C-TO-YYYY         07946655
222300                 MOVE PV-KEY-MM           TO HL2C-TO-MM           07946755
222400                 MOVE PV-KEY-DD           TO HL2C-TO-DD           07946855
222500                 MOVE CC-USER-ID          TO HL2C-USER-ID         07946955
222600             WHEN CC-RPT-BUS-DATE                                 07947055
222700                 MOVE CC-START-RPT-DATE-RANGE  TO PV-KEY-DATE     07947155
222800                 MOVE PV-KEY-YYYY         TO HL2D-YYYY            07947355
222900                 MOVE PV-KEY-MM           TO HL2D-MM              07947455
223000                 MOVE PV-KEY-DD           TO HL2D-DD              07947555
223100                 MOVE CC-USER-ID          TO HL2D-USER-ID         07947655
223200         END-EVALUATE                                             07947755
223300     END-IF.                                                      07947855
223400                                                                  07948055
223500     IF CC-ROUTE-TO-RDS                                           07950000
223600         WRITE REPORT-RECORD-1 FROM                               07960000
223700             DP132O-STANDRD-HEADER-132-COLS                       07970000
223800             AFTER ADVANCING PAGE                                 07980000
223900         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 07981020
224000             AFTER ADVANCING 1 LINE                               07982020
224100         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1             08000022
224200             AFTER ADVANCING 1 LINES                              08010022
224300                                                                  08011055
224400         EVALUATE TRUE                                            08020055
224500             WHEN CC-RPT-FISCAL-MONTH                             08021055
224600                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2A    08022055
224700                    AFTER ADVANCING 1 LINES                       08023055
224800             WHEN CC-RPT-FISCAL-WEEK                              08024055
224900                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2B    08025055
225000                    AFTER ADVANCING 1 LINES                       08026055
225100             WHEN CC-RPT-DATE-RANGE                               08027055
225200                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2C    08028055
225300                    AFTER ADVANCING 1 LINES                       08029055
225400             WHEN CC-RPT-BUS-DATE                                 08029155
225500                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2D    08029255
225600                    AFTER ADVANCING 1 LINES                       08029355
225700         END-EVALUATE                                             08029455
225800                                                                  08029555
225900         ADD 4                      TO PV-LINE-COUNT              08029655
226000     ELSE                                                         08110000
226100         WRITE REPORT-RECORD-2 FROM                               08120000
226200             DP132O-STANDRD-HEADER-132-COLS                       08130000
226300             AFTER ADVANCING PAGE                                 08140000
226400         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 08141021
226500             AFTER ADVANCING 1 LINE                               08142020
226600         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1             08182022
226700             AFTER ADVANCING 1 LINES                              08183022
226800                                                                  08184055
226900         EVALUATE TRUE                                            08185055
227000             WHEN CC-RPT-FISCAL-MONTH                             08186055
227100                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2A    08187055
227200                    AFTER ADVANCING 1 LINES                       08188055
227300             WHEN CC-RPT-FISCAL-WEEK                              08189055
227400                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2B    08189155
227500                    AFTER ADVANCING 1 LINES                       08189255
227600             WHEN CC-RPT-DATE-RANGE                               08189355
227700                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2C    08189455
227800                    AFTER ADVANCING 1 LINES                       08189555
227900             WHEN CC-RPT-BUS-DATE                                 08189655
228000                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2D    08189755
228100                    AFTER ADVANCING 1 LINES                       08189855
228200         END-EVALUATE                                             08189955
228300                                                                  08190055
228400         ADD 4                      TO PV-LINE-COUNT              08260022
228500     END-IF.                                                      08261000
228600*                                                                 08270000
228700******************************************************************08280000
228800 8100-WRITE-SUB-HEADINGS.                                         08290000
228900******************************************************************08300000
229000*                                                                 08310000
229100     MOVE PV-OPER-ID               TO HL2-OPER-ID.                08310126
229200     PERFORM 1200-SELECT-OPER-DESC                                08310236
229300     IF CC-OPER-ALL                                               08310326
229400         MOVE 'CORPORATE SUMMARY'  TO HL2-LOC-DESC                08310426
229500     ELSE                                                         08310626
229600         IF PS-SUMMARY-YES                                        08310737
229700             MOVE 'CORPORATE SUMMARY'  TO HL2-LOC-DESC            08310837
229800             MOVE SPACES               TO HL2-OPER-ID             08310940
229900         ELSE                                                     08311037
230000             MOVE PV-STORE-NAME        TO HL2-LOC-DESC            08313037
230100         END-IF                                                   08313137
230200     END-IF.                                                      08313237
230300                                                                  08314011
230400     PERFORM 1600-REPORT-TYPE-CDE.                                08314354
230500                                                                  08315000
230600     IF CC-ROUTE-TO-RDS                                           08320000
230700         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3A            08321055
230800            AFTER ADVANCING 2 LINES                               08322011
230900         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3B            08330055
231000            AFTER ADVANCING 1 LINES                               08340000
231100                                                                  08350000
231200         EVALUATE TRUE                                            08351054
231300             WHEN CC-RPT-FISCAL-MONTH                             08352054
231400                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4A    08360054
231500                    AFTER ADVANCING 1 LINES                       08370054
231600             WHEN CC-RPT-FISCAL-WEEK                              08371054
231700                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4B    08372054
231800                    AFTER ADVANCING 1 LINES                       08373054
231900             WHEN CC-RPT-DATE-RANGE                               08374054
232000                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4C    08375054
232100                    AFTER ADVANCING 1 LINES                       08376054
232200             WHEN CC-RPT-BUS-DATE                                 08377054
232300                 WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4D    08378054
232400                    AFTER ADVANCING 1 LINES                       08379054
232500         END-EVALUATE                                             08379154
232600                                                                  08380000
232700         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-5             08390000
232800            AFTER ADVANCING 1 LINES                               08400000
232900                                                                  08410000
233000         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-6             08420000
233100            AFTER ADVANCING 1 LINES                               08430000
233200         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-7             08430116
233300            AFTER ADVANCING 1 LINES                               08430216
233400                                                                  08440000
233500         ADD 7                            TO PV-LINE-COUNT        08470016
233600                                                                  08471000
233700     ELSE                                                         08480000
233800         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-3A            08481055
233900            AFTER ADVANCING 2 LINES                               08482011
234000         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-3B            08490055
234100            AFTER ADVANCING 1 LINES                               08500000
234200                                                                  08510000
234300         EVALUATE TRUE                                            08531054
234400             WHEN CC-RPT-FISCAL-MONTH                             08532054
234500                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4A    08533054
234600                    AFTER ADVANCING 1 LINES                       08534054
234700             WHEN CC-RPT-FISCAL-WEEK                              08535054
234800                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4B    08536054
234900                    AFTER ADVANCING 1 LINES                       08537054
235000             WHEN CC-RPT-DATE-RANGE                               08538054
235100                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4C    08539054
235200                    AFTER ADVANCING 1 LINES                       08539154
235300             WHEN CC-RPT-BUS-DATE                                 08539254
235400                 WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4D    08539354
235500                    AFTER ADVANCING 1 LINES                       08539454
235600         END-EVALUATE                                             08539554
235700                                                                  08540000
235800         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-5             08550000
235900            AFTER ADVANCING 1 LINES                               08560000
236000                                                                  08570000
236100         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-6             08580000
236200            AFTER ADVANCING 1 LINES                               08590000
236300         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-7             08591016
236400            AFTER ADVANCING 1 LINES                               08592016
236500                                                                  08600000
236600         ADD 7                            TO PV-LINE-COUNT.       08630016
236700*                                                                 08640000
236800******************************************************************08650000
236900 9000-EOJ.                                                        08660000
237000******************************************************************08670000
237100*                                                                 08680000
237200     IF CC-ROUTE-TO-RDS                                           08690000
237300         WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE         08700000
237400            AFTER ADVANCING 2 LINES                               08710000
237500     ELSE                                                         08720000
237600         WRITE REPORT-RECORD-2 FROM ER-END-OF-REPORT-LINE         08730000
237700            AFTER ADVANCING 2 LINES.                              08740000
237800                                                                  08750000
237900*CLOSE FILES.                                                     08760000
238000     CLOSE EXTRACT-FILE                                           08770000
238100                                                                  08780000
238200     IF CC-ROUTE-TO-RDS                                           08790000
238300        CLOSE REPORT-FILE-1                                       08800000
238400     ELSE                                                         08810000
238500        CLOSE REPORT-FILE-2                                       08820000
238600     END-IF.                                                      08830000
238700/                                                                 08840000
238800******************************************************************08850000
238900 9200-SQL-ABEND.                                                  08860000
239000******************************************************************08870000
239100                                                                  08880000
239200     MOVE SQLCODE                     TO SQLCODE2.                08890000
239300     MOVE SQLERRD(3)                  TO SQLERRD3.                08900000
239400                                                                  08910000
239500     DISPLAY '** ABEND **         ** = SQLERROR'.                 08920000
239600     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08930000
239700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08940000
239800     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08950000
239900     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     08960000
240000     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     08970000
240100     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     08980000
240200                                                                  08990000
240300     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                09000000
240400     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                09010000
240500     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 09020000
240600     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                09030000
240700                                                                  09040000
240800                                                                  09050000
240900     MOVE +4013                       TO PV-ABEND-CODE.           09060000
241000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09070000
241100                                                                  09080000
241200******************************************************************09090000
241300 9300-SQL-WARNING.                                                09100000
241400******************************************************************09110000
241500                                                                  09120000
241600     DISPLAY '9300-SQL-WARNING'.                                  09130000
241700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        09140000
241800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   09150000
241900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                09160000
242000                                                                  09170000
242100     MOVE SQLCODE                     TO SQLCODE2.                09180000
242200     MOVE SQLERRD(3)                  TO SQLERRD3.                09190000
242300     DISPLAY '** ABEND **       ** = SQLWARNING'.                 09200000
242400     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  09210000
242500     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  09220000
242600     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  09230000
242700     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  09240000
242800     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  09250000
242900     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  09260000
243000     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  09270000
243100     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  09280000
243200     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  09290000
243300     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  09300000
243400                                                                  09310000
243500     MOVE +4013                       TO PV-ABEND-CODE.           09320000
243600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09330000
243700*                                                                 09340000
243800******************************************************************09350000
243900*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       09360000
244000******************************************************************09370000
244100 9400-ABEND.                                                      09380000
244200*                                                                 09390000
244300     DISPLAY '***************************'.                       09400000
244400     DISPLAY '**       ABEND           **'.                       09410000
244500     DISPLAY '**  IN PROGRAM PCKRP014  **'.                       09420035
244600     DISPLAY '***************************'.                       09430000
244700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH.             09440000
244800     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         09450000
244900     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       09460000
245000     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       09470000
245100                                                                  09480000
245200     MOVE +4014                  TO PV-ABEND-CODE.                09490000
245300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09500000
245400*                                                                 09510000
245500******************************************************************09520000
